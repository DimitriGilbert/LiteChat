const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dagre-OKDRZEBW-ygFLMWkS.js","assets/graph-B74mWyiF.js","assets/_baseUniq-BU0gJ92Z.js","assets/layout-Cm1FzLkQ.js","assets/_basePickBy-DvYlHn5G.js","assets/clone-CxIQ9L5X.js","assets/c4Diagram-VJAJSXHY-C0JHu5Bn.js","assets/chunk-D6G4REZN-DEZcl753.js","assets/flowDiagram-4HSFHLVR-DjWeIkqx.js","assets/chunk-RZ5BOZE2-3BxQcoCe.js","assets/channel-CPsm1_Ix.js","assets/erDiagram-Q7BY3M3F-CqvZTxw-.js","assets/gitGraphDiagram-7IBYFJ6S-CrOS15ap.js","assets/chunk-4BMEZGHF-BeuK20Te.js","assets/chunk-XZIHB7SX-CSrPfF-5.js","assets/radar-MK3ICKWK-CYSd0hnV.js","assets/ganttDiagram-APWFNJXF-BtdPMneH.js","assets/linear-S6D0QrUU.js","assets/init-Gi6I4Gst.js","assets/infoDiagram-PH2N3AL5-B94h_lQz.js","assets/pieDiagram-IB7DONF6-BcnYEJVp.js","assets/arc-B4ZWJZsr.js","assets/ordinal-Cboi1Yqb.js","assets/quadrantDiagram-7GDLP6J5-DjEN7wIT.js","assets/xychartDiagram-VJFVF3MP-DdpnWYNk.js","assets/requirementDiagram-KVF5MWMF-CnTGZ5B1.js","assets/sequenceDiagram-X6HHIX6F-m54nHszU.js","assets/classDiagram-GIVACNV2-CJUeiuVN.js","assets/chunk-A2AXSNBT-_XOz8FFu.js","assets/classDiagram-v2-COTLJTTW-CJUeiuVN.js","assets/stateDiagram-DGXRK772-Be1vAabG.js","assets/chunk-AEK57VVT-CSgJO7cB.js","assets/stateDiagram-v2-YXO3MK2T-D314CdlD.js","assets/journeyDiagram-U35MCT3I-PWLGugHi.js","assets/timeline-definition-BDJGKUSR-BLA-XwTJ.js","assets/mindmap-definition-ALO5MXBD-CE2axBrk.js","assets/cytoscape.esm-0R7PX7lh.js","assets/sankeyDiagram-QLVOVGJD-Ce29_sYZ.js","assets/diagram-VNBRO52H-BFR_g9QB.js","assets/diagram-SSKATNLV-BCUsWllE.js","assets/blockDiagram-JOT3LUYC-N_VJrx4V.js","assets/architectureDiagram-IEHRJDOE-BsoDInQZ.js"])))=>i.map(i=>d[i]);
var Gfe=Object.defineProperty;var Kfe=(e,t,n)=>t in e?Gfe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ve=(e,t,n)=>Kfe(e,typeof t!="symbol"?t+"":t,n);function Yfe(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var zp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var nN={exports:{}},xv={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YL;function Zfe(){if(YL)return xv;YL=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:e,type:r,key:a,ref:s!==void 0?s:null,props:i}}return xv.Fragment=t,xv.jsx=n,xv.jsxs=n,xv}var ZL;function Xfe(){return ZL||(ZL=1,nN.exports=Zfe()),nN.exports}var f=Xfe(),rN={exports:{}};function Jfe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var FW={exports:{}},bi=FW.exports={},nu,ru;function D3(){throw new Error("setTimeout has not been defined")}function F3(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?nu=setTimeout:nu=D3}catch{nu=D3}try{typeof clearTimeout=="function"?ru=clearTimeout:ru=F3}catch{ru=F3}})();function LW(e){if(nu===setTimeout)return setTimeout(e,0);if((nu===D3||!nu)&&setTimeout)return nu=setTimeout,setTimeout(e,0);try{return nu(e,0)}catch{try{return nu.call(null,e,0)}catch{return nu.call(this,e,0)}}}function Qfe(e){if(ru===clearTimeout)return clearTimeout(e);if((ru===F3||!ru)&&clearTimeout)return ru=clearTimeout,clearTimeout(e);try{return ru(e)}catch{try{return ru.call(null,e)}catch{return ru.call(this,e)}}}var wd=[],_0=!1,Up,x2=-1;function ehe(){!_0||!Up||(_0=!1,Up.length?wd=Up.concat(wd):x2=-1,wd.length&&BW())}function BW(){if(!_0){var e=LW(ehe);_0=!0;for(var t=wd.length;t;){for(Up=wd,wd=[];++x2<t;)Up&&Up[x2].run();x2=-1,t=wd.length}Up=null,_0=!1,Qfe(e)}}bi.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];wd.push(new $W(e,t)),wd.length===1&&!_0&&LW(BW)};function $W(e,t){this.fun=e,this.array=t}$W.prototype.run=function(){this.fun.apply(null,this.array)};bi.title="browser";bi.browser=!0;bi.env={};bi.argv=[];bi.version="";bi.versions={};function Xd(){}bi.on=Xd;bi.addListener=Xd;bi.once=Xd;bi.off=Xd;bi.removeListener=Xd;bi.removeAllListeners=Xd;bi.emit=Xd;bi.prependListener=Xd;bi.prependOnceListener=Xd;bi.listeners=function(e){return[]};bi.binding=function(e){throw new Error("process.binding is not supported")};bi.cwd=function(){return"/"};bi.chdir=function(e){throw new Error("process.chdir is not supported")};bi.umask=function(){return 0};var the=FW.exports;const Ai=Jfe(the);var Er={},XL;function nhe(){if(XL)return Er;XL=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function h(W){return W===null||typeof W!="object"?null:(W=d&&W[d]||W["@@iterator"],typeof W=="function"?W:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function v(W,Q,ee){this.props=W,this.context=Q,this.refs=b,this.updater=ee||m}v.prototype.isReactComponent={},v.prototype.setState=function(W,Q){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,Q,"setState")},v.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function x(){}x.prototype=v.prototype;function w(W,Q,ee){this.props=W,this.context=Q,this.refs=b,this.updater=ee||m}var S=w.prototype=new x;S.constructor=w,y(S,v.prototype),S.isPureReactComponent=!0;var C=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},A=Object.prototype.hasOwnProperty;function R(W,Q,ee,se,pe,ce){return ee=ce.ref,{$$typeof:e,type:W,key:Q,ref:ee!==void 0?ee:null,props:ce}}function N(W,Q){return R(W.type,Q,void 0,void 0,void 0,W.props)}function I(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function O(W){var Q={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ee){return Q[ee]})}var L=/\/+/g;function P(W,Q){return typeof W=="object"&&W!==null&&W.key!=null?O(""+W.key):Q.toString(36)}function V(){}function F(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(V,V):(W.status="pending",W.then(function(Q){W.status==="pending"&&(W.status="fulfilled",W.value=Q)},function(Q){W.status==="pending"&&(W.status="rejected",W.reason=Q)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function X(W,Q,ee,se,pe){var ce=typeof W;(ce==="undefined"||ce==="boolean")&&(W=null);var Ie=!1;if(W===null)Ie=!0;else switch(ce){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(W.$$typeof){case e:case t:Ie=!0;break;case u:return Ie=W._init,X(Ie(W._payload),Q,ee,se,pe)}}if(Ie)return pe=pe(W),Ie=se===""?"."+P(W,0):se,C(pe)?(ee="",Ie!=null&&(ee=Ie.replace(L,"$&/")+"/"),X(pe,Q,ee,"",function(Ce){return Ce})):pe!=null&&(I(pe)&&(pe=N(pe,ee+(pe.key==null||W&&W.key===pe.key?"":(""+pe.key).replace(L,"$&/")+"/")+Ie)),Q.push(pe)),1;Ie=0;var De=se===""?".":se+":";if(C(W))for(var Se=0;Se<W.length;Se++)se=W[Se],ce=De+P(se,Se),Ie+=X(se,Q,ee,ce,pe);else if(Se=h(W),typeof Se=="function")for(W=Se.call(W),Se=0;!(se=W.next()).done;)se=se.value,ce=De+P(se,Se++),Ie+=X(se,Q,ee,ce,pe);else if(ce==="object"){if(typeof W.then=="function")return X(F(W),Q,ee,se,pe);throw Q=String(W),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function U(W,Q,ee){if(W==null)return W;var se=[],pe=0;return X(W,se,"","",function(ce){return Q.call(ee,ce,pe++)}),se}function H(W){if(W._status===-1){var Q=W._result;Q=Q(),Q.then(function(ee){(W._status===0||W._status===-1)&&(W._status=1,W._result=ee)},function(ee){(W._status===0||W._status===-1)&&(W._status=2,W._result=ee)}),W._status===-1&&(W._status=0,W._result=Q)}if(W._status===1)return W._result.default;throw W._result}var $=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(Q))return}else if(typeof Ai=="object"&&typeof Ai.emit=="function"){Ai.emit("uncaughtException",W);return}console.error(W)};function ne(){}return Er.Children={map:U,forEach:function(W,Q,ee){U(W,function(){Q.apply(this,arguments)},ee)},count:function(W){var Q=0;return U(W,function(){Q++}),Q},toArray:function(W){return U(W,function(Q){return Q})||[]},only:function(W){if(!I(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Er.Component=v,Er.Fragment=n,Er.Profiler=s,Er.PureComponent=w,Er.StrictMode=r,Er.Suspense=l,Er.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Er.__COMPILER_RUNTIME={__proto__:null,c:function(W){return k.H.useMemoCache(W)}},Er.cache=function(W){return function(){return W.apply(null,arguments)}},Er.cloneElement=function(W,Q,ee){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var se=y({},W.props),pe=W.key,ce=void 0;if(Q!=null)for(Ie in Q.ref!==void 0&&(ce=void 0),Q.key!==void 0&&(pe=""+Q.key),Q)!A.call(Q,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&Q.ref===void 0||(se[Ie]=Q[Ie]);var Ie=arguments.length-2;if(Ie===1)se.children=ee;else if(1<Ie){for(var De=Array(Ie),Se=0;Se<Ie;Se++)De[Se]=arguments[Se+2];se.children=De}return R(W.type,pe,void 0,void 0,ce,se)},Er.createContext=function(W){return W={$$typeof:a,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:i,_context:W},W},Er.createElement=function(W,Q,ee){var se,pe={},ce=null;if(Q!=null)for(se in Q.key!==void 0&&(ce=""+Q.key),Q)A.call(Q,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(pe[se]=Q[se]);var Ie=arguments.length-2;if(Ie===1)pe.children=ee;else if(1<Ie){for(var De=Array(Ie),Se=0;Se<Ie;Se++)De[Se]=arguments[Se+2];pe.children=De}if(W&&W.defaultProps)for(se in Ie=W.defaultProps,Ie)pe[se]===void 0&&(pe[se]=Ie[se]);return R(W,ce,void 0,void 0,null,pe)},Er.createRef=function(){return{current:null}},Er.forwardRef=function(W){return{$$typeof:o,render:W}},Er.isValidElement=I,Er.lazy=function(W){return{$$typeof:u,_payload:{_status:-1,_result:W},_init:H}},Er.memo=function(W,Q){return{$$typeof:c,type:W,compare:Q===void 0?null:Q}},Er.startTransition=function(W){var Q=k.T,ee={};k.T=ee;try{var se=W(),pe=k.S;pe!==null&&pe(ee,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(ne,$)}catch(ce){$(ce)}finally{k.T=Q}},Er.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Er.use=function(W){return k.H.use(W)},Er.useActionState=function(W,Q,ee){return k.H.useActionState(W,Q,ee)},Er.useCallback=function(W,Q){return k.H.useCallback(W,Q)},Er.useContext=function(W){return k.H.useContext(W)},Er.useDebugValue=function(){},Er.useDeferredValue=function(W,Q){return k.H.useDeferredValue(W,Q)},Er.useEffect=function(W,Q,ee){var se=k.H;if(typeof ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return se.useEffect(W,Q)},Er.useId=function(){return k.H.useId()},Er.useImperativeHandle=function(W,Q,ee){return k.H.useImperativeHandle(W,Q,ee)},Er.useInsertionEffect=function(W,Q){return k.H.useInsertionEffect(W,Q)},Er.useLayoutEffect=function(W,Q){return k.H.useLayoutEffect(W,Q)},Er.useMemo=function(W,Q){return k.H.useMemo(W,Q)},Er.useOptimistic=function(W,Q){return k.H.useOptimistic(W,Q)},Er.useReducer=function(W,Q,ee){return k.H.useReducer(W,Q,ee)},Er.useRef=function(W){return k.H.useRef(W)},Er.useState=function(W){return k.H.useState(W)},Er.useSyncExternalStore=function(W,Q,ee){return k.H.useSyncExternalStore(W,Q,ee)},Er.useTransition=function(){return k.H.useTransition()},Er.version="19.1.0",Er}var JL;function r1(){return JL||(JL=1,rN.exports=nhe()),rN.exports}var T=r1();const We=_a(T),zW=Yfe({__proto__:null,default:We},[T]);var sN={exports:{}},wv={},iN={exports:{}},aN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QL;function rhe(){return QL||(QL=1,function(e){function t(U,H){var $=U.length;U.push(H);e:for(;0<$;){var ne=$-1>>>1,W=U[ne];if(0<s(W,H))U[ne]=H,U[$]=W,$=ne;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var H=U[0],$=U.pop();if($!==H){U[0]=$;e:for(var ne=0,W=U.length,Q=W>>>1;ne<Q;){var ee=2*(ne+1)-1,se=U[ee],pe=ee+1,ce=U[pe];if(0>s(se,$))pe<W&&0>s(ce,se)?(U[ne]=ce,U[pe]=$,ne=pe):(U[ne]=se,U[ee]=$,ne=ee);else if(pe<W&&0>s(ce,$))U[ne]=ce,U[pe]=$,ne=pe;else break e}}return H}function s(U,H){var $=U.sortIndex-H.sortIndex;return $!==0?$:U.id-H.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,m=!1,y=!1,b=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function C(U){for(var H=n(c);H!==null;){if(H.callback===null)r(c);else if(H.startTime<=U)r(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=n(c)}}function k(U){if(b=!1,C(U),!y)if(n(l)!==null)y=!0,A||(A=!0,P());else{var H=n(c);H!==null&&X(k,H.startTime-U)}}var A=!1,R=-1,N=5,I=-1;function O(){return v?!0:!(e.unstable_now()-I<N)}function L(){if(v=!1,A){var U=e.unstable_now();I=U;var H=!0;try{e:{y=!1,b&&(b=!1,w(R),R=-1),m=!0;var $=h;try{t:{for(C(U),d=n(l);d!==null&&!(d.expirationTime>U&&O());){var ne=d.callback;if(typeof ne=="function"){d.callback=null,h=d.priorityLevel;var W=ne(d.expirationTime<=U);if(U=e.unstable_now(),typeof W=="function"){d.callback=W,C(U),H=!0;break t}d===n(l)&&r(l),C(U)}else r(l);d=n(l)}if(d!==null)H=!0;else{var Q=n(c);Q!==null&&X(k,Q.startTime-U),H=!1}}break e}finally{d=null,h=$,m=!1}H=void 0}}finally{H?P():A=!1}}}var P;if(typeof S=="function")P=function(){S(L)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,F=V.port2;V.port1.onmessage=L,P=function(){F.postMessage(null)}}else P=function(){x(L,0)};function X(U,H){R=x(function(){U(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var $=h;h=H;try{return U()}finally{h=$}},e.unstable_requestPaint=function(){v=!0},e.unstable_runWithPriority=function(U,H){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var $=h;h=U;try{return H()}finally{h=$}},e.unstable_scheduleCallback=function(U,H,$){var ne=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?ne+$:ne):$=ne,U){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=$+W,U={id:u++,callback:H,priorityLevel:U,startTime:$,expirationTime:W,sortIndex:-1},$>ne?(U.sortIndex=$,t(c,U),n(l)===null&&U===n(c)&&(b?(w(R),R=-1):b=!0,X(k,$-ne))):(U.sortIndex=W,t(l,U),y||m||(y=!0,A||(A=!0,P()))),U},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(U){var H=h;return function(){var $=h;h=H;try{return U.apply(this,arguments)}finally{h=$}}}}(aN)),aN}var eB;function she(){return eB||(eB=1,iN.exports=rhe()),iN.exports}var oN={exports:{}},Ta={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tB;function ihe(){if(tB)return Ta;tB=1;var e=r1();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Ta.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ta.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return i(l,c,null,u)},Ta.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},Ta.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},Ta.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},Ta.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,m=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:h,fetchPriority:m}):u==="script"&&r.d.X(l,{crossOrigin:d,integrity:h,fetchPriority:m,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Ta.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},Ta.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Ta.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},Ta.requestFormReset=function(l){r.d.r(l)},Ta.unstable_batchedUpdates=function(l,c){return l(c)},Ta.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},Ta.useFormStatus=function(){return a.H.useHostTransitionStatus()},Ta.version="19.1.0",Ta}var nB;function UW(){if(nB)return oN.exports;nB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),oN.exports=ihe(),oN.exports}var rB;function ahe(){if(rB)return wv;rB=1;var e=she(),t=r1(),n=UW();function r(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function i(p){var g=p,_=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(_=g.return),p=g.return;while(p)}return g.tag===3?_:null}function a(p){if(p.tag===13){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function o(p){if(i(p)!==p)throw Error(r(188))}function l(p){var g=p.alternate;if(!g){if(g=i(p),g===null)throw Error(r(188));return g!==p?null:p}for(var _=p,E=g;;){var j=_.return;if(j===null)break;var q=j.alternate;if(q===null){if(E=j.return,E!==null){_=E;continue}break}if(j.child===q.child){for(q=j.child;q;){if(q===_)return o(j),p;if(q===E)return o(j),g;q=q.sibling}throw Error(r(188))}if(_.return!==E.return)_=j,E=q;else{for(var ue=!1,Re=j.child;Re;){if(Re===_){ue=!0,_=j,E=q;break}if(Re===E){ue=!0,E=j,_=q;break}Re=Re.sibling}if(!ue){for(Re=q.child;Re;){if(Re===_){ue=!0,_=q,E=j;break}if(Re===E){ue=!0,E=q,_=j;break}Re=Re.sibling}if(!ue)throw Error(r(189))}}if(_.alternate!==E)throw Error(r(190))}if(_.tag!==3)throw Error(r(188));return _.stateNode.current===_?p:g}function c(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=c(p),g!==null)return g;p=p.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function P(p){return p===null||typeof p!="object"?null:(p=L&&p[L]||p["@@iterator"],typeof p=="function"?p:null)}var V=Symbol.for("react.client.reference");function F(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===V?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case y:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case k:return"Suspense";case A:return"SuspenseList";case I:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case m:return"Portal";case S:return(p.displayName||"Context")+".Provider";case w:return(p._context.displayName||"Context")+".Consumer";case C:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case R:return g=p.displayName||null,g!==null?g:F(p.type)||"Memo";case N:g=p._payload,p=p._init;try{return F(p(g))}catch{}}return null}var X=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},ne=[],W=-1;function Q(p){return{current:p}}function ee(p){0>W||(p.current=ne[W],ne[W]=null,W--)}function se(p,g){W++,ne[W]=p.current,p.current=g}var pe=Q(null),ce=Q(null),Ie=Q(null),De=Q(null);function Se(p,g){switch(se(Ie,g),se(ce,p),se(pe,null),g.nodeType){case 9:case 11:p=(p=g.documentElement)&&(p=p.namespaceURI)?SL(p):0;break;default:if(p=g.tagName,g=g.namespaceURI)g=SL(g),p=CL(g,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}ee(pe),se(pe,p)}function Ce(){ee(pe),ee(ce),ee(Ie)}function qe(p){p.memoizedState!==null&&se(De,p);var g=pe.current,_=CL(g,p.type);g!==_&&(se(ce,p),se(pe,_))}function Qe(p){ce.current===p&&(ee(pe),ee(ce)),De.current===p&&(ee(De),mv._currentValue=$)}var Ve=Object.prototype.hasOwnProperty,Ne=e.unstable_scheduleCallback,K=e.unstable_cancelCallback,me=e.unstable_shouldYield,Ae=e.unstable_requestPaint,le=e.unstable_now,oe=e.unstable_getCurrentPriorityLevel,re=e.unstable_ImmediatePriority,Te=e.unstable_UserBlockingPriority,Be=e.unstable_NormalPriority,ke=e.unstable_LowPriority,lt=e.unstable_IdlePriority,Rt=e.log,ft=e.unstable_setDisableYieldValue,jt=null,qt=null;function Lt(p){if(typeof Rt=="function"&&ft(p),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(jt,p)}catch{}}var en=Math.clz32?Math.clz32:Z,xe=Math.log,D=Math.LN2;function Z(p){return p>>>=0,p===0?32:31-(xe(p)/D|0)|0}var ge=256,Fe=4194304;function we(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function Me(p,g,_){var E=p.pendingLanes;if(E===0)return 0;var j=0,q=p.suspendedLanes,ue=p.pingedLanes;p=p.warmLanes;var Re=E&134217727;return Re!==0?(E=Re&~q,E!==0?j=we(E):(ue&=Re,ue!==0?j=we(ue):_||(_=Re&~p,_!==0&&(j=we(_))))):(Re=E&~q,Re!==0?j=we(Re):ue!==0?j=we(ue):_||(_=E&~p,_!==0&&(j=we(_)))),j===0?0:g!==0&&g!==j&&(g&q)===0&&(q=j&-j,_=g&-g,q>=_||q===32&&(_&4194048)!==0)?g:j}function de(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function vt(p,g){switch(p){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ot(){var p=ge;return ge<<=1,(ge&4194048)===0&&(ge=256),p}function B(){var p=Fe;return Fe<<=1,(Fe&62914560)===0&&(Fe=4194304),p}function ze(p){for(var g=[],_=0;31>_;_++)g.push(p);return g}function st(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function ye(p,g,_,E,j,q){var ue=p.pendingLanes;p.pendingLanes=_,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=_,p.entangledLanes&=_,p.errorRecoveryDisabledLanes&=_,p.shellSuspendCounter=0;var Re=p.entanglements,Ye=p.expirationTimes,wt=p.hiddenUpdates;for(_=ue&~_;0<_;){var Pt=31-en(_),Bt=1<<Pt;Re[Pt]=0,Ye[Pt]=-1;var Ct=wt[Pt];if(Ct!==null)for(wt[Pt]=null,Pt=0;Pt<Ct.length;Pt++){var At=Ct[Pt];At!==null&&(At.lane&=-536870913)}_&=~Bt}E!==0&&_e(p,E,0),q!==0&&j===0&&p.tag!==0&&(p.suspendedLanes|=q&~(ue&~g))}function _e(p,g,_){p.pendingLanes|=g,p.suspendedLanes&=~g;var E=31-en(g);p.entangledLanes|=g,p.entanglements[E]=p.entanglements[E]|1073741824|_&4194090}function Ue(p,g){var _=p.entangledLanes|=g;for(p=p.entanglements;_;){var E=31-en(_),j=1<<E;j&g|p[E]&g&&(p[E]|=g),_&=~j}}function kt(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function fe(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function Y(){var p=H.p;return p!==0?p:(p=window.event,p===void 0?32:qL(p.type))}function G(p,g){var _=H.p;try{return H.p=p,g()}finally{H.p=_}}var J=Math.random().toString(36).slice(2),be="__reactFiber$"+J,Pe="__reactProps$"+J,Ge="__reactContainer$"+J,_t="__reactEvents$"+J,tn="__reactListeners$"+J,Un="__reactHandles$"+J,Xt="__reactResources$"+J,nn="__reactMarker$"+J;function un(p){delete p[be],delete p[Pe],delete p[_t],delete p[tn],delete p[Un]}function mr(p){var g=p[be];if(g)return g;for(var _=p.parentNode;_;){if(g=_[Ge]||_[be]){if(_=g.alternate,g.child!==null||_!==null&&_.child!==null)for(p=AL(p);p!==null;){if(_=p[be])return _;p=AL(p)}return g}p=_,_=p.parentNode}return null}function Ar(p){if(p=p[be]||p[Ge]){var g=p.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return p}return null}function ns(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p.stateNode;throw Error(r(33))}function rs(p){var g=p[Xt];return g||(g=p[Xt]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function Cr(p){p[nn]=!0}var hn=new Set,et={};function Vt(p,g){pn(p,g),pn(p+"Capture",g)}function pn(p,g){for(et[p]=g,p=0;p<g.length;p++)hn.add(g[p])}var nr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ts={},es={};function Ii(p){return Ve.call(es,p)?!0:Ve.call(Ts,p)?!1:nr.test(p)?es[p]=!0:(Ts[p]=!0,!1)}function li(p,g,_){if(Ii(g))if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":p.removeAttribute(g);return;case"boolean":var E=g.toLowerCase().slice(0,5);if(E!=="data-"&&E!=="aria-"){p.removeAttribute(g);return}}p.setAttribute(g,""+_)}}function qa(p,g,_){if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(g);return}p.setAttribute(g,""+_)}}function ca(p,g,_,E){if(E===null)p.removeAttribute(_);else{switch(typeof E){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(_);return}p.setAttributeNS(g,_,""+E)}}var Vs,zo;function yl(p){if(Vs===void 0)try{throw Error()}catch(_){var g=_.stack.trim().match(/\n( *(at )?)/);Vs=g&&g[1]||"",zo=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Vs+p+zo}var uf=!1;function tg(p,g){if(!p||uf)return"";uf=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var E={DetermineComponentFrameRoot:function(){try{if(g){var Bt=function(){throw Error()};if(Object.defineProperty(Bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Bt,[])}catch(At){var Ct=At}Reflect.construct(p,[],Bt)}else{try{Bt.call()}catch(At){Ct=At}p.call(Bt.prototype)}}else{try{throw Error()}catch(At){Ct=At}(Bt=p())&&typeof Bt.catch=="function"&&Bt.catch(function(){})}}catch(At){if(At&&Ct&&typeof At.stack=="string")return[At.stack,Ct.stack]}return[null,null]}};E.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(E.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(E.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var q=E.DetermineComponentFrameRoot(),ue=q[0],Re=q[1];if(ue&&Re){var Ye=ue.split(`
`),wt=Re.split(`
`);for(j=E=0;E<Ye.length&&!Ye[E].includes("DetermineComponentFrameRoot");)E++;for(;j<wt.length&&!wt[j].includes("DetermineComponentFrameRoot");)j++;if(E===Ye.length||j===wt.length)for(E=Ye.length-1,j=wt.length-1;1<=E&&0<=j&&Ye[E]!==wt[j];)j--;for(;1<=E&&0<=j;E--,j--)if(Ye[E]!==wt[j]){if(E!==1||j!==1)do if(E--,j--,0>j||Ye[E]!==wt[j]){var Pt=`
`+Ye[E].replace(" at new "," at ");return p.displayName&&Pt.includes("<anonymous>")&&(Pt=Pt.replace("<anonymous>",p.displayName)),Pt}while(1<=E&&0<=j);break}}}finally{uf=!1,Error.prepareStackTrace=_}return(_=p?p.displayName||p.name:"")?yl(_):""}function Dr(p){switch(p.tag){case 26:case 27:case 5:return yl(p.type);case 16:return yl("Lazy");case 13:return yl("Suspense");case 19:return yl("SuspenseList");case 0:case 15:return tg(p.type,!1);case 11:return tg(p.type.render,!1);case 1:return tg(p.type,!0);case 31:return yl("Activity");default:return""}}function yb(p){try{var g="";do g+=Dr(p),p=p.return;while(p);return g}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}function Va(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function bb(p){var g=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function As(p){var g=bb(p)?"checked":"value",_=Object.getOwnPropertyDescriptor(p.constructor.prototype,g),E=""+p[g];if(!p.hasOwnProperty(g)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var j=_.get,q=_.set;return Object.defineProperty(p,g,{configurable:!0,get:function(){return j.call(this)},set:function(ue){E=""+ue,q.call(this,ue)}}),Object.defineProperty(p,g,{enumerable:_.enumerable}),{getValue:function(){return E},setValue:function(ue){E=""+ue},stopTracking:function(){p._valueTracker=null,delete p[g]}}}}function Fc(p){p._valueTracker||(p._valueTracker=As(p))}function df(p){if(!p)return!1;var g=p._valueTracker;if(!g)return!0;var _=g.getValue(),E="";return p&&(E=bb(p)?p.checked?"true":"false":p.value),p=E,p!==_?(g.setValue(p),!0):!1}function Jl(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var vb=/[\n"\\]/g;function Sa(p){return p.replace(vb,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function ff(p,g,_,E,j,q,ue,Re){p.name="",ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?p.type=ue:p.removeAttribute("type"),g!=null?ue==="number"?(g===0&&p.value===""||p.value!=g)&&(p.value=""+Va(g)):p.value!==""+Va(g)&&(p.value=""+Va(g)):ue!=="submit"&&ue!=="reset"||p.removeAttribute("value"),g!=null?hf(p,ue,Va(g)):_!=null?hf(p,ue,Va(_)):E!=null&&p.removeAttribute("value"),j==null&&q!=null&&(p.defaultChecked=!!q),j!=null&&(p.checked=j&&typeof j!="function"&&typeof j!="symbol"),Re!=null&&typeof Re!="function"&&typeof Re!="symbol"&&typeof Re!="boolean"?p.name=""+Va(Re):p.removeAttribute("name")}function xb(p,g,_,E,j,q,ue,Re){if(q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(p.type=q),g!=null||_!=null){if(!(q!=="submit"&&q!=="reset"||g!=null))return;_=_!=null?""+Va(_):"",g=g!=null?""+Va(g):_,Re||g===p.value||(p.value=g),p.defaultValue=g}E=E??j,E=typeof E!="function"&&typeof E!="symbol"&&!!E,p.checked=Re?p.checked:!!E,p.defaultChecked=!!E,ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"&&(p.name=ue)}function hf(p,g,_){g==="number"&&Jl(p.ownerDocument)===p||p.defaultValue===""+_||(p.defaultValue=""+_)}function Bu(p,g,_,E){if(p=p.options,g){g={};for(var j=0;j<_.length;j++)g["$"+_[j]]=!0;for(_=0;_<p.length;_++)j=g.hasOwnProperty("$"+p[_].value),p[_].selected!==j&&(p[_].selected=j),j&&E&&(p[_].defaultSelected=!0)}else{for(_=""+Va(_),g=null,j=0;j<p.length;j++){if(p[j].value===_){p[j].selected=!0,E&&(p[j].defaultSelected=!0);return}g!==null||p[j].disabled||(g=p[j])}g!==null&&(g.selected=!0)}}function pf(p,g,_){if(g!=null&&(g=""+Va(g),g!==p.value&&(p.value=g),_==null)){p.defaultValue!==g&&(p.defaultValue=g);return}p.defaultValue=_!=null?""+Va(_):""}function wb(p,g,_,E){if(g==null){if(E!=null){if(_!=null)throw Error(r(92));if(X(E)){if(1<E.length)throw Error(r(93));E=E[0]}_=E}_==null&&(_=""),g=_}_=Va(g),p.defaultValue=_,E=p.textContent,E===_&&E!==""&&E!==null&&(p.value=E)}function mf(p,g){if(g){var _=p.firstChild;if(_&&_===p.lastChild&&_.nodeType===3){_.nodeValue=g;return}}p.textContent=g}var Hr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ng(p,g,_){var E=g.indexOf("--")===0;_==null||typeof _=="boolean"||_===""?E?p.setProperty(g,""):g==="float"?p.cssFloat="":p[g]="":E?p.setProperty(g,_):typeof _!="number"||_===0||Hr.has(g)?g==="float"?p.cssFloat=_:p[g]=(""+_).trim():p[g]=_+"px"}function d_(p,g,_){if(g!=null&&typeof g!="object")throw Error(r(62));if(p=p.style,_!=null){for(var E in _)!_.hasOwnProperty(E)||g!=null&&g.hasOwnProperty(E)||(E.indexOf("--")===0?p.setProperty(E,""):E==="float"?p.cssFloat="":p[E]="");for(var j in g)E=g[j],g.hasOwnProperty(j)&&_[j]!==E&&ng(p,j,E)}else for(var q in g)g.hasOwnProperty(q)&&ng(p,q,g[q])}function _b(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wa=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),gf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $u(p){return gf.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}var bl=null;function rg(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var zu=null,Ds=null;function Uo(p){var g=Ar(p);if(g&&(p=g.stateNode)){var _=p[Pe]||null;e:switch(p=g.stateNode,g.type){case"input":if(ff(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name),g=_.name,_.type==="radio"&&g!=null){for(_=p;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll('input[name="'+Sa(""+g)+'"][type="radio"]'),g=0;g<_.length;g++){var E=_[g];if(E!==p&&E.form===p.form){var j=E[Pe]||null;if(!j)throw Error(r(90));ff(E,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(g=0;g<_.length;g++)E=_[g],E.form===p.form&&df(E)}break e;case"textarea":pf(p,_.value,_.defaultValue);break e;case"select":g=_.value,g!=null&&Bu(p,!!_.multiple,g,!1)}}}var Uu=!1;function yf(p,g,_){if(Uu)return p(g,_);Uu=!0;try{var E=p(g);return E}finally{if(Uu=!1,(zu!==null||Ds!==null)&&(Q_(),zu&&(g=zu,p=Ds,Ds=zu=null,Uo(g),p)))for(g=0;g<p.length;g++)Uo(p[g])}}function qu(p,g){var _=p.stateNode;if(_===null)return null;var E=_[Pe]||null;if(E===null)return null;_=E[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(p=p.type,E=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!E;break e;default:p=!1}if(p)return null;if(_&&typeof _!="function")throw Error(r(231,g,typeof _));return _}var Hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sb=!1;if(Hi)try{var Ca={};Object.defineProperty(Ca,"passive",{get:function(){Sb=!0}}),window.addEventListener("test",Ca,Ca),window.removeEventListener("test",Ca,Ca)}catch{Sb=!1}var vl=null,sg=null,bf=null;function vf(){if(bf)return bf;var p,g=sg,_=g.length,E,j="value"in vl?vl.value:vl.textContent,q=j.length;for(p=0;p<_&&g[p]===j[p];p++);var ue=_-p;for(E=1;E<=ue&&g[_-E]===j[q-E];E++);return bf=j.slice(p,1<E?1-E:void 0)}function xf(p){var g=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&g===13&&(p=13)):p=g,p===10&&(p=13),32<=p||p===13?p:0}function rp(){return!0}function f_(){return!1}function xi(p){function g(_,E,j,q,ue){this._reactName=_,this._targetInst=j,this.type=E,this.nativeEvent=q,this.target=ue,this.currentTarget=null;for(var Re in p)p.hasOwnProperty(Re)&&(_=p[Re],this[Re]=_?_(q):q[Re]);return this.isDefaultPrevented=(q.defaultPrevented!=null?q.defaultPrevented:q.returnValue===!1)?rp:f_,this.isPropagationStopped=f_,this}return u(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=rp)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=rp)},persist:function(){},isPersistent:rp}),g}var Vu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ig=xi(Vu),Lc=u({},Vu,{view:0,detail:0}),ag=xi(Lc),sp,Cb,ip,og=u({},Lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wu,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==ip&&(ip&&p.type==="mousemove"?(sp=p.screenX-ip.screenX,Cb=p.screenY-ip.screenY):Cb=sp=0,ip=p),sp)},movementY:function(p){return"movementY"in p?p.movementY:Cb}}),lg=xi(og),kb=u({},og,{dataTransfer:0}),h_=xi(kb),cg=u({},Lc,{relatedTarget:0}),wf=xi(cg),ug=u({},Vu,{animationName:0,elapsedTime:0,pseudoElement:0}),p_=xi(ug),gA=u({},Vu,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),dg=xi(gA),Eb=u({},Vu,{data:0}),fg=xi(Eb),Tb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ab={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ap(p){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(p):(p=Gi[p])?!!g[p]:!1}function Wu(){return ap}var m_=u({},Lc,{key:function(p){if(p.key){var g=Tb[p.key]||p.key;if(g!=="Unidentified")return g}return p.type==="keypress"?(p=xf(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?Ab[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wu,charCode:function(p){return p.type==="keypress"?xf(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?xf(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),hg=xi(m_),g_=u({},og,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rb=xi(g_),pg=u({},Lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wu}),Nb=xi(pg),Hu=u({},Vu,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mb=xi(Hu),Ib=u({},og,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),mg=xi(Ib),jb=u({},Vu,{newState:0,oldState:0}),y_=xi(jb),yA=[9,13,27,32],op=Hi&&"CompositionEvent"in window,Bc=null;Hi&&"documentMode"in document&&(Bc=document.documentMode);var bA=Hi&&"TextEvent"in window&&!Bc,gg=Hi&&(!op||Bc&&8<Bc&&11>=Bc),yg=" ",b_=!1;function Ob(p,g){switch(p){case"keyup":return yA.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function v_(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var Gu=!1;function x_(p,g){switch(p){case"compositionend":return v_(g);case"keypress":return g.which!==32?null:(b_=!0,yg);case"textInput":return p=g.data,p===yg&&b_?null:p;default:return null}}function vA(p,g){if(Gu)return p==="compositionend"||!op&&Ob(p,g)?(p=vf(),bf=sg=vl=null,Gu=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return gg&&g.locale!=="ko"?null:g.data;default:return null}}var w_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bg(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g==="input"?!!w_[p.type]:g==="textarea"}function Pb(p,g,_,E){zu?Ds?Ds.push(E):Ds=[E]:zu=E,g=iS(g,"onChange"),0<g.length&&(_=new ig("onChange","change",null,_,E),p.push({event:_,listeners:g}))}var _f=null,lp=null;function xA(p){bL(p,0)}function vg(p){var g=ns(p);if(df(g))return p}function cp(p,g){if(p==="change")return g}var xl=!1;if(Hi){var Fs;if(Hi){var Sf="oninput"in document;if(!Sf){var Ha=document.createElement("div");Ha.setAttribute("oninput","return;"),Sf=typeof Ha.oninput=="function"}Fs=Sf}else Fs=!1;xl=Fs&&(!document.documentMode||9<document.documentMode)}function __(){_f&&(_f.detachEvent("onpropertychange",xg),lp=_f=null)}function xg(p){if(p.propertyName==="value"&&vg(lp)){var g=[];Pb(g,lp,p,rg(p)),yf(xA,g)}}function S_(p,g,_){p==="focusin"?(__(),_f=g,lp=_,_f.attachEvent("onpropertychange",xg)):p==="focusout"&&__()}function Ku(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return vg(lp)}function Db(p,g){if(p==="click")return vg(g)}function Cf(p,g){if(p==="input"||p==="change")return vg(g)}function $c(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var ka=typeof Object.is=="function"?Object.is:$c;function M(p,g){if(ka(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var _=Object.keys(p),E=Object.keys(g);if(_.length!==E.length)return!1;for(E=0;E<_.length;E++){var j=_[E];if(!Ve.call(g,j)||!ka(p[j],g[j]))return!1}return!0}function z(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function te(p,g){var _=z(p);p=0;for(var E;_;){if(_.nodeType===3){if(E=p+_.textContent.length,p<=g&&E>=g)return{node:_,offset:g-p};p=E}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=z(_)}}function ae(p,g){return p&&g?p===g?!0:p&&p.nodeType===3?!1:g&&g.nodeType===3?ae(p,g.parentNode):"contains"in p?p.contains(g):p.compareDocumentPosition?!!(p.compareDocumentPosition(g)&16):!1:!1}function he(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var g=Jl(p.document);g instanceof p.HTMLIFrameElement;){try{var _=typeof g.contentWindow.location.href=="string"}catch{_=!1}if(_)p=g.contentWindow;else break;g=Jl(p.document)}return g}function Ee(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g&&(g==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||g==="textarea"||p.contentEditable==="true")}var Le=Hi&&"documentMode"in document&&11>=document.documentMode,He=null,nt=null,it=null,dt=!1;function Je(p,g,_){var E=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;dt||He==null||He!==Jl(E)||(E=He,"selectionStart"in E&&Ee(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),it&&M(it,E)||(it=E,E=iS(nt,"onSelect"),0<E.length&&(g=new ig("onSelect","select",null,g,_),p.push({event:g,listeners:E}),g.target=He)))}function pt(p,g){var _={};return _[p.toLowerCase()]=g.toLowerCase(),_["Webkit"+p]="webkit"+g,_["Moz"+p]="moz"+g,_}var tt={animationend:pt("Animation","AnimationEnd"),animationiteration:pt("Animation","AnimationIteration"),animationstart:pt("Animation","AnimationStart"),transitionrun:pt("Transition","TransitionRun"),transitionstart:pt("Transition","TransitionStart"),transitioncancel:pt("Transition","TransitionCancel"),transitionend:pt("Transition","TransitionEnd")},ut={},mt={};Hi&&(mt=document.createElement("div").style,"AnimationEvent"in window||(delete tt.animationend.animation,delete tt.animationiteration.animation,delete tt.animationstart.animation),"TransitionEvent"in window||delete tt.transitionend.transition);function at(p){if(ut[p])return ut[p];if(!tt[p])return p;var g=tt[p],_;for(_ in g)if(g.hasOwnProperty(_)&&_ in mt)return ut[p]=g[_];return p}var St=at("animationend"),Nt=at("animationiteration"),Mt=at("animationstart"),Ot=at("transitionrun"),Yt=at("transitionstart"),rn=at("transitioncancel"),Ht=at("transitionend"),Jt=new Map,an="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");an.push("scrollEnd");function Gt(p,g){Jt.set(p,g),Vt(g,[p])}var mn=new WeakMap;function Ln(p,g){if(typeof p=="object"&&p!==null){var _=mn.get(p);return _!==void 0?_:(g={value:p,source:g,stack:yb(g)},mn.set(p,g),g)}return{value:p,source:g,stack:yb(g)}}var Vn=[],fr=0,ua=0;function rr(){for(var p=fr,g=ua=fr=0;g<p;){var _=Vn[g];Vn[g++]=null;var E=Vn[g];Vn[g++]=null;var j=Vn[g];Vn[g++]=null;var q=Vn[g];if(Vn[g++]=null,E!==null&&j!==null){var ue=E.pending;ue===null?j.next=j:(j.next=ue.next,ue.next=j),E.pending=j}q!==0&&Ki(_,j,q)}}function ci(p,g,_,E){Vn[fr++]=p,Vn[fr++]=g,Vn[fr++]=_,Vn[fr++]=E,ua|=E,p.lanes|=E,p=p.alternate,p!==null&&(p.lanes|=E)}function wi(p,g,_,E){return ci(p,g,_,E),wl(p)}function Ql(p,g){return ci(p,null,null,g),wl(p)}function Ki(p,g,_){p.lanes|=_;var E=p.alternate;E!==null&&(E.lanes|=_);for(var j=!1,q=p.return;q!==null;)q.childLanes|=_,E=q.alternate,E!==null&&(E.childLanes|=_),q.tag===22&&(p=q.stateNode,p===null||p._visibility&1||(j=!0)),p=q,q=q.return;return p.tag===3?(q=p.stateNode,j&&g!==null&&(j=31-en(_),p=q.hiddenUpdates,E=p[j],E===null?p[j]=[g]:E.push(g),g.lane=_|536870912),q):null}function wl(p){if(50<ov)throw ov=0,ER=null,Error(r(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}var zc={};function Ide(p,g,_,E){this.tag=p,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qo(p,g,_,E){return new Ide(p,g,_,E)}function wA(p){return p=p.prototype,!(!p||!p.isReactComponent)}function Yu(p,g){var _=p.alternate;return _===null?(_=qo(p.tag,g,p.key,p.mode),_.elementType=p.elementType,_.type=p.type,_.stateNode=p.stateNode,_.alternate=p,p.alternate=_):(_.pendingProps=g,_.type=p.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=p.flags&65011712,_.childLanes=p.childLanes,_.lanes=p.lanes,_.child=p.child,_.memoizedProps=p.memoizedProps,_.memoizedState=p.memoizedState,_.updateQueue=p.updateQueue,g=p.dependencies,_.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},_.sibling=p.sibling,_.index=p.index,_.ref=p.ref,_.refCleanup=p.refCleanup,_}function rF(p,g){p.flags&=65011714;var _=p.alternate;return _===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=_.childLanes,p.lanes=_.lanes,p.child=_.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=_.memoizedProps,p.memoizedState=_.memoizedState,p.updateQueue=_.updateQueue,p.type=_.type,g=_.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function C_(p,g,_,E,j,q){var ue=0;if(E=p,typeof p=="function")wA(p)&&(ue=1);else if(typeof p=="string")ue=Ofe(p,_,pe.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case I:return p=qo(31,_,g,j),p.elementType=I,p.lanes=q,p;case y:return up(_.children,j,q,g);case b:ue=8,j|=24;break;case v:return p=qo(12,_,g,j|2),p.elementType=v,p.lanes=q,p;case k:return p=qo(13,_,g,j),p.elementType=k,p.lanes=q,p;case A:return p=qo(19,_,g,j),p.elementType=A,p.lanes=q,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case x:case S:ue=10;break e;case w:ue=9;break e;case C:ue=11;break e;case R:ue=14;break e;case N:ue=16,E=null;break e}ue=29,_=Error(r(130,p===null?"null":typeof p,"")),E=null}return g=qo(ue,_,g,j),g.elementType=p,g.type=E,g.lanes=q,g}function up(p,g,_,E){return p=qo(7,p,E,g),p.lanes=_,p}function _A(p,g,_){return p=qo(6,p,null,g),p.lanes=_,p}function SA(p,g,_){return g=qo(4,p.children!==null?p.children:[],p.key,g),g.lanes=_,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}var wg=[],_g=0,k_=null,E_=0,_l=[],Sl=0,dp=null,Zu=1,Xu="";function fp(p,g){wg[_g++]=E_,wg[_g++]=k_,k_=p,E_=g}function sF(p,g,_){_l[Sl++]=Zu,_l[Sl++]=Xu,_l[Sl++]=dp,dp=p;var E=Zu;p=Xu;var j=32-en(E)-1;E&=~(1<<j),_+=1;var q=32-en(g)+j;if(30<q){var ue=j-j%5;q=(E&(1<<ue)-1).toString(32),E>>=ue,j-=ue,Zu=1<<32-en(g)+j|_<<j|E,Xu=q+p}else Zu=1<<q|_<<j|E,Xu=p}function CA(p){p.return!==null&&(fp(p,1),sF(p,1,0))}function kA(p){for(;p===k_;)k_=wg[--_g],wg[_g]=null,E_=wg[--_g],wg[_g]=null;for(;p===dp;)dp=_l[--Sl],_l[Sl]=null,Xu=_l[--Sl],_l[Sl]=null,Zu=_l[--Sl],_l[Sl]=null}var Ga=null,ri=null,ss=!1,hp=null,Uc=!1,EA=Error(r(519));function pp(p){var g=Error(r(418,""));throw Bb(Ln(g,p)),EA}function iF(p){var g=p.stateNode,_=p.type,E=p.memoizedProps;switch(g[be]=p,g[Pe]=E,_){case"dialog":Lr("cancel",g),Lr("close",g);break;case"iframe":case"object":case"embed":Lr("load",g);break;case"video":case"audio":for(_=0;_<cv.length;_++)Lr(cv[_],g);break;case"source":Lr("error",g);break;case"img":case"image":case"link":Lr("error",g),Lr("load",g);break;case"details":Lr("toggle",g);break;case"input":Lr("invalid",g),xb(g,E.value,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name,!0),Fc(g);break;case"select":Lr("invalid",g);break;case"textarea":Lr("invalid",g),wb(g,E.value,E.defaultValue,E.children),Fc(g)}_=E.children,typeof _!="string"&&typeof _!="number"&&typeof _!="bigint"||g.textContent===""+_||E.suppressHydrationWarning===!0||_L(g.textContent,_)?(E.popover!=null&&(Lr("beforetoggle",g),Lr("toggle",g)),E.onScroll!=null&&Lr("scroll",g),E.onScrollEnd!=null&&Lr("scrollend",g),E.onClick!=null&&(g.onclick=aS),g=!0):g=!1,g||pp(p)}function aF(p){for(Ga=p.return;Ga;)switch(Ga.tag){case 5:case 13:Uc=!1;return;case 27:case 3:Uc=!0;return;default:Ga=Ga.return}}function Fb(p){if(p!==Ga)return!1;if(!ss)return aF(p),ss=!0,!1;var g=p.tag,_;if((_=g!==3&&g!==27)&&((_=g===5)&&(_=p.type,_=!(_!=="form"&&_!=="button")||UR(p.type,p.memoizedProps)),_=!_),_&&ri&&pp(p),aF(p),g===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));e:{for(p=p.nextSibling,g=0;p;){if(p.nodeType===8)if(_=p.data,_==="/$"){if(g===0){ri=tc(p.nextSibling);break e}g--}else _!=="$"&&_!=="$!"&&_!=="$?"||g++;p=p.nextSibling}ri=null}}else g===27?(g=ri,$f(p.type)?(p=HR,HR=null,ri=p):ri=g):ri=Ga?tc(p.stateNode.nextSibling):null;return!0}function Lb(){ri=Ga=null,ss=!1}function oF(){var p=hp;return p!==null&&(mo===null?mo=p:mo.push.apply(mo,p),hp=null),p}function Bb(p){hp===null?hp=[p]:hp.push(p)}var TA=Q(null),mp=null,Ju=null;function kf(p,g,_){se(TA,g._currentValue),g._currentValue=_}function Qu(p){p._currentValue=TA.current,ee(TA)}function AA(p,g,_){for(;p!==null;){var E=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,E!==null&&(E.childLanes|=g)):E!==null&&(E.childLanes&g)!==g&&(E.childLanes|=g),p===_)break;p=p.return}}function RA(p,g,_,E){var j=p.child;for(j!==null&&(j.return=p);j!==null;){var q=j.dependencies;if(q!==null){var ue=j.child;q=q.firstContext;e:for(;q!==null;){var Re=q;q=j;for(var Ye=0;Ye<g.length;Ye++)if(Re.context===g[Ye]){q.lanes|=_,Re=q.alternate,Re!==null&&(Re.lanes|=_),AA(q.return,_,p),E||(ue=null);break e}q=Re.next}}else if(j.tag===18){if(ue=j.return,ue===null)throw Error(r(341));ue.lanes|=_,q=ue.alternate,q!==null&&(q.lanes|=_),AA(ue,_,p),ue=null}else ue=j.child;if(ue!==null)ue.return=j;else for(ue=j;ue!==null;){if(ue===p){ue=null;break}if(j=ue.sibling,j!==null){j.return=ue.return,ue=j;break}ue=ue.return}j=ue}}function $b(p,g,_,E){p=null;for(var j=g,q=!1;j!==null;){if(!q){if((j.flags&524288)!==0)q=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var ue=j.alternate;if(ue===null)throw Error(r(387));if(ue=ue.memoizedProps,ue!==null){var Re=j.type;ka(j.pendingProps.value,ue.value)||(p!==null?p.push(Re):p=[Re])}}else if(j===De.current){if(ue=j.alternate,ue===null)throw Error(r(387));ue.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(p!==null?p.push(mv):p=[mv])}j=j.return}p!==null&&RA(g,p,_,E),g.flags|=262144}function T_(p){for(p=p.firstContext;p!==null;){if(!ka(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function gp(p){mp=p,Ju=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Ea(p){return lF(mp,p)}function A_(p,g){return mp===null&&gp(p),lF(p,g)}function lF(p,g){var _=g._currentValue;if(g={context:g,memoizedValue:_,next:null},Ju===null){if(p===null)throw Error(r(308));Ju=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else Ju=Ju.next=g;return _}var jde=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(_,E){p.push(E)}};this.abort=function(){g.aborted=!0,p.forEach(function(_){return _()})}},Ode=e.unstable_scheduleCallback,Pde=e.unstable_NormalPriority,ji={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function NA(){return{controller:new jde,data:new Map,refCount:0}}function zb(p){p.refCount--,p.refCount===0&&Ode(Pde,function(){p.controller.abort()})}var Ub=null,MA=0,Sg=0,Cg=null;function Dde(p,g){if(Ub===null){var _=Ub=[];MA=0,Sg=jR(),Cg={status:"pending",value:void 0,then:function(E){_.push(E)}}}return MA++,g.then(cF,cF),g}function cF(){if(--MA===0&&Ub!==null){Cg!==null&&(Cg.status="fulfilled");var p=Ub;Ub=null,Sg=0,Cg=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function Fde(p,g){var _=[],E={status:"pending",value:null,reason:null,then:function(j){_.push(j)}};return p.then(function(){E.status="fulfilled",E.value=g;for(var j=0;j<_.length;j++)(0,_[j])(g)},function(j){for(E.status="rejected",E.reason=j,j=0;j<_.length;j++)(0,_[j])(void 0)}),E}var uF=U.S;U.S=function(p,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&Dde(p,g),uF!==null&&uF(p,g)};var yp=Q(null);function IA(){var p=yp.current;return p!==null?p:js.pooledCache}function R_(p,g){g===null?se(yp,yp.current):se(yp,g.pool)}function dF(){var p=IA();return p===null?null:{parent:ji._currentValue,pool:p}}var qb=Error(r(460)),fF=Error(r(474)),N_=Error(r(542)),jA={then:function(){}};function hF(p){return p=p.status,p==="fulfilled"||p==="rejected"}function M_(){}function pF(p,g,_){switch(_=p[_],_===void 0?p.push(g):_!==g&&(g.then(M_,M_),g=_),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,gF(p),p;default:if(typeof g.status=="string")g.then(M_,M_);else{if(p=js,p!==null&&100<p.shellSuspendCounter)throw Error(r(482));p=g,p.status="pending",p.then(function(E){if(g.status==="pending"){var j=g;j.status="fulfilled",j.value=E}},function(E){if(g.status==="pending"){var j=g;j.status="rejected",j.reason=E}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,gF(p),p}throw Vb=g,qb}}var Vb=null;function mF(){if(Vb===null)throw Error(r(459));var p=Vb;return Vb=null,p}function gF(p){if(p===qb||p===N_)throw Error(r(483))}var Ef=!1;function OA(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function PA(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function Tf(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function Af(p,g,_){var E=p.updateQueue;if(E===null)return null;if(E=E.shared,(ms&2)!==0){var j=E.pending;return j===null?g.next=g:(g.next=j.next,j.next=g),E.pending=g,g=wl(p),Ki(p,null,_),g}return ci(p,E,g,_),wl(p)}function Wb(p,g,_){if(g=g.updateQueue,g!==null&&(g=g.shared,(_&4194048)!==0)){var E=g.lanes;E&=p.pendingLanes,_|=E,g.lanes=_,Ue(p,_)}}function DA(p,g){var _=p.updateQueue,E=p.alternate;if(E!==null&&(E=E.updateQueue,_===E)){var j=null,q=null;if(_=_.firstBaseUpdate,_!==null){do{var ue={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};q===null?j=q=ue:q=q.next=ue,_=_.next}while(_!==null);q===null?j=q=g:q=q.next=g}else j=q=g;_={baseState:E.baseState,firstBaseUpdate:j,lastBaseUpdate:q,shared:E.shared,callbacks:E.callbacks},p.updateQueue=_;return}p=_.lastBaseUpdate,p===null?_.firstBaseUpdate=g:p.next=g,_.lastBaseUpdate=g}var FA=!1;function Hb(){if(FA){var p=Cg;if(p!==null)throw p}}function Gb(p,g,_,E){FA=!1;var j=p.updateQueue;Ef=!1;var q=j.firstBaseUpdate,ue=j.lastBaseUpdate,Re=j.shared.pending;if(Re!==null){j.shared.pending=null;var Ye=Re,wt=Ye.next;Ye.next=null,ue===null?q=wt:ue.next=wt,ue=Ye;var Pt=p.alternate;Pt!==null&&(Pt=Pt.updateQueue,Re=Pt.lastBaseUpdate,Re!==ue&&(Re===null?Pt.firstBaseUpdate=wt:Re.next=wt,Pt.lastBaseUpdate=Ye))}if(q!==null){var Bt=j.baseState;ue=0,Pt=wt=Ye=null,Re=q;do{var Ct=Re.lane&-536870913,At=Ct!==Re.lane;if(At?(Gr&Ct)===Ct:(E&Ct)===Ct){Ct!==0&&Ct===Sg&&(FA=!0),Pt!==null&&(Pt=Pt.next={lane:0,tag:Re.tag,payload:Re.payload,callback:null,next:null});e:{var sr=p,Wn=Re;Ct=g;var _s=_;switch(Wn.tag){case 1:if(sr=Wn.payload,typeof sr=="function"){Bt=sr.call(_s,Bt,Ct);break e}Bt=sr;break e;case 3:sr.flags=sr.flags&-65537|128;case 0:if(sr=Wn.payload,Ct=typeof sr=="function"?sr.call(_s,Bt,Ct):sr,Ct==null)break e;Bt=u({},Bt,Ct);break e;case 2:Ef=!0}}Ct=Re.callback,Ct!==null&&(p.flags|=64,At&&(p.flags|=8192),At=j.callbacks,At===null?j.callbacks=[Ct]:At.push(Ct))}else At={lane:Ct,tag:Re.tag,payload:Re.payload,callback:Re.callback,next:null},Pt===null?(wt=Pt=At,Ye=Bt):Pt=Pt.next=At,ue|=Ct;if(Re=Re.next,Re===null){if(Re=j.shared.pending,Re===null)break;At=Re,Re=At.next,At.next=null,j.lastBaseUpdate=At,j.shared.pending=null}}while(!0);Pt===null&&(Ye=Bt),j.baseState=Ye,j.firstBaseUpdate=wt,j.lastBaseUpdate=Pt,q===null&&(j.shared.lanes=0),Df|=ue,p.lanes=ue,p.memoizedState=Bt}}function yF(p,g){if(typeof p!="function")throw Error(r(191,p));p.call(g)}function bF(p,g){var _=p.callbacks;if(_!==null)for(p.callbacks=null,p=0;p<_.length;p++)yF(_[p],g)}var kg=Q(null),I_=Q(0);function vF(p,g){p=ad,se(I_,p),se(kg,g),ad=p|g.baseLanes}function LA(){se(I_,ad),se(kg,kg.current)}function BA(){ad=I_.current,ee(kg),ee(I_)}var Rf=0,Mr=null,xs=null,_i=null,j_=!1,Eg=!1,bp=!1,O_=0,Kb=0,Tg=null,Lde=0;function ui(){throw Error(r(321))}function $A(p,g){if(g===null)return!1;for(var _=0;_<g.length&&_<p.length;_++)if(!ka(p[_],g[_]))return!1;return!0}function zA(p,g,_,E,j,q){return Rf=q,Mr=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,U.H=p===null||p.memoizedState===null?n8:r8,bp=!1,q=_(E,j),bp=!1,Eg&&(q=wF(g,_,E,j)),xF(p),q}function xF(p){U.H=$_;var g=xs!==null&&xs.next!==null;if(Rf=0,_i=xs=Mr=null,j_=!1,Kb=0,Tg=null,g)throw Error(r(300));p===null||Yi||(p=p.dependencies,p!==null&&T_(p)&&(Yi=!0))}function wF(p,g,_,E){Mr=p;var j=0;do{if(Eg&&(Tg=null),Kb=0,Eg=!1,25<=j)throw Error(r(301));if(j+=1,_i=xs=null,p.updateQueue!=null){var q=p.updateQueue;q.lastEffect=null,q.events=null,q.stores=null,q.memoCache!=null&&(q.memoCache.index=0)}U.H=Wde,q=g(_,E)}while(Eg);return q}function Bde(){var p=U.H,g=p.useState()[0];return g=typeof g.then=="function"?Yb(g):g,p=p.useState()[0],(xs!==null?xs.memoizedState:null)!==p&&(Mr.flags|=1024),g}function UA(){var p=O_!==0;return O_=0,p}function qA(p,g,_){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~_}function VA(p){if(j_){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}j_=!1}Rf=0,_i=xs=Mr=null,Eg=!1,Kb=O_=0,Tg=null}function ho(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _i===null?Mr.memoizedState=_i=p:_i=_i.next=p,_i}function Si(){if(xs===null){var p=Mr.alternate;p=p!==null?p.memoizedState:null}else p=xs.next;var g=_i===null?Mr.memoizedState:_i.next;if(g!==null)_i=g,xs=p;else{if(p===null)throw Mr.alternate===null?Error(r(467)):Error(r(310));xs=p,p={memoizedState:xs.memoizedState,baseState:xs.baseState,baseQueue:xs.baseQueue,queue:xs.queue,next:null},_i===null?Mr.memoizedState=_i=p:_i=_i.next=p}return _i}function WA(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yb(p){var g=Kb;return Kb+=1,Tg===null&&(Tg=[]),p=pF(Tg,p,g),g=Mr,(_i===null?g.memoizedState:_i.next)===null&&(g=g.alternate,U.H=g===null||g.memoizedState===null?n8:r8),p}function P_(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return Yb(p);if(p.$$typeof===S)return Ea(p)}throw Error(r(438,String(p)))}function HA(p){var g=null,_=Mr.updateQueue;if(_!==null&&(g=_.memoCache),g==null){var E=Mr.alternate;E!==null&&(E=E.updateQueue,E!==null&&(E=E.memoCache,E!=null&&(g={data:E.data.map(function(j){return j.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),_===null&&(_=WA(),Mr.updateQueue=_),_.memoCache=g,_=g.data[g.index],_===void 0)for(_=g.data[g.index]=Array(p),E=0;E<p;E++)_[E]=O;return g.index++,_}function ed(p,g){return typeof g=="function"?g(p):g}function D_(p){var g=Si();return GA(g,xs,p)}function GA(p,g,_){var E=p.queue;if(E===null)throw Error(r(311));E.lastRenderedReducer=_;var j=p.baseQueue,q=E.pending;if(q!==null){if(j!==null){var ue=j.next;j.next=q.next,q.next=ue}g.baseQueue=j=q,E.pending=null}if(q=p.baseState,j===null)p.memoizedState=q;else{g=j.next;var Re=ue=null,Ye=null,wt=g,Pt=!1;do{var Bt=wt.lane&-536870913;if(Bt!==wt.lane?(Gr&Bt)===Bt:(Rf&Bt)===Bt){var Ct=wt.revertLane;if(Ct===0)Ye!==null&&(Ye=Ye.next={lane:0,revertLane:0,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null}),Bt===Sg&&(Pt=!0);else if((Rf&Ct)===Ct){wt=wt.next,Ct===Sg&&(Pt=!0);continue}else Bt={lane:0,revertLane:wt.revertLane,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null},Ye===null?(Re=Ye=Bt,ue=q):Ye=Ye.next=Bt,Mr.lanes|=Ct,Df|=Ct;Bt=wt.action,bp&&_(q,Bt),q=wt.hasEagerState?wt.eagerState:_(q,Bt)}else Ct={lane:Bt,revertLane:wt.revertLane,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null},Ye===null?(Re=Ye=Ct,ue=q):Ye=Ye.next=Ct,Mr.lanes|=Bt,Df|=Bt;wt=wt.next}while(wt!==null&&wt!==g);if(Ye===null?ue=q:Ye.next=Re,!ka(q,p.memoizedState)&&(Yi=!0,Pt&&(_=Cg,_!==null)))throw _;p.memoizedState=q,p.baseState=ue,p.baseQueue=Ye,E.lastRenderedState=q}return j===null&&(E.lanes=0),[p.memoizedState,E.dispatch]}function KA(p){var g=Si(),_=g.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=p;var E=_.dispatch,j=_.pending,q=g.memoizedState;if(j!==null){_.pending=null;var ue=j=j.next;do q=p(q,ue.action),ue=ue.next;while(ue!==j);ka(q,g.memoizedState)||(Yi=!0),g.memoizedState=q,g.baseQueue===null&&(g.baseState=q),_.lastRenderedState=q}return[q,E]}function _F(p,g,_){var E=Mr,j=Si(),q=ss;if(q){if(_===void 0)throw Error(r(407));_=_()}else _=g();var ue=!ka((xs||j).memoizedState,_);ue&&(j.memoizedState=_,Yi=!0),j=j.queue;var Re=kF.bind(null,E,j,p);if(Zb(2048,8,Re,[p]),j.getSnapshot!==g||ue||_i!==null&&_i.memoizedState.tag&1){if(E.flags|=2048,Ag(9,F_(),CF.bind(null,E,j,_,g),null),js===null)throw Error(r(349));q||(Rf&124)!==0||SF(E,g,_)}return _}function SF(p,g,_){p.flags|=16384,p={getSnapshot:g,value:_},g=Mr.updateQueue,g===null?(g=WA(),Mr.updateQueue=g,g.stores=[p]):(_=g.stores,_===null?g.stores=[p]:_.push(p))}function CF(p,g,_,E){g.value=_,g.getSnapshot=E,EF(g)&&TF(p)}function kF(p,g,_){return _(function(){EF(g)&&TF(p)})}function EF(p){var g=p.getSnapshot;p=p.value;try{var _=g();return!ka(p,_)}catch{return!0}}function TF(p){var g=Ql(p,2);g!==null&&Ko(g,p,2)}function YA(p){var g=ho();if(typeof p=="function"){var _=p;if(p=_(),bp){Lt(!0);try{_()}finally{Lt(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ed,lastRenderedState:p},g}function AF(p,g,_,E){return p.baseState=_,GA(p,xs,typeof E=="function"?E:ed)}function $de(p,g,_,E,j){if(B_(p))throw Error(r(485));if(p=g.action,p!==null){var q={payload:j,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ue){q.listeners.push(ue)}};U.T!==null?_(!0):q.isTransition=!1,E(q),_=g.pending,_===null?(q.next=g.pending=q,RF(g,q)):(q.next=_.next,g.pending=_.next=q)}}function RF(p,g){var _=g.action,E=g.payload,j=p.state;if(g.isTransition){var q=U.T,ue={};U.T=ue;try{var Re=_(j,E),Ye=U.S;Ye!==null&&Ye(ue,Re),NF(p,g,Re)}catch(wt){ZA(p,g,wt)}finally{U.T=q}}else try{q=_(j,E),NF(p,g,q)}catch(wt){ZA(p,g,wt)}}function NF(p,g,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(E){MF(p,g,E)},function(E){return ZA(p,g,E)}):MF(p,g,_)}function MF(p,g,_){g.status="fulfilled",g.value=_,IF(g),p.state=_,g=p.pending,g!==null&&(_=g.next,_===g?p.pending=null:(_=_.next,g.next=_,RF(p,_)))}function ZA(p,g,_){var E=p.pending;if(p.pending=null,E!==null){E=E.next;do g.status="rejected",g.reason=_,IF(g),g=g.next;while(g!==E)}p.action=null}function IF(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function jF(p,g){return g}function OF(p,g){if(ss){var _=js.formState;if(_!==null){e:{var E=Mr;if(ss){if(ri){t:{for(var j=ri,q=Uc;j.nodeType!==8;){if(!q){j=null;break t}if(j=tc(j.nextSibling),j===null){j=null;break t}}q=j.data,j=q==="F!"||q==="F"?j:null}if(j){ri=tc(j.nextSibling),E=j.data==="F!";break e}}pp(E)}E=!1}E&&(g=_[0])}}return _=ho(),_.memoizedState=_.baseState=g,E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jF,lastRenderedState:g},_.queue=E,_=QF.bind(null,Mr,E),E.dispatch=_,E=YA(!1),q=tR.bind(null,Mr,!1,E.queue),E=ho(),j={state:g,dispatch:null,action:p,pending:null},E.queue=j,_=$de.bind(null,Mr,j,q,_),j.dispatch=_,E.memoizedState=p,[g,_,!1]}function PF(p){var g=Si();return DF(g,xs,p)}function DF(p,g,_){if(g=GA(p,g,jF)[0],p=D_(ed)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var E=Yb(g)}catch(ue){throw ue===qb?N_:ue}else E=g;g=Si();var j=g.queue,q=j.dispatch;return _!==g.memoizedState&&(Mr.flags|=2048,Ag(9,F_(),zde.bind(null,j,_),null)),[E,q,p]}function zde(p,g){p.action=g}function FF(p){var g=Si(),_=xs;if(_!==null)return DF(g,_,p);Si(),g=g.memoizedState,_=Si();var E=_.queue.dispatch;return _.memoizedState=p,[g,E,!1]}function Ag(p,g,_,E){return p={tag:p,create:_,deps:E,inst:g,next:null},g=Mr.updateQueue,g===null&&(g=WA(),Mr.updateQueue=g),_=g.lastEffect,_===null?g.lastEffect=p.next=p:(E=_.next,_.next=p,p.next=E,g.lastEffect=p),p}function F_(){return{destroy:void 0,resource:void 0}}function LF(){return Si().memoizedState}function L_(p,g,_,E){var j=ho();E=E===void 0?null:E,Mr.flags|=p,j.memoizedState=Ag(1|g,F_(),_,E)}function Zb(p,g,_,E){var j=Si();E=E===void 0?null:E;var q=j.memoizedState.inst;xs!==null&&E!==null&&$A(E,xs.memoizedState.deps)?j.memoizedState=Ag(g,q,_,E):(Mr.flags|=p,j.memoizedState=Ag(1|g,q,_,E))}function BF(p,g){L_(8390656,8,p,g)}function $F(p,g){Zb(2048,8,p,g)}function zF(p,g){return Zb(4,2,p,g)}function UF(p,g){return Zb(4,4,p,g)}function qF(p,g){if(typeof g=="function"){p=p();var _=g(p);return function(){typeof _=="function"?_():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function VF(p,g,_){_=_!=null?_.concat([p]):null,Zb(4,4,qF.bind(null,g,p),_)}function XA(){}function WF(p,g){var _=Si();g=g===void 0?null:g;var E=_.memoizedState;return g!==null&&$A(g,E[1])?E[0]:(_.memoizedState=[p,g],p)}function HF(p,g){var _=Si();g=g===void 0?null:g;var E=_.memoizedState;if(g!==null&&$A(g,E[1]))return E[0];if(E=p(),bp){Lt(!0);try{p()}finally{Lt(!1)}}return _.memoizedState=[E,g],E}function JA(p,g,_){return _===void 0||(Rf&1073741824)!==0?p.memoizedState=g:(p.memoizedState=_,p=Y8(),Mr.lanes|=p,Df|=p,_)}function GF(p,g,_,E){return ka(_,g)?_:kg.current!==null?(p=JA(p,_,E),ka(p,g)||(Yi=!0),p):(Rf&42)===0?(Yi=!0,p.memoizedState=_):(p=Y8(),Mr.lanes|=p,Df|=p,g)}function KF(p,g,_,E,j){var q=H.p;H.p=q!==0&&8>q?q:8;var ue=U.T,Re={};U.T=Re,tR(p,!1,g,_);try{var Ye=j(),wt=U.S;if(wt!==null&&wt(Re,Ye),Ye!==null&&typeof Ye=="object"&&typeof Ye.then=="function"){var Pt=Fde(Ye,E);Xb(p,g,Pt,Go(p))}else Xb(p,g,E,Go(p))}catch(Bt){Xb(p,g,{then:function(){},status:"rejected",reason:Bt},Go())}finally{H.p=q,U.T=ue}}function Ude(){}function QA(p,g,_,E){if(p.tag!==5)throw Error(r(476));var j=YF(p).queue;KF(p,j,g,$,_===null?Ude:function(){return ZF(p),_(E)})}function YF(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ed,lastRenderedState:$},next:null};var _={};return g.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ed,lastRenderedState:_},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function ZF(p){var g=YF(p).next.queue;Xb(p,g,{},Go())}function eR(){return Ea(mv)}function XF(){return Si().memoizedState}function JF(){return Si().memoizedState}function qde(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var _=Go();p=Tf(_);var E=Af(g,p,_);E!==null&&(Ko(E,g,_),Wb(E,g,_)),g={cache:NA()},p.payload=g;return}g=g.return}}function Vde(p,g,_){var E=Go();_={lane:E,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null},B_(p)?e8(g,_):(_=wi(p,g,_,E),_!==null&&(Ko(_,p,E),t8(_,g,E)))}function QF(p,g,_){var E=Go();Xb(p,g,_,E)}function Xb(p,g,_,E){var j={lane:E,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null};if(B_(p))e8(g,j);else{var q=p.alternate;if(p.lanes===0&&(q===null||q.lanes===0)&&(q=g.lastRenderedReducer,q!==null))try{var ue=g.lastRenderedState,Re=q(ue,_);if(j.hasEagerState=!0,j.eagerState=Re,ka(Re,ue))return ci(p,g,j,0),js===null&&rr(),!1}catch{}finally{}if(_=wi(p,g,j,E),_!==null)return Ko(_,p,E),t8(_,g,E),!0}return!1}function tR(p,g,_,E){if(E={lane:2,revertLane:jR(),action:E,hasEagerState:!1,eagerState:null,next:null},B_(p)){if(g)throw Error(r(479))}else g=wi(p,_,E,2),g!==null&&Ko(g,p,2)}function B_(p){var g=p.alternate;return p===Mr||g!==null&&g===Mr}function e8(p,g){Eg=j_=!0;var _=p.pending;_===null?g.next=g:(g.next=_.next,_.next=g),p.pending=g}function t8(p,g,_){if((_&4194048)!==0){var E=g.lanes;E&=p.pendingLanes,_|=E,g.lanes=_,Ue(p,_)}}var $_={readContext:Ea,use:P_,useCallback:ui,useContext:ui,useEffect:ui,useImperativeHandle:ui,useLayoutEffect:ui,useInsertionEffect:ui,useMemo:ui,useReducer:ui,useRef:ui,useState:ui,useDebugValue:ui,useDeferredValue:ui,useTransition:ui,useSyncExternalStore:ui,useId:ui,useHostTransitionStatus:ui,useFormState:ui,useActionState:ui,useOptimistic:ui,useMemoCache:ui,useCacheRefresh:ui},n8={readContext:Ea,use:P_,useCallback:function(p,g){return ho().memoizedState=[p,g===void 0?null:g],p},useContext:Ea,useEffect:BF,useImperativeHandle:function(p,g,_){_=_!=null?_.concat([p]):null,L_(4194308,4,qF.bind(null,g,p),_)},useLayoutEffect:function(p,g){return L_(4194308,4,p,g)},useInsertionEffect:function(p,g){L_(4,2,p,g)},useMemo:function(p,g){var _=ho();g=g===void 0?null:g;var E=p();if(bp){Lt(!0);try{p()}finally{Lt(!1)}}return _.memoizedState=[E,g],E},useReducer:function(p,g,_){var E=ho();if(_!==void 0){var j=_(g);if(bp){Lt(!0);try{_(g)}finally{Lt(!1)}}}else j=g;return E.memoizedState=E.baseState=j,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:j},E.queue=p,p=p.dispatch=Vde.bind(null,Mr,p),[E.memoizedState,p]},useRef:function(p){var g=ho();return p={current:p},g.memoizedState=p},useState:function(p){p=YA(p);var g=p.queue,_=QF.bind(null,Mr,g);return g.dispatch=_,[p.memoizedState,_]},useDebugValue:XA,useDeferredValue:function(p,g){var _=ho();return JA(_,p,g)},useTransition:function(){var p=YA(!1);return p=KF.bind(null,Mr,p.queue,!0,!1),ho().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,_){var E=Mr,j=ho();if(ss){if(_===void 0)throw Error(r(407));_=_()}else{if(_=g(),js===null)throw Error(r(349));(Gr&124)!==0||SF(E,g,_)}j.memoizedState=_;var q={value:_,getSnapshot:g};return j.queue=q,BF(kF.bind(null,E,q,p),[p]),E.flags|=2048,Ag(9,F_(),CF.bind(null,E,q,_,g),null),_},useId:function(){var p=ho(),g=js.identifierPrefix;if(ss){var _=Xu,E=Zu;_=(E&~(1<<32-en(E)-1)).toString(32)+_,g=""+g+"R"+_,_=O_++,0<_&&(g+="H"+_.toString(32)),g+=""}else _=Lde++,g=""+g+"r"+_.toString(32)+"";return p.memoizedState=g},useHostTransitionStatus:eR,useFormState:OF,useActionState:OF,useOptimistic:function(p){var g=ho();g.memoizedState=g.baseState=p;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=_,g=tR.bind(null,Mr,!0,_),_.dispatch=g,[p,g]},useMemoCache:HA,useCacheRefresh:function(){return ho().memoizedState=qde.bind(null,Mr)}},r8={readContext:Ea,use:P_,useCallback:WF,useContext:Ea,useEffect:$F,useImperativeHandle:VF,useInsertionEffect:zF,useLayoutEffect:UF,useMemo:HF,useReducer:D_,useRef:LF,useState:function(){return D_(ed)},useDebugValue:XA,useDeferredValue:function(p,g){var _=Si();return GF(_,xs.memoizedState,p,g)},useTransition:function(){var p=D_(ed)[0],g=Si().memoizedState;return[typeof p=="boolean"?p:Yb(p),g]},useSyncExternalStore:_F,useId:XF,useHostTransitionStatus:eR,useFormState:PF,useActionState:PF,useOptimistic:function(p,g){var _=Si();return AF(_,xs,p,g)},useMemoCache:HA,useCacheRefresh:JF},Wde={readContext:Ea,use:P_,useCallback:WF,useContext:Ea,useEffect:$F,useImperativeHandle:VF,useInsertionEffect:zF,useLayoutEffect:UF,useMemo:HF,useReducer:KA,useRef:LF,useState:function(){return KA(ed)},useDebugValue:XA,useDeferredValue:function(p,g){var _=Si();return xs===null?JA(_,p,g):GF(_,xs.memoizedState,p,g)},useTransition:function(){var p=KA(ed)[0],g=Si().memoizedState;return[typeof p=="boolean"?p:Yb(p),g]},useSyncExternalStore:_F,useId:XF,useHostTransitionStatus:eR,useFormState:FF,useActionState:FF,useOptimistic:function(p,g){var _=Si();return xs!==null?AF(_,xs,p,g):(_.baseState=p,[p,_.queue.dispatch])},useMemoCache:HA,useCacheRefresh:JF},Rg=null,Jb=0;function z_(p){var g=Jb;return Jb+=1,Rg===null&&(Rg=[]),pF(Rg,p,g)}function Qb(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function U_(p,g){throw g.$$typeof===d?Error(r(525)):(p=Object.prototype.toString.call(g),Error(r(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function s8(p){var g=p._init;return g(p._payload)}function i8(p){function g(ht,rt){if(p){var xt=ht.deletions;xt===null?(ht.deletions=[rt],ht.flags|=16):xt.push(rt)}}function _(ht,rt){if(!p)return null;for(;rt!==null;)g(ht,rt),rt=rt.sibling;return null}function E(ht){for(var rt=new Map;ht!==null;)ht.key!==null?rt.set(ht.key,ht):rt.set(ht.index,ht),ht=ht.sibling;return rt}function j(ht,rt){return ht=Yu(ht,rt),ht.index=0,ht.sibling=null,ht}function q(ht,rt,xt){return ht.index=xt,p?(xt=ht.alternate,xt!==null?(xt=xt.index,xt<rt?(ht.flags|=67108866,rt):xt):(ht.flags|=67108866,rt)):(ht.flags|=1048576,rt)}function ue(ht){return p&&ht.alternate===null&&(ht.flags|=67108866),ht}function Re(ht,rt,xt,Ft){return rt===null||rt.tag!==6?(rt=_A(xt,ht.mode,Ft),rt.return=ht,rt):(rt=j(rt,xt),rt.return=ht,rt)}function Ye(ht,rt,xt,Ft){var bn=xt.type;return bn===y?Pt(ht,rt,xt.props.children,Ft,xt.key):rt!==null&&(rt.elementType===bn||typeof bn=="object"&&bn!==null&&bn.$$typeof===N&&s8(bn)===rt.type)?(rt=j(rt,xt.props),Qb(rt,xt),rt.return=ht,rt):(rt=C_(xt.type,xt.key,xt.props,null,ht.mode,Ft),Qb(rt,xt),rt.return=ht,rt)}function wt(ht,rt,xt,Ft){return rt===null||rt.tag!==4||rt.stateNode.containerInfo!==xt.containerInfo||rt.stateNode.implementation!==xt.implementation?(rt=SA(xt,ht.mode,Ft),rt.return=ht,rt):(rt=j(rt,xt.children||[]),rt.return=ht,rt)}function Pt(ht,rt,xt,Ft,bn){return rt===null||rt.tag!==7?(rt=up(xt,ht.mode,Ft,bn),rt.return=ht,rt):(rt=j(rt,xt),rt.return=ht,rt)}function Bt(ht,rt,xt){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return rt=_A(""+rt,ht.mode,xt),rt.return=ht,rt;if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case h:return xt=C_(rt.type,rt.key,rt.props,null,ht.mode,xt),Qb(xt,rt),xt.return=ht,xt;case m:return rt=SA(rt,ht.mode,xt),rt.return=ht,rt;case N:var Ft=rt._init;return rt=Ft(rt._payload),Bt(ht,rt,xt)}if(X(rt)||P(rt))return rt=up(rt,ht.mode,xt,null),rt.return=ht,rt;if(typeof rt.then=="function")return Bt(ht,z_(rt),xt);if(rt.$$typeof===S)return Bt(ht,A_(ht,rt),xt);U_(ht,rt)}return null}function Ct(ht,rt,xt,Ft){var bn=rt!==null?rt.key:null;if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return bn!==null?null:Re(ht,rt,""+xt,Ft);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case h:return xt.key===bn?Ye(ht,rt,xt,Ft):null;case m:return xt.key===bn?wt(ht,rt,xt,Ft):null;case N:return bn=xt._init,xt=bn(xt._payload),Ct(ht,rt,xt,Ft)}if(X(xt)||P(xt))return bn!==null?null:Pt(ht,rt,xt,Ft,null);if(typeof xt.then=="function")return Ct(ht,rt,z_(xt),Ft);if(xt.$$typeof===S)return Ct(ht,rt,A_(ht,xt),Ft);U_(ht,xt)}return null}function At(ht,rt,xt,Ft,bn){if(typeof Ft=="string"&&Ft!==""||typeof Ft=="number"||typeof Ft=="bigint")return ht=ht.get(xt)||null,Re(rt,ht,""+Ft,bn);if(typeof Ft=="object"&&Ft!==null){switch(Ft.$$typeof){case h:return ht=ht.get(Ft.key===null?xt:Ft.key)||null,Ye(rt,ht,Ft,bn);case m:return ht=ht.get(Ft.key===null?xt:Ft.key)||null,wt(rt,ht,Ft,bn);case N:var Pr=Ft._init;return Ft=Pr(Ft._payload),At(ht,rt,xt,Ft,bn)}if(X(Ft)||P(Ft))return ht=ht.get(xt)||null,Pt(rt,ht,Ft,bn,null);if(typeof Ft.then=="function")return At(ht,rt,xt,z_(Ft),bn);if(Ft.$$typeof===S)return At(ht,rt,xt,A_(rt,Ft),bn);U_(rt,Ft)}return null}function sr(ht,rt,xt,Ft){for(var bn=null,Pr=null,In=rt,Kn=rt=0,Xi=null;In!==null&&Kn<xt.length;Kn++){In.index>Kn?(Xi=In,In=null):Xi=In.sibling;var ts=Ct(ht,In,xt[Kn],Ft);if(ts===null){In===null&&(In=Xi);break}p&&In&&ts.alternate===null&&g(ht,In),rt=q(ts,rt,Kn),Pr===null?bn=ts:Pr.sibling=ts,Pr=ts,In=Xi}if(Kn===xt.length)return _(ht,In),ss&&fp(ht,Kn),bn;if(In===null){for(;Kn<xt.length;Kn++)In=Bt(ht,xt[Kn],Ft),In!==null&&(rt=q(In,rt,Kn),Pr===null?bn=In:Pr.sibling=In,Pr=In);return ss&&fp(ht,Kn),bn}for(In=E(In);Kn<xt.length;Kn++)Xi=At(In,ht,Kn,xt[Kn],Ft),Xi!==null&&(p&&Xi.alternate!==null&&In.delete(Xi.key===null?Kn:Xi.key),rt=q(Xi,rt,Kn),Pr===null?bn=Xi:Pr.sibling=Xi,Pr=Xi);return p&&In.forEach(function(Wf){return g(ht,Wf)}),ss&&fp(ht,Kn),bn}function Wn(ht,rt,xt,Ft){if(xt==null)throw Error(r(151));for(var bn=null,Pr=null,In=rt,Kn=rt=0,Xi=null,ts=xt.next();In!==null&&!ts.done;Kn++,ts=xt.next()){In.index>Kn?(Xi=In,In=null):Xi=In.sibling;var Wf=Ct(ht,In,ts.value,Ft);if(Wf===null){In===null&&(In=Xi);break}p&&In&&Wf.alternate===null&&g(ht,In),rt=q(Wf,rt,Kn),Pr===null?bn=Wf:Pr.sibling=Wf,Pr=Wf,In=Xi}if(ts.done)return _(ht,In),ss&&fp(ht,Kn),bn;if(In===null){for(;!ts.done;Kn++,ts=xt.next())ts=Bt(ht,ts.value,Ft),ts!==null&&(rt=q(ts,rt,Kn),Pr===null?bn=ts:Pr.sibling=ts,Pr=ts);return ss&&fp(ht,Kn),bn}for(In=E(In);!ts.done;Kn++,ts=xt.next())ts=At(In,ht,Kn,ts.value,Ft),ts!==null&&(p&&ts.alternate!==null&&In.delete(ts.key===null?Kn:ts.key),rt=q(ts,rt,Kn),Pr===null?bn=ts:Pr.sibling=ts,Pr=ts);return p&&In.forEach(function(Hfe){return g(ht,Hfe)}),ss&&fp(ht,Kn),bn}function _s(ht,rt,xt,Ft){if(typeof xt=="object"&&xt!==null&&xt.type===y&&xt.key===null&&(xt=xt.props.children),typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case h:e:{for(var bn=xt.key;rt!==null;){if(rt.key===bn){if(bn=xt.type,bn===y){if(rt.tag===7){_(ht,rt.sibling),Ft=j(rt,xt.props.children),Ft.return=ht,ht=Ft;break e}}else if(rt.elementType===bn||typeof bn=="object"&&bn!==null&&bn.$$typeof===N&&s8(bn)===rt.type){_(ht,rt.sibling),Ft=j(rt,xt.props),Qb(Ft,xt),Ft.return=ht,ht=Ft;break e}_(ht,rt);break}else g(ht,rt);rt=rt.sibling}xt.type===y?(Ft=up(xt.props.children,ht.mode,Ft,xt.key),Ft.return=ht,ht=Ft):(Ft=C_(xt.type,xt.key,xt.props,null,ht.mode,Ft),Qb(Ft,xt),Ft.return=ht,ht=Ft)}return ue(ht);case m:e:{for(bn=xt.key;rt!==null;){if(rt.key===bn)if(rt.tag===4&&rt.stateNode.containerInfo===xt.containerInfo&&rt.stateNode.implementation===xt.implementation){_(ht,rt.sibling),Ft=j(rt,xt.children||[]),Ft.return=ht,ht=Ft;break e}else{_(ht,rt);break}else g(ht,rt);rt=rt.sibling}Ft=SA(xt,ht.mode,Ft),Ft.return=ht,ht=Ft}return ue(ht);case N:return bn=xt._init,xt=bn(xt._payload),_s(ht,rt,xt,Ft)}if(X(xt))return sr(ht,rt,xt,Ft);if(P(xt)){if(bn=P(xt),typeof bn!="function")throw Error(r(150));return xt=bn.call(xt),Wn(ht,rt,xt,Ft)}if(typeof xt.then=="function")return _s(ht,rt,z_(xt),Ft);if(xt.$$typeof===S)return _s(ht,rt,A_(ht,xt),Ft);U_(ht,xt)}return typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint"?(xt=""+xt,rt!==null&&rt.tag===6?(_(ht,rt.sibling),Ft=j(rt,xt),Ft.return=ht,ht=Ft):(_(ht,rt),Ft=_A(xt,ht.mode,Ft),Ft.return=ht,ht=Ft),ue(ht)):_(ht,rt)}return function(ht,rt,xt,Ft){try{Jb=0;var bn=_s(ht,rt,xt,Ft);return Rg=null,bn}catch(In){if(In===qb||In===N_)throw In;var Pr=qo(29,In,null,ht.mode);return Pr.lanes=Ft,Pr.return=ht,Pr}finally{}}}var Ng=i8(!0),a8=i8(!1),Cl=Q(null),qc=null;function Nf(p){var g=p.alternate;se(Oi,Oi.current&1),se(Cl,p),qc===null&&(g===null||kg.current!==null||g.memoizedState!==null)&&(qc=p)}function o8(p){if(p.tag===22){if(se(Oi,Oi.current),se(Cl,p),qc===null){var g=p.alternate;g!==null&&g.memoizedState!==null&&(qc=p)}}else Mf()}function Mf(){se(Oi,Oi.current),se(Cl,Cl.current)}function td(p){ee(Cl),qc===p&&(qc=null),ee(Oi)}var Oi=Q(0);function q_(p){for(var g=p;g!==null;){if(g.tag===13){var _=g.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||WR(_)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function nR(p,g,_,E){g=p.memoizedState,_=_(E,g),_=_==null?g:u({},g,_),p.memoizedState=_,p.lanes===0&&(p.updateQueue.baseState=_)}var rR={enqueueSetState:function(p,g,_){p=p._reactInternals;var E=Go(),j=Tf(E);j.payload=g,_!=null&&(j.callback=_),g=Af(p,j,E),g!==null&&(Ko(g,p,E),Wb(g,p,E))},enqueueReplaceState:function(p,g,_){p=p._reactInternals;var E=Go(),j=Tf(E);j.tag=1,j.payload=g,_!=null&&(j.callback=_),g=Af(p,j,E),g!==null&&(Ko(g,p,E),Wb(g,p,E))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var _=Go(),E=Tf(_);E.tag=2,g!=null&&(E.callback=g),g=Af(p,E,_),g!==null&&(Ko(g,p,_),Wb(g,p,_))}};function l8(p,g,_,E,j,q,ue){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(E,q,ue):g.prototype&&g.prototype.isPureReactComponent?!M(_,E)||!M(j,q):!0}function c8(p,g,_,E){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(_,E),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(_,E),g.state!==p&&rR.enqueueReplaceState(g,g.state,null)}function vp(p,g){var _=g;if("ref"in g){_={};for(var E in g)E!=="ref"&&(_[E]=g[E])}if(p=p.defaultProps){_===g&&(_=u({},_));for(var j in p)_[j]===void 0&&(_[j]=p[j])}return _}var V_=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof Ai=="object"&&typeof Ai.emit=="function"){Ai.emit("uncaughtException",p);return}console.error(p)};function u8(p){V_(p)}function d8(p){console.error(p)}function f8(p){V_(p)}function W_(p,g){try{var _=p.onUncaughtError;_(g.value,{componentStack:g.stack})}catch(E){setTimeout(function(){throw E})}}function h8(p,g,_){try{var E=p.onCaughtError;E(_.value,{componentStack:_.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function sR(p,g,_){return _=Tf(_),_.tag=3,_.payload={element:null},_.callback=function(){W_(p,g)},_}function p8(p){return p=Tf(p),p.tag=3,p}function m8(p,g,_,E){var j=_.type.getDerivedStateFromError;if(typeof j=="function"){var q=E.value;p.payload=function(){return j(q)},p.callback=function(){h8(g,_,E)}}var ue=_.stateNode;ue!==null&&typeof ue.componentDidCatch=="function"&&(p.callback=function(){h8(g,_,E),typeof j!="function"&&(Ff===null?Ff=new Set([this]):Ff.add(this));var Re=E.stack;this.componentDidCatch(E.value,{componentStack:Re!==null?Re:""})})}function Hde(p,g,_,E,j){if(_.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){if(g=_.alternate,g!==null&&$b(g,_,j,!0),_=Cl.current,_!==null){switch(_.tag){case 13:return qc===null?AR():_.alternate===null&&si===0&&(si=3),_.flags&=-257,_.flags|=65536,_.lanes=j,E===jA?_.flags|=16384:(g=_.updateQueue,g===null?_.updateQueue=new Set([E]):g.add(E),NR(p,E,j)),!1;case 22:return _.flags|=65536,E===jA?_.flags|=16384:(g=_.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([E])},_.updateQueue=g):(_=g.retryQueue,_===null?g.retryQueue=new Set([E]):_.add(E)),NR(p,E,j)),!1}throw Error(r(435,_.tag))}return NR(p,E,j),AR(),!1}if(ss)return g=Cl.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=j,E!==EA&&(p=Error(r(422),{cause:E}),Bb(Ln(p,_)))):(E!==EA&&(g=Error(r(423),{cause:E}),Bb(Ln(g,_))),p=p.current.alternate,p.flags|=65536,j&=-j,p.lanes|=j,E=Ln(E,_),j=sR(p.stateNode,E,j),DA(p,j),si!==4&&(si=2)),!1;var q=Error(r(520),{cause:E});if(q=Ln(q,_),av===null?av=[q]:av.push(q),si!==4&&(si=2),g===null)return!0;E=Ln(E,_),_=g;do{switch(_.tag){case 3:return _.flags|=65536,p=j&-j,_.lanes|=p,p=sR(_.stateNode,E,p),DA(_,p),!1;case 1:if(g=_.type,q=_.stateNode,(_.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(Ff===null||!Ff.has(q))))return _.flags|=65536,j&=-j,_.lanes|=j,j=p8(j),m8(j,p,_,E),DA(_,j),!1}_=_.return}while(_!==null);return!1}var g8=Error(r(461)),Yi=!1;function da(p,g,_,E){g.child=p===null?a8(g,null,_,E):Ng(g,p.child,_,E)}function y8(p,g,_,E,j){_=_.render;var q=g.ref;if("ref"in E){var ue={};for(var Re in E)Re!=="ref"&&(ue[Re]=E[Re])}else ue=E;return gp(g),E=zA(p,g,_,ue,q,j),Re=UA(),p!==null&&!Yi?(qA(p,g,j),nd(p,g,j)):(ss&&Re&&CA(g),g.flags|=1,da(p,g,E,j),g.child)}function b8(p,g,_,E,j){if(p===null){var q=_.type;return typeof q=="function"&&!wA(q)&&q.defaultProps===void 0&&_.compare===null?(g.tag=15,g.type=q,v8(p,g,q,E,j)):(p=C_(_.type,null,E,g,g.mode,j),p.ref=g.ref,p.return=g,g.child=p)}if(q=p.child,!fR(p,j)){var ue=q.memoizedProps;if(_=_.compare,_=_!==null?_:M,_(ue,E)&&p.ref===g.ref)return nd(p,g,j)}return g.flags|=1,p=Yu(q,E),p.ref=g.ref,p.return=g,g.child=p}function v8(p,g,_,E,j){if(p!==null){var q=p.memoizedProps;if(M(q,E)&&p.ref===g.ref)if(Yi=!1,g.pendingProps=E=q,fR(p,j))(p.flags&131072)!==0&&(Yi=!0);else return g.lanes=p.lanes,nd(p,g,j)}return iR(p,g,_,E,j)}function x8(p,g,_){var E=g.pendingProps,j=E.children,q=p!==null?p.memoizedState:null;if(E.mode==="hidden"){if((g.flags&128)!==0){if(E=q!==null?q.baseLanes|_:_,p!==null){for(j=g.child=p.child,q=0;j!==null;)q=q|j.lanes|j.childLanes,j=j.sibling;g.childLanes=q&~E}else g.childLanes=0,g.child=null;return w8(p,g,E,_)}if((_&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&R_(g,q!==null?q.cachePool:null),q!==null?vF(g,q):LA(),o8(g);else return g.lanes=g.childLanes=536870912,w8(p,g,q!==null?q.baseLanes|_:_,_)}else q!==null?(R_(g,q.cachePool),vF(g,q),Mf(),g.memoizedState=null):(p!==null&&R_(g,null),LA(),Mf());return da(p,g,j,_),g.child}function w8(p,g,_,E){var j=IA();return j=j===null?null:{parent:ji._currentValue,pool:j},g.memoizedState={baseLanes:_,cachePool:j},p!==null&&R_(g,null),LA(),o8(g),p!==null&&$b(p,g,E,!0),null}function H_(p,g){var _=g.ref;if(_===null)p!==null&&p.ref!==null&&(g.flags|=4194816);else{if(typeof _!="function"&&typeof _!="object")throw Error(r(284));(p===null||p.ref!==_)&&(g.flags|=4194816)}}function iR(p,g,_,E,j){return gp(g),_=zA(p,g,_,E,void 0,j),E=UA(),p!==null&&!Yi?(qA(p,g,j),nd(p,g,j)):(ss&&E&&CA(g),g.flags|=1,da(p,g,_,j),g.child)}function _8(p,g,_,E,j,q){return gp(g),g.updateQueue=null,_=wF(g,E,_,j),xF(p),E=UA(),p!==null&&!Yi?(qA(p,g,q),nd(p,g,q)):(ss&&E&&CA(g),g.flags|=1,da(p,g,_,q),g.child)}function S8(p,g,_,E,j){if(gp(g),g.stateNode===null){var q=zc,ue=_.contextType;typeof ue=="object"&&ue!==null&&(q=Ea(ue)),q=new _(E,q),g.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,q.updater=rR,g.stateNode=q,q._reactInternals=g,q=g.stateNode,q.props=E,q.state=g.memoizedState,q.refs={},OA(g),ue=_.contextType,q.context=typeof ue=="object"&&ue!==null?Ea(ue):zc,q.state=g.memoizedState,ue=_.getDerivedStateFromProps,typeof ue=="function"&&(nR(g,_,ue,E),q.state=g.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(ue=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),ue!==q.state&&rR.enqueueReplaceState(q,q.state,null),Gb(g,E,q,j),Hb(),q.state=g.memoizedState),typeof q.componentDidMount=="function"&&(g.flags|=4194308),E=!0}else if(p===null){q=g.stateNode;var Re=g.memoizedProps,Ye=vp(_,Re);q.props=Ye;var wt=q.context,Pt=_.contextType;ue=zc,typeof Pt=="object"&&Pt!==null&&(ue=Ea(Pt));var Bt=_.getDerivedStateFromProps;Pt=typeof Bt=="function"||typeof q.getSnapshotBeforeUpdate=="function",Re=g.pendingProps!==Re,Pt||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(Re||wt!==ue)&&c8(g,q,E,ue),Ef=!1;var Ct=g.memoizedState;q.state=Ct,Gb(g,E,q,j),Hb(),wt=g.memoizedState,Re||Ct!==wt||Ef?(typeof Bt=="function"&&(nR(g,_,Bt,E),wt=g.memoizedState),(Ye=Ef||l8(g,_,Ye,E,Ct,wt,ue))?(Pt||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount()),typeof q.componentDidMount=="function"&&(g.flags|=4194308)):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=E,g.memoizedState=wt),q.props=E,q.state=wt,q.context=ue,E=Ye):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),E=!1)}else{q=g.stateNode,PA(p,g),ue=g.memoizedProps,Pt=vp(_,ue),q.props=Pt,Bt=g.pendingProps,Ct=q.context,wt=_.contextType,Ye=zc,typeof wt=="object"&&wt!==null&&(Ye=Ea(wt)),Re=_.getDerivedStateFromProps,(wt=typeof Re=="function"||typeof q.getSnapshotBeforeUpdate=="function")||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(ue!==Bt||Ct!==Ye)&&c8(g,q,E,Ye),Ef=!1,Ct=g.memoizedState,q.state=Ct,Gb(g,E,q,j),Hb();var At=g.memoizedState;ue!==Bt||Ct!==At||Ef||p!==null&&p.dependencies!==null&&T_(p.dependencies)?(typeof Re=="function"&&(nR(g,_,Re,E),At=g.memoizedState),(Pt=Ef||l8(g,_,Pt,E,Ct,At,Ye)||p!==null&&p.dependencies!==null&&T_(p.dependencies))?(wt||typeof q.UNSAFE_componentWillUpdate!="function"&&typeof q.componentWillUpdate!="function"||(typeof q.componentWillUpdate=="function"&&q.componentWillUpdate(E,At,Ye),typeof q.UNSAFE_componentWillUpdate=="function"&&q.UNSAFE_componentWillUpdate(E,At,Ye)),typeof q.componentDidUpdate=="function"&&(g.flags|=4),typeof q.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof q.componentDidUpdate!="function"||ue===p.memoizedProps&&Ct===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||ue===p.memoizedProps&&Ct===p.memoizedState||(g.flags|=1024),g.memoizedProps=E,g.memoizedState=At),q.props=E,q.state=At,q.context=Ye,E=Pt):(typeof q.componentDidUpdate!="function"||ue===p.memoizedProps&&Ct===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||ue===p.memoizedProps&&Ct===p.memoizedState||(g.flags|=1024),E=!1)}return q=E,H_(p,g),E=(g.flags&128)!==0,q||E?(q=g.stateNode,_=E&&typeof _.getDerivedStateFromError!="function"?null:q.render(),g.flags|=1,p!==null&&E?(g.child=Ng(g,p.child,null,j),g.child=Ng(g,null,_,j)):da(p,g,_,j),g.memoizedState=q.state,p=g.child):p=nd(p,g,j),p}function C8(p,g,_,E){return Lb(),g.flags|=256,da(p,g,_,E),g.child}var aR={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function oR(p){return{baseLanes:p,cachePool:dF()}}function lR(p,g,_){return p=p!==null?p.childLanes&~_:0,g&&(p|=kl),p}function k8(p,g,_){var E=g.pendingProps,j=!1,q=(g.flags&128)!==0,ue;if((ue=q)||(ue=p!==null&&p.memoizedState===null?!1:(Oi.current&2)!==0),ue&&(j=!0,g.flags&=-129),ue=(g.flags&32)!==0,g.flags&=-33,p===null){if(ss){if(j?Nf(g):Mf(),ss){var Re=ri,Ye;if(Ye=Re){e:{for(Ye=Re,Re=Uc;Ye.nodeType!==8;){if(!Re){Re=null;break e}if(Ye=tc(Ye.nextSibling),Ye===null){Re=null;break e}}Re=Ye}Re!==null?(g.memoizedState={dehydrated:Re,treeContext:dp!==null?{id:Zu,overflow:Xu}:null,retryLane:536870912,hydrationErrors:null},Ye=qo(18,null,null,0),Ye.stateNode=Re,Ye.return=g,g.child=Ye,Ga=g,ri=null,Ye=!0):Ye=!1}Ye||pp(g)}if(Re=g.memoizedState,Re!==null&&(Re=Re.dehydrated,Re!==null))return WR(Re)?g.lanes=32:g.lanes=536870912,null;td(g)}return Re=E.children,E=E.fallback,j?(Mf(),j=g.mode,Re=G_({mode:"hidden",children:Re},j),E=up(E,j,_,null),Re.return=g,E.return=g,Re.sibling=E,g.child=Re,j=g.child,j.memoizedState=oR(_),j.childLanes=lR(p,ue,_),g.memoizedState=aR,E):(Nf(g),cR(g,Re))}if(Ye=p.memoizedState,Ye!==null&&(Re=Ye.dehydrated,Re!==null)){if(q)g.flags&256?(Nf(g),g.flags&=-257,g=uR(p,g,_)):g.memoizedState!==null?(Mf(),g.child=p.child,g.flags|=128,g=null):(Mf(),j=E.fallback,Re=g.mode,E=G_({mode:"visible",children:E.children},Re),j=up(j,Re,_,null),j.flags|=2,E.return=g,j.return=g,E.sibling=j,g.child=E,Ng(g,p.child,null,_),E=g.child,E.memoizedState=oR(_),E.childLanes=lR(p,ue,_),g.memoizedState=aR,g=j);else if(Nf(g),WR(Re)){if(ue=Re.nextSibling&&Re.nextSibling.dataset,ue)var wt=ue.dgst;ue=wt,E=Error(r(419)),E.stack="",E.digest=ue,Bb({value:E,source:null,stack:null}),g=uR(p,g,_)}else if(Yi||$b(p,g,_,!1),ue=(_&p.childLanes)!==0,Yi||ue){if(ue=js,ue!==null&&(E=_&-_,E=(E&42)!==0?1:kt(E),E=(E&(ue.suspendedLanes|_))!==0?0:E,E!==0&&E!==Ye.retryLane))throw Ye.retryLane=E,Ql(p,E),Ko(ue,p,E),g8;Re.data==="$?"||AR(),g=uR(p,g,_)}else Re.data==="$?"?(g.flags|=192,g.child=p.child,g=null):(p=Ye.treeContext,ri=tc(Re.nextSibling),Ga=g,ss=!0,hp=null,Uc=!1,p!==null&&(_l[Sl++]=Zu,_l[Sl++]=Xu,_l[Sl++]=dp,Zu=p.id,Xu=p.overflow,dp=g),g=cR(g,E.children),g.flags|=4096);return g}return j?(Mf(),j=E.fallback,Re=g.mode,Ye=p.child,wt=Ye.sibling,E=Yu(Ye,{mode:"hidden",children:E.children}),E.subtreeFlags=Ye.subtreeFlags&65011712,wt!==null?j=Yu(wt,j):(j=up(j,Re,_,null),j.flags|=2),j.return=g,E.return=g,E.sibling=j,g.child=E,E=j,j=g.child,Re=p.child.memoizedState,Re===null?Re=oR(_):(Ye=Re.cachePool,Ye!==null?(wt=ji._currentValue,Ye=Ye.parent!==wt?{parent:wt,pool:wt}:Ye):Ye=dF(),Re={baseLanes:Re.baseLanes|_,cachePool:Ye}),j.memoizedState=Re,j.childLanes=lR(p,ue,_),g.memoizedState=aR,E):(Nf(g),_=p.child,p=_.sibling,_=Yu(_,{mode:"visible",children:E.children}),_.return=g,_.sibling=null,p!==null&&(ue=g.deletions,ue===null?(g.deletions=[p],g.flags|=16):ue.push(p)),g.child=_,g.memoizedState=null,_)}function cR(p,g){return g=G_({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function G_(p,g){return p=qo(22,p,null,g),p.lanes=0,p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},p}function uR(p,g,_){return Ng(g,p.child,null,_),p=cR(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function E8(p,g,_){p.lanes|=g;var E=p.alternate;E!==null&&(E.lanes|=g),AA(p.return,g,_)}function dR(p,g,_,E,j){var q=p.memoizedState;q===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:E,tail:_,tailMode:j}:(q.isBackwards=g,q.rendering=null,q.renderingStartTime=0,q.last=E,q.tail=_,q.tailMode=j)}function T8(p,g,_){var E=g.pendingProps,j=E.revealOrder,q=E.tail;if(da(p,g,E.children,_),E=Oi.current,(E&2)!==0)E=E&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&E8(p,_,g);else if(p.tag===19)E8(p,_,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}E&=1}switch(se(Oi,E),j){case"forwards":for(_=g.child,j=null;_!==null;)p=_.alternate,p!==null&&q_(p)===null&&(j=_),_=_.sibling;_=j,_===null?(j=g.child,g.child=null):(j=_.sibling,_.sibling=null),dR(g,!1,j,_,q);break;case"backwards":for(_=null,j=g.child,g.child=null;j!==null;){if(p=j.alternate,p!==null&&q_(p)===null){g.child=j;break}p=j.sibling,j.sibling=_,_=j,j=p}dR(g,!0,_,null,q);break;case"together":dR(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function nd(p,g,_){if(p!==null&&(g.dependencies=p.dependencies),Df|=g.lanes,(_&g.childLanes)===0)if(p!==null){if($b(p,g,_,!1),(_&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(r(153));if(g.child!==null){for(p=g.child,_=Yu(p,p.pendingProps),g.child=_,_.return=g;p.sibling!==null;)p=p.sibling,_=_.sibling=Yu(p,p.pendingProps),_.return=g;_.sibling=null}return g.child}function fR(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&T_(p)))}function Gde(p,g,_){switch(g.tag){case 3:Se(g,g.stateNode.containerInfo),kf(g,ji,p.memoizedState.cache),Lb();break;case 27:case 5:qe(g);break;case 4:Se(g,g.stateNode.containerInfo);break;case 10:kf(g,g.type,g.memoizedProps.value);break;case 13:var E=g.memoizedState;if(E!==null)return E.dehydrated!==null?(Nf(g),g.flags|=128,null):(_&g.child.childLanes)!==0?k8(p,g,_):(Nf(g),p=nd(p,g,_),p!==null?p.sibling:null);Nf(g);break;case 19:var j=(p.flags&128)!==0;if(E=(_&g.childLanes)!==0,E||($b(p,g,_,!1),E=(_&g.childLanes)!==0),j){if(E)return T8(p,g,_);g.flags|=128}if(j=g.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),se(Oi,Oi.current),E)break;return null;case 22:case 23:return g.lanes=0,x8(p,g,_);case 24:kf(g,ji,p.memoizedState.cache)}return nd(p,g,_)}function A8(p,g,_){if(p!==null)if(p.memoizedProps!==g.pendingProps)Yi=!0;else{if(!fR(p,_)&&(g.flags&128)===0)return Yi=!1,Gde(p,g,_);Yi=(p.flags&131072)!==0}else Yi=!1,ss&&(g.flags&1048576)!==0&&sF(g,E_,g.index);switch(g.lanes=0,g.tag){case 16:e:{p=g.pendingProps;var E=g.elementType,j=E._init;if(E=j(E._payload),g.type=E,typeof E=="function")wA(E)?(p=vp(E,p),g.tag=1,g=S8(null,g,E,p,_)):(g.tag=0,g=iR(null,g,E,p,_));else{if(E!=null){if(j=E.$$typeof,j===C){g.tag=11,g=y8(null,g,E,p,_);break e}else if(j===R){g.tag=14,g=b8(null,g,E,p,_);break e}}throw g=F(E)||E,Error(r(306,g,""))}}return g;case 0:return iR(p,g,g.type,g.pendingProps,_);case 1:return E=g.type,j=vp(E,g.pendingProps),S8(p,g,E,j,_);case 3:e:{if(Se(g,g.stateNode.containerInfo),p===null)throw Error(r(387));E=g.pendingProps;var q=g.memoizedState;j=q.element,PA(p,g),Gb(g,E,null,_);var ue=g.memoizedState;if(E=ue.cache,kf(g,ji,E),E!==q.cache&&RA(g,[ji],_,!0),Hb(),E=ue.element,q.isDehydrated)if(q={element:E,isDehydrated:!1,cache:ue.cache},g.updateQueue.baseState=q,g.memoizedState=q,g.flags&256){g=C8(p,g,E,_);break e}else if(E!==j){j=Ln(Error(r(424)),g),Bb(j),g=C8(p,g,E,_);break e}else{switch(p=g.stateNode.containerInfo,p.nodeType){case 9:p=p.body;break;default:p=p.nodeName==="HTML"?p.ownerDocument.body:p}for(ri=tc(p.firstChild),Ga=g,ss=!0,hp=null,Uc=!0,_=a8(g,null,E,_),g.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling}else{if(Lb(),E===j){g=nd(p,g,_);break e}da(p,g,E,_)}g=g.child}return g;case 26:return H_(p,g),p===null?(_=IL(g.type,null,g.pendingProps,null))?g.memoizedState=_:ss||(_=g.type,p=g.pendingProps,E=oS(Ie.current).createElement(_),E[be]=g,E[Pe]=p,ha(E,_,p),Cr(E),g.stateNode=E):g.memoizedState=IL(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:return qe(g),p===null&&ss&&(E=g.stateNode=RL(g.type,g.pendingProps,Ie.current),Ga=g,Uc=!0,j=ri,$f(g.type)?(HR=j,ri=tc(E.firstChild)):ri=j),da(p,g,g.pendingProps.children,_),H_(p,g),p===null&&(g.flags|=4194304),g.child;case 5:return p===null&&ss&&((j=E=ri)&&(E=wfe(E,g.type,g.pendingProps,Uc),E!==null?(g.stateNode=E,Ga=g,ri=tc(E.firstChild),Uc=!1,j=!0):j=!1),j||pp(g)),qe(g),j=g.type,q=g.pendingProps,ue=p!==null?p.memoizedProps:null,E=q.children,UR(j,q)?E=null:ue!==null&&UR(j,ue)&&(g.flags|=32),g.memoizedState!==null&&(j=zA(p,g,Bde,null,null,_),mv._currentValue=j),H_(p,g),da(p,g,E,_),g.child;case 6:return p===null&&ss&&((p=_=ri)&&(_=_fe(_,g.pendingProps,Uc),_!==null?(g.stateNode=_,Ga=g,ri=null,p=!0):p=!1),p||pp(g)),null;case 13:return k8(p,g,_);case 4:return Se(g,g.stateNode.containerInfo),E=g.pendingProps,p===null?g.child=Ng(g,null,E,_):da(p,g,E,_),g.child;case 11:return y8(p,g,g.type,g.pendingProps,_);case 7:return da(p,g,g.pendingProps,_),g.child;case 8:return da(p,g,g.pendingProps.children,_),g.child;case 12:return da(p,g,g.pendingProps.children,_),g.child;case 10:return E=g.pendingProps,kf(g,g.type,E.value),da(p,g,E.children,_),g.child;case 9:return j=g.type._context,E=g.pendingProps.children,gp(g),j=Ea(j),E=E(j),g.flags|=1,da(p,g,E,_),g.child;case 14:return b8(p,g,g.type,g.pendingProps,_);case 15:return v8(p,g,g.type,g.pendingProps,_);case 19:return T8(p,g,_);case 31:return E=g.pendingProps,_=g.mode,E={mode:E.mode,children:E.children},p===null?(_=G_(E,_),_.ref=g.ref,g.child=_,_.return=g,g=_):(_=Yu(p.child,E),_.ref=g.ref,g.child=_,_.return=g,g=_),g;case 22:return x8(p,g,_);case 24:return gp(g),E=Ea(ji),p===null?(j=IA(),j===null&&(j=js,q=NA(),j.pooledCache=q,q.refCount++,q!==null&&(j.pooledCacheLanes|=_),j=q),g.memoizedState={parent:E,cache:j},OA(g),kf(g,ji,j)):((p.lanes&_)!==0&&(PA(p,g),Gb(g,null,null,_),Hb()),j=p.memoizedState,q=g.memoizedState,j.parent!==E?(j={parent:E,cache:E},g.memoizedState=j,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=j),kf(g,ji,E)):(E=q.cache,kf(g,ji,E),E!==j.cache&&RA(g,[ji],_,!0))),da(p,g,g.pendingProps.children,_),g.child;case 29:throw g.pendingProps}throw Error(r(156,g.tag))}function rd(p){p.flags|=4}function R8(p,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!FL(g)){if(g=Cl.current,g!==null&&((Gr&4194048)===Gr?qc!==null:(Gr&62914560)!==Gr&&(Gr&536870912)===0||g!==qc))throw Vb=jA,fF;p.flags|=8192}}function K_(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?B():536870912,p.lanes|=g,Og|=g)}function ev(p,g){if(!ss)switch(p.tailMode){case"hidden":g=p.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?p.tail=null:_.sibling=null;break;case"collapsed":_=p.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:E.sibling=null}}function Ys(p){var g=p.alternate!==null&&p.alternate.child===p.child,_=0,E=0;if(g)for(var j=p.child;j!==null;)_|=j.lanes|j.childLanes,E|=j.subtreeFlags&65011712,E|=j.flags&65011712,j.return=p,j=j.sibling;else for(j=p.child;j!==null;)_|=j.lanes|j.childLanes,E|=j.subtreeFlags,E|=j.flags,j.return=p,j=j.sibling;return p.subtreeFlags|=E,p.childLanes=_,g}function Kde(p,g,_){var E=g.pendingProps;switch(kA(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ys(g),null;case 1:return Ys(g),null;case 3:return _=g.stateNode,E=null,p!==null&&(E=p.memoizedState.cache),g.memoizedState.cache!==E&&(g.flags|=2048),Qu(ji),Ce(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(p===null||p.child===null)&&(Fb(g)?rd(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,oF())),Ys(g),null;case 26:return _=g.memoizedState,p===null?(rd(g),_!==null?(Ys(g),R8(g,_)):(Ys(g),g.flags&=-16777217)):_?_!==p.memoizedState?(rd(g),Ys(g),R8(g,_)):(Ys(g),g.flags&=-16777217):(p.memoizedProps!==E&&rd(g),Ys(g),g.flags&=-16777217),null;case 27:Qe(g),_=Ie.current;var j=g.type;if(p!==null&&g.stateNode!=null)p.memoizedProps!==E&&rd(g);else{if(!E){if(g.stateNode===null)throw Error(r(166));return Ys(g),null}p=pe.current,Fb(g)?iF(g):(p=RL(j,E,_),g.stateNode=p,rd(g))}return Ys(g),null;case 5:if(Qe(g),_=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==E&&rd(g);else{if(!E){if(g.stateNode===null)throw Error(r(166));return Ys(g),null}if(p=pe.current,Fb(g))iF(g);else{switch(j=oS(Ie.current),p){case 1:p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":p=j.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof E.is=="string"?j.createElement("select",{is:E.is}):j.createElement("select"),E.multiple?p.multiple=!0:E.size&&(p.size=E.size);break;default:p=typeof E.is=="string"?j.createElement(_,{is:E.is}):j.createElement(_)}}p[be]=g,p[Pe]=E;e:for(j=g.child;j!==null;){if(j.tag===5||j.tag===6)p.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===g)break e;for(;j.sibling===null;){if(j.return===null||j.return===g)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}g.stateNode=p;e:switch(ha(p,_,E),_){case"button":case"input":case"select":case"textarea":p=!!E.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&rd(g)}}return Ys(g),g.flags&=-16777217,null;case 6:if(p&&g.stateNode!=null)p.memoizedProps!==E&&rd(g);else{if(typeof E!="string"&&g.stateNode===null)throw Error(r(166));if(p=Ie.current,Fb(g)){if(p=g.stateNode,_=g.memoizedProps,E=null,j=Ga,j!==null)switch(j.tag){case 27:case 5:E=j.memoizedProps}p[be]=g,p=!!(p.nodeValue===_||E!==null&&E.suppressHydrationWarning===!0||_L(p.nodeValue,_)),p||pp(g)}else p=oS(p).createTextNode(E),p[be]=g,g.stateNode=p}return Ys(g),null;case 13:if(E=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(j=Fb(g),E!==null&&E.dehydrated!==null){if(p===null){if(!j)throw Error(r(318));if(j=g.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(r(317));j[be]=g}else Lb(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Ys(g),j=!1}else j=oF(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=j),j=!0;if(!j)return g.flags&256?(td(g),g):(td(g),null)}if(td(g),(g.flags&128)!==0)return g.lanes=_,g;if(_=E!==null,p=p!==null&&p.memoizedState!==null,_){E=g.child,j=null,E.alternate!==null&&E.alternate.memoizedState!==null&&E.alternate.memoizedState.cachePool!==null&&(j=E.alternate.memoizedState.cachePool.pool);var q=null;E.memoizedState!==null&&E.memoizedState.cachePool!==null&&(q=E.memoizedState.cachePool.pool),q!==j&&(E.flags|=2048)}return _!==p&&_&&(g.child.flags|=8192),K_(g,g.updateQueue),Ys(g),null;case 4:return Ce(),p===null&&FR(g.stateNode.containerInfo),Ys(g),null;case 10:return Qu(g.type),Ys(g),null;case 19:if(ee(Oi),j=g.memoizedState,j===null)return Ys(g),null;if(E=(g.flags&128)!==0,q=j.rendering,q===null)if(E)ev(j,!1);else{if(si!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(q=q_(p),q!==null){for(g.flags|=128,ev(j,!1),p=q.updateQueue,g.updateQueue=p,K_(g,p),g.subtreeFlags=0,p=_,_=g.child;_!==null;)rF(_,p),_=_.sibling;return se(Oi,Oi.current&1|2),g.child}p=p.sibling}j.tail!==null&&le()>X_&&(g.flags|=128,E=!0,ev(j,!1),g.lanes=4194304)}else{if(!E)if(p=q_(q),p!==null){if(g.flags|=128,E=!0,p=p.updateQueue,g.updateQueue=p,K_(g,p),ev(j,!0),j.tail===null&&j.tailMode==="hidden"&&!q.alternate&&!ss)return Ys(g),null}else 2*le()-j.renderingStartTime>X_&&_!==536870912&&(g.flags|=128,E=!0,ev(j,!1),g.lanes=4194304);j.isBackwards?(q.sibling=g.child,g.child=q):(p=j.last,p!==null?p.sibling=q:g.child=q,j.last=q)}return j.tail!==null?(g=j.tail,j.rendering=g,j.tail=g.sibling,j.renderingStartTime=le(),g.sibling=null,p=Oi.current,se(Oi,E?p&1|2:p&1),g):(Ys(g),null);case 22:case 23:return td(g),BA(),E=g.memoizedState!==null,p!==null?p.memoizedState!==null!==E&&(g.flags|=8192):E&&(g.flags|=8192),E?(_&536870912)!==0&&(g.flags&128)===0&&(Ys(g),g.subtreeFlags&6&&(g.flags|=8192)):Ys(g),_=g.updateQueue,_!==null&&K_(g,_.retryQueue),_=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),E=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(E=g.memoizedState.cachePool.pool),E!==_&&(g.flags|=2048),p!==null&&ee(yp),null;case 24:return _=null,p!==null&&(_=p.memoizedState.cache),g.memoizedState.cache!==_&&(g.flags|=2048),Qu(ji),Ys(g),null;case 25:return null;case 30:return null}throw Error(r(156,g.tag))}function Yde(p,g){switch(kA(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return Qu(ji),Ce(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return Qe(g),null;case 13:if(td(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(r(340));Lb()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return ee(Oi),null;case 4:return Ce(),null;case 10:return Qu(g.type),null;case 22:case 23:return td(g),BA(),p!==null&&ee(yp),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return Qu(ji),null;case 25:return null;default:return null}}function N8(p,g){switch(kA(g),g.tag){case 3:Qu(ji),Ce();break;case 26:case 27:case 5:Qe(g);break;case 4:Ce();break;case 13:td(g);break;case 19:ee(Oi);break;case 10:Qu(g.type);break;case 22:case 23:td(g),BA(),p!==null&&ee(yp);break;case 24:Qu(ji)}}function tv(p,g){try{var _=g.updateQueue,E=_!==null?_.lastEffect:null;if(E!==null){var j=E.next;_=j;do{if((_.tag&p)===p){E=void 0;var q=_.create,ue=_.inst;E=q(),ue.destroy=E}_=_.next}while(_!==j)}}catch(Re){Rs(g,g.return,Re)}}function If(p,g,_){try{var E=g.updateQueue,j=E!==null?E.lastEffect:null;if(j!==null){var q=j.next;E=q;do{if((E.tag&p)===p){var ue=E.inst,Re=ue.destroy;if(Re!==void 0){ue.destroy=void 0,j=g;var Ye=_,wt=Re;try{wt()}catch(Pt){Rs(j,Ye,Pt)}}}E=E.next}while(E!==q)}}catch(Pt){Rs(g,g.return,Pt)}}function M8(p){var g=p.updateQueue;if(g!==null){var _=p.stateNode;try{bF(g,_)}catch(E){Rs(p,p.return,E)}}}function I8(p,g,_){_.props=vp(p.type,p.memoizedProps),_.state=p.memoizedState;try{_.componentWillUnmount()}catch(E){Rs(p,g,E)}}function nv(p,g){try{var _=p.ref;if(_!==null){switch(p.tag){case 26:case 27:case 5:var E=p.stateNode;break;case 30:E=p.stateNode;break;default:E=p.stateNode}typeof _=="function"?p.refCleanup=_(E):_.current=E}}catch(j){Rs(p,g,j)}}function Vc(p,g){var _=p.ref,E=p.refCleanup;if(_!==null)if(typeof E=="function")try{E()}catch(j){Rs(p,g,j)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(j){Rs(p,g,j)}else _.current=null}function j8(p){var g=p.type,_=p.memoizedProps,E=p.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":_.autoFocus&&E.focus();break e;case"img":_.src?E.src=_.src:_.srcSet&&(E.srcset=_.srcSet)}}catch(j){Rs(p,p.return,j)}}function hR(p,g,_){try{var E=p.stateNode;gfe(E,p.type,_,g),E[Pe]=g}catch(j){Rs(p,p.return,j)}}function O8(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&$f(p.type)||p.tag===4}function pR(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||O8(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&$f(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function mR(p,g,_){var E=p.tag;if(E===5||E===6)p=p.stateNode,g?(_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_).insertBefore(p,g):(g=_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_,g.appendChild(p),_=_._reactRootContainer,_!=null||g.onclick!==null||(g.onclick=aS));else if(E!==4&&(E===27&&$f(p.type)&&(_=p.stateNode,g=null),p=p.child,p!==null))for(mR(p,g,_),p=p.sibling;p!==null;)mR(p,g,_),p=p.sibling}function Y_(p,g,_){var E=p.tag;if(E===5||E===6)p=p.stateNode,g?_.insertBefore(p,g):_.appendChild(p);else if(E!==4&&(E===27&&$f(p.type)&&(_=p.stateNode),p=p.child,p!==null))for(Y_(p,g,_),p=p.sibling;p!==null;)Y_(p,g,_),p=p.sibling}function P8(p){var g=p.stateNode,_=p.memoizedProps;try{for(var E=p.type,j=g.attributes;j.length;)g.removeAttributeNode(j[0]);ha(g,E,_),g[be]=p,g[Pe]=_}catch(q){Rs(p,p.return,q)}}var sd=!1,di=!1,gR=!1,D8=typeof WeakSet=="function"?WeakSet:Set,Zi=null;function Zde(p,g){if(p=p.containerInfo,$R=hS,p=he(p),Ee(p)){if("selectionStart"in p)var _={start:p.selectionStart,end:p.selectionEnd};else e:{_=(_=p.ownerDocument)&&_.defaultView||window;var E=_.getSelection&&_.getSelection();if(E&&E.rangeCount!==0){_=E.anchorNode;var j=E.anchorOffset,q=E.focusNode;E=E.focusOffset;try{_.nodeType,q.nodeType}catch{_=null;break e}var ue=0,Re=-1,Ye=-1,wt=0,Pt=0,Bt=p,Ct=null;t:for(;;){for(var At;Bt!==_||j!==0&&Bt.nodeType!==3||(Re=ue+j),Bt!==q||E!==0&&Bt.nodeType!==3||(Ye=ue+E),Bt.nodeType===3&&(ue+=Bt.nodeValue.length),(At=Bt.firstChild)!==null;)Ct=Bt,Bt=At;for(;;){if(Bt===p)break t;if(Ct===_&&++wt===j&&(Re=ue),Ct===q&&++Pt===E&&(Ye=ue),(At=Bt.nextSibling)!==null)break;Bt=Ct,Ct=Bt.parentNode}Bt=At}_=Re===-1||Ye===-1?null:{start:Re,end:Ye}}else _=null}_=_||{start:0,end:0}}else _=null;for(zR={focusedElem:p,selectionRange:_},hS=!1,Zi=g;Zi!==null;)if(g=Zi,p=g.child,(g.subtreeFlags&1024)!==0&&p!==null)p.return=g,Zi=p;else for(;Zi!==null;){switch(g=Zi,q=g.alternate,p=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((p&1024)!==0&&q!==null){p=void 0,_=g,j=q.memoizedProps,q=q.memoizedState,E=_.stateNode;try{var sr=vp(_.type,j,_.elementType===_.type);p=E.getSnapshotBeforeUpdate(sr,q),E.__reactInternalSnapshotBeforeUpdate=p}catch(Wn){Rs(_,_.return,Wn)}}break;case 3:if((p&1024)!==0){if(p=g.stateNode.containerInfo,_=p.nodeType,_===9)VR(p);else if(_===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":VR(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(r(163))}if(p=g.sibling,p!==null){p.return=g.return,Zi=p;break}Zi=g.return}}function F8(p,g,_){var E=_.flags;switch(_.tag){case 0:case 11:case 15:jf(p,_),E&4&&tv(5,_);break;case 1:if(jf(p,_),E&4)if(p=_.stateNode,g===null)try{p.componentDidMount()}catch(ue){Rs(_,_.return,ue)}else{var j=vp(_.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(j,g,p.__reactInternalSnapshotBeforeUpdate)}catch(ue){Rs(_,_.return,ue)}}E&64&&M8(_),E&512&&nv(_,_.return);break;case 3:if(jf(p,_),E&64&&(p=_.updateQueue,p!==null)){if(g=null,_.child!==null)switch(_.child.tag){case 27:case 5:g=_.child.stateNode;break;case 1:g=_.child.stateNode}try{bF(p,g)}catch(ue){Rs(_,_.return,ue)}}break;case 27:g===null&&E&4&&P8(_);case 26:case 5:jf(p,_),g===null&&E&4&&j8(_),E&512&&nv(_,_.return);break;case 12:jf(p,_);break;case 13:jf(p,_),E&4&&$8(p,_),E&64&&(p=_.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(_=ife.bind(null,_),Sfe(p,_))));break;case 22:if(E=_.memoizedState!==null||sd,!E){g=g!==null&&g.memoizedState!==null||di,j=sd;var q=di;sd=E,(di=g)&&!q?Of(p,_,(_.subtreeFlags&8772)!==0):jf(p,_),sd=j,di=q}break;case 30:break;default:jf(p,_)}}function L8(p){var g=p.alternate;g!==null&&(p.alternate=null,L8(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&un(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var Ws=null,po=!1;function id(p,g,_){for(_=_.child;_!==null;)B8(p,g,_),_=_.sibling}function B8(p,g,_){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(jt,_)}catch{}switch(_.tag){case 26:di||Vc(_,g),id(p,g,_),_.memoizedState?_.memoizedState.count--:_.stateNode&&(_=_.stateNode,_.parentNode.removeChild(_));break;case 27:di||Vc(_,g);var E=Ws,j=po;$f(_.type)&&(Ws=_.stateNode,po=!1),id(p,g,_),dv(_.stateNode),Ws=E,po=j;break;case 5:di||Vc(_,g);case 6:if(E=Ws,j=po,Ws=null,id(p,g,_),Ws=E,po=j,Ws!==null)if(po)try{(Ws.nodeType===9?Ws.body:Ws.nodeName==="HTML"?Ws.ownerDocument.body:Ws).removeChild(_.stateNode)}catch(q){Rs(_,g,q)}else try{Ws.removeChild(_.stateNode)}catch(q){Rs(_,g,q)}break;case 18:Ws!==null&&(po?(p=Ws,TL(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,_.stateNode),vv(p)):TL(Ws,_.stateNode));break;case 4:E=Ws,j=po,Ws=_.stateNode.containerInfo,po=!0,id(p,g,_),Ws=E,po=j;break;case 0:case 11:case 14:case 15:di||If(2,_,g),di||If(4,_,g),id(p,g,_);break;case 1:di||(Vc(_,g),E=_.stateNode,typeof E.componentWillUnmount=="function"&&I8(_,g,E)),id(p,g,_);break;case 21:id(p,g,_);break;case 22:di=(E=di)||_.memoizedState!==null,id(p,g,_),di=E;break;default:id(p,g,_)}}function $8(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{vv(p)}catch(_){Rs(g,g.return,_)}}function Xde(p){switch(p.tag){case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new D8),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new D8),g;default:throw Error(r(435,p.tag))}}function yR(p,g){var _=Xde(p);g.forEach(function(E){var j=afe.bind(null,p,E);_.has(E)||(_.add(E),E.then(j,j))})}function Vo(p,g){var _=g.deletions;if(_!==null)for(var E=0;E<_.length;E++){var j=_[E],q=p,ue=g,Re=ue;e:for(;Re!==null;){switch(Re.tag){case 27:if($f(Re.type)){Ws=Re.stateNode,po=!1;break e}break;case 5:Ws=Re.stateNode,po=!1;break e;case 3:case 4:Ws=Re.stateNode.containerInfo,po=!0;break e}Re=Re.return}if(Ws===null)throw Error(r(160));B8(q,ue,j),Ws=null,po=!1,q=j.alternate,q!==null&&(q.return=null),j.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)z8(g,p),g=g.sibling}var ec=null;function z8(p,g){var _=p.alternate,E=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Vo(g,p),Wo(p),E&4&&(If(3,p,p.return),tv(3,p),If(5,p,p.return));break;case 1:Vo(g,p),Wo(p),E&512&&(di||_===null||Vc(_,_.return)),E&64&&sd&&(p=p.updateQueue,p!==null&&(E=p.callbacks,E!==null&&(_=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=_===null?E:_.concat(E))));break;case 26:var j=ec;if(Vo(g,p),Wo(p),E&512&&(di||_===null||Vc(_,_.return)),E&4){var q=_!==null?_.memoizedState:null;if(E=p.memoizedState,_===null)if(E===null)if(p.stateNode===null){e:{E=p.type,_=p.memoizedProps,j=j.ownerDocument||j;t:switch(E){case"title":q=j.getElementsByTagName("title")[0],(!q||q[nn]||q[be]||q.namespaceURI==="http://www.w3.org/2000/svg"||q.hasAttribute("itemprop"))&&(q=j.createElement(E),j.head.insertBefore(q,j.querySelector("head > title"))),ha(q,E,_),q[be]=p,Cr(q),E=q;break e;case"link":var ue=PL("link","href",j).get(E+(_.href||""));if(ue){for(var Re=0;Re<ue.length;Re++)if(q=ue[Re],q.getAttribute("href")===(_.href==null||_.href===""?null:_.href)&&q.getAttribute("rel")===(_.rel==null?null:_.rel)&&q.getAttribute("title")===(_.title==null?null:_.title)&&q.getAttribute("crossorigin")===(_.crossOrigin==null?null:_.crossOrigin)){ue.splice(Re,1);break t}}q=j.createElement(E),ha(q,E,_),j.head.appendChild(q);break;case"meta":if(ue=PL("meta","content",j).get(E+(_.content||""))){for(Re=0;Re<ue.length;Re++)if(q=ue[Re],q.getAttribute("content")===(_.content==null?null:""+_.content)&&q.getAttribute("name")===(_.name==null?null:_.name)&&q.getAttribute("property")===(_.property==null?null:_.property)&&q.getAttribute("http-equiv")===(_.httpEquiv==null?null:_.httpEquiv)&&q.getAttribute("charset")===(_.charSet==null?null:_.charSet)){ue.splice(Re,1);break t}}q=j.createElement(E),ha(q,E,_),j.head.appendChild(q);break;default:throw Error(r(468,E))}q[be]=p,Cr(q),E=q}p.stateNode=E}else DL(j,p.type,p.stateNode);else p.stateNode=OL(j,E,p.memoizedProps);else q!==E?(q===null?_.stateNode!==null&&(_=_.stateNode,_.parentNode.removeChild(_)):q.count--,E===null?DL(j,p.type,p.stateNode):OL(j,E,p.memoizedProps)):E===null&&p.stateNode!==null&&hR(p,p.memoizedProps,_.memoizedProps)}break;case 27:Vo(g,p),Wo(p),E&512&&(di||_===null||Vc(_,_.return)),_!==null&&E&4&&hR(p,p.memoizedProps,_.memoizedProps);break;case 5:if(Vo(g,p),Wo(p),E&512&&(di||_===null||Vc(_,_.return)),p.flags&32){j=p.stateNode;try{mf(j,"")}catch(At){Rs(p,p.return,At)}}E&4&&p.stateNode!=null&&(j=p.memoizedProps,hR(p,j,_!==null?_.memoizedProps:j)),E&1024&&(gR=!0);break;case 6:if(Vo(g,p),Wo(p),E&4){if(p.stateNode===null)throw Error(r(162));E=p.memoizedProps,_=p.stateNode;try{_.nodeValue=E}catch(At){Rs(p,p.return,At)}}break;case 3:if(uS=null,j=ec,ec=lS(g.containerInfo),Vo(g,p),ec=j,Wo(p),E&4&&_!==null&&_.memoizedState.isDehydrated)try{vv(g.containerInfo)}catch(At){Rs(p,p.return,At)}gR&&(gR=!1,U8(p));break;case 4:E=ec,ec=lS(p.stateNode.containerInfo),Vo(g,p),Wo(p),ec=E;break;case 12:Vo(g,p),Wo(p);break;case 13:Vo(g,p),Wo(p),p.child.flags&8192&&p.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(SR=le()),E&4&&(E=p.updateQueue,E!==null&&(p.updateQueue=null,yR(p,E)));break;case 22:j=p.memoizedState!==null;var Ye=_!==null&&_.memoizedState!==null,wt=sd,Pt=di;if(sd=wt||j,di=Pt||Ye,Vo(g,p),di=Pt,sd=wt,Wo(p),E&8192)e:for(g=p.stateNode,g._visibility=j?g._visibility&-2:g._visibility|1,j&&(_===null||Ye||sd||di||xp(p)),_=null,g=p;;){if(g.tag===5||g.tag===26){if(_===null){Ye=_=g;try{if(q=Ye.stateNode,j)ue=q.style,typeof ue.setProperty=="function"?ue.setProperty("display","none","important"):ue.display="none";else{Re=Ye.stateNode;var Bt=Ye.memoizedProps.style,Ct=Bt!=null&&Bt.hasOwnProperty("display")?Bt.display:null;Re.style.display=Ct==null||typeof Ct=="boolean"?"":(""+Ct).trim()}}catch(At){Rs(Ye,Ye.return,At)}}}else if(g.tag===6){if(_===null){Ye=g;try{Ye.stateNode.nodeValue=j?"":Ye.memoizedProps}catch(At){Rs(Ye,Ye.return,At)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;_===g&&(_=null),g=g.return}_===g&&(_=null),g.sibling.return=g.return,g=g.sibling}E&4&&(E=p.updateQueue,E!==null&&(_=E.retryQueue,_!==null&&(E.retryQueue=null,yR(p,_))));break;case 19:Vo(g,p),Wo(p),E&4&&(E=p.updateQueue,E!==null&&(p.updateQueue=null,yR(p,E)));break;case 30:break;case 21:break;default:Vo(g,p),Wo(p)}}function Wo(p){var g=p.flags;if(g&2){try{for(var _,E=p.return;E!==null;){if(O8(E)){_=E;break}E=E.return}if(_==null)throw Error(r(160));switch(_.tag){case 27:var j=_.stateNode,q=pR(p);Y_(p,q,j);break;case 5:var ue=_.stateNode;_.flags&32&&(mf(ue,""),_.flags&=-33);var Re=pR(p);Y_(p,Re,ue);break;case 3:case 4:var Ye=_.stateNode.containerInfo,wt=pR(p);mR(p,wt,Ye);break;default:throw Error(r(161))}}catch(Pt){Rs(p,p.return,Pt)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function U8(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;U8(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),p=p.sibling}}function jf(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)F8(p,g.alternate,g),g=g.sibling}function xp(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:If(4,g,g.return),xp(g);break;case 1:Vc(g,g.return);var _=g.stateNode;typeof _.componentWillUnmount=="function"&&I8(g,g.return,_),xp(g);break;case 27:dv(g.stateNode);case 26:case 5:Vc(g,g.return),xp(g);break;case 22:g.memoizedState===null&&xp(g);break;case 30:xp(g);break;default:xp(g)}p=p.sibling}}function Of(p,g,_){for(_=_&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var E=g.alternate,j=p,q=g,ue=q.flags;switch(q.tag){case 0:case 11:case 15:Of(j,q,_),tv(4,q);break;case 1:if(Of(j,q,_),E=q,j=E.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(wt){Rs(E,E.return,wt)}if(E=q,j=E.updateQueue,j!==null){var Re=E.stateNode;try{var Ye=j.shared.hiddenCallbacks;if(Ye!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Ye.length;j++)yF(Ye[j],Re)}catch(wt){Rs(E,E.return,wt)}}_&&ue&64&&M8(q),nv(q,q.return);break;case 27:P8(q);case 26:case 5:Of(j,q,_),_&&E===null&&ue&4&&j8(q),nv(q,q.return);break;case 12:Of(j,q,_);break;case 13:Of(j,q,_),_&&ue&4&&$8(j,q);break;case 22:q.memoizedState===null&&Of(j,q,_),nv(q,q.return);break;case 30:break;default:Of(j,q,_)}g=g.sibling}}function bR(p,g){var _=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==_&&(p!=null&&p.refCount++,_!=null&&zb(_))}function vR(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&zb(p))}function Wc(p,g,_,E){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)q8(p,g,_,E),g=g.sibling}function q8(p,g,_,E){var j=g.flags;switch(g.tag){case 0:case 11:case 15:Wc(p,g,_,E),j&2048&&tv(9,g);break;case 1:Wc(p,g,_,E);break;case 3:Wc(p,g,_,E),j&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&zb(p)));break;case 12:if(j&2048){Wc(p,g,_,E),p=g.stateNode;try{var q=g.memoizedProps,ue=q.id,Re=q.onPostCommit;typeof Re=="function"&&Re(ue,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(Ye){Rs(g,g.return,Ye)}}else Wc(p,g,_,E);break;case 13:Wc(p,g,_,E);break;case 23:break;case 22:q=g.stateNode,ue=g.alternate,g.memoizedState!==null?q._visibility&2?Wc(p,g,_,E):rv(p,g):q._visibility&2?Wc(p,g,_,E):(q._visibility|=2,Mg(p,g,_,E,(g.subtreeFlags&10256)!==0)),j&2048&&bR(ue,g);break;case 24:Wc(p,g,_,E),j&2048&&vR(g.alternate,g);break;default:Wc(p,g,_,E)}}function Mg(p,g,_,E,j){for(j=j&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var q=p,ue=g,Re=_,Ye=E,wt=ue.flags;switch(ue.tag){case 0:case 11:case 15:Mg(q,ue,Re,Ye,j),tv(8,ue);break;case 23:break;case 22:var Pt=ue.stateNode;ue.memoizedState!==null?Pt._visibility&2?Mg(q,ue,Re,Ye,j):rv(q,ue):(Pt._visibility|=2,Mg(q,ue,Re,Ye,j)),j&&wt&2048&&bR(ue.alternate,ue);break;case 24:Mg(q,ue,Re,Ye,j),j&&wt&2048&&vR(ue.alternate,ue);break;default:Mg(q,ue,Re,Ye,j)}g=g.sibling}}function rv(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var _=p,E=g,j=E.flags;switch(E.tag){case 22:rv(_,E),j&2048&&bR(E.alternate,E);break;case 24:rv(_,E),j&2048&&vR(E.alternate,E);break;default:rv(_,E)}g=g.sibling}}var sv=8192;function Ig(p){if(p.subtreeFlags&sv)for(p=p.child;p!==null;)V8(p),p=p.sibling}function V8(p){switch(p.tag){case 26:Ig(p),p.flags&sv&&p.memoizedState!==null&&Dfe(ec,p.memoizedState,p.memoizedProps);break;case 5:Ig(p);break;case 3:case 4:var g=ec;ec=lS(p.stateNode.containerInfo),Ig(p),ec=g;break;case 22:p.memoizedState===null&&(g=p.alternate,g!==null&&g.memoizedState!==null?(g=sv,sv=16777216,Ig(p),sv=g):Ig(p));break;default:Ig(p)}}function W8(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function iv(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var E=g[_];Zi=E,G8(E,p)}W8(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)H8(p),p=p.sibling}function H8(p){switch(p.tag){case 0:case 11:case 15:iv(p),p.flags&2048&&If(9,p,p.return);break;case 3:iv(p);break;case 12:iv(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&2&&(p.return===null||p.return.tag!==13)?(g._visibility&=-3,Z_(p)):iv(p);break;default:iv(p)}}function Z_(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var E=g[_];Zi=E,G8(E,p)}W8(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:If(8,g,g.return),Z_(g);break;case 22:_=g.stateNode,_._visibility&2&&(_._visibility&=-3,Z_(g));break;default:Z_(g)}p=p.sibling}}function G8(p,g){for(;Zi!==null;){var _=Zi;switch(_.tag){case 0:case 11:case 15:If(8,_,g);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var E=_.memoizedState.cachePool.pool;E!=null&&E.refCount++}break;case 24:zb(_.memoizedState.cache)}if(E=_.child,E!==null)E.return=_,Zi=E;else e:for(_=p;Zi!==null;){E=Zi;var j=E.sibling,q=E.return;if(L8(E),E===_){Zi=null;break e}if(j!==null){j.return=q,Zi=j;break e}Zi=q}}}var Jde={getCacheForType:function(p){var g=Ea(ji),_=g.data.get(p);return _===void 0&&(_=p(),g.data.set(p,_)),_}},Qde=typeof WeakMap=="function"?WeakMap:Map,ms=0,js=null,Fr=null,Gr=0,gs=0,Ho=null,Pf=!1,jg=!1,xR=!1,ad=0,si=0,Df=0,wp=0,wR=0,kl=0,Og=0,av=null,mo=null,_R=!1,SR=0,X_=1/0,J_=null,Ff=null,fa=0,Lf=null,Pg=null,Dg=0,CR=0,kR=null,K8=null,ov=0,ER=null;function Go(){if((ms&2)!==0&&Gr!==0)return Gr&-Gr;if(U.T!==null){var p=Sg;return p!==0?p:jR()}return Y()}function Y8(){kl===0&&(kl=(Gr&536870912)===0||ss?ot():536870912);var p=Cl.current;return p!==null&&(p.flags|=32),kl}function Ko(p,g,_){(p===js&&(gs===2||gs===9)||p.cancelPendingCommit!==null)&&(Fg(p,0),Bf(p,Gr,kl,!1)),st(p,_),((ms&2)===0||p!==js)&&(p===js&&((ms&2)===0&&(wp|=_),si===4&&Bf(p,Gr,kl,!1)),Hc(p))}function Z8(p,g,_){if((ms&6)!==0)throw Error(r(327));var E=!_&&(g&124)===0&&(g&p.expiredLanes)===0||de(p,g),j=E?nfe(p,g):RR(p,g,!0),q=E;do{if(j===0){jg&&!E&&Bf(p,g,0,!1);break}else{if(_=p.current.alternate,q&&!efe(_)){j=RR(p,g,!1),q=!1;continue}if(j===2){if(q=g,p.errorRecoveryDisabledLanes&q)var ue=0;else ue=p.pendingLanes&-536870913,ue=ue!==0?ue:ue&536870912?536870912:0;if(ue!==0){g=ue;e:{var Re=p;j=av;var Ye=Re.current.memoizedState.isDehydrated;if(Ye&&(Fg(Re,ue).flags|=256),ue=RR(Re,ue,!1),ue!==2){if(xR&&!Ye){Re.errorRecoveryDisabledLanes|=q,wp|=q,j=4;break e}q=mo,mo=j,q!==null&&(mo===null?mo=q:mo.push.apply(mo,q))}j=ue}if(q=!1,j!==2)continue}}if(j===1){Fg(p,0),Bf(p,g,0,!0);break}e:{switch(E=p,q=j,q){case 0:case 1:throw Error(r(345));case 4:if((g&4194048)!==g)break;case 6:Bf(E,g,kl,!Pf);break e;case 2:mo=null;break;case 3:case 5:break;default:throw Error(r(329))}if((g&62914560)===g&&(j=SR+300-le(),10<j)){if(Bf(E,g,kl,!Pf),Me(E,0,!0)!==0)break e;E.timeoutHandle=kL(X8.bind(null,E,_,mo,J_,_R,g,kl,wp,Og,Pf,q,2,-0,0),j);break e}X8(E,_,mo,J_,_R,g,kl,wp,Og,Pf,q,0,-0,0)}}break}while(!0);Hc(p)}function X8(p,g,_,E,j,q,ue,Re,Ye,wt,Pt,Bt,Ct,At){if(p.timeoutHandle=-1,Bt=g.subtreeFlags,(Bt&8192||(Bt&16785408)===16785408)&&(pv={stylesheets:null,count:0,unsuspend:Pfe},V8(g),Bt=Ffe(),Bt!==null)){p.cancelPendingCommit=Bt(sL.bind(null,p,g,q,_,E,j,ue,Re,Ye,Pt,1,Ct,At)),Bf(p,q,ue,!wt);return}sL(p,g,q,_,E,j,ue,Re,Ye)}function efe(p){for(var g=p;;){var _=g.tag;if((_===0||_===11||_===15)&&g.flags&16384&&(_=g.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var E=0;E<_.length;E++){var j=_[E],q=j.getSnapshot;j=j.value;try{if(!ka(q(),j))return!1}catch{return!1}}if(_=g.child,g.subtreeFlags&16384&&_!==null)_.return=g,g=_;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Bf(p,g,_,E){g&=~wR,g&=~wp,p.suspendedLanes|=g,p.pingedLanes&=~g,E&&(p.warmLanes|=g),E=p.expirationTimes;for(var j=g;0<j;){var q=31-en(j),ue=1<<q;E[q]=-1,j&=~ue}_!==0&&_e(p,_,g)}function Q_(){return(ms&6)===0?(lv(0),!1):!0}function TR(){if(Fr!==null){if(gs===0)var p=Fr.return;else p=Fr,Ju=mp=null,VA(p),Rg=null,Jb=0,p=Fr;for(;p!==null;)N8(p.alternate,p),p=p.return;Fr=null}}function Fg(p,g){var _=p.timeoutHandle;_!==-1&&(p.timeoutHandle=-1,bfe(_)),_=p.cancelPendingCommit,_!==null&&(p.cancelPendingCommit=null,_()),TR(),js=p,Fr=_=Yu(p.current,null),Gr=g,gs=0,Ho=null,Pf=!1,jg=de(p,g),xR=!1,Og=kl=wR=wp=Df=si=0,mo=av=null,_R=!1,(g&8)!==0&&(g|=g&32);var E=p.entangledLanes;if(E!==0)for(p=p.entanglements,E&=g;0<E;){var j=31-en(E),q=1<<j;g|=p[j],E&=~q}return ad=g,rr(),_}function J8(p,g){Mr=null,U.H=$_,g===qb||g===N_?(g=mF(),gs=3):g===fF?(g=mF(),gs=4):gs=g===g8?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Ho=g,Fr===null&&(si=1,W_(p,Ln(g,p.current)))}function Q8(){var p=U.H;return U.H=$_,p===null?$_:p}function eL(){var p=U.A;return U.A=Jde,p}function AR(){si=4,Pf||(Gr&4194048)!==Gr&&Cl.current!==null||(jg=!0),(Df&134217727)===0&&(wp&134217727)===0||js===null||Bf(js,Gr,kl,!1)}function RR(p,g,_){var E=ms;ms|=2;var j=Q8(),q=eL();(js!==p||Gr!==g)&&(J_=null,Fg(p,g)),g=!1;var ue=si;e:do try{if(gs!==0&&Fr!==null){var Re=Fr,Ye=Ho;switch(gs){case 8:TR(),ue=6;break e;case 3:case 2:case 9:case 6:Cl.current===null&&(g=!0);var wt=gs;if(gs=0,Ho=null,Lg(p,Re,Ye,wt),_&&jg){ue=0;break e}break;default:wt=gs,gs=0,Ho=null,Lg(p,Re,Ye,wt)}}tfe(),ue=si;break}catch(Pt){J8(p,Pt)}while(!0);return g&&p.shellSuspendCounter++,Ju=mp=null,ms=E,U.H=j,U.A=q,Fr===null&&(js=null,Gr=0,rr()),ue}function tfe(){for(;Fr!==null;)tL(Fr)}function nfe(p,g){var _=ms;ms|=2;var E=Q8(),j=eL();js!==p||Gr!==g?(J_=null,X_=le()+500,Fg(p,g)):jg=de(p,g);e:do try{if(gs!==0&&Fr!==null){g=Fr;var q=Ho;t:switch(gs){case 1:gs=0,Ho=null,Lg(p,g,q,1);break;case 2:case 9:if(hF(q)){gs=0,Ho=null,nL(g);break}g=function(){gs!==2&&gs!==9||js!==p||(gs=7),Hc(p)},q.then(g,g);break e;case 3:gs=7;break e;case 4:gs=5;break e;case 7:hF(q)?(gs=0,Ho=null,nL(g)):(gs=0,Ho=null,Lg(p,g,q,7));break;case 5:var ue=null;switch(Fr.tag){case 26:ue=Fr.memoizedState;case 5:case 27:var Re=Fr;if(!ue||FL(ue)){gs=0,Ho=null;var Ye=Re.sibling;if(Ye!==null)Fr=Ye;else{var wt=Re.return;wt!==null?(Fr=wt,eS(wt)):Fr=null}break t}}gs=0,Ho=null,Lg(p,g,q,5);break;case 6:gs=0,Ho=null,Lg(p,g,q,6);break;case 8:TR(),si=6;break e;default:throw Error(r(462))}}rfe();break}catch(Pt){J8(p,Pt)}while(!0);return Ju=mp=null,U.H=E,U.A=j,ms=_,Fr!==null?0:(js=null,Gr=0,rr(),si)}function rfe(){for(;Fr!==null&&!me();)tL(Fr)}function tL(p){var g=A8(p.alternate,p,ad);p.memoizedProps=p.pendingProps,g===null?eS(p):Fr=g}function nL(p){var g=p,_=g.alternate;switch(g.tag){case 15:case 0:g=_8(_,g,g.pendingProps,g.type,void 0,Gr);break;case 11:g=_8(_,g,g.pendingProps,g.type.render,g.ref,Gr);break;case 5:VA(g);default:N8(_,g),g=Fr=rF(g,ad),g=A8(_,g,ad)}p.memoizedProps=p.pendingProps,g===null?eS(p):Fr=g}function Lg(p,g,_,E){Ju=mp=null,VA(g),Rg=null,Jb=0;var j=g.return;try{if(Hde(p,j,g,_,Gr)){si=1,W_(p,Ln(_,p.current)),Fr=null;return}}catch(q){if(j!==null)throw Fr=j,q;si=1,W_(p,Ln(_,p.current)),Fr=null;return}g.flags&32768?(ss||E===1?p=!0:jg||(Gr&536870912)!==0?p=!1:(Pf=p=!0,(E===2||E===9||E===3||E===6)&&(E=Cl.current,E!==null&&E.tag===13&&(E.flags|=16384))),rL(g,p)):eS(g)}function eS(p){var g=p;do{if((g.flags&32768)!==0){rL(g,Pf);return}p=g.return;var _=Kde(g.alternate,g,ad);if(_!==null){Fr=_;return}if(g=g.sibling,g!==null){Fr=g;return}Fr=g=p}while(g!==null);si===0&&(si=5)}function rL(p,g){do{var _=Yde(p.alternate,p);if(_!==null){_.flags&=32767,Fr=_;return}if(_=p.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!g&&(p=p.sibling,p!==null)){Fr=p;return}Fr=p=_}while(p!==null);si=6,Fr=null}function sL(p,g,_,E,j,q,ue,Re,Ye){p.cancelPendingCommit=null;do tS();while(fa!==0);if((ms&6)!==0)throw Error(r(327));if(g!==null){if(g===p.current)throw Error(r(177));if(q=g.lanes|g.childLanes,q|=ua,ye(p,_,q,ue,Re,Ye),p===js&&(Fr=js=null,Gr=0),Pg=g,Lf=p,Dg=_,CR=q,kR=j,K8=E,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,ofe(Be,function(){return cL(),null})):(p.callbackNode=null,p.callbackPriority=0),E=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||E){E=U.T,U.T=null,j=H.p,H.p=2,ue=ms,ms|=4;try{Zde(p,g,_)}finally{ms=ue,H.p=j,U.T=E}}fa=1,iL(),aL(),oL()}}function iL(){if(fa===1){fa=0;var p=Lf,g=Pg,_=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||_){_=U.T,U.T=null;var E=H.p;H.p=2;var j=ms;ms|=4;try{z8(g,p);var q=zR,ue=he(p.containerInfo),Re=q.focusedElem,Ye=q.selectionRange;if(ue!==Re&&Re&&Re.ownerDocument&&ae(Re.ownerDocument.documentElement,Re)){if(Ye!==null&&Ee(Re)){var wt=Ye.start,Pt=Ye.end;if(Pt===void 0&&(Pt=wt),"selectionStart"in Re)Re.selectionStart=wt,Re.selectionEnd=Math.min(Pt,Re.value.length);else{var Bt=Re.ownerDocument||document,Ct=Bt&&Bt.defaultView||window;if(Ct.getSelection){var At=Ct.getSelection(),sr=Re.textContent.length,Wn=Math.min(Ye.start,sr),_s=Ye.end===void 0?Wn:Math.min(Ye.end,sr);!At.extend&&Wn>_s&&(ue=_s,_s=Wn,Wn=ue);var ht=te(Re,Wn),rt=te(Re,_s);if(ht&&rt&&(At.rangeCount!==1||At.anchorNode!==ht.node||At.anchorOffset!==ht.offset||At.focusNode!==rt.node||At.focusOffset!==rt.offset)){var xt=Bt.createRange();xt.setStart(ht.node,ht.offset),At.removeAllRanges(),Wn>_s?(At.addRange(xt),At.extend(rt.node,rt.offset)):(xt.setEnd(rt.node,rt.offset),At.addRange(xt))}}}}for(Bt=[],At=Re;At=At.parentNode;)At.nodeType===1&&Bt.push({element:At,left:At.scrollLeft,top:At.scrollTop});for(typeof Re.focus=="function"&&Re.focus(),Re=0;Re<Bt.length;Re++){var Ft=Bt[Re];Ft.element.scrollLeft=Ft.left,Ft.element.scrollTop=Ft.top}}hS=!!$R,zR=$R=null}finally{ms=j,H.p=E,U.T=_}}p.current=g,fa=2}}function aL(){if(fa===2){fa=0;var p=Lf,g=Pg,_=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||_){_=U.T,U.T=null;var E=H.p;H.p=2;var j=ms;ms|=4;try{F8(p,g.alternate,g)}finally{ms=j,H.p=E,U.T=_}}fa=3}}function oL(){if(fa===4||fa===3){fa=0,Ae();var p=Lf,g=Pg,_=Dg,E=K8;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?fa=5:(fa=0,Pg=Lf=null,lL(p,p.pendingLanes));var j=p.pendingLanes;if(j===0&&(Ff=null),fe(_),g=g.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(jt,g,void 0,(g.current.flags&128)===128)}catch{}if(E!==null){g=U.T,j=H.p,H.p=2,U.T=null;try{for(var q=p.onRecoverableError,ue=0;ue<E.length;ue++){var Re=E[ue];q(Re.value,{componentStack:Re.stack})}}finally{U.T=g,H.p=j}}(Dg&3)!==0&&tS(),Hc(p),j=p.pendingLanes,(_&4194090)!==0&&(j&42)!==0?p===ER?ov++:(ov=0,ER=p):ov=0,lv(0)}}function lL(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,zb(g)))}function tS(p){return iL(),aL(),oL(),cL()}function cL(){if(fa!==5)return!1;var p=Lf,g=CR;CR=0;var _=fe(Dg),E=U.T,j=H.p;try{H.p=32>_?32:_,U.T=null,_=kR,kR=null;var q=Lf,ue=Dg;if(fa=0,Pg=Lf=null,Dg=0,(ms&6)!==0)throw Error(r(331));var Re=ms;if(ms|=4,H8(q.current),q8(q,q.current,ue,_),ms=Re,lv(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(jt,q)}catch{}return!0}finally{H.p=j,U.T=E,lL(p,g)}}function uL(p,g,_){g=Ln(_,g),g=sR(p.stateNode,g,2),p=Af(p,g,2),p!==null&&(st(p,2),Hc(p))}function Rs(p,g,_){if(p.tag===3)uL(p,p,_);else for(;g!==null;){if(g.tag===3){uL(g,p,_);break}else if(g.tag===1){var E=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Ff===null||!Ff.has(E))){p=Ln(_,p),_=p8(2),E=Af(g,_,2),E!==null&&(m8(_,E,g,p),st(E,2),Hc(E));break}}g=g.return}}function NR(p,g,_){var E=p.pingCache;if(E===null){E=p.pingCache=new Qde;var j=new Set;E.set(g,j)}else j=E.get(g),j===void 0&&(j=new Set,E.set(g,j));j.has(_)||(xR=!0,j.add(_),p=sfe.bind(null,p,g,_),g.then(p,p))}function sfe(p,g,_){var E=p.pingCache;E!==null&&E.delete(g),p.pingedLanes|=p.suspendedLanes&_,p.warmLanes&=~_,js===p&&(Gr&_)===_&&(si===4||si===3&&(Gr&62914560)===Gr&&300>le()-SR?(ms&2)===0&&Fg(p,0):wR|=_,Og===Gr&&(Og=0)),Hc(p)}function dL(p,g){g===0&&(g=B()),p=Ql(p,g),p!==null&&(st(p,g),Hc(p))}function ife(p){var g=p.memoizedState,_=0;g!==null&&(_=g.retryLane),dL(p,_)}function afe(p,g){var _=0;switch(p.tag){case 13:var E=p.stateNode,j=p.memoizedState;j!==null&&(_=j.retryLane);break;case 19:E=p.stateNode;break;case 22:E=p.stateNode._retryCache;break;default:throw Error(r(314))}E!==null&&E.delete(g),dL(p,_)}function ofe(p,g){return Ne(p,g)}var nS=null,Bg=null,MR=!1,rS=!1,IR=!1,_p=0;function Hc(p){p!==Bg&&p.next===null&&(Bg===null?nS=Bg=p:Bg=Bg.next=p),rS=!0,MR||(MR=!0,cfe())}function lv(p,g){if(!IR&&rS){IR=!0;do for(var _=!1,E=nS;E!==null;){if(p!==0){var j=E.pendingLanes;if(j===0)var q=0;else{var ue=E.suspendedLanes,Re=E.pingedLanes;q=(1<<31-en(42|p)+1)-1,q&=j&~(ue&~Re),q=q&201326741?q&201326741|1:q?q|2:0}q!==0&&(_=!0,mL(E,q))}else q=Gr,q=Me(E,E===js?q:0,E.cancelPendingCommit!==null||E.timeoutHandle!==-1),(q&3)===0||de(E,q)||(_=!0,mL(E,q));E=E.next}while(_);IR=!1}}function lfe(){fL()}function fL(){rS=MR=!1;var p=0;_p!==0&&(yfe()&&(p=_p),_p=0);for(var g=le(),_=null,E=nS;E!==null;){var j=E.next,q=hL(E,g);q===0?(E.next=null,_===null?nS=j:_.next=j,j===null&&(Bg=_)):(_=E,(p!==0||(q&3)!==0)&&(rS=!0)),E=j}lv(p)}function hL(p,g){for(var _=p.suspendedLanes,E=p.pingedLanes,j=p.expirationTimes,q=p.pendingLanes&-62914561;0<q;){var ue=31-en(q),Re=1<<ue,Ye=j[ue];Ye===-1?((Re&_)===0||(Re&E)!==0)&&(j[ue]=vt(Re,g)):Ye<=g&&(p.expiredLanes|=Re),q&=~Re}if(g=js,_=Gr,_=Me(p,p===g?_:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),E=p.callbackNode,_===0||p===g&&(gs===2||gs===9)||p.cancelPendingCommit!==null)return E!==null&&E!==null&&K(E),p.callbackNode=null,p.callbackPriority=0;if((_&3)===0||de(p,_)){if(g=_&-_,g===p.callbackPriority)return g;switch(E!==null&&K(E),fe(_)){case 2:case 8:_=Te;break;case 32:_=Be;break;case 268435456:_=lt;break;default:_=Be}return E=pL.bind(null,p),_=Ne(_,E),p.callbackPriority=g,p.callbackNode=_,g}return E!==null&&E!==null&&K(E),p.callbackPriority=2,p.callbackNode=null,2}function pL(p,g){if(fa!==0&&fa!==5)return p.callbackNode=null,p.callbackPriority=0,null;var _=p.callbackNode;if(tS()&&p.callbackNode!==_)return null;var E=Gr;return E=Me(p,p===js?E:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),E===0?null:(Z8(p,E,g),hL(p,le()),p.callbackNode!=null&&p.callbackNode===_?pL.bind(null,p):null)}function mL(p,g){if(tS())return null;Z8(p,g,!0)}function cfe(){vfe(function(){(ms&6)!==0?Ne(re,lfe):fL()})}function jR(){return _p===0&&(_p=ot()),_p}function gL(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:$u(""+p)}function yL(p,g){var _=g.ownerDocument.createElement("input");return _.name=g.name,_.value=g.value,p.id&&_.setAttribute("form",p.id),g.parentNode.insertBefore(_,g),p=new FormData(p),_.parentNode.removeChild(_),p}function ufe(p,g,_,E,j){if(g==="submit"&&_&&_.stateNode===j){var q=gL((j[Pe]||null).action),ue=E.submitter;ue&&(g=(g=ue[Pe]||null)?gL(g.formAction):ue.getAttribute("formAction"),g!==null&&(q=g,ue=null));var Re=new ig("action","action",null,E,j);p.push({event:Re,listeners:[{instance:null,listener:function(){if(E.defaultPrevented){if(_p!==0){var Ye=ue?yL(j,ue):new FormData(j);QA(_,{pending:!0,data:Ye,method:j.method,action:q},null,Ye)}}else typeof q=="function"&&(Re.preventDefault(),Ye=ue?yL(j,ue):new FormData(j),QA(_,{pending:!0,data:Ye,method:j.method,action:q},q,Ye))},currentTarget:j}]})}}for(var OR=0;OR<an.length;OR++){var PR=an[OR],dfe=PR.toLowerCase(),ffe=PR[0].toUpperCase()+PR.slice(1);Gt(dfe,"on"+ffe)}Gt(St,"onAnimationEnd"),Gt(Nt,"onAnimationIteration"),Gt(Mt,"onAnimationStart"),Gt("dblclick","onDoubleClick"),Gt("focusin","onFocus"),Gt("focusout","onBlur"),Gt(Ot,"onTransitionRun"),Gt(Yt,"onTransitionStart"),Gt(rn,"onTransitionCancel"),Gt(Ht,"onTransitionEnd"),pn("onMouseEnter",["mouseout","mouseover"]),pn("onMouseLeave",["mouseout","mouseover"]),pn("onPointerEnter",["pointerout","pointerover"]),pn("onPointerLeave",["pointerout","pointerover"]),Vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hfe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cv));function bL(p,g){g=(g&4)!==0;for(var _=0;_<p.length;_++){var E=p[_],j=E.event;E=E.listeners;e:{var q=void 0;if(g)for(var ue=E.length-1;0<=ue;ue--){var Re=E[ue],Ye=Re.instance,wt=Re.currentTarget;if(Re=Re.listener,Ye!==q&&j.isPropagationStopped())break e;q=Re,j.currentTarget=wt;try{q(j)}catch(Pt){V_(Pt)}j.currentTarget=null,q=Ye}else for(ue=0;ue<E.length;ue++){if(Re=E[ue],Ye=Re.instance,wt=Re.currentTarget,Re=Re.listener,Ye!==q&&j.isPropagationStopped())break e;q=Re,j.currentTarget=wt;try{q(j)}catch(Pt){V_(Pt)}j.currentTarget=null,q=Ye}}}}function Lr(p,g){var _=g[_t];_===void 0&&(_=g[_t]=new Set);var E=p+"__bubble";_.has(E)||(vL(g,p,2,!1),_.add(E))}function DR(p,g,_){var E=0;g&&(E|=4),vL(_,p,E,g)}var sS="_reactListening"+Math.random().toString(36).slice(2);function FR(p){if(!p[sS]){p[sS]=!0,hn.forEach(function(_){_!=="selectionchange"&&(hfe.has(_)||DR(_,!1,p),DR(_,!0,p))});var g=p.nodeType===9?p:p.ownerDocument;g===null||g[sS]||(g[sS]=!0,DR("selectionchange",!1,g))}}function vL(p,g,_,E){switch(qL(g)){case 2:var j=$fe;break;case 8:j=zfe;break;default:j=XR}_=j.bind(null,g,_,p),j=void 0,!Sb||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(j=!0),E?j!==void 0?p.addEventListener(g,_,{capture:!0,passive:j}):p.addEventListener(g,_,!0):j!==void 0?p.addEventListener(g,_,{passive:j}):p.addEventListener(g,_,!1)}function LR(p,g,_,E,j){var q=E;if((g&1)===0&&(g&2)===0&&E!==null)e:for(;;){if(E===null)return;var ue=E.tag;if(ue===3||ue===4){var Re=E.stateNode.containerInfo;if(Re===j)break;if(ue===4)for(ue=E.return;ue!==null;){var Ye=ue.tag;if((Ye===3||Ye===4)&&ue.stateNode.containerInfo===j)return;ue=ue.return}for(;Re!==null;){if(ue=mr(Re),ue===null)return;if(Ye=ue.tag,Ye===5||Ye===6||Ye===26||Ye===27){E=q=ue;continue e}Re=Re.parentNode}}E=E.return}yf(function(){var wt=q,Pt=rg(_),Bt=[];e:{var Ct=Jt.get(p);if(Ct!==void 0){var At=ig,sr=p;switch(p){case"keypress":if(xf(_)===0)break e;case"keydown":case"keyup":At=hg;break;case"focusin":sr="focus",At=wf;break;case"focusout":sr="blur",At=wf;break;case"beforeblur":case"afterblur":At=wf;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":At=lg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":At=h_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":At=Nb;break;case St:case Nt:case Mt:At=p_;break;case Ht:At=Mb;break;case"scroll":case"scrollend":At=ag;break;case"wheel":At=mg;break;case"copy":case"cut":case"paste":At=dg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":At=Rb;break;case"toggle":case"beforetoggle":At=y_}var Wn=(g&4)!==0,_s=!Wn&&(p==="scroll"||p==="scrollend"),ht=Wn?Ct!==null?Ct+"Capture":null:Ct;Wn=[];for(var rt=wt,xt;rt!==null;){var Ft=rt;if(xt=Ft.stateNode,Ft=Ft.tag,Ft!==5&&Ft!==26&&Ft!==27||xt===null||ht===null||(Ft=qu(rt,ht),Ft!=null&&Wn.push(uv(rt,Ft,xt))),_s)break;rt=rt.return}0<Wn.length&&(Ct=new At(Ct,sr,null,_,Pt),Bt.push({event:Ct,listeners:Wn}))}}if((g&7)===0){e:{if(Ct=p==="mouseover"||p==="pointerover",At=p==="mouseout"||p==="pointerout",Ct&&_!==bl&&(sr=_.relatedTarget||_.fromElement)&&(mr(sr)||sr[Ge]))break e;if((At||Ct)&&(Ct=Pt.window===Pt?Pt:(Ct=Pt.ownerDocument)?Ct.defaultView||Ct.parentWindow:window,At?(sr=_.relatedTarget||_.toElement,At=wt,sr=sr?mr(sr):null,sr!==null&&(_s=i(sr),Wn=sr.tag,sr!==_s||Wn!==5&&Wn!==27&&Wn!==6)&&(sr=null)):(At=null,sr=wt),At!==sr)){if(Wn=lg,Ft="onMouseLeave",ht="onMouseEnter",rt="mouse",(p==="pointerout"||p==="pointerover")&&(Wn=Rb,Ft="onPointerLeave",ht="onPointerEnter",rt="pointer"),_s=At==null?Ct:ns(At),xt=sr==null?Ct:ns(sr),Ct=new Wn(Ft,rt+"leave",At,_,Pt),Ct.target=_s,Ct.relatedTarget=xt,Ft=null,mr(Pt)===wt&&(Wn=new Wn(ht,rt+"enter",sr,_,Pt),Wn.target=xt,Wn.relatedTarget=_s,Ft=Wn),_s=Ft,At&&sr)t:{for(Wn=At,ht=sr,rt=0,xt=Wn;xt;xt=$g(xt))rt++;for(xt=0,Ft=ht;Ft;Ft=$g(Ft))xt++;for(;0<rt-xt;)Wn=$g(Wn),rt--;for(;0<xt-rt;)ht=$g(ht),xt--;for(;rt--;){if(Wn===ht||ht!==null&&Wn===ht.alternate)break t;Wn=$g(Wn),ht=$g(ht)}Wn=null}else Wn=null;At!==null&&xL(Bt,Ct,At,Wn,!1),sr!==null&&_s!==null&&xL(Bt,_s,sr,Wn,!0)}}e:{if(Ct=wt?ns(wt):window,At=Ct.nodeName&&Ct.nodeName.toLowerCase(),At==="select"||At==="input"&&Ct.type==="file")var bn=cp;else if(bg(Ct))if(xl)bn=Cf;else{bn=Ku;var Pr=S_}else At=Ct.nodeName,!At||At.toLowerCase()!=="input"||Ct.type!=="checkbox"&&Ct.type!=="radio"?wt&&_b(wt.elementType)&&(bn=cp):bn=Db;if(bn&&(bn=bn(p,wt))){Pb(Bt,bn,_,Pt);break e}Pr&&Pr(p,Ct,wt),p==="focusout"&&wt&&Ct.type==="number"&&wt.memoizedProps.value!=null&&hf(Ct,"number",Ct.value)}switch(Pr=wt?ns(wt):window,p){case"focusin":(bg(Pr)||Pr.contentEditable==="true")&&(He=Pr,nt=wt,it=null);break;case"focusout":it=nt=He=null;break;case"mousedown":dt=!0;break;case"contextmenu":case"mouseup":case"dragend":dt=!1,Je(Bt,_,Pt);break;case"selectionchange":if(Le)break;case"keydown":case"keyup":Je(Bt,_,Pt)}var In;if(op)e:{switch(p){case"compositionstart":var Kn="onCompositionStart";break e;case"compositionend":Kn="onCompositionEnd";break e;case"compositionupdate":Kn="onCompositionUpdate";break e}Kn=void 0}else Gu?Ob(p,_)&&(Kn="onCompositionEnd"):p==="keydown"&&_.keyCode===229&&(Kn="onCompositionStart");Kn&&(gg&&_.locale!=="ko"&&(Gu||Kn!=="onCompositionStart"?Kn==="onCompositionEnd"&&Gu&&(In=vf()):(vl=Pt,sg="value"in vl?vl.value:vl.textContent,Gu=!0)),Pr=iS(wt,Kn),0<Pr.length&&(Kn=new fg(Kn,p,null,_,Pt),Bt.push({event:Kn,listeners:Pr}),In?Kn.data=In:(In=v_(_),In!==null&&(Kn.data=In)))),(In=bA?x_(p,_):vA(p,_))&&(Kn=iS(wt,"onBeforeInput"),0<Kn.length&&(Pr=new fg("onBeforeInput","beforeinput",null,_,Pt),Bt.push({event:Pr,listeners:Kn}),Pr.data=In)),ufe(Bt,p,wt,_,Pt)}bL(Bt,g)})}function uv(p,g,_){return{instance:p,listener:g,currentTarget:_}}function iS(p,g){for(var _=g+"Capture",E=[];p!==null;){var j=p,q=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||q===null||(j=qu(p,_),j!=null&&E.unshift(uv(p,j,q)),j=qu(p,g),j!=null&&E.push(uv(p,j,q))),p.tag===3)return E;p=p.return}return[]}function $g(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function xL(p,g,_,E,j){for(var q=g._reactName,ue=[];_!==null&&_!==E;){var Re=_,Ye=Re.alternate,wt=Re.stateNode;if(Re=Re.tag,Ye!==null&&Ye===E)break;Re!==5&&Re!==26&&Re!==27||wt===null||(Ye=wt,j?(wt=qu(_,q),wt!=null&&ue.unshift(uv(_,wt,Ye))):j||(wt=qu(_,q),wt!=null&&ue.push(uv(_,wt,Ye)))),_=_.return}ue.length!==0&&p.push({event:g,listeners:ue})}var pfe=/\r\n?/g,mfe=/\u0000|\uFFFD/g;function wL(p){return(typeof p=="string"?p:""+p).replace(pfe,`
`).replace(mfe,"")}function _L(p,g){return g=wL(g),wL(p)===g}function aS(){}function ws(p,g,_,E,j,q){switch(_){case"children":typeof E=="string"?g==="body"||g==="textarea"&&E===""||mf(p,E):(typeof E=="number"||typeof E=="bigint")&&g!=="body"&&mf(p,""+E);break;case"className":qa(p,"class",E);break;case"tabIndex":qa(p,"tabindex",E);break;case"dir":case"role":case"viewBox":case"width":case"height":qa(p,_,E);break;case"style":d_(p,E,q);break;case"data":if(g!=="object"){qa(p,"data",E);break}case"src":case"href":if(E===""&&(g!=="a"||_!=="href")){p.removeAttribute(_);break}if(E==null||typeof E=="function"||typeof E=="symbol"||typeof E=="boolean"){p.removeAttribute(_);break}E=$u(""+E),p.setAttribute(_,E);break;case"action":case"formAction":if(typeof E=="function"){p.setAttribute(_,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof q=="function"&&(_==="formAction"?(g!=="input"&&ws(p,g,"name",j.name,j,null),ws(p,g,"formEncType",j.formEncType,j,null),ws(p,g,"formMethod",j.formMethod,j,null),ws(p,g,"formTarget",j.formTarget,j,null)):(ws(p,g,"encType",j.encType,j,null),ws(p,g,"method",j.method,j,null),ws(p,g,"target",j.target,j,null)));if(E==null||typeof E=="symbol"||typeof E=="boolean"){p.removeAttribute(_);break}E=$u(""+E),p.setAttribute(_,E);break;case"onClick":E!=null&&(p.onclick=aS);break;case"onScroll":E!=null&&Lr("scroll",p);break;case"onScrollEnd":E!=null&&Lr("scrollend",p);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(r(61));if(_=E.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"multiple":p.multiple=E&&typeof E!="function"&&typeof E!="symbol";break;case"muted":p.muted=E&&typeof E!="function"&&typeof E!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(E==null||typeof E=="function"||typeof E=="boolean"||typeof E=="symbol"){p.removeAttribute("xlink:href");break}_=$u(""+E),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",_);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":E!=null&&typeof E!="function"&&typeof E!="symbol"?p.setAttribute(_,""+E):p.removeAttribute(_);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":E&&typeof E!="function"&&typeof E!="symbol"?p.setAttribute(_,""):p.removeAttribute(_);break;case"capture":case"download":E===!0?p.setAttribute(_,""):E!==!1&&E!=null&&typeof E!="function"&&typeof E!="symbol"?p.setAttribute(_,E):p.removeAttribute(_);break;case"cols":case"rows":case"size":case"span":E!=null&&typeof E!="function"&&typeof E!="symbol"&&!isNaN(E)&&1<=E?p.setAttribute(_,E):p.removeAttribute(_);break;case"rowSpan":case"start":E==null||typeof E=="function"||typeof E=="symbol"||isNaN(E)?p.removeAttribute(_):p.setAttribute(_,E);break;case"popover":Lr("beforetoggle",p),Lr("toggle",p),li(p,"popover",E);break;case"xlinkActuate":ca(p,"http://www.w3.org/1999/xlink","xlink:actuate",E);break;case"xlinkArcrole":ca(p,"http://www.w3.org/1999/xlink","xlink:arcrole",E);break;case"xlinkRole":ca(p,"http://www.w3.org/1999/xlink","xlink:role",E);break;case"xlinkShow":ca(p,"http://www.w3.org/1999/xlink","xlink:show",E);break;case"xlinkTitle":ca(p,"http://www.w3.org/1999/xlink","xlink:title",E);break;case"xlinkType":ca(p,"http://www.w3.org/1999/xlink","xlink:type",E);break;case"xmlBase":ca(p,"http://www.w3.org/XML/1998/namespace","xml:base",E);break;case"xmlLang":ca(p,"http://www.w3.org/XML/1998/namespace","xml:lang",E);break;case"xmlSpace":ca(p,"http://www.w3.org/XML/1998/namespace","xml:space",E);break;case"is":li(p,"is",E);break;case"innerText":case"textContent":break;default:(!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(_=Wa.get(_)||_,li(p,_,E))}}function BR(p,g,_,E,j,q){switch(_){case"style":d_(p,E,q);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(r(61));if(_=E.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"children":typeof E=="string"?mf(p,E):(typeof E=="number"||typeof E=="bigint")&&mf(p,""+E);break;case"onScroll":E!=null&&Lr("scroll",p);break;case"onScrollEnd":E!=null&&Lr("scrollend",p);break;case"onClick":E!=null&&(p.onclick=aS);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!et.hasOwnProperty(_))e:{if(_[0]==="o"&&_[1]==="n"&&(j=_.endsWith("Capture"),g=_.slice(2,j?_.length-7:void 0),q=p[Pe]||null,q=q!=null?q[_]:null,typeof q=="function"&&p.removeEventListener(g,q,j),typeof E=="function")){typeof q!="function"&&q!==null&&(_ in p?p[_]=null:p.hasAttribute(_)&&p.removeAttribute(_)),p.addEventListener(g,E,j);break e}_ in p?p[_]=E:E===!0?p.setAttribute(_,""):li(p,_,E)}}}function ha(p,g,_){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Lr("error",p),Lr("load",p);var E=!1,j=!1,q;for(q in _)if(_.hasOwnProperty(q)){var ue=_[q];if(ue!=null)switch(q){case"src":E=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:ws(p,g,q,ue,_,null)}}j&&ws(p,g,"srcSet",_.srcSet,_,null),E&&ws(p,g,"src",_.src,_,null);return;case"input":Lr("invalid",p);var Re=q=ue=j=null,Ye=null,wt=null;for(E in _)if(_.hasOwnProperty(E)){var Pt=_[E];if(Pt!=null)switch(E){case"name":j=Pt;break;case"type":ue=Pt;break;case"checked":Ye=Pt;break;case"defaultChecked":wt=Pt;break;case"value":q=Pt;break;case"defaultValue":Re=Pt;break;case"children":case"dangerouslySetInnerHTML":if(Pt!=null)throw Error(r(137,g));break;default:ws(p,g,E,Pt,_,null)}}xb(p,q,Re,Ye,wt,ue,j,!1),Fc(p);return;case"select":Lr("invalid",p),E=ue=q=null;for(j in _)if(_.hasOwnProperty(j)&&(Re=_[j],Re!=null))switch(j){case"value":q=Re;break;case"defaultValue":ue=Re;break;case"multiple":E=Re;default:ws(p,g,j,Re,_,null)}g=q,_=ue,p.multiple=!!E,g!=null?Bu(p,!!E,g,!1):_!=null&&Bu(p,!!E,_,!0);return;case"textarea":Lr("invalid",p),q=j=E=null;for(ue in _)if(_.hasOwnProperty(ue)&&(Re=_[ue],Re!=null))switch(ue){case"value":E=Re;break;case"defaultValue":j=Re;break;case"children":q=Re;break;case"dangerouslySetInnerHTML":if(Re!=null)throw Error(r(91));break;default:ws(p,g,ue,Re,_,null)}wb(p,E,j,q),Fc(p);return;case"option":for(Ye in _)if(_.hasOwnProperty(Ye)&&(E=_[Ye],E!=null))switch(Ye){case"selected":p.selected=E&&typeof E!="function"&&typeof E!="symbol";break;default:ws(p,g,Ye,E,_,null)}return;case"dialog":Lr("beforetoggle",p),Lr("toggle",p),Lr("cancel",p),Lr("close",p);break;case"iframe":case"object":Lr("load",p);break;case"video":case"audio":for(E=0;E<cv.length;E++)Lr(cv[E],p);break;case"image":Lr("error",p),Lr("load",p);break;case"details":Lr("toggle",p);break;case"embed":case"source":case"link":Lr("error",p),Lr("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(wt in _)if(_.hasOwnProperty(wt)&&(E=_[wt],E!=null))switch(wt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:ws(p,g,wt,E,_,null)}return;default:if(_b(g)){for(Pt in _)_.hasOwnProperty(Pt)&&(E=_[Pt],E!==void 0&&BR(p,g,Pt,E,_,void 0));return}}for(Re in _)_.hasOwnProperty(Re)&&(E=_[Re],E!=null&&ws(p,g,Re,E,_,null))}function gfe(p,g,_,E){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,q=null,ue=null,Re=null,Ye=null,wt=null,Pt=null;for(At in _){var Bt=_[At];if(_.hasOwnProperty(At)&&Bt!=null)switch(At){case"checked":break;case"value":break;case"defaultValue":Ye=Bt;default:E.hasOwnProperty(At)||ws(p,g,At,null,E,Bt)}}for(var Ct in E){var At=E[Ct];if(Bt=_[Ct],E.hasOwnProperty(Ct)&&(At!=null||Bt!=null))switch(Ct){case"type":q=At;break;case"name":j=At;break;case"checked":wt=At;break;case"defaultChecked":Pt=At;break;case"value":ue=At;break;case"defaultValue":Re=At;break;case"children":case"dangerouslySetInnerHTML":if(At!=null)throw Error(r(137,g));break;default:At!==Bt&&ws(p,g,Ct,At,E,Bt)}}ff(p,ue,Re,Ye,wt,Pt,q,j);return;case"select":At=ue=Re=Ct=null;for(q in _)if(Ye=_[q],_.hasOwnProperty(q)&&Ye!=null)switch(q){case"value":break;case"multiple":At=Ye;default:E.hasOwnProperty(q)||ws(p,g,q,null,E,Ye)}for(j in E)if(q=E[j],Ye=_[j],E.hasOwnProperty(j)&&(q!=null||Ye!=null))switch(j){case"value":Ct=q;break;case"defaultValue":Re=q;break;case"multiple":ue=q;default:q!==Ye&&ws(p,g,j,q,E,Ye)}g=Re,_=ue,E=At,Ct!=null?Bu(p,!!_,Ct,!1):!!E!=!!_&&(g!=null?Bu(p,!!_,g,!0):Bu(p,!!_,_?[]:"",!1));return;case"textarea":At=Ct=null;for(Re in _)if(j=_[Re],_.hasOwnProperty(Re)&&j!=null&&!E.hasOwnProperty(Re))switch(Re){case"value":break;case"children":break;default:ws(p,g,Re,null,E,j)}for(ue in E)if(j=E[ue],q=_[ue],E.hasOwnProperty(ue)&&(j!=null||q!=null))switch(ue){case"value":Ct=j;break;case"defaultValue":At=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(r(91));break;default:j!==q&&ws(p,g,ue,j,E,q)}pf(p,Ct,At);return;case"option":for(var sr in _)if(Ct=_[sr],_.hasOwnProperty(sr)&&Ct!=null&&!E.hasOwnProperty(sr))switch(sr){case"selected":p.selected=!1;break;default:ws(p,g,sr,null,E,Ct)}for(Ye in E)if(Ct=E[Ye],At=_[Ye],E.hasOwnProperty(Ye)&&Ct!==At&&(Ct!=null||At!=null))switch(Ye){case"selected":p.selected=Ct&&typeof Ct!="function"&&typeof Ct!="symbol";break;default:ws(p,g,Ye,Ct,E,At)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Wn in _)Ct=_[Wn],_.hasOwnProperty(Wn)&&Ct!=null&&!E.hasOwnProperty(Wn)&&ws(p,g,Wn,null,E,Ct);for(wt in E)if(Ct=E[wt],At=_[wt],E.hasOwnProperty(wt)&&Ct!==At&&(Ct!=null||At!=null))switch(wt){case"children":case"dangerouslySetInnerHTML":if(Ct!=null)throw Error(r(137,g));break;default:ws(p,g,wt,Ct,E,At)}return;default:if(_b(g)){for(var _s in _)Ct=_[_s],_.hasOwnProperty(_s)&&Ct!==void 0&&!E.hasOwnProperty(_s)&&BR(p,g,_s,void 0,E,Ct);for(Pt in E)Ct=E[Pt],At=_[Pt],!E.hasOwnProperty(Pt)||Ct===At||Ct===void 0&&At===void 0||BR(p,g,Pt,Ct,E,At);return}}for(var ht in _)Ct=_[ht],_.hasOwnProperty(ht)&&Ct!=null&&!E.hasOwnProperty(ht)&&ws(p,g,ht,null,E,Ct);for(Bt in E)Ct=E[Bt],At=_[Bt],!E.hasOwnProperty(Bt)||Ct===At||Ct==null&&At==null||ws(p,g,Bt,Ct,E,At)}var $R=null,zR=null;function oS(p){return p.nodeType===9?p:p.ownerDocument}function SL(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function CL(p,g){if(p===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&g==="foreignObject"?0:p}function UR(p,g){return p==="textarea"||p==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var qR=null;function yfe(){var p=window.event;return p&&p.type==="popstate"?p===qR?!1:(qR=p,!0):(qR=null,!1)}var kL=typeof setTimeout=="function"?setTimeout:void 0,bfe=typeof clearTimeout=="function"?clearTimeout:void 0,EL=typeof Promise=="function"?Promise:void 0,vfe=typeof queueMicrotask=="function"?queueMicrotask:typeof EL<"u"?function(p){return EL.resolve(null).then(p).catch(xfe)}:kL;function xfe(p){setTimeout(function(){throw p})}function $f(p){return p==="head"}function TL(p,g){var _=g,E=0,j=0;do{var q=_.nextSibling;if(p.removeChild(_),q&&q.nodeType===8)if(_=q.data,_==="/$"){if(0<E&&8>E){_=E;var ue=p.ownerDocument;if(_&1&&dv(ue.documentElement),_&2&&dv(ue.body),_&4)for(_=ue.head,dv(_),ue=_.firstChild;ue;){var Re=ue.nextSibling,Ye=ue.nodeName;ue[nn]||Ye==="SCRIPT"||Ye==="STYLE"||Ye==="LINK"&&ue.rel.toLowerCase()==="stylesheet"||_.removeChild(ue),ue=Re}}if(j===0){p.removeChild(q),vv(g);return}j--}else _==="$"||_==="$?"||_==="$!"?j++:E=_.charCodeAt(0)-48;else E=0;_=q}while(_);vv(g)}function VR(p){var g=p.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var _=g;switch(g=g.nextSibling,_.nodeName){case"HTML":case"HEAD":case"BODY":VR(_),un(_);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(_.rel.toLowerCase()==="stylesheet")continue}p.removeChild(_)}}function wfe(p,g,_,E){for(;p.nodeType===1;){var j=_;if(p.nodeName.toLowerCase()!==g.toLowerCase()){if(!E&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(E){if(!p[nn])switch(g){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(q=p.getAttribute("rel"),q==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(q!==j.rel||p.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||p.getAttribute("title")!==(j.title==null?null:j.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(q=p.getAttribute("src"),(q!==(j.src==null?null:j.src)||p.getAttribute("type")!==(j.type==null?null:j.type)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&q&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(g==="input"&&p.type==="hidden"){var q=j.name==null?null:""+j.name;if(j.type==="hidden"&&p.getAttribute("name")===q)return p}else return p;if(p=tc(p.nextSibling),p===null)break}return null}function _fe(p,g,_){if(g==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!_||(p=tc(p.nextSibling),p===null))return null;return p}function WR(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState==="complete"}function Sfe(p,g){var _=p.ownerDocument;if(p.data!=="$?"||_.readyState==="complete")g();else{var E=function(){g(),_.removeEventListener("DOMContentLoaded",E)};_.addEventListener("DOMContentLoaded",E),p._reactRetry=E}}function tc(p){for(;p!=null;p=p.nextSibling){var g=p.nodeType;if(g===1||g===3)break;if(g===8){if(g=p.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return p}var HR=null;function AL(p){p=p.previousSibling;for(var g=0;p;){if(p.nodeType===8){var _=p.data;if(_==="$"||_==="$!"||_==="$?"){if(g===0)return p;g--}else _==="/$"&&g++}p=p.previousSibling}return null}function RL(p,g,_){switch(g=oS(_),p){case"html":if(p=g.documentElement,!p)throw Error(r(452));return p;case"head":if(p=g.head,!p)throw Error(r(453));return p;case"body":if(p=g.body,!p)throw Error(r(454));return p;default:throw Error(r(451))}}function dv(p){for(var g=p.attributes;g.length;)p.removeAttributeNode(g[0]);un(p)}var El=new Map,NL=new Set;function lS(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var od=H.d;H.d={f:Cfe,r:kfe,D:Efe,C:Tfe,L:Afe,m:Rfe,X:Mfe,S:Nfe,M:Ife};function Cfe(){var p=od.f(),g=Q_();return p||g}function kfe(p){var g=Ar(p);g!==null&&g.tag===5&&g.type==="form"?ZF(g):od.r(p)}var zg=typeof document>"u"?null:document;function ML(p,g,_){var E=zg;if(E&&typeof g=="string"&&g){var j=Sa(g);j='link[rel="'+p+'"][href="'+j+'"]',typeof _=="string"&&(j+='[crossorigin="'+_+'"]'),NL.has(j)||(NL.add(j),p={rel:p,crossOrigin:_,href:g},E.querySelector(j)===null&&(g=E.createElement("link"),ha(g,"link",p),Cr(g),E.head.appendChild(g)))}}function Efe(p){od.D(p),ML("dns-prefetch",p,null)}function Tfe(p,g){od.C(p,g),ML("preconnect",p,g)}function Afe(p,g,_){od.L(p,g,_);var E=zg;if(E&&p&&g){var j='link[rel="preload"][as="'+Sa(g)+'"]';g==="image"&&_&&_.imageSrcSet?(j+='[imagesrcset="'+Sa(_.imageSrcSet)+'"]',typeof _.imageSizes=="string"&&(j+='[imagesizes="'+Sa(_.imageSizes)+'"]')):j+='[href="'+Sa(p)+'"]';var q=j;switch(g){case"style":q=Ug(p);break;case"script":q=qg(p)}El.has(q)||(p=u({rel:"preload",href:g==="image"&&_&&_.imageSrcSet?void 0:p,as:g},_),El.set(q,p),E.querySelector(j)!==null||g==="style"&&E.querySelector(fv(q))||g==="script"&&E.querySelector(hv(q))||(g=E.createElement("link"),ha(g,"link",p),Cr(g),E.head.appendChild(g)))}}function Rfe(p,g){od.m(p,g);var _=zg;if(_&&p){var E=g&&typeof g.as=="string"?g.as:"script",j='link[rel="modulepreload"][as="'+Sa(E)+'"][href="'+Sa(p)+'"]',q=j;switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":q=qg(p)}if(!El.has(q)&&(p=u({rel:"modulepreload",href:p},g),El.set(q,p),_.querySelector(j)===null)){switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(_.querySelector(hv(q)))return}E=_.createElement("link"),ha(E,"link",p),Cr(E),_.head.appendChild(E)}}}function Nfe(p,g,_){od.S(p,g,_);var E=zg;if(E&&p){var j=rs(E).hoistableStyles,q=Ug(p);g=g||"default";var ue=j.get(q);if(!ue){var Re={loading:0,preload:null};if(ue=E.querySelector(fv(q)))Re.loading=5;else{p=u({rel:"stylesheet",href:p,"data-precedence":g},_),(_=El.get(q))&&GR(p,_);var Ye=ue=E.createElement("link");Cr(Ye),ha(Ye,"link",p),Ye._p=new Promise(function(wt,Pt){Ye.onload=wt,Ye.onerror=Pt}),Ye.addEventListener("load",function(){Re.loading|=1}),Ye.addEventListener("error",function(){Re.loading|=2}),Re.loading|=4,cS(ue,g,E)}ue={type:"stylesheet",instance:ue,count:1,state:Re},j.set(q,ue)}}}function Mfe(p,g){od.X(p,g);var _=zg;if(_&&p){var E=rs(_).hoistableScripts,j=qg(p),q=E.get(j);q||(q=_.querySelector(hv(j)),q||(p=u({src:p,async:!0},g),(g=El.get(j))&&KR(p,g),q=_.createElement("script"),Cr(q),ha(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},E.set(j,q))}}function Ife(p,g){od.M(p,g);var _=zg;if(_&&p){var E=rs(_).hoistableScripts,j=qg(p),q=E.get(j);q||(q=_.querySelector(hv(j)),q||(p=u({src:p,async:!0,type:"module"},g),(g=El.get(j))&&KR(p,g),q=_.createElement("script"),Cr(q),ha(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},E.set(j,q))}}function IL(p,g,_,E){var j=(j=Ie.current)?lS(j):null;if(!j)throw Error(r(446));switch(p){case"meta":case"title":return null;case"style":return typeof _.precedence=="string"&&typeof _.href=="string"?(g=Ug(_.href),_=rs(j).hoistableStyles,E=_.get(g),E||(E={type:"style",instance:null,count:0,state:null},_.set(g,E)),E):{type:"void",instance:null,count:0,state:null};case"link":if(_.rel==="stylesheet"&&typeof _.href=="string"&&typeof _.precedence=="string"){p=Ug(_.href);var q=rs(j).hoistableStyles,ue=q.get(p);if(ue||(j=j.ownerDocument||j,ue={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},q.set(p,ue),(q=j.querySelector(fv(p)))&&!q._p&&(ue.instance=q,ue.state.loading=5),El.has(p)||(_={rel:"preload",as:"style",href:_.href,crossOrigin:_.crossOrigin,integrity:_.integrity,media:_.media,hrefLang:_.hrefLang,referrerPolicy:_.referrerPolicy},El.set(p,_),q||jfe(j,p,_,ue.state))),g&&E===null)throw Error(r(528,""));return ue}if(g&&E!==null)throw Error(r(529,""));return null;case"script":return g=_.async,_=_.src,typeof _=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=qg(_),_=rs(j).hoistableScripts,E=_.get(g),E||(E={type:"script",instance:null,count:0,state:null},_.set(g,E)),E):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,p))}}function Ug(p){return'href="'+Sa(p)+'"'}function fv(p){return'link[rel="stylesheet"]['+p+"]"}function jL(p){return u({},p,{"data-precedence":p.precedence,precedence:null})}function jfe(p,g,_,E){p.querySelector('link[rel="preload"][as="style"]['+g+"]")?E.loading=1:(g=p.createElement("link"),E.preload=g,g.addEventListener("load",function(){return E.loading|=1}),g.addEventListener("error",function(){return E.loading|=2}),ha(g,"link",_),Cr(g),p.head.appendChild(g))}function qg(p){return'[src="'+Sa(p)+'"]'}function hv(p){return"script[async]"+p}function OL(p,g,_){if(g.count++,g.instance===null)switch(g.type){case"style":var E=p.querySelector('style[data-href~="'+Sa(_.href)+'"]');if(E)return g.instance=E,Cr(E),E;var j=u({},_,{"data-href":_.href,"data-precedence":_.precedence,href:null,precedence:null});return E=(p.ownerDocument||p).createElement("style"),Cr(E),ha(E,"style",j),cS(E,_.precedence,p),g.instance=E;case"stylesheet":j=Ug(_.href);var q=p.querySelector(fv(j));if(q)return g.state.loading|=4,g.instance=q,Cr(q),q;E=jL(_),(j=El.get(j))&&GR(E,j),q=(p.ownerDocument||p).createElement("link"),Cr(q);var ue=q;return ue._p=new Promise(function(Re,Ye){ue.onload=Re,ue.onerror=Ye}),ha(q,"link",E),g.state.loading|=4,cS(q,_.precedence,p),g.instance=q;case"script":return q=qg(_.src),(j=p.querySelector(hv(q)))?(g.instance=j,Cr(j),j):(E=_,(j=El.get(q))&&(E=u({},_),KR(E,j)),p=p.ownerDocument||p,j=p.createElement("script"),Cr(j),ha(j,"link",E),p.head.appendChild(j),g.instance=j);case"void":return null;default:throw Error(r(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(E=g.instance,g.state.loading|=4,cS(E,_.precedence,p));return g.instance}function cS(p,g,_){for(var E=_.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=E.length?E[E.length-1]:null,q=j,ue=0;ue<E.length;ue++){var Re=E[ue];if(Re.dataset.precedence===g)q=Re;else if(q!==j)break}q?q.parentNode.insertBefore(p,q.nextSibling):(g=_.nodeType===9?_.head:_,g.insertBefore(p,g.firstChild))}function GR(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.title==null&&(p.title=g.title)}function KR(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.integrity==null&&(p.integrity=g.integrity)}var uS=null;function PL(p,g,_){if(uS===null){var E=new Map,j=uS=new Map;j.set(_,E)}else j=uS,E=j.get(_),E||(E=new Map,j.set(_,E));if(E.has(p))return E;for(E.set(p,null),_=_.getElementsByTagName(p),j=0;j<_.length;j++){var q=_[j];if(!(q[nn]||q[be]||p==="link"&&q.getAttribute("rel")==="stylesheet")&&q.namespaceURI!=="http://www.w3.org/2000/svg"){var ue=q.getAttribute(g)||"";ue=p+ue;var Re=E.get(ue);Re?Re.push(q):E.set(ue,[q])}}return E}function DL(p,g,_){p=p.ownerDocument||p,p.head.insertBefore(_,g==="title"?p.querySelector("head > title"):null)}function Ofe(p,g,_){if(_===1||g.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return p=g.disabled,typeof g.precedence=="string"&&p==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function FL(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}var pv=null;function Pfe(){}function Dfe(p,g,_){if(pv===null)throw Error(r(475));var E=pv;if(g.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var j=Ug(_.href),q=p.querySelector(fv(j));if(q){p=q._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(E.count++,E=dS.bind(E),p.then(E,E)),g.state.loading|=4,g.instance=q,Cr(q);return}q=p.ownerDocument||p,_=jL(_),(j=El.get(j))&&GR(_,j),q=q.createElement("link"),Cr(q);var ue=q;ue._p=new Promise(function(Re,Ye){ue.onload=Re,ue.onerror=Ye}),ha(q,"link",_),g.instance=q}E.stylesheets===null&&(E.stylesheets=new Map),E.stylesheets.set(g,p),(p=g.state.preload)&&(g.state.loading&3)===0&&(E.count++,g=dS.bind(E),p.addEventListener("load",g),p.addEventListener("error",g))}}function Ffe(){if(pv===null)throw Error(r(475));var p=pv;return p.stylesheets&&p.count===0&&YR(p,p.stylesheets),0<p.count?function(g){var _=setTimeout(function(){if(p.stylesheets&&YR(p,p.stylesheets),p.unsuspend){var E=p.unsuspend;p.unsuspend=null,E()}},6e4);return p.unsuspend=g,function(){p.unsuspend=null,clearTimeout(_)}}:null}function dS(){if(this.count--,this.count===0){if(this.stylesheets)YR(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var fS=null;function YR(p,g){p.stylesheets=null,p.unsuspend!==null&&(p.count++,fS=new Map,g.forEach(Lfe,p),fS=null,dS.call(p))}function Lfe(p,g){if(!(g.state.loading&4)){var _=fS.get(p);if(_)var E=_.get(null);else{_=new Map,fS.set(p,_);for(var j=p.querySelectorAll("link[data-precedence],style[data-precedence]"),q=0;q<j.length;q++){var ue=j[q];(ue.nodeName==="LINK"||ue.getAttribute("media")!=="not all")&&(_.set(ue.dataset.precedence,ue),E=ue)}E&&_.set(null,E)}j=g.instance,ue=j.getAttribute("data-precedence"),q=_.get(ue)||E,q===E&&_.set(null,j),_.set(ue,j),this.count++,E=dS.bind(this),j.addEventListener("load",E),j.addEventListener("error",E),q?q.parentNode.insertBefore(j,q.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(j,p.firstChild)),g.state.loading|=4}}var mv={$$typeof:S,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function Bfe(p,g,_,E,j,q,ue,Re){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ze(0),this.hiddenUpdates=ze(null),this.identifierPrefix=E,this.onUncaughtError=j,this.onCaughtError=q,this.onRecoverableError=ue,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Re,this.incompleteTransitions=new Map}function LL(p,g,_,E,j,q,ue,Re,Ye,wt,Pt,Bt){return p=new Bfe(p,g,_,ue,Re,Ye,wt,Bt),g=1,q===!0&&(g|=24),q=qo(3,null,null,g),p.current=q,q.stateNode=p,g=NA(),g.refCount++,p.pooledCache=g,g.refCount++,q.memoizedState={element:E,isDehydrated:_,cache:g},OA(q),p}function BL(p){return p?(p=zc,p):zc}function $L(p,g,_,E,j,q){j=BL(j),E.context===null?E.context=j:E.pendingContext=j,E=Tf(g),E.payload={element:_},q=q===void 0?null:q,q!==null&&(E.callback=q),_=Af(p,E,g),_!==null&&(Ko(_,p,g),Wb(_,p,g))}function zL(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var _=p.retryLane;p.retryLane=_!==0&&_<g?_:g}}function ZR(p,g){zL(p,g),(p=p.alternate)&&zL(p,g)}function UL(p){if(p.tag===13){var g=Ql(p,67108864);g!==null&&Ko(g,p,67108864),ZR(p,67108864)}}var hS=!0;function $fe(p,g,_,E){var j=U.T;U.T=null;var q=H.p;try{H.p=2,XR(p,g,_,E)}finally{H.p=q,U.T=j}}function zfe(p,g,_,E){var j=U.T;U.T=null;var q=H.p;try{H.p=8,XR(p,g,_,E)}finally{H.p=q,U.T=j}}function XR(p,g,_,E){if(hS){var j=JR(E);if(j===null)LR(p,g,E,pS,_),VL(p,E);else if(qfe(j,p,g,_,E))E.stopPropagation();else if(VL(p,E),g&4&&-1<Ufe.indexOf(p)){for(;j!==null;){var q=Ar(j);if(q!==null)switch(q.tag){case 3:if(q=q.stateNode,q.current.memoizedState.isDehydrated){var ue=we(q.pendingLanes);if(ue!==0){var Re=q;for(Re.pendingLanes|=2,Re.entangledLanes|=2;ue;){var Ye=1<<31-en(ue);Re.entanglements[1]|=Ye,ue&=~Ye}Hc(q),(ms&6)===0&&(X_=le()+500,lv(0))}}break;case 13:Re=Ql(q,2),Re!==null&&Ko(Re,q,2),Q_(),ZR(q,2)}if(q=JR(E),q===null&&LR(p,g,E,pS,_),q===j)break;j=q}j!==null&&E.stopPropagation()}else LR(p,g,E,null,_)}}function JR(p){return p=rg(p),QR(p)}var pS=null;function QR(p){if(pS=null,p=mr(p),p!==null){var g=i(p);if(g===null)p=null;else{var _=g.tag;if(_===13){if(p=a(g),p!==null)return p;p=null}else if(_===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;p=null}else g!==p&&(p=null)}}return pS=p,null}function qL(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oe()){case re:return 2;case Te:return 8;case Be:case ke:return 32;case lt:return 268435456;default:return 32}default:return 32}}var eN=!1,zf=null,Uf=null,qf=null,gv=new Map,yv=new Map,Vf=[],Ufe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function VL(p,g){switch(p){case"focusin":case"focusout":zf=null;break;case"dragenter":case"dragleave":Uf=null;break;case"mouseover":case"mouseout":qf=null;break;case"pointerover":case"pointerout":gv.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":yv.delete(g.pointerId)}}function bv(p,g,_,E,j,q){return p===null||p.nativeEvent!==q?(p={blockedOn:g,domEventName:_,eventSystemFlags:E,nativeEvent:q,targetContainers:[j]},g!==null&&(g=Ar(g),g!==null&&UL(g)),p):(p.eventSystemFlags|=E,g=p.targetContainers,j!==null&&g.indexOf(j)===-1&&g.push(j),p)}function qfe(p,g,_,E,j){switch(g){case"focusin":return zf=bv(zf,p,g,_,E,j),!0;case"dragenter":return Uf=bv(Uf,p,g,_,E,j),!0;case"mouseover":return qf=bv(qf,p,g,_,E,j),!0;case"pointerover":var q=j.pointerId;return gv.set(q,bv(gv.get(q)||null,p,g,_,E,j)),!0;case"gotpointercapture":return q=j.pointerId,yv.set(q,bv(yv.get(q)||null,p,g,_,E,j)),!0}return!1}function WL(p){var g=mr(p.target);if(g!==null){var _=i(g);if(_!==null){if(g=_.tag,g===13){if(g=a(_),g!==null){p.blockedOn=g,G(p.priority,function(){if(_.tag===13){var E=Go();E=kt(E);var j=Ql(_,E);j!==null&&Ko(j,_,E),ZR(_,E)}});return}}else if(g===3&&_.stateNode.current.memoizedState.isDehydrated){p.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}p.blockedOn=null}function mS(p){if(p.blockedOn!==null)return!1;for(var g=p.targetContainers;0<g.length;){var _=JR(p.nativeEvent);if(_===null){_=p.nativeEvent;var E=new _.constructor(_.type,_);bl=E,_.target.dispatchEvent(E),bl=null}else return g=Ar(_),g!==null&&UL(g),p.blockedOn=_,!1;g.shift()}return!0}function HL(p,g,_){mS(p)&&_.delete(g)}function Vfe(){eN=!1,zf!==null&&mS(zf)&&(zf=null),Uf!==null&&mS(Uf)&&(Uf=null),qf!==null&&mS(qf)&&(qf=null),gv.forEach(HL),yv.forEach(HL)}function gS(p,g){p.blockedOn===g&&(p.blockedOn=null,eN||(eN=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Vfe)))}var yS=null;function GL(p){yS!==p&&(yS=p,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){yS===p&&(yS=null);for(var g=0;g<p.length;g+=3){var _=p[g],E=p[g+1],j=p[g+2];if(typeof E!="function"){if(QR(E||_)===null)continue;break}var q=Ar(_);q!==null&&(p.splice(g,3),g-=3,QA(q,{pending:!0,data:j,method:_.method,action:E},E,j))}}))}function vv(p){function g(Ye){return gS(Ye,p)}zf!==null&&gS(zf,p),Uf!==null&&gS(Uf,p),qf!==null&&gS(qf,p),gv.forEach(g),yv.forEach(g);for(var _=0;_<Vf.length;_++){var E=Vf[_];E.blockedOn===p&&(E.blockedOn=null)}for(;0<Vf.length&&(_=Vf[0],_.blockedOn===null);)WL(_),_.blockedOn===null&&Vf.shift();if(_=(p.ownerDocument||p).$$reactFormReplay,_!=null)for(E=0;E<_.length;E+=3){var j=_[E],q=_[E+1],ue=j[Pe]||null;if(typeof q=="function")ue||GL(_);else if(ue){var Re=null;if(q&&q.hasAttribute("formAction")){if(j=q,ue=q[Pe]||null)Re=ue.formAction;else if(QR(j)!==null)continue}else Re=ue.action;typeof Re=="function"?_[E+1]=Re:(_.splice(E,3),E-=3),GL(_)}}}function tN(p){this._internalRoot=p}bS.prototype.render=tN.prototype.render=function(p){var g=this._internalRoot;if(g===null)throw Error(r(409));var _=g.current,E=Go();$L(_,E,p,g,null,null)},bS.prototype.unmount=tN.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var g=p.containerInfo;$L(p.current,2,null,p,null,null),Q_(),g[Ge]=null}};function bS(p){this._internalRoot=p}bS.prototype.unstable_scheduleHydration=function(p){if(p){var g=Y();p={blockedOn:null,target:p,priority:g};for(var _=0;_<Vf.length&&g!==0&&g<Vf[_].priority;_++);Vf.splice(_,0,p),_===0&&WL(p)}};var KL=t.version;if(KL!=="19.1.0")throw Error(r(527,KL,"19.1.0"));H.findDOMNode=function(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(r(188)):(p=Object.keys(p).join(","),Error(r(268,p)));return p=l(g),p=p!==null?c(p):null,p=p===null?null:p.stateNode,p};var Wfe={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vS.isDisabled&&vS.supportsFiber)try{jt=vS.inject(Wfe),qt=vS}catch{}}return wv.createRoot=function(p,g){if(!s(p))throw Error(r(299));var _=!1,E="",j=u8,q=d8,ue=f8,Re=null;return g!=null&&(g.unstable_strictMode===!0&&(_=!0),g.identifierPrefix!==void 0&&(E=g.identifierPrefix),g.onUncaughtError!==void 0&&(j=g.onUncaughtError),g.onCaughtError!==void 0&&(q=g.onCaughtError),g.onRecoverableError!==void 0&&(ue=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Re=g.unstable_transitionCallbacks)),g=LL(p,1,!1,null,null,_,E,j,q,ue,Re,null),p[Ge]=g.current,FR(p),new tN(g)},wv.hydrateRoot=function(p,g,_){if(!s(p))throw Error(r(299));var E=!1,j="",q=u8,ue=d8,Re=f8,Ye=null,wt=null;return _!=null&&(_.unstable_strictMode===!0&&(E=!0),_.identifierPrefix!==void 0&&(j=_.identifierPrefix),_.onUncaughtError!==void 0&&(q=_.onUncaughtError),_.onCaughtError!==void 0&&(ue=_.onCaughtError),_.onRecoverableError!==void 0&&(Re=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(Ye=_.unstable_transitionCallbacks),_.formState!==void 0&&(wt=_.formState)),g=LL(p,1,!0,g,_??null,E,j,q,ue,Re,Ye,wt),g.context=BL(null),_=g.current,E=Go(),E=kt(E),j=Tf(E),j.callback=null,Af(_,j,E),_=E,g.current.lanes=_,st(g,_),Hc(g),p[Ge]=g.current,FR(p),new bS(g)},wv.version="19.1.0",wv}var sB;function ohe(){if(sB)return sN.exports;sB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),sN.exports=ahe(),sN.exports}var lhe=ohe();const che=_a(lhe);function iB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function ll(...e){return t=>{let n=!1;const r=e.map(s=>{const i=iB(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():iB(e[s],null)}}}}function Rn(...e){return T.useCallback(ll(...e),e)}function _u(e){const t=uhe(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(fhe);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var qW=_u("Slot");function uhe(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=phe(s),o=hhe(i,s.props);return s.type!==T.Fragment&&(o.ref=r?ll(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var dhe=Symbol("radix.slottable");function fhe(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===dhe}function hhe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{const l=i(...o);return s(...o),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function phe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function VW(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=VW(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function WW(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=VW(e))&&(r&&(r+=" "),r+=t);return r}const aB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,oB=WW,TO=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return oB(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,a=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],d=i==null?void 0:i[c];if(u===null)return null;const h=aB(u)||aB(d);return s[c][h]}),o=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...m}=u;return Object.entries(m).every(y=>{let[b,v]=y;return Array.isArray(v)?v.includes({...i,...o}[b]):{...i,...o}[b]===v})?[...c,d,h]:c},[]);return oB(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},AO="-",mhe=e=>{const t=yhe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(AO);return o[0]===""&&o.length!==1&&o.shift(),HW(o,t)||ghe(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},HW=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?HW(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(AO);return(a=t.validators.find(({validator:o})=>o(i)))==null?void 0:a.classGroupId},lB=/^\[(.+)\]$/,ghe=e=>{if(lB.test(e)){const t=lB.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},yhe=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const s in n)L3(n[s],r,s,t);return r},L3=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:cB(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(bhe(s)){L3(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{L3(a,cB(t,i),n,r)})})},cB=(e,t)=>{let n=e;return t.split(AO).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},bhe=e=>e.isThemeGetter,vhe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},B3="!",$3=":",xhe=$3.length,whe=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=s=>{const i=[];let a=0,o=0,l=0,c;for(let y=0;y<s.length;y++){let b=s[y];if(a===0&&o===0){if(b===$3){i.push(s.slice(l,y)),l=y+xhe;continue}if(b==="/"){c=y;continue}}b==="["?a++:b==="]"?a--:b==="("?o++:b===")"&&o--}const u=i.length===0?s:s.substring(l),d=_he(u),h=d!==u,m=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:m}};if(t){const s=t+$3,i=r;r=a=>a.startsWith(s)?i(a.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(n){const s=r;r=i=>n({className:i,parseClassName:s})}return r},_he=e=>e.endsWith(B3)?e.substring(0,e.length-1):e.startsWith(B3)?e.substring(1):e,She=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let i=[];return r.forEach(a=>{a[0]==="["||t[a]?(s.push(...i.sort(),a),i=[]):i.push(a)}),s.push(...i.sort()),s}},Che=e=>({cache:vhe(e.cacheSize),parseClassName:whe(e),sortModifiers:She(e),...mhe(e)}),khe=/\s+/,Ehe=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:i}=t,a=[],o=e.trim().split(khe);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:d,modifiers:h,hasImportantModifier:m,baseClassName:y,maybePostfixModifierPosition:b}=n(u);if(d){l=u+(l.length>0?" "+l:l);continue}let v=!!b,x=r(v?y.substring(0,b):y);if(!x){if(!v){l=u+(l.length>0?" "+l:l);continue}if(x=r(y),!x){l=u+(l.length>0?" "+l:l);continue}v=!1}const w=i(h).join(":"),S=m?w+B3:w,C=S+x;if(a.includes(C))continue;a.push(C);const k=s(x,v);for(let A=0;A<k.length;++A){const R=k[A];a.push(S+R)}l=u+(l.length>0?" "+l:l)}return l};function The(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=GW(t))&&(r&&(r+=" "),r+=n);return r}const GW=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=GW(e[r]))&&(n&&(n+=" "),n+=t);return n};function Ahe(e,...t){let n,r,s,i=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return n=Che(c),r=n.cache.get,s=n.cache.set,i=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=Ehe(l,n);return s(l,u),u}return function(){return i(The.apply(null,arguments))}}const Pi=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},KW=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,YW=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Rhe=/^\d+\/\d+$/,Nhe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Mhe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ihe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,jhe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Ohe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Vg=e=>Rhe.test(e),Ir=e=>!!e&&!Number.isNaN(Number(e)),Hf=e=>!!e&&Number.isInteger(Number(e)),lN=e=>e.endsWith("%")&&Ir(e.slice(0,-1)),ld=e=>Nhe.test(e),Phe=()=>!0,Dhe=e=>Mhe.test(e)&&!Ihe.test(e),ZW=()=>!1,Fhe=e=>jhe.test(e),Lhe=e=>Ohe.test(e),Bhe=e=>!vn(e)&&!xn(e),$he=e=>Ry(e,QW,ZW),vn=e=>KW.test(e),Sp=e=>Ry(e,eH,Dhe),cN=e=>Ry(e,Whe,Ir),uB=e=>Ry(e,XW,ZW),zhe=e=>Ry(e,JW,Lhe),xS=e=>Ry(e,tH,Fhe),xn=e=>YW.test(e),_v=e=>Ny(e,eH),Uhe=e=>Ny(e,Hhe),dB=e=>Ny(e,XW),qhe=e=>Ny(e,QW),Vhe=e=>Ny(e,JW),wS=e=>Ny(e,tH,!0),Ry=(e,t,n)=>{const r=KW.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},Ny=(e,t,n=!1)=>{const r=YW.exec(e);return r?r[1]?t(r[1]):n:!1},XW=e=>e==="position"||e==="percentage",JW=e=>e==="image"||e==="url",QW=e=>e==="length"||e==="size"||e==="bg-size",eH=e=>e==="length",Whe=e=>e==="number",Hhe=e=>e==="family-name",tH=e=>e==="shadow",Ghe=()=>{const e=Pi("color"),t=Pi("font"),n=Pi("text"),r=Pi("font-weight"),s=Pi("tracking"),i=Pi("leading"),a=Pi("breakpoint"),o=Pi("container"),l=Pi("spacing"),c=Pi("radius"),u=Pi("shadow"),d=Pi("inset-shadow"),h=Pi("text-shadow"),m=Pi("drop-shadow"),y=Pi("blur"),b=Pi("perspective"),v=Pi("aspect"),x=Pi("ease"),w=Pi("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],C=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[...C(),xn,vn],A=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto","contain","none"],N=()=>[xn,vn,l],I=()=>[Vg,"full","auto",...N()],O=()=>[Hf,"none","subgrid",xn,vn],L=()=>["auto",{span:["full",Hf,xn,vn]},Hf,xn,vn],P=()=>[Hf,"auto",xn,vn],V=()=>["auto","min","max","fr",xn,vn],F=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],X=()=>["start","end","center","stretch","center-safe","end-safe"],U=()=>["auto",...N()],H=()=>[Vg,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],$=()=>[e,xn,vn],ne=()=>[...C(),dB,uB,{position:[xn,vn]}],W=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Q=()=>["auto","cover","contain",qhe,$he,{size:[xn,vn]}],ee=()=>[lN,_v,Sp],se=()=>["","none","full",c,xn,vn],pe=()=>["",Ir,_v,Sp],ce=()=>["solid","dashed","dotted","double"],Ie=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],De=()=>[Ir,lN,dB,uB],Se=()=>["","none",y,xn,vn],Ce=()=>["none",Ir,xn,vn],qe=()=>["none",Ir,xn,vn],Qe=()=>[Ir,xn,vn],Ve=()=>[Vg,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ld],breakpoint:[ld],color:[Phe],container:[ld],"drop-shadow":[ld],ease:["in","out","in-out"],font:[Bhe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ld],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ld],shadow:[ld],spacing:["px",Ir],text:[ld],"text-shadow":[ld],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Vg,vn,xn,v]}],container:["container"],columns:[{columns:[Ir,vn,xn,o]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[Hf,"auto",xn,vn]}],basis:[{basis:[Vg,"full","auto",o,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ir,Vg,"auto","initial","none",vn]}],grow:[{grow:["",Ir,xn,vn]}],shrink:[{shrink:["",Ir,xn,vn]}],order:[{order:[Hf,"first","last","none",xn,vn]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:L()}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:L()}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":V()}],"auto-rows":[{"auto-rows":V()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...F(),"normal"]}],"justify-items":[{"justify-items":[...X(),"normal"]}],"justify-self":[{"justify-self":["auto",...X()]}],"align-content":[{content:["normal",...F()]}],"align-items":[{items:[...X(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...X(),{baseline:["","last"]}]}],"place-content":[{"place-content":F()}],"place-items":[{"place-items":[...X(),"baseline"]}],"place-self":[{"place-self":["auto",...X()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:U()}],mx:[{mx:U()}],my:[{my:U()}],ms:[{ms:U()}],me:[{me:U()}],mt:[{mt:U()}],mr:[{mr:U()}],mb:[{mb:U()}],ml:[{ml:U()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:H()}],w:[{w:[o,"screen",...H()]}],"min-w":[{"min-w":[o,"screen","none",...H()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...H()]}],h:[{h:["screen",...H()]}],"min-h":[{"min-h":["screen","none",...H()]}],"max-h":[{"max-h":["screen",...H()]}],"font-size":[{text:["base",n,_v,Sp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,xn,cN]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",lN,vn]}],"font-family":[{font:[Uhe,vn,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,xn,vn]}],"line-clamp":[{"line-clamp":[Ir,"none",xn,cN]}],leading:[{leading:[i,...N()]}],"list-image":[{"list-image":["none",xn,vn]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",xn,vn]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:$()}],"text-color":[{text:$()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ce(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ir,"from-font","auto",xn,Sp]}],"text-decoration-color":[{decoration:$()}],"underline-offset":[{"underline-offset":[Ir,"auto",xn,vn]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",xn,vn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",xn,vn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ne()}],"bg-repeat":[{bg:W()}],"bg-size":[{bg:Q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Hf,xn,vn],radial:["",xn,vn],conic:[Hf,xn,vn]},Vhe,zhe]}],"bg-color":[{bg:$()}],"gradient-from-pos":[{from:ee()}],"gradient-via-pos":[{via:ee()}],"gradient-to-pos":[{to:ee()}],"gradient-from":[{from:$()}],"gradient-via":[{via:$()}],"gradient-to":[{to:$()}],rounded:[{rounded:se()}],"rounded-s":[{"rounded-s":se()}],"rounded-e":[{"rounded-e":se()}],"rounded-t":[{"rounded-t":se()}],"rounded-r":[{"rounded-r":se()}],"rounded-b":[{"rounded-b":se()}],"rounded-l":[{"rounded-l":se()}],"rounded-ss":[{"rounded-ss":se()}],"rounded-se":[{"rounded-se":se()}],"rounded-ee":[{"rounded-ee":se()}],"rounded-es":[{"rounded-es":se()}],"rounded-tl":[{"rounded-tl":se()}],"rounded-tr":[{"rounded-tr":se()}],"rounded-br":[{"rounded-br":se()}],"rounded-bl":[{"rounded-bl":se()}],"border-w":[{border:pe()}],"border-w-x":[{"border-x":pe()}],"border-w-y":[{"border-y":pe()}],"border-w-s":[{"border-s":pe()}],"border-w-e":[{"border-e":pe()}],"border-w-t":[{"border-t":pe()}],"border-w-r":[{"border-r":pe()}],"border-w-b":[{"border-b":pe()}],"border-w-l":[{"border-l":pe()}],"divide-x":[{"divide-x":pe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":pe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ce(),"hidden","none"]}],"divide-style":[{divide:[...ce(),"hidden","none"]}],"border-color":[{border:$()}],"border-color-x":[{"border-x":$()}],"border-color-y":[{"border-y":$()}],"border-color-s":[{"border-s":$()}],"border-color-e":[{"border-e":$()}],"border-color-t":[{"border-t":$()}],"border-color-r":[{"border-r":$()}],"border-color-b":[{"border-b":$()}],"border-color-l":[{"border-l":$()}],"divide-color":[{divide:$()}],"outline-style":[{outline:[...ce(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ir,xn,vn]}],"outline-w":[{outline:["",Ir,_v,Sp]}],"outline-color":[{outline:$()}],shadow:[{shadow:["","none",u,wS,xS]}],"shadow-color":[{shadow:$()}],"inset-shadow":[{"inset-shadow":["none",d,wS,xS]}],"inset-shadow-color":[{"inset-shadow":$()}],"ring-w":[{ring:pe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:$()}],"ring-offset-w":[{"ring-offset":[Ir,Sp]}],"ring-offset-color":[{"ring-offset":$()}],"inset-ring-w":[{"inset-ring":pe()}],"inset-ring-color":[{"inset-ring":$()}],"text-shadow":[{"text-shadow":["none",h,wS,xS]}],"text-shadow-color":[{"text-shadow":$()}],opacity:[{opacity:[Ir,xn,vn]}],"mix-blend":[{"mix-blend":[...Ie(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ie()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ir]}],"mask-image-linear-from-pos":[{"mask-linear-from":De()}],"mask-image-linear-to-pos":[{"mask-linear-to":De()}],"mask-image-linear-from-color":[{"mask-linear-from":$()}],"mask-image-linear-to-color":[{"mask-linear-to":$()}],"mask-image-t-from-pos":[{"mask-t-from":De()}],"mask-image-t-to-pos":[{"mask-t-to":De()}],"mask-image-t-from-color":[{"mask-t-from":$()}],"mask-image-t-to-color":[{"mask-t-to":$()}],"mask-image-r-from-pos":[{"mask-r-from":De()}],"mask-image-r-to-pos":[{"mask-r-to":De()}],"mask-image-r-from-color":[{"mask-r-from":$()}],"mask-image-r-to-color":[{"mask-r-to":$()}],"mask-image-b-from-pos":[{"mask-b-from":De()}],"mask-image-b-to-pos":[{"mask-b-to":De()}],"mask-image-b-from-color":[{"mask-b-from":$()}],"mask-image-b-to-color":[{"mask-b-to":$()}],"mask-image-l-from-pos":[{"mask-l-from":De()}],"mask-image-l-to-pos":[{"mask-l-to":De()}],"mask-image-l-from-color":[{"mask-l-from":$()}],"mask-image-l-to-color":[{"mask-l-to":$()}],"mask-image-x-from-pos":[{"mask-x-from":De()}],"mask-image-x-to-pos":[{"mask-x-to":De()}],"mask-image-x-from-color":[{"mask-x-from":$()}],"mask-image-x-to-color":[{"mask-x-to":$()}],"mask-image-y-from-pos":[{"mask-y-from":De()}],"mask-image-y-to-pos":[{"mask-y-to":De()}],"mask-image-y-from-color":[{"mask-y-from":$()}],"mask-image-y-to-color":[{"mask-y-to":$()}],"mask-image-radial":[{"mask-radial":[xn,vn]}],"mask-image-radial-from-pos":[{"mask-radial-from":De()}],"mask-image-radial-to-pos":[{"mask-radial-to":De()}],"mask-image-radial-from-color":[{"mask-radial-from":$()}],"mask-image-radial-to-color":[{"mask-radial-to":$()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":C()}],"mask-image-conic-pos":[{"mask-conic":[Ir]}],"mask-image-conic-from-pos":[{"mask-conic-from":De()}],"mask-image-conic-to-pos":[{"mask-conic-to":De()}],"mask-image-conic-from-color":[{"mask-conic-from":$()}],"mask-image-conic-to-color":[{"mask-conic-to":$()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ne()}],"mask-repeat":[{mask:W()}],"mask-size":[{mask:Q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",xn,vn]}],filter:[{filter:["","none",xn,vn]}],blur:[{blur:Se()}],brightness:[{brightness:[Ir,xn,vn]}],contrast:[{contrast:[Ir,xn,vn]}],"drop-shadow":[{"drop-shadow":["","none",m,wS,xS]}],"drop-shadow-color":[{"drop-shadow":$()}],grayscale:[{grayscale:["",Ir,xn,vn]}],"hue-rotate":[{"hue-rotate":[Ir,xn,vn]}],invert:[{invert:["",Ir,xn,vn]}],saturate:[{saturate:[Ir,xn,vn]}],sepia:[{sepia:["",Ir,xn,vn]}],"backdrop-filter":[{"backdrop-filter":["","none",xn,vn]}],"backdrop-blur":[{"backdrop-blur":Se()}],"backdrop-brightness":[{"backdrop-brightness":[Ir,xn,vn]}],"backdrop-contrast":[{"backdrop-contrast":[Ir,xn,vn]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ir,xn,vn]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ir,xn,vn]}],"backdrop-invert":[{"backdrop-invert":["",Ir,xn,vn]}],"backdrop-opacity":[{"backdrop-opacity":[Ir,xn,vn]}],"backdrop-saturate":[{"backdrop-saturate":[Ir,xn,vn]}],"backdrop-sepia":[{"backdrop-sepia":["",Ir,xn,vn]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",xn,vn]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ir,"initial",xn,vn]}],ease:[{ease:["linear","initial",x,xn,vn]}],delay:[{delay:[Ir,xn,vn]}],animate:[{animate:["none",w,xn,vn]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,xn,vn]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:Ce()}],"rotate-x":[{"rotate-x":Ce()}],"rotate-y":[{"rotate-y":Ce()}],"rotate-z":[{"rotate-z":Ce()}],scale:[{scale:qe()}],"scale-x":[{"scale-x":qe()}],"scale-y":[{"scale-y":qe()}],"scale-z":[{"scale-z":qe()}],"scale-3d":["scale-3d"],skew:[{skew:Qe()}],"skew-x":[{"skew-x":Qe()}],"skew-y":[{"skew-y":Qe()}],transform:[{transform:[xn,vn,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ve()}],"translate-x":[{"translate-x":Ve()}],"translate-y":[{"translate-y":Ve()}],"translate-z":[{"translate-z":Ve()}],"translate-none":["translate-none"],accent:[{accent:$()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:$()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",xn,vn]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",xn,vn]}],fill:[{fill:["none",...$()]}],"stroke-w":[{stroke:[Ir,_v,Sp,cN]}],stroke:[{stroke:["none",...$()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Khe=Ahe(Ghe);function Ze(...e){return Khe(WW(e))}const z3=TO("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function bt({className:e,variant:t,size:n,asChild:r=!1,...s}){const i=r?qW:"button";return f.jsx(i,{"data-slot":"button",className:Ze(z3({variant:t,size:n,className:e})),...s})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yhe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Zhe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),fB=e=>{const t=Zhe(e);return t.charAt(0).toUpperCase()+t.slice(1)},nH=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xhe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jhe=T.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},l)=>T.createElement("svg",{ref:l,...Xhe,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:nH("lucide",s),...o},[...a.map(([c,u])=>T.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=(e,t)=>{const n=T.forwardRef(({className:r,...s},i)=>T.createElement(Jhe,{ref:i,iconNode:t,className:nH(`lucide-${Yhe(fB(e))}`,`lucide-${e}`,r),...s}));return n.displayName=fB(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qhe=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],rH=Ut("archive",Qhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const epe=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],sH=Ut("arrow-down",epe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tpe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],npe=Ut("arrow-right",tpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rpe=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],spe=Ut("arrow-up",rpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ipe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],ape=Ut("ban",ipe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ope=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]],lpe=Ut("book-open-text",ope);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cpe=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],iH=Ut("bot",cpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const upe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Ph=Ut("brain-circuit",upe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dpe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],hB=Ut("brain",dpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fpe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],hpe=Ut("calendar",fpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ppe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ro=Ut("check",ppe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mpe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Nc=Ut("chevron-down",mpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gpe=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ype=Ut("chevron-left",gpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bpe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],RO=Ut("chevron-right",bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vpe=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Dh=Ut("chevron-up",vpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xpe=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],aE=Ut("chevrons-up-down",xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wpe=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],_pe=Ut("chevrons-up",wpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Spe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],_c=Ut("circle-alert",Spe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cpe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],kpe=Ut("circle-check-big",Cpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Epe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],oE=Ut("circle-check",Epe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],Ape=Ut("circle-stop",Tpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Npe=Ut("circle",Rpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ipe=Ut("circle-x",Mpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jpe=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],lE=Ut("clipboard",jpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ope=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Ppe=Ut("clock",Ope);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dpe=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],NO=Ut("cloud-upload",Dpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fpe=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],aH=Ut("code",Fpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lpe=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],Bpe=Ut("cog",Lpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $pe=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],zpe=Ut("coins",$pe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],qpe=Ut("copy",Upe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vpe=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Wpe=Ut("dollar-sign",Vpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hpe=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],pu=Ut("download",Hpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gpe=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Kpe=Ut("ellipsis-vertical",Gpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ype=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],Zpe=Ut("file-archive",Ype);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xpe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Jpe=Ut("file-down",Xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qpe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],eme=Ut("file-json",Qpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tme=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],nme=Ut("file-question",tme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],sme=Ut("file-text",rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ime=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],ame=Ut("file-up",ime);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ome=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],oH=Ut("file",ome);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lme=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],lH=Ut("folder-git",lme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cme=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],cH=Ut("folder-plus",cme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ume=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],pB=Ut("folder-tree",ume);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],fme=Ut("folder-up",dme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],fh=Ut("folder",hme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pme=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],MO=Ut("funnel",pme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mme=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Sc=Ut("git-branch",mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gme=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],uH=Ut("git-commit-horizontal",gme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yme=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],dH=Ut("git-merge",yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bme=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],IO=Ut("git-pull-request",bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vme=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],xme=Ut("github",vme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],mB=Ut("globe",wme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _me=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Sme=Ut("grip-vertical",_me);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cme=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],jO=Ut("hard-drive",Cme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kme=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Eme=Ut("history",kme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tme=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Ame=Ut("house",Tme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rme=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],im=Ut("image",Rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],OO=Ut("info",Nme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mme=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Dx=Ut("key",Mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ime=[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]],fH=Ut("land-plot",Ime);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jme=[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]],Ome=Ut("list-restart",jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pme=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Qn=Ut("loader-circle",Pme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dme=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],Fme=Ut("menu",Dme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lme=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],Bme=Ut("message-square-plus",Lme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $me=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],gB=Ut("message-square-text",$me);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zme=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],U3=Ut("message-square",zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ume=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],qme=Ut("music",Ume);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vme=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],hH=Ut("notebook-pen",Vme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wme=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],J2=Ut("palette",Wme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hme=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],Gme=Ut("panel-left-close",Hme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kme=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],Yme=Ut("panel-right-close",Kme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zme=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],cE=Ut("paperclip",Zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xme=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],Jme=Ut("pause",Xme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qme=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],s1=Ut("pen",Qme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ege=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],tge=Ut("play",ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nge=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Pd=Ut("plus",nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rge=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],yB=Ut("puzzle",rge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sge=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],am=Ut("refresh-cw",sge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ige=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],age=Ut("rocket",ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oge=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],i1=Ut("rotate-ccw",oge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lge=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Jd=Ut("save",lge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cge=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Fa=Ut("search",cge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uge=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],dge=Ut("send-horizontal",uge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fge=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],q0=Ut("server",fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hge=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Q2=Ut("settings",hge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pge=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],bB=Ut("shield-alert",pge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mge=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],gge=Ut("sliders-horizontal",mge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],bge=Ut("smile",yge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],pH=Ut("sparkles",vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],vB=Ut("sparkle",xge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wge=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],S0=Ut("square-pen",wge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Sge=Ut("square",_ge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cge=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],kge=Ut("star",Cge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ege=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],q3=Ut("tags",Ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tge=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],Age=Ut("text",Tge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rge=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Eo=Ut("trash-2",Rge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nge=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Mge=Ut("trash",Nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ige=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],PO=Ut("triangle-alert",Ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jge=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],mH=Ut("upload",jge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oge=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Pge=Ut("user",Oge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dge=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],xB=Ut("users",Dge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fge=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Lge=Ut("video",Fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bge=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],om=Ut("wrench",Bge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ge=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],wa=Ut("x",$ge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zge=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Uge=Ut("zap",zge),wB=({controls:e,area:t,className:n})=>{const r=e.filter(s=>t==="trigger"?!!s.triggerRenderer:!!s.renderer);return r.length===0?null:f.jsx("div",{className:Ze(n),children:r.map(s=>{var a,o;const i=t==="trigger"?(a=s.triggerRenderer)==null?void 0:a.call(s):(o=s.renderer)==null?void 0:o.call(s);return i?f.jsx(We.Fragment,{children:i},s.id):null})})},_B=e=>{let t;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(m=>m(t,h))}},s=()=>t,o={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,s,o);return o},qge=e=>e?_B(e):_B,Vge=e=>e;function Wge(e,t=Vge){const n=We.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return We.useDebugValue(n),n}const SB=e=>{const t=qge(e),n=r=>Wge(t,r);return Object.assign(n,t),n},Fo=e=>e?SB(e):SB;var gH=Symbol.for("immer-nothing"),CB=Symbol.for("immer-draftable"),ls=Symbol.for("immer-state");function Bl(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var V0=Object.getPrototypeOf;function W0(e){return!!e&&!!e[ls]}function Dd(e){var t;return e?yH(e)||Array.isArray(e)||!!e[CB]||!!((t=e.constructor)!=null&&t[CB])||dE(e)||fE(e):!1}var Hge=Object.prototype.constructor.toString();function yH(e){if(!e||typeof e!="object")return!1;const t=V0(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===Hge}function Fx(e,t){uE(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function uE(e){const t=e[ls];return t?t.type_:Array.isArray(e)?1:dE(e)?2:fE(e)?3:0}function V3(e,t){return uE(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function bH(e,t,n){const r=uE(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function Gge(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function dE(e){return e instanceof Map}function fE(e){return e instanceof Set}function Qi(e){return e.copy_||e.base_}function W3(e,t){if(dE(e))return new Map(e);if(fE(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=yH(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[ls];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(V0(e),r)}else{const r=V0(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function DO(e,t=!1){return hE(e)||W0(e)||!Dd(e)||(uE(e)>1&&(e.set=e.add=e.clear=e.delete=Kge),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>DO(r,!0))),e}function Kge(){Bl(2)}function hE(e){return Object.isFrozen(e)}var H3={};function lm(e){const t=H3[e];return t||Bl(0,e),t}function Yge(e,t){H3[e]||(H3[e]=t)}var Lx;function eC(){return Lx}function Zge(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function kB(e,t){t&&(lm("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function G3(e){K3(e),e.drafts_.forEach(Xge),e.drafts_=null}function K3(e){e===Lx&&(Lx=e.parent_)}function EB(e){return Lx=Zge(Lx,e)}function Xge(e){const t=e[ls];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function TB(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[ls].modified_&&(G3(t),Bl(4)),Dd(e)&&(e=tC(t,e),t.parent_||nC(t,e)),t.patches_&&lm("Patches").generateReplacementPatches_(n[ls].base_,e,t.patches_,t.inversePatches_)):e=tC(t,n,[]),G3(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==gH?e:void 0}function tC(e,t,n){if(hE(t))return t;const r=t[ls];if(!r)return Fx(t,(s,i)=>AB(e,r,t,s,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return nC(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),Fx(i,(o,l)=>AB(e,r,s,o,l,n,a)),nC(e,s,!1),n&&e.patches_&&lm("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function AB(e,t,n,r,s,i,a){if(W0(s)){const o=i&&t&&t.type_!==3&&!V3(t.assigned_,r)?i.concat(r):void 0,l=tC(e,s,o);if(bH(n,r,l),W0(l))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(Dd(s)&&!hE(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;tC(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&nC(e,s)}}function nC(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&DO(t,n)}function Jge(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:eC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=FO;n&&(s=[r],i=Bx);const{revoke:a,proxy:o}=Proxy.revocable(s,i);return r.draft_=o,r.revoke_=a,o}var FO={get(e,t){if(t===ls)return e;const n=Qi(e);if(!V3(n,t))return Qge(e,n,t);const r=n[t];return e.finalized_||!Dd(r)?r:r===uN(e.base_,t)?(dN(e),e.copy_[t]=$x(r,e)):r},has(e,t){return t in Qi(e)},ownKeys(e){return Reflect.ownKeys(Qi(e))},set(e,t,n){const r=vH(Qi(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=uN(Qi(e),t),i=s==null?void 0:s[ls];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(Gge(n,s)&&(n!==void 0||V3(e.base_,t)))return!0;dN(e),bd(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return uN(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,dN(e),bd(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=Qi(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){Bl(11)},getPrototypeOf(e){return V0(e.base_)},setPrototypeOf(){Bl(12)}},Bx={};Fx(FO,(e,t)=>{Bx[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Bx.deleteProperty=function(e,t){return Bx.set.call(this,e,t,void 0)};Bx.set=function(e,t,n){return FO.set.call(this,e[0],t,n,e[0])};function uN(e,t){const n=e[ls];return(n?Qi(n):e)[t]}function Qge(e,t,n){var s;const r=vH(t,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(e.draft_):void 0}function vH(e,t){if(!(t in e))return;let n=V0(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=V0(n)}}function bd(e){e.modified_||(e.modified_=!0,e.parent_&&bd(e.parent_))}function dN(e){e.copy_||(e.copy_=W3(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var e0e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const a=this;return function(l=i,...c){return a.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&Bl(6),r!==void 0&&typeof r!="function"&&Bl(7);let s;if(Dd(t)){const i=EB(this),a=$x(t,void 0);let o=!0;try{s=n(a),o=!1}finally{o?G3(i):K3(i)}return kB(i,r),TB(s,i)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===gH&&(s=void 0),this.autoFreeze_&&DO(s,!0),r){const i=[],a=[];lm("Patches").generateReplacementPatches_(t,s,i,a),r(i,a)}return s}else Bl(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let r,s;return[this.produce(t,n,(a,o)=>{r=a,s=o}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Dd(e)||Bl(8),W0(e)&&(e=t0e(e));const t=EB(this),n=$x(e,void 0);return n[ls].isManual_=!0,K3(t),n}finishDraft(e,t){const n=e&&e[ls];(!n||!n.isManual_)&&Bl(9);const{scope_:r}=n;return kB(r,t),TB(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=lm("Patches").applyPatches_;return W0(e)?r(e,t):this.produce(e,s=>r(s,t))}};function $x(e,t){const n=dE(e)?lm("MapSet").proxyMap_(e,t):fE(e)?lm("MapSet").proxySet_(e,t):Jge(e,t);return(t?t.scope_:eC()).drafts_.push(n),n}function t0e(e){return W0(e)||Bl(10,e),xH(e)}function xH(e){if(!Dd(e)||hE(e))return e;const t=e[ls];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=W3(e,t.scope_.immer_.useStrictShallowCopy_)}else n=W3(e,!0);return Fx(n,(r,s)=>{bH(n,r,xH(s))}),t&&(t.finalized_=!1),n}function n0e(){class e extends Map{constructor(l,c){super(),this[ls]={type_:2,parent_:c,scope_:c?c.scope_:eC(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return Qi(this[ls]).size}has(l){return Qi(this[ls]).has(l)}set(l,c){const u=this[ls];return a(u),(!Qi(u).has(l)||Qi(u).get(l)!==c)&&(n(u),bd(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[ls];return a(c),n(c),bd(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[ls];a(l),Qi(l).size&&(n(l),bd(l),l.assigned_=new Map,Fx(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[ls];Qi(u).forEach((d,h,m)=>{l.call(c,this.get(h),h,this)})}get(l){const c=this[ls];a(c);const u=Qi(c).get(l);if(c.finalized_||!Dd(u)||u!==c.base_.get(l))return u;const d=$x(u,c);return n(c),c.copy_.set(l,d),d}keys(){return Qi(this[ls]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[ls]={type_:3,parent_:c,scope_:c?c.scope_:eC(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return Qi(this[ls]).size}has(l){const c=this[ls];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[ls];return a(c),this.has(l)||(i(c),bd(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[ls];return a(c),i(c),bd(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[ls];a(l),Qi(l).size&&(i(l),bd(l),l.copy_.clear())}values(){const l=this[ls];return a(l),i(l),l.copy_.values()}entries(){const l=this[ls];return a(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let d=u.next();for(;!d.done;)l.call(c,d.value,d.value,this),d=u.next()}}function s(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(Dd(l)){const c=$x(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&Bl(3,JSON.stringify(Qi(o)))}Yge("MapSet",{proxyMap_:t,proxySet_:s})}var cl=new e0e,r0e=cl.produce;cl.produceWithPatches.bind(cl);cl.setAutoFreeze.bind(cl);cl.setUseStrictShallowCopy.bind(cl);cl.applyPatches.bind(cl);cl.createDraft.bind(cl);cl.finishDraft.bind(cl);const s0e=e=>(t,n,r)=>(r.setState=(s,i,...a)=>{const o=typeof s=="function"?r0e(s):s;return t(o,i,...a)},e(r.setState,n,r)),Lo=s0e;function i0e(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}const je=i0e(),$r={promptControlsChanged:"control.registry.prompt.controls.changed",chatControlsChanged:"control.registry.chat.controls.changed",canvasControlsChanged:"control.registry.canvas.controls.changed",middlewareChanged:"control.registry.middleware.changed",toolsChanged:"control.registry.tools.changed",modalProvidersChanged:"control.registry.modal.providers.changed",registerPromptControlRequest:"control.registry.register.prompt.control.request",unregisterPromptControlRequest:"control.registry.unregister.prompt.control.request",registerChatControlRequest:"control.registry.register.chat.control.request",unregisterChatControlRequest:"control.registry.unregister.chat.control.request",registerCanvasControlRequest:"control.registry.register.canvas.control.request",unregisterCanvasControlRequest:"control.registry.unregister.canvas.control.request",registerMiddlewareRequest:"control.registry.register.middleware.request",unregisterMiddlewareRequest:"control.registry.unregister.middleware.request",registerToolRequest:"control.registry.register.tool.request",unregisterToolRequest:"control.registry.unregister.tool.request",registerModalProviderRequest:"control.registry.register.modal.provider.request",unregisterModalProviderRequest:"control.registry.unregister.modal.provider.request"},No=Fo(Lo((e,t)=>({promptControls:{},chatControls:{},canvasControls:{},middlewareRegistry:{},tools:{},modalProviders:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),je.emit($r.promptControlsChanged,{controls:t().promptControls}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)}),je.emit($r.promptControlsChanged,{controls:t().promptControls})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),je.emit($r.chatControlsChanged,{controls:t().chatControls}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)}),je.emit($r.chatControlsChanged,{controls:t().chatControls})},registerCanvasControl:n=>(e(r=>{r.canvasControls[n.id]&&console.warn(`ControlRegistryStore: CanvasControl with ID "${n.id}" already registered. Overwriting.`),r.canvasControls[n.id]=n}),je.emit($r.canvasControlsChanged,{controls:t().canvasControls}),()=>t().unregisterCanvasControl(n.id)),unregisterCanvasControl:n=>{e(r=>{r.canvasControls[n]?delete r.canvasControls[n]:console.warn(`ControlRegistryStore: CanvasControl with ID "${n}" not found for unregistration.`)}),je.emit($r.canvasControlsChanged,{controls:t().canvasControls})},registerMiddleware:(n,r,s,i=0)=>{const a={modId:r,callback:s,order:i};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(a),o.middlewareRegistry[n].sort((l,c)=>(l.order??0)-(c.order??0))}),je.emit($r.middlewareChanged,{middleware:t().middlewareRegistry}),()=>t().unregisterMiddleware(n,r,s)},unregisterMiddleware:(n,r,s)=>{e(i=>{var a;i.middlewareRegistry[n]?(i.middlewareRegistry[n]=i.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===s)),((a=i.middlewareRegistry[n])==null?void 0:a.length)===0&&delete i.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)}),je.emit($r.middlewareChanged,{middleware:t().middlewareRegistry})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((s,i)=>(s.order??0)-(i.order??0)))},registerTool:(n,r,s,i)=>(e(a=>{a.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${a.tools[r].modId}". Overwriting with registration from mod "${n}".`),a.tools[r]={definition:s,implementation:i,modId:n}}),je.emit($r.toolsChanged,{tools:t().tools}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)}),je.emit($r.toolsChanged,{tools:t().tools})},getRegisteredTools:()=>Object.freeze({...t().tools}),registerModalProvider:(n,r)=>(e(s=>{s.modalProviders[n]&&console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" already registered. Overwriting.`),s.modalProviders[n]=r}),je.emit($r.modalProvidersChanged,{providers:t().modalProviders}),()=>t().unregisterModalProvider(n)),unregisterModalProvider:n=>{e(r=>{r.modalProviders[n]?delete r.modalProviders[n]:console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" not found for unregistration.`)}),je.emit($r.modalProvidersChanged,{providers:t().modalProviders})},getRegisteredActionHandlers:()=>{const n="controlRegistryStore",r=t();return[{eventName:$r.registerPromptControlRequest,handler:s=>{r.registerPromptControl(s.control)},storeId:n},{eventName:$r.unregisterPromptControlRequest,handler:s=>{r.unregisterPromptControl(s.id)},storeId:n},{eventName:$r.registerChatControlRequest,handler:s=>{r.registerChatControl(s.control)},storeId:n},{eventName:$r.unregisterChatControlRequest,handler:s=>{r.unregisterChatControl(s.id)},storeId:n},{eventName:$r.registerCanvasControlRequest,handler:s=>{r.registerCanvasControl(s.control)},storeId:n},{eventName:$r.unregisterCanvasControlRequest,handler:s=>{r.unregisterCanvasControl(s.id)},storeId:n},{eventName:$r.registerMiddlewareRequest,handler:s=>{r.registerMiddleware(s.hookName,s.modId,s.callback,s.order)},storeId:n},{eventName:$r.unregisterMiddlewareRequest,handler:s=>{r.unregisterMiddleware(s.hookName,s.modId,s.callback)},storeId:n},{eventName:$r.registerToolRequest,handler:s=>{r.registerTool(s.modId,s.toolName,s.definition,s.implementation)},storeId:n},{eventName:$r.unregisterToolRequest,handler:s=>{r.unregisterTool(s.toolName)},storeId:n},{eventName:$r.registerModalProviderRequest,handler:s=>{r.registerModalProvider(s.modalId,s.provider)},storeId:n},{eventName:$r.unregisterModalProviderRequest,handler:s=>{r.unregisterModalProvider(s.modalId)},storeId:n}]}})));var w2={exports:{}},a0e=w2.exports,RB;function o0e(){return RB||(RB=1,function(e,t){(function(n,r){e.exports=r()})(a0e,function(){var n=function(M,z){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,ae){te.__proto__=ae}||function(te,ae){for(var he in ae)Object.prototype.hasOwnProperty.call(ae,he)&&(te[he]=ae[he])})(M,z)},r=function(){return(r=Object.assign||function(M){for(var z,te=1,ae=arguments.length;te<ae;te++)for(var he in z=arguments[te])Object.prototype.hasOwnProperty.call(z,he)&&(M[he]=z[he]);return M}).apply(this,arguments)};function s(M,z,te){for(var ae,he=0,Ee=z.length;he<Ee;he++)!ae&&he in z||((ae=ae||Array.prototype.slice.call(z,0,he))[he]=z[he]);return M.concat(ae||Array.prototype.slice.call(z))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:zp,a=Object.keys,o=Array.isArray;function l(M,z){return typeof z!="object"||a(z).forEach(function(te){M[te]=z[te]}),M}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function d(M,z){return u.call(M,z)}function h(M,z){typeof z=="function"&&(z=z(c(M))),(typeof Reflect>"u"?a:Reflect.ownKeys)(z).forEach(function(te){y(M,te,z[te])})}var m=Object.defineProperty;function y(M,z,te,ae){m(M,z,l(te&&d(te,"get")&&typeof te.get=="function"?{get:te.get,set:te.set,configurable:!0}:{value:te,configurable:!0,writable:!0},ae))}function b(M){return{from:function(z){return M.prototype=Object.create(z.prototype),y(M.prototype,"constructor",M),{extend:h.bind(null,M.prototype)}}}}var v=Object.getOwnPropertyDescriptor,x=[].slice;function w(M,z,te){return x.call(M,z,te)}function S(M,z){return z(M)}function C(M){if(!M)throw new Error("Assertion Failed")}function k(M){i.setImmediate?setImmediate(M):setTimeout(M,0)}function A(M,z){if(typeof z=="string"&&d(M,z))return M[z];if(!z)return M;if(typeof z!="string"){for(var te=[],ae=0,he=z.length;ae<he;++ae){var Ee=A(M,z[ae]);te.push(Ee)}return te}var Le=z.indexOf(".");if(Le!==-1){var He=M[z.substr(0,Le)];return He==null?void 0:A(He,z.substr(Le+1))}}function R(M,z,te){if(M&&z!==void 0&&!("isFrozen"in Object&&Object.isFrozen(M)))if(typeof z!="string"&&"length"in z){C(typeof te!="string"&&"length"in te);for(var ae=0,he=z.length;ae<he;++ae)R(M,z[ae],te[ae])}else{var Ee,Le,He=z.indexOf(".");He!==-1?(Ee=z.substr(0,He),(Le=z.substr(He+1))===""?te===void 0?o(M)&&!isNaN(parseInt(Ee))?M.splice(Ee,1):delete M[Ee]:M[Ee]=te:R(He=!(He=M[Ee])||!d(M,Ee)?M[Ee]={}:He,Le,te)):te===void 0?o(M)&&!isNaN(parseInt(z))?M.splice(z,1):delete M[z]:M[z]=te}}function N(M){var z,te={};for(z in M)d(M,z)&&(te[z]=M[z]);return te}var I=[].concat;function O(M){return I.apply([],M)}var jt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(O([8,16,32,64].map(function(M){return["Int","Uint","Float"].map(function(z){return z+M+"Array"})}))).filter(function(M){return i[M]}),L=new Set(jt.map(function(M){return i[M]})),P=null;function V(M){return P=new WeakMap,M=function z(te){if(!te||typeof te!="object")return te;var ae=P.get(te);if(ae)return ae;if(o(te)){ae=[],P.set(te,ae);for(var he=0,Ee=te.length;he<Ee;++he)ae.push(z(te[he]))}else if(L.has(te.constructor))ae=te;else{var Le,He=c(te);for(Le in ae=He===Object.prototype?{}:Object.create(He),P.set(te,ae),te)d(te,Le)&&(ae[Le]=z(te[Le]))}return ae}(M),P=null,M}var F={}.toString;function X(M){return F.call(M).slice(8,-1)}var U=typeof Symbol<"u"?Symbol.iterator:"@@iterator",H=typeof U=="symbol"?function(M){var z;return M!=null&&(z=M[U])&&z.apply(M)}:function(){return null};function $(M,z){return z=M.indexOf(z),0<=z&&M.splice(z,1),0<=z}var ne={};function W(M){var z,te,ae,he;if(arguments.length===1){if(o(M))return M.slice();if(this===ne&&typeof M=="string")return[M];if(he=H(M)){for(te=[];!(ae=he.next()).done;)te.push(ae.value);return te}if(M==null)return[M];if(typeof(z=M.length)!="number")return[M];for(te=new Array(z);z--;)te[z]=M[z];return te}for(z=arguments.length,te=new Array(z);z--;)te[z]=arguments[z];return te}var Q=typeof Symbol<"u"?function(M){return M[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ft=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ha=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ft),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function se(M,z){this.name=M,this.message=z}function pe(M,z){return M+". Errors: "+Object.keys(z).map(function(te){return z[te].toString()}).filter(function(te,ae,he){return he.indexOf(te)===ae}).join(`
`)}function ce(M,z,te,ae){this.failures=z,this.failedKeys=ae,this.successCount=te,this.message=pe(M,z)}function Ie(M,z){this.name="BulkError",this.failures=Object.keys(z).map(function(te){return z[te]}),this.failuresByPos=z,this.message=pe(M,this.failures)}b(se).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(ce).from(se),b(Ie).from(se);var De=Ha.reduce(function(M,z){return M[z]=z+"Error",M},{}),Se=se,Ce=Ha.reduce(function(M,z){var te=z+"Error";function ae(he,Ee){this.name=te,he?typeof he=="string"?(this.message="".concat(he).concat(Ee?`
 `+Ee:""),this.inner=Ee||null):typeof he=="object"&&(this.message="".concat(he.name," ").concat(he.message),this.inner=he):(this.message=ee[z]||te,this.inner=null)}return b(ae).from(Se),M[z]=ae,M},{});Ce.Syntax=SyntaxError,Ce.Type=TypeError,Ce.Range=RangeError;var qe=ft.reduce(function(M,z){return M[z+"Error"]=Ce[z],M},{}),Qe=Ha.reduce(function(M,z){return["Syntax","Type","Range"].indexOf(z)===-1&&(M[z+"Error"]=Ce[z]),M},{});function Ve(){}function Ne(M){return M}function K(M,z){return M==null||M===Ne?z:function(te){return z(M(te))}}function me(M,z){return function(){M.apply(this,arguments),z.apply(this,arguments)}}function Ae(M,z){return M===Ve?z:function(){var te=M.apply(this,arguments);te!==void 0&&(arguments[0]=te);var ae=this.onsuccess,he=this.onerror;this.onsuccess=null,this.onerror=null;var Ee=z.apply(this,arguments);return ae&&(this.onsuccess=this.onsuccess?me(ae,this.onsuccess):ae),he&&(this.onerror=this.onerror?me(he,this.onerror):he),Ee!==void 0?Ee:te}}function le(M,z){return M===Ve?z:function(){M.apply(this,arguments);var te=this.onsuccess,ae=this.onerror;this.onsuccess=this.onerror=null,z.apply(this,arguments),te&&(this.onsuccess=this.onsuccess?me(te,this.onsuccess):te),ae&&(this.onerror=this.onerror?me(ae,this.onerror):ae)}}function oe(M,z){return M===Ve?z:function(te){var ae=M.apply(this,arguments);l(te,ae);var he=this.onsuccess,Ee=this.onerror;return this.onsuccess=null,this.onerror=null,te=z.apply(this,arguments),he&&(this.onsuccess=this.onsuccess?me(he,this.onsuccess):he),Ee&&(this.onerror=this.onerror?me(Ee,this.onerror):Ee),ae===void 0?te===void 0?void 0:te:l(ae,te)}}function re(M,z){return M===Ve?z:function(){return z.apply(this,arguments)!==!1&&M.apply(this,arguments)}}function Te(M,z){return M===Ve?z:function(){var te=M.apply(this,arguments);if(te&&typeof te.then=="function"){for(var ae=this,he=arguments.length,Ee=new Array(he);he--;)Ee[he]=arguments[he];return te.then(function(){return z.apply(ae,Ee)})}return z.apply(this,arguments)}}Qe.ModifyError=ce,Qe.DexieError=se,Qe.BulkError=Ie;var Be=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ke(M){Be=M}var lt={},Rt=100,jt=typeof Promise>"u"?[]:function(){var M=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[M,c(M),M];var z=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[z,c(z),M]}(),ft=jt[0],Ha=jt[1],jt=jt[2],Ha=Ha&&Ha.then,qt=ft&&ft.constructor,Lt=!!jt,en=function(M,z){de.push([M,z]),D&&(queueMicrotask(fe),D=!1)},xe=!0,D=!0,Z=[],ge=[],Fe=Ne,we={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ve,pgp:!1,env:{},finalize:Ve},Me=we,de=[],vt=0,ot=[];function B(M){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var z=this._PSD=Me;if(typeof M!="function"){if(M!==lt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ye(this,this._value))}this._state=null,this._value=null,++z.ref,function te(ae,he){try{he(function(Ee){if(ae._state===null){if(Ee===ae)throw new TypeError("A promise cannot be resolved with itself.");var Le=ae._lib&&Y();Ee&&typeof Ee.then=="function"?te(ae,function(He,nt){Ee instanceof B?Ee._then(He,nt):Ee.then(He,nt)}):(ae._state=!0,ae._value=Ee,_e(ae)),Le&&G()}},ye.bind(null,ae))}catch(Ee){ye(ae,Ee)}}(this,M)}var ze={get:function(){var M=Me,z=Xt;function te(ae,he){var Ee=this,Le=!M.global&&(M!==Me||z!==Xt),He=Le&&!Ar(),nt=new B(function(it,dt){Ue(Ee,new st(Vt(ae,M,Le,He),Vt(he,M,Le,He),it,dt,M))});return this._consoleTask&&(nt._consoleTask=this._consoleTask),nt}return te.prototype=lt,te},set:function(M){y(this,"then",M&&M.prototype===lt?ze:{get:function(){return M},set:ze.set})}};function st(M,z,te,ae,he){this.onFulfilled=typeof M=="function"?M:null,this.onRejected=typeof z=="function"?z:null,this.resolve=te,this.reject=ae,this.psd=he}function ye(M,z){var te,ae;ge.push(z),M._state===null&&(te=M._lib&&Y(),z=Fe(z),M._state=!1,M._value=z,ae=M,Z.some(function(he){return he._value===ae._value})||Z.push(ae),_e(M),te&&G())}function _e(M){var z=M._listeners;M._listeners=[];for(var te=0,ae=z.length;te<ae;++te)Ue(M,z[te]);var he=M._PSD;--he.ref||he.finalize(),vt===0&&(++vt,en(function(){--vt==0&&J()},[]))}function Ue(M,z){if(M._state!==null){var te=M._state?z.onFulfilled:z.onRejected;if(te===null)return(M._state?z.resolve:z.reject)(M._value);++z.psd.ref,++vt,en(kt,[te,M,z])}else M._listeners.push(z)}function kt(M,z,te){try{var ae,he=z._value;!z._state&&ge.length&&(ge=[]),ae=Be&&z._consoleTask?z._consoleTask.run(function(){return M(he)}):M(he),z._state||ge.indexOf(he)!==-1||function(Ee){for(var Le=Z.length;Le;)if(Z[--Le]._value===Ee._value)return Z.splice(Le,1)}(z),te.resolve(ae)}catch(Ee){te.reject(Ee)}finally{--vt==0&&J(),--te.psd.ref||te.psd.finalize()}}function fe(){et(we,function(){Y()&&G()})}function Y(){var M=xe;return D=xe=!1,M}function G(){var M,z,te;do for(;0<de.length;)for(M=de,de=[],te=M.length,z=0;z<te;++z){var ae=M[z];ae[0].apply(null,ae[1])}while(0<de.length);D=xe=!0}function J(){var M=Z;Z=[],M.forEach(function(ae){ae._PSD.onunhandled.call(null,ae._value,ae)});for(var z=ot.slice(0),te=z.length;te;)z[--te]()}function be(M){return new B(lt,!1,M)}function Pe(M,z){var te=Me;return function(){var ae=Y(),he=Me;try{return Cr(te,!0),M.apply(this,arguments)}catch(Ee){z&&z(Ee)}finally{Cr(he,!1),ae&&G()}}}h(B.prototype,{then:ze,_then:function(M,z){Ue(this,new st(null,null,M,z,Me))},catch:function(M){if(arguments.length===1)return this.then(null,M);var z=M,te=arguments[1];return typeof z=="function"?this.then(null,function(ae){return(ae instanceof z?te:be)(ae)}):this.then(null,function(ae){return(ae&&ae.name===z?te:be)(ae)})},finally:function(M){return this.then(function(z){return B.resolve(M()).then(function(){return z})},function(z){return B.resolve(M()).then(function(){return be(z)})})},timeout:function(M,z){var te=this;return M<1/0?new B(function(ae,he){var Ee=setTimeout(function(){return he(new Ce.Timeout(z))},M);te.then(ae,he).finally(clearTimeout.bind(null,Ee))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&y(B.prototype,Symbol.toStringTag,"Dexie.Promise"),we.env=hn(),h(B,{all:function(){var M=W.apply(null,arguments).map(ns);return new B(function(z,te){M.length===0&&z([]);var ae=M.length;M.forEach(function(he,Ee){return B.resolve(he).then(function(Le){M[Ee]=Le,--ae||z(M)},te)})})},resolve:function(M){return M instanceof B?M:M&&typeof M.then=="function"?new B(function(z,te){M.then(z,te)}):new B(lt,!0,M)},reject:be,race:function(){var M=W.apply(null,arguments).map(ns);return new B(function(z,te){M.map(function(ae){return B.resolve(ae).then(z,te)})})},PSD:{get:function(){return Me},set:function(M){return Me=M}},totalEchoes:{get:function(){return Xt}},newPSD:un,usePSD:et,scheduler:{get:function(){return en},set:function(M){en=M}},rejectionMapper:{get:function(){return Fe},set:function(M){Fe=M}},follow:function(M,z){return new B(function(te,ae){return un(function(he,Ee){var Le=Me;Le.unhandleds=[],Le.onunhandled=Ee,Le.finalize=me(function(){var He,nt=this;He=function(){nt.unhandleds.length===0?he():Ee(nt.unhandleds[0])},ot.push(function it(){He(),ot.splice(ot.indexOf(it),1)}),++vt,en(function(){--vt==0&&J()},[])},Le.finalize),M()},z,te,ae)})}}),qt&&(qt.allSettled&&y(B,"allSettled",function(){var M=W.apply(null,arguments).map(ns);return new B(function(z){M.length===0&&z([]);var te=M.length,ae=new Array(te);M.forEach(function(he,Ee){return B.resolve(he).then(function(Le){return ae[Ee]={status:"fulfilled",value:Le}},function(Le){return ae[Ee]={status:"rejected",reason:Le}}).then(function(){return--te||z(ae)})})})}),qt.any&&typeof AggregateError<"u"&&y(B,"any",function(){var M=W.apply(null,arguments).map(ns);return new B(function(z,te){M.length===0&&te(new AggregateError([]));var ae=M.length,he=new Array(ae);M.forEach(function(Ee,Le){return B.resolve(Ee).then(function(He){return z(He)},function(He){he[Le]=He,--ae||te(new AggregateError(he))})})})}),qt.withResolvers&&(B.withResolvers=qt.withResolvers));var Ge={awaits:0,echoes:0,id:0},_t=0,tn=[],Un=0,Xt=0,nn=0;function un(M,z,te,ae){var he=Me,Ee=Object.create(he);return Ee.parent=he,Ee.ref=0,Ee.global=!1,Ee.id=++nn,we.env,Ee.env=Lt?{Promise:B,PromiseProp:{value:B,configurable:!0,writable:!0},all:B.all,race:B.race,allSettled:B.allSettled,any:B.any,resolve:B.resolve,reject:B.reject}:{},z&&l(Ee,z),++he.ref,Ee.finalize=function(){--this.parent.ref||this.parent.finalize()},ae=et(Ee,M,te,ae),Ee.ref===0&&Ee.finalize(),ae}function mr(){return Ge.id||(Ge.id=++_t),++Ge.awaits,Ge.echoes+=Rt,Ge.id}function Ar(){return!!Ge.awaits&&(--Ge.awaits==0&&(Ge.id=0),Ge.echoes=Ge.awaits*Rt,!0)}function ns(M){return Ge.echoes&&M&&M.constructor===qt?(mr(),M.then(function(z){return Ar(),z},function(z){return Ar(),nr(z)})):M}function rs(){var M=tn[tn.length-1];tn.pop(),Cr(M,!1)}function Cr(M,z){var te,ae=Me;(z?!Ge.echoes||Un++&&M===Me:!Un||--Un&&M===Me)||queueMicrotask(z?(function(he){++Xt,Ge.echoes&&--Ge.echoes!=0||(Ge.echoes=Ge.awaits=Ge.id=0),tn.push(Me),Cr(he,!0)}).bind(null,M):rs),M!==Me&&(Me=M,ae===we&&(we.env=hn()),Lt&&(te=we.env.Promise,z=M.env,(ae.global||M.global)&&(Object.defineProperty(i,"Promise",z.PromiseProp),te.all=z.all,te.race=z.race,te.resolve=z.resolve,te.reject=z.reject,z.allSettled&&(te.allSettled=z.allSettled),z.any&&(te.any=z.any))))}function hn(){var M=i.Promise;return Lt?{Promise:M,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:M.all,race:M.race,allSettled:M.allSettled,any:M.any,resolve:M.resolve,reject:M.reject}:{}}function et(M,z,te,ae,he){var Ee=Me;try{return Cr(M,!0),z(te,ae,he)}finally{Cr(Ee,!1)}}function Vt(M,z,te,ae){return typeof M!="function"?M:function(){var he=Me;te&&mr(),Cr(z,!0);try{return M.apply(this,arguments)}finally{Cr(he,!1),ae&&queueMicrotask(Ar)}}}function pn(M){Promise===qt&&Ge.echoes===0?Un===0?M():enqueueNativeMicroTask(M):setTimeout(M,0)}(""+Ha).indexOf("[native code]")===-1&&(mr=Ar=Ve);var nr=B.reject,Ts="",es="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ii="String expected.",li=[],qa="__dbnames",ca="readonly",Vs="readwrite";function zo(M,z){return M?z?function(){return M.apply(this,arguments)&&z.apply(this,arguments)}:M:z}var yl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function uf(M){return typeof M!="string"||/\./.test(M)?function(z){return z}:function(z){return z[M]===void 0&&M in z&&delete(z=V(z))[M],z}}function tg(){throw Ce.Type()}function Dr(M,z){try{var te=yb(M),ae=yb(z);if(te!==ae)return te==="Array"?1:ae==="Array"?-1:te==="binary"?1:ae==="binary"?-1:te==="string"?1:ae==="string"?-1:te==="Date"?1:ae!=="Date"?NaN:-1;switch(te){case"number":case"Date":case"string":return z<M?1:M<z?-1:0;case"binary":return function(he,Ee){for(var Le=he.length,He=Ee.length,nt=Le<He?Le:He,it=0;it<nt;++it)if(he[it]!==Ee[it])return he[it]<Ee[it]?-1:1;return Le===He?0:Le<He?-1:1}(Va(M),Va(z));case"Array":return function(he,Ee){for(var Le=he.length,He=Ee.length,nt=Le<He?Le:He,it=0;it<nt;++it){var dt=Dr(he[it],Ee[it]);if(dt!==0)return dt}return Le===He?0:Le<He?-1:1}(M,z)}}catch{}return NaN}function yb(M){var z=typeof M;return z!="object"?z:ArrayBuffer.isView(M)?"binary":(M=X(M),M==="ArrayBuffer"?"binary":M)}function Va(M){return M instanceof Uint8Array?M:ArrayBuffer.isView(M)?new Uint8Array(M.buffer,M.byteOffset,M.byteLength):new Uint8Array(M)}var bb=(As.prototype._trans=function(M,z,te){var ae=this._tx||Me.trans,he=this.name,Ee=Be&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(M==="readonly"?"read":"write"," ").concat(this.name));function Le(it,dt,Je){if(!Je.schema[he])throw new Ce.NotFound("Table "+he+" not part of transaction");return z(Je.idbtrans,Je)}var He=Y();try{var nt=ae&&ae.db._novip===this.db._novip?ae===Me.trans?ae._promise(M,Le,te):un(function(){return ae._promise(M,Le,te)},{trans:ae,transless:Me.transless||Me}):function it(dt,Je,pt,tt){if(dt.idbdb&&(dt._state.openComplete||Me.letThrough||dt._vip)){var ut=dt._createTransaction(Je,pt,dt._dbSchema);try{ut.create(),dt._state.PR1398_maxLoop=3}catch(mt){return mt.name===De.InvalidState&&dt.isOpen()&&0<--dt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),dt.close({disableAutoOpen:!1}),dt.open().then(function(){return it(dt,Je,pt,tt)})):nr(mt)}return ut._promise(Je,function(mt,at){return un(function(){return Me.trans=ut,tt(mt,at,ut)})}).then(function(mt){if(Je==="readwrite")try{ut.idbtrans.commit()}catch{}return Je==="readonly"?mt:ut._completion.then(function(){return mt})})}if(dt._state.openComplete)return nr(new Ce.DatabaseClosed(dt._state.dbOpenError));if(!dt._state.isBeingOpened){if(!dt._state.autoOpen)return nr(new Ce.DatabaseClosed);dt.open().catch(Ve)}return dt._state.dbReadyPromise.then(function(){return it(dt,Je,pt,tt)})}(this.db,M,[this.name],Le);return Ee&&(nt._consoleTask=Ee,nt=nt.catch(function(it){return console.trace(it),nr(it)})),nt}finally{He&&G()}},As.prototype.get=function(M,z){var te=this;return M&&M.constructor===Object?this.where(M).first(z):M==null?nr(new Ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(ae){return te.core.get({trans:ae,key:M}).then(function(he){return te.hook.reading.fire(he)})}).then(z)},As.prototype.where=function(M){if(typeof M=="string")return new this.db.WhereClause(this,M);if(o(M))return new this.db.WhereClause(this,"[".concat(M.join("+"),"]"));var z=a(M);if(z.length===1)return this.where(z[0]).equals(M[z[0]]);var te=this.schema.indexes.concat(this.schema.primKey).filter(function(He){if(He.compound&&z.every(function(it){return 0<=He.keyPath.indexOf(it)})){for(var nt=0;nt<z.length;++nt)if(z.indexOf(He.keyPath[nt])===-1)return!1;return!0}return!1}).sort(function(He,nt){return He.keyPath.length-nt.keyPath.length})[0];if(te&&this.db._maxKey!==Ts){var Ee=te.keyPath.slice(0,z.length);return this.where(Ee).equals(Ee.map(function(nt){return M[nt]}))}!te&&Be&&console.warn("The query ".concat(JSON.stringify(M)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(z.join("+"),"]"));var ae=this.schema.idxByName;function he(He,nt){return Dr(He,nt)===0}var Le=z.reduce(function(Je,nt){var it=Je[0],dt=Je[1],Je=ae[nt],pt=M[nt];return[it||Je,it||!Je?zo(dt,Je&&Je.multi?function(tt){return tt=A(tt,nt),o(tt)&&tt.some(function(ut){return he(pt,ut)})}:function(tt){return he(pt,A(tt,nt))}):dt]},[null,null]),Ee=Le[0],Le=Le[1];return Ee?this.where(Ee.name).equals(M[Ee.keyPath]).filter(Le):te?this.filter(Le):this.where(z).equals("")},As.prototype.filter=function(M){return this.toCollection().and(M)},As.prototype.count=function(M){return this.toCollection().count(M)},As.prototype.offset=function(M){return this.toCollection().offset(M)},As.prototype.limit=function(M){return this.toCollection().limit(M)},As.prototype.each=function(M){return this.toCollection().each(M)},As.prototype.toArray=function(M){return this.toCollection().toArray(M)},As.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},As.prototype.orderBy=function(M){return new this.db.Collection(new this.db.WhereClause(this,o(M)?"[".concat(M.join("+"),"]"):M))},As.prototype.reverse=function(){return this.toCollection().reverse()},As.prototype.mapToClass=function(M){var z,te=this.db,ae=this.name;function he(){return z!==null&&z.apply(this,arguments)||this}(this.schema.mappedClass=M).prototype instanceof tg&&(function(nt,it){if(typeof it!="function"&&it!==null)throw new TypeError("Class extends value "+String(it)+" is not a constructor or null");function dt(){this.constructor=nt}n(nt,it),nt.prototype=it===null?Object.create(it):(dt.prototype=it.prototype,new dt)}(he,z=M),Object.defineProperty(he.prototype,"db",{get:function(){return te},enumerable:!1,configurable:!0}),he.prototype.table=function(){return ae},M=he);for(var Ee=new Set,Le=M.prototype;Le;Le=c(Le))Object.getOwnPropertyNames(Le).forEach(function(nt){return Ee.add(nt)});function He(nt){if(!nt)return nt;var it,dt=Object.create(M.prototype);for(it in nt)if(!Ee.has(it))try{dt[it]=nt[it]}catch{}return dt}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=He,this.hook("reading",He),M},As.prototype.defineClass=function(){return this.mapToClass(function(M){l(this,M)})},As.prototype.add=function(M,z){var te=this,ae=this.schema.primKey,he=ae.auto,Ee=ae.keyPath,Le=M;return Ee&&he&&(Le=uf(Ee)(M)),this._trans("readwrite",function(He){return te.core.mutate({trans:He,type:"add",keys:z!=null?[z]:null,values:[Le]})}).then(function(He){return He.numFailures?B.reject(He.failures[0]):He.lastResult}).then(function(He){if(Ee)try{R(M,Ee,He)}catch{}return He})},As.prototype.update=function(M,z){return typeof M!="object"||o(M)?this.where(":id").equals(M).modify(z):(M=A(M,this.schema.primKey.keyPath),M===void 0?nr(new Ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(M).modify(z))},As.prototype.put=function(M,z){var te=this,ae=this.schema.primKey,he=ae.auto,Ee=ae.keyPath,Le=M;return Ee&&he&&(Le=uf(Ee)(M)),this._trans("readwrite",function(He){return te.core.mutate({trans:He,type:"put",values:[Le],keys:z!=null?[z]:null})}).then(function(He){return He.numFailures?B.reject(He.failures[0]):He.lastResult}).then(function(He){if(Ee)try{R(M,Ee,He)}catch{}return He})},As.prototype.delete=function(M){var z=this;return this._trans("readwrite",function(te){return z.core.mutate({trans:te,type:"delete",keys:[M]})}).then(function(te){return te.numFailures?B.reject(te.failures[0]):void 0})},As.prototype.clear=function(){var M=this;return this._trans("readwrite",function(z){return M.core.mutate({trans:z,type:"deleteRange",range:yl})}).then(function(z){return z.numFailures?B.reject(z.failures[0]):void 0})},As.prototype.bulkGet=function(M){var z=this;return this._trans("readonly",function(te){return z.core.getMany({keys:M,trans:te}).then(function(ae){return ae.map(function(he){return z.hook.reading.fire(he)})})})},As.prototype.bulkAdd=function(M,z,te){var ae=this,he=Array.isArray(z)?z:void 0,Ee=(te=te||(he?void 0:z))?te.allKeys:void 0;return this._trans("readwrite",function(Le){var it=ae.schema.primKey,He=it.auto,it=it.keyPath;if(it&&he)throw new Ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(he&&he.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var nt=M.length,it=it&&He?M.map(uf(it)):M;return ae.core.mutate({trans:Le,type:"add",keys:he,values:it,wantResults:Ee}).then(function(ut){var Je=ut.numFailures,pt=ut.results,tt=ut.lastResult,ut=ut.failures;if(Je===0)return Ee?pt:tt;throw new Ie("".concat(ae.name,".bulkAdd(): ").concat(Je," of ").concat(nt," operations failed"),ut)})})},As.prototype.bulkPut=function(M,z,te){var ae=this,he=Array.isArray(z)?z:void 0,Ee=(te=te||(he?void 0:z))?te.allKeys:void 0;return this._trans("readwrite",function(Le){var it=ae.schema.primKey,He=it.auto,it=it.keyPath;if(it&&he)throw new Ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(he&&he.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var nt=M.length,it=it&&He?M.map(uf(it)):M;return ae.core.mutate({trans:Le,type:"put",keys:he,values:it,wantResults:Ee}).then(function(ut){var Je=ut.numFailures,pt=ut.results,tt=ut.lastResult,ut=ut.failures;if(Je===0)return Ee?pt:tt;throw new Ie("".concat(ae.name,".bulkPut(): ").concat(Je," of ").concat(nt," operations failed"),ut)})})},As.prototype.bulkUpdate=function(M){var z=this,te=this.core,ae=M.map(function(Le){return Le.key}),he=M.map(function(Le){return Le.changes}),Ee=[];return this._trans("readwrite",function(Le){return te.getMany({trans:Le,keys:ae,cache:"clone"}).then(function(He){var nt=[],it=[];M.forEach(function(Je,pt){var tt=Je.key,ut=Je.changes,mt=He[pt];if(mt){for(var at=0,St=Object.keys(ut);at<St.length;at++){var Nt=St[at],Mt=ut[Nt];if(Nt===z.schema.primKey.keyPath){if(Dr(Mt,tt)!==0)throw new Ce.Constraint("Cannot update primary key in bulkUpdate()")}else R(mt,Nt,Mt)}Ee.push(pt),nt.push(tt),it.push(mt)}});var dt=nt.length;return te.mutate({trans:Le,type:"put",keys:nt,values:it,updates:{keys:ae,changeSpecs:he}}).then(function(Je){var pt=Je.numFailures,tt=Je.failures;if(pt===0)return dt;for(var ut=0,mt=Object.keys(tt);ut<mt.length;ut++){var at,St=mt[ut],Nt=Ee[Number(St)];Nt!=null&&(at=tt[St],delete tt[St],tt[Nt]=at)}throw new Ie("".concat(z.name,".bulkUpdate(): ").concat(pt," of ").concat(dt," operations failed"),tt)})})})},As.prototype.bulkDelete=function(M){var z=this,te=M.length;return this._trans("readwrite",function(ae){return z.core.mutate({trans:ae,type:"delete",keys:M})}).then(function(Le){var he=Le.numFailures,Ee=Le.lastResult,Le=Le.failures;if(he===0)return Ee;throw new Ie("".concat(z.name,".bulkDelete(): ").concat(he," of ").concat(te," operations failed"),Le)})},As);function As(){}function Fc(M){function z(Le,He){if(He){for(var nt=arguments.length,it=new Array(nt-1);--nt;)it[nt-1]=arguments[nt];return te[Le].subscribe.apply(null,it),M}if(typeof Le=="string")return te[Le]}var te={};z.addEventType=Ee;for(var ae=1,he=arguments.length;ae<he;++ae)Ee(arguments[ae]);return z;function Ee(Le,He,nt){if(typeof Le!="object"){var it;He=He||re;var dt={subscribers:[],fire:nt=nt||Ve,subscribe:function(Je){dt.subscribers.indexOf(Je)===-1&&(dt.subscribers.push(Je),dt.fire=He(dt.fire,Je))},unsubscribe:function(Je){dt.subscribers=dt.subscribers.filter(function(pt){return pt!==Je}),dt.fire=dt.subscribers.reduce(He,nt)}};return te[Le]=z[Le]=dt}a(it=Le).forEach(function(Je){var pt=it[Je];if(o(pt))Ee(Je,it[Je][0],it[Je][1]);else{if(pt!=="asap")throw new Ce.InvalidArgument("Invalid event config");var tt=Ee(Je,Ne,function(){for(var ut=arguments.length,mt=new Array(ut);ut--;)mt[ut]=arguments[ut];tt.subscribers.forEach(function(at){k(function(){at.apply(null,mt)})})})}})}}function df(M,z){return b(z).from({prototype:M}),z}function Jl(M,z){return!(M.filter||M.algorithm||M.or)&&(z?M.justLimit:!M.replayFilter)}function vb(M,z){M.filter=zo(M.filter,z)}function Sa(M,z,te){var ae=M.replayFilter;M.replayFilter=ae?function(){return zo(ae(),z())}:z,M.justLimit=te&&!ae}function ff(M,z){if(M.isPrimKey)return z.primaryKey;var te=z.getIndexByKeyPath(M.index);if(!te)throw new Ce.Schema("KeyPath "+M.index+" on object store "+z.name+" is not indexed");return te}function xb(M,z,te){var ae=ff(M,z.schema);return z.openCursor({trans:te,values:!M.keysOnly,reverse:M.dir==="prev",unique:!!M.unique,query:{index:ae,range:M.range}})}function hf(M,z,te,ae){var he=M.replayFilter?zo(M.filter,M.replayFilter()):M.filter;if(M.or){var Ee={},Le=function(He,nt,it){var dt,Je;he&&!he(nt,it,function(pt){return nt.stop(pt)},function(pt){return nt.fail(pt)})||((Je=""+(dt=nt.primaryKey))=="[object ArrayBuffer]"&&(Je=""+new Uint8Array(dt)),d(Ee,Je)||(Ee[Je]=!0,z(He,nt,it)))};return Promise.all([M.or._iterate(Le,te),Bu(xb(M,ae,te),M.algorithm,Le,!M.keysOnly&&M.valueMapper)])}return Bu(xb(M,ae,te),zo(M.algorithm,he),z,!M.keysOnly&&M.valueMapper)}function Bu(M,z,te,ae){var he=Pe(ae?function(Ee,Le,He){return te(ae(Ee),Le,He)}:te);return M.then(function(Ee){if(Ee)return Ee.start(function(){var Le=function(){return Ee.continue()};z&&!z(Ee,function(He){return Le=He},function(He){Ee.stop(He),Le=Ve},function(He){Ee.fail(He),Le=Ve})||he(Ee.value,Ee,function(He){return Le=He}),Le()})})}var pf=(wb.prototype.execute=function(M){var z=this["@@propmod"];if(z.add!==void 0){var te=z.add;if(o(te))return s(s([],o(M)?M:[],!0),te).sort();if(typeof te=="number")return(Number(M)||0)+te;if(typeof te=="bigint")try{return BigInt(M)+te}catch{return BigInt(0)+te}throw new TypeError("Invalid term ".concat(te))}if(z.remove!==void 0){var ae=z.remove;if(o(ae))return o(M)?M.filter(function(he){return!ae.includes(he)}).sort():[];if(typeof ae=="number")return Number(M)-ae;if(typeof ae=="bigint")try{return BigInt(M)-ae}catch{return BigInt(0)-ae}throw new TypeError("Invalid subtrahend ".concat(ae))}return te=(te=z.replacePrefix)===null||te===void 0?void 0:te[0],te&&typeof M=="string"&&M.startsWith(te)?z.replacePrefix[1]+M.substring(te.length):M},wb);function wb(M){this["@@propmod"]=M}var mf=(Hr.prototype._read=function(M,z){var te=this._ctx;return te.error?te.table._trans(null,nr.bind(null,te.error)):te.table._trans("readonly",M).then(z)},Hr.prototype._write=function(M){var z=this._ctx;return z.error?z.table._trans(null,nr.bind(null,z.error)):z.table._trans("readwrite",M,"locked")},Hr.prototype._addAlgorithm=function(M){var z=this._ctx;z.algorithm=zo(z.algorithm,M)},Hr.prototype._iterate=function(M,z){return hf(this._ctx,M,z,this._ctx.table.core)},Hr.prototype.clone=function(M){var z=Object.create(this.constructor.prototype),te=Object.create(this._ctx);return M&&l(te,M),z._ctx=te,z},Hr.prototype.raw=function(){return this._ctx.valueMapper=null,this},Hr.prototype.each=function(M){var z=this._ctx;return this._read(function(te){return hf(z,M,te,z.table.core)})},Hr.prototype.count=function(M){var z=this;return this._read(function(te){var ae=z._ctx,he=ae.table.core;if(Jl(ae,!0))return he.count({trans:te,query:{index:ff(ae,he.schema),range:ae.range}}).then(function(Le){return Math.min(Le,ae.limit)});var Ee=0;return hf(ae,function(){return++Ee,!1},te,he).then(function(){return Ee})}).then(M)},Hr.prototype.sortBy=function(M,z){var te=M.split(".").reverse(),ae=te[0],he=te.length-1;function Ee(nt,it){return it?Ee(nt[te[it]],it-1):nt[ae]}var Le=this._ctx.dir==="next"?1:-1;function He(nt,it){return Dr(Ee(nt,he),Ee(it,he))*Le}return this.toArray(function(nt){return nt.sort(He)}).then(z)},Hr.prototype.toArray=function(M){var z=this;return this._read(function(te){var ae=z._ctx;if(ae.dir==="next"&&Jl(ae,!0)&&0<ae.limit){var he=ae.valueMapper,Ee=ff(ae,ae.table.core.schema);return ae.table.core.query({trans:te,limit:ae.limit,values:!0,query:{index:Ee,range:ae.range}}).then(function(He){return He=He.result,he?He.map(he):He})}var Le=[];return hf(ae,function(He){return Le.push(He)},te,ae.table.core).then(function(){return Le})},M)},Hr.prototype.offset=function(M){var z=this._ctx;return M<=0||(z.offset+=M,Jl(z)?Sa(z,function(){var te=M;return function(ae,he){return te===0||(te===1?--te:he(function(){ae.advance(te),te=0}),!1)}}):Sa(z,function(){var te=M;return function(){return--te<0}})),this},Hr.prototype.limit=function(M){return this._ctx.limit=Math.min(this._ctx.limit,M),Sa(this._ctx,function(){var z=M;return function(te,ae,he){return--z<=0&&ae(he),0<=z}},!0),this},Hr.prototype.until=function(M,z){return vb(this._ctx,function(te,ae,he){return!M(te.value)||(ae(he),z)}),this},Hr.prototype.first=function(M){return this.limit(1).toArray(function(z){return z[0]}).then(M)},Hr.prototype.last=function(M){return this.reverse().first(M)},Hr.prototype.filter=function(M){var z;return vb(this._ctx,function(te){return M(te.value)}),(z=this._ctx).isMatch=zo(z.isMatch,M),this},Hr.prototype.and=function(M){return this.filter(M)},Hr.prototype.or=function(M){return new this.db.WhereClause(this._ctx.table,M,this)},Hr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Hr.prototype.desc=function(){return this.reverse()},Hr.prototype.eachKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(te,ae){M(ae.key,ae)})},Hr.prototype.eachUniqueKey=function(M){return this._ctx.unique="unique",this.eachKey(M)},Hr.prototype.eachPrimaryKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(te,ae){M(ae.primaryKey,ae)})},Hr.prototype.keys=function(M){var z=this._ctx;z.keysOnly=!z.isMatch;var te=[];return this.each(function(ae,he){te.push(he.key)}).then(function(){return te}).then(M)},Hr.prototype.primaryKeys=function(M){var z=this._ctx;if(z.dir==="next"&&Jl(z,!0)&&0<z.limit)return this._read(function(ae){var he=ff(z,z.table.core.schema);return z.table.core.query({trans:ae,values:!1,limit:z.limit,query:{index:he,range:z.range}})}).then(function(ae){return ae.result}).then(M);z.keysOnly=!z.isMatch;var te=[];return this.each(function(ae,he){te.push(he.primaryKey)}).then(function(){return te}).then(M)},Hr.prototype.uniqueKeys=function(M){return this._ctx.unique="unique",this.keys(M)},Hr.prototype.firstKey=function(M){return this.limit(1).keys(function(z){return z[0]}).then(M)},Hr.prototype.lastKey=function(M){return this.reverse().firstKey(M)},Hr.prototype.distinct=function(){var M=this._ctx,M=M.index&&M.table.schema.idxByName[M.index];if(!M||!M.multi)return this;var z={};return vb(this._ctx,function(he){var ae=he.primaryKey.toString(),he=d(z,ae);return z[ae]=!0,!he}),this},Hr.prototype.modify=function(M){var z=this,te=this._ctx;return this._write(function(ae){var he,Ee,Le;Le=typeof M=="function"?M:(he=a(M),Ee=he.length,function(at){for(var St=!1,Nt=0;Nt<Ee;++Nt){var Mt=he[Nt],Ot=M[Mt],Yt=A(at,Mt);Ot instanceof pf?(R(at,Mt,Ot.execute(Yt)),St=!0):Yt!==Ot&&(R(at,Mt,Ot),St=!0)}return St});var He=te.table.core,Je=He.schema.primaryKey,nt=Je.outbound,it=Je.extractKey,dt=200,Je=z.db._options.modifyChunkSize;Je&&(dt=typeof Je=="object"?Je[He.name]||Je["*"]||200:Je);function pt(at,Mt){var Nt=Mt.failures,Mt=Mt.numFailures;ut+=at-Mt;for(var Ot=0,Yt=a(Nt);Ot<Yt.length;Ot++){var rn=Yt[Ot];tt.push(Nt[rn])}}var tt=[],ut=0,mt=[];return z.clone().primaryKeys().then(function(at){function St(Mt){var Ot=Math.min(dt,at.length-Mt);return He.getMany({trans:ae,keys:at.slice(Mt,Mt+Ot),cache:"immutable"}).then(function(Yt){for(var rn=[],Ht=[],Jt=nt?[]:null,an=[],Gt=0;Gt<Ot;++Gt){var mn=Yt[Gt],Ln={value:V(mn),primKey:at[Mt+Gt]};Le.call(Ln,Ln.value,Ln)!==!1&&(Ln.value==null?an.push(at[Mt+Gt]):nt||Dr(it(mn),it(Ln.value))===0?(Ht.push(Ln.value),nt&&Jt.push(at[Mt+Gt])):(an.push(at[Mt+Gt]),rn.push(Ln.value)))}return Promise.resolve(0<rn.length&&He.mutate({trans:ae,type:"add",values:rn}).then(function(Vn){for(var fr in Vn.failures)an.splice(parseInt(fr),1);pt(rn.length,Vn)})).then(function(){return(0<Ht.length||Nt&&typeof M=="object")&&He.mutate({trans:ae,type:"put",keys:Jt,values:Ht,criteria:Nt,changeSpec:typeof M!="function"&&M,isAdditionalChunk:0<Mt}).then(function(Vn){return pt(Ht.length,Vn)})}).then(function(){return(0<an.length||Nt&&M===ng)&&He.mutate({trans:ae,type:"delete",keys:an,criteria:Nt,isAdditionalChunk:0<Mt}).then(function(Vn){return pt(an.length,Vn)})}).then(function(){return at.length>Mt+Ot&&St(Mt+dt)})})}var Nt=Jl(te)&&te.limit===1/0&&(typeof M!="function"||M===ng)&&{index:te.index,range:te.range};return St(0).then(function(){if(0<tt.length)throw new ce("Error modifying one or more objects",tt,ut,mt);return at.length})})})},Hr.prototype.delete=function(){var M=this._ctx,z=M.range;return Jl(M)&&(M.isPrimKey||z.type===3)?this._write(function(te){var ae=M.table.core.schema.primaryKey,he=z;return M.table.core.count({trans:te,query:{index:ae,range:he}}).then(function(Ee){return M.table.core.mutate({trans:te,type:"deleteRange",range:he}).then(function(Le){var He=Le.failures;if(Le.lastResult,Le.results,Le=Le.numFailures,Le)throw new ce("Could not delete some values",Object.keys(He).map(function(nt){return He[nt]}),Ee-Le);return Ee-Le})})}):this.modify(ng)},Hr);function Hr(){}var ng=function(M,z){return z.value=null};function d_(M,z){return M<z?-1:M===z?0:1}function _b(M,z){return z<M?-1:M===z?0:1}function Wa(M,z,te){return M=M instanceof zu?new M.Collection(M):M,M._ctx.error=new(te||TypeError)(z),M}function gf(M){return new M.Collection(M,function(){return rg("")}).limit(0)}function $u(M,z,te,ae){var he,Ee,Le,He,nt,it,dt,Je=te.length;if(!te.every(function(ut){return typeof ut=="string"}))return Wa(M,Ii);function pt(ut){he=ut==="next"?function(at){return at.toUpperCase()}:function(at){return at.toLowerCase()},Ee=ut==="next"?function(at){return at.toLowerCase()}:function(at){return at.toUpperCase()},Le=ut==="next"?d_:_b;var mt=te.map(function(at){return{lower:Ee(at),upper:he(at)}}).sort(function(at,St){return Le(at.lower,St.lower)});He=mt.map(function(at){return at.upper}),nt=mt.map(function(at){return at.lower}),dt=(it=ut)==="next"?"":ae}pt("next"),M=new M.Collection(M,function(){return bl(He[0],nt[Je-1]+ae)}),M._ondirectionchange=function(ut){pt(ut)};var tt=0;return M._addAlgorithm(function(ut,mt,at){var St=ut.key;if(typeof St!="string")return!1;var Nt=Ee(St);if(z(Nt,nt,tt))return!0;for(var Mt=null,Ot=tt;Ot<Je;++Ot){var Yt=function(rn,Ht,Jt,an,Gt,mn){for(var Ln=Math.min(rn.length,an.length),Vn=-1,fr=0;fr<Ln;++fr){var ua=Ht[fr];if(ua!==an[fr])return Gt(rn[fr],Jt[fr])<0?rn.substr(0,fr)+Jt[fr]+Jt.substr(fr+1):Gt(rn[fr],an[fr])<0?rn.substr(0,fr)+an[fr]+Jt.substr(fr+1):0<=Vn?rn.substr(0,Vn)+Ht[Vn]+Jt.substr(Vn+1):null;Gt(rn[fr],ua)<0&&(Vn=fr)}return Ln<an.length&&mn==="next"?rn+Jt.substr(rn.length):Ln<rn.length&&mn==="prev"?rn.substr(0,Jt.length):Vn<0?null:rn.substr(0,Vn)+an[Vn]+Jt.substr(Vn+1)}(St,Nt,He[Ot],nt[Ot],Le,it);Yt===null&&Mt===null?tt=Ot+1:(Mt===null||0<Le(Mt,Yt))&&(Mt=Yt)}return mt(Mt!==null?function(){ut.continue(Mt+dt)}:at),!1}),M}function bl(M,z,te,ae){return{type:2,lower:M,upper:z,lowerOpen:te,upperOpen:ae}}function rg(M){return{type:1,lower:M,upper:M}}var zu=(Object.defineProperty(Ds.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ds.prototype.between=function(M,z,te,ae){te=te!==!1,ae=ae===!0;try{return 0<this._cmp(M,z)||this._cmp(M,z)===0&&(te||ae)&&(!te||!ae)?gf(this):new this.Collection(this,function(){return bl(M,z,!te,!ae)})}catch{return Wa(this,es)}},Ds.prototype.equals=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return rg(M)})},Ds.prototype.above=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return bl(M,void 0,!0)})},Ds.prototype.aboveOrEqual=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return bl(M,void 0,!1)})},Ds.prototype.below=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return bl(void 0,M,!1,!0)})},Ds.prototype.belowOrEqual=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return bl(void 0,M)})},Ds.prototype.startsWith=function(M){return typeof M!="string"?Wa(this,Ii):this.between(M,M+Ts,!0,!0)},Ds.prototype.startsWithIgnoreCase=function(M){return M===""?this.startsWith(M):$u(this,function(z,te){return z.indexOf(te[0])===0},[M],Ts)},Ds.prototype.equalsIgnoreCase=function(M){return $u(this,function(z,te){return z===te[0]},[M],"")},Ds.prototype.anyOfIgnoreCase=function(){var M=W.apply(ne,arguments);return M.length===0?gf(this):$u(this,function(z,te){return te.indexOf(z)!==-1},M,"")},Ds.prototype.startsWithAnyOfIgnoreCase=function(){var M=W.apply(ne,arguments);return M.length===0?gf(this):$u(this,function(z,te){return te.some(function(ae){return z.indexOf(ae)===0})},M,Ts)},Ds.prototype.anyOf=function(){var M=this,z=W.apply(ne,arguments),te=this._cmp;try{z.sort(te)}catch{return Wa(this,es)}if(z.length===0)return gf(this);var ae=new this.Collection(this,function(){return bl(z[0],z[z.length-1])});ae._ondirectionchange=function(Ee){te=Ee==="next"?M._ascending:M._descending,z.sort(te)};var he=0;return ae._addAlgorithm(function(Ee,Le,He){for(var nt=Ee.key;0<te(nt,z[he]);)if(++he===z.length)return Le(He),!1;return te(nt,z[he])===0||(Le(function(){Ee.continue(z[he])}),!1)}),ae},Ds.prototype.notEqual=function(M){return this.inAnyRange([[-1/0,M],[M,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ds.prototype.noneOf=function(){var M=W.apply(ne,arguments);if(M.length===0)return new this.Collection(this);try{M.sort(this._ascending)}catch{return Wa(this,es)}var z=M.reduce(function(te,ae){return te?te.concat([[te[te.length-1][1],ae]]):[[-1/0,ae]]},null);return z.push([M[M.length-1],this.db._maxKey]),this.inAnyRange(z,{includeLowers:!1,includeUppers:!1})},Ds.prototype.inAnyRange=function(St,z){var te=this,ae=this._cmp,he=this._ascending,Ee=this._descending,Le=this._min,He=this._max;if(St.length===0)return gf(this);if(!St.every(function(Nt){return Nt[0]!==void 0&&Nt[1]!==void 0&&he(Nt[0],Nt[1])<=0}))return Wa(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ce.InvalidArgument);var nt=!z||z.includeLowers!==!1,it=z&&z.includeUppers===!0,dt,Je=he;function pt(Nt,Mt){return Je(Nt[0],Mt[0])}try{(dt=St.reduce(function(Nt,Mt){for(var Ot=0,Yt=Nt.length;Ot<Yt;++Ot){var rn=Nt[Ot];if(ae(Mt[0],rn[1])<0&&0<ae(Mt[1],rn[0])){rn[0]=Le(rn[0],Mt[0]),rn[1]=He(rn[1],Mt[1]);break}}return Ot===Yt&&Nt.push(Mt),Nt},[])).sort(pt)}catch{return Wa(this,es)}var tt=0,ut=it?function(Nt){return 0<he(Nt,dt[tt][1])}:function(Nt){return 0<=he(Nt,dt[tt][1])},mt=nt?function(Nt){return 0<Ee(Nt,dt[tt][0])}:function(Nt){return 0<=Ee(Nt,dt[tt][0])},at=ut,St=new this.Collection(this,function(){return bl(dt[0][0],dt[dt.length-1][1],!nt,!it)});return St._ondirectionchange=function(Nt){Je=Nt==="next"?(at=ut,he):(at=mt,Ee),dt.sort(pt)},St._addAlgorithm(function(Nt,Mt,Ot){for(var Yt,rn=Nt.key;at(rn);)if(++tt===dt.length)return Mt(Ot),!1;return!ut(Yt=rn)&&!mt(Yt)||(te._cmp(rn,dt[tt][1])===0||te._cmp(rn,dt[tt][0])===0||Mt(function(){Je===he?Nt.continue(dt[tt][0]):Nt.continue(dt[tt][1])}),!1)}),St},Ds.prototype.startsWithAnyOf=function(){var M=W.apply(ne,arguments);return M.every(function(z){return typeof z=="string"})?M.length===0?gf(this):this.inAnyRange(M.map(function(z){return[z,z+Ts]})):Wa(this,"startsWithAnyOf() only works with strings")},Ds);function Ds(){}function Uo(M){return Pe(function(z){return Uu(z),M(z.target.error),!1})}function Uu(M){M.stopPropagation&&M.stopPropagation(),M.preventDefault&&M.preventDefault()}var yf="storagemutated",qu="x-storagemutated-1",Hi=Fc(null,yf),Sb=(Ca.prototype._lock=function(){return C(!Me.global),++this._reculock,this._reculock!==1||Me.global||(Me.lockOwnerFor=this),this},Ca.prototype._unlock=function(){if(C(!Me.global),--this._reculock==0)for(Me.global||(Me.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var M=this._blockedFuncs.shift();try{et(M[1],M[0])}catch{}}return this},Ca.prototype._locked=function(){return this._reculock&&Me.lockOwnerFor!==this},Ca.prototype.create=function(M){var z=this;if(!this.mode)return this;var te=this.db.idbdb,ae=this.db._state.dbOpenError;if(C(!this.idbtrans),!M&&!te)switch(ae&&ae.name){case"DatabaseClosedError":throw new Ce.DatabaseClosed(ae);case"MissingAPIError":throw new Ce.MissingAPI(ae.message,ae);default:throw new Ce.OpenFailed(ae)}if(!this.active)throw new Ce.TransactionInactive;return C(this._completion._state===null),(M=this.idbtrans=M||(this.db.core||te).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Pe(function(he){Uu(he),z._reject(M.error)}),M.onabort=Pe(function(he){Uu(he),z.active&&z._reject(new Ce.Abort(M.error)),z.active=!1,z.on("abort").fire(he)}),M.oncomplete=Pe(function(){z.active=!1,z._resolve(),"mutatedParts"in M&&Hi.storagemutated.fire(M.mutatedParts)}),this},Ca.prototype._promise=function(M,z,te){var ae=this;if(M==="readwrite"&&this.mode!=="readwrite")return nr(new Ce.ReadOnly("Transaction is readonly"));if(!this.active)return nr(new Ce.TransactionInactive);if(this._locked())return new B(function(Ee,Le){ae._blockedFuncs.push([function(){ae._promise(M,z,te).then(Ee,Le)},Me])});if(te)return un(function(){var Ee=new B(function(Le,He){ae._lock();var nt=z(Le,He,ae);nt&&nt.then&&nt.then(Le,He)});return Ee.finally(function(){return ae._unlock()}),Ee._lib=!0,Ee});var he=new B(function(Ee,Le){var He=z(Ee,Le,ae);He&&He.then&&He.then(Ee,Le)});return he._lib=!0,he},Ca.prototype._root=function(){return this.parent?this.parent._root():this},Ca.prototype.waitFor=function(M){var z,te=this._root(),ae=B.resolve(M);te._waitingFor?te._waitingFor=te._waitingFor.then(function(){return ae}):(te._waitingFor=ae,te._waitingQueue=[],z=te.idbtrans.objectStore(te.storeNames[0]),function Ee(){for(++te._spinCount;te._waitingQueue.length;)te._waitingQueue.shift()();te._waitingFor&&(z.get(-1/0).onsuccess=Ee)}());var he=te._waitingFor;return new B(function(Ee,Le){ae.then(function(He){return te._waitingQueue.push(Pe(Ee.bind(null,He)))},function(He){return te._waitingQueue.push(Pe(Le.bind(null,He)))}).finally(function(){te._waitingFor===he&&(te._waitingFor=null)})})},Ca.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ce.Abort))},Ca.prototype.table=function(M){var z=this._memoizedTables||(this._memoizedTables={});if(d(z,M))return z[M];var te=this.schema[M];if(!te)throw new Ce.NotFound("Table "+M+" not part of transaction");return te=new this.db.Table(M,te,this),te.core=this.db.core.table(M),z[M]=te},Ca);function Ca(){}function vl(M,z,te,ae,he,Ee,Le){return{name:M,keyPath:z,unique:te,multi:ae,auto:he,compound:Ee,src:(te&&!Le?"&":"")+(ae?"*":"")+(he?"++":"")+sg(z)}}function sg(M){return typeof M=="string"?M:M?"["+[].join.call(M,"+")+"]":""}function bf(M,z,te){return{name:M,primKey:z,indexes:te,mappedClass:null,idxByName:(ae=function(he){return[he.name,he]},te.reduce(function(he,Ee,Le){return Le=ae(Ee,Le),Le&&(he[Le[0]]=Le[1]),he},{}))};var ae}var vf=function(M){try{return M.only([[]]),vf=function(){return[[]]},[[]]}catch{return vf=function(){return Ts},Ts}};function xf(M){return M==null?function(){}:typeof M=="string"?(z=M).split(".").length===1?function(te){return te[z]}:function(te){return A(te,z)}:function(te){return A(te,M)};var z}function rp(M){return[].slice.call(M)}var f_=0;function xi(M){return M==null?":id":typeof M=="string"?M:"[".concat(M.join("+"),"]")}function Vu(M,z,nt){function ae(at){if(at.type===3)return null;if(at.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var tt=at.lower,ut=at.upper,mt=at.lowerOpen,at=at.upperOpen;return tt===void 0?ut===void 0?null:z.upperBound(ut,!!at):ut===void 0?z.lowerBound(tt,!!mt):z.bound(tt,ut,!!mt,!!at)}function he(pt){var tt,ut=pt.name;return{name:ut,schema:pt,mutate:function(mt){var at=mt.trans,St=mt.type,Nt=mt.keys,Mt=mt.values,Ot=mt.range;return new Promise(function(Yt,rn){Yt=Pe(Yt);var Ht=at.objectStore(ut),Jt=Ht.keyPath==null,an=St==="put"||St==="add";if(!an&&St!=="delete"&&St!=="deleteRange")throw new Error("Invalid operation type: "+St);var Gt,mn=(Nt||Mt||{length:1}).length;if(Nt&&Mt&&Nt.length!==Mt.length)throw new Error("Given keys array must have same length as given values array.");if(mn===0)return Yt({numFailures:0,failures:{},results:[],lastResult:void 0});function Ln(Ki){++ua,Uu(Ki)}var Vn=[],fr=[],ua=0;if(St==="deleteRange"){if(Ot.type===4)return Yt({numFailures:ua,failures:fr,results:[],lastResult:void 0});Ot.type===3?Vn.push(Gt=Ht.clear()):Vn.push(Gt=Ht.delete(ae(Ot)))}else{var Jt=an?Jt?[Mt,Nt]:[Mt,null]:[Nt,null],rr=Jt[0],ci=Jt[1];if(an)for(var wi=0;wi<mn;++wi)Vn.push(Gt=ci&&ci[wi]!==void 0?Ht[St](rr[wi],ci[wi]):Ht[St](rr[wi])),Gt.onerror=Ln;else for(wi=0;wi<mn;++wi)Vn.push(Gt=Ht[St](rr[wi])),Gt.onerror=Ln}function Ql(Ki){Ki=Ki.target.result,Vn.forEach(function(wl,zc){return wl.error!=null&&(fr[zc]=wl.error)}),Yt({numFailures:ua,failures:fr,results:St==="delete"?Nt:Vn.map(function(wl){return wl.result}),lastResult:Ki})}Gt.onerror=function(Ki){Ln(Ki),Ql(Ki)},Gt.onsuccess=Ql})},getMany:function(mt){var at=mt.trans,St=mt.keys;return new Promise(function(Nt,Mt){Nt=Pe(Nt);for(var Ot,Yt=at.objectStore(ut),rn=St.length,Ht=new Array(rn),Jt=0,an=0,Gt=function(Vn){Vn=Vn.target,Ht[Vn._pos]=Vn.result,++an===Jt&&Nt(Ht)},mn=Uo(Mt),Ln=0;Ln<rn;++Ln)St[Ln]!=null&&((Ot=Yt.get(St[Ln]))._pos=Ln,Ot.onsuccess=Gt,Ot.onerror=mn,++Jt);Jt===0&&Nt(Ht)})},get:function(mt){var at=mt.trans,St=mt.key;return new Promise(function(Nt,Mt){Nt=Pe(Nt);var Ot=at.objectStore(ut).get(St);Ot.onsuccess=function(Yt){return Nt(Yt.target.result)},Ot.onerror=Uo(Mt)})},query:(tt=it,function(mt){return new Promise(function(at,St){at=Pe(at);var Nt,Mt,Ot,Jt=mt.trans,Yt=mt.values,rn=mt.limit,Gt=mt.query,Ht=rn===1/0?void 0:rn,an=Gt.index,Gt=Gt.range,Jt=Jt.objectStore(ut),an=an.isPrimaryKey?Jt:Jt.index(an.name),Gt=ae(Gt);if(rn===0)return at({result:[]});tt?((Ht=Yt?an.getAll(Gt,Ht):an.getAllKeys(Gt,Ht)).onsuccess=function(mn){return at({result:mn.target.result})},Ht.onerror=Uo(St)):(Nt=0,Mt=!Yt&&"openKeyCursor"in an?an.openKeyCursor(Gt):an.openCursor(Gt),Ot=[],Mt.onsuccess=function(mn){var Ln=Mt.result;return Ln?(Ot.push(Yt?Ln.value:Ln.primaryKey),++Nt===rn?at({result:Ot}):void Ln.continue()):at({result:Ot})},Mt.onerror=Uo(St))})}),openCursor:function(mt){var at=mt.trans,St=mt.values,Nt=mt.query,Mt=mt.reverse,Ot=mt.unique;return new Promise(function(Yt,rn){Yt=Pe(Yt);var an=Nt.index,Ht=Nt.range,Jt=at.objectStore(ut),Jt=an.isPrimaryKey?Jt:Jt.index(an.name),an=Mt?Ot?"prevunique":"prev":Ot?"nextunique":"next",Gt=!St&&"openKeyCursor"in Jt?Jt.openKeyCursor(ae(Ht),an):Jt.openCursor(ae(Ht),an);Gt.onerror=Uo(rn),Gt.onsuccess=Pe(function(mn){var Ln,Vn,fr,ua,rr=Gt.result;rr?(rr.___id=++f_,rr.done=!1,Ln=rr.continue.bind(rr),Vn=(Vn=rr.continuePrimaryKey)&&Vn.bind(rr),fr=rr.advance.bind(rr),ua=function(){throw new Error("Cursor not stopped")},rr.trans=at,rr.stop=rr.continue=rr.continuePrimaryKey=rr.advance=function(){throw new Error("Cursor not started")},rr.fail=Pe(rn),rr.next=function(){var ci=this,wi=1;return this.start(function(){return wi--?ci.continue():ci.stop()}).then(function(){return ci})},rr.start=function(ci){function wi(){if(Gt.result)try{ci()}catch(Ki){rr.fail(Ki)}else rr.done=!0,rr.start=function(){throw new Error("Cursor behind last entry")},rr.stop()}var Ql=new Promise(function(Ki,wl){Ki=Pe(Ki),Gt.onerror=Uo(wl),rr.fail=wl,rr.stop=function(zc){rr.stop=rr.continue=rr.continuePrimaryKey=rr.advance=ua,Ki(zc)}});return Gt.onsuccess=Pe(function(Ki){Gt.onsuccess=wi,wi()}),rr.continue=Ln,rr.continuePrimaryKey=Vn,rr.advance=fr,wi(),Ql},Yt(rr)):Yt(null)},rn)})},count:function(mt){var at=mt.query,St=mt.trans,Nt=at.index,Mt=at.range;return new Promise(function(Ot,Yt){var rn=St.objectStore(ut),Ht=Nt.isPrimaryKey?rn:rn.index(Nt.name),rn=ae(Mt),Ht=rn?Ht.count(rn):Ht.count();Ht.onsuccess=Pe(function(Jt){return Ot(Jt.target.result)}),Ht.onerror=Uo(Yt)})}}}var Ee,Le,He,dt=(Le=nt,He=rp((Ee=M).objectStoreNames),{schema:{name:Ee.name,tables:He.map(function(pt){return Le.objectStore(pt)}).map(function(pt){var tt=pt.keyPath,at=pt.autoIncrement,ut=o(tt),mt={},at={name:pt.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:tt==null,compound:ut,keyPath:tt,autoIncrement:at,unique:!0,extractKey:xf(tt)},indexes:rp(pt.indexNames).map(function(St){return pt.index(St)}).map(function(Ot){var Nt=Ot.name,Mt=Ot.unique,Yt=Ot.multiEntry,Ot=Ot.keyPath,Yt={name:Nt,compound:o(Ot),keyPath:Ot,unique:Mt,multiEntry:Yt,extractKey:xf(Ot)};return mt[xi(Ot)]=Yt}),getIndexByKeyPath:function(St){return mt[xi(St)]}};return mt[":id"]=at.primaryKey,tt!=null&&(mt[xi(tt)]=at.primaryKey),at})},hasGetAll:0<He.length&&"getAll"in Le.objectStore(He[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),nt=dt.schema,it=dt.hasGetAll,dt=nt.tables.map(he),Je={};return dt.forEach(function(pt){return Je[pt.name]=pt}),{stack:"dbcore",transaction:M.transaction.bind(M),table:function(pt){if(!Je[pt])throw new Error("Table '".concat(pt,"' not found"));return Je[pt]},MIN_KEY:-1/0,MAX_KEY:vf(z),schema:nt}}function ig(M,z,te,ae){var he=te.IDBKeyRange;return te.indexedDB,{dbcore:(ae=Vu(z,he,ae),M.dbcore.reduce(function(Ee,Le){return Le=Le.create,r(r({},Ee),Le(Ee))},ae))}}function Lc(M,ae){var te=ae.db,ae=ig(M._middlewares,te,M._deps,ae);M.core=ae.dbcore,M.tables.forEach(function(he){var Ee=he.name;M.core.schema.tables.some(function(Le){return Le.name===Ee})&&(he.core=M.core.table(Ee),M[Ee]instanceof M.Table&&(M[Ee].core=he.core))})}function ag(M,z,te,ae){te.forEach(function(he){var Ee=ae[he];z.forEach(function(Le){var He=function nt(it,dt){return v(it,dt)||(it=c(it))&&nt(it,dt)}(Le,he);(!He||"value"in He&&He.value===void 0)&&(Le===M.Transaction.prototype||Le instanceof M.Transaction?y(Le,he,{get:function(){return this.table(he)},set:function(nt){m(this,he,{value:nt,writable:!0,configurable:!0,enumerable:!0})}}):Le[he]=new M.Table(he,Ee))})})}function sp(M,z){z.forEach(function(te){for(var ae in te)te[ae]instanceof M.Table&&delete te[ae]})}function Cb(M,z){return M._cfg.version-z._cfg.version}function ip(M,z,te,ae){var he=M._dbSchema;te.objectStoreNames.contains("$meta")&&!he.$meta&&(he.$meta=bf("$meta",p_("")[0],[]),M._storeNames.push("$meta"));var Ee=M._createTransaction("readwrite",M._storeNames,he);Ee.create(te),Ee._completion.catch(ae);var Le=Ee._reject.bind(Ee),He=Me.transless||Me;un(function(){return Me.trans=Ee,Me.transless=He,z!==0?(Lc(M,te),it=z,((nt=Ee).storeNames.includes("$meta")?nt.table("$meta").get("version").then(function(dt){return dt??it}):B.resolve(it)).then(function(dt){return pt=dt,tt=Ee,ut=te,mt=[],dt=(Je=M)._versions,at=Je._dbSchema=wf(0,Je.idbdb,ut),(dt=dt.filter(function(St){return St._cfg.version>=pt})).length!==0?(dt.forEach(function(St){mt.push(function(){var Nt=at,Mt=St._cfg.dbschema;ug(Je,Nt,ut),ug(Je,Mt,ut),at=Je._dbSchema=Mt;var Ot=lg(Nt,Mt);Ot.add.forEach(function(an){kb(ut,an[0],an[1].primKey,an[1].indexes)}),Ot.change.forEach(function(an){if(an.recreate)throw new Ce.Upgrade("Not yet support for changing primary key");var Gt=ut.objectStore(an.name);an.add.forEach(function(mn){return cg(Gt,mn)}),an.change.forEach(function(mn){Gt.deleteIndex(mn.name),cg(Gt,mn)}),an.del.forEach(function(mn){return Gt.deleteIndex(mn)})});var Yt=St._cfg.contentUpgrade;if(Yt&&St._cfg.version>pt){Lc(Je,ut),tt._memoizedTables={};var rn=N(Mt);Ot.del.forEach(function(an){rn[an]=Nt[an]}),sp(Je,[Je.Transaction.prototype]),ag(Je,[Je.Transaction.prototype],a(rn),rn),tt.schema=rn;var Ht,Jt=Q(Yt);return Jt&&mr(),Ot=B.follow(function(){var an;(Ht=Yt(tt))&&Jt&&(an=Ar.bind(null,null),Ht.then(an,an))}),Ht&&typeof Ht.then=="function"?B.resolve(Ht):Ot.then(function(){return Ht})}}),mt.push(function(Nt){var Mt,Ot,Yt=St._cfg.dbschema;Mt=Yt,Ot=Nt,[].slice.call(Ot.db.objectStoreNames).forEach(function(rn){return Mt[rn]==null&&Ot.db.deleteObjectStore(rn)}),sp(Je,[Je.Transaction.prototype]),ag(Je,[Je.Transaction.prototype],Je._storeNames,Je._dbSchema),tt.schema=Je._dbSchema}),mt.push(function(Nt){Je.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Je.idbdb.version/10)===St._cfg.version?(Je.idbdb.deleteObjectStore("$meta"),delete Je._dbSchema.$meta,Je._storeNames=Je._storeNames.filter(function(Mt){return Mt!=="$meta"})):Nt.objectStore("$meta").put(St._cfg.version,"version"))})}),function St(){return mt.length?B.resolve(mt.shift()(tt.idbtrans)).then(St):B.resolve()}().then(function(){h_(at,ut)})):B.resolve();var Je,pt,tt,ut,mt,at}).catch(Le)):(a(he).forEach(function(dt){kb(te,dt,he[dt].primKey,he[dt].indexes)}),Lc(M,te),void B.follow(function(){return M.on.populate.fire(Ee)}).catch(Le));var nt,it})}function og(M,z){h_(M._dbSchema,z),z.db.version%10!=0||z.objectStoreNames.contains("$meta")||z.db.createObjectStore("$meta").add(Math.ceil(z.db.version/10-1),"version");var te=wf(0,M.idbdb,z);ug(M,M._dbSchema,z);for(var ae=0,he=lg(te,M._dbSchema).change;ae<he.length;ae++){var Ee=function(Le){if(Le.change.length||Le.recreate)return console.warn("Unable to patch indexes of table ".concat(Le.name," because it has changes on the type of index or primary key.")),{value:void 0};var He=z.objectStore(Le.name);Le.add.forEach(function(nt){Be&&console.debug("Dexie upgrade patch: Creating missing index ".concat(Le.name,".").concat(nt.src)),cg(He,nt)})}(he[ae]);if(typeof Ee=="object")return Ee.value}}function lg(M,z){var te,ae={del:[],add:[],change:[]};for(te in M)z[te]||ae.del.push(te);for(te in z){var he=M[te],Ee=z[te];if(he){var Le={name:te,def:Ee,recreate:!1,del:[],add:[],change:[]};if(""+(he.primKey.keyPath||"")!=""+(Ee.primKey.keyPath||"")||he.primKey.auto!==Ee.primKey.auto)Le.recreate=!0,ae.change.push(Le);else{var He=he.idxByName,nt=Ee.idxByName,it=void 0;for(it in He)nt[it]||Le.del.push(it);for(it in nt){var dt=He[it],Je=nt[it];dt?dt.src!==Je.src&&Le.change.push(Je):Le.add.push(Je)}(0<Le.del.length||0<Le.add.length||0<Le.change.length)&&ae.change.push(Le)}}else ae.add.push([te,Ee])}return ae}function kb(M,z,te,ae){var he=M.db.createObjectStore(z,te.keyPath?{keyPath:te.keyPath,autoIncrement:te.auto}:{autoIncrement:te.auto});return ae.forEach(function(Ee){return cg(he,Ee)}),he}function h_(M,z){a(M).forEach(function(te){z.db.objectStoreNames.contains(te)||(Be&&console.debug("Dexie: Creating missing table",te),kb(z,te,M[te].primKey,M[te].indexes))})}function cg(M,z){M.createIndex(z.name,z.keyPath,{unique:z.unique,multiEntry:z.multi})}function wf(M,z,te){var ae={};return w(z.objectStoreNames,0).forEach(function(he){for(var Ee=te.objectStore(he),Le=vl(sg(it=Ee.keyPath),it||"",!0,!1,!!Ee.autoIncrement,it&&typeof it!="string",!0),He=[],nt=0;nt<Ee.indexNames.length;++nt){var dt=Ee.index(Ee.indexNames[nt]),it=dt.keyPath,dt=vl(dt.name,it,!!dt.unique,!!dt.multiEntry,!1,it&&typeof it!="string",!1);He.push(dt)}ae[he]=bf(he,Le,He)}),ae}function ug(M,z,te){for(var ae=te.db.objectStoreNames,he=0;he<ae.length;++he){var Ee=ae[he],Le=te.objectStore(Ee);M._hasGetAll="getAll"in Le;for(var He=0;He<Le.indexNames.length;++He){var nt=Le.indexNames[He],it=Le.index(nt).keyPath,dt=typeof it=="string"?it:"["+w(it).join("+")+"]";!z[Ee]||(it=z[Ee].idxByName[dt])&&(it.name=nt,delete z[Ee].idxByName[dt],z[Ee].idxByName[nt]=it)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(M._hasGetAll=!1)}function p_(M){return M.split(",").map(function(z,te){var ae=(z=z.trim()).replace(/([&*]|\+\+)/g,""),he=/^\[/.test(ae)?ae.match(/^\[(.*)\]$/)[1].split("+"):ae;return vl(ae,he||null,/\&/.test(z),/\*/.test(z),/\+\+/.test(z),o(he),te===0)})}var gA=(dg.prototype._parseStoresSpec=function(M,z){a(M).forEach(function(te){if(M[te]!==null){var ae=p_(M[te]),he=ae.shift();if(he.unique=!0,he.multi)throw new Ce.Schema("Primary key cannot be multi-valued");ae.forEach(function(Ee){if(Ee.auto)throw new Ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!Ee.keyPath)throw new Ce.Schema("Index must have a name and cannot be an empty string")}),z[te]=bf(te,he,ae)}})},dg.prototype.stores=function(te){var z=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,te):te;var te=z._versions,ae={},he={};return te.forEach(function(Ee){l(ae,Ee._cfg.storesSource),he=Ee._cfg.dbschema={},Ee._parseStoresSpec(ae,he)}),z._dbSchema=he,sp(z,[z._allTables,z,z.Transaction.prototype]),ag(z,[z._allTables,z,z.Transaction.prototype,this._cfg.tables],a(he),he),z._storeNames=a(he),this},dg.prototype.upgrade=function(M){return this._cfg.contentUpgrade=Te(this._cfg.contentUpgrade||Ve,M),this},dg);function dg(){}function Eb(M,z){var te=M._dbNamesDB;return te||(te=M._dbNamesDB=new xl(qa,{addons:[],indexedDB:M,IDBKeyRange:z})).version(1).stores({dbnames:"name"}),te.table("dbnames")}function fg(M){return M&&typeof M.databases=="function"}function Tb(M){return un(function(){return Me.letThrough=!0,M()})}function Ab(M){return!("from"in M)}var Gi=function(M,z){if(!this){var te=new Gi;return M&&"d"in M&&l(te,M),te}l(this,arguments.length?{d:1,from:M,to:1<arguments.length?z:M}:{d:0})};function ap(M,z,te){var ae=Dr(z,te);if(!isNaN(ae)){if(0<ae)throw RangeError();if(Ab(M))return l(M,{from:z,to:te,d:1});var he=M.l,ae=M.r;if(Dr(te,M.from)<0)return he?ap(he,z,te):M.l={from:z,to:te,d:1,l:null,r:null},g_(M);if(0<Dr(z,M.to))return ae?ap(ae,z,te):M.r={from:z,to:te,d:1,l:null,r:null},g_(M);Dr(z,M.from)<0&&(M.from=z,M.l=null,M.d=ae?ae.d+1:1),0<Dr(te,M.to)&&(M.to=te,M.r=null,M.d=M.l?M.l.d+1:1),te=!M.r,he&&!M.l&&Wu(M,he),ae&&te&&Wu(M,ae)}}function Wu(M,z){Ab(z)||function te(ae,nt){var Ee=nt.from,Le=nt.to,He=nt.l,nt=nt.r;ap(ae,Ee,Le),He&&te(ae,He),nt&&te(ae,nt)}(M,z)}function m_(M,z){var te=hg(z),ae=te.next();if(ae.done)return!1;for(var he=ae.value,Ee=hg(M),Le=Ee.next(he.from),He=Le.value;!ae.done&&!Le.done;){if(Dr(He.from,he.to)<=0&&0<=Dr(He.to,he.from))return!0;Dr(he.from,He.from)<0?he=(ae=te.next(He.from)).value:He=(Le=Ee.next(he.from)).value}return!1}function hg(M){var z=Ab(M)?null:{s:0,n:M};return{next:function(te){for(var ae=0<arguments.length;z;)switch(z.s){case 0:if(z.s=1,ae)for(;z.n.l&&Dr(te,z.n.from)<0;)z={up:z,n:z.n.l,s:1};else for(;z.n.l;)z={up:z,n:z.n.l,s:1};case 1:if(z.s=2,!ae||Dr(te,z.n.to)<=0)return{value:z.n,done:!1};case 2:if(z.n.r){z.s=3,z={up:z,n:z.n.r,s:0};continue}case 3:z=z.up}return{done:!0}}}}function g_(M){var z,te,ae=(((z=M.r)===null||z===void 0?void 0:z.d)||0)-(((te=M.l)===null||te===void 0?void 0:te.d)||0),he=1<ae?"r":ae<-1?"l":"";he&&(z=he=="r"?"l":"r",te=r({},M),ae=M[he],M.from=ae.from,M.to=ae.to,M[he]=ae[he],te[he]=ae[z],(M[z]=te).d=Rb(te)),M.d=Rb(M)}function Rb(te){var z=te.r,te=te.l;return(z?te?Math.max(z.d,te.d):z.d:te?te.d:0)+1}function pg(M,z){return a(z).forEach(function(te){M[te]?Wu(M[te],z[te]):M[te]=function ae(he){var Ee,Le,He={};for(Ee in he)d(he,Ee)&&(Le=he[Ee],He[Ee]=!Le||typeof Le!="object"||L.has(Le.constructor)?Le:ae(Le));return He}(z[te])}),M}function Nb(M,z){return M.all||z.all||Object.keys(M).some(function(te){return z[te]&&m_(z[te],M[te])})}h(Gi.prototype,((Ha={add:function(M){return Wu(this,M),this},addKey:function(M){return ap(this,M,M),this},addKeys:function(M){var z=this;return M.forEach(function(te){return ap(z,te,te)}),this},hasKey:function(M){var z=hg(this).next(M).value;return z&&Dr(z.from,M)<=0&&0<=Dr(z.to,M)}})[U]=function(){return hg(this)},Ha));var Hu={},Mb={},Ib=!1;function mg(M){pg(Mb,M),Ib||(Ib=!0,setTimeout(function(){Ib=!1,jb(Mb,!(Mb={}))},0))}function jb(M,z){z===void 0&&(z=!1);var te=new Set;if(M.all)for(var ae=0,he=Object.values(Hu);ae<he.length;ae++)y_(Le=he[ae],M,te,z);else for(var Ee in M){var Le,He=/^idb\:\/\/(.*)\/(.*)\//.exec(Ee);He&&(Ee=He[1],He=He[2],(Le=Hu["idb://".concat(Ee,"/").concat(He)])&&y_(Le,M,te,z))}te.forEach(function(nt){return nt()})}function y_(M,z,te,ae){for(var he=[],Ee=0,Le=Object.entries(M.queries.query);Ee<Le.length;Ee++){for(var He=Le[Ee],nt=He[0],it=[],dt=0,Je=He[1];dt<Je.length;dt++){var pt=Je[dt];Nb(z,pt.obsSet)?pt.subscribers.forEach(function(at){return te.add(at)}):ae&&it.push(pt)}ae&&he.push([nt,it])}if(ae)for(var tt=0,ut=he;tt<ut.length;tt++){var mt=ut[tt],nt=mt[0],it=mt[1];M.queries.query[nt]=it}}function yA(M){var z=M._state,te=M._deps.indexedDB;if(z.isBeingOpened||M.idbdb)return z.dbReadyPromise.then(function(){return z.dbOpenError?nr(z.dbOpenError):M});z.isBeingOpened=!0,z.dbOpenError=null,z.openComplete=!1;var ae=z.openCanceller,he=Math.round(10*M.verno),Ee=!1;function Le(){if(z.openCanceller!==ae)throw new Ce.DatabaseClosed("db.open() was cancelled")}function He(){return new B(function(pt,tt){if(Le(),!te)throw new Ce.MissingAPI;var ut=M.name,mt=z.autoSchema||!he?te.open(ut):te.open(ut,he);if(!mt)throw new Ce.MissingAPI;mt.onerror=Uo(tt),mt.onblocked=Pe(M._fireOnBlocked),mt.onupgradeneeded=Pe(function(at){var St;dt=mt.transaction,z.autoSchema&&!M._options.allowEmptyDB?(mt.onerror=Uu,dt.abort(),mt.result.close(),(St=te.deleteDatabase(ut)).onsuccess=St.onerror=Pe(function(){tt(new Ce.NoSuchDatabase("Database ".concat(ut," doesnt exist")))})):(dt.onerror=Uo(tt),at=at.oldVersion>Math.pow(2,62)?0:at.oldVersion,Je=at<1,M.idbdb=mt.result,Ee&&og(M,dt),ip(M,at/10,dt,tt))},tt),mt.onsuccess=Pe(function(){dt=null;var at,St,Nt,Mt,Ot,Yt=M.idbdb=mt.result,rn=w(Yt.objectStoreNames);if(0<rn.length)try{var Ht=Yt.transaction((Mt=rn).length===1?Mt[0]:Mt,"readonly");if(z.autoSchema)St=Yt,Nt=Ht,(at=M).verno=St.version/10,Nt=at._dbSchema=wf(0,St,Nt),at._storeNames=w(St.objectStoreNames,0),ag(at,[at._allTables],a(Nt),Nt);else if(ug(M,M._dbSchema,Ht),((Ot=lg(wf(0,(Ot=M).idbdb,Ht),Ot._dbSchema)).add.length||Ot.change.some(function(Jt){return Jt.add.length||Jt.change.length}))&&!Ee)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Yt.close(),he=Yt.version+1,Ee=!0,pt(He());Lc(M,Ht)}catch{}li.push(M),Yt.onversionchange=Pe(function(Jt){z.vcFired=!0,M.on("versionchange").fire(Jt)}),Yt.onclose=Pe(function(Jt){M.on("close").fire(Jt)}),Je&&(Ot=M._deps,Ht=ut,Yt=Ot.indexedDB,Ot=Ot.IDBKeyRange,fg(Yt)||Ht===qa||Eb(Yt,Ot).put({name:Ht}).catch(Ve)),pt()},tt)}).catch(function(pt){switch(pt==null?void 0:pt.name){case"UnknownError":if(0<z.PR1398_maxLoop)return z.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),He();break;case"VersionError":if(0<he)return he=0,He()}return B.reject(pt)})}var nt,it=z.dbReadyResolve,dt=null,Je=!1;return B.race([ae,(typeof navigator>"u"?B.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(pt){function tt(){return indexedDB.databases().finally(pt)}nt=setInterval(tt,100),tt()}).finally(function(){return clearInterval(nt)}):Promise.resolve()).then(He)]).then(function(){return Le(),z.onReadyBeingFired=[],B.resolve(Tb(function(){return M.on.ready.fire(M.vip)})).then(function pt(){if(0<z.onReadyBeingFired.length){var tt=z.onReadyBeingFired.reduce(Te,Ve);return z.onReadyBeingFired=[],B.resolve(Tb(function(){return tt(M.vip)})).then(pt)}})}).finally(function(){z.openCanceller===ae&&(z.onReadyBeingFired=null,z.isBeingOpened=!1)}).catch(function(pt){z.dbOpenError=pt;try{dt&&dt.abort()}catch{}return ae===z.openCanceller&&M._close(),nr(pt)}).finally(function(){z.openComplete=!0,it()}).then(function(){var pt;return Je&&(pt={},M.tables.forEach(function(tt){tt.schema.indexes.forEach(function(ut){ut.name&&(pt["idb://".concat(M.name,"/").concat(tt.name,"/").concat(ut.name)]=new Gi(-1/0,[[[]]]))}),pt["idb://".concat(M.name,"/").concat(tt.name,"/")]=pt["idb://".concat(M.name,"/").concat(tt.name,"/:dels")]=new Gi(-1/0,[[[]]])}),Hi(yf).fire(pt),jb(pt,!0)),M})}function op(M){function z(Ee){return M.next(Ee)}var te=he(z),ae=he(function(Ee){return M.throw(Ee)});function he(Ee){return function(nt){var He=Ee(nt),nt=He.value;return He.done?nt:nt&&typeof nt.then=="function"?nt.then(te,ae):o(nt)?Promise.all(nt).then(te,ae):te(nt)}}return he(z)()}function Bc(M,z,te){for(var ae=o(M)?M.slice():[M],he=0;he<te;++he)ae.push(z);return ae}var bA={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(M){return r(r({},M),{table:function(z){var te=M.table(z),ae=te.schema,he={},Ee=[];function Le(Je,pt,tt){var ut=xi(Je),mt=he[ut]=he[ut]||[],at=Je==null?0:typeof Je=="string"?1:Je.length,St=0<pt,St=r(r({},tt),{name:St?"".concat(ut,"(virtual-from:").concat(tt.name,")"):tt.name,lowLevelIndex:tt,isVirtual:St,keyTail:pt,keyLength:at,extractKey:xf(Je),unique:!St&&tt.unique});return mt.push(St),St.isPrimaryKey||Ee.push(St),1<at&&Le(at===2?Je[0]:Je.slice(0,at-1),pt+1,tt),mt.sort(function(Nt,Mt){return Nt.keyTail-Mt.keyTail}),St}z=Le(ae.primaryKey.keyPath,0,ae.primaryKey),he[":id"]=[z];for(var He=0,nt=ae.indexes;He<nt.length;He++){var it=nt[He];Le(it.keyPath,0,it)}function dt(Je){var pt,tt=Je.query.index;return tt.isVirtual?r(r({},Je),{query:{index:tt.lowLevelIndex,range:(pt=Je.query.range,tt=tt.keyTail,{type:pt.type===1?2:pt.type,lower:Bc(pt.lower,pt.lowerOpen?M.MAX_KEY:M.MIN_KEY,tt),lowerOpen:!0,upper:Bc(pt.upper,pt.upperOpen?M.MIN_KEY:M.MAX_KEY,tt),upperOpen:!0})}}):Je}return r(r({},te),{schema:r(r({},ae),{primaryKey:z,indexes:Ee,getIndexByKeyPath:function(Je){return(Je=he[xi(Je)])&&Je[0]}}),count:function(Je){return te.count(dt(Je))},query:function(Je){return te.query(dt(Je))},openCursor:function(Je){var pt=Je.query.index,tt=pt.keyTail,ut=pt.isVirtual,mt=pt.keyLength;return ut?te.openCursor(dt(Je)).then(function(St){return St&&at(St)}):te.openCursor(Je);function at(St){return Object.create(St,{continue:{value:function(Nt){Nt!=null?St.continue(Bc(Nt,Je.reverse?M.MAX_KEY:M.MIN_KEY,tt)):Je.unique?St.continue(St.key.slice(0,mt).concat(Je.reverse?M.MIN_KEY:M.MAX_KEY,tt)):St.continue()}},continuePrimaryKey:{value:function(Nt,Mt){St.continuePrimaryKey(Bc(Nt,M.MAX_KEY,tt),Mt)}},primaryKey:{get:function(){return St.primaryKey}},key:{get:function(){var Nt=St.key;return mt===1?Nt[0]:Nt.slice(0,mt)}},value:{get:function(){return St.value}}})}}})}})}};function gg(M,z,te,ae){return te=te||{},ae=ae||"",a(M).forEach(function(he){var Ee,Le,He;d(z,he)?(Ee=M[he],Le=z[he],typeof Ee=="object"&&typeof Le=="object"&&Ee&&Le?(He=X(Ee))!==X(Le)?te[ae+he]=z[he]:He==="Object"?gg(Ee,Le,te,ae+he+"."):Ee!==Le&&(te[ae+he]=z[he]):Ee!==Le&&(te[ae+he]=z[he])):te[ae+he]=void 0}),a(z).forEach(function(he){d(M,he)||(te[ae+he]=z[he])}),te}function yg(M,z){return z.type==="delete"?z.keys:z.keys||z.values.map(M.extractKey)}var b_={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(M){return r(r({},M),{table:function(z){var te=M.table(z),ae=te.schema.primaryKey;return r(r({},te),{mutate:function(he){var Ee=Me.trans,Le=Ee.table(z).hook,He=Le.deleting,nt=Le.creating,it=Le.updating;switch(he.type){case"add":if(nt.fire===Ve)break;return Ee._promise("readwrite",function(){return dt(he)},!0);case"put":if(nt.fire===Ve&&it.fire===Ve)break;return Ee._promise("readwrite",function(){return dt(he)},!0);case"delete":if(He.fire===Ve)break;return Ee._promise("readwrite",function(){return dt(he)},!0);case"deleteRange":if(He.fire===Ve)break;return Ee._promise("readwrite",function(){return function Je(pt,tt,ut){return te.query({trans:pt,values:!1,query:{index:ae,range:tt},limit:ut}).then(function(mt){var at=mt.result;return dt({type:"delete",keys:at,trans:pt}).then(function(St){return 0<St.numFailures?Promise.reject(St.failures[0]):at.length<ut?{failures:[],numFailures:0,lastResult:void 0}:Je(pt,r(r({},tt),{lower:at[at.length-1],lowerOpen:!0}),ut)})})}(he.trans,he.range,1e4)},!0)}return te.mutate(he);function dt(Je){var pt,tt,ut,mt=Me.trans,at=Je.keys||yg(ae,Je);if(!at)throw new Error("Keys missing");return(Je=Je.type==="add"||Je.type==="put"?r(r({},Je),{keys:at}):r({},Je)).type!=="delete"&&(Je.values=s([],Je.values)),Je.keys&&(Je.keys=s([],Je.keys)),pt=te,ut=at,((tt=Je).type==="add"?Promise.resolve([]):pt.getMany({trans:tt.trans,keys:ut,cache:"immutable"})).then(function(St){var Nt=at.map(function(Mt,Ot){var Yt,rn,Ht,Jt=St[Ot],an={onerror:null,onsuccess:null};return Je.type==="delete"?He.fire.call(an,Mt,Jt,mt):Je.type==="add"||Jt===void 0?(Yt=nt.fire.call(an,Mt,Je.values[Ot],mt),Mt==null&&Yt!=null&&(Je.keys[Ot]=Mt=Yt,ae.outbound||R(Je.values[Ot],ae.keyPath,Mt))):(Yt=gg(Jt,Je.values[Ot]),(rn=it.fire.call(an,Yt,Mt,Jt,mt))&&(Ht=Je.values[Ot],Object.keys(rn).forEach(function(Gt){d(Ht,Gt)?Ht[Gt]=rn[Gt]:R(Ht,Gt,rn[Gt])}))),an});return te.mutate(Je).then(function(Mt){for(var Ot=Mt.failures,Yt=Mt.results,rn=Mt.numFailures,Mt=Mt.lastResult,Ht=0;Ht<at.length;++Ht){var Jt=(Yt||at)[Ht],an=Nt[Ht];Jt==null?an.onerror&&an.onerror(Ot[Ht]):an.onsuccess&&an.onsuccess(Je.type==="put"&&St[Ht]?Je.values[Ht]:Jt)}return{failures:Ot,results:Yt,numFailures:rn,lastResult:Mt}}).catch(function(Mt){return Nt.forEach(function(Ot){return Ot.onerror&&Ot.onerror(Mt)}),Promise.reject(Mt)})})}}})}})}};function Ob(M,z,te){try{if(!z||z.keys.length<M.length)return null;for(var ae=[],he=0,Ee=0;he<z.keys.length&&Ee<M.length;++he)Dr(z.keys[he],M[Ee])===0&&(ae.push(te?V(z.values[he]):z.values[he]),++Ee);return ae.length===M.length?ae:null}catch{return null}}var v_={stack:"dbcore",level:-1,create:function(M){return{table:function(z){var te=M.table(z);return r(r({},te),{getMany:function(ae){if(!ae.cache)return te.getMany(ae);var he=Ob(ae.keys,ae.trans._cache,ae.cache==="clone");return he?B.resolve(he):te.getMany(ae).then(function(Ee){return ae.trans._cache={keys:ae.keys,values:ae.cache==="clone"?V(Ee):Ee},Ee})},mutate:function(ae){return ae.type!=="add"&&(ae.trans._cache=null),te.mutate(ae)}})}}}};function Gu(M,z){return M.trans.mode==="readonly"&&!!M.subscr&&!M.trans.explicit&&M.trans.db._options.cache!=="disabled"&&!z.schema.primaryKey.outbound}function x_(M,z){switch(M){case"query":return z.values&&!z.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var vA={stack:"dbcore",level:0,name:"Observability",create:function(M){var z=M.schema.name,te=new Gi(M.MIN_KEY,M.MAX_KEY);return r(r({},M),{transaction:function(ae,he,Ee){if(Me.subscr&&he!=="readonly")throw new Ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Me.querier));return M.transaction(ae,he,Ee)},table:function(ae){var he=M.table(ae),Ee=he.schema,Le=Ee.primaryKey,Je=Ee.indexes,He=Le.extractKey,nt=Le.outbound,it=Le.autoIncrement&&Je.filter(function(tt){return tt.compound&&tt.keyPath.includes(Le.keyPath)}),dt=r(r({},he),{mutate:function(tt){function ut(Gt){return Gt="idb://".concat(z,"/").concat(ae,"/").concat(Gt),Mt[Gt]||(Mt[Gt]=new Gi)}var mt,at,St,Nt=tt.trans,Mt=tt.mutatedParts||(tt.mutatedParts={}),Ot=ut(""),Yt=ut(":dels"),rn=tt.type,an=tt.type==="deleteRange"?[tt.range]:tt.type==="delete"?[tt.keys]:tt.values.length<50?[yg(Le,tt).filter(function(Gt){return Gt}),tt.values]:[],Ht=an[0],Jt=an[1],an=tt.trans._cache;return o(Ht)?(Ot.addKeys(Ht),(an=rn==="delete"||Ht.length===Jt.length?Ob(Ht,an):null)||Yt.addKeys(Ht),(an||Jt)&&(mt=ut,at=an,St=Jt,Ee.indexes.forEach(function(Gt){var mn=mt(Gt.name||"");function Ln(fr){return fr!=null?Gt.extractKey(fr):null}function Vn(fr){return Gt.multiEntry&&o(fr)?fr.forEach(function(ua){return mn.addKey(ua)}):mn.addKey(fr)}(at||St).forEach(function(fr,ci){var rr=at&&Ln(at[ci]),ci=St&&Ln(St[ci]);Dr(rr,ci)!==0&&(rr!=null&&Vn(rr),ci!=null&&Vn(ci))})}))):Ht?(Jt={from:(Jt=Ht.lower)!==null&&Jt!==void 0?Jt:M.MIN_KEY,to:(Jt=Ht.upper)!==null&&Jt!==void 0?Jt:M.MAX_KEY},Yt.add(Jt),Ot.add(Jt)):(Ot.add(te),Yt.add(te),Ee.indexes.forEach(function(Gt){return ut(Gt.name).add(te)})),he.mutate(tt).then(function(Gt){return!Ht||tt.type!=="add"&&tt.type!=="put"||(Ot.addKeys(Gt.results),it&&it.forEach(function(mn){for(var Ln=tt.values.map(function(rr){return mn.extractKey(rr)}),Vn=mn.keyPath.findIndex(function(rr){return rr===Le.keyPath}),fr=0,ua=Gt.results.length;fr<ua;++fr)Ln[fr][Vn]=Gt.results[fr];ut(mn.name).addKeys(Ln)})),Nt.mutatedParts=pg(Nt.mutatedParts||{},Mt),Gt})}}),Je=function(ut){var mt=ut.query,ut=mt.index,mt=mt.range;return[ut,new Gi((ut=mt.lower)!==null&&ut!==void 0?ut:M.MIN_KEY,(mt=mt.upper)!==null&&mt!==void 0?mt:M.MAX_KEY)]},pt={get:function(tt){return[Le,new Gi(tt.key)]},getMany:function(tt){return[Le,new Gi().addKeys(tt.keys)]},count:Je,query:Je,openCursor:Je};return a(pt).forEach(function(tt){dt[tt]=function(ut){var mt=Me.subscr,at=!!mt,St=Gu(Me,he)&&x_(tt,ut)?ut.obsSet={}:mt;if(at){var Nt=function(Jt){return Jt="idb://".concat(z,"/").concat(ae,"/").concat(Jt),St[Jt]||(St[Jt]=new Gi)},Mt=Nt(""),Ot=Nt(":dels"),mt=pt[tt](ut),at=mt[0],mt=mt[1];if((tt==="query"&&at.isPrimaryKey&&!ut.values?Ot:Nt(at.name||"")).add(mt),!at.isPrimaryKey){if(tt!=="count"){var Yt=tt==="query"&&nt&&ut.values&&he.query(r(r({},ut),{values:!1}));return he[tt].apply(this,arguments).then(function(Jt){if(tt==="query"){if(nt&&ut.values)return Yt.then(function(Ln){return Ln=Ln.result,Mt.addKeys(Ln),Jt});var an=ut.values?Jt.result.map(He):Jt.result;(ut.values?Mt:Ot).addKeys(an)}else if(tt==="openCursor"){var Gt=Jt,mn=ut.values;return Gt&&Object.create(Gt,{key:{get:function(){return Ot.addKey(Gt.primaryKey),Gt.key}},primaryKey:{get:function(){var Ln=Gt.primaryKey;return Ot.addKey(Ln),Ln}},value:{get:function(){return mn&&Mt.addKey(Gt.primaryKey),Gt.value}}})}return Jt})}Ot.add(te)}}return he[tt].apply(this,arguments)}}),dt}})}};function w_(M,z,te){if(te.numFailures===0)return z;if(z.type==="deleteRange")return null;var ae=z.keys?z.keys.length:"values"in z&&z.values?z.values.length:1;return te.numFailures===ae?null:(z=r({},z),o(z.keys)&&(z.keys=z.keys.filter(function(he,Ee){return!(Ee in te.failures)})),"values"in z&&o(z.values)&&(z.values=z.values.filter(function(he,Ee){return!(Ee in te.failures)})),z)}function bg(M,z){return te=M,((ae=z).lower===void 0||(ae.lowerOpen?0<Dr(te,ae.lower):0<=Dr(te,ae.lower)))&&(M=M,(z=z).upper===void 0||(z.upperOpen?Dr(M,z.upper)<0:Dr(M,z.upper)<=0));var te,ae}function Pb(M,z,pt,ae,he,Ee){if(!pt||pt.length===0)return M;var Le=z.query.index,He=Le.multiEntry,nt=z.query.range,it=ae.schema.primaryKey.extractKey,dt=Le.extractKey,Je=(Le.lowLevelIndex||Le).extractKey,pt=pt.reduce(function(tt,ut){var mt=tt,at=[];if(ut.type==="add"||ut.type==="put")for(var St=new Gi,Nt=ut.values.length-1;0<=Nt;--Nt){var Mt,Ot=ut.values[Nt],Yt=it(Ot);St.hasKey(Yt)||(Mt=dt(Ot),(He&&o(Mt)?Mt.some(function(Gt){return bg(Gt,nt)}):bg(Mt,nt))&&(St.addKey(Yt),at.push(Ot)))}switch(ut.type){case"add":var rn=new Gi().addKeys(z.values?tt.map(function(mn){return it(mn)}):tt),mt=tt.concat(z.values?at.filter(function(mn){return mn=it(mn),!rn.hasKey(mn)&&(rn.addKey(mn),!0)}):at.map(function(mn){return it(mn)}).filter(function(mn){return!rn.hasKey(mn)&&(rn.addKey(mn),!0)}));break;case"put":var Ht=new Gi().addKeys(ut.values.map(function(mn){return it(mn)}));mt=tt.filter(function(mn){return!Ht.hasKey(z.values?it(mn):mn)}).concat(z.values?at:at.map(function(mn){return it(mn)}));break;case"delete":var Jt=new Gi().addKeys(ut.keys);mt=tt.filter(function(mn){return!Jt.hasKey(z.values?it(mn):mn)});break;case"deleteRange":var an=ut.range;mt=tt.filter(function(mn){return!bg(it(mn),an)})}return mt},M);return pt===M?M:(pt.sort(function(tt,ut){return Dr(Je(tt),Je(ut))||Dr(it(tt),it(ut))}),z.limit&&z.limit<1/0&&(pt.length>z.limit?pt.length=z.limit:M.length===z.limit&&pt.length<z.limit&&(he.dirty=!0)),Ee?Object.freeze(pt):pt)}function _f(M,z){return Dr(M.lower,z.lower)===0&&Dr(M.upper,z.upper)===0&&!!M.lowerOpen==!!z.lowerOpen&&!!M.upperOpen==!!z.upperOpen}function lp(M,z){return function(te,ae,he,Ee){if(te===void 0)return ae!==void 0?-1:0;if(ae===void 0)return 1;if((ae=Dr(te,ae))===0){if(he&&Ee)return 0;if(he)return 1;if(Ee)return-1}return ae}(M.lower,z.lower,M.lowerOpen,z.lowerOpen)<=0&&0<=function(te,ae,he,Ee){if(te===void 0)return ae!==void 0?1:0;if(ae===void 0)return-1;if((ae=Dr(te,ae))===0){if(he&&Ee)return 0;if(he)return-1;if(Ee)return 1}return ae}(M.upper,z.upper,M.upperOpen,z.upperOpen)}function xA(M,z,te,ae){M.subscribers.add(te),ae.addEventListener("abort",function(){var he,Ee;M.subscribers.delete(te),M.subscribers.size===0&&(he=M,Ee=z,setTimeout(function(){he.subscribers.size===0&&$(Ee,he)},3e3))})}var vg={stack:"dbcore",level:0,name:"Cache",create:function(M){var z=M.schema.name;return r(r({},M),{transaction:function(te,ae,he){var Ee,Le,He=M.transaction(te,ae,he);return ae==="readwrite"&&(Le=(Ee=new AbortController).signal,he=function(nt){return function(){if(Ee.abort(),ae==="readwrite"){for(var it=new Set,dt=0,Je=te;dt<Je.length;dt++){var pt=Je[dt],tt=Hu["idb://".concat(z,"/").concat(pt)];if(tt){var ut=M.table(pt),mt=tt.optimisticOps.filter(function(mn){return mn.trans===He});if(He._explicit&&nt&&He.mutatedParts)for(var at=0,St=Object.values(tt.queries.query);at<St.length;at++)for(var Nt=0,Mt=(rn=St[at]).slice();Nt<Mt.length;Nt++)Nb((Ht=Mt[Nt]).obsSet,He.mutatedParts)&&($(rn,Ht),Ht.subscribers.forEach(function(mn){return it.add(mn)}));else if(0<mt.length){tt.optimisticOps=tt.optimisticOps.filter(function(mn){return mn.trans!==He});for(var Ot=0,Yt=Object.values(tt.queries.query);Ot<Yt.length;Ot++)for(var rn,Ht,Jt,an=0,Gt=(rn=Yt[Ot]).slice();an<Gt.length;an++)(Ht=Gt[an]).res!=null&&He.mutatedParts&&(nt&&!Ht.dirty?(Jt=Object.isFrozen(Ht.res),Jt=Pb(Ht.res,Ht.req,mt,ut,Ht,Jt),Ht.dirty?($(rn,Ht),Ht.subscribers.forEach(function(mn){return it.add(mn)})):Jt!==Ht.res&&(Ht.res=Jt,Ht.promise=B.resolve({result:Jt}))):(Ht.dirty&&$(rn,Ht),Ht.subscribers.forEach(function(mn){return it.add(mn)})))}}}it.forEach(function(mn){return mn()})}}},He.addEventListener("abort",he(!1),{signal:Le}),He.addEventListener("error",he(!1),{signal:Le}),He.addEventListener("complete",he(!0),{signal:Le})),He},table:function(te){var ae=M.table(te),he=ae.schema.primaryKey;return r(r({},ae),{mutate:function(Ee){var Le=Me.trans;if(he.outbound||Le.db._options.cache==="disabled"||Le.explicit||Le.idbtrans.mode!=="readwrite")return ae.mutate(Ee);var He=Hu["idb://".concat(z,"/").concat(te)];return He?(Le=ae.mutate(Ee),Ee.type!=="add"&&Ee.type!=="put"||!(50<=Ee.values.length||yg(he,Ee).some(function(nt){return nt==null}))?(He.optimisticOps.push(Ee),Ee.mutatedParts&&mg(Ee.mutatedParts),Le.then(function(nt){0<nt.numFailures&&($(He.optimisticOps,Ee),(nt=w_(0,Ee,nt))&&He.optimisticOps.push(nt),Ee.mutatedParts&&mg(Ee.mutatedParts))}),Le.catch(function(){$(He.optimisticOps,Ee),Ee.mutatedParts&&mg(Ee.mutatedParts)})):Le.then(function(nt){var it=w_(0,r(r({},Ee),{values:Ee.values.map(function(dt,Je){var pt;return nt.failures[Je]?dt:(dt=(pt=he.keyPath)!==null&&pt!==void 0&&pt.includes(".")?V(dt):r({},dt),R(dt,he.keyPath,nt.results[Je]),dt)})}),nt);He.optimisticOps.push(it),queueMicrotask(function(){return Ee.mutatedParts&&mg(Ee.mutatedParts)})}),Le):ae.mutate(Ee)},query:function(Ee){if(!Gu(Me,ae)||!x_("query",Ee))return ae.query(Ee);var Le=((it=Me.trans)===null||it===void 0?void 0:it.db._options.cache)==="immutable",Je=Me,He=Je.requery,nt=Je.signal,it=function(ut,mt,at,St){var Nt=Hu["idb://".concat(ut,"/").concat(mt)];if(!Nt)return[];if(!(mt=Nt.queries[at]))return[null,!1,Nt,null];var Mt=mt[(St.query?St.query.index.name:null)||""];if(!Mt)return[null,!1,Nt,null];switch(at){case"query":var Ot=Mt.find(function(Yt){return Yt.req.limit===St.limit&&Yt.req.values===St.values&&_f(Yt.req.query.range,St.query.range)});return Ot?[Ot,!0,Nt,Mt]:[Mt.find(function(Yt){return("limit"in Yt.req?Yt.req.limit:1/0)>=St.limit&&(!St.values||Yt.req.values)&&lp(Yt.req.query.range,St.query.range)}),!1,Nt,Mt];case"count":return Ot=Mt.find(function(Yt){return _f(Yt.req.query.range,St.query.range)}),[Ot,!!Ot,Nt,Mt]}}(z,te,"query",Ee),dt=it[0],Je=it[1],pt=it[2],tt=it[3];return dt&&Je?dt.obsSet=Ee.obsSet:(Je=ae.query(Ee).then(function(ut){var mt=ut.result;if(dt&&(dt.res=mt),Le){for(var at=0,St=mt.length;at<St;++at)Object.freeze(mt[at]);Object.freeze(mt)}else ut.result=V(mt);return ut}).catch(function(ut){return tt&&dt&&$(tt,dt),Promise.reject(ut)}),dt={obsSet:Ee.obsSet,promise:Je,subscribers:new Set,type:"query",req:Ee,dirty:!1},tt?tt.push(dt):(tt=[dt],(pt=pt||(Hu["idb://".concat(z,"/").concat(te)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Ee.query.index.name||""]=tt)),xA(dt,tt,He,nt),dt.promise.then(function(ut){return{result:Pb(ut.result,Ee,pt==null?void 0:pt.optimisticOps,ae,dt,Le)}})}})}})}};function cp(M,z){return new Proxy(M,{get:function(te,ae,he){return ae==="db"?z:Reflect.get(te,ae,he)}})}var xl=(Fs.prototype.version=function(M){if(isNaN(M)||M<.1)throw new Ce.Type("Given version is not a positive number");if(M=Math.round(10*M)/10,this.idbdb||this._state.isBeingOpened)throw new Ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,M);var z=this._versions,te=z.filter(function(ae){return ae._cfg.version===M})[0];return te||(te=new this.Version(M),z.push(te),z.sort(Cb),te.stores({}),this._state.autoSchema=!1,te)},Fs.prototype._whenReady=function(M){var z=this;return this.idbdb&&(this._state.openComplete||Me.letThrough||this._vip)?M():new B(function(te,ae){if(z._state.openComplete)return ae(new Ce.DatabaseClosed(z._state.dbOpenError));if(!z._state.isBeingOpened){if(!z._state.autoOpen)return void ae(new Ce.DatabaseClosed);z.open().catch(Ve)}z._state.dbReadyPromise.then(te,ae)}).then(M)},Fs.prototype.use=function(M){var z=M.stack,te=M.create,ae=M.level,he=M.name;return he&&this.unuse({stack:z,name:he}),M=this._middlewares[z]||(this._middlewares[z]=[]),M.push({stack:z,create:te,level:ae??10,name:he}),M.sort(function(Ee,Le){return Ee.level-Le.level}),this},Fs.prototype.unuse=function(M){var z=M.stack,te=M.name,ae=M.create;return z&&this._middlewares[z]&&(this._middlewares[z]=this._middlewares[z].filter(function(he){return ae?he.create!==ae:!!te&&he.name!==te})),this},Fs.prototype.open=function(){var M=this;return et(we,function(){return yA(M)})},Fs.prototype._close=function(){var M=this._state,z=li.indexOf(this);if(0<=z&&li.splice(z,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}M.isBeingOpened||(M.dbReadyPromise=new B(function(te){M.dbReadyResolve=te}),M.openCanceller=new B(function(te,ae){M.cancelOpen=ae}))},Fs.prototype.close=function(te){var z=(te===void 0?{disableAutoOpen:!0}:te).disableAutoOpen,te=this._state;z?(te.isBeingOpened&&te.cancelOpen(new Ce.DatabaseClosed),this._close(),te.autoOpen=!1,te.dbOpenError=new Ce.DatabaseClosed):(this._close(),te.autoOpen=this._options.autoOpen||te.isBeingOpened,te.openComplete=!1,te.dbOpenError=null)},Fs.prototype.delete=function(M){var z=this;M===void 0&&(M={disableAutoOpen:!0});var te=0<arguments.length&&typeof arguments[0]!="object",ae=this._state;return new B(function(he,Ee){function Le(){z.close(M);var He=z._deps.indexedDB.deleteDatabase(z.name);He.onsuccess=Pe(function(){var nt,it,dt;nt=z._deps,it=z.name,dt=nt.indexedDB,nt=nt.IDBKeyRange,fg(dt)||it===qa||Eb(dt,nt).delete(it).catch(Ve),he()}),He.onerror=Uo(Ee),He.onblocked=z._fireOnBlocked}if(te)throw new Ce.InvalidArgument("Invalid closeOptions argument to db.delete()");ae.isBeingOpened?ae.dbReadyPromise.then(Le):Le()})},Fs.prototype.backendDB=function(){return this.idbdb},Fs.prototype.isOpen=function(){return this.idbdb!==null},Fs.prototype.hasBeenClosed=function(){var M=this._state.dbOpenError;return M&&M.name==="DatabaseClosed"},Fs.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Fs.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Fs.prototype,"tables",{get:function(){var M=this;return a(this._allTables).map(function(z){return M._allTables[z]})},enumerable:!1,configurable:!0}),Fs.prototype.transaction=function(){var M=(function(z,te,ae){var he=arguments.length;if(he<2)throw new Ce.InvalidArgument("Too few arguments");for(var Ee=new Array(he-1);--he;)Ee[he-1]=arguments[he];return ae=Ee.pop(),[z,O(Ee),ae]}).apply(this,arguments);return this._transaction.apply(this,M)},Fs.prototype._transaction=function(M,z,te){var ae=this,he=Me.trans;he&&he.db===this&&M.indexOf("!")===-1||(he=null);var Ee,Le,He=M.indexOf("?")!==-1;M=M.replace("!","").replace("?","");try{if(Le=z.map(function(it){if(it=it instanceof ae.Table?it.name:it,typeof it!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return it}),M=="r"||M===ca)Ee=ca;else{if(M!="rw"&&M!=Vs)throw new Ce.InvalidArgument("Invalid transaction mode: "+M);Ee=Vs}if(he){if(he.mode===ca&&Ee===Vs){if(!He)throw new Ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");he=null}he&&Le.forEach(function(it){if(he&&he.storeNames.indexOf(it)===-1){if(!He)throw new Ce.SubTransaction("Table "+it+" not included in parent transaction.");he=null}}),He&&he&&!he.active&&(he=null)}}catch(it){return he?he._promise(null,function(dt,Je){Je(it)}):nr(it)}var nt=(function it(dt,Je,pt,tt,ut){return B.resolve().then(function(){var mt=Me.transless||Me,at=dt._createTransaction(Je,pt,dt._dbSchema,tt);if(at.explicit=!0,mt={trans:at,transless:mt},tt)at.idbtrans=tt.idbtrans;else try{at.create(),at.idbtrans._explicit=!0,dt._state.PR1398_maxLoop=3}catch(Mt){return Mt.name===De.InvalidState&&dt.isOpen()&&0<--dt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),dt.close({disableAutoOpen:!1}),dt.open().then(function(){return it(dt,Je,pt,null,ut)})):nr(Mt)}var St,Nt=Q(ut);return Nt&&mr(),mt=B.follow(function(){var Mt;(St=ut.call(at,at))&&(Nt?(Mt=Ar.bind(null,null),St.then(Mt,Mt)):typeof St.next=="function"&&typeof St.throw=="function"&&(St=op(St)))},mt),(St&&typeof St.then=="function"?B.resolve(St).then(function(Mt){return at.active?Mt:nr(new Ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):mt.then(function(){return St})).then(function(Mt){return tt&&at._resolve(),at._completion.then(function(){return Mt})}).catch(function(Mt){return at._reject(Mt),nr(Mt)})})}).bind(null,this,Ee,Le,he,te);return he?he._promise(Ee,nt,"lock"):Me.trans?et(Me.transless,function(){return ae._whenReady(nt)}):this._whenReady(nt)},Fs.prototype.table=function(M){if(!d(this._allTables,M))throw new Ce.InvalidTable("Table ".concat(M," does not exist"));return this._allTables[M]},Fs);function Fs(M,z){var te=this;this._middlewares={},this.verno=0;var ae=Fs.dependencies;this._options=z=r({addons:Fs.addons,autoOpen:!0,indexedDB:ae.indexedDB,IDBKeyRange:ae.IDBKeyRange,cache:"cloned"},z),this._deps={indexedDB:z.indexedDB,IDBKeyRange:z.IDBKeyRange},ae=z.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var he,Ee,Le,He,nt,it={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ve,dbReadyPromise:null,cancelOpen:Ve,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:z.autoOpen};it.dbReadyPromise=new B(function(Je){it.dbReadyResolve=Je}),it.openCanceller=new B(function(Je,pt){it.cancelOpen=pt}),this._state=it,this.name=M,this.on=Fc(this,"populate","blocked","versionchange","close",{ready:[Te,Ve]}),this.on.ready.subscribe=S(this.on.ready.subscribe,function(Je){return function(pt,tt){Fs.vip(function(){var ut,mt=te._state;mt.openComplete?(mt.dbOpenError||B.resolve().then(pt),tt&&Je(pt)):mt.onReadyBeingFired?(mt.onReadyBeingFired.push(pt),tt&&Je(pt)):(Je(pt),ut=te,tt||Je(function at(){ut.on.ready.unsubscribe(pt),ut.on.ready.unsubscribe(at)}))})}}),this.Collection=(he=this,df(mf.prototype,function(St,at){this.db=he;var tt=yl,ut=null;if(at)try{tt=at()}catch(Nt){ut=Nt}var mt=St._ctx,at=mt.table,St=at.hook.reading.fire;this._ctx={table:at,index:mt.index,isPrimKey:!mt.index||at.schema.primKey.keyPath&&mt.index===at.schema.primKey.name,range:tt,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ut,or:mt.or,valueMapper:St!==Ne?St:null}})),this.Table=(Ee=this,df(bb.prototype,function(Je,pt,tt){this.db=Ee,this._tx=tt,this.name=Je,this.schema=pt,this.hook=Ee._allTables[Je]?Ee._allTables[Je].hook:Fc(null,{creating:[Ae,Ve],reading:[K,Ne],updating:[oe,Ve],deleting:[le,Ve]})})),this.Transaction=(Le=this,df(Sb.prototype,function(Je,pt,tt,ut,mt){var at=this;this.db=Le,this.mode=Je,this.storeNames=pt,this.schema=tt,this.chromeTransactionDurability=ut,this.idbtrans=null,this.on=Fc(this,"complete","error","abort"),this.parent=mt||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new B(function(St,Nt){at._resolve=St,at._reject=Nt}),this._completion.then(function(){at.active=!1,at.on.complete.fire()},function(St){var Nt=at.active;return at.active=!1,at.on.error.fire(St),at.parent?at.parent._reject(St):Nt&&at.idbtrans&&at.idbtrans.abort(),nr(St)})})),this.Version=(He=this,df(gA.prototype,function(Je){this.db=He,this._cfg={version:Je,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(nt=this,df(zu.prototype,function(Je,pt,tt){if(this.db=nt,this._ctx={table:Je,index:pt===":id"?null:pt,or:tt},this._cmp=this._ascending=Dr,this._descending=function(ut,mt){return Dr(mt,ut)},this._max=function(ut,mt){return 0<Dr(ut,mt)?ut:mt},this._min=function(ut,mt){return Dr(ut,mt)<0?ut:mt},this._IDBKeyRange=nt._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ce.MissingAPI})),this.on("versionchange",function(Je){0<Je.newVersion?console.warn("Another connection wants to upgrade database '".concat(te.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(te.name,"'. Closing db now to resume the delete request.")),te.close({disableAutoOpen:!1})}),this.on("blocked",function(Je){!Je.newVersion||Je.newVersion<Je.oldVersion?console.warn("Dexie.delete('".concat(te.name,"') was blocked")):console.warn("Upgrade '".concat(te.name,"' blocked by other connection holding version ").concat(Je.oldVersion/10))}),this._maxKey=vf(z.IDBKeyRange),this._createTransaction=function(Je,pt,tt,ut){return new te.Transaction(Je,pt,tt,te._options.chromeTransactionDurability,ut)},this._fireOnBlocked=function(Je){te.on("blocked").fire(Je),li.filter(function(pt){return pt.name===te.name&&pt!==te&&!pt._state.vcFired}).map(function(pt){return pt.on("versionchange").fire(Je)})},this.use(v_),this.use(vg),this.use(vA),this.use(bA),this.use(b_);var dt=new Proxy(this,{get:function(Je,pt,tt){if(pt==="_vip")return!0;if(pt==="table")return function(mt){return cp(te.table(mt),dt)};var ut=Reflect.get(Je,pt,tt);return ut instanceof bb?cp(ut,dt):pt==="tables"?ut.map(function(mt){return cp(mt,dt)}):pt==="_createTransaction"?function(){return cp(ut.apply(this,arguments),dt)}:ut}});this.vip=dt,ae.forEach(function(Je){return Je(te)})}var Sf,Ha=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",__=(xg.prototype.subscribe=function(M,z,te){return this._subscribe(M&&typeof M!="function"?M:{next:M,error:z,complete:te})},xg.prototype[Ha]=function(){return this},xg);function xg(M){this._subscribe=M}try{Sf={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Sf={indexedDB:null,IDBKeyRange:null}}function S_(M){var z,te=!1,ae=new __(function(he){var Ee=Q(M),Le,He=!1,nt={},it={},dt={get closed(){return He},unsubscribe:function(){He||(He=!0,Le&&Le.abort(),Je&&Hi.storagemutated.unsubscribe(tt))}};he.start&&he.start(dt);var Je=!1,pt=function(){return pn(ut)},tt=function(mt){pg(nt,mt),Nb(it,nt)&&pt()},ut=function(){var mt,at,St;!He&&Sf.indexedDB&&(nt={},mt={},Le&&Le.abort(),Le=new AbortController,St=function(Nt){var Mt=Y();try{Ee&&mr();var Ot=un(M,Nt);return Ot=Ee?Ot.finally(Ar):Ot}finally{Mt&&G()}}(at={subscr:mt,signal:Le.signal,requery:pt,querier:M,trans:null}),Promise.resolve(St).then(function(Nt){te=!0,z=Nt,He||at.signal.aborted||(nt={},function(Mt){for(var Ot in Mt)if(d(Mt,Ot))return;return 1}(it=mt)||Je||(Hi(yf,tt),Je=!0),pn(function(){return!He&&he.next&&he.next(Nt)}))},function(Nt){te=!1,["DatabaseClosedError","AbortError"].includes(Nt==null?void 0:Nt.name)||He||pn(function(){He||he.error&&he.error(Nt)})}))};return setTimeout(pt,0),dt});return ae.hasValue=function(){return te},ae.getValue=function(){return z},ae}var Ku=xl;function Db(M){var z=$c;try{$c=!0,Hi.storagemutated.fire(M),jb(M,!0)}finally{$c=z}}h(Ku,r(r({},Qe),{delete:function(M){return new Ku(M,{addons:[]}).delete()},exists:function(M){return new Ku(M,{addons:[]}).open().then(function(z){return z.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(M){try{return z=Ku.dependencies,te=z.indexedDB,z=z.IDBKeyRange,(fg(te)?Promise.resolve(te.databases()).then(function(ae){return ae.map(function(he){return he.name}).filter(function(he){return he!==qa})}):Eb(te,z).toCollection().primaryKeys()).then(M)}catch{return nr(new Ce.MissingAPI)}var z,te},defineClass:function(){return function(M){l(this,M)}},ignoreTransaction:function(M){return Me.trans?et(Me.transless,M):M()},vip:Tb,async:function(M){return function(){try{var z=op(M.apply(this,arguments));return z&&typeof z.then=="function"?z:B.resolve(z)}catch(te){return nr(te)}}},spawn:function(M,z,te){try{var ae=op(M.apply(te,z||[]));return ae&&typeof ae.then=="function"?ae:B.resolve(ae)}catch(he){return nr(he)}},currentTransaction:{get:function(){return Me.trans||null}},waitFor:function(M,z){return z=B.resolve(typeof M=="function"?Ku.ignoreTransaction(M):M).timeout(z||6e4),Me.trans?Me.trans.waitFor(z):z},Promise:B,debug:{get:function(){return Be},set:function(M){ke(M)}},derive:b,extend:l,props:h,override:S,Events:Fc,on:Hi,liveQuery:S_,extendObservabilitySet:pg,getByKeyPath:A,setByKeyPath:R,delByKeyPath:function(M,z){typeof z=="string"?R(M,z,void 0):"length"in z&&[].map.call(z,function(te){R(M,te,void 0)})},shallowClone:N,deepClone:V,getObjectDiff:gg,cmp:Dr,asap:k,minKey:-1/0,addons:[],connections:li,errnames:De,dependencies:Sf,cache:Hu,semVer:"4.0.11",version:"4.0.11".split(".").map(function(M){return parseInt(M)}).reduce(function(M,z,te){return M+z/Math.pow(10,2*te)})})),Ku.maxKey=vf(Ku.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Hi(yf,function(M){$c||(M=new CustomEvent(qu,{detail:M}),$c=!0,dispatchEvent(M),$c=!1)}),addEventListener(qu,function(M){M=M.detail,$c||Db(M)}));var Cf,$c=!1,ka=function(){};return typeof BroadcastChannel<"u"&&((ka=function(){(Cf=new BroadcastChannel(qu)).onmessage=function(M){return M.data&&Db(M.data)}})(),typeof Cf.unref=="function"&&Cf.unref(),Hi(yf,function(M){$c||Cf.postMessage(M)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(M){if(!xl.disableBfCache&&M.persisted){Be&&console.debug("Dexie: handling persisted pagehide"),Cf!=null&&Cf.close();for(var z=0,te=li;z<te.length;z++)te[z].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(M){!xl.disableBfCache&&M.persisted&&(Be&&console.debug("Dexie: handling persisted pageshow"),ka(),Db({all:new Gi(-1/0,[[]])}))})),B.rejectionMapper=function(M,z){return!M||M instanceof se||M instanceof TypeError||M instanceof SyntaxError||!M.name||!qe[M.name]?M:(z=new qe[M.name](z||M.message,M),"stack"in M&&y(z,"stack",{get:function(){return this.inner.stack}}),z)},ke(Be),r(xl,Object.freeze({__proto__:null,Dexie:xl,liveQuery:S_,Entity:tg,cmp:Dr,PropModification:pf,replacePrefix:function(M,z){return new pf({replacePrefix:[M,z]})},add:function(M){return new pf({add:M})},remove:function(M){return new pf({remove:M})},default:xl,RangeSet:Gi,mergeRanges:Wu,rangesOverlap:m_}),{default:xl}),xl})}(w2)),w2.exports}var l0e=o0e();const Y3=_a(l0e),NB=Symbol.for("Dexie"),rC=globalThis[NB]||(globalThis[NB]=Y3);if(Y3.semVer!==rC.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Y3.semVer} and ${rC.semVer}`);const{liveQuery:mut,mergeRanges:gut,rangesOverlap:yut,RangeSet:but,cmp:vut,Entity:xut,PropModification:wut,replacePrefix:_ut,add:Sut,remove:Cut}=rC;class c0e extends rC{constructor(){super("LiteChatDatabase_Rewrite_v1");ve(this,"conversations");ve(this,"interactions");ve(this,"mods");ve(this,"appState");ve(this,"providerConfigs");ve(this,"apiKeys");ve(this,"syncRepos");ve(this,"projects");ve(this,"rules");ve(this,"tags");ve(this,"tagRuleLinks");ve(this,"promptTemplates");this.version(9).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]",promptTemplates:"++id, &name, createdAt, updatedAt, isPublic"}),this.version(8).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const It=new c0e,Di=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class Et{static async loadConversations(){try{return(await It.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>Di(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await It.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await It.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await It.interactions.where({conversationId:t}).sortBy("index")).map(r=>Di(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await It.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await It.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await It.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await It.mods.orderBy("loadOrder").toArray()).map(n=>Di(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await It.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await It.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await It.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await It.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=It.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>Di(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await It.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await It.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=It.apiKeys)==null?void 0:t.toArray())??[]).map(r=>Di(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await It.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await It.transaction("rw",[It.apiKeys,It.providerConfigs],async()=>{const n=await It.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.providerConfigs.update(s.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await It.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await It.syncRepos.toArray()).map(n=>Di(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await It.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await It.transaction("rw",[It.syncRepos,It.conversations],async()=>{const n=await It.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.conversations.update(s.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await It.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await It.projects.orderBy("updatedAt").reverse().toArray()).map(n=>Di(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,defaultTagIds:t.defaultTagIds??null,defaultRuleIds:t.defaultRuleIds??null,metadata:t.metadata?{...t.metadata}:{}};return await It.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const s=await It.projects.where("parentId").equals(r).toArray();for(const i of s)await n(i.id);await It.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await It.transaction("rw",[It.projects],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await It.rules.orderBy("name").toArray()).map(n=>Di(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await It.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await It.transaction("rw",[It.rules,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("ruleId").equals(t).delete(),await It.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await It.tags.orderBy("name").toArray()).map(n=>Di(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await It.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await It.transaction("rw",[It.tags,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("tagId").equals(t).delete(),await It.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await It.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await It.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await It.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async getAllDataForExport(t){const n={version:1,exportedAt:new Date().toISOString()};if(t.importSettings){const r=await It.appState.toArray();n.settings={},r.forEach(s=>{s.key.startsWith("settings:")&&(n.settings[s.key.substring(9)]=s.value)})}return t.importApiKeys&&(n.apiKeys=await It.apiKeys.toArray()),t.importProviderConfigs&&(n.providerConfigs=await It.providerConfigs.toArray()),t.importProjects&&(n.projects=await It.projects.toArray()),t.importConversations&&(n.conversations=await It.conversations.toArray(),n.interactions=await It.interactions.toArray()),t.importRulesAndTags&&(n.rules=await It.rules.toArray(),n.tags=await It.tags.toArray(),n.tagRuleLinks=await It.tagRuleLinks.toArray()),t.importMods&&(n.mods=await It.mods.toArray()),t.importSyncRepos&&(n.syncRepos=await It.syncRepos.toArray()),n}static async importAllData(t,n){if(t.version!==1)throw new Error(`Unsupported export version: ${t.version}. Expected version 1.`);await It.transaction("rw",[It.appState,It.apiKeys,It.providerConfigs,It.projects,It.conversations,It.interactions,It.rules,It.tags,It.tagRuleLinks,It.mods,It.syncRepos],async()=>{if(n.importSettings&&await It.appState.clear(),n.importApiKeys&&await It.apiKeys.clear(),n.importProviderConfigs&&await It.providerConfigs.clear(),n.importProjects&&await It.projects.clear(),n.importConversations&&(await It.conversations.clear(),await It.interactions.clear()),n.importRulesAndTags&&(await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear()),n.importMods&&await It.mods.clear(),n.importSyncRepos&&await It.syncRepos.clear(),n.importSettings&&t.settings){const r=Object.entries(t.settings).map(([s,i])=>({key:`settings:${s}`,value:i}));await It.appState.bulkPut(r)}n.importApiKeys&&t.apiKeys&&await It.apiKeys.bulkPut(t.apiKeys.map(r=>Di(r))),n.importProviderConfigs&&t.providerConfigs&&await It.providerConfigs.bulkPut(t.providerConfigs.map(r=>Di(r,["modelsLastFetchedAt"]))),n.importProjects&&t.projects&&await It.projects.bulkPut(t.projects.map(r=>Di(r))),n.importConversations&&t.conversations&&(await It.conversations.bulkPut(t.conversations.map(r=>Di(r,["lastSyncedAt"]))),t.interactions&&await It.interactions.bulkPut(t.interactions.map(r=>Di(r,["startedAt","endedAt"])))),n.importRulesAndTags&&(t.rules&&await It.rules.bulkPut(t.rules.map(r=>Di(r))),t.tags&&await It.tags.bulkPut(t.tags.map(r=>Di(r))),t.tagRuleLinks&&await It.tagRuleLinks.bulkPut(t.tagRuleLinks)),n.importMods&&t.mods&&await It.mods.bulkPut(t.mods.map(r=>Di(r))),n.importSyncRepos&&t.syncRepos&&await It.syncRepos.bulkPut(t.syncRepos.map(r=>Di(r,["lastPulledAt","lastPushedAt"])))})}static async loadPromptTemplates(){try{return(await It.promptTemplates.orderBy("name").toArray()).map(n=>Di(n,["createdAt","updatedAt"]))}catch(t){throw console.error("PersistenceService: Error loading prompt templates:",t),t}}static async savePromptTemplate(t){try{return await It.promptTemplates.put(t)}catch(n){throw console.error("PersistenceService: Error saving prompt template:",n),n}}static async deletePromptTemplate(t){try{await It.promptTemplates.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting prompt template:",n),n}}static async clearAllData(){try{await It.transaction("rw",[It.conversations,It.interactions,It.mods,It.appState,It.providerConfigs,It.apiKeys,It.syncRepos,It.projects,It.rules,It.tags,It.tagRuleLinks,It.promptTemplates],async()=>{await It.interactions.clear(),await It.conversations.clear(),await It.projects.clear(),await It.mods.clear(),await It.appState.clear(),await It.providerConfigs.clear(),await It.apiKeys.clear(),await It.syncRepos.clear(),await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear(),await It.promptTemplates.clear()}),console.log("PersistenceService: All data cleared.")}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}const Zn={loaded:"interaction.loaded",currentConversationIdChanged:"interaction.current.conversation.id.changed",added:"interaction.added",updated:"interaction.updated",streamingIdsChanged:"interaction.streaming.ids.changed",activeStreamBuffersChanged:"interaction.active.stream.buffers.changed",activeReasoningBuffersChanged:"interaction.active.reasoning.buffers.changed",statusChanged:"interaction.status.changed",errorChanged:"interaction.error.changed",interactionRated:"interaction.rated",started:"interaction.sdk.started",streamChunk:"interaction.sdk.streamChunk",completed:"interaction.sdk.completed",loadInteractionsRequest:"interaction.load.interactions.request",rateInteractionRequest:"interaction.rate.interaction.request",setCurrentConversationIdRequest:"interaction.set.current.conversation.id.request",clearInteractionsRequest:"interaction.clear.interactions.request",setErrorRequest:"interaction.set.error.request",setStatusRequest:"interaction.set.status.request"};var rl=UW();const pE=_a(rl);function u0e(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const d0e=e=>{switch(e){case"success":return p0e;case"info":return g0e;case"warning":return m0e;case"error":return y0e;default:return null}},f0e=Array(12).fill(0),h0e=({visible:e,className:t})=>We.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},We.createElement("div",{className:"sonner-spinner"},f0e.map((n,r)=>We.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),p0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),m0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),g0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),y0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),b0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},We.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),We.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),v0e=()=>{const[e,t]=We.useState(document.hidden);return We.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let Z3=1;class x0e{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:Z3++,a=this.toasts.find(l=>l.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let i=r!==void 0,a;const o=s.then(async c=>{if(a=["resolve",c],We.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(_0e(c)&&!c.ok){i=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description,y=typeof d=="object"&&!We.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(c instanceof Error){i=!1;const d=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!We.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(n.success!==void 0){i=!1;const d=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!We.isValidElement(d)?d:{message:d};this.create({id:r,type:"success",description:h,...y})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;const u=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description,m=typeof u=="object"&&!We.isValidElement(u)?u:{message:u};this.create({id:r,type:"error",description:d,...m})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||Z3++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const bo=new x0e,w0e=(e,t)=>{const n=(t==null?void 0:t.id)||Z3++;return bo.addToast({title:e,...t,id:n}),n},_0e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",S0e=w0e,C0e=()=>bo.toasts,k0e=()=>bo.getActiveToasts(),Oe=Object.assign(S0e,{success:bo.success,info:bo.info,warning:bo.warning,error:bo.error,custom:bo.custom,message:bo.message,promise:bo.promise,dismiss:bo.dismiss,loading:bo.loading},{getHistory:C0e,getToasts:k0e});u0e("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function _S(e){return e.label!==void 0}const E0e=3,T0e="24px",A0e="16px",MB=4e3,R0e=356,N0e=14,M0e=45,I0e=200;function Gc(...e){return e.filter(Boolean).join(" ")}function j0e(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const O0e=e=>{var t,n,r,s,i,a,o,l,c;const{invert:u,toast:d,unstyled:h,interacting:m,setHeights:y,visibleToasts:b,heights:v,index:x,toasts:w,expanded:S,removeToast:C,defaultRichColors:k,closeButton:A,style:R,cancelButtonStyle:N,actionButtonStyle:I,className:O="",descriptionClassName:L="",duration:P,position:V,gap:F,expandByDefault:X,classNames:U,icons:H,closeButtonAriaLabel:$="Close toast"}=e,[ne,W]=We.useState(null),[Q,ee]=We.useState(null),[se,pe]=We.useState(!1),[ce,Ie]=We.useState(!1),[De,Se]=We.useState(!1),[Ce,qe]=We.useState(!1),[Qe,Ve]=We.useState(!1),[Ne,K]=We.useState(0),[me,Ae]=We.useState(0),le=We.useRef(d.duration||P||MB),oe=We.useRef(null),re=We.useRef(null),Te=x===0,Be=x+1<=b,ke=d.type,lt=d.dismissible!==!1,Rt=d.className||"",ft=d.descriptionClassName||"",jt=We.useMemo(()=>v.findIndex(_e=>_e.toastId===d.id)||0,[v,d.id]),qt=We.useMemo(()=>{var _e;return(_e=d.closeButton)!=null?_e:A},[d.closeButton,A]),Lt=We.useMemo(()=>d.duration||P||MB,[d.duration,P]),en=We.useRef(0),xe=We.useRef(0),D=We.useRef(0),Z=We.useRef(null),[ge,Fe]=V.split("-"),we=We.useMemo(()=>v.reduce((_e,Ue,kt)=>kt>=jt?_e:_e+Ue.height,0),[v,jt]),Me=v0e(),de=d.invert||u,vt=ke==="loading";xe.current=We.useMemo(()=>jt*F+we,[jt,we]),We.useEffect(()=>{le.current=Lt},[Lt]),We.useEffect(()=>{pe(!0)},[]),We.useEffect(()=>{const _e=re.current;if(_e){const Ue=_e.getBoundingClientRect().height;return Ae(Ue),y(kt=>[{toastId:d.id,height:Ue,position:d.position},...kt]),()=>y(kt=>kt.filter(fe=>fe.toastId!==d.id))}},[y,d.id]),We.useLayoutEffect(()=>{if(!se)return;const _e=re.current,Ue=_e.style.height;_e.style.height="auto";const kt=_e.getBoundingClientRect().height;_e.style.height=Ue,Ae(kt),y(fe=>fe.find(G=>G.toastId===d.id)?fe.map(G=>G.toastId===d.id?{...G,height:kt}:G):[{toastId:d.id,height:kt,position:d.position},...fe])},[se,d.title,d.description,y,d.id]);const ot=We.useCallback(()=>{Ie(!0),K(xe.current),y(_e=>_e.filter(Ue=>Ue.toastId!==d.id)),setTimeout(()=>{C(d)},I0e)},[d,C,y,xe]);We.useEffect(()=>{if(d.promise&&ke==="loading"||d.duration===1/0||d.type==="loading")return;let _e;return S||m||Me?(()=>{if(D.current<en.current){const fe=new Date().getTime()-en.current;le.current=le.current-fe}D.current=new Date().getTime()})():(()=>{le.current!==1/0&&(en.current=new Date().getTime(),_e=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),ot()},le.current))})(),()=>clearTimeout(_e)},[S,m,d,ke,Me,ot]),We.useEffect(()=>{d.delete&&ot()},[ot,d.delete]);function B(){var _e;if(H!=null&&H.loading){var Ue;return We.createElement("div",{className:Gc(U==null?void 0:U.loader,d==null||(Ue=d.classNames)==null?void 0:Ue.loader,"sonner-loader"),"data-visible":ke==="loading"},H.loading)}return We.createElement(h0e,{className:Gc(U==null?void 0:U.loader,d==null||(_e=d.classNames)==null?void 0:_e.loader),visible:ke==="loading"})}const ze=d.icon||(H==null?void 0:H[ke])||d0e(ke);var st,ye;return We.createElement("li",{tabIndex:0,ref:re,className:Gc(O,Rt,U==null?void 0:U.toast,d==null||(t=d.classNames)==null?void 0:t.toast,U==null?void 0:U.default,U==null?void 0:U[ke],d==null||(n=d.classNames)==null?void 0:n[ke]),"data-sonner-toast":"","data-rich-colors":(st=d.richColors)!=null?st:k,"data-styled":!(d.jsx||d.unstyled||h),"data-mounted":se,"data-promise":!!d.promise,"data-swiped":Qe,"data-removed":ce,"data-visible":Be,"data-y-position":ge,"data-x-position":Fe,"data-index":x,"data-front":Te,"data-swiping":De,"data-dismissible":lt,"data-type":ke,"data-invert":de,"data-swipe-out":Ce,"data-swipe-direction":Q,"data-expanded":!!(S||X&&se),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${ce?Ne:xe.current}px`,"--initial-height":X?"auto":`${me}px`,...R,...d.style},onDragEnd:()=>{Se(!1),W(null),Z.current=null},onPointerDown:_e=>{vt||!lt||(oe.current=new Date,K(xe.current),_e.target.setPointerCapture(_e.pointerId),_e.target.tagName!=="BUTTON"&&(Se(!0),Z.current={x:_e.clientX,y:_e.clientY}))},onPointerUp:()=>{var _e,Ue,kt;if(Ce||!lt)return;Z.current=null;const fe=Number(((_e=re.current)==null?void 0:_e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Y=Number(((Ue=re.current)==null?void 0:Ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),G=new Date().getTime()-((kt=oe.current)==null?void 0:kt.getTime()),J=ne==="x"?fe:Y,be=Math.abs(J)/G;if(Math.abs(J)>=M0e||be>.11){K(xe.current),d.onDismiss==null||d.onDismiss.call(d,d),ee(ne==="x"?fe>0?"right":"left":Y>0?"down":"up"),ot(),qe(!0);return}else{var Pe,Ge;(Pe=re.current)==null||Pe.style.setProperty("--swipe-amount-x","0px"),(Ge=re.current)==null||Ge.style.setProperty("--swipe-amount-y","0px")}Ve(!1),Se(!1),W(null)},onPointerMove:_e=>{var Ue,kt,fe;if(!Z.current||!lt||((Ue=window.getSelection())==null?void 0:Ue.toString().length)>0)return;const G=_e.clientY-Z.current.y,J=_e.clientX-Z.current.x;var be;const Pe=(be=e.swipeDirections)!=null?be:j0e(V);!ne&&(Math.abs(J)>1||Math.abs(G)>1)&&W(Math.abs(J)>Math.abs(G)?"x":"y");let Ge={x:0,y:0};const _t=tn=>1/(1.5+Math.abs(tn)/20);if(ne==="y"){if(Pe.includes("top")||Pe.includes("bottom"))if(Pe.includes("top")&&G<0||Pe.includes("bottom")&&G>0)Ge.y=G;else{const tn=G*_t(G);Ge.y=Math.abs(tn)<Math.abs(G)?tn:G}}else if(ne==="x"&&(Pe.includes("left")||Pe.includes("right")))if(Pe.includes("left")&&J<0||Pe.includes("right")&&J>0)Ge.x=J;else{const tn=J*_t(J);Ge.x=Math.abs(tn)<Math.abs(J)?tn:J}(Math.abs(Ge.x)>0||Math.abs(Ge.y)>0)&&Ve(!0),(kt=re.current)==null||kt.style.setProperty("--swipe-amount-x",`${Ge.x}px`),(fe=re.current)==null||fe.style.setProperty("--swipe-amount-y",`${Ge.y}px`)}},qt&&!d.jsx&&ke!=="loading"?We.createElement("button",{"aria-label":$,"data-disabled":vt,"data-close-button":!0,onClick:vt||!lt?()=>{}:()=>{ot(),d.onDismiss==null||d.onDismiss.call(d,d)},className:Gc(U==null?void 0:U.closeButton,d==null||(r=d.classNames)==null?void 0:r.closeButton)},(ye=H==null?void 0:H.close)!=null?ye:b0e):null,(ke||d.icon||d.promise)&&d.icon!==null&&((H==null?void 0:H[ke])!==null||d.icon)?We.createElement("div",{"data-icon":"",className:Gc(U==null?void 0:U.icon,d==null||(s=d.classNames)==null?void 0:s.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||B():null,d.type!=="loading"?ze:null):null,We.createElement("div",{"data-content":"",className:Gc(U==null?void 0:U.content,d==null||(i=d.classNames)==null?void 0:i.content)},We.createElement("div",{"data-title":"",className:Gc(U==null?void 0:U.title,d==null||(a=d.classNames)==null?void 0:a.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?We.createElement("div",{"data-description":"",className:Gc(L,ft,U==null?void 0:U.description,d==null||(o=d.classNames)==null?void 0:o.description)},typeof d.description=="function"?d.description():d.description):null),We.isValidElement(d.cancel)?d.cancel:d.cancel&&_S(d.cancel)?We.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||N,onClick:_e=>{_S(d.cancel)&&lt&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,_e),ot())},className:Gc(U==null?void 0:U.cancelButton,d==null||(l=d.classNames)==null?void 0:l.cancelButton)},d.cancel.label):null,We.isValidElement(d.action)?d.action:d.action&&_S(d.action)?We.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||I,onClick:_e=>{_S(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,_e),!_e.defaultPrevented&&ot())},className:Gc(U==null?void 0:U.actionButton,d==null||(c=d.classNames)==null?void 0:c.actionButton)},d.action.label):null)};function IB(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function P0e(e,t){const n={};return[e,t].forEach((r,s)=>{const i=s===1,a=i?"--mobile-offset":"--offset",o=i?A0e:T0e;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=o:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}const D0e=We.forwardRef(function(t,n){const{invert:r,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:m,style:y,visibleToasts:b=E0e,toastOptions:v,dir:x=IB(),gap:w=N0e,icons:S,containerAriaLabel:C="Notifications"}=t,[k,A]=We.useState([]),R=We.useMemo(()=>Array.from(new Set([s].concat(k.filter(Q=>Q.position).map(Q=>Q.position)))),[k,s]),[N,I]=We.useState([]),[O,L]=We.useState(!1),[P,V]=We.useState(!1),[F,X]=We.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=We.useRef(null),H=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),$=We.useRef(null),ne=We.useRef(!1),W=We.useCallback(Q=>{A(ee=>{var se;return(se=ee.find(pe=>pe.id===Q.id))!=null&&se.delete||bo.dismiss(Q.id),ee.filter(({id:pe})=>pe!==Q.id)})},[]);return We.useEffect(()=>bo.subscribe(Q=>{if(Q.dismiss){requestAnimationFrame(()=>{A(ee=>ee.map(se=>se.id===Q.id?{...se,delete:!0}:se))});return}setTimeout(()=>{pE.flushSync(()=>{A(ee=>{const se=ee.findIndex(pe=>pe.id===Q.id);return se!==-1?[...ee.slice(0,se),{...ee[se],...Q},...ee.slice(se+1)]:[Q,...ee]})})})}),[k]),We.useEffect(()=>{if(d!=="system"){X(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?X("dark"):X("light")),typeof window>"u")return;const Q=window.matchMedia("(prefers-color-scheme: dark)");try{Q.addEventListener("change",({matches:ee})=>{X(ee?"dark":"light")})}catch{Q.addListener(({matches:se})=>{try{X(se?"dark":"light")}catch(pe){console.error(pe)}})}},[d]),We.useEffect(()=>{k.length<=1&&L(!1)},[k]),We.useEffect(()=>{const Q=ee=>{var se;if(i.every(Ie=>ee[Ie]||ee.code===Ie)){var ce;L(!0),(ce=U.current)==null||ce.focus()}ee.code==="Escape"&&(document.activeElement===U.current||(se=U.current)!=null&&se.contains(document.activeElement))&&L(!1)};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[i]),We.useEffect(()=>{if(U.current)return()=>{$.current&&($.current.focus({preventScroll:!0}),$.current=null,ne.current=!1)}},[U.current]),We.createElement("section",{ref:n,"aria-label":`${C} ${H}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},R.map((Q,ee)=>{var se;const[pe,ce]=Q.split("-");return k.length?We.createElement("ol",{key:Q,dir:x==="auto"?IB():x,tabIndex:-1,ref:U,className:l,"data-sonner-toaster":!0,"data-sonner-theme":F,"data-y-position":pe,"data-lifted":O&&k.length>1&&!a,"data-x-position":ce,style:{"--front-toast-height":`${((se=N[0])==null?void 0:se.height)||0}px`,"--width":`${R0e}px`,"--gap":`${w}px`,...y,...P0e(c,u)},onBlur:Ie=>{ne.current&&!Ie.currentTarget.contains(Ie.relatedTarget)&&(ne.current=!1,$.current&&($.current.focus({preventScroll:!0}),$.current=null))},onFocus:Ie=>{Ie.target instanceof HTMLElement&&Ie.target.dataset.dismissible==="false"||ne.current||(ne.current=!0,$.current=Ie.relatedTarget)},onMouseEnter:()=>L(!0),onMouseMove:()=>L(!0),onMouseLeave:()=>{P||L(!1)},onDragEnd:()=>L(!1),onPointerDown:Ie=>{Ie.target instanceof HTMLElement&&Ie.target.dataset.dismissible==="false"||V(!0)},onPointerUp:()=>V(!1)},k.filter(Ie=>!Ie.position&&ee===0||Ie.position===Q).map((Ie,De)=>{var Se,Ce;return We.createElement(O0e,{key:Ie.id,icons:S,index:De,toast:Ie,defaultRichColors:h,duration:(Se=v==null?void 0:v.duration)!=null?Se:m,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:r,visibleToasts:b,closeButton:(Ce=v==null?void 0:v.closeButton)!=null?Ce:o,interacting:P,position:Q,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,closeButtonAriaLabel:v==null?void 0:v.closeButtonAriaLabel,removeToast:W,toasts:k.filter(qe=>qe.position==Ie.position),heights:N.filter(qe=>qe.position==Ie.position),setHeights:I,expandByDefault:a,gap:w,expanded:O,swipeDirections:t.swipeDirections})})):null}))}),Bn=Fo(Lo((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(t().currentConversationId!==n){console.warn(`InteractionStore: loadInteractions called for ${n}, but current is ${t().currentConversationId}. Aborting load.`);return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{}}),r!=="loading"&&je.emit(Zn.statusChanged,{status:"loading"});try{const s=await Et.loadInteractionsForConversation(n);s.sort((l,c)=>l.index-c.index);const i=t().interactions.filter(l=>l.conversationId===n),a=new Set(s.map(l=>l.id)),o=[...s,...i.filter(l=>!a.has(l.id))];o.sort((l,c)=>l.index-c.index),t().currentConversationId===n?(e({interactions:o,status:"idle"}),je.emit(Zn.loaded,{conversationId:n,interactions:o}),je.emit(Zn.statusChanged,{status:"idle"})):console.warn(`InteractionStore: loadInteractions for ${n} completed, but currentConversationId changed during fetch to ${t().currentConversationId}. Discarding.`)}catch(s){console.error(`InteractionStore: Error loading interactions for ${n}`,s),t().currentConversationId===n&&(e({error:"Failed load interactions",status:"error"}),je.emit(Zn.statusChanged,{status:"error"}),je.emit(Zn.errorChanged,{error:"Failed load interactions"}))}},_addInteractionToState:n=>{e(r=>{if(r.currentConversationId!==n.conversationId){console.warn(`InteractionStore: Attempted to add interaction for ${n.conversationId} but current is ${r.currentConversationId}. Skipping.`);return}if(!r.interactions.some(s=>s.id===n.id))r.interactions.push(n),r.interactions.sort((s,i)=>s.index-i.index);else{const s=r.interactions.findIndex(i=>i.id===n.id);s!==-1&&(r.interactions[s]={...r.interactions[s],...n})}}),je.emit(Zn.added,{interaction:n})},_updateInteractionInState:(n,r)=>{e(s=>{const i=s.interactions.findIndex(a=>a.id===n);if(i!==-1){if(s.currentConversationId!==s.interactions[i].conversationId){console.warn(`InteractionStore: Attempted to update interaction ${n} which is not in the current conversation ${s.currentConversationId}. Skipping.`);return}const a=s.interactions[i];let o={...a.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]),r.metadata.reasoning!==void 0&&(o.reasoning=r.metadata.reasoning));const l={...a,...r,metadata:o};"response"in r&&(l.response=r.response),"rating"in r&&(l.rating=r.rating),s.interactions[i]=l}}),je.emit(Zn.updated,{interactionId:n,updates:r})},appendInteractionResponseChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeStreamBuffers[n]=(s.activeStreamBuffers[n]||"")+r)}),je.emit(Zn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendReasoningChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeReasoningBuffers[n]=(s.activeReasoningBuffers[n]||"")+r)}),je.emit(Zn.activeReasoningBuffersChanged,{buffers:t().activeReasoningBuffers})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(s=>s.id!==n)})},rateInteraction:async(n,r)=>{const s=t().interactions.find(i=>i.id===n);if(s&&t().currentConversationId===s.conversationId){t()._updateInteractionInState(n,{rating:r});try{await Et.saveInteraction({...s,rating:r}),je.emit(Zn.interactionRated,{interactionId:n,rating:r})}catch{t()._updateInteractionInState(n,{rating:s.rating}),Oe.error("Failed to save rating.")}}},setCurrentConversationId:async n=>{const r=t().currentConversationId;if(r===n){n&&t().interactions.length===0&&t().status!=="loading"?(console.warn(`InteractionStore: Current ID ${n} matches, but no interactions. Forcing reload.`),await t().loadInteractions(n)):console.log(`InteractionStore: setCurrentConversationId called with the same ID (${n}). No change needed or already handled.`);return}console.log(`InteractionStore: Setting current conversation ID from ${r} to ${n}`),e({currentConversationId:n}),je.emit(Zn.currentConversationIdChanged,{conversationId:n}),n?await t().loadInteractions(n):t().clearInteractions()},clearInteractions:()=>{const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&je.emit(Zn.statusChanged,{status:"idle"}),je.emit(Zn.currentConversationIdChanged,{conversationId:null})},setError:n=>{const r=t().status;let s="idle";e(i=>{i.error=n,n?(s="error",i.status="error"):i.status==="error"?(s=i.streamingInteractionIds.length>0?"streaming":"idle",i.status=s):s=i.status}),r!==s&&je.emit(Zn.statusChanged,{status:s}),je.emit(Zn.errorChanged,{error:n})},setStatus:n=>{t().status!==n&&(e({status:n}),je.emit(Zn.statusChanged,{status:n}))},_addStreamingId:n=>{let r=!1;e(s=>{s.streamingInteractionIds.includes(n)||(s.streamingInteractionIds.push(n),s.activeStreamBuffers[n]="",s.activeReasoningBuffers[n]="",s.streamingInteractionIds.length===1&&(s.status="streaming",r=!0),s.error=null)}),r&&je.emit(Zn.statusChanged,{status:"streaming"}),je.emit(Zn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},_removeStreamingId:n=>{let r=!1;e(s=>{const i=s.streamingInteractionIds.indexOf(n);i!==-1&&(s.streamingInteractionIds.splice(i,1),delete s.activeStreamBuffers[n],delete s.activeReasoningBuffers[n],s.streamingInteractionIds.length===0&&s.status==="streaming"&&(s.status=s.error?"error":"idle",r=!0))}),r&&je.emit(Zn.statusChanged,{status:t().status}),je.emit(Zn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},getRegisteredActionHandlers:()=>{const n="interactionStore",r=t();return[{eventName:Zn.loadInteractionsRequest,handler:s=>r.loadInteractions(s.conversationId),storeId:n},{eventName:Zn.rateInteractionRequest,handler:s=>r.rateInteraction(s.interactionId,s.rating),storeId:n},{eventName:Zn.setCurrentConversationIdRequest,handler:s=>r.setCurrentConversationId(s.id),storeId:n},{eventName:Zn.clearInteractionsRequest,handler:()=>r.clearInteractions(),storeId:n},{eventName:Zn.setErrorRequest,handler:s=>r.setError(s.error),storeId:n},{eventName:Zn.setStatusRequest,handler:s=>r.setStatus(s.status),storeId:n}]}}))),F0e="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let qi=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=F0e[n[e]&63];return t};const Ll={attachedFilesChanged:"input.attached.files.changed",addAttachedFileRequest:"input.add.attached.file.request",removeAttachedFileRequest:"input.remove.attached.file.request",clearAttachedFilesRequest:"input.clear.attached.files.request"},hh=Fo(Lo((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(s=>{if(s.attachedFilesMetadata.some(a=>a.source==="direct"&&n.source==="direct"?a.name===n.name&&a.size===n.size:a.source==="vfs"&&n.source==="vfs"?a.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const a={id:qi(),...n};s.attachedFilesMetadata.push(a),r=!0}}),r&&je.emit(Ll.attachedFilesChanged,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(s=>{const i=s.attachedFilesMetadata.length;s.attachedFilesMetadata=s.attachedFilesMetadata.filter(a=>a.id!==n),r=s.attachedFilesMetadata.length<i}),r&&je.emit(Ll.attachedFilesChanged,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&je.emit(Ll.attachedFilesChanged,{files:[]})},getRegisteredActionHandlers:()=>{const n="inputStore",r=t();return[{eventName:Ll.addAttachedFileRequest,handler:s=>r.addAttachedFile(s),storeId:n},{eventName:Ll.removeAttachedFileRequest,handler:s=>r.removeAttachedFile(s.attachmentId),storeId:n},{eventName:Ll.clearAttachedFilesRequest,handler:()=>r.clearAttachedFiles(),storeId:n}]}}))),wH=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(wH);const zx=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml"||n.split(".").length<2)return!0;const s="."+n.split(".").pop();return wH.has(s)};var _H="vercel.ai.error",L0e=Symbol.for(_H),SH,B0e=class CH extends Error{constructor({name:t,message:n,cause:r}){super(n),this[SH]=!0,this.name=t,this.cause=r}static isInstance(t){return CH.hasMarker(t,_H)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};SH=L0e;var er=B0e,kH="AI_APICallError",EH=`vercel.ai.error.${kH}`,$0e=Symbol.for(EH),TH,$l=class extends er{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:s,responseBody:i,cause:a,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:kH,message:e,cause:a}),this[TH]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=s,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return er.hasMarker(e,EH)}};TH=$0e;var AH="AI_EmptyResponseBodyError",RH=`vercel.ai.error.${AH}`,z0e=Symbol.for(RH),NH,MH=class extends er{constructor({message:e="Empty response body"}={}){super({name:AH,message:e}),this[NH]=!0}static isInstance(e){return er.hasMarker(e,RH)}};NH=z0e;function a1(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var IH="AI_InvalidArgumentError",jH=`vercel.ai.error.${IH}`,U0e=Symbol.for(jH),OH,PH=class extends er{constructor({message:t,cause:n,argument:r}){super({name:IH,message:t,cause:n}),this[OH]=!0,this.argument=r}static isInstance(t){return er.hasMarker(t,jH)}};OH=U0e;var DH="AI_InvalidPromptError",FH=`vercel.ai.error.${DH}`,q0e=Symbol.for(FH),LH,uc=class extends er{constructor({prompt:e,message:t,cause:n}){super({name:DH,message:`Invalid prompt: ${t}`,cause:n}),this[LH]=!0,this.prompt=e}static isInstance(e){return er.hasMarker(e,FH)}};LH=q0e;var BH="AI_InvalidResponseDataError",$H=`vercel.ai.error.${BH}`,V0e=Symbol.for($H),zH,Td=class extends er{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:BH,message:t}),this[zH]=!0,this.data=e}static isInstance(e){return er.hasMarker(e,$H)}};zH=V0e;var UH="AI_JSONParseError",qH=`vercel.ai.error.${UH}`,W0e=Symbol.for(qH),VH,sC=class extends er{constructor({text:e,cause:t}){super({name:UH,message:`JSON parsing failed: Text: ${e}.
Error message: ${a1(t)}`,cause:t}),this[VH]=!0,this.text=e}static isInstance(e){return er.hasMarker(e,qH)}};VH=W0e;var WH="AI_LoadAPIKeyError",HH=`vercel.ai.error.${WH}`,H0e=Symbol.for(HH),GH,SS=class extends er{constructor({message:e}){super({name:WH,message:e}),this[GH]=!0}static isInstance(e){return er.hasMarker(e,HH)}};GH=H0e;var KH="AI_TooManyEmbeddingValuesForCallError",YH=`vercel.ai.error.${KH}`,G0e=Symbol.for(YH),ZH,mE=class extends er{constructor(e){super({name:KH,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[ZH]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return er.hasMarker(e,YH)}};ZH=G0e;var XH="AI_TypeValidationError",JH=`vercel.ai.error.${XH}`,K0e=Symbol.for(JH),QH,Y0e=class X3 extends er{constructor({value:t,cause:n}){super({name:XH,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${a1(n)}`,cause:n}),this[QH]=!0,this.value=t}static isInstance(t){return er.hasMarker(t,JH)}static wrap({value:t,cause:n}){return X3.isInstance(n)&&n.value===t?n:new X3({value:t,cause:n})}};QH=K0e;var iC=Y0e,eG="AI_UnsupportedFunctionalityError",tG=`vercel.ai.error.${eG}`,Z0e=Symbol.for(tG),nG,hr=class extends er{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:eG,message:t}),this[nG]=!0,this.functionality=e}static isInstance(e){return er.hasMarker(e,tG)}};nG=Z0e;let X0e=(e,t=21)=>(n=t)=>{let r="",s=n|0;for(;s--;)r+=e[Math.random()*e.length|0];return r};var LO={},gE={};gE.byteLength=eye;gE.toByteArray=nye;gE.fromByteArray=iye;var au=[],Pl=[],J0e=typeof Uint8Array<"u"?Uint8Array:Array,fN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Wg=0,Q0e=fN.length;Wg<Q0e;++Wg)au[Wg]=fN[Wg],Pl[fN.charCodeAt(Wg)]=Wg;Pl[45]=62;Pl[95]=63;function rG(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function eye(e){var t=rG(e),n=t[0],r=t[1];return(n+r)*3/4-r}function tye(e,t,n){return(t+n)*3/4-n}function nye(e){var t,n=rG(e),r=n[0],s=n[1],i=new J0e(tye(e,r,s)),a=0,o=s>0?r-4:r,l;for(l=0;l<o;l+=4)t=Pl[e.charCodeAt(l)]<<18|Pl[e.charCodeAt(l+1)]<<12|Pl[e.charCodeAt(l+2)]<<6|Pl[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return s===2&&(t=Pl[e.charCodeAt(l)]<<2|Pl[e.charCodeAt(l+1)]>>4,i[a++]=t&255),s===1&&(t=Pl[e.charCodeAt(l)]<<10|Pl[e.charCodeAt(l+1)]<<4|Pl[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function rye(e){return au[e>>18&63]+au[e>>12&63]+au[e>>6&63]+au[e&63]}function sye(e,t,n){for(var r,s=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(rye(r));return s.join("")}function iye(e){for(var t,n=e.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push(sye(e,a,a+i>o?o:a+i));return r===1?(t=e[n-1],s.push(au[t>>2]+au[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],s.push(au[t>>10]+au[t>>4&63]+au[t<<2&63]+"=")),s.join("")}var BO={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */BO.read=function(e,t,n,r,s){var i,a,o=s*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,d=n?s-1:0,h=n?-1:1,m=e[t+d];for(d+=h,i=m&(1<<-u)-1,m>>=-u,u+=o;u>0;i=i*256+e[t+d],d+=h,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=a*256+e[t+d],d+=h,u-=8);if(i===0)i=1-c;else{if(i===l)return a?NaN:(m?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-c}return(m?-1:1)*a*Math.pow(2,i-r)};BO.write=function(e,t,n,r,s,i){var a,o,l,c=i*8-s-1,u=(1<<c)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=r?0:i-1,y=r?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(o=0,a=u):a+d>=1?(o=(t*l-1)*Math.pow(2,s),a=a+d):(o=t*Math.pow(2,d-1)*Math.pow(2,s),a=0));s>=8;e[n+m]=o&255,m+=y,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;e[n+m]=a&255,m+=y,a/=256,c-=8);e[n+m-y]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=gE,n=BO,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=k,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const xe=new i(1),D={foo:function(){return 42}};return Object.setPrototypeOf(D,i.prototype),Object.setPrototypeOf(xe,D),xe.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(xe){if(xe>s)throw new RangeError('The value "'+xe+'" is invalid for option "size"');const D=new i(xe);return Object.setPrototypeOf(D,u.prototype),D}function u(xe,D,Z){if(typeof xe=="number"){if(typeof D=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(xe)}return d(xe,D,Z)}u.poolSize=8192;function d(xe,D,Z){if(typeof xe=="string")return b(xe,D);if(a.isView(xe))return x(xe);if(xe==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xe);if(ft(xe,a)||xe&&ft(xe.buffer,a)||typeof o<"u"&&(ft(xe,o)||xe&&ft(xe.buffer,o)))return w(xe,D,Z);if(typeof xe=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ge=xe.valueOf&&xe.valueOf();if(ge!=null&&ge!==xe)return u.from(ge,D,Z);const Fe=S(xe);if(Fe)return Fe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof xe[Symbol.toPrimitive]=="function")return u.from(xe[Symbol.toPrimitive]("string"),D,Z);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xe)}u.from=function(xe,D,Z){return d(xe,D,Z)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function h(xe){if(typeof xe!="number")throw new TypeError('"size" argument must be of type number');if(xe<0)throw new RangeError('The value "'+xe+'" is invalid for option "size"')}function m(xe,D,Z){return h(xe),xe<=0?c(xe):D!==void 0?typeof Z=="string"?c(xe).fill(D,Z):c(xe).fill(D):c(xe)}u.alloc=function(xe,D,Z){return m(xe,D,Z)};function y(xe){return h(xe),c(xe<0?0:C(xe)|0)}u.allocUnsafe=function(xe){return y(xe)},u.allocUnsafeSlow=function(xe){return y(xe)};function b(xe,D){if((typeof D!="string"||D==="")&&(D="utf8"),!u.isEncoding(D))throw new TypeError("Unknown encoding: "+D);const Z=A(xe,D)|0;let ge=c(Z);const Fe=ge.write(xe,D);return Fe!==Z&&(ge=ge.slice(0,Fe)),ge}function v(xe){const D=xe.length<0?0:C(xe.length)|0,Z=c(D);for(let ge=0;ge<D;ge+=1)Z[ge]=xe[ge]&255;return Z}function x(xe){if(ft(xe,i)){const D=new i(xe);return w(D.buffer,D.byteOffset,D.byteLength)}return v(xe)}function w(xe,D,Z){if(D<0||xe.byteLength<D)throw new RangeError('"offset" is outside of buffer bounds');if(xe.byteLength<D+(Z||0))throw new RangeError('"length" is outside of buffer bounds');let ge;return D===void 0&&Z===void 0?ge=new i(xe):Z===void 0?ge=new i(xe,D):ge=new i(xe,D,Z),Object.setPrototypeOf(ge,u.prototype),ge}function S(xe){if(u.isBuffer(xe)){const D=C(xe.length)|0,Z=c(D);return Z.length===0||xe.copy(Z,0,0,D),Z}if(xe.length!==void 0)return typeof xe.length!="number"||jt(xe.length)?c(0):v(xe);if(xe.type==="Buffer"&&Array.isArray(xe.data))return v(xe.data)}function C(xe){if(xe>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return xe|0}function k(xe){return+xe!=xe&&(xe=0),u.alloc(+xe)}u.isBuffer=function(D){return D!=null&&D._isBuffer===!0&&D!==u.prototype},u.compare=function(D,Z){if(ft(D,i)&&(D=u.from(D,D.offset,D.byteLength)),ft(Z,i)&&(Z=u.from(Z,Z.offset,Z.byteLength)),!u.isBuffer(D)||!u.isBuffer(Z))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(D===Z)return 0;let ge=D.length,Fe=Z.length;for(let we=0,Me=Math.min(ge,Fe);we<Me;++we)if(D[we]!==Z[we]){ge=D[we],Fe=Z[we];break}return ge<Fe?-1:Fe<ge?1:0},u.isEncoding=function(D){switch(String(D).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(D,Z){if(!Array.isArray(D))throw new TypeError('"list" argument must be an Array of Buffers');if(D.length===0)return u.alloc(0);let ge;if(Z===void 0)for(Z=0,ge=0;ge<D.length;++ge)Z+=D[ge].length;const Fe=u.allocUnsafe(Z);let we=0;for(ge=0;ge<D.length;++ge){let Me=D[ge];if(ft(Me,i))we+Me.length>Fe.length?(u.isBuffer(Me)||(Me=u.from(Me)),Me.copy(Fe,we)):i.prototype.set.call(Fe,Me,we);else if(u.isBuffer(Me))Me.copy(Fe,we);else throw new TypeError('"list" argument must be an Array of Buffers');we+=Me.length}return Fe};function A(xe,D){if(u.isBuffer(xe))return xe.length;if(a.isView(xe)||ft(xe,a))return xe.byteLength;if(typeof xe!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof xe);const Z=xe.length,ge=arguments.length>2&&arguments[2]===!0;if(!ge&&Z===0)return 0;let Fe=!1;for(;;)switch(D){case"ascii":case"latin1":case"binary":return Z;case"utf8":case"utf-8":return Te(xe).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z*2;case"hex":return Z>>>1;case"base64":return lt(xe).length;default:if(Fe)return ge?-1:Te(xe).length;D=(""+D).toLowerCase(),Fe=!0}}u.byteLength=A;function R(xe,D,Z){let ge=!1;if((D===void 0||D<0)&&(D=0),D>this.length||((Z===void 0||Z>this.length)&&(Z=this.length),Z<=0)||(Z>>>=0,D>>>=0,Z<=D))return"";for(xe||(xe="utf8");;)switch(xe){case"hex":return ee(this,D,Z);case"utf8":case"utf-8":return H(this,D,Z);case"ascii":return W(this,D,Z);case"latin1":case"binary":return Q(this,D,Z);case"base64":return U(this,D,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se(this,D,Z);default:if(ge)throw new TypeError("Unknown encoding: "+xe);xe=(xe+"").toLowerCase(),ge=!0}}u.prototype._isBuffer=!0;function N(xe,D,Z){const ge=xe[D];xe[D]=xe[Z],xe[Z]=ge}u.prototype.swap16=function(){const D=this.length;if(D%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Z=0;Z<D;Z+=2)N(this,Z,Z+1);return this},u.prototype.swap32=function(){const D=this.length;if(D%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Z=0;Z<D;Z+=4)N(this,Z,Z+3),N(this,Z+1,Z+2);return this},u.prototype.swap64=function(){const D=this.length;if(D%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Z=0;Z<D;Z+=8)N(this,Z,Z+7),N(this,Z+1,Z+6),N(this,Z+2,Z+5),N(this,Z+3,Z+4);return this},u.prototype.toString=function(){const D=this.length;return D===0?"":arguments.length===0?H(this,0,D):R.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(D){if(!u.isBuffer(D))throw new TypeError("Argument must be a Buffer");return this===D?!0:u.compare(this,D)===0},u.prototype.inspect=function(){let D="";const Z=e.INSPECT_MAX_BYTES;return D=this.toString("hex",0,Z).replace(/(.{2})/g,"$1 ").trim(),this.length>Z&&(D+=" ... "),"<Buffer "+D+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(D,Z,ge,Fe,we){if(ft(D,i)&&(D=u.from(D,D.offset,D.byteLength)),!u.isBuffer(D))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof D);if(Z===void 0&&(Z=0),ge===void 0&&(ge=D?D.length:0),Fe===void 0&&(Fe=0),we===void 0&&(we=this.length),Z<0||ge>D.length||Fe<0||we>this.length)throw new RangeError("out of range index");if(Fe>=we&&Z>=ge)return 0;if(Fe>=we)return-1;if(Z>=ge)return 1;if(Z>>>=0,ge>>>=0,Fe>>>=0,we>>>=0,this===D)return 0;let Me=we-Fe,de=ge-Z;const vt=Math.min(Me,de),ot=this.slice(Fe,we),B=D.slice(Z,ge);for(let ze=0;ze<vt;++ze)if(ot[ze]!==B[ze]){Me=ot[ze],de=B[ze];break}return Me<de?-1:de<Me?1:0};function I(xe,D,Z,ge,Fe){if(xe.length===0)return-1;if(typeof Z=="string"?(ge=Z,Z=0):Z>2147483647?Z=2147483647:Z<-2147483648&&(Z=-2147483648),Z=+Z,jt(Z)&&(Z=Fe?0:xe.length-1),Z<0&&(Z=xe.length+Z),Z>=xe.length){if(Fe)return-1;Z=xe.length-1}else if(Z<0)if(Fe)Z=0;else return-1;if(typeof D=="string"&&(D=u.from(D,ge)),u.isBuffer(D))return D.length===0?-1:O(xe,D,Z,ge,Fe);if(typeof D=="number")return D=D&255,typeof i.prototype.indexOf=="function"?Fe?i.prototype.indexOf.call(xe,D,Z):i.prototype.lastIndexOf.call(xe,D,Z):O(xe,[D],Z,ge,Fe);throw new TypeError("val must be string, number or Buffer")}function O(xe,D,Z,ge,Fe){let we=1,Me=xe.length,de=D.length;if(ge!==void 0&&(ge=String(ge).toLowerCase(),ge==="ucs2"||ge==="ucs-2"||ge==="utf16le"||ge==="utf-16le")){if(xe.length<2||D.length<2)return-1;we=2,Me/=2,de/=2,Z/=2}function vt(B,ze){return we===1?B[ze]:B.readUInt16BE(ze*we)}let ot;if(Fe){let B=-1;for(ot=Z;ot<Me;ot++)if(vt(xe,ot)===vt(D,B===-1?0:ot-B)){if(B===-1&&(B=ot),ot-B+1===de)return B*we}else B!==-1&&(ot-=ot-B),B=-1}else for(Z+de>Me&&(Z=Me-de),ot=Z;ot>=0;ot--){let B=!0;for(let ze=0;ze<de;ze++)if(vt(xe,ot+ze)!==vt(D,ze)){B=!1;break}if(B)return ot}return-1}u.prototype.includes=function(D,Z,ge){return this.indexOf(D,Z,ge)!==-1},u.prototype.indexOf=function(D,Z,ge){return I(this,D,Z,ge,!0)},u.prototype.lastIndexOf=function(D,Z,ge){return I(this,D,Z,ge,!1)};function L(xe,D,Z,ge){Z=Number(Z)||0;const Fe=xe.length-Z;ge?(ge=Number(ge),ge>Fe&&(ge=Fe)):ge=Fe;const we=D.length;ge>we/2&&(ge=we/2);let Me;for(Me=0;Me<ge;++Me){const de=parseInt(D.substr(Me*2,2),16);if(jt(de))return Me;xe[Z+Me]=de}return Me}function P(xe,D,Z,ge){return Rt(Te(D,xe.length-Z),xe,Z,ge)}function V(xe,D,Z,ge){return Rt(Be(D),xe,Z,ge)}function F(xe,D,Z,ge){return Rt(lt(D),xe,Z,ge)}function X(xe,D,Z,ge){return Rt(ke(D,xe.length-Z),xe,Z,ge)}u.prototype.write=function(D,Z,ge,Fe){if(Z===void 0)Fe="utf8",ge=this.length,Z=0;else if(ge===void 0&&typeof Z=="string")Fe=Z,ge=this.length,Z=0;else if(isFinite(Z))Z=Z>>>0,isFinite(ge)?(ge=ge>>>0,Fe===void 0&&(Fe="utf8")):(Fe=ge,ge=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const we=this.length-Z;if((ge===void 0||ge>we)&&(ge=we),D.length>0&&(ge<0||Z<0)||Z>this.length)throw new RangeError("Attempt to write outside buffer bounds");Fe||(Fe="utf8");let Me=!1;for(;;)switch(Fe){case"hex":return L(this,D,Z,ge);case"utf8":case"utf-8":return P(this,D,Z,ge);case"ascii":case"latin1":case"binary":return V(this,D,Z,ge);case"base64":return F(this,D,Z,ge);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,D,Z,ge);default:if(Me)throw new TypeError("Unknown encoding: "+Fe);Fe=(""+Fe).toLowerCase(),Me=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(xe,D,Z){return D===0&&Z===xe.length?t.fromByteArray(xe):t.fromByteArray(xe.slice(D,Z))}function H(xe,D,Z){Z=Math.min(xe.length,Z);const ge=[];let Fe=D;for(;Fe<Z;){const we=xe[Fe];let Me=null,de=we>239?4:we>223?3:we>191?2:1;if(Fe+de<=Z){let vt,ot,B,ze;switch(de){case 1:we<128&&(Me=we);break;case 2:vt=xe[Fe+1],(vt&192)===128&&(ze=(we&31)<<6|vt&63,ze>127&&(Me=ze));break;case 3:vt=xe[Fe+1],ot=xe[Fe+2],(vt&192)===128&&(ot&192)===128&&(ze=(we&15)<<12|(vt&63)<<6|ot&63,ze>2047&&(ze<55296||ze>57343)&&(Me=ze));break;case 4:vt=xe[Fe+1],ot=xe[Fe+2],B=xe[Fe+3],(vt&192)===128&&(ot&192)===128&&(B&192)===128&&(ze=(we&15)<<18|(vt&63)<<12|(ot&63)<<6|B&63,ze>65535&&ze<1114112&&(Me=ze))}}Me===null?(Me=65533,de=1):Me>65535&&(Me-=65536,ge.push(Me>>>10&1023|55296),Me=56320|Me&1023),ge.push(Me),Fe+=de}return ne(ge)}const $=4096;function ne(xe){const D=xe.length;if(D<=$)return String.fromCharCode.apply(String,xe);let Z="",ge=0;for(;ge<D;)Z+=String.fromCharCode.apply(String,xe.slice(ge,ge+=$));return Z}function W(xe,D,Z){let ge="";Z=Math.min(xe.length,Z);for(let Fe=D;Fe<Z;++Fe)ge+=String.fromCharCode(xe[Fe]&127);return ge}function Q(xe,D,Z){let ge="";Z=Math.min(xe.length,Z);for(let Fe=D;Fe<Z;++Fe)ge+=String.fromCharCode(xe[Fe]);return ge}function ee(xe,D,Z){const ge=xe.length;(!D||D<0)&&(D=0),(!Z||Z<0||Z>ge)&&(Z=ge);let Fe="";for(let we=D;we<Z;++we)Fe+=qt[xe[we]];return Fe}function se(xe,D,Z){const ge=xe.slice(D,Z);let Fe="";for(let we=0;we<ge.length-1;we+=2)Fe+=String.fromCharCode(ge[we]+ge[we+1]*256);return Fe}u.prototype.slice=function(D,Z){const ge=this.length;D=~~D,Z=Z===void 0?ge:~~Z,D<0?(D+=ge,D<0&&(D=0)):D>ge&&(D=ge),Z<0?(Z+=ge,Z<0&&(Z=0)):Z>ge&&(Z=ge),Z<D&&(Z=D);const Fe=this.subarray(D,Z);return Object.setPrototypeOf(Fe,u.prototype),Fe};function pe(xe,D,Z){if(xe%1!==0||xe<0)throw new RangeError("offset is not uint");if(xe+D>Z)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(D,Z,ge){D=D>>>0,Z=Z>>>0,ge||pe(D,Z,this.length);let Fe=this[D],we=1,Me=0;for(;++Me<Z&&(we*=256);)Fe+=this[D+Me]*we;return Fe},u.prototype.readUintBE=u.prototype.readUIntBE=function(D,Z,ge){D=D>>>0,Z=Z>>>0,ge||pe(D,Z,this.length);let Fe=this[D+--Z],we=1;for(;Z>0&&(we*=256);)Fe+=this[D+--Z]*we;return Fe},u.prototype.readUint8=u.prototype.readUInt8=function(D,Z){return D=D>>>0,Z||pe(D,1,this.length),this[D]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(D,Z){return D=D>>>0,Z||pe(D,2,this.length),this[D]|this[D+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(D,Z){return D=D>>>0,Z||pe(D,2,this.length),this[D]<<8|this[D+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(D,Z){return D=D>>>0,Z||pe(D,4,this.length),(this[D]|this[D+1]<<8|this[D+2]<<16)+this[D+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(D,Z){return D=D>>>0,Z||pe(D,4,this.length),this[D]*16777216+(this[D+1]<<16|this[D+2]<<8|this[D+3])},u.prototype.readBigUInt64LE=Lt(function(D){D=D>>>0,Ae(D,"offset");const Z=this[D],ge=this[D+7];(Z===void 0||ge===void 0)&&le(D,this.length-8);const Fe=Z+this[++D]*2**8+this[++D]*2**16+this[++D]*2**24,we=this[++D]+this[++D]*2**8+this[++D]*2**16+ge*2**24;return BigInt(Fe)+(BigInt(we)<<BigInt(32))}),u.prototype.readBigUInt64BE=Lt(function(D){D=D>>>0,Ae(D,"offset");const Z=this[D],ge=this[D+7];(Z===void 0||ge===void 0)&&le(D,this.length-8);const Fe=Z*2**24+this[++D]*2**16+this[++D]*2**8+this[++D],we=this[++D]*2**24+this[++D]*2**16+this[++D]*2**8+ge;return(BigInt(Fe)<<BigInt(32))+BigInt(we)}),u.prototype.readIntLE=function(D,Z,ge){D=D>>>0,Z=Z>>>0,ge||pe(D,Z,this.length);let Fe=this[D],we=1,Me=0;for(;++Me<Z&&(we*=256);)Fe+=this[D+Me]*we;return we*=128,Fe>=we&&(Fe-=Math.pow(2,8*Z)),Fe},u.prototype.readIntBE=function(D,Z,ge){D=D>>>0,Z=Z>>>0,ge||pe(D,Z,this.length);let Fe=Z,we=1,Me=this[D+--Fe];for(;Fe>0&&(we*=256);)Me+=this[D+--Fe]*we;return we*=128,Me>=we&&(Me-=Math.pow(2,8*Z)),Me},u.prototype.readInt8=function(D,Z){return D=D>>>0,Z||pe(D,1,this.length),this[D]&128?(255-this[D]+1)*-1:this[D]},u.prototype.readInt16LE=function(D,Z){D=D>>>0,Z||pe(D,2,this.length);const ge=this[D]|this[D+1]<<8;return ge&32768?ge|4294901760:ge},u.prototype.readInt16BE=function(D,Z){D=D>>>0,Z||pe(D,2,this.length);const ge=this[D+1]|this[D]<<8;return ge&32768?ge|4294901760:ge},u.prototype.readInt32LE=function(D,Z){return D=D>>>0,Z||pe(D,4,this.length),this[D]|this[D+1]<<8|this[D+2]<<16|this[D+3]<<24},u.prototype.readInt32BE=function(D,Z){return D=D>>>0,Z||pe(D,4,this.length),this[D]<<24|this[D+1]<<16|this[D+2]<<8|this[D+3]},u.prototype.readBigInt64LE=Lt(function(D){D=D>>>0,Ae(D,"offset");const Z=this[D],ge=this[D+7];(Z===void 0||ge===void 0)&&le(D,this.length-8);const Fe=this[D+4]+this[D+5]*2**8+this[D+6]*2**16+(ge<<24);return(BigInt(Fe)<<BigInt(32))+BigInt(Z+this[++D]*2**8+this[++D]*2**16+this[++D]*2**24)}),u.prototype.readBigInt64BE=Lt(function(D){D=D>>>0,Ae(D,"offset");const Z=this[D],ge=this[D+7];(Z===void 0||ge===void 0)&&le(D,this.length-8);const Fe=(Z<<24)+this[++D]*2**16+this[++D]*2**8+this[++D];return(BigInt(Fe)<<BigInt(32))+BigInt(this[++D]*2**24+this[++D]*2**16+this[++D]*2**8+ge)}),u.prototype.readFloatLE=function(D,Z){return D=D>>>0,Z||pe(D,4,this.length),n.read(this,D,!0,23,4)},u.prototype.readFloatBE=function(D,Z){return D=D>>>0,Z||pe(D,4,this.length),n.read(this,D,!1,23,4)},u.prototype.readDoubleLE=function(D,Z){return D=D>>>0,Z||pe(D,8,this.length),n.read(this,D,!0,52,8)},u.prototype.readDoubleBE=function(D,Z){return D=D>>>0,Z||pe(D,8,this.length),n.read(this,D,!1,52,8)};function ce(xe,D,Z,ge,Fe,we){if(!u.isBuffer(xe))throw new TypeError('"buffer" argument must be a Buffer instance');if(D>Fe||D<we)throw new RangeError('"value" argument is out of bounds');if(Z+ge>xe.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(D,Z,ge,Fe){if(D=+D,Z=Z>>>0,ge=ge>>>0,!Fe){const de=Math.pow(2,8*ge)-1;ce(this,D,Z,ge,de,0)}let we=1,Me=0;for(this[Z]=D&255;++Me<ge&&(we*=256);)this[Z+Me]=D/we&255;return Z+ge},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(D,Z,ge,Fe){if(D=+D,Z=Z>>>0,ge=ge>>>0,!Fe){const de=Math.pow(2,8*ge)-1;ce(this,D,Z,ge,de,0)}let we=ge-1,Me=1;for(this[Z+we]=D&255;--we>=0&&(Me*=256);)this[Z+we]=D/Me&255;return Z+ge},u.prototype.writeUint8=u.prototype.writeUInt8=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,1,255,0),this[Z]=D&255,Z+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,2,65535,0),this[Z]=D&255,this[Z+1]=D>>>8,Z+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,2,65535,0),this[Z]=D>>>8,this[Z+1]=D&255,Z+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,4,4294967295,0),this[Z+3]=D>>>24,this[Z+2]=D>>>16,this[Z+1]=D>>>8,this[Z]=D&255,Z+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,4,4294967295,0),this[Z]=D>>>24,this[Z+1]=D>>>16,this[Z+2]=D>>>8,this[Z+3]=D&255,Z+4};function Ie(xe,D,Z,ge,Fe){me(D,ge,Fe,xe,Z,7);let we=Number(D&BigInt(4294967295));xe[Z++]=we,we=we>>8,xe[Z++]=we,we=we>>8,xe[Z++]=we,we=we>>8,xe[Z++]=we;let Me=Number(D>>BigInt(32)&BigInt(4294967295));return xe[Z++]=Me,Me=Me>>8,xe[Z++]=Me,Me=Me>>8,xe[Z++]=Me,Me=Me>>8,xe[Z++]=Me,Z}function De(xe,D,Z,ge,Fe){me(D,ge,Fe,xe,Z,7);let we=Number(D&BigInt(4294967295));xe[Z+7]=we,we=we>>8,xe[Z+6]=we,we=we>>8,xe[Z+5]=we,we=we>>8,xe[Z+4]=we;let Me=Number(D>>BigInt(32)&BigInt(4294967295));return xe[Z+3]=Me,Me=Me>>8,xe[Z+2]=Me,Me=Me>>8,xe[Z+1]=Me,Me=Me>>8,xe[Z]=Me,Z+8}u.prototype.writeBigUInt64LE=Lt(function(D,Z=0){return Ie(this,D,Z,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Lt(function(D,Z=0){return De(this,D,Z,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(D,Z,ge,Fe){if(D=+D,Z=Z>>>0,!Fe){const vt=Math.pow(2,8*ge-1);ce(this,D,Z,ge,vt-1,-vt)}let we=0,Me=1,de=0;for(this[Z]=D&255;++we<ge&&(Me*=256);)D<0&&de===0&&this[Z+we-1]!==0&&(de=1),this[Z+we]=(D/Me>>0)-de&255;return Z+ge},u.prototype.writeIntBE=function(D,Z,ge,Fe){if(D=+D,Z=Z>>>0,!Fe){const vt=Math.pow(2,8*ge-1);ce(this,D,Z,ge,vt-1,-vt)}let we=ge-1,Me=1,de=0;for(this[Z+we]=D&255;--we>=0&&(Me*=256);)D<0&&de===0&&this[Z+we+1]!==0&&(de=1),this[Z+we]=(D/Me>>0)-de&255;return Z+ge},u.prototype.writeInt8=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,1,127,-128),D<0&&(D=255+D+1),this[Z]=D&255,Z+1},u.prototype.writeInt16LE=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,2,32767,-32768),this[Z]=D&255,this[Z+1]=D>>>8,Z+2},u.prototype.writeInt16BE=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,2,32767,-32768),this[Z]=D>>>8,this[Z+1]=D&255,Z+2},u.prototype.writeInt32LE=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,4,2147483647,-2147483648),this[Z]=D&255,this[Z+1]=D>>>8,this[Z+2]=D>>>16,this[Z+3]=D>>>24,Z+4},u.prototype.writeInt32BE=function(D,Z,ge){return D=+D,Z=Z>>>0,ge||ce(this,D,Z,4,2147483647,-2147483648),D<0&&(D=4294967295+D+1),this[Z]=D>>>24,this[Z+1]=D>>>16,this[Z+2]=D>>>8,this[Z+3]=D&255,Z+4},u.prototype.writeBigInt64LE=Lt(function(D,Z=0){return Ie(this,D,Z,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Lt(function(D,Z=0){return De(this,D,Z,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Se(xe,D,Z,ge,Fe,we){if(Z+ge>xe.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("Index out of range")}function Ce(xe,D,Z,ge,Fe){return D=+D,Z=Z>>>0,Fe||Se(xe,D,Z,4),n.write(xe,D,Z,ge,23,4),Z+4}u.prototype.writeFloatLE=function(D,Z,ge){return Ce(this,D,Z,!0,ge)},u.prototype.writeFloatBE=function(D,Z,ge){return Ce(this,D,Z,!1,ge)};function qe(xe,D,Z,ge,Fe){return D=+D,Z=Z>>>0,Fe||Se(xe,D,Z,8),n.write(xe,D,Z,ge,52,8),Z+8}u.prototype.writeDoubleLE=function(D,Z,ge){return qe(this,D,Z,!0,ge)},u.prototype.writeDoubleBE=function(D,Z,ge){return qe(this,D,Z,!1,ge)},u.prototype.copy=function(D,Z,ge,Fe){if(!u.isBuffer(D))throw new TypeError("argument should be a Buffer");if(ge||(ge=0),!Fe&&Fe!==0&&(Fe=this.length),Z>=D.length&&(Z=D.length),Z||(Z=0),Fe>0&&Fe<ge&&(Fe=ge),Fe===ge||D.length===0||this.length===0)return 0;if(Z<0)throw new RangeError("targetStart out of bounds");if(ge<0||ge>=this.length)throw new RangeError("Index out of range");if(Fe<0)throw new RangeError("sourceEnd out of bounds");Fe>this.length&&(Fe=this.length),D.length-Z<Fe-ge&&(Fe=D.length-Z+ge);const we=Fe-ge;return this===D&&typeof i.prototype.copyWithin=="function"?this.copyWithin(Z,ge,Fe):i.prototype.set.call(D,this.subarray(ge,Fe),Z),we},u.prototype.fill=function(D,Z,ge,Fe){if(typeof D=="string"){if(typeof Z=="string"?(Fe=Z,Z=0,ge=this.length):typeof ge=="string"&&(Fe=ge,ge=this.length),Fe!==void 0&&typeof Fe!="string")throw new TypeError("encoding must be a string");if(typeof Fe=="string"&&!u.isEncoding(Fe))throw new TypeError("Unknown encoding: "+Fe);if(D.length===1){const Me=D.charCodeAt(0);(Fe==="utf8"&&Me<128||Fe==="latin1")&&(D=Me)}}else typeof D=="number"?D=D&255:typeof D=="boolean"&&(D=Number(D));if(Z<0||this.length<Z||this.length<ge)throw new RangeError("Out of range index");if(ge<=Z)return this;Z=Z>>>0,ge=ge===void 0?this.length:ge>>>0,D||(D=0);let we;if(typeof D=="number")for(we=Z;we<ge;++we)this[we]=D;else{const Me=u.isBuffer(D)?D:u.from(D,Fe),de=Me.length;if(de===0)throw new TypeError('The value "'+D+'" is invalid for argument "value"');for(we=0;we<ge-Z;++we)this[we+Z]=Me[we%de]}return this};const Qe={};function Ve(xe,D,Z){Qe[xe]=class extends Z{constructor(){super(),Object.defineProperty(this,"message",{value:D.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${xe}]`,this.stack,delete this.name}get code(){return xe}set code(Fe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Fe,writable:!0})}toString(){return`${this.name} [${xe}]: ${this.message}`}}}Ve("ERR_BUFFER_OUT_OF_BOUNDS",function(xe){return xe?`${xe} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ve("ERR_INVALID_ARG_TYPE",function(xe,D){return`The "${xe}" argument must be of type number. Received type ${typeof D}`},TypeError),Ve("ERR_OUT_OF_RANGE",function(xe,D,Z){let ge=`The value of "${xe}" is out of range.`,Fe=Z;return Number.isInteger(Z)&&Math.abs(Z)>2**32?Fe=Ne(String(Z)):typeof Z=="bigint"&&(Fe=String(Z),(Z>BigInt(2)**BigInt(32)||Z<-(BigInt(2)**BigInt(32)))&&(Fe=Ne(Fe)),Fe+="n"),ge+=` It must be ${D}. Received ${Fe}`,ge},RangeError);function Ne(xe){let D="",Z=xe.length;const ge=xe[0]==="-"?1:0;for(;Z>=ge+4;Z-=3)D=`_${xe.slice(Z-3,Z)}${D}`;return`${xe.slice(0,Z)}${D}`}function K(xe,D,Z){Ae(D,"offset"),(xe[D]===void 0||xe[D+Z]===void 0)&&le(D,xe.length-(Z+1))}function me(xe,D,Z,ge,Fe,we){if(xe>Z||xe<D){const Me=typeof D=="bigint"?"n":"";let de;throw D===0||D===BigInt(0)?de=`>= 0${Me} and < 2${Me} ** ${(we+1)*8}${Me}`:de=`>= -(2${Me} ** ${(we+1)*8-1}${Me}) and < 2 ** ${(we+1)*8-1}${Me}`,new Qe.ERR_OUT_OF_RANGE("value",de,xe)}K(ge,Fe,we)}function Ae(xe,D){if(typeof xe!="number")throw new Qe.ERR_INVALID_ARG_TYPE(D,"number",xe)}function le(xe,D,Z){throw Math.floor(xe)!==xe?(Ae(xe,Z),new Qe.ERR_OUT_OF_RANGE("offset","an integer",xe)):D<0?new Qe.ERR_BUFFER_OUT_OF_BOUNDS:new Qe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${D}`,xe)}const oe=/[^+/0-9A-Za-z-_]/g;function re(xe){if(xe=xe.split("=")[0],xe=xe.trim().replace(oe,""),xe.length<2)return"";for(;xe.length%4!==0;)xe=xe+"=";return xe}function Te(xe,D){D=D||1/0;let Z;const ge=xe.length;let Fe=null;const we=[];for(let Me=0;Me<ge;++Me){if(Z=xe.charCodeAt(Me),Z>55295&&Z<57344){if(!Fe){if(Z>56319){(D-=3)>-1&&we.push(239,191,189);continue}else if(Me+1===ge){(D-=3)>-1&&we.push(239,191,189);continue}Fe=Z;continue}if(Z<56320){(D-=3)>-1&&we.push(239,191,189),Fe=Z;continue}Z=(Fe-55296<<10|Z-56320)+65536}else Fe&&(D-=3)>-1&&we.push(239,191,189);if(Fe=null,Z<128){if((D-=1)<0)break;we.push(Z)}else if(Z<2048){if((D-=2)<0)break;we.push(Z>>6|192,Z&63|128)}else if(Z<65536){if((D-=3)<0)break;we.push(Z>>12|224,Z>>6&63|128,Z&63|128)}else if(Z<1114112){if((D-=4)<0)break;we.push(Z>>18|240,Z>>12&63|128,Z>>6&63|128,Z&63|128)}else throw new Error("Invalid code point")}return we}function Be(xe){const D=[];for(let Z=0;Z<xe.length;++Z)D.push(xe.charCodeAt(Z)&255);return D}function ke(xe,D){let Z,ge,Fe;const we=[];for(let Me=0;Me<xe.length&&!((D-=2)<0);++Me)Z=xe.charCodeAt(Me),ge=Z>>8,Fe=Z%256,we.push(Fe),we.push(ge);return we}function lt(xe){return t.toByteArray(re(xe))}function Rt(xe,D,Z,ge){let Fe;for(Fe=0;Fe<ge&&!(Fe+Z>=D.length||Fe>=xe.length);++Fe)D[Fe+Z]=xe[Fe];return Fe}function ft(xe,D){return xe instanceof D||xe!=null&&xe.constructor!=null&&xe.constructor.name!=null&&xe.constructor.name===D.name}function jt(xe){return xe!==xe}const qt=function(){const xe="0123456789abcdef",D=new Array(256);for(let Z=0;Z<16;++Z){const ge=Z*16;for(let Fe=0;Fe<16;++Fe)D[ge+Fe]=xe[Z]+xe[Fe]}return D}();function Lt(xe){return typeof BigInt>"u"?en:xe}function en(){throw new Error("BigInt not supported")}})(LO);const on=LO.Buffer,Os=LO.Buffer;var Cp={exports:{}},jB;function aye(){if(jB)return Cp.exports;jB=1;const e=typeof on<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,c){c==null&&l!==null&&typeof l=="object"&&(c=l,l=void 0),e&&on.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const u=JSON.parse(o,l);if(u===null||typeof u!="object")return u;const d=c&&c.protoAction||"error",h=c&&c.constructorAction||"error";if(d==="ignore"&&h==="ignore")return u;if(d!=="ignore"&&h!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return u}else if(d!=="ignore"&&h==="ignore"){if(t.test(o)===!1)return u}else if(n.test(o)===!1)return u;return s(u,{protoAction:d,constructorAction:h,safe:c&&c.safe})}function s(o,{protoAction:l="error",constructorAction:c="error",safe:u}={}){let d=[o];for(;d.length;){const h=d;d=[];for(const m of h){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"__proto__")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.__proto__}if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"constructor")&&Object.prototype.hasOwnProperty.call(m.constructor,"prototype")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.constructor}for(const y in m){const b=m[y];b&&typeof b=="object"&&d.push(b)}}}return o}function i(o,l,c){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,c)}finally{Error.stackTraceLimit=u}}function a(o,l){const c=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=c}}return Cp.exports=i,Cp.exports.default=i,Cp.exports.parse=i,Cp.exports.safeParse=a,Cp.exports.scan=s,Cp.exports}var oye=aye();const $O=_a(oye);var lye={};function Us(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function cye(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function uye(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function sG(){let e="",t,n=[],r,s;function i(l,c){if(l===""){a(c);return}if(l.startsWith(":"))return;const u=l.indexOf(":");if(u===-1){o(l,"");return}const d=l.slice(0,u),h=u+1,m=h<l.length&&l[h]===" "?l.slice(h+1):l.slice(h);o(d,m)}function a(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:s}),n=[],t=void 0,s=void 0)}function o(l,c){switch(l){case"event":t=c;break;case"data":n.push(c);break;case"id":r=c;break;case"retry":const u=parseInt(c,10);isNaN(u)||(s=u);break}}return new TransformStream({transform(l,c){const{lines:u,incompleteLine:d}=dye(e,l);e=d;for(let h=0;h<u.length;h++)i(u[h],c)},flush(l){i(e,l),a(l)}})}function dye(e,t){const n=[];let r=e;for(let s=0;s<t.length;){const i=t[s++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[s]===`
`&&s++):r+=i}return{lines:n,incompleteLine:r}}function My(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Tm=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const s=X0e(n,t);if(e==null)return s;if(n.includes(r))throw new PH({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${s(i)}`},ra=Tm();function fye(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function hye(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function _2(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function zO({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new SS({message:`${r} API key must be a string.`});if(typeof Ai>"u")throw new SS({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=lye[t],e==null)throw new SS({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new SS({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var aC=Symbol.for("vercel.ai.validator");function pye(e){return{[aC]:!0,validate:e}}function mye(e){return typeof e=="object"&&e!==null&&aC in e&&e[aC]===!0&&"validate"in e}function gye(e){return mye(e)?e:yye(e)}function yye(e){return pye(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function bye({value:e,schema:t}){const n=Iy({value:e,schema:t});if(!n.success)throw iC.wrap({value:e,cause:n.error});return n.value}function Iy({value:e,schema:t}){const n=gye(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:iC.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:iC.wrap({value:e,cause:r})}}}function vye({text:e,schema:t}){try{const n=$O.parse(e);return t==null?n:bye({value:n,schema:t})}catch(n){throw sC.isInstance(n)||iC.isInstance(n)?n:new sC({text:e,cause:n})}}function cm({text:e,schema:t}){try{const n=$O.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=Iy({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:sC.isInstance(n)?n:new sC({text:e,cause:n})}}}function Jp(e){try{return $O.parse(e),!0}catch{return!1}}function yE({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=Iy({value:t[e],schema:n});if(!r.success)throw new PH({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var xye=()=>globalThis.fetch,qs=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>iG({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),wye=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>iG({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),iG=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:a=xye()})=>{try{const o=await a(e,{method:"POST",headers:hye(t),body:n.content,signal:i}),l=My(o);if(!o.ok){let c;try{c=await s({response:o,url:e,requestBodyValues:n.values})}catch(u){throw _2(u)||$l.isInstance(u)?u:new $l({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(_2(c)||$l.isInstance(c))?c:new $l({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(_2(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new $l({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function J3(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var Fh=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{const a=await r.text(),o=My(r);if(a.trim()==="")return{responseHeaders:o,value:new $l({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=vye({text:a,schema:e});return{responseHeaders:o,value:new $l({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new $l({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},Lh=e=>async({response:t})=>{const n=My(t);if(t.body==null)throw new MH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(sG()).pipeThrough(new TransformStream({transform({data:r},s){r!=="[DONE]"&&s.enqueue(cm({text:r,schema:e}))}}))}},$a=e=>async({response:t,url:n,requestBodyValues:r})=>{const s=await t.text(),i=cm({text:s,schema:e}),a=My(t);if(!i.success)throw new $l({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:a,value:i.value,rawValue:i.rawValue}},_ye=()=>async({response:e,url:t,requestBodyValues:n})=>{const r=My(e);if(!e.body)throw new $l({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const s=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(s)}}catch(s){throw new $l({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:s})}},{btoa:Sye,atob:Cye}=globalThis;function bE(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=Cye(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function Su(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return Sye(t)}function o1(e){return e==null?void 0:e.replace(/\/$/,"")}var Qr;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return e.objectValues(a)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},e.find=(s,i)=>{for(const a of s)if(i(a))return a},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Qr||(Qr={}));var OB;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(OB||(OB={}));const gn=Qr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),th=e=>{switch(typeof e){case"undefined":return gn.undefined;case"string":return gn.string;case"number":return Number.isNaN(e)?gn.nan:gn.number;case"boolean":return gn.boolean;case"function":return gn.function;case"bigint":return gn.bigint;case"symbol":return gn.symbol;case"object":return Array.isArray(e)?gn.array:e===null?gn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?gn.promise:typeof Map<"u"&&e instanceof Map?gn.map:typeof Set<"u"&&e instanceof Set?gn.set:typeof Date<"u"&&e instanceof Date?gn.date:gn.object;default:return gn.unknown}},Zt=Qr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Cu extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return s(this),r}static assert(t){if(!(t instanceof Cu))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Qr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Cu.create=e=>new Cu(e);const Q3=(e,t)=>{let n;switch(e.code){case Zt.invalid_type:e.received===gn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Zt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Qr.jsonStringifyReplacer)}`;break;case Zt.unrecognized_keys:n=`Unrecognized key(s) in object: ${Qr.joinValues(e.keys,", ")}`;break;case Zt.invalid_union:n="Invalid input";break;case Zt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Qr.joinValues(e.options)}`;break;case Zt.invalid_enum_value:n=`Invalid enum value. Expected ${Qr.joinValues(e.options)}, received '${e.received}'`;break;case Zt.invalid_arguments:n="Invalid function arguments";break;case Zt.invalid_return_type:n="Invalid function return type";break;case Zt.invalid_date:n="Invalid date";break;case Zt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Qr.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Zt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Zt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Zt.custom:n="Invalid input";break;case Zt.invalid_intersection_types:n="Intersection results could not be merged";break;case Zt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Zt.not_finite:n="Number must be finite";break;default:n=t.defaultError,Qr.assertNever(e)}return{message:n}};let kye=Q3;function Eye(){return kye}const Tye=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function fn(e,t){const n=Eye(),r=Tye({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Q3?void 0:Q3].filter(s=>!!s)});e.common.issues.push(r)}class so{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return cr;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return so.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return cr;i.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:t.value,value:r}}}const cr=Object.freeze({status:"aborted"}),Gv=e=>({status:"dirty",value:e}),Gl=e=>({status:"valid",value:e}),PB=e=>e.status==="aborted",DB=e=>e.status==="dirty",H0=e=>e.status==="valid",oC=e=>typeof Promise<"u"&&e instanceof Promise;var En;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(En||(En={}));class ku{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const FB=(e,t)=>{if(H0(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Cu(e.common.issues);return this._error=n,this._error}}};function Tr(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(a,o)=>{const{message:l}=e;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Ur{get description(){return this._def.description}_getType(t){return th(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:th(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new so,ctx:{common:t.parent.common,data:t.data,parsedType:th(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(oC(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:th(t)},s=this._parseSync({data:t,path:r.path,parent:r});return FB(r,s)}"~validate"(t){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:th(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:n});return H0(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(i=>H0(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:th(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(oC(s)?s:Promise.resolve(s));return FB(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=t(s),o=()=>i.addIssue({code:Zt.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new fm({schema:this,typeName:Qt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return gu.create(this,this._def)}nullable(){return hm.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return mu.create(this)}promise(){return mC.create(this,this._def)}or(t){return uC.create([this,t],this._def)}and(t){return dC.create(this,t,this._def)}transform(t){return new fm({...Tr(this._def),schema:this,typeName:Qt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new gC({...Tr(this._def),innerType:this,defaultValue:n,typeName:Qt.ZodDefault})}brand(){return new cG({typeName:Qt.ZodBranded,type:this,...Tr(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new yC({...Tr(this._def),innerType:this,catchValue:n,typeName:Qt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return qO.create(this,t)}readonly(){return bC.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Aye=/^c[^\s-]{8,}$/i,Rye=/^[0-9a-z]+$/,Nye=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Mye=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Iye=/^[a-z0-9_-]{21}$/i,jye=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Oye=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Pye=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Dye="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let hN;const Fye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Lye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Bye=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,$ye=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,zye=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Uye=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,aG="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",qye=new RegExp(`^${aG}$`);function oG(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Vye(e){return new RegExp(`^${oG(e)}$`)}function Wye(e){let t=`${aG}T${oG(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Hye(e,t){return!!((t==="v4"||!t)&&Fye.test(e)||(t==="v6"||!t)&&Bye.test(e))}function Gye(e,t){if(!jye.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function Kye(e,t){return!!((t==="v4"||!t)&&Lye.test(e)||(t==="v6"||!t)&&$ye.test(e))}class _d extends Ur{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==gn.string){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_type,expected:gn.string,received:i.parsedType}),cr}const r=new so;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=t.data.length>i.value,o=t.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(t,s),a?fn(s,{code:Zt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&fn(s,{code:Zt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Pye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"email",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")hN||(hN=new RegExp(Dye,"u")),hN.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"emoji",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Mye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"uuid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Iye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"nanoid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Aye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cuid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Rye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cuid2",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Nye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"ulid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),fn(s,{validation:"url",code:Zt.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"regex",code:Zt.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Wye(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?qye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?Vye(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Oye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"duration",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?Hye(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"ip",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?Gye(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"jwt",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?Kye(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cidr",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?zye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"base64",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Uye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"base64url",code:Zt.invalid_string,message:i.message}),r.dirty()):Qr.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:Zt.invalid_string,...En.errToObj(r)})}_addCheck(t){return new _d({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...En.errToObj(t)})}url(t){return this._addCheck({kind:"url",...En.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...En.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...En.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...En.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...En.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...En.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...En.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...En.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...En.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...En.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...En.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...En.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...En.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...En.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...En.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...En.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...En.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...En.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...En.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...En.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...En.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...En.errToObj(n)})}nonempty(t){return this.min(1,En.errToObj(t))}trim(){return new _d({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new _d({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new _d({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}_d.create=e=>new _d({checks:[],typeName:Qt.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Tr(e)});function Yye(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(e.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return i%a/10**s}class G0 extends Ur{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==gn.number){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_type,expected:gn.number,received:i.parsedType}),cr}let r;const s=new so;for(const i of this._def.checks)i.kind==="int"?Qr.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Yye(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.not_finite,message:i.message}),s.dirty()):Qr.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,En.toString(n))}gt(t,n){return this.setLimit("min",t,!1,En.toString(n))}lte(t,n){return this.setLimit("max",t,!0,En.toString(n))}lt(t,n){return this.setLimit("max",t,!1,En.toString(n))}setLimit(t,n,r,s){return new G0({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:En.toString(s)}]})}_addCheck(t){return new G0({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:En.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:En.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:En.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:En.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:En.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:En.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:En.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:En.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:En.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Qr.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}G0.create=e=>new G0({checks:[],typeName:Qt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Tr(e)});class Ux extends Ur{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==gn.bigint)return this._getInvalidInput(t);let r;const s=new so;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Qr.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return fn(n,{code:Zt.invalid_type,expected:gn.bigint,received:n.parsedType}),cr}gte(t,n){return this.setLimit("min",t,!0,En.toString(n))}gt(t,n){return this.setLimit("min",t,!1,En.toString(n))}lte(t,n){return this.setLimit("max",t,!0,En.toString(n))}lt(t,n){return this.setLimit("max",t,!1,En.toString(n))}setLimit(t,n,r,s){return new Ux({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:En.toString(s)}]})}_addCheck(t){return new Ux({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:En.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:En.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:En.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:En.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:En.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Ux.create=e=>new Ux({checks:[],typeName:Qt.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Tr(e)});class ej extends Ur{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==gn.boolean){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.boolean,received:r.parsedType}),cr}return Gl(t.data)}}ej.create=e=>new ej({typeName:Qt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Tr(e)});class lC extends Ur{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==gn.date){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_type,expected:gn.date,received:i.parsedType}),cr}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_date}),cr}const r=new so;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Qr.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new lC({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:En.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:En.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}lC.create=e=>new lC({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Qt.ZodDate,...Tr(e)});class LB extends Ur{_parse(t){if(this._getType(t)!==gn.symbol){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.symbol,received:r.parsedType}),cr}return Gl(t.data)}}LB.create=e=>new LB({typeName:Qt.ZodSymbol,...Tr(e)});class tj extends Ur{_parse(t){if(this._getType(t)!==gn.undefined){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.undefined,received:r.parsedType}),cr}return Gl(t.data)}}tj.create=e=>new tj({typeName:Qt.ZodUndefined,...Tr(e)});class cC extends Ur{_parse(t){if(this._getType(t)!==gn.null){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.null,received:r.parsedType}),cr}return Gl(t.data)}}cC.create=e=>new cC({typeName:Qt.ZodNull,...Tr(e)});class qx extends Ur{constructor(){super(...arguments),this._any=!0}_parse(t){return Gl(t.data)}}qx.create=e=>new qx({typeName:Qt.ZodAny,...Tr(e)});class nj extends Ur{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Gl(t.data)}}nj.create=e=>new nj({typeName:Qt.ZodUnknown,...Tr(e)});class ph extends Ur{_parse(t){const n=this._getOrReturnCtx(t);return fn(n,{code:Zt.invalid_type,expected:gn.never,received:n.parsedType}),cr}}ph.create=e=>new ph({typeName:Qt.ZodNever,...Tr(e)});class BB extends Ur{_parse(t){if(this._getType(t)!==gn.undefined){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.void,received:r.parsedType}),cr}return Gl(t.data)}}BB.create=e=>new BB({typeName:Qt.ZodVoid,...Tr(e)});class mu extends Ur{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==gn.array)return fn(n,{code:Zt.invalid_type,expected:gn.array,received:n.parsedType}),cr;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(fn(n,{code:a?Zt.too_big:Zt.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(fn(n,{code:Zt.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(fn(n,{code:Zt.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new ku(n,a,n.path,o)))).then(a=>so.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new ku(n,a,n.path,o)));return so.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new mu({...this._def,minLength:{value:t,message:En.toString(n)}})}max(t,n){return new mu({...this._def,maxLength:{value:t,message:En.toString(n)}})}length(t,n){return new mu({...this._def,exactLength:{value:t,message:En.toString(n)}})}nonempty(t){return this.min(1,t)}}mu.create=(e,t)=>new mu({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Qt.ZodArray,...Tr(t)});function s0(e){if(e instanceof Ei){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=gu.create(s0(r))}return new Ei({...e._def,shape:()=>t})}else return e instanceof mu?new mu({...e._def,type:s0(e.element)}):e instanceof gu?gu.create(s0(e.unwrap())):e instanceof hm?hm.create(s0(e.unwrap())):e instanceof um?um.create(e.items.map(t=>s0(t))):e}class Ei extends Ur{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Qr.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==gn.object){const c=this._getOrReturnCtx(t);return fn(c,{code:Zt.invalid_type,expected:gn.object,received:c.parsedType}),cr}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof ph&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=i[c],d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new ku(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof ph){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")o.length>0&&(fn(s,{code:Zt.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new ku(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>so.mergeObjectSync(r,c)):so.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return En.errToObj,new Ei({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var i,a;const s=((a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:En.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Ei({...this._def,unknownKeys:"strip"})}passthrough(){return new Ei({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ei({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ei({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Qt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Ei({...this._def,catchall:t})}pick(t){const n={};for(const r of Qr.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Ei({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Qr.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Ei({...this._def,shape:()=>n})}deepPartial(){return s0(this)}partial(t){const n={};for(const r of Qr.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new Ei({...this._def,shape:()=>n})}required(t){const n={};for(const r of Qr.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof gu;)i=i._def.innerType;n[r]=i}return new Ei({...this._def,shape:()=>n})}keyof(){return lG(Qr.objectKeys(this.shape))}}Ei.create=(e,t)=>new Ei({shape:()=>e,unknownKeys:"strip",catchall:ph.create(),typeName:Qt.ZodObject,...Tr(t)});Ei.strictCreate=(e,t)=>new Ei({shape:()=>e,unknownKeys:"strict",catchall:ph.create(),typeName:Qt.ZodObject,...Tr(t)});Ei.lazycreate=(e,t)=>new Ei({shape:e,unknownKeys:"strip",catchall:ph.create(),typeName:Qt.ZodObject,...Tr(t)});class uC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Cu(o.ctx.common.issues));return fn(n,{code:Zt.invalid_union,unionErrors:a}),cr}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new Cu(l));return fn(n,{code:Zt.invalid_union,unionErrors:o}),cr}}get options(){return this._def.options}}uC.create=(e,t)=>new uC({options:e,typeName:Qt.ZodUnion,...Tr(t)});const pd=e=>e instanceof hC?pd(e.schema):e instanceof fm?pd(e.innerType()):e instanceof pC?[e.value]:e instanceof dm?e.options:e instanceof sj?Qr.objectValues(e.enum):e instanceof gC?pd(e._def.innerType):e instanceof tj?[void 0]:e instanceof cC?[null]:e instanceof gu?[void 0,...pd(e.unwrap())]:e instanceof hm?[null,...pd(e.unwrap())]:e instanceof cG||e instanceof bC?pd(e.unwrap()):e instanceof yC?pd(e._def.innerType):[];class UO extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==gn.object)return fn(n,{code:Zt.invalid_type,expected:gn.object,received:n.parsedType}),cr;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(fn(n,{code:Zt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),cr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const i of n){const a=pd(i.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new UO({typeName:Qt.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Tr(r)})}}function rj(e,t){const n=th(e),r=th(t);if(e===t)return{valid:!0,data:e};if(n===gn.object&&r===gn.object){const s=Qr.objectKeys(t),i=Qr.objectKeys(e).filter(o=>s.indexOf(o)!==-1),a={...e,...t};for(const o of i){const l=rj(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===gn.array&&r===gn.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const a=e[i],o=t[i],l=rj(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===gn.date&&r===gn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class dC extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,a)=>{if(PB(i)||PB(a))return cr;const o=rj(i.value,a.value);return o.valid?((DB(i)||DB(a))&&n.dirty(),{status:n.value,value:o.data}):(fn(r,{code:Zt.invalid_intersection_types}),cr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}dC.create=(e,t,n)=>new dC({left:e,right:t,typeName:Qt.ZodIntersection,...Tr(n)});class um extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==gn.array)return fn(r,{code:Zt.invalid_type,expected:gn.array,received:r.parsedType}),cr;if(r.data.length<this._def.items.length)return fn(r,{code:Zt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),cr;!this._def.rest&&r.data.length>this._def.items.length&&(fn(r,{code:Zt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new ku(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>so.mergeArray(n,a)):so.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new um({...this._def,rest:t})}}um.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new um({items:e,typeName:Qt.ZodTuple,rest:null,...Tr(t)})};class fC extends Ur{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==gn.object)return fn(r,{code:Zt.invalid_type,expected:gn.object,received:r.parsedType}),cr;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new ku(r,o,r.path,o)),value:a._parse(new ku(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?so.mergeObjectAsync(n,s):so.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Ur?new fC({keyType:t,valueType:n,typeName:Qt.ZodRecord,...Tr(r)}):new fC({keyType:_d.create(),valueType:t,typeName:Qt.ZodRecord,...Tr(n)})}}class $B extends Ur{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==gn.map)return fn(r,{code:Zt.invalid_type,expected:gn.map,received:r.parsedType}),cr;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:s._parse(new ku(r,o,r.path,[c,"key"])),value:i._parse(new ku(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return cr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return cr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}$B.create=(e,t,n)=>new $B({valueType:t,keyType:e,typeName:Qt.ZodMap,...Tr(n)});class Vx extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==gn.set)return fn(r,{code:Zt.invalid_type,expected:gn.set,received:r.parsedType}),cr;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(fn(r,{code:Zt.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(fn(r,{code:Zt.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return cr;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>i._parse(new ku(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,n){return new Vx({...this._def,minSize:{value:t,message:En.toString(n)}})}max(t,n){return new Vx({...this._def,maxSize:{value:t,message:En.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Vx.create=(e,t)=>new Vx({valueType:e,minSize:null,maxSize:null,typeName:Qt.ZodSet,...Tr(t)});class hC extends Ur{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}hC.create=(e,t)=>new hC({getter:e,typeName:Qt.ZodLazy,...Tr(t)});class pC extends Ur{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return fn(n,{received:n.data,code:Zt.invalid_literal,expected:this._def.value}),cr}return{status:"valid",value:t.data}}get value(){return this._def.value}}pC.create=(e,t)=>new pC({value:e,typeName:Qt.ZodLiteral,...Tr(t)});function lG(e,t){return new dm({values:e,typeName:Qt.ZodEnum,...Tr(t)})}class dm extends Ur{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return fn(n,{expected:Qr.joinValues(r),received:n.parsedType,code:Zt.invalid_type}),cr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return fn(n,{received:n.data,code:Zt.invalid_enum_value,options:r}),cr}return Gl(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return dm.create(t,{...this._def,...n})}exclude(t,n=this._def){return dm.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}dm.create=lG;class sj extends Ur{_parse(t){const n=Qr.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==gn.string&&r.parsedType!==gn.number){const s=Qr.objectValues(n);return fn(r,{expected:Qr.joinValues(s),received:r.parsedType,code:Zt.invalid_type}),cr}if(this._cache||(this._cache=new Set(Qr.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=Qr.objectValues(n);return fn(r,{received:r.data,code:Zt.invalid_enum_value,options:s}),cr}return Gl(t.data)}get enum(){return this._def.values}}sj.create=(e,t)=>new sj({values:e,typeName:Qt.ZodNativeEnum,...Tr(t)});class mC extends Ur{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==gn.promise&&n.common.async===!1)return fn(n,{code:Zt.invalid_type,expected:gn.promise,received:n.parsedType}),cr;const r=n.parsedType===gn.promise?n.data:Promise.resolve(n.data);return Gl(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}mC.create=(e,t)=>new mC({type:e,typeName:Qt.ZodPromise,...Tr(t)});class fm extends Ur{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Qt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:a=>{fn(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return cr;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?cr:l.status==="dirty"||n.value==="dirty"?Gv(l.value):l});{if(n.value==="aborted")return cr;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?cr:o.status==="dirty"||n.value==="dirty"?Gv(o.value):o}}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?cr:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?cr:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!H0(a))return cr;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>H0(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):cr);Qr.assertNever(s)}}fm.create=(e,t,n)=>new fm({schema:e,typeName:Qt.ZodEffects,effect:t,...Tr(n)});fm.createWithPreprocess=(e,t,n)=>new fm({schema:t,effect:{type:"preprocess",transform:e},typeName:Qt.ZodEffects,...Tr(n)});class gu extends Ur{_parse(t){return this._getType(t)===gn.undefined?Gl(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}gu.create=(e,t)=>new gu({innerType:e,typeName:Qt.ZodOptional,...Tr(t)});class hm extends Ur{_parse(t){return this._getType(t)===gn.null?Gl(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}hm.create=(e,t)=>new hm({innerType:e,typeName:Qt.ZodNullable,...Tr(t)});class gC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===gn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}gC.create=(e,t)=>new gC({innerType:e,typeName:Qt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Tr(t)});class yC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return oC(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Cu(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Cu(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}yC.create=(e,t)=>new yC({innerType:e,typeName:Qt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Tr(t)});class zB extends Ur{_parse(t){if(this._getType(t)!==gn.nan){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.nan,received:r.parsedType}),cr}return{status:"valid",value:t.data}}}zB.create=e=>new zB({typeName:Qt.ZodNaN,...Tr(e)});class cG extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class qO extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?cr:i.status==="dirty"?(n.dirty(),Gv(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?cr:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new qO({in:t,out:n,typeName:Qt.ZodPipeline})}}class bC extends Ur{_parse(t){const n=this._def.innerType._parse(t),r=s=>(H0(s)&&(s.value=Object.freeze(s.value)),s);return oC(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}bC.create=(e,t)=>new bC({innerType:e,typeName:Qt.ZodReadonly,...Tr(t)});function UB(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function uG(e,t={},n){return e?qx.create().superRefine((r,s)=>{const i=e(r);if(i instanceof Promise)return i.then(a=>{if(!a){const o=UB(t,r),l=o.fatal??n??!0;s.addIssue({code:"custom",...o,fatal:l})}});if(!i){const a=UB(t,r),o=a.fatal??n??!0;s.addIssue({code:"custom",...a,fatal:o})}}):qx.create()}var Qt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Qt||(Qt={}));const vC=(e,t={message:`Input not instance of ${e.name}`})=>uG(n=>n instanceof e,t),$e=_d.create,Tt=G0.create,br=ej.create,Zye=cC.create,mh=qx.create,jy=nj.create;ph.create;const ln=mu.create,Ke=Ei.create,hs=uC.create,vE=UO.create;dC.create;um.create;const gh=fC.create,Xye=hC.create,An=pC.create,hl=dm.create;mC.create;const ta=gu.create;hm.create;function Jye({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],s=[];for(const{role:i,content:a}of e)switch(i){case"system":{switch(n){case"system":{r.push({role:"system",content:a});break}case"developer":{r.push({role:"developer",content:a});break}case"remove":{s.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(a.length===1&&a[0].type==="text"){r.push({role:"user",content:a[0].text});break}r.push({role:"user",content:a.map((o,l)=>{var c,u,d,h;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(c=o.mimeType)!=null?c:"image/jpeg"};base64,${Su(o.image)}`,detail:(d=(u=o.providerMetadata)==null?void 0:u.openai)==null?void 0:d.imageDetail}};case"file":{if(o.data instanceof URL)throw new hr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(h=o.filename)!=null?h:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new hr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const c of a)switch(c.type){case"text":{o+=c.text;break}case"tool-call":{l.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.args)}});break}}if(t){if(l.length>1)throw new hr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of a)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:s}}function qB(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function xC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var VO=Ke({error:Ke({message:$e(),type:$e().nullish(),param:mh().nullish(),code:hs([$e(),Tt()]).nullish()})}),Eu=Fh({errorSchema:VO,errorToMessage:e=>e.error.message});function wC({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function Qye({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const s=(r=e.tools)!=null&&r.length?e.tools:void 0,i=[];if(s==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const a=e.toolChoice;if(t){const c=[];for(const d of s)d.type==="provider-defined"?i.push({type:"unsupported-tool",tool:d}):c.push({name:d.name,description:d.description,parameters:d.parameters});if(a==null)return{functions:c,function_call:void 0,toolWarnings:i};switch(a.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:i};case"required":throw new hr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:a.toolName},toolWarnings:i}}}const o=[];for(const c of s)c.type==="provider-defined"?i.push({type:"unsupported-tool",tool:c}):o.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:n?!0:void 0}});if(a==null)return{tools:o,tool_choice:void 0,toolWarnings:i};const l=a.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:i};default:{const c=l;throw new hr({functionality:`Unsupported tool choice type: ${c}`})}}}var ebe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:ij(this.modelId)}get defaultObjectGenerationMode(){return rbe(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y,b,v,x,w,S;const C=e.type,k=[];i!=null&&k.push({type:"unsupported-setting",setting:"topK"}),(c==null?void 0:c.type)==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&k.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const A=this.settings.useLegacyFunctionCalling;if(A&&this.settings.parallelToolCalls===!0)throw new hr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(A&&this.supportsStructuredOutputs)throw new hr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:R,warnings:N}=Jye({prompt:t,useLegacyFunctionCalling:A,systemMessageMode:sbe(this.modelId)});k.push(...N);const I={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(c==null?void 0:c.type)==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(h=c.name)!=null?h:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(m=d==null?void 0:d.openai)==null?void 0:m.maxCompletionTokens,store:(y=d==null?void 0:d.openai)==null?void 0:y.store,metadata:(b=d==null?void 0:d.openai)==null?void 0:b.metadata,prediction:(v=d==null?void 0:d.openai)==null?void 0:v.prediction,reasoning_effort:(w=(x=d==null?void 0:d.openai)==null?void 0:x.reasoningEffort)!=null?w:this.settings.reasoningEffort,messages:R};switch(ij(this.modelId)?(I.temperature!=null&&(I.temperature=void 0,k.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),I.top_p!=null&&(I.top_p=void 0,k.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),I.frequency_penalty!=null&&(I.frequency_penalty=void 0,k.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),I.presence_penalty!=null&&(I.presence_penalty=void 0,k.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),I.logit_bias!=null&&(I.logit_bias=void 0,k.push({type:"other",message:"logitBias is not supported for reasoning models"})),I.logprobs!=null&&(I.logprobs=void 0,k.push({type:"other",message:"logprobs is not supported for reasoning models"})),I.top_logprobs!=null&&(I.top_logprobs=void 0,k.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),I.max_tokens!=null&&(I.max_completion_tokens==null&&(I.max_completion_tokens=I.max_tokens),I.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&I.temperature!=null&&(I.temperature=void 0,k.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),C){case"regular":{const{tools:O,tool_choice:L,functions:P,function_call:V,toolWarnings:F}=Qye({mode:e,useLegacyFunctionCalling:A,structuredOutputs:this.supportsStructuredOutputs});return{args:{...I,tools:O,tool_choice:L,functions:P,function_call:V},warnings:[...k,...F]}}case"object-json":return{args:{...I,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(S=e.name)!=null?S:"response",description:e.description}}:{type:"json_object"}},warnings:k};case"object-tool":return{args:A?{...I,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...I,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:k};default:{const O=C;throw new Error(`Unsupported type: ${O}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l;const{args:c,warnings:u}=this.getArgs(e),{responseHeaders:d,value:h,rawValue:m}=await qs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:c,failedResponseHandler:Eu,successfulResponseHandler:$a(tbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:y,...b}=c,v=h.choices[0],x=(t=h.usage)==null?void 0:t.completion_tokens_details,w=(n=h.usage)==null?void 0:n.prompt_tokens_details,S={openai:{}};return(x==null?void 0:x.reasoning_tokens)!=null&&(S.openai.reasoningTokens=x==null?void 0:x.reasoning_tokens),(x==null?void 0:x.accepted_prediction_tokens)!=null&&(S.openai.acceptedPredictionTokens=x==null?void 0:x.accepted_prediction_tokens),(x==null?void 0:x.rejected_prediction_tokens)!=null&&(S.openai.rejectedPredictionTokens=x==null?void 0:x.rejected_prediction_tokens),(w==null?void 0:w.cached_tokens)!=null&&(S.openai.cachedPromptTokens=w==null?void 0:w.cached_tokens),{text:(r=v.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&v.message.function_call?[{toolCallType:"function",toolCallId:ra(),toolName:v.message.function_call.name,args:v.message.function_call.arguments}]:(s=v.message.tool_calls)==null?void 0:s.map(C=>{var k;return{toolCallType:"function",toolCallId:(k=C.id)!=null?k:ra(),toolName:C.function.name,args:C.function.arguments}}),finishReason:xC(v.finish_reason),usage:{promptTokens:(a=(i=h.usage)==null?void 0:i.prompt_tokens)!=null?a:NaN,completionTokens:(l=(o=h.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d,body:m},request:{body:JSON.stringify(c)},response:wC(h),warnings:u,logprobs:qB(v.logprobs),providerMetadata:S}}async doStream(e){if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.args}),x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await qs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:r,failedResponseHandler:Eu,successfulResponseHandler:Lh(nbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=t,l=[];let c="unknown",u={promptTokens:void 0,completionTokens:void 0},d,h=!0;const{useLegacyFunctionCalling:m}=this.settings,y={openai:{}};return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,C,k,A,R,N,I,O,L,P;if(!b.success){c="error",v.enqueue({type:"error",error:b.error});return}const V=b.value;if("error"in V){c="error",v.enqueue({type:"error",error:V.error});return}if(h&&(h=!1,v.enqueue({type:"response-metadata",...wC(V)})),V.usage!=null){const{prompt_tokens:$,completion_tokens:ne,prompt_tokens_details:W,completion_tokens_details:Q}=V.usage;u={promptTokens:$??void 0,completionTokens:ne??void 0},(Q==null?void 0:Q.reasoning_tokens)!=null&&(y.openai.reasoningTokens=Q==null?void 0:Q.reasoning_tokens),(Q==null?void 0:Q.accepted_prediction_tokens)!=null&&(y.openai.acceptedPredictionTokens=Q==null?void 0:Q.accepted_prediction_tokens),(Q==null?void 0:Q.rejected_prediction_tokens)!=null&&(y.openai.rejectedPredictionTokens=Q==null?void 0:Q.rejected_prediction_tokens),(W==null?void 0:W.cached_tokens)!=null&&(y.openai.cachedPromptTokens=W==null?void 0:W.cached_tokens)}const F=V.choices[0];if((F==null?void 0:F.finish_reason)!=null&&(c=xC(F.finish_reason)),(F==null?void 0:F.delta)==null)return;const X=F.delta;X.content!=null&&v.enqueue({type:"text-delta",textDelta:X.content});const U=qB(F==null?void 0:F.logprobs);U!=null&&U.length&&(d===void 0&&(d=[]),d.push(...U));const H=m&&X.function_call!=null?[{type:"function",id:ra(),function:X.function_call,index:0}]:X.tool_calls;if(H!=null)for(const $ of H){const ne=$.index;if(l[ne]==null){if($.type!=="function")throw new Td({data:$,message:"Expected 'function' type."});if($.id==null)throw new Td({data:$,message:"Expected 'id' to be a string."});if(((x=$.function)==null?void 0:x.name)==null)throw new Td({data:$,message:"Expected 'function.name' to be a string."});l[ne]={id:$.id,type:"function",function:{name:$.function.name,arguments:(w=$.function.arguments)!=null?w:""},hasFinished:!1};const Q=l[ne];((S=Q.function)==null?void 0:S.name)!=null&&((C=Q.function)==null?void 0:C.arguments)!=null&&(Q.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:Q.function.arguments}),Jp(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(k=Q.id)!=null?k:ra(),toolName:Q.function.name,args:Q.function.arguments}),Q.hasFinished=!0));continue}const W=l[ne];W.hasFinished||(((A=$.function)==null?void 0:A.arguments)!=null&&(W.function.arguments+=(N=(R=$.function)==null?void 0:R.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:W.id,toolName:W.function.name,argsTextDelta:(I=$.function.arguments)!=null?I:""}),((O=W.function)==null?void 0:O.name)!=null&&((L=W.function)==null?void 0:L.arguments)!=null&&Jp(W.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=W.id)!=null?P:ra(),toolName:W.function.name,args:W.function.arguments}),W.hasFinished=!0))}},flush(b){var v,x;b.enqueue({type:"finish",finishReason:c,logprobs:d,usage:{promptTokens:(v=u.promptTokens)!=null?v:NaN,completionTokens:(x=u.completionTokens)!=null?x:NaN},...y!=null?{providerMetadata:y}:{}})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(r)},warnings:n}}},dG=Ke({prompt_tokens:Tt().nullish(),completion_tokens:Tt().nullish(),prompt_tokens_details:Ke({cached_tokens:Tt().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:Tt().nullish(),accepted_prediction_tokens:Tt().nullish(),rejected_prediction_tokens:Tt().nullish()}).nullish()}).nullish(),tbe=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:ln(Ke({message:Ke({role:An("assistant").nullish(),content:$e().nullish(),function_call:Ke({arguments:$e(),name:$e()}).nullish(),tool_calls:ln(Ke({id:$e().nullish(),type:An("function"),function:Ke({name:$e(),arguments:$e()})})).nullish()}),index:Tt(),logprobs:Ke({content:ln(Ke({token:$e(),logprob:Tt(),top_logprobs:ln(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullish()})),usage:dG}),nbe=hs([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:ln(Ke({delta:Ke({role:hl(["assistant"]).nullish(),content:$e().nullish(),function_call:Ke({name:$e().optional(),arguments:$e().optional()}).nullish(),tool_calls:ln(Ke({index:Tt(),id:$e().nullish(),type:An("function").nullish(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:ln(Ke({token:$e(),logprob:Tt(),top_logprobs:ln(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullish(),index:Tt()})),usage:dG}),VO]);function ij(e){return e.startsWith("o")}function rbe(e){return e.startsWith("gpt-4o-audio-preview")}function sbe(e){var t,n;return ij(e)?(n=(t=ibe[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var ibe={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function abe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new uc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new hr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new hr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new hr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}function VB(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,s])=>({token:r,logprob:s})):[]}))}var obe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d}){var h;const m=e.type,y=[];a!=null&&y.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:b,stopSequences:v}=abe({prompt:n,inputFormat:t}),x=[...v??[],...c??[]],w={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,prompt:b,stop:x.length>0?x:void 0};switch(m){case"regular":{if((h=e.tools)!=null&&h.length)throw new hr({functionality:"tools"});if(e.toolChoice)throw new hr({functionality:"toolChoice"});return{args:w,warnings:y}}case"object-json":throw new hr({functionality:"object-json mode"});case"object-tool":throw new hr({functionality:"object-tool mode"});default:{const S=m;throw new Error(`Unsupported type: ${S}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s,rawValue:i}=await qs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:t,failedResponseHandler:Eu,successfulResponseHandler:$a(lbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t,l=s.choices[0];return{text:l.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:xC(l.finish_reason),logprobs:VB(l.logprobs),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:r,body:i},response:wC(s),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await qs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:r,failedResponseHandler:Eu,successfulResponseHandler:Lh(cbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,d=!0;return{stream:i.pipeThrough(new TransformStream({transform(h,m){if(!h.success){l="error",m.enqueue({type:"error",error:h.error});return}const y=h.value;if("error"in y){l="error",m.enqueue({type:"error",error:y.error});return}d&&(d=!1,m.enqueue({type:"response-metadata",...wC(y)})),y.usage!=null&&(c={promptTokens:y.usage.prompt_tokens,completionTokens:y.usage.completion_tokens});const b=y.choices[0];(b==null?void 0:b.finish_reason)!=null&&(l=xC(b.finish_reason)),(b==null?void 0:b.text)!=null&&m.enqueue({type:"text-delta",textDelta:b.text});const v=VB(b==null?void 0:b.logprobs);v!=null&&v.length&&(u===void 0&&(u=[]),u.push(...v))},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},lbe=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:ln(Ke({text:$e(),finish_reason:$e(),logprobs:Ke({tokens:ln($e()),token_logprobs:ln(Tt()),top_logprobs:ln(gh($e(),Tt())).nullable()}).nullish()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()})}),cbe=hs([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:ln(Ke({text:$e(),finish_reason:$e().nullish(),index:Tt(),logprobs:Ke({tokens:ln($e()),token_logprobs:ln(Tt()),top_logprobs:ln(gh($e(),Tt())).nullable()}).nullish()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),VO]),ube=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new mE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:s}=await qs({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Us(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Eu,successfulResponseHandler:$a(dbe),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},dbe=Ke({data:ln(Ke({embedding:ln(Tt())})),usage:Ke({prompt_tokens:Tt()}).nullish()}),fbe={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},hbe=new Set(["gpt-image-1"]),pbe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:fbe[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d;const h=[];r!=null&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&h.push({type:"unsupported-setting",setting:"seed"});const m=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:y,responseHeaders:b}=await qs({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Us(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},...hbe.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:Eu,successfulResponseHandler:$a(mbe),abortSignal:o,fetch:this.config.fetch});return{images:y.data.map(v=>v.b64_json),warnings:h,response:{timestamp:m,modelId:this.modelId,headers:b}}}},mbe=Ke({data:ln(Ke({b64_json:$e()}))}),gbe=Ke({include:ln($e()).nullish(),language:$e().nullish(),prompt:$e().nullish(),temperature:Tt().min(0).max(1).nullish().default(0),timestampGranularities:ln(hl(["word","segment"])).nullish().default(["segment"])}),WB={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},ybe=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,s,i,a,o;const l=[],c=yE({provider:"openai",providerOptions:n,schema:gbe}),u=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([bE(e)]);if(u.append("model",this.modelId),u.append("file",new File([d],"audio",{type:t})),c){const h={include:(r=c.include)!=null?r:void 0,language:(s=c.language)!=null?s:void 0,prompt:(i=c.prompt)!=null?i:void 0,temperature:(a=c.temperature)!=null?a:void 0,timestamp_granularities:(o=c.timestampGranularities)!=null?o:void 0};for(const m in h){const y=h[m];y!==void 0&&u.append(m,String(y))}}return{formData:u,warnings:l}}async doGenerate(e){var t,n,r,s,i,a;const o=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{formData:l,warnings:c}=this.getArgs(e),{value:u,responseHeaders:d,rawValue:h}=await wye({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),formData:l,failedResponseHandler:Eu,successfulResponseHandler:$a(bbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u.language!=null&&u.language in WB?WB[u.language]:void 0;return{text:u.text,segments:(i=(s=u.words)==null?void 0:s.map(y=>({text:y.word,startSecond:y.start,endSecond:y.end})))!=null?i:[],language:m,durationInSeconds:(a=u.duration)!=null?a:void 0,warnings:c,response:{timestamp:o,modelId:this.modelId,headers:d,body:h}}}},bbe=Ke({text:$e(),language:$e().nullish(),duration:Tt().nullish(),words:ln(Ke({word:$e(),start:Tt(),end:Tt()})).nullish()});function vbe({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:s,content:i}of e)switch(s){case"system":{switch(t){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case"user":{n.push({role:"user",content:i.map((a,o)=>{var l,c,u,d;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image":return{type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(l=a.mimeType)!=null?l:"image/jpeg"};base64,${Su(a.image)}`,detail:(u=(c=a.providerMetadata)==null?void 0:c.openai)==null?void 0:u.imageDetail};case"file":{if(a.data instanceof URL)throw new hr({functionality:"File URLs in user messages"});switch(a.mimeType){case"application/pdf":return{type:"input_file",filename:(d=a.filename)!=null?d:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new hr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const a of i)switch(a.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case"tool":{for(const a of i)n.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{const a=s;throw new Error(`Unsupported role: ${a}`)}}return{messages:n,warnings:r}}function HB({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function xbe({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)switch(l.type){case"function":a.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:s.push({type:"unsupported-tool",tool:l});break}break;default:s.push({type:"unsupported-tool",tool:l});break}if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return i.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:s}:{tools:a,tool_choice:{type:"function",name:i.toolName},toolWarnings:s};default:{const l=o;throw new hr({functionality:`Unsupported tool choice type: ${l}`})}}}var wbe=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:s,topK:i,presencePenalty:a,frequencyPenalty:o,seed:l,prompt:c,providerMetadata:u,responseFormat:d}){var h,m,y;const b=[],v=Bbe(this.modelId),x=e.type;i!=null&&b.push({type:"unsupported-setting",setting:"topK"}),l!=null&&b.push({type:"unsupported-setting",setting:"seed"}),a!=null&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&b.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:w,warnings:S}=vbe({prompt:c,systemMessageMode:v.systemMessageMode});b.push(...S);const C=yE({provider:"openai",providerOptions:u,schema:$be}),k=(h=C==null?void 0:C.strictSchemas)!=null?h:!0,A={model:this.modelId,input:w,temperature:n,top_p:s,max_output_tokens:t,...(d==null?void 0:d.type)==="json"&&{text:{format:d.schema!=null?{type:"json_schema",strict:k,name:(m=d.name)!=null?m:"response",description:d.description,schema:d.schema}:{type:"json_object"}}},metadata:C==null?void 0:C.metadata,parallel_tool_calls:C==null?void 0:C.parallelToolCalls,previous_response_id:C==null?void 0:C.previousResponseId,store:C==null?void 0:C.store,user:C==null?void 0:C.user,instructions:C==null?void 0:C.instructions,...v.isReasoningModel&&((C==null?void 0:C.reasoningEffort)!=null||(C==null?void 0:C.reasoningSummary)!=null)&&{reasoning:{...(C==null?void 0:C.reasoningEffort)!=null&&{effort:C.reasoningEffort},...(C==null?void 0:C.reasoningSummary)!=null&&{summary:C.reasoningSummary}}},...v.requiredAutoTruncation&&{truncation:"auto"}};switch(v.isReasoningModel&&(A.temperature!=null&&(A.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),A.top_p!=null&&(A.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),x){case"regular":{const{tools:R,tool_choice:N,toolWarnings:I}=xbe({mode:e,strict:k});return{args:{...A,tools:R,tool_choice:N},warnings:[...b,...I]}}case"object-json":return{args:{...A,text:{format:e.schema!=null?{type:"json_schema",strict:k,name:(y=e.name)!=null?y:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...A,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:k}]},warnings:b};default:{const R=x;throw new Error(`Unsupported type: ${R}`)}}}async doGenerate(e){var t,n,r,s,i,a,o;const{args:l,warnings:c}=this.getArgs(e),{responseHeaders:u,value:d,rawValue:h}=await qs({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:l,failedResponseHandler:Eu,successfulResponseHandler:$a(Ke({id:$e(),created_at:Tt(),model:$e(),output:ln(vE("type",[Ke({type:An("message"),role:An("assistant"),content:ln(Ke({type:An("output_text"),text:$e(),annotations:ln(Ke({type:An("url_citation"),start_index:Tt(),end_index:Tt(),url:$e(),title:$e()}))}))}),Ke({type:An("function_call"),call_id:$e(),name:$e(),arguments:$e()}),Ke({type:An("web_search_call")}),Ke({type:An("computer_call")}),Ke({type:An("reasoning"),summary:ln(Ke({type:An("summary_text"),text:$e()}))})])),incomplete_details:Ke({reason:$e()}).nullable(),usage:fG})),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=d.output.filter(v=>v.type==="message").flatMap(v=>v.content).filter(v=>v.type==="output_text"),y=d.output.filter(v=>v.type==="function_call").map(v=>({toolCallType:"function",toolCallId:v.call_id,toolName:v.name,args:v.arguments})),b=(n=(t=d.output.find(v=>v.type==="reasoning"))==null?void 0:t.summary)!=null?n:null;return{text:m.map(v=>v.text).join(`
`),sources:m.flatMap(v=>v.annotations.map(x=>{var w,S,C;return{sourceType:"url",id:(C=(S=(w=this.config).generateId)==null?void 0:S.call(w))!=null?C:ra(),url:x.url,title:x.title}})),finishReason:HB({finishReason:(r=d.incomplete_details)==null?void 0:r.reason,hasToolCalls:y.length>0}),toolCalls:y.length>0?y:void 0,reasoning:b?b.map(v=>({type:"text",text:v.text})):void 0,usage:{promptTokens:d.usage.input_tokens,completionTokens:d.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:h},request:{body:JSON.stringify(l)},response:{id:d.id,timestamp:new Date(d.created_at*1e3),modelId:d.model},providerMetadata:{openai:{responseId:d.id,cachedPromptTokens:(i=(s=d.usage.input_tokens_details)==null?void 0:s.cached_tokens)!=null?i:null,reasoningTokens:(o=(a=d.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?o:null}},warnings:c}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s}=await qs({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:Eu,successfulResponseHandler:Lh(Nbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this;let a="unknown",o=NaN,l=NaN,c=null,u=null,d=null;const h={};let m=!1;return{stream:s.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,C,k,A,R;if(!y.success){a="error",b.enqueue({type:"error",error:y.error});return}const N=y.value;if(Dbe(N))N.item.type==="function_call"&&(h[N.output_index]={toolName:N.item.name,toolCallId:N.item.call_id},b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,argsTextDelta:N.item.arguments}));else if(Pbe(N)){const I=h[N.output_index];I!=null&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:I.toolCallId,toolName:I.toolName,argsTextDelta:N.delta})}else Obe(N)?(d=N.response.id,b.enqueue({type:"response-metadata",id:N.response.id,timestamp:new Date(N.response.created_at*1e3),modelId:N.response.model})):Mbe(N)?b.enqueue({type:"text-delta",textDelta:N.delta}):Lbe(N)?b.enqueue({type:"reasoning",textDelta:N.delta}):Ibe(N)&&N.item.type==="function_call"?(h[N.output_index]=void 0,m=!0,b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,args:N.item.arguments})):jbe(N)?(a=HB({finishReason:(v=N.response.incomplete_details)==null?void 0:v.reason,hasToolCalls:m}),o=N.response.usage.input_tokens,l=N.response.usage.output_tokens,c=(w=(x=N.response.usage.input_tokens_details)==null?void 0:x.cached_tokens)!=null?w:c,u=(C=(S=N.response.usage.output_tokens_details)==null?void 0:S.reasoning_tokens)!=null?C:u):Fbe(N)&&b.enqueue({type:"source",source:{sourceType:"url",id:(R=(A=(k=i.config).generateId)==null?void 0:A.call(k))!=null?R:ra(),url:N.annotation.url,title:N.annotation.title}})},flush(y){y.enqueue({type:"finish",finishReason:a,usage:{promptTokens:o,completionTokens:l},...(c!=null||u!=null)&&{providerMetadata:{openai:{responseId:d,cachedPromptTokens:c,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},fG=Ke({input_tokens:Tt(),input_tokens_details:Ke({cached_tokens:Tt().nullish()}).nullish(),output_tokens:Tt(),output_tokens_details:Ke({reasoning_tokens:Tt().nullish()}).nullish()}),_be=Ke({type:An("response.output_text.delta"),delta:$e()}),Sbe=Ke({type:hl(["response.completed","response.incomplete"]),response:Ke({incomplete_details:Ke({reason:$e()}).nullish(),usage:fG})}),Cbe=Ke({type:An("response.created"),response:Ke({id:$e(),created_at:Tt(),model:$e()})}),kbe=Ke({type:An("response.output_item.done"),output_index:Tt(),item:vE("type",[Ke({type:An("message")}),Ke({type:An("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e(),status:An("completed")})])}),Ebe=Ke({type:An("response.function_call_arguments.delta"),item_id:$e(),output_index:Tt(),delta:$e()}),Tbe=Ke({type:An("response.output_item.added"),output_index:Tt(),item:vE("type",[Ke({type:An("message")}),Ke({type:An("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e()})])}),Abe=Ke({type:An("response.output_text.annotation.added"),annotation:Ke({type:An("url_citation"),url:$e(),title:$e()})}),Rbe=Ke({type:An("response.reasoning_summary_text.delta"),item_id:$e(),output_index:Tt(),summary_index:Tt(),delta:$e()}),Nbe=hs([_be,Sbe,Cbe,kbe,Ebe,Tbe,Abe,Rbe,Ke({type:$e()}).passthrough()]);function Mbe(e){return e.type==="response.output_text.delta"}function Ibe(e){return e.type==="response.output_item.done"}function jbe(e){return e.type==="response.completed"||e.type==="response.incomplete"}function Obe(e){return e.type==="response.created"}function Pbe(e){return e.type==="response.function_call_arguments.delta"}function Dbe(e){return e.type==="response.output_item.added"}function Fbe(e){return e.type==="response.output_text.annotation.added"}function Lbe(e){return e.type==="response.reasoning_summary_text.delta"}function Bbe(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var $be=Ke({metadata:mh().nullish(),parallelToolCalls:br().nullish(),previousResponseId:$e().nullish(),store:br().nullish(),user:$e().nullish(),reasoningEffort:$e().nullish(),strictSchemas:br().nullish(),instructions:$e().nullish(),reasoningSummary:$e().nullish()}),zbe=Ke({});function Ube({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:zbe}}var qbe={webSearchPreview:Ube},Vbe=Ke({instructions:$e().nullish(),speed:Tt().min(.25).max(4).default(1).nullish()}),Wbe=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:s,providerOptions:i}){const a=[],o=yE({provider:"openai",providerOptions:i,schema:Vbe}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:s};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){const c={};for(const u in c){const d=c[u];d!==void 0&&(l[u]=d)}}return{requestBody:l,warnings:a}}async doGenerate(e){var t,n,r;const s=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{requestBody:i,warnings:a}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:c}=await qs({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:i,failedResponseHandler:Eu,successfulResponseHandler:_ye(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:a,request:{body:JSON.stringify(i)},response:{timestamp:s,modelId:this.modelId,headers:l,body:c}}}};function hG(e={}){var t,n,r;const s=(t=o1(e.baseURL))!=null?t:"https://api.openai.com/v1",i=(n=e.compatibility)!=null?n:"compatible",a=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${zO({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(x,w={})=>new ebe(x,w,{provider:`${a}.chat`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),c=(x,w={})=>new obe(x,w,{provider:`${a}.completion`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),u=(x,w={})=>new ube(x,w,{provider:`${a}.embedding`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),d=(x,w={})=>new pbe(x,w,{provider:`${a}.image`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),h=x=>new ybe(x,{provider:`${a}.transcription`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),m=x=>new Wbe(x,{provider:`${a}.speech`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),y=(x,w)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return x==="gpt-3.5-turbo-instruct"?c(x,w):l(x,w)},b=x=>new wbe(x,{provider:`${a}.responses`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),v=function(x,w){return y(x,w)};return v.languageModel=y,v.chat=l,v.completion=c,v.responses=b,v.embedding=u,v.textEmbedding=u,v.textEmbeddingModel=u,v.image=d,v.imageModel=d,v.transcription=h,v.transcriptionModel=h,v.speech=m,v.speechModel=m,v.tools=qbe,v}hG({compatibility:"strict"});function Dl(e){if(Hbe(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:s,items:i,allOf:a,anyOf:o,oneOf:l,format:c,const:u,minLength:d,enum:h}=e,m={};if(n&&(m.description=n),r&&(m.required=r),c&&(m.format=c),u!==void 0&&(m.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(m.type=t.filter(y=>y!=="null")[0],m.nullable=!0):m.type=t:t==="null"?m.type="null":m.type=t),h!==void 0&&(m.enum=h),s!=null&&(m.properties=Object.entries(s).reduce((y,[b,v])=>(y[b]=Dl(v),y),{})),i&&(m.items=Array.isArray(i)?i.map(Dl):Dl(i)),a&&(m.allOf=a.map(Dl)),o)if(o.some(y=>typeof y=="object"&&(y==null?void 0:y.type)==="null")){const y=o.filter(b=>!(typeof b=="object"&&(b==null?void 0:b.type)==="null"));if(y.length===1){const b=Dl(y[0]);typeof b=="object"&&(m.nullable=!0,Object.assign(m,b))}else m.anyOf=y.map(Dl),m.nullable=!0}else m.anyOf=o.map(Dl);return l&&(m.oneOf=l.map(Dl)),d!==void 0&&(m.minLength=d),m}function Hbe(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function Gbe(e){var t,n;const r=[],s=[];let i=!0;for(const{role:a,content:o}of e)switch(a){case"system":{if(!i)throw new hr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{i=!1;const l=[];for(const c of o)switch(c.type){case"text":{l.push({text:c.text});break}case"image":{l.push(c.image instanceof URL?{fileData:{mimeType:(t=c.mimeType)!=null?t:"image/jpeg",fileUri:c.image.toString()}}:{inlineData:{mimeType:(n=c.mimeType)!=null?n:"image/jpeg",data:Su(c.image)}});break}case"file":{l.push(c.data instanceof URL?{fileData:{mimeType:c.mimeType,fileUri:c.data.toString()}}:{inlineData:{mimeType:c.mimeType,data:c.data}});break}}s.push({role:"user",parts:l});break}case"assistant":{i=!1,s.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new hr({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new hr({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{i=!1,s.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:s}}function GB(e){return e.includes("/")?e:`models/${e}`}var Kbe=Ke({error:Ke({code:Tt().nullable(),message:$e(),status:$e()})}),aj=Fh({errorSchema:Kbe,errorToMessage:e=>e.error.message});function Ybe(e,t,n,r){var s,i;const a=(s=e.tools)!=null&&s.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),c=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!c||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(a==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const u=[];for(const m of a)m.type==="provider-defined"?o.push({type:"unsupported-tool",tool:m}):u.push({name:m.name,description:(i=m.description)!=null?i:"",parameters:Dl(m.parameters)});const d=e.toolChoice;if(d==null)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:o};const h=d.type;switch(h){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[d.toolName]}},toolWarnings:o};default:{const m=h;throw new hr({functionality:`Unsupported tool choice type: ${m}`})}}}function KB({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var Zbe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y;const b=e.type,v=[],x=yE({provider:"google",providerOptions:d,schema:eve});((h=x==null?void 0:x.thinkingConfig)==null?void 0:h.includeThoughts)===!0&&!this.config.provider.startsWith("google.vertex.")&&v.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});const w={maxOutputTokens:n,temperature:r,topK:i,topP:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,seed:u,responseMimeType:(c==null?void 0:c.type)==="json"?"application/json":void 0,responseSchema:(c==null?void 0:c.type)==="json"&&c.schema!=null&&this.supportsStructuredOutputs?Dl(c.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:x==null?void 0:x.responseModalities,thinkingConfig:x==null?void 0:x.thinkingConfig},{contents:S,systemInstruction:C}=Gbe(t);switch(b){case"regular":{const{tools:k,toolConfig:A,toolWarnings:R}=Ybe(e,(m=this.settings.useSearchGrounding)!=null?m:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:w,contents:S,systemInstruction:C,safetySettings:this.settings.safetySettings,tools:k,toolConfig:A,cachedContent:this.settings.cachedContent},warnings:[...v,...R]}}case"object-json":return{args:{generationConfig:{...w,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?Dl(e.schema):void 0},contents:S,systemInstruction:C,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};case"object-tool":return{args:{generationConfig:w,contents:S,tools:{functionDeclarations:[{name:e.tool.name,description:(y=e.tool.description)!=null?y:"",parameters:Dl(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};default:{const k=b;throw new Error(`Unsupported type: ${k}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,s,i;const{args:a,warnings:o}=await this.getArgs(e),l=JSON.stringify(a),c=Us(await J3(this.config.headers),e.headers),{responseHeaders:u,value:d,rawValue:h}=await qs({url:`${this.config.baseURL}/${GB(this.modelId)}:generateContent`,headers:c,body:a,failedResponseHandler:aj,successfulResponseHandler:$a(Jbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:m,...y}=a,b=d.candidates[0],v=b.content==null||typeof b.content!="object"||!("parts"in b.content)?[]:b.content.parts,x=YB({parts:v,generateId:this.config.generateId}),w=d.usageMetadata;return{text:ZB(v),reasoning:XB(v),files:(t=JB(v))==null?void 0:t.map(S=>({data:S.inlineData.data,mimeType:S.inlineData.mimeType})),toolCalls:x,finishReason:KB({finishReason:b.finishReason,hasToolCalls:x!=null&&x.length>0}),usage:{promptTokens:(n=w==null?void 0:w.promptTokenCount)!=null?n:NaN,completionTokens:(r=w==null?void 0:w.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:m,rawSettings:y},rawResponse:{headers:u,body:h},warnings:o,providerMetadata:{google:{groundingMetadata:(s=b.groundingMetadata)!=null?s:null,safetyRatings:(i=b.safetyRatings)!=null?i:null}},sources:QB({groundingMetadata:b.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),s=Us(await J3(this.config.headers),e.headers),{responseHeaders:i,value:a}=await qs({url:`${this.config.baseURL}/${GB(this.modelId)}:streamGenerateContent?alt=sse`,headers:s,body:t,failedResponseHandler:aj,successfulResponseHandler:Lh(Qbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let c="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d;const h=this.config.generateId;let m=!1;return{stream:a.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,C,k;if(!y.success){b.enqueue({type:"error",error:y.error});return}const A=y.value,R=A.usageMetadata;R!=null&&(u={promptTokens:(v=R.promptTokenCount)!=null?v:NaN,completionTokens:(x=R.candidatesTokenCount)!=null?x:NaN});const N=(w=A.candidates)==null?void 0:w[0];if(N==null)return;const I=N.content;if(I!=null){const O=ZB(I.parts);O!=null&&b.enqueue({type:"text-delta",textDelta:O});const L=XB(I.parts);if(L!=null)for(const F of L)b.enqueue({type:"reasoning",textDelta:F.text});const P=JB(I.parts);if(P!=null)for(const F of P)b.enqueue({type:"file",mimeType:F.inlineData.mimeType,data:F.inlineData.data});const V=YB({parts:I.parts,generateId:h});if(V!=null)for(const F of V)b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:F.toolCallId,toolName:F.toolName,argsTextDelta:F.args}),b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:F.toolCallId,toolName:F.toolName,args:F.args}),m=!0}if(N.finishReason!=null){c=KB({finishReason:N.finishReason,hasToolCalls:m});const O=(S=QB({groundingMetadata:N.groundingMetadata,generateId:h}))!=null?S:[];for(const L of O)b.enqueue({type:"source",source:L});d={google:{groundingMetadata:(C=N.groundingMetadata)!=null?C:null,safetyRatings:(k=N.safetyRatings)!=null?k:null}}}},flush(y){y.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:d})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:n,request:{body:r}}}};function YB({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function ZB(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought!==!0);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function XB(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought===!0&&n.text!=null);return t==null||t.length===0?void 0:t.map(n=>({type:"text",text:n.text}))}function JB(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function QB({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var pG=Ke({parts:ln(hs([Ke({functionCall:Ke({name:$e(),args:jy()})}),Ke({inlineData:Ke({mimeType:$e(),data:$e()})}),Ke({text:$e().nullish(),thought:br().nullish()})])).nullish()}),Xbe=Ke({web:Ke({uri:$e(),title:$e()}).nullish(),retrievedContext:Ke({uri:$e(),title:$e()}).nullish()}),mG=Ke({webSearchQueries:ln($e()).nullish(),retrievalQueries:ln($e()).nullish(),searchEntryPoint:Ke({renderedContent:$e()}).nullish(),groundingChunks:ln(Xbe).nullish(),groundingSupports:ln(Ke({segment:Ke({startIndex:Tt().nullish(),endIndex:Tt().nullish(),text:$e().nullish()}),segment_text:$e().nullish(),groundingChunkIndices:ln(Tt()).nullish(),supportChunkIndices:ln(Tt()).nullish(),confidenceScores:ln(Tt()).nullish(),confidenceScore:ln(Tt()).nullish()})).nullish(),retrievalMetadata:hs([Ke({webDynamicRetrievalScore:Tt()}),Ke({})]).nullish()}),gG=Ke({category:$e().nullish(),probability:$e().nullish(),probabilityScore:Tt().nullish(),severity:$e().nullish(),severityScore:Tt().nullish(),blocked:br().nullish()}),Jbe=Ke({candidates:ln(Ke({content:pG.nullish().or(Ke({}).strict()),finishReason:$e().nullish(),safetyRatings:ln(gG).nullish(),groundingMetadata:mG.nullish()})),usageMetadata:Ke({promptTokenCount:Tt().nullish(),candidatesTokenCount:Tt().nullish(),totalTokenCount:Tt().nullish()}).nullish()}),Qbe=Ke({candidates:ln(Ke({content:pG.nullish(),finishReason:$e().nullish(),safetyRatings:ln(gG).nullish(),groundingMetadata:mG.nullish()})).nullish(),usageMetadata:Ke({promptTokenCount:Tt().nullish(),candidatesTokenCount:Tt().nullish(),totalTokenCount:Tt().nullish()}).nullish()}),eve=Ke({responseModalities:ln(hl(["TEXT","IMAGE"])).nullish(),thinkingConfig:Ke({thinkingBudget:Tt().nullish(),includeThoughts:br().nullish()}).nullish()}),tve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new mE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=Us(await J3(this.config.headers),t),{responseHeaders:s,value:i}=await qs({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:aj,successfulResponseHandler:$a(nve),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.embeddings.map(a=>a.values),usage:void 0,rawResponse:{headers:s}}}},nve=Ke({embeddings:ln(Ke({values:ln(Tt())}))});function rve(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function yG(e={}){var t;const n=(t=o1(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":zO({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),s=(o,l={})=>{var c;return new Zbe(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(c=e.generateId)!=null?c:ra,isSupportedUrl:rve,fetch:e.fetch})},i=(o,l={})=>new tve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),a=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return s(o,l)};return a.languageModel=s,a.chat=s,a.generativeAI=s,a.embedding=i,a.textEmbedding=i,a.textEmbeddingModel=i,a}yG();var sve=Object.defineProperty,ive=Object.defineProperties,ave=Object.getOwnPropertyDescriptors,_C=Object.getOwnPropertySymbols,bG=Object.prototype.hasOwnProperty,vG=Object.prototype.propertyIsEnumerable,e$=(e,t,n)=>t in e?sve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Na=(e,t)=>{for(var n in t||(t={}))bG.call(t,n)&&e$(e,n,t[n]);if(_C)for(var n of _C(t))vG.call(t,n)&&e$(e,n,t[n]);return e},S2=(e,t)=>ive(e,ave(t)),SC=(e,t)=>{var n={};for(var r in e)bG.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&_C)for(var r of _C(e))t.indexOf(r)<0&&vG.call(e,r)&&(n[r]=e[r]);return n},ove=Ke({type:An("reasoning.summary"),summary:$e()}),lve=Ke({type:An("reasoning.encrypted"),data:$e()}),cve=Ke({type:An("reasoning.text"),text:$e().nullish(),signature:$e().nullish()}),uve=hs([ove,lve,cve]),dve=hs([uve,jy().transform(()=>null)]),WO=ln(dve).transform(e=>e.filter(t=>!!t));function Gf(e){var t,n,r;const s=e==null?void 0:e.anthropic,i=e==null?void 0:e.openrouter;return(r=(n=(t=i==null?void 0:i.cacheControl)!=null?t:i==null?void 0:i.cache_control)!=null?n:s==null?void 0:s.cacheControl)!=null?r:s==null?void 0:s.cache_control}function fve(e){var t,n,r;const s=[];for(const{role:i,content:a,providerMetadata:o}of e)switch(i){case"system":{s.push({role:"system",content:a,cache_control:Gf(o)});break}case"user":{if(a.length===1&&((t=a[0])==null?void 0:t.type)==="text"){s.push({role:"user",content:a[0].text,cache_control:(n=Gf(o))!=null?n:Gf(a[0].providerMetadata)});break}const l=Gf(o),c=a.map(u=>{var d,h,m,y;const b=(d=Gf(u.providerMetadata))!=null?d:l;switch(u.type){case"text":return{type:"text",text:u.text,cache_control:b};case"image":return{type:"image_url",image_url:{url:u.image instanceof URL?u.image.toString():`data:${(h=u.mimeType)!=null?h:"image/jpeg"};base64,${Su(u.image)}`},cache_control:b};case"file":return{type:"file",file:{filename:String((y=(m=u.providerMetadata)==null?void 0:m.openrouter)==null?void 0:y.filename),file_data:u.data instanceof Uint8Array?`data:${u.mimeType};base64,${Su(u.data)}`:`data:${u.mimeType};base64,${u.data}`},cache_control:b};default:{const v=u;throw new Error(`Unsupported content part type: ${v}`)}}});s.push({role:"user",content:c});break}case"assistant":{let l="",c="";const u=[],d=[];for(const h of a)switch(h.type){case"text":{l+=h.text;break}case"tool-call":{d.push({id:h.toolCallId,type:"function",function:{name:h.toolName,arguments:JSON.stringify(h.args)}});break}case"reasoning":{c+=h.text,u.push({type:"reasoning.text",text:h.text,signature:h.signature});break}case"redacted-reasoning":{u.push({type:"reasoning.encrypted",data:h.data});break}case"file":break;default:{const m=h;throw new Error(`Unsupported part: ${m}`)}}s.push({role:"assistant",content:l,tool_calls:d.length>0?d:void 0,reasoning:c||void 0,reasoning_details:u.length>0?u:void 0,cache_control:Gf(o)});break}case"tool":{for(const l of a)s.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=Gf(o))!=null?r:Gf(l.providerMetadata)});break}default:{const l=i;throw new Error(`Unsupported role: ${l}`)}}return s}function t$(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function CC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var HO=Ke({error:Ke({code:hs([$e(),Tt()]).nullable(),message:$e(),type:$e().nullable(),param:mh().nullable()})}),kC=Fh({errorSchema:HO,errorToMessage:e=>e.error.message});function hve(e){return"parameters"in e}var pve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,frequencyPenalty:i,presencePenalty:a,seed:o,stopSequences:l,responseFormat:c,topK:u,providerMetadata:d}){var h;const m=e.type,y=(h=d==null?void 0:d.openrouter)!=null?h:{},b=Na(Na(Na({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:a,seed:o,stop:l,response_format:c,top_k:u,messages:fve(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning,usage:this.settings.usage},this.config.extraBody),this.settings.extraBody),y);switch(m){case"regular":return Na(Na({},b),yve(e));case"object-json":return S2(Na({},b),{response_format:{type:"json_object"}});case"object-tool":return S2(Na({},b),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const v=m;throw new hr({functionality:`${v} mode`})}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c;const u=this.getArgs(e),{responseHeaders:d,value:h}=await qs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:u,failedResponseHandler:kC,successfulResponseHandler:$a(mve),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u,{messages:y}=m,b=SC(m,["messages"]),v=h.choices[0];if(!v)throw new Error("No choice in response");const x=h.usage?{promptTokens:(t=h.usage.prompt_tokens)!=null?t:0,completionTokens:(n=h.usage.completion_tokens)!=null?n:0}:{promptTokens:0,completionTokens:0},w={};h.usage&&((r=this.settings.usage)!=null&&r.include)&&(w.openrouter={usage:{promptTokens:h.usage.prompt_tokens,promptTokensDetails:h.usage.prompt_tokens_details?{cachedTokens:(s=h.usage.prompt_tokens_details.cached_tokens)!=null?s:0}:void 0,completionTokens:h.usage.completion_tokens,completionTokensDetails:h.usage.completion_tokens_details?{reasoningTokens:(i=h.usage.completion_tokens_details.reasoning_tokens)!=null?i:0}:void 0,cost:h.usage.cost,totalTokens:(a=h.usage.total_tokens)!=null?a:0}});const S=Object.keys(w).length>0,C=(o=v.message.reasoning_details)!=null?o:[],k=C.length>0?C.map(A=>{var R;switch(A.type){case"reasoning.text":{if(A.text)return{type:"text",text:A.text,signature:(R=A.signature)!=null?R:void 0};break}case"reasoning.summary":{if(A.summary)return{type:"text",text:A.summary};break}case"reasoning.encrypted":{if(A.data)return{type:"redacted",data:A.data};break}}return null}).filter(A=>A!==null):v.message.reasoning?[{type:"text",text:v.message.reasoning}]:[];return Na({response:{id:h.id,modelId:h.model},text:(l=v.message.content)!=null?l:void 0,reasoning:k,toolCalls:(c=v.message.tool_calls)==null?void 0:c.map(A=>{var R;return{toolCallType:"function",toolCallId:(R=A.id)!=null?R:ra(),toolName:A.function.name,args:A.function.arguments}}),finishReason:CC(v.finish_reason),usage:x,rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d},warnings:[],logprobs:t$(v.logprobs)},S?{providerMetadata:w}:{})}async doStream(e){var t,n;const r=this.getArgs(e),{responseHeaders:s,value:i}=await qs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:S2(Na({},r),{stream:!0,stream_options:this.config.compatibility==="strict"?Na({include_usage:!0},(t=this.settings.usage)!=null&&t.include?{include_usage:!0}:{}):void 0}),failedResponseHandler:kC,successfulResponseHandler:Lh(gve),abortSignal:e.abortSignal,fetch:this.config.fetch}),a=r,{messages:o}=a,l=SC(a,["messages"]),c=[];let u="other",d={promptTokens:Number.NaN,completionTokens:Number.NaN},h;const m={},y=!!((n=this.settings.usage)!=null&&n.include);return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,C,k,A,R,N,I,O,L,P,V,F;if(!b.success){u="error",v.enqueue({type:"error",error:b.error});return}const X=b.value;if("error"in X){u="error",v.enqueue({type:"error",error:X.error});return}X.id&&v.enqueue({type:"response-metadata",id:X.id}),X.model&&v.enqueue({type:"response-metadata",modelId:X.model}),X.usage!=null&&(d={promptTokens:X.usage.prompt_tokens,completionTokens:X.usage.completion_tokens},m.promptTokens=X.usage.prompt_tokens,X.usage.prompt_tokens_details&&(m.promptTokensDetails={cachedTokens:(x=X.usage.prompt_tokens_details.cached_tokens)!=null?x:0}),m.completionTokens=X.usage.completion_tokens,X.usage.completion_tokens_details&&(m.completionTokensDetails={reasoningTokens:(w=X.usage.completion_tokens_details.reasoning_tokens)!=null?w:0}),m.cost=X.usage.cost,m.totalTokens=X.usage.total_tokens);const U=X.choices[0];if((U==null?void 0:U.finish_reason)!=null&&(u=CC(U.finish_reason)),(U==null?void 0:U.delta)==null)return;const H=U.delta;if(H.content!=null&&v.enqueue({type:"text-delta",textDelta:H.content}),H.reasoning!=null&&v.enqueue({type:"reasoning",textDelta:H.reasoning}),H.reasoning_details&&H.reasoning_details.length>0)for(const ne of H.reasoning_details)switch(ne.type){case"reasoning.text":{ne.text&&v.enqueue({type:"reasoning",textDelta:ne.text}),ne.signature&&v.enqueue({type:"reasoning-signature",signature:ne.signature});break}case"reasoning.encrypted":{ne.data&&v.enqueue({type:"redacted-reasoning",data:ne.data});break}case"reasoning.summary":{ne.summary&&v.enqueue({type:"reasoning",textDelta:ne.summary});break}}const $=t$(U==null?void 0:U.logprobs);if($!=null&&$.length&&(h===void 0&&(h=[]),h.push(...$)),H.tool_calls!=null)for(const ne of H.tool_calls){const W=ne.index;if(c[W]==null){if(ne.type!=="function")throw new Td({data:ne,message:"Expected 'function' type."});if(ne.id==null)throw new Td({data:ne,message:"Expected 'id' to be a string."});if(((S=ne.function)==null?void 0:S.name)==null)throw new Td({data:ne,message:"Expected 'function.name' to be a string."});c[W]={id:ne.id,type:"function",function:{name:ne.function.name,arguments:(C=ne.function.arguments)!=null?C:""},sent:!1};const ee=c[W];if(ee==null)throw new Error("Tool call is missing");((k=ee.function)==null?void 0:k.name)!=null&&((A=ee.function)==null?void 0:A.arguments)!=null&&Jp(ee.function.arguments)&&(v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ee.id,toolName:ee.function.name,argsTextDelta:ee.function.arguments}),v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(R=ee.id)!=null?R:ra(),toolName:ee.function.name,args:ee.function.arguments}),ee.sent=!0);continue}const Q=c[W];if(Q==null)throw new Error("Tool call is missing");((N=ne.function)==null?void 0:N.arguments)!=null&&(Q.function.arguments+=(O=(I=ne.function)==null?void 0:I.arguments)!=null?O:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:(L=ne.function.arguments)!=null?L:""}),((P=Q.function)==null?void 0:P.name)!=null&&((V=Q.function)==null?void 0:V.arguments)!=null&&Jp(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(F=Q.id)!=null?F:ra(),toolName:Q.function.name,args:Q.function.arguments}),Q.sent=!0)}},flush(b){var v;if(u==="tool-calls")for(const S of c)S.sent||(b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(v=S.id)!=null?v:ra(),toolName:S.function.name,args:Jp(S.function.arguments)?S.function.arguments:"{}"}),S.sent=!0);const x={};y&&(m.totalTokens!==void 0||m.cost!==void 0||m.promptTokensDetails!==void 0||m.completionTokensDetails!==void 0)&&(x.openrouter={usage:m});const w=Object.keys(x).length>0&&y;b.enqueue(Na({type:"finish",finishReason:u,logprobs:h,usage:d},w?{providerMetadata:x}:{}))}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:s},warnings:[]}}},xG=Ke({id:$e().optional(),model:$e().optional(),usage:Ke({prompt_tokens:Tt(),prompt_tokens_details:Ke({cached_tokens:Tt()}).nullish(),completion_tokens:Tt(),completion_tokens_details:Ke({reasoning_tokens:Tt()}).nullish(),total_tokens:Tt(),cost:Tt().optional()}).nullish()}),mve=xG.extend({choices:ln(Ke({message:Ke({role:An("assistant"),content:$e().nullable().optional(),reasoning:$e().nullable().optional(),reasoning_details:WO.nullish(),tool_calls:ln(Ke({id:$e().optional().nullable(),type:An("function"),function:Ke({name:$e(),arguments:$e()})})).optional()}),index:Tt(),logprobs:Ke({content:ln(Ke({token:$e(),logprob:Tt(),top_logprobs:ln(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullable().optional(),finish_reason:$e().optional().nullable()}))}),gve=hs([xG.extend({choices:ln(Ke({delta:Ke({role:hl(["assistant"]).optional(),content:$e().nullish(),reasoning:$e().nullish().optional(),reasoning_details:WO.nullish(),tool_calls:ln(Ke({index:Tt(),id:$e().nullish(),type:An("function").optional(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:ln(Ke({token:$e(),logprob:Tt(),top_logprobs:ln(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullable().optional(),index:Tt()}))}),HO]);function yve(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(a=>hve(a)?{type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}}:{type:"function",function:{name:a.name}}),s=e.toolChoice;if(s==null)return{tools:r,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:r,tool_choice:i};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const a=i;throw new Error(`Unsupported tool choice type: ${a}`)}}}function bve({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0]&&e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new uc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new hr({functionality:"images"});case"file":throw new hr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new hr({functionality:"tool-call messages"});case"reasoning":throw new hr({functionality:"reasoning messages"});case"redacted-reasoning":throw new hr({functionality:"redacted reasoning messages"});case"file":throw new hr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new hr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s}}function n$(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,s;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((s=e.top_logprobs[n])!=null?s:{}).map(([i,a])=>({token:i,logprob:a})):[]}})}var vve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,frequencyPenalty:a,presencePenalty:o,seed:l,responseFormat:c,topK:u,stopSequences:d,providerMetadata:h}){var m,y;const b=e.type,v=(m=h==null?void 0:h.openrouter)!=null?m:{},{prompt:x}=bve({prompt:n,inputFormat:t}),w=Na(Na(Na({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:o,seed:l,stop:d,response_format:c,top_k:u,prompt:x,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),v);switch(b){case"regular":{if((y=e.tools)!=null&&y.length)throw new hr({functionality:"tools"});if(e.toolChoice)throw new hr({functionality:"toolChoice"});return w}case"object-json":throw new hr({functionality:"object-json mode"});case"object-tool":throw new hr({functionality:"object-tool mode"});default:{const S=b;throw new hr({functionality:`${S} mode`})}}}async doGenerate(e){var t,n,r,s,i;const a=this.getArgs(e),{responseHeaders:o,value:l}=await qs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:a,failedResponseHandler:kC,successfulResponseHandler:$a(r$),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=a,{prompt:u}=c,d=SC(c,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const h=l.choices[0];if(!h)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=h.text)!=null?t:"",reasoning:h.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(i=(s=l.usage)==null?void 0:s.completion_tokens)!=null?i:0},finishReason:CC(h.finish_reason),logprobs:n$(h.logprobs),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await qs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:S2(Na({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:kC,successfulResponseHandler:Lh(r$),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=t,{prompt:i}=s,a=SC(s,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:r.pipeThrough(new TransformStream({transform(u,d){if(!u.success){o="error",d.enqueue({type:"error",error:u.error});return}const h=u.value;if("error"in h){o="error",d.enqueue({type:"error",error:h.error});return}h.usage!=null&&(l={promptTokens:h.usage.prompt_tokens,completionTokens:h.usage.completion_tokens});const m=h.choices[0];(m==null?void 0:m.finish_reason)!=null&&(o=CC(m.finish_reason)),(m==null?void 0:m.text)!=null&&d.enqueue({type:"text-delta",textDelta:m.text});const y=n$(m==null?void 0:m.logprobs);y!=null&&y.length&&(c===void 0&&(c=[]),c.push(...y))},flush(u){u.enqueue({type:"finish",finishReason:o,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},r$=hs([Ke({id:$e().optional(),model:$e().optional(),choices:ln(Ke({text:$e(),reasoning:$e().nullish().optional(),reasoning_details:WO.nullish(),finish_reason:$e().nullish(),index:Tt(),logprobs:Ke({tokens:ln($e()),token_logprobs:ln(Tt()),top_logprobs:ln(gh($e(),Tt())).nullable()}).nullable().optional()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).optional().nullable()}),HO]);function wG(e={}){var t,n,r;const s=(n=o1((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",i=(r=e.compatibility)!=null?r:"compatible",a=()=>Na({Authorization:`Bearer ${zO({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(d,h={})=>new pve(d,h,{provider:"openrouter.chat",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),l=(d,h={})=>new vve(d,h,{provider:"openrouter.completion",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),c=(d,h)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return d==="openai/gpt-3.5-turbo-instruct"?l(d,h):o(d,h)},u=(d,h)=>c(d,h);return u.languageModel=c,u.chat=o,u.completion=l,u}wG({compatibility:"strict"});var kp={},pN={},s$;function i$(){return s$||(s$=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(pN)),pN}var a$;function xve(){return a$||(a$=1,function(e){var t=kp&&kp.__createBinding||(Object.create?function(c,u,d,h){h===void 0&&(h=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,h,m)}:function(c,u,d,h){h===void 0&&(h=d),c[h]=u[d]}),n=kp&&kp.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=i$();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(i$(),e);class s extends Error{}e.PartialJSON=s;class i extends Error{}e.MalformedJSON=i;function a(c,u=r.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return o(c.trim(),u)}e.parseJSON=a;const o=(c,u)=>{const d=c.length;let h=0;const m=k=>{throw new s(`${k} at position ${h}`)},y=k=>{throw new i(`${k} at position ${h}`)},b=()=>(C(),h>=d&&m("Unexpected end of input"),c[h]==='"'?v():c[h]==="{"?x():c[h]==="["?w():c.substring(h,h+4)==="null"||r.Allow.NULL&u&&d-h<4&&"null".startsWith(c.substring(h))?(h+=4,null):c.substring(h,h+4)==="true"||r.Allow.BOOL&u&&d-h<4&&"true".startsWith(c.substring(h))?(h+=4,!0):c.substring(h,h+5)==="false"||r.Allow.BOOL&u&&d-h<5&&"false".startsWith(c.substring(h))?(h+=5,!1):c.substring(h,h+8)==="Infinity"||r.Allow.INFINITY&u&&d-h<8&&"Infinity".startsWith(c.substring(h))?(h+=8,1/0):c.substring(h,h+9)==="-Infinity"||r.Allow._INFINITY&u&&1<d-h&&d-h<9&&"-Infinity".startsWith(c.substring(h))?(h+=9,-1/0):c.substring(h,h+3)==="NaN"||r.Allow.NAN&u&&d-h<3&&"NaN".startsWith(c.substring(h))?(h+=3,NaN):S()),v=()=>{const k=h;let A=!1;for(h++;h<d&&(c[h]!=='"'||A&&c[h-1]==="\\");)A=c[h]==="\\"?!A:!1,h++;if(c.charAt(h)=='"')try{return JSON.parse(c.substring(k,++h-Number(A)))}catch(R){y(String(R))}else if(r.Allow.STR&u)try{return JSON.parse(c.substring(k,h-Number(A))+'"')}catch{return JSON.parse(c.substring(k,c.lastIndexOf("\\"))+'"')}m("Unterminated string literal")},x=()=>{h++,C();const k={};try{for(;c[h]!=="}";){if(C(),h>=d&&r.Allow.OBJ&u)return k;const A=v();C(),h++;try{const R=b();k[A]=R}catch(R){if(r.Allow.OBJ&u)return k;throw R}C(),c[h]===","&&h++}}catch{if(r.Allow.OBJ&u)return k;m("Expected '}' at end of object")}return h++,k},w=()=>{h++;const k=[];try{for(;c[h]!=="]";)k.push(b()),C(),c[h]===","&&h++}catch{if(r.Allow.ARR&u)return k;m("Expected ']' at end of array")}return h++,k},S=()=>{if(h===0){c==="-"&&y("Not sure what '-' is");try{return JSON.parse(c)}catch(A){if(r.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}y(String(A))}}const k=h;for(c[h]==="-"&&h++;c[h]&&",]}".indexOf(c[h])===-1;)h++;h==d&&!(r.Allow.NUM&u)&&m("Unterminated number literal");try{return JSON.parse(c.substring(k,h))}catch{c.substring(k,h)==="-"&&m("Not sure what '-' is");try{return JSON.parse(c.substring(k,c.lastIndexOf("e")))}catch(R){y(String(R))}}},C=()=>{for(;h<d&&` 
\r	`.includes(c[h]);)h++};return b()},l=a;e.parse=l}(kp)),kp}var wve=xve();function mN(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new hr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(Su(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const a of n)switch(a.type){case"text":{s.push(a.text);break}case"tool-call":{i.push({function:{arguments:a.args,name:a.toolName},id:a.toolCallId,type:"function"});break}default:{const o=a;throw new Error(`Unsupported part: ${o}`)}}t.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{t.push(...n.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return t}var _ve=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=wve.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[s,i]of r.entries()){const a=(n=JSON.stringify(i==null?void 0:i.parameters))!=null?n:"";if(a==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:ra(),type:"function"});const o=this._toolCalls[s];o.function.arguments=a,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function Sve({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var Cve=Ke({error:Ke({code:$e().nullable(),message:$e(),param:mh().nullable(),type:$e()})}),oj=Fh({errorSchema:Cve,errorToMessage:e=>e.error.message});function kve({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],s=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const i=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):i.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(s===void 0)return{tools:i,toolWarnings:r};const a=s.type;switch(a){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=a;throw new hr({functionality:`Unsupported tool choice type: ${o}`})}}}function Eve(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var Tve=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},Ave=e=>async({response:t})=>{const n=My(t);if(t.body===null)throw new MH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new Tve).pipeThrough(new TransformStream({transform(r,s){s.enqueue(cm({schema:e,text:r}))}}))}},Rve=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:s,responseFormat:i,seed:a,stopSequences:o,temperature:l,topK:c,topP:u}){const d=n.type,h=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&!this.supportsStructuredOutputs&&h.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const m={format:i==null?void 0:i.type,model:this.modelId,options:Eve({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:a,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(d){case"regular":{const{tools:y,toolWarnings:b}=kve({mode:n});return{args:{...m,messages:mN(s),tools:y},type:d,warnings:[...h,...b]}}case"object-json":return{args:{...m,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:mN(s)},type:d,warnings:h};case"object-tool":return{args:{...m,messages:mN(s),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:d,warnings:h};default:{const y=d;throw new Error(`Unsupported type: ${y}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:s}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:a,value:o}=await qs({abortSignal:e.abortSignal,body:i,failedResponseHandler:oj,fetch:this.config.fetch,headers:Us(this.config.headers(),e.headers),successfulResponseHandler:$a(Nve),url:`${this.config.baseURL}/chat`}),{messages:l,...c}=i,u=(t=o.message.tool_calls)==null?void 0:t.map(d=>{var h;return{args:JSON.stringify(d.function.arguments),toolCallId:(h=d.id)!=null?h:ra(),toolCallType:"function",toolName:d.function.name}});return{finishReason:Sve({finishReason:o.done_reason,hasToolCalls:u!==void 0&&u.length>0}),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},request:{body:JSON.stringify(i)},text:(n=o.message.content)!=null?n:void 0,toolCalls:u,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(e){if(this.settings.simulateStreaming){const m=await this.doGenerate(e),y=new ReadableStream({start(b){if(b.enqueue({type:"response-metadata",...m.response}),m.text&&b.enqueue({textDelta:m.text,type:"text-delta"}),m.toolCalls)for(const v of m.toolCalls)b.enqueue({argsTextDelta:v.args,toolCallId:v.toolCallId,toolCallType:"function",toolName:v.toolName,type:"tool-call-delta"}),b.enqueue({type:"tool-call",...v});b.enqueue({finishReason:m.finishReason,logprobs:m.logprobs,providerMetadata:m.providerMetadata,type:"finish",usage:m.usage}),b.close()}});return{rawCall:m.rawCall,rawResponse:m.rawResponse,stream:y,warnings:m.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:s,value:i}=await qs({abortSignal:e.abortSignal,body:t,failedResponseHandler:oj,fetch:this.config.fetch,headers:Us(this.config.headers(),e.headers),successfulResponseHandler:Ave(Mve),url:`${this.config.baseURL}/chat`}),{messages:a,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,c=new _ve({tools:l,type:n});let u="other",d={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:h=!0}=this.settings;return{rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(m){m.enqueue({finishReason:u,type:"finish",usage:d})},async transform(m,y){if(!m.success){y.enqueue({error:m.error,type:"error"});return}const b=m.value;if(b.done){u=c.finish({controller:y}),d={completionTokens:b.eval_count,promptTokens:b.prompt_eval_count||0};return}h&&c.parse({controller:y,delta:b.message.content})||b.message.content!==null&&y.enqueue({textDelta:b.message.content,type:"text-delta"})}})),warnings:r}}},Nve=Ke({created_at:$e(),done:An(!0),done_reason:$e().optional().nullable(),eval_count:Tt(),eval_duration:Tt(),load_duration:Tt().optional(),message:Ke({content:$e(),role:$e(),tool_calls:ln(Ke({function:Ke({arguments:gh(mh()),name:$e()}),id:$e().optional()})).optional().nullable()}),model:$e(),prompt_eval_count:Tt().optional(),prompt_eval_duration:Tt().optional(),total_duration:Tt()}),Mve=vE("done",[Ke({created_at:$e(),done:An(!1),message:Ke({content:$e(),role:$e()}),model:$e()}),Ke({created_at:$e(),done:An(!0),eval_count:Tt(),eval_duration:Tt(),load_duration:Tt().optional(),model:$e(),prompt_eval_count:Tt().optional(),prompt_eval_duration:Tt().optional(),total_duration:Tt()})]),Ive=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new mE({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await qs({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:oj,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:$a(jve),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},jve=Ke({embeddings:ln(ln(Tt())),prompt_eval_count:Tt().nullable()});function _G(e={}){var t;const n=(t=o1(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),s=(o,l={})=>new Rve(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),i=(o,l={})=>new Ive(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),a=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(o,l)};return a.chat=s,a.embedding=i,a.languageModel=s,a.textEmbedding=i,a.textEmbeddingModel=i,a}_G();function Sv(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function Ove(e){const t=[];for(const{role:n,content:r,...s}of e){const i=Sv({...s});switch(n){case"system":{t.push({role:"system",content:r,...i});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...Sv(r[0])});break}t.push({role:"user",content:r.map(a=>{var o;const l=Sv(a);switch(a.type){case"text":return{type:"text",text:a.text,...l};case"image":return{type:"image_url",image_url:{url:a.image instanceof URL?a.image.toString():`data:${(o=a.mimeType)!=null?o:"image/jpeg"};base64,${Su(a.image)}`},...l};case"file":throw new hr({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let a="";const o=[];for(const l of r){const c=Sv(l);switch(l.type){case"text":{a+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}}}t.push({role:"assistant",content:a,tool_calls:o.length>0?o:void 0,...i});break}case"tool":{for(const a of r){const o=Sv(a);t.push({role:"tool",tool_call_id:a.toolCallId,content:JSON.stringify(a.result),...o})}break}default:{const a=n;throw new Error(`Unsupported role: ${a}`)}}}return t}function EC({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function TC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Pve=Ke({error:Ke({message:$e(),type:$e().nullish(),param:mh().nullish(),code:hs([$e(),Tt()]).nullish()})}),xE={errorSchema:Pve,errorToMessage:e=>e.error.message};function Dve({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)l.type==="provider-defined"?s.push({type:"unsupported-tool",tool:l}):a.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:{const l=o;throw new hr({functionality:`Unsupported tool choice type: ${l}`})}}}var Fve=class{constructor(e,t,n){this.specificationVersion="v1";var r,s;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:xE;this.chunkSchema=Bve(i.errorSchema),this.failedResponseHandler=Fh(i),this.supportsStructuredOutputs=(s=n.supportsStructuredOutputs)!=null?s:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,providerMetadata:l,stopSequences:c,responseFormat:u,seed:d}){var h,m,y,b,v;const x=e.type,w=[];i!=null&&w.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&w.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const S={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs===!0&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,name:(h=u.name)!=null?h:"response",description:u.description}}:{type:"json_object"}:void 0,stop:c,seed:d,...l==null?void 0:l[this.providerOptionsName],reasoning_effort:(b=(m=l==null?void 0:l[this.providerOptionsName])==null?void 0:m.reasoningEffort)!=null?b:(y=l==null?void 0:l["openai-compatible"])==null?void 0:y.reasoningEffort,messages:Ove(t)};switch(x){case"regular":{const{tools:C,tool_choice:k,toolWarnings:A}=Dve({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...S,tools:C,tool_choice:k},warnings:[...w,...A]}}case"object-json":return{args:{...S,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(v=e.name)!=null?v:"response",description:e.description}}:{type:"json_object"}},warnings:w};case"object-tool":return{args:{...S,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:w};default:{const C=x;throw new Error(`Unsupported type: ${C}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c,u,d;const{args:h,warnings:m}=this.getArgs({...e}),y=JSON.stringify(h),{responseHeaders:b,value:v,rawValue:x}=await qs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:h,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$a(Lve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:w,...S}=h,C=v.choices[0],k={[this.providerOptionsName]:{},...(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:x})},A=(r=v.usage)==null?void 0:r.completion_tokens_details,R=(s=v.usage)==null?void 0:s.prompt_tokens_details;return(A==null?void 0:A.reasoning_tokens)!=null&&(k[this.providerOptionsName].reasoningTokens=A==null?void 0:A.reasoning_tokens),(A==null?void 0:A.accepted_prediction_tokens)!=null&&(k[this.providerOptionsName].acceptedPredictionTokens=A==null?void 0:A.accepted_prediction_tokens),(A==null?void 0:A.rejected_prediction_tokens)!=null&&(k[this.providerOptionsName].rejectedPredictionTokens=A==null?void 0:A.rejected_prediction_tokens),(R==null?void 0:R.cached_tokens)!=null&&(k[this.providerOptionsName].cachedPromptTokens=R==null?void 0:R.cached_tokens),{text:(i=C.message.content)!=null?i:void 0,reasoning:(a=C.message.reasoning_content)!=null?a:void 0,toolCalls:(o=C.message.tool_calls)==null?void 0:o.map(N=>{var I;return{toolCallType:"function",toolCallId:(I=N.id)!=null?I:ra(),toolName:N.function.name,args:N.function.arguments}}),finishReason:TC(C.finish_reason),usage:{promptTokens:(c=(l=v.usage)==null?void 0:l.prompt_tokens)!=null?c:NaN,completionTokens:(d=(u=v.usage)==null?void 0:u.completion_tokens)!=null?d:NaN},providerMetadata:k,rawCall:{rawPrompt:w,rawSettings:S},rawResponse:{headers:b,body:x},response:EC(v),warnings:m,request:{body:y}}}async doStream(e){var t;if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.reasoning)if(Array.isArray(b.reasoning))for(const w of b.reasoning)w.type==="text"&&x.enqueue({type:"reasoning",textDelta:w.text});else x.enqueue({type:"reasoning",textDelta:b.reasoning});if(b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),s={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},i=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:a,value:o}=await qs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:s,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Lh(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=n,u=[];let d="unknown",h={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},m=!0,y=this.providerOptionsName;return{stream:o.pipeThrough(new TransformStream({transform(b,v){var x,w,S,C,k,A,R,N,I,O,L,P;if(!b.success){d="error",v.enqueue({type:"error",error:b.error});return}const V=b.value;if(i==null||i.processChunk(b.rawValue),"error"in V){d="error",v.enqueue({type:"error",error:V.error.message});return}if(m&&(m=!1,v.enqueue({type:"response-metadata",...EC(V)})),V.usage!=null){const{prompt_tokens:U,completion_tokens:H,prompt_tokens_details:$,completion_tokens_details:ne}=V.usage;h.promptTokens=U??void 0,h.completionTokens=H??void 0,(ne==null?void 0:ne.reasoning_tokens)!=null&&(h.completionTokensDetails.reasoningTokens=ne==null?void 0:ne.reasoning_tokens),(ne==null?void 0:ne.accepted_prediction_tokens)!=null&&(h.completionTokensDetails.acceptedPredictionTokens=ne==null?void 0:ne.accepted_prediction_tokens),(ne==null?void 0:ne.rejected_prediction_tokens)!=null&&(h.completionTokensDetails.rejectedPredictionTokens=ne==null?void 0:ne.rejected_prediction_tokens),($==null?void 0:$.cached_tokens)!=null&&(h.promptTokensDetails.cachedTokens=$==null?void 0:$.cached_tokens)}const F=V.choices[0];if((F==null?void 0:F.finish_reason)!=null&&(d=TC(F.finish_reason)),(F==null?void 0:F.delta)==null)return;const X=F.delta;if(X.reasoning_content!=null&&v.enqueue({type:"reasoning",textDelta:X.reasoning_content}),X.content!=null&&v.enqueue({type:"text-delta",textDelta:X.content}),X.tool_calls!=null)for(const U of X.tool_calls){const H=U.index;if(u[H]==null){if(U.type!=="function")throw new Td({data:U,message:"Expected 'function' type."});if(U.id==null)throw new Td({data:U,message:"Expected 'id' to be a string."});if(((x=U.function)==null?void 0:x.name)==null)throw new Td({data:U,message:"Expected 'function.name' to be a string."});u[H]={id:U.id,type:"function",function:{name:U.function.name,arguments:(w=U.function.arguments)!=null?w:""},hasFinished:!1};const ne=u[H];((S=ne.function)==null?void 0:S.name)!=null&&((C=ne.function)==null?void 0:C.arguments)!=null&&(ne.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ne.id,toolName:ne.function.name,argsTextDelta:ne.function.arguments}),Jp(ne.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(k=ne.id)!=null?k:ra(),toolName:ne.function.name,args:ne.function.arguments}),ne.hasFinished=!0));continue}const $=u[H];$.hasFinished||(((A=U.function)==null?void 0:A.arguments)!=null&&($.function.arguments+=(N=(R=U.function)==null?void 0:R.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:$.id,toolName:$.function.name,argsTextDelta:(I=U.function.arguments)!=null?I:""}),((O=$.function)==null?void 0:O.name)!=null&&((L=$.function)==null?void 0:L.arguments)!=null&&Jp($.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=$.id)!=null?P:ra(),toolName:$.function.name,args:$.function.arguments}),$.hasFinished=!0))}},flush(b){var v,x;const w={[y]:{},...i==null?void 0:i.buildMetadata()};h.completionTokensDetails.reasoningTokens!=null&&(w[y].reasoningTokens=h.completionTokensDetails.reasoningTokens),h.completionTokensDetails.acceptedPredictionTokens!=null&&(w[y].acceptedPredictionTokens=h.completionTokensDetails.acceptedPredictionTokens),h.completionTokensDetails.rejectedPredictionTokens!=null&&(w[y].rejectedPredictionTokens=h.completionTokensDetails.rejectedPredictionTokens),h.promptTokensDetails.cachedTokens!=null&&(w[y].cachedPromptTokens=h.promptTokensDetails.cachedTokens),b.enqueue({type:"finish",finishReason:d,usage:{promptTokens:(v=h.promptTokens)!=null?v:NaN,completionTokens:(x=h.completionTokens)!=null?x:NaN},providerMetadata:w})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(s)}}}},SG=Ke({prompt_tokens:Tt().nullish(),completion_tokens:Tt().nullish(),prompt_tokens_details:Ke({cached_tokens:Tt().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:Tt().nullish(),accepted_prediction_tokens:Tt().nullish(),rejected_prediction_tokens:Tt().nullish()}).nullish()}).nullish(),Lve=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:ln(Ke({message:Ke({role:An("assistant").nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:ln(Ke({id:$e().nullish(),type:An("function"),function:Ke({name:$e(),arguments:$e()})})).nullish()}),finish_reason:$e().nullish()})),usage:SG}),Bve=e=>hs([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:ln(Ke({delta:Ke({role:hl(["assistant"]).nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:ln(Ke({index:Tt(),id:$e().nullish(),type:An("function").nullish(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),finish_reason:$e().nullish()})),usage:SG}),e]);function $ve({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new uc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new hr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new hr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new hr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}var zve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const s=(r=n.errorStructure)!=null?r:xE;this.chunkSchema=qve(s.errorSchema),this.failedResponseHandler=Fh(s)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d,providerMetadata:h}){var m;const y=e.type,b=[];a!=null&&b.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:v,stopSequences:x}=$ve({prompt:n,inputFormat:t}),w=[...x??[],...c??[]],S={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,...h==null?void 0:h[this.providerOptionsName],prompt:v,stop:w.length>0?w:void 0};switch(y){case"regular":{if((m=e.tools)!=null&&m.length)throw new hr({functionality:"tools"});if(e.toolChoice)throw new hr({functionality:"toolChoice"});return{args:S,warnings:b}}case"object-json":throw new hr({functionality:"object-json mode"});case"object-tool":throw new hr({functionality:"object-tool mode"});default:{const C=y;throw new Error(`Unsupported type: ${C}`)}}}async doGenerate(e){var t,n,r,s;const{args:i,warnings:a}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:c}=await qs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$a(Uve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...d}=i,h=l.choices[0];return{text:h.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(s=(r=l.usage)==null?void 0:r.completion_tokens)!=null?s:NaN},finishReason:TC(h.finish_reason),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o,body:c},response:EC(l),warnings:a,request:{body:JSON.stringify(i)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await qs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Us(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Lh(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u=!0;return{stream:i.pipeThrough(new TransformStream({transform(d,h){if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const m=d.value;if("error"in m){l="error",h.enqueue({type:"error",error:m.error});return}u&&(u=!1,h.enqueue({type:"response-metadata",...EC(m)})),m.usage!=null&&(c={promptTokens:m.usage.prompt_tokens,completionTokens:m.usage.completion_tokens});const y=m.choices[0];(y==null?void 0:y.finish_reason)!=null&&(l=TC(y.finish_reason)),(y==null?void 0:y.text)!=null&&h.enqueue({type:"text-delta",textDelta:y.text})},flush(d){d.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},Uve=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:ln(Ke({text:$e(),finish_reason:$e()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),qve=e=>hs([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:ln(Ke({text:$e(),finish_reason:$e().nullish(),index:Tt()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),e]),Vve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new mE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:s,value:i}=await qs({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Us(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Fh((r=this.config.errorStructure)!=null?r:xE),successfulResponseHandler:$a(Wve),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(a=>a.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:s}}}},Wve=Ke({data:ln(Ke({embedding:ln(Tt())})),usage:Ke({prompt_tokens:Tt()}).nullish()}),Hve=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d,h;const m=[];r!=null&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&m.push({type:"unsupported-setting",setting:"seed"});const y=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:b,responseHeaders:v}=await qs({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Us(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:Fh((h=this.config.errorStructure)!=null?h:xE),successfulResponseHandler:$a(Gve),abortSignal:o,fetch:this.config.fetch});return{images:b.data.map(x=>x.b64_json),warnings:m,response:{timestamp:y,modelId:this.modelId,headers:v}}}},Gve=Ke({data:ln(Ke({b64_json:$e()}))});function Kve(e){const t=o1(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),s=d=>({provider:`${n}.${d}`,url:({path:h})=>{const m=new URL(`${t}${h}`);return e.queryParams&&(m.search=new URLSearchParams(e.queryParams).toString()),m.toString()},headers:r,fetch:e.fetch}),i=(d,h={})=>a(d,h),a=(d,h={})=>new Fve(d,h,{...s("chat"),defaultObjectGenerationMode:"tool"}),o=(d,h={})=>new zve(d,h,s("completion")),l=(d,h={})=>new Vve(d,h,s("embedding")),c=(d,h={})=>new Hve(d,h,s("image")),u=(d,h)=>i(d,h);return u.languageModel=i,u.chatModel=a,u.completionModel=o,u.textEmbeddingModel=l,u.imageModel=c,u}const px=(e,t)=>`${e}:${t}`,yc=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},K0=e=>e==="openai"||e==="openrouter"||e==="google",AC=e=>e==="ollama"||e==="openai-compatible",Qp=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",xo=[{value:"openrouter",label:"OpenRouter"},{value:"openai",label:"OpenAI"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"},{value:"google",label:"Google Gemini"}],Yve={openai:[{id:"gpt-4o",name:"GPT-4o"},{id:"dall-e-3",name:"DALL-E 3"},{id:"dall-e-2",name:"DALL-E 2"},{id:"o3-mini",name:"o3-mini"},{id:"o4-mini",name:"o4-mini"},{id:"o4-mini-high",name:"o4-mini-high"},{id:"o3-mini-high",name:"o3-mini-high"},{id:"o3",name:"o3"},{id:"4.1",name:"4.1"},{id:"4.1-mini",name:"4.1-mini"},{id:"4.1-nano",name:"4.1-nano"},{id:"o3-pro",name:"o3-pro"},{id:"codex-mini",name:"codex-mini"}],google:[{id:"gemini-2.5-pro-preview",name:"Gemini 2.5 Pro Preview"},{id:"gemini-2.5-flash-preview-05-20:thinking",name:"Gemini 2.5 Flash Preview (Thinking)"},{id:"gemini-2.5-flash-preview",name:"Gemini 2.5 Flash Preview"},{id:"gemini-2.0-flash-001",name:"Gemini 2.0 Flash"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},CG=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function GO(e,t,n){try{switch(e.type){case"openai":return hG({apiKey:n})(t);case"google":return yG({apiKey:n})(t);case"openrouter":const s=wG({apiKey:n,extraBody:{include_reasoning:!0}})(t),i=s.doStream.bind(s);return s.doStream=async function(a){const o=await i(a),l=o.stream.getReader(),c=new ReadableStream({async start(u){try{for(;;){const{done:d,value:h}=await l.read();if(d)break;u.enqueue(h)}}catch(d){d&&typeof d=="object"&&"message"in d&&typeof d.message=="string"&&d.message.includes("reading 'sent'")?console.warn("[OpenRouter Provider Bug] Caught toolCall.sent error, attempting graceful recovery"):u.error(d)}finally{u.close()}}});return{...o,stream:c}},s;case"ollama":return _G({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return Kve({baseURL:CG(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function kG(e,t,n){const s=Rr.getState().getAllAvailableModelDefsForProvider(e.id).find(a=>a.id===t);if(!s){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const i=GO(e,t,n);if(!i){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:px(e.id,t),name:s.name,providerId:e.id,providerName:e.name,instance:i,metadata:s}}const EG={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]},Cv=new Map,Zve=5*60*1e3,Xve=(e,t)=>{var i,a,o,l,c,u,d,h,m,y,b,v,x,w;const n=e.id||e.name,r=e.name||n,s={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((i=e.architecture)==null?void 0:i.modality)??"text->text",input_modalities:((a=e.architecture)==null?void 0:a.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((c=e.architecture)==null?void 0:c.instruct_type)??null},pricing:{prompt:((u=e.pricing)==null?void 0:u.prompt)??"0",completion:((d=e.pricing)==null?void 0:d.completion)??"0",request:((h=e.pricing)==null?void 0:h.request)??"0",image:((m=e.pricing)==null?void 0:m.image)??"0",web_search:((y=e.pricing)==null?void 0:y.web_search)??"0",internal_reasoning:((b=e.pricing)==null?void 0:b.internal_reasoning)??"0"},top_provider:{context_length:((v=e.top_provider)==null?void 0:v.context_length)??e.context_length??null,max_completion_tokens:((x=e.top_provider)==null?void 0:x.max_completion_tokens)??null,is_moderated:((w=e.top_provider)==null?void 0:w.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??EG[t]??[]};return t==="ollama"?(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(s.context_length=8192),n.includes("gpt-4-32k")&&(s.context_length=32768),n.includes("gpt-4-turbo")&&(s.context_length=128e3),n.includes("gpt-4o")&&(s.context_length=128e3),n.includes("gpt-3.5-turbo")&&(s.context_length=16385),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?s.context_length=1048576:n.includes("gemini")&&(s.context_length=32768),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Google")):t==="openai-compatible"&&(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Compatible")),s};async function Jve(e,t){const n=`${e.id}-${e.baseURL||""}`,r=Cv.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const s=(async()=>{var o,l,c;let i;const a={Accept:"application/json"};t&&(a.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");i="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");i="https://openrouter.ai/api/v1/models",a["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",a["X-Title"]="LiteChat";break;case"ollama":const u=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";i=new URL("/api/tags",u).toString(),delete a.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const d=CG(e.baseURL);i=new URL("models",d.endsWith("/")?d:d+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(u){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,u),Oe.error(`Invalid Base URL for ${e.name}: ${u instanceof Error?u.message:String(u)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${i}`);try{const u=await fetch(i,{headers:a});if(!u.ok){let y=`(${u.status} ${u.statusText})`;try{const b=await u.text();y=b||y;try{const v=JSON.parse(b);y=((c=v==null?void 0:v.error)==null?void 0:c.message)||(v==null?void 0:v.message)||y}catch{}}catch(b){console.warn("[ModelFetcher] Failed to read error response body:",b)}throw new Error(`API Error: ${y}`)}const d=await u.json();let h=[];if(e.type==="ollama"?h=d.models||[]:h=d.data||d||[],!Array.isArray(h))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,d),[];const m=h.map(y=>Xve(y,e.type));return m.sort((y,b)=>(y.name||y.id).localeCompare(b.name||b.id)),console.log(`[ModelFetcher] Fetched and mapped ${m.length} models for ${e.name}`),m}catch(u){const d=u instanceof Error?u.message:String(u);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,d),Oe.error(`Failed to fetch models for ${e.name}: ${d}`),Cv.delete(n),[]}})();return Cv.set(n,s),setTimeout(()=>{Cv.get(n)===s&&(Cv.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},Zve),s}const dr={initialDataLoaded:"provider.initial.data.loaded",configsChanged:"provider.configs.changed",apiKeysChanged:"provider.api.keys.changed",selectedModelChanged:"provider.selected.model.changed",globalModelSortOrderChanged:"provider.global.model.sort.order.changed",fetchStatusChanged:"provider.fetch.status.changed",globallyEnabledModelsUpdated:"provider.globally.enabled.models.updated",selectedModelForDetailsChanged:"provider.selected.model.for.details.changed",enableApiKeyManagementChanged:"provider.enable.api.key.management.changed",loadInitialDataRequest:"provider.load.initial.data.request",selectModelRequest:"provider.select.model.request",addApiKeyRequest:"provider.add.api.key.request",deleteApiKeyRequest:"provider.delete.api.key.request",addProviderConfigRequest:"provider.add.config.request",updateProviderConfigRequest:"provider.update.config.request",deleteProviderConfigRequest:"provider.delete.config.request",fetchModelsRequest:"provider.fetch.models.request",setGlobalModelSortOrderRequest:"provider.set.global.model.sort.order.request",setEnableApiKeyManagementRequest:"provider.set.enable.api.key.management.request",setSelectedModelForDetailsRequest:"provider.set.selected.model.for.details.request"},gN="provider:lastModelSelection",o$="provider:globalModelSortOrder",Rr=Fo(Lo((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,globallyEnabledModelDefinitions:[],_updateGloballyEnabledModelDefinitions:()=>{const{dbProviderConfigs:n,globalModelSortOrder:r}=t(),s=t().getAvailableModelListItems(),i=new Map(s.map(u=>[u.id,u])),a=new Set;n.forEach(u=>{u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(d=>{a.add(px(u.id,d))})});const o=[],l=new Set;r.forEach(u=>{if(a.has(u)){const d=i.get(u);d&&!l.has(u)&&(o.push(d),l.add(u))}});const c=s.filter(u=>a.has(u.id)&&!l.has(u.id)).sort((u,d)=>u.name.localeCompare(d.name));o.push(...c),e({globallyEnabledModelDefinitions:o}),je.emit(dr.globallyEnabledModelsUpdated,{models:o})},getGloballyEnabledModelDefinitions:()=>t().globallyEnabledModelDefinitions,createAiModelConfig:(n,r,s)=>{const a=t().getAllAvailableModelDefsForProvider(n.id).find(l=>l.id===r);if(!a){console.warn(`Model definition not found for ${r} in provider ${n.name}`);return}const o=GO(n,r,s);if(!o){console.warn(`Failed to instantiate AI SDK instance for ${r} from provider ${n.name}`);return}return{id:px(n.id,r),name:a.name,providerId:n.id,providerName:n.name,instance:o,metadata:a}},setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),Et.saveSetting("enableApiKeyManagement",n),je.emit(dr.enableApiKeyManagementChanged,{enabled:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await Et.loadSetting("enableApiKeyManagement",!0),[r,s,i,a]=await Promise.all([Et.loadProviderConfigs(),Et.loadApiKeys(),Et.loadSetting(o$,[]),Et.loadSetting(gN,null)]);e({dbProviderConfigs:r,dbApiKeys:s,enableApiKeyManagement:n,globalModelSortOrder:i}),t()._updateGloballyEnabledModelDefinitions();const o=t().globallyEnabledModelDefinitions.map(d=>d.id),l=new Set(o);let c=a;c&&l.has(c)||(c=o[0]??null),e({selectedModelId:c,isLoading:!1}),await Et.saveSetting(gN,c),je.emit(dr.initialDataLoaded,{configs:r,apiKeys:s,selectedModelId:c,globalSortOrder:t().globalModelSortOrder}),t().selectedModelId!==c?t().selectModel(c):je.emit(dr.selectedModelChanged,{modelId:c})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),Oe.error("Failed to load provider data")}},selectModel:n=>{t().selectedModelId!==n&&(e({selectedModelId:n}),Et.saveSetting(gN,n),je.emit(dr.selectedModelChanged,{modelId:n}))},addApiKey:async(n,r,s)=>{const i=qi(),a=new Date,o={id:i,name:n,value:s,providerId:r,createdAt:a,updatedAt:a};try{return await Et.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),Oe.success(`API Key "${n}" added.`),je.emit(dr.apiKeysChanged,{apiKeys:t().dbApiKeys}),i}catch(l){throw console.error("ProviderStore: Error adding API key",l),Oe.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var s;const r=((s=t().dbApiKeys.find(i=>i.id===n))==null?void 0:s.name)??"Unknown Key";try{await Et.deleteApiKey(n),e(i=>{i.dbApiKeys=i.dbApiKeys.filter(a=>a.id!==n),i.dbProviderConfigs=i.dbProviderConfigs.map(a=>a.apiKeyId===n?{...a,apiKeyId:null}:a)}),Oe.success(`API Key "${r}" deleted.`),je.emit(dr.apiKeysChanged,{apiKeys:t().dbApiKeys}),je.emit(dr.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(i){throw console.error("ProviderStore: Error deleting API key",i),Oe.error(`Failed to delete API Key: ${i instanceof Error?i.message:String(i)}`),i}},addProviderConfig:async n=>{const r=qi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await Et.saveProviderConfig(i),e(a=>{a.dbProviderConfigs.push(i)}),t()._updateGloballyEnabledModelDefinitions(),Oe.success(`Provider "${n.name}" added.`),je.emit(dr.configsChanged,{providerConfigs:t().dbProviderConfigs}),t().fetchModels(r).catch(a=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,a)}),r}catch(a){throw console.error("ProviderStore: Error adding provider config",a),Oe.error(`Failed to add Provider: ${a instanceof Error?a.message:String(a)}`),a}},updateProviderConfig:async(n,r)=>{const s=t().dbProviderConfigs.find(a=>a.id===n);if(!s)return;const i={...s,...r,fetchedModels:r.fetchedModels!==void 0?r.fetchedModels:s.fetchedModels,modelsLastFetchedAt:r.modelsLastFetchedAt!==void 0?r.modelsLastFetchedAt:s.modelsLastFetchedAt,updatedAt:new Date};try{await Et.saveProviderConfig(i),e(a=>{const o=a.dbProviderConfigs.findIndex(l=>l.id===n);o!==-1&&(a.dbProviderConfigs[o]=i)}),t()._updateGloballyEnabledModelDefinitions(),je.emit(dr.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(a){throw console.error("ProviderStore: Error updating provider config",a),Oe.error(`Failed to update Provider: ${a instanceof Error?a.message:String(a)}`),a}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r)return;const s=r.name;try{await Et.deleteProviderConfig(n),e(i=>{i.dbProviderConfigs=i.dbProviderConfigs.filter(a=>a.id!==n),delete i.providerFetchStatus[n]}),t()._updateGloballyEnabledModelDefinitions(),je.emit(dr.configsChanged,{providerConfigs:t().dbProviderConfigs}),Oe.success(`Provider "${s}" deleted.`)}catch(i){throw console.error("ProviderStore: Error deleting provider config",i),Oe.error(`Failed to delete Provider: ${i instanceof Error?i.message:String(i)}`),i}},fetchModels:async n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r){Oe.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]!=="fetching"){t()._setProviderFetchStatus(n,"fetching");try{const i=r.apiKeyId,a=(s=t().dbApiKeys.find(l=>l.id===i))==null?void 0:s.value,o=await Jve(r,a);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),Oe.success(`Models fetched successfully for ${r.name}`)}catch(i){console.error(`Error fetching models for ${r.name}:`,i),t()._setProviderFetchStatus(n,"error")}}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await Et.saveSetting(o$,r),t()._updateGloballyEnabledModelDefinitions(),je.emit(dr.globalModelSortOrderChanged,{ids:r});const s=t().selectedModelId,i=t().globallyEnabledModelDefinitions.map(o=>o.id),a=new Set(i);if(!s||!a.has(s)){const o=i[0]??null;o!==s&&t().selectModel(o)}},_setProviderFetchStatus:(n,r)=>{e(s=>{s.providerFetchStatus[n]=r}),je.emit(dr.fetchStatusChanged,{providerId:n,status:r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n}),je.emit(dr.selectedModelForDetailsChanged,{modelId:n})},getSelectedModel:()=>{const{selectedModelId:n}=t();if(!n)return;const{providerId:r,modelId:s}=yc(n);if(!r||!s)return;const i=t().dbProviderConfigs.find(o=>o.id===r);if(!i)return;const a=t().dbApiKeys.find(o=>o.id===i.apiKeyId);return t().createAiModelConfig(i,s,a==null?void 0:a.value)},getApiKeyForProvider:n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);return(s=t().dbApiKeys.find(i=>i.id===(r==null?void 0:r.apiKeyId)))==null?void 0:s.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(a=>a.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const s=r.type;return(Yve[s]||[]).map(a=>{let o="text->text",l=["text"],c=["text"];return(a.id.includes("dall-e")||a.id.includes("imagen")||a.id.includes("flux")||a.id.includes("stable-diffusion"))&&(o="text->image",l=["text"],c=["image"]),{id:a.id,name:a.name,context_length:4096,architecture:{modality:o,input_modalities:l,output_modalities:c},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:EG[r.type]??[]}})},getAvailableModelListItems:()=>{const{dbProviderConfigs:n}=t(),r=[];return n.forEach(s=>{t().getAllAvailableModelDefsForProvider(s.id).forEach(a=>{var o,l,c;r.push({id:px(s.id,a.id),name:a.name,providerId:s.id,providerName:s.name,metadataSummary:{context_length:((o=a.top_provider)==null?void 0:o.context_length)??a.context_length,supported_parameters:a.supported_parameters,input_modalities:(l=a.architecture)==null?void 0:l.input_modalities,output_modalities:(c=a.architecture)==null?void 0:c.output_modalities,pricing:a.pricing,description:a.description}})})}),r},getRegisteredActionHandlers:()=>{const n="providerStore",r=t();return[{eventName:dr.loadInitialDataRequest,handler:r.loadInitialData,storeId:n},{eventName:dr.selectModelRequest,handler:s=>r.selectModel(s.modelId),storeId:n},{eventName:dr.addApiKeyRequest,handler:s=>r.addApiKey(s.name,s.providerId,s.value).then(()=>{}),storeId:n},{eventName:dr.deleteApiKeyRequest,handler:s=>r.deleteApiKey(s.id),storeId:n},{eventName:dr.addProviderConfigRequest,handler:s=>r.addProviderConfig(s).then(()=>{}),storeId:n},{eventName:dr.updateProviderConfigRequest,handler:s=>r.updateProviderConfig(s.id,s.changes),storeId:n},{eventName:dr.deleteProviderConfigRequest,handler:s=>r.deleteProviderConfig(s.id),storeId:n},{eventName:dr.fetchModelsRequest,handler:s=>r.fetchModels(s.providerConfigId),storeId:n},{eventName:dr.setGlobalModelSortOrderRequest,handler:s=>r.setGlobalModelSortOrder(s.ids),storeId:n},{eventName:dr.setEnableApiKeyManagementRequest,handler:s=>r.setEnableApiKeyManagement(s.enabled),storeId:n},{eventName:dr.setSelectedModelForDetailsRequest,handler:s=>r.setSelectedModelForDetails(s.modelId),storeId:n}]}}))),sn={loaded:"settings.loaded",themeChanged:"settings.theme.changed",globalSystemPromptChanged:"settings.global.system.prompt.changed",temperatureChanged:"settings.temperature.changed",maxTokensChanged:"settings.max.tokens.changed",topPChanged:"settings.top.p.changed",topKChanged:"settings.top.k.changed",presencePenaltyChanged:"settings.presence.penalty.changed",frequencyPenaltyChanged:"settings.frequency.penalty.changed",enableAdvancedSettingsChanged:"settings.enable.advanced.settings.changed",enableStreamingMarkdownChanged:"settings.enable.streaming.markdown.changed",enableStreamingCodeBlockParsingChanged:"settings.enable.streaming.code.block.parsing.changed",foldStreamingCodeBlocksChanged:"settings.fold.streaming.code.blocks.changed",foldUserMessagesOnCompletionChanged:"settings.fold.user.messages.on.completion.changed",streamingRenderFpsChanged:"settings.streaming.render.fps.changed",gitUserNameChanged:"settings.git.user.name.changed",gitUserEmailChanged:"settings.git.user.email.changed",toolMaxStepsChanged:"settings.tool.max.steps.changed",prismThemeUrlChanged:"settings.prism.theme.url.changed",autoTitleEnabledChanged:"settings.auto.title.enabled.changed",autoTitleModelIdChanged:"settings.auto.title.model.id.changed",autoTitlePromptMaxLengthChanged:"settings.auto.title.prompt.max.length.changed",autoTitleIncludeFilesChanged:"settings.auto.title.include.files.changed",autoTitleIncludeRulesChanged:"settings.auto.title.include.rules.changed",customFontFamilyChanged:"settings.custom.font.family.changed",customFontSizeChanged:"settings.custom.font.size.changed",chatMaxWidthChanged:"settings.chat.max.width.changed",customThemeColorsChanged:"settings.custom.theme.colors.changed",autoScrollIntervalChanged:"settings.auto.scroll.interval.changed",enableAutoScrollOnStreamChanged:"settings.enable.auto.scroll.on.stream.changed",autoSyncOnStreamCompleteChanged:"settings.auto.sync.on.stream.complete.changed",autoInitializeReposOnStartupChanged:"settings.auto.initialize.repos.on.startup.changed",setThemeRequest:"settings.set.theme.request",setGlobalSystemPromptRequest:"settings.set.global.system.prompt.request",setTemperatureRequest:"settings.set.temperature.request",setMaxTokensRequest:"settings.set.max.tokens.request",setTopPRequest:"settings.set.top.p.request",setTopKRequest:"settings.set.top.k.request",setPresencePenaltyRequest:"settings.set.presence.penalty.request",setFrequencyPenaltyRequest:"settings.set.frequency.penalty.request",setEnableAdvancedSettingsRequest:"settings.set.enable.advanced.settings.request",setEnableStreamingMarkdownRequest:"settings.set.enable.streaming.markdown.request",setEnableStreamingCodeBlockParsingRequest:"settings.set.enable.streaming.code.block.parsing.request",setFoldStreamingCodeBlocksRequest:"settings.set.fold.streaming.code.blocks.request",setFoldUserMessagesOnCompletionRequest:"settings.set.fold.user.messages.on.completion.request",setStreamingRenderFpsRequest:"settings.set.streaming.render.fps.request",setGitUserNameRequest:"settings.set.git.user.name.request",setGitUserEmailRequest:"settings.set.git.user.email.request",setToolMaxStepsRequest:"settings.set.tool.max.steps.request",setPrismThemeUrlRequest:"settings.set.prism.theme.url.request",setAutoTitleEnabledRequest:"settings.set.auto.title.enabled.request",setAutoTitleModelIdRequest:"settings.set.auto.title.model.id.request",setAutoTitlePromptMaxLengthRequest:"settings.set.auto.title.prompt.max.length.request",setAutoTitleIncludeFilesRequest:"settings.set.auto.title.include.files.request",setAutoTitleIncludeRulesRequest:"settings.set.auto.title.include.rules.request",setCustomFontFamilyRequest:"settings.set.custom.font.family.request",setCustomFontSizeRequest:"settings.set.custom.font.size.request",setChatMaxWidthRequest:"settings.set.chat.max.width.request",setCustomThemeColorsRequest:"settings.set.custom.theme.colors.request",setCustomThemeColorRequest:"settings.set.custom.theme.color.request",setAutoScrollIntervalRequest:"settings.set.auto.scroll.interval.request",setEnableAutoScrollOnStreamRequest:"settings.set.enable.auto.scroll.on.stream.request",setAutoSyncOnStreamCompleteRequest:"settings.set.auto.sync.on.stream.complete.request",setAutoInitializeReposOnStartupRequest:"settings.set.auto.initialize.repos.on.startup.request",loadSettingsRequest:"settings.load.settings.request",resetGeneralSettingsRequest:"settings.reset.general.settings.request",resetAssistantSettingsRequest:"settings.reset.assistant.settings.request",resetThemeSettingsRequest:"settings.reset.theme.settings.request"},Qve=`You are a helpful AI assistant.

You are knowledgeable, friendly, and always strive to provide accurate and useful information. When you don't know something, you admit it honestly. You communicate clearly and concisely, adapting your tone to be appropriate for the context.

Key principles:
- Be helpful and respectful
- Provide accurate information
- Ask clarifying questions when needed
- Explain complex concepts clearly
- Acknowledge limitations honestly 

When creating gated blocks, if you can infer a filepath for it, you should create it as follow : 
\`\`\`language:relative/path/to/file.ext
The file content would be completely normal
\`\`\`

examples : 
\`\`\`jsx:src/components/button.jsx
export const Button = ({ children, onClick }) => {
  return <button onClick={onClick}>{children}</button>;
};
\`\`\`

\`\`\`markdown:readme.md
---
title: My Project
description: This is a project description
---

# My Project

This is a project description
\`\`\``,yN="system",bN=Qve,vN=.7,xN=null,wN=null,_N=null,SN=0,CN=0,l$=!0,kN=!0,EN=!0,TN=!1,AN=!1,RN=15,c$=null,u$=null,NN=5,MN=null,IN=!0,jN=null,ON=768,PN=!1,DN=!1,FN=null,LN=16,BN="max-w-7xl",$N=null,zN=1e3,UN=!0,d$=!1,f$=!1,yr=Fo(Lo((e,t)=>({theme:yN,globalSystemPrompt:bN,temperature:vN,maxTokens:xN,topP:wN,topK:_N,presencePenalty:SN,frequencyPenalty:CN,enableAdvancedSettings:l$,enableStreamingMarkdown:kN,enableStreamingCodeBlockParsing:EN,foldStreamingCodeBlocks:TN,foldUserMessagesOnCompletion:AN,streamingRenderFPS:RN,gitUserName:c$,gitUserEmail:u$,toolMaxSteps:NN,prismThemeUrl:MN,autoTitleEnabled:IN,autoTitleModelId:jN,autoTitlePromptMaxLength:ON,autoTitleIncludeFiles:PN,autoTitleIncludeRules:DN,customFontFamily:FN,customFontSize:LN,chatMaxWidth:BN,customThemeColors:$N,autoScrollInterval:zN,enableAutoScrollOnStream:UN,autoSyncOnStreamComplete:d$,autoInitializeReposOnStartup:f$,setTheme:n=>{e({theme:n}),Et.saveSetting("theme",n),je.emit(sn.themeChanged,{theme:n})},setGlobalSystemPrompt:n=>{e({globalSystemPrompt:n}),Et.saveSetting("globalSystemPrompt",n),je.emit(sn.globalSystemPromptChanged,{prompt:n})},setTemperature:n=>{e({temperature:n}),Et.saveSetting("temperature",n),je.emit(sn.temperatureChanged,{value:n})},setMaxTokens:n=>{e({maxTokens:n}),Et.saveSetting("maxTokens",n),je.emit(sn.maxTokensChanged,{value:n})},setTopP:n=>{e({topP:n}),Et.saveSetting("topP",n),je.emit(sn.topPChanged,{value:n})},setTopK:n=>{e({topK:n}),Et.saveSetting("topK",n),je.emit(sn.topKChanged,{value:n})},setPresencePenalty:n=>{e({presencePenalty:n}),Et.saveSetting("presencePenalty",n),je.emit(sn.presencePenaltyChanged,{value:n})},setFrequencyPenalty:n=>{e({frequencyPenalty:n}),Et.saveSetting("frequencyPenalty",n),je.emit(sn.frequencyPenaltyChanged,{value:n})},setEnableAdvancedSettings:n=>{e({enableAdvancedSettings:n}),Et.saveSetting("enableAdvancedSettings",n),je.emit(sn.enableAdvancedSettingsChanged,{enabled:n})},setEnableStreamingMarkdown:n=>{e({enableStreamingMarkdown:n}),Et.saveSetting("enableStreamingMarkdown",n),je.emit(sn.enableStreamingMarkdownChanged,{enabled:n})},setEnableStreamingCodeBlockParsing:n=>{e({enableStreamingCodeBlockParsing:n}),Et.saveSetting("enableStreamingCodeBlockParsing",n),je.emit(sn.enableStreamingCodeBlockParsingChanged,{enabled:n})},setFoldStreamingCodeBlocks:n=>{e({foldStreamingCodeBlocks:n}),Et.saveSetting("foldStreamingCodeBlocks",n),je.emit(sn.foldStreamingCodeBlocksChanged,{fold:n})},setFoldUserMessagesOnCompletion:n=>{e({foldUserMessagesOnCompletion:n}),Et.saveSetting("foldUserMessagesOnCompletion",n),je.emit(sn.foldUserMessagesOnCompletionChanged,{fold:n})},setStreamingRenderFPS:n=>{const r=Math.max(3,Math.min(60,n));e({streamingRenderFPS:r}),Et.saveSetting("streamingRenderFPS",r),je.emit(sn.streamingRenderFpsChanged,{fps:r})},setGitUserName:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserName:r}),Et.saveSetting("gitUserName",r),je.emit(sn.gitUserNameChanged,{name:r})},setGitUserEmail:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserEmail:r}),Et.saveSetting("gitUserEmail",r),je.emit(sn.gitUserEmailChanged,{email:r})},setToolMaxSteps:n=>{const r=Math.max(1,Math.min(20,n));e({toolMaxSteps:r}),Et.saveSetting("toolMaxSteps",r),je.emit(sn.toolMaxStepsChanged,{steps:r})},setPrismThemeUrl:n=>{const r=(n==null?void 0:n.trim())||null;e({prismThemeUrl:r}),Et.saveSetting("prismThemeUrl",r),je.emit(sn.prismThemeUrlChanged,{url:r})},setAutoTitleEnabled:n=>{e({autoTitleEnabled:n}),Et.saveSetting("autoTitleEnabled",n),je.emit(sn.autoTitleEnabledChanged,{enabled:n})},setAutoTitleModelId:n=>{e({autoTitleModelId:n}),Et.saveSetting("autoTitleModelId",n),je.emit(sn.autoTitleModelIdChanged,{modelId:n})},setAutoTitlePromptMaxLength:n=>{const r=Math.max(100,Math.min(4e3,n));e({autoTitlePromptMaxLength:r}),Et.saveSetting("autoTitlePromptMaxLength",r),je.emit(sn.autoTitlePromptMaxLengthChanged,{length:r})},setAutoTitleIncludeFiles:n=>{e({autoTitleIncludeFiles:n}),Et.saveSetting("autoTitleIncludeFiles",n),je.emit(sn.autoTitleIncludeFilesChanged,{include:n})},setAutoTitleIncludeRules:n=>{e({autoTitleIncludeRules:n}),Et.saveSetting("autoTitleIncludeRules",n),je.emit(sn.autoTitleIncludeRulesChanged,{include:n})},setCustomFontFamily:n=>{const r=(n==null?void 0:n.trim())||null;e({customFontFamily:r}),Et.saveSetting("customFontFamily",r),je.emit(sn.customFontFamilyChanged,{fontFamily:r})},setCustomFontSize:n=>{const r=n===null?null:Math.max(10,Math.min(24,n));e({customFontSize:r}),Et.saveSetting("customFontSize",r),je.emit(sn.customFontSizeChanged,{fontSize:r})},setChatMaxWidth:n=>{e({chatMaxWidth:n}),Et.saveSetting("chatMaxWidth",n),je.emit(sn.chatMaxWidthChanged,{maxWidth:n})},setCustomThemeColors:n=>{e({customThemeColors:n}),Et.saveSetting("customThemeColors",n),je.emit(sn.customThemeColorsChanged,{colors:n})},setCustomThemeColor:(n,r)=>{e(i=>{const o={...i.customThemeColors??{}};r===null||r.trim()===""?delete o[n]:o[n]=r.trim(),i.customThemeColors=Object.keys(o).length>0?o:null});const s=t().customThemeColors;Et.saveSetting("customThemeColors",s),je.emit(sn.customThemeColorsChanged,{colors:s})},setAutoScrollInterval:n=>{const r=Math.max(50,n);e({autoScrollInterval:r}),Et.saveSetting("autoScrollInterval",r),je.emit(sn.autoScrollIntervalChanged,{interval:r})},setEnableAutoScrollOnStream:n=>{e({enableAutoScrollOnStream:n}),Et.saveSetting("enableAutoScrollOnStream",n),je.emit(sn.enableAutoScrollOnStreamChanged,{enabled:n})},setAutoSyncOnStreamComplete:n=>{e({autoSyncOnStreamComplete:n}),Et.saveSetting("autoSyncOnStreamComplete",n),je.emit(sn.autoSyncOnStreamCompleteChanged,{enabled:n})},setAutoInitializeReposOnStartup:n=>{e({autoInitializeReposOnStartup:n}),Et.saveSetting("autoInitializeReposOnStartup",n),je.emit(sn.autoInitializeReposOnStartupChanged,{enabled:n})},loadSettings:async()=>{try{const[n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k,A,R,N,I,O,L,P,V,F,X,U]=await Promise.all([Et.loadSetting("theme",yN),Et.loadSetting("temperature",vN),Et.loadSetting("maxTokens",xN),Et.loadSetting("topP",wN),Et.loadSetting("topK",_N),Et.loadSetting("presencePenalty",SN),Et.loadSetting("frequencyPenalty",CN),Et.loadSetting("globalSystemPrompt",bN),Et.loadSetting("enableAdvancedSettings",l$),Et.loadSetting("enableStreamingMarkdown",kN),Et.loadSetting("enableStreamingCodeBlockParsing",EN),Et.loadSetting("foldStreamingCodeBlocks",TN),Et.loadSetting("foldUserMessagesOnCompletion",AN),Et.loadSetting("streamingRenderFPS",RN),Et.loadSetting("gitUserName",c$),Et.loadSetting("gitUserEmail",u$),Et.loadSetting("toolMaxSteps",NN),Et.loadSetting("prismThemeUrl",MN),Et.loadSetting("autoTitleEnabled",IN),Et.loadSetting("autoTitleModelId",jN),Et.loadSetting("autoTitlePromptMaxLength",ON),Et.loadSetting("autoTitleIncludeFiles",PN),Et.loadSetting("autoTitleIncludeRules",DN),Et.loadSetting("customFontFamily",FN),Et.loadSetting("customFontSize",LN),Et.loadSetting("chatMaxWidth",BN),Et.loadSetting("customThemeColors",$N),Et.loadSetting("autoScrollInterval",zN),Et.loadSetting("enableAutoScrollOnStream",UN),Et.loadSetting("autoSyncOnStreamComplete",d$),Et.loadSetting("autoInitializeReposOnStartup",f$)]),H={theme:n,temperature:r,maxTokens:s,topP:i,topK:a,presencePenalty:o,frequencyPenalty:l,globalSystemPrompt:c,enableAdvancedSettings:u,enableStreamingMarkdown:d,enableStreamingCodeBlockParsing:h,foldStreamingCodeBlocks:m,foldUserMessagesOnCompletion:y,streamingRenderFPS:b,gitUserName:v,gitUserEmail:x,toolMaxSteps:w,prismThemeUrl:S,autoTitleEnabled:C,autoTitleModelId:k,autoTitlePromptMaxLength:A,autoTitleIncludeFiles:R,autoTitleIncludeRules:N,customFontFamily:I,customFontSize:O,chatMaxWidth:L,customThemeColors:P,autoScrollInterval:V,enableAutoScrollOnStream:F,autoSyncOnStreamComplete:X,autoInitializeReposOnStartup:U};e(H),je.emit(sn.loaded,{settings:H})}catch(n){console.error("SettingsStore: Error loading settings",n),je.emit(sn.loaded,{settings:t()})}},resetGeneralSettings:async()=>{try{t().setEnableStreamingMarkdown(kN),t().setEnableStreamingCodeBlockParsing(EN),t().setFoldStreamingCodeBlocks(TN),t().setFoldUserMessagesOnCompletion(AN),t().setStreamingRenderFPS(RN),t().setAutoScrollInterval(zN),t().setEnableAutoScrollOnStream(UN),Oe.success("Streaming & Display settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting general settings",n),Oe.error("Failed to reset general settings.")}},resetAssistantSettings:async()=>{try{t().setGlobalSystemPrompt(bN),t().setTemperature(vN),t().setMaxTokens(xN),t().setTopP(wN),t().setTopK(_N),t().setPresencePenalty(SN),t().setFrequencyPenalty(CN),t().setToolMaxSteps(NN),t().setAutoTitleEnabled(IN),t().setAutoTitleModelId(jN),t().setAutoTitlePromptMaxLength(ON),t().setAutoTitleIncludeFiles(PN),t().setAutoTitleIncludeRules(DN),Oe.success("Assistant settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting assistant settings",n),Oe.error("Failed to reset assistant settings.")}},resetThemeSettings:async()=>{try{t().setTheme(yN),t().setPrismThemeUrl(MN),t().setCustomFontFamily(FN),t().setCustomFontSize(LN),t().setChatMaxWidth(BN),t().setCustomThemeColors($N),Oe.success("Theme settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting theme settings",n),Oe.error("Failed to reset theme settings.")}},getRegisteredActionHandlers:()=>{const n="settingsStore",r=t();return[{eventName:sn.setThemeRequest,handler:s=>r.setTheme(s.theme),storeId:n},{eventName:sn.setGlobalSystemPromptRequest,handler:s=>r.setGlobalSystemPrompt(s.prompt),storeId:n},{eventName:sn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:sn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:sn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:sn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:sn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:sn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:sn.setEnableAdvancedSettingsRequest,handler:s=>r.setEnableAdvancedSettings(s.enabled),storeId:n},{eventName:sn.setEnableStreamingMarkdownRequest,handler:s=>r.setEnableStreamingMarkdown(s.enabled),storeId:n},{eventName:sn.setEnableStreamingCodeBlockParsingRequest,handler:s=>r.setEnableStreamingCodeBlockParsing(s.enabled),storeId:n},{eventName:sn.setFoldStreamingCodeBlocksRequest,handler:s=>r.setFoldStreamingCodeBlocks(s.fold),storeId:n},{eventName:sn.setFoldUserMessagesOnCompletionRequest,handler:s=>r.setFoldUserMessagesOnCompletion(s.fold),storeId:n},{eventName:sn.setStreamingRenderFpsRequest,handler:s=>r.setStreamingRenderFPS(s.fps),storeId:n},{eventName:sn.setGitUserNameRequest,handler:s=>r.setGitUserName(s.name),storeId:n},{eventName:sn.setGitUserEmailRequest,handler:s=>r.setGitUserEmail(s.email),storeId:n},{eventName:sn.setToolMaxStepsRequest,handler:s=>r.setToolMaxSteps(s.steps),storeId:n},{eventName:sn.setPrismThemeUrlRequest,handler:s=>r.setPrismThemeUrl(s.url),storeId:n},{eventName:sn.setAutoTitleEnabledRequest,handler:s=>r.setAutoTitleEnabled(s.enabled),storeId:n},{eventName:sn.setAutoTitleModelIdRequest,handler:s=>r.setAutoTitleModelId(s.modelId),storeId:n},{eventName:sn.setAutoTitlePromptMaxLengthRequest,handler:s=>r.setAutoTitlePromptMaxLength(s.length),storeId:n},{eventName:sn.setAutoTitleIncludeFilesRequest,handler:s=>r.setAutoTitleIncludeFiles(s.include),storeId:n},{eventName:sn.setAutoTitleIncludeRulesRequest,handler:s=>r.setAutoTitleIncludeRules(s.include),storeId:n},{eventName:sn.setCustomFontFamilyRequest,handler:s=>r.setCustomFontFamily(s.fontFamily),storeId:n},{eventName:sn.setCustomFontSizeRequest,handler:s=>r.setCustomFontSize(s.fontSize),storeId:n},{eventName:sn.setChatMaxWidthRequest,handler:s=>r.setChatMaxWidth(s.maxWidth),storeId:n},{eventName:sn.setCustomThemeColorsRequest,handler:s=>r.setCustomThemeColors(s.colors),storeId:n},{eventName:sn.setCustomThemeColorRequest,handler:s=>r.setCustomThemeColor(s.colorKey,s.value),storeId:n},{eventName:sn.setAutoScrollIntervalRequest,handler:s=>r.setAutoScrollInterval(s.interval),storeId:n},{eventName:sn.setEnableAutoScrollOnStreamRequest,handler:s=>r.setEnableAutoScrollOnStream(s.enabled),storeId:n},{eventName:sn.setAutoSyncOnStreamCompleteRequest,handler:s=>r.setAutoSyncOnStreamComplete(s.enabled),storeId:n},{eventName:sn.setAutoInitializeReposOnStartupRequest,handler:s=>r.setAutoInitializeReposOnStartup(s.enabled),storeId:n},{eventName:sn.loadSettingsRequest,handler:()=>r.loadSettings(),storeId:n},{eventName:sn.resetGeneralSettingsRequest,handler:()=>r.resetGeneralSettings(),storeId:n},{eventName:sn.resetAssistantSettingsRequest,handler:()=>r.resetAssistantSettings(),storeId:n},{eventName:sn.resetThemeSettingsRequest,handler:()=>r.resetThemeSettings(),storeId:n}]}})));async function RC(e,t){const n=No.getState().getMiddlewareForHook,r=n(e);let s=t;for(const i of r)try{const a=await i.callback(s);if(a===!1)return console.log(`Middleware ${i.modId} cancelled action for hook ${e}`),!1;a&&typeof a=="object"&&(s=a)}catch(a){return console.error(`Middleware error in mod ${i.modId} for hook ${e}:`,a),!1}return s}function h$(){const e=Bn.getState(),t=Rr.getState(),n=yr.getState(),{providerId:r}=yc(t.selectedModelId),s={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme,gitUserName:n.gitUserName,gitUserEmail:n.gitUserEmail};return Object.freeze(s)}function exe(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function p$(e){try{const t=e.type||"application/octet-stream",n=zx(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:exe(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),Oe.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function lj(e){return e.flatMap(t=>{var s,i,a;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(s=r.metadata)!=null&&s.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(i=t.metadata)!=null&&i.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-call"&&c.toolCallId&&c.toolName&&c.args!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,c)}}),o.length>0&&n.push({role:"assistant",content:o})}if((a=t.metadata)!=null&&a.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-result"&&c.toolCallId&&c.toolName&&c.result!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,c)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const m$=e=>Symbol.iterator in e,g$=e=>"entries"in e,y$=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[s,i]of n)if(!Object.is(i,r.get(s)))return!1;return!0},txe=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let s=n.next(),i=r.next();for(;!s.done&&!i.done;){if(!Object.is(s.value,i.value))return!1;s=n.next(),i=r.next()}return!!s.done&&!!i.done};function nxe(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!m$(e)||!m$(t)?y$({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):g$(e)&&g$(t)?y$(e,t):txe(e,t)}function yn(e){const t=We.useRef(void 0);return n=>{const r=e(n);return nxe(t.current,r)?t.current:t.current=r}}var Y0=(e=>(e.PROMPT_TURN_FINALIZE="middleware.prompt.turnFinalize",e.INTERACTION_BEFORE_START="middleware.interaction.beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware.interaction.processChunk",e))(Y0||{});const Fn={initialized:"prompt.state.initialized",parameterChanged:"prompt.state.parameter.changed",transientParametersReset:"prompt.state.transient.parameters.reset",inputTextStateChanged:"prompt.state.input.text.changed",submitted:"prompt.state.submitted",setModelIdRequest:"prompt.state.set.model.id.request",setTemperatureRequest:"prompt.state.set.temperature.request",setMaxTokensRequest:"prompt.state.set.max.tokens.request",setTopPRequest:"prompt.state.set.top.p.request",setTopKRequest:"prompt.state.set.top.k.request",setPresencePenaltyRequest:"prompt.state.set.presence.penalty.request",setFrequencyPenaltyRequest:"prompt.state.set.frequency.penalty.request",setReasoningEnabledRequest:"prompt.state.set.reasoning.enabled.request",setWebSearchEnabledRequest:"prompt.state.set.web.search.enabled.request",setImageGenerationEnabledRequest:"prompt.state.set.image.generation.enabled.request",setStructuredOutputJsonRequest:"prompt.state.set.structured.output.json.request",initializePromptStateRequest:"prompt.state.initialize.prompt.state.request",resetTransientParametersRequest:"prompt.state.reset.transient.parameters.request",setInputTextRequest:"prompt.input.set.text.request",inputChanged:"prompt.inputChanged"},nc=(e,t)=>{je.emit(Fn.parameterChanged,{params:{[e]:t}})},Mo=Fo(Lo((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,imageGenerationEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),nc("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),nc("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),nc("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),nc("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),nc("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),nc("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),nc("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),nc("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),nc("webSearchEnabled",n))},setImageGenerationEnabled:n=>{t().imageGenerationEnabled!==n&&(e({imageGenerationEnabled:n}),nc("imageGenerationEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),nc("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),s={};let i=!1;r.modelId!==n.modelId&&(s.modelId=n.modelId,i=!0),r.temperature!==n.temperature&&(s.temperature=n.temperature,i=!0),r.maxTokens!==n.maxTokens&&(s.maxTokens=n.maxTokens,i=!0),r.topP!==n.topP&&(s.topP=n.topP,i=!0),r.topK!==n.topK&&(s.topK=n.topK,i=!0),r.presencePenalty!==n.presencePenalty&&(s.presencePenalty=n.presencePenalty,i=!0),r.frequencyPenalty!==n.frequencyPenalty&&(s.frequencyPenalty=n.frequencyPenalty,i=!0),i&&(e(s),je.emit(Fn.parameterChanged,{params:s})),je.emit(Fn.initialized,{state:{...t()}})},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let s=!1;n.temperature!==null&&(r.temperature=null,s=!0),n.maxTokens!==null&&(r.maxTokens=null,s=!0),n.topP!==null&&(r.topP=null,s=!0),n.topK!==null&&(r.topK=null,s=!0),n.presencePenalty!==null&&(r.presencePenalty=null,s=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,s=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,s=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,s=!0),n.imageGenerationEnabled!==null&&(r.imageGenerationEnabled=null,s=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,s=!0),s&&(e(r),je.emit(Fn.parameterChanged,{params:r})),je.emit(Fn.transientParametersReset,void 0)},getRegisteredActionHandlers:()=>{const n="promptStateStore",r=t();return[{eventName:Fn.setModelIdRequest,handler:s=>r.setModelId(s.id),storeId:n},{eventName:Fn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:Fn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:Fn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:Fn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:Fn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:Fn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:Fn.setReasoningEnabledRequest,handler:s=>r.setReasoningEnabled(s.enabled),storeId:n},{eventName:Fn.setWebSearchEnabledRequest,handler:s=>r.setWebSearchEnabled(s.enabled),storeId:n},{eventName:Fn.setImageGenerationEnabledRequest,handler:s=>r.setImageGenerationEnabled(s.enabled),storeId:n},{eventName:Fn.setStructuredOutputJsonRequest,handler:s=>r.setStructuredOutputJson(s.json),storeId:n},{eventName:Fn.initializePromptStateRequest,handler:s=>r.initializePromptState(s.effectiveSettings),storeId:n},{eventName:Fn.resetTransientParametersRequest,handler:()=>r.resetTransientParameters(),storeId:n}]}}))),rxe=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message...",inputAreaRef:s,selectedItemId:i,selectedItemType:a})=>{const[o,l]=T.useState(!1),[c,u]=T.useState(!1),d=No(yn(k=>k.promptControls)),h=Bn(yn(k=>k.status==="streaming")),{attachedFilesMetadata:m,clearAttachedFiles:y}=hh(yn(k=>({attachedFilesMetadata:k.attachedFilesMetadata,clearAttachedFiles:k.clearAttachedFiles}))),b=Mo(k=>k.modelId);T.useEffect(()=>{a==="conversation"&&i&&requestAnimationFrame(()=>{var k;(k=s.current)==null||k.focus()})},[i,a,s]);const v=T.useMemo(()=>Object.values(d),[d]),x=T.useMemo(()=>v.filter(k=>k.renderer),[v]),w=T.useMemo(()=>v.filter(k=>k.triggerRenderer),[v]),S=T.useCallback(async()=>{var N,I;const A=(((N=s==null?void 0:s.current)==null?void 0:N.getValue())??"").trim(),R=hh.getState().attachedFilesMetadata;if(!(!A&&R.length===0)&&!(h||o)){l(!0);try{let O={},L={};for(const U of v){if(U.getParameters){const H=await U.getParameters();H&&(O={...O,...H})}if(U.getMetadata){const H=await U.getMetadata();H&&(L={...L,...H})}}R.length>0&&(L.attachedFiles=[...R]),!L.modelId&&b&&(L.modelId=b);const P=v.find(U=>U.id==="core-rules-tags");if(P&&L.activeRuleIds&&L.activeTagIds){const U=[],H=new Set(L.activeRuleIds);L.activeTagIds.forEach($=>{P.getRulesForTag($).forEach(ne=>H.add(ne.id))}),H.forEach($=>{const ne=P.getRuleById($);ne&&U.push({type:ne.type,content:ne.content,sourceRuleId:ne.id})}),L.effectiveRulesContent=U}let V={id:qi(),content:A,parameters:O,metadata:L};je.emit(Fn.submitted,{turnData:V});const F=await RC(Y0.PROMPT_TURN_FINALIZE,{turnData:V});if(F===!1){console.log("Prompt submission cancelled by middleware."),l(!1);return}const X=F&&typeof F=="object"?F.turnData:V;await t(X),y(),v.forEach(U=>{U.clearOnSubmit&&U.clearOnSubmit()}),(I=s.current)==null||I.clearValue(),u(!1)}catch(O){console.error("Error during prompt submission:",O),Oe.error(`Failed to send message: ${O instanceof Error?O.message:String(O)}`)}finally{l(!1)}}},[s,h,o,v,t,y,b]),C=T.useCallback(k=>{u(k.trim().length>0)},[]);return f.jsxs("div",{className:Ze("p-2 md:p-4 space-y-2 md:space-y-3",n),children:[x.length>0&&f.jsx(wB,{controls:x,area:"panel",className:"flex flex-wrap gap-1 md:gap-2 items-start mb-1 md:mb-2"}),f.jsxs("div",{className:"flex items-end gap-2",children:[f.jsx(e,{ref:s,onSubmit:S,disabled:h||o,placeholder:r,onValueChange:C,className:"flex-grow"}),f.jsx(bt,{type:"button",size:"icon",onClick:S,disabled:h||o||!c&&m.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:o?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(dge,{className:"h-4 w-4"})})]})," ",f.jsx(wB,{controls:w,area:"trigger",className:"flex items-center gap-1 flex-wrap flex-shrink-0 mt-1 md:mt-2"})]})};function Wt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function sxe(e,t){const n=T.createContext(t),r=i=>{const{children:a,...o}=i,l=T.useMemo(()=>o,Object.values(o));return f.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function s(i){const a=T.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Wi(e,t=[]){let n=[];function r(i,a){const o=T.createContext(a),l=n.length;n=[...n,a];const c=d=>{var x;const{scope:h,children:m,...y}=d,b=((x=h==null?void 0:h[e])==null?void 0:x[l])||o,v=T.useMemo(()=>y,Object.values(y));return f.jsx(b.Provider,{value:v,children:m})};c.displayName=i+"Provider";function u(d,h){var b;const m=((b=h==null?void 0:h[e])==null?void 0:b[l])||o,y=T.useContext(m);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(a=>T.createContext(a));return function(o){const l=(o==null?void 0:o[e])||i;return T.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return s.scopeName=e,[r,ixe(s,...t)]}function ixe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...o,...d}},{});return T.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function axe(e){const t=oxe(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(cxe);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function oxe(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=dxe(s),o=uxe(i,s.props);return s.type!==T.Fragment&&(o.ref=r?ll(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var lxe=Symbol("radix.slottable");function cxe(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===lxe}function uxe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function dxe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var fxe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ar=fxe.reduce((e,t)=>{const n=axe(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function TG(e,t){e&&rl.flushSync(()=>e.dispatchEvent(t))}function Cs(e){const t=T.useRef(e);return T.useEffect(()=>{t.current=e}),T.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function KO(e,t=globalThis==null?void 0:globalThis.document){const n=Cs(e);T.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var hxe="DismissableLayer",cj="dismissableLayer.update",pxe="dismissableLayer.pointerDownOutside",mxe="dismissableLayer.focusOutside",b$,AG=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),wE=T.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=T.useContext(AG),[u,d]=T.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=T.useState({}),y=Rn(t,R=>d(R)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,C=w>=x,k=bxe(R=>{const N=R.target,I=[...c.branches].some(O=>O.contains(N));!C||I||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),A=vxe(R=>{const N=R.target;[...c.branches].some(O=>O.contains(N))||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return KO(R=>{w===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),T.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(b$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),v$(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=b$)}},[u,h,n,c]),T.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),v$())},[u,c]),T.useEffect(()=>{const R=()=>m({});return document.addEventListener(cj,R),()=>document.removeEventListener(cj,R)},[]),f.jsx(ar.div,{...l,ref:y,style:{pointerEvents:S?C?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,A.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,k.onPointerDownCapture)})});wE.displayName=hxe;var gxe="DismissableLayerBranch",yxe=T.forwardRef((e,t)=>{const n=T.useContext(AG),r=T.useRef(null),s=Rn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(ar.div,{...e,ref:s})});yxe.displayName=gxe;function bxe(e,t=globalThis==null?void 0:globalThis.document){const n=Cs(e),r=T.useRef(!1),s=T.useRef(()=>{});return T.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){RG(pxe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function vxe(e,t=globalThis==null?void 0:globalThis.document){const n=Cs(e),r=T.useRef(!1);return T.useEffect(()=>{const s=i=>{i.target&&!r.current&&RG(mxe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function v$(){const e=new CustomEvent(cj);document.dispatchEvent(e)}function RG(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?TG(s,i):s.dispatchEvent(i)}var ti=globalThis!=null&&globalThis.document?T.useLayoutEffect:()=>{},xxe=zW[" useId ".trim().toString()]||(()=>{}),wxe=0;function ia(e){const[t,n]=T.useState(xxe());return ti(()=>{n(r=>r??String(wxe++))},[e]),t?`radix-${t}`:""}const _xe=["top","right","bottom","left"],yh=Math.min,nl=Math.max,NC=Math.round,CS=Math.floor,yu=e=>({x:e,y:e}),Sxe={left:"right",right:"left",bottom:"top",top:"bottom"},Cxe={start:"end",end:"start"};function uj(e,t,n){return nl(e,yh(t,n))}function Fd(e,t){return typeof e=="function"?e(t):e}function Ld(e){return e.split("-")[0]}function Oy(e){return e.split("-")[1]}function YO(e){return e==="x"?"y":"x"}function ZO(e){return e==="y"?"height":"width"}function bh(e){return["top","bottom"].includes(Ld(e))?"y":"x"}function XO(e){return YO(bh(e))}function kxe(e,t,n){n===void 0&&(n=!1);const r=Oy(e),s=XO(e),i=ZO(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=MC(a)),[a,MC(a)]}function Exe(e){const t=MC(e);return[dj(e),t,dj(t)]}function dj(e){return e.replace(/start|end/g,t=>Cxe[t])}function Txe(e,t,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?i:a;default:return[]}}function Axe(e,t,n,r){const s=Oy(e);let i=Txe(Ld(e),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),t&&(i=i.concat(i.map(dj)))),i}function MC(e){return e.replace(/left|right|bottom|top/g,t=>Sxe[t])}function Rxe(e){return{top:0,right:0,bottom:0,left:0,...e}}function NG(e){return typeof e!="number"?Rxe(e):{top:e,right:e,bottom:e,left:e}}function IC(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function x$(e,t,n){let{reference:r,floating:s}=e;const i=bh(t),a=XO(t),o=ZO(a),l=Ld(t),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[o]/2-s[o]/2;let m;switch(l){case"top":m={x:u,y:r.y-s.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:d};break;case"left":m={x:r.x-s.width,y:d};break;default:m={x:r.x,y:r.y}}switch(Oy(t)){case"start":m[a]-=h*(n&&c?-1:1);break;case"end":m[a]+=h*(n&&c?-1:1);break}return m}const Nxe=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:d}=x$(c,r,l),h=r,m={},y=0;for(let b=0;b<o.length;b++){const{name:v,fn:x}=o[b],{x:w,y:S,data:C,reset:k}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:m,rects:c,platform:a,elements:{reference:e,floating:t}});u=w??u,d=S??d,m={...m,[v]:{...m[v],...C}},k&&y<=50&&(y++,typeof k=="object"&&(k.placement&&(h=k.placement),k.rects&&(c=k.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):k.rects),{x:u,y:d}=x$(c,h,l)),b=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:m}};async function Wx(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:m=0}=Fd(t,e),y=NG(m),v=o[h?d==="floating"?"reference":"floating":d],x=IC(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),C=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},k=IC(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:S,strategy:l}):w);return{top:(x.top-k.top+y.top)/C.y,bottom:(k.bottom-x.bottom+y.bottom)/C.y,left:(x.left-k.left+y.left)/C.x,right:(k.right-x.right+y.right)/C.x}}const Mxe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=Fd(e,t)||{};if(c==null)return{};const d=NG(u),h={x:n,y:r},m=XO(s),y=ZO(m),b=await a.getDimensions(c),v=m==="y",x=v?"top":"left",w=v?"bottom":"right",S=v?"clientHeight":"clientWidth",C=i.reference[y]+i.reference[m]-h[m]-i.floating[y],k=h[m]-i.reference[m],A=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let R=A?A[S]:0;(!R||!await(a.isElement==null?void 0:a.isElement(A)))&&(R=o.floating[S]||i.floating[y]);const N=C/2-k/2,I=R/2-b[y]/2-1,O=yh(d[x],I),L=yh(d[w],I),P=O,V=R-b[y]-L,F=R/2-b[y]/2+N,X=uj(P,F,V),U=!l.arrow&&Oy(s)!=null&&F!==X&&i.reference[y]/2-(F<P?O:L)-b[y]/2<0,H=U?F<P?F-P:F-V:0;return{[m]:h[m]+H,data:{[m]:X,centerOffset:F-X-H,...U&&{alignmentOffset:H}},reset:U}}}),Ixe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...v}=Fd(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=Ld(s),w=bh(o),S=Ld(o)===o,C=await(l.isRTL==null?void 0:l.isRTL(c.floating)),k=h||(S||!b?[MC(o)]:Exe(o)),A=y!=="none";!h&&A&&k.push(...Axe(o,b,y,C));const R=[o,...k],N=await Wx(t,v),I=[];let O=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&I.push(N[x]),d){const F=kxe(s,a,C);I.push(N[F[0]],N[F[1]])}if(O=[...O,{placement:s,overflows:I}],!I.every(F=>F<=0)){var L,P;const F=(((L=i.flip)==null?void 0:L.index)||0)+1,X=R[F];if(X)return{data:{index:F,overflows:O},reset:{placement:X}};let U=(P=O.filter(H=>H.overflows[0]<=0).sort((H,$)=>H.overflows[1]-$.overflows[1])[0])==null?void 0:P.placement;if(!U)switch(m){case"bestFit":{var V;const H=(V=O.filter($=>{if(A){const ne=bh($.placement);return ne===w||ne==="y"}return!0}).map($=>[$.placement,$.overflows.filter(ne=>ne>0).reduce((ne,W)=>ne+W,0)]).sort(($,ne)=>$[1]-ne[1])[0])==null?void 0:V[0];H&&(U=H);break}case"initialPlacement":U=o;break}if(s!==U)return{reset:{placement:U}}}return{}}}};function w$(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function _$(e){return _xe.some(t=>e[t]>=0)}const jxe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=Fd(e,t);switch(r){case"referenceHidden":{const i=await Wx(t,{...s,elementContext:"reference"}),a=w$(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:_$(a)}}}case"escaped":{const i=await Wx(t,{...s,altBoundary:!0}),a=w$(i,n.floating);return{data:{escapedOffsets:a,escaped:_$(a)}}}default:return{}}}}};async function Oxe(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=Ld(n),o=Oy(n),l=bh(n)==="y",c=["left","top"].includes(a)?-1:1,u=i&&l?-1:1,d=Fd(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof y=="number"&&(m=o==="end"?y*-1:y),l?{x:m*u,y:h*c}:{x:h*c,y:m*u}}const Pxe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:a,middlewareData:o}=t,l=await Oxe(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}}},Dxe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:v=>{let{x,y:w}=v;return{x,y:w}}},...l}=Fd(e,t),c={x:n,y:r},u=await Wx(t,l),d=bh(Ld(s)),h=YO(d);let m=c[h],y=c[d];if(i){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=m+u[v],S=m-u[x];m=uj(w,m,S)}if(a){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=y+u[v],S=y-u[x];y=uj(w,y,S)}const b=o.fn({...t,[h]:m,[d]:y});return{...b,data:{x:b.x-n,y:b.y-r,enabled:{[h]:i,[d]:a}}}}}},Fxe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Fd(e,t),u={x:n,y:r},d=bh(s),h=YO(d);let m=u[h],y=u[d];const b=Fd(o,t),v=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const S=h==="y"?"height":"width",C=i.reference[h]-i.floating[S]+v.mainAxis,k=i.reference[h]+i.reference[S]-v.mainAxis;m<C?m=C:m>k&&(m=k)}if(c){var x,w;const S=h==="y"?"width":"height",C=["top","left"].includes(Ld(s)),k=i.reference[d]-i.floating[S]+(C&&((x=a.offset)==null?void 0:x[d])||0)+(C?0:v.crossAxis),A=i.reference[d]+i.reference[S]+(C?0:((w=a.offset)==null?void 0:w[d])||0)-(C?v.crossAxis:0);y<k?y=k:y>A&&(y=A)}return{[h]:m,[d]:y}}}},Lxe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:a,elements:o}=t,{apply:l=()=>{},...c}=Fd(e,t),u=await Wx(t,c),d=Ld(s),h=Oy(s),m=bh(s)==="y",{width:y,height:b}=i.floating;let v,x;d==="top"||d==="bottom"?(v=d,x=h===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(x=d,v=h==="end"?"top":"bottom");const w=b-u.top-u.bottom,S=y-u.left-u.right,C=yh(b-u[v],w),k=yh(y-u[x],S),A=!t.middlewareData.shift;let R=C,N=k;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(N=S),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(R=w),A&&!h){const O=nl(u.left,0),L=nl(u.right,0),P=nl(u.top,0),V=nl(u.bottom,0);m?N=y-2*(O!==0||L!==0?O+L:nl(u.left,u.right)):R=b-2*(P!==0||V!==0?P+V:nl(u.top,u.bottom))}await l({...t,availableWidth:N,availableHeight:R});const I=await a.getDimensions(o.floating);return y!==I.width||b!==I.height?{reset:{rects:!0}}:{}}}};function _E(){return typeof window<"u"}function Py(e){return MG(e)?(e.nodeName||"").toLowerCase():"#document"}function il(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Iu(e){var t;return(t=(MG(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function MG(e){return _E()?e instanceof Node||e instanceof il(e).Node:!1}function Cc(e){return _E()?e instanceof Element||e instanceof il(e).Element:!1}function Tu(e){return _E()?e instanceof HTMLElement||e instanceof il(e).HTMLElement:!1}function S$(e){return!_E()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof il(e).ShadowRoot}function l1(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=kc(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function Bxe(e){return["table","td","th"].includes(Py(e))}function SE(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function JO(e){const t=QO(),n=Cc(e)?kc(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function $xe(e){let t=vh(e);for(;Tu(t)&&!Z0(t);){if(JO(t))return t;if(SE(t))return null;t=vh(t)}return null}function QO(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Z0(e){return["html","body","#document"].includes(Py(e))}function kc(e){return il(e).getComputedStyle(e)}function CE(e){return Cc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function vh(e){if(Py(e)==="html")return e;const t=e.assignedSlot||e.parentNode||S$(e)&&e.host||Iu(e);return S$(t)?t.host:t}function IG(e){const t=vh(e);return Z0(t)?e.ownerDocument?e.ownerDocument.body:e.body:Tu(t)&&l1(t)?t:IG(t)}function Hx(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=IG(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),a=il(s);if(i){const o=fj(a);return t.concat(a,a.visualViewport||[],l1(s)?s:[],o&&n?Hx(o):[])}return t.concat(s,Hx(s,[],n))}function fj(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function jG(e){const t=kc(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=Tu(e),i=s?e.offsetWidth:n,a=s?e.offsetHeight:r,o=NC(n)!==i||NC(r)!==a;return o&&(n=i,r=a),{width:n,height:r,$:o}}function eP(e){return Cc(e)?e:e.contextElement}function C0(e){const t=eP(e);if(!Tu(t))return yu(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=jG(t);let a=(i?NC(n.width):n.width)/r,o=(i?NC(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const zxe=yu(0);function OG(e){const t=il(e);return!QO()||!t.visualViewport?zxe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Uxe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==il(e)?!1:t}function pm(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=eP(e);let a=yu(1);t&&(r?Cc(r)&&(a=C0(r)):a=C0(e));const o=Uxe(i,n,r)?OG(i):yu(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,u=s.width/a.x,d=s.height/a.y;if(i){const h=il(i),m=r&&Cc(r)?il(r):r;let y=h,b=fj(y);for(;b&&r&&m!==y;){const v=C0(b),x=b.getBoundingClientRect(),w=kc(b),S=x.left+(b.clientLeft+parseFloat(w.paddingLeft))*v.x,C=x.top+(b.clientTop+parseFloat(w.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=S,c+=C,y=il(b),b=fj(y)}}return IC({width:u,height:d,x:l,y:c})}function tP(e,t){const n=CE(e).scrollLeft;return t?t.left+n:pm(Iu(e)).left+n}function PG(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:tP(e,r)),i=r.top+t.scrollTop;return{x:s,y:i}}function qxe(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",a=Iu(r),o=t?SE(t.floating):!1;if(r===a||o&&i)return n;let l={scrollLeft:0,scrollTop:0},c=yu(1);const u=yu(0),d=Tu(r);if((d||!d&&!i)&&((Py(r)!=="body"||l1(a))&&(l=CE(r)),Tu(r))){const m=pm(r);c=C0(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}const h=a&&!d&&!i?PG(a,l,!0):yu(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function Vxe(e){return Array.from(e.getClientRects())}function Wxe(e){const t=Iu(e),n=CE(e),r=e.ownerDocument.body,s=nl(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=nl(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+tP(e);const o=-n.scrollTop;return kc(r).direction==="rtl"&&(a+=nl(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}function Hxe(e,t){const n=il(e),r=Iu(e),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;const c=QO();(!c||c&&t==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}return{width:i,height:a,x:o,y:l}}function Gxe(e,t){const n=pm(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=Tu(e)?C0(e):yu(1),a=e.clientWidth*i.x,o=e.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:a,height:o,x:l,y:c}}function C$(e,t,n){let r;if(t==="viewport")r=Hxe(e,n);else if(t==="document")r=Wxe(Iu(e));else if(Cc(t))r=Gxe(t,n);else{const s=OG(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return IC(r)}function DG(e,t){const n=vh(e);return n===t||!Cc(n)||Z0(n)?!1:kc(n).position==="fixed"||DG(n,t)}function Kxe(e,t){const n=t.get(e);if(n)return n;let r=Hx(e,[],!1).filter(o=>Cc(o)&&Py(o)!=="body"),s=null;const i=kc(e).position==="fixed";let a=i?vh(e):e;for(;Cc(a)&&!Z0(a);){const o=kc(a),l=JO(a);!l&&o.position==="fixed"&&(s=null),(i?!l&&!s:!l&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||l1(a)&&!l&&DG(e,a))?r=r.filter(u=>u!==a):s=o,a=vh(a)}return t.set(e,r),r}function Yxe(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const a=[...n==="clippingAncestors"?SE(t)?[]:Kxe(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const d=C$(t,u,s);return c.top=nl(d.top,c.top),c.right=yh(d.right,c.right),c.bottom=yh(d.bottom,c.bottom),c.left=nl(d.left,c.left),c},C$(t,o,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Zxe(e){const{width:t,height:n}=jG(e);return{width:t,height:n}}function Xxe(e,t,n){const r=Tu(t),s=Iu(t),i=n==="fixed",a=pm(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=yu(0);if(r||!r&&!i)if((Py(t)!=="body"||l1(s))&&(o=CE(t)),r){const h=pm(t,!0,i,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else s&&(l.x=tP(s));const c=s&&!r&&!i?PG(s,o):yu(0),u=a.left+o.scrollLeft-l.x-c.x,d=a.top+o.scrollTop-l.y-c.y;return{x:u,y:d,width:a.width,height:a.height}}function qN(e){return kc(e).position==="static"}function k$(e,t){if(!Tu(e)||kc(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Iu(e)===n&&(n=n.ownerDocument.body),n}function FG(e,t){const n=il(e);if(SE(e))return n;if(!Tu(e)){let s=vh(e);for(;s&&!Z0(s);){if(Cc(s)&&!qN(s))return s;s=vh(s)}return n}let r=k$(e,t);for(;r&&Bxe(r)&&qN(r);)r=k$(r,t);return r&&Z0(r)&&qN(r)&&!JO(r)?n:r||$xe(e)||n}const Jxe=async function(e){const t=this.getOffsetParent||FG,n=this.getDimensions,r=await n(e.floating);return{reference:Xxe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Qxe(e){return kc(e).direction==="rtl"}const ewe={convertOffsetParentRelativeRectToViewportRelativeRect:qxe,getDocumentElement:Iu,getClippingRect:Yxe,getOffsetParent:FG,getElementRects:Jxe,getClientRects:Vxe,getDimensions:Zxe,getScale:C0,isElement:Cc,isRTL:Qxe};function LG(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function twe(e,t){let n=null,r;const s=Iu(e);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:m}=c;if(o||t(),!h||!m)return;const y=CS(d),b=CS(s.clientWidth-(u+h)),v=CS(s.clientHeight-(d+m)),x=CS(u),S={rootMargin:-y+"px "+-b+"px "+-v+"px "+-x+"px",threshold:nl(0,yh(1,l))||1};let C=!0;function k(A){const R=A[0].intersectionRatio;if(R!==l){if(!C)return a();R?a(!1,R):r=setTimeout(()=>{a(!1,1e-7)},1e3)}R===1&&!LG(c,e.getBoundingClientRect())&&a(),C=!1}try{n=new IntersectionObserver(k,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(k,S)}n.observe(e)}return a(!0),i}function nP(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=eP(e),u=s||i?[...c?Hx(c):[],...Hx(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const d=c&&o?twe(c,n):null;let h=-1,m=null;a&&(m=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(t)})),n()}),c&&!l&&m.observe(c),m.observe(t));let y,b=l?pm(e):null;l&&v();function v(){const x=pm(e);b&&!LG(b,x)&&n(),b=x,y=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(w=>{s&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),d==null||d(),(x=m)==null||x.disconnect(),m=null,l&&cancelAnimationFrame(y)}}const nwe=Pxe,rwe=Dxe,swe=Ixe,iwe=Lxe,awe=jxe,E$=Mxe,owe=Fxe,lwe=(e,t,n)=>{const r=new Map,s={platform:ewe,...n},i={...s.platform,_c:r};return Nxe(e,t,{...s,platform:i})};var C2=typeof document<"u"?T.useLayoutEffect:T.useEffect;function jC(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!jC(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!jC(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function BG(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function T$(e,t){const n=BG(e);return Math.round(t*n)/n}function VN(e){const t=T.useRef(e);return C2(()=>{t.current=e}),t}function rP(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=T.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=T.useState(r);jC(h,r)||m(r);const[y,b]=T.useState(null),[v,x]=T.useState(null),w=T.useCallback($=>{$!==A.current&&(A.current=$,b($))},[]),S=T.useCallback($=>{$!==R.current&&(R.current=$,x($))},[]),C=i||y,k=a||v,A=T.useRef(null),R=T.useRef(null),N=T.useRef(u),I=l!=null,O=VN(l),L=VN(s),P=VN(c),V=T.useCallback(()=>{if(!A.current||!R.current)return;const $={placement:t,strategy:n,middleware:h};L.current&&($.platform=L.current),lwe(A.current,R.current,$).then(ne=>{const W={...ne,isPositioned:P.current!==!1};F.current&&!jC(N.current,W)&&(N.current=W,rl.flushSync(()=>{d(W)}))})},[h,t,n,L,P]);C2(()=>{c===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d($=>({...$,isPositioned:!1})))},[c]);const F=T.useRef(!1);C2(()=>(F.current=!0,()=>{F.current=!1}),[]),C2(()=>{if(C&&(A.current=C),k&&(R.current=k),C&&k){if(O.current)return O.current(C,k,V);V()}},[C,k,V,O,I]);const X=T.useMemo(()=>({reference:A,floating:R,setReference:w,setFloating:S}),[w,S]),U=T.useMemo(()=>({reference:C,floating:k}),[C,k]),H=T.useMemo(()=>{const $={position:n,left:0,top:0};if(!U.floating)return $;const ne=T$(U.floating,u.x),W=T$(U.floating,u.y);return o?{...$,transform:"translate("+ne+"px, "+W+"px)",...BG(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ne,top:W}},[n,o,U.floating,u.x,u.y]);return T.useMemo(()=>({...u,update:V,refs:X,elements:U,floatingStyles:H}),[u,V,X,U,H])}const cwe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?E$({element:r.current,padding:s}).fn(n):{}:r?E$({element:r,padding:s}).fn(n):{}}}},sP=(e,t)=>({...nwe(e),options:[e,t]}),iP=(e,t)=>({...rwe(e),options:[e,t]}),aP=(e,t)=>({...owe(e),options:[e,t]}),oP=(e,t)=>({...swe(e),options:[e,t]}),lP=(e,t)=>({...iwe(e),options:[e,t]}),cP=(e,t)=>({...awe(e),options:[e,t]}),uP=(e,t)=>({...cwe(e),options:[e,t]});var uwe="Arrow",$G=T.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(ar.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});$G.displayName=uwe;var dwe=$G;function Dy(e){const[t,n]=T.useState(void 0);return ti(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;n({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var dP="Popper",[zG,kE]=Wi(dP),[fwe,UG]=zG(dP),qG=e=>{const{__scopePopper:t,children:n}=e,[r,s]=T.useState(null);return f.jsx(fwe,{scope:t,anchor:r,onAnchorChange:s,children:n})};qG.displayName=dP;var VG="PopperAnchor",WG=T.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=UG(VG,n),a=T.useRef(null),o=Rn(t,a);return T.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(ar.div,{...s,ref:o})});WG.displayName=VG;var fP="PopperContent",[hwe,pwe]=zG(fP),HG=T.forwardRef((e,t)=>{var De,Se,Ce,qe,Qe,Ve;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=UG(fP,n),[x,w]=T.useState(null),S=Rn(t,Ne=>w(Ne)),[C,k]=T.useState(null),A=Dy(C),R=(A==null?void 0:A.width)??0,N=(A==null?void 0:A.height)??0,I=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],P=L.length>0,V={padding:O,boundary:L.filter(gwe),altBoundary:P},{refs:F,floatingStyles:X,placement:U,isPositioned:H,middlewareData:$}=rP({strategy:"fixed",placement:I,whileElementsMounted:(...Ne)=>nP(...Ne,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[sP({mainAxis:s+N,alignmentAxis:a}),l&&iP({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?aP():void 0,...V}),l&&oP({...V}),lP({...V,apply:({elements:Ne,rects:K,availableWidth:me,availableHeight:Ae})=>{const{width:le,height:oe}=K.reference,re=Ne.floating.style;re.setProperty("--radix-popper-available-width",`${me}px`),re.setProperty("--radix-popper-available-height",`${Ae}px`),re.setProperty("--radix-popper-anchor-width",`${le}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),C&&uP({element:C,padding:o}),ywe({arrowWidth:R,arrowHeight:N}),h&&cP({strategy:"referenceHidden",...V})]}),[ne,W]=YG(U),Q=Cs(y);ti(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(De=$.arrow)==null?void 0:De.x,se=(Se=$.arrow)==null?void 0:Se.y,pe=((Ce=$.arrow)==null?void 0:Ce.centerOffset)!==0,[ce,Ie]=T.useState();return ti(()=>{x&&Ie(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...X,transform:H?X.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(qe=$.transformOrigin)==null?void 0:qe.x,(Qe=$.transformOrigin)==null?void 0:Qe.y].join(" "),...((Ve=$.hide)==null?void 0:Ve.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(hwe,{scope:n,placedSide:ne,onArrowChange:k,arrowX:ee,arrowY:se,shouldHideArrow:pe,children:f.jsx(ar.div,{"data-side":ne,"data-align":W,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});HG.displayName=fP;var GG="PopperArrow",mwe={top:"bottom",right:"left",bottom:"top",left:"right"},KG=T.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=pwe(GG,r),a=mwe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(dwe,{...s,ref:n,style:{...s.style,display:"block"}})})});KG.displayName=GG;function gwe(e){return e!==null}var ywe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=YG(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function YG(e){const[t,n="center"]=e.split("-");return[t,n]}var ZG=qG,XG=WG,JG=HG,QG=KG,bwe="Portal",EE=T.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=T.useState(!1);ti(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?pE.createPortal(f.jsx(ar.div,{...r,ref:t}),a):null});EE.displayName=bwe;function vwe(e,t){return T.useReducer((n,r)=>t[n][r]??n,e)}var oa=e=>{const{present:t,children:n}=e,r=xwe(t),s=typeof n=="function"?n({present:r.isPresent}):T.Children.only(n),i=Rn(r.ref,wwe(s));return typeof n=="function"||r.isPresent?T.cloneElement(s,{ref:i}):null};oa.displayName="Presence";function xwe(e){const[t,n]=T.useState(),r=T.useRef(null),s=T.useRef(e),i=T.useRef("none"),a=e?"mounted":"unmounted",[o,l]=vwe(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return T.useEffect(()=>{const c=kS(r.current);i.current=o==="mounted"?c:"none"},[o]),ti(()=>{const c=r.current,u=s.current;if(u!==e){const h=i.current,m=kS(c);e?l("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),ti(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=m=>{const b=kS(r.current).includes(m.animationName);if(m.target===t&&b&&(l("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=m=>{m.target===t&&(i.current=kS(r.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:T.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function kS(e){return(e==null?void 0:e.animationName)||"none"}function wwe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var _we=Symbol("radix.slottable");function Swe(e){const t=({children:n})=>f.jsx(f.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=_we,t}var Cwe=zW[" useInsertionEffect ".trim().toString()]||ti;function Ec({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,a]=kwe({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:s;{const u=T.useRef(e!==void 0);T.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=T.useCallback(u=>{var d;if(o){const h=Ewe(u)?u(e):u;h!==e&&((d=a.current)==null||d.call(a,h))}else i(u)},[o,e,i,a]);return[l,c]}function kwe({defaultProp:e,onChange:t}){const[n,r]=T.useState(e),s=T.useRef(n),i=T.useRef(t);return Cwe(()=>{i.current=t},[t]),T.useEffect(()=>{var a;s.current!==n&&((a=i.current)==null||a.call(i,n),s.current=n)},[n,s]),[n,r,i]}function Ewe(e){return typeof e=="function"}var Twe=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Awe="VisuallyHidden",eK=T.forwardRef((e,t)=>f.jsx(ar.span,{...e,ref:t,style:{...Twe,...e.style}}));eK.displayName=Awe;var Rwe=eK,[TE,Tut]=Wi("Tooltip",[kE]),AE=kE(),tK="TooltipProvider",Nwe=700,hj="tooltip.open",[Mwe,hP]=TE(tK),nK=e=>{const{__scopeTooltip:t,delayDuration:n=Nwe,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,a=T.useRef(!0),o=T.useRef(!1),l=T.useRef(0);return T.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),f.jsx(Mwe,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:T.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:T.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:T.useCallback(c=>{o.current=c},[]),disableHoverableContent:s,children:i})};nK.displayName=tK;var Gx="Tooltip",[Iwe,c1]=TE(Gx),rK=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:a,delayDuration:o}=e,l=hP(Gx,e.__scopeTooltip),c=AE(t),[u,d]=T.useState(null),h=ia(),m=T.useRef(0),y=a??l.disableHoverableContent,b=o??l.delayDuration,v=T.useRef(!1),[x,w]=Ec({prop:r,defaultProp:s??!1,onChange:R=>{R?(l.onOpen(),document.dispatchEvent(new CustomEvent(hj))):l.onClose(),i==null||i(R)},caller:Gx}),S=T.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),C=T.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v.current=!1,w(!0)},[w]),k=T.useCallback(()=>{window.clearTimeout(m.current),m.current=0,w(!1)},[w]),A=T.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{v.current=!0,w(!0),m.current=0},b)},[b,w]);return T.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),f.jsx(ZG,{...c,children:f.jsx(Iwe,{scope:t,contentId:h,open:x,stateAttribute:S,trigger:u,onTriggerChange:d,onTriggerEnter:T.useCallback(()=>{l.isOpenDelayedRef.current?A():C()},[l.isOpenDelayedRef,A,C]),onTriggerLeave:T.useCallback(()=>{y?k():(window.clearTimeout(m.current),m.current=0)},[k,y]),onOpen:C,onClose:k,disableHoverableContent:y,children:n})})};rK.displayName=Gx;var pj="TooltipTrigger",sK=T.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=c1(pj,n),i=hP(pj,n),a=AE(n),o=T.useRef(null),l=Rn(t,o,s.onTriggerChange),c=T.useRef(!1),u=T.useRef(!1),d=T.useCallback(()=>c.current=!1,[]);return T.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),f.jsx(XG,{asChild:!0,...a,children:f.jsx(ar.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Wt(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Wt(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Wt(e.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Wt(e.onFocus,()=>{c.current||s.onOpen()}),onBlur:Wt(e.onBlur,s.onClose),onClick:Wt(e.onClick,s.onClose)})})});sK.displayName=pj;var pP="TooltipPortal",[jwe,Owe]=TE(pP,{forceMount:void 0}),iK=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:s}=e,i=c1(pP,t);return f.jsx(jwe,{scope:t,forceMount:n,children:f.jsx(oa,{present:n||i.open,children:f.jsx(EE,{asChild:!0,container:s,children:r})})})};iK.displayName=pP;var X0="TooltipContent",aK=T.forwardRef((e,t)=>{const n=Owe(X0,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,a=c1(X0,e.__scopeTooltip);return f.jsx(oa,{present:r||a.open,children:a.disableHoverableContent?f.jsx(oK,{side:s,...i,ref:t}):f.jsx(Pwe,{side:s,...i,ref:t})})}),Pwe=T.forwardRef((e,t)=>{const n=c1(X0,e.__scopeTooltip),r=hP(X0,e.__scopeTooltip),s=T.useRef(null),i=Rn(t,s),[a,o]=T.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:d}=r,h=T.useCallback(()=>{o(null),d(!1)},[d]),m=T.useCallback((y,b)=>{const v=y.currentTarget,x={x:y.clientX,y:y.clientY},w=Bwe(x,v.getBoundingClientRect()),S=$we(x,w),C=zwe(b.getBoundingClientRect()),k=qwe([...S,...C]);o(k),d(!0)},[d]);return T.useEffect(()=>()=>h(),[h]),T.useEffect(()=>{if(l&&u){const y=v=>m(v,u),b=v=>m(v,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",b)}}},[l,u,m,h]),T.useEffect(()=>{if(a){const y=b=>{const v=b.target,x={x:b.clientX,y:b.clientY},w=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),S=!Uwe(x,a);w?h():S&&(h(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,a,c,h]),f.jsx(oK,{...e,ref:i})}),[Dwe,Fwe]=TE(Gx,{isInside:!1}),Lwe=Swe("TooltipContent"),oK=T.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...o}=e,l=c1(X0,n),c=AE(n),{onClose:u}=l;return T.useEffect(()=>(document.addEventListener(hj,u),()=>document.removeEventListener(hj,u)),[u]),T.useEffect(()=>{if(l.trigger){const d=h=>{const m=h.target;m!=null&&m.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),f.jsx(wE,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:f.jsxs(JG,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(Lwe,{children:r}),f.jsx(Dwe,{scope:n,isInside:!0,children:f.jsx(Rwe,{id:l.contentId,role:"tooltip",children:s||r})})]})})});aK.displayName=X0;var lK="TooltipArrow",cK=T.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=AE(n);return Fwe(lK,n).isInside?null:f.jsx(QG,{...s,...r,ref:t})});cK.displayName=lK;function Bwe(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function $we(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function zwe(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function Uwe(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function qwe(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),Vwe(t)}function Vwe(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var Wwe=nK,Hwe=rK,Gwe=sK,Kwe=iK,Ywe=aK,Zwe=cK;function xr({delayDuration:e=0,...t}){return f.jsx(Wwe,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function wr({...e}){return f.jsx(xr,{children:f.jsx(Hwe,{"data-slot":"tooltip",...e})})}function _r({...e}){return f.jsx(Gwe,{"data-slot":"tooltip-trigger",...e})}function Sr({className:e,sideOffset:t=0,children:n,...r}){return f.jsx(Kwe,{children:f.jsxs(Ywe,{"data-slot":"tooltip-content",sideOffset:t,className:Ze("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,f.jsx(Zwe,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var WN={exports:{}},A$;function Xwe(){return A$||(A$=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function w(S){return S instanceof l?new l(S.type,w(S.content),S.alias):Array.isArray(S)?S.map(w):S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(w){return Object.prototype.toString.call(w).slice(8,-1)},objId:function(w){return w.__id||Object.defineProperty(w,"__id",{value:++i}),w.__id},clone:function w(S,C){C=C||{};var k,A;switch(o.util.type(S)){case"Object":if(A=o.util.objId(S),C[A])return C[A];k={},C[A]=k;for(var R in S)S.hasOwnProperty(R)&&(k[R]=w(S[R],C));return k;case"Array":return A=o.util.objId(S),C[A]?C[A]:(k=[],C[A]=k,S.forEach(function(N,I){k[I]=w(N,C)}),k);default:return S}},getLanguage:function(w){for(;w;){var S=s.exec(w.className);if(S)return S[1].toLowerCase();w=w.parentElement}return"none"},setLanguage:function(w,S){w.className=w.className.replace(RegExp(s,"gi"),""),w.classList.add("language-"+S)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(k){var w=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(k.stack)||[])[1];if(w){var S=document.getElementsByTagName("script");for(var C in S)if(S[C].src==w)return S[C]}return null}},isActive:function(w,S,C){for(var k="no-"+S;w;){var A=w.classList;if(A.contains(S))return!0;if(A.contains(k))return!1;w=w.parentElement}return!!C}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(w,S){var C=o.util.clone(o.languages[w]);for(var k in S)C[k]=S[k];return C},insertBefore:function(w,S,C,k){k=k||o.languages;var A=k[w],R={};for(var N in A)if(A.hasOwnProperty(N)){if(N==S)for(var I in C)C.hasOwnProperty(I)&&(R[I]=C[I]);C.hasOwnProperty(N)||(R[N]=A[N])}var O=k[w];return k[w]=R,o.languages.DFS(o.languages,function(L,P){P===O&&L!=w&&(this[L]=R)}),R},DFS:function w(S,C,k,A){A=A||{};var R=o.util.objId;for(var N in S)if(S.hasOwnProperty(N)){C.call(S,N,S[N],k||N);var I=S[N],O=o.util.type(I);O==="Object"&&!A[R(I)]?(A[R(I)]=!0,w(I,C,null,A)):O==="Array"&&!A[R(I)]&&(A[R(I)]=!0,w(I,C,N,A))}}},plugins:{},highlightAll:function(w,S){o.highlightAllUnder(document,w,S)},highlightAllUnder:function(w,S,C){var k={callback:C,container:w,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",k),k.elements=Array.prototype.slice.apply(k.container.querySelectorAll(k.selector)),o.hooks.run("before-all-elements-highlight",k);for(var A=0,R;R=k.elements[A++];)o.highlightElement(R,S===!0,k.callback)},highlightElement:function(w,S,C){var k=o.util.getLanguage(w),A=o.languages[k];o.util.setLanguage(w,k);var R=w.parentElement;R&&R.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(R,k);var N=w.textContent,I={element:w,language:k,grammar:A,code:N};function O(P){I.highlightedCode=P,o.hooks.run("before-insert",I),I.element.innerHTML=I.highlightedCode,o.hooks.run("after-highlight",I),o.hooks.run("complete",I),C&&C.call(I.element)}if(o.hooks.run("before-sanity-check",I),R=I.element.parentElement,R&&R.nodeName.toLowerCase()==="pre"&&!R.hasAttribute("tabindex")&&R.setAttribute("tabindex","0"),!I.code){o.hooks.run("complete",I),C&&C.call(I.element);return}if(o.hooks.run("before-highlight",I),!I.grammar){O(o.util.encode(I.code));return}if(S&&r.Worker){var L=new Worker(o.filename);L.onmessage=function(P){O(P.data)},L.postMessage(JSON.stringify({language:I.language,code:I.code,immediateClose:!0}))}else O(o.highlight(I.code,I.grammar,I.language))},highlight:function(w,S,C){var k={code:w,grammar:S,language:C};if(o.hooks.run("before-tokenize",k),!k.grammar)throw new Error('The language "'+k.language+'" has no grammar.');return k.tokens=o.tokenize(k.code,k.grammar),o.hooks.run("after-tokenize",k),l.stringify(o.util.encode(k.tokens),k.language)},tokenize:function(w,S){var C=S.rest;if(C){for(var k in C)S[k]=C[k];delete S.rest}var A=new d;return h(A,A.head,w),u(w,A,S,A.head,0),y(A)},hooks:{all:{},add:function(w,S){var C=o.hooks.all;C[w]=C[w]||[],C[w].push(S)},run:function(w,S){var C=o.hooks.all[w];if(!(!C||!C.length))for(var k=0,A;A=C[k++];)A(S)}},Token:l};r.Prism=o;function l(w,S,C,k){this.type=w,this.content=S,this.alias=C,this.length=(k||"").length|0}l.stringify=function w(S,C){if(typeof S=="string")return S;if(Array.isArray(S)){var k="";return S.forEach(function(O){k+=w(O,C)}),k}var A={type:S.type,content:w(S.content,C),tag:"span",classes:["token",S.type],attributes:{},language:C},R=S.alias;R&&(Array.isArray(R)?Array.prototype.push.apply(A.classes,R):A.classes.push(R)),o.hooks.run("wrap",A);var N="";for(var I in A.attributes)N+=" "+I+'="'+(A.attributes[I]||"").replace(/"/g,"&quot;")+'"';return"<"+A.tag+' class="'+A.classes.join(" ")+'"'+N+">"+A.content+"</"+A.tag+">"};function c(w,S,C,k){w.lastIndex=S;var A=w.exec(C);if(A&&k&&A[1]){var R=A[1].length;A.index+=R,A[0]=A[0].slice(R)}return A}function u(w,S,C,k,A,R){for(var N in C)if(!(!C.hasOwnProperty(N)||!C[N])){var I=C[N];I=Array.isArray(I)?I:[I];for(var O=0;O<I.length;++O){if(R&&R.cause==N+","+O)return;var L=I[O],P=L.inside,V=!!L.lookbehind,F=!!L.greedy,X=L.alias;if(F&&!L.pattern.global){var U=L.pattern.toString().match(/[imsuy]*$/)[0];L.pattern=RegExp(L.pattern.source,U+"g")}for(var H=L.pattern||L,$=k.next,ne=A;$!==S.tail&&!(R&&ne>=R.reach);ne+=$.value.length,$=$.next){var W=$.value;if(S.length>w.length)return;if(!(W instanceof l)){var Q=1,ee;if(F){if(ee=c(H,ne,w,V),!ee||ee.index>=w.length)break;var Ie=ee.index,se=ee.index+ee[0].length,pe=ne;for(pe+=$.value.length;Ie>=pe;)$=$.next,pe+=$.value.length;if(pe-=$.value.length,ne=pe,$.value instanceof l)continue;for(var ce=$;ce!==S.tail&&(pe<se||typeof ce.value=="string");ce=ce.next)Q++,pe+=ce.value.length;Q--,W=w.slice(ne,pe),ee.index-=ne}else if(ee=c(H,0,W,V),!ee)continue;var Ie=ee.index,De=ee[0],Se=W.slice(0,Ie),Ce=W.slice(Ie+De.length),qe=ne+W.length;R&&qe>R.reach&&(R.reach=qe);var Qe=$.prev;Se&&(Qe=h(S,Qe,Se),ne+=Se.length),m(S,Qe,Q);var Ve=new l(N,P?o.tokenize(De,P):De,X,De);if($=h(S,Qe,Ve),Ce&&h(S,$,Ce),Q>1){var Ne={cause:N+","+O,reach:qe};u(w,S,C,$.prev,ne,Ne),R&&Ne.reach>R.reach&&(R.reach=Ne.reach)}}}}}}function d(){var w={value:null,prev:null,next:null},S={value:null,prev:w,next:null};w.next=S,this.head=w,this.tail=S,this.length=0}function h(w,S,C){var k=S.next,A={value:C,prev:S,next:k};return S.next=A,k.prev=A,w.length++,A}function m(w,S,C){for(var k=S.next,A=0;A<C&&k!==w.tail;A++)k=k.next;S.next=k,k.prev=S,w.length-=A}function y(w){for(var S=[],C=w.head.next;C!==w.tail;)S.push(C.value),C=C.next;return S}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(w){var S=JSON.parse(w.data),C=S.language,k=S.code,A=S.immediateClose;r.postMessage(o.highlight(k,o.languages[C],C)),A&&r.close()},!1)),o;var b=o.util.currentScript();b&&(o.filename=b.src,b.hasAttribute("data-manual")&&(o.manual=!0));function v(){o.manual||o.highlightAll()}if(!o.manual){var x=document.readyState;x==="loading"||x==="interactive"&&b&&b.defer?document.addEventListener("DOMContentLoaded",v):window.requestAnimationFrame?window.requestAnimationFrame(v):window.setTimeout(v,16)}return o}(t);e.exports&&(e.exports=n),typeof zp<"u"&&(zp.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(s,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,s){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:n.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var i=r.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",s=function(b,v){return" Error "+b+" while fetching file: "+v},i=" Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",d="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function h(b,v,x){var w=new XMLHttpRequest;w.open("GET",b,!0),w.onreadystatechange=function(){w.readyState==4&&(w.status<400&&w.responseText?v(w.responseText):w.status>=400?x(s(w.status,w.statusText)):x(i))},w.send(null)}function m(b){var v=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(b||"");if(v){var x=Number(v[1]),w=v[2],S=v[3];return w?S?[x,Number(S)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(b){b.selector+=", "+d}),n.hooks.add("before-sanity-check",function(b){var v=b.element;if(v.matches(d)){b.code="",v.setAttribute(o,l);var x=v.appendChild(document.createElement("CODE"));x.textContent=r;var w=v.getAttribute("data-src"),S=b.language;if(S==="none"){var C=(/\.(\w+)$/.exec(w)||[,"none"])[1];S=a[C]||C}n.util.setLanguage(x,S),n.util.setLanguage(v,S);var k=n.plugins.autoloader;k&&k.loadLanguages(S),h(w,function(A){v.setAttribute(o,c);var R=m(v.getAttribute("data-range"));if(R){var N=A.split(/\r\n?|\n/g),I=R[0],O=R[1]==null?N.length:R[1];I<0&&(I+=N.length),I=Math.max(0,Math.min(I-1,N.length)),O<0&&(O+=N.length),O=Math.max(0,Math.min(O,N.length)),A=N.slice(I,O).join(`
`),v.hasAttribute("data-start")||v.setAttribute("data-start",String(I+1))}x.textContent=A,n.highlightElement(x)},function(A){v.setAttribute(o,u),x.textContent=A})}}),n.plugins.fileHighlight={highlight:function(v){for(var x=(v||document).querySelectorAll(d),w=0,S;S=x[w++];)n.highlightElement(S)}};var y=!1;n.fileHighlight=function(){y||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),y=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(WN)),WN.exports}var Jwe=Xwe();const Qwe=_a(Jwe);var R$={},N$;function e1e(){return N$||(N$=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),R$}e1e();var M$={},I$;function t1e(){return I$||(I$=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),M$}t1e();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=r.variable[1].inside,a=0;a<s.length;a++)i[s[a]]=e.languages.bash[s[a]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+i+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+i+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(d){u!==d&&(e.languages.markdown[u].inside.content.inside[d]=e.languages.markdown[d])})}),e.hooks.add("after-tokenize",function(u){if(u.language!=="markdown"&&u.language!=="md")return;function d(h){if(!(!h||typeof h=="string"))for(var m=0,y=h.length;m<y;m++){var b=h[m];if(b.type!=="code"){d(b.content);continue}var v=b.content[1],x=b.content[3];if(v&&x&&v.type==="code-language"&&x.type==="code-block"&&typeof v.content=="string"){var w=v.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");w=(/[a-z][\w-]*/i.exec(w)||[""])[0].toLowerCase();var S="language-"+w;x.alias?typeof x.alias=="string"?x.alias=[x.alias,S]:x.alias.push(S):x.alias=[S]}}}d(u.tokens)}),e.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var d="",h=0,m=u.classes.length;h<m;h++){var y=u.classes[h],b=/language-(.+)/.exec(y);if(b){d=b[1];break}}var v=e.languages[d];if(v)u.content=e.highlight(c(u.content),v,d);else if(d&&d!=="none"&&e.plugins.autoloader){var x="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);u.attributes.id=x,e.plugins.autoloader.loadLanguages(d,function(){var w=document.getElementById(x);w&&(w.innerHTML=e.highlight(w.textContent,e.languages[d],d))})}}});var a=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function c(u){var d=u.replace(a,"");return d=d.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,m){if(m=m.toLowerCase(),m[0]==="#"){var y;return m[1]==="x"?y=parseInt(m.slice(2),16):y=Number(m.slice(1)),l(y)}else{var b=o[m];return b||h}}),d}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],s=[];/^\w+$/.test(n)||s.push(/\w+/.exec(n)[0]),n==="diff"&&s.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",s=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),i=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var c=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(c,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+s+"|"+i+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(i),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var j$={},O$;function n1e(){return O$||(O$=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),j$}n1e();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const r1e=({lang:e,code:t,filepath:n,isStreaming:r=!1})=>{const{foldStreamingCodeBlocks:s}=yr(yn(b=>({foldStreamingCodeBlocks:b.foldStreamingCodeBlocks}))),[i,a]=T.useState(r?s:!1),o=T.useRef(null),l=No(yn(b=>Object.values(b.canvasControls))),c=T.useCallback((b,v,x,w,S,C)=>l.filter(k=>k.type==="codeblock"&&k.targetSlot===b&&k.renderer).map(k=>{if(k.renderer){const A={codeBlockContent:v,codeBlockLang:x,codeBlockFilepath:w,isFolded:S,toggleFold:C,canvasContextType:"codeblock"};return f.jsx(We.Fragment,{children:k.renderer(A)},k.id)}return null}).filter(Boolean),[l]),u=T.useCallback(()=>{if(o.current&&t)try{o.current.style.whiteSpace!=="pre-wrap"&&(o.current.style.whiteSpace="pre-wrap"),o.current.textContent=t,Qwe.highlightElement(o.current)}catch(b){console.error("Prism highlight error:",b),o.current.textContent=t}else o.current&&(o.current.textContent="")},[t]);T.useEffect(()=>{i||u()},[t,e,i,u]);const d=()=>{const b=i;a(v=>!v),b&&setTimeout(u,0)},h=e?`language-${e}`:"language-plaintext",m=T.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]),y=c("codeblock-header-actions",t,e,n,i,d);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),n&&f.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:n}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:y})]}),f.jsx("div",{})]}),!i&&f.jsx("div",{className:"overflow-hidden w-full",children:f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere",children:f.jsx("code",{ref:o,className:h+" block"})})}),i&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:d,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:m})})]})},Fy=T.memo(r1e);var gt;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(gt||(gt={}));const P$={[gt.EPERM]:"Operation not permitted",[gt.ENOENT]:"No such file or directory",[gt.EINTR]:"Interrupted system call",[gt.EIO]:"Input/output error",[gt.ENXIO]:"No such device or address",[gt.EBADF]:"Bad file descriptor",[gt.EAGAIN]:"Resource temporarily unavailable",[gt.ENOMEM]:"Cannot allocate memory",[gt.EACCES]:"Permission denied",[gt.EFAULT]:"Bad address",[gt.ENOTBLK]:"Block device required",[gt.EBUSY]:"Resource busy or locked",[gt.EEXIST]:"File exists",[gt.EXDEV]:"Invalid cross-device link",[gt.ENODEV]:"No such device",[gt.ENOTDIR]:"File is not a directory",[gt.EISDIR]:"File is a directory",[gt.EINVAL]:"Invalid argument",[gt.ENFILE]:"Too many open files in system",[gt.EMFILE]:"Too many open files",[gt.ETXTBSY]:"Text file busy",[gt.EFBIG]:"File is too big",[gt.ENOSPC]:"No space left on disk",[gt.ESPIPE]:"Illegal seek",[gt.EROFS]:"Cannot modify a read-only file system",[gt.EMLINK]:"Too many links",[gt.EPIPE]:"Broken pipe",[gt.EDOM]:"Numerical argument out of domain",[gt.ERANGE]:"Numerical result out of range",[gt.EDEADLK]:"Resource deadlock would occur",[gt.ENAMETOOLONG]:"File name too long",[gt.ENOLCK]:"No locks available",[gt.ENOSYS]:"Function not implemented",[gt.ENOTEMPTY]:"Directory is not empty",[gt.ELOOP]:"Too many levels of symbolic links",[gt.ENOMSG]:"No message of desired type",[gt.EBADE]:"Invalid exchange",[gt.EBADR]:"Invalid request descriptor",[gt.EXFULL]:"Exchange full",[gt.ENOANO]:"No anode",[gt.EBADRQC]:"Invalid request code",[gt.ENOSTR]:"Device not a stream",[gt.ENODATA]:"No data available",[gt.ETIME]:"Timer expired",[gt.ENOSR]:"Out of streams resources",[gt.ENONET]:"Machine is not on the network",[gt.EREMOTE]:"Object is remote",[gt.ENOLINK]:"Link has been severed",[gt.ECOMM]:"Communication error on send",[gt.EPROTO]:"Protocol error",[gt.EBADMSG]:"Bad message",[gt.EOVERFLOW]:"Value too large for defined data type",[gt.EBADFD]:"File descriptor in bad state",[gt.ESTRPIPE]:"Streams pipe error",[gt.ENOTSOCK]:"Socket operation on non-socket",[gt.EDESTADDRREQ]:"Destination address required",[gt.EMSGSIZE]:"Message too long",[gt.EPROTOTYPE]:"Protocol wrong type for socket",[gt.ENOPROTOOPT]:"Protocol not available",[gt.EPROTONOSUPPORT]:"Protocol not supported",[gt.ESOCKTNOSUPPORT]:"Socket type not supported",[gt.ENOTSUP]:"Operation is not supported",[gt.ENETDOWN]:"Network is down",[gt.ENETUNREACH]:"Network is unreachable",[gt.ENETRESET]:"Network dropped connection on reset",[gt.ETIMEDOUT]:"Connection timed out",[gt.ECONNREFUSED]:"Connection refused",[gt.EHOSTDOWN]:"Host is down",[gt.EHOSTUNREACH]:"No route to host",[gt.EALREADY]:"Operation already in progress",[gt.EINPROGRESS]:"Operation now in progress",[gt.ESTALE]:"Stale file handle",[gt.EREMOTEIO]:"Remote I/O error",[gt.EDQUOT]:"Disk quota exceeded"};class Xe extends Error{static fromJSON(t){const n=new Xe(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Xe(gt[t],P$[gt[t]],n,r)}constructor(t,n=P$[t],r,s=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=s,this.code=gt[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var HN={exports:{}},D$;function s1e(){return D$||(D$=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||l,h),y=n?n+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],m]:l._events[y].push(m):(l._events[y]=m,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,y=new Array(m);h<m;h++)y[h]=d[h].fn;return y},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,m,y){var b=n?n+c:c;if(!this._events[b])return!1;var v=this._events[b],x=arguments.length,w,S;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,h),!0;case 5:return v.fn.call(v.context,u,d,h,m),!0;case 6:return v.fn.call(v.context,u,d,h,m,y),!0}for(S=1,w=new Array(x-1);S<x;S++)w[S-1]=arguments[S];v.fn.apply(v.context,w)}else{var C=v.length,k;for(S=0;S<C;S++)switch(v[S].once&&this.removeListener(c,v[S].fn,void 0,!0),x){case 1:v[S].fn.call(v[S].context);break;case 2:v[S].fn.call(v[S].context,u);break;case 3:v[S].fn.call(v[S].context,u,d);break;case 4:v[S].fn.call(v[S].context,u,d,h);break;default:if(!w)for(k=1,w=new Array(x-1);k<x;k++)w[k-1]=arguments[k];v[S].fn.apply(v[S].context,w)}}return!0},o.prototype.on=function(c,u,d){return i(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return i(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var m=n?n+c:c;if(!this._events[m])return this;if(!u)return a(this,m),this;var y=this._events[m];if(y.fn)y.fn===u&&(!h||y.once)&&(!d||y.context===d)&&a(this,m);else{for(var b=0,v=[],x=y.length;b<x;b++)(y[b].fn!==u||h&&!y[b].once||d&&y[b].context!==d)&&v.push(y[b]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(HN)),HN.exports}var i1e=s1e();const mP=_a(i1e);var DW;let a1e=class extends mP{constructor(n){super();ve(this,DW,"List");ve(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,s=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const i=Array.from(this.data);i.splice(n,+s,r),this.data=new Set(i),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...s){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const i=Array.from(this.data),a=i.splice(n,r,...s);return this.data=new Set(i),this.emit("update"),a}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(DW=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function F$(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function ys(e){throw e}const L$=Intl.NumberFormat("en",{notation:"compact"});L$.format.bind(L$);function Am(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function o1e(e){try{return JSON.parse(e),!0}catch{return!1}}function mj(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function gP(e){return e.at(0).toUpperCase()+e.slice(1)}const l1e=new TextEncoder;function Lp(e){return l1e.encode(e)}const B$=new TextDecoder;function yP(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return B$.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),B$.decode(t)}function Kx(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=Kx(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function c1e(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var u1e={};let d1e="process"in globalThis&&"env"in globalThis.process&&u1e.U_DEBUG=="true";function Yx(...e){d1e&&console.debug("[U]",...e)}const $$=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],f1e=[...$$,...$$.map(e=>gP(e)),"char"],bP=/^(u?int|float)(8|16|32|64|128)$/i;function uK(e){return e=="char"?"uint8":e.toLowerCase()}function vP(e){return bP.test(e.toString())}function gj(e){return e=="char"||bP.test(e.toString().toLowerCase())}function h1e(e){if(!gj(e))throw new TypeError("Not a valid primitive type: "+e)}const z$=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function dK(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function p1e(e){return e!=null&&typeof e=="object"&&"struct"in e}function RE(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function bc(e){return typeof e=="function"&&Symbol.metadata in e&&p1e(e[Symbol.metadata])}function u1(e){return e!=null&&typeof e=="object"&&bc(e.constructor)}function fK(e){if(!u1(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function xP(e){return u1(e)||bc(e)}function hK(e){if(!xP(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function wP(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function zs(e){if(e==null)return 0;if(Array.isArray(e)){let s=0;for(let i=0;i<e.length;i++)s+=zs(e[i]);return s}if(typeof e=="string")return h1e(e),+uK(e).match(bP)[2]/8;if(wP(e))return e[Symbol.size];hK(e);const t=bc(e)?e:e.constructor;RE(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(bc(e))return r;for(const s of n.members.values()){const i=e[s.name];if(u1(i)&&i.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,zs(i)):r+=zs(i);continue}if(typeof s.length!="string")continue;let a=0;for(let o=0;o<e[s.length];o++)a+=zs(xP(i[o])?i[o]:s.type);n.isUnion?r=Math.max(r,a):r+=a}return r}function m1e(e,t){var i;hK(e);const n=bc(e)?e:e.constructor;RE(n);const{struct:r}=n[Symbol.metadata];if(bc(e)||!r.isDynamic)return((i=r.members.get(t))==null?void 0:i.staticOffset)??ys(new Error("Struct does not have member: "+t));let s=0;for(const a of r.members.values()){if(a.name==t)return s;const o=e[a.name];s+=zs(xP(o)?o:a.type)}throw new Error("Struct does not have member: "+t)}function g1e(e,t){return Math.ceil(e/t)*t}function Rm(e={}){return function(n,r){const s=new Map;let i=0,a=!1;for(const{name:o,type:l,length:c}of dK(r)){if(!gj(l)&&!bc(l))throw new TypeError("Not a valid type: "+l);if(typeof c=="string"){const h=s.get(c);if(!h)throw new Error(`"${c}" is undefined or declared after "${o}"`);if(!vP(h.type))throw new Error(`"${c}" is not a number and cannot be used to count "${o}"`)}let u=`${typeof l=="string"?l:l.name} ${o}`;c!==void 0&&(u+=`[${c}]`),s.set(o,{name:o,staticOffset:e.isUnion?0:i,type:gj(l)?uK(l):l,length:c,decl:u});const d=typeof c=="string"||bc(l)&&l[Symbol.metadata].struct.isDynamic?0:zs(l)*(c||1);a||(a=bc(l)?l[Symbol.metadata].struct.isDynamic:typeof c=="string"),i=e.isUnion?Math.max(i,d):i+d,i=g1e(i,e.align||1),Yx("define",n.name+"."+o)}return r.metadata.struct={options:e,members:s,staticSize:i,isDynamic:a,isUnion:e.isUnion??!1},n}}function Zx(e,t){return function(n,r){let s=r.name;if(typeof s=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+s.toString()),s=s.toString()),!s)throw new ReferenceError("Invalid name for struct member");return dK(r).push({name:s,type:e,length:t}),n}}function pK(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:ys(new Error("Array lengths must be natural numbers"))}function ma(e){if(wP(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();fK(e),RE(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=zs(e),s=new Uint8Array(r),i=new DataView(s.buffer);Yx("serialize",e.constructor.name);let a=0,o=0;for(const l of n.values()){const c=pK(e,l);Yx("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name][u]:e[l.name];if(typeof d=="string"&&(d=d.charCodeAt(0)),a=o,o+=u1(d)?zs(d):zs(l.type),!vP(l.type)){s.set(d?ma(d):new Uint8Array(zs(l.type)),a);continue}const h=`set${gP(l.type)}`;if(h=="setInt64"){i.setBigInt64(a,BigInt(d),!t.bigEndian);continue}if(h=="setUint64"){i.setBigUint64(a,BigInt(d),!t.bigEndian);continue}if(h=="setInt128"){i.setBigUint64(a+(t.bigEndian?8:0),d&z$,!t.bigEndian),i.setBigInt64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setUint128"){i.setBigUint64(a+(t.bigEndian?8:0),d&z$,!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setFloat128"){i.setFloat64(a+(t.bigEndian?8:0),Number(d),!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}i[h](a,Number(d),!t.bigEndian)}}return s}function NE(e,t){const n=c1e(t);if(wP(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);fK(e),RE(e.constructor);const{options:r,members:s}=e.constructor[Symbol.metadata].struct,i=new DataView(n.buffer,n.byteOffset,n.byteLength);Yx("deserialize",e.constructor.name);let a=0,o=0;for(const l of s.values()){const c=pK(e,l);Yx("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name]:e;const h=c!=-1?u:l.name,m=d[h]===null||d[h]===void 0,y=m&&bc(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(a=o,!u1(d[h])&&!y&&(o+=zs(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,u)+String.fromCharCode(i.getUint8(a))+e[l.name].slice(u+1);continue}if(!vP(l.type)){if(y&&bc(l.type))d[h]??(d[h]=new l.type);else if(m)continue;NE(d[h],new Uint8Array(n.subarray(a))),o+=zs(d[h]);continue}c&&c!=-1&&(d||(d=[]));const b=`get${gP(l.type)}`;if(b=="getInt64"){d[h]=i.getBigInt64(a,!r.bigEndian);continue}if(b=="getUint64"){d[h]=i.getBigUint64(a,!r.bigEndian);continue}if(b=="getInt128"){d[h]=i.getBigInt64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getUint128"){d[h]=i.getBigUint64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getFloat128"){d[h]=i.getFloat64(a+(r.bigEndian?8:0),!r.bigEndian);continue}d[h]=i[b](a,!r.bigEndian)}}}function y1e(e){function t(n,r){return typeof n=="number"||typeof n=="string"?Zx(e,n):Zx(e)(n,r)}return t}const Xn=Object.fromEntries(f1e.map(e=>[e,y1e(e)]));function b1e(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const Mc={root:"/",pwd:"/",credentials:b1e({uid:0,gid:0}),descriptors:new Map};function mK(e,t){let n="",r=0,s=-1,i=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if(a=="/")break;a="/"}if(a=="/"){if(!(s===o-1||i===1))if(i===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}else if(n.length!==0){n="",r=0,s=o,i=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,i=0}else a==="."&&i!==-1?++i:i=-1}return n}function Bd(...e){var t;let n="";for(const s of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:Mc.pwd])if(s!=null&&s.length&&(n=`${s}/${n}`,s.startsWith("/")))break;const r=n.startsWith("/");return n=mK(n,!r),r?`/${n}`:n.length?n:"/"}function v1e(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=mK(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function is(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?v1e(t):"."}function gK(e,t){if(e===t||(e=Bd.call(this,e),t=Bd.call(this,t),e===t))return"";const n=1,r=e.length,s=r-n,i=1,a=t.length-i,o=s<a?s:a;let l=-1,c=0;for(;c<o;c++){const d=e[n+c];if(d!==t[i+c])break;d==="/"&&(l=c)}if(c===o)if(a>o){if(t[i+c]==="/")return t.slice(i+c+1);if(c===0)return t.slice(i+c)}else s>o&&(e[n+c]==="/"?l=c:c===0&&(l=0));let u="";for(c=n+l+1;c<=r;++c)(c===r||e[c]==="/")&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(i+l)}`}function Yr(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let s=e.length-1;s>=1;--s)if(e[s]==="/"){if(!r){n=s;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function J0(e,t){let n=0,r=-1,s=!0;for(let i=e.length-1;i>=0;--i)if(e[i]==="/"){if(!s){n=i+1;break}}else r===-1&&(s=!1,r=i+1);return r===-1?"":e.slice(n,r)}function eu(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let s=-1,i=0,a=-1,o=!0,l=e.length-1,c=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){i=l+1;break}continue}a===-1&&(o=!1,a=l+1),e[l]==="."?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(a!==-1){const u=i===0&&t?1:i;s===-1||c===0||c===1&&s===a-1&&s===i+1?n.base=n.name=e.slice(u,a):(n.name=e.slice(u,s),n.base=e.slice(u,a),n.ext=e.slice(s,a))}return i>0?n.dir=e.slice(0,i-1):t&&(n.dir="/"),n}var Gn;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(Gn||(Gn={}));Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"";const x1e=new a1e;function w1e(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};x1e.add(n),R1e(n)}function _1e(e,t){var n,r;if(!(e instanceof Xe))return e.toString();const s=e.code+": "+e.message;if(!e.path)return s;const i=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return s+": "+is(i,e.path)}function Bh(e){return function(t,n={}){return w1e(e,_1e(t,n)),t}}Bh(Gn.EMERG);const S1e=Bh(Gn.ALERT),ME=Bh(Gn.CRIT),wo=Bh(Gn.ERR),Oa=Bh(Gn.WARN),_P=Bh(Gn.NOTICE),yK=Bh(Gn.INFO),mx=Bh(Gn.DEBUG);function C1e(e,t){return`\x1B[${t}m${e}\x1B[0m`}function k1e(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[C1e(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"",Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"";Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"",Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"";let E1e=e=>[...k1e(e),e.message];function T1e(e){const t=E1e(e);return typeof t=="string"?[t]:Array.from(t)}let A1e=console.error;function R1e(e){e.level>N1e||A1e(...T1e(e))}let N1e=Gn.ALERT;function SP(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function M1e(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function I1e(e,t){if(typeof t!="object"||t===null)throw wo(new Xe(gt.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const s=t==null?void 0:t[n];if(s==null){if(!r.required){mx("Using default for option: "+n);continue}throw wo(new Xe(gt.EINVAL,"Missing required option: "+n))}const i=(c,u=s)=>{var d;return typeof c=="function"?Symbol.hasInstance in c&&c.prototype?s instanceof c:c(s):typeof s===c||((d=s==null?void 0:s.constructor)===null||d===void 0?void 0:d.name)===c};if(Array.isArray(r.type)?r.type.some(c=>i(c)):i(r.type))continue;const a=typeof s=="object"&&"constructor"in s?s.constructor.name:typeof s,o=c=>typeof c=="function"?c.name!="type"?c.name:c.toString():c,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw wo(new Xe(gt.EINVAL,`Incorrect type for "${n}": ${a} (expected ${l})`))}}function bK(e){return e!=null&&typeof e=="object"&&"backend"in e&&SP(e.backend)}const CP=0,zi=4,ai=2,k2=1,kP=1,j1e=2,O1e=4,vK=0,ja=1,Ad=2,IE=64,jE=128,P1e=256,OE=512,mm=1024,D1e=65536,F1e=262144,L1e=131072,PE=1052672,B1e=4096,$1e=32768,z1e=16384,U1e=2048,Ss=61440,Nm=49152,Qd=40960,vc=32768,Mm=24576,Ti=16384,Im=8192,jm=4096,d1=2048,f1=1024,q1e=512,V1e=448,xK=256,wK=128,_K=64,W1e=56,SK=32,CK=16,kK=8,H1e=7,EK=4,TK=2,AK=1,G1e=0,io=4294967295,RK=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:kP,COPYFILE_FICLONE:j1e,COPYFILE_FICLONE_FORCE:O1e,F_OK:CP,O_APPEND:mm,O_CREAT:IE,O_DIRECT:z1e,O_DIRECTORY:D1e,O_DSYNC:B1e,O_EXCL:jE,O_NOATIME:F1e,O_NOCTTY:P1e,O_NOFOLLOW:L1e,O_NONBLOCK:U1e,O_RDONLY:vK,O_RDWR:Ad,O_SYMLINK:$1e,O_SYNC:PE,O_TRUNC:OE,O_WRONLY:ja,R_OK:zi,S_IFBLK:Mm,S_IFCHR:Im,S_IFDIR:Ti,S_IFIFO:jm,S_IFLNK:Qd,S_IFMT:Ss,S_IFREG:vc,S_IFSOCK:Nm,S_IRGRP:SK,S_IROTH:EK,S_IRUSR:xK,S_IRWXG:W1e,S_IRWXO:H1e,S_IRWXU:V1e,S_ISGID:f1,S_ISUID:d1,S_ISVTX:q1e,S_IWGRP:CK,S_IWOTH:TK,S_IWUSR:wK,S_IXGRP:kK,S_IXOTH:AK,S_IXUSR:_K,UV_FS_O_FILEMAP:G1e,W_OK:ai,X_OK:k2,size_max:io},Symbol.toStringTag,{value:"Module"})),ES=BigInt(1e3);class NK{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:s,uid:i,gid:a,size:o,mode:l,ino:c,...u}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const d=Date.now();this.atimeMs=this._convert(t??d),this.mtimeMs=this._convert(n??d),this.ctimeMs=this._convert(r??d),this.birthtimeMs=this._convert(s??d),this.uid=this._convert(i??0),this.gid=this._convert(a??0),this.size=this._convert(o??0),this.ino=this._convert(c??0),this.mode=this._convert(l??420&vc),(this.mode&Ss)==0&&(this.mode=this.mode|this._convert(vc)),Object.assign(this,u)}isFile(){return(this.mode&Ss)===vc}isDirectory(){return(this.mode&Ss)===Ti}isSymbolicLink(){return(this.mode&Ss)===Qd}isSocket(){return(this.mode&Ss)===Nm}isBlockDevice(){return(this.mode&Ss)===Mm}isCharacterDevice(){return(this.mode&Ss)===Im}isFIFO(){return(this.mode&Ss)===jm}toJSON(){return Am(this,yj)}hasAccess(t,n){return ds(n,this._isBigint?new ef(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*ES}get mtimeNs(){return BigInt(this.mtimeMs)*ES}get ctimeNs(){return BigInt(this.ctimeMs)*ES}get birthtimeNs(){return BigInt(this.birthtimeMs)*ES}}function MK(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<io?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<io?e.gid=n:r=!1,r}class ef extends NK{constructor(){super(...arguments),this._isBigint=!1}}class Om extends NK{constructor(){super(...arguments),this._isBigint=!0}}function K1e(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class Y1e{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=io,this.ffree=io}}class Z1e{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(io),this.ffree=BigInt(io)}}var Is=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Hn=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},EP=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const Yo=0,X1e=1024;let U$=(()=>{var e,t;let n=[Rm()],r,s=[],i,a,o=[],l=[],c,u=[],d=[],h,m=[],y=[],b,v=[],x=[];return i=class{get key(){return this._key}set key(w){this._key=w,this.keySize=w.length}get value(){return this._value.subarray(0,this.valueSize)}set value(w){this._value=w,this.valueSize=w.length}constructor(w,S){this.keySize=Hn(this,o,0),this.valueSize=(Hn(this,l),Hn(this,u,0)),this._key=(Hn(this,d),Hn(this,m,"")),this._value=(Hn(this,y),Hn(this,v,new Uint8Array(X1e))),Hn(this,x),w&&(this.key=w),S&&(this.value=S)}},EP(i,"Attribute"),(()=>{const w=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;a=[(e=Xn).uint32.bind(e)],c=[(t=Xn).uint32.bind(t)],h=[Xn.char("keySize")],b=[Xn.uint8("valueSize")],Is(null,null,a,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:S=>"keySize"in S,get:S=>S.keySize,set:(S,C)=>{S.keySize=C}},metadata:w},o,l),Is(null,null,c,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:S=>"valueSize"in S,get:S=>S.valueSize,set:(S,C)=>{S.valueSize=C}},metadata:w},u,d),Is(null,null,h,{kind:"field",name:"_key",static:!1,private:!1,access:{has:S=>"_key"in S,get:S=>S._key,set:(S,C)=>{S._key=C}},metadata:w},m,y),Is(null,null,b,{kind:"field",name:"_value",static:!1,private:!1,access:{has:S=>"_value"in S,get:S=>S._value,set:(S,C)=>{S._value=C}},metadata:w},v,x),Is(null,r={value:i},n,{kind:"class",name:i.name,metadata:w},null,s),i=r.value,w&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:w}),Hn(i,s)})(),i})(),xh=(()=>{var e;let t=[Rm()],n,r=[],s,i,a=[],o=[],l,c=[],u=[];return s=class{has(d){return this.data.some(h=>h.key==d)}get(d){return this.data.find(h=>h.key==d)}set(d,h){const m=this.get(d);if(m){m.value=h;return}this.data.push(new U$(d,h)),this.size++}remove(d){const h=this.data.findIndex(m=>m.key==d);return h===-1?!1:(this.data.splice(h,1),this.size--,!0)}keys(){return this.data.map(d=>d.key)}values(){return this.data.map(d=>d.value)}entries(){return this.data.map(d=>[d.key,d.value])}constructor(){this.size=Hn(this,a,0),this.data=(Hn(this,o),Hn(this,c,[])),Hn(this,u)}},EP(s,"Attributes"),(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[(e=Xn).uint32.bind(e)],l=[Zx(U$,"size")],Is(null,null,i,{kind:"field",name:"size",static:!1,private:!1,access:{has:h=>"size"in h,get:h=>h.size,set:(h,m)=>{h.size=m}},metadata:d},a,o),Is(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:h=>"data"in h,get:h=>h.data,set:(h,m)=>{h.data=m}},metadata:d},c,u),Is(null,n={value:s},t,{kind:"class",name:s.name,metadata:d},null,r),s=n.value,d&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),Hn(s,r)})(),s})();const yj=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],J1e=4;var _o;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})(_o||(_o={}));let Ci=(()=>{var e,t,n,r,s,i,a,o,l,c,u,d,h,m,y,b;let v=[Rm()],x,w=[],S,C,k=[],A=[],R,N=[],I=[],O,L=[],P=[],V,F=[],X=[],U,H=[],$=[],ne,W=[],Q=[],ee,se=[],pe=[],ce,Ie=[],De=[],Se,Ce=[],qe=[],Qe,Ve=[],Ne=[],K,me=[],Ae=[],le,oe=[],re=[],Te,Be=[],ke=[],lt,Rt=[],ft=[],jt,qt=[],Lt=[],en,xe=[],D=[],Z,ge=[],Fe=[],we,Me=[],de=[];var vt=S=class{constructor(ot){if(this.data=Hn(this,k,mj(0,io)),this.__data_old=(Hn(this,A),Hn(this,N,0)),this.size=(Hn(this,I),Hn(this,L,0)),this.mode=(Hn(this,P),Hn(this,F,0)),this.nlink=(Hn(this,X),Hn(this,H,1)),this.uid=(Hn(this,$),Hn(this,W,0)),this.gid=(Hn(this,Q),Hn(this,se,0)),this.atimeMs=(Hn(this,pe),Hn(this,Ie,Date.now())),this.birthtimeMs=(Hn(this,De),Hn(this,Ce,Date.now())),this.mtimeMs=(Hn(this,qe),Hn(this,Ve,Date.now())),this.ctimeMs=(Hn(this,Ne),Hn(this,me,Date.now())),this.ino=(Hn(this,Ae),Hn(this,oe,mj(0,io))),this.__ino_old=(Hn(this,re),Hn(this,Be,0)),this.flags=(Hn(this,ke),Hn(this,Rt,0)),this.__after_flags=(Hn(this,ft),Hn(this,qt,0)),this.version=(Hn(this,Lt),Hn(this,xe,0)),this.__padding=(Hn(this,D),Hn(this,ge,[])),this.attributes=(Hn(this,Fe),Hn(this,Me,new xh)),Hn(this,de),!!ot){if(!("byteLength"in ot)){Object.assign(this,ot);return}if(ot.byteLength<zs(vt))throw ME(new Xe(gt.EIO,"Buffer is too small to create an inode"));NE(this,ot)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...Am(this,yj),attributes:this.attributes}}toStats(){return new ef(this)}update(ot){if(!ot)return!1;let B=!1;for(const ze of yj)ot[ze]!==void 0&&(ze=="ino"||ze=="data"||this[ze]!==ot[ze]&&(ze=="atimeMs"&&this.flags&_o.NoAtime||(this[ze]=ot[ze],B=!0)));return ot.attributes&&(this.attributes=ot.attributes,B=!0),B&&(this.ctimeMs=Date.now()),B}};return EP(S,"Inode"),(()=>{const ot=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;C=[(e=Xn).uint32.bind(e)],R=[(t=Xn).uint32.bind(t)],O=[(n=Xn).uint32.bind(n)],V=[(r=Xn).uint16.bind(r)],U=[(s=Xn).uint32.bind(s)],ne=[(i=Xn).uint32.bind(i)],ee=[(a=Xn).uint32.bind(a)],ce=[(o=Xn).float64.bind(o)],Se=[(l=Xn).float64.bind(l)],Qe=[(c=Xn).float64.bind(c)],K=[(u=Xn).float64.bind(u)],le=[(d=Xn).uint32.bind(d)],Te=[(h=Xn).uint32.bind(h)],lt=[(m=Xn).uint32.bind(m)],jt=[(y=Xn).uint16.bind(y)],en=[(b=Xn).uint32.bind(b)],Z=[Xn.uint8(48)],we=[Zx(xh)],Is(null,null,C,{kind:"field",name:"data",static:!1,private:!1,access:{has:B=>"data"in B,get:B=>B.data,set:(B,ze)=>{B.data=ze}},metadata:ot},k,A),Is(null,null,R,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:B=>"__data_old"in B,get:B=>B.__data_old,set:(B,ze)=>{B.__data_old=ze}},metadata:ot},N,I),Is(null,null,O,{kind:"field",name:"size",static:!1,private:!1,access:{has:B=>"size"in B,get:B=>B.size,set:(B,ze)=>{B.size=ze}},metadata:ot},L,P),Is(null,null,V,{kind:"field",name:"mode",static:!1,private:!1,access:{has:B=>"mode"in B,get:B=>B.mode,set:(B,ze)=>{B.mode=ze}},metadata:ot},F,X),Is(null,null,U,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:B=>"nlink"in B,get:B=>B.nlink,set:(B,ze)=>{B.nlink=ze}},metadata:ot},H,$),Is(null,null,ne,{kind:"field",name:"uid",static:!1,private:!1,access:{has:B=>"uid"in B,get:B=>B.uid,set:(B,ze)=>{B.uid=ze}},metadata:ot},W,Q),Is(null,null,ee,{kind:"field",name:"gid",static:!1,private:!1,access:{has:B=>"gid"in B,get:B=>B.gid,set:(B,ze)=>{B.gid=ze}},metadata:ot},se,pe),Is(null,null,ce,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:B=>"atimeMs"in B,get:B=>B.atimeMs,set:(B,ze)=>{B.atimeMs=ze}},metadata:ot},Ie,De),Is(null,null,Se,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:B=>"birthtimeMs"in B,get:B=>B.birthtimeMs,set:(B,ze)=>{B.birthtimeMs=ze}},metadata:ot},Ce,qe),Is(null,null,Qe,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:B=>"mtimeMs"in B,get:B=>B.mtimeMs,set:(B,ze)=>{B.mtimeMs=ze}},metadata:ot},Ve,Ne),Is(null,null,K,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:B=>"ctimeMs"in B,get:B=>B.ctimeMs,set:(B,ze)=>{B.ctimeMs=ze}},metadata:ot},me,Ae),Is(null,null,le,{kind:"field",name:"ino",static:!1,private:!1,access:{has:B=>"ino"in B,get:B=>B.ino,set:(B,ze)=>{B.ino=ze}},metadata:ot},oe,re),Is(null,null,Te,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:B=>"__ino_old"in B,get:B=>B.__ino_old,set:(B,ze)=>{B.__ino_old=ze}},metadata:ot},Be,ke),Is(null,null,lt,{kind:"field",name:"flags",static:!1,private:!1,access:{has:B=>"flags"in B,get:B=>B.flags,set:(B,ze)=>{B.flags=ze}},metadata:ot},Rt,ft),Is(null,null,jt,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:B=>"__after_flags"in B,get:B=>B.__after_flags,set:(B,ze)=>{B.__after_flags=ze}},metadata:ot},qt,Lt),Is(null,null,en,{kind:"field",name:"version",static:!1,private:!1,access:{has:B=>"version"in B,get:B=>B.version,set:(B,ze)=>{B.version=ze}},metadata:ot},xe,D),Is(null,null,Z,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:B=>"__padding"in B,get:B=>B.__padding,set:(B,ze)=>{B.__padding=ze}},metadata:ot},ge,Fe),Is(null,null,we,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:B=>"attributes"in B,get:B=>B.attributes,set:(B,ze)=>{B.attributes=ze}},metadata:ot},Me,de),Is(null,x={value:S},v,{kind:"class",name:S.name,metadata:ot},null,w),vt=S=x.value,ot&&Object.defineProperty(S,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:ot}),Hn(S,w)})(),vt=S})();function Q1e(e){return(e.mode&Ss)===vc}function Tc(e){return(e.mode&Ss)===Ti}function Q0(e){return(e.mode&Ss)===Qd}function e_e(e){return(e.mode&Ss)===Nm}function Xx(e){return(e.mode&Ss)===Mm}function Jx(e){return(e.mode&Ss)===Im}function t_e(e){return(e.mode&Ss)===jm}function ds(e,t,n){const r=(e==null?void 0:e.credentials)||Mc.credentials;if(Q0(t)||r.euid===0||r.egid===0)return!0;let s=0;return r.uid===t.uid&&(t.mode&xK&&(s|=zi),t.mode&wK&&(s|=ai),t.mode&_K&&(s|=k2)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&SK&&(s|=zi),t.mode&CK&&(s|=ai),t.mode&kK&&(s|=k2)),t.mode&EK&&(s|=zi),t.mode&TK&&(s|=ai),t.mode&AK&&(s|=k2),(s&n)===n}const q$=1;class OC extends Map{constructor(){super(...arguments),this.maxSize=io}toJSON(){return{version:q$,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*zs(Ci);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Xe.With("ENOENT",t);if((n.mode&Ss)!=Ti)throw Xe.With("ENOTDIR",t);const r={};for(const s of this.keys())Yr(s)==t&&s!=t&&(r[J0(s)]=this.get(s).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&Ss)!=Ti)continue;const s={};for(const i of this.keys())Yr(i)==n&&i!=n&&(s[J0(i)]=this.get(i).ino);t.set(n,s)}return t}fromJSON(t){var n;if(t.version!=q$)throw new Xe(gt.EINVAL,"Index version mismatch");this.clear();for(const[r,s]of Object.entries(t.entries))(n=s.data)!==null&&n!==void 0||(s.data=mj(1,io)),r=="/"&&(s.ino=0),this.set(r,new Ci(s));return this}static parse(t){if(!o1e(t))throw new Xe(gt.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new OC;return r.fromJSON(n),r}}const GN=4096;let TP=class bj{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===bj.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===bj.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:s}=await this.stat(t),{start:i=0,end:a=s}=n;for(let o=i;o<a;o+=GN){const l=o+GN>a?a-o:GN,c=new Uint8Array(l);await this.read(t,c,o,o+l).catch(r.error.bind(r)),r.enqueue(c)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let s=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(i,a)=>{let o=!1;const l=u=>{o=!0,a.error(u)},{size:c}=await this.stat(t);await this.write(t,i,s).catch(l),!o&&(s+=i.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(c,s)}).catch(l))}})}};function Ka(e){return JSON.parse(yP(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function Tl(e){return Lp(JSON.stringify(e))}function $h(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Xe(gt.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function PC(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Xe(gt.EINVAL,"Invalid time.")}}function Pn(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Xe(gt.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Xe(gt.EINVAL,"Path can not contain null character");if(e.length==0)throw new Xe(gt.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:Bd(e)}function Rd(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:$h("mode"in e?e==null?void 0:e.mode:null,r)}}class n_e{constructor(t,n,r,s){ve(this,"id");ve(this,"_size");ve(this,"options");ve(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),s==null||s.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const s=t-r.offset;r.data.byteLength>s&&(r.data=r.data.subarray(0,s)),r.ranges=r.ranges.filter(i=>i.start<t).map(i=>i.end>t?{start:i.start,end:t}:i)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],s=this.regions[n+1];if(s.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...s.ranges),r.ranges.sort((i,a)=>i.start-a.start),r.ranges=r.ranges.reduce((i,a)=>(!i.length||i.at(-1).end<a.start?i.push(a):i.at(-1).end=Math.max(i.at(-1).end,a.end),i),[]),r.data=Kx(r.data,s.offset+s.data.byteLength),r.data.set(s.data,s.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const s of this.regions){if(s.offset>=n)break;for(const i of s.ranges)if(!(i.end<=t)&&(i.start>=n||(i.start>t&&r.push({start:t,end:Math.min(i.start,n)}),i.end>t&&(t=Math.max(t,i.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const a of i.ranges)if(!(a.end<=t)){if(a.start>=n)break;r.push({start:Math.max(t,a.start),end:Math.min(n,a.end)})}}r.sort((i,a)=>i.start-a.start);const s=[];for(const i of r){const a=s.at(-1);a&&i.start<=a.end?a.end=Math.max(a.end,i.end):s.push(i)}return s}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,s=this.regionAt(n);if(s)return s.data=Kx(s.data,r),s.data.set(t,n),s.ranges.push({start:n,end:r}),s.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const i={data:t,offset:n,ranges:[{start:n,end:r}]},a=this.regions.findIndex(o=>o.offset>n);return a==-1?this.regions.push(i):this.regions.splice(a,0,i),this.collect(),this}}var KN,YN,ZN;(KN=Promise.withResolvers)!==null&&KN!==void 0||(Promise.withResolvers=(Oa("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}));(YN=Symbol.dispose)!==null&&YN!==void 0||(Symbol.dispose=(Oa("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(ZN=Symbol.asyncDispose)!==null&&ZN!==void 0||(Symbol.asyncDispose=(Oa("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class IK{constructor(t){this.store=t}}class r_e extends IK{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class vj extends IK{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,s;(r=(s=this.store).cache)!==null&&r!==void 0||(s.cache=new Map);const i=this.store.cache.get(t);return i?(n&&(i.size=n.size),i):n?new n_e(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var s;const i=this._cached(t);if(!i)return;r??(r=i.size);const a=i.missing(n,r);for(const{start:l,end:c}of a)this.async(this.get(t,l,c));if(a.length)throw wo(Xe.With("EAGAIN",(s=this.store._fs)===null||s===void 0?void 0:s._path(t)));const o=i.regionAt(n);if(!o){Oa("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class s_e{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const s=await this.raw.get(t,n,r);return this.stash(t),s}getSync(t,n=0,r){const s=this.raw.getSync(t,n,r);return this.stash(t),s}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,s),n)}catch(i){if(!(this.raw instanceof vj))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,s),n)}catch(i){if(!(this.raw instanceof vj))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var Ns=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Ms=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class jK extends TP{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[s,i]of this._ids){const a=gK(t,s);if(a.startsWith(".."))continue;let o=is(n,a);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:s,newKey:o,ino:i})}for(const{oldKey:s,newKey:i,ino:a}of r){this._ids.delete(s),this._ids.set(i,a);const o=this._paths.get(a);if(!o){Oa("Missing paths in table for ino "+a);continue}o.delete(s),o.add(i)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,s;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,mx(this.name+": supports features: "+((s=this.store.flags)===null||s===void 0?void 0:s.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ns(n,this.transaction(),!0),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),await r.set(a.ino,ma(a)),s.has(i)&&await r.set(a.data,Tl(s.get(i)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=Ms(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ns(n,this.transaction(),!1),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),r.setSync(a.ino,ma(a)),s.has(i)&&r.setSync(a.data,Tl(s.get(i)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{Ms(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new OC,s=Ns(n,this.transaction(),!0),i=[["/",0]],a=F$(Xe.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ci(await s.get(l));if(r.set(o,c),c.mode&Ti){const u=Ka((t=await s.get(c.data))!==null&&t!==void 0?t:ys(Xe.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([is(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=Ms(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new OC,s=Ns(n,this.transaction(),!1),i=[["/",0]],a=F$(Xe.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ci(s.getSync(l));if(r.set(o,c),c.mode&Ti){const u=Ka((t=s.getSync(c.data))!==null&&t!==void 0?t:ys(Xe.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([is(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{Ms(n)}}async rename(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ns(a,this.transaction(),!0),l=eu(t),c=eu(n),u=await this.findInode(o,l.dir,"rename"),d=Ka((r=await o.get(u.data))!==null&&r!==void 0?r:ys(Xe.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Xe.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&wo(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Xe(gt.EBUSY,l.dir);const m=c.dir==l.dir,y=m?u:await this.findInode(o,c.dir,"rename"),b=m?d:Ka((s=await o.get(y.data))!==null&&s!==void 0?s:ys(Xe.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ci((i=await o.get(b[c.base]))!==null&&i!==void 0?i:ys(Xe.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Xe.With("EPERM",n,"rename");await o.remove(v.data),await o.remove(b[c.base])}b[c.base]=h,await o.set(u.data,Tl(d)),await o.set(y.data,Tl(b)),await o.commit(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{const o=Ms(a);o&&await o}}renameSync(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ns(a,this.transaction(),!1),l=eu(t),c=eu(n),u=this.findInodeSync(o,l.dir,"rename"),d=Ka((r=o.getSync(u.data))!==null&&r!==void 0?r:ys(Xe.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Xe.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&wo(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Xe(gt.EBUSY,l.dir);const m=c.dir===l.dir,y=m?u:this.findInodeSync(o,c.dir,"rename"),b=m?d:Ka((s=o.getSync(y.data))!==null&&s!==void 0?s:ys(Xe.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ci((i=o.getSync(b[c.base]))!==null&&i!==void 0?i:ys(Xe.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Xe.With("EPERM",n,"rename");o.removeSync(v.data),o.removeSync(b[c.base])}b[c.base]=h,o.setSync(u.data,Tl(d)),o.setSync(y.data,Tl(b)),o.commitSync(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{Ms(a)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ns(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=Ms(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ns(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{Ms(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ns(r,this.transaction(),!0),i=await this.findInode(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ma(i))),await s.commit()}catch(s){r.error=s,r.hasError=!0}finally{const s=Ms(r);s&&await s}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ns(r,this.transaction(),!1),i=this.findInodeSync(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ma(i))),s.commitSync()}catch(s){r.error=s,r.hasError=!0}finally{Ms(r)}}async createFile(t,n){return n.mode|=vc,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=vc,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Xe.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Xe.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=Ti,await this.commitNew(t,n,Lp("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=Ti,this.commitNewSync(t,n,Lp("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Ns(r,this.transaction(),!0),i=await this.findInode(s,t,"readdir");return Object.keys(Ka((n=await s.get(i.data))!==null&&n!==void 0?n:ys(Xe.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{const s=Ms(r);s&&await s}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Ns(r,this.transaction(),!1),i=this.findInodeSync(s,t,"readdir");return Object.keys(Ka((n=s.getSync(i.data))!==null&&n!==void 0?n:ys(Xe.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{Ms(r)}}async sync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Ns(s,this.transaction(),!0),a=await this.findInode(i,t,"sync");n&&await i.set(a.data,n),a.update(r)&&(this._add(a.ino,t),await i.set(a.ino,ma(a))),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=Ms(s);i&&await i}}syncSync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Ns(s,this.transaction(),!1),a=this.findInodeSync(i,t,"sync");n&&i.setSync(a.data,n),a.update(r)&&(this._add(a.ino,t),i.setSync(a.ino,ma(a))),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{Ms(s)}}async link(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Ns(s,this.transaction(),!0),a=Yr(n),o=await this.findInode(i,a,"link"),l=Ka((r=await i.get(o.data))!==null&&r!==void 0?r:ys(Xe.With("ENOENT",a,"link"))),c=await this.findInode(i,t,"link");c.nlink++,l[J0(n)]=c.ino,this._add(c.ino,n),await i.set(c.ino,ma(c)),await i.set(o.data,Tl(l)),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=Ms(s);i&&await i}}linkSync(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Ns(s,this.transaction(),!1),a=Yr(n),o=this.findInodeSync(i,a,"link"),l=Ka((r=i.getSync(o.data))!==null&&r!==void 0?r:ys(Xe.With("ENOENT",a,"link"))),c=this.findInodeSync(i,t,"link");c.nlink++,l[J0(n)]=c.ino,this._add(c.ino,n),i.setSync(c.ino,ma(c)),i.setSync(o.data,Tl(l)),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{Ms(s)}}async read(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ns(a,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const c=(i=await o.get(l.data,r,s))!==null&&i!==void 0?i:ys(Xe.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&wo(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{const o=Ms(a);o&&await o}}readSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ns(a,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const c=(i=o.getSync(l.data,r,s))!==null&&i!==void 0?i:ys(Xe.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&wo(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{Ms(a)}}async write(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Ns(i,this.transaction(),!0),o=await this.findInode(a,t,"write");let l=n;a.flag("partial")||(l=Kx((s=await a.get(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await a.set(o.data,l,r),this._add(o.ino,t),await a.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=Ms(i);a&&await a}}writeSync(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Ns(i,this.transaction(),!1),o=this.findInodeSync(a,t,"write");let l=n;a.flag("partial")||(l=Kx((s=a.getSync(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),a.setSync(o.data,l,r),this._add(o.ino,t),a.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{Ms(i)}}transaction(){return new s_e(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ns(t,this.transaction(),!0);if(await n.get(Yo))return;const r=new Ci({ino:Yo,data:1,mode:511|Ti});await n.set(r.data,Lp("{}")),this._add(Yo,"/"),await n.set(Yo,ma(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=Ms(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ns(t,this.transaction(),!1);if(n.getSync(Yo))return;const r=new Ci({ino:Yo,data:1,mode:511|Ti});n.setSync(r.data,Lp("{}")),this._add(Yo,"/"),n.setSync(Yo,ma(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{Ms(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){Oa("Attempted to populate tables after initialization");return}mx("Populating tables with existing store metadata");const n=Ns(t,this.transaction(),!0),r=await n.get(Yo);if(!r){_P("Store does not have a root inode");const o=new Ci({ino:Yo,data:1,mode:511|Ti});await n.set(o.data,Lp("{}")),this._add(Yo,"/"),await n.set(Yo,ma(o)),await n.commit();return}if(r.length<zs(Ci)){ME("Store contains an invalid root inode. Refusing to populate tables");return}const s=new Set;let i=0;const a=[["/",Yo]];for(;a.length>0;){i++;const[o,l]=a.shift();this._add(l,o);const c=await n.get(l);if(!c){Oa("Store is missing data for inode: "+l);continue}if(c.length<zs(Ci)){Oa(`Invalid inode size for ino ${l}: ${c.length}`);continue}const u=new Ci(c);if((u.mode&Ti)!=Ti||s.has(l))continue;s.add(l);const d=await n.get(u.data);if(!d){Oa("Store is missing directory data: "+u.data);continue}const h=Ka(d);for(const[m,y]of Object.entries(h))a.push([is(o,m),y])}mx(`Added ${i} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=Ms(t);n&&await n}}async findInode(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Xe.With("ENOENT",n,r);return new Ci((s=await t.get(i))!==null&&s!==void 0?s:ys(Xe.With("ENOENT",n,r)))}findInodeSync(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Xe.With("ENOENT",n,r);return new Ci((s=t.getSync(i))!==null&&s!==void 0?s:ys(Xe.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const s=this._lastID;if(s>io)throw wo(new Xe(gt.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(s,t),s}async commitNew(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Xe.With("EEXIST",t,s);const o=Ns(a,this.transaction(),!0),{dir:l,base:c}=eu(t),u=await this.findInode(o,l,s),d=Ka((i=await o.get(u.data))!==null&&i!==void 0?i:ys(Xe.With("ENOENT",l,s)));if(d[c])throw Xe.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ci({...n,ino:h,data:h+1,size:r.byteLength});return await o.set(m.ino,ma(m)),await o.set(m.data,r),d[c]=m.ino,await o.set(u.data,Tl(d)),await o.commit(),m}catch(o){a.error=o,a.hasError=!0}finally{const o=Ms(a);o&&await o}}commitNewSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Xe.With("EEXIST",t,s);const o=Ns(a,this.transaction(),!1),{dir:l,base:c}=eu(t),u=this.findInodeSync(o,l,s),d=Ka((i=o.getSync(u.data))!==null&&i!==void 0?i:ys(Xe.With("ENOENT",l,s)));if(d[c])throw Xe.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ci({...n,ino:h,data:h+1,size:r.byteLength});return o.setSync(m.ino,ma(m)),o.setSync(m.data,r),d[c]=m.ino,o.setSync(u.data,Tl(d)),o.commitSync(),m}catch(o){a.error=o,a.hasError=!0}finally{Ms(a)}}async remove(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Ns(i,this.transaction(),!0),{dir:l,base:c}=eu(t),u=await this.findInode(o,l,a),d=Ka((r=await o.get(u.data))!==null&&r!==void 0?r:ys(Xe.With("ENOENT",l,a)));if(!d[c])throw Xe.With("ENOENT",t,a);const h=d[c],m=new Ci((s=await o.get(h))!==null&&s!==void 0?s:ys(Xe.With("ENOENT",t,a)));if(delete d[c],!n&&Tc(m))throw Xe.With("EISDIR",t,a);await o.set(u.data,Tl(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),await o.set(m.ino,ma(m))):(await o.remove(m.data),await o.remove(h),this._remove(h)),await o.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=Ms(i);a&&await a}}removeSync(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Ns(i,this.transaction(),!1),{dir:l,base:c}=eu(t),u=this.findInodeSync(o,l,a),d=Ka((r=o.getSync(u.data))!==null&&r!==void 0?r:ys(Xe.With("ENOENT",l,a))),h=d[c];if(!h)throw Xe.With("ENOENT",t,a);const m=new Ci((s=o.getSync(h))!==null&&s!==void 0?s:ys(Xe.With("ENOENT",t,a)));if(delete d[c],!n&&Tc(m))throw Xe.With("EISDIR",t,a);o.setSync(u.data,Tl(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),o.setSync(m.ino,ma(m))):(o.removeSync(m.data),o.removeSync(h),this._remove(h)),o.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{Ms(i)}}}class i_e extends r_e{async keys(){return this.store.keys()}async get(t){var n,r,s;return await((s=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&s!==void 0?s:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class a_e extends Map{constructor(t=io,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new i_e(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const o_e={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new jK(new a_e(e,t));return n.checkRootSync(),n}},l_e=o_e;let Ui=!0;class V$ extends mP{get cursor(){return this._cursor}constructor(t,n,r,s=!1){super(),this.input=t,this.output=n,this.terminal=s,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=i=>{if(!(this._paused||this._closed)){this._buffer+=typeof i=="string"?i:i.toString("utf8");for(let a=this._buffer.indexOf(`
`);a>=0;a=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,a);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(a+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;Al(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;Al(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);TS(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);TS(this.output,0),Al(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const s=this.line.slice(0,r+1)+this.line.slice(this._cursor),i=r+1;this._renderLine(s),this._cursor=i,this._cursor=i,Al(this.output,-s.length,0),Al(this.output,i,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const s=Math.max(0,Math.min(this.line.length,this._cursor+r));if(s==this._cursor)return;Al(this.output,r,0),this._cursor=s,this._cursor=s;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(Al(this.output,-this._cursor,0),Al(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);TS(this.output,0),Al(this.output,0,0),this.output.write(this._prompt+r),this.line=r,Al(this.output,-r.length,0),Al(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&(TS(this.output,0),Al(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const s=typeof n=="function"?n:r;if(this._closed||!this.output){s("");return}this.output.write(t),this.once("line",s)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return Oa("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return Oa("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",s=>n({value:s,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function c_e(e,t,n,r){return"input"in e?new V$(e.input,e.output,e.completer,e.terminal):new V$(e,t,n,r)}function TS(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function Al(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class DC{get position(){return this.flag&mm?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,s,i,a){this.context=t,this.path=n,this.fs=r,this.internalPath=s,this.flag=i,this.inode=a,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&PE||this.inode.flags&_o.Sync)}sync(){if(this.closed)throw Xe.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Xe.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Xe.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Xe.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Xe.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Xe.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&ja||this.flag&Ad))throw new Xe(gt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"write");if(!(this.flag&ja||this.flag&Ad))throw new Xe(gt.EPERM,"File not opened with a writeable mode");if(this.inode.flags&_o.Immutable)throw new Xe(gt.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!Jx(this.inode)&&!Xx(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,this.fs.writeSync(this.internalPath,a,s),this._isSync&&this.sync(),a.byteLength}read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"read");if(this.flag&ja)throw new Xe(gt.EPERM,"File not opened with a readable mode");this.inode.flags&_o.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!Jx(this.inode)&&!Xx(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&this.sync(),i-s}chmod(t){if(this.closed)throw Xe.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>Ss?-61441:Ss)|t,(this._isSync||t>Ss)&&this.sync()}chown(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"chown");this.dirty=!0,MK(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Xe.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Xe.With("EBADF",this.path,"streamWrite");if(this.inode.flags&_o.Immutable)throw new Xe(gt.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function FC(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:Mc.descriptors,s=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(s,e),s}function za(e,t){var n;const s=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Mc.descriptors).get(t);if(!s)throw new Xe(gt.EBADF);return s}function OK(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Mc.descriptors).delete(t)}const u_e=/[rwasx]{1,2}\+?/;function Nd(e){if(typeof e=="number")return e;if(!u_e.test(e))throw new Xe(gt.EINVAL,"Invalid flag string: "+e);return d_e(e)}function d_e(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Xe(gt.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?vK:IE;return e.includes("w")&&(t|=OE),e.includes("a")&&(t|=mm),e.includes("+")?t|=Ad:e.includes("r")||(t|=ja),e.includes("s")&&(t|=PE),e.includes("x")&&(t|=jE),t}function PK(e){let t=0;return e&ja||(t|=zi),(e&ja||e&Ad)&&(t|=ai),t}const Qx=new Map;AP("/",l_e.create({label:"root"}));function AP(e,t){if(e[0]!="/"&&(e="/"+e),e=Bd.call(this,e),Qx.has(e))throw wo(new Xe(gt.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,Qx.set(e,t),yK(`Mounted ${t.name} on ${e}`),mx(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function DK(e){if(e[0]!="/"&&(e="/"+e),e=Bd.call(this,e),!Qx.has(e)){Oa(e+" is already unmounted");return}Qx.delete(e),_P("Unmounted "+e)}function Nr(e,t){const n=(t==null?void 0:t.root)||Mc.root;e=Pn(is(n,e));const r=[...Qx].sort((s,i)=>s[0].length>i[0].length?-1:1);for(const[s,i]of r)if(h_e(s,e))return e=e.slice(s.length>1?s.length:0),e===""&&(e=n),{fs:i,path:e,mountPoint:s,root:n};throw S1e(new Xe(gt.EIO,"No file system",e))}function XN(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function fs(e,t){typeof e.stack=="string"&&(e.stack=XN(e.stack,t));try{e.message=XN(e.message,t)}catch{}return e.path&&(e.path=XN(e.path,t)),e}function FK(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||io),files:(t?BigInt:Number)(n.totalNodes||io),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function f_e(e){var t,n,r,s,i,a,o;const l=this!==null&&this!==void 0?this:Mc;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((s=l.credentials)===null||s===void 0?void 0:s.egid)!==0)throw new Xe(gt.EPERM,"Can not chroot() as non-root user");(i=l.root)!==null&&i!==void 0||(l.root="/");const c=is(l.root,e);for(const u of(o=(a=l.descriptors)===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[]){if(!u.path.startsWith(l.root))throw Xe.With("EBUSY",u.path,"chroot");u.path=u.path.slice(l.root.length)}if(c.length>l.root.length)throw new Xe(gt.EPERM,"Can not chroot() outside of current root");l.root=c}function h_e(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class LK extends mP{off(t,n,r,s){return super.off(t,n,r,s)}removeListener(t,n,r,s){return super.removeListener(t,n,r,s)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Xe.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Xe.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class BK extends LK{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?is(t.root,n):n,m_e(this.realpath,this)}close(){super.emit("close"),g_e(this.realpath,this)}[Symbol.dispose](){this.close()}}class p_e extends LK{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=wh(this.path);K1e(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=wh(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const ah=new Map;function m_e(e,t){const n=Pn(e);ah.has(n)||ah.set(n,new Set),ah.get(n).add(t)}function g_e(e,t){const n=Pn(e);ah.has(n)&&(ah.get(n).delete(t),ah.get(n).size===0&&ah.delete(n))}function xa(e,t,n){var r;e&&(n=is((r=e.root)!==null&&r!==void 0?r:"/",n)),n=Pn(n);for(let s=n;s!="/";s=Yr(s)){const i=ah.get(s);if(i)for(const a of i)a.emit("change",t,gK.call(a._context,s,n)||J0(n))}}var h1=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},p1=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function y_e(e,t){e=Pn(e),t=Pn(t);const n=Nr(e,this),r=Nr(t,this);if(!wh.call(this,Yr(e)).hasAccess(ai,this))throw Xe.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),xa(this,"rename",e.toString()),xa(this,"change",t.toString());return}jP.call(this,t,IP(e)),MP.call(this,e),xa(this,"rename",e.toString())}catch(s){throw fs(s,{[n.path]:e,[r.path]:t})}}function RP(e){e=Pn(e);try{const{fs:t,path:n}=Nr(zh.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==gt.ENOENT)return!1;throw t}}function wh(e,t){e=Pn(e);const{fs:n,path:r}=Nr(zh.call(this,e),this);try{const s=n.statSync(r);if(Ui&&!ds(this,s,zi))throw Xe.With("EACCES",r,"stat");return t!=null&&t.bigint?new Om(s):new ef(s)}catch(s){throw fs(s,{[r]:e})}}function NP(e,t){e=Pn(e);const{fs:n,path:r}=Nr(e,this);try{const s=n.statSync(r);if(Ui&&!ds(this,s,zi))throw Xe.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Om(s):new ef(s)}catch(s){throw fs(s,{[r]:e})}}function b_e(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=h1(n,Pm.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Xe(gt.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{p1(n)}}function MP(e){e=Pn(e);const{fs:t,path:n}=Nr(e,this);try{if(Ui&&!ds(this,t.statSync(n),ai))throw Xe.With("EACCES",n,"unlink");t.unlinkSync(n),xa(this,"rename",e.toString())}catch(r){throw fs(r,{[n]:e})}}function Pm(e,t){var n;e=Pn(e);const r=$h(t.mode,420),s=Nd(t.flag);e=t.preserveSymlinks?e:zh.call(this,e);const{fs:i,path:a}=Nr(e,this);let o;try{o=i.statSync(a)}catch{}if(!o){if(!(s&IE))throw Xe.With("ENOENT",e,"_open");const c=i.statSync(Yr(a));if(!ds(this,c,ai))throw Xe.With("EACCES",Yr(e),"_open");if(!Tc(c))throw Xe.With("ENOTDIR",Yr(e),"_open");if(!t.allowDirectory&&r&Ti)throw Xe.With("EISDIR",e,"_open");if(!ds(this,c,ai))throw Xe.With("EACCES",Yr(a),"_open");const{euid:u,egid:d}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Mc.credentials,h=i.createFileSync(a,{mode:r,uid:c.mode&d1?c.uid:u,gid:c.mode&f1?c.gid:d});return new DC(this,e,i,a,s,h)}if(!ds(this,o,r)||!ds(this,o,PK(s)))throw Xe.With("EACCES",e,"_open");if(s&jE)throw Xe.With("EEXIST",e,"_open");const l=new DC(this,e,i,a,s,o);if(s&OE&&l.truncate(0),!t.allowDirectory&&o.mode&Ti)throw Xe.With("EISDIR",e,"_open");return l}function DE(e,t,n=CP){return FC(Pm.call(this,e,{flag:t,mode:n}))}function FE(e,t,n){return FC(Pm.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function $K(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=h1(r,typeof e=="number"?za(this,e):Pm.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:i}=s.stat(),a=new Uint8Array(i);return s.read(a,0,i,0),a}catch(s){r.error=s,r.hasError=!0}finally{p1(r)}}function IP(e,t={}){const n=Rd(t,null,"r",420);if(Nd(n.flag)&ja)throw new Xe(gt.EINVAL,"Flag passed to readFile must allow for reading");const s=Os.from($K.call(this,e,n.flag,!1));return n.encoding?s.toString(n.encoding):s}function jP(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Rd(n,"utf8","w+",420),i=Nd(s.flag);if(!(i&ja||i&Ad))throw new Xe(gt.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!s.encoding)throw new Xe(gt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Os.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Xe(gt.EINVAL,"Data not specified");h1(r,typeof e=="number"?za(this,e):Pm.call(this,e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength,0),xa(this,"change",e.toString())}catch(s){r.error=s,r.hasError=!0}finally{p1(r)}}function v_e(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Rd(n,"utf8","a+",420),i=Nd(s.flag);if(!(i&mm))throw new Xe(gt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Xe(gt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Os.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);h1(r,Pm.call(this,typeof e=="number"?za(this,e).path:e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength)}catch(s){r.error=s,r.hasError=!0}finally{p1(r)}}function x_e(e,t){const n=za(this,e).stat();return t!=null&&t.bigint?new Om(n):new ef(n)}function Dm(e){za(this,e).close(),OK(this,e)}function w_e(e,t=0){if(t||(t=0),t<0)throw new Xe(gt.EINVAL);za(this,e).truncate(t)}function __e(e){za(this,e).sync()}function S_e(e){za(this,e).datasync()}function C_e(e,t,n,r,s){let i,a,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const d=typeof r=="string"?r:"utf8";a=0,i=Os.from(t,d),o=i.byteLength}else i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,l=typeof s=="number"?s:null;const c=za(this,e);l??(l=c.position);const u=c.write(i,a,o,l);return xa(this,"change",c.path),u}function k_e(e,t,n,r,s){const i=za(this,e),a=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,s=n.position),s=Number(s),isNaN(s)&&(s=i.position),i.read(t,a,r,s)}function OP(e,t,n){za(this,e).chown(t,n)}function PP(e,t){const n=$h(t,-1);if(n<0)throw new Xe(gt.EINVAL,"Invalid mode.");za(this,e).chmod(n)}function DP(e,t,n){za(this,e).utimes(PC(t),PC(n))}function zK(e){e=Pn(e);const{fs:t,path:n}=Nr(zh.call(this,e),this);try{const r=t.statSync(n);if(!Tc(r))throw Xe.With("ENOTDIR",n,"rmdir");if(Ui&&!ds(this,r,ai))throw Xe.With("EACCES",n,"rmdir");t.rmdirSync(n),xa(this,"rename",e.toString())}catch(r){throw fs(r,{[n]:e})}}function FP(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Mc.credentials;t=typeof t=="object"?t:{mode:t};const a=$h(t==null?void 0:t.mode,511);e=zh.call(this,e);const{fs:o,path:l,root:c}=Nr(e,this),u={[l]:e},d=(h,m)=>{if(!ds(this,m,ai))throw Xe.With("EACCES",Yr(h),"mkdir");const y=o.mkdirSync(h,{mode:a,uid:m.mode&d1?m.uid:s,gid:m.mode&f1?m.gid:i});return xa(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){d(l,o.statSync(Yr(l)));return}const h=[];for(let y=l,b=e;!o.existsSync(y);y=Yr(y),b=Yr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[o.statSync(Yr(h[0]))];for(const[y,b]of h.entries())m.push(d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw fs(h,u)}}function Ly(e,t){t=typeof t=="object"?t:{encoding:t},e=Pn(e);const{fs:n,path:r}=Nr(zh.call(this,e),this);let s;try{const a=n.statSync(r);if(Ui&&!ds(this,a,zi))throw Xe.With("EACCES",r,"readdir");if(!Tc(a))throw Xe.With("ENOTDIR",r,"readdir");s=n.readdirSync(r)}catch(a){throw fs(a,{[r]:e})}const i=[];for(const a of s){let o;try{o=n.statSync(is(r,a))}catch{continue}if(t!=null&&t.withFileTypes?i.push(new ew(a,o)):(t==null?void 0:t.encoding)=="buffer"?i.push(Os.from(a)):i.push(a),!(!Tc(o)||!(t!=null&&t.recursive)))for(const l of Ly.call(this,is(e,a),t))l instanceof ew?(l.path=is(a,l.path),i.push(l)):Os.isBuffer(l)?i.push(Os.from(is(a,yP(l)))):i.push(is(a,l))}return i}function E_e(e,t){if(e=Pn(e),!wh(Yr(e)).hasAccess(zi,this))throw Xe.With("EACCES",Yr(e),"link");if(t=Pn(t),!wh(Yr(t)).hasAccess(ai,this))throw Xe.With("EACCES",Yr(t),"link");const{fs:n,path:r}=Nr(e,this),s=Nr(t,this);if(n!=s.fs)throw Xe.With("EXDEV",t,"link");try{if(Ui&&!ds(this,n.statSync(r),zi))throw Xe.With("EACCES",r,"link");return n.linkSync(r,s.path)}catch(i){throw fs(i,{[r]:e,[s.path]:t})}}function T_e(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Xe(gt.EINVAL,"Invalid type: "+n);t=Pn(t);const s=h1(r,Pm.call(this,t,{flag:"wx",mode:420}),!1);s.write(Lp(Pn(e,!0))),s.chmod(Qd)}catch(s){r.error=s,r.hasError=!0}finally{p1(r)}}function xj(e,t){const n=Os.from($K.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function A_e(e,t,n){const r=DE.call(this,e,"r+");OP.call(this,r,t,n),Dm.call(this,r)}function R_e(e,t,n){const r=FE.call(this,e,"r+");OP.call(this,r,t,n),Dm.call(this,r)}function N_e(e,t){const n=DE.call(this,e,"r+");PP.call(this,n,t),Dm.call(this,n)}function M_e(e,t){const n=FE.call(this,e,"r+");PP.call(this,n,t),Dm.call(this,n)}function UK(e,t,n){const r=DE.call(this,e,"r+");DP.call(this,r,t,n),Dm.call(this,r)}function I_e(e,t,n){const r=FE.call(this,e,"r+");DP.call(this,r,t,n),Dm.call(this,r)}function wj(e,t,n){try{const l=Nr(t,e),c=l.fs.statSync(l.path);if(!Q0(c))return{...l,fullPath:t,stats:c};const u=Bd.call(e,Yr(t),xj.call(e,t).toString());return wj(e,u)}catch{}const{base:r,dir:s}=eu(t),i=s=="/"?"/":zh.call(e,s),a=is(i,r),o=Nr(a,e);try{const l=o.fs.statSync(o.path);if(!Q0(l))return{...o,fullPath:a,stats:l};const c=Bd.call(e,i,xj.call(e,a).toString());return wj(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw fs(l,{[o.path]:a})}}function zh(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Pn(e);const{fullPath:s}=wj(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Os.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function j_e(e,t=384){if(!ds(this,wh.call(this,e),t))throw new Xe(gt.EACCES)}function qK(e,t){e=Pn(e);let n;try{n=NP.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&Ss){case Ti:if(t!=null&&t.recursive)for(const r of Ly.call(this,e))qK.call(this,is(e,r),t);zK.call(this,e);break;case vc:case Qd:case Mm:case Im:MP.call(this,e);break;case jm:case Nm:default:throw new Xe(gt.EPERM,"File type not supported",e,"rm")}}function O_e(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return FP.call(this,s),n=="buffer"?Os.from(s):s}function VK(e,t,n){if(e=Pn(e),t=Pn(t),n&&n&kP&&RP(t))throw new Xe(gt.EEXIST,"Destination file already exists",t,"copyFile");jP.call(this,t,IP(e)),xa(this,"rename",t.toString())}function P_e(e,t,n){const r=za(this,e);let s=0;for(const i of t)s+=r.read(i,0,i.byteLength,n+s);return s}function D_e(e,t,n){const r=za(this,e);let s=0;for(const i of t)s+=r.write(new Uint8Array(i.buffer),0,i.byteLength,n+s);return s}function F_e(e,t){return e=Pn(e),new LP(e,this)}function WK(e,t,n){e=Pn(e),t=Pn(t);const r=NP.call(this,e);if(n!=null&&n.errorOnExist&&RP.call(this,t))throw new Xe(gt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Ss){case Ti:if(!(n!=null&&n.recursive))throw new Xe(gt.EISDIR,e+" is a directory (not copied)",e,"cp");FP.call(this,t,{recursive:!0});for(const s of Ly.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(is(e,s.name),is(t,s.name))||WK.call(this,is(e,s.name),is(t,s.name),n);break;case vc:case Qd:VK.call(this,e,t);break;case Mm:case Im:case jm:case Nm:default:throw new Xe(gt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&UK.call(this,t,r.atime,r.mtime)}function L_e(e,t){e=Pn(e);const{fs:n}=Nr(e,this);return FK(n,t==null?void 0:t.bigint)}function B_e(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t,i=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),a=[];function o(l){const c=Ly(l,{withFileTypes:r,encoding:"utf8"});for(const u of c){const d=r?u.path:l+"/"+u;s(r?u:d)||(wh(d).isDirectory()&&i.some(h=>h.source.includes(".*"))&&o(d),i.some(h=>h.test(d.replace(/^\/+/g,"")))&&a.push(r?u.path:d.replace(/^\/+/g,"")))}}return o(n),a}class ew{get name(){return J0(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return Q1e(this.stats)}isDirectory(){return Tc(this.stats)}isBlockDevice(){return Xx(this.stats)}isCharacterDevice(){return Jx(this.stats)}isSymbolicLink(){return Q0(this.stats)}isFIFO(){return t_e(this.stats)}isSocket(){return e_e(this.stats)}}class LP{checkClosed(){if(this.closed)throw new Xe(gt.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await Lm.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=Ly.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var JN={exports:{}},QN={exports:{}},eM={},W$;function Uh(){return W$||(W$=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=u,n.toByteArray=h,n.fromByteArray=b;for(var r=[],s=[],i=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],s[a.charCodeAt(o)]=o;s[45]=62,s[95]=63;function c(w){var S=w.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var C=w.indexOf("=");C===-1&&(C=S);var k=C===S?0:4-C%4;return[C,k]}function u(w){var S=c(w),C=S[0],k=S[1];return(C+k)*3/4-k}function d(w,S,C){return(S+C)*3/4-C}function h(w){var S,C=c(w),k=C[0],A=C[1],R=new i(d(w,k,A)),N=0,I=A>0?k-4:k,O;for(O=0;O<I;O+=4)S=s[w.charCodeAt(O)]<<18|s[w.charCodeAt(O+1)]<<12|s[w.charCodeAt(O+2)]<<6|s[w.charCodeAt(O+3)],R[N++]=S>>16&255,R[N++]=S>>8&255,R[N++]=S&255;return A===2&&(S=s[w.charCodeAt(O)]<<2|s[w.charCodeAt(O+1)]>>4,R[N++]=S&255),A===1&&(S=s[w.charCodeAt(O)]<<10|s[w.charCodeAt(O+1)]<<4|s[w.charCodeAt(O+2)]>>2,R[N++]=S>>8&255,R[N++]=S&255),R}function m(w){return r[w>>18&63]+r[w>>12&63]+r[w>>6&63]+r[w&63]}function y(w,S,C){for(var k,A=[],R=S;R<C;R+=3)k=(w[R]<<16&16711680)+(w[R+1]<<8&65280)+(w[R+2]&255),A.push(m(k));return A.join("")}function b(w){for(var S,C=w.length,k=C%3,A=[],R=16383,N=0,I=C-k;N<I;N+=R)A.push(y(w,N,N+R>I?I:N+R));return k===1?(S=w[C-1],A.push(r[S>>2]+r[S<<4&63]+"==")):k===2&&(S=(w[C-2]<<8)+w[C-1],A.push(r[S>>10]+r[S>>4&63]+r[S<<2&63]+"=")),A.join("")}var v={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */v.read=function(w,S,C,k,A){var R,N,I=A*8-k-1,O=(1<<I)-1,L=O>>1,P=-7,V=C?A-1:0,F=C?-1:1,X=w[S+V];for(V+=F,R=X&(1<<-P)-1,X>>=-P,P+=I;P>0;R=R*256+w[S+V],V+=F,P-=8);for(N=R&(1<<-P)-1,R>>=-P,P+=k;P>0;N=N*256+w[S+V],V+=F,P-=8);if(R===0)R=1-L;else{if(R===O)return N?NaN:(X?-1:1)*(1/0);N=N+Math.pow(2,k),R=R-L}return(X?-1:1)*N*Math.pow(2,R-k)},v.write=function(w,S,C,k,A,R){var N,I,O,L=R*8-A-1,P=(1<<L)-1,V=P>>1,F=A===23?Math.pow(2,-24)-Math.pow(2,-77):0,X=k?0:R-1,U=k?1:-1,H=S<0||S===0&&1/S<0?1:0;for(S=Math.abs(S),isNaN(S)||S===1/0?(I=isNaN(S)?1:0,N=P):(N=Math.floor(Math.log(S)/Math.LN2),S*(O=Math.pow(2,-N))<1&&(N--,O*=2),N+V>=1?S+=F/O:S+=F*Math.pow(2,1-V),S*O>=2&&(N++,O/=2),N+V>=P?(I=0,N=P):N+V>=1?(I=(S*O-1)*Math.pow(2,A),N=N+V):(I=S*Math.pow(2,V-1)*Math.pow(2,A),N=0));A>=8;w[C+X]=I&255,X+=U,I/=256,A-=8);for(N=N<<A|I,L+=A;L>0;w[C+X]=N&255,X+=U,N/=256,L-=8);w[C+X-U]|=H*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(w){const S=n,C=v,k=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;w.Buffer=P,w.SlowBuffer=se,w.INSPECT_MAX_BYTES=50;const A=2147483647;w.kMaxLength=A;const{Uint8Array:R,ArrayBuffer:N,SharedArrayBuffer:I}=globalThis;P.TYPED_ARRAY_SUPPORT=O(),!P.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function O(){try{const Y=new R(1),G={foo:function(){return 42}};return Object.setPrototypeOf(G,R.prototype),Object.setPrototypeOf(Y,G),Y.foo()===42}catch{return!1}}Object.defineProperty(P.prototype,"parent",{enumerable:!0,get:function(){if(P.isBuffer(this))return this.buffer}}),Object.defineProperty(P.prototype,"offset",{enumerable:!0,get:function(){if(P.isBuffer(this))return this.byteOffset}});function L(Y){if(Y>A)throw new RangeError('The value "'+Y+'" is invalid for option "size"');const G=new R(Y);return Object.setPrototypeOf(G,P.prototype),G}function P(Y,G,J){if(typeof Y=="number"){if(typeof G=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return U(Y)}return V(Y,G,J)}P.poolSize=8192;function V(Y,G,J){if(typeof Y=="string")return H(Y,G);if(N.isView(Y))return ne(Y);if(Y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y);if(ye(Y,N)||Y&&ye(Y.buffer,N)||typeof I<"u"&&(ye(Y,I)||Y&&ye(Y.buffer,I)))return W(Y,G,J);if(typeof Y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const be=Y.valueOf&&Y.valueOf();if(be!=null&&be!==Y)return P.from(be,G,J);const Pe=Q(Y);if(Pe)return Pe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Y[Symbol.toPrimitive]=="function")return P.from(Y[Symbol.toPrimitive]("string"),G,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y)}P.from=function(Y,G,J){return V(Y,G,J)},Object.setPrototypeOf(P.prototype,R.prototype),Object.setPrototypeOf(P,R);function F(Y){if(typeof Y!="number")throw new TypeError('"size" argument must be of type number');if(Y<0)throw new RangeError('The value "'+Y+'" is invalid for option "size"')}function X(Y,G,J){return F(Y),Y<=0?L(Y):G!==void 0?typeof J=="string"?L(Y).fill(G,J):L(Y).fill(G):L(Y)}P.alloc=function(Y,G,J){return X(Y,G,J)};function U(Y){return F(Y),L(Y<0?0:ee(Y)|0)}P.allocUnsafe=function(Y){return U(Y)},P.allocUnsafeSlow=function(Y){return U(Y)};function H(Y,G){if((typeof G!="string"||G==="")&&(G="utf8"),!P.isEncoding(G))throw new TypeError("Unknown encoding: "+G);const J=pe(Y,G)|0;let be=L(J);const Pe=be.write(Y,G);return Pe!==J&&(be=be.slice(0,Pe)),be}function $(Y){const G=Y.length<0?0:ee(Y.length)|0,J=L(G);for(let be=0;be<G;be+=1)J[be]=Y[be]&255;return J}function ne(Y){if(ye(Y,R)){const G=new R(Y);return W(G.buffer,G.byteOffset,G.byteLength)}return $(Y)}function W(Y,G,J){if(G<0||Y.byteLength<G)throw new RangeError('"offset" is outside of buffer bounds');if(Y.byteLength<G+(J||0))throw new RangeError('"length" is outside of buffer bounds');let be;return G===void 0&&J===void 0?be=new R(Y):J===void 0?be=new R(Y,G):be=new R(Y,G,J),Object.setPrototypeOf(be,P.prototype),be}function Q(Y){if(P.isBuffer(Y)){const G=ee(Y.length)|0,J=L(G);return J.length===0||Y.copy(J,0,0,G),J}if(Y.length!==void 0)return typeof Y.length!="number"||_e(Y.length)?L(0):$(Y);if(Y.type==="Buffer"&&Array.isArray(Y.data))return $(Y.data)}function ee(Y){if(Y>=A)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+A.toString(16)+" bytes");return Y|0}function se(Y){return+Y!=Y&&(Y=0),P.alloc(+Y)}P.isBuffer=function(G){return G!=null&&G._isBuffer===!0&&G!==P.prototype},P.compare=function(G,J){if(ye(G,R)&&(G=P.from(G,G.offset,G.byteLength)),ye(J,R)&&(J=P.from(J,J.offset,J.byteLength)),!P.isBuffer(G)||!P.isBuffer(J))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(G===J)return 0;let be=G.length,Pe=J.length;for(let Ge=0,_t=Math.min(be,Pe);Ge<_t;++Ge)if(G[Ge]!==J[Ge]){be=G[Ge],Pe=J[Ge];break}return be<Pe?-1:Pe<be?1:0},P.isEncoding=function(G){switch(String(G).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},P.concat=function(G,J){if(!Array.isArray(G))throw new TypeError('"list" argument must be an Array of Buffers');if(G.length===0)return P.alloc(0);let be;if(J===void 0)for(J=0,be=0;be<G.length;++be)J+=G[be].length;const Pe=P.allocUnsafe(J);let Ge=0;for(be=0;be<G.length;++be){let _t=G[be];if(ye(_t,R))Ge+_t.length>Pe.length?(P.isBuffer(_t)||(_t=P.from(_t)),_t.copy(Pe,Ge)):R.prototype.set.call(Pe,_t,Ge);else if(P.isBuffer(_t))_t.copy(Pe,Ge);else throw new TypeError('"list" argument must be an Array of Buffers');Ge+=_t.length}return Pe};function pe(Y,G){if(P.isBuffer(Y))return Y.length;if(N.isView(Y)||ye(Y,N))return Y.byteLength;if(typeof Y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Y);const J=Y.length,be=arguments.length>2&&arguments[2]===!0;if(!be&&J===0)return 0;let Pe=!1;for(;;)switch(G){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return vt(Y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J*2;case"hex":return J>>>1;case"base64":return ze(Y).length;default:if(Pe)return be?-1:vt(Y).length;G=(""+G).toLowerCase(),Pe=!0}}P.byteLength=pe;function ce(Y,G,J){let be=!1;if((G===void 0||G<0)&&(G=0),G>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0,G>>>=0,J<=G))return"";for(Y||(Y="utf8");;)switch(Y){case"hex":return Te(this,G,J);case"utf8":case"utf-8":return me(this,G,J);case"ascii":return oe(this,G,J);case"latin1":case"binary":return re(this,G,J);case"base64":return K(this,G,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,G,J);default:if(be)throw new TypeError("Unknown encoding: "+Y);Y=(Y+"").toLowerCase(),be=!0}}P.prototype._isBuffer=!0;function Ie(Y,G,J){const be=Y[G];Y[G]=Y[J],Y[J]=be}P.prototype.swap16=function(){const G=this.length;if(G%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let J=0;J<G;J+=2)Ie(this,J,J+1);return this},P.prototype.swap32=function(){const G=this.length;if(G%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let J=0;J<G;J+=4)Ie(this,J,J+3),Ie(this,J+1,J+2);return this},P.prototype.swap64=function(){const G=this.length;if(G%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let J=0;J<G;J+=8)Ie(this,J,J+7),Ie(this,J+1,J+6),Ie(this,J+2,J+5),Ie(this,J+3,J+4);return this},P.prototype.toString=function(){const G=this.length;return G===0?"":arguments.length===0?me(this,0,G):ce.apply(this,arguments)},P.prototype.toLocaleString=P.prototype.toString,P.prototype.equals=function(G){if(!P.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:P.compare(this,G)===0},P.prototype.inspect=function(){let G="";const J=w.INSPECT_MAX_BYTES;return G=this.toString("hex",0,J).replace(/(.{2})/g,"$1 ").trim(),this.length>J&&(G+=" ... "),"<Buffer "+G+">"},k&&(P.prototype[k]=P.prototype.inspect),P.prototype.compare=function(G,J,be,Pe,Ge){if(ye(G,R)&&(G=P.from(G,G.offset,G.byteLength)),!P.isBuffer(G))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof G);if(J===void 0&&(J=0),be===void 0&&(be=G?G.length:0),Pe===void 0&&(Pe=0),Ge===void 0&&(Ge=this.length),J<0||be>G.length||Pe<0||Ge>this.length)throw new RangeError("out of range index");if(Pe>=Ge&&J>=be)return 0;if(Pe>=Ge)return-1;if(J>=be)return 1;if(J>>>=0,be>>>=0,Pe>>>=0,Ge>>>=0,this===G)return 0;let _t=Ge-Pe,tn=be-J;const Un=Math.min(_t,tn),Xt=this.slice(Pe,Ge),nn=G.slice(J,be);for(let un=0;un<Un;++un)if(Xt[un]!==nn[un]){_t=Xt[un],tn=nn[un];break}return _t<tn?-1:tn<_t?1:0};function De(Y,G,J,be,Pe){if(Y.length===0)return-1;if(typeof J=="string"?(be=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,_e(J)&&(J=Pe?0:Y.length-1),J<0&&(J=Y.length+J),J>=Y.length){if(Pe)return-1;J=Y.length-1}else if(J<0)if(Pe)J=0;else return-1;if(typeof G=="string"&&(G=P.from(G,be)),P.isBuffer(G))return G.length===0?-1:Se(Y,G,J,be,Pe);if(typeof G=="number")return G=G&255,typeof R.prototype.indexOf=="function"?Pe?R.prototype.indexOf.call(Y,G,J):R.prototype.lastIndexOf.call(Y,G,J):Se(Y,[G],J,be,Pe);throw new TypeError("val must be string, number or Buffer")}function Se(Y,G,J,be,Pe){let Ge=1,_t=Y.length,tn=G.length;if(be!==void 0&&(be=String(be).toLowerCase(),be==="ucs2"||be==="ucs-2"||be==="utf16le"||be==="utf-16le")){if(Y.length<2||G.length<2)return-1;Ge=2,_t/=2,tn/=2,J/=2}function Un(nn,un){return Ge===1?nn[un]:nn.readUInt16BE(un*Ge)}let Xt;if(Pe){let nn=-1;for(Xt=J;Xt<_t;Xt++)if(Un(Y,Xt)===Un(G,nn===-1?0:Xt-nn)){if(nn===-1&&(nn=Xt),Xt-nn+1===tn)return nn*Ge}else nn!==-1&&(Xt-=Xt-nn),nn=-1}else for(J+tn>_t&&(J=_t-tn),Xt=J;Xt>=0;Xt--){let nn=!0;for(let un=0;un<tn;un++)if(Un(Y,Xt+un)!==Un(G,un)){nn=!1;break}if(nn)return Xt}return-1}P.prototype.includes=function(G,J,be){return this.indexOf(G,J,be)!==-1},P.prototype.indexOf=function(G,J,be){return De(this,G,J,be,!0)},P.prototype.lastIndexOf=function(G,J,be){return De(this,G,J,be,!1)};function Ce(Y,G,J,be){J=Number(J)||0;const Pe=Y.length-J;be?(be=Number(be),be>Pe&&(be=Pe)):be=Pe;const Ge=G.length;be>Ge/2&&(be=Ge/2);let _t;for(_t=0;_t<be;++_t){const tn=parseInt(G.substr(_t*2,2),16);if(_e(tn))return _t;Y[J+_t]=tn}return _t}function qe(Y,G,J,be){return st(vt(G,Y.length-J),Y,J,be)}function Qe(Y,G,J,be){return st(ot(G),Y,J,be)}function Ve(Y,G,J,be){return st(ze(G),Y,J,be)}function Ne(Y,G,J,be){return st(B(G,Y.length-J),Y,J,be)}P.prototype.write=function(G,J,be,Pe){if(J===void 0)Pe="utf8",be=this.length,J=0;else if(be===void 0&&typeof J=="string")Pe=J,be=this.length,J=0;else if(isFinite(J))J=J>>>0,isFinite(be)?(be=be>>>0,Pe===void 0&&(Pe="utf8")):(Pe=be,be=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ge=this.length-J;if((be===void 0||be>Ge)&&(be=Ge),G.length>0&&(be<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");Pe||(Pe="utf8");let _t=!1;for(;;)switch(Pe){case"hex":return Ce(this,G,J,be);case"utf8":case"utf-8":return qe(this,G,J,be);case"ascii":case"latin1":case"binary":return Qe(this,G,J,be);case"base64":return Ve(this,G,J,be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ne(this,G,J,be);default:if(_t)throw new TypeError("Unknown encoding: "+Pe);Pe=(""+Pe).toLowerCase(),_t=!0}},P.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(Y,G,J){return G===0&&J===Y.length?S.fromByteArray(Y):S.fromByteArray(Y.slice(G,J))}function me(Y,G,J){J=Math.min(Y.length,J);const be=[];let Pe=G;for(;Pe<J;){const Ge=Y[Pe];let _t=null,tn=Ge>239?4:Ge>223?3:Ge>191?2:1;if(Pe+tn<=J){let Un,Xt,nn,un;switch(tn){case 1:Ge<128&&(_t=Ge);break;case 2:Un=Y[Pe+1],(Un&192)===128&&(un=(Ge&31)<<6|Un&63,un>127&&(_t=un));break;case 3:Un=Y[Pe+1],Xt=Y[Pe+2],(Un&192)===128&&(Xt&192)===128&&(un=(Ge&15)<<12|(Un&63)<<6|Xt&63,un>2047&&(un<55296||un>57343)&&(_t=un));break;case 4:Un=Y[Pe+1],Xt=Y[Pe+2],nn=Y[Pe+3],(Un&192)===128&&(Xt&192)===128&&(nn&192)===128&&(un=(Ge&15)<<18|(Un&63)<<12|(Xt&63)<<6|nn&63,un>65535&&un<1114112&&(_t=un))}}_t===null?(_t=65533,tn=1):_t>65535&&(_t-=65536,be.push(_t>>>10&1023|55296),_t=56320|_t&1023),be.push(_t),Pe+=tn}return le(be)}const Ae=4096;function le(Y){const G=Y.length;if(G<=Ae)return String.fromCharCode.apply(String,Y);let J="",be=0;for(;be<G;)J+=String.fromCharCode.apply(String,Y.slice(be,be+=Ae));return J}function oe(Y,G,J){let be="";J=Math.min(Y.length,J);for(let Pe=G;Pe<J;++Pe)be+=String.fromCharCode(Y[Pe]&127);return be}function re(Y,G,J){let be="";J=Math.min(Y.length,J);for(let Pe=G;Pe<J;++Pe)be+=String.fromCharCode(Y[Pe]);return be}function Te(Y,G,J){const be=Y.length;(!G||G<0)&&(G=0),(!J||J<0||J>be)&&(J=be);let Pe="";for(let Ge=G;Ge<J;++Ge)Pe+=Ue[Y[Ge]];return Pe}function Be(Y,G,J){const be=Y.slice(G,J);let Pe="";for(let Ge=0;Ge<be.length-1;Ge+=2)Pe+=String.fromCharCode(be[Ge]+be[Ge+1]*256);return Pe}P.prototype.slice=function(G,J){const be=this.length;G=~~G,J=J===void 0?be:~~J,G<0?(G+=be,G<0&&(G=0)):G>be&&(G=be),J<0?(J+=be,J<0&&(J=0)):J>be&&(J=be),J<G&&(J=G);const Pe=this.subarray(G,J);return Object.setPrototypeOf(Pe,P.prototype),Pe};function ke(Y,G,J){if(Y%1!==0||Y<0)throw new RangeError("offset is not uint");if(Y+G>J)throw new RangeError("Trying to access beyond buffer length")}P.prototype.readUintLE=P.prototype.readUIntLE=function(G,J,be){G=G>>>0,J=J>>>0,be||ke(G,J,this.length);let Pe=this[G],Ge=1,_t=0;for(;++_t<J&&(Ge*=256);)Pe+=this[G+_t]*Ge;return Pe},P.prototype.readUintBE=P.prototype.readUIntBE=function(G,J,be){G=G>>>0,J=J>>>0,be||ke(G,J,this.length);let Pe=this[G+--J],Ge=1;for(;J>0&&(Ge*=256);)Pe+=this[G+--J]*Ge;return Pe},P.prototype.readUint8=P.prototype.readUInt8=function(G,J){return G=G>>>0,J||ke(G,1,this.length),this[G]},P.prototype.readUint16LE=P.prototype.readUInt16LE=function(G,J){return G=G>>>0,J||ke(G,2,this.length),this[G]|this[G+1]<<8},P.prototype.readUint16BE=P.prototype.readUInt16BE=function(G,J){return G=G>>>0,J||ke(G,2,this.length),this[G]<<8|this[G+1]},P.prototype.readUint32LE=P.prototype.readUInt32LE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),(this[G]|this[G+1]<<8|this[G+2]<<16)+this[G+3]*16777216},P.prototype.readUint32BE=P.prototype.readUInt32BE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),this[G]*16777216+(this[G+1]<<16|this[G+2]<<8|this[G+3])},P.prototype.readBigUInt64LE=kt(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],be=this[G+7];(J===void 0||be===void 0)&&we(G,this.length-8);const Pe=J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24,Ge=this[++G]+this[++G]*2**8+this[++G]*2**16+be*2**24;return BigInt(Pe)+(BigInt(Ge)<<BigInt(32))}),P.prototype.readBigUInt64BE=kt(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],be=this[G+7];(J===void 0||be===void 0)&&we(G,this.length-8);const Pe=J*2**24+this[++G]*2**16+this[++G]*2**8+this[++G],Ge=this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+be;return(BigInt(Pe)<<BigInt(32))+BigInt(Ge)}),P.prototype.readIntLE=function(G,J,be){G=G>>>0,J=J>>>0,be||ke(G,J,this.length);let Pe=this[G],Ge=1,_t=0;for(;++_t<J&&(Ge*=256);)Pe+=this[G+_t]*Ge;return Ge*=128,Pe>=Ge&&(Pe-=Math.pow(2,8*J)),Pe},P.prototype.readIntBE=function(G,J,be){G=G>>>0,J=J>>>0,be||ke(G,J,this.length);let Pe=J,Ge=1,_t=this[G+--Pe];for(;Pe>0&&(Ge*=256);)_t+=this[G+--Pe]*Ge;return Ge*=128,_t>=Ge&&(_t-=Math.pow(2,8*J)),_t},P.prototype.readInt8=function(G,J){return G=G>>>0,J||ke(G,1,this.length),this[G]&128?(255-this[G]+1)*-1:this[G]},P.prototype.readInt16LE=function(G,J){G=G>>>0,J||ke(G,2,this.length);const be=this[G]|this[G+1]<<8;return be&32768?be|4294901760:be},P.prototype.readInt16BE=function(G,J){G=G>>>0,J||ke(G,2,this.length);const be=this[G+1]|this[G]<<8;return be&32768?be|4294901760:be},P.prototype.readInt32LE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),this[G]|this[G+1]<<8|this[G+2]<<16|this[G+3]<<24},P.prototype.readInt32BE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),this[G]<<24|this[G+1]<<16|this[G+2]<<8|this[G+3]},P.prototype.readBigInt64LE=kt(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],be=this[G+7];(J===void 0||be===void 0)&&we(G,this.length-8);const Pe=this[G+4]+this[G+5]*2**8+this[G+6]*2**16+(be<<24);return(BigInt(Pe)<<BigInt(32))+BigInt(J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24)}),P.prototype.readBigInt64BE=kt(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],be=this[G+7];(J===void 0||be===void 0)&&we(G,this.length-8);const Pe=(J<<24)+this[++G]*2**16+this[++G]*2**8+this[++G];return(BigInt(Pe)<<BigInt(32))+BigInt(this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+be)}),P.prototype.readFloatLE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),C.read(this,G,!0,23,4)},P.prototype.readFloatBE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),C.read(this,G,!1,23,4)},P.prototype.readDoubleLE=function(G,J){return G=G>>>0,J||ke(G,8,this.length),C.read(this,G,!0,52,8)},P.prototype.readDoubleBE=function(G,J){return G=G>>>0,J||ke(G,8,this.length),C.read(this,G,!1,52,8)};function lt(Y,G,J,be,Pe,Ge){if(!P.isBuffer(Y))throw new TypeError('"buffer" argument must be a Buffer instance');if(G>Pe||G<Ge)throw new RangeError('"value" argument is out of bounds');if(J+be>Y.length)throw new RangeError("Index out of range")}P.prototype.writeUintLE=P.prototype.writeUIntLE=function(G,J,be,Pe){if(G=+G,J=J>>>0,be=be>>>0,!Pe){const tn=Math.pow(2,8*be)-1;lt(this,G,J,be,tn,0)}let Ge=1,_t=0;for(this[J]=G&255;++_t<be&&(Ge*=256);)this[J+_t]=G/Ge&255;return J+be},P.prototype.writeUintBE=P.prototype.writeUIntBE=function(G,J,be,Pe){if(G=+G,J=J>>>0,be=be>>>0,!Pe){const tn=Math.pow(2,8*be)-1;lt(this,G,J,be,tn,0)}let Ge=be-1,_t=1;for(this[J+Ge]=G&255;--Ge>=0&&(_t*=256);)this[J+Ge]=G/_t&255;return J+be},P.prototype.writeUint8=P.prototype.writeUInt8=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,1,255,0),this[J]=G&255,J+1},P.prototype.writeUint16LE=P.prototype.writeUInt16LE=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,2,65535,0),this[J]=G&255,this[J+1]=G>>>8,J+2},P.prototype.writeUint16BE=P.prototype.writeUInt16BE=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,2,65535,0),this[J]=G>>>8,this[J+1]=G&255,J+2},P.prototype.writeUint32LE=P.prototype.writeUInt32LE=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,4,4294967295,0),this[J+3]=G>>>24,this[J+2]=G>>>16,this[J+1]=G>>>8,this[J]=G&255,J+4},P.prototype.writeUint32BE=P.prototype.writeUInt32BE=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,4,4294967295,0),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4};function Rt(Y,G,J,be,Pe){ge(G,be,Pe,Y,J,7);let Ge=Number(G&BigInt(4294967295));Y[J++]=Ge,Ge=Ge>>8,Y[J++]=Ge,Ge=Ge>>8,Y[J++]=Ge,Ge=Ge>>8,Y[J++]=Ge;let _t=Number(G>>BigInt(32)&BigInt(4294967295));return Y[J++]=_t,_t=_t>>8,Y[J++]=_t,_t=_t>>8,Y[J++]=_t,_t=_t>>8,Y[J++]=_t,J}function ft(Y,G,J,be,Pe){ge(G,be,Pe,Y,J,7);let Ge=Number(G&BigInt(4294967295));Y[J+7]=Ge,Ge=Ge>>8,Y[J+6]=Ge,Ge=Ge>>8,Y[J+5]=Ge,Ge=Ge>>8,Y[J+4]=Ge;let _t=Number(G>>BigInt(32)&BigInt(4294967295));return Y[J+3]=_t,_t=_t>>8,Y[J+2]=_t,_t=_t>>8,Y[J+1]=_t,_t=_t>>8,Y[J]=_t,J+8}P.prototype.writeBigUInt64LE=kt(function(G,J=0){return Rt(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),P.prototype.writeBigUInt64BE=kt(function(G,J=0){return ft(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),P.prototype.writeIntLE=function(G,J,be,Pe){if(G=+G,J=J>>>0,!Pe){const Un=Math.pow(2,8*be-1);lt(this,G,J,be,Un-1,-Un)}let Ge=0,_t=1,tn=0;for(this[J]=G&255;++Ge<be&&(_t*=256);)G<0&&tn===0&&this[J+Ge-1]!==0&&(tn=1),this[J+Ge]=(G/_t>>0)-tn&255;return J+be},P.prototype.writeIntBE=function(G,J,be,Pe){if(G=+G,J=J>>>0,!Pe){const Un=Math.pow(2,8*be-1);lt(this,G,J,be,Un-1,-Un)}let Ge=be-1,_t=1,tn=0;for(this[J+Ge]=G&255;--Ge>=0&&(_t*=256);)G<0&&tn===0&&this[J+Ge+1]!==0&&(tn=1),this[J+Ge]=(G/_t>>0)-tn&255;return J+be},P.prototype.writeInt8=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,1,127,-128),G<0&&(G=255+G+1),this[J]=G&255,J+1},P.prototype.writeInt16LE=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,2,32767,-32768),this[J]=G&255,this[J+1]=G>>>8,J+2},P.prototype.writeInt16BE=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,2,32767,-32768),this[J]=G>>>8,this[J+1]=G&255,J+2},P.prototype.writeInt32LE=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,4,2147483647,-2147483648),this[J]=G&255,this[J+1]=G>>>8,this[J+2]=G>>>16,this[J+3]=G>>>24,J+4},P.prototype.writeInt32BE=function(G,J,be){return G=+G,J=J>>>0,be||lt(this,G,J,4,2147483647,-2147483648),G<0&&(G=4294967295+G+1),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4},P.prototype.writeBigInt64LE=kt(function(G,J=0){return Rt(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),P.prototype.writeBigInt64BE=kt(function(G,J=0){return ft(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function jt(Y,G,J,be,Pe,Ge){if(J+be>Y.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function qt(Y,G,J,be,Pe){return G=+G,J=J>>>0,Pe||jt(Y,G,J,4),C.write(Y,G,J,be,23,4),J+4}P.prototype.writeFloatLE=function(G,J,be){return qt(this,G,J,!0,be)},P.prototype.writeFloatBE=function(G,J,be){return qt(this,G,J,!1,be)};function Lt(Y,G,J,be,Pe){return G=+G,J=J>>>0,Pe||jt(Y,G,J,8),C.write(Y,G,J,be,52,8),J+8}P.prototype.writeDoubleLE=function(G,J,be){return Lt(this,G,J,!0,be)},P.prototype.writeDoubleBE=function(G,J,be){return Lt(this,G,J,!1,be)},P.prototype.copy=function(G,J,be,Pe){if(!P.isBuffer(G))throw new TypeError("argument should be a Buffer");if(be||(be=0),!Pe&&Pe!==0&&(Pe=this.length),J>=G.length&&(J=G.length),J||(J=0),Pe>0&&Pe<be&&(Pe=be),Pe===be||G.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(be<0||be>=this.length)throw new RangeError("Index out of range");if(Pe<0)throw new RangeError("sourceEnd out of bounds");Pe>this.length&&(Pe=this.length),G.length-J<Pe-be&&(Pe=G.length-J+be);const Ge=Pe-be;return this===G&&typeof R.prototype.copyWithin=="function"?this.copyWithin(J,be,Pe):R.prototype.set.call(G,this.subarray(be,Pe),J),Ge},P.prototype.fill=function(G,J,be,Pe){if(typeof G=="string"){if(typeof J=="string"?(Pe=J,J=0,be=this.length):typeof be=="string"&&(Pe=be,be=this.length),Pe!==void 0&&typeof Pe!="string")throw new TypeError("encoding must be a string");if(typeof Pe=="string"&&!P.isEncoding(Pe))throw new TypeError("Unknown encoding: "+Pe);if(G.length===1){const _t=G.charCodeAt(0);(Pe==="utf8"&&_t<128||Pe==="latin1")&&(G=_t)}}else typeof G=="number"?G=G&255:typeof G=="boolean"&&(G=Number(G));if(J<0||this.length<J||this.length<be)throw new RangeError("Out of range index");if(be<=J)return this;J=J>>>0,be=be===void 0?this.length:be>>>0,G||(G=0);let Ge;if(typeof G=="number")for(Ge=J;Ge<be;++Ge)this[Ge]=G;else{const _t=P.isBuffer(G)?G:P.from(G,Pe),tn=_t.length;if(tn===0)throw new TypeError('The value "'+G+'" is invalid for argument "value"');for(Ge=0;Ge<be-J;++Ge)this[Ge+J]=_t[Ge%tn]}return this};const en={};function xe(Y,G,J){en[Y]=class extends J{constructor(){super(),Object.defineProperty(this,"message",{value:G.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Y}]`,this.stack,delete this.name}get code(){return Y}set code(Pe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Pe,writable:!0})}toString(){return`${this.name} [${Y}]: ${this.message}`}}}xe("ERR_BUFFER_OUT_OF_BOUNDS",function(Y){return Y?`${Y} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),xe("ERR_INVALID_ARG_TYPE",function(Y,G){return`The "${Y}" argument must be of type number. Received type ${typeof G}`},TypeError),xe("ERR_OUT_OF_RANGE",function(Y,G,J){let be=`The value of "${Y}" is out of range.`,Pe=J;return Number.isInteger(J)&&Math.abs(J)>2**32?Pe=D(String(J)):typeof J=="bigint"&&(Pe=String(J),(J>BigInt(2)**BigInt(32)||J<-(BigInt(2)**BigInt(32)))&&(Pe=D(Pe)),Pe+="n"),be+=` It must be ${G}. Received ${Pe}`,be},RangeError);function D(Y){let G="",J=Y.length;const be=Y[0]==="-"?1:0;for(;J>=be+4;J-=3)G=`_${Y.slice(J-3,J)}${G}`;return`${Y.slice(0,J)}${G}`}function Z(Y,G,J){Fe(G,"offset"),(Y[G]===void 0||Y[G+J]===void 0)&&we(G,Y.length-(J+1))}function ge(Y,G,J,be,Pe,Ge){if(Y>J||Y<G){const _t=typeof G=="bigint"?"n":"";let tn;throw G===0||G===BigInt(0)?tn=`>= 0${_t} and < 2${_t} ** ${(Ge+1)*8}${_t}`:tn=`>= -(2${_t} ** ${(Ge+1)*8-1}${_t}) and < 2 ** ${(Ge+1)*8-1}${_t}`,new en.ERR_OUT_OF_RANGE("value",tn,Y)}Z(be,Pe,Ge)}function Fe(Y,G){if(typeof Y!="number")throw new en.ERR_INVALID_ARG_TYPE(G,"number",Y)}function we(Y,G,J){throw Math.floor(Y)!==Y?(Fe(Y,J),new en.ERR_OUT_OF_RANGE("offset","an integer",Y)):G<0?new en.ERR_BUFFER_OUT_OF_BOUNDS:new en.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${G}`,Y)}const Me=/[^+/0-9A-Za-z-_]/g;function de(Y){if(Y=Y.split("=")[0],Y=Y.trim().replace(Me,""),Y.length<2)return"";for(;Y.length%4!==0;)Y=Y+"=";return Y}function vt(Y,G){G=G||1/0;let J;const be=Y.length;let Pe=null;const Ge=[];for(let _t=0;_t<be;++_t){if(J=Y.charCodeAt(_t),J>55295&&J<57344){if(!Pe){if(J>56319){(G-=3)>-1&&Ge.push(239,191,189);continue}else if(_t+1===be){(G-=3)>-1&&Ge.push(239,191,189);continue}Pe=J;continue}if(J<56320){(G-=3)>-1&&Ge.push(239,191,189),Pe=J;continue}J=(Pe-55296<<10|J-56320)+65536}else Pe&&(G-=3)>-1&&Ge.push(239,191,189);if(Pe=null,J<128){if((G-=1)<0)break;Ge.push(J)}else if(J<2048){if((G-=2)<0)break;Ge.push(J>>6|192,J&63|128)}else if(J<65536){if((G-=3)<0)break;Ge.push(J>>12|224,J>>6&63|128,J&63|128)}else if(J<1114112){if((G-=4)<0)break;Ge.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw new Error("Invalid code point")}return Ge}function ot(Y){const G=[];for(let J=0;J<Y.length;++J)G.push(Y.charCodeAt(J)&255);return G}function B(Y,G){let J,be,Pe;const Ge=[];for(let _t=0;_t<Y.length&&!((G-=2)<0);++_t)J=Y.charCodeAt(_t),be=J>>8,Pe=J%256,Ge.push(Pe),Ge.push(be);return Ge}function ze(Y){return S.toByteArray(de(Y))}function st(Y,G,J,be){let Pe;for(Pe=0;Pe<be&&!(Pe+J>=G.length||Pe>=Y.length);++Pe)G[Pe+J]=Y[Pe];return Pe}function ye(Y,G){return Y instanceof G||Y!=null&&Y.constructor!=null&&Y.constructor.name!=null&&Y.constructor.name===G.name}function _e(Y){return Y!==Y}const Ue=function(){const Y="0123456789abcdef",G=new Array(256);for(let J=0;J<16;++J){const be=J*16;for(let Pe=0;Pe<16;++Pe)G[be+Pe]=Y[J]+Y[Pe]}return G}();function kt(Y){return typeof BigInt>"u"?fe:Y}function fe(){throw new Error("BigInt not supported")}})(t);const x=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=x,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(eM)),eM}var tM,H$;function Qs(){if(H$)return tM;H$=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let s=0;s<n.length;s++)r+=`    ${n[s].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return tM={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},tM}var nM={exports:{}},rM,G$;function HK(){return G$||(G$=1,rM={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const s=t.shift();return r==="f"?s.toFixed(6):r==="j"?JSON.stringify(s):r==="s"&&typeof s=="object"?`${s.constructor!==Object?s.constructor.name:""} {}`.trim():s.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),rM}var sM,K$;function lo(){if(K$)return sM;K$=1;const{format:e,inspect:t}=HK(),{AggregateError:n}=Qs(),r=globalThis.AggregateError||n,s=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function c(v,x){if(!v)throw new l.ERR_INTERNAL_ASSERTION(x)}function u(v){let x="",w=v.length;const S=v[0]==="-"?1:0;for(;w>=S+4;w-=3)x=`_${v.slice(w-3,w)}${x}`;return`${v.slice(0,w)}${x}`}function d(v,x,w){if(typeof x=="function")return c(x.length<=w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${x.length}).`),x(...w);const S=(x.match(/%[dfijoOs]/g)||[]).length;return c(S===w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${S}).`),w.length===0?x:e(x,...w)}function h(v,x,w){w||(w=Error);class S extends w{constructor(...k){super(d(v,x,k))}toString(){return`${this.name} [${v}]: ${this.message}`}}Object.defineProperties(S.prototype,{name:{value:w.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${v}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),S.prototype.code=v,S.prototype[s]=!0,l[v]=S}function m(v){const x=o+v.name;return Object.defineProperty(v,"name",{value:x}),v}function y(v,x){if(v&&x&&v!==x){if(Array.isArray(x.errors))return x.errors.push(v),x;const w=new r([x,v],x.message);return w.code=x.code,w}return v||x}class b extends Error{constructor(x="The operation was aborted",w=void 0){if(w!==void 0&&typeof w!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",w);super(x,w),this.code="ABORT_ERR",this.name="AbortError"}}return h("ERR_ASSERTION","%s",Error),h("ERR_INVALID_ARG_TYPE",(v,x,w)=>{c(typeof v=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let S="The ";v.endsWith(" argument")?S+=`${v} `:S+=`"${v}" ${v.includes(".")?"property":"argument"} `,S+="must be ";const C=[],k=[],A=[];for(const N of x)c(typeof N=="string","All expected entries have to be of type string"),i.includes(N)?C.push(N.toLowerCase()):a.test(N)?k.push(N):(c(N!=="object",'The value "object" should be written as "Object"'),A.push(N));if(k.length>0){const N=C.indexOf("object");N!==-1&&(C.splice(C,N,1),k.push("Object"))}if(C.length>0){switch(C.length){case 1:S+=`of type ${C[0]}`;break;case 2:S+=`one of type ${C[0]} or ${C[1]}`;break;default:{const N=C.pop();S+=`one of type ${C.join(", ")}, or ${N}`}}(k.length>0||A.length>0)&&(S+=" or ")}if(k.length>0){switch(k.length){case 1:S+=`an instance of ${k[0]}`;break;case 2:S+=`an instance of ${k[0]} or ${k[1]}`;break;default:{const N=k.pop();S+=`an instance of ${k.join(", ")}, or ${N}`}}A.length>0&&(S+=" or ")}switch(A.length){case 0:break;case 1:A[0].toLowerCase()!==A[0]&&(S+="an "),S+=`${A[0]}`;break;case 2:S+=`one of ${A[0]} or ${A[1]}`;break;default:{const N=A.pop();S+=`one of ${A.join(", ")}, or ${N}`}}if(w==null)S+=`. Received ${w}`;else if(typeof w=="function"&&w.name)S+=`. Received function ${w.name}`;else if(typeof w=="object"){var R;if((R=w.constructor)!==null&&R!==void 0&&R.name)S+=`. Received an instance of ${w.constructor.name}`;else{const N=t(w,{depth:-1});S+=`. Received ${N}`}}else{let N=t(w,{colors:!1});N.length>25&&(N=`${N.slice(0,25)}...`),S+=`. Received type ${typeof w} (${N})`}return S},TypeError),h("ERR_INVALID_ARG_VALUE",(v,x,w="is invalid")=>{let S=t(x);return S.length>128&&(S=S.slice(0,128)+"..."),`The ${v.includes(".")?"property":"argument"} '${v}' ${w}. Received ${S}`},TypeError),h("ERR_INVALID_RETURN_VALUE",(v,x,w)=>{var S;const C=w!=null&&(S=w.constructor)!==null&&S!==void 0&&S.name?`instance of ${w.constructor.name}`:`type ${typeof w}`;return`Expected ${v} to be returned from the "${x}" function but got ${C}.`},TypeError),h("ERR_MISSING_ARGS",(...v)=>{c(v.length>0,"At least one arg needs to be specified");let x;const w=v.length;switch(v=(Array.isArray(v)?v:[v]).map(S=>`"${S}"`).join(" or "),w){case 1:x+=`The ${v[0]} argument`;break;case 2:x+=`The ${v[0]} and ${v[1]} arguments`;break;default:{const S=v.pop();x+=`The ${v.join(", ")}, and ${S} arguments`}break}return`${x} must be specified`},TypeError),h("ERR_OUT_OF_RANGE",(v,x,w)=>{c(x,'Missing "range" argument');let S;if(Number.isInteger(w)&&Math.abs(w)>2**32)S=u(String(w));else if(typeof w=="bigint"){S=String(w);const C=BigInt(2)**BigInt(32);(w>C||w<-C)&&(S=u(S)),S+="n"}else S=t(w);return`The value of "${v}" is out of range. It must be ${x}. Received ${S}`},RangeError),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),h("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),h("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),h("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),h("ERR_STREAM_WRITE_AFTER_END","write after end",Error),h("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),sM={AbortError:b,aggregateTwoErrors:m(y),hideStackFrames:m,codes:l},sM}var kv={exports:{}},Y$;function tw(){if(Y$)return kv.exports;Y$=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return kv.exports=e,kv.exports.AbortSignal=t,kv.exports.default=e,kv.exports}var AS={exports:{}},Z$;function LE(){if(Z$)return AS.exports;Z$=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(k,A,R){return Function.prototype.apply.call(k,A,R)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:n=function(k){return Object.getOwnPropertyNames(k)};function r(C){console&&console.warn&&console.warn(C)}var s=Number.isNaN||function(k){return k!==k};function i(){i.init.call(this)}AS.exports=i,AS.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(C){if(typeof C!="number"||C<0||s(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");a=C}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function l(C){return C._maxListeners===void 0?i.defaultMaxListeners:C._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(k){for(var A=[],R=1;R<arguments.length;R++)A.push(arguments[R]);var N=k==="error",I=this._events;if(I!==void 0)N=N&&I.error===void 0;else if(!N)return!1;if(N){var O;if(A.length>0&&(O=A[0]),O instanceof Error)throw O;var L=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw L.context=O,L}var P=I[k];if(P===void 0)return!1;if(typeof P=="function")t(P,this,A);else for(var V=P.length,F=y(P,V),R=0;R<V;++R)t(F[R],this,A);return!0};function c(C,k,A,R){var N,I,O;if(o(A),I=C._events,I===void 0?(I=C._events=Object.create(null),C._eventsCount=0):(I.newListener!==void 0&&(C.emit("newListener",k,A.listener?A.listener:A),I=C._events),O=I[k]),O===void 0)O=I[k]=A,++C._eventsCount;else if(typeof O=="function"?O=I[k]=R?[A,O]:[O,A]:R?O.unshift(A):O.push(A),N=l(C),N>0&&O.length>N&&!O.warned){O.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=C,L.type=k,L.count=O.length,r(L)}return C}i.prototype.addListener=function(k,A){return c(this,k,A,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(k,A){return c(this,k,A,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(C,k,A){var R={fired:!1,wrapFn:void 0,target:C,type:k,listener:A},N=u.bind(R);return N.listener=A,R.wrapFn=N,N}i.prototype.once=function(k,A){return o(A),this.on(k,d(this,k,A)),this},i.prototype.prependOnceListener=function(k,A){return o(A),this.prependListener(k,d(this,k,A)),this},i.prototype.removeListener=function(k,A){var R,N,I,O,L;if(o(A),N=this._events,N===void 0)return this;if(R=N[k],R===void 0)return this;if(R===A||R.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete N[k],N.removeListener&&this.emit("removeListener",k,R.listener||A));else if(typeof R!="function"){for(I=-1,O=R.length-1;O>=0;O--)if(R[O]===A||R[O].listener===A){L=R[O].listener,I=O;break}if(I<0)return this;I===0?R.shift():b(R,I),R.length===1&&(N[k]=R[0]),N.removeListener!==void 0&&this.emit("removeListener",k,L||A)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(k){var A,R,N;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[k]),this;if(arguments.length===0){var I=Object.keys(R),O;for(N=0;N<I.length;++N)O=I[N],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=R[k],typeof A=="function")this.removeListener(k,A);else if(A!==void 0)for(N=A.length-1;N>=0;N--)this.removeListener(k,A[N]);return this};function h(C,k,A){var R=C._events;if(R===void 0)return[];var N=R[k];return N===void 0?[]:typeof N=="function"?A?[N.listener||N]:[N]:A?v(N):y(N,N.length)}i.prototype.listeners=function(k){return h(this,k,!0)},i.prototype.rawListeners=function(k){return h(this,k,!1)},i.listenerCount=function(C,k){return typeof C.listenerCount=="function"?C.listenerCount(k):m.call(C,k)},i.prototype.listenerCount=m;function m(C){var k=this._events;if(k!==void 0){var A=k[C];if(typeof A=="function")return 1;if(A!==void 0)return A.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function y(C,k){for(var A=new Array(k),R=0;R<k;++R)A[R]=C[R];return A}function b(C,k){for(;k+1<C.length;k++)C[k]=C[k+1];C.pop()}function v(C){for(var k=new Array(C.length),A=0;A<k.length;++A)k[A]=C[A].listener||C[A];return k}function x(C,k){return new Promise(function(A,R){function N(O){C.removeListener(k,I),R(O)}function I(){typeof C.removeListener=="function"&&C.removeListener("error",N),A([].slice.call(arguments))}S(C,k,I,{once:!0}),k!=="error"&&w(C,N,{once:!0})})}function w(C,k,A){typeof C.on=="function"&&S(C,"error",k,A)}function S(C,k,A,R){if(typeof C.on=="function")R.once?C.once(k,A):C.on(k,A);else if(typeof C.addEventListener=="function")C.addEventListener(k,function N(I){R.once&&C.removeEventListener(k,N),A(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return AS.exports}var X$;function To(){return X$||(X$=1,function(e){const t=Uh(),{format:n,inspect:r}=HK(),{codes:{ERR_INVALID_ARG_TYPE:s}}=lo(),{kResistStopPropagation:i,AggregateError:a,SymbolDispose:o}=Qs(),l=globalThis.AbortSignal||tw().AbortSignal,c=globalThis.AbortController||tw().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,d=globalThis.Blob||t.Blob,h=typeof d<"u"?function(v){return v instanceof d}:function(v){return!1},m=(b,v)=>{if(b!==void 0&&(b===null||typeof b!="object"||!("aborted"in b)))throw new s(v,"AbortSignal",b)},y=(b,v)=>{if(typeof b!="function")throw new s(v,"Function",b)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(b){let v=!1;return function(...x){v||(v=!0,b.apply(this,x))}},createDeferredPromise:function(){let b,v;return{promise:new Promise((w,S)=>{b=w,v=S}),resolve:b,reject:v}},promisify(b){return new Promise((v,x)=>{b((w,...S)=>w?x(w):v(...S))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(b){return b instanceof u},isArrayBufferView(b){return ArrayBuffer.isView(b)}},isBlob:h,deprecate(b,v){return b},addAbortListener:LE().addAbortListener||function(v,x){if(v===void 0)throw new s("signal","AbortSignal",v);m(v,"signal"),y(x,"listener");let w;return v.aborted?queueMicrotask(()=>x()):(v.addEventListener("abort",x,{__proto__:null,once:!0,[i]:!0}),w=()=>{v.removeEventListener("abort",x)}),{__proto__:null,[o](){var S;(S=w)===null||S===void 0||S()}}},AbortSignalAny:l.any||function(v){if(v.length===1)return v[0];const x=new c,w=()=>x.abort();return v.forEach(S=>{m(S,"signals"),S.addEventListener("abort",w,{once:!0})}),x.signal.addEventListener("abort",()=>{v.forEach(S=>S.removeEventListener("abort",w))},{once:!0}),x.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(nM)),nM.exports}var RS={},iM,J$;function m1(){if(J$)return iM;J$=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:s,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:d,StringPrototypeToUpperCase:h,StringPrototypeTrim:m}=Qs(),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:v,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:S}}=lo(),{normalizeEncoding:C}=To(),{isAsyncFunction:k,isArrayBufferView:A}=To().types,R={};function N(re){return re===(re|0)}function I(re){return re===re>>>0}const O=/^[0-7]+$/,L="must be a 32-bit unsigned integer or an octal string";function P(re,Te,Be){if(typeof re>"u"&&(re=Be),typeof re=="string"){if(u(O,re)===null)throw new x(Te,re,L);re=l(re,8)}return X(re,Te),re}const V=y((re,Te,Be=o,ke=a)=>{if(typeof re!="number")throw new v(Te,"number",re);if(!s(re))throw new w(Te,"an integer",re);if(re<Be||re>ke)throw new w(Te,`>= ${Be} && <= ${ke}`,re)}),F=y((re,Te,Be=-2147483648,ke=2147483647)=>{if(typeof re!="number")throw new v(Te,"number",re);if(!s(re))throw new w(Te,"an integer",re);if(re<Be||re>ke)throw new w(Te,`>= ${Be} && <= ${ke}`,re)}),X=y((re,Te,Be=!1)=>{if(typeof re!="number")throw new v(Te,"number",re);if(!s(re))throw new w(Te,"an integer",re);const ke=Be?1:0,lt=4294967295;if(re<ke||re>lt)throw new w(Te,`>= ${ke} && <= ${lt}`,re)});function U(re,Te){if(typeof re!="string")throw new v(Te,"string",re)}function H(re,Te,Be=void 0,ke){if(typeof re!="number")throw new v(Te,"number",re);if(Be!=null&&re<Be||ke!=null&&re>ke||(Be!=null||ke!=null)&&i(re))throw new w(Te,`${Be!=null?`>= ${Be}`:""}${Be!=null&&ke!=null?" && ":""}${ke!=null?`<= ${ke}`:""}`,re)}const $=y((re,Te,Be)=>{if(!t(Be,re)){const lt="must be one of: "+n(r(Be,Rt=>typeof Rt=="string"?`'${Rt}'`:d(Rt)),", ");throw new x(Te,re,lt)}});function ne(re,Te){if(typeof re!="boolean")throw new v(Te,"boolean",re)}function W(re,Te,Be){return re==null||!c(re,Te)?Be:re[Te]}const Q=y((re,Te,Be=null)=>{const ke=W(Be,"allowArray",!1),lt=W(Be,"allowFunction",!1);if(!W(Be,"nullable",!1)&&re===null||!ke&&e(re)||typeof re!="object"&&(!lt||typeof re!="function"))throw new v(Te,"Object",re)}),ee=y((re,Te)=>{if(re!=null&&typeof re!="object"&&typeof re!="function")throw new v(Te,"a dictionary",re)}),se=y((re,Te,Be=0)=>{if(!e(re))throw new v(Te,"Array",re);if(re.length<Be){const ke=`must be longer than ${Be}`;throw new x(Te,re,ke)}});function pe(re,Te){se(re,Te);for(let Be=0;Be<re.length;Be++)U(re[Be],`${Te}[${Be}]`)}function ce(re,Te){se(re,Te);for(let Be=0;Be<re.length;Be++)ne(re[Be],`${Te}[${Be}]`)}function Ie(re,Te){se(re,Te);for(let Be=0;Be<re.length;Be++){const ke=re[Be],lt=`${Te}[${Be}]`;if(ke==null)throw new v(lt,"AbortSignal",ke);Qe(ke,lt)}}function De(re,Te="signal"){if(U(re,Te),R[re]===void 0)throw R[h(re)]!==void 0?new S(re+" (signals must use all capital letters)"):new S(re)}const Se=y((re,Te="buffer")=>{if(!A(re))throw new v(Te,["Buffer","TypedArray","DataView"],re)});function Ce(re,Te){const Be=C(Te),ke=re.length;if(Be==="hex"&&ke%2!==0)throw new x("encoding",Te,`is invalid for data of length ${ke}`)}function qe(re,Te="Port",Be=!0){if(typeof re!="number"&&typeof re!="string"||typeof re=="string"&&m(re).length===0||+re!==+re>>>0||re>65535||re===0&&!Be)throw new b(Te,re,Be);return re|0}const Qe=y((re,Te)=>{if(re!==void 0&&(re===null||typeof re!="object"||!("aborted"in re)))throw new v(Te,"AbortSignal",re)}),Ve=y((re,Te)=>{if(typeof re!="function")throw new v(Te,"Function",re)}),Ne=y((re,Te)=>{if(typeof re!="function"||k(re))throw new v(Te,"Function",re)}),K=y((re,Te)=>{if(re!==void 0)throw new v(Te,"undefined",re)});function me(re,Te,Be){if(!t(Be,re))throw new v(Te,`('${n(Be,"|")}')`,re)}const Ae=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function le(re,Te){if(typeof re>"u"||!u(Ae,re))throw new x(Te,re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function oe(re){if(typeof re=="string")return le(re,"hints"),re;if(e(re)){const Te=re.length;let Be="";if(Te===0)return Be;for(let ke=0;ke<Te;ke++){const lt=re[ke];le(lt,"hints"),Be+=lt,ke!==Te-1&&(Be+=", ")}return Be}throw new x("hints",re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return iM={isInt32:N,isUint32:I,parseFileMode:P,validateArray:se,validateStringArray:pe,validateBooleanArray:ce,validateAbortSignalArray:Ie,validateBoolean:ne,validateBuffer:Se,validateDictionary:ee,validateEncoding:Ce,validateFunction:Ve,validateInt32:F,validateInteger:V,validateNumber:H,validateObject:Q,validateOneOf:$,validatePlainFunction:Ne,validatePort:qe,validateSignalName:De,validateString:U,validateUint32:X,validateUndefined:K,validateUnion:me,validateAbortSignal:Qe,validateLinkHeaderValue:oe},iM}var NS={exports:{}},aM={},Q$;function Fm(){return Q$||(Q$=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}var n={exports:{}},r=n.exports={},s,i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=a}catch{s=a}try{typeof clearTimeout=="function"?i=clearTimeout:i=o}catch{i=o}})();function l(C){if(s===setTimeout)return setTimeout(C,0);if((s===a||!s)&&setTimeout)return s=setTimeout,setTimeout(C,0);try{return s(C,0)}catch{try{return s.call(null,C,0)}catch{return s.call(this,C,0)}}}function c(C){if(i===clearTimeout)return clearTimeout(C);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(C);try{return i(C)}catch{try{return i.call(null,C)}catch{return i.call(this,C)}}}var u=[],d=!1,h,m=-1;function y(){!d||!h||(d=!1,h.length?u=h.concat(u):m=-1,u.length&&b())}function b(){if(!d){var C=l(y);d=!0;for(var k=u.length;k;){for(h=u,u=[];++m<k;)h&&h[m].run();m=-1,k=u.length}h=null,d=!1,c(C)}}r.nextTick=function(C){var k=new Array(arguments.length-1);if(arguments.length>1)for(var A=1;A<arguments.length;A++)k[A-1]=arguments[A];u.push(new v(C,k)),u.length===1&&!d&&l(b)};function v(C,k){this.fun=C,this.array=k}v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(C){return[]},r.binding=function(C){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(C){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var w=n.exports;const S=t(w);e.default=S,e.process=S}(aM)),aM}var oM,e9;function tf(){if(e9)return oM;e9=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=Qs(),r=n("nodejs.stream.destroyed"),s=n("nodejs.stream.errored"),i=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(W,Q=!1){var ee;return!!(W&&typeof W.pipe=="function"&&typeof W.on=="function"&&(!Q||typeof W.pause=="function"&&typeof W.resume=="function")&&(!W._writableState||((ee=W._readableState)===null||ee===void 0?void 0:ee.readable)!==!1)&&(!W._writableState||W._readableState))}function d(W){var Q;return!!(W&&typeof W.write=="function"&&typeof W.on=="function"&&(!W._readableState||((Q=W._writableState)===null||Q===void 0?void 0:Q.writable)!==!1))}function h(W){return!!(W&&typeof W.pipe=="function"&&W._readableState&&typeof W.on=="function"&&typeof W.write=="function")}function m(W){return W&&(W._readableState||W._writableState||typeof W.write=="function"&&typeof W.on=="function"||typeof W.pipe=="function"&&typeof W.on=="function")}function y(W){return!!(W&&!m(W)&&typeof W.pipeThrough=="function"&&typeof W.getReader=="function"&&typeof W.cancel=="function")}function b(W){return!!(W&&!m(W)&&typeof W.getWriter=="function"&&typeof W.abort=="function")}function v(W){return!!(W&&!m(W)&&typeof W.readable=="object"&&typeof W.writable=="object")}function x(W){return y(W)||b(W)||v(W)}function w(W,Q){return W==null?!1:Q===!0?typeof W[e]=="function":Q===!1?typeof W[t]=="function":typeof W[e]=="function"||typeof W[t]=="function"}function S(W){if(!m(W))return null;const Q=W._writableState,ee=W._readableState,se=Q||ee;return!!(W.destroyed||W[r]||se!=null&&se.destroyed)}function C(W){if(!d(W))return null;if(W.writableEnded===!0)return!0;const Q=W._writableState;return Q!=null&&Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function k(W,Q){if(!d(W))return null;if(W.writableFinished===!0)return!0;const ee=W._writableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.finished)!="boolean"?null:!!(ee.finished||Q===!1&&ee.ended===!0&&ee.length===0)}function A(W){if(!u(W))return null;if(W.readableEnded===!0)return!0;const Q=W._readableState;return!Q||Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function R(W,Q){if(!u(W))return null;const ee=W._readableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.endEmitted)!="boolean"?null:!!(ee.endEmitted||Q===!1&&ee.ended===!0&&ee.length===0)}function N(W){return W&&W[i]!=null?W[i]:typeof(W==null?void 0:W.readable)!="boolean"?null:S(W)?!1:u(W)&&W.readable&&!R(W)}function I(W){return W&&W[a]!=null?W[a]:typeof(W==null?void 0:W.writable)!="boolean"?null:S(W)?!1:d(W)&&W.writable&&!C(W)}function O(W,Q){return m(W)?S(W)?!0:!((Q==null?void 0:Q.readable)!==!1&&N(W)||(Q==null?void 0:Q.writable)!==!1&&I(W)):null}function L(W){var Q,ee;return m(W)?W.writableErrored?W.writableErrored:(Q=(ee=W._writableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function P(W){var Q,ee;return m(W)?W.readableErrored?W.readableErrored:(Q=(ee=W._readableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function V(W){if(!m(W))return null;if(typeof W.closed=="boolean")return W.closed;const Q=W._writableState,ee=W._readableState;return typeof(Q==null?void 0:Q.closed)=="boolean"||typeof(ee==null?void 0:ee.closed)=="boolean"?(Q==null?void 0:Q.closed)||(ee==null?void 0:ee.closed):typeof W._closed=="boolean"&&F(W)?W._closed:null}function F(W){return typeof W._closed=="boolean"&&typeof W._defaultKeepAlive=="boolean"&&typeof W._removedConnection=="boolean"&&typeof W._removedContLen=="boolean"}function X(W){return typeof W._sent100=="boolean"&&F(W)}function U(W){var Q;return typeof W._consuming=="boolean"&&typeof W._dumped=="boolean"&&((Q=W.req)===null||Q===void 0?void 0:Q.upgradeOrConnect)===void 0}function H(W){if(!m(W))return null;const Q=W._writableState,ee=W._readableState,se=Q||ee;return!se&&X(W)||!!(se&&se.autoDestroy&&se.emitClose&&se.closed===!1)}function $(W){var Q;return!!(W&&((Q=W[o])!==null&&Q!==void 0?Q:W.readableDidRead||W.readableAborted))}function ne(W){var Q,ee,se,pe,ce,Ie,De,Se,Ce,qe;return!!(W&&((Q=(ee=(se=(pe=(ce=(Ie=W[s])!==null&&Ie!==void 0?Ie:W.readableErrored)!==null&&ce!==void 0?ce:W.writableErrored)!==null&&pe!==void 0?pe:(De=W._readableState)===null||De===void 0?void 0:De.errorEmitted)!==null&&se!==void 0?se:(Se=W._writableState)===null||Se===void 0?void 0:Se.errorEmitted)!==null&&ee!==void 0?ee:(Ce=W._readableState)===null||Ce===void 0?void 0:Ce.errored)!==null&&Q!==void 0?Q:!((qe=W._writableState)===null||qe===void 0)&&qe.errored))}return oM={isDestroyed:S,kIsDestroyed:r,isDisturbed:$,kIsDisturbed:o,isErrored:ne,kIsErrored:s,isReadable:N,kIsReadable:i,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:V,isDuplexNodeStream:h,isFinished:O,isIterable:w,isReadableNodeStream:u,isReadableStream:y,isReadableEnded:A,isReadableFinished:R,isReadableErrored:P,isNodeStream:m,isWebStream:x,isWritable:I,isWritableNodeStream:d,isWritableStream:b,isWritableEnded:C,isWritableFinished:k,isWritableErrored:L,isServerRequest:U,isServerResponse:X,willEmitClose:H,isTransformStream:v},oM}var t9;function qh(){if(t9)return NS.exports;t9=1;const e=Fm(),{AbortError:t,codes:n}=lo(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:s}=n,{kEmptyObject:i,once:a}=To(),{validateAbortSignal:o,validateFunction:l,validateObject:c,validateBoolean:u}=m1(),{Promise:d,PromisePrototypeThen:h,SymbolDispose:m}=Qs(),{isClosed:y,isReadable:b,isReadableNodeStream:v,isReadableStream:x,isReadableFinished:w,isReadableErrored:S,isWritable:C,isWritableNodeStream:k,isWritableStream:A,isWritableFinished:R,isWritableErrored:N,isNodeStream:I,willEmitClose:O,kIsClosedPromise:L}=tf();let P;function V($){return $.setHeader&&typeof $.abort=="function"}const F=()=>{};function X($,ne,W){var Q,ee;if(arguments.length===2?(W=ne,ne=i):ne==null?ne=i:c(ne,"options"),l(W,"callback"),o(ne.signal,"options.signal"),W=a(W),x($)||A($))return U($,ne,W);if(!I($))throw new r("stream",["ReadableStream","WritableStream","Stream"],$);const se=(Q=ne.readable)!==null&&Q!==void 0?Q:v($),pe=(ee=ne.writable)!==null&&ee!==void 0?ee:k($),ce=$._writableState,Ie=$._readableState,De=()=>{$.writable||qe()};let Se=O($)&&v($)===se&&k($)===pe,Ce=R($,!1);const qe=()=>{Ce=!0,$.destroyed&&(Se=!1),!(Se&&(!$.readable||se))&&(!se||Qe)&&W.call($)};let Qe=w($,!1);const Ve=()=>{Qe=!0,$.destroyed&&(Se=!1),!(Se&&(!$.writable||pe))&&(!pe||Ce)&&W.call($)},Ne=re=>{W.call($,re)};let K=y($);const me=()=>{K=!0;const re=N($)||S($);if(re&&typeof re!="boolean")return W.call($,re);if(se&&!Qe&&v($,!0)&&!w($,!1))return W.call($,new s);if(pe&&!Ce&&!R($,!1))return W.call($,new s);W.call($)},Ae=()=>{K=!0;const re=N($)||S($);if(re&&typeof re!="boolean")return W.call($,re);W.call($)},le=()=>{$.req.on("finish",qe)};V($)?($.on("complete",qe),Se||$.on("abort",me),$.req?le():$.on("request",le)):pe&&!ce&&($.on("end",De),$.on("close",De)),!Se&&typeof $.aborted=="boolean"&&$.on("aborted",me),$.on("end",Ve),$.on("finish",qe),ne.error!==!1&&$.on("error",Ne),$.on("close",me),K?e.nextTick(me):ce!=null&&ce.errorEmitted||Ie!=null&&Ie.errorEmitted?Se||e.nextTick(Ae):(!se&&(!Se||b($))&&(Ce||C($)===!1)||!pe&&(!Se||C($))&&(Qe||b($)===!1)||Ie&&$.req&&$.aborted)&&e.nextTick(Ae);const oe=()=>{W=F,$.removeListener("aborted",me),$.removeListener("complete",qe),$.removeListener("abort",me),$.removeListener("request",le),$.req&&$.req.removeListener("finish",qe),$.removeListener("end",De),$.removeListener("close",De),$.removeListener("finish",qe),$.removeListener("end",Ve),$.removeListener("error",Ne),$.removeListener("close",me)};if(ne.signal&&!K){const re=()=>{const Te=W;oe(),Te.call($,new t(void 0,{cause:ne.signal.reason}))};if(ne.signal.aborted)e.nextTick(re);else{P=P||To().addAbortListener;const Te=P(ne.signal,re),Be=W;W=a((...ke)=>{Te[m](),Be.apply($,ke)})}}return oe}function U($,ne,W){let Q=!1,ee=F;if(ne.signal)if(ee=()=>{Q=!0,W.call($,new t(void 0,{cause:ne.signal.reason}))},ne.signal.aborted)e.nextTick(ee);else{P=P||To().addAbortListener;const pe=P(ne.signal,ee),ce=W;W=a((...Ie)=>{pe[m](),ce.apply($,Ie)})}const se=(...pe)=>{Q||e.nextTick(()=>W.apply($,pe))};return h($[L].promise,se,se),F}function H($,ne){var W;let Q=!1;return ne===null&&(ne=i),(W=ne)!==null&&W!==void 0&&W.cleanup&&(u(ne.cleanup,"cleanup"),Q=ne.cleanup),new d((ee,se)=>{const pe=X($,ne,ce=>{Q&&pe(),ce?se(ce):ee()})})}return NS.exports=X,NS.exports.finished=H,NS.exports}var lM,n9;function By(){if(n9)return lM;n9=1;const e=Fm(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=lo(),{Symbol:s}=Qs(),{kIsDestroyed:i,isDestroyed:a,isFinished:o,isServerRequest:l}=tf(),c=s("kDestroy"),u=s("kConstruct");function d(O,L,P){O&&(O.stack,L&&!L.errored&&(L.errored=O),P&&!P.errored&&(P.errored=O))}function h(O,L){const P=this._readableState,V=this._writableState,F=V||P;return V!=null&&V.destroyed||P!=null&&P.destroyed?(typeof L=="function"&&L(),this):(d(O,V,P),V&&(V.destroyed=!0),P&&(P.destroyed=!0),F.constructed?m(this,O,L):this.once(c,function(X){m(this,t(X,O),L)}),this)}function m(O,L,P){let V=!1;function F(X){if(V)return;V=!0;const U=O._readableState,H=O._writableState;d(X,H,U),H&&(H.closed=!0),U&&(U.closed=!0),typeof P=="function"&&P(X),X?e.nextTick(y,O,X):e.nextTick(b,O)}try{O._destroy(L||null,F)}catch(X){F(X)}}function y(O,L){v(O,L),b(O)}function b(O){const L=O._readableState,P=O._writableState;P&&(P.closeEmitted=!0),L&&(L.closeEmitted=!0),(P!=null&&P.emitClose||L!=null&&L.emitClose)&&O.emit("close")}function v(O,L){const P=O._readableState,V=O._writableState;V!=null&&V.errorEmitted||P!=null&&P.errorEmitted||(V&&(V.errorEmitted=!0),P&&(P.errorEmitted=!0),O.emit("error",L))}function x(){const O=this._readableState,L=this._writableState;O&&(O.constructed=!0,O.closed=!1,O.closeEmitted=!1,O.destroyed=!1,O.errored=null,O.errorEmitted=!1,O.reading=!1,O.ended=O.readable===!1,O.endEmitted=O.readable===!1),L&&(L.constructed=!0,L.destroyed=!1,L.closed=!1,L.closeEmitted=!1,L.errored=null,L.errorEmitted=!1,L.finalCalled=!1,L.prefinished=!1,L.ended=L.writable===!1,L.ending=L.writable===!1,L.finished=L.writable===!1)}function w(O,L,P){const V=O._readableState,F=O._writableState;if(F!=null&&F.destroyed||V!=null&&V.destroyed)return this;V!=null&&V.autoDestroy||F!=null&&F.autoDestroy?O.destroy(L):L&&(L.stack,F&&!F.errored&&(F.errored=L),V&&!V.errored&&(V.errored=L),P?e.nextTick(v,O,L):v(O,L))}function S(O,L){if(typeof O._construct!="function")return;const P=O._readableState,V=O._writableState;P&&(P.constructed=!1),V&&(V.constructed=!1),O.once(u,L),!(O.listenerCount(u)>1)&&e.nextTick(C,O)}function C(O){let L=!1;function P(V){if(L){w(O,V??new n);return}L=!0;const F=O._readableState,X=O._writableState,U=X||F;F&&(F.constructed=!0),X&&(X.constructed=!0),U.destroyed?O.emit(c,V):V?w(O,V,!0):e.nextTick(k,O)}try{O._construct(V=>{e.nextTick(P,V)})}catch(V){e.nextTick(P,V)}}function k(O){O.emit(u)}function A(O){return(O==null?void 0:O.setHeader)&&typeof O.abort=="function"}function R(O){O.emit("close")}function N(O,L){O.emit("error",L),e.nextTick(R,O)}function I(O,L){!O||a(O)||(!L&&!o(O)&&(L=new r),l(O)?(O.socket=null,O.destroy(L)):A(O)?O.abort():A(O.req)?O.req.abort():typeof O.destroy=="function"?O.destroy(L):typeof O.close=="function"?O.close():L?e.nextTick(N,O,L):e.nextTick(R,O),O.destroyed||(O[i]=!0))}return lM={construct:S,destroyer:I,destroy:h,undestroy:x,errorOrDestroy:w},lM}var cM,r9;function BP(){if(r9)return cM;r9=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=Qs(),{EventEmitter:n}=LE();function r(i){n.call(this,i)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(i,a){const o=this;function l(b){i.writable&&i.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function c(){o.readable&&o.resume&&o.resume()}i.on("drain",c),!i._isStdio&&(!a||a.end!==!1)&&(o.on("end",d),o.on("close",h));let u=!1;function d(){u||(u=!0,i.end())}function h(){u||(u=!0,typeof i.destroy=="function"&&i.destroy())}function m(b){y(),n.listenerCount(this,"error")===0&&this.emit("error",b)}s(o,"error",m),s(i,"error",m);function y(){o.removeListener("data",l),i.removeListener("drain",c),o.removeListener("end",d),o.removeListener("close",h),o.removeListener("error",m),i.removeListener("error",m),o.removeListener("end",y),o.removeListener("close",y),i.removeListener("close",y)}return o.on("end",y),o.on("close",y),i.on("close",y),i.emit("pipe",o),i};function s(i,a,o){if(typeof i.prependListener=="function")return i.prependListener(a,o);!i._events||!i._events[a]?i.on(a,o):e(i._events[a])?i._events[a].unshift(o):i._events[a]=[o,i._events[a]]}return cM={Stream:r,prependListener:s},cM}var uM={exports:{}},s9;function BE(){return s9||(s9=1,function(e){const{SymbolDispose:t}=Qs(),{AbortError:n,codes:r}=lo(),{isNodeStream:s,isWebStream:i,kControllerErrorFunction:a}=tf(),o=qh(),{ERR_INVALID_ARG_TYPE:l}=r;let c;const u=(d,h)=>{if(typeof d!="object"||!("aborted"in d))throw new l(h,"AbortSignal",d)};e.exports.addAbortSignal=function(h,m){if(u(h,"signal"),!s(m)&&!i(m))throw new l("stream",["ReadableStream","WritableStream","Stream"],m);return e.exports.addAbortSignalNoValidate(h,m)},e.exports.addAbortSignalNoValidate=function(d,h){if(typeof d!="object"||!("aborted"in d))return h;const m=s(h)?()=>{h.destroy(new n(void 0,{cause:d.reason}))}:()=>{h[a](new n(void 0,{cause:d.reason}))};if(d.aborted)m();else{c=c||To().addAbortListener;const y=c(d,m);o(h,y[t])}return h}}(uM)),uM.exports}var dM,i9;function $_e(){if(i9)return dM;i9=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=Qs(),{Buffer:s}=Uh(),{inspect:i}=To();return dM=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,c=""+l.data;for(;(l=l.next)!==null;)c+=o+l.data;return c}concat(o){if(this.length===0)return s.alloc(0);const l=s.allocUnsafe(o>>>0);let c=this.head,u=0;for(;c;)n(l,c.data,u),u+=c.data.length,c=c.next;return l}consume(o,l){const c=this.head.data;if(o<c.length){const u=c.slice(0,o);return this.head.data=c.slice(o),u}return o===c.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",c=this.head,u=0;do{const d=c.data;if(o>d.length)l+=d,o-=d.length;else{o===d.length?(l+=d,++u,c.next?this.head=c.next:this.head=this.tail=null):(l+=e(d,0,o),this.head=c,c.data=e(d,o));break}++u}while((c=c.next)!==null);return this.length-=u,l}_getBuffer(o){const l=s.allocUnsafe(o),c=o;let u=this.head,d=0;do{const h=u.data;if(o>h.length)n(l,h,c-o),o-=h.length;else{o===h.length?(n(l,h,c-o),++d,u.next?this.head=u.next:this.head=this.tail=null):(n(l,new r(h.buffer,h.byteOffset,o),c-o),this.head=u,u.data=h.slice(o));break}++d}while((u=u.next)!==null);return this.length-=d,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return i(this,{...l,depth:0,customInspect:!1})}},dM}var fM,a9;function $E(){if(a9)return fM;a9=1;const{MathFloor:e,NumberIsInteger:t}=Qs(),{validateInteger:n}=m1(),{ERR_INVALID_ARG_VALUE:r}=lo().codes;let s=16*1024,i=16;function a(u,d,h){return u.highWaterMark!=null?u.highWaterMark:d?u[h]:null}function o(u){return u?i:s}function l(u,d){n(d,"value",0),u?i=d:s=d}function c(u,d,h,m){const y=a(d,m,h);if(y!=null){if(!t(y)||y<0){const b=m?`options.${h}`:"options.highWaterMark";throw new r(b,y)}return e(y)}return o(u.objectMode)}return fM={getHighWaterMark:c,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},fM}var hM={},MS={exports:{}},o9;function $P(){return o9||(o9=1,function(e,t){var n=Uh(),r=n.Buffer;function s(a,o){for(var l in a)o[l]=a[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=i);function i(a,o,l){return r(a,o,l)}s(r,i),i.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,l)},i.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=r(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}}(MS,MS.exports)),MS.exports}var l9;function z_e(){if(l9)return hM;l9=1;var e=$P().Buffer,t=e.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(x){if(!x)return"utf8";for(var w;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(w)return;x=(""+x).toLowerCase(),w=!0}}function r(x){var w=n(x);if(typeof w!="string"&&(e.isEncoding===t||!t(x)))throw new Error("Unknown encoding: "+x);return w||x}hM.StringDecoder=s;function s(x){this.encoding=r(x);var w;switch(this.encoding){case"utf16le":this.text=d,this.end=h,w=4;break;case"utf8":this.fillLast=l,w=4;break;case"base64":this.text=m,this.end=y,w=3;break;default:this.write=b,this.end=v;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(w)}s.prototype.write=function(x){if(x.length===0)return"";var w,S;if(this.lastNeed){if(w=this.fillLast(x),w===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<x.length?w?w+this.text(x,S):this.text(x,S):w||""},s.prototype.end=u,s.prototype.text=c,s.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length};function i(x){return x<=127?0:x>>5===6?2:x>>4===14?3:x>>3===30?4:x>>6===2?-1:-2}function a(x,w,S){var C=w.length-1;if(C<S)return 0;var k=i(w[C]);return k>=0?(k>0&&(x.lastNeed=k-1),k):--C<S||k===-2?0:(k=i(w[C]),k>=0?(k>0&&(x.lastNeed=k-2),k):--C<S||k===-2?0:(k=i(w[C]),k>=0?(k>0&&(k===2?k=0:x.lastNeed=k-3),k):0))}function o(x,w,S){if((w[0]&192)!==128)return x.lastNeed=0,"";if(x.lastNeed>1&&w.length>1){if((w[1]&192)!==128)return x.lastNeed=1,"";if(x.lastNeed>2&&w.length>2&&(w[2]&192)!==128)return x.lastNeed=2,""}}function l(x){var w=this.lastTotal-this.lastNeed,S=o(this,x);if(S!==void 0)return S;if(this.lastNeed<=x.length)return x.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,w,0,x.length),this.lastNeed-=x.length}function c(x,w){var S=a(this,x,w);if(!this.lastNeed)return x.toString("utf8",w);this.lastTotal=S;var C=x.length-(S-this.lastNeed);return x.copy(this.lastChar,0,C),x.toString("utf8",w,C)}function u(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+"":w}function d(x,w){if((x.length-w)%2===0){var S=x.toString("utf16le",w);if(S){var C=S.charCodeAt(S.length-1);if(C>=55296&&C<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",w,x.length-1)}function h(x){var w=x&&x.length?this.write(x):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,S)}return w}function m(x,w){var S=(x.length-w)%3;return S===0?x.toString("base64",w):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",w,x.length-S))}function y(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function b(x){return x.toString(this.encoding)}function v(x){return x&&x.length?this.write(x):""}return hM}var pM,c9;function GK(){if(c9)return pM;c9=1;const e=Fm(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=Qs(),{Buffer:s}=Uh(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:a}=lo().codes;function o(l,c,u){let d;if(typeof c=="string"||c instanceof s)return new l({objectMode:!0,...u,read(){this.push(c),this.push(null)}});let h;if(c&&c[n])h=!0,d=c[n]();else if(c&&c[r])h=!1,d=c[r]();else throw new i("iterable",["Iterable"],c);const m=new l({objectMode:!0,highWaterMark:1,...u});let y=!1;m._read=function(){y||(y=!0,v())},m._destroy=function(x,w){t(b(x),()=>e.nextTick(w,x),S=>e.nextTick(w,S||x))};async function b(x){const w=x!=null,S=typeof d.throw=="function";if(w&&S){const{value:C,done:k}=await d.throw(x);if(await C,k)return}if(typeof d.return=="function"){const{value:C}=await d.return();await C}}async function v(){for(;;){try{const{value:x,done:w}=h?await d.next():d.next();if(w)m.push(null);else{const S=x&&typeof x.then=="function"?await x:x;if(S===null)throw y=!1,new a;if(m.push(S))continue;y=!1}}catch(x){m.destroy(x)}break}}return m}return pM=o,pM}var mM,u9;function zE(){if(u9)return mM;u9=1;const e=Fm(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:a,ObjectSetPrototypeOf:o,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:d,Symbol:h}=Qs();mM=ke,ke.ReadableState=Be;const{EventEmitter:m}=LE(),{Stream:y,prependListener:b}=BP(),{Buffer:v}=Uh(),{addAbortSignal:x}=BE(),w=qh();let S=To().debuglog("stream",fe=>{S=fe});const C=$_e(),k=By(),{getHighWaterMark:A,getDefaultHighWaterMark:R}=$E(),{aggregateTwoErrors:N,codes:{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:O,ERR_OUT_OF_RANGE:L,ERR_STREAM_PUSH_AFTER_EOF:P,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:V},AbortError:F}=lo(),{validateObject:X}=m1(),U=h("kPaused"),{StringDecoder:H}=z_e(),$=GK();o(ke.prototype,y.prototype),o(ke,y);const ne=()=>{},{errorOrDestroy:W}=k,Q=1,ee=2,se=4,pe=8,ce=16,Ie=32,De=64,Se=128,Ce=256,qe=512,Qe=1024,Ve=2048,Ne=4096,K=8192,me=16384,Ae=32768,le=65536,oe=1<<17,re=1<<18;function Te(fe){return{enumerable:!1,get(){return(this.state&fe)!==0},set(Y){Y?this.state|=fe:this.state&=~fe}}}i(Be.prototype,{objectMode:Te(Q),ended:Te(ee),endEmitted:Te(se),reading:Te(pe),constructed:Te(ce),sync:Te(Ie),needReadable:Te(De),emittedReadable:Te(Se),readableListening:Te(Ce),resumeScheduled:Te(qe),errorEmitted:Te(Qe),emitClose:Te(Ve),autoDestroy:Te(Ne),destroyed:Te(K),closed:Te(me),closeEmitted:Te(Ae),multiAwaitDrain:Te(le),readingMore:Te(oe),dataEmitted:Te(re)});function Be(fe,Y,G){typeof G!="boolean"&&(G=Y instanceof $d()),this.state=Ve|Ne|ce|Ie,fe&&fe.objectMode&&(this.state|=Q),G&&fe&&fe.readableObjectMode&&(this.state|=Q),this.highWaterMark=fe?A(this,fe,"readableHighWaterMark",G):R(!1),this.buffer=new C,this.length=0,this.pipes=[],this.flowing=null,this[U]=null,fe&&fe.emitClose===!1&&(this.state&=-2049),fe&&fe.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=fe&&fe.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,fe&&fe.encoding&&(this.decoder=new H(fe.encoding),this.encoding=fe.encoding)}function ke(fe){if(!(this instanceof ke))return new ke(fe);const Y=this instanceof $d();this._readableState=new Be(fe,this,Y),fe&&(typeof fe.read=="function"&&(this._read=fe.read),typeof fe.destroy=="function"&&(this._destroy=fe.destroy),typeof fe.construct=="function"&&(this._construct=fe.construct),fe.signal&&!Y&&x(fe.signal,this)),y.call(this,fe),k.construct(this,()=>{this._readableState.needReadable&&D(this,this._readableState)})}ke.prototype.destroy=k.destroy,ke.prototype._undestroy=k.undestroy,ke.prototype._destroy=function(fe,Y){Y(fe)},ke.prototype[m.captureRejectionSymbol]=function(fe){this.destroy(fe)},ke.prototype[u]=function(){let fe;return this.destroyed||(fe=this.readableEnded?null:new F,this.destroy(fe)),new l((Y,G)=>w(this,J=>J&&J!==fe?G(J):Y(null)))},ke.prototype.push=function(fe,Y){return lt(this,fe,Y,!1)},ke.prototype.unshift=function(fe,Y){return lt(this,fe,Y,!0)};function lt(fe,Y,G,J){S("readableAddChunk",Y);const be=fe._readableState;let Pe;if((be.state&Q)===0&&(typeof Y=="string"?(G=G||be.defaultEncoding,be.encoding!==G&&(J&&be.encoding?Y=v.from(Y,G).toString(be.encoding):(Y=v.from(Y,G),G=""))):Y instanceof v?G="":y._isUint8Array(Y)?(Y=y._uint8ArrayToBuffer(Y),G=""):Y!=null&&(Pe=new I("chunk",["string","Buffer","Uint8Array"],Y))),Pe)W(fe,Pe);else if(Y===null)be.state&=-9,Lt(fe,be);else if((be.state&Q)!==0||Y&&Y.length>0)if(J)if((be.state&se)!==0)W(fe,new V);else{if(be.destroyed||be.errored)return!1;Rt(fe,be,Y,!0)}else if(be.ended)W(fe,new P);else{if(be.destroyed||be.errored)return!1;be.state&=-9,be.decoder&&!G?(Y=be.decoder.write(Y),be.objectMode||Y.length!==0?Rt(fe,be,Y,!1):D(fe,be)):Rt(fe,be,Y,!1)}else J||(be.state&=-9,D(fe,be));return!be.ended&&(be.length<be.highWaterMark||be.length===0)}function Rt(fe,Y,G,J){Y.flowing&&Y.length===0&&!Y.sync&&fe.listenerCount("data")>0?((Y.state&le)!==0?Y.awaitDrainWriters.clear():Y.awaitDrainWriters=null,Y.dataEmitted=!0,fe.emit("data",G)):(Y.length+=Y.objectMode?1:G.length,J?Y.buffer.unshift(G):Y.buffer.push(G),(Y.state&De)!==0&&en(fe)),D(fe,Y)}ke.prototype.isPaused=function(){const fe=this._readableState;return fe[U]===!0||fe.flowing===!1},ke.prototype.setEncoding=function(fe){const Y=new H(fe);this._readableState.decoder=Y,this._readableState.encoding=this._readableState.decoder.encoding;const G=this._readableState.buffer;let J="";for(const be of G)J+=Y.write(be);return G.clear(),J!==""&&G.push(J),this._readableState.length=J.length,this};const ft=1073741824;function jt(fe){if(fe>ft)throw new L("size","<= 1GiB",fe);return fe--,fe|=fe>>>1,fe|=fe>>>2,fe|=fe>>>4,fe|=fe>>>8,fe|=fe>>>16,fe++,fe}function qt(fe,Y){return fe<=0||Y.length===0&&Y.ended?0:(Y.state&Q)!==0?1:r(fe)?Y.flowing&&Y.length?Y.buffer.first().length:Y.length:fe<=Y.length?fe:Y.ended?Y.length:0}ke.prototype.read=function(fe){S("read",fe),fe===void 0?fe=NaN:n(fe)||(fe=s(fe,10));const Y=this._readableState,G=fe;if(fe>Y.highWaterMark&&(Y.highWaterMark=jt(fe)),fe!==0&&(Y.state&=-129),fe===0&&Y.needReadable&&((Y.highWaterMark!==0?Y.length>=Y.highWaterMark:Y.length>0)||Y.ended))return S("read: emitReadable",Y.length,Y.ended),Y.length===0&&Y.ended?st(this):en(this),null;if(fe=qt(fe,Y),fe===0&&Y.ended)return Y.length===0&&st(this),null;let J=(Y.state&De)!==0;if(S("need readable",J),(Y.length===0||Y.length-fe<Y.highWaterMark)&&(J=!0,S("length less than watermark",J)),Y.ended||Y.reading||Y.destroyed||Y.errored||!Y.constructed)J=!1,S("reading, ended or constructing",J);else if(J){S("do read"),Y.state|=pe|Ie,Y.length===0&&(Y.state|=De);try{this._read(Y.highWaterMark)}catch(Pe){W(this,Pe)}Y.state&=-33,Y.reading||(fe=qt(G,Y))}let be;return fe>0?be=ze(fe,Y):be=null,be===null?(Y.needReadable=Y.length<=Y.highWaterMark,fe=0):(Y.length-=fe,Y.multiAwaitDrain?Y.awaitDrainWriters.clear():Y.awaitDrainWriters=null),Y.length===0&&(Y.ended||(Y.needReadable=!0),G!==fe&&Y.ended&&st(this)),be!==null&&!Y.errorEmitted&&!Y.closeEmitted&&(Y.dataEmitted=!0,this.emit("data",be)),be};function Lt(fe,Y){if(S("onEofChunk"),!Y.ended){if(Y.decoder){const G=Y.decoder.end();G&&G.length&&(Y.buffer.push(G),Y.length+=Y.objectMode?1:G.length)}Y.ended=!0,Y.sync?en(fe):(Y.needReadable=!1,Y.emittedReadable=!0,xe(fe))}}function en(fe){const Y=fe._readableState;S("emitReadable",Y.needReadable,Y.emittedReadable),Y.needReadable=!1,Y.emittedReadable||(S("emitReadable",Y.flowing),Y.emittedReadable=!0,e.nextTick(xe,fe))}function xe(fe){const Y=fe._readableState;S("emitReadable_",Y.destroyed,Y.length,Y.ended),!Y.destroyed&&!Y.errored&&(Y.length||Y.ended)&&(fe.emit("readable"),Y.emittedReadable=!1),Y.needReadable=!Y.flowing&&!Y.ended&&Y.length<=Y.highWaterMark,vt(fe)}function D(fe,Y){!Y.readingMore&&Y.constructed&&(Y.readingMore=!0,e.nextTick(Z,fe,Y))}function Z(fe,Y){for(;!Y.reading&&!Y.ended&&(Y.length<Y.highWaterMark||Y.flowing&&Y.length===0);){const G=Y.length;if(S("maybeReadMore read 0"),fe.read(0),G===Y.length)break}Y.readingMore=!1}ke.prototype._read=function(fe){throw new O("_read()")},ke.prototype.pipe=function(fe,Y){const G=this,J=this._readableState;J.pipes.length===1&&(J.multiAwaitDrain||(J.multiAwaitDrain=!0,J.awaitDrainWriters=new c(J.awaitDrainWriters?[J.awaitDrainWriters]:[]))),J.pipes.push(fe),S("pipe count=%d opts=%j",J.pipes.length,Y);const Pe=(!Y||Y.end!==!1)&&fe!==e.stdout&&fe!==e.stderr?_t:rs;J.endEmitted?e.nextTick(Pe):G.once("end",Pe),fe.on("unpipe",Ge);function Ge(Cr,hn){S("onunpipe"),Cr===G&&hn&&hn.hasUnpiped===!1&&(hn.hasUnpiped=!0,Xt())}function _t(){S("onend"),fe.end()}let tn,Un=!1;function Xt(){S("cleanup"),fe.removeListener("close",Ar),fe.removeListener("finish",ns),tn&&fe.removeListener("drain",tn),fe.removeListener("error",mr),fe.removeListener("unpipe",Ge),G.removeListener("end",_t),G.removeListener("end",rs),G.removeListener("data",un),Un=!0,tn&&J.awaitDrainWriters&&(!fe._writableState||fe._writableState.needDrain)&&tn()}function nn(){Un||(J.pipes.length===1&&J.pipes[0]===fe?(S("false write response, pause",0),J.awaitDrainWriters=fe,J.multiAwaitDrain=!1):J.pipes.length>1&&J.pipes.includes(fe)&&(S("false write response, pause",J.awaitDrainWriters.size),J.awaitDrainWriters.add(fe)),G.pause()),tn||(tn=ge(G,fe),fe.on("drain",tn))}G.on("data",un);function un(Cr){S("ondata");const hn=fe.write(Cr);S("dest.write",hn),hn===!1&&nn()}function mr(Cr){if(S("onerror",Cr),rs(),fe.removeListener("error",mr),fe.listenerCount("error")===0){const hn=fe._writableState||fe._readableState;hn&&!hn.errorEmitted?W(fe,Cr):fe.emit("error",Cr)}}b(fe,"error",mr);function Ar(){fe.removeListener("finish",ns),rs()}fe.once("close",Ar);function ns(){S("onfinish"),fe.removeListener("close",Ar),rs()}fe.once("finish",ns);function rs(){S("unpipe"),G.unpipe(fe)}return fe.emit("pipe",G),fe.writableNeedDrain===!0?nn():J.flowing||(S("pipe resume"),G.resume()),fe};function ge(fe,Y){return function(){const J=fe._readableState;J.awaitDrainWriters===Y?(S("pipeOnDrain",1),J.awaitDrainWriters=null):J.multiAwaitDrain&&(S("pipeOnDrain",J.awaitDrainWriters.size),J.awaitDrainWriters.delete(Y)),(!J.awaitDrainWriters||J.awaitDrainWriters.size===0)&&fe.listenerCount("data")&&fe.resume()}}ke.prototype.unpipe=function(fe){const Y=this._readableState,G={hasUnpiped:!1};if(Y.pipes.length===0)return this;if(!fe){const be=Y.pipes;Y.pipes=[],this.pause();for(let Pe=0;Pe<be.length;Pe++)be[Pe].emit("unpipe",this,{hasUnpiped:!1});return this}const J=t(Y.pipes,fe);return J===-1?this:(Y.pipes.splice(J,1),Y.pipes.length===0&&this.pause(),fe.emit("unpipe",this,G),this)},ke.prototype.on=function(fe,Y){const G=y.prototype.on.call(this,fe,Y),J=this._readableState;return fe==="data"?(J.readableListening=this.listenerCount("readable")>0,J.flowing!==!1&&this.resume()):fe==="readable"&&!J.endEmitted&&!J.readableListening&&(J.readableListening=J.needReadable=!0,J.flowing=!1,J.emittedReadable=!1,S("on readable",J.length,J.reading),J.length?en(this):J.reading||e.nextTick(we,this)),G},ke.prototype.addListener=ke.prototype.on,ke.prototype.removeListener=function(fe,Y){const G=y.prototype.removeListener.call(this,fe,Y);return fe==="readable"&&e.nextTick(Fe,this),G},ke.prototype.off=ke.prototype.removeListener,ke.prototype.removeAllListeners=function(fe){const Y=y.prototype.removeAllListeners.apply(this,arguments);return(fe==="readable"||fe===void 0)&&e.nextTick(Fe,this),Y};function Fe(fe){const Y=fe._readableState;Y.readableListening=fe.listenerCount("readable")>0,Y.resumeScheduled&&Y[U]===!1?Y.flowing=!0:fe.listenerCount("data")>0?fe.resume():Y.readableListening||(Y.flowing=null)}function we(fe){S("readable nexttick read 0"),fe.read(0)}ke.prototype.resume=function(){const fe=this._readableState;return fe.flowing||(S("resume"),fe.flowing=!fe.readableListening,Me(this,fe)),fe[U]=!1,this};function Me(fe,Y){Y.resumeScheduled||(Y.resumeScheduled=!0,e.nextTick(de,fe,Y))}function de(fe,Y){S("resume",Y.reading),Y.reading||fe.read(0),Y.resumeScheduled=!1,fe.emit("resume"),vt(fe),Y.flowing&&!Y.reading&&fe.read(0)}ke.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[U]=!0,this};function vt(fe){const Y=fe._readableState;for(S("flow",Y.flowing);Y.flowing&&fe.read()!==null;);}ke.prototype.wrap=function(fe){let Y=!1;fe.on("data",J=>{!this.push(J)&&fe.pause&&(Y=!0,fe.pause())}),fe.on("end",()=>{this.push(null)}),fe.on("error",J=>{W(this,J)}),fe.on("close",()=>{this.destroy()}),fe.on("destroy",()=>{this.destroy()}),this._read=()=>{Y&&fe.resume&&(Y=!1,fe.resume())};const G=a(fe);for(let J=1;J<G.length;J++){const be=G[J];this[be]===void 0&&typeof fe[be]=="function"&&(this[be]=fe[be].bind(fe))}return this},ke.prototype[d]=function(){return ot(this)},ke.prototype.iterator=function(fe){return fe!==void 0&&X(fe,"options"),ot(this,fe)};function ot(fe,Y){typeof fe.read!="function"&&(fe=ke.wrap(fe,{objectMode:!0}));const G=B(fe,Y);return G.stream=fe,G}async function*B(fe,Y){let G=ne;function J(Ge){this===fe?(G(),G=ne):G=Ge}fe.on("readable",J);let be;const Pe=w(fe,{writable:!1},Ge=>{be=Ge?N(be,Ge):null,G(),G=ne});try{for(;;){const Ge=fe.destroyed?null:fe.read();if(Ge!==null)yield Ge;else{if(be)throw be;if(be===null)return;await new l(J)}}}catch(Ge){throw be=N(be,Ge),be}finally{(be||(Y==null?void 0:Y.destroyOnReturn)!==!1)&&(be===void 0||fe._readableState.autoDestroy)?k.destroyer(fe,null):(fe.off("readable",J),Pe())}}i(ke.prototype,{readable:{__proto__:null,get(){const fe=this._readableState;return!!fe&&fe.readable!==!1&&!fe.destroyed&&!fe.errorEmitted&&!fe.endEmitted},set(fe){this._readableState&&(this._readableState.readable=!!fe)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(fe){this._readableState&&(this._readableState.flowing=fe)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(fe){this._readableState&&(this._readableState.destroyed=fe)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Be.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[U]!==!1},set(fe){this[U]=!!fe}}}),ke._fromList=ze;function ze(fe,Y){if(Y.length===0)return null;let G;return Y.objectMode?G=Y.buffer.shift():!fe||fe>=Y.length?(Y.decoder?G=Y.buffer.join(""):Y.buffer.length===1?G=Y.buffer.first():G=Y.buffer.concat(Y.length),Y.buffer.clear()):G=Y.buffer.consume(fe,Y.decoder),G}function st(fe){const Y=fe._readableState;S("endReadable",Y.endEmitted),Y.endEmitted||(Y.ended=!0,e.nextTick(ye,Y,fe))}function ye(fe,Y){if(S("endReadableNT",fe.endEmitted,fe.length),!fe.errored&&!fe.closeEmitted&&!fe.endEmitted&&fe.length===0){if(fe.endEmitted=!0,Y.emit("end"),Y.writable&&Y.allowHalfOpen===!1)e.nextTick(_e,Y);else if(fe.autoDestroy){const G=Y._writableState;(!G||G.autoDestroy&&(G.finished||G.writable===!1))&&Y.destroy()}}}function _e(fe){fe.writable&&!fe.writableEnded&&!fe.destroyed&&fe.end()}ke.from=function(fe,Y){return $(ke,fe,Y)};let Ue;function kt(){return Ue===void 0&&(Ue={}),Ue}return ke.fromWeb=function(fe,Y){return kt().newStreamReadableFromReadableStream(fe,Y)},ke.toWeb=function(fe,Y){return kt().newReadableStreamFromStreamReadable(fe,Y)},ke.wrap=function(fe,Y){var G,J;return new ke({objectMode:(G=(J=fe.readableObjectMode)!==null&&J!==void 0?J:fe.objectMode)!==null&&G!==void 0?G:!0,...Y,destroy(be,Pe){k.destroyer(fe,be),Pe(be)}}).wrap(fe)},mM}var gM,d9;function zP(){if(d9)return gM;d9=1;const e=Fm(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:c}=Qs();gM=X,X.WritableState=V;const{EventEmitter:u}=LE(),d=BP().Stream,{Buffer:h}=Uh(),m=By(),{addAbortSignal:y}=BE(),{getHighWaterMark:b,getDefaultHighWaterMark:v}=$E(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:C,ERR_STREAM_DESTROYED:k,ERR_STREAM_ALREADY_FINISHED:A,ERR_STREAM_NULL_VALUES:R,ERR_STREAM_WRITE_AFTER_END:N,ERR_UNKNOWN_ENCODING:I}=lo().codes,{errorOrDestroy:O}=m;a(X.prototype,d.prototype),a(X,d);function L(){}const P=l("kOnFinished");function V(Ne,K,me){typeof me!="boolean"&&(me=K instanceof $d()),this.objectMode=!!(Ne&&Ne.objectMode),me&&(this.objectMode=this.objectMode||!!(Ne&&Ne.writableObjectMode)),this.highWaterMark=Ne?b(this,Ne,"writableHighWaterMark",me):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Ae=!!(Ne&&Ne.decodeStrings===!1);this.decodeStrings=!Ae,this.defaultEncoding=Ne&&Ne.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=W.bind(void 0,K),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,F(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!Ne||Ne.emitClose!==!1,this.autoDestroy=!Ne||Ne.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[P]=[]}function F(Ne){Ne.buffered=[],Ne.bufferedIndex=0,Ne.allBuffers=!0,Ne.allNoop=!0}V.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},s(V.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function X(Ne){const K=this instanceof $d();if(!K&&!r(X,this))return new X(Ne);this._writableState=new V(Ne,this,K),Ne&&(typeof Ne.write=="function"&&(this._write=Ne.write),typeof Ne.writev=="function"&&(this._writev=Ne.writev),typeof Ne.destroy=="function"&&(this._destroy=Ne.destroy),typeof Ne.final=="function"&&(this._final=Ne.final),typeof Ne.construct=="function"&&(this._construct=Ne.construct),Ne.signal&&y(Ne.signal,this)),d.call(this,Ne),m.construct(this,()=>{const me=this._writableState;me.writing||pe(this,me),Se(this,me)})}s(X,c,{__proto__:null,value:function(Ne){return r(this,Ne)?!0:this!==X?!1:Ne&&Ne._writableState instanceof V}}),X.prototype.pipe=function(){O(this,new C)};function U(Ne,K,me,Ae){const le=Ne._writableState;if(typeof me=="function")Ae=me,me=le.defaultEncoding;else{if(!me)me=le.defaultEncoding;else if(me!=="buffer"&&!h.isEncoding(me))throw new I(me);typeof Ae!="function"&&(Ae=L)}if(K===null)throw new R;if(!le.objectMode)if(typeof K=="string")le.decodeStrings!==!1&&(K=h.from(K,me),me="buffer");else if(K instanceof h)me="buffer";else if(d._isUint8Array(K))K=d._uint8ArrayToBuffer(K),me="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],K);let oe;return le.ending?oe=new N:le.destroyed&&(oe=new k("write")),oe?(e.nextTick(Ae,oe),O(Ne,oe,!0),oe):(le.pendingcb++,H(Ne,le,K,me,Ae))}X.prototype.write=function(Ne,K,me){return U(this,Ne,K,me)===!0},X.prototype.cork=function(){this._writableState.corked++},X.prototype.uncork=function(){const Ne=this._writableState;Ne.corked&&(Ne.corked--,Ne.writing||pe(this,Ne))},X.prototype.setDefaultEncoding=function(K){if(typeof K=="string"&&(K=o(K)),!h.isEncoding(K))throw new I(K);return this._writableState.defaultEncoding=K,this};function H(Ne,K,me,Ae,le){const oe=K.objectMode?1:me.length;K.length+=oe;const re=K.length<K.highWaterMark;return re||(K.needDrain=!0),K.writing||K.corked||K.errored||!K.constructed?(K.buffered.push({chunk:me,encoding:Ae,callback:le}),K.allBuffers&&Ae!=="buffer"&&(K.allBuffers=!1),K.allNoop&&le!==L&&(K.allNoop=!1)):(K.writelen=oe,K.writecb=le,K.writing=!0,K.sync=!0,Ne._write(me,Ae,K.onwrite),K.sync=!1),re&&!K.errored&&!K.destroyed}function $(Ne,K,me,Ae,le,oe,re){K.writelen=Ae,K.writecb=re,K.writing=!0,K.sync=!0,K.destroyed?K.onwrite(new k("write")):me?Ne._writev(le,K.onwrite):Ne._write(le,oe,K.onwrite),K.sync=!1}function ne(Ne,K,me,Ae){--K.pendingcb,Ae(me),se(K),O(Ne,me)}function W(Ne,K){const me=Ne._writableState,Ae=me.sync,le=me.writecb;if(typeof le!="function"){O(Ne,new S);return}me.writing=!1,me.writecb=null,me.length-=me.writelen,me.writelen=0,K?(K.stack,me.errored||(me.errored=K),Ne._readableState&&!Ne._readableState.errored&&(Ne._readableState.errored=K),Ae?e.nextTick(ne,Ne,me,K,le):ne(Ne,me,K,le)):(me.buffered.length>me.bufferedIndex&&pe(Ne,me),Ae?me.afterWriteTickInfo!==null&&me.afterWriteTickInfo.cb===le?me.afterWriteTickInfo.count++:(me.afterWriteTickInfo={count:1,cb:le,stream:Ne,state:me},e.nextTick(Q,me.afterWriteTickInfo)):ee(Ne,me,1,le))}function Q({stream:Ne,state:K,count:me,cb:Ae}){return K.afterWriteTickInfo=null,ee(Ne,K,me,Ae)}function ee(Ne,K,me,Ae){for(!K.ending&&!Ne.destroyed&&K.length===0&&K.needDrain&&(K.needDrain=!1,Ne.emit("drain"));me-- >0;)K.pendingcb--,Ae();K.destroyed&&se(K),Se(Ne,K)}function se(Ne){if(Ne.writing)return;for(let le=Ne.bufferedIndex;le<Ne.buffered.length;++le){var K;const{chunk:oe,callback:re}=Ne.buffered[le],Te=Ne.objectMode?1:oe.length;Ne.length-=Te,re((K=Ne.errored)!==null&&K!==void 0?K:new k("write"))}const me=Ne[P].splice(0);for(let le=0;le<me.length;le++){var Ae;me[le]((Ae=Ne.errored)!==null&&Ae!==void 0?Ae:new k("end"))}F(Ne)}function pe(Ne,K){if(K.corked||K.bufferProcessing||K.destroyed||!K.constructed)return;const{buffered:me,bufferedIndex:Ae,objectMode:le}=K,oe=me.length-Ae;if(!oe)return;let re=Ae;if(K.bufferProcessing=!0,oe>1&&Ne._writev){K.pendingcb-=oe-1;const Te=K.allNoop?L:ke=>{for(let lt=re;lt<me.length;++lt)me[lt].callback(ke)},Be=K.allNoop&&re===0?me:t(me,re);Be.allBuffers=K.allBuffers,$(Ne,K,!0,K.length,Be,"",Te),F(K)}else{do{const{chunk:Te,encoding:Be,callback:ke}=me[re];me[re++]=null;const lt=le?1:Te.length;$(Ne,K,!1,lt,Te,Be,ke)}while(re<me.length&&!K.writing);re===me.length?F(K):re>256?(me.splice(0,re),K.bufferedIndex=0):K.bufferedIndex=re}K.bufferProcessing=!1}X.prototype._write=function(Ne,K,me){if(this._writev)this._writev([{chunk:Ne,encoding:K}],me);else throw new w("_write()")},X.prototype._writev=null,X.prototype.end=function(Ne,K,me){const Ae=this._writableState;typeof Ne=="function"?(me=Ne,Ne=null,K=null):typeof K=="function"&&(me=K,K=null);let le;if(Ne!=null){const oe=U(this,Ne,K);oe instanceof n&&(le=oe)}return Ae.corked&&(Ae.corked=1,this.uncork()),le||(!Ae.errored&&!Ae.ending?(Ae.ending=!0,Se(this,Ae,!0),Ae.ended=!0):Ae.finished?le=new A("end"):Ae.destroyed&&(le=new k("end"))),typeof me=="function"&&(le||Ae.finished?e.nextTick(me,le):Ae[P].push(me)),this};function ce(Ne){return Ne.ending&&!Ne.destroyed&&Ne.constructed&&Ne.length===0&&!Ne.errored&&Ne.buffered.length===0&&!Ne.finished&&!Ne.writing&&!Ne.errorEmitted&&!Ne.closeEmitted}function Ie(Ne,K){let me=!1;function Ae(le){if(me){O(Ne,le??S());return}if(me=!0,K.pendingcb--,le){const oe=K[P].splice(0);for(let re=0;re<oe.length;re++)oe[re](le);O(Ne,le,K.sync)}else ce(K)&&(K.prefinished=!0,Ne.emit("prefinish"),K.pendingcb++,e.nextTick(Ce,Ne,K))}K.sync=!0,K.pendingcb++;try{Ne._final(Ae)}catch(le){Ae(le)}K.sync=!1}function De(Ne,K){!K.prefinished&&!K.finalCalled&&(typeof Ne._final=="function"&&!K.destroyed?(K.finalCalled=!0,Ie(Ne,K)):(K.prefinished=!0,Ne.emit("prefinish")))}function Se(Ne,K,me){ce(K)&&(De(Ne,K),K.pendingcb===0&&(me?(K.pendingcb++,e.nextTick((Ae,le)=>{ce(le)?Ce(Ae,le):le.pendingcb--},Ne,K)):ce(K)&&(K.pendingcb++,Ce(Ne,K))))}function Ce(Ne,K){K.pendingcb--,K.finished=!0;const me=K[P].splice(0);for(let Ae=0;Ae<me.length;Ae++)me[Ae]();if(Ne.emit("finish"),K.autoDestroy){const Ae=Ne._readableState;(!Ae||Ae.autoDestroy&&(Ae.endEmitted||Ae.readable===!1))&&Ne.destroy()}}i(X.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(Ne){this._writableState&&(this._writableState.destroyed=Ne)}},writable:{__proto__:null,get(){const Ne=this._writableState;return!!Ne&&Ne.writable!==!1&&!Ne.destroyed&&!Ne.errored&&!Ne.ending&&!Ne.ended},set(Ne){this._writableState&&(this._writableState.writable=!!Ne)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const Ne=this._writableState;return Ne?!Ne.destroyed&&!Ne.ending&&Ne.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const qe=m.destroy;X.prototype.destroy=function(Ne,K){const me=this._writableState;return!me.destroyed&&(me.bufferedIndex<me.buffered.length||me[P].length)&&e.nextTick(se,me),qe.call(this,Ne,K),this},X.prototype._undestroy=m.undestroy,X.prototype._destroy=function(Ne,K){K(Ne)},X.prototype[u.captureRejectionSymbol]=function(Ne){this.destroy(Ne)};let Qe;function Ve(){return Qe===void 0&&(Qe={}),Qe}return X.fromWeb=function(Ne,K){return Ve().newStreamWritableFromWritableStream(Ne,K)},X.toWeb=function(Ne){return Ve().newWritableStreamFromStreamWritable(Ne)},gM}var yM,f9;function U_e(){if(f9)return yM;f9=1;const e=Fm(),t=Uh(),{isReadable:n,isWritable:r,isIterable:s,isNodeStream:i,isReadableNodeStream:a,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=tf(),d=qh(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:y}}=lo(),{destroyer:b}=By(),v=$d(),x=zE(),w=zP(),{createDeferredPromise:S}=To(),C=GK(),k=globalThis.Blob||t.Blob,A=typeof k<"u"?function(V){return V instanceof k}:function(V){return!1},R=globalThis.AbortController||tw().AbortController,{FunctionPrototypeCall:N}=Qs();class I extends v{constructor(V){super(V),(V==null?void 0:V.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(V==null?void 0:V.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}yM=function P(V,F){if(l(V))return V;if(a(V))return L({readable:V});if(o(V))return L({writable:V});if(i(V))return L({writable:!1,readable:!1});if(c(V))return L({readable:x.fromWeb(V)});if(u(V))return L({writable:w.fromWeb(V)});if(typeof V=="function"){const{value:U,write:H,final:$,destroy:ne}=O(V);if(s(U))return C(I,U,{objectMode:!0,write:H,final:$,destroy:ne});const W=U==null?void 0:U.then;if(typeof W=="function"){let Q;const ee=N(W,U,se=>{if(se!=null)throw new y("nully","body",se)},se=>{b(Q,se)});return Q=new I({objectMode:!0,readable:!1,write:H,final(se){$(async()=>{try{await ee,e.nextTick(se,null)}catch(pe){e.nextTick(se,pe)}})},destroy:ne})}throw new y("Iterable, AsyncIterable or AsyncFunction",F,U)}if(A(V))return P(V.arrayBuffer());if(s(V))return C(I,V,{objectMode:!0,writable:!1});if(c(V==null?void 0:V.readable)&&u(V==null?void 0:V.writable))return I.fromWeb(V);if(typeof(V==null?void 0:V.writable)=="object"||typeof(V==null?void 0:V.readable)=="object"){const U=V!=null&&V.readable?a(V==null?void 0:V.readable)?V==null?void 0:V.readable:P(V.readable):void 0,H=V!=null&&V.writable?o(V==null?void 0:V.writable)?V==null?void 0:V.writable:P(V.writable):void 0;return L({readable:U,writable:H})}const X=V==null?void 0:V.then;if(typeof X=="function"){let U;return N(X,V,H=>{H!=null&&U.push(H),U.push(null)},H=>{b(U,H)}),U=new I({objectMode:!0,writable:!1,read(){}})}throw new m(F,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],V)};function O(P){let{promise:V,resolve:F}=S();const X=new R,U=X.signal;return{value:P(async function*(){for(;;){const $=V;V=null;const{chunk:ne,done:W,cb:Q}=await $;if(e.nextTick(Q),W)return;if(U.aborted)throw new h(void 0,{cause:U.reason});({promise:V,resolve:F}=S()),yield ne}}(),{signal:U}),write($,ne,W){const Q=F;F=null,Q({chunk:$,done:!1,cb:W})},final($){const ne=F;F=null,ne({done:!0,cb:$})},destroy($,ne){X.abort(),ne($)}}}function L(P){const V=P.readable&&typeof P.readable.read!="function"?x.wrap(P.readable):P.readable,F=P.writable;let X=!!n(V),U=!!r(F),H,$,ne,W,Q;function ee(se){const pe=W;W=null,pe?pe(se):se&&Q.destroy(se)}return Q=new I({readableObjectMode:!!(V!=null&&V.readableObjectMode),writableObjectMode:!!(F!=null&&F.writableObjectMode),readable:X,writable:U}),U&&(d(F,se=>{U=!1,se&&b(V,se),ee(se)}),Q._write=function(se,pe,ce){F.write(se,pe)?ce():H=ce},Q._final=function(se){F.end(),$=se},F.on("drain",function(){if(H){const se=H;H=null,se()}}),F.on("finish",function(){if($){const se=$;$=null,se()}})),X&&(d(V,se=>{X=!1,se&&b(V,se),ee(se)}),V.on("readable",function(){if(ne){const se=ne;ne=null,se()}}),V.on("end",function(){Q.push(null)}),Q._read=function(){for(;;){const se=V.read();if(se===null){ne=Q._read;return}if(!Q.push(se))return}}),Q._destroy=function(se,pe){!se&&W!==null&&(se=new h),ne=null,H=null,$=null,W===null?pe(se):(W=pe,b(F,se),b(V,se))},Q}return yM}var bM,h9;function $d(){if(h9)return bM;h9=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=Qs();bM=a;const s=zE(),i=zP();r(a.prototype,s.prototype),r(a,s);{const u=n(i.prototype);for(let d=0;d<u.length;d++){const h=u[d];a.prototype[h]||(a.prototype[h]=i.prototype[h])}}function a(u){if(!(this instanceof a))return new a(u);s.call(this,u),i.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(a.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let o;function l(){return o===void 0&&(o={}),o}a.fromWeb=function(u,d){return l().newStreamDuplexFromReadableWritablePair(u,d)},a.toWeb=function(u){return l().newReadableWritablePairFromDuplex(u)};let c;return a.from=function(u){return c||(c=U_e()),c(u,"body")},bM}var vM,p9;function KK(){if(p9)return vM;p9=1;const{ObjectSetPrototypeOf:e,Symbol:t}=Qs();vM=a;const{ERR_METHOD_NOT_IMPLEMENTED:n}=lo().codes,r=$d(),{getHighWaterMark:s}=$E();e(a.prototype,r.prototype),e(a,r);const i=t("kCallback");function a(c){if(!(this instanceof a))return new a(c);const u=c?s(this,c,"readableHighWaterMark",!0):null;u===0&&(c={...c,highWaterMark:null,readableHighWaterMark:u,writableHighWaterMark:c.writableHighWaterMark||0}),r.call(this,c),this._readableState.sync=!1,this[i]=null,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function o(c){typeof this._flush=="function"&&!this.destroyed?this._flush((u,d)=>{if(u){c?c(u):this.destroy(u);return}d!=null&&this.push(d),this.push(null),c&&c()}):(this.push(null),c&&c())}function l(){this._final!==o&&o.call(this)}return a.prototype._final=o,a.prototype._transform=function(c,u,d){throw new n("_transform()")},a.prototype._write=function(c,u,d){const h=this._readableState,m=this._writableState,y=h.length;this._transform(c,u,(b,v)=>{if(b){d(b);return}v!=null&&this.push(v),m.ended||y===h.length||h.length<h.highWaterMark?d():this[i]=d})},a.prototype._read=function(){if(this[i]){const c=this[i];this[i]=null,c()}},vM}var xM,m9;function YK(){if(m9)return xM;m9=1;const{ObjectSetPrototypeOf:e}=Qs();xM=n;const t=KK();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,s,i){i(null,r)},xM}var wM,g9;function UP(){if(g9)return wM;g9=1;const e=Fm(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:s}=Qs(),i=qh(),{once:a}=To(),o=By(),l=$d(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:d,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=lo(),{validateFunction:v,validateAbortSignal:x}=m1(),{isIterable:w,isReadable:S,isReadableNodeStream:C,isNodeStream:k,isTransformStream:A,isWebStream:R,isReadableStream:N,isReadableFinished:I}=tf(),O=globalThis.AbortController||tw().AbortController;let L,P,V;function F(se,pe,ce){let Ie=!1;se.on("close",()=>{Ie=!0});const De=i(se,{readable:pe,writable:ce},Se=>{Ie=!Se});return{destroy:Se=>{Ie||(Ie=!0,o.destroyer(se,Se||new m("pipe")))},cleanup:De}}function X(se){return v(se[se.length-1],"streams[stream.length - 1]"),se.pop()}function U(se){if(w(se))return se;if(C(se))return H(se);throw new u("val",["Readable","Iterable","AsyncIterable"],se)}async function*H(se){P||(P=zE()),yield*P.prototype[r].call(se)}async function $(se,pe,ce,{end:Ie}){let De,Se=null;const Ce=Ve=>{if(Ve&&(De=Ve),Se){const Ne=Se;Se=null,Ne()}},qe=()=>new n((Ve,Ne)=>{De?Ne(De):Se=()=>{De?Ne(De):Ve()}});pe.on("drain",Ce);const Qe=i(pe,{readable:!1},Ce);try{pe.writableNeedDrain&&await qe();for await(const Ve of se)pe.write(Ve)||await qe();Ie&&(pe.end(),await qe()),ce()}catch(Ve){ce(De!==Ve?c(De,Ve):Ve)}finally{Qe(),pe.off("drain",Ce)}}async function ne(se,pe,ce,{end:Ie}){A(pe)&&(pe=pe.writable);const De=pe.getWriter();try{for await(const Se of se)await De.ready,De.write(Se).catch(()=>{});await De.ready,Ie&&await De.close(),ce()}catch(Se){try{await De.abort(Se),ce(Se)}catch(Ce){ce(Ce)}}}function W(...se){return Q(se,a(X(se)))}function Q(se,pe,ce){if(se.length===1&&t(se[0])&&(se=se[0]),se.length<2)throw new h("streams");const Ie=new O,De=Ie.signal,Se=ce==null?void 0:ce.signal,Ce=[];x(Se,"options.signal");function qe(){le(new b)}V=V||To().addAbortListener;let Qe;Se&&(Qe=V(Se,qe));let Ve,Ne;const K=[];let me=0;function Ae(Be){le(Be,--me===0)}function le(Be,ke){var lt;if(Be&&(!Ve||Ve.code==="ERR_STREAM_PREMATURE_CLOSE")&&(Ve=Be),!(!Ve&&!ke)){for(;K.length;)K.shift()(Ve);(lt=Qe)===null||lt===void 0||lt[s](),Ie.abort(),ke&&(Ve||Ce.forEach(Rt=>Rt()),e.nextTick(pe,Ve,Ne))}}let oe;for(let Be=0;Be<se.length;Be++){const ke=se[Be],lt=Be<se.length-1,Rt=Be>0,ft=lt||(ce==null?void 0:ce.end)!==!1,jt=Be===se.length-1;if(k(ke)){let qt=function(Lt){Lt&&Lt.name!=="AbortError"&&Lt.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Ae(Lt)};if(ft){const{destroy:Lt,cleanup:en}=F(ke,lt,Rt);K.push(Lt),S(ke)&&jt&&Ce.push(en)}ke.on("error",qt),S(ke)&&jt&&Ce.push(()=>{ke.removeListener("error",qt)})}if(Be===0)if(typeof ke=="function"){if(oe=ke({signal:De}),!w(oe))throw new d("Iterable, AsyncIterable or Stream","source",oe)}else w(ke)||C(ke)||A(ke)?oe=ke:oe=l.from(ke);else if(typeof ke=="function"){if(A(oe)){var re;oe=U((re=oe)===null||re===void 0?void 0:re.readable)}else oe=U(oe);if(oe=ke(oe,{signal:De}),lt){if(!w(oe,!0))throw new d("AsyncIterable",`transform[${Be-1}]`,oe)}else{var Te;L||(L=YK());const qt=new L({objectMode:!0}),Lt=(Te=oe)===null||Te===void 0?void 0:Te.then;if(typeof Lt=="function")me++,Lt.call(oe,D=>{Ne=D,D!=null&&qt.write(D),ft&&qt.end(),e.nextTick(Ae)},D=>{qt.destroy(D),e.nextTick(Ae,D)});else if(w(oe,!0))me++,$(oe,qt,Ae,{end:ft});else if(N(oe)||A(oe)){const D=oe.readable||oe;me++,$(D,qt,Ae,{end:ft})}else throw new d("AsyncIterable or Promise","destination",oe);oe=qt;const{destroy:en,cleanup:xe}=F(oe,!1,!0);K.push(en),jt&&Ce.push(xe)}}else if(k(ke)){if(C(oe)){me+=2;const qt=ee(oe,ke,Ae,{end:ft});S(ke)&&jt&&Ce.push(qt)}else if(A(oe)||N(oe)){const qt=oe.readable||oe;me++,$(qt,ke,Ae,{end:ft})}else if(w(oe))me++,$(oe,ke,Ae,{end:ft});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=ke}else if(R(ke)){if(C(oe))me++,ne(U(oe),ke,Ae,{end:ft});else if(N(oe)||w(oe))me++,ne(oe,ke,Ae,{end:ft});else if(A(oe))me++,ne(oe.readable,ke,Ae,{end:ft});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=ke}else oe=l.from(ke)}return(De!=null&&De.aborted||Se!=null&&Se.aborted)&&e.nextTick(qe),oe}function ee(se,pe,ce,{end:Ie}){let De=!1;if(pe.on("close",()=>{De||ce(new y)}),se.pipe(pe,{end:!1}),Ie){let Se=function(){De=!0,pe.end()};I(se)?e.nextTick(Se):se.once("end",Se)}else ce();return i(se,{readable:!0,writable:!1},Se=>{const Ce=se._readableState;Se&&Se.code==="ERR_STREAM_PREMATURE_CLOSE"&&Ce&&Ce.ended&&!Ce.errored&&!Ce.errorEmitted?se.once("end",ce).once("error",ce):ce(Se)}),i(pe,{readable:!1,writable:!0},ce)}return wM={pipelineImpl:Q,pipeline:W},wM}var _M,y9;function ZK(){if(y9)return _M;y9=1;const{pipeline:e}=UP(),t=$d(),{destroyer:n}=By(),{isNodeStream:r,isReadable:s,isWritable:i,isWebStream:a,isTransformStream:o,isWritableStream:l,isReadableStream:c}=tf(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:d,ERR_MISSING_ARGS:h}}=lo(),m=qh();return _M=function(...b){if(b.length===0)throw new h("streams");if(b.length===1)return t.from(b[0]);const v=[...b];if(typeof b[0]=="function"&&(b[0]=t.from(b[0])),typeof b[b.length-1]=="function"){const L=b.length-1;b[L]=t.from(b[L])}for(let L=0;L<b.length;++L)if(!(!r(b[L])&&!a(b[L]))){if(L<b.length-1&&!(s(b[L])||c(b[L])||o(b[L])))throw new d(`streams[${L}]`,v[L],"must be readable");if(L>0&&!(i(b[L])||l(b[L])||o(b[L])))throw new d(`streams[${L}]`,v[L],"must be writable")}let x,w,S,C,k;function A(L){const P=C;C=null,P?P(L):L?k.destroy(L):!O&&!I&&k.destroy()}const R=b[0],N=e(b,A),I=!!(i(R)||l(R)||o(R)),O=!!(s(N)||c(N)||o(N));if(k=new t({writableObjectMode:!!(R!=null&&R.writableObjectMode),readableObjectMode:!!(N!=null&&N.readableObjectMode),writable:I,readable:O}),I){if(r(R))k._write=function(P,V,F){R.write(P,V)?F():x=F},k._final=function(P){R.end(),w=P},R.on("drain",function(){if(x){const P=x;x=null,P()}});else if(a(R)){const V=(o(R)?R.writable:R).getWriter();k._write=async function(F,X,U){try{await V.ready,V.write(F).catch(()=>{}),U()}catch(H){U(H)}},k._final=async function(F){try{await V.ready,V.close().catch(()=>{}),w=F}catch(X){F(X)}}}const L=o(N)?N.readable:N;m(L,()=>{if(w){const P=w;w=null,P()}})}if(O){if(r(N))N.on("readable",function(){if(S){const L=S;S=null,L()}}),N.on("end",function(){k.push(null)}),k._read=function(){for(;;){const L=N.read();if(L===null){S=k._read;return}if(!k.push(L))return}};else if(a(N)){const P=(o(N)?N.readable:N).getReader();k._read=async function(){for(;;)try{const{value:V,done:F}=await P.read();if(!k.push(V))return;if(F){k.push(null);return}}catch{return}}}}return k._destroy=function(L,P){!L&&C!==null&&(L=new u),S=null,x=null,w=null,C===null?P(L):(C=P,r(N)&&n(N,L))},k},_M}var b9;function q_e(){if(b9)return RS;b9=1;const e=globalThis.AbortController||tw().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:s},AbortError:i}=lo(),{validateAbortSignal:a,validateInteger:o,validateObject:l}=m1(),c=Qs().Symbol("kWeak"),u=Qs().Symbol("kResistStopPropagation"),{finished:d}=qh(),h=ZK(),{addAbortSignalNoValidate:m}=BE(),{isWritable:y,isNodeStream:b}=tf(),{deprecate:v}=To(),{ArrayPrototypePush:x,Boolean:w,MathFloor:S,Number:C,NumberIsNaN:k,Promise:A,PromiseReject:R,PromiseResolve:N,PromisePrototypeThen:I,Symbol:O}=Qs(),L=O("kEmpty"),P=O("kEof");function V(Se,Ce){if(Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),b(Se)&&!y(Se))throw new t("stream",Se,"must be writable");const qe=h(this,Se);return Ce!=null&&Ce.signal&&m(Ce.signal,qe),qe}function F(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal");let qe=1;(Ce==null?void 0:Ce.concurrency)!=null&&(qe=S(Ce.concurrency));let Qe=qe-1;return(Ce==null?void 0:Ce.highWaterMark)!=null&&(Qe=S(Ce.highWaterMark)),o(qe,"options.concurrency",1),o(Qe,"options.highWaterMark",0),Qe+=qe,(async function*(){const Ne=To().AbortSignalAny([Ce==null?void 0:Ce.signal].filter(w)),K=this,me=[],Ae={signal:Ne};let le,oe,re=!1,Te=0;function Be(){re=!0,ke()}function ke(){Te-=1,lt()}function lt(){oe&&!re&&Te<qe&&me.length<Qe&&(oe(),oe=null)}async function Rt(){try{for await(let ft of K){if(re)return;if(Ne.aborted)throw new i;try{if(ft=Se(ft,Ae),ft===L)continue;ft=N(ft)}catch(jt){ft=R(jt)}Te+=1,I(ft,ke,Be),me.push(ft),le&&(le(),le=null),!re&&(me.length>=Qe||Te>=qe)&&await new A(jt=>{oe=jt})}me.push(P)}catch(ft){const jt=R(ft);I(jt,ke,Be),me.push(jt)}finally{re=!0,le&&(le(),le=null)}}Rt();try{for(;;){for(;me.length>0;){const ft=await me[0];if(ft===P)return;if(Ne.aborted)throw new i;ft!==L&&(yield ft),me.shift(),lt()}await new A(ft=>{le=ft})}}finally{re=!0,oe&&(oe(),oe=null)}}).call(this)}function X(Se=void 0){return Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal"),(async function*(){let qe=0;for await(const Ve of this){var Qe;if(Se!=null&&(Qe=Se.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i({cause:Se.signal.reason});yield[qe++,Ve]}}).call(this)}async function U(Se,Ce=void 0){for await(const qe of W.call(this,Se,Ce))return!0;return!1}async function H(Se,Ce=void 0){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);return!await U.call(this,async(...qe)=>!await Se(...qe),Ce)}async function $(Se,Ce){for await(const qe of W.call(this,Se,Ce))return qe}async function ne(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,Ve){return await Se(Qe,Ve),L}for await(const Qe of F.call(this,qe,Ce));}function W(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,Ve){return await Se(Qe,Ve)?Qe:L}return F.call(this,qe,Ce)}class Q extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function ee(Se,Ce,qe){var Qe;if(typeof Se!="function")throw new n("reducer",["Function","AsyncFunction"],Se);qe!=null&&l(qe,"options"),(qe==null?void 0:qe.signal)!=null&&a(qe.signal,"options.signal");let Ve=arguments.length>1;if(qe!=null&&(Qe=qe.signal)!==null&&Qe!==void 0&&Qe.aborted){const le=new i(void 0,{cause:qe.signal.reason});throw this.once("error",()=>{}),await d(this.destroy(le)),le}const Ne=new e,K=Ne.signal;if(qe!=null&&qe.signal){const le={once:!0,[c]:this,[u]:!0};qe.signal.addEventListener("abort",()=>Ne.abort(),le)}let me=!1;try{for await(const le of this){var Ae;if(me=!0,qe!=null&&(Ae=qe.signal)!==null&&Ae!==void 0&&Ae.aborted)throw new i;Ve?Ce=await Se(Ce,le,{signal:K}):(Ce=le,Ve=!0)}if(!me&&!Ve)throw new Q}finally{Ne.abort()}return Ce}async function se(Se){Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal");const Ce=[];for await(const Qe of this){var qe;if(Se!=null&&(qe=Se.signal)!==null&&qe!==void 0&&qe.aborted)throw new i(void 0,{cause:Se.signal.reason});x(Ce,Qe)}return Ce}function pe(Se,Ce){const qe=F.call(this,Se,Ce);return(async function*(){for await(const Ve of qe)yield*Ve}).call(this)}function ce(Se){if(Se=C(Se),k(Se))return 0;if(Se<0)throw new s("number",">= 0",Se);return Se}function Ie(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=ce(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ne of this){var Ve;if(Ce!=null&&(Ve=Ce.signal)!==null&&Ve!==void 0&&Ve.aborted)throw new i;Se--<=0&&(yield Ne)}}).call(this)}function De(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=ce(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ne of this){var Ve;if(Ce!=null&&(Ve=Ce.signal)!==null&&Ve!==void 0&&Ve.aborted)throw new i;if(Se-- >0&&(yield Ne),Se<=0)return}}).call(this)}return RS.streamReturningOperators={asIndexedPairs:v(X,"readable.asIndexedPairs will be removed in a future version."),drop:Ie,filter:W,flatMap:pe,map:F,take:De,compose:V},RS.promiseReturningOperators={every:H,forEach:ne,reduce:ee,toArray:se,some:U,find:$},RS}var SM,v9;function XK(){if(v9)return SM;v9=1;const{ArrayPrototypePop:e,Promise:t}=Qs(),{isIterable:n,isNodeStream:r,isWebStream:s}=tf(),{pipelineImpl:i}=UP(),{finished:a}=qh();JK();function o(...l){return new t((c,u)=>{let d,h;const m=l[l.length-1];if(m&&typeof m=="object"&&!r(m)&&!n(m)&&!s(m)){const y=e(l);d=y.signal,h=y.end}i(l,(y,b)=>{y?u(y):c(b)},{signal:d,end:h})})}return SM={finished:a,pipeline:o},SM}var x9;function JK(){if(x9)return QN.exports;x9=1;const{Buffer:e}=Uh(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=Qs(),{promisify:{custom:s}}=To(),{streamReturningOperators:i,promiseReturningOperators:a}=q_e(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=lo(),l=ZK(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=$E(),{pipeline:d}=UP(),{destroyer:h}=By(),m=qh(),y=XK(),b=tf(),v=QN.exports=BP().Stream;v.isDestroyed=b.isDestroyed,v.isDisturbed=b.isDisturbed,v.isErrored=b.isErrored,v.isReadable=b.isReadable,v.isWritable=b.isWritable,v.Readable=zE();for(const w of n(i)){let C=function(...k){if(new.target)throw o();return v.Readable.from(r(S,this,k))};const S=i[w];t(C,"name",{__proto__:null,value:S.name}),t(C,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:C,enumerable:!1,configurable:!0,writable:!0})}for(const w of n(a)){let C=function(...k){if(new.target)throw o();return r(S,this,k)};const S=a[w];t(C,"name",{__proto__:null,value:S.name}),t(C,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:C,enumerable:!1,configurable:!0,writable:!0})}v.Writable=zP(),v.Duplex=$d(),v.Transform=KK(),v.PassThrough=YK(),v.pipeline=d;const{addAbortSignal:x}=BE();return v.addAbortSignal=x,v.finished=m,v.destroy=h,v.compose=l,v.setDefaultHighWaterMark=c,v.getDefaultHighWaterMark=u,t(v,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return y}}),t(d,s,{__proto__:null,enumerable:!0,get(){return y.pipeline}}),t(m,s,{__proto__:null,enumerable:!0,get(){return y.finished}}),v.Stream=v,v._isUint8Array=function(S){return S instanceof Uint8Array},v._uint8ArrayToBuffer=function(S){return e.from(S.buffer,S.byteOffset,S.byteLength)},QN.exports}var w9;function V_e(){return w9||(w9=1,function(e){const t=JK(),n=XK(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(JN)),JN.exports}var QK=V_e();class qP extends QK.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(s=>{this._path=s.path;const i=s.readableWebStream({start:t.start,end:t.end});this.reader=i.getReader(),this.pending=!1}).catch(s=>{this.destroy(s)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Xe(gt.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Xe(gt.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class VP extends QK.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const s=r.writableWebStream({start:t.start});this.writer=s.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(Oa(new Xe(gt.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(Oa(new Xe(gt.ENOTSUP,"Unsupported encoding for stream",this._path)));const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(s),this._bytesWritten+=t.byteLength,r()}catch(i){r(new Xe(gt.EIO,i.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Xe(gt.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Xe(gt.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var Kl=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Yl=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class La{get position(){return this.flag&mm?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=za(t,n);Object.assign(this,Am(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&PE||this.inode.flags&_o.Sync)}_emitChange(){xa(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"chown");this.dirty=!0,MK(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=$h(t,-1);if(n<0)throw new Xe(gt.EINVAL,"Invalid mode");if(this.closed)throw Xe.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>Ss?-61441:Ss)|n,(this._isSync||n>Ss)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Xe.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Xe.With("EBADF",this.path,"truncate");if(t<0)throw new Xe(gt.EINVAL);if(this.dirty=!0,!(this.flag&ja||this.flag&Ad))throw new Xe(gt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=PC(t),this.inode.mtimeMs=PC(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=Rd(n,"utf8","a",420);if(!(Nd(r.flag)&mm))throw new Xe(gt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Xe(gt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Os.from(t,r.encoding):t;await this._write(i,0,i.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"read");if(this.flag&ja)throw new Xe(gt.EPERM,"File not opened with a readable mode");this.inode.flags&_o.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!Jx(this.inode)&&!Xx(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&await this.sync(),{bytesRead:i-s,buffer:t}}async read(t,n,r,s){typeof n=="object"&&n!=null&&(s=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(s=t.position,r=t.length,n=t.offset,t=t.buffer);const i=Number.isSafeInteger(s)?s:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,i)}async readFile(t){const n=Rd(t,null,"r",292);if(Nd(n.flag)&ja)throw new Xe(gt.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:s}=await this.stat(),{buffer:i}=await this._read(new Uint8Array(s),0,s,0),a=Os.from(i);return n.encoding?a.toString(n.encoding):a}readableWebStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&_o.Immutable)throw new Xe(gt.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&ja)throw Xe.With("EBADF",this.path,"readLines");return c_e({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Xe.With("EBADF",this.path,"stat");if(!ds(this.context,this.inode,zi))throw Xe.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new Om(this.inode):new ef(this.inode)}async _write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"write");if(this.inode.flags&_o.Immutable)throw new Xe(gt.EPERM,"File is immutable",this.path,"write");if(!(this.flag&ja||this.flag&Ad))throw new Xe(gt.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!Jx(this.inode)&&!Xx(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,await this.fs.write(this.internalPath,a,s),this._isSync&&await this.sync(),a.byteLength}async write(t,n,r,s){let i,a,o;typeof n=="object"&&n!=null&&(r=n.length,s=n.position,n=n.offset),typeof t=="string"?(s=typeof n=="number"?n:null,a=0,i=Os.from(t,typeof r=="string"?r:"utf8"),o=i.length):(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n??0,o=typeof r=="number"?r:i.byteLength,s=typeof s=="number"?s:null),s??(s=this.position);const l=await this._write(i,a,o,s);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=Rd(n,"utf8","w",420),s=Nd(r.flag);if(!(s&ja||s&Ad))throw new Xe(gt.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Xe(gt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Os.from(t,r.encoding):t;await this._write(i,0,i.length,0),this._emitChange()}async close(){if(this.closed)throw Xe.With("EBADF",this.path,"close");await this.sync(),this.dispose(),OK(this.context,this.fd)}dispose(t){if(this.closed)throw Xe.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Xe.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.write(s)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.read(s)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&ja)throw Xe.With("EBADF",this.path,"createReadStream");return new qP(t,this)}createWriteStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&_o.Immutable)throw new Xe(gt.EPERM,"File is immutable",this.path,"createWriteStream");return new VP(t,this)}}async function eY(e,t){e=Pn(e),t=Pn(t);const n=Nr(e,this),r=Nr(t,this);if(!(await $y.call(this,Yr(e))).hasAccess(ai,this))throw Xe.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),xa(this,"rename",e.toString()),xa(this,"change",t.toString());return}await WE.call(this,t,await VE(e)),await qE.call(this,e),xa(this,"rename",e.toString())}catch(s){throw fs(s,{[n.path]:e,[r.path]:t})}}async function g1(e){try{const{fs:t,path:n}=Nr(await Vh.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Xe&&t.code=="ENOENT")return!1;throw t}}async function $y(e,t){e=Pn(e);const{fs:n,path:r}=Nr(await Vh.call(this,e),this);try{const s=await n.stat(r);if(Ui&&!ds(this,s,zi))throw Xe.With("EACCES",r,"stat");return t!=null&&t.bigint?new Om(s):new ef(s)}catch(s){throw fs(s,{[r]:e})}}async function UE(e,t){e=Pn(e);const{fs:n,path:r}=Nr(e,this);try{const s=await n.stat(r);if(Ui&&!ds(this,s,zi))throw Xe.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Om(s):new ef(s)}catch(s){throw fs(s,{[r]:e})}}async function tY(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await Kl(n,await Zl.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Yl(n);r&&await r}}async function qE(e){e=Pn(e);const{fs:t,path:n}=Nr(e,this);try{if(Ui&&!ds(this,await t.stat(n),ai))throw Xe.With("EACCES",n,"unlink");await t.unlink(n),xa(this,"rename",e.toString())}catch(r){throw fs(r,{[n]:e})}}async function zy(e,t,n){var r;t=Pn(t);const s=$h(n.mode,420),i=Nd(n.flag),{fullPath:a,fs:o,path:l,stats:c}=await BC(e,t.toString(),n.preserveSymlinks);if(!c){if(!(i&IE))throw Xe.With("ENOENT",a,"_open");const d=await o.stat(Yr(l));if(!ds(e,d,ai))throw Xe.With("EACCES",Yr(a),"_open");if(!Tc(d))throw Xe.With("ENOTDIR",Yr(a),"_open");const{euid:h,egid:m}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:Mc.credentials,y=await o.createFile(l,{mode:s,uid:d.mode&d1?d.uid:h,gid:d.mode&f1?d.gid:m});return new La(e,FC(new DC(e,t,o,l,i,y)))}if(!ds(e,c,PK(i)))throw Xe.With("EACCES",a,"_open");if(i&jE)throw Xe.With("EEXIST",a,"_open");const u=new La(e,FC(new DC(e,t,o,l,i,c)));return i&OE&&await u.truncate(0),u}async function Zl(e,t="r",n=420){return await zy(this,e,{flag:t,mode:n})}async function VE(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=Rd(t,null,"r",292);return await Kl(n,typeof e=="object"&&"fd"in e?e:await Zl.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=Yl(n);r&&await r}}async function WE(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Rd(n,"utf8","w+",420),i=Kl(r,e instanceof La?e:await Zl.call(this,e.toString(),s.flag,s.mode),!0),a=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof a!="string"&&!(a instanceof Uint8Array))throw new Xe(gt.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,i.path,"writeFile");await i.writeFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=Yl(r);s&&await s}}async function nY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Rd(n,"utf8","a",420);if(!(Nd(s.flag)&mm))throw new Xe(gt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Xe(gt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Os.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await Kl(r,typeof e=="object"&&"fd"in e?e:await Zl.call(this,e,s.flag,s.mode),!0).appendFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=Yl(r);s&&await s}}async function WP(e){e=await Vh.call(this,e);const{fs:t,path:n}=Nr(e,this);try{const r=await t.stat(n);if(!r)throw Xe.With("ENOENT",e,"rmdir");if(!Tc(r))throw Xe.With("ENOTDIR",n,"rmdir");if(Ui&&!ds(this,r,ai))throw Xe.With("EACCES",n,"rmdir");await t.rmdir(n),xa(this,"rename",e.toString())}catch(r){throw fs(r,{[n]:e})}}async function HE(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Mc.credentials;t=typeof t=="object"?t:{mode:t};const a=$h(t==null?void 0:t.mode,511);e=await Vh.call(this,e);const{fs:o,path:l,root:c}=Nr(e,this),u={[l]:e},d=async(h,m)=>{if(!ds(this,m,ai))throw Xe.With("EACCES",Yr(h),"mkdir");const y=await o.mkdir(h,{mode:a,uid:m.mode&d1?m.uid:s,gid:m.mode&f1?m.gid:i});return xa(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){await d(l,await o.stat(Yr(l)));return}const h=[];for(let y=l,b=e;!await o.exists(y);y=Yr(y),b=Yr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[await o.stat(Yr(h[0]))];for(const[y,b]of h.entries())m.push(await d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw fs(h,u)}}async function Lm(e,t){t=typeof t=="object"?t:{encoding:t},e=await Vh.call(this,e);const{fs:n,path:r}=Nr(e,this),s=await n.stat(r).catch(l=>ys(fs(l,{[r]:e})));if(!s)throw Xe.With("ENOENT",e,"readdir");if(!ds(this,s,zi))throw Xe.With("EACCES",e,"readdir");if(!Tc(s))throw Xe.With("ENOTDIR",e,"readdir");const i=await n.readdir(r).catch(l=>ys(fs(l,{[r]:e}))),a=[],o=async l=>{let c;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(c=await n.stat(is(r,l)).catch(u=>{if(u.code!="ENOENT")throw fs(u,{[r]:e})}),!c))&&(t!=null&&t.withFileTypes?a.push(new ew(l,c)):(t==null?void 0:t.encoding)=="buffer"?a.push(Os.from(l)):a.push(l),!(!(t!=null&&t.recursive)||!Tc(c))))for(const u of await Lm.call(this,is(e,l),t))u instanceof ew?(u.path=is(l,u.path),a.push(u)):Os.isBuffer(u)?a.push(Os.from(is(l,yP(u)))):a.push(is(l,u))};return await Promise.all(i.map(o)),a}async function rY(e,t){e=Pn(e),t=Pn(t);const{fs:n,path:r}=Nr(e,this),s=Nr(t,this);if(n!=s.fs)throw Xe.With("EXDEV",t,"link");try{if(Ui&&!ds(this,await n.stat(Yr(r)),zi))throw Xe.With("EACCES",Yr(r),"link");if(Ui&&!(await $y.call(this,Yr(t))).hasAccess(ai,this))throw Xe.With("EACCES",Yr(t),"link");if(Ui&&!ds(this,await n.stat(r),zi))throw Xe.With("EACCES",r,"link");return await n.link(r,s.path)}catch(i){throw fs(i,{[s.path]:t,[r]:e})}}async function sY(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Xe(gt.EINVAL,"Invalid symlink type: "+n);if(t=Pn(t),await g1.call(this,t))throw Xe.With("EEXIST",t,"symlink");const s=Kl(r,await zy(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await s.writeFile(Pn(e,!0)),await s.chmod(Qd)}catch(s){r.error=s,r.hasError=!0}finally{const s=Yl(r);s&&await s}}async function LC(e,t){const n={stack:[],error:void 0,hasError:!1};try{const s=await Kl(n,await zy(this,Pn(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),i=typeof t=="object"?t==null?void 0:t.encoding:t;return i=="buffer"?s:s.toString(i??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=Yl(n);r&&await r}}async function iY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Kl(r,await Zl.call(this,e,"r+"),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=Yl(r);s&&await s}}async function aY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Kl(r,await zy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=Yl(r);s&&await s}}async function oY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await Kl(n,await Zl.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Yl(n);r&&await r}}async function lY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await Kl(n,await zy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Yl(n);r&&await r}}async function HP(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Kl(r,await Zl.call(this,e,"r+"),!0).utimes(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=Yl(r);s&&await s}}async function cY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Kl(r,await zy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(s){r.error=s,r.hasError=!0}finally{const s=Yl(r);s&&await s}}async function BC(e,t,n){if(n){const l=Nr(t,e),c=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:c}}try{const l=Nr(t,e),c=await l.fs.stat(l.path);if(!Q0(c))return{...l,fullPath:t,stats:c};const u=Bd.call(e,Yr(t),(await LC.call(e,t)).toString());return await BC(e,u)}catch{}const{base:r,dir:s}=eu(t),i=s=="/"?"/":await Vh.call(e,s),a=is(i,r),o=Nr(a,e);try{const l=await o.fs.stat(o.path);if(!Q0(l))return{...o,fullPath:a,stats:l};const c=Bd.call(e,i,(await LC.call(e,a)).toString());return await BC(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw fs(l,{[o.path]:a})}}async function Vh(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Pn(e);const{fullPath:s}=await BC(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Os.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function W_e(e,t={}){const n=new BK(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let s=!1;n.on("change",(a,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:a,filename:o},done:!1})});function i(){s=!0,n.close();for(const a of r)a({value:null,done:s});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(s)return Promise.resolve({value:null,done:s});const{promise:a,resolve:o}=Promise.withResolvers();return r.push(o),a},return:i,throw:i,async[Symbol.asyncDispose](){await i()},[Symbol.asyncIterator](){return this}}}async function uY(e,t=CP){if(!(await $y.call(this,e)).hasAccess(t,this))throw new Xe(gt.EACCES)}async function GP(e,t){e=Pn(e);const n=await UE.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&Ss){case Ti:if(t!=null&&t.recursive)for(const r of await Lm.call(this,e))await GP.call(this,is(e,r),t);await WP.call(this,e);break;case vc:case Qd:case Mm:case Im:await qE.call(this,e);break;case jm:case Nm:default:throw new Xe(gt.EPERM,"File type not supported",e,"rm")}}async function dY(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await HE.call(this,s),n=="buffer"?Os.from(s):s}async function KP(e,t,n){if(e=Pn(e),t=Pn(t),n&&n&kP&&await g1.call(this,t))throw new Xe(gt.EEXIST,"Destination file already exists",t,"copyFile");await WE.call(this,t,await VE.call(this,e)),xa(this,"rename",t.toString())}function fY(e,t){return e=Pn(e),Promise.resolve(new LP(e,this))}async function YP(e,t,n){e=Pn(e),t=Pn(t);const r=await UE.call(this,e);if(n!=null&&n.errorOnExist&&await g1.call(this,t))throw new Xe(gt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Ss){case Ti:{if(!(n!=null&&n.recursive))throw new Xe(gt.EISDIR,e+" is a directory (not copied)",e,"cp");const[s]=await Promise.all([Lm.call(this,e,{withFileTypes:!0}),HE.call(this,t,{recursive:!0})]),i=async a=>{n.filter&&!n.filter(is(e,a.name),is(t,a.name))||await YP.call(this,is(e,a.name),is(t,a.name),n)};await Promise.all(s.map(i));break}case vc:case Qd:await KP.call(this,e,t);break;case Mm:case Im:case jm:case Nm:default:throw new Xe(gt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await HP.call(this,t,r.atime,r.mtime)}async function hY(e,t){e=Pn(e);const{fs:n}=Nr(e,this);return Promise.resolve(FK(n,t==null?void 0:t.bigint))}function pY(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t||{},i=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*a(o){const l=await Lm(o,{withFileTypes:r,encoding:"utf8"});for(const c of l){const u=r?c.path:o+"/"+c;s(r?c:u)||((await $y(u)).isDirectory()&&i.some(d=>d.source.includes(".*"))&&(yield*a(u)),i.some(d=>d.test(u.replace(/^\/+/g,"")))&&(yield r?c:u.replace(/^\/+/g,"")))}}return a(n)}const H_e=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:La,access:uY,appendFile:nY,chmod:oY,chown:iY,constants:RK,copyFile:KP,cp:YP,exists:g1,glob:pY,lchmod:lY,lchown:aY,link:rY,lstat:UE,lutimes:cY,mkdir:HE,mkdtemp:dY,open:Zl,opendir:fY,readFile:VE,readdir:Lm,readlink:LC,realpath:Vh,rename:eY,rm:GP,rmdir:WP,stat:$y,statfs:hY,symlink:sY,truncate:tY,unlink:qE,utimes:HP,watch:W_e,writeFile:WE},Symbol.toStringTag,{value:"Module"})),pr=()=>{};async function G_e(e){const t=[];for await(const n of e)t.push(n);return t}function K_e(e,t,n=pr){eY.call(this,e,t).then(()=>n()).catch(n)}function Y_e(e,t=pr){g1.call(this,e).then(t).catch(()=>t(!1))}function Z_e(e,t,n=pr){n=typeof t=="function"?t:n,$y.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function X_e(e,t,n=pr){n=typeof t=="function"?t:n,UE.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function J_e(e,t=0,n=pr){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;tY.call(this,e,r).then(()=>n()).catch(n)}function Q_e(e,t=pr){qE.call(this,e).then(()=>t()).catch(t)}function eSe(e,t,n,r=pr){const s=$h(n,420);r=typeof n=="function"?n:r,Zl.call(this,e,t,s).then(i=>r(void 0,i.fd)).catch(r)}function tSe(e,t,n=pr){n=typeof t=="function"?t:n,VE.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function nSe(e,t,n,r=pr){r=typeof n=="function"?n:r,WE.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function rSe(e,t,n,r=pr){const s=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,nY.call(this,e,t,s).then(()=>r()).catch(r)}function sSe(e,t,n=pr){n=typeof t=="function"?t:n,new La(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new Om(r):r)).catch(n)}function iSe(e,t=pr){new La(this,e).close().then(()=>t()).catch(t)}function aSe(e,t,n=pr){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const s=new La(this,e);if(r<0)throw new Xe(gt.EINVAL);s.truncate(r).then(()=>n()).catch(n)}function oSe(e,t=pr){new La(this,e).sync().then(()=>t()).catch(t)}function lSe(e,t=pr){new La(this,e).datasync().then(()=>t()).catch(t)}function cSe(e,t,n,r,s,i=pr){let a,o,l,c,u;const d=new La(this,e);if(typeof t=="string"){switch(u="utf8",typeof n){case"function":i=n;break;case"number":c=n,u=typeof r=="string"?r:"utf8",i=typeof s=="function"?s:i;break;default:i=typeof r=="function"?r:typeof s=="function"?s:i,i(new Xe(gt.EINVAL,"Invalid arguments"));return}a=Os.from(t),o=0,l=a.length;const h=i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a.toString(u))).catch(h)}else{a=Os.from(t.buffer),o=n,l=r,c=typeof s=="number"?s:null;const h=typeof s=="function"?s:i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a)).catch(h)}}function uSe(e,t,n,r,s,i=pr){new La(this,e).read(t,n,r,s).then(({bytesRead:a,buffer:o})=>i(void 0,a,o)).catch(i)}function dSe(e,t,n,r=pr){new La(this,e).chown(t,n).then(()=>r()).catch(r)}function fSe(e,t,n){new La(this,e).chmod(t).then(()=>n()).catch(n)}function hSe(e,t,n,r=pr){new La(this,e).utimes(t,n).then(()=>r()).catch(r)}function pSe(e,t=pr){WP.call(this,e).then(()=>t()).catch(t)}function mSe(e,t,n=pr){HE.call(this,e,t).then(()=>n()).catch(n)}function gSe(e,t,n=pr){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};Lm.call(this,e,r).then(s=>n(void 0,s)).catch(n)}function ySe(e,t,n=pr){rY.call(this,e,t).then(()=>n()).catch(n)}function bSe(e,t,n,r=pr){const s=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,sY.call(this,e,t,s).then(()=>r()).catch(r)}function vSe(e,t,n=pr){n=typeof t=="function"?t:n,LC.call(this,e).then(r=>n(void 0,r)).catch(n)}function xSe(e,t,n,r=pr){iY.call(this,e,t,n).then(()=>r()).catch(r)}function wSe(e,t,n,r=pr){aY.call(this,e,t,n).then(()=>r()).catch(r)}function _Se(e,t,n=pr){oY.call(this,e,t).then(()=>n()).catch(n)}function SSe(e,t,n=pr){lY.call(this,e,t).then(()=>n()).catch(n)}function CSe(e,t,n,r=pr){HP.call(this,e,t,n).then(()=>r()).catch(r)}function kSe(e,t,n,r=pr){cY.call(this,e,t,n).then(()=>r()).catch(r)}function ESe(e,t,n=pr){n=typeof t=="function"?t:n,Vh.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function TSe(e,t,n=pr){const r=typeof t=="number"?t:zi;n=typeof t=="function"?t:n,uY.call(this,e,r).then(()=>n()).catch(n)}const u0=new Map;function ASe(e,t,n){const r=Pn(e),s=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Xe(gt.EINVAL,"No listener specified",e.toString(),"watchFile");if(u0.has(r)){const a=u0.get(r);a&&a.listeners.add(n);return}const i=new p_e(this,r,s);i.on("change",(a,o)=>{const l=u0.get(r);if(l)for(const c of l.listeners)c(a,o)}),u0.set(r,{watcher:i,listeners:new Set})}function RSe(e,t=pr){const n=Pn(e),r=u0.get(n);r&&(t&&t!==pr?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),u0.delete(n)))}function NSe(e,t,n){const r=new BK(this,Pn(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||pr),r}function MSe(e,t){t=typeof t=="object"?t:{encoding:t};const n=Zl.call(this,e,"r",t==null?void 0:t.mode);return new qP({...t,autoClose:!0},n)}function ISe(e,t){t=typeof t=="object"?t:{encoding:t};const n=Zl.call(this,e,"w",t==null?void 0:t.mode);return new VP(t,n)}function jSe(e,t,n=pr){n=typeof t=="function"?t:n,GP.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function OSe(e,t,n=pr){n=typeof t=="function"?t:n,dY.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function PSe(e,t,n,r=pr){r=typeof n=="function"?n:r,KP.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function DSe(e,t,n,r=pr){r=typeof n=="function"?n:r,new La(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesRead:i})=>r(void 0,i,s)).catch(r)}function FSe(e,t,n,r=pr){r=typeof n=="function"?n:r,new La(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesWritten:i})=>r(void 0,i,s)).catch(r)}function LSe(e,t,n=pr){n=typeof t=="function"?t:n,fY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function BSe(e,t,n,r=pr){r=typeof n=="function"?n:r,YP.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function $Se(e,t,n=pr){n=typeof t=="function"?t:n,hY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function zSe(e,t){const n=await Zl.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function USe(e,t,n=pr){n=typeof t=="function"?t:n;const r=pY.call(this,e,typeof t=="function"?void 0:t);G_e(r).then(s=>{var i;return n(null,(i=s)!==null&&i!==void 0?i:[])}).catch(s=>n(s))}var Ep=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Zo=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},qSe=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},$C;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})($C||($C={}));let mY=(()=>{var e,t,n,r,s;let i=[Rm()],a,o=[],l,c,u=[],d=[],h,m=[],y=[],b,v=[],x=[],w,S=[],C=[],k,A=[],R=[],N,I=[],O=[];return l=class{constructor(L=ys(new Xe(gt.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=Zo(this,u,0),this.extsize=(Zo(this,d),Zo(this,m,0)),this.nextents=(Zo(this,y),Zo(this,v,0)),this.projid=(Zo(this,x),Zo(this,S,0)),this.cowextsize=(Zo(this,C),Zo(this,A,0)),this.pad=(Zo(this,R),Zo(this,I,[])),Zo(this,O),this.extsize=L.size,this.nextents=1,this.projid=L.uid,this.cowextsize=L.size;for(const P of Object.keys(_o))L.flags&_o[P]&&P in $C&&(this.xflags|=$C[P])}},qSe(l,"fsxattr"),(()=>{const L=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;c=[(e=Xn).uint32.bind(e)],h=[(t=Xn).uint32.bind(t)],b=[(n=Xn).uint32.bind(n)],w=[(r=Xn).uint32.bind(r)],k=[(s=Xn).uint32.bind(s)],N=[Xn.char(8)],Ep(null,null,c,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:P=>"xflags"in P,get:P=>P.xflags,set:(P,V)=>{P.xflags=V}},metadata:L},u,d),Ep(null,null,h,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:P=>"extsize"in P,get:P=>P.extsize,set:(P,V)=>{P.extsize=V}},metadata:L},m,y),Ep(null,null,b,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:P=>"nextents"in P,get:P=>P.nextents,set:(P,V)=>{P.nextents=V}},metadata:L},v,x),Ep(null,null,w,{kind:"field",name:"projid",static:!1,private:!1,access:{has:P=>"projid"in P,get:P=>P.projid,set:(P,V)=>{P.projid=V}},metadata:L},S,C),Ep(null,null,k,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:P=>"cowextsize"in P,get:P=>P.cowextsize,set:(P,V)=>{P.cowextsize=V}},metadata:L},A,R),Ep(null,null,N,{kind:"field",name:"pad",static:!1,private:!1,access:{has:P=>"pad"in P,get:P=>P.pad,set:(P,V)=>{P.pad=V}},metadata:L},I,O),Ep(null,a={value:l},i,{kind:"class",name:l.name,metadata:L},null,o),l=a.value,L&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:L}),Zo(l,o)})(),l})();var $s;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})($s||($s={}));var hc;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(hc||(hc={}));async function VSe(e,t,...n){e=Pn(e);const{fs:r,path:s}=Nr(e,this);try{const i=new Ci(await r.stat(s));switch(t){case $s.GetFlags:case hc.GetFlags:return i.flags;case $s.SetFlags:case hc.SetFlags:i.flags=n[0],await r.touch(s,i);return;case $s.GetVersion:case hc.GetVersion:return i.version;case $s.SetVersion:case hc.SetVersion:i.version=n[0],await r.touch(s,i);return;case $s.Fiemap:break;case $s.GetXattr:return new mY(i);case $s.SetXattr:break;case $s.GetLabel:return r.label;case $s.SetLabel:r.label=n[0];return;case $s.GetUUID:return r.uuid;case $s.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw fs(i,{[s]:e})}throw new Xe(gt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function WSe(e,t,...n){e=Pn(e);const{fs:r,path:s}=Nr(e,this);try{const i=new Ci(r.statSync(s));switch(t){case $s.GetFlags:case hc.GetFlags:return i.flags;case $s.SetFlags:case hc.SetFlags:i.flags=n[0],r.touchSync(s,i);return;case $s.GetVersion:case hc.GetVersion:return i.version;case $s.SetVersion:case hc.SetVersion:i.version=n[0],r.touchSync(s,i);return;case $s.Fiemap:break;case $s.GetXattr:return new mY(i);case $s.SetXattr:break;case $s.GetLabel:return r.label;case $s.SetLabel:r.label=n[0];return;case $s.GetUUID:return r.uuid;case $s.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw fs(i,{[s]:e})}throw new Xe(gt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const HSe=[];function Uy(e,t,n,r){if(!t.startsWith("user.")&&!HSe.includes(t))throw new Xe(gt.EPERM,"Only attributes in the user namespace are supported",n,r)}async function GSe(e,t,n={}){var r;e=Pn(e);const{fs:s,path:i}=Nr(e,this);Uy(this,t,e,"xattr.get");try{const a=await s.stat(i);if(Ui&&!ds(this,a,zi))throw Xe.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new xh);const o=a.attributes.get(t);if(!o)throw Xe.With("ENODATA",i,"xattr.get");const l=Os.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw fs(a,{[i]:e})}}function KSe(e,t,n={}){var r;e=Pn(e),Uy(this,t,e,"xattr.get");const{fs:s,path:i}=Nr(e,this);try{const a=s.statSync(i);if(Ui&&!ds(this,a,zi))throw Xe.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new xh);const o=a.attributes.get(t);if(!o)throw Xe.With("ENODATA",i,"xattr.get");const l=Os.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw fs(a,{[i]:e})}}async function YSe(e,t,n,r={}){var s;e=Pn(e);const{fs:i,path:a}=Nr(e,this);Uy(this,t,e,"xattr.set");try{const o=await i.stat(a);if(Ui&&!ds(this,o,ai))throw Xe.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new xh);const l=o.attributes.get(t);if(r.create&&l)throw Xe.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Xe.With("ENODATA",a,"xattr.set");o.attributes.set(t,Os.from(n)),await i.touch(a,Am(o,"attributes"))}catch(o){throw fs(o,{[a]:e})}}function ZSe(e,t,n,r={}){var s;e=Pn(e);const{fs:i,path:a}=Nr(e,this);Uy(this,t,e,"xattr.set");try{const o=i.statSync(a);if(Ui&&!ds(this,o,ai))throw Xe.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new xh);const l=o.attributes.get(t);if(r.create&&l)throw Xe.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Xe.With("ENODATA",a,"xattr.set");o.attributes.set(t,Os.from(n)),i.touchSync(a,Am(o,"attributes"))}catch(o){throw fs(o,{[a]:e})}}async function XSe(e,t){var n;e=Pn(e);const{fs:r,path:s}=Nr(e,this);Uy(this,t,e,"xattr.remove");try{const i=await r.stat(s);if(Ui&&!ds(this,i,ai))throw Xe.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new xh),!i.attributes.get(t))throw Xe.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),await r.touch(s,Am(i,"attributes"))}catch(i){throw fs(i,{[s]:e})}}function JSe(e,t){var n;e=Pn(e);const{fs:r,path:s}=Nr(e,this);Uy(this,t,e,"xattr.remove");try{const i=r.statSync(s);if(Ui&&!ds(this,i,ai))throw Xe.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new xh),!i.attributes.get(t))throw Xe.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),r.touchSync(s,Am(i,"attributes"))}catch(i){throw fs(i,{[s]:e})}}async function QSe(e){e=Pn(e);const{fs:t,path:n}=Nr(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw fs(r,{[n]:e})}}function e2e(e){e=Pn(e);const{fs:t,path:n}=Nr(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw fs(r,{[n]:e})}}const t2e=Object.freeze(Object.defineProperty({__proto__:null,get:GSe,getSync:KSe,list:QSe,listSync:e2e,remove:XSe,removeSync:JSe,set:YSe,setSync:ZSe},Symbol.toStringTag,{value:"Module"})),la=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:Z1e,Dir:LP,Dirent:ew,get IOC(){return $s},get IOC32(){return hc},ReadStream:qP,Stats:ef,StatsFs:Y1e,WriteStream:VP,access:TSe,accessSync:j_e,appendFile:rSe,appendFileSync:v_e,chmod:_Se,chmodSync:N_e,chown:xSe,chownSync:A_e,chroot:f_e,close:iSe,closeSync:Dm,constants:RK,copyFile:PSe,copyFileSync:VK,cp:BSe,cpSync:WK,createReadStream:MSe,createWriteStream:ISe,exists:Y_e,existsSync:RP,fchmod:fSe,fchmodSync:PP,fchown:dSe,fchownSync:OP,fdatasync:lSe,fdatasyncSync:S_e,fstat:sSe,fstatSync:x_e,fsync:oSe,fsyncSync:__e,ftruncate:aSe,ftruncateSync:w_e,futimes:hSe,futimesSync:DP,glob:USe,globSync:B_e,ioctl:VSe,ioctlSync:WSe,lchmod:SSe,lchmodSync:M_e,lchown:wSe,lchownSync:R_e,link:ySe,linkSync:E_e,lopenSync:FE,lstat:X_e,lstatSync:NP,lutimes:kSe,lutimesSync:I_e,mkdir:mSe,mkdirSync:FP,mkdtemp:OSe,mkdtempSync:O_e,mount:AP,open:eSe,openAsBlob:zSe,openSync:DE,opendir:LSe,opendirSync:F_e,promises:H_e,read:uSe,readFile:tSe,readFileSync:IP,readSync:k_e,readdir:gSe,readdirSync:Ly,readlink:vSe,readlinkSync:xj,readv:DSe,readvSync:P_e,realpath:ESe,realpathSync:zh,rename:K_e,renameSync:y_e,rm:jSe,rmSync:qK,rmdir:pSe,rmdirSync:zK,stat:Z_e,statSync:wh,statfs:$Se,statfsSync:L_e,symlink:bSe,symlinkSync:T_e,truncate:J_e,truncateSync:b_e,umount:DK,unlink:Q_e,unlinkSync:MP,unwatchFile:RSe,utimes:CSe,utimesSync:UK,watch:NSe,watchFile:ASe,write:cSe,writeFile:nSe,writeFileSync:jP,writeSync:C_e,writev:FSe,writevSync:D_e,xattr:t2e},Symbol.toStringTag,{value:"Module"}));function _9(e){return bK(e)||SP(e)||e instanceof TP}async function gY(e,t=0){if(typeof e!="object"||e==null)throw wo(new Xe(gt.EINVAL,"Invalid options on mount configuration"));if(!_9(e))throw wo(new Xe(gt.EINVAL,"Invalid mount configuration"));if(e instanceof TP)return await e.ready(),e;SP(e)&&(e={backend:e});for(const[s,i]of Object.entries(e))if(s!="backend"&&_9(i)){if(yK("Resolving nested mount configuration: "+s),t>10)throw wo(new Xe(gt.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[s]=await gY(i,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw wo(new Xe(gt.EPERM,"Backend not available: "+n.name));I1e(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function n2e(e){if(!bK(e))throw new TypeError("Invalid single mount point configuration");const t=await gY(e);DK("/"),AP("/",t)}const r2e=["delete"];Math.max(...r2e.map(e=>e.length));M1e("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const yY=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;yY[e]=t}function s2e(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^yY[(t^e[n])&255];return(t^4294967295)>>>0}var Bs=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},or=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},ZP=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let S9=(()=>{var e,t,n,r;let s=[Rm()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[];return o=class{constructor(){this.id=or(this,c,0),this.offset_=(or(this,u),or(this,h,0)),this.offset=(or(this,m),or(this,b,0)),this.size=(or(this,v),or(this,w,0)),or(this,S)}},ZP(o,"MetadataEntry"),(()=>{const C=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=Xn).uint32.bind(e)],d=[(t=Xn).uint32.bind(t)],y=[(n=Xn).uint32.bind(n)],x=[(r=Xn).uint32.bind(r)],Bs(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:k=>"id"in k,get:k=>k.id,set:(k,A)=>{k.id=A}},metadata:C},c,u),Bs(null,null,d,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:k=>"offset_"in k,get:k=>k.offset_,set:(k,A)=>{k.offset_=A}},metadata:C},h,m),Bs(null,null,y,{kind:"field",name:"offset",static:!1,private:!1,access:{has:k=>"offset"in k,get:k=>k.offset,set:(k,A)=>{k.offset=A}},metadata:C},b,v),Bs(null,null,x,{kind:"field",name:"size",static:!1,private:!1,access:{has:k=>"size"in k,get:k=>k.size,set:(k,A)=>{k.size=A}},metadata:C},w,S),Bs(null,i={value:o},s,{kind:"class",name:o.name,metadata:C},null,a),o=i.value,C&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:C}),or(o,a)})(),o})();const C9=255;let Tp=(()=>{var e,t,n,r;let s=[Rm()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[],C,k=[],A=[];var R=o=class{constructor(N=ys(new Xe(gt.EINVAL,"Metadata block must be initialized with a superblock")),I=0){if(this.superblock=N,this.offset=I,this.checksum=or(this,c,0),this.timestamp=(or(this,u),or(this,h,Date.now())),this.previous_offset_=(or(this,m),or(this,b,0)),this.previous_offset=(or(this,v),or(this,w,0)),this._previous=or(this,S),this.entries=or(this,k,Array.from({length:C9},()=>new S9)),or(this,A),this.superblock=N,this.offset=I,!!I&&(NE(this,N.store._buffer.subarray(I,I+zs(R))),!bY(this)))throw ME(new Xe(gt.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+I.toString(16)))}get previous(){var N;if(this.previous_offset)return(N=this._previous)!==null&&N!==void 0||(this._previous=new R(this.superblock,this.previous_offset)),this._previous}};return ZP(o,"MetadataBlock"),(()=>{const N=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=Xn).uint32.bind(e)],d=[(t=Xn).uint32.bind(t)],y=[(n=Xn).uint32.bind(n)],x=[(r=Xn).uint32.bind(r)],C=[Zx(S9,C9)],Bs(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:I=>"checksum"in I,get:I=>I.checksum,set:(I,O)=>{I.checksum=O}},metadata:N},c,u),Bs(null,null,d,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:I=>"timestamp"in I,get:I=>I.timestamp,set:(I,O)=>{I.timestamp=O}},metadata:N},h,m),Bs(null,null,y,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:I=>"previous_offset_"in I,get:I=>I.previous_offset_,set:(I,O)=>{I.previous_offset_=O}},metadata:N},b,v),Bs(null,null,x,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:I=>"previous_offset"in I,get:I=>I.previous_offset,set:(I,O)=>{I.previous_offset=O}},metadata:N},w,S),Bs(null,null,C,{kind:"field",name:"entries",static:!1,private:!1,access:{has:I=>"entries"in I,get:I=>I.entries,set:(I,O)=>{I.entries=O}},metadata:N},k,A),Bs(null,i={value:o},s,{kind:"class",name:o.name,metadata:N},null,a),R=o=i.value,N&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:N}),or(o,a)})(),R=o})();const k9=2049864546;(()=>{var e,t,n,r,s,i,a,o,l,c,u;let d=[Rm()],h,m=[],y,b,v=[],x=[],w,S=[],C=[],k,A=[],R=[],N,I=[],O=[],L,P=[],V=[],F,X=[],U=[],H,$=[],ne=[],W,Q=[],ee=[],se,pe=[],ce=[],Ie,De=[],Se=[],Ce,qe=[],Qe=[],Ve,Ne=[],K=[],me,Ae=[],le=[];var oe=y=class{constructor(re=ys(new Xe(gt.EINVAL,"Super block must be initialized with a store"))){if(this.store=re,this.checksum=or(this,v,0),this.magic=(or(this,x),or(this,S,k9)),this.version=(or(this,C),or(this,A,1)),this.inode_format=(or(this,R),or(this,I,J1e)),this.flags=(or(this,O),or(this,P,0)),this.used_bytes=(or(this,V),or(this,X,BigInt(0))),this.total_bytes=(or(this,U),or(this,$,BigInt(0))),this.uuid=(or(this,ne),or(this,Q,BigInt(0))),this.metadata_block_size=(or(this,ee),or(this,pe,zs(Tp))),this.metadata_offset_=(or(this,ce),or(this,De,0)),this.metadata_offset=(or(this,Se),or(this,qe,0)),this.metadata=or(this,Qe),this.label=or(this,Ne,""),this._padding=(or(this,K),or(this,Ae,new Array(132).fill(0))),or(this,le),this.store=re,re._view.getUint32(m1e(oe,"magic"),!0)!=k9){Oa("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new Tp(this),this.metadata.offset=zs(oe),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(zs(oe)+zs(Tp)),this.total_bytes=BigInt(re._buffer.byteLength),re._write(this),re._write(this.metadata);return}if(NE(this,re._buffer.subarray(0,zs(oe))),!bY(this))throw ME(new Xe(gt.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new Tp(this,this.metadata_offset)}rotateMetadata(){const re=new Tp(this);return re.offset=Number(this.used_bytes),re.previous_offset=this.metadata_offset,this.metadata=re,this.metadata_offset=re.offset,this.store._write(re),this.used_bytes+=BigInt(zs(Tp)),this.store._write(this),re}isUnused(re,Te){if(!Te)return!0;if(re+Te>this.total_bytes||re<zs(oe))return!1;for(let Be=this.metadata;Be;Be=Be.previous){if(re<Be.offset+zs(Tp)&&re+Te>Be.offset)return!1;for(const ke of Be.entries)if(ke.offset&&(re>=ke.offset&&re<ke.offset+ke.size||re+Te>ke.offset&&re+Te<=ke.offset+ke.size||re<=ke.offset&&re+Te>=ke.offset+ke.size))return!1}return!0}};return ZP(y,"SuperBlock"),(()=>{const re=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;b=[(e=Xn).uint32.bind(e)],w=[(t=Xn).uint32.bind(t)],k=[(n=Xn).uint16.bind(n)],N=[(r=Xn).uint16.bind(r)],L=[(s=Xn).uint32.bind(s)],F=[(i=Xn).uint64.bind(i)],H=[(a=Xn).uint64.bind(a)],W=[(o=Xn).uint128.bind(o)],se=[(l=Xn).uint32.bind(l)],Ie=[(c=Xn).uint32.bind(c)],Ce=[(u=Xn).uint32.bind(u)],Ve=[Xn.char(64)],me=[Xn.char(132)],Bs(null,null,b,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:Te=>"checksum"in Te,get:Te=>Te.checksum,set:(Te,Be)=>{Te.checksum=Be}},metadata:re},v,x),Bs(null,null,w,{kind:"field",name:"magic",static:!1,private:!1,access:{has:Te=>"magic"in Te,get:Te=>Te.magic,set:(Te,Be)=>{Te.magic=Be}},metadata:re},S,C),Bs(null,null,k,{kind:"field",name:"version",static:!1,private:!1,access:{has:Te=>"version"in Te,get:Te=>Te.version,set:(Te,Be)=>{Te.version=Be}},metadata:re},A,R),Bs(null,null,N,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:Te=>"inode_format"in Te,get:Te=>Te.inode_format,set:(Te,Be)=>{Te.inode_format=Be}},metadata:re},I,O),Bs(null,null,L,{kind:"field",name:"flags",static:!1,private:!1,access:{has:Te=>"flags"in Te,get:Te=>Te.flags,set:(Te,Be)=>{Te.flags=Be}},metadata:re},P,V),Bs(null,null,F,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:Te=>"used_bytes"in Te,get:Te=>Te.used_bytes,set:(Te,Be)=>{Te.used_bytes=Be}},metadata:re},X,U),Bs(null,null,H,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:Te=>"total_bytes"in Te,get:Te=>Te.total_bytes,set:(Te,Be)=>{Te.total_bytes=Be}},metadata:re},$,ne),Bs(null,null,W,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:Te=>"uuid"in Te,get:Te=>Te.uuid,set:(Te,Be)=>{Te.uuid=Be}},metadata:re},Q,ee),Bs(null,null,se,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:Te=>"metadata_block_size"in Te,get:Te=>Te.metadata_block_size,set:(Te,Be)=>{Te.metadata_block_size=Be}},metadata:re},pe,ce),Bs(null,null,Ie,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:Te=>"metadata_offset_"in Te,get:Te=>Te.metadata_offset_,set:(Te,Be)=>{Te.metadata_offset_=Be}},metadata:re},De,Se),Bs(null,null,Ce,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:Te=>"metadata_offset"in Te,get:Te=>Te.metadata_offset,set:(Te,Be)=>{Te.metadata_offset=Be}},metadata:re},qe,Qe),Bs(null,null,Ve,{kind:"field",name:"label",static:!1,private:!1,access:{has:Te=>"label"in Te,get:Te=>Te.label,set:(Te,Be)=>{Te.label=Be}},metadata:re},Ne,K),Bs(null,null,me,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:Te=>"_padding"in Te,get:Te=>Te._padding,set:(Te,Be)=>{Te._padding=Be}},metadata:re},Ae,le),Bs(null,h={value:y},d,{kind:"class",name:y.name,metadata:re},null,m),oe=y=h.value,re&&Object.defineProperty(y,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:re}),or(y,m)})(),oe=y})();function bY(e){const t=ma(e),n=s2e(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=la;function i2e(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function _j(e,t,n){if(e instanceof Xe)return e;const r=e instanceof DOMException?gt[i2e(e)]:gt.EIO,s=new Xe(r,e.message,t,n);return s.stack=e.stack,s.cause=e.cause,s}function d0(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(_j(e.error))}})}class a2e extends vj{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await d0(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await d0(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await d0(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),d0(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(_j(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(_j(this.tx.error)),this.tx.abort(),t}}async function o2e(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(Oa("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await d0(n)}class l2e{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new a2e(t,this)}}const c2e={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await d0(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await o2e(e.storeName||"zenfs",e.idbFactory),n=new l2e(t),r=new jK(n);if(e!=null&&e.disableAsyncCache)return _P("Async preloading disabled for IndexedDB"),r;const s=n.transaction();for(const i of await s.keys())await s.get(i);return r}},u2e=c2e,dn={vfsKeyChanged:"vfs.key.changed",nodesUpdated:"vfs.nodes.updated",selectionChanged:"vfs.selection.changed",loadingStateChanged:"vfs.loading.state.changed",fsInstanceChanged:"vfs.instance.changed",vfsEnabledChanged:"vfs.enabled.changed",fileWritten:"vfs.sdk.fileWritten",fileRead:"vfs.sdk.fileRead",fileDeleted:"vfs.sdk.fileDeleted",setVfsKeyRequest:"vfs.set.vfs.key.request",initializeVFSRequest:"vfs.initialize.vfs.request",fetchNodesRequest:"vfs.fetch.nodes.request",setCurrentPathRequest:"vfs.set.current.path.request",createDirectoryRequest:"vfs.create.directory.request",uploadFilesRequest:"vfs.upload.files.request",deleteNodesRequest:"vfs.delete.nodes.request",renameNodeRequest:"vfs.rename.node.request",downloadFileRequest:"vfs.download.file.request",selectFileRequest:"vfs.select.file.request",deselectFileRequest:"vfs.deselect.file.request",clearSelectionRequest:"vfs.clear.selection.request",setEnableVfsRequest:"vfs.set.enable.vfs.request"};function IS(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var CM={exports:{}},E9;function d2e(){return E9||(E9=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,s,i){function a(c,u){if(!s[c]){if(!r[c]){var d=typeof IS=="function"&&IS;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var m=s[c]={exports:{}};r[c][0].call(m.exports,function(y){var b=r[c][1][y];return a(b||y)},m,m.exports,n,r,s,i)}return s[c].exports}for(var o=typeof IS=="function"&&IS,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(n,r,s){var i=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,d,h,m,y,b,v=[],x=0,w=l.length,S=w,C=i.getTypeOf(l)!=="string";x<l.length;)S=w-x,d=C?(c=l[x++],u=x<w?l[x++]:0,x<w?l[x++]:0):(c=l.charCodeAt(x++),u=x<w?l.charCodeAt(x++):0,x<w?l.charCodeAt(x++):0),h=c>>2,m=(3&c)<<4|u>>4,y=1<S?(15&u)<<2|d>>6:64,b=2<S?63&d:64,v.push(o.charAt(h)+o.charAt(m)+o.charAt(y)+o.charAt(b));return v.join("")},s.decode=function(l){var c,u,d,h,m,y,b=0,v=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var w,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|S):new Array(0|S);b<l.length;)c=o.indexOf(l.charAt(b++))<<2|(h=o.indexOf(l.charAt(b++)))>>4,u=(15&h)<<4|(m=o.indexOf(l.charAt(b++)))>>2,d=(3&m)<<6|(y=o.indexOf(l.charAt(b++))),w[v++]=c,m!==64&&(w[v++]=u),y!==64&&(w[v++]=d);return w}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,h,m,y){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=m,this.compressedContent=y}c.prototype={getContentWorker:function(){var u=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u[b])];return-1^c}(0|l,o,o.length,0):function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u.charCodeAt(b))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),c=i?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}s.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},s.compressWorker=function(d){return new u("Deflate",d)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(m,y){var b,v="";for(b=0;b<y;b++)v+=String.fromCharCode(255&m),m>>>=8;return v}function a(m,y,b,v,x,w){var S,C,k=m.file,A=m.compression,R=w!==c.utf8encode,N=o.transformTo("string",w(k.name)),I=o.transformTo("string",c.utf8encode(k.name)),O=k.comment,L=o.transformTo("string",w(O)),P=o.transformTo("string",c.utf8encode(O)),V=I.length!==k.name.length,F=P.length!==O.length,X="",U="",H="",$=k.dir,ne=k.date,W={crc32:0,compressedSize:0,uncompressedSize:0};y&&!b||(W.crc32=m.crc32,W.compressedSize=m.compressedSize,W.uncompressedSize=m.uncompressedSize);var Q=0;y&&(Q|=8),R||!V&&!F||(Q|=2048);var ee=0,se=0;$&&(ee|=16),x==="UNIX"?(se=798,ee|=function(ce,Ie){var De=ce;return ce||(De=Ie?16893:33204),(65535&De)<<16}(k.unixPermissions,$)):(se=20,ee|=function(ce){return 63&(ce||0)}(k.dosPermissions)),S=ne.getUTCHours(),S<<=6,S|=ne.getUTCMinutes(),S<<=5,S|=ne.getUTCSeconds()/2,C=ne.getUTCFullYear()-1980,C<<=4,C|=ne.getUTCMonth()+1,C<<=5,C|=ne.getUTCDate(),V&&(U=i(1,1)+i(u(N),4)+I,X+="up"+i(U.length,2)+U),F&&(H=i(1,1)+i(u(L),4)+P,X+="uc"+i(H.length,2)+H);var pe="";return pe+=`
\0`,pe+=i(Q,2),pe+=A.magic,pe+=i(S,2),pe+=i(C,2),pe+=i(W.crc32,4),pe+=i(W.compressedSize,4),pe+=i(W.uncompressedSize,4),pe+=i(N.length,2),pe+=i(X.length,2),{fileRecord:d.LOCAL_FILE_HEADER+pe+N+X,dirRecord:d.CENTRAL_FILE_HEADER+i(se,2)+pe+i(L.length,2)+"\0\0\0\0"+i(ee,4)+i(v,4)+N+X+L}}var o=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function h(m,y,b,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=b,this.encodeFileName=v,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(m){var y=m.meta.percent||0,b=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,l.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:b?(y+100*(b-v-1))/b:100}}))},h.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var y=this.streamFiles&&!m.file.dir;if(y){var b=a(m,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(m){this.accumulate=!1;var y=this.streamFiles&&!m.file.dir,b=a(m,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),y)this.push({data:function(v){return d.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var m=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var b=this.bytesWritten-m,v=function(x,w,S,C,k){var A=o.transformTo("string",k(C));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(x,2)+i(x,2)+i(w,4)+i(S,4)+i(A.length,2)+A}(this.dirRecords.length,b,m,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(m){this._sources.push(m);var y=this;return m.on("data",function(b){y.processChunk(b)}),m.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),m.on("error",function(b){y.error(b)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(m){var y=this._sources;if(!l.prototype.error.call(this,m))return!1;for(var b=0;b<y.length;b++)try{y[b].error(m)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var m=this._sources,y=0;y<m.length;y++)m[y].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),a=n("./ZipFileWorker");s.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,m){d++;var y=function(w,S){var C=w||S,k=i[C];if(!k)throw new Error(C+" is not a valid compression method !");return k}(m.options.compression,l.compression),b=m.options.compressionOptions||l.compressionOptions||{},v=m.dir,x=m.date;m._compressWorker(y,b).withStreamInfo("file",{name:h,dir:v,date:x,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,o){return new i().loadAsync(a,o)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),a=n("./external"),o=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(h){return new a.Promise(function(m,y){var b=h.decompressed.getContentWorker().pipe(new c);b.on("error",function(v){y(v)}).on("end",function(){b.streamInfo.crc32!==h.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(h,m){var y=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,m.optimizedBinaryString,m.base64).then(function(b){var v=new l(m);return v.load(b),v}).then(function(b){var v=[a.Promise.resolve(b)],x=b.files;if(m.checkCRC32)for(var w=0;w<x.length;w++)v.push(d(x[w]));return a.Promise.all(v)}).then(function(b){for(var v=b.shift(),x=v.files,w=0;w<x.length;w++){var S=x[w],C=S.fileNameStr,k=i.resolve(S.fileNameStr);y.file(k,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:m.createFolders}),S.dir||(y.file(k).unsafeOriginalName=C)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),a=n("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function a(o,l,c){i.call(this,l),this._helper=o;var u=this;o.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof on<"u",newBufferFrom:function(i,a){if(on.from&&on.from!==Uint8Array.from)return on.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new on(i,a)},allocBuffer:function(i){if(on.alloc)return on.alloc(i);var a=new on(i);return a.fill(0),a},isBuffer:function(i){return on.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(k,A,R){var N,I=o.getTypeOf(A),O=o.extend(R||{},u);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(k=x(k)),O.createFolders&&(N=v(k))&&w.call(this,N,!0);var L=I==="string"&&O.binary===!1&&O.base64===!1;R&&R.binary!==void 0||(O.binary=!L),(A instanceof d&&A.uncompressedSize===0||O.dir||!A||A.length===0)&&(O.base64=!1,O.binary=!0,A="",O.compression="STORE",I="string");var P=null;P=A instanceof d||A instanceof l?A:y.isNode&&y.isStream(A)?new b(k,A):o.prepareContent(k,A,O.binary,O.optimizedBinaryString,O.base64);var V=new h(k,P,O);this.files[k]=V}var a=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),h=n("./zipObject"),m=n("./generate"),y=n("./nodejsUtils"),b=n("./nodejs/NodejsStreamInputAdapter"),v=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var A=k.lastIndexOf("/");return 0<A?k.substring(0,A):""},x=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},w=function(k,A){return A=A!==void 0?A:u.createFolders,k=x(k),this.files[k]||i.call(this,k,null,{dir:!0,createFolders:A}),this.files[k]};function S(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var A,R,N;for(A in this.files)N=this.files[A],(R=A.slice(this.root.length,A.length))&&A.slice(0,this.root.length)===this.root&&k(R,N)},filter:function(k){var A=[];return this.forEach(function(R,N){k(R,N)&&A.push(N)}),A},file:function(k,A,R){if(arguments.length!==1)return k=this.root+k,i.call(this,k,A,R),this;if(S(k)){var N=k;return this.filter(function(O,L){return!L.dir&&N.test(O)})}var I=this.files[this.root+k];return I&&!I.dir?I:null},folder:function(k){if(!k)return this;if(S(k))return this.filter(function(I,O){return O.dir&&k.test(I)});var A=this.root+k,R=w.call(this,A),N=this.clone();return N.root=R.name,N},remove:function(k){k=this.root+k;var A=this.files[k];if(A||(k.slice(-1)!=="/"&&(k+="/"),A=this.files[k]),A&&!A.dir)delete this.files[k];else for(var R=this.filter(function(I,O){return O.name.slice(0,k.length)===k}),N=0;N<R.length;N++)delete this.files[R[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var A,R={};try{if((R=o.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");o.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var N=R.comment||this.comment||"";A=m.generateWorker(this,R,N)}catch(I){(A=new l("error")).error(I)}return new c(A,R.type||"string",R.mimeType)},generateAsync:function(k,A){return this.generateInternalStream(k).accumulate(A)},generateNodeStream:function(k,A){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(A)}};r.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),a=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var h=i.getTypeOf(d);return i.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new u(i.transformTo("uint8array",d)):new o(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),a=n("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),a=n("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(y,b){return new u.Promise(function(v,x){var w=[],S=y._internalType,C=y._outputType,k=y._mimeType;y.on("data",function(A,R){w.push(A),b&&b(R)}).on("error",function(A){w=[],x(A)}).on("end",function(){try{var A=function(R,N,I){switch(R){case"blob":return i.newBlob(i.transformTo("arraybuffer",N),I);case"base64":return l.encode(N);default:return i.transformTo(R,N)}}(C,function(R,N){var I,O=0,L=null,P=0;for(I=0;I<N.length;I++)P+=N[I].length;switch(R){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(L=new Uint8Array(P),I=0;I<N.length;I++)L.set(N[I],O),O+=N[I].length;return L;case"nodebuffer":return on.concat(N);default:throw new Error("concat : unsupported type '"+R+"'")}}(S,w),k);v(A)}catch(R){x(R)}w=[]}).resume()})}function m(y,b,v){var x=b;switch(b){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=b,this._mimeType=v,i.checkSupport(x),this._worker=y.pipe(new a(x)),y.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}m.prototype={accumulate:function(y){return h(this,y)},on:function(y,b){var v=this;return y==="data"?this._worker.on(y,function(x){b.call(v,x.data,x.meta)}):this._worker.on(y,function(){i.delay(b,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof on<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}s.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):function(y){var b,v,x,w,S,C=y.length,k=0;for(w=0;w<C;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<C&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),k+=v<128?1:v<2048?2:v<65536?3:4;for(b=a.uint8array?new Uint8Array(k):new Array(k),w=S=0;S<k;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<C&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),v<128?b[S++]=v:(v<2048?b[S++]=192|v>>>6:(v<65536?b[S++]=224|v>>>12:(b[S++]=240|v>>>18,b[S++]=128|v>>>12&63),b[S++]=128|v>>>6&63),b[S++]=128|63&v);return b}(m)},s.utf8decode=function(m){return a.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):function(y){var b,v,x,w,S=y.length,C=new Array(2*S);for(b=v=0;b<S;)if((x=y[b++])<128)C[v++]=x;else if(4<(w=c[x]))C[v++]=65533,b+=w-1;else{for(x&=w===2?31:w===3?15:7;1<w&&b<S;)x=x<<6|63&y[b++],w--;1<w?C[v++]=65533:x<65536?C[v++]=x:(x-=65536,C[v++]=55296|x>>10&1023,C[v++]=56320|1023&x)}return C.length!==v&&(C.subarray?C=C.subarray(0,v):C.length=v),i.applyFromCharCode(C)}(m=i.transformTo(a.uint8array?"uint8array":"array",m))},i.inherits(d,l),d.prototype.processChunk=function(m){var y=i.transformTo(a.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=y;(y=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),y.set(b,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(w,S){var C;for((S=S||w.length)>w.length&&(S=w.length),C=S-1;0<=C&&(192&w[C])==128;)C--;return C<0||C===0?S:C+c[w[C]]>S?C:S}(y),x=y;v!==y.length&&(a.uint8array?(x=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(x=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:s.utf8decode(x),meta:m.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=d,i.inherits(h,l),h.prototype.processChunk=function(m){this.push({data:s.utf8encode(m.data),meta:m.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function c(b){return b}function u(b,v){for(var x=0;x<b.length;++x)v[x]=255&b.charCodeAt(x);return v}n("setimmediate"),s.newBlob=function(b,v){s.checkSupport("blob");try{return new Blob([b],{type:v})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(b),x.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(b,v,x){var w=[],S=0,C=b.length;if(C<=x)return String.fromCharCode.apply(null,b);for(;S<C;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,b.slice(S,Math.min(S+x,C)))):w.push(String.fromCharCode.apply(null,b.subarray(S,Math.min(S+x,C)))),S+=x;return w.join("")},stringifyByChar:function(b){for(var v="",x=0;x<b.length;x++)v+=String.fromCharCode(b[x]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function h(b){var v=65536,x=s.getTypeOf(b),w=!0;if(x==="uint8array"?w=d.applyCanBeUsed.uint8array:x==="nodebuffer"&&(w=d.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return d.stringifyByChunk(b,x,v)}catch{v=Math.floor(v/2)}return d.stringifyByChar(b)}function m(b,v){for(var x=0;x<b.length;x++)v[x]=b[x];return v}s.applyFromCharCode=h;var y={};y.string={string:c,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return y.string.uint8array(b).buffer},uint8array:function(b){return u(b,new Uint8Array(b.length))},nodebuffer:function(b){return u(b,o.allocBuffer(b.length))}},y.array={string:h,array:c,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(b)}},y.arraybuffer={string:function(b){return h(new Uint8Array(b))},array:function(b){return m(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(new Uint8Array(b))}},y.uint8array={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return o.newBufferFrom(b)}},y.nodebuffer={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return y.nodebuffer.uint8array(b).buffer},uint8array:function(b){return m(b,new Uint8Array(b.length))},nodebuffer:c},s.transformTo=function(b,v){if(v=v||"",!b)return v;s.checkSupport(b);var x=s.getTypeOf(v);return y[x][b](v)},s.resolve=function(b){for(var v=b.split("/"),x=[],w=0;w<v.length;w++){var S=v[w];S==="."||S===""&&w!==0&&w!==v.length-1||(S===".."?x.pop():x.push(S))}return x.join("/")},s.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(b)?"nodebuffer":i.uint8array&&b instanceof Uint8Array?"uint8array":i.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(b){if(!i[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(b){var v,x,w="";for(x=0;x<(b||"").length;x++)w+="\\x"+((v=b.charCodeAt(x))<16?"0":"")+v.toString(16).toUpperCase();return w},s.delay=function(b,v,x){setImmediate(function(){b.apply(x||null,v||[])})},s.inherits=function(b,v){function x(){}x.prototype=v.prototype,b.prototype=new x},s.extend=function(){var b,v,x={};for(b=0;b<arguments.length;b++)for(v in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],v)&&x[v]===void 0&&(x[v]=arguments[b][v]);return x},s.prepareContent=function(b,v,x,w,S){return l.Promise.resolve(v).then(function(C){return i.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new l.Promise(function(k,A){var R=new FileReader;R.onload=function(N){k(N.target.result)},R.onerror=function(N){A(N.target.error)},R.readAsArrayBuffer(C)}):C}).then(function(C){var k=s.getTypeOf(C);return k?(k==="arraybuffer"?C=s.transformTo("uint8array",C):k==="string"&&(S?C=a.decode(C):x&&w!==!0&&(C=function(A){return u(A,i.uint8array?new Uint8Array(A.length):new Array(A.length))}(C))),C):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var m=this.reader.index;this.reader.setIndex(d);var y=this.reader.readString(4)===h;return this.reader.setIndex(m),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",m=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,m,y=this.zip64EndOfCentralSize-44;0<y;)d=this.reader.readInt(2),h=this.reader.readInt(4),m=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var y=h-m;if(0<y)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function h(m,y){this.options=m,this.loadOptions=y}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var y,b;if(m.skip(22),this.fileNameLength=m.readInt(2),b=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var x in u)if(Object.prototype.hasOwnProperty.call(u,x)&&u[x].magic===v)return u[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,y,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var y=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(y),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var y,b,v,x=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<x;)y=m.readInt(2),b=m.readInt(2),v=m.readData(b),this.extraFields[y]={id:y,length:b,value:v};m.setIndex(x)},handleUTF8:function(){var m=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var b=a.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var x=a.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(y,b,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=b,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");i.prototype={internalStream:function(y){var b=null,v="string";try{if(!y)throw new Error("No output type specified.");var x=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),b=this._decompressWorker();var w=!this._dataBinary;w&&!x&&(b=b.pipe(new l.Utf8EncodeWorker)),!w&&x&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(S){(b=new u("error")).error(S)}return new a(b,v,"")},async:function(y,b){return this.internalStream(y).accumulate(b)},nodeStream:function(y,b){return this.internalStream(y||"nodebuffer").toNodejsStream(b)},_compressWorker:function(y,b){if(this._data instanceof c&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(v,y,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<d.length;m++)i.prototype[d[m]]=h;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var a,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(y),d=i.document.createTextNode("");u.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var b=i.document.createElement("script");b.onreadystatechange=function(){y(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:function(){setTimeout(y,0)};else{var h=new i.MessageChannel;h.port1.onmessage=y,a=function(){h.port2.postMessage(0)}}var m=[];function y(){var b,v;o=!0;for(var x=m.length;x;){for(v=m,m=[],b=-1;++b<x;)v[b]();x=m.length}o=!1}r.exports=function(b){m.push(b)!==1||o||a()}}).call(this,typeof zp<"u"?zp:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,x!==a&&b(this,x)}function h(x,w,S){this.promise=x,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function m(x,w,S){i(function(){var C;try{C=w(S)}catch(k){return o.reject(x,k)}C===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,C)})}function y(x){var w=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof w=="function")return function(){w.apply(x,arguments)}}function b(x,w){var S=!1;function C(R){S||(S=!0,o.reject(x,R))}function k(R){S||(S=!0,o.resolve(x,R))}var A=v(function(){w(k,C)});A.status==="error"&&C(A.value)}function v(x,w){var S={};try{S.value=x(w),S.status="success"}catch(C){S.status="error",S.value=C}return S}(r.exports=d).prototype.finally=function(x){if(typeof x!="function")return this;var w=this.constructor;return this.then(function(S){return w.resolve(x()).then(function(){return S})},function(S){return w.resolve(x()).then(function(){throw S})})},d.prototype.catch=function(x){return this.then(null,x)},d.prototype.then=function(x,w){if(typeof x!="function"&&this.state===c||typeof w!="function"&&this.state===l)return this;var S=new this.constructor(a);return this.state!==u?m(S,this.state===c?x:w,this.outcome):this.queue.push(new h(S,x,w)),S},h.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},h.prototype.otherCallFulfilled=function(x){m(this.promise,this.onFulfilled,x)},h.prototype.callRejected=function(x){o.reject(this.promise,x)},h.prototype.otherCallRejected=function(x){m(this.promise,this.onRejected,x)},o.resolve=function(x,w){var S=v(y,w);if(S.status==="error")return o.reject(x,S.value);var C=S.value;if(C)b(x,C);else{x.state=c,x.outcome=w;for(var k=-1,A=x.queue.length;++k<A;)x.queue[k].callFulfilled(w)}return x},o.reject=function(x,w){x.state=l,x.outcome=w;for(var S=-1,C=x.queue.length;++S<C;)x.queue[S].callRejected(w);return x},d.resolve=function(x){return x instanceof this?x:o.resolve(new this(a),x)},d.reject=function(x){var w=new this(a);return o.reject(w,x)},d.all=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,C=!1;if(!S)return this.resolve([]);for(var k=new Array(S),A=0,R=-1,N=new this(a);++R<S;)I(x[R],R);return N;function I(O,L){w.resolve(O).then(function(P){k[L]=P,++A!==S||C||(C=!0,o.resolve(N,k))},function(P){C||(C=!0,o.reject(N,P))})}},d.race=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,C=!1;if(!S)return this.resolve([]);for(var k=-1,A=new this(a);++k<S;)R=x[k],w.resolve(R).then(function(N){C||(C=!0,o.resolve(A,N))},function(N){C||(C=!0,o.reject(A,N))});var R;return A}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,m=0,y=8;function b(x){if(!(this instanceof b))return new b(x);this.options=a.assign({level:h,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},x||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(S!==d)throw new Error(l[S]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var C;if(C=typeof w.dictionary=="string"?o.string2buf(w.dictionary):u.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(S=i.deflateSetDictionary(this.strm,C))!==d)throw new Error(l[S]);this._dict_set=!0}}function v(x,w){var S=new b(w);if(S.push(x,!0),S.err)throw S.msg||l[S.err];return S.result}b.prototype.push=function(x,w){var S,C,k=this.strm,A=this.options.chunkSize;if(this.ended)return!1;C=w===~~w?w:w===!0?4:0,typeof x=="string"?k.input=o.string2buf(x):u.call(x)==="[object ArrayBuffer]"?k.input=new Uint8Array(x):k.input=x,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new a.Buf8(A),k.next_out=0,k.avail_out=A),(S=i.deflate(k,C))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(k.output,k.next_out))):this.onData(a.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&S!==1);return C===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):C!==2||(this.onEnd(d),!(k.avail_out=0))},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},s.Deflate=b,s.deflate=v,s.deflateRaw=function(x,w){return(w=w||{}).raw=!0,v(x,w)},s.gzip=function(x,w){return(w=w||{}).gzip=!0,v(x,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),h=Object.prototype.toString;function m(b){if(!(this instanceof m))return new m(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||b&&b.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=i.inflateInit2(this.strm,v.windowBits);if(x!==l.Z_OK)throw new Error(c[x]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function y(b,v){var x=new m(v);if(x.push(b,!0),x.err)throw x.msg||c[x.err];return x.result}m.prototype.push=function(b,v){var x,w,S,C,k,A,R=this.strm,N=this.options.chunkSize,I=this.options.dictionary,O=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?R.input=o.binstring2buf(b):h.call(b)==="[object ArrayBuffer]"?R.input=new Uint8Array(b):R.input=b,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new a.Buf8(N),R.next_out=0,R.avail_out=N),(x=i.inflate(R,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(A=typeof I=="string"?o.string2buf(I):h.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,x=i.inflateSetDictionary(this.strm,A)),x===l.Z_BUF_ERROR&&O===!0&&(x=l.Z_OK,O=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&x!==l.Z_STREAM_END&&(R.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(R.output,R.next_out),C=R.next_out-S,k=o.buf2string(R.output,S),R.next_out=C,R.avail_out=N-C,C&&a.arraySet(R.output,R.output,S,C,0),this.onData(k)):this.onData(a.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(O=!0)}while((0<R.avail_in||R.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(x=i.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(R.avail_out=0))},m.prototype.onData=function(b){this.chunks.push(b)},m.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},s.Inflate=m,s.inflate=y,s.inflateRaw=function(b,v){return(v=v||{}).raw=!0,y(b,v)},s.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){var c,u,d,h,m,y;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(y=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)m=l[c],y.set(m,h),h+=m.length;return y}},o={arraySet:function(l,c,u,d,h){for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(d,h));for(var m="",y=0;y<h;y++)m+=String.fromCharCode(d[y]);return m}l[254]=l[254]=1,s.string2buf=function(d){var h,m,y,b,v,x=d.length,w=0;for(b=0;b<x;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),w+=m<128?1:m<2048?2:m<65536?3:4;for(h=new i.Buf8(w),b=v=0;v<w;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),m<128?h[v++]=m:(m<2048?h[v++]=192|m>>>6:(m<65536?h[v++]=224|m>>>12:(h[v++]=240|m>>>18,h[v++]=128|m>>>12&63),h[v++]=128|m>>>6&63),h[v++]=128|63&m);return h},s.buf2binstring=function(d){return u(d,d.length)},s.binstring2buf=function(d){for(var h=new i.Buf8(d.length),m=0,y=h.length;m<y;m++)h[m]=d.charCodeAt(m);return h},s.buf2string=function(d,h){var m,y,b,v,x=h||d.length,w=new Array(2*x);for(m=y=0;m<x;)if((b=d[m++])<128)w[y++]=b;else if(4<(v=l[b]))w[y++]=65533,m+=v-1;else{for(b&=v===2?31:v===3?15:7;1<v&&m<x;)b=b<<6|63&d[m++],v--;1<v?w[y++]=65533:b<65536?w[y++]=b:(b-=65536,w[y++]=55296|b>>10&1023,w[y++]=56320|1023&b)}return u(w,y)},s.utf8border=function(d,h){var m;for((h=h||d.length)>d.length&&(h=d.length),m=h-1;0<=m&&(192&d[m])==128;)m--;return m<0||m===0?h:m+l[d[m]]>h?m:h}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,a,o,l){for(var c=65535&i|0,u=i>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=i,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(n,r,s){var i,a=n("../utils/common"),o=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,h=4,m=0,y=-2,b=-1,v=4,x=2,w=8,S=9,C=286,k=30,A=19,R=2*C+1,N=15,I=3,O=258,L=O+I+1,P=42,V=113,F=1,X=2,U=3,H=4;function $(K,me){return K.msg=u[me],me}function ne(K){return(K<<1)-(4<K?9:0)}function W(K){for(var me=K.length;0<=--me;)K[me]=0}function Q(K){var me=K.state,Ae=me.pending;Ae>K.avail_out&&(Ae=K.avail_out),Ae!==0&&(a.arraySet(K.output,me.pending_buf,me.pending_out,Ae,K.next_out),K.next_out+=Ae,me.pending_out+=Ae,K.total_out+=Ae,K.avail_out-=Ae,me.pending-=Ae,me.pending===0&&(me.pending_out=0))}function ee(K,me){o._tr_flush_block(K,0<=K.block_start?K.block_start:-1,K.strstart-K.block_start,me),K.block_start=K.strstart,Q(K.strm)}function se(K,me){K.pending_buf[K.pending++]=me}function pe(K,me){K.pending_buf[K.pending++]=me>>>8&255,K.pending_buf[K.pending++]=255&me}function ce(K,me){var Ae,le,oe=K.max_chain_length,re=K.strstart,Te=K.prev_length,Be=K.nice_match,ke=K.strstart>K.w_size-L?K.strstart-(K.w_size-L):0,lt=K.window,Rt=K.w_mask,ft=K.prev,jt=K.strstart+O,qt=lt[re+Te-1],Lt=lt[re+Te];K.prev_length>=K.good_match&&(oe>>=2),Be>K.lookahead&&(Be=K.lookahead);do if(lt[(Ae=me)+Te]===Lt&&lt[Ae+Te-1]===qt&&lt[Ae]===lt[re]&&lt[++Ae]===lt[re+1]){re+=2,Ae++;do;while(lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&re<jt);if(le=O-(jt-re),re=jt-O,Te<le){if(K.match_start=me,Be<=(Te=le))break;qt=lt[re+Te-1],Lt=lt[re+Te]}}while((me=ft[me&Rt])>ke&&--oe!=0);return Te<=K.lookahead?Te:K.lookahead}function Ie(K){var me,Ae,le,oe,re,Te,Be,ke,lt,Rt,ft=K.w_size;do{if(oe=K.window_size-K.lookahead-K.strstart,K.strstart>=ft+(ft-L)){for(a.arraySet(K.window,K.window,ft,ft,0),K.match_start-=ft,K.strstart-=ft,K.block_start-=ft,me=Ae=K.hash_size;le=K.head[--me],K.head[me]=ft<=le?le-ft:0,--Ae;);for(me=Ae=ft;le=K.prev[--me],K.prev[me]=ft<=le?le-ft:0,--Ae;);oe+=ft}if(K.strm.avail_in===0)break;if(Te=K.strm,Be=K.window,ke=K.strstart+K.lookahead,lt=oe,Rt=void 0,Rt=Te.avail_in,lt<Rt&&(Rt=lt),Ae=Rt===0?0:(Te.avail_in-=Rt,a.arraySet(Be,Te.input,Te.next_in,Rt,ke),Te.state.wrap===1?Te.adler=l(Te.adler,Be,Rt,ke):Te.state.wrap===2&&(Te.adler=c(Te.adler,Be,Rt,ke)),Te.next_in+=Rt,Te.total_in+=Rt,Rt),K.lookahead+=Ae,K.lookahead+K.insert>=I)for(re=K.strstart-K.insert,K.ins_h=K.window[re],K.ins_h=(K.ins_h<<K.hash_shift^K.window[re+1])&K.hash_mask;K.insert&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[re+I-1])&K.hash_mask,K.prev[re&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=re,re++,K.insert--,!(K.lookahead+K.insert<I)););}while(K.lookahead<L&&K.strm.avail_in!==0)}function De(K,me){for(var Ae,le;;){if(K.lookahead<L){if(Ie(K),K.lookahead<L&&me===d)return F;if(K.lookahead===0)break}if(Ae=0,K.lookahead>=I&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),Ae!==0&&K.strstart-Ae<=K.w_size-L&&(K.match_length=ce(K,Ae)),K.match_length>=I)if(le=o._tr_tally(K,K.strstart-K.match_start,K.match_length-I),K.lookahead-=K.match_length,K.match_length<=K.max_lazy_match&&K.lookahead>=I){for(K.match_length--;K.strstart++,K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart,--K.match_length!=0;);K.strstart++}else K.strstart+=K.match_length,K.match_length=0,K.ins_h=K.window[K.strstart],K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+1])&K.hash_mask;else le=o._tr_tally(K,0,K.window[K.strstart]),K.lookahead--,K.strstart++;if(le&&(ee(K,!1),K.strm.avail_out===0))return F}return K.insert=K.strstart<I-1?K.strstart:I-1,me===h?(ee(K,!0),K.strm.avail_out===0?U:H):K.last_lit&&(ee(K,!1),K.strm.avail_out===0)?F:X}function Se(K,me){for(var Ae,le,oe;;){if(K.lookahead<L){if(Ie(K),K.lookahead<L&&me===d)return F;if(K.lookahead===0)break}if(Ae=0,K.lookahead>=I&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),K.prev_length=K.match_length,K.prev_match=K.match_start,K.match_length=I-1,Ae!==0&&K.prev_length<K.max_lazy_match&&K.strstart-Ae<=K.w_size-L&&(K.match_length=ce(K,Ae),K.match_length<=5&&(K.strategy===1||K.match_length===I&&4096<K.strstart-K.match_start)&&(K.match_length=I-1)),K.prev_length>=I&&K.match_length<=K.prev_length){for(oe=K.strstart+K.lookahead-I,le=o._tr_tally(K,K.strstart-1-K.prev_match,K.prev_length-I),K.lookahead-=K.prev_length-1,K.prev_length-=2;++K.strstart<=oe&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),--K.prev_length!=0;);if(K.match_available=0,K.match_length=I-1,K.strstart++,le&&(ee(K,!1),K.strm.avail_out===0))return F}else if(K.match_available){if((le=o._tr_tally(K,0,K.window[K.strstart-1]))&&ee(K,!1),K.strstart++,K.lookahead--,K.strm.avail_out===0)return F}else K.match_available=1,K.strstart++,K.lookahead--}return K.match_available&&(le=o._tr_tally(K,0,K.window[K.strstart-1]),K.match_available=0),K.insert=K.strstart<I-1?K.strstart:I-1,me===h?(ee(K,!0),K.strm.avail_out===0?U:H):K.last_lit&&(ee(K,!1),K.strm.avail_out===0)?F:X}function Ce(K,me,Ae,le,oe){this.good_length=K,this.max_lazy=me,this.nice_length=Ae,this.max_chain=le,this.func=oe}function qe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*R),this.dyn_dtree=new a.Buf16(2*(2*k+1)),this.bl_tree=new a.Buf16(2*(2*A+1)),W(this.dyn_ltree),W(this.dyn_dtree),W(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(N+1),this.heap=new a.Buf16(2*C+1),W(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*C+1),W(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Qe(K){var me;return K&&K.state?(K.total_in=K.total_out=0,K.data_type=x,(me=K.state).pending=0,me.pending_out=0,me.wrap<0&&(me.wrap=-me.wrap),me.status=me.wrap?P:V,K.adler=me.wrap===2?0:1,me.last_flush=d,o._tr_init(me),m):$(K,y)}function Ve(K){var me=Qe(K);return me===m&&function(Ae){Ae.window_size=2*Ae.w_size,W(Ae.head),Ae.max_lazy_match=i[Ae.level].max_lazy,Ae.good_match=i[Ae.level].good_length,Ae.nice_match=i[Ae.level].nice_length,Ae.max_chain_length=i[Ae.level].max_chain,Ae.strstart=0,Ae.block_start=0,Ae.lookahead=0,Ae.insert=0,Ae.match_length=Ae.prev_length=I-1,Ae.match_available=0,Ae.ins_h=0}(K.state),me}function Ne(K,me,Ae,le,oe,re){if(!K)return y;var Te=1;if(me===b&&(me=6),le<0?(Te=0,le=-le):15<le&&(Te=2,le-=16),oe<1||S<oe||Ae!==w||le<8||15<le||me<0||9<me||re<0||v<re)return $(K,y);le===8&&(le=9);var Be=new qe;return(K.state=Be).strm=K,Be.wrap=Te,Be.gzhead=null,Be.w_bits=le,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=oe+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+I-1)/I),Be.window=new a.Buf8(2*Be.w_size),Be.head=new a.Buf16(Be.hash_size),Be.prev=new a.Buf16(Be.w_size),Be.lit_bufsize=1<<oe+6,Be.pending_buf_size=4*Be.lit_bufsize,Be.pending_buf=new a.Buf8(Be.pending_buf_size),Be.d_buf=1*Be.lit_bufsize,Be.l_buf=3*Be.lit_bufsize,Be.level=me,Be.strategy=re,Be.method=Ae,Ve(K)}i=[new Ce(0,0,0,0,function(K,me){var Ae=65535;for(Ae>K.pending_buf_size-5&&(Ae=K.pending_buf_size-5);;){if(K.lookahead<=1){if(Ie(K),K.lookahead===0&&me===d)return F;if(K.lookahead===0)break}K.strstart+=K.lookahead,K.lookahead=0;var le=K.block_start+Ae;if((K.strstart===0||K.strstart>=le)&&(K.lookahead=K.strstart-le,K.strstart=le,ee(K,!1),K.strm.avail_out===0)||K.strstart-K.block_start>=K.w_size-L&&(ee(K,!1),K.strm.avail_out===0))return F}return K.insert=0,me===h?(ee(K,!0),K.strm.avail_out===0?U:H):(K.strstart>K.block_start&&(ee(K,!1),K.strm.avail_out),F)}),new Ce(4,4,8,4,De),new Ce(4,5,16,8,De),new Ce(4,6,32,32,De),new Ce(4,4,16,16,Se),new Ce(8,16,32,32,Se),new Ce(8,16,128,128,Se),new Ce(8,32,128,256,Se),new Ce(32,128,258,1024,Se),new Ce(32,258,258,4096,Se)],s.deflateInit=function(K,me){return Ne(K,me,w,15,8,0)},s.deflateInit2=Ne,s.deflateReset=Ve,s.deflateResetKeep=Qe,s.deflateSetHeader=function(K,me){return K&&K.state?K.state.wrap!==2?y:(K.state.gzhead=me,m):y},s.deflate=function(K,me){var Ae,le,oe,re;if(!K||!K.state||5<me||me<0)return K?$(K,y):y;if(le=K.state,!K.output||!K.input&&K.avail_in!==0||le.status===666&&me!==h)return $(K,K.avail_out===0?-5:y);if(le.strm=K,Ae=le.last_flush,le.last_flush=me,le.status===P)if(le.wrap===2)K.adler=0,se(le,31),se(le,139),se(le,8),le.gzhead?(se(le,(le.gzhead.text?1:0)+(le.gzhead.hcrc?2:0)+(le.gzhead.extra?4:0)+(le.gzhead.name?8:0)+(le.gzhead.comment?16:0)),se(le,255&le.gzhead.time),se(le,le.gzhead.time>>8&255),se(le,le.gzhead.time>>16&255),se(le,le.gzhead.time>>24&255),se(le,le.level===9?2:2<=le.strategy||le.level<2?4:0),se(le,255&le.gzhead.os),le.gzhead.extra&&le.gzhead.extra.length&&(se(le,255&le.gzhead.extra.length),se(le,le.gzhead.extra.length>>8&255)),le.gzhead.hcrc&&(K.adler=c(K.adler,le.pending_buf,le.pending,0)),le.gzindex=0,le.status=69):(se(le,0),se(le,0),se(le,0),se(le,0),se(le,0),se(le,le.level===9?2:2<=le.strategy||le.level<2?4:0),se(le,3),le.status=V);else{var Te=w+(le.w_bits-8<<4)<<8;Te|=(2<=le.strategy||le.level<2?0:le.level<6?1:le.level===6?2:3)<<6,le.strstart!==0&&(Te|=32),Te+=31-Te%31,le.status=V,pe(le,Te),le.strstart!==0&&(pe(le,K.adler>>>16),pe(le,65535&K.adler)),K.adler=1}if(le.status===69)if(le.gzhead.extra){for(oe=le.pending;le.gzindex<(65535&le.gzhead.extra.length)&&(le.pending!==le.pending_buf_size||(le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),Q(K),oe=le.pending,le.pending!==le.pending_buf_size));)se(le,255&le.gzhead.extra[le.gzindex]),le.gzindex++;le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),le.gzindex===le.gzhead.extra.length&&(le.gzindex=0,le.status=73)}else le.status=73;if(le.status===73)if(le.gzhead.name){oe=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),Q(K),oe=le.pending,le.pending===le.pending_buf_size)){re=1;break}re=le.gzindex<le.gzhead.name.length?255&le.gzhead.name.charCodeAt(le.gzindex++):0,se(le,re)}while(re!==0);le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),re===0&&(le.gzindex=0,le.status=91)}else le.status=91;if(le.status===91)if(le.gzhead.comment){oe=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),Q(K),oe=le.pending,le.pending===le.pending_buf_size)){re=1;break}re=le.gzindex<le.gzhead.comment.length?255&le.gzhead.comment.charCodeAt(le.gzindex++):0,se(le,re)}while(re!==0);le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),re===0&&(le.status=103)}else le.status=103;if(le.status===103&&(le.gzhead.hcrc?(le.pending+2>le.pending_buf_size&&Q(K),le.pending+2<=le.pending_buf_size&&(se(le,255&K.adler),se(le,K.adler>>8&255),K.adler=0,le.status=V)):le.status=V),le.pending!==0){if(Q(K),K.avail_out===0)return le.last_flush=-1,m}else if(K.avail_in===0&&ne(me)<=ne(Ae)&&me!==h)return $(K,-5);if(le.status===666&&K.avail_in!==0)return $(K,-5);if(K.avail_in!==0||le.lookahead!==0||me!==d&&le.status!==666){var Be=le.strategy===2?function(ke,lt){for(var Rt;;){if(ke.lookahead===0&&(Ie(ke),ke.lookahead===0)){if(lt===d)return F;break}if(ke.match_length=0,Rt=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++,Rt&&(ee(ke,!1),ke.strm.avail_out===0))return F}return ke.insert=0,lt===h?(ee(ke,!0),ke.strm.avail_out===0?U:H):ke.last_lit&&(ee(ke,!1),ke.strm.avail_out===0)?F:X}(le,me):le.strategy===3?function(ke,lt){for(var Rt,ft,jt,qt,Lt=ke.window;;){if(ke.lookahead<=O){if(Ie(ke),ke.lookahead<=O&&lt===d)return F;if(ke.lookahead===0)break}if(ke.match_length=0,ke.lookahead>=I&&0<ke.strstart&&(ft=Lt[jt=ke.strstart-1])===Lt[++jt]&&ft===Lt[++jt]&&ft===Lt[++jt]){qt=ke.strstart+O;do;while(ft===Lt[++jt]&&ft===Lt[++jt]&&ft===Lt[++jt]&&ft===Lt[++jt]&&ft===Lt[++jt]&&ft===Lt[++jt]&&ft===Lt[++jt]&&ft===Lt[++jt]&&jt<qt);ke.match_length=O-(qt-jt),ke.match_length>ke.lookahead&&(ke.match_length=ke.lookahead)}if(ke.match_length>=I?(Rt=o._tr_tally(ke,1,ke.match_length-I),ke.lookahead-=ke.match_length,ke.strstart+=ke.match_length,ke.match_length=0):(Rt=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++),Rt&&(ee(ke,!1),ke.strm.avail_out===0))return F}return ke.insert=0,lt===h?(ee(ke,!0),ke.strm.avail_out===0?U:H):ke.last_lit&&(ee(ke,!1),ke.strm.avail_out===0)?F:X}(le,me):i[le.level].func(le,me);if(Be!==U&&Be!==H||(le.status=666),Be===F||Be===U)return K.avail_out===0&&(le.last_flush=-1),m;if(Be===X&&(me===1?o._tr_align(le):me!==5&&(o._tr_stored_block(le,0,0,!1),me===3&&(W(le.head),le.lookahead===0&&(le.strstart=0,le.block_start=0,le.insert=0))),Q(K),K.avail_out===0))return le.last_flush=-1,m}return me!==h?m:le.wrap<=0?1:(le.wrap===2?(se(le,255&K.adler),se(le,K.adler>>8&255),se(le,K.adler>>16&255),se(le,K.adler>>24&255),se(le,255&K.total_in),se(le,K.total_in>>8&255),se(le,K.total_in>>16&255),se(le,K.total_in>>24&255)):(pe(le,K.adler>>>16),pe(le,65535&K.adler)),Q(K),0<le.wrap&&(le.wrap=-le.wrap),le.pending!==0?m:1)},s.deflateEnd=function(K){var me;return K&&K.state?(me=K.state.status)!==P&&me!==69&&me!==73&&me!==91&&me!==103&&me!==V&&me!==666?$(K,y):(K.state=null,me===V?$(K,-3):m):y},s.deflateSetDictionary=function(K,me){var Ae,le,oe,re,Te,Be,ke,lt,Rt=me.length;if(!K||!K.state||(re=(Ae=K.state).wrap)===2||re===1&&Ae.status!==P||Ae.lookahead)return y;for(re===1&&(K.adler=l(K.adler,me,Rt,0)),Ae.wrap=0,Rt>=Ae.w_size&&(re===0&&(W(Ae.head),Ae.strstart=0,Ae.block_start=0,Ae.insert=0),lt=new a.Buf8(Ae.w_size),a.arraySet(lt,me,Rt-Ae.w_size,Ae.w_size,0),me=lt,Rt=Ae.w_size),Te=K.avail_in,Be=K.next_in,ke=K.input,K.avail_in=Rt,K.next_in=0,K.input=me,Ie(Ae);Ae.lookahead>=I;){for(le=Ae.strstart,oe=Ae.lookahead-(I-1);Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[le+I-1])&Ae.hash_mask,Ae.prev[le&Ae.w_mask]=Ae.head[Ae.ins_h],Ae.head[Ae.ins_h]=le,le++,--oe;);Ae.strstart=le,Ae.lookahead=I-1,Ie(Ae)}return Ae.strstart+=Ae.lookahead,Ae.block_start=Ae.strstart,Ae.insert=Ae.lookahead,Ae.lookahead=0,Ae.match_length=Ae.prev_length=I-1,Ae.match_available=0,K.next_in=Be,K.input=ke,K.avail_in=Te,Ae.wrap=re,m},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,a){var o,l,c,u,d,h,m,y,b,v,x,w,S,C,k,A,R,N,I,O,L,P,V,F,X;o=i.state,l=i.next_in,F=i.input,c=l+(i.avail_in-5),u=i.next_out,X=i.output,d=u-(a-i.avail_out),h=u+(i.avail_out-257),m=o.dmax,y=o.wsize,b=o.whave,v=o.wnext,x=o.window,w=o.hold,S=o.bits,C=o.lencode,k=o.distcode,A=(1<<o.lenbits)-1,R=(1<<o.distbits)-1;e:do{S<15&&(w+=F[l++]<<S,S+=8,w+=F[l++]<<S,S+=8),N=C[w&A];t:for(;;){if(w>>>=I=N>>>24,S-=I,(I=N>>>16&255)===0)X[u++]=65535&N;else{if(!(16&I)){if((64&I)==0){N=C[(65535&N)+(w&(1<<I)-1)];continue t}if(32&I){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}O=65535&N,(I&=15)&&(S<I&&(w+=F[l++]<<S,S+=8),O+=w&(1<<I)-1,w>>>=I,S-=I),S<15&&(w+=F[l++]<<S,S+=8,w+=F[l++]<<S,S+=8),N=k[w&R];n:for(;;){if(w>>>=I=N>>>24,S-=I,!(16&(I=N>>>16&255))){if((64&I)==0){N=k[(65535&N)+(w&(1<<I)-1)];continue n}i.msg="invalid distance code",o.mode=30;break e}if(L=65535&N,S<(I&=15)&&(w+=F[l++]<<S,(S+=8)<I&&(w+=F[l++]<<S,S+=8)),m<(L+=w&(1<<I)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(w>>>=I,S-=I,(I=u-d)<L){if(b<(I=L-I)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(V=x,(P=0)===v){if(P+=y-I,I<O){for(O-=I;X[u++]=x[P++],--I;);P=u-L,V=X}}else if(v<I){if(P+=y+v-I,(I-=v)<O){for(O-=I;X[u++]=x[P++],--I;);if(P=0,v<O){for(O-=I=v;X[u++]=x[P++],--I;);P=u-L,V=X}}}else if(P+=v-I,I<O){for(O-=I;X[u++]=x[P++],--I;);P=u-L,V=X}for(;2<O;)X[u++]=V[P++],X[u++]=V[P++],X[u++]=V[P++],O-=3;O&&(X[u++]=V[P++],1<O&&(X[u++]=V[P++]))}else{for(P=u-L;X[u++]=X[P++],X[u++]=X[P++],X[u++]=X[P++],2<(O-=3););O&&(X[u++]=X[P++],1<O&&(X[u++]=X[P++]))}break}}break}}while(l<c&&u<h);l-=O=S>>3,w&=(1<<(S-=O<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<h?h-u+257:257-(u-h),o.hold=w,o.bits=S}},{}],49:[function(n,r,s){var i=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,h=0,m=-2,y=1,b=852,v=592;function x(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(P){var V;return P&&P.state?(V=P.state,P.total_in=P.total_out=V.total=0,P.msg="",V.wrap&&(P.adler=1&V.wrap),V.mode=y,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new i.Buf32(b),V.distcode=V.distdyn=new i.Buf32(v),V.sane=1,V.back=-1,h):m}function C(P){var V;return P&&P.state?((V=P.state).wsize=0,V.whave=0,V.wnext=0,S(P)):m}function k(P,V){var F,X;return P&&P.state?(X=P.state,V<0?(F=0,V=-V):(F=1+(V>>4),V<48&&(V&=15)),V&&(V<8||15<V)?m:(X.window!==null&&X.wbits!==V&&(X.window=null),X.wrap=F,X.wbits=V,C(P))):m}function A(P,V){var F,X;return P?(X=new w,(P.state=X).window=null,(F=k(P,V))!==h&&(P.state=null),F):m}var R,N,I=!0;function O(P){if(I){var V;for(R=new i.Buf32(512),N=new i.Buf32(32),V=0;V<144;)P.lens[V++]=8;for(;V<256;)P.lens[V++]=9;for(;V<280;)P.lens[V++]=7;for(;V<288;)P.lens[V++]=8;for(c(u,P.lens,0,288,R,0,P.work,{bits:9}),V=0;V<32;)P.lens[V++]=5;c(d,P.lens,0,32,N,0,P.work,{bits:5}),I=!1}P.lencode=R,P.lenbits=9,P.distcode=N,P.distbits=5}function L(P,V,F,X){var U,H=P.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new i.Buf8(H.wsize)),X>=H.wsize?(i.arraySet(H.window,V,F-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(X<(U=H.wsize-H.wnext)&&(U=X),i.arraySet(H.window,V,F-X,U,H.wnext),(X-=U)?(i.arraySet(H.window,V,F-X,X,0),H.wnext=X,H.whave=H.wsize):(H.wnext+=U,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=U))),0}s.inflateReset=C,s.inflateReset2=k,s.inflateResetKeep=S,s.inflateInit=function(P){return A(P,15)},s.inflateInit2=A,s.inflate=function(P,V){var F,X,U,H,$,ne,W,Q,ee,se,pe,ce,Ie,De,Se,Ce,qe,Qe,Ve,Ne,K,me,Ae,le,oe=0,re=new i.Buf8(4),Te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return m;(F=P.state).mode===12&&(F.mode=13),$=P.next_out,U=P.output,W=P.avail_out,H=P.next_in,X=P.input,ne=P.avail_in,Q=F.hold,ee=F.bits,se=ne,pe=W,me=h;e:for(;;)switch(F.mode){case y:if(F.wrap===0){F.mode=13;break}for(;ee<16;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if(2&F.wrap&&Q===35615){re[F.check=0]=255&Q,re[1]=Q>>>8&255,F.check=o(F.check,re,2,0),ee=Q=0,F.mode=2;break}if(F.flags=0,F.head&&(F.head.done=!1),!(1&F.wrap)||(((255&Q)<<8)+(Q>>8))%31){P.msg="incorrect header check",F.mode=30;break}if((15&Q)!=8){P.msg="unknown compression method",F.mode=30;break}if(ee-=4,K=8+(15&(Q>>>=4)),F.wbits===0)F.wbits=K;else if(K>F.wbits){P.msg="invalid window size",F.mode=30;break}F.dmax=1<<K,P.adler=F.check=1,F.mode=512&Q?10:12,ee=Q=0;break;case 2:for(;ee<16;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if(F.flags=Q,(255&F.flags)!=8){P.msg="unknown compression method",F.mode=30;break}if(57344&F.flags){P.msg="unknown header flags set",F.mode=30;break}F.head&&(F.head.text=Q>>8&1),512&F.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,F.check=o(F.check,re,2,0)),ee=Q=0,F.mode=3;case 3:for(;ee<32;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}F.head&&(F.head.time=Q),512&F.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,re[2]=Q>>>16&255,re[3]=Q>>>24&255,F.check=o(F.check,re,4,0)),ee=Q=0,F.mode=4;case 4:for(;ee<16;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}F.head&&(F.head.xflags=255&Q,F.head.os=Q>>8),512&F.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,F.check=o(F.check,re,2,0)),ee=Q=0,F.mode=5;case 5:if(1024&F.flags){for(;ee<16;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}F.length=Q,F.head&&(F.head.extra_len=Q),512&F.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,F.check=o(F.check,re,2,0)),ee=Q=0}else F.head&&(F.head.extra=null);F.mode=6;case 6:if(1024&F.flags&&(ne<(ce=F.length)&&(ce=ne),ce&&(F.head&&(K=F.head.extra_len-F.length,F.head.extra||(F.head.extra=new Array(F.head.extra_len)),i.arraySet(F.head.extra,X,H,ce,K)),512&F.flags&&(F.check=o(F.check,X,ce,H)),ne-=ce,H+=ce,F.length-=ce),F.length))break e;F.length=0,F.mode=7;case 7:if(2048&F.flags){if(ne===0)break e;for(ce=0;K=X[H+ce++],F.head&&K&&F.length<65536&&(F.head.name+=String.fromCharCode(K)),K&&ce<ne;);if(512&F.flags&&(F.check=o(F.check,X,ce,H)),ne-=ce,H+=ce,K)break e}else F.head&&(F.head.name=null);F.length=0,F.mode=8;case 8:if(4096&F.flags){if(ne===0)break e;for(ce=0;K=X[H+ce++],F.head&&K&&F.length<65536&&(F.head.comment+=String.fromCharCode(K)),K&&ce<ne;);if(512&F.flags&&(F.check=o(F.check,X,ce,H)),ne-=ce,H+=ce,K)break e}else F.head&&(F.head.comment=null);F.mode=9;case 9:if(512&F.flags){for(;ee<16;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if(Q!==(65535&F.check)){P.msg="header crc mismatch",F.mode=30;break}ee=Q=0}F.head&&(F.head.hcrc=F.flags>>9&1,F.head.done=!0),P.adler=F.check=0,F.mode=12;break;case 10:for(;ee<32;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}P.adler=F.check=x(Q),ee=Q=0,F.mode=11;case 11:if(F.havedict===0)return P.next_out=$,P.avail_out=W,P.next_in=H,P.avail_in=ne,F.hold=Q,F.bits=ee,2;P.adler=F.check=1,F.mode=12;case 12:if(V===5||V===6)break e;case 13:if(F.last){Q>>>=7&ee,ee-=7&ee,F.mode=27;break}for(;ee<3;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}switch(F.last=1&Q,ee-=1,3&(Q>>>=1)){case 0:F.mode=14;break;case 1:if(O(F),F.mode=20,V!==6)break;Q>>>=2,ee-=2;break e;case 2:F.mode=17;break;case 3:P.msg="invalid block type",F.mode=30}Q>>>=2,ee-=2;break;case 14:for(Q>>>=7&ee,ee-=7&ee;ee<32;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if((65535&Q)!=(Q>>>16^65535)){P.msg="invalid stored block lengths",F.mode=30;break}if(F.length=65535&Q,ee=Q=0,F.mode=15,V===6)break e;case 15:F.mode=16;case 16:if(ce=F.length){if(ne<ce&&(ce=ne),W<ce&&(ce=W),ce===0)break e;i.arraySet(U,X,H,ce,$),ne-=ce,H+=ce,W-=ce,$+=ce,F.length-=ce;break}F.mode=12;break;case 17:for(;ee<14;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if(F.nlen=257+(31&Q),Q>>>=5,ee-=5,F.ndist=1+(31&Q),Q>>>=5,ee-=5,F.ncode=4+(15&Q),Q>>>=4,ee-=4,286<F.nlen||30<F.ndist){P.msg="too many length or distance symbols",F.mode=30;break}F.have=0,F.mode=18;case 18:for(;F.have<F.ncode;){for(;ee<3;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}F.lens[Te[F.have++]]=7&Q,Q>>>=3,ee-=3}for(;F.have<19;)F.lens[Te[F.have++]]=0;if(F.lencode=F.lendyn,F.lenbits=7,Ae={bits:F.lenbits},me=c(0,F.lens,0,19,F.lencode,0,F.work,Ae),F.lenbits=Ae.bits,me){P.msg="invalid code lengths set",F.mode=30;break}F.have=0,F.mode=19;case 19:for(;F.have<F.nlen+F.ndist;){for(;Ce=(oe=F.lencode[Q&(1<<F.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if(qe<16)Q>>>=Se,ee-=Se,F.lens[F.have++]=qe;else{if(qe===16){for(le=Se+2;ee<le;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if(Q>>>=Se,ee-=Se,F.have===0){P.msg="invalid bit length repeat",F.mode=30;break}K=F.lens[F.have-1],ce=3+(3&Q),Q>>>=2,ee-=2}else if(qe===17){for(le=Se+3;ee<le;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}ee-=Se,K=0,ce=3+(7&(Q>>>=Se)),Q>>>=3,ee-=3}else{for(le=Se+7;ee<le;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}ee-=Se,K=0,ce=11+(127&(Q>>>=Se)),Q>>>=7,ee-=7}if(F.have+ce>F.nlen+F.ndist){P.msg="invalid bit length repeat",F.mode=30;break}for(;ce--;)F.lens[F.have++]=K}}if(F.mode===30)break;if(F.lens[256]===0){P.msg="invalid code -- missing end-of-block",F.mode=30;break}if(F.lenbits=9,Ae={bits:F.lenbits},me=c(u,F.lens,0,F.nlen,F.lencode,0,F.work,Ae),F.lenbits=Ae.bits,me){P.msg="invalid literal/lengths set",F.mode=30;break}if(F.distbits=6,F.distcode=F.distdyn,Ae={bits:F.distbits},me=c(d,F.lens,F.nlen,F.ndist,F.distcode,0,F.work,Ae),F.distbits=Ae.bits,me){P.msg="invalid distances set",F.mode=30;break}if(F.mode=20,V===6)break e;case 20:F.mode=21;case 21:if(6<=ne&&258<=W){P.next_out=$,P.avail_out=W,P.next_in=H,P.avail_in=ne,F.hold=Q,F.bits=ee,l(P,pe),$=P.next_out,U=P.output,W=P.avail_out,H=P.next_in,X=P.input,ne=P.avail_in,Q=F.hold,ee=F.bits,F.mode===12&&(F.back=-1);break}for(F.back=0;Ce=(oe=F.lencode[Q&(1<<F.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if(Ce&&(240&Ce)==0){for(Qe=Se,Ve=Ce,Ne=qe;Ce=(oe=F.lencode[Ne+((Q&(1<<Qe+Ve)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,F.back+=Qe}if(Q>>>=Se,ee-=Se,F.back+=Se,F.length=qe,Ce===0){F.mode=26;break}if(32&Ce){F.back=-1,F.mode=12;break}if(64&Ce){P.msg="invalid literal/length code",F.mode=30;break}F.extra=15&Ce,F.mode=22;case 22:if(F.extra){for(le=F.extra;ee<le;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}F.length+=Q&(1<<F.extra)-1,Q>>>=F.extra,ee-=F.extra,F.back+=F.extra}F.was=F.length,F.mode=23;case 23:for(;Ce=(oe=F.distcode[Q&(1<<F.distbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if((240&Ce)==0){for(Qe=Se,Ve=Ce,Ne=qe;Ce=(oe=F.distcode[Ne+((Q&(1<<Qe+Ve)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,F.back+=Qe}if(Q>>>=Se,ee-=Se,F.back+=Se,64&Ce){P.msg="invalid distance code",F.mode=30;break}F.offset=qe,F.extra=15&Ce,F.mode=24;case 24:if(F.extra){for(le=F.extra;ee<le;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}F.offset+=Q&(1<<F.extra)-1,Q>>>=F.extra,ee-=F.extra,F.back+=F.extra}if(F.offset>F.dmax){P.msg="invalid distance too far back",F.mode=30;break}F.mode=25;case 25:if(W===0)break e;if(ce=pe-W,F.offset>ce){if((ce=F.offset-ce)>F.whave&&F.sane){P.msg="invalid distance too far back",F.mode=30;break}Ie=ce>F.wnext?(ce-=F.wnext,F.wsize-ce):F.wnext-ce,ce>F.length&&(ce=F.length),De=F.window}else De=U,Ie=$-F.offset,ce=F.length;for(W<ce&&(ce=W),W-=ce,F.length-=ce;U[$++]=De[Ie++],--ce;);F.length===0&&(F.mode=21);break;case 26:if(W===0)break e;U[$++]=F.length,W--,F.mode=21;break;case 27:if(F.wrap){for(;ee<32;){if(ne===0)break e;ne--,Q|=X[H++]<<ee,ee+=8}if(pe-=W,P.total_out+=pe,F.total+=pe,pe&&(P.adler=F.check=F.flags?o(F.check,U,pe,$-pe):a(F.check,U,pe,$-pe)),pe=W,(F.flags?Q:x(Q))!==F.check){P.msg="incorrect data check",F.mode=30;break}ee=Q=0}F.mode=28;case 28:if(F.wrap&&F.flags){for(;ee<32;){if(ne===0)break e;ne--,Q+=X[H++]<<ee,ee+=8}if(Q!==(4294967295&F.total)){P.msg="incorrect length check",F.mode=30;break}ee=Q=0}F.mode=29;case 29:me=1;break e;case 30:me=-3;break e;case 31:return-4;case 32:default:return m}return P.next_out=$,P.avail_out=W,P.next_in=H,P.avail_in=ne,F.hold=Q,F.bits=ee,(F.wsize||pe!==P.avail_out&&F.mode<30&&(F.mode<27||V!==4))&&L(P,P.output,P.next_out,pe-P.avail_out)?(F.mode=31,-4):(se-=P.avail_in,pe-=P.avail_out,P.total_in+=se,P.total_out+=pe,F.total+=pe,F.wrap&&pe&&(P.adler=F.check=F.flags?o(F.check,U,pe,P.next_out-pe):a(F.check,U,pe,P.next_out-pe)),P.data_type=F.bits+(F.last?64:0)+(F.mode===12?128:0)+(F.mode===20||F.mode===15?256:0),(se==0&&pe===0||V===4)&&me===h&&(me=-5),me)},s.inflateEnd=function(P){if(!P||!P.state)return m;var V=P.state;return V.window&&(V.window=null),P.state=null,h},s.inflateGetHeader=function(P,V){var F;return P&&P.state?(2&(F=P.state).wrap)==0?m:((F.head=V).done=!1,h):m},s.inflateSetDictionary=function(P,V){var F,X=V.length;return P&&P.state?(F=P.state).wrap!==0&&F.mode!==11?m:F.mode===11&&a(1,V,X,0)!==F.check?-3:L(P,V,X,X)?(F.mode=31,-4):(F.havedict=1,h):m},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,m,y,b,v,x){var w,S,C,k,A,R,N,I,O,L=x.bits,P=0,V=0,F=0,X=0,U=0,H=0,$=0,ne=0,W=0,Q=0,ee=null,se=0,pe=new i.Buf16(16),ce=new i.Buf16(16),Ie=null,De=0;for(P=0;P<=15;P++)pe[P]=0;for(V=0;V<m;V++)pe[d[h+V]]++;for(U=L,X=15;1<=X&&pe[X]===0;X--);if(X<U&&(U=X),X===0)return y[b++]=20971520,y[b++]=20971520,x.bits=1,0;for(F=1;F<X&&pe[F]===0;F++);for(U<F&&(U=F),P=ne=1;P<=15;P++)if(ne<<=1,(ne-=pe[P])<0)return-1;if(0<ne&&(u===0||X!==1))return-1;for(ce[1]=0,P=1;P<15;P++)ce[P+1]=ce[P]+pe[P];for(V=0;V<m;V++)d[h+V]!==0&&(v[ce[d[h+V]]++]=V);if(R=u===0?(ee=Ie=v,19):u===1?(ee=a,se-=257,Ie=o,De-=257,256):(ee=l,Ie=c,-1),P=F,A=b,$=V=Q=0,C=-1,k=(W=1<<(H=U))-1,u===1&&852<W||u===2&&592<W)return 1;for(;;){for(N=P-$,O=v[V]<R?(I=0,v[V]):v[V]>R?(I=Ie[De+v[V]],ee[se+v[V]]):(I=96,0),w=1<<P-$,F=S=1<<H;y[A+(Q>>$)+(S-=w)]=N<<24|I<<16|O|0,S!==0;);for(w=1<<P-1;Q&w;)w>>=1;if(w!==0?(Q&=w-1,Q+=w):Q=0,V++,--pe[P]==0){if(P===X)break;P=d[h+v[V]]}if(U<P&&(Q&k)!==C){for($===0&&($=U),A+=F,ne=1<<(H=P-$);H+$<X&&!((ne-=pe[H+$])<=0);)H++,ne<<=1;if(W+=1<<H,u===1&&852<W||u===2&&592<W)return 1;y[C=Q&k]=U<<24|H<<16|A-b|0}}return Q!==0&&(y[A+Q]=P-$<<24|64<<16|0),x.bits=U,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),a=0,o=1;function l(oe){for(var re=oe.length;0<=--re;)oe[re]=0}var c=0,u=29,d=256,h=d+1+u,m=30,y=19,b=2*h+1,v=15,x=16,w=7,S=256,C=16,k=17,A=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=new Array(2*(h+2));l(L);var P=new Array(2*m);l(P);var V=new Array(512);l(V);var F=new Array(256);l(F);var X=new Array(u);l(X);var U,H,$,ne=new Array(m);function W(oe,re,Te,Be,ke){this.static_tree=oe,this.extra_bits=re,this.extra_base=Te,this.elems=Be,this.max_length=ke,this.has_stree=oe&&oe.length}function Q(oe,re){this.dyn_tree=oe,this.max_code=0,this.stat_desc=re}function ee(oe){return oe<256?V[oe]:V[256+(oe>>>7)]}function se(oe,re){oe.pending_buf[oe.pending++]=255&re,oe.pending_buf[oe.pending++]=re>>>8&255}function pe(oe,re,Te){oe.bi_valid>x-Te?(oe.bi_buf|=re<<oe.bi_valid&65535,se(oe,oe.bi_buf),oe.bi_buf=re>>x-oe.bi_valid,oe.bi_valid+=Te-x):(oe.bi_buf|=re<<oe.bi_valid&65535,oe.bi_valid+=Te)}function ce(oe,re,Te){pe(oe,Te[2*re],Te[2*re+1])}function Ie(oe,re){for(var Te=0;Te|=1&oe,oe>>>=1,Te<<=1,0<--re;);return Te>>>1}function De(oe,re,Te){var Be,ke,lt=new Array(v+1),Rt=0;for(Be=1;Be<=v;Be++)lt[Be]=Rt=Rt+Te[Be-1]<<1;for(ke=0;ke<=re;ke++){var ft=oe[2*ke+1];ft!==0&&(oe[2*ke]=Ie(lt[ft]++,ft))}}function Se(oe){var re;for(re=0;re<h;re++)oe.dyn_ltree[2*re]=0;for(re=0;re<m;re++)oe.dyn_dtree[2*re]=0;for(re=0;re<y;re++)oe.bl_tree[2*re]=0;oe.dyn_ltree[2*S]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function Ce(oe){8<oe.bi_valid?se(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function qe(oe,re,Te,Be){var ke=2*re,lt=2*Te;return oe[ke]<oe[lt]||oe[ke]===oe[lt]&&Be[re]<=Be[Te]}function Qe(oe,re,Te){for(var Be=oe.heap[Te],ke=Te<<1;ke<=oe.heap_len&&(ke<oe.heap_len&&qe(re,oe.heap[ke+1],oe.heap[ke],oe.depth)&&ke++,!qe(re,Be,oe.heap[ke],oe.depth));)oe.heap[Te]=oe.heap[ke],Te=ke,ke<<=1;oe.heap[Te]=Be}function Ve(oe,re,Te){var Be,ke,lt,Rt,ft=0;if(oe.last_lit!==0)for(;Be=oe.pending_buf[oe.d_buf+2*ft]<<8|oe.pending_buf[oe.d_buf+2*ft+1],ke=oe.pending_buf[oe.l_buf+ft],ft++,Be===0?ce(oe,ke,re):(ce(oe,(lt=F[ke])+d+1,re),(Rt=R[lt])!==0&&pe(oe,ke-=X[lt],Rt),ce(oe,lt=ee(--Be),Te),(Rt=N[lt])!==0&&pe(oe,Be-=ne[lt],Rt)),ft<oe.last_lit;);ce(oe,S,re)}function Ne(oe,re){var Te,Be,ke,lt=re.dyn_tree,Rt=re.stat_desc.static_tree,ft=re.stat_desc.has_stree,jt=re.stat_desc.elems,qt=-1;for(oe.heap_len=0,oe.heap_max=b,Te=0;Te<jt;Te++)lt[2*Te]!==0?(oe.heap[++oe.heap_len]=qt=Te,oe.depth[Te]=0):lt[2*Te+1]=0;for(;oe.heap_len<2;)lt[2*(ke=oe.heap[++oe.heap_len]=qt<2?++qt:0)]=1,oe.depth[ke]=0,oe.opt_len--,ft&&(oe.static_len-=Rt[2*ke+1]);for(re.max_code=qt,Te=oe.heap_len>>1;1<=Te;Te--)Qe(oe,lt,Te);for(ke=jt;Te=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],Qe(oe,lt,1),Be=oe.heap[1],oe.heap[--oe.heap_max]=Te,oe.heap[--oe.heap_max]=Be,lt[2*ke]=lt[2*Te]+lt[2*Be],oe.depth[ke]=(oe.depth[Te]>=oe.depth[Be]?oe.depth[Te]:oe.depth[Be])+1,lt[2*Te+1]=lt[2*Be+1]=ke,oe.heap[1]=ke++,Qe(oe,lt,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(Lt,en){var xe,D,Z,ge,Fe,we,Me=en.dyn_tree,de=en.max_code,vt=en.stat_desc.static_tree,ot=en.stat_desc.has_stree,B=en.stat_desc.extra_bits,ze=en.stat_desc.extra_base,st=en.stat_desc.max_length,ye=0;for(ge=0;ge<=v;ge++)Lt.bl_count[ge]=0;for(Me[2*Lt.heap[Lt.heap_max]+1]=0,xe=Lt.heap_max+1;xe<b;xe++)st<(ge=Me[2*Me[2*(D=Lt.heap[xe])+1]+1]+1)&&(ge=st,ye++),Me[2*D+1]=ge,de<D||(Lt.bl_count[ge]++,Fe=0,ze<=D&&(Fe=B[D-ze]),we=Me[2*D],Lt.opt_len+=we*(ge+Fe),ot&&(Lt.static_len+=we*(vt[2*D+1]+Fe)));if(ye!==0){do{for(ge=st-1;Lt.bl_count[ge]===0;)ge--;Lt.bl_count[ge]--,Lt.bl_count[ge+1]+=2,Lt.bl_count[st]--,ye-=2}while(0<ye);for(ge=st;ge!==0;ge--)for(D=Lt.bl_count[ge];D!==0;)de<(Z=Lt.heap[--xe])||(Me[2*Z+1]!==ge&&(Lt.opt_len+=(ge-Me[2*Z+1])*Me[2*Z],Me[2*Z+1]=ge),D--)}}(oe,re),De(lt,qt,oe.bl_count)}function K(oe,re,Te){var Be,ke,lt=-1,Rt=re[1],ft=0,jt=7,qt=4;for(Rt===0&&(jt=138,qt=3),re[2*(Te+1)+1]=65535,Be=0;Be<=Te;Be++)ke=Rt,Rt=re[2*(Be+1)+1],++ft<jt&&ke===Rt||(ft<qt?oe.bl_tree[2*ke]+=ft:ke!==0?(ke!==lt&&oe.bl_tree[2*ke]++,oe.bl_tree[2*C]++):ft<=10?oe.bl_tree[2*k]++:oe.bl_tree[2*A]++,lt=ke,qt=(ft=0)===Rt?(jt=138,3):ke===Rt?(jt=6,3):(jt=7,4))}function me(oe,re,Te){var Be,ke,lt=-1,Rt=re[1],ft=0,jt=7,qt=4;for(Rt===0&&(jt=138,qt=3),Be=0;Be<=Te;Be++)if(ke=Rt,Rt=re[2*(Be+1)+1],!(++ft<jt&&ke===Rt)){if(ft<qt)for(;ce(oe,ke,oe.bl_tree),--ft!=0;);else ke!==0?(ke!==lt&&(ce(oe,ke,oe.bl_tree),ft--),ce(oe,C,oe.bl_tree),pe(oe,ft-3,2)):ft<=10?(ce(oe,k,oe.bl_tree),pe(oe,ft-3,3)):(ce(oe,A,oe.bl_tree),pe(oe,ft-11,7));lt=ke,qt=(ft=0)===Rt?(jt=138,3):ke===Rt?(jt=6,3):(jt=7,4)}}l(ne);var Ae=!1;function le(oe,re,Te,Be){pe(oe,(c<<1)+(Be?1:0),3),function(ke,lt,Rt,ft){Ce(ke),se(ke,Rt),se(ke,~Rt),i.arraySet(ke.pending_buf,ke.window,lt,Rt,ke.pending),ke.pending+=Rt}(oe,re,Te)}s._tr_init=function(oe){Ae||(function(){var re,Te,Be,ke,lt,Rt=new Array(v+1);for(ke=Be=0;ke<u-1;ke++)for(X[ke]=Be,re=0;re<1<<R[ke];re++)F[Be++]=ke;for(F[Be-1]=ke,ke=lt=0;ke<16;ke++)for(ne[ke]=lt,re=0;re<1<<N[ke];re++)V[lt++]=ke;for(lt>>=7;ke<m;ke++)for(ne[ke]=lt<<7,re=0;re<1<<N[ke]-7;re++)V[256+lt++]=ke;for(Te=0;Te<=v;Te++)Rt[Te]=0;for(re=0;re<=143;)L[2*re+1]=8,re++,Rt[8]++;for(;re<=255;)L[2*re+1]=9,re++,Rt[9]++;for(;re<=279;)L[2*re+1]=7,re++,Rt[7]++;for(;re<=287;)L[2*re+1]=8,re++,Rt[8]++;for(De(L,h+1,Rt),re=0;re<m;re++)P[2*re+1]=5,P[2*re]=Ie(re,5);U=new W(L,R,d+1,h,v),H=new W(P,N,0,m,v),$=new W(new Array(0),I,0,y,w)}(),Ae=!0),oe.l_desc=new Q(oe.dyn_ltree,U),oe.d_desc=new Q(oe.dyn_dtree,H),oe.bl_desc=new Q(oe.bl_tree,$),oe.bi_buf=0,oe.bi_valid=0,Se(oe)},s._tr_stored_block=le,s._tr_flush_block=function(oe,re,Te,Be){var ke,lt,Rt=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(ft){var jt,qt=4093624447;for(jt=0;jt<=31;jt++,qt>>>=1)if(1&qt&&ft.dyn_ltree[2*jt]!==0)return a;if(ft.dyn_ltree[18]!==0||ft.dyn_ltree[20]!==0||ft.dyn_ltree[26]!==0)return o;for(jt=32;jt<d;jt++)if(ft.dyn_ltree[2*jt]!==0)return o;return a}(oe)),Ne(oe,oe.l_desc),Ne(oe,oe.d_desc),Rt=function(ft){var jt;for(K(ft,ft.dyn_ltree,ft.l_desc.max_code),K(ft,ft.dyn_dtree,ft.d_desc.max_code),Ne(ft,ft.bl_desc),jt=y-1;3<=jt&&ft.bl_tree[2*O[jt]+1]===0;jt--);return ft.opt_len+=3*(jt+1)+5+5+4,jt}(oe),ke=oe.opt_len+3+7>>>3,(lt=oe.static_len+3+7>>>3)<=ke&&(ke=lt)):ke=lt=Te+5,Te+4<=ke&&re!==-1?le(oe,re,Te,Be):oe.strategy===4||lt===ke?(pe(oe,2+(Be?1:0),3),Ve(oe,L,P)):(pe(oe,4+(Be?1:0),3),function(ft,jt,qt,Lt){var en;for(pe(ft,jt-257,5),pe(ft,qt-1,5),pe(ft,Lt-4,4),en=0;en<Lt;en++)pe(ft,ft.bl_tree[2*O[en]+1],3);me(ft,ft.dyn_ltree,jt-1),me(ft,ft.dyn_dtree,qt-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,Rt+1),Ve(oe,oe.dyn_ltree,oe.dyn_dtree)),Se(oe),Be&&Ce(oe)},s._tr_tally=function(oe,re,Te){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=re>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&re,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Te,oe.last_lit++,re===0?oe.dyn_ltree[2*Te]++:(oe.matches++,re--,oe.dyn_ltree[2*(F[Te]+d+1)]++,oe.dyn_dtree[2*ee(re)]++),oe.last_lit===oe.lit_bufsize-1},s._tr_align=function(oe){pe(oe,2,3),ce(oe,S,L),function(re){re.bi_valid===16?(se(re,re.bi_buf),re.bi_buf=0,re.bi_valid=0):8<=re.bi_valid&&(re.pending_buf[re.pending++]=255&re.bi_buf,re.bi_buf>>=8,re.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(a,o){if(!a.setImmediate){var l,c,u,d,h=1,m={},y=!1,b=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(C){Ai.nextTick(function(){w(C)})}:function(){if(a.postMessage&&!a.importScripts){var C=!0,k=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=k,C}}()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(C){a.postMessage(d+C,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(C){w(C.data)},function(C){u.port2.postMessage(C)}):b&&"onreadystatechange"in b.createElement("script")?(c=b.documentElement,function(C){var k=b.createElement("script");k.onreadystatechange=function(){w(C),k.onreadystatechange=null,c.removeChild(k),k=null},c.appendChild(k)}):function(C){setTimeout(w,0,C)},v.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var k=new Array(arguments.length-1),A=0;A<k.length;A++)k[A]=arguments[A+1];var R={callback:C,args:k};return m[h]=R,l(h),h++},v.clearImmediate=x}function x(C){delete m[C]}function w(C){if(y)setTimeout(w,0,C);else{var k=m[C];if(k){y=!0;try{(function(A){var R=A.callback,N=A.args;switch(N.length){case 0:R();break;case 1:R(N[0]);break;case 2:R(N[0],N[1]);break;case 3:R(N[0],N[1],N[2]);break;default:R.apply(o,N)}})(k)}finally{x(C),y=!1}}}}function S(C){C.source===a&&typeof C.data=="string"&&C.data.indexOf(d)===0&&w(+C.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof zp<"u"?zp:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(CM)),CM.exports}var f2e=d2e();const XP=_a(f2e),nw=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+s[i]},zr=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},Au=(...e)=>zr(e.map(t=>t.trim()).filter(Boolean).join("/")),GE=e=>{const t=zr(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},gi=e=>{const t=zr(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},Sj=(e,t)=>zr(e==="/"?`/${t}`:`${e}/${t}`);var kM,T9;function h2e(){if(T9)return kM;T9=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof Ai>"u"||typeof Ai.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,a=null,o=null;typeof r!="function"&&(s=r,r=null,o=new this.Promise(function(S,C){i=S,a=C})),s=s||{};var l=!1,c=null,u=null,d=null,h=this,m=function(S,C,k){u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),S&&(h.queues[t]&&h.queues[t].length===0&&delete h.queues[t],h.domainReentrant&&delete h.domains[t]),l||(o?C?a(C):i(k):typeof r=="function"&&r(C,k),l=!0),S&&h.queues[t]&&h.queues[t].length>0&&h.queues[t].shift()()},y=function(S){if(l)return m(S);c&&(clearTimeout(c),c=null),h.domainReentrant&&S&&(h.domains[t]=Ai.domain);var C=s.maxExecutionTime||h.maxExecutionTime;if(C&&(d=setTimeout(function(){h.queues[t]&&m(S,new Error("Maximum execution time is exceeded "+t))},C)),n.length===1){var k=!1;try{n(function(A,R){k||(k=!0,m(S,A,R))})}catch(A){k||(k=!0,m(S,A))}}else h._promiseTry(function(){return n()}).then(function(A){m(S,void 0,A)},function(A){m(S,A)})};h.domainReentrant&&Ai.domain&&(y=Ai.domain.bind(y));var b=s.maxPending||h.maxPending;if(!h.queues[t])h.queues[t]=[],y(!0);else if(h.domainReentrant&&Ai.domain&&Ai.domain===h.domains[t])y(!1);else if(h.queues[t].length>=b)m(!1,new Error("Too many pending tasks in queue "+t));else{var v=function(){y(!0)};s.skipQueue?h.queues[t].unshift(v):h.queues[t].push(v);var x=s.timeout||h.timeout;x&&(c=setTimeout(function(){c=null,m(!1,new Error("async-lock timed out in queue "+t))},x))}var w=s.maxOccupationTime||h.maxOccupationTime;if(w&&(u=setTimeout(function(){h.queues[t]&&m(!1,new Error("Maximum occupation time is exceeded in queue "+t))},w)),o)return o},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,a=function(l,c){return function(u){i.acquire(l,c,u,s)}},o=t.reduceRight(function(l,c){return a(c,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,c){o.length===1?o(function(u,d){u?c(u):l(d)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},kM=e,kM}var EM,A9;function p2e(){return A9||(A9=1,EM=h2e()),EM}var m2e=p2e();const rw=_a(m2e);var jS={exports:{}},R9;function g2e(){return R9||(R9=1,typeof Object.create=="function"?jS.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:jS.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),jS.exports}var TM,N9;function y2e(){if(N9)return TM;N9=1;var e=$P().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var s=this._block,i=this._blockSize,a=n.length,o=this._len,l=0;l<a;){for(var c=o%i,u=Math.min(a-l,i-c),d=0;d<u;d++)s[c+d]=n[l+d];o+=u,l+=u,o%i===0&&this._update(s)}return this._len+=a,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var s=this._len*8;if(s<=4294967295)this._block.writeUInt32BE(s,this._blockSize-4);else{var i=(s&4294967295)>>>0,a=(s-i)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},TM=t,TM}var AM,M9;function b2e(){if(M9)return AM;M9=1;var e=g2e(),t=y2e(),n=$P().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function i(){this.init(),this._w=s,t.call(this,64,56)}e(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function a(u){return u<<1|u>>>31}function o(u){return u<<5|u>>>27}function l(u){return u<<30|u>>>2}function c(u,d,h,m){return u===0?d&h|~d&m:u===2?d&h|d&m|h&m:d^h^m}return i.prototype._update=function(u){for(var d=this._w,h=this._a|0,m=this._b|0,y=this._c|0,b=this._d|0,v=this._e|0,x=0;x<16;++x)d[x]=u.readInt32BE(x*4);for(;x<80;++x)d[x]=a(d[x-3]^d[x-8]^d[x-14]^d[x-16]);for(var w=0;w<80;++w){var S=~~(w/20),C=o(h)+c(S,m,y,b)+v+d[w]+r[S]|0;v=b,b=y,y=l(m),m=h,h=C}this._a=h+this._a|0,this._b=m+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=v+this._e|0},i.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},AM=i,AM}var v2e=b2e();const vY=_a(v2e);var RM,I9;function x2e(){if(I9)return RM;I9=1;function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(s))}function t(s,i){for(var a="",o=0,l=-1,c=0,u,d=0;d<=s.length;++d){if(d<s.length)u=s.charCodeAt(d);else{if(u===47)break;u=47}if(u===47){if(!(l===d-1||c===1))if(l!==d-1&&c===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var h=a.lastIndexOf("/");if(h!==a.length-1){h===-1?(a="",o=0):(a=a.slice(0,h),o=a.length-1-a.lastIndexOf("/")),l=d,c=0;continue}}else if(a.length===2||a.length===1){a="",o=0,l=d,c=0;continue}}i&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+s.slice(l+1,d):a=s.slice(l+1,d),o=d-l-1;l=d,c=0}else u===46&&c!==-1?++c:c=-1}return a}function n(s,i){var a=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return a?a===i.root?a+o:a+s+o:o}var r={resolve:function(){for(var i="",a=!1,o,l=arguments.length-1;l>=-1&&!a;l--){var c;l>=0?c=arguments[l]:(o===void 0&&(o=Ai.cwd()),c=o),e(c),c.length!==0&&(i=c+"/"+i,a=c.charCodeAt(0)===47)}return i=t(i,!a),a?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(e(i),i.length===0)return".";var a=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!a),i.length===0&&!a&&(i="."),i.length>0&&o&&(i+="/"),a?"/"+i:i},isAbsolute:function(i){return e(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,a=0;a<arguments.length;++a){var o=arguments[a];e(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":r.normalize(i)},relative:function(i,a){if(e(i),e(a),i===a||(i=r.resolve(i),a=r.resolve(a),i===a))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var l=i.length,c=l-o,u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var d=a.length,h=d-u,m=c<h?c:h,y=-1,b=0;b<=m;++b){if(b===m){if(h>m){if(a.charCodeAt(u+b)===47)return a.slice(u+b+1);if(b===0)return a.slice(u+b)}else c>m&&(i.charCodeAt(o+b)===47?y=b:b===0&&(y=0));break}var v=i.charCodeAt(o+b),x=a.charCodeAt(u+b);if(v!==x)break;v===47&&(y=b)}var w="";for(b=o+y+1;b<=l;++b)(b===l||i.charCodeAt(b)===47)&&(w.length===0?w+="..":w+="/..");return w.length>0?w+a.slice(u+y):(u+=y,a.charCodeAt(u)===47&&++u,a.slice(u))},_makeLong:function(i){return i},dirname:function(i){if(e(i),i.length===0)return".";for(var a=i.charCodeAt(0),o=a===47,l=-1,c=!0,u=i.length-1;u>=1;--u)if(a=i.charCodeAt(u),a===47){if(!c){l=u;break}}else c=!1;return l===-1?o?"/":".":o&&l===1?"//":i.slice(0,l)},basename:function(i,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(i);var o=0,l=-1,c=!0,u;if(a!==void 0&&a.length>0&&a.length<=i.length){if(a.length===i.length&&a===i)return"";var d=a.length-1,h=-1;for(u=i.length-1;u>=0;--u){var m=i.charCodeAt(u);if(m===47){if(!c){o=u+1;break}}else h===-1&&(c=!1,h=u+1),d>=0&&(m===a.charCodeAt(d)?--d===-1&&(l=u):(d=-1,l=h))}return o===l?l=h:l===-1&&(l=i.length),i.slice(o,l)}else{for(u=i.length-1;u>=0;--u)if(i.charCodeAt(u)===47){if(!c){o=u+1;break}}else l===-1&&(c=!1,l=u+1);return l===-1?"":i.slice(o,l)}},extname:function(i){e(i);for(var a=-1,o=0,l=-1,c=!0,u=0,d=i.length-1;d>=0;--d){var h=i.charCodeAt(d);if(h===47){if(!c){o=d+1;break}continue}l===-1&&(c=!1,l=d+1),h===46?a===-1?a=d:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?"":i.slice(a,l)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return n("/",i)},parse:function(i){e(i);var a={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return a;var o=i.charCodeAt(0),l=o===47,c;l?(a.root="/",c=1):c=0;for(var u=-1,d=0,h=-1,m=!0,y=i.length-1,b=0;y>=c;--y){if(o=i.charCodeAt(y),o===47){if(!m){d=y+1;break}continue}h===-1&&(m=!1,h=y+1),o===46?u===-1?u=y:b!==1&&(b=1):u!==-1&&(b=-1)}return u===-1||h===-1||b===0||b===1&&u===h-1&&u===d+1?h!==-1&&(d===0&&l?a.base=a.name=i.slice(1,h):a.base=a.name=i.slice(d,h)):(d===0&&l?(a.name=i.slice(1,u),a.base=i.slice(1,h)):(a.name=i.slice(d,u),a.base=i.slice(d,h)),a.ext=i.slice(u,h)),d>0?a.dir=i.slice(0,d-1):l&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,RM=r,RM}var $t=x2e(),NM={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var j9;function w2e(){return j9||(j9=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var N=0,I=new Array(256),O=0;O!=256;++O)N=O,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,I[O]=N;return typeof Int32Array<"u"?new Int32Array(I):I}var r=n();function s(N){var I=0,O=0,L=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)P[L]=N[L];for(L=0;L!=256;++L)for(O=N[L],I=256+L;I<4096;I+=256)O=P[I]=O>>>8^N[O&255];var V=[];for(L=1;L!=16;++L)V[L-1]=typeof Int32Array<"u"?P.subarray(L*256,L*256+256):P.slice(L*256,L*256+256);return V}var i=s(r),a=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],m=i[7],y=i[8],b=i[9],v=i[10],x=i[11],w=i[12],S=i[13],C=i[14];function k(N,I){for(var O=I^-1,L=0,P=N.length;L<P;)O=O>>>8^r[(O^N.charCodeAt(L++))&255];return~O}function A(N,I){for(var O=I^-1,L=N.length-15,P=0;P<L;)O=C[N[P++]^O&255]^S[N[P++]^O>>8&255]^w[N[P++]^O>>16&255]^x[N[P++]^O>>>24]^v[N[P++]]^b[N[P++]]^y[N[P++]]^m[N[P++]]^h[N[P++]]^d[N[P++]]^u[N[P++]]^c[N[P++]]^l[N[P++]]^o[N[P++]]^a[N[P++]]^r[N[P++]];for(L+=15;P<L;)O=O>>>8^r[(O^N[P++])&255];return~O}function R(N,I){for(var O=I^-1,L=0,P=N.length,V=0,F=0;L<P;)V=N.charCodeAt(L++),V<128?O=O>>>8^r[(O^V)&255]:V<2048?(O=O>>>8^r[(O^(192|V>>6&31))&255],O=O>>>8^r[(O^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,F=N.charCodeAt(L++)&1023,O=O>>>8^r[(O^(240|V>>8&7))&255],O=O>>>8^r[(O^(128|V>>2&63))&255],O=O>>>8^r[(O^(128|F>>6&15|(V&3)<<4))&255],O=O>>>8^r[(O^(128|F&63))&255]):(O=O>>>8^r[(O^(224|V>>12&15))&255],O=O>>>8^r[(O^(128|V>>6&63))&255],O=O>>>8^r[(O^(128|V&63))&255]);return~O}t.table=r,t.bstr=k,t.buf=A,t.str=R})}(NM)),NM}var _2e=w2e();const S2e=_a(_2e);var MM={},O9;function Wh(){return O9||(O9=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(i,a){return Object.prototype.hasOwnProperty.call(i,a)}e.assign=function(i){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(i[l]=o[l])}}return i},e.shrinkBuf=function(i,a){return i.length===a?i:i.subarray?i.subarray(0,a):(i.length=a,i)};var r={arraySet:function(i,a,o,l,c){if(a.subarray&&i.subarray){i.set(a.subarray(o,o+l),c);return}for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){var a,o,l,c,u,d;for(l=0,a=0,o=i.length;a<o;a++)l+=i[a].length;for(d=new Uint8Array(l),c=0,a=0,o=i.length;a<o;a++)u=i[a],d.set(u,c),c+=u.length;return d}},s={arraySet:function(i,a,o,l,c){for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){return[].concat.apply([],i)}};e.setTyped=function(i){i?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)}(MM)),MM}var Hg={},rc={},Ap={},P9;function C2e(){if(P9)return Ap;P9=1;var e=Wh(),t=4,n=0,r=1,s=2;function i(D){for(var Z=D.length;--Z>=0;)D[Z]=0}var a=0,o=1,l=2,c=3,u=258,d=29,h=256,m=h+1+d,y=30,b=19,v=2*m+1,x=15,w=16,S=7,C=256,k=16,A=17,R=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,V=new Array((m+2)*2);i(V);var F=new Array(y*2);i(F);var X=new Array(P);i(X);var U=new Array(u-c+1);i(U);var H=new Array(d);i(H);var $=new Array(y);i($);function ne(D,Z,ge,Fe,we){this.static_tree=D,this.extra_bits=Z,this.extra_base=ge,this.elems=Fe,this.max_length=we,this.has_stree=D&&D.length}var W,Q,ee;function se(D,Z){this.dyn_tree=D,this.max_code=0,this.stat_desc=Z}function pe(D){return D<256?X[D]:X[256+(D>>>7)]}function ce(D,Z){D.pending_buf[D.pending++]=Z&255,D.pending_buf[D.pending++]=Z>>>8&255}function Ie(D,Z,ge){D.bi_valid>w-ge?(D.bi_buf|=Z<<D.bi_valid&65535,ce(D,D.bi_buf),D.bi_buf=Z>>w-D.bi_valid,D.bi_valid+=ge-w):(D.bi_buf|=Z<<D.bi_valid&65535,D.bi_valid+=ge)}function De(D,Z,ge){Ie(D,ge[Z*2],ge[Z*2+1])}function Se(D,Z){var ge=0;do ge|=D&1,D>>>=1,ge<<=1;while(--Z>0);return ge>>>1}function Ce(D){D.bi_valid===16?(ce(D,D.bi_buf),D.bi_buf=0,D.bi_valid=0):D.bi_valid>=8&&(D.pending_buf[D.pending++]=D.bi_buf&255,D.bi_buf>>=8,D.bi_valid-=8)}function qe(D,Z){var ge=Z.dyn_tree,Fe=Z.max_code,we=Z.stat_desc.static_tree,Me=Z.stat_desc.has_stree,de=Z.stat_desc.extra_bits,vt=Z.stat_desc.extra_base,ot=Z.stat_desc.max_length,B,ze,st,ye,_e,Ue,kt=0;for(ye=0;ye<=x;ye++)D.bl_count[ye]=0;for(ge[D.heap[D.heap_max]*2+1]=0,B=D.heap_max+1;B<v;B++)ze=D.heap[B],ye=ge[ge[ze*2+1]*2+1]+1,ye>ot&&(ye=ot,kt++),ge[ze*2+1]=ye,!(ze>Fe)&&(D.bl_count[ye]++,_e=0,ze>=vt&&(_e=de[ze-vt]),Ue=ge[ze*2],D.opt_len+=Ue*(ye+_e),Me&&(D.static_len+=Ue*(we[ze*2+1]+_e)));if(kt!==0){do{for(ye=ot-1;D.bl_count[ye]===0;)ye--;D.bl_count[ye]--,D.bl_count[ye+1]+=2,D.bl_count[ot]--,kt-=2}while(kt>0);for(ye=ot;ye!==0;ye--)for(ze=D.bl_count[ye];ze!==0;)st=D.heap[--B],!(st>Fe)&&(ge[st*2+1]!==ye&&(D.opt_len+=(ye-ge[st*2+1])*ge[st*2],ge[st*2+1]=ye),ze--)}}function Qe(D,Z,ge){var Fe=new Array(x+1),we=0,Me,de;for(Me=1;Me<=x;Me++)Fe[Me]=we=we+ge[Me-1]<<1;for(de=0;de<=Z;de++){var vt=D[de*2+1];vt!==0&&(D[de*2]=Se(Fe[vt]++,vt))}}function Ve(){var D,Z,ge,Fe,we,Me=new Array(x+1);for(ge=0,Fe=0;Fe<d-1;Fe++)for(H[Fe]=ge,D=0;D<1<<N[Fe];D++)U[ge++]=Fe;for(U[ge-1]=Fe,we=0,Fe=0;Fe<16;Fe++)for($[Fe]=we,D=0;D<1<<I[Fe];D++)X[we++]=Fe;for(we>>=7;Fe<y;Fe++)for($[Fe]=we<<7,D=0;D<1<<I[Fe]-7;D++)X[256+we++]=Fe;for(Z=0;Z<=x;Z++)Me[Z]=0;for(D=0;D<=143;)V[D*2+1]=8,D++,Me[8]++;for(;D<=255;)V[D*2+1]=9,D++,Me[9]++;for(;D<=279;)V[D*2+1]=7,D++,Me[7]++;for(;D<=287;)V[D*2+1]=8,D++,Me[8]++;for(Qe(V,m+1,Me),D=0;D<y;D++)F[D*2+1]=5,F[D*2]=Se(D,5);W=new ne(V,N,h+1,m,x),Q=new ne(F,I,0,y,x),ee=new ne(new Array(0),O,0,b,S)}function Ne(D){var Z;for(Z=0;Z<m;Z++)D.dyn_ltree[Z*2]=0;for(Z=0;Z<y;Z++)D.dyn_dtree[Z*2]=0;for(Z=0;Z<b;Z++)D.bl_tree[Z*2]=0;D.dyn_ltree[C*2]=1,D.opt_len=D.static_len=0,D.last_lit=D.matches=0}function K(D){D.bi_valid>8?ce(D,D.bi_buf):D.bi_valid>0&&(D.pending_buf[D.pending++]=D.bi_buf),D.bi_buf=0,D.bi_valid=0}function me(D,Z,ge,Fe){K(D),ce(D,ge),ce(D,~ge),e.arraySet(D.pending_buf,D.window,Z,ge,D.pending),D.pending+=ge}function Ae(D,Z,ge,Fe){var we=Z*2,Me=ge*2;return D[we]<D[Me]||D[we]===D[Me]&&Fe[Z]<=Fe[ge]}function le(D,Z,ge){for(var Fe=D.heap[ge],we=ge<<1;we<=D.heap_len&&(we<D.heap_len&&Ae(Z,D.heap[we+1],D.heap[we],D.depth)&&we++,!Ae(Z,Fe,D.heap[we],D.depth));)D.heap[ge]=D.heap[we],ge=we,we<<=1;D.heap[ge]=Fe}function oe(D,Z,ge){var Fe,we,Me=0,de,vt;if(D.last_lit!==0)do Fe=D.pending_buf[D.d_buf+Me*2]<<8|D.pending_buf[D.d_buf+Me*2+1],we=D.pending_buf[D.l_buf+Me],Me++,Fe===0?De(D,we,Z):(de=U[we],De(D,de+h+1,Z),vt=N[de],vt!==0&&(we-=H[de],Ie(D,we,vt)),Fe--,de=pe(Fe),De(D,de,ge),vt=I[de],vt!==0&&(Fe-=$[de],Ie(D,Fe,vt)));while(Me<D.last_lit);De(D,C,Z)}function re(D,Z){var ge=Z.dyn_tree,Fe=Z.stat_desc.static_tree,we=Z.stat_desc.has_stree,Me=Z.stat_desc.elems,de,vt,ot=-1,B;for(D.heap_len=0,D.heap_max=v,de=0;de<Me;de++)ge[de*2]!==0?(D.heap[++D.heap_len]=ot=de,D.depth[de]=0):ge[de*2+1]=0;for(;D.heap_len<2;)B=D.heap[++D.heap_len]=ot<2?++ot:0,ge[B*2]=1,D.depth[B]=0,D.opt_len--,we&&(D.static_len-=Fe[B*2+1]);for(Z.max_code=ot,de=D.heap_len>>1;de>=1;de--)le(D,ge,de);B=Me;do de=D.heap[1],D.heap[1]=D.heap[D.heap_len--],le(D,ge,1),vt=D.heap[1],D.heap[--D.heap_max]=de,D.heap[--D.heap_max]=vt,ge[B*2]=ge[de*2]+ge[vt*2],D.depth[B]=(D.depth[de]>=D.depth[vt]?D.depth[de]:D.depth[vt])+1,ge[de*2+1]=ge[vt*2+1]=B,D.heap[1]=B++,le(D,ge,1);while(D.heap_len>=2);D.heap[--D.heap_max]=D.heap[1],qe(D,Z),Qe(ge,ot,D.bl_count)}function Te(D,Z,ge){var Fe,we=-1,Me,de=Z[0*2+1],vt=0,ot=7,B=4;for(de===0&&(ot=138,B=3),Z[(ge+1)*2+1]=65535,Fe=0;Fe<=ge;Fe++)Me=de,de=Z[(Fe+1)*2+1],!(++vt<ot&&Me===de)&&(vt<B?D.bl_tree[Me*2]+=vt:Me!==0?(Me!==we&&D.bl_tree[Me*2]++,D.bl_tree[k*2]++):vt<=10?D.bl_tree[A*2]++:D.bl_tree[R*2]++,vt=0,we=Me,de===0?(ot=138,B=3):Me===de?(ot=6,B=3):(ot=7,B=4))}function Be(D,Z,ge){var Fe,we=-1,Me,de=Z[0*2+1],vt=0,ot=7,B=4;for(de===0&&(ot=138,B=3),Fe=0;Fe<=ge;Fe++)if(Me=de,de=Z[(Fe+1)*2+1],!(++vt<ot&&Me===de)){if(vt<B)do De(D,Me,D.bl_tree);while(--vt!==0);else Me!==0?(Me!==we&&(De(D,Me,D.bl_tree),vt--),De(D,k,D.bl_tree),Ie(D,vt-3,2)):vt<=10?(De(D,A,D.bl_tree),Ie(D,vt-3,3)):(De(D,R,D.bl_tree),Ie(D,vt-11,7));vt=0,we=Me,de===0?(ot=138,B=3):Me===de?(ot=6,B=3):(ot=7,B=4)}}function ke(D){var Z;for(Te(D,D.dyn_ltree,D.l_desc.max_code),Te(D,D.dyn_dtree,D.d_desc.max_code),re(D,D.bl_desc),Z=b-1;Z>=3&&D.bl_tree[L[Z]*2+1]===0;Z--);return D.opt_len+=3*(Z+1)+5+5+4,Z}function lt(D,Z,ge,Fe){var we;for(Ie(D,Z-257,5),Ie(D,ge-1,5),Ie(D,Fe-4,4),we=0;we<Fe;we++)Ie(D,D.bl_tree[L[we]*2+1],3);Be(D,D.dyn_ltree,Z-1),Be(D,D.dyn_dtree,ge-1)}function Rt(D){var Z=4093624447,ge;for(ge=0;ge<=31;ge++,Z>>>=1)if(Z&1&&D.dyn_ltree[ge*2]!==0)return n;if(D.dyn_ltree[9*2]!==0||D.dyn_ltree[10*2]!==0||D.dyn_ltree[13*2]!==0)return r;for(ge=32;ge<h;ge++)if(D.dyn_ltree[ge*2]!==0)return r;return n}var ft=!1;function jt(D){ft||(Ve(),ft=!0),D.l_desc=new se(D.dyn_ltree,W),D.d_desc=new se(D.dyn_dtree,Q),D.bl_desc=new se(D.bl_tree,ee),D.bi_buf=0,D.bi_valid=0,Ne(D)}function qt(D,Z,ge,Fe){Ie(D,(a<<1)+(Fe?1:0),3),me(D,Z,ge)}function Lt(D){Ie(D,o<<1,3),De(D,C,V),Ce(D)}function en(D,Z,ge,Fe){var we,Me,de=0;D.level>0?(D.strm.data_type===s&&(D.strm.data_type=Rt(D)),re(D,D.l_desc),re(D,D.d_desc),de=ke(D),we=D.opt_len+3+7>>>3,Me=D.static_len+3+7>>>3,Me<=we&&(we=Me)):we=Me=ge+5,ge+4<=we&&Z!==-1?qt(D,Z,ge,Fe):D.strategy===t||Me===we?(Ie(D,(o<<1)+(Fe?1:0),3),oe(D,V,F)):(Ie(D,(l<<1)+(Fe?1:0),3),lt(D,D.l_desc.max_code+1,D.d_desc.max_code+1,de+1),oe(D,D.dyn_ltree,D.dyn_dtree)),Ne(D),Fe&&K(D)}function xe(D,Z,ge){return D.pending_buf[D.d_buf+D.last_lit*2]=Z>>>8&255,D.pending_buf[D.d_buf+D.last_lit*2+1]=Z&255,D.pending_buf[D.l_buf+D.last_lit]=ge&255,D.last_lit++,Z===0?D.dyn_ltree[ge*2]++:(D.matches++,Z--,D.dyn_ltree[(U[ge]+h+1)*2]++,D.dyn_dtree[pe(Z)*2]++),D.last_lit===D.lit_bufsize-1}return Ap._tr_init=jt,Ap._tr_stored_block=qt,Ap._tr_flush_block=en,Ap._tr_tally=xe,Ap._tr_align=Lt,Ap}var IM,D9;function xY(){if(D9)return IM;D9=1;function e(t,n,r,s){for(var i=t&65535|0,a=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+n[s++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}return IM=e,IM}var jM,F9;function wY(){if(F9)return jM;F9=1;function e(){for(var r,s=[],i=0;i<256;i++){r=i;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;s[i]=r}return s}var t=e();function n(r,s,i,a){var o=t,l=a+i;r^=-1;for(var c=a;c<l;c++)r=r>>>8^o[(r^s[c])&255];return r^-1}return jM=n,jM}var OM,L9;function JP(){return L9||(L9=1,OM={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),OM}var B9;function k2e(){if(B9)return rc;B9=1;var e=Wh(),t=C2e(),n=xY(),r=wY(),s=JP(),i=0,a=1,o=3,l=4,c=5,u=0,d=1,h=-2,m=-3,y=-5,b=-1,v=1,x=2,w=3,S=4,C=0,k=2,A=8,R=9,N=15,I=8,O=29,L=256,P=L+1+O,V=30,F=19,X=2*P+1,U=15,H=3,$=258,ne=$+H+1,W=32,Q=42,ee=69,se=73,pe=91,ce=103,Ie=113,De=666,Se=1,Ce=2,qe=3,Qe=4,Ve=3;function Ne(B,ze){return B.msg=s[ze],ze}function K(B){return(B<<1)-(B>4?9:0)}function me(B){for(var ze=B.length;--ze>=0;)B[ze]=0}function Ae(B){var ze=B.state,st=ze.pending;st>B.avail_out&&(st=B.avail_out),st!==0&&(e.arraySet(B.output,ze.pending_buf,ze.pending_out,st,B.next_out),B.next_out+=st,ze.pending_out+=st,B.total_out+=st,B.avail_out-=st,ze.pending-=st,ze.pending===0&&(ze.pending_out=0))}function le(B,ze){t._tr_flush_block(B,B.block_start>=0?B.block_start:-1,B.strstart-B.block_start,ze),B.block_start=B.strstart,Ae(B.strm)}function oe(B,ze){B.pending_buf[B.pending++]=ze}function re(B,ze){B.pending_buf[B.pending++]=ze>>>8&255,B.pending_buf[B.pending++]=ze&255}function Te(B,ze,st,ye){var _e=B.avail_in;return _e>ye&&(_e=ye),_e===0?0:(B.avail_in-=_e,e.arraySet(ze,B.input,B.next_in,_e,st),B.state.wrap===1?B.adler=n(B.adler,ze,_e,st):B.state.wrap===2&&(B.adler=r(B.adler,ze,_e,st)),B.next_in+=_e,B.total_in+=_e,_e)}function Be(B,ze){var st=B.max_chain_length,ye=B.strstart,_e,Ue,kt=B.prev_length,fe=B.nice_match,Y=B.strstart>B.w_size-ne?B.strstart-(B.w_size-ne):0,G=B.window,J=B.w_mask,be=B.prev,Pe=B.strstart+$,Ge=G[ye+kt-1],_t=G[ye+kt];B.prev_length>=B.good_match&&(st>>=2),fe>B.lookahead&&(fe=B.lookahead);do if(_e=ze,!(G[_e+kt]!==_t||G[_e+kt-1]!==Ge||G[_e]!==G[ye]||G[++_e]!==G[ye+1])){ye+=2,_e++;do;while(G[++ye]===G[++_e]&&G[++ye]===G[++_e]&&G[++ye]===G[++_e]&&G[++ye]===G[++_e]&&G[++ye]===G[++_e]&&G[++ye]===G[++_e]&&G[++ye]===G[++_e]&&G[++ye]===G[++_e]&&ye<Pe);if(Ue=$-(Pe-ye),ye=Pe-$,Ue>kt){if(B.match_start=ze,kt=Ue,Ue>=fe)break;Ge=G[ye+kt-1],_t=G[ye+kt]}}while((ze=be[ze&J])>Y&&--st!==0);return kt<=B.lookahead?kt:B.lookahead}function ke(B){var ze=B.w_size,st,ye,_e,Ue,kt;do{if(Ue=B.window_size-B.lookahead-B.strstart,B.strstart>=ze+(ze-ne)){e.arraySet(B.window,B.window,ze,ze,0),B.match_start-=ze,B.strstart-=ze,B.block_start-=ze,ye=B.hash_size,st=ye;do _e=B.head[--st],B.head[st]=_e>=ze?_e-ze:0;while(--ye);ye=ze,st=ye;do _e=B.prev[--st],B.prev[st]=_e>=ze?_e-ze:0;while(--ye);Ue+=ze}if(B.strm.avail_in===0)break;if(ye=Te(B.strm,B.window,B.strstart+B.lookahead,Ue),B.lookahead+=ye,B.lookahead+B.insert>=H)for(kt=B.strstart-B.insert,B.ins_h=B.window[kt],B.ins_h=(B.ins_h<<B.hash_shift^B.window[kt+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[kt+H-1])&B.hash_mask,B.prev[kt&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=kt,kt++,B.insert--,!(B.lookahead+B.insert<H)););}while(B.lookahead<ne&&B.strm.avail_in!==0)}function lt(B,ze){var st=65535;for(st>B.pending_buf_size-5&&(st=B.pending_buf_size-5);;){if(B.lookahead<=1){if(ke(B),B.lookahead===0&&ze===i)return Se;if(B.lookahead===0)break}B.strstart+=B.lookahead,B.lookahead=0;var ye=B.block_start+st;if((B.strstart===0||B.strstart>=ye)&&(B.lookahead=B.strstart-ye,B.strstart=ye,le(B,!1),B.strm.avail_out===0)||B.strstart-B.block_start>=B.w_size-ne&&(le(B,!1),B.strm.avail_out===0))return Se}return B.insert=0,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):(B.strstart>B.block_start&&(le(B,!1),B.strm.avail_out===0),Se)}function Rt(B,ze){for(var st,ye;;){if(B.lookahead<ne){if(ke(B),B.lookahead<ne&&ze===i)return Se;if(B.lookahead===0)break}if(st=0,B.lookahead>=H&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+H-1])&B.hash_mask,st=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),st!==0&&B.strstart-st<=B.w_size-ne&&(B.match_length=Be(B,st)),B.match_length>=H)if(ye=t._tr_tally(B,B.strstart-B.match_start,B.match_length-H),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=H){B.match_length--;do B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+H-1])&B.hash_mask,st=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart;while(--B.match_length!==0);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else ye=t._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(ye&&(le(B,!1),B.strm.avail_out===0))return Se}return B.insert=B.strstart<H-1?B.strstart:H-1,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):B.last_lit&&(le(B,!1),B.strm.avail_out===0)?Se:Ce}function ft(B,ze){for(var st,ye,_e;;){if(B.lookahead<ne){if(ke(B),B.lookahead<ne&&ze===i)return Se;if(B.lookahead===0)break}if(st=0,B.lookahead>=H&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+H-1])&B.hash_mask,st=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=H-1,st!==0&&B.prev_length<B.max_lazy_match&&B.strstart-st<=B.w_size-ne&&(B.match_length=Be(B,st),B.match_length<=5&&(B.strategy===v||B.match_length===H&&B.strstart-B.match_start>4096)&&(B.match_length=H-1)),B.prev_length>=H&&B.match_length<=B.prev_length){_e=B.strstart+B.lookahead-H,ye=t._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-H),B.lookahead-=B.prev_length-1,B.prev_length-=2;do++B.strstart<=_e&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+H-1])&B.hash_mask,st=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart);while(--B.prev_length!==0);if(B.match_available=0,B.match_length=H-1,B.strstart++,ye&&(le(B,!1),B.strm.avail_out===0))return Se}else if(B.match_available){if(ye=t._tr_tally(B,0,B.window[B.strstart-1]),ye&&le(B,!1),B.strstart++,B.lookahead--,B.strm.avail_out===0)return Se}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(ye=t._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<H-1?B.strstart:H-1,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):B.last_lit&&(le(B,!1),B.strm.avail_out===0)?Se:Ce}function jt(B,ze){for(var st,ye,_e,Ue,kt=B.window;;){if(B.lookahead<=$){if(ke(B),B.lookahead<=$&&ze===i)return Se;if(B.lookahead===0)break}if(B.match_length=0,B.lookahead>=H&&B.strstart>0&&(_e=B.strstart-1,ye=kt[_e],ye===kt[++_e]&&ye===kt[++_e]&&ye===kt[++_e])){Ue=B.strstart+$;do;while(ye===kt[++_e]&&ye===kt[++_e]&&ye===kt[++_e]&&ye===kt[++_e]&&ye===kt[++_e]&&ye===kt[++_e]&&ye===kt[++_e]&&ye===kt[++_e]&&_e<Ue);B.match_length=$-(Ue-_e),B.match_length>B.lookahead&&(B.match_length=B.lookahead)}if(B.match_length>=H?(st=t._tr_tally(B,1,B.match_length-H),B.lookahead-=B.match_length,B.strstart+=B.match_length,B.match_length=0):(st=t._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++),st&&(le(B,!1),B.strm.avail_out===0))return Se}return B.insert=0,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):B.last_lit&&(le(B,!1),B.strm.avail_out===0)?Se:Ce}function qt(B,ze){for(var st;;){if(B.lookahead===0&&(ke(B),B.lookahead===0)){if(ze===i)return Se;break}if(B.match_length=0,st=t._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++,st&&(le(B,!1),B.strm.avail_out===0))return Se}return B.insert=0,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):B.last_lit&&(le(B,!1),B.strm.avail_out===0)?Se:Ce}function Lt(B,ze,st,ye,_e){this.good_length=B,this.max_lazy=ze,this.nice_length=st,this.max_chain=ye,this.func=_e}var en;en=[new Lt(0,0,0,0,lt),new Lt(4,4,8,4,Rt),new Lt(4,5,16,8,Rt),new Lt(4,6,32,32,Rt),new Lt(4,4,16,16,ft),new Lt(8,16,32,32,ft),new Lt(8,16,128,128,ft),new Lt(8,32,128,256,ft),new Lt(32,128,258,1024,ft),new Lt(32,258,258,4096,ft)];function xe(B){B.window_size=2*B.w_size,me(B.head),B.max_lazy_match=en[B.level].max_lazy,B.good_match=en[B.level].good_length,B.nice_match=en[B.level].nice_length,B.max_chain_length=en[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=H-1,B.match_available=0,B.ins_h=0}function D(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(X*2),this.dyn_dtree=new e.Buf16((2*V+1)*2),this.bl_tree=new e.Buf16((2*F+1)*2),me(this.dyn_ltree),me(this.dyn_dtree),me(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(U+1),this.heap=new e.Buf16(2*P+1),me(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*P+1),me(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Z(B){var ze;return!B||!B.state?Ne(B,h):(B.total_in=B.total_out=0,B.data_type=k,ze=B.state,ze.pending=0,ze.pending_out=0,ze.wrap<0&&(ze.wrap=-ze.wrap),ze.status=ze.wrap?Q:Ie,B.adler=ze.wrap===2?0:1,ze.last_flush=i,t._tr_init(ze),u)}function ge(B){var ze=Z(B);return ze===u&&xe(B.state),ze}function Fe(B,ze){return!B||!B.state||B.state.wrap!==2?h:(B.state.gzhead=ze,u)}function we(B,ze,st,ye,_e,Ue){if(!B)return h;var kt=1;if(ze===b&&(ze=6),ye<0?(kt=0,ye=-ye):ye>15&&(kt=2,ye-=16),_e<1||_e>R||st!==A||ye<8||ye>15||ze<0||ze>9||Ue<0||Ue>S)return Ne(B,h);ye===8&&(ye=9);var fe=new D;return B.state=fe,fe.strm=B,fe.wrap=kt,fe.gzhead=null,fe.w_bits=ye,fe.w_size=1<<fe.w_bits,fe.w_mask=fe.w_size-1,fe.hash_bits=_e+7,fe.hash_size=1<<fe.hash_bits,fe.hash_mask=fe.hash_size-1,fe.hash_shift=~~((fe.hash_bits+H-1)/H),fe.window=new e.Buf8(fe.w_size*2),fe.head=new e.Buf16(fe.hash_size),fe.prev=new e.Buf16(fe.w_size),fe.lit_bufsize=1<<_e+6,fe.pending_buf_size=fe.lit_bufsize*4,fe.pending_buf=new e.Buf8(fe.pending_buf_size),fe.d_buf=1*fe.lit_bufsize,fe.l_buf=3*fe.lit_bufsize,fe.level=ze,fe.strategy=Ue,fe.method=st,ge(B)}function Me(B,ze){return we(B,ze,A,N,I,C)}function de(B,ze){var st,ye,_e,Ue;if(!B||!B.state||ze>c||ze<0)return B?Ne(B,h):h;if(ye=B.state,!B.output||!B.input&&B.avail_in!==0||ye.status===De&&ze!==l)return Ne(B,B.avail_out===0?y:h);if(ye.strm=B,st=ye.last_flush,ye.last_flush=ze,ye.status===Q)if(ye.wrap===2)B.adler=0,oe(ye,31),oe(ye,139),oe(ye,8),ye.gzhead?(oe(ye,(ye.gzhead.text?1:0)+(ye.gzhead.hcrc?2:0)+(ye.gzhead.extra?4:0)+(ye.gzhead.name?8:0)+(ye.gzhead.comment?16:0)),oe(ye,ye.gzhead.time&255),oe(ye,ye.gzhead.time>>8&255),oe(ye,ye.gzhead.time>>16&255),oe(ye,ye.gzhead.time>>24&255),oe(ye,ye.level===9?2:ye.strategy>=x||ye.level<2?4:0),oe(ye,ye.gzhead.os&255),ye.gzhead.extra&&ye.gzhead.extra.length&&(oe(ye,ye.gzhead.extra.length&255),oe(ye,ye.gzhead.extra.length>>8&255)),ye.gzhead.hcrc&&(B.adler=r(B.adler,ye.pending_buf,ye.pending,0)),ye.gzindex=0,ye.status=ee):(oe(ye,0),oe(ye,0),oe(ye,0),oe(ye,0),oe(ye,0),oe(ye,ye.level===9?2:ye.strategy>=x||ye.level<2?4:0),oe(ye,Ve),ye.status=Ie);else{var kt=A+(ye.w_bits-8<<4)<<8,fe=-1;ye.strategy>=x||ye.level<2?fe=0:ye.level<6?fe=1:ye.level===6?fe=2:fe=3,kt|=fe<<6,ye.strstart!==0&&(kt|=W),kt+=31-kt%31,ye.status=Ie,re(ye,kt),ye.strstart!==0&&(re(ye,B.adler>>>16),re(ye,B.adler&65535)),B.adler=1}if(ye.status===ee)if(ye.gzhead.extra){for(_e=ye.pending;ye.gzindex<(ye.gzhead.extra.length&65535)&&!(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>_e&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-_e,_e)),Ae(B),_e=ye.pending,ye.pending===ye.pending_buf_size));)oe(ye,ye.gzhead.extra[ye.gzindex]&255),ye.gzindex++;ye.gzhead.hcrc&&ye.pending>_e&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-_e,_e)),ye.gzindex===ye.gzhead.extra.length&&(ye.gzindex=0,ye.status=se)}else ye.status=se;if(ye.status===se)if(ye.gzhead.name){_e=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>_e&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-_e,_e)),Ae(B),_e=ye.pending,ye.pending===ye.pending_buf_size)){Ue=1;break}ye.gzindex<ye.gzhead.name.length?Ue=ye.gzhead.name.charCodeAt(ye.gzindex++)&255:Ue=0,oe(ye,Ue)}while(Ue!==0);ye.gzhead.hcrc&&ye.pending>_e&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-_e,_e)),Ue===0&&(ye.gzindex=0,ye.status=pe)}else ye.status=pe;if(ye.status===pe)if(ye.gzhead.comment){_e=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>_e&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-_e,_e)),Ae(B),_e=ye.pending,ye.pending===ye.pending_buf_size)){Ue=1;break}ye.gzindex<ye.gzhead.comment.length?Ue=ye.gzhead.comment.charCodeAt(ye.gzindex++)&255:Ue=0,oe(ye,Ue)}while(Ue!==0);ye.gzhead.hcrc&&ye.pending>_e&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-_e,_e)),Ue===0&&(ye.status=ce)}else ye.status=ce;if(ye.status===ce&&(ye.gzhead.hcrc?(ye.pending+2>ye.pending_buf_size&&Ae(B),ye.pending+2<=ye.pending_buf_size&&(oe(ye,B.adler&255),oe(ye,B.adler>>8&255),B.adler=0,ye.status=Ie)):ye.status=Ie),ye.pending!==0){if(Ae(B),B.avail_out===0)return ye.last_flush=-1,u}else if(B.avail_in===0&&K(ze)<=K(st)&&ze!==l)return Ne(B,y);if(ye.status===De&&B.avail_in!==0)return Ne(B,y);if(B.avail_in!==0||ye.lookahead!==0||ze!==i&&ye.status!==De){var Y=ye.strategy===x?qt(ye,ze):ye.strategy===w?jt(ye,ze):en[ye.level].func(ye,ze);if((Y===qe||Y===Qe)&&(ye.status=De),Y===Se||Y===qe)return B.avail_out===0&&(ye.last_flush=-1),u;if(Y===Ce&&(ze===a?t._tr_align(ye):ze!==c&&(t._tr_stored_block(ye,0,0,!1),ze===o&&(me(ye.head),ye.lookahead===0&&(ye.strstart=0,ye.block_start=0,ye.insert=0))),Ae(B),B.avail_out===0))return ye.last_flush=-1,u}return ze!==l?u:ye.wrap<=0?d:(ye.wrap===2?(oe(ye,B.adler&255),oe(ye,B.adler>>8&255),oe(ye,B.adler>>16&255),oe(ye,B.adler>>24&255),oe(ye,B.total_in&255),oe(ye,B.total_in>>8&255),oe(ye,B.total_in>>16&255),oe(ye,B.total_in>>24&255)):(re(ye,B.adler>>>16),re(ye,B.adler&65535)),Ae(B),ye.wrap>0&&(ye.wrap=-ye.wrap),ye.pending!==0?u:d)}function vt(B){var ze;return!B||!B.state?h:(ze=B.state.status,ze!==Q&&ze!==ee&&ze!==se&&ze!==pe&&ze!==ce&&ze!==Ie&&ze!==De?Ne(B,h):(B.state=null,ze===Ie?Ne(B,m):u))}function ot(B,ze){var st=ze.length,ye,_e,Ue,kt,fe,Y,G,J;if(!B||!B.state||(ye=B.state,kt=ye.wrap,kt===2||kt===1&&ye.status!==Q||ye.lookahead))return h;for(kt===1&&(B.adler=n(B.adler,ze,st,0)),ye.wrap=0,st>=ye.w_size&&(kt===0&&(me(ye.head),ye.strstart=0,ye.block_start=0,ye.insert=0),J=new e.Buf8(ye.w_size),e.arraySet(J,ze,st-ye.w_size,ye.w_size,0),ze=J,st=ye.w_size),fe=B.avail_in,Y=B.next_in,G=B.input,B.avail_in=st,B.next_in=0,B.input=ze,ke(ye);ye.lookahead>=H;){_e=ye.strstart,Ue=ye.lookahead-(H-1);do ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[_e+H-1])&ye.hash_mask,ye.prev[_e&ye.w_mask]=ye.head[ye.ins_h],ye.head[ye.ins_h]=_e,_e++;while(--Ue);ye.strstart=_e,ye.lookahead=H-1,ke(ye)}return ye.strstart+=ye.lookahead,ye.block_start=ye.strstart,ye.insert=ye.lookahead,ye.lookahead=0,ye.match_length=ye.prev_length=H-1,ye.match_available=0,B.next_in=Y,B.input=G,B.avail_in=fe,ye.wrap=kt,u}return rc.deflateInit=Me,rc.deflateInit2=we,rc.deflateReset=ge,rc.deflateResetKeep=Z,rc.deflateSetHeader=Fe,rc.deflate=de,rc.deflateEnd=vt,rc.deflateSetDictionary=ot,rc.deflateInfo="pako deflate (from Nodeca project)",rc}var Rp={},$9;function _Y(){if($9)return Rp;$9=1;var e=Wh(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),s=0;s<256;s++)r[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;r[254]=r[254]=1,Rp.string2buf=function(a){var o,l,c,u,d,h=a.length,m=0;for(u=0;u<h;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),m+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(m),d=0,u=0;d<m;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),l<128?o[d++]=l:l<2048?(o[d++]=192|l>>>6,o[d++]=128|l&63):l<65536?(o[d++]=224|l>>>12,o[d++]=128|l>>>6&63,o[d++]=128|l&63):(o[d++]=240|l>>>18,o[d++]=128|l>>>12&63,o[d++]=128|l>>>6&63,o[d++]=128|l&63);return o};function i(a,o){if(o<65534&&(a.subarray&&n||!a.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(a,o));for(var l="",c=0;c<o;c++)l+=String.fromCharCode(a[c]);return l}return Rp.buf2binstring=function(a){return i(a,a.length)},Rp.binstring2buf=function(a){for(var o=new e.Buf8(a.length),l=0,c=o.length;l<c;l++)o[l]=a.charCodeAt(l);return o},Rp.buf2string=function(a,o){var l,c,u,d,h=o||a.length,m=new Array(h*2);for(c=0,l=0;l<h;){if(u=a[l++],u<128){m[c++]=u;continue}if(d=r[u],d>4){m[c++]=65533,l+=d-1;continue}for(u&=d===2?31:d===3?15:7;d>1&&l<h;)u=u<<6|a[l++]&63,d--;if(d>1){m[c++]=65533;continue}u<65536?m[c++]=u:(u-=65536,m[c++]=55296|u>>10&1023,m[c++]=56320|u&1023)}return i(m,c)},Rp.utf8border=function(a,o){var l;for(o=o||a.length,o>a.length&&(o=a.length),l=o-1;l>=0&&(a[l]&192)===128;)l--;return l<0||l===0?o:l+r[a[l]]>o?l:o},Rp}var PM,z9;function SY(){if(z9)return PM;z9=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return PM=e,PM}var U9;function E2e(){if(U9)return Hg;U9=1;var e=k2e(),t=Wh(),n=_Y(),r=JP(),s=SY(),i=Object.prototype.toString,a=0,o=4,l=0,c=1,u=2,d=-1,h=0,m=8;function y(w){if(!(this instanceof y))return new y(w);this.options=t.assign({level:d,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},w||{});var S=this.options;S.raw&&S.windowBits>0?S.windowBits=-S.windowBits:S.gzip&&S.windowBits>0&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var C=e.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(C!==l)throw new Error(r[C]);if(S.header&&e.deflateSetHeader(this.strm,S.header),S.dictionary){var k;if(typeof S.dictionary=="string"?k=n.string2buf(S.dictionary):i.call(S.dictionary)==="[object ArrayBuffer]"?k=new Uint8Array(S.dictionary):k=S.dictionary,C=e.deflateSetDictionary(this.strm,k),C!==l)throw new Error(r[C]);this._dict_set=!0}}y.prototype.push=function(w,S){var C=this.strm,k=this.options.chunkSize,A,R;if(this.ended)return!1;R=S===~~S?S:S===!0?o:a,typeof w=="string"?C.input=n.string2buf(w):i.call(w)==="[object ArrayBuffer]"?C.input=new Uint8Array(w):C.input=w,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new t.Buf8(k),C.next_out=0,C.avail_out=k),A=e.deflate(C,R),A!==c&&A!==l)return this.onEnd(A),this.ended=!0,!1;(C.avail_out===0||C.avail_in===0&&(R===o||R===u))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(C.output,C.next_out))):this.onData(t.shrinkBuf(C.output,C.next_out)))}while((C.avail_in>0||C.avail_out===0)&&A!==c);return R===o?(A=e.deflateEnd(this.strm),this.onEnd(A),this.ended=!0,A===l):(R===u&&(this.onEnd(l),C.avail_out=0),!0)},y.prototype.onData=function(w){this.chunks.push(w)},y.prototype.onEnd=function(w){w===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg};function b(w,S){var C=new y(S);if(C.push(w,!0),C.err)throw C.msg||r[C.err];return C.result}function v(w,S){return S=S||{},S.raw=!0,b(w,S)}function x(w,S){return S=S||{},S.gzip=!0,b(w,S)}return Hg.Deflate=y,Hg.deflate=b,Hg.deflateRaw=v,Hg.gzip=x,Hg}var Gg={},Rl={},DM,q9;function T2e(){if(q9)return DM;q9=1;var e=30,t=12;return DM=function(r,s){var i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k,A,R,N,I,O,L,P,V;i=r.state,a=r.next_in,P=r.input,o=a+(r.avail_in-5),l=r.next_out,V=r.output,c=l-(s-r.avail_out),u=l+(r.avail_out-257),d=i.dmax,h=i.wsize,m=i.whave,y=i.wnext,b=i.window,v=i.hold,x=i.bits,w=i.lencode,S=i.distcode,C=(1<<i.lenbits)-1,k=(1<<i.distbits)-1;e:do{x<15&&(v+=P[a++]<<x,x+=8,v+=P[a++]<<x,x+=8),A=w[v&C];t:for(;;){if(R=A>>>24,v>>>=R,x-=R,R=A>>>16&255,R===0)V[l++]=A&65535;else if(R&16){N=A&65535,R&=15,R&&(x<R&&(v+=P[a++]<<x,x+=8),N+=v&(1<<R)-1,v>>>=R,x-=R),x<15&&(v+=P[a++]<<x,x+=8,v+=P[a++]<<x,x+=8),A=S[v&k];n:for(;;){if(R=A>>>24,v>>>=R,x-=R,R=A>>>16&255,R&16){if(I=A&65535,R&=15,x<R&&(v+=P[a++]<<x,x+=8,x<R&&(v+=P[a++]<<x,x+=8)),I+=v&(1<<R)-1,I>d){r.msg="invalid distance too far back",i.mode=e;break e}if(v>>>=R,x-=R,R=l-c,I>R){if(R=I-R,R>m&&i.sane){r.msg="invalid distance too far back",i.mode=e;break e}if(O=0,L=b,y===0){if(O+=h-R,R<N){N-=R;do V[l++]=b[O++];while(--R);O=l-I,L=V}}else if(y<R){if(O+=h+y-R,R-=y,R<N){N-=R;do V[l++]=b[O++];while(--R);if(O=0,y<N){R=y,N-=R;do V[l++]=b[O++];while(--R);O=l-I,L=V}}}else if(O+=y-R,R<N){N-=R;do V[l++]=b[O++];while(--R);O=l-I,L=V}for(;N>2;)V[l++]=L[O++],V[l++]=L[O++],V[l++]=L[O++],N-=3;N&&(V[l++]=L[O++],N>1&&(V[l++]=L[O++]))}else{O=l-I;do V[l++]=V[O++],V[l++]=V[O++],V[l++]=V[O++],N-=3;while(N>2);N&&(V[l++]=V[O++],N>1&&(V[l++]=V[O++]))}}else if((R&64)===0){A=S[(A&65535)+(v&(1<<R)-1)];continue n}else{r.msg="invalid distance code",i.mode=e;break e}break}}else if((R&64)===0){A=w[(A&65535)+(v&(1<<R)-1)];continue t}else if(R&32){i.mode=t;break e}else{r.msg="invalid literal/length code",i.mode=e;break e}break}}while(a<o&&l<u);N=x>>3,a-=N,x-=N<<3,v&=(1<<x)-1,r.next_in=a,r.next_out=l,r.avail_in=a<o?5+(o-a):5-(a-o),r.avail_out=l<u?257+(u-l):257-(l-u),i.hold=v,i.bits=x},DM}var FM,V9;function A2e(){if(V9)return FM;V9=1;var e=Wh(),t=15,n=852,r=592,s=0,i=1,a=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return FM=function(h,m,y,b,v,x,w,S){var C=S.bits,k=0,A=0,R=0,N=0,I=0,O=0,L=0,P=0,V=0,F=0,X,U,H,$,ne,W=null,Q=0,ee,se=new e.Buf16(t+1),pe=new e.Buf16(t+1),ce=null,Ie=0,De,Se,Ce;for(k=0;k<=t;k++)se[k]=0;for(A=0;A<b;A++)se[m[y+A]]++;for(I=C,N=t;N>=1&&se[N]===0;N--);if(I>N&&(I=N),N===0)return v[x++]=1<<24|64<<16|0,v[x++]=1<<24|64<<16|0,S.bits=1,0;for(R=1;R<N&&se[R]===0;R++);for(I<R&&(I=R),P=1,k=1;k<=t;k++)if(P<<=1,P-=se[k],P<0)return-1;if(P>0&&(h===s||N!==1))return-1;for(pe[1]=0,k=1;k<t;k++)pe[k+1]=pe[k]+se[k];for(A=0;A<b;A++)m[y+A]!==0&&(w[pe[m[y+A]]++]=A);if(h===s?(W=ce=w,ee=19):h===i?(W=o,Q-=257,ce=l,Ie-=257,ee=256):(W=c,ce=u,ee=-1),F=0,A=0,k=R,ne=x,O=I,L=0,H=-1,V=1<<I,$=V-1,h===i&&V>n||h===a&&V>r)return 1;for(;;){De=k-L,w[A]<ee?(Se=0,Ce=w[A]):w[A]>ee?(Se=ce[Ie+w[A]],Ce=W[Q+w[A]]):(Se=96,Ce=0),X=1<<k-L,U=1<<O,R=U;do U-=X,v[ne+(F>>L)+U]=De<<24|Se<<16|Ce|0;while(U!==0);for(X=1<<k-1;F&X;)X>>=1;if(X!==0?(F&=X-1,F+=X):F=0,A++,--se[k]===0){if(k===N)break;k=m[y+w[A]]}if(k>I&&(F&$)!==H){for(L===0&&(L=I),ne+=R,O=k-L,P=1<<O;O+L<N&&(P-=se[O+L],!(P<=0));)O++,P<<=1;if(V+=1<<O,h===i&&V>n||h===a&&V>r)return 1;H=F&$,v[H]=I<<24|O<<16|ne-x|0}}return F!==0&&(v[ne+F]=k-L<<24|64<<16|0),S.bits=I,0},FM}var W9;function R2e(){if(W9)return Rl;W9=1;var e=Wh(),t=xY(),n=wY(),r=T2e(),s=A2e(),i=0,a=1,o=2,l=4,c=5,u=6,d=0,h=1,m=2,y=-2,b=-3,v=-4,x=-5,w=8,S=1,C=2,k=3,A=4,R=5,N=6,I=7,O=8,L=9,P=10,V=11,F=12,X=13,U=14,H=15,$=16,ne=17,W=18,Q=19,ee=20,se=21,pe=22,ce=23,Ie=24,De=25,Se=26,Ce=27,qe=28,Qe=29,Ve=30,Ne=31,K=32,me=852,Ae=592,le=15,oe=le;function re(we){return(we>>>24&255)+(we>>>8&65280)+((we&65280)<<8)+((we&255)<<24)}function Te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Be(we){var Me;return!we||!we.state?y:(Me=we.state,we.total_in=we.total_out=Me.total=0,we.msg="",Me.wrap&&(we.adler=Me.wrap&1),Me.mode=S,Me.last=0,Me.havedict=0,Me.dmax=32768,Me.head=null,Me.hold=0,Me.bits=0,Me.lencode=Me.lendyn=new e.Buf32(me),Me.distcode=Me.distdyn=new e.Buf32(Ae),Me.sane=1,Me.back=-1,d)}function ke(we){var Me;return!we||!we.state?y:(Me=we.state,Me.wsize=0,Me.whave=0,Me.wnext=0,Be(we))}function lt(we,Me){var de,vt;return!we||!we.state||(vt=we.state,Me<0?(de=0,Me=-Me):(de=(Me>>4)+1,Me<48&&(Me&=15)),Me&&(Me<8||Me>15))?y:(vt.window!==null&&vt.wbits!==Me&&(vt.window=null),vt.wrap=de,vt.wbits=Me,ke(we))}function Rt(we,Me){var de,vt;return we?(vt=new Te,we.state=vt,vt.window=null,de=lt(we,Me),de!==d&&(we.state=null),de):y}function ft(we){return Rt(we,oe)}var jt=!0,qt,Lt;function en(we){if(jt){var Me;for(qt=new e.Buf32(512),Lt=new e.Buf32(32),Me=0;Me<144;)we.lens[Me++]=8;for(;Me<256;)we.lens[Me++]=9;for(;Me<280;)we.lens[Me++]=7;for(;Me<288;)we.lens[Me++]=8;for(s(a,we.lens,0,288,qt,0,we.work,{bits:9}),Me=0;Me<32;)we.lens[Me++]=5;s(o,we.lens,0,32,Lt,0,we.work,{bits:5}),jt=!1}we.lencode=qt,we.lenbits=9,we.distcode=Lt,we.distbits=5}function xe(we,Me,de,vt){var ot,B=we.state;return B.window===null&&(B.wsize=1<<B.wbits,B.wnext=0,B.whave=0,B.window=new e.Buf8(B.wsize)),vt>=B.wsize?(e.arraySet(B.window,Me,de-B.wsize,B.wsize,0),B.wnext=0,B.whave=B.wsize):(ot=B.wsize-B.wnext,ot>vt&&(ot=vt),e.arraySet(B.window,Me,de-vt,ot,B.wnext),vt-=ot,vt?(e.arraySet(B.window,Me,de-vt,vt,0),B.wnext=vt,B.whave=B.wsize):(B.wnext+=ot,B.wnext===B.wsize&&(B.wnext=0),B.whave<B.wsize&&(B.whave+=ot))),0}function D(we,Me){var de,vt,ot,B,ze,st,ye,_e,Ue,kt,fe,Y,G,J,be=0,Pe,Ge,_t,tn,Un,Xt,nn,un,mr=new e.Buf8(4),Ar,ns,rs=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!we||!we.state||!we.output||!we.input&&we.avail_in!==0)return y;de=we.state,de.mode===F&&(de.mode=X),ze=we.next_out,ot=we.output,ye=we.avail_out,B=we.next_in,vt=we.input,st=we.avail_in,_e=de.hold,Ue=de.bits,kt=st,fe=ye,un=d;e:for(;;)switch(de.mode){case S:if(de.wrap===0){de.mode=X;break}for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(de.wrap&2&&_e===35615){de.check=0,mr[0]=_e&255,mr[1]=_e>>>8&255,de.check=n(de.check,mr,2,0),_e=0,Ue=0,de.mode=C;break}if(de.flags=0,de.head&&(de.head.done=!1),!(de.wrap&1)||(((_e&255)<<8)+(_e>>8))%31){we.msg="incorrect header check",de.mode=Ve;break}if((_e&15)!==w){we.msg="unknown compression method",de.mode=Ve;break}if(_e>>>=4,Ue-=4,nn=(_e&15)+8,de.wbits===0)de.wbits=nn;else if(nn>de.wbits){we.msg="invalid window size",de.mode=Ve;break}de.dmax=1<<nn,we.adler=de.check=1,de.mode=_e&512?P:F,_e=0,Ue=0;break;case C:for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(de.flags=_e,(de.flags&255)!==w){we.msg="unknown compression method",de.mode=Ve;break}if(de.flags&57344){we.msg="unknown header flags set",de.mode=Ve;break}de.head&&(de.head.text=_e>>8&1),de.flags&512&&(mr[0]=_e&255,mr[1]=_e>>>8&255,de.check=n(de.check,mr,2,0)),_e=0,Ue=0,de.mode=k;case k:for(;Ue<32;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.head&&(de.head.time=_e),de.flags&512&&(mr[0]=_e&255,mr[1]=_e>>>8&255,mr[2]=_e>>>16&255,mr[3]=_e>>>24&255,de.check=n(de.check,mr,4,0)),_e=0,Ue=0,de.mode=A;case A:for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.head&&(de.head.xflags=_e&255,de.head.os=_e>>8),de.flags&512&&(mr[0]=_e&255,mr[1]=_e>>>8&255,de.check=n(de.check,mr,2,0)),_e=0,Ue=0,de.mode=R;case R:if(de.flags&1024){for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.length=_e,de.head&&(de.head.extra_len=_e),de.flags&512&&(mr[0]=_e&255,mr[1]=_e>>>8&255,de.check=n(de.check,mr,2,0)),_e=0,Ue=0}else de.head&&(de.head.extra=null);de.mode=N;case N:if(de.flags&1024&&(Y=de.length,Y>st&&(Y=st),Y&&(de.head&&(nn=de.head.extra_len-de.length,de.head.extra||(de.head.extra=new Array(de.head.extra_len)),e.arraySet(de.head.extra,vt,B,Y,nn)),de.flags&512&&(de.check=n(de.check,vt,Y,B)),st-=Y,B+=Y,de.length-=Y),de.length))break e;de.length=0,de.mode=I;case I:if(de.flags&2048){if(st===0)break e;Y=0;do nn=vt[B+Y++],de.head&&nn&&de.length<65536&&(de.head.name+=String.fromCharCode(nn));while(nn&&Y<st);if(de.flags&512&&(de.check=n(de.check,vt,Y,B)),st-=Y,B+=Y,nn)break e}else de.head&&(de.head.name=null);de.length=0,de.mode=O;case O:if(de.flags&4096){if(st===0)break e;Y=0;do nn=vt[B+Y++],de.head&&nn&&de.length<65536&&(de.head.comment+=String.fromCharCode(nn));while(nn&&Y<st);if(de.flags&512&&(de.check=n(de.check,vt,Y,B)),st-=Y,B+=Y,nn)break e}else de.head&&(de.head.comment=null);de.mode=L;case L:if(de.flags&512){for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(_e!==(de.check&65535)){we.msg="header crc mismatch",de.mode=Ve;break}_e=0,Ue=0}de.head&&(de.head.hcrc=de.flags>>9&1,de.head.done=!0),we.adler=de.check=0,de.mode=F;break;case P:for(;Ue<32;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}we.adler=de.check=re(_e),_e=0,Ue=0,de.mode=V;case V:if(de.havedict===0)return we.next_out=ze,we.avail_out=ye,we.next_in=B,we.avail_in=st,de.hold=_e,de.bits=Ue,m;we.adler=de.check=1,de.mode=F;case F:if(Me===c||Me===u)break e;case X:if(de.last){_e>>>=Ue&7,Ue-=Ue&7,de.mode=Ce;break}for(;Ue<3;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}switch(de.last=_e&1,_e>>>=1,Ue-=1,_e&3){case 0:de.mode=U;break;case 1:if(en(de),de.mode=ee,Me===u){_e>>>=2,Ue-=2;break e}break;case 2:de.mode=ne;break;case 3:we.msg="invalid block type",de.mode=Ve}_e>>>=2,Ue-=2;break;case U:for(_e>>>=Ue&7,Ue-=Ue&7;Ue<32;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if((_e&65535)!==(_e>>>16^65535)){we.msg="invalid stored block lengths",de.mode=Ve;break}if(de.length=_e&65535,_e=0,Ue=0,de.mode=H,Me===u)break e;case H:de.mode=$;case $:if(Y=de.length,Y){if(Y>st&&(Y=st),Y>ye&&(Y=ye),Y===0)break e;e.arraySet(ot,vt,B,Y,ze),st-=Y,B+=Y,ye-=Y,ze+=Y,de.length-=Y;break}de.mode=F;break;case ne:for(;Ue<14;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(de.nlen=(_e&31)+257,_e>>>=5,Ue-=5,de.ndist=(_e&31)+1,_e>>>=5,Ue-=5,de.ncode=(_e&15)+4,_e>>>=4,Ue-=4,de.nlen>286||de.ndist>30){we.msg="too many length or distance symbols",de.mode=Ve;break}de.have=0,de.mode=W;case W:for(;de.have<de.ncode;){for(;Ue<3;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.lens[rs[de.have++]]=_e&7,_e>>>=3,Ue-=3}for(;de.have<19;)de.lens[rs[de.have++]]=0;if(de.lencode=de.lendyn,de.lenbits=7,Ar={bits:de.lenbits},un=s(i,de.lens,0,19,de.lencode,0,de.work,Ar),de.lenbits=Ar.bits,un){we.msg="invalid code lengths set",de.mode=Ve;break}de.have=0,de.mode=Q;case Q:for(;de.have<de.nlen+de.ndist;){for(;be=de.lencode[_e&(1<<de.lenbits)-1],Pe=be>>>24,Ge=be>>>16&255,_t=be&65535,!(Pe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(_t<16)_e>>>=Pe,Ue-=Pe,de.lens[de.have++]=_t;else{if(_t===16){for(ns=Pe+2;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(_e>>>=Pe,Ue-=Pe,de.have===0){we.msg="invalid bit length repeat",de.mode=Ve;break}nn=de.lens[de.have-1],Y=3+(_e&3),_e>>>=2,Ue-=2}else if(_t===17){for(ns=Pe+3;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}_e>>>=Pe,Ue-=Pe,nn=0,Y=3+(_e&7),_e>>>=3,Ue-=3}else{for(ns=Pe+7;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}_e>>>=Pe,Ue-=Pe,nn=0,Y=11+(_e&127),_e>>>=7,Ue-=7}if(de.have+Y>de.nlen+de.ndist){we.msg="invalid bit length repeat",de.mode=Ve;break}for(;Y--;)de.lens[de.have++]=nn}}if(de.mode===Ve)break;if(de.lens[256]===0){we.msg="invalid code -- missing end-of-block",de.mode=Ve;break}if(de.lenbits=9,Ar={bits:de.lenbits},un=s(a,de.lens,0,de.nlen,de.lencode,0,de.work,Ar),de.lenbits=Ar.bits,un){we.msg="invalid literal/lengths set",de.mode=Ve;break}if(de.distbits=6,de.distcode=de.distdyn,Ar={bits:de.distbits},un=s(o,de.lens,de.nlen,de.ndist,de.distcode,0,de.work,Ar),de.distbits=Ar.bits,un){we.msg="invalid distances set",de.mode=Ve;break}if(de.mode=ee,Me===u)break e;case ee:de.mode=se;case se:if(st>=6&&ye>=258){we.next_out=ze,we.avail_out=ye,we.next_in=B,we.avail_in=st,de.hold=_e,de.bits=Ue,r(we,fe),ze=we.next_out,ot=we.output,ye=we.avail_out,B=we.next_in,vt=we.input,st=we.avail_in,_e=de.hold,Ue=de.bits,de.mode===F&&(de.back=-1);break}for(de.back=0;be=de.lencode[_e&(1<<de.lenbits)-1],Pe=be>>>24,Ge=be>>>16&255,_t=be&65535,!(Pe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(Ge&&(Ge&240)===0){for(tn=Pe,Un=Ge,Xt=_t;be=de.lencode[Xt+((_e&(1<<tn+Un)-1)>>tn)],Pe=be>>>24,Ge=be>>>16&255,_t=be&65535,!(tn+Pe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}_e>>>=tn,Ue-=tn,de.back+=tn}if(_e>>>=Pe,Ue-=Pe,de.back+=Pe,de.length=_t,Ge===0){de.mode=Se;break}if(Ge&32){de.back=-1,de.mode=F;break}if(Ge&64){we.msg="invalid literal/length code",de.mode=Ve;break}de.extra=Ge&15,de.mode=pe;case pe:if(de.extra){for(ns=de.extra;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.length+=_e&(1<<de.extra)-1,_e>>>=de.extra,Ue-=de.extra,de.back+=de.extra}de.was=de.length,de.mode=ce;case ce:for(;be=de.distcode[_e&(1<<de.distbits)-1],Pe=be>>>24,Ge=be>>>16&255,_t=be&65535,!(Pe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if((Ge&240)===0){for(tn=Pe,Un=Ge,Xt=_t;be=de.distcode[Xt+((_e&(1<<tn+Un)-1)>>tn)],Pe=be>>>24,Ge=be>>>16&255,_t=be&65535,!(tn+Pe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}_e>>>=tn,Ue-=tn,de.back+=tn}if(_e>>>=Pe,Ue-=Pe,de.back+=Pe,Ge&64){we.msg="invalid distance code",de.mode=Ve;break}de.offset=_t,de.extra=Ge&15,de.mode=Ie;case Ie:if(de.extra){for(ns=de.extra;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.offset+=_e&(1<<de.extra)-1,_e>>>=de.extra,Ue-=de.extra,de.back+=de.extra}if(de.offset>de.dmax){we.msg="invalid distance too far back",de.mode=Ve;break}de.mode=De;case De:if(ye===0)break e;if(Y=fe-ye,de.offset>Y){if(Y=de.offset-Y,Y>de.whave&&de.sane){we.msg="invalid distance too far back",de.mode=Ve;break}Y>de.wnext?(Y-=de.wnext,G=de.wsize-Y):G=de.wnext-Y,Y>de.length&&(Y=de.length),J=de.window}else J=ot,G=ze-de.offset,Y=de.length;Y>ye&&(Y=ye),ye-=Y,de.length-=Y;do ot[ze++]=J[G++];while(--Y);de.length===0&&(de.mode=se);break;case Se:if(ye===0)break e;ot[ze++]=de.length,ye--,de.mode=se;break;case Ce:if(de.wrap){for(;Ue<32;){if(st===0)break e;st--,_e|=vt[B++]<<Ue,Ue+=8}if(fe-=ye,we.total_out+=fe,de.total+=fe,fe&&(we.adler=de.check=de.flags?n(de.check,ot,fe,ze-fe):t(de.check,ot,fe,ze-fe)),fe=ye,(de.flags?_e:re(_e))!==de.check){we.msg="incorrect data check",de.mode=Ve;break}_e=0,Ue=0}de.mode=qe;case qe:if(de.wrap&&de.flags){for(;Ue<32;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(_e!==(de.total&4294967295)){we.msg="incorrect length check",de.mode=Ve;break}_e=0,Ue=0}de.mode=Qe;case Qe:un=h;break e;case Ve:un=b;break e;case Ne:return v;case K:default:return y}return we.next_out=ze,we.avail_out=ye,we.next_in=B,we.avail_in=st,de.hold=_e,de.bits=Ue,(de.wsize||fe!==we.avail_out&&de.mode<Ve&&(de.mode<Ce||Me!==l))&&xe(we,we.output,we.next_out,fe-we.avail_out),kt-=we.avail_in,fe-=we.avail_out,we.total_in+=kt,we.total_out+=fe,de.total+=fe,de.wrap&&fe&&(we.adler=de.check=de.flags?n(de.check,ot,fe,we.next_out-fe):t(de.check,ot,fe,we.next_out-fe)),we.data_type=de.bits+(de.last?64:0)+(de.mode===F?128:0)+(de.mode===ee||de.mode===H?256:0),(kt===0&&fe===0||Me===l)&&un===d&&(un=x),un}function Z(we){if(!we||!we.state)return y;var Me=we.state;return Me.window&&(Me.window=null),we.state=null,d}function ge(we,Me){var de;return!we||!we.state||(de=we.state,(de.wrap&2)===0)?y:(de.head=Me,Me.done=!1,d)}function Fe(we,Me){var de=Me.length,vt,ot,B;return!we||!we.state||(vt=we.state,vt.wrap!==0&&vt.mode!==V)?y:vt.mode===V&&(ot=1,ot=t(ot,Me,de,0),ot!==vt.check)?b:(B=xe(we,Me,de,de),B?(vt.mode=Ne,v):(vt.havedict=1,d))}return Rl.inflateReset=ke,Rl.inflateReset2=lt,Rl.inflateResetKeep=Be,Rl.inflateInit=ft,Rl.inflateInit2=Rt,Rl.inflate=D,Rl.inflateEnd=Z,Rl.inflateGetHeader=ge,Rl.inflateSetDictionary=Fe,Rl.inflateInfo="pako inflate (from Nodeca project)",Rl}var LM,H9;function CY(){return H9||(H9=1,LM={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),LM}var BM,G9;function N2e(){if(G9)return BM;G9=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return BM=e,BM}var K9;function M2e(){if(K9)return Gg;K9=1;var e=R2e(),t=Wh(),n=_Y(),r=CY(),s=JP(),i=SY(),a=N2e(),o=Object.prototype.toString;function l(d){if(!(this instanceof l))return new l(d);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},d||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),h.windowBits>=0&&h.windowBits<16&&!(d&&d.windowBits)&&(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(h.windowBits&15)===0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var m=e.inflateInit2(this.strm,h.windowBits);if(m!==r.Z_OK)throw new Error(s[m]);if(this.header=new a,e.inflateGetHeader(this.strm,this.header),h.dictionary&&(typeof h.dictionary=="string"?h.dictionary=n.string2buf(h.dictionary):o.call(h.dictionary)==="[object ArrayBuffer]"&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(m=e.inflateSetDictionary(this.strm,h.dictionary),m!==r.Z_OK)))throw new Error(s[m])}l.prototype.push=function(d,h){var m=this.strm,y=this.options.chunkSize,b=this.options.dictionary,v,x,w,S,C,k=!1;if(this.ended)return!1;x=h===~~h?h:h===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof d=="string"?m.input=n.binstring2buf(d):o.call(d)==="[object ArrayBuffer]"?m.input=new Uint8Array(d):m.input=d,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new t.Buf8(y),m.next_out=0,m.avail_out=y),v=e.inflate(m,r.Z_NO_FLUSH),v===r.Z_NEED_DICT&&b&&(v=e.inflateSetDictionary(this.strm,b)),v===r.Z_BUF_ERROR&&k===!0&&(v=r.Z_OK,k=!1),v!==r.Z_STREAM_END&&v!==r.Z_OK)return this.onEnd(v),this.ended=!0,!1;m.next_out&&(m.avail_out===0||v===r.Z_STREAM_END||m.avail_in===0&&(x===r.Z_FINISH||x===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(w=n.utf8border(m.output,m.next_out),S=m.next_out-w,C=n.buf2string(m.output,w),m.next_out=S,m.avail_out=y-S,S&&t.arraySet(m.output,m.output,w,S,0),this.onData(C)):this.onData(t.shrinkBuf(m.output,m.next_out))),m.avail_in===0&&m.avail_out===0&&(k=!0)}while((m.avail_in>0||m.avail_out===0)&&v!==r.Z_STREAM_END);return v===r.Z_STREAM_END&&(x=r.Z_FINISH),x===r.Z_FINISH?(v=e.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===r.Z_OK):(x===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),m.avail_out=0),!0)},l.prototype.onData=function(d){this.chunks.push(d)},l.prototype.onEnd=function(d){d===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function c(d,h){var m=new l(h);if(m.push(d,!0),m.err)throw m.msg||s[m.err];return m.result}function u(d,h){return h=h||{},h.raw=!0,c(d,h)}return Gg.Inflate=l,Gg.inflate=c,Gg.inflateRaw=u,Gg.ungzip=c,Gg}var $M,Y9;function I2e(){if(Y9)return $M;Y9=1;var e=Wh().assign,t=E2e(),n=M2e(),r=CY(),s={};return e(s,t,n,r),$M=s,$M}var j2e=I2e();const QP=_a(j2e);var zM,Z9;function O2e(){if(Z9)return zM;Z9=1;const e=(t,n)=>function(...r){const s=n.promiseModule;return new s((i,a)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?a(o):(o.shift(),i(o)):i(o)}):n.errorFirst?r.push((o,l)=>{o?a(o):i(l)}):r.push(i),t.apply(this,r)})};return zM=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const s=a=>{const o=l=>typeof l=="string"?a===l:l.test(a);return n.include?n.include.some(o):!n.exclude.some(o)};let i;r==="function"?i=function(...a){return n.excludeMain?t(...a):e(t,n).apply(this,a)}:i=Object.create(Object.getPrototypeOf(t));for(const a in t){const o=t[a];i[a]=typeof o=="function"&&s(a)?e(o,n):o}return i},zM}var P2e=O2e();const UM=_a(P2e);var qM,X9;function D2e(){if(X9)return qM;X9=1;var e={};function t(H){return Array.isArray(H)?H:[H]}const n="",r=" ",s="\\",i=/^\s+$/,a=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,c=/\r?\n/g,u=/^\.*\/|^\.+$/,d="/";let h="node-ignore";typeof Symbol<"u"&&(h=Symbol.for("node-ignore"));const m=h,y=(H,$,ne)=>Object.defineProperty(H,$,{value:ne}),b=/([0-z])-([0-z])/g,v=()=>!1,x=H=>H.replace(b,($,ne,W)=>ne.charCodeAt(0)<=W.charCodeAt(0)?$:n),w=H=>{const{length:$}=H;return H.slice(0,$-$%2)},S=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(H,$,ne)=>$+(ne.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(H,$)=>{const{length:ne}=$;return $.slice(0,ne-ne%2)+r}],[/[\\$.|*+(){^]/g,H=>`\\${H}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(H,$,ne)=>$+6<ne.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(H,$,ne)=>{const W=ne.replace(/\\\*/g,"[^\\/]*");return $+W}],[/\\\\\\(?=[$.|*+(){^])/g,()=>s],[/\\\\/g,()=>s],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(H,$,ne,W,Q)=>$===s?`\\[${ne}${w(W)}${Q}`:Q==="]"&&W.length%2===0?`[${x(ne)}${W}]`:"[]"],[/(?:[^*])$/,H=>/\/$/.test(H)?`${H}$`:`${H}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(H,$)=>`${$?`${$}[^/]+`:"[^/]*"}(?=$|\\/$)`]],C=Object.create(null),k=(H,$)=>{let ne=C[H];return ne||(ne=S.reduce((W,[Q,ee])=>W.replace(Q,ee.bind(H)),H),C[H]=ne),$?new RegExp(ne,"i"):new RegExp(ne)},A=H=>typeof H=="string",R=H=>H&&A(H)&&!i.test(H)&&!a.test(H)&&H.indexOf("#")!==0,N=H=>H.split(c);class I{constructor($,ne,W,Q){this.origin=$,this.pattern=ne,this.negative=W,this.regex=Q}}const O=(H,$)=>{const ne=H;let W=!1;H.indexOf("!")===0&&(W=!0,H=H.substr(1)),H=H.replace(o,"!").replace(l,"#");const Q=k(H,$);return new I(ne,H,W,Q)},L=(H,$)=>{throw new $(H)},P=(H,$,ne)=>A(H)?H?P.isNotRelative(H)?ne(`path should be a \`path.relative()\`d string, but got "${$}"`,RangeError):!0:ne("path must not be empty",TypeError):ne(`path must be a string, but got \`${$}\``,TypeError),V=H=>u.test(H);P.isNotRelative=V,P.convert=H=>H;class F{constructor({ignorecase:$=!0,ignoreCase:ne=$,allowRelativePaths:W=!1}={}){y(this,m,!0),this._rules=[],this._ignoreCase=ne,this._allowRelativePaths=W,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern($){if($&&$[m]){this._rules=this._rules.concat($._rules),this._added=!0;return}if(R($)){const ne=O($,this._ignoreCase);this._added=!0,this._rules.push(ne)}}add($){return this._added=!1,t(A($)?N($):$).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern($){return this.add($)}_testOne($,ne){let W=!1,Q=!1;return this._rules.forEach(ee=>{const{negative:se}=ee;if(Q===se&&W!==Q||se&&!W&&!Q&&!ne)return;ee.regex.test($)&&(W=!se,Q=se)}),{ignored:W,unignored:Q}}_test($,ne,W,Q){const ee=$&&P.convert($);return P(ee,$,this._allowRelativePaths?v:L),this._t(ee,ne,W,Q)}_t($,ne,W,Q){if($ in ne)return ne[$];if(Q||(Q=$.split(d)),Q.pop(),!Q.length)return ne[$]=this._testOne($,W);const ee=this._t(Q.join(d)+d,ne,W,Q);return ne[$]=ee.ignored?ee:this._testOne($,W)}ignores($){return this._test($,this._ignoreCache,!1).ignored}createFilter(){return $=>!this.ignores($)}filter($){return t($).filter(this.createFilter())}test($){return this._test($,this._testCache,!0)}}const X=H=>new F(H),U=H=>P(H&&P.convert(H),H,v);if(X.isPathValid=U,X.default=X,qM=X,typeof Ai<"u"&&(e&&e.IGNORE_TEST_WIN32||Ai.platform==="win32")){const H=ne=>/^\\\\\?\\/.test(ne)||/["<>|\u0000-\u001F]+/u.test(ne)?ne:ne.replace(/\\/g,"/");P.convert=H;const $=/^[a-z]:\//i;P.isNotRelative=ne=>$.test(ne)||V(ne)}return qM}var F2e=D2e();const L2e=_a(F2e);var VM,J9;function B2e(){if(J9)return VM;J9=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,s,i){return s=s instanceof RegExp?s:new RegExp(e(s),"g"),r.replace(s,i)}var n={clean:function(s){if(typeof s!="string")throw new Error("Expected a string, received: "+s);return s=t(s,"./","/"),s=t(s,"..","."),s=t(s," ","-"),s=t(s,/^[~^:?*\\\-]/g,""),s=t(s,/[~^:?*\\]/g,"-"),s=t(s,/[~^:?*\\\-]$/g,""),s=t(s,"@{","-"),s=t(s,/\.$/g,""),s=t(s,/\/$/g,""),s=t(s,/\.lock$/g,""),s}};return VM=n,VM}var $2e=B2e();const uu=_a($2e);var WM,Q9;function z2e(){return Q9||(Q9=1,WM=function(e,t){var n=e,r=t,s=n.length,i=r.length,a=!1,o=null,l=s+1,c=[],u=[],d=[],h="",m=-1,y=0,b=1,v,x,w=function(){s>=i&&(v=n,x=s,n=r,r=v,s=i,i=x,a=!0,l=s+1)},S=function(R,N,I){return{x:R,y:N,k:I}},C=function(R,N){return{elem:R,t:N}},k=function(R,N,I){var O,L,P;for(N>I?O=c[R-1+l]:O=c[R+1+l],P=Math.max(N,I),L=P-R;L<s&&P<i&&n[L]===r[P];)++L,++P;return c[R+l]=u.length,u[u.length]=new S(L,P,O),P},A=function(R){var N,I,O;for(N=I=0,O=R.length-1;O>=0;--O)for(;N<R[O].x||I<R[O].y;)R[O].y-R[O].x>I-N?(a?d[d.length]=new C(r[I],m):d[d.length]=new C(r[I],b),++I):R[O].y-R[O].x<I-N?(a?d[d.length]=new C(n[N],b):d[d.length]=new C(n[N],m),++N):(d[d.length]=new C(n[N],y),h+=n[N],++N,++I)};return w(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return h},getses:function(){return d},compose:function(){var R,N,I,O,L,P,V,F;for(R=i-s,N=s+i+3,I={},V=0;V<N;++V)I[V]=-1,c[V]=-1;O=-1;do{for(++O,F=-O;F<=R-1;++F)I[F+l]=k(F,I[F-1+l]+1,I[F+1+l]);for(F=R+O;F>=R+1;--F)I[F+l]=k(F,I[F-1+l]+1,I[F+1+l]);I[R+l]=k(R,I[R-1+l]+1,I[R+1+l])}while(I[R+l]!==i);for(o=R+2*O,L=c[R+l],P=[];L!==-1;)P[P.length]=new S(u[L].x,u[L].y,null),L=u[L].k;A(P)}}}),WM}var HM,ez;function U2e(){if(ez)return HM;ez=1;var e=z2e();function t(i,a){var o=new e(i,a);o.compose();for(var l=o.getses(),c,u,d=i.length-1,h=a.length-1,m=l.length-1;m>=0;--m)l[m].t===o.SES_COMMON?(u?(u.chain={file1index:d,file2index:h,chain:null},u=u.chain):(c={file1index:d,file2index:h,chain:null},u=c),d--,h--):l[m].t===o.SES_DELETE?d--:l[m].t===o.SES_ADD&&h--;var y={file1index:-1,file2index:-1,chain:null};return u?(u.chain=y,c):y}function n(i,a){for(var o=[],l=i.length,c=a.length,u=t(i,a);u!==null;u=u.chain){var d=l-u.file1index-1,h=c-u.file2index-1;l=u.file1index,c=u.file2index,(d||h)&&o.push({file1:[l+1,d],file2:[c+1,h]})}return o.reverse(),o}function r(i,a,o){var l,c=n(a,i),u=n(a,o),d=[];function h($,ne){d.push([$.file1[0],ne,$.file1[1],$.file2[0],$.file2[1]])}for(l=0;l<c.length;l++)h(c[l],0);for(l=0;l<u.length;l++)h(u[l],2);d.sort(function($,ne){return $[0]-ne[0]});var m=[],y=0;function b($){$>y&&(m.push([1,y,$-y]),y=$)}for(var v=0;v<d.length;v++){for(var x=v,w=d[v],S=w[0],C=S+w[2];v<d.length-1;){var k=d[v+1],A=k[0];if(A>C)break;C=Math.max(C,A+k[2]),v++}if(b(S),x==v)w[4]>0&&m.push([w[1],w[3],w[4]]);else{var R={0:[i.length,-1,a.length,-1],2:[o.length,-1,a.length,-1]};for(l=x;l<=v;l++){w=d[l];var N=w[1],I=R[N],O=w[0],L=O+w[2],P=w[3],V=P+w[4];I[0]=Math.min(P,I[0]),I[1]=Math.max(V,I[1]),I[2]=Math.min(O,I[2]),I[3]=Math.max(L,I[3])}var F=R[0][0]+(S-R[0][2]),X=R[0][1]+(C-R[0][3]),U=R[2][0]+(S-R[2][2]),H=R[2][1]+(C-R[2][3]);m.push([-1,F,X-F,S,C-S,U,H-U])}y=C}return b(a.length),m}function s(i,a,o){var l=[],c=[i,a,o],u=r(i,a,o),d=[];function h(){d.length&&l.push({ok:d}),d=[]}function m(w){for(var S=0;S<w.length;S++)d.push(w[S])}function y(w){if(w[2]!=w[6])return!0;for(var S=w[1],C=w[5],k=0;k<w[2];k++)if(i[k+S]!=o[k+C])return!0;return!1}for(var b=0;b<u.length;b++){var v=u[b],x=v[0];x==-1?y(v)?(h(),l.push({conflict:{a:i.slice(v[1],v[1]+v[2]),aIndex:v[1],o:a.slice(v[3],v[3]+v[4]),oIndex:v[3],b:o.slice(v[5],v[5]+v[6]),bIndex:v[5]}})):m(c[0].slice(v[1],v[1]+v[2])):m(c[x].slice(v[1],v[1]+v[2]))}return h(),l}return HM=s,HM}var q2e=U2e();const V2e=_a(q2e);class Jr extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new Jr(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class y1 extends Jr{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=y1.code,this.data={filepaths:t}}}y1.code="UnmergedPathsError";class vr extends Jr{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=vr.code,this.data={message:t}}}vr.code="InternalError";class qy extends Jr{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=qy.code,this.data={filepath:t}}}qy.code="UnsafeFilepathError";class ou{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const s=this.buffer.write(t,this._start,n,r);return this._start+=n,s}copy(t,n,r){const s=t.copy(this.buffer,this._start,n,r);return this._start+=s,s}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function KE(e,t){return-(e<t)||+(e>t)}function kY(e,t){return KE(e.path,t.path)}function EY(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const Kc=2**32;function tz(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const s=Math.floor(n/1e3),i=(n-s*1e3)*1e6;return[s,i]}function ey(e){const[t,n]=tz(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,s]=tz(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%Kc,ctimeNanoseconds:n%Kc,mtimeSeconds:r%Kc,mtimeNanoseconds:s%Kc,dev:e.dev%Kc,ino:e.ino%Kc,mode:EY(e.mode%Kc),uid:e.uid%Kc,gid:e.gid%Kc,size:e.size>-1?e.size%Kc:0}}function W2e(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let GM=null;async function zd(e){return GM===null&&(GM=await G2e()),GM?TY(e):H2e(e)}function H2e(e){return new vY().update(e).digest("hex")}async function TY(e){const t=await crypto.subtle.digest("SHA-1",e);return W2e(t)}async function G2e(){try{if(await TY(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function K2e(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function Y2e(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(on.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class Bp{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(on.isBuffer(t))return Bp.fromBuffer(t);if(t===null)return new Bp(null);throw new vr("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new vr("Index file is empty (.git/index)");const n=new Bp,r=new ou(t),s=r.toString("utf8",4);if(s!=="DIRC")throw new vr(`Invalid dircache magic file number: ${s}`);const i=await zd(t.slice(0,-20)),a=t.slice(-20).toString("hex");if(a!==i)throw new vr(`Invalid checksum in GitIndex buffer: expected ${a} but saw ${i}`);const o=r.readUInt32BE();if(o!==2)throw new vr(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let c=0;for(;!r.eof()&&c<l;){const u={};u.ctimeSeconds=r.readUInt32BE(),u.ctimeNanoseconds=r.readUInt32BE(),u.mtimeSeconds=r.readUInt32BE(),u.mtimeNanoseconds=r.readUInt32BE(),u.dev=r.readUInt32BE(),u.ino=r.readUInt32BE(),u.mode=r.readUInt32BE(),u.uid=r.readUInt32BE(),u.gid=r.readUInt32BE(),u.size=r.readUInt32BE(),u.oid=r.slice(20).toString("hex");const d=r.readUInt16BE();u.flags=K2e(d);const h=t.indexOf(0,r.tell()+1)-r.tell();if(h<1)throw new vr(`Got a path length of: ${h}`);if(u.path=r.toString("utf8",h),u.path.includes("..\\")||u.path.includes("../"))throw new qy(u.path);let m=8-(r.tell()-12)%8;for(m===0&&(m=8);m--;){const y=r.readUInt8();if(y!==0)throw new vr(`Expected 1-8 null characters but got '${y}' after ${u.path}`);if(r.eof())throw new vr("Unexpected end of file")}u.stages=[],n._addEntry(u),c++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(kY)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:s=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=ey(n);const i=on.from(t),a={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:s,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(a),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=on.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,s=on.alloc(r),i=new ou(s),a=ey(t);return i.writeUInt32BE(a.ctimeSeconds),i.writeUInt32BE(a.ctimeNanoseconds),i.writeUInt32BE(a.mtimeSeconds),i.writeUInt32BE(a.mtimeNanoseconds),i.writeUInt32BE(a.dev),i.writeUInt32BE(a.ino),i.writeUInt32BE(a.mode),i.writeUInt32BE(a.uid),i.writeUInt32BE(a.gid),i.writeUInt32BE(a.size),i.write(t.oid,20,"hex"),i.writeUInt16BE(Y2e(t)),i.write(t.path,n.length,"utf8"),s}async toObject(){const t=on.alloc(12),n=new ou(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(Bp._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(Bp._entryToBuffer(l));r=await Promise.all(r);const s=on.concat(r),i=on.concat([t,s]),a=await zd(i);return on.concat([i,on.from(a,"hex")])}}function zC(e,t,n=!0,r=!0){const s=ey(e),i=ey(t);return n&&s.mode!==i.mode||s.mtimeSeconds!==i.mtimeSeconds||s.ctimeSeconds!==i.ctimeSeconds||s.uid!==i.uid||s.gid!==i.gid||r&&s.ino!==i.ino||s.size!==i.size}let KM=null;const YM=Symbol("IndexCache");function Z2e(){return{map:new Map,stats:new Map}}async function X2e(e,t,n){const[r,s]=await Promise.all([e.lstat(t),e.read(t)]),i=await Bp.from(s);n.map.set(t,i),n.stats.set(t,r)}async function J2e(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const s=await e.lstat(t);return s===null?!1:zC(r,s)}class aa{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:s=!0},i){r[YM]||(r[YM]=Z2e());const a=`${n}/index`;KM===null&&(KM=new rw({maxPending:1/0}));let o,l=[];return await KM.acquire(a,async()=>{const c=r[YM];await J2e(t,a,c)&&await X2e(t,a,c);const u=c.map.get(a);if(l=u.unmergedPaths,l.length&&!s)throw new y1(l);if(o=await i(u),u._dirty){const d=await u.toObject();await t.write(a,d),c.stats.set(a,await t.lstat(a)),u._dirty=!1}}),o}}function UC(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function ty(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function AY(e){const t=new Map,n=function(s){if(!t.has(s)){const i={type:"tree",fullpath:s,basename:UC(s),metadata:{},children:[]};t.set(s,i),i.parent=n(ty(s)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return t.get(s)},r=function(s,i){if(!t.has(s)){const a={type:"blob",fullpath:s,basename:UC(s),metadata:i,parent:n(ty(s)),children:[]};a.parent&&a.parent.children.push(a),t.set(s,a)}return t.get(s)};n(".");for(const s of e)r(s.path,s);return t}function Q2e(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new vr(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class eCe{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=aa.acquire({fs:t,gitdir:n,cache:r},async function(i){return AY(i.entries)});const s=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,s=(await this.treePromise).get(n);if(!s||s.type==="blob")return null;if(s.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const i=s.children.map(a=>a.fullpath);return i.sort(KE),i}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const s=r.type==="tree"?{}:ey(r.metadata);t._type=r.type==="tree"?"tree":Q2e(s.mode),t._mode=s.mode,r.type==="tree"?t._stat=void 0:t._stat=s}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const YE=Symbol("GitWalkSymbol");function Vy(){const e=Object.create(null);return Object.defineProperty(e,YE,{value:function({fs:t,gitdir:n,cache:r}){return new eCe({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class Es extends Jr{constructor(t){super(`Could not find ${t}.`),this.code=this.name=Es.code,this.data={what:t}}}Es.code="NotFoundError";class co extends Jr{constructor(t,n,r,s){super(`Object ${t} ${s?`at ${s}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=co.code,this.data={oid:t,actual:n,expected:r,filepath:s}}}co.code="ObjectTypeError";class _h extends Jr{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=_h.code,this.data={value:t}}}_h.code="InvalidOidError";class b1 extends Jr{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=b1.code,this.data={remote:t}}}b1.code="NoRefspecError";class qC{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const s=r.indexOf(" ");if(r.startsWith("^")){const i=r.slice(1);return this.refs.set(n+"^{}",i),{line:r,ref:n,peeled:i}}else{const i=r.slice(0,s);return n=r.slice(s+1),this.refs.set(n,i),{line:r,ref:n,oid:i}}})}return this}static from(t){return new qC(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class VC{constructor({remotePath:t,localPath:n,force:r,matchPrefix:s}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:s})}static from(t){const[n,r,s,i,a]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=s==="*";if(l!==(a==="*"))throw new vr("Invalid refspec");return new VC({remotePath:r,localPath:i,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class eD{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(VC.from(r));return new eD(n)}add(t){const n=VC.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const s of t){const i=r.translate(s);i&&n.push([s,i])}return n}translateOne(t){let n=null;for(const r of this.rules){const s=r.translate(t);s&&(n=s)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function tCe(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),s=-(n<r)||+(n>r);return s===0?e.endsWith("^{}")?1:-1:s}const nCe=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},Ev=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},nz={core:{filemode:Ev,bare:Ev,logallrefupdates:Ev,symlinks:Ev,ignorecase:Ev,bigFileThreshold:nCe}},rCe=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,sCe=/^[A-Za-z0-9-.]+$/,iCe=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,aCe=/^[A-Za-z][A-Za-z-]*$/,oCe=/^(.*?)( *[#;].*)$/,lCe=e=>{const t=rCe.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},cCe=e=>{const t=iCe.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),s=uCe(r),i=dCe(s);return[n,i]}return null},uCe=e=>{const t=oCe.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return rz(n)&&rz(r)?`${n}${r}`:n},rz=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,dCe=e=>e.split("").reduce((t,n,r,s)=>{const i=n==='"'&&s[r-1]!=="\\",a=n==="\\"&&s[r+1]==='"';return i||a?t:t+n},""),sz=e=>e!=null?e.toLowerCase():null,Cj=(e,t,n)=>[sz(e),t,sz(n)].filter(r=>r!=null).join("."),iz=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),s=t.length?t.join("."):void 0;return{section:n,subsection:s,name:r,path:Cj(n,s,r),sectionPath:Cj(n,s,null),isSection:!!n}},fCe=(e,t)=>e.reduce((n,r,s)=>t(r)?s:n,-1);class tD{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(s=>{let i=null,a=null;const o=s.trim(),l=lCe(o),c=l!=null;if(c)[n,r]=l;else{const d=cCe(o);d!=null&&([i,a]=d)}const u=Cj(n,r,i);return{line:s,isSection:c,section:n,subsection:r,name:i,value:a,path:u}}):[]}static from(t){return new tD(t)}async get(t,n=!1){const r=iz(t).path,s=this.parsedConfig.filter(i=>i.path===r).map(({section:i,name:a,value:o})=>{const l=nz[i]&&nz[i][a];return l?l(o):o});return n?s:s.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:s,subsection:i,name:a,path:o,sectionPath:l,isSection:c}=iz(t),u=fCe(this.parsedConfig,d=>d.path===o);if(n==null)u!==-1&&this.parsedConfig.splice(u,1);else if(u!==-1){const d=this.parsedConfig[u],h=Object.assign({},d,{name:a,value:n,modified:!0});r?this.parsedConfig.splice(u+1,0,h):this.parsedConfig[u]=h}else{const d=this.parsedConfig.findIndex(m=>m.path===l),h={section:s,subsection:i,name:a,value:n,modified:!0,path:o};if(sCe.test(s)&&aCe.test(a))if(d>=0)this.parsedConfig.splice(d+1,0,h);else{const m={isSection:c,section:s,subsection:i,modified:!0,path:l};this.parsedConfig.push(m,h)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:s,value:i,modified:a=!1})=>a?s!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${s} = "${i}"`:`	${s} = ${i}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class Mi{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return tD.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const OS=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],hCe=["config","description","index","shallow","commondir"];let ZM;async function Kf(e,t){return ZM===void 0&&(ZM=new rw),ZM.acquire(e,t)}class Kt{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:s,symrefs:i,tags:a,refspecs:o=void 0,prune:l=!1,pruneTags:c=!1}){for(const v of s.values())if(!v.match(/[0-9a-f]{40}/))throw new _h(v);const u=await Mi.get({fs:t,gitdir:n});if(!o){if(o=await u.getall(`remote.${r}.fetch`),o.length===0)throw new b1(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const d=eD.from(o),h=new Map;if(c){const v=await Kt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await Kt.deleteRefs({fs:t,gitdir:n,refs:v.map(x=>`refs/tags/${x}`)})}if(a){for(const v of s.keys())if(v.startsWith("refs/tags")&&!v.endsWith("^{}")&&!await Kt.exists({fs:t,gitdir:n,ref:v})){const x=s.get(v);h.set(v,x)}}const m=d.translate([...s.keys()]);for(const[v,x]of m){const w=s.get(v);h.set(x,w)}const y=d.translate([...i.keys()]);for(const[v,x]of y){const w=i.get(v),S=d.translateOne(w);S&&h.set(x,`ref: ${S}`)}const b=[];if(l){for(const v of d.localNamespaces()){const x=(await Kt.listRefs({fs:t,gitdir:n,filepath:v})).map(w=>`${v}/${w}`);for(const w of x)h.has(w)||b.push(w)}b.length>0&&await Kt.deleteRefs({fs:t,gitdir:n,refs:b})}for(const[v,x]of h)await Kf(v,async()=>t.write($t.join(n,v),`${x.trim()}
`,"utf8"));return{pruned:b}}static async writeRef({fs:t,gitdir:n,ref:r,value:s}){if(!s.match(/[0-9a-f]{40}/))throw new _h(s);await Kf(r,async()=>t.write($t.join(n,r),`${s.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:s}){await Kf(r,async()=>t.write($t.join(n,r),`ref: ${s.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return Kt.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm($t.join(n,o))));let s=await Kf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const i=qC.from(s),a=i.refs.size;for(const o of r)i.refs.has(o)&&i.delete(o);i.refs.size<a&&(s=i.toString(),await Kf("packed-refs",async()=>t.write(`${n}/packed-refs`,s,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:s=void 0}){if(s!==void 0&&(s--,s===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),Kt.resolve({fs:t,gitdir:n,ref:r,depth:s});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await Kt.packedRefs({fs:t,gitdir:n}),a=OS(r).filter(o=>!hCe.includes(o));for(const o of a){const l=await Kf(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||i.get(o));if(l)return Kt.resolve({fs:t,gitdir:n,ref:l.trim(),depth:s})}throw new Es(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await Kt.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const s=await Kt.packedRefs({fs:t,gitdir:n}),i=OS(r);for(const a of i)if(await Kf(a,async()=>t.exists(`${n}/${a}`))||s.has(a))return a;throw new Es(r)}static async expandAgainstMap({ref:t,map:n}){const r=OS(t);for(const s of r)if(await n.has(s))return s;throw new Es(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:s}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),Kt.resolveAgainstMap({ref:t,fullref:n,depth:r,map:s});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const i=OS(t);for(const a of i){const o=s.get(a);if(o)return Kt.resolveAgainstMap({ref:o.trim(),fullref:a,depth:r,map:s})}throw new Es(t)}static async packedRefs({fs:t,gitdir:n}){const r=await Kf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return qC.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const s=Kt.packedRefs({fs:t,gitdir:n});let i=null;try{i=await t.readdirDeep(`${n}/${r}`),i=i.map(a=>a.replace(`${n}/${r}/`,""))}catch{i=[]}for(let a of(await s).keys())a.startsWith(r)&&(a=a.replace(r+"/",""),i.includes(a)||i.push(a));return i.sort(tCe),i}static async listBranches({fs:t,gitdir:n,remote:r}){return r?Kt.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):Kt.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await Kt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(s=>!s.endsWith("^{}"))}}function pCe(e,t){return KE(az(e),az(t))}function az(e){return e.mode==="040000"?e.path+"/":e.path}function RY(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new vr(`Unexpected GitTree entry mode: ${e}`)}function mCe(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new vr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const s=e.indexOf(0,n);if(s===-1)throw new vr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let i=e.slice(n,r).toString("utf8");i==="40000"&&(i="040000");const a=RY(i),o=e.slice(r+1,s).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new qy(o);const l=e.slice(s+1,s+21).toString("hex");n=s+21,t.push({mode:i,path:o,oid:l,type:a})}return t}function gCe(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new vr(`Could not understand file mode: ${e}`)}function yCe(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=gCe(e.mode),e.type||(e.type=RY(e.mode)),e}class Io{constructor(t){if(on.isBuffer(t))this._entries=mCe(t);else if(Array.isArray(t))this._entries=t.map(yCe);else throw new vr("invalid type passed to GitTree constructor");this._entries.sort(kY)}static from(t){return new Io(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(pCe),on.concat(t.map(n=>{const r=on.from(n.mode.replace(/^0/,"")),s=on.from(" "),i=on.from(n.path,"utf8"),a=on.from([0]),o=on.from(n.oid,"hex");return on.concat([r,s,i,a,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class Wy{static wrap({type:t,object:n}){return on.concat([on.from(`${t} ${n.byteLength.toString()}\0`),on.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),s=t.slice(0,n).toString("utf8"),i=t.slice(n+1,r).toString("utf8"),a=t.length-(r+1);if(parseInt(i)!==a)throw new vr(`Length mismatch: expected ${i} bytes but got ${a} instead.`);return{type:s,object:on.from(t.slice(r+1))}}}async function NY({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,s=await e.read(`${t}/${r}`);return s?{object:s,format:"deflated",source:r}:null}function bCe(e,t){const n=new ou(e),r=oz(n);if(r!==t.byteLength)throw new vr(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const s=oz(n);let i;const a=cz(n,t);if(a.byteLength===s)i=a;else{i=on.alloc(s);const o=new ou(i);for(o.copy(a);!n.eof();)o.copy(cz(n,t));const l=o.tell();if(s!==l)throw new vr(`applyDelta expected target buffer to be ${s} bytes but the resulting buffer was ${l} bytes`)}return i}function oz(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function lz(e,t,n){let r=0,s=0;for(;n--;)t&1&&(r|=e.readUInt8()<<s),t>>=1,s+=8;return r}function cz(e,t){const n=e.readUInt8(),r=128,s=15,i=112;if(n&r){const a=lz(e,n&s,4);let o=lz(e,(n&i)>>4,3);return o===0&&(o=65536),t.slice(a,a+o)}else return e.slice(n)}function vCe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function MY(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:vCe(e)}class IY{constructor(t){if(typeof on>"u")throw new Error("Missing Buffer dependency");this.stream=MY(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?on.alloc(0):(n&&(n=on.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>xCe(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=on.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function xCe(e){return e.reduce((t,n)=>t+n.length,0)}async function wCe(e,t){const n=new IY(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new vr(`Invalid PACK header '${r}'`);let s=await n.read(4);if(s=s.readUInt32BE(0),s!==2)throw new vr(`Invalid packfile version: ${s}`);let i=await n.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!n.eof()&&i--;){const a=n.tell(),{type:o,length:l,ofs:c,reference:u}=await _Ce(n),d=new QP.Inflate;for(;!d.result;){const h=await n.chunk();if(!h)break;if(d.push(h,!1),d.err)throw new vr(`Pako error: ${d.msg}`);if(d.result){if(d.result.length!==l)throw new vr("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(h.length-d.strm.avail_in);const m=n.tell();await t({data:d.result,type:o,num:i,offset:a,end:m,reference:u,ofs:c})}}}}async function _Ce(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let a=4;do t=await e.byte(),r|=(t&127)<<a,a+=7;while(t&128)}let s,i;if(n===6){let a=0;s=0;const o=[];do t=await e.byte(),s|=(t&127)<<a,a+=7,o.push(t);while(t&128);i=on.from(o)}return n===7&&(i=await e.read(20)),{type:n,length:r,ofs:s,reference:i}}async function jY(e){return QP.inflate(e)}function SCe(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const s=n&127;t.push(s),r=n&128}while(r);return t.reduce((s,i)=>s+1<<7|i,-1)}function CCe(e,t){let n=t,r=4,s=null;do s=e.readUInt8(),n|=(s&127)<<r,r+=7;while(s&128);return n}class ny{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new ou(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const i=r.readUInt32BE();if(i!==2)throw new vr(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new vr("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const a=r.readUInt32BE(),o=[];for(let u=0;u<a;u++){const d=r.slice(20).toString("hex");o[u]=d}r.seek(r.tell()+4*a);const l=new Map;for(let u=0;u<a;u++)l.set(o[u],r.readUInt32BE());const c=r.slice(20).toString("hex");return new ny({hashes:o,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const s={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},a=t.slice(-20).toString("hex"),o=[],l={},c=new Map;let u=null,d=null;await wCe([t],async({data:v,type:x,reference:w,offset:S,num:C})=>{u===null&&(u=C);const k=Math.floor((u-C)*100/u);k!==d&&r&&await r({phase:"Receiving objects",loaded:u-C,total:u}),d=k,x=s[x],["commit","tree","blob","tag"].includes(x)?i[S]={type:x,offset:S}:x==="ofs-delta"?i[S]={type:x,offset:S}:x==="ref-delta"&&(i[S]={type:x,offset:S})});const h=Object.keys(i).map(Number);for(const[v,x]of h.entries()){const w=v+1===h.length?t.byteLength-20:h[v+1],S=i[x],C=S2e.buf(t.slice(x,w))>>>0;S.end=w,S.crc=C}const m=new ny({pack:Promise.resolve(t),packfileSha:a,crcs:l,hashes:o,offsets:c,getExternalRefDelta:n});d=null;let y=0;const b=[0,0,0,0,0,0,0,0,0,0,0,0];for(let v in i){v=Number(v);const x=Math.floor(y*100/u);x!==d&&r&&await r({phase:"Resolving deltas",loaded:y,total:u}),y++,d=x;const w=i[v];if(!w.oid)try{m.readDepth=0,m.externalReadDepth=0;const{type:S,object:C}=await m.readSlice({start:v});b[m.readDepth]+=1;const k=await zd(Wy.wrap({type:S,object:C}));w.oid=k,o.push(k),c.set(k,v),l[k]=w.crc}catch{continue}}return o.sort(),m}async toBuffer(){const t=[],n=(c,u)=>{t.push(on.from(c,u))};n("ff744f63","hex"),n("00000002","hex");const r=new ou(on.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const d of this.hashes)parseInt(d.slice(0,2),16)<=c&&u++;r.writeUInt32BE(u)}t.push(r.buffer);for(const c of this.hashes)n(c,"hex");const s=new ou(on.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.crcs[c]);t.push(s.buffer);const i=new ou(on.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.offsets.get(c));t.push(i.buffer),n(this.packfileSha,"hex");const a=on.concat(t),o=await zd(a),l=on.alloc(20);return l.write(o,"hex"),on.concat([a,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new vr(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new vr("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),s=new ou(r),i=s.readUInt8(),a=i&112;let o=n[a];if(o===void 0)throw new vr("Unrecognized type: 0b"+a.toString(2));const l=i&15;let c=l;i&128&&(c=CCe(s,l));let d=null,h=null;if(o==="ofs_delta"){const y=SCe(s),b=t-y;({object:d,type:o}=await this.readSlice({start:b}))}if(o==="ref_delta"){const y=s.slice(20).toString("hex");({object:d,type:o}=await this.read({oid:y}))}const m=r.slice(s.tell());if(h=on.from(await jY(m)),h.byteLength!==c)throw new vr(`Packfile told us object would have length ${c} but it had length ${h.byteLength}`);return d&&(h=on.from(bCe(h,d))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:h}),{type:o,format:"content",object:h}}}const PS=Symbol("PackfileCache");async function kCe({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:s}){const i=await e.read(t);return ny.fromIdx({idx:i,getExternalRefDelta:n})}function nD({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}){t[PS]||(t[PS]=new Map);let a=t[PS].get(n);return a||(a=kCe({fs:e,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}),t[PS].set(n,a)),a}async function ECe({fs:e,cache:t,gitdir:n,oid:r,format:s="content",getExternalRefDelta:i}){let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await nD({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(c.error)throw new vr(c.error);if(c.offsets.has(r)){if(!c.pack){const d=l.replace(/idx$/,"pack");c.pack=e.read(d)}const u=await c.read({oid:r,getExternalRefDelta:i});return u.format="content",u.source=`objects/pack/${o.replace(/idx$/,"pack")}`,u}}return null}async function Ks({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=u=>Ks({fs:e,cache:t,gitdir:n,oid:u});let a;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(a={format:"wrapped",object:on.from("tree 0\0")}),a||(a=await NY({fs:e,gitdir:n,oid:r})),!a){if(a=await ECe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}),!a)throw new Es(r);return a}if(s==="deflated"||(a.format==="deflated"&&(a.object=on.from(await jY(a.object)),a.format="wrapped"),s==="wrapped"))return a;const o=await zd(a.object);if(o!==r)throw new vr(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:c}=Wy.unwrap(a.object);if(a.type=c,a.object=l,a.format="content",s==="content")return a;throw new vr(`invalid requested format "${s}"`)}class Ic extends Jr{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=Ic.code,this.data={noun:t,where:n,canForce:r}}}Ic.code="AlreadyExistsError";class v1 extends Jr{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=v1.code,this.data={nouns:t,short:n,matches:r}}}v1.code="AmbiguousError";class x1 extends Jr{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=x1.code,this.data={filepaths:t}}}x1.code="CheckoutConflictError";class w1 extends Jr{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=w1.code,this.data={ref:t,oid:n}}}w1.code="CommitNotFetchedError";class _1 extends Jr{constructor(){super("Empty response from git server."),this.code=this.name=_1.code,this.data={}}}_1.code="EmptyServerResponseError";class S1 extends Jr{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=S1.code,this.data={}}}S1.code="FastForwardError";class C1 extends Jr{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=C1.code,this.data={prettyDetails:t,result:n}}}C1.code="GitPushError";class ry extends Jr{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=ry.code,this.data={statusCode:t,statusMessage:n,response:r}}}ry.code="HttpError";class Sh extends Jr{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=Sh.code,this.data={reason:t}}}Sh.code="InvalidFilepathError";class Ac extends Jr{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=Ac.code,this.data={ref:t,suggestion:n}}}Ac.code="InvalidRefNameError";class k1 extends Jr{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=k1.code,this.data={depth:t}}}k1.code="MaxDepthError";class Hy extends Jr{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=Hy.code,this.data={}}}Hy.code="MergeNotSupportedError";class Gy extends Jr{constructor(t,n,r,s){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=Gy.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:s}}}Gy.code="MergeConflictError";class Ba extends Jr{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=Ba.code,this.data={role:t}}}Ba.code="MissingNameError";class Ao extends Jr{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=Ao.code,this.data={parameter:t}}}Ao.code="MissingParameterError";class E1 extends Jr{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=E1.code,this.data={errors:t},this.errors=t}}E1.code="MultipleGitError";class Bm extends Jr{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=Bm.code,this.data={expected:t,actual:n}}}Bm.code="ParseError";class sy extends Jr{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=sy.code,this.data={reason:t}}}sy.code="PushRejectedError";class oh extends Jr{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=oh.code,this.data={capability:t,parameter:n}}}oh.code="RemoteCapabilityError";class T1 extends Jr{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=T1.code,this.data={preview:t,response:n}}}T1.code="SmartHttpError";class A1 extends Jr{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=A1.code,this.data={url:t,transport:n,suggestion:r}}}A1.code="UnknownTransportError";class R1 extends Jr{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=R1.code,this.data={url:t}}}R1.code="UrlParseError";class Ky extends Jr{constructor(){super("The operation was canceled."),this.code=this.name=Ky.code,this.data={}}}Ky.code="UserCanceledError";class N1 extends Jr{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=N1.code,this.data={filepath:t}}}N1.code="IndexResetError";class M1 extends Jr{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=M1.code,this.data={ref:t}}}M1.code="NoCommitError";var TCe=Object.freeze({__proto__:null,AlreadyExistsError:Ic,AmbiguousError:v1,CheckoutConflictError:x1,CommitNotFetchedError:w1,EmptyServerResponseError:_1,FastForwardError:S1,GitPushError:C1,HttpError:ry,InternalError:vr,InvalidFilepathError:Sh,InvalidOidError:_h,InvalidRefNameError:Ac,MaxDepthError:k1,MergeNotSupportedError:Hy,MergeConflictError:Gy,MissingNameError:Ba,MissingParameterError:Ao,MultipleGitError:E1,NoRefspecError:b1,NotFoundError:Es,ObjectTypeError:co,ParseError:Bm,PushRejectedError:sy,RemoteCapabilityError:oh,SmartHttpError:T1,UnknownTransportError:A1,UnsafeFilepathError:qy,UrlParseError:R1,UserCanceledError:Ky,UnmergedPathsError:y1,IndexResetError:N1,NoCommitError:M1});function kj({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=ACe(r),`${e} <${t}> ${n} ${r}`}function ACe(e){const t=RCe(NCe(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),s=String(e);return r.length<2&&(r="0"+r),s.length<2&&(s="0"+s),(t===-1?"-":"+")+r+s}function RCe(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function NCe(e){return e===0?e:-e}function vd(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function WC(e){const[,t,n,r,s]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:MCe(s)}}function MCe(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),ICe(r)}function ICe(e){return e===0?e:-e}class to{constructor(t){if(typeof t=="string")this._tag=t;else if(on.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=to.render(t);else throw new vr("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new to(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${kj(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.tagger&&(r.tagger=WC(r.tagger)),r.committer&&(r.committer=WC(r.committer)),r}withoutSignature(){const t=vd(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return vd(t)}payload(){return this.withoutSignature()+`
`}toObject(){return on.from(this._tag,"utf8")}static async sign(t,n,r){const s=t.payload();let{signature:i}=await n({payload:s,secretKey:r});i=vd(i);const a=s+i;return to.from(a)}}function XM(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function jCe(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class Gs{constructor(t){if(typeof t=="string")this._commit=t;else if(on.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=Gs.render(t);else throw new vr("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=Gs.justHeaders(t),s=Gs.justMessage(t),i=vd(r+`
gpgsig`+XM(n)+`
`+s);return new Gs(i)}static from(t){return new Gs(t)}toObject(){return on.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Gs.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return vd(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=Gs.justHeaders(this._commit).split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={parent:[]};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.author&&(r.author=WC(r.author)),r.committer&&(r.committer=WC(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new vr("commit 'parent' property should be an array");for(const i of t.parent)n+=`parent ${i}
`}const r=t.author;n+=`author ${kj(r)}
`;const s=t.committer||t.author;return n+=`committer ${kj(s)}
`,t.gpgsig&&(n+="gpgsig"+XM(t.gpgsig)),n}static render(t){return Gs.renderHeaders(t)+`
`+vd(t.message)}render(){return this._commit}withoutSignature(){const t=vd(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return vd(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return jCe(t)}static async sign(t,n,r){const s=t.withoutSignature(),i=Gs.justMessage(t._commit);let{signature:a}=await n({payload:s,secretKey:r});a=vd(a);const l=Gs.justHeaders(t._commit)+`
gpgsig`+XM(a)+`
`+i;return Gs.from(l)}}async function iy({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Io.from([]),oid:r};const{type:s,object:i}=await Ks({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=to.from(i).parse().object,iy({fs:e,cache:t,gitdir:n,oid:r});if(s==="commit")return r=Gs.from(i).parse().tree,iy({fs:e,cache:t,gitdir:n,oid:r});if(s!=="tree")throw new co(r,s,"tree");return{tree:Io.from(i),oid:r}}class OCe{constructor({fs:t,gitdir:n,ref:r,cache:s}){this.fs=t,this.cache=s,this.gitdir=n,this.mapPromise=(async()=>{const a=new Map;let o;try{o=await Kt.resolve({fs:t,gitdir:n,ref:r})}catch(c){c instanceof Es&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await iy({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",a.set(".",l),a})();const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:s,gitdir:i}=this,a=await this.mapPromise,o=a.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:c,object:u}=await Ks({fs:r,cache:s,gitdir:i,oid:l});if(c!==o.type)throw new co(l,c,o.type);const d=Io.from(u);for(const h of d)a.set($t.join(n,h.path),h);return d.entries().map(h=>$t.join(n,h.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=EY(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:s,gitdir:i}=this,o=n.get(t._fullpath).oid,{type:l,object:c}=await Ks({fs:r,cache:s,gitdir:i,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(c)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function zl({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,YE,{value:function({fs:n,gitdir:r,cache:s}){return new OCe({fs:n,gitdir:r,ref:e,cache:s})}}),Object.freeze(t),t}class PCe{constructor({fs:t,dir:n,gitdir:r,cache:s}){this.fs=t,this.cache=s,this.dir=n,this.gitdir=r,this.config=null;const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:s}=this,i=await r.readdir($t.join(s,n));return i===null?null:i.map(a=>$t.join(n,a))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let s=await n.lstat(`${r}/${t._fullpath}`);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let i=s.isDirectory()?"tree":"blob";i==="blob"&&!s.isFile()&&!s.isSymbolicLink()&&(i="special"),t._type=i,s=ey(s),t._mode=s.mode,s.size===-1&&t._actualSize&&(s.size=t._actualSize),t._stat=s}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:s}=this;if(await t.type()==="tree")t._content=void 0;else{const a=await(await this._getGitConfig(n,s)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:a});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:s,cache:i}=this;let a;await aa.acquire({fs:r,gitdir:s,cache:i},async function(o){const l=o.entriesMap.get(t._fullpath),c=await t.stat(),d=await(await n._getGitConfig(r,s)).get("core.filemode"),h=typeof Ai<"u"?Ai.platform!=="win32":!0;if(!l||zC(c,l,d,h)){const m=await t.content();m===void 0?a=void 0:(a=await zd(Wy.wrap({type:"blob",object:m})),l&&a===l.oid&&(!d||c.mode===l.mode)&&zC(c,l,d,h)&&o.insert({filepath:t._fullpath,stats:c,oid:a}))}else a=l.oid}),t._oid=a}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await Mi.get({fs:t,gitdir:n}),this.config)}}function I1(){const e=Object.create(null);return Object.defineProperty(e,YE,{value:function({fs:t,dir:n,gitdir:r,cache:s}){return new PCe({fs:t,dir:n,gitdir:r,cache:s})}}),Object.freeze(e),e}function DCe(e,t){const n=t-e;return Array.from({length:n},(r,s)=>e+s)}const OY=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class FCe{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*LCe(e){const t=new FCe;let n;const r=[],s=e.length;for(let i=0;i<s;i++)r[i]=e[i].next().value,r[i]!==void 0&&t.consider(r[i]);if(t.value!==null)for(;;){const i=[];n=t.value,t.reset();for(let a=0;a<s;a++)r[a]!==void 0&&r[a]===n?(i[a]=r[a],r[a]=e[a].next().value):i[a]=null,r[a]!==void 0&&t.consider(r[a]);if(yield i,t.value===null)return}}async function Ch({fs:e,cache:t,dir:n,gitdir:r,trees:s,map:i=async(l,c)=>c,reduce:a=async(l,c)=>{const u=OY(c);return l!==void 0&&u.unshift(l),u},iterate:o=(l,c)=>Promise.all([...c].map(l))}){const l=s.map(m=>m[YE]({fs:e,dir:n,gitdir:r,cache:t})),c=new Array(l.length).fill("."),u=DCe(0,l.length),d=async m=>{u.map(v=>{const x=m[v];m[v]=x&&new l[v].ConstructEntry(x)});const b=(await Promise.all(u.map(v=>{const x=m[v];return x?l[v].readdir(x):[]}))).map(v=>(v===null?[]:v)[Symbol.iterator]());return{entries:m,children:LCe(b)}},h=async m=>{const{entries:y,children:b}=await d(m),v=y.find(w=>w&&w._fullpath)._fullpath,x=await i(v,y);if(x!==null){let w=await o(h,b);return w=w.filter(S=>S!==void 0),a(x,w)}};return h(c)}async function Ej(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const s=$t.join(t,r);return e.lstat(s).then(i=>{if(i)return i.isDirectory()?Ej(e,s):e.rm(s)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function BCe(e){return $Ce(e)&&uz(e.then)&&uz(e.catch)}function $Ce(e){return e&&typeof e=="object"}function uz(e){return typeof e=="function"}function dz(e){return BCe((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const fz=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function hz(e,t){if(dz(t))for(const n of fz)e[`_${n}`]=t[n].bind(t);else for(const n of fz)e[`_${n}`]=UM(t[n].bind(t));dz(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=Ej.bind(null,e):t.rm?e._rm=UM(t.rm.bind(t)):t.rmdir.length>2?e._rm=UM(t.rmdir.bind(t)):e._rm=Ej.bind(null,e)}class Sn{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?hz(this,t.promises):hz(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=on.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(ty(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const s=ty(t);if(s==="."||s==="/"||s===t)throw r;await this.mkdir(s),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(KE),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async s=>{const i=t+"/"+s;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((s,i)=>s.concat(i),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return on.isBuffer(r)?r:on.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function ct(e,t){if(t===void 0)throw new Ao(e)}async function HC(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function zCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r="HEAD",cache:s={}}){try{ct("fs",e),ct("dir",t),ct("gitdir",n);const i=new Sn(e),a=[zl({ref:r}),I1(),Vy()];let o=[];await aa.acquire({fs:i,gitdir:n,cache:s},async function(c){o=c.unmergedPaths});const l=await Ch({fs:i,cache:s,dir:t,gitdir:n,trees:a,map:async function(c,[u,d,h]){const m=!await HC(d,h),y=o.includes(c),b=!await HC(h,u);if(m||y)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(b)return!1;throw new N1(c)}});await aa.acquire({fs:i,gitdir:n,cache:s},async function(c){for(const u of l)if(u!==!1){if(!u){await i.rmdir(`${t}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const d=new TextDecoder().decode(u.content);await i.write(`${t}/${u.path}`,d,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class Yy{static async isIgnored({fs:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s}){if(UC(s)===".git")return!0;if(s===".")return!1;let i="";const a=$t.join(r,"info","exclude");await t.exists(a)&&(i=await t.read(a,"utf8"));const o=[{gitignore:$t.join(n,".gitignore"),filepath:s}],l=s.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const d=l.slice(0,u).join("/"),h=l.slice(u).join("/");o.push({gitignore:$t.join(n,d,".gitignore"),filepath:h})}let c=!1;for(const u of o){let d;try{d=await t.read(u.gitignore,"utf8")}catch(y){if(y.code==="NOENT")continue}const h=L2e().add(i);h.add(d);const m=ty(u.filepath);if(m!=="."&&h.ignores(m))return!0;c?c=!h.test(u.filepath).unignored:c=h.test(u.filepath).ignored}return c}}async function UCe({fs:e,gitdir:t,object:n,format:r,oid:s}){const i=`objects/${s.slice(0,2)}/${s.slice(2)}`,a=`${t}/${i}`;await e.exists(a)||await e.write(a,n)}let JM=null;async function PY(e){return JM===null&&(JM=VCe()),JM?qCe(e):QP.deflate(e)}async function qCe(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function VCe(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function Bo({fs:e,gitdir:t,type:n,object:r,format:s="content",oid:i=void 0,dryRun:a=!1}){return s!=="deflated"&&(s!=="wrapped"&&(r=Wy.wrap({type:n,object:r})),i=await zd(r),r=on.from(await PY(r))),a||await UCe({fs:e,gitdir:t,object:r,format:"deflated",oid:i}),i}function DY(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function WCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={},force:i=!1,parallel:a=!0}){try{ct("fs",e),ct("dir",t),ct("gitdir",n),ct("filepath",r);const o=new Sn(e);await aa.acquire({fs:o,gitdir:n,cache:s},async l=>{const u=await(await Mi.get({fs:o,gitdir:n})).get("core.autocrlf");return Tj({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:i,parallel:a,autocrlf:u})})}catch(o){throw o.caller="git.add",o}}async function Tj({dir:e,gitdir:t,fs:n,filepath:r,index:s,force:i,parallel:a,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async h=>{if(!i&&await Yy.isIgnored({fs:n,dir:e,gitdir:t,filepath:h}))return;const m=await n.lstat($t.join(e,h));if(!m)throw new Es(h);if(m.isDirectory()){const y=await n.readdir($t.join(e,h));if(a){const b=y.map(v=>Tj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,v)],index:s,force:i,parallel:a,autocrlf:o}));await Promise.all(b)}else for(const b of y)await Tj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,b)],index:s,force:i,parallel:a,autocrlf:o})}else{const y=m.isSymbolicLink()?await n.readlink($t.join(e,h)).then(DY):await n.read($t.join(e,h),{autocrlf:o});if(y===null)throw new Es(h);const b=await Bo({fs:n,gitdir:t,type:"blob",object:y});s.insert({filepath:h,stats:m,oid:b})}}),c=await Promise.allSettled(l),u=c.filter(h=>h.status==="rejected").map(h=>h.reason);if(u.length>1)throw new E1(u);if(u.length===1)throw u[0];return c.filter(h=>h.status==="fulfilled"&&h.value).map(h=>h.value)}async function sw({fs:e,gitdir:t,path:n}){return(await Mi.get({fs:e,gitdir:t})).get(n)}function FY(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const s=n[r];s!==void 0&&(e[r]=s)}return e}async function kh({fs:e,gitdir:t,author:n,commit:r}){const s=Math.floor(Date.now()/1e3),i={name:await sw({fs:e,gitdir:t,path:"user.name"}),email:await sw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},a=FY({},i,r?r.author:void 0,n);if(a.name!==void 0)return a}async function ay({fs:e,gitdir:t,author:n,committer:r,commit:s}){const i=Math.floor(Date.now()/1e3),a={name:await sw({fs:e,gitdir:t,path:"user.name"}),email:await sw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},o=FY({},a,s?s.committer:void 0,n,r);if(o.name!==void 0)return o}async function LY({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Ks({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=to.from(i).parse().object,LY({fs:e,cache:t,gitdir:n,oid:r});if(s!=="commit")throw new co(r,s,"commit");return{commit:Gs.from(i),oid:r}}async function oy({fs:e,cache:t,gitdir:n,oid:r}){const{commit:s,oid:i}=await LY({fs:e,cache:t,gitdir:n,oid:r});return{oid:i,commit:s.parse(),payload:s.withoutSignature()}}async function ZE({fs:e,cache:t,onSign:n,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m}){let y=!1;d||(d=await Kt.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let b,v;try{b=await Kt.resolve({fs:e,gitdir:r,ref:d}),v=await oy({fs:e,gitdir:r,oid:b,cache:{}})}catch{y=!0}if(l&&y)throw new M1(d);const x=l?await kh({fs:e,gitdir:r,author:i,commit:v.commit}):await kh({fs:e,gitdir:r,author:i});if(!x)throw new Ba("author");const w=l?await ay({fs:e,gitdir:r,author:x,committer:a,commit:v.commit}):await ay({fs:e,gitdir:r,author:x,committer:a});if(!w)throw new Ba("committer");return aa.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(S){const k=AY(S.entries).get(".");if(m||(m=await BY({fs:e,gitdir:r,inode:k,dryRun:c})),h?h=await Promise.all(h.map(N=>Kt.resolve({fs:e,gitdir:r,ref:N}))):l?h=v.commit.parent:h=b?[b]:[],!s)if(l)s=v.commit.message;else throw new Ao("message");let A=Gs.from({tree:m,parent:h,author:x,committer:w,message:s});o&&(A=await Gs.sign(A,n,o));const R=await Bo({fs:e,gitdir:r,type:"commit",object:A.toObject(),dryRun:c});return!u&&!c&&await Kt.writeRef({fs:e,gitdir:r,ref:d,value:R}),R})}async function BY({fs:e,gitdir:t,inode:n,dryRun:r}){const s=n.children;for(const l of s)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await BY({fs:e,gitdir:t,inode:l,dryRun:r}));const i=s.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),a=Io.from(i);return await Bo({fs:e,gitdir:t,type:"tree",object:a.toObject(),dryRun:r})}async function j1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}){if(s.startsWith("/"))throw new Sh("leading-slash");if(s.endsWith("/"))throw new Sh("trailing-slash");const i=r,a=await iy({fs:e,cache:t,gitdir:n,oid:r}),o=a.tree;if(s==="")r=a.oid;else{const l=s.split("/");r=await $Y({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:i,filepath:s})}return r}async function $Y({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a}){const o=s.shift();for(const l of r)if(l.path===o){if(s.length===0)return l.oid;{const{type:c,object:u}=await Ks({fs:e,cache:t,gitdir:n,oid:l.oid});if(c!=="tree")throw new co(i,c,"tree",a);return r=Io.from(u),$Y({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a})}}throw new Es(`file or directory found at "${i}:${a}"`)}async function Zy({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){s!==void 0&&(r=await j1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}));const{tree:i,oid:a}=await iy({fs:e,cache:t,gitdir:n,oid:r});return{oid:a,tree:i.entries()}}async function O1({fs:e,gitdir:t,tree:n}){const r=Io.from(n).toObject();return await Bo({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function HCe({fs:e,cache:t,onSign:n,gitdir:r,ref:s,oid:i,note:a,force:o,author:l,committer:c,signingKey:u}){let d;try{d=await Kt.resolve({gitdir:r,fs:e,ref:s})}catch(x){if(!(x instanceof Es))throw x}let m=(await Zy({fs:e,cache:t,gitdir:r,oid:d||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)m=m.filter(x=>x.path!==i);else for(const x of m)if(x.path===i)throw new Ic("note",i);typeof a=="string"&&(a=on.from(a,"utf8"));const y=await Bo({fs:e,gitdir:r,type:"blob",object:a,format:"content"});m.push({mode:"100644",path:i,oid:y,type:"blob"});const b=await O1({fs:e,gitdir:r,tree:m});return await ZE({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:b,parent:d&&[d],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function GCe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,note:a,force:o,author:l,committer:c,signingKey:u,cache:d={}}){try{ct("fs",e),ct("gitdir",r),ct("oid",i),ct("note",a),u&&ct("onSign",t);const h=new Sn(e),m=await kh({fs:h,gitdir:r,author:l});if(!m)throw new Ba("author");const y=await ay({fs:h,gitdir:r,author:m,committer:c});if(!y)throw new Ba("committer");return await HCe({fs:new Sn(h),cache:d,onSign:t,gitdir:r,ref:s,oid:i,note:a,force:o,author:m,committer:y,signingKey:u})}catch(h){throw h.caller="git.addNote",h}}async function zY({fs:e,gitdir:t,remote:n,url:r,force:s}){if(n!==uu.clean(n))throw new Ac(n,uu.clean(n));const i=await Mi.get({fs:e,gitdir:t});if(!s&&(await i.getSubsections("remote")).includes(n)&&r!==await i.get(`remote.${n}.url`))throw new Ic("remote",n);await i.set(`remote.${n}.url`,r),await i.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await Mi.save({fs:e,gitdir:t,config:i})}async function KCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r,url:s,force:i=!1}){try{return ct("fs",e),ct("gitdir",n),ct("remote",r),ct("url",s),await zY({fs:new Sn(e),gitdir:n,remote:r,url:s,force:i})}catch(a){throw a.caller="git.addRemote",a}}async function YCe({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1}){if(s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`,!u&&await Kt.exists({fs:e,gitdir:r,ref:s}))throw new Ic("tag",s);const d=await Kt.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:h}=await Ks({fs:e,cache:t,gitdir:r,oid:d});let m=to.from({object:d,type:h,tag:s.replace("refs/tags/",""),tagger:i,message:a,gpgsig:o});c&&(m=await to.sign(m,n,c));const y=await Bo({fs:e,gitdir:r,type:"tag",object:m.toObject()});await Kt.writeRef({fs:e,gitdir:r,ref:s,value:y})}async function ZCe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1,cache:d={}}){try{ct("fs",e),ct("gitdir",r),ct("ref",s),c&&ct("onSign",t);const h=new Sn(e),m=await kh({fs:h,gitdir:r,author:i});if(!m)throw new Ba("tagger");return await YCe({fs:h,cache:d,onSign:t,gitdir:r,ref:s,tagger:m,message:a,gpgsig:o,object:l,signingKey:c,force:u})}catch(h){throw h.caller="git.annotatedTag",h}}async function XCe({fs:e,gitdir:t,ref:n,object:r,checkout:s=!1,force:i=!1}){if(n!==uu.clean(n))throw new Ac(n,uu.clean(n));const a=`refs/heads/${n}`;if(!i&&await Kt.exists({fs:e,gitdir:t,ref:a}))throw new Ic("branch",n,!1);let o;try{o=await Kt.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await Kt.writeRef({fs:e,gitdir:t,ref:a,value:o}),s&&await Kt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function JCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,checkout:i=!1,force:a=!1}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await XCe({fs:new Sn(e),gitdir:n,ref:r,object:s,checkout:i,force:a})}catch(o){throw o.caller="git.branch",o}}const UY=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function rD({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:s,gitdir:i,remote:a,ref:o,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:d,force:h,track:m=!0}){let y;if(r)try{y=await Kt.resolve({fs:e,gitdir:i,ref:"HEAD"})}catch{y="0000000000000000000000000000000000000000"}let b;try{b=await Kt.resolve({fs:e,gitdir:i,ref:o})}catch(v){if(o==="HEAD")throw v;const x=`${a}/${o}`;if(b=await Kt.resolve({fs:e,gitdir:i,ref:x}),m){const w=await Mi.get({fs:e,gitdir:i});await w.set(`branch.${o}.remote`,a),await w.set(`branch.${o}.merge`,`refs/heads/${o}`),await Mi.save({fs:e,gitdir:i,config:w})}await Kt.writeRef({fs:e,gitdir:i,ref:`refs/heads/${o}`,value:b})}if(!c){let v;try{v=await QCe({fs:e,cache:t,onProgress:n,dir:s,gitdir:i,ref:o,force:h,filepaths:l})}catch(k){throw k instanceof Es&&k.data.what===b?new w1(o,b):k}const x=v.filter(([k])=>k==="conflict").map(([k,A])=>A);if(x.length>0)throw new x1(x);const w=v.filter(([k])=>k==="error").map(([k,A])=>A);if(w.length>0)throw new vr(w.join(", "));if(d){r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"});return}let S=0;const C=v.length;await aa.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(v.filter(([A])=>A==="delete"||A==="delete-index").map(async function([A,R]){const N=`${s}/${R}`;A==="delete"&&await e.rm(N),k.delete({filepath:R}),n&&await n({phase:"Updating workdir",loaded:++S,total:C})}))}),await aa.acquire({fs:e,gitdir:i,cache:t},async function(k){for(const[A,R]of v)if(A==="rmdir"||A==="rmdir-index"){const N=`${s}/${R}`;try{A==="rmdir-index"&&k.delete({filepath:R}),await e.rmdir(N),n&&await n({phase:"Updating workdir",loaded:++S,total:C})}catch(I){if(I.code==="ENOTEMPTY")console.log(`Did not delete ${R} because directory is not empty`);else throw I}}}),await Promise.all(v.filter(([k])=>k==="mkdir"||k==="mkdir-index").map(async function([k,A]){const R=`${s}/${A}`;await e.mkdir(R),n&&await n({phase:"Updating workdir",loaded:++S,total:C})})),await aa.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(v.filter(([A])=>A==="create"||A==="create-index"||A==="update"||A==="mkdir-index").map(async function([A,R,N,I,O]){const L=`${s}/${R}`;try{if(A!=="create-index"&&A!=="mkdir-index"){const{object:V}=await Ks({fs:e,cache:t,gitdir:i,oid:N});if(O&&await e.rm(L),I===33188)await e.write(L,V);else if(I===33261)await e.write(L,V,{mode:511});else if(I===40960)await e.writelink(L,V);else throw new vr(`Invalid mode 0o${I.toString(8)} detected in blob ${N}`)}const P=await e.lstat(L);I===33261&&(P.mode=493),A==="mkdir-index"&&(P.mode=57344),k.insert({filepath:R,stats:P,oid:N}),n&&await n({phase:"Updating workdir",loaded:++S,total:C})}catch(P){console.log(P)}}))}),r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const v=await Kt.expand({fs:e,gitdir:i,ref:o});v.startsWith("refs/heads")?await Kt.writeSymbolicRef({fs:e,gitdir:i,ref:"HEAD",value:v}):await Kt.writeRef({fs:e,gitdir:i,ref:"HEAD",value:b})}}async function QCe({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,ref:i,force:a,filepaths:o}){let l=0;return Ch({fs:e,cache:t,dir:r,gitdir:s,trees:[zl({ref:i}),I1(),Vy()],map:async function(c,[u,d,h]){if(c===".")return;if(o&&!o.some(y=>UY(c,y)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!h,!!u,!!d].map(Number).join("")){case"000":return;case"001":return a&&o&&o.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await d.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await d.oid()?a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]:await u.mode()!==await d.mode()?a?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await h.type()){case"tree":return["rmdir",c];case"blob":return await h.oid()!==await d.oid()?a?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await h.type()}`]}case"110":case"111":switch(`${await h.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await h.oid()===await u.oid()&&await h.mode()===await u.mode()&&!a)return;if(d){if(await d.oid()!==await h.oid()&&await d.oid()!==await u.oid())return a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]}else if(a)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()];return await u.mode()!==await h.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await h.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await h.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=OY(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function qY({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:s=$t.join(r,".git"),remote:i="origin",ref:a,filepaths:o,noCheckout:l=!1,noUpdateHead:c=a===void 0,dryRun:u=!1,force:d=!1,track:h=!0,cache:m={}}){try{ct("fs",e),ct("dir",r),ct("gitdir",s);const y=a||"HEAD";return await rD({fs:new Sn(e),cache:m,onProgress:t,onPostCheckout:n,dir:r,gitdir:s,remote:i,ref:y,filepaths:o,noCheckout:l,noUpdateHead:c,dryRun:u,force:d,track:h})}catch(y){throw y.caller="git.checkout",y}}const eke=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function qp(e){const t=eke.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function Hh({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const s=await Kt.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await Kt.resolve({fs:e,gitdir:t,ref:s})}catch{return}if(s.startsWith("refs/"))return n?s:qp(s)}function tke(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function VY({username:e="",password:t=""}){return`Basic ${on.from(`${e}:${t}`).toString("base64")}`}async function P1(e,t){const n=MY(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function GC(e){let t=0;const n=[];await P1(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function pz(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function Aj(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class hi{static flush(){return on.from("0000","utf8")}static delim(){return on.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=on.from(t));const n=t.length+4,r=Aj(4,n);return on.concat([on.from(r,"utf8"),t])}static streamReader(t){const n=new IY(t);return async function(){try{let s=await n.read(4);if(s==null)return!0;if(s=parseInt(s.toString("utf8"),16),s===0||s===1)return null;const i=await n.read(s-4);return i??!0}catch(s){return t.error=s,!0}}}}async function mz(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const s=n.slice(0,r),i=n.slice(r+1);t[s]=i}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function gz(e,{service:t}){const n=new Set,r=new Map,s=new Map,i=hi.streamReader(e);let a=await i();for(;a===null;)a=await i();if(a===!0)throw new _1;if(a.includes("version 2"))return mz(i);if(a.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new Bm(`# service=${t}\\n`,a.toString("utf8"));let o=await i();for(;o===null;)o=await i();if(o===!0)return{capabilities:n,refs:r,symrefs:s};if(o=o.toString("utf8"),o.includes("version 2"))return mz(i);const[l,c]=QM(o,"\0","\\x00");if(c.split(" ").map(u=>n.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,d]=QM(l," "," ");for(r.set(d,u);;){const h=await i();if(h===!0)break;if(h!==null){const[m,y]=QM(h.toString("utf8")," "," ");r.set(y,m)}}}for(const u of n)if(u.startsWith("symref=")){const d=u.match(/symref=([^:]+):(.*)/);d.length===3&&s.set(d[1],d[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:s}}function QM(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new Bm(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const yz=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,bz=(e,t)=>{(t.username||t.password)&&(e.Authorization=VY(t)),t.headers&&Object.assign(e,t.headers)},eI=async e=>{try{const t=on.from(await GC(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class KC{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:s,onAuthFailure:i,corsProxy:a,service:o,url:l,headers:c,protocolVersion:u}){let{url:d,auth:h}=pz(l);const m=a?yz(a,d):d;(h.username||h.password)&&(c.Authorization=VY(h)),u===2&&(c["Git-Protocol"]="version=2");let y,b,v=!1;do if(y=await t.request({onProgress:n,method:"GET",url:`${m}/info/refs?service=${o}`,headers:c}),b=!1,y.statusCode===401||y.statusCode===203){const x=v?i:r;if(x){if(h=await x(d,{...h,headers:{...c}}),h&&h.cancel)throw new Ky;h&&(bz(c,h),v=!0,b=!0)}}else y.statusCode===200&&v&&s&&await s(d,h);while(b);if(y.statusCode!==200){const{response:x}=await eI(y);throw new ry(y.statusCode,y.statusMessage,x)}if(y.headers["content-type"]===`application/x-${o}-advertisement`){const x=await gz(y.body,{service:o});return x.auth=h,x}else{const{preview:x,response:w,data:S}=await eI(y);try{const C=await gz([S],{service:o});return C.auth=h,C}catch{throw new T1(x,w)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:s,url:i,auth:a,body:o,headers:l}){const c=pz(i);c&&(i=c.url),r&&(i=yz(r,i)),l["content-type"]=`application/x-${s}-request`,l.accept=`application/x-${s}-result`,bz(l,a);const u=await t.request({onProgress:n,method:"POST",url:`${i}/${s}`,body:o,headers:l});if(u.statusCode!==200){const{response:d}=eI(u);throw new ry(u.statusCode,u.statusMessage,d)}return u}}function nke({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class XE{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",KC),n.set("https",KC);const r=nke({url:t});if(!r)throw new R1(t);if(n.has(r.transport))return n.get(r.transport);throw new A1(t,r.transport,r.transport==="ssh"?tke(t):void 0)}}let Np=null;class iw{static async read({fs:t,gitdir:n}){Np===null&&(Np=new rw);const r=$t.join(n,"shallow"),s=new Set;return await Np.acquire(r,async function(){const i=await t.read(r,{encoding:"utf8"});if(i===null||i.trim()==="")return s;i.trim().split(`
`).map(a=>s.add(a))}),s}static async write({fs:t,gitdir:n,oids:r}){Np===null&&(Np=new rw);const s=$t.join(n,"shallow");if(r.size>0){const i=[...r].join(`
`)+`
`;await Np.acquire(s,async function(){await t.write(s,i,{encoding:"utf8"})})}else await Np.acquire(s,async function(){await t.rm(s)})}}async function rke({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function ske({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){let i=await e.readdir($t.join(n,"objects/pack"));i=i.filter(a=>a.endsWith(".idx"));for(const a of i){const o=`${n}/objects/pack/${a}`,l=await nD({fs:e,cache:t,filename:o,getExternalRefDelta:s});if(l.error)throw new vr(l.error);if(l.offsets.has(r))return!0}return!1}async function vz({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=o=>Ks({fs:e,cache:t,gitdir:n,oid:o});let a=await rke({fs:e,gitdir:n,oid:r});return a||(a=await ske({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i})),a}function ike(e){const s="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===s}function WY(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const s=r.split("=",1)[0];return n.includes(s)})}const JE={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class E2{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function ake(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function HY(e){const t=new E2;let n="";return(async()=>(await P1(e,r=>{for(r=r.toString("utf8"),n+=r;;){const s=ake(n);if(s===-1)break;t.write(n.slice(0,s)),n=n.slice(s)}}),n.length>0&&t.write(n),t.end()))(),t}class GY{static demux(t){const n=hi.streamReader(t),r=new E2,s=new E2,i=new E2,a=async function(){const o=await n();if(o===null)return a();if(o===!0){r.end(),i.end(),t.error?s.destroy(t.error):s.end();return}switch(o[0]){case 1:{s.write(o.slice(1));break}case 2:{i.write(o.slice(1));break}case 3:{const l=o.slice(1);i.write(l),r.end(),i.end(),s.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}a()};return a(),{packetlines:r,packfile:s,progress:i}}}async function oke(e){const{packetlines:t,packfile:n,progress:r}=GY.demux(e),s=[],i=[],a=[];let o=!1,l=!1;return new Promise((c,u)=>{P1(t,d=>{const h=d.toString("utf8").trim();if(h.startsWith("shallow")){const m=h.slice(-41).trim();m.length!==40&&u(new _h(m)),s.push(m)}else if(h.startsWith("unshallow")){const m=h.slice(-41).trim();m.length!==40&&u(new _h(m)),i.push(m)}else if(h.startsWith("ACK")){const[,m,y]=h.split(" ");a.push({oid:m,status:y}),y||(l=!0)}else h.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))})})}function lke({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:s=null,since:i=null,exclude:a=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const c of t)o.push(hi.encode(`want ${c}${l}
`)),l="";for(const c of r)o.push(hi.encode(`shallow ${c}
`));s!==null&&o.push(hi.encode(`deepen ${s}
`)),i!==null&&o.push(hi.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const c of a)o.push(hi.encode(`deepen-not ${c}
`));o.push(hi.flush());for(const c of n)o.push(hi.encode(`have ${c}
`));return o.push(hi.encode(`done
`)),o}async function sD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:l,ref:c,remoteRef:u,remote:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:C={},prune:k=!1,pruneTags:A=!1}){const R=c||await Hh({fs:e,gitdir:l,test:!0}),N=await Mi.get({fs:e,gitdir:l}),I=d||R&&await N.get(`branch.${R}.remote`)||"origin",O=h||await N.get(`remote.${I}.url`);if(typeof O>"u")throw new Ao("remote OR url");const L=u||R&&await N.get(`branch.${R}.merge`)||c||"HEAD";m===void 0&&(m=await N.get("http.corsProxy"));const P=XE.getRemoteHelperFor({url:O}),V=await P.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:m,service:"git-upload-pack",url:O,headers:C,protocolVersion:1}),F=V.auth,X=V.refs;if(X.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(y!==null&&!V.capabilities.has("shallow"))throw new oh("shallow","depth");if(b!==null&&!V.capabilities.has("deepen-since"))throw new oh("deepen-since","since");if(v.length>0&&!V.capabilities.has("deepen-not"))throw new oh("deepen-not","exclude");if(x===!0&&!V.capabilities.has("deepen-relative"))throw new oh("deepen-relative","relative");const{oid:U,fullref:H}=Kt.resolveAgainstMap({ref:L,map:X});for(const Ve of X.keys())Ve===H||Ve==="HEAD"||Ve.startsWith("refs/heads/")||w&&Ve.startsWith("refs/tags/")||X.delete(Ve);const $=WY([...V.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${JE.agent}`]);x&&$.push("deepen-relative");const ne=S?[U]:X.values(),W=S?[R]:await Kt.listRefs({fs:e,gitdir:l,filepath:"refs"});let Q=[];for(let Ve of W)try{Ve=await Kt.expand({fs:e,gitdir:l,ref:Ve});const Ne=await Kt.resolve({fs:e,gitdir:l,ref:Ve});await vz({fs:e,cache:t,gitdir:l,oid:Ne})&&Q.push(Ne)}catch{}Q=[...new Set(Q)];const ee=await iw.read({fs:e,gitdir:l}),se=V.capabilities.has("shallow")?[...ee]:[],pe=lke({capabilities:$,wants:ne,haves:Q,shallows:se,depth:y,since:b,exclude:v}),ce=on.from(await GC(pe)),Ie=await P.connect({http:n,onProgress:r,corsProxy:m,service:"git-upload-pack",url:O,auth:F,body:[ce],headers:C}),De=await oke(Ie.body);Ie.headers&&(De.headers=Ie.headers);for(const Ve of De.shallows)if(!ee.has(Ve))try{const{object:Ne}=await Ks({fs:e,cache:t,gitdir:l,oid:Ve}),K=new Gs(Ne),me=await Promise.all(K.headers().parent.map(le=>vz({fs:e,cache:t,gitdir:l,oid:le})));me.length===0||me.every(le=>le)||ee.add(Ve)}catch{ee.add(Ve)}for(const Ve of De.unshallows)ee.delete(Ve);if(await iw.write({fs:e,gitdir:l,oids:ee}),S){const Ve=new Map([[H,U]]),Ne=new Map;let K=10,me=H;for(;K--;){const oe=V.symrefs.get(me);if(oe===void 0)break;Ne.set(me,oe),me=oe}const Ae=X.get(me);Ae&&Ve.set(me,Ae);const{pruned:le}=await Kt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:Ve,symrefs:Ne,tags:w,prune:k});k&&(De.pruned=le)}else{const{pruned:Ve}=await Kt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:X,symrefs:V.symrefs,tags:w,prune:k,pruneTags:A});k&&(De.pruned=Ve)}if(De.HEAD=V.symrefs.get("HEAD"),De.HEAD===void 0){const{oid:Ve}=Kt.resolveAgainstMap({ref:"HEAD",map:X});for(const[Ne,K]of X.entries())if(Ne!=="HEAD"&&K===Ve){De.HEAD=Ne;break}}const Se=H.startsWith("refs/tags")?"tag":"branch";if(De.FETCH_HEAD={oid:U,description:`${Se} '${qp(H)}' of ${O}`},r||s){const Ve=HY(De.progress);P1(Ve,async Ne=>{if(s&&await s(Ne),r){const K=Ne.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);K&&await r({phase:K[1].trim(),loaded:parseInt(K[2],10),total:parseInt(K[3],10)})}})}const Ce=on.from(await GC(De.packfile));if(Ie.body.error)throw Ie.body.error;const qe=Ce.slice(-20).toString("hex"),Qe={defaultBranch:De.HEAD,fetchHead:De.FETCH_HEAD.oid,fetchHeadDescription:De.FETCH_HEAD.description};if(De.headers&&(Qe.headers=De.headers),k&&(Qe.pruned=De.pruned),qe!==""&&!ike(Ce)){Qe.packfile=`objects/pack/pack-${qe}.pack`;const Ve=$t.join(l,Qe.packfile);await e.write(Ve,Ce);const Ne=me=>Ks({fs:e,cache:t,gitdir:l,oid:me}),K=await ny.fromPack({pack:Ce,getExternalRefDelta:Ne,onProgress:r});await e.write(Ve.replace(/\.pack$/,".idx"),await K.toBuffer())}return Qe}async function KY({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){if(await e.exists(r+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(a=>r+"/"+a);for(const a of i)await e.mkdir(a);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${s}
`)}async function cke({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPostCheckout:l,dir:c,gitdir:u,url:d,corsProxy:h,ref:m,remote:y,depth:b,since:v,exclude:x,relative:w,singleBranch:S,noCheckout:C,noTags:k,headers:A}){try{if(await KY({fs:e,gitdir:u}),await zY({fs:e,gitdir:u,remote:y,url:d,force:!1}),h){const I=await Mi.get({fs:e,gitdir:u});await I.set("http.corsProxy",h),await Mi.save({fs:e,gitdir:u,config:I})}const{defaultBranch:R,fetchHead:N}=await sD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:u,ref:m,remote:y,corsProxy:h,depth:b,since:v,exclude:x,relative:w,singleBranch:S,headers:A,tags:!k});if(N===null)return;m=m||R,m=m.replace("refs/heads/",""),await rD({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:c,gitdir:u,ref:m,remote:y,noCheckout:C})}catch(R){throw await e.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),R}}async function uke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c=$t.join(l,".git"),url:u,corsProxy:d=void 0,ref:h=void 0,remote:m="origin",depth:y=void 0,since:b=void 0,exclude:v=[],relative:x=!1,singleBranch:w=!1,noCheckout:S=!1,noTags:C=!1,headers:k={},cache:A={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",c),S||ct("dir",l),ct("url",u),await cke({fs:new Sn(e),cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c,url:u,corsProxy:d,ref:h,remote:m,depth:y,since:b,exclude:v,relative:x,singleBranch:w,noCheckout:S,noTags:C,headers:k})}catch(R){throw R.caller="git.clone",R}}async function dke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m,cache:y={}}){try{ct("fs",e),l||ct("message",s),o&&ct("onSign",t);const b=new Sn(e);return await ZE({fs:b,cache:y,onSign:t,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l,dryRun:c,noUpdateBranch:u,ref:d,parent:h,tree:m})}catch(b){throw b.caller="git.commit",b}}async function fke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),fullname:r=!1,test:s=!1}){try{return ct("fs",e),ct("gitdir",n),await Hh({fs:new Sn(e),gitdir:n,fullname:r,test:s})}catch(i){throw i.caller="git.currentBranch",i}}async function hke({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await Kt.exists({fs:e,gitdir:t,ref:n}))throw new Es(n);const s=await Kt.expand({fs:e,gitdir:t,ref:n}),i=await Hh({fs:e,gitdir:t,fullname:!0});if(s===i){const l=await Kt.resolve({fs:e,gitdir:t,ref:s});await Kt.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await Kt.deleteRef({fs:e,gitdir:t,ref:s});const a=qp(n),o=await Mi.get({fs:e,gitdir:t});await o.deleteSection("branch",a),await Mi.save({fs:e,gitdir:t,config:o})}async function pke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("ref",r),await hke({fs:new Sn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteBranch",s}}async function mke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{ct("fs",e),ct("ref",r),await Kt.deleteRef({fs:new Sn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteRef",s}}async function gke({fs:e,gitdir:t,remote:n}){const r=await Mi.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await Mi.save({fs:e,gitdir:t,config:r})}async function yke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ct("fs",e),ct("remote",r),await gke({fs:new Sn(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.deleteRemote",s}}async function bke({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await Kt.deleteRef({fs:e,gitdir:t,ref:n})}async function vke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("ref",r),await bke({fs:new Sn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteTag",s}}async function xke({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(i=>`${r}${i}`).filter(i=>i.startsWith(n))}async function wke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){const i=[];let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await nD({fs:e,cache:t,filename:l,getExternalRefDelta:s});if(c.error)throw new vr(c.error);for(const u of c.offsets.keys())u.startsWith(r)&&i.push(u)}return i}async function _ke({fs:e,cache:t,gitdir:n,oid:r}){const s=o=>Ks({fs:e,cache:t,gitdir:n,oid:o}),i=await xke({fs:e,gitdir:n,oid:r}),a=await wke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s});for(const o of a)i.indexOf(o)===-1&&i.push(o);if(i.length===1)return i[0];throw i.length>1?new v1("oids",r,i):new Es(`an object matching "${r}"`)}async function Ske({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await _ke({fs:new Sn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.expandOid",i}}async function Cke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Kt.expand({fs:new Sn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.expandRef",s}}async function iD({fs:e,cache:t,gitdir:n,oids:r}){const s={},i=r.length;let a=r.map((o,l)=>({index:l,oid:o}));for(;a.length;){const o=new Set;for(const{oid:c,index:u}of a)s[c]||(s[c]=new Set),s[c].add(u),s[c].size===i&&o.add(c);if(o.size>0)return[...o];const l=new Map;for(const{oid:c,index:u}of a)try{const{object:d}=await Ks({fs:e,cache:t,gitdir:n,oid:c}),h=Gs.from(d),{parent:m}=h.parseHeaders();for(const y of m)(!s[y]||!s[y].has(u))&&l.set(y+":"+u,{oid:y,index:u})}catch{}a=Array.from(l.values())}return[]}const tI=/^.*(\r?\n|$)/gm;function kke({branches:e,contents:t}){const n=e[1],r=e[2],s=t[0],i=t[1],a=t[2],o=i.match(tI),l=s.match(tI),c=a.match(tI),u=V2e(o,l,c),d=7;let h="",m=!0;for(const y of u)y.ok&&(h+=y.ok.join("")),y.conflict&&(m=!1,h+=`${"<".repeat(d)} ${n}
`,h+=y.conflict.a.join(""),h+=`${"=".repeat(d)}
`,h+=y.conflict.b.join(""),h+=`${">".repeat(d)} ${r}
`);return{cleanMerge:m,mergedText:h}}async function Eke({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),index:s,ourOid:i,baseOid:a,theirOid:o,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:d=!1,abortOnConflict:h=!0,mergeDriver:m}){const y=zl({ref:i}),b=zl({ref:a}),v=zl({ref:o}),x=[],w=[],S=[],C=[],k=await Ch({fs:e,cache:t,dir:n,gitdir:r,trees:[y,b,v],map:async function(A,[R,N,I]){const O=UC(A),L=await HC(R,N),P=await HC(I,N);switch(`${L}-${P}`){case"false-false":return{mode:await N.mode(),path:O,oid:await N.oid(),type:await N.type()};case"false-true":return I?{mode:await I.mode(),path:O,oid:await I.oid(),type:await I.type()}:void 0;case"true-false":return R?{mode:await R.mode(),path:O,oid:await R.oid(),type:await R.type()}:void 0;case"true-true":{if(R&&N&&I&&await R.type()==="blob"&&await N.type()==="blob"&&await I.type()==="blob")return Tke({fs:e,gitdir:r,path:O,ours:R,base:N,theirs:I,ourName:l,baseName:c,theirName:u,mergeDriver:m}).then(async V=>{if(V.cleanMerge)h||s.insert({filepath:A,oid:V.mergeResult.oid,stage:0});else if(x.push(A),w.push(A),!h){const F=await N.oid(),X=await R.oid(),U=await I.oid();s.delete({filepath:A}),s.insert({filepath:A,oid:F,stage:1}),s.insert({filepath:A,oid:X,stage:2}),s.insert({filepath:A,oid:U,stage:3})}return V.mergeResult});if(N&&!R&&I&&await N.type()==="blob"&&await I.type()==="blob"){if(x.push(A),S.push(A),!h){const V=await N.oid(),F=await I.oid();s.delete({filepath:A}),s.insert({filepath:A,oid:V,stage:1}),s.insert({filepath:A,oid:F,stage:3})}return{mode:await I.mode(),oid:await I.oid(),type:"blob",path:O}}if(N&&R&&!I&&await N.type()==="blob"&&await R.type()==="blob"){if(x.push(A),C.push(A),!h){const V=await N.oid(),F=await R.oid();s.delete({filepath:A}),s.insert({filepath:A,oid:V,stage:1}),s.insert({filepath:A,oid:F,stage:2})}return{mode:await R.mode(),oid:await R.oid(),type:"blob",path:O}}if(N&&!R&&!I&&await N.type()==="blob")return;throw new Hy}}},reduce:x.length!==0&&(!n||h)?void 0:async(A,R)=>{const N=R.filter(Boolean);if(A&&!(A&&A.type==="tree"&&N.length===0)){if(N.length>0){const O=new Io(N).toObject(),L=await Bo({fs:e,gitdir:r,type:"tree",object:O,dryRun:d});A.oid=L}return A}}});return x.length!==0?(n&&!h&&await Ch({fs:e,cache:t,dir:n,gitdir:r,trees:[zl({ref:k.oid})],map:async function(A,[R]){const N=`${n}/${A}`;if(await R.type()==="blob"){const I=await R.mode(),O=new TextDecoder().decode(await R.content());await e.write(N,O,{mode:I})}return!0}}),new Gy(x,w,S,C)):k.oid}async function Tke({fs:e,gitdir:t,path:n,ours:r,base:s,theirs:i,ourName:a,theirName:o,baseName:l,dryRun:c,mergeDriver:u=kke}){const d="blob",h=await s.mode()===await r.mode()?await i.mode():await r.mode();if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};if(await r.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await i.oid(),type:d}};if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};const m=on.from(await r.content()).toString("utf8"),y=on.from(await s.content()).toString("utf8"),b=on.from(await i.content()).toString("utf8"),{mergedText:v,cleanMerge:x}=await u({branches:[l,a,o],contents:[y,m,b],path:n}),w=await Bo({fs:e,gitdir:t,type:"blob",object:on.from(v,"utf8"),dryRun:c});return{cleanMerge:x,mergeResult:{mode:h,path:n,oid:w,type:d}}}async function YY({fs:e,cache:t,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,onSign:b,mergeDriver:v}){s===void 0&&(s=await Hh({fs:e,gitdir:r,fullname:!0})),s=await Kt.expand({fs:e,gitdir:r,ref:s}),i=await Kt.expand({fs:e,gitdir:r,ref:i});const x=await Kt.resolve({fs:e,gitdir:r,ref:s}),w=await Kt.resolve({fs:e,gitdir:r,ref:i}),S=await iD({fs:e,cache:t,gitdir:r,oids:[x,w]});if(S.length!==1)throw new Hy;const C=S[0];if(C===w)return{oid:x,alreadyMerged:!0};if(a&&C===x)return!l&&!c&&await Kt.writeRef({fs:e,gitdir:r,ref:s,value:w}),{oid:w,fastForward:!0};{if(o)throw new S1;const k=await aa.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async R=>Eke({fs:e,cache:t,dir:n,gitdir:r,index:R,ourOid:x,theirOid:w,baseOid:C,ourName:qp(s),baseName:"base",theirName:qp(i),dryRun:l,abortOnConflict:u,mergeDriver:v}));if(k instanceof Gy)throw k;return d||(d=`Merge branch '${qp(i)}' into ${qp(s)}`),{oid:await ZE({fs:e,cache:t,gitdir:r,message:d,ref:s,tree:k,parent:[x,w],author:h,committer:m,signingKey:y,onSign:b,dryRun:l,noUpdateBranch:c}),tree:k,mergeCommit:!0}}}async function ZY({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,dir:l,gitdir:c,ref:u,url:d,remote:h,remoteRef:m,prune:y,pruneTags:b,fastForward:v,fastForwardOnly:x,corsProxy:w,singleBranch:S,headers:C,author:k,committer:A,signingKey:R}){try{if(!u){const O=await Hh({fs:e,gitdir:c});if(!O)throw new Ao("ref");u=O}const{fetchHead:N,fetchHeadDescription:I}=await sD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:c,corsProxy:w,ref:u,url:d,remote:h,remoteRef:m,singleBranch:S,headers:C,prune:y,pruneTags:b});await YY({fs:e,cache:t,gitdir:c,ours:u,theirs:N,fastForward:v,fastForwardOnly:x,message:`Merge ${I}`,author:k,committer:A,signingKey:R,dryRun:!1,noUpdateBranch:!1}),await rD({fs:e,cache:t,onProgress:r,dir:l,gitdir:c,ref:u,remote:h,noCheckout:!1})}catch(N){throw N.caller="git.pull",N}}async function Ake({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,corsProxy:m,singleBranch:y,headers:b={},cache:v={}}){try{ct("fs",e),ct("http",t),ct("gitdir",l);const x={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await ZY({fs:new Sn(e),cache:v,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForwardOnly:!0,corsProxy:m,singleBranch:y,headers:b,author:x,committer:x})}catch(x){throw x.caller="git.fastForward",x}}async function Rke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:C={},prune:k=!1,pruneTags:A=!1,cache:R={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",l),await sD({fs:new Sn(e),cache:R,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,gitdir:l,ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y,since:b,exclude:v,relative:x,tags:w,singleBranch:S,headers:C,prune:k,pruneTags:A})}catch(N){throw N.caller="git.fetch",N}}async function Nke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oids",r),await iD({fs:new Sn(e),cache:s,gitdir:n,oids:r})}catch(i){throw i.caller="git.findMergeBase",i}}async function XY({fs:e,filepath:t}){if(await e.exists($t.join(t,".git")))return t;{const n=ty(t);if(n===t)throw new Es(`git root for ${t}`);return XY({fs:e,filepath:n})}}async function Mke({fs:e,filepath:t}){try{return ct("fs",e),ct("filepath",t),await XY({fs:new Sn(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function Ike({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ct("fs",e),ct("gitdir",n),ct("path",r),await sw({fs:new Sn(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfig",s}}async function jke({fs:e,gitdir:t,path:n}){return(await Mi.get({fs:e,gitdir:t})).getall(n)}async function Oke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ct("fs",e),ct("gitdir",n),ct("path",r),await jke({fs:new Sn(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfigAll",s}}async function Pke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1}){try{ct("http",e),ct("url",i);const c=await XE.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[d,h]of c.refs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}for(const[d,h]of c.symrefs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function JY(e,t,n,r){const s=[];for(const[i,a]of e.refs){if(t&&!i.startsWith(t))continue;if(i.endsWith("^{}")){if(r){const l=i.replace("^{}",""),c=s[s.length-1],u=c.ref===l?c:s.find(d=>d.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=a}continue}const o={ref:i,oid:a};n&&e.symrefs.has(i)&&(o.target=e.symrefs.get(i)),s.push(o)}return s}async function Dke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2}){try{ct("http",e),ct("url",i);const u=await XE.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const d={};for(const h of u.capabilities){const[m,y]=h.split("=");y?d[m]=y:d[m]=!0}return{protocolVersion:1,capabilities:d,refs:JY(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function Fke({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=Wy.wrap({type:e,object:t})),r=await zd(t)),{oid:r,object:t}}async function Lke({object:e}){try{ct("object",e),typeof e=="string"?e=on.from(e,"utf8"):e=on.from(e);const t="blob",{oid:n,object:r}=await Fke({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function Bke({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,filepath:i}){try{i=$t.join(r,i);const a=await e.read(i),o=c=>Ks({fs:e,cache:t,gitdir:s,oid:c}),l=await ny.fromPack({pack:a,getExternalRefDelta:o,onProgress:n});return await e.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(a){throw a.caller="git.indexPack",a}}async function $ke({fs:e,onProgress:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s,cache:i={}}){try{return ct("fs",e),ct("dir",n),ct("gitdir",n),ct("filepath",s),await Bke({fs:new Sn(e),cache:i,onProgress:t,dir:n,gitdir:r,filepath:s})}catch(a){throw a.caller="git.indexPack",a}}async function zke({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){try{return ct("fs",e),ct("gitdir",r),t||ct("dir",n),await KY({fs:new Sn(e),bare:t,dir:n,gitdir:r,defaultBranch:s})}catch(i){throw i.caller="git.init",i}}async function QY({fs:e,cache:t,gitdir:n,oid:r,ancestor:s,depth:i}){const a=await iw.read({fs:e,gitdir:n});if(!r)throw new Ao("oid");if(!s)throw new Ao("ancestor");if(r===s)return!1;const o=[r],l=new Set;let c=0;for(;o.length;){if(c++===i)throw new k1(i);const u=o.shift(),{type:d,object:h}=await Ks({fs:e,cache:t,gitdir:n,oid:u});if(d!=="commit")throw new co(u,d,"commit");const m=Gs.from(h).parse();for(const y of m.parent)if(y===s)return!0;if(!a.has(u))for(const y of m.parent)l.has(y)||(o.push(y),l.add(y))}return!1}async function Uke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,ancestor:s,depth:i=-1,cache:a={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),ct("ancestor",s),await QY({fs:new Sn(e),cache:a,gitdir:n,oid:r,ancestor:s,depth:i})}catch(o){throw o.caller="git.isDescendent",o}}async function qke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ct("fs",e),ct("dir",t),ct("gitdir",n),ct("filepath",r),Yy.isIgnored({fs:new Sn(e),dir:t,gitdir:n,filepath:r})}catch(s){throw s.caller="git.isIgnored",s}}async function Vke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ct("fs",e),ct("gitdir",n),Kt.listBranches({fs:new Sn(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.listBranches",s}}async function Wke({fs:e,gitdir:t,ref:n,cache:r}){if(n){const s=await Kt.resolve({gitdir:t,fs:e,ref:n}),i=[];return await eZ({fs:e,cache:r,gitdir:t,oid:s,filenames:i,prefix:""}),i}else return aa.acquire({fs:e,gitdir:t,cache:r},async function(s){return s.entries.map(i=>i.path)})}async function eZ({fs:e,cache:t,gitdir:n,oid:r,filenames:s,prefix:i}){const{tree:a}=await Zy({fs:e,cache:t,gitdir:n,oid:r});for(const o of a)o.type==="tree"?await eZ({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:s,prefix:$t.join(i,o.path)}):s.push($t.join(i,o.path))}async function Hke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),await Wke({fs:new Sn(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listFiles",i}}async function Gke({fs:e,cache:t,gitdir:n,ref:r}){let s;try{s=await Kt.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof Es)return[]}return(await Zy({fs:e,cache:t,gitdir:n,oid:s})).tree.map(o=>({target:o.path,note:o.oid}))}async function Kke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Gke({fs:new Sn(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listNotes",i}}async function Yke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ct("fs",e),ct("gitdir",n),Kt.listRefs({fs:new Sn(e),gitdir:n,filepath:r})}catch(s){throw s.caller="git.listRefs",s}}async function Zke({fs:e,gitdir:t}){const n=await Mi.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async i=>{const a=await n.get(`remote.${i}.url`);return{remote:i,url:a}}))}async function Xke({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ct("fs",e),ct("gitdir",n),await Zke({fs:new Sn(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function Jke(e){const t=hi.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[s,i,...a]=r.split(" "),o={ref:i,oid:s};for(const l of a){const[c,u]=l.split(":");c==="symref-target"?o.target=u:c==="peeled"&&(o.peeled=u)}n.push(o)}return n}async function Qke({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(hi.encode(`command=ls-refs
`)),r.push(hi.encode(`agent=${JE.agent}
`)),(n||t||e)&&r.push(hi.delim()),n&&r.push(hi.encode("peel")),t&&r.push(hi.encode("symrefs")),e&&r.push(hi.encode(`ref-prefix ${e}`)),r.push(hi.flush()),r}async function eEe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:d}){try{ct("http",e),ct("url",i);const h=await KC.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(h.protocolVersion===1)return JY(h,c,u,d);const m=await Qke({prefix:c,symrefs:u,peelTags:d}),y=await KC.connect({http:e,auth:h.auth,headers:a,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,body:m});return Jke(y.body)}catch(h){throw h.caller="git.listServerRefs",h}}async function tEe({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ct("fs",e),ct("gitdir",n),Kt.listTags({fs:new Sn(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function nEe(e,t){return e.committer.timestamp-t.committer.timestamp}const rEe="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function xz({fs:e,cache:t,gitdir:n,oid:r,fileId:s}){if(s===rEe)return;const i=r;let a;const o=await iy({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return s===o.oid?a=o.path:(a=await tZ({fs:e,cache:t,gitdir:n,tree:l,fileId:s,oid:i}),Array.isArray(a)&&(a.length===0?a=void 0:a.length===1&&(a=a[0]))),a}async function tZ({fs:e,cache:t,gitdir:n,tree:r,fileId:s,oid:i,filepaths:a=[],parentPath:o=""}){const l=r.entries().map(function(c){let u;return c.oid===s?(u=$t.join(o,c.path),a.push(u)):c.type==="tree"&&(u=Ks({fs:e,cache:t,gitdir:n,oid:c.oid}).then(function({object:d}){return tZ({fs:e,cache:t,gitdir:n,tree:Io.from(d),fileId:s,oid:i,filepaths:a,parentPath:$t.join(o,c.path)})})),u});return await Promise.all(l),a}async function sEe({fs:e,cache:t,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l}){const c=typeof a>"u"?void 0:Math.floor(a.valueOf()/1e3),u=[],d=await iw.read({fs:e,gitdir:n}),h=await Kt.resolve({fs:e,gitdir:n,ref:s}),m=[await oy({fs:e,cache:t,gitdir:n,oid:h})];let y,b,v;function x(w){v&&r&&u.push(w)}for(;m.length>0;){const w=m.pop();if(c!==void 0&&w.commit.committer.timestamp<=c)break;if(r){let S;try{S=await j1({fs:e,cache:t,gitdir:n,oid:w.commit.tree,filepath:r}),b&&y!==S&&u.push(b),y=S,b=w,v=!0}catch(C){if(C instanceof Es){let k=l&&y;if(k&&(k=await xz({fs:e,cache:t,gitdir:n,oid:w.commit.tree,fileId:y}),k))if(Array.isArray(k)){if(b){const A=await xz({fs:e,cache:t,gitdir:n,oid:b.commit.tree,fileId:y});if(Array.isArray(A))if(k=k.filter(R=>A.indexOf(R)===-1),k.length===1)k=k[0],r=k,b&&u.push(b);else{k=!1,b&&u.push(b);break}}}else r=k,b&&u.push(b);if(!k){if(v&&y&&(u.push(b),!o))break;if(!o&&!l)throw C}b=w,v=!1}else throw C}}else u.push(w);if(i!==void 0&&u.length===i){x(w);break}if(!d.has(w.oid))for(const S of w.commit.parent){const C=await oy({fs:e,cache:t,gitdir:n,oid:S});m.map(k=>k.oid).includes(C.oid)||m.push(C)}m.length===0&&x(w),m.sort((S,C)=>nEe(S.commit,C.commit))}return u}async function iEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s="HEAD",depth:i,since:a,force:o,follow:l,cache:c={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",s),await sEe({fs:new Sn(e),cache:c,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l})}catch(u){throw u.caller="git.log",u}}async function aEe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,cache:b={},mergeDriver:v}){try{ct("fs",e),y&&ct("onSign",t);const x=new Sn(e),w=await kh({fs:x,gitdir:r,author:h});if(!w&&(!o||!a))throw new Ba("author");const S=await ay({fs:x,gitdir:r,author:w,committer:m});if(!S&&(!o||!a))throw new Ba("committer");return await YY({fs:x,cache:b,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a,fastForwardOnly:o,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:d,author:w,committer:S,signingKey:y,onSign:t,mergeDriver:v})}catch(x){throw x.caller="git.merge",x}}const oEe={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function nZ({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new vY,a=[];function o(u,d){const h=on.from(u,d);a.push(h),i.update(h)}async function l({stype:u,object:d}){const h=oEe[u];let m=d.length,y=m>15?128:0;const b=m&15;m=m>>>4;let v=(y|h|b).toString(16);for(o(v,"hex");y;)y=m>127?128:0,v=y|m&127,o(Aj(2,v),"hex"),m=m>>>7;o(on.from(await PY(d)))}o("PACK"),o("00000002","hex"),o(Aj(8,s.length),"hex");for(const u of s){const{type:d,object:h}=await Ks({fs:e,cache:t,gitdir:r,oid:u});await l({object:h,stype:d})}const c=i.digest();return a.push(c),a}async function lEe({fs:e,cache:t,gitdir:n,oids:r,write:s}){const i=await nZ({fs:e,cache:t,gitdir:n,oids:r}),a=on.from(await GC(i)),l=`pack-${a.slice(-20).toString("hex")}.pack`;return s?(await e.write($t.join(n,`objects/pack/${l}`),a),{filename:l}):{filename:l,packfile:new Uint8Array(a)}}async function cEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,write:s=!1,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oids",r),await lEe({fs:new Sn(e),cache:i,gitdir:n,oids:r,write:s})}catch(a){throw a.caller="git.packObjects",a}}async function uEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,prune:m=!1,pruneTags:y=!1,fastForward:b=!0,fastForwardOnly:v=!1,corsProxy:x,singleBranch:w,headers:S={},author:C,committer:k,signingKey:A,cache:R={}}){try{ct("fs",e),ct("gitdir",l);const N=new Sn(e),I=await kh({fs:N,gitdir:l,author:C});if(!I)throw new Ba("author");const O=await ay({fs:N,gitdir:l,author:I,committer:k});if(!O)throw new Ba("committer");return await ZY({fs:N,cache:R,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForward:b,fastForwardOnly:v,corsProxy:x,singleBranch:w,headers:S,author:I,committer:O,signingKey:A,prune:m,pruneTags:y})}catch(N){throw N.caller="git.pull",N}}async function dEe({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),start:s,finish:i}){const a=await iw.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const d of s)o.add(await Kt.resolve({fs:e,gitdir:r,ref:d}));for(const d of i)try{const h=await Kt.resolve({fs:e,gitdir:r,ref:d});l.add(h)}catch{}const c=new Set;async function u(d){c.add(d);const{type:h,object:m}=await Ks({fs:e,cache:t,gitdir:r,oid:d});if(h==="tag"){const b=to.from(m).headers().object;return u(b)}if(h!=="commit")throw new co(d,h,"commit");if(!a.has(d)){const b=Gs.from(m).headers().parent;for(d of b)!l.has(d)&&!c.has(d)&&await u(d)}}for(const d of o)await u(d);return c}async function nI({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new Set;async function a(o){if(i.has(o))return;i.add(o);const{type:l,object:c}=await Ks({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const d=to.from(c).headers().object;await a(d)}else if(l==="commit"){const d=Gs.from(c).headers().tree;await a(d)}else if(l==="tree"){const u=Io.from(c);for(const d of u)d.type==="blob"&&i.add(d.oid),d.type==="tree"&&await a(d.oid)}}for(const o of s)await a(o);return i}async function fEe(e){const t={};let n="";const r=hi.streamReader(e);let s=await r();for(;s!==!0;)s!==null&&(n+=s.toString("utf8")+`
`),s=await r();const i=n.toString("utf8").split(`
`);if(s=i.shift(),!s.startsWith("unpack "))throw new Bm('unpack ok" or "unpack [error message]',s);t.ok=s==="unpack ok",t.ok||(t.error=s.slice(7)),t.refs={};for(const a of i){if(a.trim()==="")continue;const o=a.slice(0,2),l=a.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),d=l.slice(c+1);t.refs[u]={ok:o==="ok",error:d}}return t}async function hEe({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const s of t)n.push(hi.encode(`${s.oldoid} ${s.oid} ${s.fullRef}${r}
`)),r="";return n.push(hi.flush()),n}async function pEe({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPrePush:l,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={}}){const w=u||await Hh({fs:e,gitdir:c});if(typeof w>"u")throw new Ao("ref");const S=await Mi.get({fs:e,gitdir:c});h=h||await S.get(`branch.${w}.pushRemote`)||await S.get("remote.pushDefault")||await S.get(`branch.${w}.remote`)||"origin";const C=m||await S.get(`remote.${h}.pushurl`)||await S.get(`remote.${h}.url`);if(typeof C>"u")throw new Ao("remote OR url");const k=d||await S.get(`branch.${w}.merge`);if(typeof C>"u")throw new Ao("remoteRef");v===void 0&&(v=await S.get("http.corsProxy"));const A=await Kt.expand({fs:e,gitdir:c,ref:w}),R=b?"0000000000000000000000000000000000000000":await Kt.resolve({fs:e,gitdir:c,ref:A}),N=XE.getRemoteHelperFor({url:C}),I=await N.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:v,service:"git-receive-pack",url:C,headers:x,protocolVersion:1}),O=I.auth;let L;if(!k)L=A;else try{L=await Kt.expandAgainstMap({ref:k,map:I.refs})}catch(ee){if(ee instanceof Es)L=k.startsWith("refs/")?k:`refs/heads/${k}`;else throw ee}const P=I.refs.get(L)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:h,url:C,localRef:{ref:b?"(delete)":A,oid:R},remoteRef:{ref:L,oid:P}}))throw new Ky;const V=!I.capabilities.has("no-thin");let F=new Set;if(!b){const ee=[...I.refs.values()];let se=new Set;if(P!=="0000000000000000000000000000000000000000"){const pe=await iD({fs:e,cache:t,gitdir:c,oids:[R,P]});for(const ce of pe)ee.push(ce);V&&(se=await nI({fs:e,cache:t,gitdir:c,oids:pe}))}if(!ee.includes(R)){const pe=await dEe({fs:e,cache:t,gitdir:c,start:[R],finish:ee});F=await nI({fs:e,cache:t,gitdir:c,oids:pe})}if(V){try{const pe=await Kt.resolve({fs:e,gitdir:c,ref:`refs/remotes/${h}/HEAD`,depth:2}),{oid:ce}=await Kt.resolveAgainstMap({ref:pe.replace(`refs/remotes/${h}/`,""),fullref:pe,map:I.refs}),Ie=[ce];for(const De of await nI({fs:e,cache:t,gitdir:c,oids:Ie}))se.add(De)}catch{}for(const pe of se)F.delete(pe)}if(R===P&&(y=!0),!y){if(A.startsWith("refs/tags")&&P!=="0000000000000000000000000000000000000000")throw new sy("tag-exists");if(R!=="0000000000000000000000000000000000000000"&&P!=="0000000000000000000000000000000000000000"&&!await QY({fs:e,cache:t,gitdir:c,oid:R,ancestor:P,depth:-1}))throw new sy("not-fast-forward")}}const X=WY([...I.capabilities],["report-status","side-band-64k",`agent=${JE.agent}`]),U=await hEe({capabilities:X,triplets:[{oldoid:P,oid:R,fullRef:L}]}),H=b?[]:await nZ({fs:e,cache:t,gitdir:c,oids:[...F]}),$=await N.connect({http:n,onProgress:r,corsProxy:v,service:"git-receive-pack",url:C,auth:O,headers:x,body:[...U,...H]}),{packfile:ne,progress:W}=await GY.demux($.body);if(s){const ee=HY(W);P1(ee,async se=>{await s(se)})}const Q=await fEe(ne);if($.headers&&(Q.headers=$.headers),h&&Q.ok&&Q.refs[L].ok&&!A.startsWith("refs/tags")){const ee=`refs/remotes/${h}/${L.replace("refs/heads","")}`;b?await Kt.deleteRef({fs:e,gitdir:c,ref:ee}):await Kt.writeRef({fs:e,gitdir:c,ref:ee,value:R})}if(Q.ok&&Object.values(Q.refs).every(ee=>ee.ok))return Q;{const ee=Object.entries(Q.refs).filter(([se,pe])=>!pe.ok).map(([se,pe])=>`
  - ${se}: ${pe.error}`).join("");throw new C1(ee,Q)}}async function mEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,dir:l,gitdir:c=$t.join(l,".git"),ref:u,remoteRef:d,remote:h="origin",url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={},cache:w={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",c),await pEe({fs:new Sn(e),cache:w,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y,delete:b,corsProxy:v,headers:x})}catch(S){throw S.caller="git.push",S}}async function rZ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Ks({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=to.from(i).parse().object,rZ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="blob")throw new co(r,s,"blob");return{oid:r,blob:new Uint8Array(i)}}async function sZ({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){return s!==void 0&&(r=await j1({fs:e,cache:t,gitdir:n,oid:r,filepath:s})),await rZ({fs:e,cache:t,gitdir:n,oid:r})}async function gEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await sZ({fs:new Sn(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readBlob",a}}async function iZ({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await oy({fs:new Sn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readCommit",i}}async function yEe({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:s}){const i=await Kt.resolve({gitdir:n,fs:e,ref:r}),{blob:a}=await sZ({fs:e,cache:t,gitdir:n,oid:i,filepath:s});return a}async function bEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",oid:s,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),ct("oid",s),await yEe({fs:new Sn(e),cache:i,gitdir:n,ref:r,oid:s})}catch(a){throw a.caller="git.readNote",a}}async function vEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,format:s="parsed",filepath:i=void 0,encoding:a=void 0,cache:o={}}){try{ct("fs",e),ct("gitdir",n),ct("oid",r);const l=new Sn(e);i!==void 0&&(r=await j1({fs:l,cache:o,gitdir:n,oid:r,filepath:i}));const u=await Ks({fs:l,cache:o,gitdir:n,oid:r,format:s==="parsed"?"content":s});if(u.oid=r,s==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=Gs.from(u.object).parse();break;case"tree":u.object=Io.from(u.object).entries();break;case"blob":a?u.object=u.object.toString(a):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=to.from(u.object).parse();break;default:throw new co(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function xEe({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Ks({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(s!=="tag")throw new co(r,s,"tag");const a=to.from(i);return{oid:r,tag:a.parse(),payload:a.payload()}}async function wEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await xEe({fs:new Sn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readTag",i}}async function _Ee({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s=void 0,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await Zy({fs:new Sn(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readTree",a}}async function SEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r),await aa.acquire({fs:new Sn(e),gitdir:n,cache:s},async function(i){i.delete({filepath:r})})}catch(i){throw i.caller="git.remove",i}}async function CEe({fs:e,cache:t,onSign:n,gitdir:r,ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l}){let c;try{c=await Kt.resolve({gitdir:r,fs:e,ref:s})}catch(y){if(!(y instanceof Es))throw y}let d=(await Zy({fs:e,gitdir:r,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;d=d.filter(y=>y.path!==i);const h=await O1({fs:e,gitdir:r,tree:d});return await ZE({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:h,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:a,committer:o,signingKey:l})}async function kEe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l,cache:c={}}){try{ct("fs",e),ct("gitdir",r),ct("oid",i);const u=new Sn(e),d=await kh({fs:u,gitdir:r,author:a});if(!d)throw new Ba("author");const h=await ay({fs:u,gitdir:r,author:d,committer:o});if(!h)throw new Ba("committer");return await CEe({fs:u,cache:c,onSign:t,gitdir:r,ref:s,oid:i,author:d,committer:h,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function EEe({fs:e,gitdir:t,oldref:n,ref:r,checkout:s=!1}){if(r!==uu.clean(r))throw new Ac(r,uu.clean(r));if(n!==uu.clean(n))throw new Ac(n,uu.clean(n));const i=`refs/heads/${n}`,a=`refs/heads/${r}`;if(await Kt.exists({fs:e,gitdir:t,ref:a}))throw new Ic("branch",r,!1);const l=await Kt.resolve({fs:e,gitdir:t,ref:i,depth:1});await Kt.writeRef({fs:e,gitdir:t,ref:a,value:l}),await Kt.deleteRef({fs:e,gitdir:t,ref:i});const u=await Hh({fs:e,gitdir:t,fullname:!0})===i;(s||u)&&await Kt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function TEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,oldref:s,checkout:i=!1}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),ct("oldref",s),await EEe({fs:new Sn(e),gitdir:n,ref:r,oldref:s,checkout:i})}catch(a){throw a.caller="git.renameBranch",a}}async function aZ({gitdir:e,type:t,object:n}){return zd(Wy.wrap({type:t,object:n}))}async function AEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s,cache:i={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r);const a=new Sn(e);let o,l;try{o=await Kt.resolve({fs:a,gitdir:n,ref:s||"HEAD"})}catch(d){if(s)throw d}if(o)try{o=await j1({fs:a,cache:i,gitdir:n,oid:o,filepath:r})}catch{o=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=t&&await a.read($t.join(t,r));u&&(l=await aZ({gitdir:n,type:"blob",object:u}),o===l&&(c=await a.lstat($t.join(t,r)))),await aa.acquire({fs:a,gitdir:n,cache:i},async function(d){d.delete({filepath:r}),o&&d.insert({filepath:r,stats:c,oid:o})})}catch(a){throw a.caller="git.reset",a}}async function REe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,depth:s}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Kt.resolve({fs:new Sn(e),gitdir:n,ref:r,depth:s})}catch(i){throw i.caller="git.resolveRef",i}}async function NEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r,value:s,append:i=!1}){try{ct("fs",e),ct("gitdir",n),ct("path",r);const a=new Sn(e),o=await Mi.get({fs:a,gitdir:n});i?await o.append(r,s):await o.set(r,s),await Mi.save({fs:a,gitdir:n,config:o})}catch(a){throw a.caller="git.setConfig",a}}async function oZ({fs:e,gitdir:t,commit:n}){const r=Gs.from(n).toObject();return await Bo({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class YC{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const s=t.name.replace(/\s/g,""),i="0000000000000000000000000000000000000000",a=Math.floor(Date.now()/1e3),o=YC.timezoneOffsetForRefLogEntry;return`${i} ${n} ${s} ${t.email} ${a} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(i=>i).reverse().map((i,a)=>n?`stash@{${a}}: ${i.split("	")[1]}`:i)}}const MEe={stage:Vy,workdir:I1};let rI;async function ly(e,t){return rI===void 0&&(rI=new rw),rI.acquire(e,t)}async function IEe(e,t,n,r,s=null){const i=$t.join(n,r),a=await e.lstat(i);if(!a)throw new Es(i);if(a.isDirectory())throw new vr(`${i}: file expected, but found directory`);const o=s?await NY({fs:e,gitdir:t,oid:s}):void 0;let l=o?s:void 0;return o||await ly({fs:e,gitdir:t,currentFilepath:i},async()=>{const c=a.isSymbolicLink()?await e.readlink(i).then(DY):await e.read(i);if(c===null)throw new Es(i);l=await Bo({fs:e,gitdir:t,type:"blob",object:c})}),l}async function jEe({fs:e,dir:t,gitdir:n,entries:r}){async function s(i){if(i.type==="tree"){if(!i.oid){const a=await Promise.all(i.children.map(s));i.oid=await O1({fs:e,gitdir:n,tree:a}),i.mode=16384}}else i.type==="blob"&&(i.oid=await IEe(e,n,t,i.path,i.oid),i.mode=33188);return i.path=i.path.split("/").pop(),i}return Promise.all(r.map(s))}async function wz({fs:e,dir:t,gitdir:n,treePair:r}){const s=r[1]==="stage",i=r.map(m=>typeof m=="string"?MEe[m]():m),a=[],u=await Ch({fs:e,cache:{},dir:t,gitdir:n,trees:i,map:async(m,[y,b])=>{if(!(m==="."||await Yy.isIgnored({fs:e,dir:t,gitdir:n,filepath:m}))&&b)return(!y||await y.oid()!==await b.oid()&&await b.oid()!==void 0)&&a.push([y,b]),{mode:await b.mode(),path:m,oid:await b.oid(),type:await b.type()}},reduce:async(m,y)=>(y=y.filter(Boolean),m?(m.children=y,m):y.length>0?y:void 0),iterate:async(m,y)=>{const b=[];for(const v of y){const[x,w]=v;s?w&&(await e.exists(`${t}/${w.toString()}`)?b.push(v):a.push([null,w])):x&&(w?b.push(v):a.push([x,null]))}return b.length?Promise.all(b.map(m)):[]}});if(a.length===0||u.length===0)return null;const h=(await jEe({fs:e,dir:t,gitdir:n,entries:u})).filter(Boolean).map(m=>({mode:m.mode,path:m.path,oid:m.oid,type:m.type}));return O1({fs:e,gitdir:n,tree:h})}async function OEe({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:s,wasStaged:i}){const a=[],o=[],l=await Ch({fs:e,cache:{},dir:t,gitdir:n,trees:[zl({ref:s}),zl({ref:r})],map:async(c,[u,d])=>{if(c==="."||await Yy.isIgnored({fs:e,dir:t,gitdir:n,filepath:c}))return;const h=d?await d.type():await u.type();if(h!=="tree"&&h!=="blob")return;if(!d&&u){const y=h==="tree"?"rmdir":"rm";return h==="tree"&&a.push(c),h==="blob"&&i&&o.push({filepath:c,oid:await u.oid()}),{method:y,filepath:c}}const m=await d.oid();if(!u||await u.oid()!==m)return h==="tree"?{method:"mkdir",filepath:c}:(i&&o.push({filepath:c,oid:m,stats:await e.lstat($t.join(t,c))}),{method:"write",filepath:c,oid:m})}});await ly({fs:e,gitdir:n,dirRemoved:a,ops:l},async()=>{for(const c of l){const u=$t.join(t,c.filepath);switch(c.method){case"rmdir":await e.rmdir(u);break;case"mkdir":await e.mkdir(u);break;case"rm":await e.rm(u);break;case"write":if(!a.some(d=>u.startsWith(d))){const{object:d}=await Ks({fs:e,cache:{},gitdir:n,oid:c.oid});await e.exists(u)&&await e.rm(u),await e.write(u,d)}break}}}),await aa.acquire({fs:e,gitdir:n,cache:{}},async c=>{o.forEach(({filepath:u,stats:d,oid:h})=>{c.insert({filepath:u,stats:d,oid:h})})})}class Md{constructor({fs:t,dir:n,gitdir:r=$t.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return $t.join(this.gitdir,Md.refStash)}get refLogsStashPath(){return $t.join(this.gitdir,Md.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await kh({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new Ba("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return oZ({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new Ac(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?oy({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return Kt.writeRef({fs:this.fs,gitdir:this.gitdir,ref:Md.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),s=YC.createStashReflogEntry(r,t,n),i=this.refLogsStashPath;await ly({filepath:i,entry:s},async()=>{const a=await this.fs.exists(i)?await this.fs.read(i,"utf8"):"";await this.fs.write(i,a+s,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return YC.getStashReflogEntry(r,t)}}async function PEe({fs:e,dir:t,gitdir:n,message:r=""}){const s=new Md({fs:e,dir:t,gitdir:n});await s.getAuthor();const i=await Hh({fs:e,gitdir:n,fullname:!1}),a=await Kt.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await iZ({fs:e,dir:t,gitdir:n,oid:a})).commit.message,c=[a];let u=null,d=zl({ref:"HEAD"});const h=await wz({fs:e,dir:t,gitdir:n,treePair:[zl({ref:"HEAD"}),"stage"]});if(h){const v=await s.writeStashCommit({message:`stash-Index: WIP on ${i} - ${new Date().toISOString()}`,tree:h,parent:c});c.push(v),u=h,d=Vy()}const m=await wz({fs:e,dir:t,gitdir:n,treePair:[d,"workdir"]});if(m){const v=await s.writeStashCommit({message:`stash-WorkDir: WIP on ${i} - ${new Date().toISOString()}`,tree:m,parent:[c[c.length-1]]});c.push(v),u=m}if(!u||!h&&!m)throw new Es("changes, nothing to stash");const y=(r.trim()||`WIP on ${i}`)+`: ${a.substring(0,7)} ${l}`,b=await s.writeStashCommit({message:y,tree:u,parent:c});return await s.writeStashRef(b),await s.writeStashReflogEntry({stashCommit:b,message:y}),await qY({fs:e,dir:t,gitdir:n,ref:i,track:!1,force:!0}),b}async function lZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=await new Md({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:a=null}=i.commit?i.commit:{};if(!(!a||!Array.isArray(a)))for(let o=0;o<a.length-1;o++){const c=(await oy({fs:e,cache:{},gitdir:n,oid:a[o+1]})).commit.message.startsWith("stash-Index");await OEe({fs:e,dir:t,gitdir:n,stashCommit:a[o+1],parentCommit:a[o],wasStaged:c})}}async function cZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const s=new Md({fs:e,dir:t,gitdir:n});if(!(await s.readStashCommit(r)).commit)return;const a=s.refStashPath;await ly(a,async()=>{await e.exists(a)&&await e.rm(a)});const o=await s.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=s.refLogsStashPath;await ly({reflogEntries:o,stashReflogPath:l,stashMgr:s},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const c=o[o.length-1].split(" ")[1];await s.writeStashRef(c)}else await e.rm(l)})}async function DEe({fs:e,dir:t,gitdir:n}){return new Md({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function FEe({fs:e,dir:t,gitdir:n}){const r=new Md({fs:e,dir:t,gitdir:n}),s=[r.refStashPath,r.refLogsStashPath];await ly(s,async()=>{await Promise.all(s.map(async i=>{if(await e.exists(i))return e.rm(i)}))})}async function LEe({fs:e,dir:t,gitdir:n,refIdx:r=0}){await lZ({fs:e,dir:t,gitdir:n,refIdx:r}),await cZ({fs:e,dir:t,gitdir:n,refIdx:r})}async function BEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),op:r="push",message:s="",refIdx:i=0}){ct("fs",e),ct("dir",t),ct("gitdir",n),ct("op",r);const a={push:PEe,apply:lZ,drop:cZ,list:DEe,clear:FEe,pop:LEe},o=["apply","drop","pop"];try{const l=new Sn(e);["refs","logs","logs/refs"].map(d=>$t.join(n,d)).forEach(async d=>{await l.exists(d)||await l.mkdir(d)});const u=a[r];if(u){if(o.includes(r)&&i<0)throw new Ac(`stash@${i}`,"number that is in range of [0, num of stash pushed]");return await u({fs:l,dir:t,gitdir:n,message:s,refIdx:i})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function $Ee({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r);const i=new Sn(e);if(await Yy.isIgnored({fs:i,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await zEe({fs:i,cache:s,gitdir:n}),l=await uZ({fs:i,cache:s,gitdir:n,tree:o,path:r}),c=await aa.acquire({fs:i,gitdir:n,cache:s},async function(b){for(const v of b)if(v.path===r)return v;return null}),u=await i.lstat($t.join(t,r)),d=l!==null,h=c!==null,m=u!==null,y=async()=>{if(h&&!zC(c,u))return c.oid;{const b=await i.read($t.join(t,r)),v=await aZ({gitdir:n,type:"blob",object:b});return h&&c.oid===v&&u.size!==-1&&aa.acquire({fs:i,gitdir:n,cache:s},async function(x){x.insert({filepath:r,stats:u,oid:v})}),v}};if(!d&&!m&&!h)return"absent";if(!d&&!m&&h)return"*absent";if(!d&&m&&!h)return"*added";if(!d&&m&&h)return await y()===c.oid?"added":"*added";if(d&&!m&&!h)return"deleted";if(d&&!m&&h)return l===c.oid,"*deleted";if(d&&m&&!h)return await y()===l?"*undeleted":"*undeletemodified";if(d&&m&&h){const b=await y();return b===l?b===c.oid?"unmodified":"*unmodified":b===c.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function uZ({fs:e,cache:t,gitdir:n,tree:r,path:s}){typeof s=="string"&&(s=s.split("/"));const i=s.shift();for(const a of r)if(a.path===i){if(s.length===0)return a.oid;const{type:o,object:l}=await Ks({fs:e,cache:t,gitdir:n,oid:a.oid});if(o==="tree"){const c=Io.from(l);return uZ({fs:e,cache:t,gitdir:n,tree:c,path:s})}if(o==="blob")throw new co(a.oid,o,"blob",s.join("/"))}return null}async function zEe({fs:e,cache:t,gitdir:n}){let r;try{r=await Kt.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(i){if(i instanceof Es)return[]}const{tree:s}=await Zy({fs:e,cache:t,gitdir:n,oid:r});return s}async function UEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="HEAD",filepaths:s=["."],filter:i,cache:a={},ignored:o=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r);const l=new Sn(e);return await Ch({fs:l,cache:a,dir:t,gitdir:n,trees:[zl({ref:r}),I1(),Vy()],map:async function(c,[u,d,h]){if(!u&&!h&&d&&!o&&await Yy.isIgnored({fs:l,dir:t,filepath:c})||!s.some(A=>UY(c,A)))return null;if(i&&!i(c))return;const[m,y,b]=await Promise.all([u&&u.type(),d&&d.type(),h&&h.type()]),v=[m,y,b].includes("blob");if((m==="tree"||m==="special")&&!v)return;if(m==="commit")return null;if((y==="tree"||y==="special")&&!v)return;if(b==="commit")return null;if((b==="tree"||b==="special")&&!v)return;const x=m==="blob"?await u.oid():void 0,w=b==="blob"?await h.oid():void 0;let S;m!=="blob"&&y==="blob"&&b!=="blob"?S="42":y==="blob"&&(S=await d.oid());const C=[void 0,x,S,w],k=C.map(A=>C.indexOf(A));return k.shift(),[c,...k]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function qEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,force:i=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r);const a=new Sn(e);if(r===void 0)throw new Ao("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await Kt.resolve({fs:a,gitdir:n,ref:s||"HEAD"});if(!i&&await Kt.exists({fs:a,gitdir:n,ref:r}))throw new Ic("tag",r);await Kt.writeRef({fs:a,gitdir:n,ref:r,value:o})}catch(a){throw a.caller="git.tag",a}}async function VEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),cache:r={},filepath:s,oid:i,mode:a,add:o,remove:l,force:c}){try{ct("fs",e),ct("gitdir",n),ct("filepath",s);const u=new Sn(e);if(l)return await aa.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!c){const m=await u.lstat($t.join(t,s));if(m){if(m.isDirectory())throw new Sh("directory");return}}h.has({filepath:s})&&h.delete({filepath:s})});let d;if(!i){if(d=await u.lstat($t.join(t,s)),!d)throw new Es(`file at "${s}" on disk and "remove" not set`);if(d.isDirectory())throw new Sh("directory")}return await aa.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!o&&!h.has({filepath:s}))throw new Es(`file at "${s}" in index and "add" not set`);let m;if(i)m={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:a,uid:0,gid:0,size:0};else{m=d;const y=m.isSymbolicLink()?await u.readlink($t.join(t,s)):await u.read($t.join(t,s));i=await Bo({fs:u,gitdir:n,type:"blob",format:"content",object:y})}return h.insert({filepath:s,oid:i,stats:m}),i})}catch(u){throw u.caller="git.updateIndex",u}}function WEe(){try{return JE.version}catch(e){throw e.caller="git.version",e}}async function HEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),trees:r,map:s,reduce:i,iterate:a,cache:o={}}){try{return ct("fs",e),ct("gitdir",n),ct("trees",r),await Ch({fs:new Sn(e),cache:o,dir:t,gitdir:n,trees:r,map:s,reduce:i,iterate:a})}catch(l){throw l.caller="git.walk",l}}async function GEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),blob:r}){try{return ct("fs",e),ct("gitdir",n),ct("blob",r),await Bo({fs:new Sn(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(s){throw s.caller="git.writeBlob",s}}async function KEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r}){try{return ct("fs",e),ct("gitdir",n),ct("commit",r),await oZ({fs:new Sn(e),gitdir:n,commit:r})}catch(s){throw s.caller="git.writeCommit",s}}async function YEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),type:r,object:s,format:i="parsed",oid:a,encoding:o=void 0}){try{const l=new Sn(e);if(i==="parsed"){switch(r){case"commit":s=Gs.from(s).toObject();break;case"tree":s=Io.from(s).toObject();break;case"blob":s=on.from(s,o);break;case"tag":s=to.from(s).toObject();break;default:throw new co(a||"",r,"blob|commit|tag|tree")}i="content"}return a=await Bo({fs:l,gitdir:n,type:r,object:s,oid:a,format:i}),a}catch(l){throw l.caller="git.writeObject",l}}async function ZEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,value:s,force:i=!1,symbolic:a=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r),ct("value",s);const o=new Sn(e);if(r!==uu.clean(r))throw new Ac(r,uu.clean(r));if(!i&&await Kt.exists({fs:o,gitdir:n,ref:r}))throw new Ic("ref",r);a?await Kt.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:s}):(s=await Kt.resolve({fs:o,gitdir:n,ref:s}),await Kt.writeRef({fs:o,gitdir:n,ref:r,value:s}))}catch(o){throw o.caller="git.writeRef",o}}async function XEe({fs:e,gitdir:t,tag:n}){const r=to.from(n).toObject();return await Bo({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function JEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tag:r}){try{return ct("fs",e),ct("gitdir",n),ct("tag",r),await XEe({fs:new Sn(e),gitdir:n,tag:r})}catch(s){throw s.caller="git.writeTag",s}}async function QEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tree:r}){try{return ct("fs",e),ct("gitdir",n),ct("tree",r),await O1({fs:new Sn(e),gitdir:n,tree:r})}catch(s){throw s.caller="git.writeTree",s}}var Bi={Errors:TCe,STAGE:Vy,TREE:zl,WORKDIR:I1,add:WCe,abortMerge:zCe,addNote:GCe,addRemote:KCe,annotatedTag:ZCe,branch:JCe,checkout:qY,clone:uke,commit:dke,getConfig:Ike,getConfigAll:Oke,setConfig:NEe,currentBranch:fke,deleteBranch:pke,deleteRef:mke,deleteRemote:yke,deleteTag:vke,expandOid:Ske,expandRef:Cke,fastForward:Ake,fetch:Rke,findMergeBase:Nke,findRoot:Mke,getRemoteInfo:Pke,getRemoteInfo2:Dke,hashBlob:Lke,indexPack:$ke,init:zke,isDescendent:Uke,isIgnored:qke,listBranches:Vke,listFiles:Hke,listNotes:Kke,listRefs:Yke,listRemotes:Xke,listServerRefs:eEe,listTags:tEe,log:iEe,merge:aEe,packObjects:cEe,pull:uEe,push:mEe,readBlob:gEe,readCommit:iZ,readNote:bEe,readObject:vEe,readTag:wEe,readTree:_Ee,remove:SEe,removeNote:kEe,renameBranch:TEe,resetIndex:AEe,updateIndex:VEe,resolveRef:REe,status:$Ee,statusMatrix:UEe,tag:qEe,version:WEe,walk:HEe,writeBlob:GEe,writeCommit:KEe,writeObject:YEe,writeRef:ZEe,writeTag:JEe,writeTree:QEe,stash:BEe};function eTe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function tTe(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:eTe(e)}async function nTe(e,t){const n=tTe(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function rTe(e){let t=0;const n=[];await nTe(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function sTe(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function iTe({onProgress:e,url:t,method:n="GET",headers:r={},body:s}){s&&(s=await rTe(s));const i=await fetch(t,{method:n,headers:r,body:s}),a=i.body&&i.body.getReader?sTe(i.body):[new Uint8Array(await i.arrayBuffer())];r={};for(const[o,l]of i.headers.entries())r[o]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:a,headers:r}}var aw={request:iTe};const ow="https://cors.isomorphic-git.org",cy=new Map,dZ=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=yr.getState();if(!n||!r)return Oe.error("Git user name and email must be configured in Settings before committing."),!1;try{const s=await Bi.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),i=await Bi.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return s!==n&&await Bi.setConfig({fs:t,dir:e,path:"user.name",value:n}),i!==r&&await Bi.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(s){return console.error("[VFS Git Op] Error checking/setting Git config:",s),Oe.error(`Failed to configure Git user: ${s instanceof Error?s.message:String(s)}`),!1}},lw=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=cy.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const s=window.prompt(`Enter username for ${e}`);if(!s)return Oe.error("Authentication cancelled: Username not provided."),null;const i=window.prompt(`Enter password or token for ${s}@${e}`);return i?(cy.set(n,{username:s,password:i}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:s,password:i,authScheme:"Basic"}):(Oe.error("Authentication cancelled: Password/token not provided."),null)},cw=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),cy.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),cy.delete(n)),null},uw=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!cy.has(n)&&t.username&&t.password&&(cy.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},k0=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let s="";if(r)try{const i=JSON.parse(r);s=i.message||i.error||JSON.stringify(i)}catch{s=r}return`HTTP ${t} ${n}${s?`: ${s}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},aTe=async(e,t)=>{const n=la,r=zr(e),s=Au(r,".git");try{return(await n.promises.stat(s)).isDirectory()}catch(i){return i instanceof Error&&i.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,i),!1}},fZ=async(e,t,n,r,s)=>{var o;const i=(s==null?void 0:s.fsInstance)??la,a=zr(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${a}`);try{let l=!1;try{await i.promises.stat(Au(a,".git")),l=!0}catch(h){if(h.code!=="ENOENT")throw h}if(l)throw console.warn(`[VFS Git Op] Clone target ${a} already contains a .git directory.`),new Error(`Repository already cloned at ${a}.`);const c=GE(a);if(c!=="/")try{await i.promises.mkdir(c,{recursive:!0})}catch(h){if(h.code!=="EEXIST")throw h}let u=n;if(!u)try{if(u=(o=(await Bi.getRemoteInfo({http:aw,url:t,corsProxy:ow,onAuth:m=>lw(m,r),onAuthFailure:cw,onAuthSuccess:uw})).HEAD)==null?void 0:o.replace("refs/heads/",""),!u)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${u}`)}catch(h){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",h),new Error(`Failed to determine default branch: ${k0(h)}`)}await Bi.clone({fs:i,http:aw,dir:a,corsProxy:ow,url:t,ref:u,singleBranch:!0,depth:10,onAuth:h=>lw(h,r),onAuthFailure:cw,onAuthSuccess:uw,onProgress:h=>{h.phase==="counting objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):h.phase==="receiving objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):console.log(`Clone progress: ${h.phase}`)}}),await i.promises.stat(Au(a,".git"));const d=await Bi.currentBranch({fs:i,dir:a,fullname:!1}).catch(()=>null);d!==u&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${d}, expected ${u}. Checking out...`),await Bi.checkout({fs:i,dir:a,ref:u})),Oe.success(`Repository cloned successfully into ${a} (branch: ${u}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const c=k0(l);if(l instanceof Error&&l.message.includes("already cloned")||Oe.error(`Git clone failed: ${c}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${a}`),await i.promises.rm(a,{recursive:!0,force:!0})}catch(u){console.warn("[VFS Git Op] Failed cleanup after clone error:",u)}throw l}},hZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??la,r=zr(e);try{await Bi.init({fs:n,dir:r}),Oe.success(`Initialized empty Git repository in "${gi(r)}"`)}catch(s){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,s),Oe.error(`Git init failed: ${s instanceof Error?s.message:String(s)}`),s}},aD=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??la,s=zr(e);try{if(!await dZ(s,r))throw new Error("Git user configuration is missing or invalid.");if(await Bi.add({fs:r,dir:s,filepath:"."}),!(await Bi.statusMatrix({fs:r,dir:s})).some(([,,c])=>c!==0)){Oe.info("No changes detected to commit.");return}const l=await Bi.commit({fs:r,dir:s,message:t,author:{name:yr.getState().gitUserName,email:yr.getState().gitUserEmail}});Oe.success(`Changes committed: ${l.substring(0,7)}`)}catch(i){throw console.error(`[VFS Git Op] Git commit failed for ${s}:`,i),Oe.error(`Git commit failed: ${i instanceof Error?i.message:String(i)}`),i}},QE=async(e,t,n,r)=>{const s=(r==null?void 0:r.fsInstance)??la,i=zr(e);try{if(!await dZ(i,s))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${i}`);const o=await Bi.currentBranch({fs:s,dir:i,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await Bi.checkout({fs:s,dir:i,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await Bi.fetch({fs:s,http:aw,dir:i,corsProxy:ow,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:c=>lw(c,n),onAuthFailure:cw,onAuthSuccess:uw}),await Bi.branch({fs:s,dir:i,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(c){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,c),new Error(`Failed to switch to or create local branch "${t}": ${k0(c)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${k0(l)}`)}}await Bi.pull({fs:s,http:aw,dir:i,ref:t,singleBranch:!0,author:{name:yr.getState().gitUserName,email:yr.getState().gitUserEmail},corsProxy:ow,onAuth:l=>lw(l,n),onAuthFailure:cw,onAuthSuccess:uw}),Oe.success(`Pulled changes successfully for "${gi(i)}"`),console.log(`[VFS Git Op] Pull successful for ${i}`)}catch(a){if(console.error(`[VFS Git Op] Git pull failed for ${i}:`,a),a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")?Oe.info(`Branch "${t}" is already up-to-date.`):Oe.error(`Git pull failed: ${k0(a)}`),!(a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")))throw a}},oD=async(e,t,n,r)=>{var a,o;const s=(r==null?void 0:r.fsInstance)??la,i=zr(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${i}`);const l=await Bi.push({fs:s,http:aw,dir:i,corsProxy:ow,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:c=>lw(c,n),onAuthFailure:cw,onAuthSuccess:uw});if(l!=null&&l.ok)Oe.success(`Pushed changes successfully for "${gi(i)}"`);else if((a=l==null?void 0:l.error)!=null&&a.includes("up-to-date"))Oe.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(Oe.error(`Push rejected for "${gi(i)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${i}:`,l),l instanceof Error&&l.message.includes("rejected")||Oe.error(`Git push failed: ${k0(l)}`),l}},pZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??la,r=zr(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const s=await Bi.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",s);const i=s.map(([a,o,l,c])=>{let u="";return c===2&&(u+="INDEX_Modified "),c===3&&(u+="INDEX_Added "),o===0&&l===2?u+="WT_New":o===1&&l===2?u+="WT_Modified":o===1&&l===0?u+="WT_Deleted":o===1&&l===1&&c===0&&(u="Unmodified"),(!u||u==="INDEX_Unmodified ")&&(u=`h:${o} w:${l} s:${c}`),`${a}: ${u.trim()}`}).filter(a=>!a.endsWith("Unmodified")).join(`
`);Oe.info(`Git Status for "${gi(r)}":
${i||"No changes"}`,{duration:15e3})}catch(s){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,s),Oe.error(`Git status failed: ${s instanceof Error?s.message:String(s)}`),s}},gm=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??la,r=zr(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(s){if(s instanceof Error&&s.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,s),Oe.error(`Error creating directory "${gi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},oTe=async e=>{try{const t={backend:u2e,name:`litechat_vfs_${e}`};return await n2e(t),la}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),Oe.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},lD=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??la,r=zr(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await gm(r,{fsInstance:n}),[];throw l}const i=(await n.promises.readdir(r)).map(async l=>{const c=Au(r,l);try{const u=await n.promises.stat(c);return{name:l,path:c,isDirectory:u.isDirectory(),size:u.size,lastModified:u.mtime}}catch(u){return console.error(`[VFS Op] Failed to stat ${c}:`,u),null}});return(await Promise.all(i)).filter(l=>l!==null)}catch(s){throw console.error(`[VFS Op] Failed to list directory ${r}:`,s),Oe.error(`Error listing files: ${s instanceof Error?s.message:String(s)}`),s}},Gh=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??la,r=zr(e);try{const s=await n.promises.readFile(r);return je.emit(dn.fileRead,{path:r}),s}catch(s){throw console.error(`[VFS Op] Failed to read file ${r}:`,s),Oe.error(`Error reading file "${gi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},eT=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??la,s=zr(e),i=GE(s);try{i!=="/"&&await gm(i,{fsInstance:r}),await r.promises.writeFile(s,t),je.emit(dn.fileWritten,{path:s})}catch(a){throw a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${s}:`,a),Oe.error(`Error writing file "${gi(s)}": ${a instanceof Error?a.message:String(a)}`)),a}},cD=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??la,s=zr(e);if(s==="/")throw Oe.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(s)).isDirectory()?(await r.promises.rm(s,{recursive:t}),je.emit(dn.fileDeleted,{path:s})):(await r.promises.unlink(s),je.emit(dn.fileDeleted,{path:s})),Oe.success(`"${gi(s)}" deleted.`)}catch(i){if(i instanceof Error&&i.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${s}`);return}throw console.error(`[VFS Op] Failed to delete ${s}:`,i),Oe.error(`Error deleting "${gi(s)}": ${i instanceof Error?i.message:String(i)}`),i}},mZ=async(e,t)=>{await gm(e,t)},lTe=async(e,t,n)=>{try{const r=await Gh(e,n),s=new Blob([r]),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i;const o=zr(e);a.download=t||gi(o),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||Oe.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},gZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??la,s=zr(t);let i=0,a=0;const o=Array.from(e);try{await gm(s,{fsInstance:r});for(const l of o){const c=Au(s,l.name);try{const u=await l.arrayBuffer();await eT(c,new Uint8Array(u),{fsInstance:r}),i++}catch(u){a++,console.error(`[VFS Op] Failed to upload ${l.name}:`,u)}}}catch(l){a=o.length,console.error(`[VFS Op] Failed to prepare target directory ${s} for upload:`,l)}finally{a>0&&i>0?Oe.warning(`Upload complete with issues. ${i} succeeded, ${a} failed.`):a===0&&i>0&&Oe.success(`Successfully uploaded ${i} file(s) to ${s==="/"?"root":gi(s)}.`)}},cTe=async(e,t,n)=>{const r=la;if(!e.name.toLowerCase().endsWith(".zip")){Oe.error("Please select a valid ZIP file.");return}const s=zr(t);let i;try{await gm(s,{fsInstance:r}),i=await XP.loadAsync(e);const a=Object.values(i.files),o=await Promise.allSettled(a.map(async d=>{const h=Au(s,d.name);if(d.dir)await gm(h,{fsInstance:r});else{const m=await d.async("uint8array");await eT(h,m,{fsInstance:r})}return{name:d.name,isDir:d.dir}}));let l=0,c=0,u=0;o.forEach(d=>{d.status==="fulfilled"&&d.value?d.value.isDir?c++:l++:d.status==="rejected"&&(u++,console.error("[VFS Op] ZIP Extraction item failed:",d.reason))}),u>0?Oe.warning(`Finished extracting "${e.name}". ${l+c} items succeeded, ${u} failed.`):Oe.success(`Successfully extracted ${l} files and ${c} folders from "${e.name}" to ${s==="/"?"root":gi(s)}.`)}catch(a){a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,a),Oe.error(`ZIP extraction failed: ${a instanceof Error?a.message:String(a)}`))}},_z=async(e,t="/",n)=>{const r=la,s=new XP,i=zr(t),a=gi(i)||"root";try{try{if(!(await r.promises.stat(i)).isDirectory()){Oe.error(`Cannot export: "${a}" is not a directory.`);return}}catch(h){h instanceof Error&&h.code==="ENOENT"?Oe.error(`Cannot export: Path "${a}" not found.`):Oe.error(`Cannot export: Error accessing path "${a}". ${h instanceof Error?h.message:String(h)}`);return}const o=async(h,m)=>{const y=await lD(h,{fsInstance:r});for(const b of y)if(b.isDirectory){if(b.name===".git")continue;const v=m.folder(b.name);if(v)await o(b.path,v);else throw new Error(`Failed to create subfolder ${b.name} in zip.`)}else{const v=await Gh(b.path,{fsInstance:r});m.file(b.name,v)}};await o(i,s);const l=await s.generateAsync({type:"blob"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c;const d=`vfs_${a}_export.zip`;u.download=e||d,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),Oe.success(`"${a}" exported as ${u.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||Oe.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},yZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??la,s=zr(e),i=zr(t);if(s==="/"||i==="/")throw Oe.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(s!==i)try{const a=GE(i);a!=="/"&&await gm(a,{fsInstance:r}),await r.promises.rename(s,i),Oe.success(`Renamed "${gi(s)}" to "${gi(i)}"`)}catch(a){throw a instanceof Error&&a.code==="ENOENT"?a.message.includes("Error creating directory")||Oe.error(`Rename failed: Original item "${gi(s)}" not found.`):a instanceof Error&&a.code==="EEXIST"?Oe.error(`Rename failed: An item named "${gi(i)}" already exists.`):a instanceof Error&&a.message.includes("Error creating directory")||Oe.error(`Rename failed: ${a instanceof Error?a.message:String(a)}`),console.error(`[VFS Op] Failed to rename ${s} to ${i}:`,a),a}},uTe=1024*5,dTe=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const s=new Uint8Array(r),i=new Blob([s],{type:t});return URL.createObjectURL(i)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},Sz=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const s=new Uint8Array(r);t=new Blob([s],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},bZ=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,s]=T.useState(null),[i,a]=T.useState(null),[o,l]=T.useState(!1),[c,u]=T.useState(!1),[d,h]=T.useState(!0),m=e.type||"application/octet-stream",y=zx(e.name,m),b=m.startsWith("image/"),v=m.startsWith("audio/"),x=m.startsWith("video/"),w=e.source==="vfs";T.useEffect(()=>{let I=null;return a(null),e.source==="direct"&&!y&&e.contentBase64?(I=dTe(e.contentBase64,m),I||a("Failed to decode file content for preview."),s(I)):s(null),e.source==="direct"&&y&&e.contentText&&e.contentText.length>uTe?a(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&y&&e.contentText===void 0&&a("Text content missing from metadata."),()=>{I&&(URL.revokeObjectURL(I),s(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,m,y]);const S=async()=>{if(e.source==="vfs"){Oe.info("File is already in VFS.");return}const I=Sz(e);if(!I){Oe.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await gZ([I],"/"),Oe.success(`"${e.name}" added to VFS root.`)}catch(O){console.error("Failed to add file to VFS:",O),Oe.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},C=async()=>{u(!0);try{let I;if(e.source==="vfs"&&e.path){const P=await Gh(e.path);I=new Blob([P],{type:m})}else{const P=Sz(e);if(!P)throw new Error("Could not reconstruct file data.");I=P}const O=URL.createObjectURL(I),L=document.createElement("a");L.href=O,L.download=e.name,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(O)}catch(I){console.error("Failed to download file:",I),Oe.error(`Download failed: ${I instanceof Error?I.message:String(I)}`)}finally{u(!1)}},k=()=>h(I=>!I),A=()=>w?f.jsx(jO,{className:"h-5 w-5 text-cyan-500"}):y?f.jsx(sme,{className:"h-5 w-5 text-blue-500"}):b?f.jsx(im,{className:"h-5 w-5 text-purple-500"}):v?f.jsx(qme,{className:"h-5 w-5 text-green-500"}):x?f.jsx(Lge,{className:"h-5 w-5 text-orange-500"}):f.jsx(nme,{className:"h-5 w-5 text-muted-foreground"}),R=()=>w?f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):i?f.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[f.jsx(_c,{className:"h-4 w-4"}),f.jsx("span",{children:i})]}):y&&e.contentText!==void 0?f.jsx(Fy,{lang:m==="text/markdown"?"markdown":"text",code:e.contentText}):b&&r?f.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):v&&r?f.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):x&&r?f.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),N=T.useMemo(()=>{let I="File";return w?I="VFS File":y?I="Text":b?I="Image":v?I="Audio":x&&(I="Video"),`${I} (${nw(e.size)})`},[w,y,b,v,x,e.size]);return f.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[f.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[A(),f.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),f.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",nw(e.size),")"]}),w&&e.path&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),f.jsx(Sr,{children:f.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:C,disabled:c,"aria-label":"Download file",children:c?f.jsx(Qn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(pu,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Download File"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:k,"aria-label":d?"Unfold preview":"Fold preview",children:f.jsx(aE,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{side:"top",children:d?"Unfold":"Fold"})]})}),!n&&t&&f.jsxs(f.Fragment,{children:[e.source==="direct"&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:S,disabled:o,"aria-label":"Add to VFS",children:o?f.jsx(Qn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(NO,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Add to VFS"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:f.jsx(wa,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Remove from Prompt"})]})})]})]})]}),d?f.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:k,children:N}):f.jsx("div",{className:Ze("p-2 max-h-80 overflow-y-auto"),children:R()})]})},vZ=6048e5,fTe=864e5,xZ=6e4,wZ=36e5,DS=43200,Cz=1440,kz=Symbol.for("constructDateFrom");function yi(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&kz in e?e[kz](t):e instanceof Date?new e.constructor(t):new Date(t)}function qr(e,t){return yi(t||e,e)}function _Z(e,t,n){const r=qr(e,n==null?void 0:n.in);return isNaN(t)?yi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function SZ(e,t,n){const r=qr(e,n==null?void 0:n.in);if(isNaN(t))return yi(e,NaN);if(!t)return r;const s=r.getDate(),i=yi(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const a=i.getDate();return s>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),s),r)}let hTe={};function Xy(){return hTe}function uy(e,t){var o,l,c,u;const n=Xy(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=qr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?7:0)+i-r;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function dw(e,t){return uy(e,{...t,weekStartsOn:1})}function CZ(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=yi(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=dw(s),a=yi(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=dw(a);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function ZC(e){const t=qr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Kh(e,...t){const n=yi.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function fw(e,t){const n=qr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function kZ(e,t,n){const[r,s]=Kh(n==null?void 0:n.in,e,t),i=fw(r),a=fw(s),o=+i-ZC(i),l=+a-ZC(a);return Math.round((o-l)/fTe)}function pTe(e,t){const n=CZ(e,t),r=yi(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),dw(r)}function mTe(e,t,n){return _Z(e,t*7,n)}function gTe(e,t,n){return SZ(e,t*12,n)}function yTe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=yi.bind(null,s));const i=qr(s,r);(!n||n<i||isNaN(+i))&&(n=i)}),yi(r,n||NaN)}function bTe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=yi.bind(null,s));const i=qr(s,r);(!n||n>i||isNaN(+i))&&(n=i)}),yi(r,n||NaN)}function T2(e,t){const n=+qr(e)-+qr(t);return n<0?-1:n>0?1:n}function vTe(e){return yi(e,Date.now())}function xTe(e,t,n){const[r,s]=Kh(n==null?void 0:n.in,e,t);return+fw(r)==+fw(s)}function EZ(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function wTe(e){return!(!EZ(e)&&typeof e!="number"||isNaN(+qr(e)))}function TZ(e,t,n){const[r,s]=Kh(n==null?void 0:n.in,e,t),i=r.getFullYear()-s.getFullYear(),a=r.getMonth()-s.getMonth();return i*12+a}function _Te(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function STe(e,t){return+qr(e)-+qr(t)}function CTe(e,t){const n=qr(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function AZ(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function kTe(e,t){const n=qr(e,t==null?void 0:t.in);return+CTe(n,t)==+AZ(n,t)}function ETe(e,t,n){const[r,s,i]=Kh(n==null?void 0:n.in,e,e,t),a=T2(s,i),o=Math.abs(TZ(s,i));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=T2(s,i)===-a;kTe(r)&&o===1&&T2(r,i)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function TTe(e,t,n){const r=STe(e,t)/1e3;return _Te(n==null?void 0:n.roundingMethod)(r)}function ATe(e,t){const[n,r]=Kh(e,t.start,t.end);return{start:n,end:r}}function RTe(e,t){const{start:n,end:r}=ATe(t==null?void 0:t.in,e);let s=+n>+r;const i=s?+n:+r,a=s?r:n;a.setHours(0,0,0,0),a.setDate(1);let o=1;const l=[];for(;+a<=i;)l.push(yi(n,a)),a.setMonth(a.getMonth()+o);return s?l.reverse():l}function NTe(e,t){const n=qr(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function MTe(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function RZ(e,t){const n=qr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function NZ(e,t){var o,l,c,u;const n=Xy(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=qr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}function ITe(e,t){return NZ(e,{...t,weekStartsOn:1})}const jTe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},OTe=(e,t,n)=>{let r;const s=jTe[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function sI(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const PTe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},DTe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},FTe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},LTe={date:sI({formats:PTe,defaultWidth:"full"}),time:sI({formats:DTe,defaultWidth:"full"}),dateTime:sI({formats:FTe,defaultWidth:"full"})},BTe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},$Te=(e,t,n,r)=>BTe[e];function Tv(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const zTe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},UTe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},qTe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},VTe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},WTe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},HTe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},GTe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},KTe={ordinalNumber:GTe,era:Tv({values:zTe,defaultWidth:"wide"}),quarter:Tv({values:UTe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Tv({values:qTe,defaultWidth:"wide"}),day:Tv({values:VTe,defaultWidth:"wide"}),dayPeriod:Tv({values:WTe,defaultWidth:"wide",formattingValues:HTe,defaultFormattingWidth:"wide"})};function Av(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?ZTe(o,d=>d.test(a)):YTe(o,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function YTe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function ZTe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function XTe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const JTe=/^(\d+)(th|st|nd|rd)?/i,QTe=/\d+/i,eAe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},tAe={any:[/^b/i,/^(a|c)/i]},nAe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},rAe={any:[/1/i,/2/i,/3/i,/4/i]},sAe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},iAe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},aAe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},oAe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},lAe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},cAe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},uAe={ordinalNumber:XTe({matchPattern:JTe,parsePattern:QTe,valueCallback:e=>parseInt(e,10)}),era:Av({matchPatterns:eAe,defaultMatchWidth:"wide",parsePatterns:tAe,defaultParseWidth:"any"}),quarter:Av({matchPatterns:nAe,defaultMatchWidth:"wide",parsePatterns:rAe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Av({matchPatterns:sAe,defaultMatchWidth:"wide",parsePatterns:iAe,defaultParseWidth:"any"}),day:Av({matchPatterns:aAe,defaultMatchWidth:"wide",parsePatterns:oAe,defaultParseWidth:"any"}),dayPeriod:Av({matchPatterns:lAe,defaultMatchWidth:"any",parsePatterns:cAe,defaultParseWidth:"any"})},tT={code:"en-US",formatDistance:OTe,formatLong:LTe,formatRelative:$Te,localize:KTe,match:uAe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function dAe(e,t){const n=qr(e,t==null?void 0:t.in);return kZ(n,RZ(n))+1}function MZ(e,t){const n=qr(e,t==null?void 0:t.in),r=+dw(n)-+pTe(n);return Math.round(r/vZ)+1}function IZ(e,t){var u,d,h,m;const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=Xy(),i=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(h=s.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=yi((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,i),a.setHours(0,0,0,0);const o=uy(a,t),l=yi((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=uy(l,t);return+n>=+o?r+1:+n>=+c?r:r-1}function fAe(e,t){var o,l,c,u;const n=Xy(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=IZ(e,t),i=yi((t==null?void 0:t.in)||e,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),uy(i,t)}function jZ(e,t){const n=qr(e,t==null?void 0:t.in),r=+uy(n,t)-+fAe(n,t);return Math.round(r/vZ)+1}function bs(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Yf={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return bs(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):bs(n+1,2)},d(e,t){return bs(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return bs(e.getHours()%12||12,t.length)},H(e,t){return bs(e.getHours(),t.length)},m(e,t){return bs(e.getMinutes(),t.length)},s(e,t){return bs(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return bs(s,t.length)}},Kg={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ez={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Yf.y(e,t)},Y:function(e,t,n,r){const s=IZ(e,r),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return bs(a,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):bs(i,t.length)},R:function(e,t){const n=CZ(e);return bs(n,t.length)},u:function(e,t){const n=e.getFullYear();return bs(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return bs(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return bs(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Yf.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return bs(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=jZ(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):bs(s,t.length)},I:function(e,t,n){const r=MZ(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):bs(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Yf.d(e,t)},D:function(e,t,n){const r=dAe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):bs(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return bs(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return bs(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return bs(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=Kg.noon:r===0?s=Kg.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=Kg.evening:r>=12?s=Kg.afternoon:r>=4?s=Kg.morning:s=Kg.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Yf.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Yf.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):bs(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):bs(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Yf.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Yf.s(e,t)},S:function(e,t){return Yf.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Az(r);case"XXXX":case"XX":return jp(r);case"XXXXX":case"XXX":default:return jp(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Az(r);case"xxxx":case"xx":return jp(r);case"xxxxx":case"xxx":default:return jp(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Tz(r,":");case"OOOO":default:return"GMT"+jp(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Tz(r,":");case"zzzz":default:return"GMT"+jp(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return bs(r,t.length)},T:function(e,t,n){return bs(+e,t.length)}};function Tz(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+t+bs(i,2)}function Az(e,t){return e%60===0?(e>0?"-":"+")+bs(Math.abs(e)/60,2):jp(e,t)}function jp(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=bs(Math.trunc(r/60),2),i=bs(r%60,2);return n+s+t+i}const Rz=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},OZ=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},hAe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return Rz(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Rz(r,t)).replace("{{time}}",OZ(s,t))},pAe={p:OZ,P:hAe},mAe=/^D+$/,gAe=/^Y+$/,yAe=["D","DD","YY","YYYY"];function bAe(e){return mAe.test(e)}function vAe(e){return gAe.test(e)}function xAe(e,t,n){const r=wAe(e,t,n);if(console.warn(r),yAe.includes(e))throw new RangeError(r)}function wAe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const _Ae=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,SAe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,CAe=/^'([^]*?)'?$/,kAe=/''/g,EAe=/[a-zA-Z]/;function hw(e,t,n){var u,d,h,m,y,b,v,x;const r=Xy(),s=(n==null?void 0:n.locale)??r.locale??tT,i=(n==null?void 0:n.firstWeekContainsDate)??((d=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((b=(y=n==null?void 0:n.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??r.weekStartsOn??((x=(v=r.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,o=qr(e,n==null?void 0:n.in);if(!wTe(o))throw new RangeError("Invalid time value");let l=t.match(SAe).map(w=>{const S=w[0];if(S==="p"||S==="P"){const C=pAe[S];return C(w,s.formatLong)}return w}).join("").match(_Ae).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const S=w[0];if(S==="'")return{isToken:!1,value:TAe(w)};if(Ez[S])return{isToken:!0,value:w};if(S.match(EAe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return l.map(w=>{if(!w.isToken)return w.value;const S=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&vAe(S)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&bAe(S))&&xAe(S,t,String(e));const C=Ez[S[0]];return C(o,S,s.localize,c)}).join("")}function TAe(e){const t=e.match(CAe);return t?t[1].replace(kAe,"'"):e}function AAe(e,t,n){const r=Xy(),s=(n==null?void 0:n.locale)??r.locale??tT,i=2520,a=T2(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[l,c]=Kh(n==null?void 0:n.in,...a>0?[t,e]:[e,t]),u=TTe(c,l),d=(ZC(c)-ZC(l))/1e3,h=Math.round((u-d)/60);let m;if(h<2)return n!=null&&n.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,o):u<10?s.formatDistance("lessThanXSeconds",10,o):u<20?s.formatDistance("lessThanXSeconds",20,o):u<40?s.formatDistance("halfAMinute",0,o):u<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):h===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",h,o);if(h<45)return s.formatDistance("xMinutes",h,o);if(h<90)return s.formatDistance("aboutXHours",1,o);if(h<Cz){const y=Math.round(h/60);return s.formatDistance("aboutXHours",y,o)}else{if(h<i)return s.formatDistance("xDays",1,o);if(h<DS){const y=Math.round(h/Cz);return s.formatDistance("xDays",y,o)}else if(h<DS*2)return m=Math.round(h/DS),s.formatDistance("aboutXMonths",m,o)}if(m=ETe(c,l),m<12){const y=Math.round(h/DS);return s.formatDistance("xMonths",y,o)}else{const y=m%12,b=Math.trunc(m/12);return y<3?s.formatDistance("aboutXYears",b,o):y<9?s.formatDistance("overXYears",b,o):s.formatDistance("almostXYears",b+1,o)}}function PZ(e,t){return AAe(e,vTe(e),t)}function RAe(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=n.getMonth(),i=yi(n,0);return i.setFullYear(r,s+1,0),i.setHours(0,0,0,0),i.getDate()}function NAe(e,t){return qr(e,t==null?void 0:t.in).getMonth()}function MAe(e,t){return qr(e,t==null?void 0:t.in).getFullYear()}function IAe(e,t){return+qr(e)>+qr(t)}function jAe(e,t){return+qr(e)<+qr(t)}function OAe(e,t,n){const[r,s]=Kh(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function PAe(e,t,n){const[r,s]=Kh(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()}function DAe(e,t){const n=()=>yi(t==null?void 0:t.in,NaN),s=$Ae(e);let i;if(s.date){const c=zAe(s.date,2);i=UAe(c.restDateString,c.year)}if(!i||isNaN(+i))return n();const a=+i;let o=0,l;if(s.time&&(o=qAe(s.time),isNaN(o)))return n();if(s.timezone){if(l=VAe(s.timezone),isNaN(l))return n()}else{const c=new Date(a+o),u=qr(0,t==null?void 0:t.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return qr(a+o+l,t==null?void 0:t.in)}const FS={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},FAe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,LAe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,BAe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function $Ae(e){const t={},n=e.split(FS.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],FS.timeZoneDelimiter.test(t.date)&&(t.date=e.split(FS.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const s=FS.timezone.exec(r);s?(t.time=r.replace(s[1],""),t.timezone=s[1]):t.time=r}return t}function zAe(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:e.slice((r[1]||r[2]).length)}}function UAe(e,t){if(t===null)return new Date(NaN);const n=e.match(FAe);if(!n)return new Date(NaN);const r=!!n[4],s=Rv(n[1]),i=Rv(n[2])-1,a=Rv(n[3]),o=Rv(n[4]),l=Rv(n[5])-1;if(r)return YAe(t,o,l)?WAe(t,o,l):new Date(NaN);{const c=new Date(0);return!GAe(t,i,a)||!KAe(t,s)?new Date(NaN):(c.setUTCFullYear(t,i,Math.max(s,a)),c)}}function Rv(e){return e?parseInt(e):1}function qAe(e){const t=e.match(LAe);if(!t)return NaN;const n=iI(t[1]),r=iI(t[2]),s=iI(t[3]);return ZAe(n,r,s)?n*wZ+r*xZ+s*1e3:NaN}function iI(e){return e&&parseFloat(e.replace(",","."))||0}function VAe(e){if(e==="Z")return 0;const t=e.match(BAe);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return XAe(r,s)?n*(r*wZ+s*xZ):NaN}function WAe(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const s=r.getUTCDay()||7,i=(t-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const HAe=[31,null,31,30,31,30,31,31,30,31,30,31];function DZ(e){return e%400===0||e%4===0&&e%100!==0}function GAe(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(HAe[t]||(DZ(e)?29:28))}function KAe(e,t){return t>=1&&t<=(DZ(e)?366:365)}function YAe(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function ZAe(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function XAe(e,t){return t>=0&&t<=59}function JAe(e,t,n){const r=qr(e,n==null?void 0:n.in),s=r.getFullYear(),i=r.getDate(),a=yi(e,0);a.setFullYear(s,t,15),a.setHours(0,0,0,0);const o=RAe(a);return r.setMonth(t,Math.min(i,o)),r}function QAe(e,t,n){const r=qr(e,n==null?void 0:n.in);return isNaN(+r)?yi(e,NaN):(r.setFullYear(t),r)}const On=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:s,disabled:i,variant:a="ghost",size:o="icon",className:l,"aria-label":c,...u})=>{const d=typeof t=="function";return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:a,size:o,onClick:s,disabled:i,className:Ze("h-6 w-6",l),"aria-label":c??e,...u,children:d?f.jsx(t,{className:Ze("h-3.5 w-3.5",n)}):t})}),f.jsx(Sr,{side:r,children:f.jsx("p",{children:e})})]})})},Nz={};function eRe(e){let t=Nz[e];if(t)return t;t=Nz[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function dy(e,t){typeof t!="string"&&(t=dy.defaultChars);const n=eRe(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let s="";for(let i=0,a=r.length;i<a;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){s+=n[o];continue}if((o&224)===192&&i+3<a){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const c=o<<6&1984|l&63;c<128?s+="":s+=String.fromCharCode(c),i+=3;continue}}if((o&240)===224&&i+6<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(c&192)===128){const u=o<<12&61440|l<<6&4032|c&63;u<2048||u>=55296&&u<=57343?s+="":s+=String.fromCharCode(u),i+=6;continue}}if((o&248)===240&&i+9<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16),u=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(c&192)===128&&(u&192)===128){let d=o<<18&1835008|l<<12&258048|c<<6&4032|u&63;d<65536||d>1114111?s+="":(d-=65536,s+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),i+=9;continue}}s+=""}return s})}dy.defaultChars=";/?:@&=+$,#";dy.componentChars="";const Mz={};function tRe(e){let t=Mz[e];if(t)return t;t=Mz[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function D1(e,t,n){typeof t!="string"&&(n=t,t=D1.defaultChars),typeof n>"u"&&(n=!0);const r=tRe(t);let s="";for(let i=0,a=e.length;i<a;i++){const o=e.charCodeAt(i);if(n&&o===37&&i+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3))){s+=e.slice(i,i+3),i+=2;continue}if(o<128){s+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<a){const l=e.charCodeAt(i+1);if(l>=56320&&l<=57343){s+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}s+="%EF%BF%BD";continue}s+=encodeURIComponent(e[i])}return s}D1.defaultChars=";/?:@&=+$,-_.!~*'()#";D1.componentChars="-_.!~*'()";function uD(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function XC(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const nRe=/^([a-z0-9.+-]+:)/i,rRe=/:[0-9]*$/,sRe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,iRe=["<",">",'"',"`"," ","\r",`
`,"	"],aRe=["{","}","|","\\","^","`"].concat(iRe),oRe=["'"].concat(aRe),Iz=["%","/","?",";","#"].concat(oRe),jz=["/","?","#"],lRe=255,Oz=/^[+a-z0-9A-Z_-]{0,63}$/,cRe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Pz={javascript:!0,"javascript:":!0},Dz={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function dD(e,t){if(e&&e instanceof XC)return e;const n=new XC;return n.parse(e,t),n}XC.prototype.parse=function(e,t){let n,r,s,i=e;if(i=i.trim(),!t&&e.split("#").length===1){const c=sRe.exec(i);if(c)return this.pathname=c[1],c[2]&&(this.search=c[2]),this}let a=nRe.exec(i);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,i=i.substr(a.length)),(t||a||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=i.substr(0,2)==="//",s&&!(a&&Pz[a])&&(i=i.substr(2),this.slashes=!0)),!Pz[a]&&(s||a&&!Dz[a])){let c=-1;for(let y=0;y<jz.length;y++)r=i.indexOf(jz[y]),r!==-1&&(c===-1||r<c)&&(c=r);let u,d;c===-1?d=i.lastIndexOf("@"):d=i.lastIndexOf("@",c),d!==-1&&(u=i.slice(0,d),i=i.slice(d+1),this.auth=u),c=-1;for(let y=0;y<Iz.length;y++)r=i.indexOf(Iz[y]),r!==-1&&(c===-1||r<c)&&(c=r);c===-1&&(c=i.length),i[c-1]===":"&&c--;const h=i.slice(0,c);i=i.slice(c),this.parseHost(h),this.hostname=this.hostname||"";const m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){const y=this.hostname.split(/\./);for(let b=0,v=y.length;b<v;b++){const x=y[b];if(x&&!x.match(Oz)){let w="";for(let S=0,C=x.length;S<C;S++)x.charCodeAt(S)>127?w+="x":w+=x[S];if(!w.match(Oz)){const S=y.slice(0,b),C=y.slice(b+1),k=x.match(cRe);k&&(S.push(k[1]),C.unshift(k[2])),C.length&&(i=C.join(".")+i),this.hostname=S.join(".");break}}}}this.hostname.length>lRe&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),Dz[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};XC.prototype.parseHost=function(e){let t=rRe.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const uRe=Object.freeze(Object.defineProperty({__proto__:null,decode:dy,encode:D1,format:uD,parse:dD},Symbol.toStringTag,{value:"Module"})),FZ=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,LZ=/[\0-\x1F\x7F-\x9F]/,dRe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,fD=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,BZ=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,$Z=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,fRe=Object.freeze(Object.defineProperty({__proto__:null,Any:FZ,Cc:LZ,Cf:dRe,P:fD,S:BZ,Z:$Z},Symbol.toStringTag,{value:"Module"})),hRe=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),pRe=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var aI;const mRe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),gRe=(aI=String.fromCodePoint)!==null&&aI!==void 0?aI:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function yRe(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=mRe.get(e))!==null&&t!==void 0?t:e}var sa;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(sa||(sa={}));const bRe=32;var lh;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(lh||(lh={}));function Rj(e){return e>=sa.ZERO&&e<=sa.NINE}function vRe(e){return e>=sa.UPPER_A&&e<=sa.UPPER_F||e>=sa.LOWER_A&&e<=sa.LOWER_F}function xRe(e){return e>=sa.UPPER_A&&e<=sa.UPPER_Z||e>=sa.LOWER_A&&e<=sa.LOWER_Z||Rj(e)}function wRe(e){return e===sa.EQUALS||xRe(e)}var Ji;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(Ji||(Ji={}));var ih;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(ih||(ih={}));class _Re{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=Ji.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=ih.Strict}startEntity(t){this.decodeMode=t,this.state=Ji.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case Ji.EntityStart:return t.charCodeAt(n)===sa.NUM?(this.state=Ji.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=Ji.NamedEntity,this.stateNamedEntity(t,n));case Ji.NumericStart:return this.stateNumericStart(t,n);case Ji.NumericDecimal:return this.stateNumericDecimal(t,n);case Ji.NumericHex:return this.stateNumericHex(t,n);case Ji.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|bRe)===sa.LOWER_X?(this.state=Ji.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=Ji.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(n,i),s),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Rj(s)||vRe(s))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Rj(s))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===sa.SEMI)this.consumed+=1;else if(this.decodeMode===ih.Strict)return 0;return this.emitCodePoint(yRe(this.result),this.consumed),this.errors&&(t!==sa.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&lh.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const a=t.charCodeAt(n);if(this.treeIndex=SRe(r,s,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return this.result===0||this.decodeMode===ih.Attribute&&(i===0||wRe(a))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&lh.VALUE_LENGTH)>>14,i!==0){if(a===sa.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==ih.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,s=(r[n]&lh.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[t]&~lh.VALUE_LENGTH:s[t+1],r),n===3&&this.emitCodePoint(s[t+2],r),r}end(){var t;switch(this.state){case Ji.NamedEntity:return this.result!==0&&(this.decodeMode!==ih.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Ji.NumericDecimal:return this.emitNumericEntity(0,2);case Ji.NumericHex:return this.emitNumericEntity(0,3);case Ji.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Ji.EntityStart:return 0}}}function zZ(e){let t="";const n=new _Re(e,r=>t+=gRe(r));return function(s,i){let a=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(a,o),n.startEntity(i);const c=n.write(s,o+1);if(c<0){a=o+n.end();break}a=o+c,o=c===0?a+1:a}const l=t+s.slice(a);return t="",l}}function SRe(e,t,n,r){const s=(t&lh.BRANCH_LENGTH)>>7,i=t&lh.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=s?-1:e[n+l]-1}let a=n,o=a+s-1;for(;a<=o;){const l=a+o>>>1,c=e[l];if(c<r)a=l+1;else if(c>r)o=l-1;else return e[l+s]}return-1}const CRe=zZ(hRe);zZ(pRe);function UZ(e,t=ih.Legacy){return CRe(e,t)}function kRe(e){return Object.prototype.toString.call(e)}function hD(e){return kRe(e)==="[object String]"}const ERe=Object.prototype.hasOwnProperty;function TRe(e,t){return ERe.call(e,t)}function nT(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function qZ(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function pD(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function JC(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const VZ=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,ARe=/&([a-z#][a-z0-9]{1,31});/gi,RRe=new RegExp(VZ.source+"|"+ARe.source,"gi"),NRe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function MRe(e,t){if(t.charCodeAt(0)===35&&NRe.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return pD(r)?JC(r):e}const n=UZ(e);return n!==e?n:e}function IRe(e){return e.indexOf("\\")<0?e:e.replace(VZ,"$1")}function fy(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(RRe,function(t,n,r){return n||MRe(t,r)})}const jRe=/[&<>"]/,ORe=/[&<>"]/g,PRe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function DRe(e){return PRe[e]}function Eh(e){return jRe.test(e)?e.replace(ORe,DRe):e}const FRe=/[.?*+^$[\]\\(){}|-]/g;function LRe(e){return e.replace(FRe,"\\$&")}function Ps(e){switch(e){case 9:case 32:return!0}return!1}function pw(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function mw(e){return fD.test(e)||BZ.test(e)}function gw(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function rT(e){return e=e.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(e=e.replace(//g,"")),e.toLowerCase().toUpperCase()}const BRe={mdurl:uRe,ucmicro:fRe},$Re=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:qZ,assign:nT,escapeHtml:Eh,escapeRE:LRe,fromCodePoint:JC,has:TRe,isMdAsciiPunct:gw,isPunctChar:mw,isSpace:Ps,isString:hD,isValidEntityCode:pD,isWhiteSpace:pw,lib:BRe,normalizeReference:rT,unescapeAll:fy,unescapeMd:IRe},Symbol.toStringTag,{value:"Module"}));function zRe(e,t,n){let r,s,i,a;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(i=e.src.charCodeAt(e.pos),i===93&&(r--,r===0)){s=!0;break}if(a=e.pos,e.md.inline.skipToken(e),i===91){if(a===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return s&&(c=e.pos),e.pos=l,c}function URe(e,t,n){let r,s=t;const i={ok:!1,pos:0,str:""};if(e.charCodeAt(s)===60){for(s++;s<n;){if(r=e.charCodeAt(s),r===10||r===60)return i;if(r===62)return i.pos=s+1,i.str=fy(e.slice(t+1,s)),i.ok=!0,i;if(r===92&&s+1<n){s+=2;continue}s++}return i}let a=0;for(;s<n&&(r=e.charCodeAt(s),!(r===32||r<32||r===127));){if(r===92&&s+1<n){if(e.charCodeAt(s+1)===32)break;s+=2;continue}if(r===40&&(a++,a>32))return i;if(r===41){if(a===0)break;a--}s++}return t===s||a!==0||(i.str=fy(e.slice(t,s)),i.pos=s,i.ok=!0),i}function qRe(e,t,n,r){let s,i=t;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(i>=n)return a;let o=e.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return a;t++,i++,o===40&&(o=41),a.marker=o}for(;i<n;){if(s=e.charCodeAt(i),s===a.marker)return a.pos=i+1,a.str+=fy(e.slice(t,i)),a.ok=!0,a;if(s===40&&a.marker===41)return a;s===92&&i+1<n&&i++,i++}return a.can_continue=!0,a.str+=fy(e.slice(t,i)),a}const VRe=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:URe,parseLinkLabel:zRe,parseLinkTitle:qRe},Symbol.toStringTag,{value:"Module"})),ju={};ju.code_inline=function(e,t,n,r,s){const i=e[t];return"<code"+s.renderAttrs(i)+">"+Eh(i.content)+"</code>"};ju.code_block=function(e,t,n,r,s){const i=e[t];return"<pre"+s.renderAttrs(i)+"><code>"+Eh(e[t].content)+`</code></pre>
`};ju.fence=function(e,t,n,r,s){const i=e[t],a=i.info?fy(i.info).trim():"";let o="",l="";if(a){const u=a.split(/(\s+)/g);o=u[0],l=u.slice(2).join("")}let c;if(n.highlight?c=n.highlight(i.content,o,l)||Eh(i.content):c=Eh(i.content),c.indexOf("<pre")===0)return c+`
`;if(a){const u=i.attrIndex("class"),d=i.attrs?i.attrs.slice():[];u<0?d.push(["class",n.langPrefix+o]):(d[u]=d[u].slice(),d[u][1]+=" "+n.langPrefix+o);const h={attrs:d};return`<pre><code${s.renderAttrs(h)}>${c}</code></pre>
`}return`<pre><code${s.renderAttrs(i)}>${c}</code></pre>
`};ju.image=function(e,t,n,r,s){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=s.renderInlineAsText(i.children,n,r),s.renderToken(e,t,n)};ju.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};ju.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};ju.text=function(e,t){return Eh(e[t].content)};ju.html_block=function(e,t){return e[t].content};ju.html_inline=function(e,t){return e[t].content};function Jy(){this.rules=nT({},ju)}Jy.prototype.renderAttrs=function(t){let n,r,s;if(!t.attrs)return"";for(s="",n=0,r=t.attrs.length;n<r;n++)s+=" "+Eh(t.attrs[n][0])+'="'+Eh(t.attrs[n][1])+'"';return s};Jy.prototype.renderToken=function(t,n,r){const s=t[n];let i="";if(s.hidden)return"";s.block&&s.nesting!==-1&&n&&t[n-1].hidden&&(i+=`
`),i+=(s.nesting===-1?"</":"<")+s.tag,i+=this.renderAttrs(s),s.nesting===0&&r.xhtmlOut&&(i+=" /");let a=!1;if(s.block&&(a=!0,s.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===s.tag)&&(a=!1)}return i+=a?`>
`:">",i};Jy.prototype.renderInline=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r};Jy.prototype.renderInlineAsText=function(e,t,n){let r="";for(let s=0,i=e.length;s<i;s++)switch(e[s].type){case"text":r+=e[s].content;break;case"image":r+=this.renderInlineAsText(e[s].children,t,n);break;case"html_inline":case"html_block":r+=e[s].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};Jy.prototype.render=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;o==="inline"?r+=this.renderInline(e[i].children,t,n):typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r};function jo(){this.__rules__=[],this.__cache__=null}jo.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};jo.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};jo.prototype.at=function(e,t,n){const r=this.__find__(e),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=s.alt||[],this.__cache__=null};jo.prototype.before=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};jo.prototype.after=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};jo.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};jo.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!0,n.push(r)},this),this.__cache__=null,n};jo.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};jo.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!1,n.push(r)},this),this.__cache__=null,n};jo.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function jc(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}jc.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,s=n.length;r<s;r++)if(n[r][0]===t)return r;return-1};jc.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};jc.prototype.attrSet=function(t,n){const r=this.attrIndex(t),s=[t,n];r<0?this.attrPush(s):this.attrs[r]=s};jc.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};jc.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function WZ(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}WZ.prototype.Token=jc;const WRe=/\r\n?|\n/g,HRe=/\0/g;function GRe(e){let t;t=e.src.replace(WRe,`
`),t=t.replace(HRe,""),e.src=t}function KRe(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function YRe(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const s=t[n];s.type==="inline"&&e.md.inline.parse(s.content,e.md,e.env,s.children)}}function ZRe(e){return/^<a[>\s]/i.test(e)}function XRe(e){return/^<\/a\s*>/i.test(e)}function JRe(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let s=t[n].children,i=0;for(let a=s.length-1;a>=0;a--){const o=s[a];if(o.type==="link_close"){for(a--;s[a].level!==o.level&&s[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(ZRe(o.content)&&i>0&&i--,XRe(o.content)&&i++),!(i>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let c=e.md.linkify.match(l);const u=[];let d=o.level,h=0;c.length>0&&c[0].index===0&&a>0&&s[a-1].type==="text_special"&&(c=c.slice(1));for(let m=0;m<c.length;m++){const y=c[m].url,b=e.md.normalizeLink(y);if(!e.md.validateLink(b))continue;let v=c[m].text;c[m].schema?c[m].schema==="mailto:"&&!/^mailto:/i.test(v)?v=e.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=e.md.normalizeLinkText(v):v=e.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");const x=c[m].index;if(x>h){const k=new e.Token("text","",0);k.content=l.slice(h,x),k.level=d,u.push(k)}const w=new e.Token("link_open","a",1);w.attrs=[["href",b]],w.level=d++,w.markup="linkify",w.info="auto",u.push(w);const S=new e.Token("text","",0);S.content=v,S.level=d,u.push(S);const C=new e.Token("link_close","a",-1);C.level=--d,C.markup="linkify",C.info="auto",u.push(C),h=c[m].lastIndex}if(h<l.length){const m=new e.Token("text","",0);m.content=l.slice(h),m.level=d,u.push(m)}t[n].children=s=qZ(s,a,u)}}}}const HZ=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,QRe=/\((c|tm|r)\)/i,eNe=/\((c|tm|r)\)/ig,tNe={c:"",r:"",tm:""};function nNe(e,t){return tNe[t.toLowerCase()]}function rNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(eNe,nNe)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function sNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&HZ.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function iNe(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(QRe.test(e.tokens[t].content)&&rNe(e.tokens[t].children),HZ.test(e.tokens[t].content)&&sNe(e.tokens[t].children))}const aNe=/['"]/,Fz=/['"]/g,Lz="";function LS(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function oNe(e,t){let n;const r=[];for(let s=0;s<e.length;s++){const i=e[s],a=e[s].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,c=o.length;e:for(;l<c;){Fz.lastIndex=l;const u=Fz.exec(o);if(!u)break;let d=!0,h=!0;l=u.index+1;const m=u[0]==="'";let y=32;if(u.index-1>=0)y=o.charCodeAt(u.index-1);else for(n=s-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){y=e[n].content.charCodeAt(e[n].content.length-1);break}let b=32;if(l<c)b=o.charCodeAt(l);else for(n=s+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){b=e[n].content.charCodeAt(0);break}const v=gw(y)||mw(String.fromCharCode(y)),x=gw(b)||mw(String.fromCharCode(b)),w=pw(y),S=pw(b);if(S?d=!1:x&&(w||v||(d=!1)),w?h=!1:v&&(S||x||(h=!1)),b===34&&u[0]==='"'&&y>=48&&y<=57&&(h=d=!1),d&&h&&(d=v,h=x),!d&&!h){m&&(i.content=LS(i.content,u.index,Lz));continue}if(h)for(n=r.length-1;n>=0;n--){let C=r[n];if(r[n].level<a)break;if(C.single===m&&r[n].level===a){C=r[n];let k,A;m?(k=t.md.options.quotes[2],A=t.md.options.quotes[3]):(k=t.md.options.quotes[0],A=t.md.options.quotes[1]),i.content=LS(i.content,u.index,A),e[C.token].content=LS(e[C.token].content,C.pos,k),l+=A.length-1,C.token===s&&(l+=k.length-1),o=i.content,c=o.length,r.length=n;continue e}}d?r.push({token:s,pos:u.index,single:m,level:a}):h&&m&&(i.content=LS(i.content,u.index,Lz))}}}function lNe(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!aNe.test(e.tokens[t].content)||oNe(e.tokens[t].children,e)}function cNe(e){let t,n;const r=e.tokens,s=r.length;for(let i=0;i<s;i++){if(r[i].type!=="inline")continue;const a=r[i].children,o=a.length;for(t=0;t<o;t++)a[t].type==="text_special"&&(a[t].type="text");for(t=n=0;t<o;t++)a[t].type==="text"&&t+1<o&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}}const oI=[["normalize",GRe],["block",KRe],["inline",YRe],["linkify",JRe],["replacements",iNe],["smartquotes",lNe],["text_join",cNe]];function mD(){this.ruler=new jo;for(let e=0;e<oI.length;e++)this.ruler.push(oI[e][0],oI[e][1])}mD.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};mD.prototype.State=WZ;function Ou(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const s=this.src;for(let i=0,a=0,o=0,l=0,c=s.length,u=!1;a<c;a++){const d=s.charCodeAt(a);if(!u)if(Ps(d)){o++,d===9?l+=4-l%4:l++;continue}else u=!0;(d===10||a===c-1)&&(d!==10&&a++,this.bMarks.push(i),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),u=!1,o=0,l=0,i=a+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Ou.prototype.push=function(e,t,n){const r=new jc(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};Ou.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};Ou.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};Ou.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Ps(r))break}return t};Ou.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Ps(this.src.charCodeAt(--t)))return t+1;return t};Ou.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};Ou.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};Ou.prototype.getLines=function(t,n,r,s){if(t>=n)return"";const i=new Array(n-t);for(let a=0,o=t;o<n;o++,a++){let l=0;const c=this.bMarks[o];let u=c,d;for(o+1<n||s?d=this.eMarks[o]+1:d=this.eMarks[o];u<d&&l<r;){const h=this.src.charCodeAt(u);if(Ps(h))h===9?l+=4-(l+this.bsCount[o])%4:l++;else if(u-c<this.tShift[o])l++;else break;u++}l>r?i[a]=new Array(l-r+1).join(" ")+this.src.slice(u,d):i[a]=this.src.slice(u,d)}return i.join("")};Ou.prototype.Token=jc;const uNe=65536;function lI(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function Bz(e){const t=[],n=e.length;let r=0,s=e.charCodeAt(r),i=!1,a=0,o="";for(;r<n;)s===124&&(i?(o+=e.substring(a,r-1),a=r):(t.push(o+e.substring(a,r)),o="",a=r+1)),i=s===92,r++,s=e.charCodeAt(r);return t.push(o+e.substring(a)),t}function dNe(e,t,n,r){if(t+2>n)return!1;let s=t+1;if(e.sCount[s]<e.blkIndent||e.sCount[s]-e.blkIndent>=4)return!1;let i=e.bMarks[s]+e.tShift[s];if(i>=e.eMarks[s])return!1;const a=e.src.charCodeAt(i++);if(a!==124&&a!==45&&a!==58||i>=e.eMarks[s])return!1;const o=e.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!Ps(o)||a===45&&Ps(o))return!1;for(;i<e.eMarks[s];){const C=e.src.charCodeAt(i);if(C!==124&&C!==45&&C!==58&&!Ps(C))return!1;i++}let l=lI(e,t+1),c=l.split("|");const u=[];for(let C=0;C<c.length;C++){const k=c[C].trim();if(!k){if(C===0||C===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(k))return!1;k.charCodeAt(k.length-1)===58?u.push(k.charCodeAt(0)===58?"center":"right"):k.charCodeAt(0)===58?u.push("left"):u.push("")}if(l=lI(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;c=Bz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop();const d=c.length;if(d===0||d!==u.length)return!1;if(r)return!0;const h=e.parentType;e.parentType="table";const m=e.md.block.ruler.getRules("blockquote"),y=e.push("table_open","table",1),b=[t,0];y.map=b;const v=e.push("thead_open","thead",1);v.map=[t,t+1];const x=e.push("tr_open","tr",1);x.map=[t,t+1];for(let C=0;C<c.length;C++){const k=e.push("th_open","th",1);u[C]&&(k.attrs=[["style","text-align:"+u[C]]]);const A=e.push("inline","",0);A.content=c[C].trim(),A.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let w,S=0;for(s=t+2;s<n&&!(e.sCount[s]<e.blkIndent);s++){let C=!1;for(let A=0,R=m.length;A<R;A++)if(m[A](e,s,n,!0)){C=!0;break}if(C||(l=lI(e,s).trim(),!l)||e.sCount[s]-e.blkIndent>=4||(c=Bz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop(),S+=d-c.length,S>uNe))break;if(s===t+2){const A=e.push("tbody_open","tbody",1);A.map=w=[t+2,0]}const k=e.push("tr_open","tr",1);k.map=[s,s+1];for(let A=0;A<d;A++){const R=e.push("td_open","td",1);u[A]&&(R.attrs=[["style","text-align:"+u[A]]]);const N=e.push("inline","",0);N.content=c[A]?c[A].trim():"",N.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return w&&(e.push("tbody_close","tbody",-1),w[1]=s),e.push("table_close","table",-1),b[1]=s,e.parentType=h,e.line=s,!0}function fNe(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,s=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,s=r;continue}break}e.line=s;const i=e.push("code_block","code",0);return i.content=e.getLines(t,s,4+e.blkIndent,!1)+`
`,i.map=[t,e.line],!0}function hNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||s+3>i)return!1;const a=e.src.charCodeAt(s);if(a!==126&&a!==96)return!1;let o=s;s=e.skipChars(s,a);let l=s-o;if(l<3)return!1;const c=e.src.slice(o,s),u=e.src.slice(s,i);if(a===96&&u.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let d=t,h=!1;for(;d++,!(d>=n||(s=o=e.bMarks[d]+e.tShift[d],i=e.eMarks[d],s<i&&e.sCount[d]<e.blkIndent));)if(e.src.charCodeAt(s)===a&&!(e.sCount[d]-e.blkIndent>=4)&&(s=e.skipChars(s,a),!(s-o<l)&&(s=e.skipSpaces(s),!(s<i)))){h=!0;break}l=e.sCount[t],e.line=d+(h?1:0);const m=e.push("fence","code",0);return m.info=u,m.content=e.getLines(t+1,d,l,!0),m.markup=c,m.map=[t,e.line],!0}function pNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const a=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==62)return!1;if(r)return!0;const o=[],l=[],c=[],u=[],d=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let m=!1,y;for(y=t;y<n;y++){const S=e.sCount[y]<e.blkIndent;if(s=e.bMarks[y]+e.tShift[y],i=e.eMarks[y],s>=i)break;if(e.src.charCodeAt(s++)===62&&!S){let k=e.sCount[y]+1,A,R;e.src.charCodeAt(s)===32?(s++,k++,R=!1,A=!0):e.src.charCodeAt(s)===9?(A=!0,(e.bsCount[y]+k)%4===3?(s++,k++,R=!1):R=!0):A=!1;let N=k;for(o.push(e.bMarks[y]),e.bMarks[y]=s;s<i;){const I=e.src.charCodeAt(s);if(Ps(I))I===9?N+=4-(N+e.bsCount[y]+(R?1:0))%4:N++;else break;s++}m=s>=i,l.push(e.bsCount[y]),e.bsCount[y]=e.sCount[y]+1+(A?1:0),c.push(e.sCount[y]),e.sCount[y]=N-k,u.push(e.tShift[y]),e.tShift[y]=s-e.bMarks[y];continue}if(m)break;let C=!1;for(let k=0,A=d.length;k<A;k++)if(d[k](e,y,n,!0)){C=!0;break}if(C){e.lineMax=y,e.blkIndent!==0&&(o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]-=e.blkIndent);break}o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]=-1}const b=e.blkIndent;e.blkIndent=0;const v=e.push("blockquote_open","blockquote",1);v.markup=">";const x=[t,0];v.map=x,e.md.block.tokenize(e,t,y);const w=e.push("blockquote_close","blockquote",-1);w.markup=">",e.lineMax=a,e.parentType=h,x[1]=e.line;for(let S=0;S<u.length;S++)e.bMarks[S+t]=o[S],e.tShift[S+t]=u[S],e.sCount[S+t]=c[S],e.bsCount[S+t]=l[S];return e.blkIndent=b,!0}function mNe(e,t,n,r){const s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(i++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;i<s;){const c=e.src.charCodeAt(i++);if(c!==a&&!Ps(c))return!1;c===a&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function $z(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(r++);if(s!==42&&s!==45&&s!==43)return-1;if(r<n){const i=e.src.charCodeAt(r);if(!Ps(i))return-1}return r}function zz(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let s=n;if(s+1>=r)return-1;let i=e.src.charCodeAt(s++);if(i<48||i>57)return-1;for(;;){if(s>=r)return-1;if(i=e.src.charCodeAt(s++),i>=48&&i<=57){if(s-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return s<r&&(i=e.src.charCodeAt(s),!Ps(i))?-1:s}function gNe(e,t){const n=e.level+2;for(let r=t+2,s=e.tokens.length-2;r<s;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function yNe(e,t,n,r){let s,i,a,o,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(u=!0);let d,h,m;if((m=zz(e,l))>=0){if(d=!0,a=e.bMarks[l]+e.tShift[l],h=Number(e.src.slice(a,m-1)),u&&h!==1)return!1}else if((m=$z(e,l))>=0)d=!1;else return!1;if(u&&e.skipSpaces(m)>=e.eMarks[l])return!1;if(r)return!0;const y=e.src.charCodeAt(m-1),b=e.tokens.length;d?(o=e.push("ordered_list_open","ol",1),h!==1&&(o.attrs=[["start",h]])):o=e.push("bullet_list_open","ul",1);const v=[l,0];o.map=v,o.markup=String.fromCharCode(y);let x=!1;const w=e.md.block.ruler.getRules("list"),S=e.parentType;for(e.parentType="list";l<n;){i=m,s=e.eMarks[l];const C=e.sCount[l]+m-(e.bMarks[l]+e.tShift[l]);let k=C;for(;i<s;){const X=e.src.charCodeAt(i);if(X===9)k+=4-(k+e.bsCount[l])%4;else if(X===32)k++;else break;i++}const A=i;let R;A>=s?R=1:R=k-C,R>4&&(R=1);const N=C+R;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(y);const I=[l,0];o.map=I,d&&(o.info=e.src.slice(a,m-1));const O=e.tight,L=e.tShift[l],P=e.sCount[l],V=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=N,e.tight=!0,e.tShift[l]=A-e.bMarks[l],e.sCount[l]=k,A>=s&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||x)&&(c=!1),x=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=V,e.tShift[l]=L,e.sCount[l]=P,e.tight=O,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(y),l=e.line,I[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let F=!1;for(let X=0,U=w.length;X<U;X++)if(w[X](e,l,n,!0)){F=!0;break}if(F)break;if(d){if(m=zz(e,l),m<0)break;a=e.bMarks[l]+e.tShift[l]}else if(m=$z(e,l),m<0)break;if(y!==e.src.charCodeAt(m-1))break}return d?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(y),v[1]=l,e.line=l,e.parentType=S,c&&gNe(e,b),!0}function bNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==91)return!1;function o(w){const S=e.lineMax;if(w>=S||e.isEmpty(w))return null;let C=!1;if(e.sCount[w]-e.blkIndent>3&&(C=!0),e.sCount[w]<0&&(C=!0),!C){const R=e.md.block.ruler.getRules("reference"),N=e.parentType;e.parentType="reference";let I=!1;for(let O=0,L=R.length;O<L;O++)if(R[O](e,w,S,!0)){I=!0;break}if(e.parentType=N,I)return null}const k=e.bMarks[w]+e.tShift[w],A=e.eMarks[w];return e.src.slice(k,A+1)}let l=e.src.slice(s,i+1);i=l.length;let c=-1;for(s=1;s<i;s++){const w=l.charCodeAt(s);if(w===91)return!1;if(w===93){c=s;break}else if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(w===92&&(s++,s<i&&l.charCodeAt(s)===10)){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}}if(c<0||l.charCodeAt(c+1)!==58)return!1;for(s=c+2;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Ps(w))break}const u=e.md.helpers.parseLinkDestination(l,s,i);if(!u.ok)return!1;const d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;s=u.pos;const h=s,m=a,y=s;for(;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Ps(w))break}let b=e.md.helpers.parseLinkTitle(l,s,i);for(;b.can_continue;){const w=o(a);if(w===null)break;l+=w,s=i,i=l.length,a++,b=e.md.helpers.parseLinkTitle(l,s,i,b)}let v;for(s<i&&y!==s&&b.ok?(v=b.str,s=b.pos):(v="",s=h,a=m);s<i;){const w=l.charCodeAt(s);if(!Ps(w))break;s++}if(s<i&&l.charCodeAt(s)!==10&&v)for(v="",s=h,a=m;s<i;){const w=l.charCodeAt(s);if(!Ps(w))break;s++}if(s<i&&l.charCodeAt(s)!==10)return!1;const x=rT(l.slice(1,c));return x?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[x]>"u"&&(e.env.references[x]={title:v,href:d}),e.line=a),!0):!1}const vNe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],xNe="[a-zA-Z_:][a-zA-Z0-9:._-]*",wNe="[^\"'=<>`\\x00-\\x20]+",_Ne="'[^']*'",SNe='"[^"]*"',CNe="(?:"+wNe+"|"+_Ne+"|"+SNe+")",kNe="(?:\\s+"+xNe+"(?:\\s*=\\s*"+CNe+")?)",GZ="<[A-Za-z][A-Za-z0-9\\-]*"+kNe+"*\\s*\\/?>",KZ="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",ENe="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",TNe="<[?][\\s\\S]*?[?]>",ANe="<![A-Za-z][^>]*>",RNe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",NNe=new RegExp("^(?:"+GZ+"|"+KZ+"|"+ENe+"|"+TNe+"|"+ANe+"|"+RNe+")"),MNe=new RegExp("^(?:"+GZ+"|"+KZ+")"),Yg=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+vNe.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(MNe.source+"\\s*$"),/^$/,!1]];function INe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(s)!==60)return!1;let a=e.src.slice(s,i),o=0;for(;o<Yg.length&&!Yg[o][0].test(a);o++);if(o===Yg.length)return!1;if(r)return Yg[o][2];let l=t+1;if(!Yg[o][1].test(a)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(s=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],a=e.src.slice(s,i),Yg[o][1].test(a)){a.length!==0&&l++;break}}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0}function jNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let a=e.src.charCodeAt(s);if(a!==35||s>=i)return!1;let o=1;for(a=e.src.charCodeAt(++s);a===35&&s<i&&o<=6;)o++,a=e.src.charCodeAt(++s);if(o>6||s<i&&!Ps(a))return!1;if(r)return!0;i=e.skipSpacesBack(i,s);const l=e.skipCharsBack(i,35,s);l>s&&Ps(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const c=e.push("heading_open","h"+String(o),1);c.markup="########".slice(0,o),c.map=[t,e.line];const u=e.push("inline","",0);u.content=e.src.slice(s,i).trim(),u.map=[t,e.line],u.children=[];const d=e.push("heading_close","h"+String(o),-1);return d.markup="########".slice(0,o),!0}function ONe(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const s=e.parentType;e.parentType="paragraph";let i=0,a,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let m=e.bMarks[o]+e.tShift[o];const y=e.eMarks[o];if(m<y&&(a=e.src.charCodeAt(m),(a===45||a===61)&&(m=e.skipChars(m,a),m=e.skipSpaces(m),m>=y))){i=a===61?1:2;break}}if(e.sCount[o]<0)continue;let h=!1;for(let m=0,y=r.length;m<y;m++)if(r[m](e,o,n,!0)){h=!0;break}if(h)break}if(!i)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const c=e.push("heading_open","h"+String(i),1);c.markup=String.fromCharCode(a),c.map=[t,e.line];const u=e.push("inline","",0);u.content=l,u.map=[t,e.line-1],u.children=[];const d=e.push("heading_close","h"+String(i),-1);return d.markup=String.fromCharCode(a),e.parentType=s,!0}function PNe(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),s=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3||e.sCount[i]<0)continue;let c=!1;for(let u=0,d=r.length;u<d;u++)if(r[u](e,i,n,!0)){c=!0;break}if(c)break}const a=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=a,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=s,!0}const BS=[["table",dNe,["paragraph","reference"]],["code",fNe],["fence",hNe,["paragraph","reference","blockquote","list"]],["blockquote",pNe,["paragraph","reference","blockquote","list"]],["hr",mNe,["paragraph","reference","blockquote","list"]],["list",yNe,["paragraph","reference","blockquote"]],["reference",bNe],["html_block",INe,["paragraph","reference","blockquote"]],["heading",jNe,["paragraph","reference","blockquote"]],["lheading",ONe],["paragraph",PNe]];function sT(){this.ruler=new jo;for(let e=0;e<BS.length;e++)this.ruler.push(BS[e][0],BS[e][1],{alt:(BS[e][2]||[]).slice()})}sT.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),s=r.length,i=e.md.options.maxNesting;let a=t,o=!1;for(;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n||e.sCount[a]<e.blkIndent));){if(e.level>=i){e.line=n;break}const l=e.line;let c=!1;for(let u=0;u<s;u++)if(c=r[u](e,a,n,!1),c){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!c)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),a=e.line,a<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}};sT.prototype.parse=function(e,t,n,r){if(!e)return;const s=new this.State(e,t,n,r);this.tokenize(s,s.line,s.lineMax)};sT.prototype.State=Ou;function F1(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}F1.prototype.pushPending=function(){const e=new jc("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};F1.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new jc(e,t,n);let s=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(s),r};F1.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),s=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const a=i-e,o=i<n?this.src.charCodeAt(i):32,l=gw(s)||mw(String.fromCharCode(s)),c=gw(o)||mw(String.fromCharCode(o)),u=pw(s),d=pw(o),h=!d&&(!c||u||l),m=!u&&(!l||d||c);return{can_open:h&&(t||!m||l),can_close:m&&(t||!h||c),length:a}};F1.prototype.Token=jc;function DNe(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function FNe(e,t){let n=e.pos;for(;n<e.posMax&&!DNe(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const LNe=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function BNe(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const s=e.pending.match(LNe);if(!s)return!1;const i=s[1],a=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!a)return!1;let o=a.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);const c=e.push("link_open","a",1);c.attrs=[["href",l]],c.markup="linkify",c.info="auto";const u=e.push("text","",0);u.content=e.md.normalizeLinkText(o);const d=e.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return e.pos+=o.length-i.length,!0}function $Ne(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,s=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&e.pending.charCodeAt(i-1)===32;)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<s&&Ps(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const gD=[];for(let e=0;e<256;e++)gD.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){gD[e.charCodeAt(0)]=1});function zNe(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let s=e.src.charCodeAt(n);if(s===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(s=e.src.charCodeAt(n),!!Ps(s));)n++;return e.pos=n,!0}let i=e.src[n];if(s>=55296&&s<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=e.src[n+1],n++)}const a="\\"+i;if(!t){const o=e.push("text_special","",0);s<256&&gD[s]!==0?o.content=i:o.content=a,o.markup=a,o.info="escape"}return e.pos=n+1,!0}function UNe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const s=n;n++;const i=e.posMax;for(;n<i&&e.src.charCodeAt(n)===96;)n++;const a=e.src.slice(s,n),o=a.length;if(e.backticksScanned&&(e.backticks[o]||0)<=s)return t||(e.pending+=a),e.pos+=o,!0;let l=n,c;for(;(c=e.src.indexOf("`",l))!==-1;){for(l=c+1;l<i&&e.src.charCodeAt(l)===96;)l++;const u=l-c;if(u===o){if(!t){const d=e.push("code_inline","code",0);d.markup=a,d.content=e.src.slice(n,c).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[u]=c}return e.backticksScanned=!0,t||(e.pending+=a),e.pos+=o,!0}function qNe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const s=e.scanDelims(e.pos,!0);let i=s.length;const a=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=e.push("text","",0),o.content=a,i--);for(let l=0;l<i;l+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close});return e.pos+=s.length,!0}function Uz(e,t){let n;const r=[],s=t.length;for(let i=0;i<s;i++){const a=t[i];if(a.marker!==126||a.end===-1)continue;const o=t[a.end];n=e.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let a=i+1;for(;a<e.tokens.length&&e.tokens[a].type==="s_close";)a++;a--,i!==a&&(n=e.tokens[a],e.tokens[a]=e.tokens[i],e.tokens[i]=n)}}function VNe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Uz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Uz(e,t[r].delimiters)}const YZ={tokenize:qNe,postProcess:VNe};function WNe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const s=e.scanDelims(e.pos,r===42);for(let i=0;i<s.length;i++){const a=e.push("text","",0);a.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:s.length,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close})}return e.pos+=s.length,!0}function qz(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s.marker!==95&&s.marker!==42||s.end===-1)continue;const i=t[s.end],a=r>0&&t[r-1].end===s.end+1&&t[r-1].marker===s.marker&&t[r-1].token===s.token-1&&t[s.end+1].token===i.token+1,o=String.fromCharCode(s.marker),l=e.tokens[s.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const c=e.tokens[i.token];c.type=a?"strong_close":"em_close",c.tag=a?"strong":"em",c.nesting=-1,c.markup=a?o+o:o,c.content="",a&&(e.tokens[t[r-1].token].content="",e.tokens[t[s.end+1].token].content="",r--)}}function HNe(e){const t=e.tokens_meta,n=e.tokens_meta.length;qz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&qz(e,t[r].delimiters)}const ZZ={tokenize:WNe,postProcess:HNe};function GNe(e,t){let n,r,s,i,a="",o="",l=e.pos,c=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const u=e.pos,d=e.posMax,h=e.pos+1,m=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(m<0)return!1;let y=m+1;if(y<d&&e.src.charCodeAt(y)===40){for(c=!1,y++;y<d&&(n=e.src.charCodeAt(y),!(!Ps(n)&&n!==10));y++);if(y>=d)return!1;if(l=y,s=e.md.helpers.parseLinkDestination(e.src,y,e.posMax),s.ok){for(a=e.md.normalizeLink(s.str),e.md.validateLink(a)?y=s.pos:a="",l=y;y<d&&(n=e.src.charCodeAt(y),!(!Ps(n)&&n!==10));y++);if(s=e.md.helpers.parseLinkTitle(e.src,y,e.posMax),y<d&&l!==y&&s.ok)for(o=s.str,y=s.pos;y<d&&(n=e.src.charCodeAt(y),!(!Ps(n)&&n!==10));y++);}(y>=d||e.src.charCodeAt(y)!==41)&&(c=!0),y++}if(c){if(typeof e.env.references>"u")return!1;if(y<d&&e.src.charCodeAt(y)===91?(l=y+1,y=e.md.helpers.parseLinkLabel(e,y),y>=0?r=e.src.slice(l,y++):y=m+1):y=m+1,r||(r=e.src.slice(h,m)),i=e.env.references[rT(r)],!i)return e.pos=u,!1;a=i.href,o=i.title}if(!t){e.pos=h,e.posMax=m;const b=e.push("link_open","a",1),v=[["href",a]];b.attrs=v,o&&v.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=y,e.posMax=d,!0}function KNe(e,t){let n,r,s,i,a,o,l,c,u="";const d=e.pos,h=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const m=e.pos+2,y=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(y<0)return!1;if(i=y+1,i<h&&e.src.charCodeAt(i)===40){for(i++;i<h&&(n=e.src.charCodeAt(i),!(!Ps(n)&&n!==10));i++);if(i>=h)return!1;for(c=i,o=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),o.ok&&(u=e.md.normalizeLink(o.str),e.md.validateLink(u)?i=o.pos:u=""),c=i;i<h&&(n=e.src.charCodeAt(i),!(!Ps(n)&&n!==10));i++);if(o=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<h&&c!==i&&o.ok)for(l=o.str,i=o.pos;i<h&&(n=e.src.charCodeAt(i),!(!Ps(n)&&n!==10));i++);else l="";if(i>=h||e.src.charCodeAt(i)!==41)return e.pos=d,!1;i++}else{if(typeof e.env.references>"u")return!1;if(i<h&&e.src.charCodeAt(i)===91?(c=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?s=e.src.slice(c,i++):i=y+1):i=y+1,s||(s=e.src.slice(m,y)),a=e.env.references[rT(s)],!a)return e.pos=d,!1;u=a.href,l=a.title}if(!t){r=e.src.slice(m,y);const b=[];e.md.inline.parse(r,e.md,e.env,b);const v=e.push("image","img",0),x=[["src",u],["alt",""]];v.attrs=x,v.children=b,v.content=r,l&&x.push(["title",l])}return e.pos=i,e.posMax=h,!0}const YNe=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,ZNe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function XNe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,s=e.posMax;for(;;){if(++n>=s)return!1;const a=e.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const i=e.src.slice(r+1,n);if(ZNe.test(i)){const a=e.md.normalizeLink(i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}if(YNe.test(i)){const a=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}return!1}function JNe(e){return/^<a[>\s]/i.test(e)}function QNe(e){return/^<\/a\s*>/i.test(e)}function eMe(e){const t=e|32;return t>=97&&t<=122}function tMe(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const s=e.src.charCodeAt(r+1);if(s!==33&&s!==63&&s!==47&&!eMe(s))return!1;const i=e.src.slice(r).match(NNe);if(!i)return!1;if(!t){const a=e.push("html_inline","",0);a.content=i[0],JNe(a.content)&&e.linkLevel++,QNe(a.content)&&e.linkLevel--}return e.pos+=i[0].length,!0}const nMe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,rMe=/^&([a-z][a-z0-9]{1,31});/i;function sMe(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const i=e.src.slice(n).match(nMe);if(i){if(!t){const a=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=e.push("text_special","",0);o.content=pD(a)?JC(a):JC(65533),o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}else{const i=e.src.slice(n).match(rMe);if(i){const a=UZ(i[0]);if(a!==i[0]){if(!t){const o=e.push("text_special","",0);o.content=a,o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}}return!1}function Vz(e){const t={},n=e.length;if(!n)return;let r=0,s=-2;const i=[];for(let a=0;a<n;a++){const o=e[a];if(i.push(0),(e[r].marker!==o.marker||s!==o.token-1)&&(r=a),s=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let c=r-i[r]-1,u=c;for(;c>l;c-=i[c]+1){const d=e[c];if(d.marker===o.marker&&d.open&&d.end<0){let h=!1;if((d.close||o.open)&&(d.length+o.length)%3===0&&(d.length%3!==0||o.length%3!==0)&&(h=!0),!h){const m=c>0&&!e[c-1].open?i[c-1]+1:0;i[a]=a-c+m,i[c]=m,o.open=!1,d.end=a,d.close=!1,u=-1,s=-2;break}}}u!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=u)}}function iMe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Vz(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Vz(t[r].delimiters)}function aMe(e){let t,n,r=0;const s=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)s[t].nesting<0&&r--,s[t].level=r,s[t].nesting>0&&r++,s[t].type==="text"&&t+1<i&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}const cI=[["text",FNe],["linkify",BNe],["newline",$Ne],["escape",zNe],["backticks",UNe],["strikethrough",YZ.tokenize],["emphasis",ZZ.tokenize],["link",GNe],["image",KNe],["autolink",XNe],["html_inline",tMe],["entity",sMe]],uI=[["balance_pairs",iMe],["strikethrough",YZ.postProcess],["emphasis",ZZ.postProcess],["fragments_join",aMe]];function L1(){this.ruler=new jo;for(let e=0;e<cI.length;e++)this.ruler.push(cI[e][0],cI[e][1]);this.ruler2=new jo;for(let e=0;e<uI.length;e++)this.ruler2.push(uI[e][0],uI[e][1])}L1.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,s=e.md.options.maxNesting,i=e.cache;if(typeof i[t]<"u"){e.pos=i[t];return}let a=!1;if(e.level<s){for(let o=0;o<r;o++)if(e.level++,a=n[o](e,!0),e.level--,a){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;a||e.pos++,i[t]=e.pos};L1.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,s=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let a=!1;if(e.level<s){for(let o=0;o<n;o++)if(a=t[o](e,!1),a){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};L1.prototype.parse=function(e,t,n,r){const s=new this.State(e,t,n,r);this.tokenize(s);const i=this.ruler2.getRules(""),a=i.length;for(let o=0;o<a;o++)i[o](s)};L1.prototype.State=F1;function oMe(e){const t={};e=e||{},t.src_Any=FZ.source,t.src_Cc=LZ.source,t.src_Z=$Z.source,t.src_P=fD.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function Nj(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function iT(e){return Object.prototype.toString.call(e)}function lMe(e){return iT(e)==="[object String]"}function cMe(e){return iT(e)==="[object Object]"}function uMe(e){return iT(e)==="[object RegExp]"}function Wz(e){return iT(e)==="[object Function]"}function dMe(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const XZ={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function fMe(e){return Object.keys(e||{}).reduce(function(t,n){return t||XZ.hasOwnProperty(n)},!1)}const hMe={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},pMe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",mMe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function gMe(e){e.__index__=-1,e.__text_cache__=""}function yMe(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function Hz(){return function(e,t){t.normalize(e)}}function QC(e){const t=e.re=oMe(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(pMe),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const s=[];e.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const c={validate:null,link:null};if(e.__compiled__[o]=c,cMe(l)){uMe(l.validate)?c.validate=yMe(l.validate):Wz(l.validate)?c.validate=l.validate:i(o,l),Wz(l.normalize)?c.normalize=l.normalize:l.normalize?i(o,l):c.normalize=Hz();return}if(lMe(l)){s.push(o);return}i(o,l)}),s.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:Hz()};const a=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(dMe).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),gMe(e)}function bMe(e,t){const n=e.__index__,r=e.__last_index__,s=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=s,this.text=s,this.url=s}function Mj(e,t){const n=new bMe(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function ul(e,t){if(!(this instanceof ul))return new ul(e,t);t||fMe(e)&&(t=e,e={}),this.__opts__=Nj({},XZ,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Nj({},hMe,e),this.__compiled__={},this.__tlds__=mMe,this.__tlds_replaced__=!1,this.re={},QC(this)}ul.prototype.add=function(t,n){return this.__schemas__[t]=n,QC(this),this};ul.prototype.set=function(t){return this.__opts__=Nj(this.__opts__,t),this};ul.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,s,i,a,o,l,c,u;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(i=this.testSchemaAt(t,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(c=t.search(this.re.host_fuzzy_test),c>=0&&(this.__index__<0||c<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=t.indexOf("@"),u>=0&&(s=t.match(this.re.email_fuzzy))!==null&&(a=s.index+s[1].length,o=s.index+s[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};ul.prototype.pretest=function(t){return this.re.pretest.test(t)};ul.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};ul.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(Mj(this,r)),r=this.__last_index__);let s=r?t.slice(r):t;for(;this.test(s);)n.push(Mj(this,r)),s=s.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};ul.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,Mj(this,0)):null};ul.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,s,i){return r!==i[s-1]}).reverse(),QC(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,QC(this),this)};ul.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};ul.prototype.onCompile=function(){};const E0=2147483647,du=36,yD=1,yw=26,vMe=38,xMe=700,JZ=72,QZ=128,eX="-",wMe=/^xn--/,_Me=/[^\0-\x7F]/,SMe=/[\x2E\u3002\uFF0E\uFF61]/g,CMe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},dI=du-yD,fu=Math.floor,fI=String.fromCharCode;function nh(e){throw new RangeError(CMe[e])}function kMe(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function tX(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(SMe,".");const s=e.split("."),i=kMe(s,t).join(".");return r+i}function nX(e){const t=[];let n=0;const r=e.length;for(;n<r;){const s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){const i=e.charCodeAt(n++);(i&64512)==56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),n--)}else t.push(s)}return t}const EMe=e=>String.fromCodePoint(...e),TMe=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:du},Gz=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},rX=function(e,t,n){let r=0;for(e=n?fu(e/xMe):e>>1,e+=fu(e/t);e>dI*yw>>1;r+=du)e=fu(e/dI);return fu(r+(dI+1)*e/(e+vMe))},sX=function(e){const t=[],n=e.length;let r=0,s=QZ,i=JZ,a=e.lastIndexOf(eX);a<0&&(a=0);for(let o=0;o<a;++o)e.charCodeAt(o)>=128&&nh("not-basic"),t.push(e.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=r;for(let u=1,d=du;;d+=du){o>=n&&nh("invalid-input");const h=TMe(e.charCodeAt(o++));h>=du&&nh("invalid-input"),h>fu((E0-r)/u)&&nh("overflow"),r+=h*u;const m=d<=i?yD:d>=i+yw?yw:d-i;if(h<m)break;const y=du-m;u>fu(E0/y)&&nh("overflow"),u*=y}const c=t.length+1;i=rX(r-l,c,l==0),fu(r/c)>E0-s&&nh("overflow"),s+=fu(r/c),r%=c,t.splice(r++,0,s)}return String.fromCodePoint(...t)},iX=function(e){const t=[];e=nX(e);const n=e.length;let r=QZ,s=0,i=JZ;for(const l of e)l<128&&t.push(fI(l));const a=t.length;let o=a;for(a&&t.push(eX);o<n;){let l=E0;for(const u of e)u>=r&&u<l&&(l=u);const c=o+1;l-r>fu((E0-s)/c)&&nh("overflow"),s+=(l-r)*c,r=l;for(const u of e)if(u<r&&++s>E0&&nh("overflow"),u===r){let d=s;for(let h=du;;h+=du){const m=h<=i?yD:h>=i+yw?yw:h-i;if(d<m)break;const y=d-m,b=du-m;t.push(fI(Gz(m+y%b,0))),d=fu(y/b)}t.push(fI(Gz(d,0))),i=rX(s,c,o===a),s=0,++o}++s,++r}return t.join("")},AMe=function(e){return tX(e,function(t){return wMe.test(t)?sX(t.slice(4).toLowerCase()):t})},RMe=function(e){return tX(e,function(t){return _Me.test(t)?"xn--"+iX(t):t})},aX={version:"2.3.1",ucs2:{decode:nX,encode:EMe},decode:sX,encode:iX,toASCII:RMe,toUnicode:AMe},NMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},MMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},IMe={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},jMe={default:NMe,zero:MMe,commonmark:IMe},OMe=/^(vbscript|javascript|file|data):/,PMe=/^data:image\/(gif|png|jpeg|webp);/;function DMe(e){const t=e.trim().toLowerCase();return OMe.test(t)?PMe.test(t):!0}const oX=["http:","https:","mailto:"];function FMe(e){const t=dD(e,!0);if(t.hostname&&(!t.protocol||oX.indexOf(t.protocol)>=0))try{t.hostname=aX.toASCII(t.hostname)}catch{}return D1(uD(t))}function LMe(e){const t=dD(e,!0);if(t.hostname&&(!t.protocol||oX.indexOf(t.protocol)>=0))try{t.hostname=aX.toUnicode(t.hostname)}catch{}return dy(uD(t),dy.defaultChars+"%")}function dl(e,t){if(!(this instanceof dl))return new dl(e,t);t||hD(e)||(t=e||{},e="default"),this.inline=new L1,this.block=new sT,this.core=new mD,this.renderer=new Jy,this.linkify=new ul,this.validateLink=DMe,this.normalizeLink=FMe,this.normalizeLinkText=LMe,this.utils=$Re,this.helpers=nT({},VRe),this.options={},this.configure(e),t&&this.set(t)}dl.prototype.set=function(e){return nT(this.options,e),this};dl.prototype.configure=function(e){const t=this;if(hD(e)){const n=e;if(e=jMe[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};dl.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};dl.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};dl.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};dl.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};dl.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};dl.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};dl.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const hI=new dl({html:!1,linkify:!0,breaks:!0});function aT(e){return T.useMemo(()=>{var n;if(!e)return[];try{const r=hI.parse(e,{}),s=[];let i="",a=0;for(;a<r.length;){const o=r[a];if(o.type==="fence"){i&&(s.push(i),i="");const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[d,...h]=l.split(":");c=d||void 0,u=h.join(":")||void 0}else c=l.split(" ")[0]||void 0;c==="mermaid"?s.push({type:"mermaid",code:o.content}):s.push({type:"code",lang:c,code:o.content,filepath:u}),a++}else{const l=[];for(;a<r.length&&r[a].type!=="fence";)l.push(r[a]),a++;l.length>0&&(i+=hI.renderer.render(l,hI.options,{}))}}return i&&s.push(i),s}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const BMe="modulepreload",$Me=function(e){return"/"+e},Kz={},Zr=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=a(n.map(c=>{if(c=$Me(c),c in Kz)return;Kz[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":BMe,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})};var A2={exports:{}},zMe=A2.exports,Yz;function UMe(){return Yz||(Yz=1,function(e,t){(function(n,r){e.exports=r()})(zMe,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",a="second",o="minute",l="hour",c="day",u="week",d="month",h="quarter",m="year",y="date",b="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(F){var X=["th","st","nd","rd"],U=F%100;return"["+F+(X[(U-20)%10]||X[U]||X[0])+"]"}},S=function(F,X,U){var H=String(F);return!H||H.length>=X?F:""+Array(X+1-H.length).join(U)+F},C={s:S,z:function(F){var X=-F.utcOffset(),U=Math.abs(X),H=Math.floor(U/60),$=U%60;return(X<=0?"+":"-")+S(H,2,"0")+":"+S($,2,"0")},m:function F(X,U){if(X.date()<U.date())return-F(U,X);var H=12*(U.year()-X.year())+(U.month()-X.month()),$=X.clone().add(H,d),ne=U-$<0,W=X.clone().add(H+(ne?-1:1),d);return+(-(H+(U-$)/(ne?$-W:W-$))||0)},a:function(F){return F<0?Math.ceil(F)||0:Math.floor(F)},p:function(F){return{M:d,y:m,w:u,d:c,D:y,h:l,m:o,s:a,ms:i,Q:h}[F]||String(F||"").toLowerCase().replace(/s$/,"")},u:function(F){return F===void 0}},k="en",A={};A[k]=w;var R="$isDayjsObject",N=function(F){return F instanceof P||!(!F||!F[R])},I=function F(X,U,H){var $;if(!X)return k;if(typeof X=="string"){var ne=X.toLowerCase();A[ne]&&($=ne),U&&(A[ne]=U,$=ne);var W=X.split("-");if(!$&&W.length>1)return F(W[0])}else{var Q=X.name;A[Q]=X,$=Q}return!H&&$&&(k=$),$||!H&&k},O=function(F,X){if(N(F))return F.clone();var U=typeof X=="object"?X:{};return U.date=F,U.args=arguments,new P(U)},L=C;L.l=I,L.i=N,L.w=function(F,X){return O(F,{locale:X.$L,utc:X.$u,x:X.$x,$offset:X.$offset})};var P=function(){function F(U){this.$L=I(U.locale,null,!0),this.parse(U),this.$x=this.$x||U.x||{},this[R]=!0}var X=F.prototype;return X.parse=function(U){this.$d=function(H){var $=H.date,ne=H.utc;if($===null)return new Date(NaN);if(L.u($))return new Date;if($ instanceof Date)return new Date($);if(typeof $=="string"&&!/Z$/i.test($)){var W=$.match(v);if(W){var Q=W[2]-1||0,ee=(W[7]||"0").substring(0,3);return ne?new Date(Date.UTC(W[1],Q,W[3]||1,W[4]||0,W[5]||0,W[6]||0,ee)):new Date(W[1],Q,W[3]||1,W[4]||0,W[5]||0,W[6]||0,ee)}}return new Date($)}(U),this.init()},X.init=function(){var U=this.$d;this.$y=U.getFullYear(),this.$M=U.getMonth(),this.$D=U.getDate(),this.$W=U.getDay(),this.$H=U.getHours(),this.$m=U.getMinutes(),this.$s=U.getSeconds(),this.$ms=U.getMilliseconds()},X.$utils=function(){return L},X.isValid=function(){return this.$d.toString()!==b},X.isSame=function(U,H){var $=O(U);return this.startOf(H)<=$&&$<=this.endOf(H)},X.isAfter=function(U,H){return O(U)<this.startOf(H)},X.isBefore=function(U,H){return this.endOf(H)<O(U)},X.$g=function(U,H,$){return L.u(U)?this[H]:this.set($,U)},X.unix=function(){return Math.floor(this.valueOf()/1e3)},X.valueOf=function(){return this.$d.getTime()},X.startOf=function(U,H){var $=this,ne=!!L.u(H)||H,W=L.p(U),Q=function(Ce,qe){var Qe=L.w($.$u?Date.UTC($.$y,qe,Ce):new Date($.$y,qe,Ce),$);return ne?Qe:Qe.endOf(c)},ee=function(Ce,qe){return L.w($.toDate()[Ce].apply($.toDate("s"),(ne?[0,0,0,0]:[23,59,59,999]).slice(qe)),$)},se=this.$W,pe=this.$M,ce=this.$D,Ie="set"+(this.$u?"UTC":"");switch(W){case m:return ne?Q(1,0):Q(31,11);case d:return ne?Q(1,pe):Q(0,pe+1);case u:var De=this.$locale().weekStart||0,Se=(se<De?se+7:se)-De;return Q(ne?ce-Se:ce+(6-Se),pe);case c:case y:return ee(Ie+"Hours",0);case l:return ee(Ie+"Minutes",1);case o:return ee(Ie+"Seconds",2);case a:return ee(Ie+"Milliseconds",3);default:return this.clone()}},X.endOf=function(U){return this.startOf(U,!1)},X.$set=function(U,H){var $,ne=L.p(U),W="set"+(this.$u?"UTC":""),Q=($={},$[c]=W+"Date",$[y]=W+"Date",$[d]=W+"Month",$[m]=W+"FullYear",$[l]=W+"Hours",$[o]=W+"Minutes",$[a]=W+"Seconds",$[i]=W+"Milliseconds",$)[ne],ee=ne===c?this.$D+(H-this.$W):H;if(ne===d||ne===m){var se=this.clone().set(y,1);se.$d[Q](ee),se.init(),this.$d=se.set(y,Math.min(this.$D,se.daysInMonth())).$d}else Q&&this.$d[Q](ee);return this.init(),this},X.set=function(U,H){return this.clone().$set(U,H)},X.get=function(U){return this[L.p(U)]()},X.add=function(U,H){var $,ne=this;U=Number(U);var W=L.p(H),Q=function(pe){var ce=O(ne);return L.w(ce.date(ce.date()+Math.round(pe*U)),ne)};if(W===d)return this.set(d,this.$M+U);if(W===m)return this.set(m,this.$y+U);if(W===c)return Q(1);if(W===u)return Q(7);var ee=($={},$[o]=r,$[l]=s,$[a]=n,$)[W]||1,se=this.$d.getTime()+U*ee;return L.w(se,this)},X.subtract=function(U,H){return this.add(-1*U,H)},X.format=function(U){var H=this,$=this.$locale();if(!this.isValid())return $.invalidDate||b;var ne=U||"YYYY-MM-DDTHH:mm:ssZ",W=L.z(this),Q=this.$H,ee=this.$m,se=this.$M,pe=$.weekdays,ce=$.months,Ie=$.meridiem,De=function(qe,Qe,Ve,Ne){return qe&&(qe[Qe]||qe(H,ne))||Ve[Qe].slice(0,Ne)},Se=function(qe){return L.s(Q%12||12,qe,"0")},Ce=Ie||function(qe,Qe,Ve){var Ne=qe<12?"AM":"PM";return Ve?Ne.toLowerCase():Ne};return ne.replace(x,function(qe,Qe){return Qe||function(Ve){switch(Ve){case"YY":return String(H.$y).slice(-2);case"YYYY":return L.s(H.$y,4,"0");case"M":return se+1;case"MM":return L.s(se+1,2,"0");case"MMM":return De($.monthsShort,se,ce,3);case"MMMM":return De(ce,se);case"D":return H.$D;case"DD":return L.s(H.$D,2,"0");case"d":return String(H.$W);case"dd":return De($.weekdaysMin,H.$W,pe,2);case"ddd":return De($.weekdaysShort,H.$W,pe,3);case"dddd":return pe[H.$W];case"H":return String(Q);case"HH":return L.s(Q,2,"0");case"h":return Se(1);case"hh":return Se(2);case"a":return Ce(Q,ee,!0);case"A":return Ce(Q,ee,!1);case"m":return String(ee);case"mm":return L.s(ee,2,"0");case"s":return String(H.$s);case"ss":return L.s(H.$s,2,"0");case"SSS":return L.s(H.$ms,3,"0");case"Z":return W}return null}(qe)||W.replace(":","")})},X.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},X.diff=function(U,H,$){var ne,W=this,Q=L.p(H),ee=O(U),se=(ee.utcOffset()-this.utcOffset())*r,pe=this-ee,ce=function(){return L.m(W,ee)};switch(Q){case m:ne=ce()/12;break;case d:ne=ce();break;case h:ne=ce()/3;break;case u:ne=(pe-se)/6048e5;break;case c:ne=(pe-se)/864e5;break;case l:ne=pe/s;break;case o:ne=pe/r;break;case a:ne=pe/n;break;default:ne=pe}return $?ne:L.a(ne)},X.daysInMonth=function(){return this.endOf(d).$D},X.$locale=function(){return A[this.$L]},X.locale=function(U,H){if(!U)return this.$L;var $=this.clone(),ne=I(U,H,!0);return ne&&($.$L=ne),$},X.clone=function(){return L.w(this.$d,this)},X.toDate=function(){return new Date(this.valueOf())},X.toJSON=function(){return this.isValid()?this.toISOString():null},X.toISOString=function(){return this.$d.toISOString()},X.toString=function(){return this.$d.toUTCString()},F}(),V=P.prototype;return O.prototype=V,[["$ms",i],["$s",a],["$m",o],["$H",l],["$W",c],["$M",d],["$y",m],["$D",y]].forEach(function(F){V[F[1]]=function(X){return this.$g(X,F[0],F[1])}}),O.extend=function(F,X){return F.$i||(F(X,P,O),F.$i=!0),O},O.locale=I,O.isDayjs=N,O.unix=function(F){return O(1e3*F)},O.en=A[k],O.Ls=A,O.p={},O})}(A2)),A2.exports}var qMe=UMe();const VMe=_a(qMe),R2={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},r)=>{if(!t)return n*2.55;e/=360,t/=100,n/=100;const s=n<.5?n*(1+t):n+t-n*t,i=2*n-s;switch(r){case"r":return R2.hue2rgb(i,s,e+1/3)*255;case"g":return R2.hue2rgb(i,s,e)*255;case"b":return R2.hue2rgb(i,s,e-1/3)*255}},rgb2hsl:({r:e,g:t,b:n},r)=>{e/=255,t/=255,n/=255;const s=Math.max(e,t,n),i=Math.min(e,t,n),a=(s+i)/2;if(r==="l")return a*100;if(s===i)return 0;const o=s-i,l=a>.5?o/(2-s-i):o/(s+i);if(r==="s")return l*100;switch(s){case e:return((t-n)/o+(t<n?6:0))*60;case t:return((n-e)/o+2)*60;case n:return((e-t)/o+4)*60;default:return-1}}},WMe={clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(e*1e10)/1e10},HMe={dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}},lr={channel:R2,lang:WMe,unit:HMe},Zf={};for(let e=0;e<=255;e++)Zf[e]=lr.unit.dec2hex(e);const Ra={ALL:0,RGB:1,HSL:2};class GMe{constructor(){this.type=Ra.ALL}get(){return this.type}set(t){if(this.type&&this.type!==t)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=t}reset(){this.type=Ra.ALL}is(t){return this.type===t}}class KMe{constructor(t,n){this.color=n,this.changed=!1,this.data=t,this.type=new GMe}set(t,n){return this.color=n,this.changed=!1,this.data=t,this.type.type=Ra.ALL,this}_ensureHSL(){const t=this.data,{h:n,s:r,l:s}=t;n===void 0&&(t.h=lr.channel.rgb2hsl(t,"h")),r===void 0&&(t.s=lr.channel.rgb2hsl(t,"s")),s===void 0&&(t.l=lr.channel.rgb2hsl(t,"l"))}_ensureRGB(){const t=this.data,{r:n,g:r,b:s}=t;n===void 0&&(t.r=lr.channel.hsl2rgb(t,"r")),r===void 0&&(t.g=lr.channel.hsl2rgb(t,"g")),s===void 0&&(t.b=lr.channel.hsl2rgb(t,"b"))}get r(){const t=this.data,n=t.r;return!this.type.is(Ra.HSL)&&n!==void 0?n:(this._ensureHSL(),lr.channel.hsl2rgb(t,"r"))}get g(){const t=this.data,n=t.g;return!this.type.is(Ra.HSL)&&n!==void 0?n:(this._ensureHSL(),lr.channel.hsl2rgb(t,"g"))}get b(){const t=this.data,n=t.b;return!this.type.is(Ra.HSL)&&n!==void 0?n:(this._ensureHSL(),lr.channel.hsl2rgb(t,"b"))}get h(){const t=this.data,n=t.h;return!this.type.is(Ra.RGB)&&n!==void 0?n:(this._ensureRGB(),lr.channel.rgb2hsl(t,"h"))}get s(){const t=this.data,n=t.s;return!this.type.is(Ra.RGB)&&n!==void 0?n:(this._ensureRGB(),lr.channel.rgb2hsl(t,"s"))}get l(){const t=this.data,n=t.l;return!this.type.is(Ra.RGB)&&n!==void 0?n:(this._ensureRGB(),lr.channel.rgb2hsl(t,"l"))}get a(){return this.data.a}set r(t){this.type.set(Ra.RGB),this.changed=!0,this.data.r=t}set g(t){this.type.set(Ra.RGB),this.changed=!0,this.data.g=t}set b(t){this.type.set(Ra.RGB),this.changed=!0,this.data.b=t}set h(t){this.type.set(Ra.HSL),this.changed=!0,this.data.h=t}set s(t){this.type.set(Ra.HSL),this.changed=!0,this.data.s=t}set l(t){this.type.set(Ra.HSL),this.changed=!0,this.data.l=t}set a(t){this.changed=!0,this.data.a=t}}const oT=new KMe({r:0,g:0,b:0,a:0},"transparent"),T0={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(e.charCodeAt(0)!==35)return;const t=e.match(T0.re);if(!t)return;const n=t[1],r=parseInt(n,16),s=n.length,i=s%4===0,a=s>4,o=a?1:17,l=a?8:4,c=i?0:-1,u=a?255:15;return oT.set({r:(r>>l*(c+3)&u)*o,g:(r>>l*(c+2)&u)*o,b:(r>>l*(c+1)&u)*o,a:i?(r&u)*o/255:1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`#${Zf[Math.round(t)]}${Zf[Math.round(n)]}${Zf[Math.round(r)]}${Zf[Math.round(s*255)]}`:`#${Zf[Math.round(t)]}${Zf[Math.round(n)]}${Zf[Math.round(r)]}`}},Vp={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(Vp.hueRe);if(t){const[,n,r]=t;switch(r){case"grad":return lr.channel.clamp.h(parseFloat(n)*.9);case"rad":return lr.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return lr.channel.clamp.h(parseFloat(n)*360)}}return lr.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(t!==104&&t!==72)return;const n=e.match(Vp.re);if(!n)return;const[,r,s,i,a,o]=n;return oT.set({h:Vp._hue2deg(r),s:lr.channel.clamp.s(parseFloat(s)),l:lr.channel.clamp.l(parseFloat(i)),a:a?lr.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},e)},stringify:e=>{const{h:t,s:n,l:r,a:s}=e;return s<1?`hsla(${lr.lang.round(t)}, ${lr.lang.round(n)}%, ${lr.lang.round(r)}%, ${s})`:`hsl(${lr.lang.round(t)}, ${lr.lang.round(n)}%, ${lr.lang.round(r)}%)`}},gx={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=gx.colors[e];if(t)return T0.parse(t)},stringify:e=>{const t=T0.stringify(e);for(const n in gx.colors)if(gx.colors[n]===t)return n}},Kv={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(t!==114&&t!==82)return;const n=e.match(Kv.re);if(!n)return;const[,r,s,i,a,o,l,c,u]=n;return oT.set({r:lr.channel.clamp.r(s?parseFloat(r)*2.55:parseFloat(r)),g:lr.channel.clamp.g(a?parseFloat(i)*2.55:parseFloat(i)),b:lr.channel.clamp.b(l?parseFloat(o)*2.55:parseFloat(o)),a:c?lr.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`rgba(${lr.lang.round(t)}, ${lr.lang.round(n)}, ${lr.lang.round(r)}, ${lr.lang.round(s)})`:`rgb(${lr.lang.round(t)}, ${lr.lang.round(n)}, ${lr.lang.round(r)})`}},Ru={format:{keyword:gx,hex:T0,rgb:Kv,rgba:Kv,hsl:Vp,hsla:Vp},parse:e=>{if(typeof e!="string")return e;const t=T0.parse(e)||Kv.parse(e)||Vp.parse(e)||gx.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(Ra.HSL)||e.data.r===void 0?Vp.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?Kv.stringify(e):T0.stringify(e)},lX=(e,t)=>{const n=Ru.parse(e);for(const r in t)n[r]=lr.channel.clamp[r](t[r]);return Ru.stringify(n)},yx=(e,t,n=0,r=1)=>{if(typeof e!="number")return lX(e,{a:t});const s=oT.set({r:lr.channel.clamp.r(e),g:lr.channel.clamp.g(t),b:lr.channel.clamp.b(n),a:lr.channel.clamp.a(r)});return Ru.stringify(s)},YMe=e=>{const{r:t,g:n,b:r}=Ru.parse(e),s=.2126*lr.channel.toLinear(t)+.7152*lr.channel.toLinear(n)+.0722*lr.channel.toLinear(r);return lr.lang.round(s)},ZMe=e=>YMe(e)>=.5,B1=e=>!ZMe(e),cX=(e,t,n)=>{const r=Ru.parse(e),s=r[t],i=lr.channel.clamp[t](s+n);return s!==i&&(r[t]=i),Ru.stringify(r)},wn=(e,t)=>cX(e,"l",t),$n=(e,t)=>cX(e,"l",-t),yt=(e,t)=>{const n=Ru.parse(e),r={};for(const s in t)t[s]&&(r[s]=n[s]+t[s]);return lX(e,r)},XMe=(e,t,n=50)=>{const{r,g:s,b:i,a}=Ru.parse(e),{r:o,g:l,b:c,a:u}=Ru.parse(t),d=n/100,h=d*2-1,m=a-u,b=((h*m===-1?h:(h+m)/(1+h*m))+1)/2,v=1-b,x=r*b+o*v,w=s*b+l*v,S=i*b+c*v,C=a*d+u*(1-d);return yx(x,w,S,C)},cn=(e,t=100)=>{const n=Ru.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,XMe(n,e,t)};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:uX,setPrototypeOf:Zz,isFrozen:JMe,getPrototypeOf:QMe,getOwnPropertyDescriptor:eIe}=Object;let{freeze:ao,seal:Vl,create:dX}=Object,{apply:Ij,construct:jj}=typeof Reflect<"u"&&Reflect;ao||(ao=function(t){return t});Vl||(Vl=function(t){return t});Ij||(Ij=function(t,n,r){return t.apply(n,r)});jj||(jj=function(t,n){return new t(...n)});const $S=oo(Array.prototype.forEach),tIe=oo(Array.prototype.lastIndexOf),Xz=oo(Array.prototype.pop),Nv=oo(Array.prototype.push),nIe=oo(Array.prototype.splice),N2=oo(String.prototype.toLowerCase),pI=oo(String.prototype.toString),Jz=oo(String.prototype.match),Mv=oo(String.prototype.replace),rIe=oo(String.prototype.indexOf),sIe=oo(String.prototype.trim),ac=oo(Object.prototype.hasOwnProperty),Ya=oo(RegExp.prototype.test),Iv=iIe(TypeError);function oo(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return Ij(e,t,r)}}function iIe(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return jj(e,n)}}function Br(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:N2;Zz&&Zz(e,null);let r=t.length;for(;r--;){let s=t[r];if(typeof s=="string"){const i=n(s);i!==s&&(JMe(t)||(t[r]=i),s=i)}e[s]=!0}return e}function aIe(e){for(let t=0;t<e.length;t++)ac(e,t)||(e[t]=null);return e}function md(e){const t=dX(null);for(const[n,r]of uX(e))ac(e,n)&&(Array.isArray(r)?t[n]=aIe(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=md(r):t[n]=r);return t}function jv(e,t){for(;e!==null;){const r=eIe(e,t);if(r){if(r.get)return oo(r.get);if(typeof r.value=="function")return oo(r.value)}e=QMe(e)}function n(){return null}return n}const Qz=ao(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),mI=ao(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),gI=ao(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),oIe=ao(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),yI=ao(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),lIe=ao(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),e7=ao(["#text"]),t7=ao(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),bI=ao(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),n7=ao(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zS=ao(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),cIe=Vl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),uIe=Vl(/<%[\w\W]*|[\w\W]*%>/gm),dIe=Vl(/\$\{[\w\W]*/gm),fIe=Vl(/^data-[\-\w.\u00B7-\uFFFF]+$/),hIe=Vl(/^aria-[\-\w]+$/),fX=Vl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),pIe=Vl(/^(?:\w+script|data):/i),mIe=Vl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),hX=Vl(/^html$/i),gIe=Vl(/^[a-z][.\w]*(-[.\w]+)+$/i);var r7=Object.freeze({__proto__:null,ARIA_ATTR:hIe,ATTR_WHITESPACE:mIe,CUSTOM_ELEMENT:gIe,DATA_ATTR:fIe,DOCTYPE_NAME:hX,ERB_EXPR:uIe,IS_ALLOWED_URI:fX,IS_SCRIPT_OR_DATA:pIe,MUSTACHE_EXPR:cIe,TMPLIT_EXPR:dIe});const Ov={element:1,text:3,progressingInstruction:7,comment:8,document:9},yIe=function(){return typeof window>"u"?null:window},bIe=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(r=n.getAttribute(s));const i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},s7=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function pX(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yIe();const t=hn=>pX(hn);if(t.version="3.2.6",t.removed=[],!e||!e.document||e.document.nodeType!==Ov.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,s=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:a,Node:o,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:m}=e,y=l.prototype,b=jv(y,"cloneNode"),v=jv(y,"remove"),x=jv(y,"nextSibling"),w=jv(y,"childNodes"),S=jv(y,"parentNode");if(typeof a=="function"){const hn=n.createElement("template");hn.content&&hn.content.ownerDocument&&(n=hn.content.ownerDocument)}let C,k="";const{implementation:A,createNodeIterator:R,createDocumentFragment:N,getElementsByTagName:I}=n,{importNode:O}=r;let L=s7();t.isSupported=typeof uX=="function"&&typeof S=="function"&&A&&A.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:P,ERB_EXPR:V,TMPLIT_EXPR:F,DATA_ATTR:X,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:H,ATTR_WHITESPACE:$,CUSTOM_ELEMENT:ne}=r7;let{IS_ALLOWED_URI:W}=r7,Q=null;const ee=Br({},[...Qz,...mI,...gI,...yI,...e7]);let se=null;const pe=Br({},[...t7,...bI,...n7,...zS]);let ce=Object.seal(dX(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ie=null,De=null,Se=!0,Ce=!0,qe=!1,Qe=!0,Ve=!1,Ne=!0,K=!1,me=!1,Ae=!1,le=!1,oe=!1,re=!1,Te=!0,Be=!1;const ke="user-content-";let lt=!0,Rt=!1,ft={},jt=null;const qt=Br({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Lt=null;const en=Br({},["audio","video","img","source","image","track"]);let xe=null;const D=Br({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Z="http://www.w3.org/1998/Math/MathML",ge="http://www.w3.org/2000/svg",Fe="http://www.w3.org/1999/xhtml";let we=Fe,Me=!1,de=null;const vt=Br({},[Z,ge,Fe],pI);let ot=Br({},["mi","mo","mn","ms","mtext"]),B=Br({},["annotation-xml"]);const ze=Br({},["title","style","font","a","script"]);let st=null;const ye=["application/xhtml+xml","text/html"],_e="text/html";let Ue=null,kt=null;const fe=n.createElement("form"),Y=function(et){return et instanceof RegExp||et instanceof Function},G=function(){let et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(kt&&kt===et)){if((!et||typeof et!="object")&&(et={}),et=md(et),st=ye.indexOf(et.PARSER_MEDIA_TYPE)===-1?_e:et.PARSER_MEDIA_TYPE,Ue=st==="application/xhtml+xml"?pI:N2,Q=ac(et,"ALLOWED_TAGS")?Br({},et.ALLOWED_TAGS,Ue):ee,se=ac(et,"ALLOWED_ATTR")?Br({},et.ALLOWED_ATTR,Ue):pe,de=ac(et,"ALLOWED_NAMESPACES")?Br({},et.ALLOWED_NAMESPACES,pI):vt,xe=ac(et,"ADD_URI_SAFE_ATTR")?Br(md(D),et.ADD_URI_SAFE_ATTR,Ue):D,Lt=ac(et,"ADD_DATA_URI_TAGS")?Br(md(en),et.ADD_DATA_URI_TAGS,Ue):en,jt=ac(et,"FORBID_CONTENTS")?Br({},et.FORBID_CONTENTS,Ue):qt,Ie=ac(et,"FORBID_TAGS")?Br({},et.FORBID_TAGS,Ue):md({}),De=ac(et,"FORBID_ATTR")?Br({},et.FORBID_ATTR,Ue):md({}),ft=ac(et,"USE_PROFILES")?et.USE_PROFILES:!1,Se=et.ALLOW_ARIA_ATTR!==!1,Ce=et.ALLOW_DATA_ATTR!==!1,qe=et.ALLOW_UNKNOWN_PROTOCOLS||!1,Qe=et.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ve=et.SAFE_FOR_TEMPLATES||!1,Ne=et.SAFE_FOR_XML!==!1,K=et.WHOLE_DOCUMENT||!1,le=et.RETURN_DOM||!1,oe=et.RETURN_DOM_FRAGMENT||!1,re=et.RETURN_TRUSTED_TYPE||!1,Ae=et.FORCE_BODY||!1,Te=et.SANITIZE_DOM!==!1,Be=et.SANITIZE_NAMED_PROPS||!1,lt=et.KEEP_CONTENT!==!1,Rt=et.IN_PLACE||!1,W=et.ALLOWED_URI_REGEXP||fX,we=et.NAMESPACE||Fe,ot=et.MATHML_TEXT_INTEGRATION_POINTS||ot,B=et.HTML_INTEGRATION_POINTS||B,ce=et.CUSTOM_ELEMENT_HANDLING||{},et.CUSTOM_ELEMENT_HANDLING&&Y(et.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ce.tagNameCheck=et.CUSTOM_ELEMENT_HANDLING.tagNameCheck),et.CUSTOM_ELEMENT_HANDLING&&Y(et.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ce.attributeNameCheck=et.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),et.CUSTOM_ELEMENT_HANDLING&&typeof et.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ce.allowCustomizedBuiltInElements=et.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ve&&(Ce=!1),oe&&(le=!0),ft&&(Q=Br({},e7),se=[],ft.html===!0&&(Br(Q,Qz),Br(se,t7)),ft.svg===!0&&(Br(Q,mI),Br(se,bI),Br(se,zS)),ft.svgFilters===!0&&(Br(Q,gI),Br(se,bI),Br(se,zS)),ft.mathMl===!0&&(Br(Q,yI),Br(se,n7),Br(se,zS))),et.ADD_TAGS&&(Q===ee&&(Q=md(Q)),Br(Q,et.ADD_TAGS,Ue)),et.ADD_ATTR&&(se===pe&&(se=md(se)),Br(se,et.ADD_ATTR,Ue)),et.ADD_URI_SAFE_ATTR&&Br(xe,et.ADD_URI_SAFE_ATTR,Ue),et.FORBID_CONTENTS&&(jt===qt&&(jt=md(jt)),Br(jt,et.FORBID_CONTENTS,Ue)),lt&&(Q["#text"]=!0),K&&Br(Q,["html","head","body"]),Q.table&&(Br(Q,["tbody"]),delete Ie.tbody),et.TRUSTED_TYPES_POLICY){if(typeof et.TRUSTED_TYPES_POLICY.createHTML!="function")throw Iv('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof et.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Iv('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=et.TRUSTED_TYPES_POLICY,k=C.createHTML("")}else C===void 0&&(C=bIe(m,s)),C!==null&&typeof k=="string"&&(k=C.createHTML(""));ao&&ao(et),kt=et}},J=Br({},[...mI,...gI,...oIe]),be=Br({},[...yI,...lIe]),Pe=function(et){let Vt=S(et);(!Vt||!Vt.tagName)&&(Vt={namespaceURI:we,tagName:"template"});const pn=N2(et.tagName),nr=N2(Vt.tagName);return de[et.namespaceURI]?et.namespaceURI===ge?Vt.namespaceURI===Fe?pn==="svg":Vt.namespaceURI===Z?pn==="svg"&&(nr==="annotation-xml"||ot[nr]):!!J[pn]:et.namespaceURI===Z?Vt.namespaceURI===Fe?pn==="math":Vt.namespaceURI===ge?pn==="math"&&B[nr]:!!be[pn]:et.namespaceURI===Fe?Vt.namespaceURI===ge&&!B[nr]||Vt.namespaceURI===Z&&!ot[nr]?!1:!be[pn]&&(ze[pn]||!J[pn]):!!(st==="application/xhtml+xml"&&de[et.namespaceURI]):!1},Ge=function(et){Nv(t.removed,{element:et});try{S(et).removeChild(et)}catch{v(et)}},_t=function(et,Vt){try{Nv(t.removed,{attribute:Vt.getAttributeNode(et),from:Vt})}catch{Nv(t.removed,{attribute:null,from:Vt})}if(Vt.removeAttribute(et),et==="is")if(le||oe)try{Ge(Vt)}catch{}else try{Vt.setAttribute(et,"")}catch{}},tn=function(et){let Vt=null,pn=null;if(Ae)et="<remove></remove>"+et;else{const es=Jz(et,/^[\r\n\t ]+/);pn=es&&es[0]}st==="application/xhtml+xml"&&we===Fe&&(et='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+et+"</body></html>");const nr=C?C.createHTML(et):et;if(we===Fe)try{Vt=new h().parseFromString(nr,st)}catch{}if(!Vt||!Vt.documentElement){Vt=A.createDocument(we,"template",null);try{Vt.documentElement.innerHTML=Me?k:nr}catch{}}const Ts=Vt.body||Vt.documentElement;return et&&pn&&Ts.insertBefore(n.createTextNode(pn),Ts.childNodes[0]||null),we===Fe?I.call(Vt,K?"html":"body")[0]:K?Vt.documentElement:Ts},Un=function(et){return R.call(et.ownerDocument||et,et,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Xt=function(et){return et instanceof d&&(typeof et.nodeName!="string"||typeof et.textContent!="string"||typeof et.removeChild!="function"||!(et.attributes instanceof u)||typeof et.removeAttribute!="function"||typeof et.setAttribute!="function"||typeof et.namespaceURI!="string"||typeof et.insertBefore!="function"||typeof et.hasChildNodes!="function")},nn=function(et){return typeof o=="function"&&et instanceof o};function un(hn,et,Vt){$S(hn,pn=>{pn.call(t,et,Vt,kt)})}const mr=function(et){let Vt=null;if(un(L.beforeSanitizeElements,et,null),Xt(et))return Ge(et),!0;const pn=Ue(et.nodeName);if(un(L.uponSanitizeElement,et,{tagName:pn,allowedTags:Q}),Ne&&et.hasChildNodes()&&!nn(et.firstElementChild)&&Ya(/<[/\w!]/g,et.innerHTML)&&Ya(/<[/\w!]/g,et.textContent)||et.nodeType===Ov.progressingInstruction||Ne&&et.nodeType===Ov.comment&&Ya(/<[/\w]/g,et.data))return Ge(et),!0;if(!Q[pn]||Ie[pn]){if(!Ie[pn]&&ns(pn)&&(ce.tagNameCheck instanceof RegExp&&Ya(ce.tagNameCheck,pn)||ce.tagNameCheck instanceof Function&&ce.tagNameCheck(pn)))return!1;if(lt&&!jt[pn]){const nr=S(et)||et.parentNode,Ts=w(et)||et.childNodes;if(Ts&&nr){const es=Ts.length;for(let Ii=es-1;Ii>=0;--Ii){const li=b(Ts[Ii],!0);li.__removalCount=(et.__removalCount||0)+1,nr.insertBefore(li,x(et))}}}return Ge(et),!0}return et instanceof l&&!Pe(et)||(pn==="noscript"||pn==="noembed"||pn==="noframes")&&Ya(/<\/no(script|embed|frames)/i,et.innerHTML)?(Ge(et),!0):(Ve&&et.nodeType===Ov.text&&(Vt=et.textContent,$S([P,V,F],nr=>{Vt=Mv(Vt,nr," ")}),et.textContent!==Vt&&(Nv(t.removed,{element:et.cloneNode()}),et.textContent=Vt)),un(L.afterSanitizeElements,et,null),!1)},Ar=function(et,Vt,pn){if(Te&&(Vt==="id"||Vt==="name")&&(pn in n||pn in fe))return!1;if(!(Ce&&!De[Vt]&&Ya(X,Vt))){if(!(Se&&Ya(U,Vt))){if(!se[Vt]||De[Vt]){if(!(ns(et)&&(ce.tagNameCheck instanceof RegExp&&Ya(ce.tagNameCheck,et)||ce.tagNameCheck instanceof Function&&ce.tagNameCheck(et))&&(ce.attributeNameCheck instanceof RegExp&&Ya(ce.attributeNameCheck,Vt)||ce.attributeNameCheck instanceof Function&&ce.attributeNameCheck(Vt))||Vt==="is"&&ce.allowCustomizedBuiltInElements&&(ce.tagNameCheck instanceof RegExp&&Ya(ce.tagNameCheck,pn)||ce.tagNameCheck instanceof Function&&ce.tagNameCheck(pn))))return!1}else if(!xe[Vt]){if(!Ya(W,Mv(pn,$,""))){if(!((Vt==="src"||Vt==="xlink:href"||Vt==="href")&&et!=="script"&&rIe(pn,"data:")===0&&Lt[et])){if(!(qe&&!Ya(H,Mv(pn,$,"")))){if(pn)return!1}}}}}}return!0},ns=function(et){return et!=="annotation-xml"&&Jz(et,ne)},rs=function(et){un(L.beforeSanitizeAttributes,et,null);const{attributes:Vt}=et;if(!Vt||Xt(et))return;const pn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:se,forceKeepAttr:void 0};let nr=Vt.length;for(;nr--;){const Ts=Vt[nr],{name:es,namespaceURI:Ii,value:li}=Ts,qa=Ue(es),ca=li;let Vs=es==="value"?ca:sIe(ca);if(pn.attrName=qa,pn.attrValue=Vs,pn.keepAttr=!0,pn.forceKeepAttr=void 0,un(L.uponSanitizeAttribute,et,pn),Vs=pn.attrValue,Be&&(qa==="id"||qa==="name")&&(_t(es,et),Vs=ke+Vs),Ne&&Ya(/((--!?|])>)|<\/(style|title)/i,Vs)){_t(es,et);continue}if(pn.forceKeepAttr)continue;if(!pn.keepAttr){_t(es,et);continue}if(!Qe&&Ya(/\/>/i,Vs)){_t(es,et);continue}Ve&&$S([P,V,F],yl=>{Vs=Mv(Vs,yl," ")});const zo=Ue(et.nodeName);if(!Ar(zo,qa,Vs)){_t(es,et);continue}if(C&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!Ii)switch(m.getAttributeType(zo,qa)){case"TrustedHTML":{Vs=C.createHTML(Vs);break}case"TrustedScriptURL":{Vs=C.createScriptURL(Vs);break}}if(Vs!==ca)try{Ii?et.setAttributeNS(Ii,es,Vs):et.setAttribute(es,Vs),Xt(et)?Ge(et):Xz(t.removed)}catch{_t(es,et)}}un(L.afterSanitizeAttributes,et,null)},Cr=function hn(et){let Vt=null;const pn=Un(et);for(un(L.beforeSanitizeShadowDOM,et,null);Vt=pn.nextNode();)un(L.uponSanitizeShadowNode,Vt,null),mr(Vt),rs(Vt),Vt.content instanceof i&&hn(Vt.content);un(L.afterSanitizeShadowDOM,et,null)};return t.sanitize=function(hn){let et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=null,pn=null,nr=null,Ts=null;if(Me=!hn,Me&&(hn="<!-->"),typeof hn!="string"&&!nn(hn))if(typeof hn.toString=="function"){if(hn=hn.toString(),typeof hn!="string")throw Iv("dirty is not a string, aborting")}else throw Iv("toString is not a function");if(!t.isSupported)return hn;if(me||G(et),t.removed=[],typeof hn=="string"&&(Rt=!1),Rt){if(hn.nodeName){const li=Ue(hn.nodeName);if(!Q[li]||Ie[li])throw Iv("root node is forbidden and cannot be sanitized in-place")}}else if(hn instanceof o)Vt=tn("<!---->"),pn=Vt.ownerDocument.importNode(hn,!0),pn.nodeType===Ov.element&&pn.nodeName==="BODY"||pn.nodeName==="HTML"?Vt=pn:Vt.appendChild(pn);else{if(!le&&!Ve&&!K&&hn.indexOf("<")===-1)return C&&re?C.createHTML(hn):hn;if(Vt=tn(hn),!Vt)return le?null:re?k:""}Vt&&Ae&&Ge(Vt.firstChild);const es=Un(Rt?hn:Vt);for(;nr=es.nextNode();)mr(nr),rs(nr),nr.content instanceof i&&Cr(nr.content);if(Rt)return hn;if(le){if(oe)for(Ts=N.call(Vt.ownerDocument);Vt.firstChild;)Ts.appendChild(Vt.firstChild);else Ts=Vt;return(se.shadowroot||se.shadowrootmode)&&(Ts=O.call(r,Ts,!0)),Ts}let Ii=K?Vt.outerHTML:Vt.innerHTML;return K&&Q["!doctype"]&&Vt.ownerDocument&&Vt.ownerDocument.doctype&&Vt.ownerDocument.doctype.name&&Ya(hX,Vt.ownerDocument.doctype.name)&&(Ii="<!DOCTYPE "+Vt.ownerDocument.doctype.name+`>
`+Ii),Ve&&$S([P,V,F],li=>{Ii=Mv(Ii,li," ")}),C&&re?C.createHTML(Ii):Ii},t.setConfig=function(){let hn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};G(hn),me=!0},t.clearConfig=function(){kt=null,me=!1},t.isValidAttribute=function(hn,et,Vt){kt||G({});const pn=Ue(hn),nr=Ue(et);return Ar(pn,nr,Vt)},t.addHook=function(hn,et){typeof et=="function"&&Nv(L[hn],et)},t.removeHook=function(hn,et){if(et!==void 0){const Vt=tIe(L[hn],et);return Vt===-1?void 0:nIe(L[hn],Vt,1)[0]}return Xz(L[hn])},t.removeHooks=function(hn){L[hn]=[]},t.removeAllHooks=function(){L=s7()},t}var hy=pX(),mX=Object.defineProperty,ie=(e,t)=>mX(e,"name",{value:t,configurable:!0}),vIe=(e,t)=>{for(var n in t)mX(e,n,{get:t[n],enumerable:!0})},cd={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},zt={trace:ie((...e)=>{},"trace"),debug:ie((...e)=>{},"debug"),info:ie((...e)=>{},"info"),warn:ie((...e)=>{},"warn"),error:ie((...e)=>{},"error"),fatal:ie((...e)=>{},"fatal")},bD=ie(function(e="fatal"){let t=cd.fatal;typeof e=="string"?e.toLowerCase()in cd&&(t=cd[e]):typeof e=="number"&&(t=e),zt.trace=()=>{},zt.debug=()=>{},zt.info=()=>{},zt.warn=()=>{},zt.error=()=>{},zt.fatal=()=>{},t<=cd.fatal&&(zt.fatal=console.error?console.error.bind(console,Nl("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",Nl("FATAL"))),t<=cd.error&&(zt.error=console.error?console.error.bind(console,Nl("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",Nl("ERROR"))),t<=cd.warn&&(zt.warn=console.warn?console.warn.bind(console,Nl("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",Nl("WARN"))),t<=cd.info&&(zt.info=console.info?console.info.bind(console,Nl("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",Nl("INFO"))),t<=cd.debug&&(zt.debug=console.debug?console.debug.bind(console,Nl("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Nl("DEBUG"))),t<=cd.trace&&(zt.trace=console.debug?console.debug.bind(console,Nl("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Nl("TRACE")))},"setLogLevel"),Nl=ie(e=>`%c${VMe().format("ss.SSS")} : ${e} : `,"format"),gX=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,bx=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,xIe=/\s*%%.*\n/gm,P0,yX=(P0=class extends Error{constructor(t){super(t),this.name="UnknownDiagramError"}},ie(P0,"UnknownDiagramError"),P0),py={},vD=ie(function(e,t){e=e.replace(gX,"").replace(bx,"").replace(xIe,`
`);for(const[n,{detector:r}]of Object.entries(py))if(r(e,t))return n;throw new yX(`No diagram type detected matching given configuration for text: ${e}`)},"detectType"),bX=ie((...e)=>{for(const{id:t,detector:n,loader:r}of e)vX(t,n,r)},"registerLazyLoadedDiagrams"),vX=ie((e,t,n)=>{py[e]&&zt.warn(`Detector with key ${e} already exists. Overwriting.`),py[e]={detector:t,loader:n},zt.debug(`Detector with key ${e} added${n?" with loader":""}`)},"addDetector"),wIe=ie(e=>py[e].loader,"getDiagramLoader"),Oj=ie((e,t,{depth:n=2,clobber:r=!1}={})=>{const s={depth:n,clobber:r};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(i=>Oj(e,i,s)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(i=>{e.includes(i)||e.push(i)}),e):e===void 0||n<=0?e!=null&&typeof e=="object"&&typeof t=="object"?Object.assign(e,t):t:(t!==void 0&&typeof e=="object"&&typeof t=="object"&&Object.keys(t).forEach(i=>{typeof t[i]=="object"&&(e[i]===void 0||typeof e[i]=="object")?(e[i]===void 0&&(e[i]=Array.isArray(t[i])?[]:{}),e[i]=Oj(e[i],t[i],{depth:n-1,clobber:r})):(r||typeof e[i]!="object"&&typeof t[i]!="object")&&(e[i]=t[i])}),e)},"assignWithDepth"),va=Oj,lT="#ffffff",cT="#f2f2f2",Xa=ie((e,t)=>t?yt(e,{s:-40,l:10}):yt(e,{s:-40,l:-10}),"mkBorder"),D0,_Ie=(D0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){var n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k,A;if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||yt(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||yt(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||Xa(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||Xa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||Xa(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||Xa(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||cn(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||cn(this.tertiaryColor),this.lineColor=this.lineColor||cn(this.background),this.arrowheadColor=this.arrowheadColor||cn(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?$n(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||this.actorBorder,this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||$n(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||cn(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||wn(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.darkMode?(this.rowOdd=this.rowOdd||$n(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||$n(this.mainBkg,10)):(this.rowOdd=this.rowOdd||wn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||wn(this.mainBkg,5)),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||yt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||yt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||yt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||yt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||yt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||yt(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||yt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||yt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||yt(this.primaryColor,{h:330}),this.darkMode)for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=$n(this["cScale"+R],75);else for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=$n(this["cScale"+R],25);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleInv"+R]=this["cScaleInv"+R]||cn(this["cScale"+R]);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this.darkMode?this["cScalePeer"+R]=this["cScalePeer"+R]||wn(this["cScale"+R],10):this["cScalePeer"+R]=this["cScalePeer"+R]||$n(this["cScale"+R],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleLabel"+R]=this["cScaleLabel"+R]||this.scaleLabelColor;const t=this.darkMode?-4:-1;for(let R=0;R<5;R++)this["surface"+R]=this["surface"+R]||yt(this.mainBkg,{h:180,s:-15,l:t*(5+R*3)}),this["surfacePeer"+R]=this["surfacePeer"+R]||yt(this.mainBkg,{h:180,s:-15,l:t*(8+R*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||yt(this.primaryColor,{h:64}),this.fillType3=this.fillType3||yt(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||yt(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||yt(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||yt(this.primaryColor,{h:128}),this.fillType7=this.fillType7||yt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||yt(this.primaryColor,{l:-10}),this.pie5=this.pie5||yt(this.secondaryColor,{l:-10}),this.pie6=this.pie6||yt(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||yt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||yt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||yt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||yt(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||yt(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||yt(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.radar={axisColor:((n=this.radar)==null?void 0:n.axisColor)||this.lineColor,axisStrokeWidth:((r=this.radar)==null?void 0:r.axisStrokeWidth)||2,axisLabelFontSize:((s=this.radar)==null?void 0:s.axisLabelFontSize)||12,curveOpacity:((i=this.radar)==null?void 0:i.curveOpacity)||.5,curveStrokeWidth:((a=this.radar)==null?void 0:a.curveStrokeWidth)||2,graticuleColor:((o=this.radar)==null?void 0:o.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((l=this.radar)==null?void 0:l.graticuleStrokeWidth)||1,graticuleOpacity:((c=this.radar)==null?void 0:c.graticuleOpacity)||.3,legendBoxSize:((u=this.radar)==null?void 0:u.legendBoxSize)||12,legendFontSize:((d=this.radar)==null?void 0:d.legendFontSize)||12},this.archEdgeColor=this.archEdgeColor||"#777",this.archEdgeArrowColor=this.archEdgeArrowColor||"#777",this.archEdgeWidth=this.archEdgeWidth||"3",this.archGroupBorderColor=this.archGroupBorderColor||"#000",this.archGroupBorderWidth=this.archGroupBorderWidth||"2px",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||yt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||yt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||yt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||yt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||yt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||yt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||B1(this.quadrant1Fill)?wn(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((h=this.xyChart)==null?void 0:h.backgroundColor)||this.background,titleColor:((m=this.xyChart)==null?void 0:m.titleColor)||this.primaryTextColor,xAxisTitleColor:((y=this.xyChart)==null?void 0:y.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((b=this.xyChart)==null?void 0:b.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((v=this.xyChart)==null?void 0:v.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((x=this.xyChart)==null?void 0:x.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((w=this.xyChart)==null?void 0:w.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((S=this.xyChart)==null?void 0:S.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((C=this.xyChart)==null?void 0:C.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((A=this.xyChart)==null?void 0:A.plotColorPalette)||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?$n(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||yt(this.primaryColor,{h:-30}),this.git4=this.git4||yt(this.primaryColor,{h:-60}),this.git5=this.git5||yt(this.primaryColor,{h:-90}),this.git6=this.git6||yt(this.primaryColor,{h:60}),this.git7=this.git7||yt(this.primaryColor,{h:120}),this.darkMode?(this.git0=wn(this.git0,25),this.git1=wn(this.git1,25),this.git2=wn(this.git2,25),this.git3=wn(this.git3,25),this.git4=wn(this.git4,25),this.git5=wn(this.git5,25),this.git6=wn(this.git6,25),this.git7=wn(this.git7,25)):(this.git0=$n(this.git0,25),this.git1=$n(this.git1,25),this.git2=$n(this.git2,25),this.git3=$n(this.git3,25),this.git4=$n(this.git4,25),this.git5=$n(this.git5,25),this.git6=$n(this.git6,25),this.git7=$n(this.git7,25)),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||lT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||cT}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(D0,"Theme"),D0),SIe=ie(e=>{const t=new _Ie;return t.calculate(e),t},"getThemeVariables"),F0,CIe=(F0=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=wn(this.primaryColor,16),this.tertiaryColor=yt(this.primaryColor,{h:-160}),this.primaryBorderColor=cn(this.background),this.secondaryBorderColor=Xa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Xa(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=wn(cn("#323D47"),10),this.lineColor="calculated",this.border1="#ccc",this.border2=yx(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=$n("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=$n(this.sectionBkgColor,10),this.taskBorderColor=yx(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=yx(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||wn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||$n(this.mainBkg,10),this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k;this.secondBkg=wn(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=wn(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.actorBorder,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=wn(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=yt(this.primaryColor,{h:64}),this.fillType3=yt(this.secondaryColor,{h:64}),this.fillType4=yt(this.primaryColor,{h:-64}),this.fillType5=yt(this.secondaryColor,{h:-64}),this.fillType6=yt(this.primaryColor,{h:128}),this.fillType7=yt(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||yt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||yt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||yt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||yt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||yt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||yt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||yt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||yt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||yt(this.primaryColor,{h:330});for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||cn(this["cScale"+A]);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScalePeer"+A]=this["cScalePeer"+A]||wn(this["cScale"+A],10);for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||yt(this.mainBkg,{h:30,s:-30,l:-(-10+A*4)}),this["surfacePeer"+A]=this["surfacePeer"+A]||yt(this.mainBkg,{h:30,s:-30,l:-(-7+A*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["pie"+A]=this["cScale"+A];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||yt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||yt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||yt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||yt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||yt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||yt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||B1(this.quadrant1Fill)?wn(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.background},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((C=this.radar)==null?void 0:C.legendBoxSize)||12,legendFontSize:((k=this.radar)==null?void 0:k.legendFontSize)||12},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?$n(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=wn(this.secondaryColor,20),this.git1=wn(this.pie2||this.secondaryColor,20),this.git2=wn(this.pie3||this.tertiaryColor,20),this.git3=wn(this.pie4||yt(this.primaryColor,{h:-30}),20),this.git4=wn(this.pie5||yt(this.primaryColor,{h:-60}),20),this.git5=wn(this.pie6||yt(this.primaryColor,{h:-90}),10),this.git6=wn(this.pie7||yt(this.primaryColor,{h:60}),10),this.git7=wn(this.pie8||yt(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||wn(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||wn(this.background,2),this.nodeBorder=this.nodeBorder||"#999"}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(F0,"Theme"),F0),kIe=ie(e=>{const t=new CIe;return t.calculate(e),t},"getThemeVariables"),L0,EIe=(L0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=yt(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=yt(this.primaryColor,{h:-160}),this.primaryBorderColor=Xa(this.primaryColor,this.darkMode),this.secondaryBorderColor=Xa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Xa(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="rgba(232,232,232, 0.8)",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=yx(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd="calculated",this.rowEven="calculated",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k;this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||yt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||yt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||yt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||yt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||yt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||yt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||yt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||yt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||yt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||$n(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||$n(this.tertiaryColor,40);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=$n(this["cScale"+A],10),this["cScalePeer"+A]=this["cScalePeer"+A]||$n(this["cScale"+A],25);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||yt(this["cScale"+A],{h:180});for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||yt(this.mainBkg,{h:30,l:-(5+A*5)}),this["surfacePeer"+A]=this["surfacePeer"+A]||yt(this.mainBkg,{h:30,l:-(7+A*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||cn(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||cn(this.labelTextColor);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=wn(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||wn(this.primaryColor,75)||"#ffffff",this.rowEven=this.rowEven||wn(this.primaryColor,1),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=yt(this.primaryColor,{h:64}),this.fillType3=yt(this.secondaryColor,{h:64}),this.fillType4=yt(this.primaryColor,{h:-64}),this.fillType5=yt(this.secondaryColor,{h:-64}),this.fillType6=yt(this.primaryColor,{h:128}),this.fillType7=yt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||yt(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||yt(this.primaryColor,{l:-10}),this.pie5=this.pie5||yt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||yt(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||yt(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||yt(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||yt(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||yt(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||yt(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||yt(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||yt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||yt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||yt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||yt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||yt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||yt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||B1(this.quadrant1Fill)?wn(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((k=this.xyChart)==null?void 0:k.plotColorPalette)||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||yt(this.primaryColor,{h:-30}),this.git4=this.git4||yt(this.primaryColor,{h:-60}),this.git5=this.git5||yt(this.primaryColor,{h:-90}),this.git6=this.git6||yt(this.primaryColor,{h:60}),this.git7=this.git7||yt(this.primaryColor,{h:120}),this.darkMode?(this.git0=wn(this.git0,25),this.git1=wn(this.git1,25),this.git2=wn(this.git2,25),this.git3=wn(this.git3,25),this.git4=wn(this.git4,25),this.git5=wn(this.git5,25),this.git6=wn(this.git6,25),this.git7=wn(this.git7,25)):(this.git0=$n(this.git0,25),this.git1=$n(this.git1,25),this.git2=$n(this.git2,25),this.git3=$n(this.git3,25),this.git4=$n(this.git4,25),this.git5=$n(this.git5,25),this.git6=$n(this.git6,25),this.git7=$n(this.git7,25)),this.gitInv0=this.gitInv0||$n(cn(this.git0),25),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||lT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||cT}calculate(t){if(Object.keys(this).forEach(r=>{this[r]==="calculated"&&(this[r]=void 0)}),typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(L0,"Theme"),L0),TIe=ie(e=>{const t=new EIe;return t.calculate(e),t},"getThemeVariables"),B0,AIe=(B0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=wn("#cde498",10),this.primaryBorderColor=Xa(this.primaryColor,this.darkMode),this.secondaryBorderColor=Xa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Xa(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.primaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k;this.actorBorder=$n(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||yt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||yt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||yt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||yt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||yt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||yt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||yt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||yt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||yt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||$n(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||$n(this.tertiaryColor,40);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=$n(this["cScale"+A],10),this["cScalePeer"+A]=this["cScalePeer"+A]||$n(this["cScale"+A],25);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||yt(this["cScale"+A],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||yt(this.mainBkg,{h:30,s:-30,l:-(5+A*5)}),this["surfacePeer"+A]=this["surfacePeer"+A]||yt(this.mainBkg,{h:30,s:-30,l:-(8+A*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||wn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||wn(this.mainBkg,20),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=yt(this.primaryColor,{h:64}),this.fillType3=yt(this.secondaryColor,{h:64}),this.fillType4=yt(this.primaryColor,{h:-64}),this.fillType5=yt(this.secondaryColor,{h:-64}),this.fillType6=yt(this.primaryColor,{h:128}),this.fillType7=yt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||yt(this.primaryColor,{l:-30}),this.pie5=this.pie5||yt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||yt(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||yt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||yt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||yt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||yt(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||yt(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||yt(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||yt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||yt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||yt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||yt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||yt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||yt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||B1(this.quadrant1Fill)?wn(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.mainBkg},this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((k=this.xyChart)==null?void 0:k.plotColorPalette)||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||yt(this.primaryColor,{h:-30}),this.git4=this.git4||yt(this.primaryColor,{h:-60}),this.git5=this.git5||yt(this.primaryColor,{h:-90}),this.git6=this.git6||yt(this.primaryColor,{h:60}),this.git7=this.git7||yt(this.primaryColor,{h:120}),this.darkMode?(this.git0=wn(this.git0,25),this.git1=wn(this.git1,25),this.git2=wn(this.git2,25),this.git3=wn(this.git3,25),this.git4=wn(this.git4,25),this.git5=wn(this.git5,25),this.git6=wn(this.git6,25),this.git7=wn(this.git7,25)):(this.git0=$n(this.git0,25),this.git1=$n(this.git1,25),this.git2=$n(this.git2,25),this.git3=$n(this.git3,25),this.git4=$n(this.git4,25),this.git5=$n(this.git5,25),this.git6=$n(this.git6,25),this.git7=$n(this.git7,25)),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||lT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||cT}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(B0,"Theme"),B0),RIe=ie(e=>{const t=new AIe;return t.calculate(e),t},"getThemeVariables"),$0,NIe=($0=class{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=wn(this.contrast,55),this.background="#ffffff",this.tertiaryColor=yt(this.primaryColor,{h:-160}),this.primaryBorderColor=Xa(this.primaryColor,this.darkMode),this.secondaryBorderColor=Xa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Xa(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor=this.actorBorder,this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||wn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||"#f4f4f4",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k;this.secondBkg=wn(this.contrast,55),this.border2=this.contrast,this.actorBorder=wn(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.actorBorder,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||cn(this["cScale"+A]);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this.darkMode?this["cScalePeer"+A]=this["cScalePeer"+A]||wn(this["cScale"+A],10):this["cScalePeer"+A]=this["cScalePeer"+A]||$n(this["cScale"+A],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||yt(this.mainBkg,{l:-(5+A*5)}),this["surfacePeer"+A]=this["surfacePeer"+A]||yt(this.mainBkg,{l:-(8+A*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=wn(this.contrast,30),this.sectionBkgColor2=wn(this.contrast,30),this.taskBorderColor=$n(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=wn(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=$n(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=yt(this.primaryColor,{h:64}),this.fillType3=yt(this.secondaryColor,{h:64}),this.fillType4=yt(this.primaryColor,{h:-64}),this.fillType5=yt(this.secondaryColor,{h:-64}),this.fillType6=yt(this.primaryColor,{h:128}),this.fillType7=yt(this.secondaryColor,{h:128});for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["pie"+A]=this["cScale"+A];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||yt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||yt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||yt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||yt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||yt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||yt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||B1(this.quadrant1Fill)?wn(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((C=this.radar)==null?void 0:C.legendBoxSize)||12,legendFontSize:((k=this.radar)==null?void 0:k.legendFontSize)||12},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=$n(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||yt(this.primaryColor,{h:-30}),this.git4=this.pie5||yt(this.primaryColor,{h:-60}),this.git5=this.pie6||yt(this.primaryColor,{h:-90}),this.git6=this.pie7||yt(this.primaryColor,{h:60}),this.git7=this.pie8||yt(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||lT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||cT}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie($0,"Theme"),$0),MIe=ie(e=>{const t=new NIe;return t.calculate(e),t},"getThemeVariables"),Id={base:{getThemeVariables:SIe},dark:{getThemeVariables:kIe},default:{getThemeVariables:TIe},forest:{getThemeVariables:RIe},neutral:{getThemeVariables:MIe}},ud={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1,hideEmptyMembersBox:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,nodeSpacing:140,rankSpacing:80,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},kanban:{useMaxWidth:!0,padding:8,sectionWidth:200,ticketBaseUrl:""},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},packet:{useMaxWidth:!0,rowHeight:32,bitWidth:32,bitsPerRow:32,showBits:!0,paddingX:5,paddingY:5},architecture:{useMaxWidth:!0,padding:40,iconSize:80,fontSize:16},radar:{useMaxWidth:!0,width:600,height:600,marginTop:50,marginRight:50,marginBottom:50,marginLeft:50,axisScaleFactor:1,axisLabelFactor:1.05,curveTension:.17},theme:"default",look:"classic",handDrawnSeed:0,layout:"dagre",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","suppressErrorRendering","maxEdges"],legacyMathML:!1,forceLegacyMathML:!1,deterministicIds:!1,fontSize:16,markdownAutoWrap:!0,suppressErrorRendering:!1},xX={...ud,deterministicIDSeed:void 0,elk:{mergeEdges:!1,nodePlacementStrategy:"BRANDES_KOEPF"},themeCSS:void 0,themeVariables:Id.default.getThemeVariables(),sequence:{...ud.sequence,messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont"),noteFont:ie(function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},"noteFont"),actorFont:ie(function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}},"actorFont")},class:{hideEmptyMembersBox:!1},gantt:{...ud.gantt,tickInterval:void 0,useWidth:void 0},c4:{...ud.c4,useWidth:void 0,personFont:ie(function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},"personFont"),external_personFont:ie(function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},"external_personFont"),systemFont:ie(function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},"systemFont"),external_systemFont:ie(function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},"external_systemFont"),system_dbFont:ie(function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},"system_dbFont"),external_system_dbFont:ie(function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},"external_system_dbFont"),system_queueFont:ie(function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},"system_queueFont"),external_system_queueFont:ie(function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},"external_system_queueFont"),containerFont:ie(function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},"containerFont"),external_containerFont:ie(function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},"external_containerFont"),container_dbFont:ie(function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},"container_dbFont"),external_container_dbFont:ie(function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},"external_container_dbFont"),container_queueFont:ie(function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},"container_queueFont"),external_container_queueFont:ie(function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},"external_container_queueFont"),componentFont:ie(function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},"componentFont"),external_componentFont:ie(function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},"external_componentFont"),component_dbFont:ie(function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},"component_dbFont"),external_component_dbFont:ie(function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},"external_component_dbFont"),component_queueFont:ie(function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},"component_queueFont"),external_component_queueFont:ie(function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},"external_component_queueFont"),boundaryFont:ie(function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},"boundaryFont"),messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont")},pie:{...ud.pie,useWidth:984},xyChart:{...ud.xyChart,useWidth:void 0},requirement:{...ud.requirement,useWidth:void 0},packet:{...ud.packet},radar:{...ud.radar}},wX=ie((e,t="")=>Object.keys(e).reduce((n,r)=>Array.isArray(e[r])?n:typeof e[r]=="object"&&e[r]!==null?[...n,t+r,...wX(e[r],"")]:[...n,t+r],[]),"keyify"),IIe=new Set(wX(xX,"")),_X=xX,ek=ie(e=>{if(zt.debug("sanitizeDirective called with",e),!(typeof e!="object"||e==null)){if(Array.isArray(e)){e.forEach(t=>ek(t));return}for(const t of Object.keys(e)){if(zt.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!IIe.has(t)||e[t]==null){zt.debug("sanitize deleting key: ",t),delete e[t];continue}if(typeof e[t]=="object"){zt.debug("sanitizing object",t),ek(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const r of n)t.includes(r)&&(zt.debug("sanitizing css option",t),e[t]=jIe(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];n!=null&&n.match&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}zt.debug("After sanitization",e)}},"sanitizeDirective"),jIe=ie(e=>{let t=0,n=0;for(const r of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";r==="{"?t++:r==="}"&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e},"sanitizeCss"),my=Object.freeze(_X),vo=va({},my),SX,gy=[],vx=va({},my),uT=ie((e,t)=>{let n=va({},e),r={};for(const s of t)EX(s),r=va(r,s);if(n=va(n,r),r.theme&&r.theme in Id){const s=va({},SX),i=va(s.themeVariables||{},r.themeVariables);n.theme&&n.theme in Id&&(n.themeVariables=Id[n.theme].getThemeVariables(i))}return vx=n,TX(vx),vx},"updateCurrentConfig"),OIe=ie(e=>(vo=va({},my),vo=va(vo,e),e.theme&&Id[e.theme]&&(vo.themeVariables=Id[e.theme].getThemeVariables(e.themeVariables)),uT(vo,gy),vo),"setSiteConfig"),PIe=ie(e=>{SX=va({},e)},"saveConfigFromInitialize"),DIe=ie(e=>(vo=va(vo,e),uT(vo,gy),vo),"updateSiteConfig"),CX=ie(()=>va({},vo),"getSiteConfig"),kX=ie(e=>(TX(e),va(vx,e),Ro()),"setConfig"),Ro=ie(()=>va({},vx),"getConfig"),EX=ie(e=>{e&&(["secure",...vo.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(zt.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{typeof e[t]=="string"&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],typeof e[t]=="object"&&EX(e[t])}))},"sanitize"),FIe=ie(e=>{var t;ek(e),e.fontFamily&&!((t=e.themeVariables)!=null&&t.fontFamily)&&(e.themeVariables={...e.themeVariables,fontFamily:e.fontFamily}),gy.push(e),uT(vo,gy)},"addDirective"),tk=ie((e=vo)=>{gy=[],uT(e,gy)},"reset"),LIe={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},i7={},BIe=ie(e=>{i7[e]||(zt.warn(LIe[e]),i7[e]=!0)},"issueWarning"),TX=ie(e=>{e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&BIe("LAZY_LOAD_DEPRECATED")},"checkConfig"),$1=/<br\s*\/?>/gi,$Ie=ie(e=>e?NX(e).replace(/\\n/g,"#br#").split("#br#"):[""],"getRows"),zIe=(()=>{let e=!1;return()=>{e||(AX(),e=!0)}})();function AX(){const e="data-temp-href-target";hy.addHook("beforeSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute("target")&&t.setAttribute(e,t.getAttribute("target")??"")}),hy.addHook("afterSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute(e)&&(t.setAttribute("target",t.getAttribute(e)??""),t.removeAttribute(e),t.getAttribute("target")==="_blank"&&t.setAttribute("rel","noopener"))})}ie(AX,"setupDompurifyHooks");var RX=ie(e=>(zIe(),hy.sanitize(e)),"removeScript"),a7=ie((e,t)=>{var n;if(((n=t.flowchart)==null?void 0:n.htmlLabels)!==!1){const r=t.securityLevel;r==="antiscript"||r==="strict"?e=RX(e):r!=="loose"&&(e=NX(e),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/=/g,"&equals;"),e=WIe(e))}return e},"sanitizeMore"),ym=ie((e,t)=>e&&(t.dompurifyConfig?e=hy.sanitize(a7(e,t),t.dompurifyConfig).toString():e=hy.sanitize(a7(e,t),{FORBID_TAGS:["style"]}).toString(),e),"sanitizeText"),UIe=ie((e,t)=>typeof e=="string"?ym(e,t):e.flat().map(n=>ym(n,t)),"sanitizeTextOrArray"),qIe=ie(e=>$1.test(e),"hasBreaks"),VIe=ie(e=>e.split($1),"splitBreaks"),WIe=ie(e=>e.replace(/#br#/g,"<br/>"),"placeholderToBreak"),NX=ie(e=>e.replace($1,"#br#"),"breakToPlaceholder"),HIe=ie(e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},"getUrl"),Vi=ie(e=>!(e===!1||["false","null","0"].includes(String(e).trim().toLowerCase())),"evaluate"),GIe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.max(...t)},"getMax"),KIe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.min(...t)},"getMin"),o7=ie(function(e){const t=e.split(/(,)/),n=[];for(let r=0;r<t.length;r++){let s=t[r];if(s===","&&r>0&&r+1<t.length){const i=t[r-1],a=t[r+1];YIe(i,a)&&(s=i+","+a,r++,n.pop())}n.push(ZIe(s))}return n.join("")},"parseGenericTypes"),Pj=ie((e,t)=>Math.max(0,e.split(t).length-1),"countOccurrence"),YIe=ie((e,t)=>{const n=Pj(e,"~"),r=Pj(t,"~");return n===1&&r===1},"shouldCombineSets"),ZIe=ie(e=>{const t=Pj(e,"~");let n=!1;if(t<=1)return e;t%2!==0&&e.startsWith("~")&&(e=e.substring(1),n=!0);const r=[...e];let s=r.indexOf("~"),i=r.lastIndexOf("~");for(;s!==-1&&i!==-1&&s!==i;)r[s]="<",r[i]=">",s=r.indexOf("~"),i=r.lastIndexOf("~");return n&&r.unshift("~"),r.join("")},"processSet"),l7=ie(()=>window.MathMLElement!==void 0,"isMathMLSupported"),Dj=/\$\$(.*)\$\$/g,yy=ie(e=>{var t;return(((t=e.match(Dj))==null?void 0:t.length)??0)>0},"hasKatex"),Out=ie(async(e,t)=>{e=await xD(e,t);const n=document.createElement("div");n.innerHTML=e,n.id="katex-temp",n.style.visibility="hidden",n.style.position="absolute",n.style.top="0";const r=document.querySelector("body");r==null||r.insertAdjacentElement("beforeend",n);const s={width:n.clientWidth,height:n.clientHeight};return n.remove(),s},"calculateMathMLDimensions"),xD=ie(async(e,t)=>{if(!yy(e))return e;if(!(l7()||t.legacyMathML||t.forceLegacyMathML))return e.replace(Dj,"MathML is unsupported in this environment.");const{default:n}=await Zr(async()=>{const{default:s}=await import("./katex-ChWnQ-fc.js");return{default:s}},[]),r=t.forceLegacyMathML||!l7()&&t.legacyMathML?"htmlAndMathml":"mathml";return e.split($1).map(s=>yy(s)?`<div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">${s}</div>`:`<div>${s}</div>`).join("").replace(Dj,(s,i)=>n.renderToString(i,{throwOnError:!0,displayMode:!0,output:r}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))},"renderKatex"),Qy={getRows:$Ie,sanitizeText:ym,sanitizeTextOrArray:UIe,hasBreaks:qIe,splitBreaks:VIe,lineBreakRegex:$1,removeScript:RX,getUrl:HIe,evaluate:Vi,getMax:GIe,getMin:KIe},XIe=ie(function(e,t){for(let n of t)e.attr(n[0],n[1])},"d3Attrs"),JIe=ie(function(e,t,n){let r=new Map;return n?(r.set("width","100%"),r.set("style",`max-width: ${t}px;`)):(r.set("height",e),r.set("width",t)),r},"calculateSvgSizeAttrs"),MX=ie(function(e,t,n,r){const s=JIe(t,n,r);XIe(e,s)},"configureSvgSize"),QIe=ie(function(e,t,n,r){const s=t.node().getBBox(),i=s.width,a=s.height;zt.info(`SVG bounds: ${i}x${a}`,s);let o=0,l=0;zt.info(`Graph bounds: ${o}x${l}`,e),o=i+n*2,l=a+n*2,zt.info(`Calculated bounds: ${o}x${l}`),MX(t,l,o,r);const c=`${s.x-n} ${s.y-n} ${s.width+2*n} ${s.height+2*n}`;t.attr("viewBox",c)},"setupGraphViewbox"),M2={},e3e=ie((e,t,n)=>{let r="";return e in M2&&M2[e]?r=M2[e](n):zt.warn(`No theme found for ${e}`),` & {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
    fill: ${n.textColor}
  }
  @keyframes edge-animation-frame {
    from {
      stroke-dashoffset: 0;
    }
  }
  @keyframes dash {
    to {
      stroke-dashoffset: 0;
    }
  }
  & .edge-animation-slow {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 50s linear infinite;
    stroke-linecap: round;
  }
  & .edge-animation-fast {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 20s linear infinite;
    stroke-linecap: round;
  }
  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${n.errorBkgColor};
  }
  & .error-text {
    fill: ${n.errorTextColor};
    stroke: ${n.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 1px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }
  & .edge-thickness-invisible {
    stroke-width: 0;
    fill: none;
  }
  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${n.lineColor};
    stroke: ${n.lineColor};
  }
  & .marker.cross {
    stroke: ${n.lineColor};
  }

  & svg {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
  }
   & p {
    margin: 0
   }

  ${r}

  ${t}
`},"getStyles"),t3e=ie((e,t)=>{t!==void 0&&(M2[e]=t)},"addStylesForDiagram"),n3e=e3e,IX={};vIe(IX,{clear:()=>r3e,getAccDescription:()=>o3e,getAccTitle:()=>i3e,getDiagramTitle:()=>c3e,setAccDescription:()=>a3e,setAccTitle:()=>s3e,setDiagramTitle:()=>l3e});var wD="",_D="",SD="",CD=ie(e=>ym(e,Ro()),"sanitizeText"),r3e=ie(()=>{wD="",SD="",_D=""},"clear"),s3e=ie(e=>{wD=CD(e).replace(/^\s+/g,"")},"setAccTitle"),i3e=ie(()=>wD,"getAccTitle"),a3e=ie(e=>{SD=CD(e).replace(/\n\s+/g,`
`)},"setAccDescription"),o3e=ie(()=>SD,"getAccDescription"),l3e=ie(e=>{_D=CD(e)},"setDiagramTitle"),c3e=ie(()=>_D,"getDiagramTitle"),c7=zt,u3e=bD,as=Ro,Put=kX,Dut=my,kD=ie(e=>ym(e,as()),"sanitizeText"),d3e=QIe,f3e=ie(()=>IX,"getCommonDb"),nk={},rk=ie((e,t,n)=>{var r;nk[e]&&c7.warn(`Diagram with id ${e} already registered. Overwriting.`),nk[e]=t,n&&vX(e,n),t3e(e,t.styles),(r=t.injectUtils)==null||r.call(t,c7,u3e,as,kD,d3e,f3e(),()=>{})},"registerDiagram"),Fj=ie(e=>{if(e in nk)return nk[e];throw new h3e(e)},"getDiagram"),z0,h3e=(z0=class extends Error{constructor(t){super(`Diagram ${t} not found.`)}},ie(z0,"DiagramNotFoundError"),z0);function ED(e){return typeof e>"u"||e===null}ie(ED,"isNothing");function jX(e){return typeof e=="object"&&e!==null}ie(jX,"isObject");function OX(e){return Array.isArray(e)?e:ED(e)?[]:[e]}ie(OX,"toArray");function PX(e,t){var n,r,s,i;if(t)for(i=Object.keys(t),n=0,r=i.length;n<r;n+=1)s=i[n],e[s]=t[s];return e}ie(PX,"extend");function DX(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}ie(DX,"repeat");function FX(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}ie(FX,"isNegativeZero");var p3e=ED,m3e=jX,g3e=OX,y3e=DX,b3e=FX,v3e=PX,$i={isNothing:p3e,isObject:m3e,toArray:g3e,repeat:y3e,isNegativeZero:b3e,extend:v3e};function TD(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}ie(TD,"formatError");function by(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=TD(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ie(by,"YAMLException$1");by.prototype=Object.create(Error.prototype);by.prototype.constructor=by;by.prototype.toString=ie(function(t){return this.name+": "+TD(this,t)},"toString");var So=by;function I2(e,t,n,r,s){var i="",a="",o=Math.floor(s/2)-1;return r-t>o&&(i=" ... ",t=r-o+i.length),n-r>o&&(a=" ...",n=r+o-a.length),{str:i+e.slice(t,n).replace(/\t/g,"")+a,pos:r-t+i.length}}ie(I2,"getLine");function j2(e,t){return $i.repeat(" ",t-e.length)+e}ie(j2,"padStart");function LX(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],s=[],i,a=-1;i=n.exec(e.buffer);)s.push(i.index),r.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=r.length-2);a<0&&(a=r.length-1);var o="",l,c,u=Math.min(e.line+t.linesAfter,s.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)c=I2(e.buffer,r[a-l],s[a-l],e.position-(r[a]-r[a-l]),d),o=$i.repeat(" ",t.indent)+j2((e.line-l+1).toString(),u)+" | "+c.str+`
`+o;for(c=I2(e.buffer,r[a],s[a],e.position,d),o+=$i.repeat(" ",t.indent)+j2((e.line+1).toString(),u)+" | "+c.str+`
`,o+=$i.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(a+l>=s.length);l++)c=I2(e.buffer,r[a+l],s[a+l],e.position-(r[a]-r[a+l]),d),o+=$i.repeat(" ",t.indent)+j2((e.line+l+1).toString(),u)+" | "+c.str+`
`;return o.replace(/\n$/,"")}ie(LX,"makeSnippet");var x3e=LX,w3e=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],_3e=["scalar","sequence","mapping"];function BX(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}ie(BX,"compileStyleAliases");function $X(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(w3e.indexOf(n)===-1)throw new So('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=BX(t.styleAliases||null),_3e.indexOf(this.kind)===-1)throw new So('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}ie($X,"Type$1");var Da=$X;function Lj(e,t){var n=[];return e[t].forEach(function(r){var s=n.length;n.forEach(function(i,a){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(s=a)}),n[s]=r}),n}ie(Lj,"compileList");function zX(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(ie(r,"collectType"),t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}ie(zX,"compileMap");function sk(e){return this.extend(e)}ie(sk,"Schema$1");sk.prototype.extend=ie(function(t){var n=[],r=[];if(t instanceof Da)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new So("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(i){if(!(i instanceof Da))throw new So("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new So("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new So("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof Da))throw new So("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(sk.prototype);return s.implicit=(this.implicit||[]).concat(n),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=Lj(s,"implicit"),s.compiledExplicit=Lj(s,"explicit"),s.compiledTypeMap=zX(s.compiledImplicit,s.compiledExplicit),s},"extend");var S3e=sk,C3e=new Da("tag:yaml.org,2002:str",{kind:"scalar",construct:ie(function(e){return e!==null?e:""},"construct")}),k3e=new Da("tag:yaml.org,2002:seq",{kind:"sequence",construct:ie(function(e){return e!==null?e:[]},"construct")}),E3e=new Da("tag:yaml.org,2002:map",{kind:"mapping",construct:ie(function(e){return e!==null?e:{}},"construct")}),T3e=new S3e({explicit:[C3e,k3e,E3e]});function UX(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}ie(UX,"resolveYamlNull");function qX(){return null}ie(qX,"constructYamlNull");function VX(e){return e===null}ie(VX,"isNull");var A3e=new Da("tag:yaml.org,2002:null",{kind:"scalar",resolve:UX,construct:qX,predicate:VX,represent:{canonical:ie(function(){return"~"},"canonical"),lowercase:ie(function(){return"null"},"lowercase"),uppercase:ie(function(){return"NULL"},"uppercase"),camelcase:ie(function(){return"Null"},"camelcase"),empty:ie(function(){return""},"empty")},defaultStyle:"lowercase"});function WX(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}ie(WX,"resolveYamlBoolean");function HX(e){return e==="true"||e==="True"||e==="TRUE"}ie(HX,"constructYamlBoolean");function GX(e){return Object.prototype.toString.call(e)==="[object Boolean]"}ie(GX,"isBoolean");var R3e=new Da("tag:yaml.org,2002:bool",{kind:"scalar",resolve:WX,construct:HX,predicate:GX,represent:{lowercase:ie(function(e){return e?"true":"false"},"lowercase"),uppercase:ie(function(e){return e?"TRUE":"FALSE"},"uppercase"),camelcase:ie(function(e){return e?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function KX(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}ie(KX,"isHexCode");function YX(e){return 48<=e&&e<=55}ie(YX,"isOctCode");function ZX(e){return 48<=e&&e<=57}ie(ZX,"isDecCode");function XX(e){if(e===null)return!1;var t=e.length,n=0,r=!1,s;if(!t)return!1;if(s=e[n],(s==="-"||s==="+")&&(s=e[++n]),s==="0"){if(n+1===t)return!0;if(s=e[++n],s==="b"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(s!=="0"&&s!=="1")return!1;r=!0}return r&&s!=="_"}if(s==="x"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!KX(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}if(s==="o"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!YX(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}}if(s==="_")return!1;for(;n<t;n++)if(s=e[n],s!=="_"){if(!ZX(e.charCodeAt(n)))return!1;r=!0}return!(!r||s==="_")}ie(XX,"resolveYamlInteger");function JX(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}ie(JX,"constructYamlInteger");function QX(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!$i.isNegativeZero(e)}ie(QX,"isInteger");var N3e=new Da("tag:yaml.org,2002:int",{kind:"scalar",resolve:XX,construct:JX,predicate:QX,represent:{binary:ie(function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},"binary"),octal:ie(function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},"octal"),decimal:ie(function(e){return e.toString(10)},"decimal"),hexadecimal:ie(function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),M3e=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function eJ(e){return!(e===null||!M3e.test(e)||e[e.length-1]==="_")}ie(eJ,"resolveYamlFloat");function tJ(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}ie(tJ,"constructYamlFloat");var I3e=/^[-+]?[0-9]+e/;function nJ(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if($i.isNegativeZero(e))return"-0.0";return n=e.toString(10),I3e.test(n)?n.replace("e",".e"):n}ie(nJ,"representYamlFloat");function rJ(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||$i.isNegativeZero(e))}ie(rJ,"isFloat");var j3e=new Da("tag:yaml.org,2002:float",{kind:"scalar",resolve:eJ,construct:tJ,predicate:rJ,represent:nJ,defaultStyle:"lowercase"}),sJ=T3e.extend({implicit:[A3e,R3e,N3e,j3e]}),O3e=sJ,iJ=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),aJ=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function oJ(e){return e===null?!1:iJ.exec(e)!==null||aJ.exec(e)!==null}ie(oJ,"resolveYamlTimestamp");function lJ(e){var t,n,r,s,i,a,o,l=0,c=null,u,d,h;if(t=iJ.exec(e),t===null&&(t=aJ.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(n,r,s));if(i=+t[4],a=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(n,r,s,i,a,o,l)),c&&h.setTime(h.getTime()-c),h}ie(lJ,"constructYamlTimestamp");function cJ(e){return e.toISOString()}ie(cJ,"representYamlTimestamp");var P3e=new Da("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:oJ,construct:lJ,instanceOf:Date,represent:cJ});function uJ(e){return e==="<<"||e===null}ie(uJ,"resolveYamlMerge");var D3e=new Da("tag:yaml.org,2002:merge",{kind:"scalar",resolve:uJ}),AD=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function dJ(e){if(e===null)return!1;var t,n,r=0,s=e.length,i=AD;for(n=0;n<s;n++)if(t=i.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}ie(dJ,"resolveYamlBinary");function fJ(e){var t,n,r=e.replace(/[\r\n=]/g,""),s=r.length,i=AD,a=0,o=[];for(t=0;t<s;t++)t%4===0&&t&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|i.indexOf(r.charAt(t));return n=s%4*6,n===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):n===18?(o.push(a>>10&255),o.push(a>>2&255)):n===12&&o.push(a>>4&255),new Uint8Array(o)}ie(fJ,"constructYamlBinary");function hJ(e){var t="",n=0,r,s,i=e.length,a=AD;for(r=0;r<i;r++)r%3===0&&r&&(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]),n=(n<<8)+e[r];return s=i%3,s===0?(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]):s===2?(t+=a[n>>10&63],t+=a[n>>4&63],t+=a[n<<2&63],t+=a[64]):s===1&&(t+=a[n>>2&63],t+=a[n<<4&63],t+=a[64],t+=a[64]),t}ie(hJ,"representYamlBinary");function pJ(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}ie(pJ,"isBinary");var F3e=new Da("tag:yaml.org,2002:binary",{kind:"scalar",resolve:dJ,construct:fJ,predicate:pJ,represent:hJ}),L3e=Object.prototype.hasOwnProperty,B3e=Object.prototype.toString;function mJ(e){if(e===null)return!0;var t=[],n,r,s,i,a,o=e;for(n=0,r=o.length;n<r;n+=1){if(s=o[n],a=!1,B3e.call(s)!=="[object Object]")return!1;for(i in s)if(L3e.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}ie(mJ,"resolveYamlOmap");function gJ(e){return e!==null?e:[]}ie(gJ,"constructYamlOmap");var $3e=new Da("tag:yaml.org,2002:omap",{kind:"sequence",resolve:mJ,construct:gJ}),z3e=Object.prototype.toString;function yJ(e){if(e===null)return!0;var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],z3e.call(r)!=="[object Object]"||(s=Object.keys(r),s.length!==1))return!1;i[t]=[s[0],r[s[0]]]}return!0}ie(yJ,"resolveYamlPairs");function bJ(e){if(e===null)return[];var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],s=Object.keys(r),i[t]=[s[0],r[s[0]]];return i}ie(bJ,"constructYamlPairs");var U3e=new Da("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:yJ,construct:bJ}),q3e=Object.prototype.hasOwnProperty;function vJ(e){if(e===null)return!0;var t,n=e;for(t in n)if(q3e.call(n,t)&&n[t]!==null)return!1;return!0}ie(vJ,"resolveYamlSet");function xJ(e){return e!==null?e:{}}ie(xJ,"constructYamlSet");var V3e=new Da("tag:yaml.org,2002:set",{kind:"mapping",resolve:vJ,construct:xJ}),wJ=O3e.extend({implicit:[P3e,D3e],explicit:[F3e,$3e,U3e,V3e]}),Th=Object.prototype.hasOwnProperty,ik=1,_J=2,SJ=3,ak=4,vI=1,W3e=2,u7=3,H3e=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,G3e=/[\x85\u2028\u2029]/,K3e=/[,\[\]\{\}]/,CJ=/^(?:!|!!|![a-z\-]+!)$/i,kJ=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Bj(e){return Object.prototype.toString.call(e)}ie(Bj,"_class");function xc(e){return e===10||e===13}ie(xc,"is_EOL");function uh(e){return e===9||e===32}ie(uh,"is_WHITE_SPACE");function Ja(e){return e===9||e===32||e===10||e===13}ie(Ja,"is_WS_OR_EOL");function Wp(e){return e===44||e===91||e===93||e===123||e===125}ie(Wp,"is_FLOW_INDICATOR");function EJ(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}ie(EJ,"fromHexCode");function TJ(e){return e===120?2:e===117?4:e===85?8:0}ie(TJ,"escapedHexLen");function AJ(e){return 48<=e&&e<=57?e-48:-1}ie(AJ,"fromDecimalCode");function $j(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}ie($j,"simpleEscapeSequence");function RJ(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}ie(RJ,"charFromCodepoint");var NJ=new Array(256),MJ=new Array(256);for(Mp=0;Mp<256;Mp++)NJ[Mp]=$j(Mp)?1:0,MJ[Mp]=$j(Mp);var Mp;function IJ(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||wJ,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}ie(IJ,"State$1");function RD(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=x3e(n),new So(t,n)}ie(RD,"generateError");function jn(e,t){throw RD(e,t)}ie(jn,"throwError");function bw(e,t){e.onWarning&&e.onWarning.call(null,RD(e,t))}ie(bw,"throwWarning");var d7={YAML:ie(function(t,n,r){var s,i,a;t.version!==null&&jn(t,"duplication of %YAML directive"),r.length!==1&&jn(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),s===null&&jn(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&jn(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&bw(t,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:ie(function(t,n,r){var s,i;r.length!==2&&jn(t,"TAG directive accepts exactly two arguments"),s=r[0],i=r[1],CJ.test(s)||jn(t,"ill-formed tag handle (first argument) of the TAG directive"),Th.call(t.tagMap,s)&&jn(t,'there is a previously declared suffix for "'+s+'" tag handle'),kJ.test(i)||jn(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{jn(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i},"handleTagDirective")};function jd(e,t,n,r){var s,i,a,o;if(t<n){if(o=e.input.slice(t,n),r)for(s=0,i=o.length;s<i;s+=1)a=o.charCodeAt(s),a===9||32<=a&&a<=1114111||jn(e,"expected valid JSON character");else H3e.test(o)&&jn(e,"the stream contains non-printable characters");e.result+=o}}ie(jd,"captureSegment");function zj(e,t,n,r){var s,i,a,o;for($i.isObject(n)||jn(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(n),a=0,o=s.length;a<o;a+=1)i=s[a],Th.call(t,i)||(t[i]=n[i],r[i]=!0)}ie(zj,"mergeMappings");function Hp(e,t,n,r,s,i,a,o,l){var c,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),c=0,u=s.length;c<u;c+=1)Array.isArray(s[c])&&jn(e,"nested arrays are not supported inside keys"),typeof s=="object"&&Bj(s[c])==="[object Object]"&&(s[c]="[object Object]");if(typeof s=="object"&&Bj(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(c=0,u=i.length;c<u;c+=1)zj(e,t,i[c],n);else zj(e,t,i,n);else!e.json&&!Th.call(n,s)&&Th.call(t,s)&&(e.line=a||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,jn(e,"duplicated mapping key")),s==="__proto__"?Object.defineProperty(t,s,{configurable:!0,enumerable:!0,writable:!0,value:i}):t[s]=i,delete n[s];return t}ie(Hp,"storeMappingPair");function dT(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):jn(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}ie(dT,"readLineBreak");function pi(e,t,n){for(var r=0,s=e.input.charCodeAt(e.position);s!==0;){for(;uh(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(xc(s))for(dT(e),s=e.input.charCodeAt(e.position),r++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&bw(e,"deficient indentation"),r}ie(pi,"skipSeparationSpace");function z1(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||Ja(n)))}ie(z1,"testDocumentSeparator");function fT(e,t){t===1?e.result+=" ":t>1&&(e.result+=$i.repeat(`
`,t-1))}ie(fT,"writeFoldedLines");function jJ(e,t,n){var r,s,i,a,o,l,c,u,d=e.kind,h=e.result,m;if(m=e.input.charCodeAt(e.position),Ja(m)||Wp(m)||m===35||m===38||m===42||m===33||m===124||m===62||m===39||m===34||m===37||m===64||m===96||(m===63||m===45)&&(s=e.input.charCodeAt(e.position+1),Ja(s)||n&&Wp(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,o=!1;m!==0;){if(m===58){if(s=e.input.charCodeAt(e.position+1),Ja(s)||n&&Wp(s))break}else if(m===35){if(r=e.input.charCodeAt(e.position-1),Ja(r))break}else{if(e.position===e.lineStart&&z1(e)||n&&Wp(m))break;if(xc(m))if(l=e.line,c=e.lineStart,u=e.lineIndent,pi(e,!1,-1),e.lineIndent>=t){o=!0,m=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=l,e.lineStart=c,e.lineIndent=u;break}}o&&(jd(e,i,a,!1),fT(e,e.line-l),i=a=e.position,o=!1),uh(m)||(a=e.position+1),m=e.input.charCodeAt(++e.position)}return jd(e,i,a,!1),e.result?!0:(e.kind=d,e.result=h,!1)}ie(jJ,"readPlainScalar");function OJ(e,t){var n,r,s;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=s=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(jd(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,s=e.position;else return!0;else xc(n)?(jd(e,r,s,!0),fT(e,pi(e,!1,t)),r=s=e.position):e.position===e.lineStart&&z1(e)?jn(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);jn(e,"unexpected end of the stream within a single quoted scalar")}ie(OJ,"readSingleQuotedScalar");function PJ(e,t){var n,r,s,i,a,o;if(o=e.input.charCodeAt(e.position),o!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(o=e.input.charCodeAt(e.position))!==0;){if(o===34)return jd(e,n,e.position,!0),e.position++,!0;if(o===92){if(jd(e,n,e.position,!0),o=e.input.charCodeAt(++e.position),xc(o))pi(e,!1,t);else if(o<256&&NJ[o])e.result+=MJ[o],e.position++;else if((a=TJ(o))>0){for(s=a,i=0;s>0;s--)o=e.input.charCodeAt(++e.position),(a=EJ(o))>=0?i=(i<<4)+a:jn(e,"expected hexadecimal character");e.result+=RJ(i),e.position++}else jn(e,"unknown escape sequence");n=r=e.position}else xc(o)?(jd(e,n,r,!0),fT(e,pi(e,!1,t)),n=r=e.position):e.position===e.lineStart&&z1(e)?jn(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}jn(e,"unexpected end of the stream within a double quoted scalar")}ie(PJ,"readDoubleQuotedScalar");function DJ(e,t){var n=!0,r,s,i,a=e.tag,o,l=e.anchor,c,u,d,h,m,y=Object.create(null),b,v,x,w;if(w=e.input.charCodeAt(e.position),w===91)u=93,m=!1,o=[];else if(w===123)u=125,m=!0,o={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),w=e.input.charCodeAt(++e.position);w!==0;){if(pi(e,!0,t),w=e.input.charCodeAt(e.position),w===u)return e.position++,e.tag=a,e.anchor=l,e.kind=m?"mapping":"sequence",e.result=o,!0;n?w===44&&jn(e,"expected the node content, but found ','"):jn(e,"missed comma between flow collection entries"),v=b=x=null,d=h=!1,w===63&&(c=e.input.charCodeAt(e.position+1),Ja(c)&&(d=h=!0,e.position++,pi(e,!0,t))),r=e.line,s=e.lineStart,i=e.position,bm(e,t,ik,!1,!0),v=e.tag,b=e.result,pi(e,!0,t),w=e.input.charCodeAt(e.position),(h||e.line===r)&&w===58&&(d=!0,w=e.input.charCodeAt(++e.position),pi(e,!0,t),bm(e,t,ik,!1,!0),x=e.result),m?Hp(e,o,y,v,b,x,r,s,i):d?o.push(Hp(e,null,y,v,b,x,r,s,i)):o.push(b),pi(e,!0,t),w=e.input.charCodeAt(e.position),w===44?(n=!0,w=e.input.charCodeAt(++e.position)):n=!1}jn(e,"unexpected end of the stream within a flow collection")}ie(DJ,"readFlowCollection");function FJ(e,t){var n,r,s=vI,i=!1,a=!1,o=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)vI===s?s=d===43?u7:W3e:jn(e,"repeat of a chomping mode identifier");else if((u=AJ(d))>=0)u===0?jn(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?jn(e,"repeat of an indentation width identifier"):(o=t+u-1,a=!0);else break;if(uh(d)){do d=e.input.charCodeAt(++e.position);while(uh(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!xc(d)&&d!==0)}for(;d!==0;){for(dT(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!a||e.lineIndent<o)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>o&&(o=e.lineIndent),xc(d)){l++;continue}if(e.lineIndent<o){s===u7?e.result+=$i.repeat(`
`,i?1+l:l):s===vI&&i&&(e.result+=`
`);break}for(r?uh(d)?(c=!0,e.result+=$i.repeat(`
`,i?1+l:l)):c?(c=!1,e.result+=$i.repeat(`
`,l+1)):l===0?i&&(e.result+=" "):e.result+=$i.repeat(`
`,l):e.result+=$i.repeat(`
`,i?1+l:l),i=!0,a=!0,l=0,n=e.position;!xc(d)&&d!==0;)d=e.input.charCodeAt(++e.position);jd(e,n,e.position,!1)}return!0}ie(FJ,"readBlockScalar");function Uj(e,t){var n,r=e.tag,s=e.anchor,i=[],a,o=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,jn(e,"tab characters must not be used in indentation")),!(l!==45||(a=e.input.charCodeAt(e.position+1),!Ja(a))));){if(o=!0,e.position++,pi(e,!0,-1)&&e.lineIndent<=t){i.push(null),l=e.input.charCodeAt(e.position);continue}if(n=e.line,bm(e,t,SJ,!1,!0),i.push(e.result),pi(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&l!==0)jn(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return o?(e.tag=r,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}ie(Uj,"readBlockSequence");function LJ(e,t,n){var r,s,i,a,o,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),m=null,y=null,b=null,v=!1,x=!1,w;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),w=e.input.charCodeAt(e.position);w!==0;){if(!v&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,jn(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,(w===63||w===58)&&Ja(r))w===63?(v&&(Hp(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!0,s=!0):v?(v=!1,s=!0):jn(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,w=r;else{if(a=e.line,o=e.lineStart,l=e.position,!bm(e,n,_J,!1,!0))break;if(e.line===i){for(w=e.input.charCodeAt(e.position);uh(w);)w=e.input.charCodeAt(++e.position);if(w===58)w=e.input.charCodeAt(++e.position),Ja(w)||jn(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(Hp(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!1,s=!1,m=e.tag,y=e.result;else if(x)jn(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(x)jn(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(v&&(a=e.line,o=e.lineStart,l=e.position),bm(e,t,ak,!0,s)&&(v?y=e.result:b=e.result),v||(Hp(e,d,h,m,y,b,a,o,l),m=y=b=null),pi(e,!0,-1),w=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&w!==0)jn(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&Hp(e,d,h,m,y,null,a,o,l),x&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),x}ie(LJ,"readBlockMapping");function BJ(e){var t,n=!1,r=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&jn(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):jn(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Ja(a);)a===33&&(r?jn(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),CJ.test(s)||jn(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),K3e.test(i)&&jn(e,"tag suffix cannot contain flow indicator characters")}i&&!kJ.test(i)&&jn(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{jn(e,"tag name is malformed: "+i)}return n?e.tag=i:Th.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:jn(e,'undeclared tag handle "'+s+'"'),!0}ie(BJ,"readTagProperty");function $J(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&jn(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Ja(n)&&!Wp(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&jn(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}ie($J,"readAnchorProperty");function zJ(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Ja(r)&&!Wp(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&jn(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Th.call(e.anchorMap,n)||jn(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],pi(e,!0,-1),!0}ie(zJ,"readAlias");function bm(e,t,n,r,s){var i,a,o,l=1,c=!1,u=!1,d,h,m,y,b,v;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=o=ak===n||SJ===n,r&&pi(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;BJ(e)||$J(e);)pi(e,!0,-1)?(c=!0,o=i,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):o=!1;if(o&&(o=c||s),(l===1||ak===n)&&(ik===n||_J===n?b=t:b=t+1,v=e.position-e.lineStart,l===1?o&&(Uj(e,v)||LJ(e,v,b))||DJ(e,b)?u=!0:(a&&FJ(e,b)||OJ(e,b)||PJ(e,b)?u=!0:zJ(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&jn(e,"alias node should not have any properties")):jJ(e,b,ik===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=o&&Uj(e,v))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&jn(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(y=e.implicitTypes[d],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Th.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,m=e.typeMap.multi[e.kind||"fallback"],d=0,h=m.length;d<h;d+=1)if(e.tag.slice(0,m[d].tag.length)===m[d].tag){y=m[d];break}y||jn(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&jn(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):jn(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}ie(bm,"composeNode");function UJ(e){var t=e.position,n,r,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(pi(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!Ja(a);)a=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),s=[],r.length<1&&jn(e,"directive name must not be less than one character in length");a!==0;){for(;uh(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!xc(a));break}if(xc(a))break;for(n=e.position;a!==0&&!Ja(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(n,e.position))}a!==0&&dT(e),Th.call(d7,r)?d7[r](e,r,s):bw(e,'unknown document directive "'+r+'"')}if(pi(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,pi(e,!0,-1)):i&&jn(e,"directives end mark is expected"),bm(e,e.lineIndent-1,ak,!1,!0),pi(e,!0,-1),e.checkLineBreaks&&G3e.test(e.input.slice(t,e.position))&&bw(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&z1(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,pi(e,!0,-1));return}if(e.position<e.length-1)jn(e,"end of the stream or a document separator is expected");else return}ie(UJ,"readDocument");function ND(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new IJ(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,jn(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)UJ(n);return n.documents}ie(ND,"loadDocuments");function Y3e(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=ND(e,n);if(typeof t!="function")return r;for(var s=0,i=r.length;s<i;s+=1)t(r[s])}ie(Y3e,"loadAll$1");function qJ(e,t){var n=ND(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new So("expected a single document in the stream, but found more")}}ie(qJ,"load$1");var Z3e=qJ,X3e={load:Z3e},VJ=Object.prototype.toString,WJ=Object.prototype.hasOwnProperty,MD=65279,J3e=9,vw=10,Q3e=13,eje=32,tje=33,nje=34,qj=35,rje=37,sje=38,ije=39,aje=42,HJ=44,oje=45,ok=58,lje=61,cje=62,uje=63,dje=64,GJ=91,KJ=93,fje=96,YJ=123,hje=124,ZJ=125,Ua={};Ua[0]="\\0";Ua[7]="\\a";Ua[8]="\\b";Ua[9]="\\t";Ua[10]="\\n";Ua[11]="\\v";Ua[12]="\\f";Ua[13]="\\r";Ua[27]="\\e";Ua[34]='\\"';Ua[92]="\\\\";Ua[133]="\\N";Ua[160]="\\_";Ua[8232]="\\L";Ua[8233]="\\P";var pje=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],mje=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function XJ(e,t){var n,r,s,i,a,o,l;if(t===null)return{};for(n={},r=Object.keys(t),s=0,i=r.length;s<i;s+=1)a=r[s],o=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=e.compiledTypeMap.fallback[a],l&&WJ.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[a]=o;return n}ie(XJ,"compileStyleMap");function JJ(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new So("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+$i.repeat("0",r-t.length)+t}ie(JJ,"encodeHex");var gje=1,xw=2;function QJ(e){this.schema=e.schema||wJ,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=$i.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=XJ(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?xw:gje,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}ie(QJ,"State");function Vj(e,t){for(var n=$i.repeat(" ",t),r=0,s=-1,i="",a,o=e.length;r<o;)s=e.indexOf(`
`,r),s===-1?(a=e.slice(r),r=o):(a=e.slice(r,s+1),r=s+1),a.length&&a!==`
`&&(i+=n),i+=a;return i}ie(Vj,"indentString");function lk(e,t){return`
`+$i.repeat(" ",e.indent*t)}ie(lk,"generateNextLine");function eQ(e,t){var n,r,s;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(s=e.implicitTypes[n],s.resolve(t))return!0;return!1}ie(eQ,"testImplicitResolving");function ww(e){return e===eje||e===J3e}ie(ww,"isWhitespace");function vy(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==MD||65536<=e&&e<=1114111}ie(vy,"isPrintable");function Wj(e){return vy(e)&&e!==MD&&e!==Q3e&&e!==vw}ie(Wj,"isNsCharOrWhitespace");function Hj(e,t,n){var r=Wj(e),s=r&&!ww(e);return(n?r:r&&e!==HJ&&e!==GJ&&e!==KJ&&e!==YJ&&e!==ZJ)&&e!==qj&&!(t===ok&&!s)||Wj(t)&&!ww(t)&&e===qj||t===ok&&s}ie(Hj,"isPlainSafe");function tQ(e){return vy(e)&&e!==MD&&!ww(e)&&e!==oje&&e!==uje&&e!==ok&&e!==HJ&&e!==GJ&&e!==KJ&&e!==YJ&&e!==ZJ&&e!==qj&&e!==sje&&e!==aje&&e!==tje&&e!==hje&&e!==lje&&e!==cje&&e!==ije&&e!==nje&&e!==rje&&e!==dje&&e!==fje}ie(tQ,"isPlainSafeFirst");function nQ(e){return!ww(e)&&e!==ok}ie(nQ,"isPlainSafeLast");function f0(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}ie(f0,"codePointAt");function ID(e){var t=/^\n* /;return t.test(e)}ie(ID,"needIndentIndicator");var rQ=1,Gj=2,sQ=3,iQ=4,i0=5;function aQ(e,t,n,r,s,i,a,o){var l,c=0,u=null,d=!1,h=!1,m=r!==-1,y=-1,b=tQ(f0(e,0))&&nQ(f0(e,e.length-1));if(t||a)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=f0(e,l),!vy(c))return i0;b=b&&Hj(c,u,o),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=f0(e,l),c===vw)d=!0,m&&(h=h||l-y-1>r&&e[y+1]!==" ",y=l);else if(!vy(c))return i0;b=b&&Hj(c,u,o),u=c}h=h||m&&l-y-1>r&&e[y+1]!==" "}return!d&&!h?b&&!a&&!s(e)?rQ:i===xw?i0:Gj:n>9&&ID(e)?i0:a?i===xw?i0:Gj:h?iQ:sQ}ie(aQ,"chooseScalarStyle");function oQ(e,t,n,r,s){e.dump=function(){if(t.length===0)return e.quotingType===xw?'""':"''";if(!e.noCompatMode&&(pje.indexOf(t)!==-1||mje.test(t)))return e.quotingType===xw?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),o=r||e.flowLevel>-1&&n>=e.flowLevel;function l(c){return eQ(e,c)}switch(ie(l,"testAmbiguity"),aQ(t,o,e.indent,a,l,e.quotingType,e.forceQuotes&&!r,s)){case rQ:return t;case Gj:return"'"+t.replace(/'/g,"''")+"'";case sQ:return"|"+Kj(t,e.indent)+Yj(Vj(t,i));case iQ:return">"+Kj(t,e.indent)+Yj(Vj(lQ(t,a),i));case i0:return'"'+cQ(t)+'"';default:throw new So("impossible error: invalid scalar style")}}()}ie(oQ,"writeScalar");function Kj(e,t){var n=ID(e)?String(t):"",r=e[e.length-1]===`
`,s=r&&(e[e.length-2]===`
`||e===`
`),i=s?"+":r?"":"-";return n+i+`
`}ie(Kj,"blockHeader");function Yj(e){return e[e.length-1]===`
`?e.slice(0,-1):e}ie(Yj,"dropEndingNewline");function lQ(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,n.lastIndex=c,Zj(e.slice(0,c),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=n.exec(e);){var o=a[1],l=a[2];i=l[0]===" ",r+=o+(!s&&!i&&l!==""?`
`:"")+Zj(l,t),s=i}return r}ie(lQ,"foldString");function Zj(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,s=0,i,a=0,o=0,l="";r=n.exec(e);)o=r.index,o-s>t&&(i=a>s?a:o,l+=`
`+e.slice(s,i),s=i+1),a=o;return l+=`
`,e.length-s>t&&a>s?l+=e.slice(s,a)+`
`+e.slice(a+1):l+=e.slice(s),l.slice(1)}ie(Zj,"foldLine");function cQ(e){for(var t="",n=0,r,s=0;s<e.length;n>=65536?s+=2:s++)n=f0(e,s),r=Ua[n],!r&&vy(n)?(t+=e[s],n>=65536&&(t+=e[s+1])):t+=r||JJ(n);return t}ie(cQ,"escapeString");function uQ(e,t,n){var r="",s=e.tag,i,a,o;for(i=0,a=n.length;i<a;i+=1)o=n[i],e.replacer&&(o=e.replacer.call(n,String(i),o)),(Nu(e,t,o,!1,!1)||typeof o>"u"&&Nu(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=s,e.dump="["+r+"]"}ie(uQ,"writeFlowSequence");function Xj(e,t,n,r){var s="",i=e.tag,a,o,l;for(a=0,o=n.length;a<o;a+=1)l=n[a],e.replacer&&(l=e.replacer.call(n,String(a),l)),(Nu(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&Nu(e,t+1,null,!0,!0,!1,!0))&&((!r||s!=="")&&(s+=lk(e,t)),e.dump&&vw===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}ie(Xj,"writeBlockSequence");function dQ(e,t,n){var r="",s=e.tag,i=Object.keys(n),a,o,l,c,u;for(a=0,o=i.length;a<o;a+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=i[a],c=n[l],e.replacer&&(c=e.replacer.call(n,l,c)),Nu(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Nu(e,t,c,!1,!1)&&(u+=e.dump,r+=u));e.tag=s,e.dump="{"+r+"}"}ie(dQ,"writeFlowMapping");function fQ(e,t,n,r){var s="",i=e.tag,a=Object.keys(n),o,l,c,u,d,h;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new So("sortKeys must be a boolean or a function");for(o=0,l=a.length;o<l;o+=1)h="",(!r||s!=="")&&(h+=lk(e,t)),c=a[o],u=n[c],e.replacer&&(u=e.replacer.call(n,c,u)),Nu(e,t+1,c,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&vw===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,d&&(h+=lk(e,t)),Nu(e,t+1,u,!0,d)&&(e.dump&&vw===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,s+=h));e.tag=i,e.dump=s||"{}"}ie(fQ,"writeBlockMapping");function Jj(e,t,n){var r,s,i,a,o,l;for(s=n?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(o=s[i],(o.instanceOf||o.predicate)&&(!o.instanceOf||typeof t=="object"&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,VJ.call(o.represent)==="[object Function]")r=o.represent(t,l);else if(WJ.call(o.represent,l))r=o.represent[l](t,l);else throw new So("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=r}return!0}return!1}ie(Jj,"detectType");function Nu(e,t,n,r,s,i,a){e.tag=null,e.dump=n,Jj(e,n,!1)||Jj(e,n,!0);var o=VJ.call(e.dump),l=r,c;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=o==="[object Object]"||o==="[object Array]",d,h;if(u&&(d=e.duplicates.indexOf(n),h=d!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(s=!1),h&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(u&&h&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),o==="[object Object]")r&&Object.keys(e.dump).length!==0?(fQ(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(dQ(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?Xj(e,t-1,e.dump,s):Xj(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(uQ(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object String]")e.tag!=="?"&&oQ(e,e.dump,t,i,l);else{if(o==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new So("unacceptable kind of an object to dump "+o)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}ie(Nu,"writeNode");function hQ(e,t){var n=[],r=[],s,i;for(ck(e,n,r),s=0,i=r.length;s<i;s+=1)t.duplicates.push(n[r[s]]);t.usedDuplicates=new Array(i)}ie(hQ,"getDuplicateReferences");function ck(e,t,n){var r,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)n.indexOf(s)===-1&&n.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)ck(e[s],t,n);else for(r=Object.keys(e),s=0,i=r.length;s<i;s+=1)ck(e[r[s]],t,n)}ie(ck,"inspectNode");function yje(e,t){t=t||{};var n=new QJ(t);n.noRefs||hQ(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Nu(n,0,r,!0,!0)?n.dump+`
`:""}ie(yje,"dump$1");function bje(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}ie(bje,"renamed");var vje=sJ,xje=X3e.load;/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/var Ml={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:4};function Yv(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=Hs(e),t=Hs(t);const[n,r]=[e.x,e.y],[s,i]=[t.x,t.y],a=s-n,o=i-r;return{angle:Math.atan(o/a),deltaX:a,deltaY:o}}ie(Yv,"calculateDeltaAndAngle");var Hs=ie(e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,"pointTransformer"),wje=ie(e=>({x:ie(function(t,n,r){let s=0;const i=Hs(r[0]).x<Hs(r[r.length-1]).x?"left":"right";if(n===0&&Object.hasOwn(Ml,e.arrowTypeStart)){const{angle:m,deltaX:y}=Yv(r[0],r[1]);s=Ml[e.arrowTypeStart]*Math.cos(m)*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Ml,e.arrowTypeEnd)){const{angle:m,deltaX:y}=Yv(r[r.length-1],r[r.length-2]);s=Ml[e.arrowTypeEnd]*Math.cos(m)*(y>=0?1:-1)}const a=Math.abs(Hs(t).x-Hs(r[r.length-1]).x),o=Math.abs(Hs(t).y-Hs(r[r.length-1]).y),l=Math.abs(Hs(t).x-Hs(r[0]).x),c=Math.abs(Hs(t).y-Hs(r[0]).y),u=Ml[e.arrowTypeStart],d=Ml[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="right"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="right"?-1:1,s+=m}return Hs(t).x+s},"x"),y:ie(function(t,n,r){let s=0;const i=Hs(r[0]).y<Hs(r[r.length-1]).y?"down":"up";if(n===0&&Object.hasOwn(Ml,e.arrowTypeStart)){const{angle:m,deltaY:y}=Yv(r[0],r[1]);s=Ml[e.arrowTypeStart]*Math.abs(Math.sin(m))*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Ml,e.arrowTypeEnd)){const{angle:m,deltaY:y}=Yv(r[r.length-1],r[r.length-2]);s=Ml[e.arrowTypeEnd]*Math.abs(Math.sin(m))*(y>=0?1:-1)}const a=Math.abs(Hs(t).y-Hs(r[r.length-1]).y),o=Math.abs(Hs(t).x-Hs(r[r.length-1]).x),l=Math.abs(Hs(t).y-Hs(r[0]).y),c=Math.abs(Hs(t).x-Hs(r[0]).x),u=Ml[e.arrowTypeStart],d=Ml[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="up"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="up"?-1:1,s+=m}return Hs(t).y+s},"y")}),"getLineFunctionsWithOffset"),jD=ie(({flowchart:e})=>{var s,i;const t=((s=e==null?void 0:e.subGraphTitleMargin)==null?void 0:s.top)??0,n=((i=e==null?void 0:e.subGraphTitleMargin)==null?void 0:i.bottom)??0,r=t+n;return{subGraphTitleTopMargin:t,subGraphTitleBottomMargin:n,subGraphTitleTotalMargin:r}},"getSubGraphTitleMargins");const _je=Object.freeze({left:0,top:0,width:16,height:16}),uk=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),pQ=Object.freeze({..._je,...uk}),Sje=Object.freeze({...pQ,body:"",hidden:!1}),Cje=Object.freeze({width:null,height:null}),kje=Object.freeze({...Cje,...uk}),Eje=(e,t,n,r="")=>{const s=e.split(":");if(e.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;r=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const o=s.pop(),l=s.pop(),c={provider:s.length>0?s[0]:r,prefix:l,name:o};return xI(c)?c:null}const i=s[0],a=i.split("-");if(a.length>1){const o={provider:r,prefix:a.shift(),name:a.join("-")};return xI(o)?o:null}if(n&&r===""){const o={provider:r,prefix:"",name:i};return xI(o,n)?o:null}return null},xI=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1;function Tje(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function f7(e,t){const n=Tje(e,t);for(const r in Sje)r in uk?r in e&&!(r in n)&&(n[r]=uk[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function Aje(e,t){const n=e.icons,r=e.aliases||Object.create(null),s=Object.create(null);function i(a){if(n[a])return s[a]=[];if(!(a in s)){s[a]=null;const o=r[a]&&r[a].parent,l=o&&i(o);l&&(s[a]=[o].concat(l))}return s[a]}return(t||Object.keys(n).concat(Object.keys(r))).forEach(i),s}function h7(e,t,n){const r=e.icons,s=e.aliases||Object.create(null);let i={};function a(o){i=f7(r[o]||s[o],i)}return a(t),n.forEach(a),f7(e,i)}function Rje(e,t){if(e.icons[t])return h7(e,t,[]);const n=Aje(e,[t])[t];return n?h7(e,t,n):null}const Nje=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Mje=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function p7(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(Nje);if(r===null||!r.length)return e;const s=[];let i=r.shift(),a=Mje.test(i);for(;;){if(a){const o=parseFloat(i);isNaN(o)?s.push(i):s.push(Math.ceil(o*t*n)/n)}else s.push(i);if(i=r.shift(),i===void 0)return s.join("");a=!a}}function Ije(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const s=e.indexOf(">",r),i=e.indexOf("</"+t);if(s===-1||i===-1)break;const a=e.indexOf(">",i);if(a===-1)break;n+=e.slice(s+1,i).trim(),e=e.slice(0,r).trim()+e.slice(a+1)}return{defs:n,content:e}}function jje(e,t){return e?"<defs>"+e+"</defs>"+t:t}function Oje(e,t,n){const r=Ije(e);return jje(r.defs,t+r.content+n)}const Pje=e=>e==="unset"||e==="undefined"||e==="none";function Dje(e,t){const n={...pQ,...e},r={...kje,...t},s={left:n.left,top:n.top,width:n.width,height:n.height};let i=n.body;[n,r].forEach(b=>{const v=[],x=b.hFlip,w=b.vFlip;let S=b.rotate;x?w?S+=2:(v.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),v.push("scale(-1 1)"),s.top=s.left=0):w&&(v.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),v.push("scale(1 -1)"),s.top=s.left=0);let C;switch(S<0&&(S-=Math.floor(S/4)*4),S=S%4,S){case 1:C=s.height/2+s.top,v.unshift("rotate(90 "+C.toString()+" "+C.toString()+")");break;case 2:v.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:C=s.width/2+s.left,v.unshift("rotate(-90 "+C.toString()+" "+C.toString()+")");break}S%2===1&&(s.left!==s.top&&(C=s.left,s.left=s.top,s.top=C),s.width!==s.height&&(C=s.width,s.width=s.height,s.height=C)),v.length&&(i=Oje(i,'<g transform="'+v.join(" ")+'">',"</g>"))});const a=r.width,o=r.height,l=s.width,c=s.height;let u,d;a===null?(d=o===null?"1em":o==="auto"?c:o,u=p7(d,l/c)):(u=a==="auto"?l:a,d=o===null?p7(u,c/l):o==="auto"?c:o);const h={},m=(b,v)=>{Pje(v)||(h[b]=v.toString())};m("width",u),m("height",d);const y=[s.left,s.top,l,c];return h.viewBox=y.join(" "),{attributes:h,viewBox:y,body:i}}const Fje=/\sid="(\S+)"/g,Lje="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let Bje=0;function $je(e,t=Lje){const n=[];let r;for(;r=Fje.exec(e);)n.push(r[1]);if(!n.length)return e;const s="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(i=>{const a=typeof t=="function"?t(i):t+(Bje++).toString(),o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+s+"$3")}),e=e.replace(new RegExp(s,"g"),""),e}function zje(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}var Uje={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},Qj=new Map,mQ=new Map,qje=ie(e=>{for(const t of e){if(!t.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(zt.debug("Registering icon pack:",t.name),"loader"in t)mQ.set(t.name,t.loader);else if("icons"in t)Qj.set(t.name,t.icons);else throw zt.error("Invalid icon loader:",t),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),Vje=ie(async(e,t)=>{const n=Eje(e,!0,t!==void 0);if(!n)throw new Error(`Invalid icon name: ${e}`);const r=n.prefix||t;if(!r)throw new Error(`Icon name must contain a prefix: ${e}`);let s=Qj.get(r);if(!s){const a=mQ.get(r);if(!a)throw new Error(`Icon set not found: ${n.prefix}`);try{s={...await a(),prefix:r},Qj.set(r,s)}catch(o){throw zt.error(o),new Error(`Failed to load icon set: ${n.prefix}`)}}const i=Rje(s,n.name);if(!i)throw new Error(`Icon not found: ${e}`);return i},"getRegisteredIconData"),hT=ie(async(e,t)=>{let n;try{n=await Vje(e,t==null?void 0:t.fallbackPrefix)}catch(i){zt.error(i),n=Uje}const r=Dje(n,t);return zje($je(r.body),r.attributes)},"getIconSVG"),Pv={},Fi={},m7;function Wje(){return m7||(m7=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.BLANK_URL=Fi.relativeFirstCharacters=Fi.whitespaceEscapeCharsRegex=Fi.urlSchemeRegex=Fi.ctrlCharactersRegex=Fi.htmlCtrlEntityRegex=Fi.htmlEntitiesRegex=Fi.invalidProtocolRegex=void 0,Fi.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,Fi.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,Fi.htmlCtrlEntityRegex=/&(newline|tab);/gi,Fi.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,Fi.urlSchemeRegex=/^.+(:|&colon;)/gim,Fi.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,Fi.relativeFirstCharacters=[".","/"],Fi.BLANK_URL="about:blank"),Fi}var g7;function Hje(){if(g7)return Pv;g7=1,Object.defineProperty(Pv,"__esModule",{value:!0}),Pv.sanitizeUrl=void 0;var e=Wje();function t(a){return e.relativeFirstCharacters.indexOf(a[0])>-1}function n(a){var o=a.replace(e.ctrlCharactersRegex,"");return o.replace(e.htmlEntitiesRegex,function(l,c){return String.fromCharCode(c)})}function r(a){return URL.canParse(a)}function s(a){try{return decodeURIComponent(a)}catch{return a}}function i(a){if(!a)return e.BLANK_URL;var o,l=s(a.trim());do l=n(l).replace(e.htmlCtrlEntityRegex,"").replace(e.ctrlCharactersRegex,"").replace(e.whitespaceEscapeCharsRegex,"").trim(),l=s(l),o=l.match(e.ctrlCharactersRegex)||l.match(e.htmlEntitiesRegex)||l.match(e.htmlCtrlEntityRegex)||l.match(e.whitespaceEscapeCharsRegex);while(o&&o.length>0);var c=l;if(!c)return e.BLANK_URL;if(t(c))return c;var u=c.trimStart(),d=u.match(e.urlSchemeRegex);if(!d)return c;var h=d[0].toLowerCase().trim();if(e.invalidProtocolRegex.test(h))return e.BLANK_URL;var m=u.replace(/\\/g,"/");if(h==="mailto:"||h.includes("://"))return m;if(h==="http:"||h==="https:"){if(!r(m))return e.BLANK_URL;var y=new URL(m);return y.protocol=y.protocol.toLowerCase(),y.hostname=y.hostname.toLowerCase(),y.toString()}return m}return Pv.sanitizeUrl=i,Pv}var Gje=Hje(),Kje={value:()=>{}};function gQ(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new O2(n)}function O2(e){this._=e}function Yje(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}O2.prototype=gQ.prototype={constructor:O2,on:function(e,t){var n=this._,r=Yje(e+"",n),s,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((s=(e=r[i]).type)&&(s=Zje(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=r[i]).type)n[s]=y7(n[s],e.name,t);else if(t==null)for(s in n)n[s]=y7(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new O2(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function Zje(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function y7(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=Kje,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var e4="http://www.w3.org/1999/xhtml";const b7={svg:"http://www.w3.org/2000/svg",xhtml:e4,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function pT(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),b7.hasOwnProperty(t)?{space:b7[t],local:e}:e}function Xje(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===e4&&t.documentElement.namespaceURI===e4?t.createElement(e):t.createElementNS(n,e)}}function Jje(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function yQ(e){var t=pT(e);return(t.local?Jje:Xje)(t)}function Qje(){}function OD(e){return e==null?Qje:function(){return this.querySelector(e)}}function e4e(e){typeof e!="function"&&(e=OD(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=new Array(a),l,c,u=0;u<a;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new fl(r,this._parents)}function t4e(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function n4e(){return[]}function bQ(e){return e==null?n4e:function(){return this.querySelectorAll(e)}}function r4e(e){return function(){return t4e(e.apply(this,arguments))}}function s4e(e){typeof e=="function"?e=r4e(e):e=bQ(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var a=t[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),s.push(l));return new fl(r,s)}function vQ(e){return function(){return this.matches(e)}}function xQ(e){return function(t){return t.matches(e)}}var i4e=Array.prototype.find;function a4e(e){return function(){return i4e.call(this.children,e)}}function o4e(){return this.firstElementChild}function l4e(e){return this.select(e==null?o4e:a4e(typeof e=="function"?e:xQ(e)))}var c4e=Array.prototype.filter;function u4e(){return Array.from(this.children)}function d4e(e){return function(){return c4e.call(this.children,e)}}function f4e(e){return this.selectAll(e==null?u4e:d4e(typeof e=="function"?e:xQ(e)))}function h4e(e){typeof e!="function"&&(e=vQ(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new fl(r,this._parents)}function wQ(e){return new Array(e.length)}function p4e(){return new fl(this._enter||this._groups.map(wQ),this._parents)}function dk(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}dk.prototype={constructor:dk,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function m4e(e){return function(){return e}}function g4e(e,t,n,r,s,i){for(var a=0,o,l=t.length,c=i.length;a<c;++a)(o=t[a])?(o.__data__=i[a],r[a]=o):n[a]=new dk(e,i[a]);for(;a<l;++a)(o=t[a])&&(s[a]=o)}function y4e(e,t,n,r,s,i,a){var o,l,c=new Map,u=t.length,d=i.length,h=new Array(u),m;for(o=0;o<u;++o)(l=t[o])&&(h[o]=m=a.call(l,l.__data__,o,t)+"",c.has(m)?s[o]=l:c.set(m,l));for(o=0;o<d;++o)m=a.call(e,i[o],o,i)+"",(l=c.get(m))?(r[o]=l,l.__data__=i[o],c.delete(m)):n[o]=new dk(e,i[o]);for(o=0;o<u;++o)(l=t[o])&&c.get(h[o])===l&&(s[o]=l)}function b4e(e){return e.__data__}function v4e(e,t){if(!arguments.length)return Array.from(this,b4e);var n=t?y4e:g4e,r=this._parents,s=this._groups;typeof e!="function"&&(e=m4e(e));for(var i=s.length,a=new Array(i),o=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],d=s[c],h=d.length,m=x4e(e.call(u,u&&u.__data__,c,r)),y=m.length,b=o[c]=new Array(y),v=a[c]=new Array(y),x=l[c]=new Array(h);n(u,d,b,v,x,m,t);for(var w=0,S=0,C,k;w<y;++w)if(C=b[w]){for(w>=S&&(S=w+1);!(k=v[S])&&++S<y;);C._next=k||null}}return a=new fl(a,r),a._enter=o,a._exit=l,a}function x4e(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function w4e(){return new fl(this._exit||this._groups.map(wQ),this._parents)}function _4e(e,t,n){var r=this.enter(),s=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function S4e(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,i=r.length,a=Math.min(s,i),o=new Array(s),l=0;l<a;++l)for(var c=n[l],u=r[l],d=c.length,h=o[l]=new Array(d),m,y=0;y<d;++y)(m=c[y]||u[y])&&(h[y]=m);for(;l<s;++l)o[l]=n[l];return new fl(o,this._parents)}function C4e(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function k4e(e){e||(e=E4e);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],o=a.length,l=s[i]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(t)}return new fl(s,this._parents).order()}function E4e(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function T4e(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function A4e(){return Array.from(this)}function R4e(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function N4e(){let e=0;for(const t of this)++e;return e}function M4e(){return!this.node()}function I4e(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,a=s.length,o;i<a;++i)(o=s[i])&&e.call(o,o.__data__,i,s);return this}function j4e(e){return function(){this.removeAttribute(e)}}function O4e(e){return function(){this.removeAttributeNS(e.space,e.local)}}function P4e(e,t){return function(){this.setAttribute(e,t)}}function D4e(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function F4e(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function L4e(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function B4e(e,t){var n=pT(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?O4e:j4e:typeof t=="function"?n.local?L4e:F4e:n.local?D4e:P4e)(n,t))}function _Q(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function $4e(e){return function(){this.style.removeProperty(e)}}function z4e(e,t,n){return function(){this.style.setProperty(e,t,n)}}function U4e(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function q4e(e,t,n){return arguments.length>1?this.each((t==null?$4e:typeof t=="function"?U4e:z4e)(e,t,n??"")):xy(this.node(),e)}function xy(e,t){return e.style.getPropertyValue(t)||_Q(e).getComputedStyle(e,null).getPropertyValue(t)}function V4e(e){return function(){delete this[e]}}function W4e(e,t){return function(){this[e]=t}}function H4e(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function G4e(e,t){return arguments.length>1?this.each((t==null?V4e:typeof t=="function"?H4e:W4e)(e,t)):this.node()[e]}function SQ(e){return e.trim().split(/^|\s+/)}function PD(e){return e.classList||new CQ(e)}function CQ(e){this._node=e,this._names=SQ(e.getAttribute("class")||"")}CQ.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function kQ(e,t){for(var n=PD(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function EQ(e,t){for(var n=PD(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function K4e(e){return function(){kQ(this,e)}}function Y4e(e){return function(){EQ(this,e)}}function Z4e(e,t){return function(){(t.apply(this,arguments)?kQ:EQ)(this,e)}}function X4e(e,t){var n=SQ(e+"");if(arguments.length<2){for(var r=PD(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?Z4e:t?K4e:Y4e)(n,t))}function J4e(){this.textContent=""}function Q4e(e){return function(){this.textContent=e}}function eOe(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function tOe(e){return arguments.length?this.each(e==null?J4e:(typeof e=="function"?eOe:Q4e)(e)):this.node().textContent}function nOe(){this.innerHTML=""}function rOe(e){return function(){this.innerHTML=e}}function sOe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function iOe(e){return arguments.length?this.each(e==null?nOe:(typeof e=="function"?sOe:rOe)(e)):this.node().innerHTML}function aOe(){this.nextSibling&&this.parentNode.appendChild(this)}function oOe(){return this.each(aOe)}function lOe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function cOe(){return this.each(lOe)}function uOe(e){var t=typeof e=="function"?e:yQ(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function dOe(){return null}function fOe(e,t){var n=typeof e=="function"?e:yQ(e),r=t==null?dOe:typeof t=="function"?t:OD(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function hOe(){var e=this.parentNode;e&&e.removeChild(this)}function pOe(){return this.each(hOe)}function mOe(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function gOe(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function yOe(e){return this.select(e?gOe:mOe)}function bOe(e){return arguments.length?this.property("__data__",e):this.node().__data__}function vOe(e){return function(t){e.call(this,t,this.__data__)}}function xOe(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function wOe(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function _Oe(e,t,n){return function(){var r=this.__on,s,i=vOe(t);if(r){for(var a=0,o=r.length;a<o;++a)if((s=r[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function SOe(e,t,n){var r=xOe(e+""),s,i=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(s=0,u=o[l];s<i;++s)if((a=r[s]).type===u.type&&a.name===u.name)return u.value}return}for(o=t?_Oe:wOe,s=0;s<i;++s)this.each(o(r[s],t,n));return this}function TQ(e,t,n){var r=_Q(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function COe(e,t){return function(){return TQ(this,e,t)}}function kOe(e,t){return function(){return TQ(this,e,t.apply(this,arguments))}}function EOe(e,t){return this.each((typeof t=="function"?kOe:COe)(e,t))}function*TOe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var AQ=[null];function fl(e,t){this._groups=e,this._parents=t}function U1(){return new fl([[document.documentElement]],AQ)}function AOe(){return this}fl.prototype=U1.prototype={constructor:fl,select:e4e,selectAll:s4e,selectChild:l4e,selectChildren:f4e,filter:h4e,data:v4e,enter:p4e,exit:w4e,join:_4e,merge:S4e,selection:AOe,order:C4e,sort:k4e,call:T4e,nodes:A4e,node:R4e,size:N4e,empty:M4e,each:I4e,attr:B4e,style:q4e,property:G4e,classed:X4e,text:tOe,html:iOe,raise:oOe,lower:cOe,append:uOe,insert:fOe,remove:pOe,clone:yOe,datum:bOe,on:SOe,dispatch:EOe,[Symbol.iterator]:TOe};function Kr(e){return typeof e=="string"?new fl([[document.querySelector(e)]],[document.documentElement]):new fl([[e]],AQ)}function DD(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function RQ(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function q1(){}var _w=.7,fk=1/_w,A0="\\s*([+-]?\\d+)\\s*",Sw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",bu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ROe=/^#([0-9a-f]{3,8})$/,NOe=new RegExp(`^rgb\\(${A0},${A0},${A0}\\)$`),MOe=new RegExp(`^rgb\\(${bu},${bu},${bu}\\)$`),IOe=new RegExp(`^rgba\\(${A0},${A0},${A0},${Sw}\\)$`),jOe=new RegExp(`^rgba\\(${bu},${bu},${bu},${Sw}\\)$`),OOe=new RegExp(`^hsl\\(${Sw},${bu},${bu}\\)$`),POe=new RegExp(`^hsla\\(${Sw},${bu},${bu},${Sw}\\)$`),v7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};DD(q1,Cw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:x7,formatHex:x7,formatHex8:DOe,formatHsl:FOe,formatRgb:w7,toString:w7});function x7(){return this.rgb().formatHex()}function DOe(){return this.rgb().formatHex8()}function FOe(){return NQ(this).formatHsl()}function w7(){return this.rgb().formatRgb()}function Cw(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ROe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?_7(t):n===3?new Co(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?US(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?US(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=NOe.exec(e))?new Co(t[1],t[2],t[3],1):(t=MOe.exec(e))?new Co(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=IOe.exec(e))?US(t[1],t[2],t[3],t[4]):(t=jOe.exec(e))?US(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=OOe.exec(e))?k7(t[1],t[2]/100,t[3]/100,1):(t=POe.exec(e))?k7(t[1],t[2]/100,t[3]/100,t[4]):v7.hasOwnProperty(e)?_7(v7[e]):e==="transparent"?new Co(NaN,NaN,NaN,0):null}function _7(e){return new Co(e>>16&255,e>>8&255,e&255,1)}function US(e,t,n,r){return r<=0&&(e=t=n=NaN),new Co(e,t,n,r)}function LOe(e){return e instanceof q1||(e=Cw(e)),e?(e=e.rgb(),new Co(e.r,e.g,e.b,e.opacity)):new Co}function t4(e,t,n,r){return arguments.length===1?LOe(e):new Co(e,t,n,r??1)}function Co(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}DD(Co,t4,RQ(q1,{brighter(e){return e=e==null?fk:Math.pow(fk,e),new Co(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?_w:Math.pow(_w,e),new Co(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Co(em(this.r),em(this.g),em(this.b),hk(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S7,formatHex:S7,formatHex8:BOe,formatRgb:C7,toString:C7}));function S7(){return`#${Gp(this.r)}${Gp(this.g)}${Gp(this.b)}`}function BOe(){return`#${Gp(this.r)}${Gp(this.g)}${Gp(this.b)}${Gp((isNaN(this.opacity)?1:this.opacity)*255)}`}function C7(){const e=hk(this.opacity);return`${e===1?"rgb(":"rgba("}${em(this.r)}, ${em(this.g)}, ${em(this.b)}${e===1?")":`, ${e})`}`}function hk(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function em(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Gp(e){return e=em(e),(e<16?"0":"")+e.toString(16)}function k7(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new dc(e,t,n,r)}function NQ(e){if(e instanceof dc)return new dc(e.h,e.s,e.l,e.opacity);if(e instanceof q1||(e=Cw(e)),!e)return new dc;if(e instanceof dc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,o=i-s,l=(i+s)/2;return o?(t===i?a=(n-r)/o+(n<r)*6:n===i?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?i+s:2-i-s,a*=60):o=l>0&&l<1?0:a,new dc(a,o,l,e.opacity)}function $Oe(e,t,n,r){return arguments.length===1?NQ(e):new dc(e,t,n,r??1)}function dc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}DD(dc,$Oe,RQ(q1,{brighter(e){return e=e==null?fk:Math.pow(fk,e),new dc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?_w:Math.pow(_w,e),new dc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new Co(wI(e>=240?e-240:e+120,s,r),wI(e,s,r),wI(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new dc(E7(this.h),qS(this.s),qS(this.l),hk(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=hk(this.opacity);return`${e===1?"hsl(":"hsla("}${E7(this.h)}, ${qS(this.s)*100}%, ${qS(this.l)*100}%${e===1?")":`, ${e})`}`}}));function E7(e){return e=(e||0)%360,e<0?e+360:e}function qS(e){return Math.max(0,Math.min(1,e||0))}function wI(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const FD=e=>()=>e;function MQ(e,t){return function(n){return e+n*t}}function zOe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Fut(e,t){var n=t-e;return n?MQ(e,n>180||n<-180?n-360*Math.round(n/360):n):FD(isNaN(e)?t:e)}function UOe(e){return(e=+e)==1?IQ:function(t,n){return n-t?zOe(t,n,e):FD(isNaN(t)?n:t)}}function IQ(e,t){var n=t-e;return n?MQ(e,n):FD(isNaN(e)?t:e)}const T7=function e(t){var n=UOe(t);function r(s,i){var a=n((s=t4(s)).r,(i=t4(i)).r),o=n(s.g,i.g),l=n(s.b,i.b),c=IQ(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=o(u),s.b=l(u),s.opacity=c(u),s+""}}return r.gamma=e,r}(1);function rh(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var n4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_I=new RegExp(n4.source,"g");function qOe(e){return function(){return e}}function VOe(e){return function(t){return e(t)+""}}function WOe(e,t){var n=n4.lastIndex=_I.lastIndex=0,r,s,i,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=n4.exec(e))&&(s=_I.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),o[a]?o[a]+=i:o[++a]=i),(r=r[0])===(s=s[0])?o[a]?o[a]+=s:o[++a]=s:(o[++a]=null,l.push({i:a,x:rh(r,s)})),n=_I.lastIndex;return n<t.length&&(i=t.slice(n),o[a]?o[a]+=i:o[++a]=i),o.length<2?l[0]?VOe(l[0].x):qOe(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}var A7=180/Math.PI,r4={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function jQ(e,t,n,r,s,i){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*A7,skewX:Math.atan(l)*A7,scaleX:a,scaleY:o}}var VS;function HOe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?r4:jQ(t.a,t.b,t.c,t.d,t.e,t.f)}function GOe(e){return e==null||(VS||(VS=document.createElementNS("http://www.w3.org/2000/svg","g")),VS.setAttribute("transform",e),!(e=VS.transform.baseVal.consolidate()))?r4:(e=e.matrix,jQ(e.a,e.b,e.c,e.d,e.e,e.f))}function OQ(e,t,n,r){function s(c){return c.length?c.pop()+" ":""}function i(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push("translate(",null,t,null,n);y.push({i:b-4,x:rh(c,d)},{i:b-2,x:rh(u,h)})}else(d||h)&&m.push("translate("+d+t+h+n)}function a(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(s(d)+"rotate(",null,r)-2,x:rh(c,u)})):u&&d.push(s(d)+"rotate("+u+r)}function o(c,u,d,h){c!==u?h.push({i:d.push(s(d)+"skewX(",null,r)-2,x:rh(c,u)}):u&&d.push(s(d)+"skewX("+u+r)}function l(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push(s(m)+"scale(",null,",",null,")");y.push({i:b-4,x:rh(c,d)},{i:b-2,x:rh(u,h)})}else(d!==1||h!==1)&&m.push(s(m)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,d,h),a(c.rotate,u.rotate,d,h),o(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(m){for(var y=-1,b=h.length,v;++y<b;)d[(v=h[y]).i]=v.x(m);return d.join("")}}}var KOe=OQ(HOe,"px, ","px)","deg)"),YOe=OQ(GOe,", ",")",")"),wy=0,Zv=0,Dv=0,PQ=1e3,pk,Xv,mk=0,vm=0,mT=0,kw=typeof performance=="object"&&performance.now?performance:Date,DQ=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function LD(){return vm||(DQ(ZOe),vm=kw.now()+mT)}function ZOe(){vm=0}function gk(){this._call=this._time=this._next=null}gk.prototype=FQ.prototype={constructor:gk,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?LD():+n)+(t==null?0:+t),!this._next&&Xv!==this&&(Xv?Xv._next=this:pk=this,Xv=this),this._call=e,this._time=n,s4()},stop:function(){this._call&&(this._call=null,this._time=1/0,s4())}};function FQ(e,t,n){var r=new gk;return r.restart(e,t,n),r}function XOe(){LD(),++wy;for(var e=pk,t;e;)(t=vm-e._time)>=0&&e._call.call(void 0,t),e=e._next;--wy}function R7(){vm=(mk=kw.now())+mT,wy=Zv=0;try{XOe()}finally{wy=0,QOe(),vm=0}}function JOe(){var e=kw.now(),t=e-mk;t>PQ&&(mT-=t,mk=e)}function QOe(){for(var e,t=pk,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:pk=n);Xv=e,s4(r)}function s4(e){if(!wy){Zv&&(Zv=clearTimeout(Zv));var t=e-vm;t>24?(e<1/0&&(Zv=setTimeout(R7,e-kw.now()-mT)),Dv&&(Dv=clearInterval(Dv))):(Dv||(mk=kw.now(),Dv=setInterval(JOe,PQ)),wy=1,DQ(R7))}}function N7(e,t,n){var r=new gk;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var ePe=gQ("start","end","cancel","interrupt"),tPe=[],LQ=0,M7=1,i4=2,P2=3,I7=4,a4=5,D2=6;function gT(e,t,n,r,s,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;nPe(e,n,{name:t,index:r,group:s,on:ePe,tween:tPe,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:LQ})}function BD(e,t){var n=Oc(e,t);if(n.state>LQ)throw new Error("too late; already scheduled");return n}function Pu(e,t){var n=Oc(e,t);if(n.state>P2)throw new Error("too late; already running");return n}function Oc(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function nPe(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=FQ(i,0,n.time);function i(c){n.state=M7,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,d,h,m;if(n.state!==M7)return l();for(u in r)if(m=r[u],m.name===n.name){if(m.state===P2)return N7(a);m.state===I7?(m.state=D2,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[u]):+u<t&&(m.state=D2,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[u])}if(N7(function(){n.state===P2&&(n.state=I7,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=i4,n.on.call("start",e,e.__data__,n.index,n.group),n.state===i4){for(n.state=P2,s=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(m=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++d]=m);s.length=d+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=a4,1),d=-1,h=s.length;++d<h;)s[d].call(e,u);n.state===a4&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=D2,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function rPe(e,t){var n=e.__transition,r,s,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}s=r.state>i4&&r.state<a4,r.state=D2,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function sPe(e){return this.each(function(){rPe(this,e)})}function iPe(e,t){var n,r;return function(){var s=Pu(this,e),i=s.tween;if(i!==n){r=n=i;for(var a=0,o=r.length;a<o;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function aPe(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=Pu(this,e),a=i.tween;if(a!==r){s=(r=a).slice();for(var o={name:t,value:n},l=0,c=s.length;l<c;++l)if(s[l].name===t){s[l]=o;break}l===c&&s.push(o)}i.tween=s}}function oPe(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Oc(this.node(),n).tween,s=0,i=r.length,a;s<i;++s)if((a=r[s]).name===e)return a.value;return null}return this.each((t==null?iPe:aPe)(n,e,t))}function $D(e,t,n){var r=e._id;return e.each(function(){var s=Pu(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return Oc(s,r).value[t]}}function BQ(e,t){var n;return(typeof t=="number"?rh:t instanceof Cw?T7:(n=Cw(t))?(t=n,T7):WOe)(e,t)}function lPe(e){return function(){this.removeAttribute(e)}}function cPe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function uPe(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===r?i:i=t(r=a,n)}}function dPe(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===r?i:i=t(r=a,n)}}function fPe(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function hPe(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function pPe(e,t){var n=pT(e),r=n==="transform"?YOe:BQ;return this.attrTween(e,typeof t=="function"?(n.local?hPe:fPe)(n,r,$D(this,"attr."+e,t)):t==null?(n.local?cPe:lPe)(n):(n.local?dPe:uPe)(n,r,t))}function mPe(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function gPe(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function yPe(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&gPe(e,i)),n}return s._value=t,s}function bPe(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&mPe(e,i)),n}return s._value=t,s}function vPe(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=pT(e);return this.tween(n,(r.local?yPe:bPe)(r,t))}function xPe(e,t){return function(){BD(this,e).delay=+t.apply(this,arguments)}}function wPe(e,t){return t=+t,function(){BD(this,e).delay=t}}function _Pe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?xPe:wPe)(t,e)):Oc(this.node(),t).delay}function SPe(e,t){return function(){Pu(this,e).duration=+t.apply(this,arguments)}}function CPe(e,t){return t=+t,function(){Pu(this,e).duration=t}}function kPe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?SPe:CPe)(t,e)):Oc(this.node(),t).duration}function EPe(e,t){if(typeof t!="function")throw new Error;return function(){Pu(this,e).ease=t}}function TPe(e){var t=this._id;return arguments.length?this.each(EPe(t,e)):Oc(this.node(),t).ease}function APe(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Pu(this,e).ease=n}}function RPe(e){if(typeof e!="function")throw new Error;return this.each(APe(this._id,e))}function NPe(e){typeof e!="function"&&(e=vQ(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new Ud(r,this._parents,this._name,this._id)}function MPe(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),a=new Array(r),o=0;o<i;++o)for(var l=t[o],c=n[o],u=l.length,d=a[o]=new Array(u),h,m=0;m<u;++m)(h=l[m]||c[m])&&(d[m]=h);for(;o<r;++o)a[o]=t[o];return new Ud(a,this._parents,this._name,this._id)}function IPe(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function jPe(e,t,n){var r,s,i=IPe(t)?BD:Pu;return function(){var a=i(this,e),o=a.on;o!==r&&(s=(r=o).copy()).on(t,n),a.on=s}}function OPe(e,t){var n=this._id;return arguments.length<2?Oc(this.node(),n).on.on(e):this.each(jPe(n,e,t))}function PPe(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function DPe(){return this.on("end.remove",PPe(this._id))}function FPe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=OD(e));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var o=r[a],l=o.length,c=i[a]=new Array(l),u,d,h=0;h<l;++h)(u=o[h])&&(d=e.call(u,u.__data__,h,o))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,gT(c[h],t,n,h,c,Oc(u,n)));return new Ud(i,this._parents,t,n)}function LPe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=bQ(e));for(var r=this._groups,s=r.length,i=[],a=[],o=0;o<s;++o)for(var l=r[o],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=e.call(u,u.__data__,d,l),m,y=Oc(u,n),b=0,v=h.length;b<v;++b)(m=h[b])&&gT(m,t,n,b,h,y);i.push(h),a.push(u)}return new Ud(i,a,t,n)}var BPe=U1.prototype.constructor;function $Pe(){return new BPe(this._groups,this._parents)}function zPe(e,t){var n,r,s;return function(){var i=xy(this,e),a=(this.style.removeProperty(e),xy(this,e));return i===a?null:i===n&&a===r?s:s=t(n=i,r=a)}}function $Q(e){return function(){this.style.removeProperty(e)}}function UPe(e,t,n){var r,s=n+"",i;return function(){var a=xy(this,e);return a===s?null:a===r?i:i=t(r=a,n)}}function qPe(e,t,n){var r,s,i;return function(){var a=xy(this,e),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(e),xy(this,e))),a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o))}}function VPe(e,t){var n,r,s,i="style."+t,a="end."+i,o;return function(){var l=Pu(this,e),c=l.on,u=l.value[i]==null?o||(o=$Q(t)):void 0;(c!==n||s!==u)&&(r=(n=c).copy()).on(a,s=u),l.on=r}}function WPe(e,t,n){var r=(e+="")=="transform"?KOe:BQ;return t==null?this.styleTween(e,zPe(e,r)).on("end.style."+e,$Q(e)):typeof t=="function"?this.styleTween(e,qPe(e,r,$D(this,"style."+e,t))).each(VPe(this._id,e)):this.styleTween(e,UPe(e,r,t),n).on("end.style."+e,null)}function HPe(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function GPe(e,t,n){var r,s;function i(){var a=t.apply(this,arguments);return a!==s&&(r=(s=a)&&HPe(e,a,n)),r}return i._value=t,i}function KPe(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,GPe(e,t,n??""))}function YPe(e){return function(){this.textContent=e}}function ZPe(e){return function(){var t=e(this);this.textContent=t??""}}function XPe(e){return this.tween("text",typeof e=="function"?ZPe($D(this,"text",e)):YPe(e==null?"":e+""))}function JPe(e){return function(t){this.textContent=e.call(this,t)}}function QPe(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&JPe(s)),t}return r._value=e,r}function eDe(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,QPe(e))}function tDe(){for(var e=this._name,t=this._id,n=zQ(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=Oc(l,t);gT(l,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ud(r,this._parents,e,n)}function nDe(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var o={value:a},l={value:function(){--s===0&&i()}};n.each(function(){var c=Pu(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),c.on=t}),s===0&&i()})}var rDe=0;function Ud(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function zQ(){return++rDe}var dd=U1.prototype;Ud.prototype={constructor:Ud,select:FPe,selectAll:LPe,selectChild:dd.selectChild,selectChildren:dd.selectChildren,filter:NPe,merge:MPe,selection:$Pe,transition:tDe,call:dd.call,nodes:dd.nodes,node:dd.node,size:dd.size,empty:dd.empty,each:dd.each,on:OPe,attr:pPe,attrTween:vPe,style:WPe,styleTween:KPe,text:XPe,textTween:eDe,remove:DPe,tween:oPe,delay:_Pe,duration:kPe,ease:TPe,easeVarying:RPe,end:nDe,[Symbol.iterator]:dd[Symbol.iterator]};function sDe(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var iDe={time:null,delay:0,duration:250,ease:sDe};function aDe(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function oDe(e){var t,n;e instanceof Ud?(t=e._id,e=e._name):(t=zQ(),(n=iDe).time=LD(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&gT(l,e,t,c,a,n||aDe(l,t));return new Ud(r,this._parents,e,t)}U1.prototype.interrupt=sPe;U1.prototype.transition=oDe;const o4=Math.PI,l4=2*o4,Op=1e-6,lDe=l4-Op;function UQ(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function cDe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return UQ;const n=10**t;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class uDe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?UQ:cDe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,s){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(t,n,r,s,i,a){this._append`C${+t},${+n},${+r},${+s},${this._x1=+i},${this._y1=+a}`}arcTo(t,n,r,s,i){if(t=+t,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,l=r-t,c=s-n,u=a-t,d=o-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Op)if(!(Math.abs(d*l-c*u)>Op)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let m=r-a,y=s-o,b=l*l+c*c,v=m*m+y*y,x=Math.sqrt(b),w=Math.sqrt(h),S=i*Math.tan((o4-Math.acos((b+h-v)/(2*x*w)))/2),C=S/w,k=S/x;Math.abs(C-1)>Op&&this._append`L${t+C*u},${n+C*d}`,this._append`A${i},${i},0,0,${+(d*m>u*y)},${this._x1=t+k*l},${this._y1=n+k*c}`}}arc(t,n,r,s,i,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(s),l=r*Math.sin(s),c=t+o,u=n+l,d=1^a,h=a?s-i:i-s;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Op||Math.abs(this._y1-u)>Op)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%l4+l4),h>lDe?this._append`A${r},${r},0,1,${d},${t-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>Op&&this._append`A${r},${r},0,${+(h>=o4)},${d},${this._x1=t+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(t,n,r,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function Zg(e){return function(){return e}}const Lut=Math.abs,But=Math.atan2,$ut=Math.cos,zut=Math.max,Uut=Math.min,qut=Math.sin,Vut=Math.sqrt,j7=1e-12,zD=Math.PI,O7=zD/2,Wut=2*zD;function Hut(e){return e>1?0:e<-1?zD:Math.acos(e)}function Gut(e){return e>=1?O7:e<=-1?-O7:Math.asin(e)}function dDe(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new uDe(t)}function fDe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function qQ(e){this._context=e}qQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function yk(e){return new qQ(e)}function hDe(e){return e[0]}function pDe(e){return e[1]}function mDe(e,t){var n=Zg(!0),r=null,s=yk,i=null,a=dDe(o);e=typeof e=="function"?e:e===void 0?hDe:Zg(e),t=typeof t=="function"?t:t===void 0?pDe:Zg(t);function o(l){var c,u=(l=fDe(l)).length,d,h=!1,m;for(r==null&&(i=s(m=a())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(d,c,l),+t(d,c,l));if(m)return i=null,m+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:Zg(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:Zg(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Zg(!!l),o):n},o.curve=function(l){return arguments.length?(s=l,r!=null&&(i=s(r)),o):s},o.context=function(l){return arguments.length?(l==null?r=i=null:i=s(r=l),o):r},o}class VQ{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function WQ(e){return new VQ(e,!0)}function HQ(e){return new VQ(e,!1)}function Ah(){}function bk(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function yT(e){this._context=e}yT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:bk(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:bk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function F2(e){return new yT(e)}function GQ(e){this._context=e}GQ.prototype={areaStart:Ah,areaEnd:Ah,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:bk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gDe(e){return new GQ(e)}function KQ(e){this._context=e}KQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:bk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function yDe(e){return new KQ(e)}function YQ(e,t){this._basis=new yT(e),this._beta=t}YQ.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],s=t[0],i=e[n]-r,a=t[n]-s,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*i),this._beta*t[o]+(1-this._beta)*(s+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const bDe=function e(t){function n(r){return t===1?new yT(r):new YQ(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function vk(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function UD(e,t){this._context=e,this._k=(1-t)/6}UD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:vk(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:vk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ZQ=function e(t){function n(r){return new UD(r,t)}return n.tension=function(r){return e(+r)},n}(0);function qD(e,t){this._context=e,this._k=(1-t)/6}qD.prototype={areaStart:Ah,areaEnd:Ah,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:vk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const vDe=function e(t){function n(r){return new qD(r,t)}return n.tension=function(r){return e(+r)},n}(0);function VD(e,t){this._context=e,this._k=(1-t)/6}VD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:vk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const xDe=function e(t){function n(r){return new VD(r,t)}return n.tension=function(r){return e(+r)},n}(0);function WD(e,t,n){var r=e._x1,s=e._y1,i=e._x2,a=e._y2;if(e._l01_a>j7){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,s=(s*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>j7){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/u,a=(a*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,s,i,a,e._x2,e._y2)}function XQ(e,t){this._context=e,this._alpha=t}XQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:WD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const JQ=function e(t){function n(r){return t?new XQ(r,t):new UD(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function QQ(e,t){this._context=e,this._alpha=t}QQ.prototype={areaStart:Ah,areaEnd:Ah,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:WD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const wDe=function e(t){function n(r){return t?new QQ(r,t):new qD(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function eee(e,t){this._context=e,this._alpha=t}eee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:WD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const _De=function e(t){function n(r){return t?new eee(r,t):new VD(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function tee(e){this._context=e}tee.prototype={areaStart:Ah,areaEnd:Ah,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function SDe(e){return new tee(e)}function P7(e){return e<0?-1:1}function D7(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),a=(n-e._y1)/(s||r<0&&-0),o=(i*s+a*r)/(r+s);return(P7(i)+P7(a))*Math.min(Math.abs(i),Math.abs(a),.5*Math.abs(o))||0}function F7(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function SI(e,t,n){var r=e._x0,s=e._y0,i=e._x1,a=e._y1,o=(i-r)/3;e._context.bezierCurveTo(r+o,s+o*t,i-o,a-o*n,i,a)}function xk(e){this._context=e}xk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:SI(this,this._t0,F7(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,SI(this,F7(this,n=D7(this,e,t)),n);break;default:SI(this,this._t0,n=D7(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function nee(e){this._context=new ree(e)}(nee.prototype=Object.create(xk.prototype)).point=function(e,t){xk.prototype.point.call(this,t,e)};function ree(e){this._context=e}ree.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function see(e){return new xk(e)}function iee(e){return new nee(e)}function aee(e){this._context=e}aee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=L7(e),s=L7(t),i=0,a=1;a<n;++i,++a)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function L7(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),a=new Array(n);for(s[0]=0,i[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,a[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,a[t]-=r*a[t-1];for(s[n-1]=a[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(a[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function oee(e){return new aee(e)}function bT(e,t){this._context=e,this._t=t}bT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function lee(e){return new bT(e,.5)}function cee(e){return new bT(e,0)}function uee(e){return new bT(e,1)}function Jv(e,t,n){this.k=e,this.x=t,this.y=n}Jv.prototype={constructor:Jv,scale:function(e){return e===1?this:new Jv(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Jv(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Jv.prototype;const h0=globalThis||void 0||self;var dee=typeof h0=="object"&&h0&&h0.Object===Object&&h0,CDe=typeof self=="object"&&self&&self.Object===Object&&self,Du=dee||CDe||Function("return this")(),wk=Du.Symbol,fee=Object.prototype,kDe=fee.hasOwnProperty,EDe=fee.toString,Fv=wk?wk.toStringTag:void 0;function TDe(e){var t=kDe.call(e,Fv),n=e[Fv];try{e[Fv]=void 0;var r=!0}catch{}var s=EDe.call(e);return r&&(t?e[Fv]=n:delete e[Fv]),s}var ADe=Object.prototype,RDe=ADe.toString;function NDe(e){return RDe.call(e)}var MDe="[object Null]",IDe="[object Undefined]",B7=wk?wk.toStringTag:void 0;function eb(e){return e==null?e===void 0?IDe:MDe:B7&&B7 in Object(e)?TDe(e):NDe(e)}function $m(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var jDe="[object AsyncFunction]",ODe="[object Function]",PDe="[object GeneratorFunction]",DDe="[object Proxy]";function HD(e){if(!$m(e))return!1;var t=eb(e);return t==ODe||t==PDe||t==jDe||t==DDe}var CI=Du["__core-js_shared__"],$7=function(){var e=/[^.]+$/.exec(CI&&CI.keys&&CI.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function FDe(e){return!!$7&&$7 in e}var LDe=Function.prototype,BDe=LDe.toString;function zm(e){if(e!=null){try{return BDe.call(e)}catch{}try{return e+""}catch{}}return""}var $De=/[\\^$.*+?()[\]{}|]/g,zDe=/^\[object .+?Constructor\]$/,UDe=Function.prototype,qDe=Object.prototype,VDe=UDe.toString,WDe=qDe.hasOwnProperty,HDe=RegExp("^"+VDe.call(WDe).replace($De,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function GDe(e){if(!$m(e)||FDe(e))return!1;var t=HD(e)?HDe:zDe;return t.test(zm(e))}function KDe(e,t){return e==null?void 0:e[t]}function Um(e,t){var n=KDe(e,t);return GDe(n)?n:void 0}var Ew=Um(Object,"create");function YDe(){this.__data__=Ew?Ew(null):{},this.size=0}function ZDe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var XDe="__lodash_hash_undefined__",JDe=Object.prototype,QDe=JDe.hasOwnProperty;function e6e(e){var t=this.__data__;if(Ew){var n=t[e];return n===XDe?void 0:n}return QDe.call(t,e)?t[e]:void 0}var t6e=Object.prototype,n6e=t6e.hasOwnProperty;function r6e(e){var t=this.__data__;return Ew?t[e]!==void 0:n6e.call(t,e)}var s6e="__lodash_hash_undefined__";function i6e(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ew&&t===void 0?s6e:t,this}function xm(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}xm.prototype.clear=YDe;xm.prototype.delete=ZDe;xm.prototype.get=e6e;xm.prototype.has=r6e;xm.prototype.set=i6e;function a6e(){this.__data__=[],this.size=0}function vT(e,t){return e===t||e!==e&&t!==t}function xT(e,t){for(var n=e.length;n--;)if(vT(e[n][0],t))return n;return-1}var o6e=Array.prototype,l6e=o6e.splice;function c6e(e){var t=this.__data__,n=xT(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():l6e.call(t,n,1),--this.size,!0}function u6e(e){var t=this.__data__,n=xT(t,e);return n<0?void 0:t[n][1]}function d6e(e){return xT(this.__data__,e)>-1}function f6e(e,t){var n=this.__data__,r=xT(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function nf(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}nf.prototype.clear=a6e;nf.prototype.delete=c6e;nf.prototype.get=u6e;nf.prototype.has=d6e;nf.prototype.set=f6e;var Tw=Um(Du,"Map");function h6e(){this.size=0,this.__data__={hash:new xm,map:new(Tw||nf),string:new xm}}function p6e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function wT(e,t){var n=e.__data__;return p6e(t)?n[typeof t=="string"?"string":"hash"]:n.map}function m6e(e){var t=wT(this,e).delete(e);return this.size-=t?1:0,t}function g6e(e){return wT(this,e).get(e)}function y6e(e){return wT(this,e).has(e)}function b6e(e,t){var n=wT(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function Yh(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Yh.prototype.clear=h6e;Yh.prototype.delete=m6e;Yh.prototype.get=g6e;Yh.prototype.has=y6e;Yh.prototype.set=b6e;var v6e="Expected a function";function V1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(v6e);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(V1.Cache||Yh),n}V1.Cache=Yh;function x6e(){this.__data__=new nf,this.size=0}function w6e(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function _6e(e){return this.__data__.get(e)}function S6e(e){return this.__data__.has(e)}var C6e=200;function k6e(e,t){var n=this.__data__;if(n instanceof nf){var r=n.__data__;if(!Tw||r.length<C6e-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Yh(r)}return n.set(e,t),this.size=n.size,this}function tb(e){var t=this.__data__=new nf(e);this.size=t.size}tb.prototype.clear=x6e;tb.prototype.delete=w6e;tb.prototype.get=_6e;tb.prototype.has=S6e;tb.prototype.set=k6e;var _k=function(){try{var e=Um(Object,"defineProperty");return e({},"",{}),e}catch{}}();function GD(e,t,n){t=="__proto__"&&_k?_k(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function c4(e,t,n){(n!==void 0&&!vT(e[t],n)||n===void 0&&!(t in e))&&GD(e,t,n)}function E6e(e){return function(t,n,r){for(var s=-1,i=Object(t),a=r(t),o=a.length;o--;){var l=a[++s];if(n(i[l],l,i)===!1)break}return t}}var T6e=E6e(),hee=typeof exports=="object"&&exports&&!exports.nodeType&&exports,z7=hee&&typeof module=="object"&&module&&!module.nodeType&&module,A6e=z7&&z7.exports===hee,U7=A6e?Du.Buffer:void 0,q7=U7?U7.allocUnsafe:void 0;function R6e(e,t){if(t)return e.slice();var n=e.length,r=q7?q7(n):new e.constructor(n);return e.copy(r),r}var V7=Du.Uint8Array;function N6e(e){var t=new e.constructor(e.byteLength);return new V7(t).set(new V7(e)),t}function M6e(e,t){var n=t?N6e(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function I6e(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var W7=Object.create,j6e=function(){function e(){}return function(t){if(!$m(t))return{};if(W7)return W7(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function pee(e,t){return function(n){return e(t(n))}}var mee=pee(Object.getPrototypeOf,Object),O6e=Object.prototype;function _T(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||O6e;return e===n}function P6e(e){return typeof e.constructor=="function"&&!_T(e)?j6e(mee(e)):{}}function W1(e){return e!=null&&typeof e=="object"}var D6e="[object Arguments]";function H7(e){return W1(e)&&eb(e)==D6e}var gee=Object.prototype,F6e=gee.hasOwnProperty,L6e=gee.propertyIsEnumerable,Sk=H7(function(){return arguments}())?H7:function(e){return W1(e)&&F6e.call(e,"callee")&&!L6e.call(e,"callee")},Ck=Array.isArray,B6e=9007199254740991;function yee(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=B6e}function ST(e){return e!=null&&yee(e.length)&&!HD(e)}function $6e(e){return W1(e)&&ST(e)}function z6e(){return!1}var bee=typeof exports=="object"&&exports&&!exports.nodeType&&exports,G7=bee&&typeof module=="object"&&module&&!module.nodeType&&module,U6e=G7&&G7.exports===bee,K7=U6e?Du.Buffer:void 0,q6e=K7?K7.isBuffer:void 0,KD=q6e||z6e,V6e="[object Object]",W6e=Function.prototype,H6e=Object.prototype,vee=W6e.toString,G6e=H6e.hasOwnProperty,K6e=vee.call(Object);function Y6e(e){if(!W1(e)||eb(e)!=V6e)return!1;var t=mee(e);if(t===null)return!0;var n=G6e.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&vee.call(n)==K6e}var Z6e="[object Arguments]",X6e="[object Array]",J6e="[object Boolean]",Q6e="[object Date]",e5e="[object Error]",t5e="[object Function]",n5e="[object Map]",r5e="[object Number]",s5e="[object Object]",i5e="[object RegExp]",a5e="[object Set]",o5e="[object String]",l5e="[object WeakMap]",c5e="[object ArrayBuffer]",u5e="[object DataView]",d5e="[object Float32Array]",f5e="[object Float64Array]",h5e="[object Int8Array]",p5e="[object Int16Array]",m5e="[object Int32Array]",g5e="[object Uint8Array]",y5e="[object Uint8ClampedArray]",b5e="[object Uint16Array]",v5e="[object Uint32Array]",Ls={};Ls[d5e]=Ls[f5e]=Ls[h5e]=Ls[p5e]=Ls[m5e]=Ls[g5e]=Ls[y5e]=Ls[b5e]=Ls[v5e]=!0;Ls[Z6e]=Ls[X6e]=Ls[c5e]=Ls[J6e]=Ls[u5e]=Ls[Q6e]=Ls[e5e]=Ls[t5e]=Ls[n5e]=Ls[r5e]=Ls[s5e]=Ls[i5e]=Ls[a5e]=Ls[o5e]=Ls[l5e]=!1;function x5e(e){return W1(e)&&yee(e.length)&&!!Ls[eb(e)]}function w5e(e){return function(t){return e(t)}}var xee=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xx=xee&&typeof module=="object"&&module&&!module.nodeType&&module,_5e=xx&&xx.exports===xee,kI=_5e&&dee.process,Y7=function(){try{var e=xx&&xx.require&&xx.require("util").types;return e||kI&&kI.binding&&kI.binding("util")}catch{}}(),Z7=Y7&&Y7.isTypedArray,YD=Z7?w5e(Z7):x5e;function u4(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var S5e=Object.prototype,C5e=S5e.hasOwnProperty;function k5e(e,t,n){var r=e[t];(!(C5e.call(e,t)&&vT(r,n))||n===void 0&&!(t in e))&&GD(e,t,n)}function E5e(e,t,n,r){var s=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],l=void 0;l===void 0&&(l=e[o]),s?GD(n,o,l):k5e(n,o,l)}return n}function T5e(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var A5e=9007199254740991,R5e=/^(?:0|[1-9]\d*)$/;function wee(e,t){var n=typeof e;return t=t??A5e,!!t&&(n=="number"||n!="symbol"&&R5e.test(e))&&e>-1&&e%1==0&&e<t}var N5e=Object.prototype,M5e=N5e.hasOwnProperty;function I5e(e,t){var n=Ck(e),r=!n&&Sk(e),s=!n&&!r&&KD(e),i=!n&&!r&&!s&&YD(e),a=n||r||s||i,o=a?T5e(e.length,String):[],l=o.length;for(var c in e)(t||M5e.call(e,c))&&!(a&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||wee(c,l)))&&o.push(c);return o}function j5e(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var O5e=Object.prototype,P5e=O5e.hasOwnProperty;function D5e(e){if(!$m(e))return j5e(e);var t=_T(e),n=[];for(var r in e)r=="constructor"&&(t||!P5e.call(e,r))||n.push(r);return n}function _ee(e){return ST(e)?I5e(e,!0):D5e(e)}function F5e(e){return E5e(e,_ee(e))}function L5e(e,t,n,r,s,i,a){var o=u4(e,n),l=u4(t,n),c=a.get(l);if(c){c4(e,n,c);return}var u=i?i(o,l,n+"",e,t,a):void 0,d=u===void 0;if(d){var h=Ck(l),m=!h&&KD(l),y=!h&&!m&&YD(l);u=l,h||m||y?Ck(o)?u=o:$6e(o)?u=I6e(o):m?(d=!1,u=R6e(l,!0)):y?(d=!1,u=M6e(l,!0)):u=[]:Y6e(l)||Sk(l)?(u=o,Sk(o)?u=F5e(o):(!$m(o)||HD(o))&&(u=P6e(l))):d=!1}d&&(a.set(l,u),s(u,l,r,i,a),a.delete(l)),c4(e,n,u)}function See(e,t,n,r,s){e!==t&&T6e(t,function(i,a){if(s||(s=new tb),$m(i))L5e(e,t,a,n,See,r,s);else{var o=r?r(u4(e,a),i,a+"",e,t,s):void 0;o===void 0&&(o=i),c4(e,a,o)}},_ee)}function Cee(e){return e}function B5e(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var X7=Math.max;function $5e(e,t,n){return t=X7(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=X7(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=n(a),B5e(e,this,o)}}function z5e(e){return function(){return e}}var U5e=_k?function(e,t){return _k(e,"toString",{configurable:!0,enumerable:!1,value:z5e(t),writable:!0})}:Cee,q5e=800,V5e=16,W5e=Date.now;function H5e(e){var t=0,n=0;return function(){var r=W5e(),s=V5e-(r-n);if(n=r,s>0){if(++t>=q5e)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var G5e=H5e(U5e);function K5e(e,t){return G5e($5e(e,t,Cee),e+"")}function Y5e(e,t,n){if(!$m(n))return!1;var r=typeof t;return(r=="number"?ST(n)&&wee(t,n.length):r=="string"&&t in n)?vT(n[t],e):!1}function Z5e(e){return K5e(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,a&&Y5e(n[0],n[1],a)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var o=n[r];o&&e(t,o,r,i)}return t})}var X5e=Z5e(function(e,t,n){See(e,t,n)}),J5e="",Q5e={curveBasis:F2,curveBasisClosed:gDe,curveBasisOpen:yDe,curveBumpX:WQ,curveBumpY:HQ,curveBundle:bDe,curveCardinalClosed:vDe,curveCardinalOpen:xDe,curveCardinal:ZQ,curveCatmullRomClosed:wDe,curveCatmullRomOpen:_De,curveCatmullRom:JQ,curveLinear:yk,curveLinearClosed:SDe,curveMonotoneX:see,curveMonotoneY:iee,curveNatural:oee,curveStep:lee,curveStepAfter:uee,curveStepBefore:cee},eFe=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,tFe=ie(function(e,t){const n=kee(e,/(?:init\b)|(?:initialize\b)/);let r={};if(Array.isArray(n)){const a=n.map(o=>o.args);ek(a),r=va(r,[...a])}else r=n.args;if(!r)return;let s=vD(e,t);const i="config";return r[i]!==void 0&&(s==="flowchart-v2"&&(s="flowchart"),r[s]=r[i],delete r[i]),r},"detectInit"),kee=ie(function(e,t=null){var n,r;try{const s=new RegExp(`[%]{2}(?![{]${eFe.source})(?=[}][%]{2}).*
`,"ig");e=e.trim().replace(s,"").replace(/'/gm,'"'),zt.debug(`Detecting diagram directive${t!==null?" type:"+t:""} based on the text:${e}`);let i;const a=[];for(;(i=bx.exec(e))!==null;)if(i.index===bx.lastIndex&&bx.lastIndex++,i&&!t||t&&((n=i[1])!=null&&n.match(t))||t&&((r=i[2])!=null&&r.match(t))){const o=i[1]?i[1]:i[2],l=i[3]?i[3].trim():i[4]?JSON.parse(i[4].trim()):null;a.push({type:o,args:l})}return a.length===0?{type:e,args:null}:a.length===1?a[0]:a}catch(s){return zt.error(`ERROR: ${s.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}},"detectDirective"),nFe=ie(function(e){return e.replace(bx,"")},"removeDirectives"),rFe=ie(function(e,t){for(const[n,r]of t.entries())if(r.match(e))return n;return-1},"isSubstringInArray");function ZD(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return Q5e[n]??t}ie(ZD,"interpolateToCurve");function Eee(e,t){const n=e.trim();if(n)return t.securityLevel!=="loose"?Gje.sanitizeUrl(n):n}ie(Eee,"formatUrl");var sFe=ie((e,...t)=>{const n=e.split("."),r=n.length-1,s=n[r];let i=window;for(let a=0;a<r;a++)if(i=i[n[a]],!i){zt.error(`Function name: ${e} not found in window`);return}i[s](...t)},"runFunc");function XD(e,t){return!e||!t?0:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}ie(XD,"distance");function Tee(e){let t,n=0;e.forEach(s=>{n+=XD(s,t),t=s});const r=n/2;return JD(e,r)}ie(Tee,"traverseEdge");function Aee(e){return e.length===1?e[0]:Tee(e)}ie(Aee,"calcLabelPosition");var J7=ie((e,t=2)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},"roundNumber"),JD=ie((e,t)=>{let n,r=t;for(const s of e){if(n){const i=XD(s,n);if(i===0)return n;if(i<r)r-=i;else{const a=r/i;if(a<=0)return n;if(a>=1)return{x:s.x,y:s.y};if(a>0&&a<1)return{x:J7((1-a)*n.x+a*s.x,5),y:J7((1-a)*n.y+a*s.y,5)}}}n=s}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),iFe=ie((e,t,n)=>{zt.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());const s=JD(t,25),i=e?10:5,a=Math.atan2(t[0].y-s.y,t[0].x-s.x),o={x:0,y:0};return o.x=Math.sin(a)*i+(t[0].x+s.x)/2,o.y=-Math.cos(a)*i+(t[0].y+s.y)/2,o},"calcCardinalityPosition");function Ree(e,t,n){const r=structuredClone(n);zt.info("our points",r),t!=="start_left"&&t!=="start_right"&&r.reverse();const s=25+e,i=JD(r,s),a=10+e*.5,o=Math.atan2(r[0].y-i.y,r[0].x-i.x),l={x:0,y:0};return t==="start_left"?(l.x=Math.sin(o+Math.PI)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o+Math.PI)*a+(r[0].y+i.y)/2):t==="end_right"?(l.x=Math.sin(o-Math.PI)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o-Math.PI)*a+(r[0].y+i.y)/2-5):t==="end_left"?(l.x=Math.sin(o)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2-5):(l.x=Math.sin(o)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2),l}ie(Ree,"calcTerminalLabelPosition");function Nee(e){let t="",n="";for(const r of e)r!==void 0&&(r.startsWith("color:")||r.startsWith("text-align:")?n=n+r+";":t=t+r+";");return{style:t,labelStyle:n}}ie(Nee,"getStylesFromArray");var Q7=0,aFe=ie(()=>(Q7++,"id-"+Math.random().toString(36).substr(2,12)+"-"+Q7),"generateId");function Mee(e){let t="";const n="0123456789abcdef",r=n.length;for(let s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*r));return t}ie(Mee,"makeRandomHex");var oFe=ie(e=>Mee(e.length),"random"),lFe=ie(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),cFe=ie(function(e,t){const n=t.text.replace(Qy.lineBreakRegex," "),[,r]=CT(t.fontSize),s=e.append("text");s.attr("x",t.x),s.attr("y",t.y),s.style("text-anchor",t.anchor),s.style("font-family",t.fontFamily),s.style("font-size",r),s.style("font-weight",t.fontWeight),s.attr("fill",t.fill),t.class!==void 0&&s.attr("class",t.class);const i=s.append("tspan");return i.attr("x",t.x+t.textMargin*2),i.attr("fill",t.fill),i.text(n),s},"drawSimpleText"),uFe=V1((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),Qy.lineBreakRegex.test(e)))return e;const r=e.split(" ").filter(Boolean),s=[];let i="";return r.forEach((a,o)=>{const l=qd(`${a} `,n),c=qd(i,n);if(l>t){const{hyphenatedStrings:h,remainingWord:m}=dFe(a,t,"-",n);s.push(i,...h),i=m}else c+l>=t?(s.push(i),i=a):i=[i,a].filter(Boolean).join(" ");o+1===r.length&&s.push(i)}),s.filter(a=>a!=="").join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),dFe=V1((e,t,n="-",r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},r);const s=[...e],i=[];let a="";return s.forEach((o,l)=>{const c=`${a}${o}`;if(qd(c,r)>=t){const d=l+1,h=s.length===d,m=`${c}${n}`;i.push(h?c:m),a=""}else a=c}),{hyphenatedStrings:i,remainingWord:a}},(e,t,n="-",r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function Iee(e,t){return QD(e,t).height}ie(Iee,"calculateTextHeight");function qd(e,t){return QD(e,t).width}ie(qd,"calculateTextWidth");var QD=V1((e,t)=>{const{fontSize:n=12,fontFamily:r="Arial",fontWeight:s=400}=t;if(!e)return{width:0,height:0};const[,i]=CT(n),a=["sans-serif",r],o=e.split(Qy.lineBreakRegex),l=[],c=Kr("body");if(!c.remove)return{width:0,height:0,lineHeight:0};const u=c.append("svg");for(const h of a){let m=0;const y={width:0,height:0,lineHeight:0};for(const b of o){const v=lFe();v.text=b||J5e;const x=cFe(u,v).style("font-size",i).style("font-weight",s).style("font-family",h),w=(x._groups||x)[0][0].getBBox();if(w.width===0&&w.height===0)throw new Error("svg element not in render tree");y.width=Math.round(Math.max(y.width,w.width)),m=Math.round(w.height),y.height+=m,y.lineHeight=Math.round(Math.max(y.lineHeight,m))}l.push(y)}u.remove();const d=isNaN(l[1].height)||isNaN(l[1].width)||isNaN(l[1].lineHeight)||l[0].height>l[1].height&&l[0].width>l[1].width&&l[0].lineHeight>l[1].lineHeight?0:1;return l[d]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),U0,fFe=(U0=class{constructor(t=!1,n){this.count=0,this.count=n?n.length:0,this.next=t?()=>this.count++:()=>Date.now()}},ie(U0,"InitIDGenerator"),U0),WS,hFe=ie(function(e){return WS=WS||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),WS.innerHTML=e,unescape(WS.textContent)},"entityDecode");function e6(e){return"str"in e}ie(e6,"isDetailedError");var pFe=ie((e,t,n,r)=>{var i;if(!r)return;const s=(i=e.node())==null?void 0:i.getBBox();s&&e.append("text").text(r).attr("text-anchor","middle").attr("x",s.x+s.width/2).attr("y",-n).attr("class",t)},"insertTitle"),CT=ie(e=>{if(typeof e=="number")return[e,e+"px"];const t=parseInt(e??"",10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]},"parseFontSize");function t6(e,t){return X5e({},e,t)}ie(t6,"cleanAndMerge");var lu={assignWithDepth:va,wrapLabel:uFe,calculateTextHeight:Iee,calculateTextWidth:qd,calculateTextDimensions:QD,cleanAndMerge:t6,detectInit:tFe,detectDirective:kee,isSubstringInArray:rFe,interpolateToCurve:ZD,calcLabelPosition:Aee,calcCardinalityPosition:iFe,calcTerminalLabelPosition:Ree,formatUrl:Eee,getStylesFromArray:Nee,generateId:aFe,random:oFe,runFunc:sFe,entityDecode:hFe,insertTitle:pFe,parseFontSize:CT,InitIDGenerator:fFe},mFe=ie(function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/#\w+;/g,function(n){const r=n.substring(1,n.length-1);return/^\+?\d+$/.test(r)?""+r+"":""+r+""}),t},"encodeEntities"),qm=ie(function(e){return e.replace(//g,"&#").replace(//g,"&").replace(//g,";")},"decodeEntities"),Kut=ie((e,t,{counter:n=0,prefix:r,suffix:s},i)=>i||`${r?`${r}_`:""}${e}_${t}_${n}${s?`_${s}`:""}`,"getEdgeId");function no(e){return e??null}ie(no,"handleUndefinedAttr");function n6(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Vm=n6();function jee(e){Vm=e}var wx={exec:()=>null};function ps(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(s,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(Qa.caret,"$1"),n=n.replace(s,a),r},getRegex:()=>new RegExp(n,t)};return r}var Qa={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},gFe=/^(?:[ \t]*(?:\n|$))+/,yFe=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,bFe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,H1=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,vFe=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,r6=/(?:[*+-]|\d{1,9}[.)])/,Oee=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Pee=ps(Oee).replace(/bull/g,r6).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),xFe=ps(Oee).replace(/bull/g,r6).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),s6=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,wFe=/^[^\n]+/,i6=/(?!\s*\])(?:\\.|[^\[\]\\])+/,_Fe=ps(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",i6).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),SFe=ps(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,r6).getRegex(),kT="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",a6=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,CFe=ps("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",a6).replace("tag",kT).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Dee=ps(s6).replace("hr",H1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kT).getRegex(),kFe=ps(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Dee).getRegex(),o6={blockquote:kFe,code:yFe,def:_Fe,fences:bFe,heading:vFe,hr:H1,html:CFe,lheading:Pee,list:SFe,newline:gFe,paragraph:Dee,table:wx,text:wFe},eU=ps("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",H1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kT).getRegex(),EFe={...o6,lheading:xFe,table:eU,paragraph:ps(s6).replace("hr",H1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",eU).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kT).getRegex()},TFe={...o6,html:ps(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",a6).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:wx,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ps(s6).replace("hr",H1).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Pee).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},AFe=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,RFe=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Fee=/^( {2,}|\\)\n(?!\s*$)/,NFe=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ET=/[\p{P}\p{S}]/u,l6=/[\s\p{P}\p{S}]/u,Lee=/[^\s\p{P}\p{S}]/u,MFe=ps(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,l6).getRegex(),Bee=/(?!~)[\p{P}\p{S}]/u,IFe=/(?!~)[\s\p{P}\p{S}]/u,jFe=/(?:[^\s\p{P}\p{S}]|~)/u,OFe=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,$ee=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,PFe=ps($ee,"u").replace(/punct/g,ET).getRegex(),DFe=ps($ee,"u").replace(/punct/g,Bee).getRegex(),zee="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",FFe=ps(zee,"gu").replace(/notPunctSpace/g,Lee).replace(/punctSpace/g,l6).replace(/punct/g,ET).getRegex(),LFe=ps(zee,"gu").replace(/notPunctSpace/g,jFe).replace(/punctSpace/g,IFe).replace(/punct/g,Bee).getRegex(),BFe=ps("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Lee).replace(/punctSpace/g,l6).replace(/punct/g,ET).getRegex(),$Fe=ps(/\\(punct)/,"gu").replace(/punct/g,ET).getRegex(),zFe=ps(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),UFe=ps(a6).replace("(?:-->|$)","-->").getRegex(),qFe=ps("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",UFe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),kk=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,VFe=ps(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",kk).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Uee=ps(/^!?\[(label)\]\[(ref)\]/).replace("label",kk).replace("ref",i6).getRegex(),qee=ps(/^!?\[(ref)\](?:\[\])?/).replace("ref",i6).getRegex(),WFe=ps("reflink|nolink(?!\\()","g").replace("reflink",Uee).replace("nolink",qee).getRegex(),c6={_backpedal:wx,anyPunctuation:$Fe,autolink:zFe,blockSkip:OFe,br:Fee,code:RFe,del:wx,emStrongLDelim:PFe,emStrongRDelimAst:FFe,emStrongRDelimUnd:BFe,escape:AFe,link:VFe,nolink:qee,punctuation:MFe,reflink:Uee,reflinkSearch:WFe,tag:qFe,text:NFe,url:wx},HFe={...c6,link:ps(/^!?\[(label)\]\((.*?)\)/).replace("label",kk).getRegex(),reflink:ps(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",kk).getRegex()},d4={...c6,emStrongRDelimAst:LFe,emStrongLDelim:DFe,url:ps(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},GFe={...d4,br:ps(Fee).replace("{2,}","*").getRegex(),text:ps(d4.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},HS={normal:o6,gfm:EFe,pedantic:TFe},Lv={normal:c6,gfm:d4,breaks:GFe,pedantic:HFe},KFe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tU=e=>KFe[e];function Xc(e,t){if(t){if(Qa.escapeTest.test(e))return e.replace(Qa.escapeReplace,tU)}else if(Qa.escapeTestNoEncode.test(e))return e.replace(Qa.escapeReplaceNoEncode,tU);return e}function nU(e){try{e=encodeURI(e).replace(Qa.percentDecode,"%")}catch{return null}return e}function rU(e,t){var i;const n=e.replace(Qa.findPipe,(a,o,l)=>{let c=!1,u=o;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(Qa.splitPipe);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!((i=r.at(-1))!=null&&i.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(Qa.slashPipe,"|");return r}function Bv(e,t,n){const r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function YFe(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function sU(e,t,n,r,s){const i=t.href,a=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function ZFe(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const s=r[1];return t.split(`
`).map(i=>{const a=i.match(n.other.beginningSpace);if(a===null)return i;const[o]=a;return o.length>=s.length?i.slice(s.length):i}).join(`
`)}var Ek=class{constructor(e){ve(this,"options");ve(this,"rules");ve(this,"lexer");this.options=e||Vm}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Bv(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=ZFe(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=Bv(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Bv(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=Bv(t[0],`
`).split(`
`),r="",s="";const i=[];for(;n.length>0;){let a=!1;const o=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);const c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,s=s?`${s}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,i,!0),this.lexer.state.top=d,n.length===0)break;const h=i.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.blockquote(y);i[i.length-1]=b,r=r.substring(0,r.length-m.raw.length)+b.raw,s=s.substring(0,s.length-m.text.length)+b.text;break}else if((h==null?void 0:h.type)==="list"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.list(y);i[i.length-1]=b,r=r.substring(0,r.length-h.raw.length)+b.raw,s=s.substring(0,s.length-m.raw.length)+b.raw,n=y.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const i=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,x=>" ".repeat(3*x.length)),h=e.split(`
`,1)[0],m=!d.trim(),y=0;if(this.options.pedantic?(y=2,u=d.trimStart()):m?y=t[1].length+1:(y=t[2].search(this.rules.other.nonSpaceChar),y=y>4?1:y,u=d.slice(y),y+=t[1].length),m&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),l=!0),!l){const x=this.rules.other.nextBulletRegex(y),w=this.rules.other.hrRegex(y),S=this.rules.other.fencesBeginRegex(y),C=this.rules.other.headingBeginRegex(y),k=this.rules.other.htmlBeginRegex(y);for(;e;){const A=e.split(`
`,1)[0];let R;if(h=A,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),R=h):R=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||C.test(h)||k.test(h)||x.test(h)||w.test(h))break;if(R.search(this.rules.other.nonSpaceChar)>=y||!h.trim())u+=`
`+R.slice(y);else{if(m||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(d)||C.test(d)||w.test(d))break;u+=`
`+h}!m&&!h.trim()&&(m=!0),c+=A+`
`,e=e.substring(A.length+1),d=R.slice(y)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let b=null,v;this.options.gfm&&(b=this.rules.other.listIsTask.exec(u),b&&(v=b[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!b,checked:v,loose:!1,text:u,tokens:[]}),s.raw+=c}const o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const c=s.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=u}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){var a;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=rU(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const o of r)this.rules.other.tableAlignRight.test(o)?i.align.push("right"):this.rules.other.tableAlignCenter.test(o)?i.align.push("center"):this.rules.other.tableAlignLeft.test(o)?i.align.push("left"):i.align.push(null);for(let o=0;o<n.length;o++)i.header.push({text:n[o],tokens:this.lexer.inline(n[o]),header:!0,align:i.align[o]});for(const o of s)i.rows.push(rU(o,i.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[c]})));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const i=Bv(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{const i=YFe(t[2],"()");if(i===-2)return;if(i>-1){const o=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,o).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],s=i[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),sU(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){const i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return sU(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const i=[...r[0]].length-1;let a,o,l=i,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+i);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=[...a].length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&i%3&&!((i+o)%3)){c+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+c);const d=[...r[0]][0].length,h=e.slice(0,i+r.index+d+o);if(Math.min(i,o)%2){const y=h.slice(1,-1);return{type:"em",raw:h,text:y,tokens:this.lexer.inlineTokens(y)}}const m=h.slice(2,-2);return{type:"strong",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=t[0],s="mailto:"+r;else{let i;do i=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(i!==t[0]);r=t[0],t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Sd=class f4{constructor(t){ve(this,"tokens");ve(this,"options");ve(this,"state");ve(this,"tokenizer");ve(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Vm,this.options.tokenizer=this.options.tokenizer||new Ek,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:Qa,block:HS.normal,inline:Lv.normal};this.options.pedantic?(n.block=HS.pedantic,n.inline=Lv.pedantic):this.options.gfm&&(n.block=HS.gfm,this.options.breaks?n.inline=Lv.breaks:n.inline=Lv.gfm),this.tokenizer.rules=n}static get rules(){return{block:HS,inline:Lv}}static lex(t,n){return new f4(n).lex(t)}static lexInline(t,n){return new f4(n).inlineTokens(t)}lex(t){t=t.replace(Qa.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var s,i,a;for(this.options.pedantic&&(t=t.replace(Qa.tabCharGlobal,"    ").replace(Qa.spaceLine,""));t;){let o;if((i=(s=this.options.extensions)==null?void 0:s.block)!=null&&i.some(c=>(o=c.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);const c=n.at(-1);o.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let l=t;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o),r=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,l,c;let r=t,s=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,a="";for(;t;){i||(a=""),i=!1;let u;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(h=>(u=h.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,a)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0;const m=t.slice(1);let y;this.options.extensions.startInline.forEach(b=>{y=b.call({lexer:this},m),typeof y=="number"&&y>=0&&(h=Math.min(h,y))}),h<1/0&&h>=0&&(d=t.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),i=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},Tk=class{constructor(e){ve(this,"options");ve(this,"parser");this.options=e||Vm}space(e){return""}code({text:e,lang:t,escaped:n}){var i;const r=(i=(t||"").match(Qa.notSpaceStart))==null?void 0:i[0],s=e.replace(Qa.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Xc(r)+'">'+(n?s:Xc(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:Xc(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let a=0;a<e.items.length;a++){const o=e.items[a];r+=this.listitem(o)}const s=t?"ol":"ul",i=t&&n!==1?' start="'+n+'"':"";return"<"+s+i+`>
`+r+"</"+s+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+Xc(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){const i=e.rows[s];n="";for(let a=0;a<i.length;a++)n+=this.tablecell(i[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Xc(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),s=nU(e);if(s===null)return r;e=s;let i='<a href="'+e+'"';return t&&(i+=' title="'+Xc(t)+'"'),i+=">"+r+"</a>",i}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const s=nU(e);if(s===null)return Xc(n);e=s;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${Xc(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Xc(e.text)}},u6=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Cd=class h4{constructor(t){ve(this,"options");ve(this,"renderer");ve(this,"textRenderer");this.options=t||Vm,this.options.renderer=this.options.renderer||new Tk,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new u6}static parse(t,n){return new h4(n).parse(t)}static parseInline(t,n){return new h4(n).parseInline(t)}parse(t,n=!0){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=o,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=o;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;a+1<t.length&&t[a+1].type==="text";)c=t[++a],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=this.options.extensions.renderers[o.type].call({parser:this},o);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=c||"";continue}}const l=o;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},P3,L2=(P3=class{constructor(e){ve(this,"options");ve(this,"block");this.options=e||Vm}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Sd.lex:Sd.lexInline}provideParser(){return this.block?Cd.parse:Cd.parseInline}},ve(P3,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),P3),XFe=class{constructor(...e){ve(this,"defaults",n6());ve(this,"options",this.setOptions);ve(this,"parse",this.parseMarkdown(!0));ve(this,"parseInline",this.parseMarkdown(!1));ve(this,"Parser",Cd);ve(this,"Renderer",Tk);ve(this,"TextRenderer",u6);ve(this,"Lexer",Sd);ve(this,"Tokenizer",Ek);ve(this,"Hooks",L2);this.use(...e)}walkTokens(e,t){var r,s;let n=[];for(const i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{const a=i;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of a.rows)for(const l of o)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{const a=i;n=n.concat(this.walkTokens(a.items,t));break}default:{const a=i;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{const l=a[o].flat(1/0);n=n.concat(this.walkTokens(l,t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const i=t.renderers[s.name];i?t.renderers[s.name]=function(...a){let o=s.renderer.apply(this,a);return o===!1&&(o=i.apply(this,a)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=t[s.level];i?i.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){const s=this.defaults.renderer||new Tk(this.defaults);for(const i in n.renderer){if(!(i in s))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;const a=i,o=n.renderer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u||""}}r.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new Ek(this.defaults);for(const i in n.tokenizer){if(!(i in s))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const a=i,o=n.tokenizer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new L2;for(const i in n.hooks){if(!(i in s))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;const a=i,o=n.hooks[a],l=s[a];L2.passThroughHooks.has(i)?s[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(s,c)).then(d=>l.call(s,d));const u=o.call(s,c);return l.call(s,u)}:s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens,i=n.walkTokens;r.walkTokens=function(a){let o=[];return o.push(i.call(this,a)),s&&(o=o.concat(s.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Sd.lex(e,t??this.defaults)}parser(e,t){return Cd.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const s={...r},i={...this.defaults,...s},a=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const o=i.hooks?i.hooks.provideLexer():e?Sd.lex:Sd.lexInline,l=i.hooks?i.hooks.provideParser():e?Cd.parse:Cd.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(c=>o(c,i)).then(c=>i.hooks?i.hooks.processAllTokens(c):c).then(c=>i.walkTokens?Promise.all(this.walkTokens(c,i.walkTokens)).then(()=>c):c).then(c=>l(c,i)).then(c=>i.hooks?i.hooks.postprocess(c):c).catch(a);try{i.hooks&&(n=i.hooks.preprocess(n));let c=o(n,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let u=l(c,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(c){return a(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+Xc(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},wm=new XFe;function us(e,t){return wm.parse(e,t)}us.options=us.setOptions=function(e){return wm.setOptions(e),us.defaults=wm.defaults,jee(us.defaults),us};us.getDefaults=n6;us.defaults=Vm;us.use=function(...e){return wm.use(...e),us.defaults=wm.defaults,jee(us.defaults),us};us.walkTokens=function(e,t){return wm.walkTokens(e,t)};us.parseInline=wm.parseInline;us.Parser=Cd;us.parser=Cd.parse;us.Renderer=Tk;us.TextRenderer=u6;us.Lexer=Sd;us.lexer=Sd.lex;us.Tokenizer=Ek;us.Hooks=L2;us.parse=us;us.options;us.setOptions;us.use;us.walkTokens;us.parseInline;Cd.parse;Sd.lex;function Vee(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.from(typeof e=="string"?[e]:e);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var s=r.reduce(function(o,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?o.concat(c.map(function(u){var d,h;return(h=(d=u.match(/[\t ]/g))===null||d===void 0?void 0:d.length)!==null&&h!==void 0?h:0})):o},[]);if(s.length){var i=new RegExp(`
[	 ]{`+Math.min.apply(Math,s)+"}","g");r=r.map(function(o){return o.replace(i,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return t.forEach(function(o,l){var c=a.match(/(?:^|\n)( *)$/),u=c?c[1]:"",d=o;typeof o=="string"&&o.includes(`
`)&&(d=String(o).split(`
`).map(function(h,m){return m===0?h:""+u+h}).join(`
`)),a+=d+r[l+1]}),a}function Wee(e,{markdownAutoWrap:t}){const r=e.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),s=Vee(r);return t===!1?s.replace(/ /g,"&nbsp;"):s}ie(Wee,"preprocessMarkdown");function Hee(e,t={}){const n=Wee(e,t),r=us.lexer(n),s=[[]];let i=0;function a(o,l="normal"){o.type==="text"?o.text.split(`
`).forEach((u,d)=>{d!==0&&(i++,s.push([])),u.split(" ").forEach(h=>{h=h.replace(/&#39;/g,"'"),h&&s[i].push({content:h,type:l})})}):o.type==="strong"||o.type==="em"?o.tokens.forEach(c=>{a(c,o.type)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}return ie(a,"processNode"),r.forEach(o=>{var l;o.type==="paragraph"?(l=o.tokens)==null||l.forEach(c=>{a(c)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}),s}ie(Hee,"markdownToLines");function Gee(e,{markdownAutoWrap:t}={}){const n=us.lexer(e);function r(s){var i,a,o;return s.type==="text"?t===!1?s.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):s.text.replace(/\n */g,"<br/>"):s.type==="strong"?`<strong>${(i=s.tokens)==null?void 0:i.map(r).join("")}</strong>`:s.type==="em"?`<em>${(a=s.tokens)==null?void 0:a.map(r).join("")}</em>`:s.type==="paragraph"?`<p>${(o=s.tokens)==null?void 0:o.map(r).join("")}</p>`:s.type==="space"?"":s.type==="html"?`${s.text}`:s.type==="escape"?s.text:`Unsupported markdown: ${s.type}`}return ie(r,"output"),n.map(r).join("")}ie(Gee,"markdownToHTML");function Kee(e){return Intl.Segmenter?[...new Intl.Segmenter().segment(e)].map(t=>t.segment):[...e]}ie(Kee,"splitTextToChars");function Yee(e,t){const n=Kee(t.content);return d6(e,[],n,t.type)}ie(Yee,"splitWordToFitWidth");function d6(e,t,n,r){if(n.length===0)return[{content:t.join(""),type:r},{content:"",type:r}];const[s,...i]=n,a=[...t,s];return e([{content:a.join(""),type:r}])?d6(e,a,i,r):(t.length===0&&s&&(t.push(s),n.shift()),[{content:t.join(""),type:r},{content:n.join(""),type:r}])}ie(d6,"splitWordToFitWidthRecursion");function Zee(e,t){if(e.some(({content:n})=>n.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return Ak(e,t)}ie(Zee,"splitLineToFitWidth");function Ak(e,t,n=[],r=[]){if(e.length===0)return r.length>0&&n.push(r),n.length>0?n:[];let s="";e[0].content===" "&&(s=" ",e.shift());const i=e.shift()??{content:" ",type:"normal"},a=[...r];if(s!==""&&a.push({content:s,type:"normal"}),a.push(i),t(a))return Ak(e,t,n,a);if(r.length>0)n.push(r),e.unshift(i);else if(i.content){const[o,l]=Yee(t,i);n.push([o]),l.content&&e.unshift(l)}return Ak(e,t,n)}ie(Ak,"splitLineToFitWidthRecursion");function p4(e,t){t&&e.attr("style",t)}ie(p4,"applyStyle");async function Xee(e,t,n,r,s=!1){const i=e.append("foreignObject");i.attr("width",`${10*n}px`),i.attr("height",`${10*n}px`);const a=i.append("xhtml:div");let o=t.label;t.label&&yy(t.label)&&(o=await xD(t.label.replace(Qy.lineBreakRegex,`
`),as()));const l=t.isNode?"nodeLabel":"edgeLabel",c=a.append("span");c.html(o),p4(c,t.labelStyle),c.attr("class",`${l} ${r}`),p4(a,t.labelStyle),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("line-height","1.5"),a.style("max-width",n+"px"),a.style("text-align","center"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),s&&a.attr("class","labelBkg");let u=a.node().getBoundingClientRect();return u.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),u=a.node().getBoundingClientRect()),i.node()}ie(Xee,"addHtmlSpan");function TT(e,t,n){return e.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",t*n-.1+"em").attr("dy",n+"em")}ie(TT,"createTspan");function Jee(e,t,n){const r=e.append("text"),s=TT(r,1,t);AT(s,n);const i=s.node().getComputedTextLength();return r.remove(),i}ie(Jee,"computeWidthOfText");function JFe(e,t,n){var a;const r=e.append("text"),s=TT(r,1,t);AT(s,[{content:n,type:"normal"}]);const i=(a=s.node())==null?void 0:a.getBoundingClientRect();return i&&r.remove(),i}ie(JFe,"computeDimensionOfText");function Qee(e,t,n,r=!1){const i=t.append("g"),a=i.insert("rect").attr("class","background").attr("style","stroke: none"),o=i.append("text").attr("y","-10.1");let l=0;for(const c of n){const u=ie(h=>Jee(i,1.1,h)<=e,"checkWidth"),d=u(c)?[c]:Zee(c,u);for(const h of d){const m=TT(o,l,1.1);AT(m,h),l++}}if(r){const c=o.node().getBBox(),u=2;return a.attr("x",c.x-u).attr("y",c.y-u).attr("width",c.width+2*u).attr("height",c.height+2*u),i.node()}else return o.node()}ie(Qee,"createFormattedText");function AT(e,t){e.text(""),t.forEach((n,r)=>{const s=e.append("tspan").attr("font-style",n.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",n.type==="strong"?"bold":"normal");r===0?s.text(n.content):s.text(" "+n.content)})}ie(AT,"updateTextContentAndStyles");function ete(e){return e.replace(/fa[bklrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`)}ie(ete,"replaceIconSubstring");var Zh=ie(async(e,t="",{style:n="",isTitle:r=!1,classes:s="",useHtmlLabels:i=!0,isNode:a=!0,width:o=200,addSvgBackground:l=!1}={},c)=>{if(zt.debug("XYZ createText",t,n,r,s,i,a,"addSvgBackground: ",l),i){const u=Gee(t,c),d=ete(qm(u)),h=t.replace(/\\\\/g,"\\"),m={isNode:a,label:yy(t)?h:d,labelStyle:n.replace("fill:","color:")};return await Xee(e,m,o,s,l)}else{const u=t.replace(/<br\s*\/?>/g,"<br/>"),d=Hee(u.replace("<br>","<br/>"),c),h=Qee(o,e,d,t?l:!1);if(a){/stroke:/.exec(n)&&(n=n.replace("stroke:","lineColor:"));const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Kr(h).attr("style",m)}else{const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");Kr(h).select("rect").attr("style",m.replace(/background:/g,"fill:"));const y=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Kr(h).select("text").attr("style",y)}return h}},"createText");function EI(e,t,n){if(e&&e.length){const[r,s]=t,i=Math.PI/180*n,a=Math.cos(i),o=Math.sin(i);for(const l of e){const[c,u]=l;l[0]=(c-r)*a-(u-s)*o+r,l[1]=(c-r)*o+(u-s)*a+s}}}function QFe(e,t){return e[0]===t[0]&&e[1]===t[1]}function e8e(e,t,n,r=1){const s=n,i=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,o=[0,0];if(s)for(const c of a)EI(c,o,s);const l=function(c,u,d){const h=[];for(const w of c){const S=[...w];QFe(S[0],S[S.length-1])||S.push([S[0][0],S[0][1]]),S.length>2&&h.push(S)}const m=[];u=Math.max(u,.1);const y=[];for(const w of h)for(let S=0;S<w.length-1;S++){const C=w[S],k=w[S+1];if(C[1]!==k[1]){const A=Math.min(C[1],k[1]);y.push({ymin:A,ymax:Math.max(C[1],k[1]),x:A===C[1]?C[0]:k[0],islope:(k[0]-C[0])/(k[1]-C[1])})}}if(y.sort((w,S)=>w.ymin<S.ymin?-1:w.ymin>S.ymin?1:w.x<S.x?-1:w.x>S.x?1:w.ymax===S.ymax?0:(w.ymax-S.ymax)/Math.abs(w.ymax-S.ymax)),!y.length)return m;let b=[],v=y[0].ymin,x=0;for(;b.length||y.length;){if(y.length){let w=-1;for(let S=0;S<y.length&&!(y[S].ymin>v);S++)w=S;y.splice(0,w+1).forEach(S=>{b.push({s:v,edge:S})})}if(b=b.filter(w=>!(w.edge.ymax<=v)),b.sort((w,S)=>w.edge.x===S.edge.x?0:(w.edge.x-S.edge.x)/Math.abs(w.edge.x-S.edge.x)),(d!==1||x%u==0)&&b.length>1)for(let w=0;w<b.length;w+=2){const S=w+1;if(S>=b.length)break;const C=b[w].edge,k=b[S].edge;m.push([[Math.round(C.x),v],[Math.round(k.x),v]])}v+=d,b.forEach(w=>{w.edge.x=w.edge.x+d*w.edge.islope}),x++}return m}(a,i,r);if(s){for(const c of a)EI(c,o,-s);(function(c,u,d){const h=[];c.forEach(m=>h.push(...m)),EI(h,u,d)})(l,o,-s)}return l}function G1(e,t){var n;const r=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.round(Math.max(s,.1));let i=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(i=s),e8e(e,s,r,i||1)}class f6{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const r=G1(t,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(t,n){const r=[];for(const s of t)r.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return r}}function RT(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class t8e extends f6{fillPolygons(t,n){let r=n.hachureGap;r<0&&(r=4*n.strokeWidth),r=Math.max(r,.1);const s=G1(t,Object.assign({},n,{hachureGap:r})),i=Math.PI/180*n.hachureAngle,a=[],o=.5*r*Math.cos(i),l=.5*r*Math.sin(i);for(const[c,u]of s)RT([c,u])&&a.push([[c[0]-o,c[1]+l],[...u]],[[c[0]+o,c[1]-l],[...u]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class n8e extends f6{fillPolygons(t,n){const r=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),i=this._fillPolygons(t,s);return r.ops=r.ops.concat(i.ops),r}}class r8e{constructor(t){this.helper=t}fillPolygons(t,n){const r=G1(t,n=Object.assign({},n,{hachureAngle:0}));return this.dotsOnLines(r,n)}dotsOnLines(t,n){const r=[];let s=n.hachureGap;s<0&&(s=4*n.strokeWidth),s=Math.max(s,.1);let i=n.fillWeight;i<0&&(i=n.strokeWidth/2);const a=s/4;for(const o of t){const l=RT(o),c=l/s,u=Math.ceil(c)-1,d=l-u*s,h=(o[0][0]+o[1][0])/2-s/4,m=Math.min(o[0][1],o[1][1]);for(let y=0;y<u;y++){const b=m+d+y*s,v=h-a+2*Math.random()*a,x=b-a+2*Math.random()*a,w=this.helper.ellipse(v,x,i,i,n);r.push(...w.ops)}}return{type:"fillSketch",ops:r}}}class s8e{constructor(t){this.helper=t}fillPolygons(t,n){const r=G1(t,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(t,n){const r=n.dashOffset<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashGap,i=[];return t.forEach(a=>{const o=RT(a),l=Math.floor(o/(r+s)),c=(o+s-l*(r+s))/2;let u=a[0],d=a[1];u[0]>d[0]&&(u=a[1],d=a[0]);const h=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let m=0;m<l;m++){const y=m*(r+s),b=y+r,v=[u[0]+y*Math.cos(h)+c*Math.cos(h),u[1]+y*Math.sin(h)+c*Math.sin(h)],x=[u[0]+b*Math.cos(h)+c*Math.cos(h),u[1]+b*Math.sin(h)+c*Math.sin(h)];i.push(...this.helper.doubleLineOps(v[0],v[1],x[0],x[1],n))}}),i}}class i8e{constructor(t){this.helper=t}fillPolygons(t,n){const r=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,s=n.zigzagOffset<0?r:n.zigzagOffset,i=G1(t,n=Object.assign({},n,{hachureGap:r+s}));return{type:"fillSketch",ops:this.zigzagLines(i,s,n)}}zigzagLines(t,n,r){const s=[];return t.forEach(i=>{const a=RT(i),o=Math.round(a/(2*n));let l=i[0],c=i[1];l[0]>c[0]&&(l=i[1],c=i[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<o;d++){const h=2*d*n,m=2*(d+1)*n,y=Math.sqrt(2*Math.pow(n,2)),b=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],v=[l[0]+m*Math.cos(u),l[1]+m*Math.sin(u)],x=[b[0]+y*Math.cos(u+Math.PI/4),b[1]+y*Math.sin(u+Math.PI/4)];s.push(...this.helper.doubleLineOps(b[0],b[1],x[0],x[1],r),...this.helper.doubleLineOps(x[0],x[1],v[0],v[1],r))}}),s}}const go={};let a8e=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}};const o8e=0,TI=1,iU=2,GS={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function AI(e,t){return e.type===t}function h6(e){const t=[],n=function(a){const o=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))o[o.length]={type:o8e,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];o[o.length]={type:TI,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return o[o.length]={type:iU,text:""},o}(e);let r="BOD",s=0,i=n[s];for(;!AI(i,iU);){let a=0;const o=[];if(r==="BOD"){if(i.text!=="M"&&i.text!=="m")return h6("M0,0"+e);s++,a=GS[i.text],r=i.text}else AI(i,TI)?a=GS[r]:(s++,a=GS[i.text],r=i.text);if(!(s+a<n.length))throw new Error("Path data ended short");for(let l=s;l<s+a;l++){const c=n[l];if(!AI(c,TI))throw new Error("Param not a number: "+r+","+c.text);o[o.length]=+c.text}if(typeof GS[r]!="number")throw new Error("Bad segment: "+r);{const l={key:r,data:o};t.push(l),s+=a,i=n[s],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function tte(e){let t=0,n=0,r=0,s=0;const i=[];for(const{key:a,data:o}of e)switch(a){case"M":i.push({key:"M",data:[...o]}),[t,n]=o,[r,s]=o;break;case"m":t+=o[0],n+=o[1],i.push({key:"M",data:[t,n]}),r=t,s=n;break;case"L":i.push({key:"L",data:[...o]}),[t,n]=o;break;case"l":t+=o[0],n+=o[1],i.push({key:"L",data:[t,n]});break;case"C":i.push({key:"C",data:[...o]}),t=o[4],n=o[5];break;case"c":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":i.push({key:"Q",data:[...o]}),t=o[2],n=o[3];break;case"q":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":i.push({key:"A",data:[...o]}),t=o[5],n=o[6];break;case"a":t+=o[5],n+=o[6],i.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],t,n]});break;case"H":i.push({key:"H",data:[...o]}),t=o[0];break;case"h":t+=o[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],i.push({key:"V",data:[n]});break;case"S":i.push({key:"S",data:[...o]}),t=o[2],n=o[3];break;case"s":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":i.push({key:"T",data:[...o]}),t=o[0],n=o[1];break;case"t":t+=o[0],n+=o[1],i.push({key:"T",data:[t,n]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=r,n=s}return i}function nte(e){const t=[];let n="",r=0,s=0,i=0,a=0,o=0,l=0;for(const{key:c,data:u}of e){switch(c){case"M":t.push({key:"M",data:[...u]}),[r,s]=u,[i,a]=u;break;case"C":t.push({key:"C",data:[...u]}),r=u[4],s=u[5],o=u[2],l=u[3];break;case"L":t.push({key:"L",data:[...u]}),[r,s]=u;break;case"H":r=u[0],t.push({key:"L",data:[r,s]});break;case"V":s=u[0],t.push({key:"L",data:[r,s]});break;case"S":{let d=0,h=0;n==="C"||n==="S"?(d=r+(r-o),h=s+(s-l)):(d=r,h=s),t.push({key:"C",data:[d,h,...u]}),o=u[0],l=u[1],r=u[2],s=u[3];break}case"T":{const[d,h]=u;let m=0,y=0;n==="Q"||n==="T"?(m=r+(r-o),y=s+(s-l)):(m=r,y=s);const b=r+2*(m-r)/3,v=s+2*(y-s)/3,x=d+2*(m-d)/3,w=h+2*(y-h)/3;t.push({key:"C",data:[b,v,x,w,d,h]}),o=m,l=y,r=d,s=h;break}case"Q":{const[d,h,m,y]=u,b=r+2*(d-r)/3,v=s+2*(h-s)/3,x=m+2*(d-m)/3,w=y+2*(h-y)/3;t.push({key:"C",data:[b,v,x,w,m,y]}),o=d,l=h,r=m,s=y;break}case"A":{const d=Math.abs(u[0]),h=Math.abs(u[1]),m=u[2],y=u[3],b=u[4],v=u[5],x=u[6];d===0||h===0?(t.push({key:"C",data:[r,s,v,x,v,x]}),r=v,s=x):(r!==v||s!==x)&&(rte(r,s,v,x,d,h,m,y,b).forEach(function(w){t.push({key:"C",data:w})}),r=v,s=x);break}case"Z":t.push({key:"Z",data:[]}),r=i,s=a}n=c}return t}function $v(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function rte(e,t,n,r,s,i,a,o,l,c){const u=(d=a,Math.PI*d/180);var d;let h=[],m=0,y=0,b=0,v=0;if(c)[m,y,b,v]=c;else{[e,t]=$v(e,t,-u),[n,r]=$v(n,r,-u);const V=(e-n)/2,F=(t-r)/2;let X=V*V/(s*s)+F*F/(i*i);X>1&&(X=Math.sqrt(X),s*=X,i*=X);const U=s*s,H=i*i,$=U*H-U*F*F-H*V*V,ne=U*F*F+H*V*V,W=(o===l?-1:1)*Math.sqrt(Math.abs($/ne));b=W*s*F/i+(e+n)/2,v=W*-i*V/s+(t+r)/2,m=Math.asin(parseFloat(((t-v)/i).toFixed(9))),y=Math.asin(parseFloat(((r-v)/i).toFixed(9))),e<b&&(m=Math.PI-m),n<b&&(y=Math.PI-y),m<0&&(m=2*Math.PI+m),y<0&&(y=2*Math.PI+y),l&&m>y&&(m-=2*Math.PI),!l&&y>m&&(y-=2*Math.PI)}let x=y-m;if(Math.abs(x)>120*Math.PI/180){const V=y,F=n,X=r;y=l&&y>m?m+120*Math.PI/180*1:m+120*Math.PI/180*-1,h=rte(n=b+s*Math.cos(y),r=v+i*Math.sin(y),F,X,s,i,a,0,l,[y,V,b,v])}x=y-m;const w=Math.cos(m),S=Math.sin(m),C=Math.cos(y),k=Math.sin(y),A=Math.tan(x/4),R=4/3*s*A,N=4/3*i*A,I=[e,t],O=[e+R*S,t-N*w],L=[n+R*k,r-N*C],P=[n,r];if(O[0]=2*I[0]-O[0],O[1]=2*I[1]-O[1],c)return[O,L,P].concat(h);{h=[O,L,P].concat(h);const V=[];for(let F=0;F<h.length;F+=3){const X=$v(h[F][0],h[F][1],u),U=$v(h[F+1][0],h[F+1][1],u),H=$v(h[F+2][0],h[F+2][1],u);V.push([X[0],X[1],U[0],U[1],H[0],H[1]])}return V}}const l8e={randOffset:function(e,t){return Jn(e,t)},randOffsetWithRange:function(e,t,n){return Rk(e,t,n)},ellipse:function(e,t,n,r,s){const i=ite(n,r,s);return m4(e,t,s,i).opset},doubleLineOps:function(e,t,n,r,s){return Rh(e,t,n,r,s,!0)}};function ste(e,t,n,r,s){return{type:"path",ops:Rh(e,t,n,r,s)}}function B2(e,t,n){const r=(e||[]).length;if(r>2){const s=[];for(let i=0;i<r-1;i++)s.push(...Rh(e[i][0],e[i][1],e[i+1][0],e[i+1][1],n));return t&&s.push(...Rh(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}return r===2?ste(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:"path",ops:[]}}function c8e(e,t,n,r,s){return function(i,a){return B2(i,!0,a)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],s)}function aU(e,t){if(e.length){const n=typeof e[0][0]=="number"?[e]:e,r=KS(n[0],1*(1+.2*t.roughness),t),s=t.disableMultiStroke?[]:KS(n[0],1.5*(1+.22*t.roughness),cU(t));for(let i=1;i<n.length;i++){const a=n[i];if(a.length){const o=KS(a,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:KS(a,1.5*(1+.22*t.roughness),cU(t));for(const c of o)c.op!=="move"&&r.push(c);for(const c of l)c.op!=="move"&&s.push(c)}}return{type:"path",ops:r.concat(s)}}return{type:"path",ops:[]}}function ite(e,t,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),i=2*Math.PI/s;let a=Math.abs(e/2),o=Math.abs(t/2);const l=1-n.curveFitting;return a+=Jn(a*l,n),o+=Jn(o*l,n),{increment:i,rx:a,ry:o}}function m4(e,t,n,r){const[s,i]=uU(r.increment,e,t,r.rx,r.ry,1,r.increment*Rk(.1,Rk(.4,1,n),n),n);let a=Nk(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=uU(r.increment,e,t,r.rx,r.ry,1.5,0,n),l=Nk(o,null,n);a=a.concat(l)}return{estimatedPoints:i,opset:{type:"path",ops:a}}}function oU(e,t,n,r,s,i,a,o,l){const c=e,u=t;let d=Math.abs(n/2),h=Math.abs(r/2);d+=Jn(.01*d,l),h+=Jn(.01*h,l);let m=s,y=i;for(;m<0;)m+=2*Math.PI,y+=2*Math.PI;y-m>2*Math.PI&&(m=0,y=2*Math.PI);const b=2*Math.PI/l.curveStepCount,v=Math.min(b/2,(y-m)/2),x=dU(v,c,u,d,h,m,y,1,l);if(!l.disableMultiStroke){const w=dU(v,c,u,d,h,m,y,1.5,l);x.push(...w)}return a&&(o?x.push(...Rh(c,u,c+d*Math.cos(m),u+h*Math.sin(m),l),...Rh(c,u,c+d*Math.cos(y),u+h*Math.sin(y),l)):x.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(m),u+h*Math.sin(m)]})),{type:"path",ops:x}}function lU(e,t){const n=nte(tte(h6(e))),r=[];let s=[0,0],i=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":i=[o[0],o[1]],s=[o[0],o[1]];break;case"L":r.push(...Rh(i[0],i[1],o[0],o[1],t)),i=[o[0],o[1]];break;case"C":{const[l,c,u,d,h,m]=o;r.push(...u8e(l,c,u,d,h,m,i,t)),i=[h,m];break}case"Z":r.push(...Rh(i[0],i[1],s[0],s[1],t)),i=[s[0],s[1]]}return{type:"path",ops:r}}function RI(e,t){const n=[];for(const r of e)if(r.length){const s=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:"move",data:[r[0][0]+Jn(s,t),r[0][1]+Jn(s,t)]});for(let a=1;a<i;a++)n.push({op:"lineTo",data:[r[a][0]+Jn(s,t),r[a][1]+Jn(s,t)]})}}return{type:"fillPath",ops:n}}function Xg(e,t){return function(n,r){let s=n.fillStyle||"hachure";if(!go[s])switch(s){case"zigzag":go[s]||(go[s]=new t8e(r));break;case"cross-hatch":go[s]||(go[s]=new n8e(r));break;case"dots":go[s]||(go[s]=new r8e(r));break;case"dashed":go[s]||(go[s]=new s8e(r));break;case"zigzag-line":go[s]||(go[s]=new i8e(r));break;default:s="hachure",go[s]||(go[s]=new f6(r))}return go[s]}(t,l8e).fillPolygons(e,t)}function cU(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function ate(e){return e.randomizer||(e.randomizer=new a8e(e.seed||0)),e.randomizer.next()}function Rk(e,t,n,r=1){return n.roughness*r*(ate(n)*(t-e)+e)}function Jn(e,t,n=1){return Rk(-e,e,t,n)}function Rh(e,t,n,r,s,i=!1){const a=i?s.disableMultiStrokeFill:s.disableMultiStroke,o=g4(e,t,n,r,s,!0,!1);if(a)return o;const l=g4(e,t,n,r,s,!0,!0);return o.concat(l)}function g4(e,t,n,r,s,i,a){const o=Math.pow(e-n,2)+Math.pow(t-r,2),l=Math.sqrt(o);let c=1;c=l<200?1:l>500?.4:-.0016668*l+1.233334;let u=s.maxRandomnessOffset||0;u*u*100>o&&(u=l/10);const d=u/2,h=.2+.2*ate(s);let m=s.bowing*s.maxRandomnessOffset*(r-t)/200,y=s.bowing*s.maxRandomnessOffset*(e-n)/200;m=Jn(m,s,c),y=Jn(y,s,c);const b=[],v=()=>Jn(d,s,c),x=()=>Jn(u,s,c),w=s.preserveVertices;return a?b.push({op:"move",data:[e+(w?0:v()),t+(w?0:v())]}):b.push({op:"move",data:[e+(w?0:Jn(u,s,c)),t+(w?0:Jn(u,s,c))]}),a?b.push({op:"bcurveTo",data:[m+e+(n-e)*h+v(),y+t+(r-t)*h+v(),m+e+2*(n-e)*h+v(),y+t+2*(r-t)*h+v(),n+(w?0:v()),r+(w?0:v())]}):b.push({op:"bcurveTo",data:[m+e+(n-e)*h+x(),y+t+(r-t)*h+x(),m+e+2*(n-e)*h+x(),y+t+2*(r-t)*h+x(),n+(w?0:x()),r+(w?0:x())]}),b}function KS(e,t,n){if(!e.length)return[];const r=[];r.push([e[0][0]+Jn(t,n),e[0][1]+Jn(t,n)]),r.push([e[0][0]+Jn(t,n),e[0][1]+Jn(t,n)]);for(let s=1;s<e.length;s++)r.push([e[s][0]+Jn(t,n),e[s][1]+Jn(t,n)]),s===e.length-1&&r.push([e[s][0]+Jn(t,n),e[s][1]+Jn(t,n)]);return Nk(r,null,n)}function Nk(e,t,n){const r=e.length,s=[];if(r>3){const i=[],a=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let o=1;o+2<r;o++){const l=e[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*e[o+1][0]-a*e[o-1][0])/6,l[1]+(a*e[o+1][1]-a*e[o-1][1])/6],i[2]=[e[o+1][0]+(a*e[o][0]-a*e[o+2][0])/6,e[o+1][1]+(a*e[o][1]-a*e[o+2][1])/6],i[3]=[e[o+1][0],e[o+1][1]],s.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}}else r===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&s.push(...g4(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return s}function uU(e,t,n,r,s,i,a,o){const l=[],c=[];if(o.roughness===0){e/=4,c.push([t+r*Math.cos(-e),n+s*Math.sin(-e)]);for(let u=0;u<=2*Math.PI;u+=e){const d=[t+r*Math.cos(u),n+s*Math.sin(u)];l.push(d),c.push(d)}c.push([t+r*Math.cos(0),n+s*Math.sin(0)]),c.push([t+r*Math.cos(e),n+s*Math.sin(e)])}else{const u=Jn(.5,o)-Math.PI/2;c.push([Jn(i,o)+t+.9*r*Math.cos(u-e),Jn(i,o)+n+.9*s*Math.sin(u-e)]);const d=2*Math.PI+u-.01;for(let h=u;h<d;h+=e){const m=[Jn(i,o)+t+r*Math.cos(h),Jn(i,o)+n+s*Math.sin(h)];l.push(m),c.push(m)}c.push([Jn(i,o)+t+r*Math.cos(u+2*Math.PI+.5*a),Jn(i,o)+n+s*Math.sin(u+2*Math.PI+.5*a)]),c.push([Jn(i,o)+t+.98*r*Math.cos(u+a),Jn(i,o)+n+.98*s*Math.sin(u+a)]),c.push([Jn(i,o)+t+.9*r*Math.cos(u+.5*a),Jn(i,o)+n+.9*s*Math.sin(u+.5*a)])}return[c,l]}function dU(e,t,n,r,s,i,a,o,l){const c=i+Jn(.1,l),u=[];u.push([Jn(o,l)+t+.9*r*Math.cos(c-e),Jn(o,l)+n+.9*s*Math.sin(c-e)]);for(let d=c;d<=a;d+=e)u.push([Jn(o,l)+t+r*Math.cos(d),Jn(o,l)+n+s*Math.sin(d)]);return u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),Nk(u,null,l)}function u8e(e,t,n,r,s,i,a,o){const l=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let u=[0,0];const d=o.disableMultiStroke?1:2,h=o.preserveVertices;for(let m=0;m<d;m++)m===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(h?0:Jn(c[0],o)),a[1]+(h?0:Jn(c[0],o))]}),u=h?[s,i]:[s+Jn(c[m],o),i+Jn(c[m],o)],l.push({op:"bcurveTo",data:[e+Jn(c[m],o),t+Jn(c[m],o),n+Jn(c[m],o),r+Jn(c[m],o),u[0],u[1]]});return l}function zv(e){return[...e]}function fU(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(zv(e[0]),zv(e[1]),zv(e[2]),zv(e[2]));else{const s=[];s.push(e[0],e[0]);for(let o=1;o<e.length;o++)s.push(e[o]),o===e.length-1&&s.push(e[o]);const i=[],a=1-t;r.push(zv(s[0]));for(let o=1;o+2<s.length;o++){const l=s[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*s[o+1][0]-a*s[o-1][0])/6,l[1]+(a*s[o+1][1]-a*s[o-1][1])/6],i[2]=[s[o+1][0]+(a*s[o][0]-a*s[o+2][0])/6,s[o+1][1]+(a*s[o][1]-a*s[o+2][1])/6],i[3]=[s[o+1][0],s[o+1][1]],r.push(i[1],i[2],i[3])}}return r}function $2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function d8e(e,t,n){const r=$2(t,n);if(r===0)return $2(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return s=Math.max(0,Math.min(1,s)),$2(e,Pp(t,n,s))}function Pp(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function y4(e,t,n,r){const s=r||[];if(function(o,l){const c=o[l+0],u=o[l+1],d=o[l+2],h=o[l+3];let m=3*u[0]-2*c[0]-h[0];m*=m;let y=3*u[1]-2*c[1]-h[1];y*=y;let b=3*d[0]-2*h[0]-c[0];b*=b;let v=3*d[1]-2*h[1]-c[1];return v*=v,m<b&&(m=b),y<v&&(y=v),m+y}(e,t)<n){const o=e[t+0];s.length?(i=s[s.length-1],a=o,Math.sqrt($2(i,a))>1&&s.push(o)):s.push(o),s.push(e[t+3])}else{const l=e[t+0],c=e[t+1],u=e[t+2],d=e[t+3],h=Pp(l,c,.5),m=Pp(c,u,.5),y=Pp(u,d,.5),b=Pp(h,m,.5),v=Pp(m,y,.5),x=Pp(b,v,.5);y4([l,h,b,x],0,n,s),y4([x,v,y,d],0,n,s)}var i,a;return s}function f8e(e,t){return Mk(e,0,e.length,t)}function Mk(e,t,n,r,s){const i=s||[],a=e[t],o=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=d8e(e[u],a,o);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(Mk(e,t,c+1,r,i),Mk(e,c,n,r,i)):(i.length||i.push(a),i.push(o)),i}function NI(e,t=.15,n){const r=[],s=(e.length-1)/3;for(let i=0;i<s;i++)y4(e,3*i,t,r);return n&&n>0?Mk(r,0,r.length,n):r}const Xo="none";class Ik{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,r){return{shape:t,sets:n||[],options:r||this.defaultOptions}}line(t,n,r,s,i){const a=this._o(i);return this._d("line",[ste(t,n,r,s,a)],a)}rectangle(t,n,r,s,i){const a=this._o(i),o=[],l=c8e(t,n,r,s,a);if(a.fill){const c=[[t,n],[t+r,n],[t+r,n+s],[t,n+s]];a.fillStyle==="solid"?o.push(RI([c],a)):o.push(Xg([c],a))}return a.stroke!==Xo&&o.push(l),this._d("rectangle",o,a)}ellipse(t,n,r,s,i){const a=this._o(i),o=[],l=ite(r,s,a),c=m4(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){const u=m4(t,n,a,l).opset;u.type="fillPath",o.push(u)}else o.push(Xg([c.estimatedPoints],a));return a.stroke!==Xo&&o.push(c.opset),this._d("ellipse",o,a)}circle(t,n,r,s){const i=this.ellipse(t,n,r,r,s);return i.shape="circle",i}linearPath(t,n){const r=this._o(n);return this._d("linearPath",[B2(t,!1,r)],r)}arc(t,n,r,s,i,a,o=!1,l){const c=this._o(l),u=[],d=oU(t,n,r,s,i,a,o,!0,c);if(o&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const m=oU(t,n,r,s,i,a,!0,!1,h);m.type="fillPath",u.push(m)}else u.push(function(h,m,y,b,v,x,w){const S=h,C=m;let k=Math.abs(y/2),A=Math.abs(b/2);k+=Jn(.01*k,w),A+=Jn(.01*A,w);let R=v,N=x;for(;R<0;)R+=2*Math.PI,N+=2*Math.PI;N-R>2*Math.PI&&(R=0,N=2*Math.PI);const I=(N-R)/w.curveStepCount,O=[];for(let L=R;L<=N;L+=I)O.push([S+k*Math.cos(L),C+A*Math.sin(L)]);return O.push([S+k*Math.cos(N),C+A*Math.sin(N)]),O.push([S,C]),Xg([O],w)}(t,n,r,s,i,a,c));return c.stroke!==Xo&&u.push(d),this._d("arc",u,c)}curve(t,n){const r=this._o(n),s=[],i=aU(t,r);if(r.fill&&r.fill!==Xo)if(r.fillStyle==="solid"){const a=aU(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=t;if(o.length){const l=typeof o[0][0]=="number"?[o]:o;for(const c of l)c.length<3?a.push(...c):c.length===3?a.push(...NI(fU([c[0],c[0],c[1],c[2]]),10,(1+r.roughness)/2)):a.push(...NI(fU(c),10,(1+r.roughness)/2))}a.length&&s.push(Xg([a],r))}return r.stroke!==Xo&&s.push(i),this._d("curve",s,r)}polygon(t,n){const r=this._o(n),s=[],i=B2(t,!0,r);return r.fill&&(r.fillStyle==="solid"?s.push(RI([t],r)):s.push(Xg([t],r))),r.stroke!==Xo&&s.push(i),this._d("polygon",s,r)}path(t,n){const r=this._o(n),s=[];if(!t)return this._d("path",s,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const i=r.fill&&r.fill!=="transparent"&&r.fill!==Xo,a=r.stroke!==Xo,o=!!(r.simplification&&r.simplification<1),l=function(u,d,h){const m=nte(tte(h6(u))),y=[];let b=[],v=[0,0],x=[];const w=()=>{x.length>=4&&b.push(...NI(x,d)),x=[]},S=()=>{w(),b.length&&(y.push(b),b=[])};for(const{key:k,data:A}of m)switch(k){case"M":S(),v=[A[0],A[1]],b.push(v);break;case"L":w(),b.push([A[0],A[1]]);break;case"C":if(!x.length){const R=b.length?b[b.length-1]:v;x.push([R[0],R[1]])}x.push([A[0],A[1]]),x.push([A[2],A[3]]),x.push([A[4],A[5]]);break;case"Z":w(),b.push([v[0],v[1]])}if(S(),!h)return y;const C=[];for(const k of y){const A=f8e(k,h);A.length&&C.push(A)}return C}(t,1,o?4-4*(r.simplification||1):(1+r.roughness)/2),c=lU(t,r);if(i)if(r.fillStyle==="solid")if(l.length===1){const u=lU(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else s.push(RI(l,r));else s.push(Xg(l,r));return a&&(o?l.forEach(u=>{s.push(B2(u,!1,r))}):s.push(c)),this._d("path",s,r)}opsToPath(t,n){let r="";for(const s of t.ops){const i=typeof n=="number"&&n>=0?s.data.map(a=>+a.toFixed(n)):s.data;switch(s.op){case"move":r+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":r+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":r+=`L${i[0]} ${i[1]} `}}return r.trim()}toPaths(t){const n=t.sets||[],r=t.options||this.defaultOptions,s=[];for(const i of n){let a=null;switch(i.type){case"path":a={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:Xo};break;case"fillPath":a={d:this.opsToPath(i),stroke:Xo,strokeWidth:0,fill:r.fill||Xo};break;case"fillSketch":a=this.fillSketch(i,r)}a&&s.push(a)}return s}fillSketch(t,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||Xo,strokeWidth:r,fill:Xo}}_mergedShape(t){return t.filter((n,r)=>r===0||n.op!=="move")}}class h8e{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new Ik(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":s.save(),s.strokeStyle=r.stroke==="none"?"transparent":r.stroke,s.lineWidth=r.strokeWidth,r.strokeLineDash&&s.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(s.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(s,a,i),s.restore();break;case"fillPath":{s.save(),s.fillStyle=r.fill||"";const o=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,a,i,o),s.restore();break}case"fillSketch":this.fillSketch(s,a,r)}}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=s,this._drawToContext(t,n,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,r,s="nonzero"){t.beginPath();for(const i of n.ops){const a=typeof r=="number"&&r>=0?i.data.map(o=>+o.toFixed(r)):i.data;switch(i.op){case"move":t.moveTo(a[0],a[1]);break;case"bcurveTo":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":t.lineTo(a[0],a[1])}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a),a}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a),a}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a),a}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i),i}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r),r}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r),r}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c),c}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r),r}path(t,n){const r=this.gen.path(t,n);return this.draw(r),r}}const YS="http://www.w3.org/2000/svg";class p8e{constructor(t,n){this.svg=t,this.gen=new Ik(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,i=s.createElementNS(YS,"g"),a=t.options.fixedDecimalPlaceDigits;for(const o of n){let l=null;switch(o.type){case"path":l=s.createElementNS(YS,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":l=s.createElementNS(YS,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||l.setAttribute("fill-rule","evenodd");break;case"fillSketch":l=this.fillSketch(s,o,r)}l&&i.appendChild(l)}return i}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);const i=t.createElementNS(YS,"path");return i.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),i.setAttribute("stroke",r.fill||""),i.setAttribute("stroke-width",s+""),i.setAttribute("fill","none"),r.fillLineDash&&i.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a)}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a)}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a)}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i)}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r)}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r)}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c)}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r)}path(t,n){const r=this.gen.path(t,n);return this.draw(r)}}var kn={canvas:(e,t)=>new h8e(e,t),svg:(e,t)=>new p8e(e,t),generator:e=>new Ik(e),newSeed:()=>Ik.newSeed()},ur=ie(async(e,t,n)=>{var d,h;let r;const s=t.useHtmlLabels||Vi((d=as())==null?void 0:d.htmlLabels);n?r=n:r="node default";const i=e.insert("g").attr("class",r).attr("id",t.domId||t.id),a=i.insert("g").attr("class","label").attr("style",no(t.labelStyle));let o;t.label===void 0?o="":o=typeof t.label=="string"?t.label:t.label[0];const l=await Zh(a,ym(qm(o),as()),{useHtmlLabels:s,width:t.width||((h=as().flowchart)==null?void 0:h.wrappingWidth),cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let c=l.getBBox();const u=((t==null?void 0:t.padding)??0)/2;if(s){const m=l.children[0],y=Kr(l),b=m.getElementsByTagName("img");if(b){const v=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...b].map(x=>new Promise(w=>{function S(){if(x.style.display="flex",x.style.flexDirection="column",v){const C=as().fontSize?as().fontSize:window.getComputedStyle(document.body).fontSize,k=5,[A=_X.fontSize]=CT(C),R=A*k+"px";x.style.minWidth=R,x.style.maxWidth=R}else x.style.width="100%";w(x)}ie(S,"setupImage"),setTimeout(()=>{x.complete&&S()}),x.addEventListener("error",S),x.addEventListener("load",S)})))}c=m.getBoundingClientRect(),y.attr("width",c.width),y.attr("height",c.height)}return s?a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"):a.attr("transform","translate(0, "+-c.height/2+")"),t.centerLabel&&a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:i,bbox:c,halfPadding:u,label:a}},"labelHelper"),MI=ie(async(e,t,n)=>{var l,c,u,d,h,m;const r=n.useHtmlLabels||Vi((c=(l=as())==null?void 0:l.flowchart)==null?void 0:c.htmlLabels),s=e.insert("g").attr("class","label").attr("style",n.labelStyle||""),i=await Zh(s,ym(qm(t),as()),{useHtmlLabels:r,width:n.width||((d=(u=as())==null?void 0:u.flowchart)==null?void 0:d.wrappingWidth),style:n.labelStyle,addSvgBackground:!!n.icon||!!n.img});let a=i.getBBox();const o=n.padding/2;if(Vi((m=(h=as())==null?void 0:h.flowchart)==null?void 0:m.htmlLabels)){const y=i.children[0],b=Kr(i);a=y.getBoundingClientRect(),b.attr("width",a.width),b.attr("height",a.height)}return r?s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"):s.attr("transform","translate(0, "+-a.height/2+")"),n.centerLabel&&s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:e,bbox:a,halfPadding:o,label:s}},"insertLabel"),Nn=ie((e,t)=>{const n=t.node().getBBox();e.width=n.width,e.height=n.height},"updateNodeBounds"),tr=ie((e,t)=>(e.look==="handDrawn"?"rough-node":"node")+" "+e.cssClasses+" "+(t||""),"getNodeClasses");function Xr(e){const t=e.map((n,r)=>`${r===0?"M":"L"}${n.x},${n.y}`);return t.push("Z"),t.join(" ")}ie(Xr,"createPathFromPoints");function Nh(e,t,n,r,s,i){const a=[],l=n-e,c=r-t,u=l/i,d=2*Math.PI/u,h=t+c/2;for(let m=0;m<=50;m++){const y=m/50,b=e+y*l,v=h+s*Math.sin(d*(b-e));a.push({x:b,y:v})}return a}ie(Nh,"generateFullSineWavePoints");function p6(e,t,n,r,s,i){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(p6,"generateCirclePoints");var m8e=ie((e,t)=>{var n=e.x,r=e.y,s=t.x-n,i=t.y-r,a=e.width/2,o=e.height/2,l,c;return Math.abs(i)*a>Math.abs(s)*o?(i<0&&(o=-o),l=i===0?0:o*s/i,c=o):(s<0&&(a=-a),l=a,c=s===0?0:a*i/s),{x:n+l,y:r+c}},"intersectRect"),nb=m8e;function ote(e,t){t&&e.attr("style",t)}ie(ote,"applyStyle");async function lte(e){const t=Kr(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),n=t.append("xhtml:div");let r=e.label;e.label&&yy(e.label)&&(r=await xD(e.label.replace(Qy.lineBreakRegex,`
`),as()));const s=e.isNode?"nodeLabel":"edgeLabel";return n.html('<span class="'+s+'" '+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+r+"</span>"),ote(n,e.labelStyle),n.style("display","inline-block"),n.style("padding-right","1px"),n.style("white-space","nowrap"),n.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}ie(lte,"addHtmlLabel");var g8e=ie(async(e,t,n,r)=>{let s=e||"";if(typeof s=="object"&&(s=s[0]),Vi(as().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),zt.info("vertexText"+s);const i={isNode:r,label:qm(s).replace(/fa[blrs]?:fa-[\w-]+/g,o=>`<i class='${o.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await lte(i)}else{const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let a=[];typeof s=="string"?a=s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?a=s:a=[];for(const o of a){const l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),n?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=o.trim(),i.appendChild(l)}return i}},"createLabel"),Kp=g8e,rf=ie((e,t,n,r,s)=>["M",e+s,t,"H",e+n-s,"A",s,s,0,0,1,e+n,t+s,"V",t+r-s,"A",s,s,0,0,1,e+n-s,t+r,"H",e+s,"A",s,s,0,0,1,e,t+r-s,"V",t+s,"A",s,s,0,0,1,e+s,t,"Z"].join(" "),"createRoundedRectPathD"),y8e=ie(e=>{const{handDrawnSeed:t}=as();return{fill:e,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:e,seed:t}},"solidStateFill"),rb=ie(e=>{const t=b8e([...e.cssCompiledStyles||[],...e.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),b8e=ie(e=>{const t=new Map;return e.forEach(n=>{const[r,s]=n.split(":");t.set(r.trim(),s==null?void 0:s.trim())}),t},"styles2Map"),cte=ie(e=>e==="color"||e==="font-size"||e==="font-family"||e==="font-weight"||e==="font-style"||e==="text-decoration"||e==="text-align"||e==="text-transform"||e==="line-height"||e==="letter-spacing"||e==="word-spacing"||e==="text-shadow"||e==="text-overflow"||e==="white-space"||e==="word-wrap"||e==="word-break"||e==="overflow-wrap"||e==="hyphens","isLabelStyle"),Mn=ie(e=>{const{stylesArray:t}=rb(e),n=[],r=[],s=[],i=[];return t.forEach(a=>{const o=a[0];cte(o)?n.push(a.join(":")+" !important"):(r.push(a.join(":")+" !important"),o.includes("stroke")&&s.push(a.join(":")+" !important"),o==="fill"&&i.push(a.join(":")+" !important"))}),{labelStyles:n.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:s,backgroundStyles:i}},"styles2String"),Tn=ie((e,t)=>{var l;const{themeVariables:n,handDrawnSeed:r}=as(),{nodeBorder:s,mainBkg:i}=n,{stylesMap:a}=rb(e);return Object.assign({roughness:.7,fill:a.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:a.get("stroke")||s,seed:r,strokeWidth:((l=a.get("stroke-width"))==null?void 0:l.replace("px",""))||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),ute=ie(async(e,t)=>{zt.info("Creating subgraph rect for ",t.id,t);const n=as(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=Mn(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Vi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await Zh(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0});let b=y.getBBox();if(Vi(n.flowchart.htmlLabels)){const R=y.children[0],N=Kr(y);b=R.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;zt.trace("Data ",t,JSON.stringify(t));let C;if(t.look==="handDrawn"){const R=kn.svg(d),N=Tn(t,{roughness:.7,fill:i,stroke:a,fillWeight:3,seed:s}),I=R.path(rf(w,S,v,x,0),N);C=d.insert(()=>(zt.debug("Rough node insert CXC",I),I),":first-child"),C.select("path:nth-child(2)").attr("style",c.join(";")),C.select("path").attr("style",u.join(";").replace("fill","stroke"))}else C=d.insert("rect",":first-child"),C.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:k}=jD(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+k})`),o){const R=m.select("span");R&&R.attr("style",o)}const A=C.node().getBBox();return t.offsetX=0,t.width=A.width,t.height=A.height,t.offsetY=b.height-t.padding/2,t.intersect=function(R){return nb(t,R)},{cluster:d,labelBBox:b}},"rect"),v8e=ie((e,t)=>{const n=e.insert("g").attr("class","note-cluster").attr("id",t.id),r=n.insert("rect",":first-child"),s=0*t.padding,i=s/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+s).attr("height",t.height+s).attr("fill","none");const a=r.node().getBBox();return t.width=a.width,t.height=a.height,t.intersect=function(o){return nb(t,o)},{cluster:n,labelBBox:{width:0,height:0}}},"noteGroup"),x8e=ie(async(e,t)=>{const n=as(),{themeVariables:r,handDrawnSeed:s}=n,{altBackground:i,compositeBackground:a,compositeTitleBackground:o,nodeBorder:l}=r,c=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),u=c.insert("g",":first-child"),d=c.insert("g").attr("class","cluster-label");let h=c.append("rect");const m=d.node().appendChild(await Kp(t.label,t.labelStyle,void 0,!0));let y=m.getBBox();if(Vi(n.flowchart.htmlLabels)){const I=m.children[0],O=Kr(m);y=I.getBoundingClientRect(),O.attr("width",y.width),O.attr("height",y.height)}const b=0*t.padding,v=b/2,x=(t.width<=y.width+t.padding?y.width+t.padding:t.width)+b;t.width<=y.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;const w=t.height+b,S=t.height+b-y.height-6,C=t.x-x/2,k=t.y-w/2;t.width=x;const A=t.y-t.height/2-v+y.height+2;let R;if(t.look==="handDrawn"){const I=t.cssClasses.includes("statediagram-cluster-alt"),O=kn.svg(c),L=t.rx||t.ry?O.path(rf(C,k,x,w,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:l,seed:s}):O.rectangle(C,k,x,w,{seed:s});R=c.insert(()=>L,":first-child");const P=O.rectangle(C,A,x,S,{fill:I?i:a,fillStyle:I?"hachure":"solid",stroke:l,seed:s});R=c.insert(()=>L,":first-child"),h=c.insert(()=>P)}else R=u.insert("rect",":first-child"),R.attr("class","outer").attr("x",C).attr("y",k).attr("width",x).attr("height",w).attr("data-look",t.look),h.attr("class","inner").attr("x",C).attr("y",A).attr("width",x).attr("height",S);d.attr("transform",`translate(${t.x-y.width/2}, ${k+1-(Vi(n.flowchart.htmlLabels)?0:3)})`);const N=R.node().getBBox();return t.height=N.height,t.offsetX=0,t.offsetY=y.height-t.padding/2,t.labelBBox=y,t.intersect=function(I){return nb(t,I)},{cluster:c,labelBBox:y}},"roundedWithTitle"),w8e=ie(async(e,t)=>{zt.info("Creating subgraph rect for ",t.id,t);const n=as(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=Mn(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Vi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await Zh(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0,width:t.width});let b=y.getBBox();if(Vi(n.flowchart.htmlLabels)){const R=y.children[0],N=Kr(y);b=R.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;zt.trace("Data ",t,JSON.stringify(t));let C;if(t.look==="handDrawn"){const R=kn.svg(d),N=Tn(t,{roughness:.7,fill:i,stroke:a,fillWeight:4,seed:s}),I=R.path(rf(w,S,v,x,t.rx),N);C=d.insert(()=>(zt.debug("Rough node insert CXC",I),I),":first-child"),C.select("path:nth-child(2)").attr("style",c.join(";")),C.select("path").attr("style",u.join(";").replace("fill","stroke"))}else C=d.insert("rect",":first-child"),C.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:k}=jD(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+k})`),o){const R=m.select("span");R&&R.attr("style",o)}const A=C.node().getBBox();return t.offsetX=0,t.width=A.width,t.height=A.height,t.offsetY=b.height-t.padding/2,t.intersect=function(R){return nb(t,R)},{cluster:d,labelBBox:b}},"kanbanSection"),_8e=ie((e,t)=>{const n=as(),{themeVariables:r,handDrawnSeed:s}=n,{nodeBorder:i}=r,a=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),o=a.insert("g",":first-child"),l=0*t.padding,c=t.width+l;t.diff=-t.padding;const u=t.height+l,d=t.x-c/2,h=t.y-u/2;t.width=c;let m;if(t.look==="handDrawn"){const v=kn.svg(a).rectangle(d,h,c,u,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:s});m=a.insert(()=>v,":first-child")}else m=o.insert("rect",":first-child"),m.attr("class","divider").attr("x",d).attr("y",h).attr("width",c).attr("height",u).attr("data-look",t.look);const y=m.node().getBBox();return t.height=y.height,t.offsetX=0,t.offsetY=0,t.intersect=function(b){return nb(t,b)},{cluster:a,labelBBox:{}}},"divider"),S8e=ute,C8e={rect:ute,squareRect:S8e,roundedWithTitle:x8e,noteGroup:v8e,divider:_8e,kanbanSection:w8e},dte=new Map,k8e=ie(async(e,t)=>{const n=t.shape||"rect",r=await C8e[n](e,t);return dte.set(t.id,r),r},"insertCluster"),Zut=ie(()=>{dte=new Map},"clear");function fte(e,t){return e.intersect(t)}ie(fte,"intersectNode");var E8e=fte;function hte(e,t,n,r){var s=e.x,i=e.y,a=s-r.x,o=i-r.y,l=Math.sqrt(t*t*o*o+n*n*a*a),c=Math.abs(t*n*a/l);r.x<s&&(c=-c);var u=Math.abs(t*n*o/l);return r.y<i&&(u=-u),{x:s+c,y:i+u}}ie(hte,"intersectEllipse");var pte=hte;function mte(e,t,n){return pte(e,t,t,n)}ie(mte,"intersectCircle");var T8e=mte;function gte(e,t,n,r){var s,i,a,o,l,c,u,d,h,m,y,b,v,x,w;if(s=t.y-e.y,a=e.x-t.x,l=t.x*e.y-e.x*t.y,h=s*n.x+a*n.y+l,m=s*r.x+a*r.y+l,!(h!==0&&m!==0&&b4(h,m))&&(i=r.y-n.y,o=n.x-r.x,c=r.x*n.y-n.x*r.y,u=i*e.x+o*e.y+c,d=i*t.x+o*t.y+c,!(u!==0&&d!==0&&b4(u,d))&&(y=s*o-i*a,y!==0)))return b=Math.abs(y/2),v=a*c-o*l,x=v<0?(v-b)/y:(v+b)/y,v=i*l-s*c,w=v<0?(v-b)/y:(v+b)/y,{x,y:w}}ie(gte,"intersectLine");function b4(e,t){return e*t>0}ie(b4,"sameSign");var A8e=gte;function yte(e,t,n){let r=e.x,s=e.y,i=[],a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(u){a=Math.min(a,u.x),o=Math.min(o,u.y)}):(a=Math.min(a,t.x),o=Math.min(o,t.y));let l=r-e.width/2-a,c=s-e.height/2-o;for(let u=0;u<t.length;u++){let d=t[u],h=t[u<t.length-1?u+1:0],m=A8e(e,n,{x:l+d.x,y:c+d.y},{x:l+h.x,y:c+h.y});m&&i.push(m)}return i.length?(i.length>1&&i.sort(function(u,d){let h=u.x-n.x,m=u.y-n.y,y=Math.sqrt(h*h+m*m),b=d.x-n.x,v=d.y-n.y,x=Math.sqrt(b*b+v*v);return y<x?-1:y===x?0:1}),i[0]):e}ie(yte,"intersectPolygon");var R8e=yte,_n={node:E8e,circle:T8e,ellipse:pte,polygon:R8e,rect:nb};function bte(e,t){const{labelStyles:n}=Mn(t);t.labelStyle=n;const r=tr(t);let s=r;r||(s="anchor");const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=1,{cssStyles:o}=t,l=kn.svg(i),c=Tn(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);const u=l.circle(0,0,a*2,c),d=i.insert(()=>u,":first-child");return d.attr("class","anchor").attr("style",no(o)),Nn(t,d),t.intersect=function(h){return zt.info("Circle intersect",t,a,h),_n.circle(t,a,h)},i}ie(bte,"anchor");function v4(e,t,n,r,s,i,a){const l=(e+n)/2,c=(t+r)/2,u=Math.atan2(r-t,n-e),d=(n-e)/2,h=(r-t)/2,m=d/s,y=h/i,b=Math.sqrt(m**2+y**2);if(b>1)throw new Error("The given radii are too small to create an arc between the points.");const v=Math.sqrt(1-b**2),x=l+v*i*Math.sin(u)*(a?-1:1),w=c-v*s*Math.cos(u)*(a?-1:1),S=Math.atan2((t-w)/i,(e-x)/s);let k=Math.atan2((r-w)/i,(n-x)/s)-S;a&&k<0&&(k+=2*Math.PI),!a&&k>0&&(k-=2*Math.PI);const A=[];for(let R=0;R<20;R++){const N=R/19,I=S+N*k,O=x+s*Math.cos(I),L=w+i*Math.sin(I);A.push({x:O,y:L})}return A}ie(v4,"generateArcPoints");async function vte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.width+t.padding+20,o=i.height+t.padding,l=o/2,c=l/(2.5+o/50),{cssStyles:u}=t,d=[{x:a/2,y:-o/2},{x:-a/2,y:-o/2},...v4(-a/2,-o/2,-a/2,o/2,c,l,!1),{x:a/2,y:o/2},...v4(a/2,o/2,a/2,-o/2,c,l,!0)],h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Xr(d),b=h.path(y,m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(${c/2}, 0)`),Nn(t,v),t.intersect=function(x){return _n.polygon(t,d,x)},s}ie(vte,"bowTieRect");function sf(e,t,n,r){return e.insert("polygon",":first-child").attr("points",r.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+n/2+")")}ie(sf,"insertPolygonShape");async function xte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.height+t.padding,o=12,l=i.width+t.padding+o,c=0,u=l,d=-a,h=0,m=[{x:c+o,y:d},{x:u,y:d},{x:u,y:h},{x:c,y:h},{x:c,y:d+o},{x:c+o,y:d}];let y;const{cssStyles:b}=t;if(t.look==="handDrawn"){const v=kn.svg(s),x=Tn(t,{}),w=Xr(m),S=v.path(w,x);y=s.insert(()=>S,":first-child").attr("transform",`translate(${-l/2}, ${a/2})`),b&&y.attr("style",b)}else y=sf(s,l,a,m);return r&&y.attr("style",r),Nn(t,y),t.intersect=function(v){return _n.polygon(t,m,v)},s}ie(xte,"card");function wte(e,t){const{nodeStyles:n}=Mn(t);t.label="";const r=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,i=Math.max(28,t.width??0),a=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],o=kn.svg(r),l=Tn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=Xr(a),u=o.path(c,l),d=r.insert(()=>u,":first-child");return s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),n&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",n),t.width=28,t.height=28,t.intersect=function(h){return _n.polygon(t,a,h)},r}ie(wte,"choice");async function _te(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await ur(e,t,tr(t)),o=i.width/2+a;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=kn.svg(s),d=Tn(t,{}),h=u.circle(0,0,o*2,d);l=s.insert(()=>h,":first-child"),l.attr("class","basic label-container").attr("style",no(c))}else l=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",o).attr("cx",0).attr("cy",0);return Nn(t,l),t.intersect=function(u){return zt.info("Circle intersect",t,o,u),_n.circle(t,o,u)},s}ie(_te,"circle");function Ste(e){const t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,s={x:r/2*t,y:r/2*n},i={x:-(r/2)*t,y:r/2*n},a={x:-(r/2)*t,y:-(r/2)*n},o={x:r/2*t,y:-(r/2)*n};return`M ${i.x},${i.y} L ${o.x},${o.y}
                   M ${s.x},${s.y} L ${a.x},${a.y}`}ie(Ste,"createLine");function Cte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n,t.label="";const s=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),i=Math.max(30,(t==null?void 0:t.width)??0),{cssStyles:a}=t,o=kn.svg(s),l=Tn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=o.circle(0,0,i*2,l),u=Ste(i),d=o.path(u,l),h=s.insert(()=>c,":first-child");return h.insert(()=>d),a&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",a),r&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",r),Nn(t,h),t.intersect=function(m){return zt.info("crossedCircle intersect",t,{radius:i,point:m}),_n.circle(t,i,m)},s}ie(Cte,"crossedCircle");function gd(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(gd,"generateCirclePoints");async function kte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...gd(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...gd(o/2+c*2,-c,c,20,-180,-270),...gd(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...gd(o/2,l/2,c,20,0,90)],h=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...gd(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...gd(o/2+o*.1,-c,c,20,-180,-270),...gd(o/2+o*.1,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...gd(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2,y:l/2+c}],m=kn.svg(s),y=Tn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Xr(d).replace("Z",""),x=m.path(v,y),w=Xr(h),S=m.path(w,{...y}),C=s.insert("g",":first-child");return C.insert(()=>S,":first-child").attr("stroke-opacity",0),C.insert(()=>x,":first-child"),C.attr("class","text"),u&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),C.attr("transform",`translate(${c}, 0)`),a.attr("transform",`translate(${-o/2+c-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Nn(t,C),t.intersect=function(k){return _n.polygon(t,h,k)},s}ie(kte,"curlyBraceLeft");function yd(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:m,y})}return a}ie(yd,"generateCirclePoints");async function Ete(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...yd(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...yd(o/2+c*2,-c,c,20,-180,-270),...yd(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...yd(o/2,l/2,c,20,0,90)],h=[{x:-o/2,y:-l/2-c},{x:o/2,y:-l/2-c},...yd(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...yd(o/2+c*2,-c,c,20,-180,-270),...yd(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...yd(o/2,l/2,c,20,0,90),{x:o/2,y:l/2+c},{x:-o/2,y:l/2+c}],m=kn.svg(s),y=Tn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Xr(d).replace("Z",""),x=m.path(v,y),w=Xr(h),S=m.path(w,{...y}),C=s.insert("g",":first-child");return C.insert(()=>S,":first-child").attr("stroke-opacity",0),C.insert(()=>x,":first-child"),C.attr("class","text"),u&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),C.attr("transform",`translate(${-c}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Nn(t,C),t.intersect=function(k){return _n.polygon(t,h,k)},s}ie(Ete,"curlyBraceRight");function pa(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(pa,"generateCirclePoints");async function Tte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...pa(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...pa(o/2+c*2,-c,c,20,-180,-270),...pa(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...pa(o/2,l/2,c,20,0,90)],h=[...pa(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...pa(-o/2-c/2,-c,c,20,0,90),...pa(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...pa(-o/2+c+c/2,l/2,c,30,-180,-270)],m=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...pa(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...pa(o/2+c*2,-c,c,20,-180,-270),...pa(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...pa(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2-c-c/2,y:l/2+c},...pa(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...pa(-o/2-c/2,-c,c,20,0,90),...pa(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...pa(-o/2+c+c/2,l/2,c,30,-180,-270)],y=kn.svg(s),b=Tn(t,{fill:"none"});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const x=Xr(d).replace("Z",""),w=y.path(x,b),C=Xr(h).replace("Z",""),k=y.path(C,b),A=Xr(m),R=y.path(A,{...b}),N=s.insert("g",":first-child");return N.insert(()=>R,":first-child").attr("stroke-opacity",0),N.insert(()=>w,":first-child"),N.insert(()=>k,":first-child"),N.attr("class","text"),u&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(${c-c/4}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Nn(t,N),t.intersect=function(I){return _n.polygon(t,m,I)},s}ie(Tte,"curlyBraces");async function Ate(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=80,o=20,l=Math.max(a,(i.width+(t.padding??0)*2)*1.25,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=l,b=c,v=y-u,x=b/4,w=[{x:v,y:0},{x,y:0},{x:0,y:b/2},{x,y:b},{x:v,y:b},...p6(-v,-b/2,u,50,270,90)],S=Xr(w),C=h.path(S,m),k=s.insert(()=>C,":first-child");return k.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&k.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&k.selectChildren("path").attr("style",r),k.attr("transform",`translate(${-l/2}, ${-c/2})`),Nn(t,k),t.intersect=function(A){return _n.polygon(t,w,A)},s}ie(Ate,"curvedTrapezoid");var N8e=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),M8e=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),I8e=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function Rte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+t.padding,t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+t.padding,t.height??0);let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=kn.svg(s),y=M8e(0,0,o,u,l,c),b=I8e(0,c,o,u,l,c),v=m.path(y,Tn(t,{})),x=m.path(b,Tn(t,{fill:"none"}));d=s.insert(()=>x,":first-child"),d=s.insert(()=>v,":first-child"),d.attr("class","basic label-container"),h&&d.attr("style",h)}else{const m=N8e(0,0,o,u,l,c);d=s.insert("path",":first-child").attr("d",m).attr("class","basic label-container").attr("style",no(h)).attr("style",r)}return d.attr("label-offset-y",c),d.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Nn(t,d),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(m){const y=_n.rect(t,m),b=y.x-(t.x??0);if(l!=0&&(Math.abs(b)<(t.width??0)/2||Math.abs(b)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-c)){let v=c*c*(1-b*b/(l*l));v>0&&(v=Math.sqrt(v)),v=c-v,m.y-(t.y??0)>0&&(v=-v),y.y+=v}return y},s}ie(Rte,"cylinder");async function Nte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+t.padding,l=i.height+t.padding,c=l*.2,u=-o/2,d=-l/2-c/2,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d+c},{x:-u,y:d+c},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${u+(t.padding??0)/2-(i.x-(i.left??0))}, ${d+c+(t.padding??0)/2-(i.y-(i.top??0))})`),Nn(t,x),t.intersect=function(w){return _n.rect(t,w)},s}ie(Nte,"dividedRectangle");async function Mte(e,t){var h,m;const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await ur(e,t,tr(t)),l=i.width/2+a+5,c=i.width/2+a;let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const y=kn.svg(s),b=Tn(t,{roughness:.2,strokeWidth:2.5}),v=Tn(t,{roughness:.2,strokeWidth:1.5}),x=y.circle(0,0,l*2,b),w=y.circle(0,0,c*2,v);u=s.insert("g",":first-child"),u.attr("class",no(t.cssClasses)).attr("style",no(d)),(h=u.node())==null||h.appendChild(x),(m=u.node())==null||m.appendChild(w)}else{u=s.insert("g",":first-child");const y=u.insert("circle",":first-child"),b=u.insert("circle");u.attr("class","basic label-container").attr("style",r),y.attr("class","outer-circle").attr("style",r).attr("r",l).attr("cx",0).attr("cy",0),b.attr("class","inner-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0)}return Nn(t,u),t.intersect=function(y){return zt.info("DoubleCircle intersect",t,l,y),_n.circle(t,l,y)},s}ie(Mte,"doublecircle");function Ite(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=Mn(t);t.label="",t.labelStyle=r;const i=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),a=7,{cssStyles:o}=t,l=kn.svg(i),{nodeBorder:c}=n,u=Tn(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(u.roughness=0);const d=l.circle(0,0,a*2,u),h=i.insert(()=>d,":first-child");return h.selectAll("path").attr("style",`fill: ${c} !important;`),o&&o.length>0&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",o),s&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",s),Nn(t,h),t.intersect=function(m){return zt.info("filledCircle intersect",t,{radius:a,point:m}),_n.circle(t,a,m)},i}ie(Ite,"filledCircle");async function jte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+(t.padding??0),l=o+i.height,c=o+i.height,u=[{x:0,y:-l},{x:c,y:-l},{x:c/2,y:0}],{cssStyles:d}=t,h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Xr(u),b=h.path(y,m),v=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return d&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),t.width=o,t.height=l,Nn(t,v),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-l/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(x){return zt.info("Triangle intersect",t,u,x),_n.polygon(t,u,x)},s}ie(jte,"flippedTriangle");function Ote(e,t,{dir:n,config:{state:r,themeVariables:s}}){const{nodeStyles:i}=Mn(t);t.label="";const a=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),{cssStyles:o}=t;let l=Math.max(70,(t==null?void 0:t.width)??0),c=Math.max(10,(t==null?void 0:t.height)??0);n==="LR"&&(l=Math.max(10,(t==null?void 0:t.width)??0),c=Math.max(70,(t==null?void 0:t.height)??0));const u=-1*l/2,d=-1*c/2,h=kn.svg(a),m=Tn(t,{stroke:s.lineColor,fill:s.lineColor});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=h.rectangle(u,d,l,c,m),b=a.insert(()=>y,":first-child");o&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",o),i&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",i),Nn(t,b);const v=(r==null?void 0:r.padding)??0;return t.width&&t.height&&(t.width+=v/2||0,t.height+=v/2||0),t.intersect=function(x){return _n.rect(t,x)},a}ie(Ote,"forkJoin");async function Pte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const s=80,i=50,{shapeSvg:a,bbox:o}=await ur(e,t,tr(t)),l=Math.max(s,o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i,o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=kn.svg(a),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-l/2,y:-c/2},{x:l/2-u,y:-c/2},...p6(-l/2+u,0,u,50,90,270),{x:l/2-u,y:c/2},{x:-l/2,y:c/2}],b=Xr(y),v=h.path(b,m),x=a.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),Nn(t,x),t.intersect=function(w){return zt.info("Pill intersect",t,{radius:u,point:w}),_n.polygon(t,y,w)},a}ie(Pte,"halfRoundedRectangle");var j8e=ie((e,t,n,r,s)=>[`M${e+s},${t}`,`L${e+n-s},${t}`,`L${e+n},${t-r/2}`,`L${e+n-s},${t-r}`,`L${e+s},${t-r}`,`L${e},${t-r/2}`,"Z"].join(" "),"createHexagonPathD");async function Dte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=4,o=i.height+t.padding,l=o/a,c=i.width+2*l+t.padding,u=[{x:l,y:0},{x:c-l,y:0},{x:c,y:-o/2},{x:c-l,y:-o},{x:l,y:-o},{x:0,y:-o/2}];let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=kn.svg(s),y=Tn(t,{}),b=j8e(0,0,c,o,l),v=m.path(b,y);d=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${o/2})`),h&&d.attr("style",h)}else d=sf(s,c,o,u);return r&&d.attr("style",r),t.width=c,t.height=o,Nn(t,d),t.intersect=function(m){return _n.polygon(t,u,m)},s}ie(Dte,"hexagon");async function Fte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.label="",t.labelStyle=n;const{shapeSvg:s}=await ur(e,t,tr(t)),i=Math.max(30,(t==null?void 0:t.width)??0),a=Math.max(30,(t==null?void 0:t.height)??0),{cssStyles:o}=t,l=kn.svg(s),c=Tn(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const u=[{x:0,y:0},{x:i,y:0},{x:0,y:a},{x:i,y:a}],d=Xr(u),h=l.path(d,c),m=s.insert(()=>h,":first-child");return m.attr("class","basic label-container"),o&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",o),r&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",r),m.attr("transform",`translate(${-i/2}, ${-a/2})`),Nn(t,m),t.intersect=function(y){return zt.info("Pill intersect",t,{points:u}),_n.polygon(t,u,y)},s}ie(Fte,"hourglass");async function Lte(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Mn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await ur(e,t,"icon-shape default"),h=t.pos==="t",m=o,y=o,{nodeBorder:b}=n,{stylesMap:v}=rb(t),x=-y/2,w=-m/2,S=t.label?8:0,C=kn.svg(c),k=Tn(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");const A=C.rectangle(x,w,y,m,k),R=Math.max(y,u.width),N=m+u.height+S,I=C.rectangle(-R/2,-N/2,R,N,{...k,fill:"transparent",stroke:"none"}),O=c.insert(()=>A,":first-child"),L=c.insert(()=>I);if(t.icon){const P=c.append("g");P.html(`<g>${await hT(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const V=P.node().getBBox(),F=V.width,X=V.height,U=V.x,H=V.y;P.attr("transform",`translate(${-F/2-U},${h?u.height/2+S/2-X/2-H:-u.height/2-S/2-X/2-H})`),P.attr("style",`color: ${v.get("stroke")??b};`)}return d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${h?-N/2:N/2-u.height})`),O.attr("transform",`translate(0,${h?u.height/2+S/2:-u.height/2-S/2})`),Nn(t,L),t.intersect=function(P){if(zt.info("iconSquare intersect",t,P),!t.label)return _n.rect(t,P);const V=t.x??0,F=t.y??0,X=t.height??0;let U=[];return h?U=[{x:V-u.width/2,y:F-X/2},{x:V+u.width/2,y:F-X/2},{x:V+u.width/2,y:F-X/2+u.height+S},{x:V+y/2,y:F-X/2+u.height+S},{x:V+y/2,y:F+X/2},{x:V-y/2,y:F+X/2},{x:V-y/2,y:F-X/2+u.height+S},{x:V-u.width/2,y:F-X/2+u.height+S}]:U=[{x:V-y/2,y:F-X/2},{x:V+y/2,y:F-X/2},{x:V+y/2,y:F-X/2+m},{x:V+u.width/2,y:F-X/2+m},{x:V+u.width/2/2,y:F+X/2},{x:V-u.width/2,y:F+X/2},{x:V-u.width/2,y:F-X/2+m},{x:V-y/2,y:F-X/2+m}],_n.polygon(t,U,P)},c}ie(Lte,"icon");async function Bte(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Mn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await ur(e,t,"icon-shape default"),h=20,m=t.label?8:0,y=t.pos==="t",{nodeBorder:b,mainBkg:v}=n,{stylesMap:x}=rb(t),w=kn.svg(c),S=Tn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const C=x.get("fill");S.stroke=C??v;const k=c.append("g");t.icon&&k.html(`<g>${await hT(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const A=k.node().getBBox(),R=A.width,N=A.height,I=A.x,O=A.y,L=Math.max(R,N)*Math.SQRT2+h*2,P=w.circle(0,0,L,S),V=Math.max(L,u.width),F=L+u.height+m,X=w.rectangle(-V/2,-F/2,V,F,{...S,fill:"transparent",stroke:"none"}),U=c.insert(()=>P,":first-child"),H=c.insert(()=>X);return k.attr("transform",`translate(${-R/2-I},${y?u.height/2+m/2-N/2-O:-u.height/2-m/2-N/2-O})`),k.attr("style",`color: ${x.get("stroke")??b};`),d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${y?-F/2:F/2-u.height})`),U.attr("transform",`translate(0,${y?u.height/2+m/2:-u.height/2-m/2})`),Nn(t,H),t.intersect=function($){return zt.info("iconSquare intersect",t,$),_n.rect(t,$)},c}ie(Bte,"iconCircle");async function $te(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Mn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await ur(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=rb(t),S=-b/2,C=-y/2,k=t.label?8:0,A=kn.svg(c),R=Tn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const N=w.get("fill");R.stroke=N??x;const I=A.path(rf(S,C,b,y,5),R),O=Math.max(b,u.width),L=y+u.height+k,P=A.rectangle(-O/2,-L/2,O,L,{...R,fill:"transparent",stroke:"none"}),V=c.insert(()=>I,":first-child").attr("class","icon-shape2"),F=c.insert(()=>P);if(t.icon){const X=c.append("g");X.html(`<g>${await hT(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=X.node().getBBox(),H=U.width,$=U.height,ne=U.x,W=U.y;X.attr("transform",`translate(${-H/2-ne},${m?u.height/2+k/2-$/2-W:-u.height/2-k/2-$/2-W})`),X.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-L/2:L/2-u.height})`),V.attr("transform",`translate(0,${m?u.height/2+k/2:-u.height/2-k/2})`),Nn(t,F),t.intersect=function(X){if(zt.info("iconSquare intersect",t,X),!t.label)return _n.rect(t,X);const U=t.x??0,H=t.y??0,$=t.height??0;let ne=[];return m?ne=[{x:U-u.width/2,y:H-$/2},{x:U+u.width/2,y:H-$/2},{x:U+u.width/2,y:H-$/2+u.height+k},{x:U+b/2,y:H-$/2+u.height+k},{x:U+b/2,y:H+$/2},{x:U-b/2,y:H+$/2},{x:U-b/2,y:H-$/2+u.height+k},{x:U-u.width/2,y:H-$/2+u.height+k}]:ne=[{x:U-b/2,y:H-$/2},{x:U+b/2,y:H-$/2},{x:U+b/2,y:H-$/2+y},{x:U+u.width/2,y:H-$/2+y},{x:U+u.width/2/2,y:H+$/2},{x:U-u.width/2,y:H+$/2},{x:U-u.width/2,y:H-$/2+y},{x:U-b/2,y:H-$/2+y}],_n.polygon(t,ne,X)},c}ie($te,"iconRounded");async function zte(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Mn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await ur(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=rb(t),S=-b/2,C=-y/2,k=t.label?8:0,A=kn.svg(c),R=Tn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const N=w.get("fill");R.stroke=N??x;const I=A.path(rf(S,C,b,y,.1),R),O=Math.max(b,u.width),L=y+u.height+k,P=A.rectangle(-O/2,-L/2,O,L,{...R,fill:"transparent",stroke:"none"}),V=c.insert(()=>I,":first-child"),F=c.insert(()=>P);if(t.icon){const X=c.append("g");X.html(`<g>${await hT(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=X.node().getBBox(),H=U.width,$=U.height,ne=U.x,W=U.y;X.attr("transform",`translate(${-H/2-ne},${m?u.height/2+k/2-$/2-W:-u.height/2-k/2-$/2-W})`),X.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-L/2:L/2-u.height})`),V.attr("transform",`translate(0,${m?u.height/2+k/2:-u.height/2-k/2})`),Nn(t,F),t.intersect=function(X){if(zt.info("iconSquare intersect",t,X),!t.label)return _n.rect(t,X);const U=t.x??0,H=t.y??0,$=t.height??0;let ne=[];return m?ne=[{x:U-u.width/2,y:H-$/2},{x:U+u.width/2,y:H-$/2},{x:U+u.width/2,y:H-$/2+u.height+k},{x:U+b/2,y:H-$/2+u.height+k},{x:U+b/2,y:H+$/2},{x:U-b/2,y:H+$/2},{x:U-b/2,y:H-$/2+u.height+k},{x:U-u.width/2,y:H-$/2+u.height+k}]:ne=[{x:U-b/2,y:H-$/2},{x:U+b/2,y:H-$/2},{x:U+b/2,y:H-$/2+y},{x:U+u.width/2,y:H-$/2+y},{x:U+u.width/2/2,y:H+$/2},{x:U-u.width/2,y:H+$/2},{x:U-u.width/2,y:H-$/2+y},{x:U-b/2,y:H-$/2+y}],_n.polygon(t,ne,X)},c}ie(zte,"iconSquare");async function Ute(e,t,{config:{flowchart:n}}){const r=new Image;r.src=(t==null?void 0:t.img)??"",await r.decode();const s=Number(r.naturalWidth.toString().replace("px","")),i=Number(r.naturalHeight.toString().replace("px",""));t.imageAspectRatio=s/i;const{labelStyles:a}=Mn(t);t.labelStyle=a;const o=n==null?void 0:n.wrappingWidth;t.defaultWidth=n==null?void 0:n.wrappingWidth;const l=Math.max(t.label?o??0:0,(t==null?void 0:t.assetWidth)??s),c=t.constraint==="on"&&t!=null&&t.assetHeight?t.assetHeight*t.imageAspectRatio:l,u=t.constraint==="on"?c/t.imageAspectRatio:(t==null?void 0:t.assetHeight)??i;t.width=Math.max(c,o??0);const{shapeSvg:d,bbox:h,label:m}=await ur(e,t,"image-shape default"),y=t.pos==="t",b=-c/2,v=-u/2,x=t.label?8:0,w=kn.svg(d),S=Tn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const C=w.rectangle(b,v,c,u,S),k=Math.max(c,h.width),A=u+h.height+x,R=w.rectangle(-k/2,-A/2,k,A,{...S,fill:"none",stroke:"none"}),N=d.insert(()=>C,":first-child"),I=d.insert(()=>R);if(t.img){const O=d.append("image");O.attr("href",t.img),O.attr("width",c),O.attr("height",u),O.attr("preserveAspectRatio","none"),O.attr("transform",`translate(${-c/2},${y?A/2-u:-A/2})`)}return m.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${y?-u/2-h.height/2-x/2:u/2-h.height/2+x/2})`),N.attr("transform",`translate(0,${y?h.height/2+x/2:-h.height/2-x/2})`),Nn(t,I),t.intersect=function(O){if(zt.info("iconSquare intersect",t,O),!t.label)return _n.rect(t,O);const L=t.x??0,P=t.y??0,V=t.height??0;let F=[];return y?F=[{x:L-h.width/2,y:P-V/2},{x:L+h.width/2,y:P-V/2},{x:L+h.width/2,y:P-V/2+h.height+x},{x:L+c/2,y:P-V/2+h.height+x},{x:L+c/2,y:P+V/2},{x:L-c/2,y:P+V/2},{x:L-c/2,y:P-V/2+h.height+x},{x:L-h.width/2,y:P-V/2+h.height+x}]:F=[{x:L-c/2,y:P-V/2},{x:L+c/2,y:P-V/2},{x:L+c/2,y:P-V/2+u},{x:L+h.width/2,y:P-V/2+u},{x:L+h.width/2/2,y:P+V/2},{x:L-h.width/2,y:P+V/2},{x:L-h.width/2,y:P-V/2+u},{x:L-c/2,y:P-V/2+u}],_n.polygon(t,F,O)},d}ie(Ute,"imageSquare");async function qte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:-3*o/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=kn.svg(s),h=Tn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=sf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Nn(t,c),t.intersect=function(d){return _n.polygon(t,l,d)},s}ie(qte,"inv_trapezoid");async function K1(e,t,n){const{labelStyles:r,nodeStyles:s}=Mn(t);t.labelStyle=r;const{shapeSvg:i,bbox:a}=await ur(e,t,tr(t)),o=Math.max(a.width+n.labelPaddingX*2,(t==null?void 0:t.width)||0),l=Math.max(a.height+n.labelPaddingY*2,(t==null?void 0:t.height)||0),c=-o/2,u=-l/2;let d,{rx:h,ry:m}=t;const{cssStyles:y}=t;if(n!=null&&n.rx&&n.ry&&(h=n.rx,m=n.ry),t.look==="handDrawn"){const b=kn.svg(i),v=Tn(t,{}),x=h||m?b.path(rf(c,u,o,l,h||0),v):b.rectangle(c,u,o,l,v);d=i.insert(()=>x,":first-child"),d.attr("class","basic label-container").attr("style",no(y))}else d=i.insert("rect",":first-child"),d.attr("class","basic label-container").attr("style",s).attr("rx",no(h)).attr("ry",no(m)).attr("x",c).attr("y",u).attr("width",o).attr("height",l);return Nn(t,d),t.intersect=function(b){return _n.rect(t,b)},i}ie(K1,"drawRect");async function Vte(e,t){const{shapeSvg:n,bbox:r,label:s}=await ur(e,t,"label"),i=n.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),n.attr("class","label edgeLabel"),s.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),Nn(t,i),t.intersect=function(l){return _n.rect(t,l)},n}ie(Vte,"labelRect");async function Wte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:-(3*o)/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=kn.svg(s),h=Tn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=sf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Nn(t,c),t.intersect=function(d){return _n.polygon(t,l,d)},s}ie(Wte,"lean_left");async function Hte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:-3*o/6,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=kn.svg(s),h=Tn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=sf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Nn(t,c),t.intersect=function(d){return _n.polygon(t,l,d)},s}ie(Hte,"lean_right");function Gte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.label="",t.labelStyle=n;const s=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,a=Math.max(35,(t==null?void 0:t.width)??0),o=Math.max(35,(t==null?void 0:t.height)??0),l=7,c=[{x:a,y:0},{x:0,y:o+l/2},{x:a-2*l,y:o+l/2},{x:0,y:2*o},{x:a,y:o-l/2},{x:2*l,y:o-l/2}],u=kn.svg(s),d=Tn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=Xr(c),m=u.path(h,d),y=s.insert(()=>m,":first-child");return i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),r&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",r),y.attr("transform",`translate(-${a/2},${-o})`),Nn(t,y),t.intersect=function(b){return zt.info("lightningBolt intersect",t,b),_n.polygon(t,c,b)},s}ie(Gte,"lightningBolt");var O8e=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createCylinderPathD"),P8e=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createOuterCylinderPathD"),D8e=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function Kte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0),t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+(t.padding??0),t.height??0),d=u*.1;let h;const{cssStyles:m}=t;if(t.look==="handDrawn"){const y=kn.svg(s),b=P8e(0,0,o,u,l,c,d),v=D8e(0,c,o,u,l,c),x=Tn(t,{}),w=y.path(b,x),S=y.path(v,x);s.insert(()=>S,":first-child").attr("class","line"),h=s.insert(()=>w,":first-child"),h.attr("class","basic label-container"),m&&h.attr("style",m)}else{const y=O8e(0,0,o,u,l,c,d);h=s.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",no(m)).attr("style",r)}return h.attr("label-offset-y",c),h.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Nn(t,h),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),t.intersect=function(y){const b=_n.rect(t,y),v=b.x-(t.x??0);if(l!=0&&(Math.abs(v)<(t.width??0)/2||Math.abs(v)==(t.width??0)/2&&Math.abs(b.y-(t.y??0))>(t.height??0)/2-c)){let x=c*c*(1-v*v/(l*l));x>0&&(x=Math.sqrt(x)),x=c-x,y.y-(t.y??0)>0&&(x=-x),b.y+=x}return b},s}ie(Kte,"linedCylinder");async function Yte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,{cssStyles:d}=t,h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-o/2-o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:u/2},...Nh(-o/2-o/2*.1,u/2,o/2+o/2*.1,u/2,c,.8),{x:o/2+o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:-u/2},{x:-o/2,y:-u/2},{x:-o/2,y:u/2*1.1},{x:-o/2,y:-u/2}],b=h.polygon(y.map(x=>[x.x,x.y]),m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)+o/2*.1/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Nn(t,v),t.intersect=function(x){return _n.polygon(t,y,x)},s}ie(Yte,"linedWaveEdgedRect");async function Zte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{}),b=[{x:u-c,y:d+c},{x:u-c,y:d+l+c},{x:u+o-c,y:d+l+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d+l-c},{x:u+o+c,y:d+l-c},{x:u+o+c,y:d-c},{x:u+c,y:d-c},{x:u+c,y:d},{x:u,y:d},{x:u,y:d+c}],v=[{x:u,y:d+c},{x:u+o-c,y:d+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d},{x:u,y:d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Xr(b),w=m.path(x,y),S=Xr(v),C=m.path(S,{...y,fill:"none"}),k=s.insert(()=>C,":first-child");return k.insert(()=>w,":first-child"),k.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)-c-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),Nn(t,k),t.intersect=function(A){return _n.polygon(t,b,A)},s}ie(Zte,"multiRect");async function Xte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,d=-o/2,h=-u/2,m=5,{cssStyles:y}=t,b=Nh(d-m,h+u+m,d+o-m,h+u+m,c,.8),v=b==null?void 0:b[b.length-1],x=[{x:d-m,y:h+m},{x:d-m,y:h+u+m},...b,{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:v.y-2*m},{x:d+o+m,y:v.y-2*m},{x:d+o+m,y:h-m},{x:d+m,y:h-m},{x:d+m,y:h},{x:d,y:h},{x:d,y:h+m}],w=[{x:d,y:h+m},{x:d+o-m,y:h+m},{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:h},{x:d,y:h}],S=kn.svg(s),C=Tn(t,{});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");const k=Xr(x),A=S.path(k,C),R=Xr(w),N=S.path(R,C),I=s.insert(()=>A,":first-child");return I.insert(()=>N),I.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",y),r&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",r),I.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-(i.width/2)-m-(i.x-(i.left??0))}, ${-(i.height/2)+m-c/2-(i.y-(i.top??0))})`),Nn(t,I),t.intersect=function(O){return _n.polygon(t,x,O)},s}ie(Xte,"multiWaveEdgedRectangle");async function Jte(e,t,{config:{themeVariables:n}}){var x;const{labelStyles:r,nodeStyles:s}=Mn(t);t.labelStyle=r,t.useHtmlLabels||((x=Ro().flowchart)==null?void 0:x.htmlLabels)!==!1||(t.centerLabel=!0);const{shapeSvg:a,bbox:o}=await ur(e,t,tr(t)),l=Math.max(o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-l/2,d=-c/2,{cssStyles:h}=t,m=kn.svg(a),y=Tn(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=m.rectangle(u,d,l,c,y),v=a.insert(()=>b,":first-child");return v.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),Nn(t,v),t.intersect=function(w){return _n.rect(t,w)},a}ie(Jte,"note");var F8e=ie((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function Qte(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.width+t.padding,o=i.height+t.padding,l=a+o,c=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}];let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const h=kn.svg(s),m=Tn(t,{}),y=F8e(0,0,l),b=h.path(y,m);u=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`),d&&u.attr("style",d)}else u=sf(s,l,l,c);return r&&u.attr("style",r),Nn(t,u),t.intersect=function(h){return zt.debug(`APA12 Intersect called SPLIT
point:`,h,`
node:
`,t,`
res:`,_n.polygon(t,c,h)),_n.polygon(t,c,h)},s}ie(Qte,"question");async function ene(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,d=u/2,h=[{x:c+d,y:u},{x:c,y:0},{x:c+d,y:-u},{x:-c,y:-u},{x:-c,y:u}],{cssStyles:m}=t,y=kn.svg(s),b=Tn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=Xr(h),x=y.path(v,b),w=s.insert(()=>x,":first-child");return w.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),w.attr("transform",`translate(${-d/2},0)`),a.attr("transform",`translate(${-d/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Nn(t,w),t.intersect=function(S){return _n.polygon(t,h,S)},s}ie(ene,"rect_left_inv_arrow");async function tne(e,t){var N,I;const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;let s;t.cssClasses?s="node "+t.cssClasses:s="node default";const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=i.insert("g"),o=i.insert("g").attr("class","label").attr("style",r),l=t.description,c=t.label,u=o.node().appendChild(await Kp(c,t.labelStyle,!0,!0));let d={width:0,height:0};if(Vi((I=(N=as())==null?void 0:N.flowchart)==null?void 0:I.htmlLabels)){const O=u.children[0],L=Kr(u);d=O.getBoundingClientRect(),L.attr("width",d.width),L.attr("height",d.height)}zt.info("Text 2",l);const h=l||[],m=u.getBBox(),y=o.node().appendChild(await Kp(h.join?h.join("<br/>"):h,t.labelStyle,!0,!0)),b=y.children[0],v=Kr(y);d=b.getBoundingClientRect(),v.attr("width",d.width),v.attr("height",d.height);const x=(t.padding||0)/2;Kr(y).attr("transform","translate( "+(d.width>m.width?0:(m.width-d.width)/2)+", "+(m.height+x+5)+")"),Kr(u).attr("transform","translate( "+(d.width<m.width?0:-(m.width-d.width)/2)+", 0)"),d=o.node().getBBox(),o.attr("transform","translate("+-d.width/2+", "+(-d.height/2-x+3)+")");const w=d.width+(t.padding||0),S=d.height+(t.padding||0),C=-d.width/2-x,k=-d.height/2-x;let A,R;if(t.look==="handDrawn"){const O=kn.svg(i),L=Tn(t,{}),P=O.path(rf(C,k,w,S,t.rx||0),L),V=O.line(-d.width/2-x,-d.height/2-x+m.height+x,d.width/2+x,-d.height/2-x+m.height+x,L);R=i.insert(()=>(zt.debug("Rough node insert CXC",P),V),":first-child"),A=i.insert(()=>(zt.debug("Rough node insert CXC",P),P),":first-child")}else A=a.insert("rect",":first-child"),R=a.insert("line"),A.attr("class","outer title-state").attr("style",r).attr("x",-d.width/2-x).attr("y",-d.height/2-x).attr("width",d.width+(t.padding||0)).attr("height",d.height+(t.padding||0)),R.attr("class","divider").attr("x1",-d.width/2-x).attr("x2",d.width/2+x).attr("y1",-d.height/2-x+m.height+x).attr("y2",-d.height/2-x+m.height+x);return Nn(t,A),t.intersect=function(O){return _n.rect(t,O)},i}ie(tne,"rectWithTitle");async function nne(e,t){const n={rx:5,ry:5,labelPaddingX:((t==null?void 0:t.padding)||0)*1,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return K1(e,t,n)}ie(nne,"roundedRect");async function rne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=(t==null?void 0:t.padding)??0,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-i.width/2-o,d=-i.height/2-o,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d},{x:u+l+8,y:d},{x:u+l+8,y:d+c},{x:u-8,y:d+c},{x:u-8,y:d},{x:u,y:d},{x:u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container").attr("style",no(h)),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${-l/2+4+(t.padding??0)-(i.x-(i.left??0))},${-c/2+(t.padding??0)-(i.y-(i.top??0))})`),Nn(t,x),t.intersect=function(w){return _n.rect(t,w)},s}ie(rne,"shadedProcess");async function sne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,{cssStyles:d}=t,h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:c,y:u},{x:c,y:u+l},{x:c+o,y:u+l},{x:c+o,y:u-l/2}],b=Xr(y),v=h.path(b,m),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),x.attr("transform",`translate(0, ${l/4})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))}, ${-l/4+(t.padding??0)-(i.y-(i.top??0))})`),Nn(t,x),t.intersect=function(w){return _n.polygon(t,y,w)},s}ie(sne,"slopedRect");async function ine(e,t){const n={rx:0,ry:0,labelPaddingX:((t==null?void 0:t.padding)||0)*2,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return K1(e,t,n)}ie(ine,"squareRect");async function ane(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.height+t.padding,o=i.width+a/4+t.padding;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=kn.svg(s),d=Tn(t,{}),h=rf(-o/2,-a/2,o,a,a/2),m=u.path(h,d);l=s.insert(()=>m,":first-child"),l.attr("class","basic label-container").attr("style",no(c))}else l=s.insert("rect",":first-child"),l.attr("class","basic label-container").attr("style",r).attr("rx",a/2).attr("ry",a/2).attr("x",-o/2).attr("y",-a/2).attr("width",o).attr("height",a);return Nn(t,l),t.intersect=function(u){return _n.rect(t,u)},s}ie(ane,"stadium");async function one(e,t){return K1(e,t,{rx:5,ry:5})}ie(one,"state");function lne(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=Mn(t);t.labelStyle=r;const{cssStyles:i}=t,{lineColor:a,stateBorder:o,nodeBorder:l}=n,c=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),u=kn.svg(c),d=Tn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=u.circle(0,0,14,{...d,stroke:a,strokeWidth:2}),m=o??l,y=u.circle(0,0,5,{...d,fill:m,stroke:m,strokeWidth:2,fillStyle:"solid"}),b=c.insert(()=>h,":first-child");return b.insert(()=>y),i&&b.selectAll("path").attr("style",i),s&&b.selectAll("path").attr("style",s),Nn(t,b),t.intersect=function(v){return _n.circle(t,7,v)},c}ie(lne,"stateEnd");function cne(e,t,{config:{themeVariables:n}}){const{lineColor:r}=n,s=e.insert("g").attr("class","node default").attr("id",t.domId||t.id);let i;if(t.look==="handDrawn"){const o=kn.svg(s).circle(0,0,14,y8e(r));i=s.insert(()=>o),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=s.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return Nn(t,i),t.intersect=function(a){return _n.circle(t,7,a)},s}ie(cne,"stateStart");async function une(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=((t==null?void 0:t.padding)||0)/2,o=i.width+t.padding,l=i.height+t.padding,c=-i.width/2-a,u=-i.height/2-a,d=[{x:0,y:0},{x:o,y:0},{x:o,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look==="handDrawn"){const h=kn.svg(s),m=Tn(t,{}),y=h.rectangle(c-8,u,o+16,l,m),b=h.line(c,u,c,u+l,m),v=h.line(c+o,u,c+o,u+l,m);s.insert(()=>b,":first-child"),s.insert(()=>v,":first-child");const x=s.insert(()=>y,":first-child"),{cssStyles:w}=t;x.attr("class","basic label-container").attr("style",no(w)),Nn(t,x)}else{const h=sf(s,o,l,d);r&&h.attr("style",r),Nn(t,h)}return t.intersect=function(h){return _n.polygon(t,d,h)},s}ie(une,"subroutine");async function dne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=-a/2,c=-o/2,u=.2*o,d=.2*o,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{}),b=[{x:l-u/2,y:c},{x:l+a+u/2,y:c},{x:l+a+u/2,y:c+o},{x:l-u/2,y:c+o}],v=[{x:l+a-u/2,y:c+o},{x:l+a+u/2,y:c+o},{x:l+a+u/2,y:c+o-d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Xr(b),w=m.path(x,y),S=Xr(v),C=m.path(S,{...y,fillStyle:"solid"}),k=s.insert(()=>C,":first-child");return k.insert(()=>w,":first-child"),k.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),Nn(t,k),t.intersect=function(A){return _n.polygon(t,b,A)},s}ie(dne,"taggedRect");async function fne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=.2*o,d=.2*l,h=l+c,{cssStyles:m}=t,y=kn.svg(s),b=Tn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=[{x:-o/2-o/2*.1,y:h/2},...Nh(-o/2-o/2*.1,h/2,o/2+o/2*.1,h/2,c,.8),{x:o/2+o/2*.1,y:-h/2},{x:-o/2-o/2*.1,y:-h/2}],x=-o/2+o/2*.1,w=-h/2-d*.4,S=[{x:x+o-u,y:(w+l)*1.4},{x:x+o,y:w+l-d},{x:x+o,y:(w+l)*.9},...Nh(x+o,(w+l)*1.3,x+o-u,(w+l)*1.5,-l*.03,.5)],C=Xr(v),k=y.path(C,b),A=Xr(S),R=y.path(A,{...b,fillStyle:"solid"}),N=s.insert(()=>R,":first-child");return N.insert(()=>k,":first-child"),N.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Nn(t,N),t.intersect=function(I){return _n.polygon(t,v,I)},s}ie(fne,"taggedWaveEdgedRectangle");async function hne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+t.padding,(t==null?void 0:t.width)||0),o=Math.max(i.height+t.padding,(t==null?void 0:t.height)||0),l=-a/2,c=-o/2,u=s.insert("rect",":first-child");return u.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",l).attr("y",c).attr("width",a).attr("height",o),Nn(t,u),t.intersect=function(d){return _n.rect(t,d)},s}ie(hne,"text");var L8e=ie((e,t,n,r,s,i)=>`M${e},${t}
    a${s},${i} 0,0,1 0,${-r}
    l${n},0
    a${s},${i} 0,0,1 0,${r}
    M${n},${-r}
    a${s},${i} 0,0,0 0,${r}
    l${-n},0`,"createCylinderPathD"),B8e=ie((e,t,n,r,s,i)=>[`M${e},${t}`,`M${e+n},${t}`,`a${s},${i} 0,0,0 0,${-r}`,`l${-n},0`,`a${s},${i} 0,0,0 0,${r}`,`l${n},0`].join(" "),"createOuterCylinderPathD"),$8e=ie((e,t,n,r,s,i)=>[`M${e+n/2},${-r/2}`,`a${s},${i} 0,0,0 0,${r}`].join(" "),"createInnerCylinderPathD");async function pne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a,halfPadding:o}=await ur(e,t,tr(t)),l=t.look==="neo"?o*2:o,c=i.height+l,u=c/2,d=u/(2.5+c/50),h=i.width+d+l,{cssStyles:m}=t;let y;if(t.look==="handDrawn"){const b=kn.svg(s),v=B8e(0,0,h,c,d,u),x=$8e(0,0,h,c,d,u),w=b.path(v,Tn(t,{})),S=b.path(x,Tn(t,{fill:"none"}));y=s.insert(()=>S,":first-child"),y=s.insert(()=>w,":first-child"),y.attr("class","basic label-container"),m&&y.attr("style",m)}else{const b=L8e(0,0,h,c,d,u);y=s.insert("path",":first-child").attr("d",b).attr("class","basic label-container").attr("style",no(m)).attr("style",r),y.attr("class","basic label-container"),m&&y.selectAll("path").attr("style",m),r&&y.selectAll("path").attr("style",r)}return y.attr("label-offset-x",d),y.attr("transform",`translate(${-h/2}, ${c/2} )`),a.attr("transform",`translate(${-(i.width/2)-d-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Nn(t,y),t.intersect=function(b){const v=_n.rect(t,b),x=v.y-(t.y??0);if(u!=0&&(Math.abs(x)<(t.height??0)/2||Math.abs(x)==(t.height??0)/2&&Math.abs(v.x-(t.x??0))>(t.width??0)/2-d)){let w=d*d*(1-x*x/(u*u));w!=0&&(w=Math.sqrt(Math.abs(w))),w=d-w,b.x-(t.x??0)>0&&(w=-w),v.x+=w}return v},s}ie(pne,"tiltedCylinder");async function mne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.width+t.padding,o=i.height+t.padding,l=[{x:-3*o/6,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=kn.svg(s),h=Tn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=sf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Nn(t,c),t.intersect=function(d){return _n.polygon(t,l,d)},s}ie(mne,"trapezoid");async function gne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=60,o=20,l=Math.max(a,i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),{cssStyles:u}=t,d=kn.svg(s),h=Tn(t,{});t.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");const m=[{x:-l/2*.8,y:-c/2},{x:l/2*.8,y:-c/2},{x:l/2,y:-c/2*.6},{x:l/2,y:c/2},{x:-l/2,y:c/2},{x:-l/2,y:-c/2*.6}],y=Xr(m),b=d.path(y,h),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),Nn(t,v),t.intersect=function(x){return _n.polygon(t,m,x)},s}ie(gne,"trapezoidalPentagon");async function yne(e,t){var w;const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Vi((w=as().flowchart)==null?void 0:w.htmlLabels),l=i.width+(t.padding??0),c=l+i.height,u=l+i.height,d=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-c}],{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=Xr(d),v=m.path(b,y),x=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return h&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),t.width=l,t.height=c,Nn(t,x),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${c/2-(i.height+(t.padding??0)/(o?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(S){return zt.info("Triangle intersect",t,d,S),_n.polygon(t,d,S)},s}ie(yne,"triangle");async function bne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/8,u=l+c,{cssStyles:d}=t,m=70-o,y=m>0?m/2:0,b=kn.svg(s),v=Tn(t,{});t.look!=="handDrawn"&&(v.roughness=0,v.fillStyle="solid");const x=[{x:-o/2-y,y:u/2},...Nh(-o/2-y,u/2,o/2+y,u/2,c,.8),{x:o/2+y,y:-u/2},{x:-o/2-y,y:-u/2}],w=Xr(x),S=b.path(w,v),C=s.insert(()=>S,":first-child");return C.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),C.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c-(i.y-(i.top??0))})`),Nn(t,C),t.intersect=function(k){return _n.polygon(t,x,k)},s}ie(bne,"waveEdgedRectangle");async function vne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=100,o=50,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=l/c;let d=l,h=c;d>h*u?h=d/u:d=h*u,d=Math.max(d,a),h=Math.max(h,o);const m=Math.min(h*.2,h/4),y=h+m*2,{cssStyles:b}=t,v=kn.svg(s),x=Tn(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-d/2,y:y/2},...Nh(-d/2,y/2,d/2,y/2,m,1),{x:d/2,y:-y/2},...Nh(d/2,-y/2,-d/2,-y/2,m,-1)],S=Xr(w),C=v.path(S,x),k=s.insert(()=>C,":first-child");return k.attr("class","basic label-container"),b&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",b),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),Nn(t,k),t.intersect=function(A){return _n.polygon(t,w,A)},s}ie(vne,"waveRectangle");async function xne(e,t){const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{}),b=[{x:u-c,y:d-c},{x:u-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d-c}],v=`M${u-c},${d-c} L${u+o},${d-c} L${u+o},${d+l} L${u-c},${d+l} L${u-c},${d-c}
                M${u-c},${d} L${u+o},${d}
                M${u},${d-c} L${u},${d+l}`;t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=m.path(v,y),w=s.insert(()=>x,":first-child");return w.attr("transform",`translate(${c/2}, ${c/2})`),w.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)+c/2-(i.x-(i.left??0))}, ${-(i.height/2)+c/2-(i.y-(i.top??0))})`),Nn(t,w),t.intersect=function(S){return _n.polygon(t,b,S)},s}ie(xne,"windowPane");async function m6(e,t){var ne,W,Q;const n=t;if(n.alias&&(t.label=n.alias),t.look==="handDrawn"){const{themeVariables:ee}=Ro(),{background:se}=ee,pe={...t,id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${se}`]};await m6(e,pe)}const r=Ro();t.useHtmlLabels=r.htmlLabels;let s=((ne=r.er)==null?void 0:ne.diagramPadding)??10,i=((W=r.er)==null?void 0:W.entityPadding)??6;const{cssStyles:a}=t,{labelStyles:o}=Mn(t);if(n.attributes.length===0&&t.label){const ee={rx:0,ry:0,labelPaddingX:s,labelPaddingY:s*1.5};qd(t.label,r)+ee.labelPaddingX*2<r.er.minEntityWidth&&(t.width=r.er.minEntityWidth);const se=await K1(e,t,ee);if(!Vi(r.htmlLabels)){const pe=se.select("text"),ce=(Q=pe.node())==null?void 0:Q.getBBox();pe.attr("transform",`translate(${-ce.width/2}, 0)`)}return se}r.htmlLabels||(s*=1.25,i*=1.25);let l=tr(t);l||(l="node default");const c=e.insert("g").attr("class",l).attr("id",t.domId||t.id),u=await a0(c,t.label??"",r,0,0,["name"],o);u.height+=i;let d=0;const h=[];let m=0,y=0,b=0,v=0,x=!0,w=!0;for(const ee of n.attributes){const se=await a0(c,ee.type,r,0,d,["attribute-type"],o);m=Math.max(m,se.width+s);const pe=await a0(c,ee.name,r,0,d,["attribute-name"],o);y=Math.max(y,pe.width+s);const ce=await a0(c,ee.keys.join(),r,0,d,["attribute-keys"],o);b=Math.max(b,ce.width+s);const Ie=await a0(c,ee.comment,r,0,d,["attribute-comment"],o);v=Math.max(v,Ie.width+s),d+=Math.max(se.height,pe.height,ce.height,Ie.height)+i,h.push(d)}h.pop();let S=4;b<=s&&(x=!1,b=0,S--),v<=s&&(w=!1,v=0,S--);const C=c.node().getBBox();if(u.width+s*2-(m+y+b+v)>0){const ee=u.width+s*2-(m+y+b+v);m+=ee/S,y+=ee/S,b>0&&(b+=ee/S),v>0&&(v+=ee/S)}const k=m+y+b+v,A=kn.svg(c),R=Tn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const N=Math.max(C.width+s*2,(t==null?void 0:t.width)||0,k),I=Math.max(C.height+(h[0]||d)+i,(t==null?void 0:t.height)||0),O=-N/2,L=-I/2;c.selectAll("g:not(:first-child)").each((ee,se,pe)=>{const ce=Kr(pe[se]),Ie=ce.attr("transform");let De=0,Se=0;if(Ie){const qe=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Ie);qe&&(De=parseFloat(qe[1]),Se=parseFloat(qe[2]),ce.attr("class").includes("attribute-name")?De+=m:ce.attr("class").includes("attribute-keys")?De+=m+y:ce.attr("class").includes("attribute-comment")&&(De+=m+y+b))}ce.attr("transform",`translate(${O+s/2+De}, ${Se+L+u.height+i/2})`)}),c.select(".name").attr("transform","translate("+-u.width/2+", "+(L+i/2)+")");const P=A.rectangle(O,L,N,I,R),V=c.insert(()=>P,":first-child").attr("style",a.join("")),{themeVariables:F}=Ro(),{rowEven:X,rowOdd:U,nodeBorder:H}=F;h.push(0);for(const[ee,se]of h.entries()){if(ee===0&&h.length>1)continue;const pe=ee%2===0&&se!==0,ce=A.rectangle(O,u.height+L+se,N,u.height,{...R,fill:pe?X:U,stroke:H});c.insert(()=>ce,"g.label").attr("style",a.join("")).attr("class",`row-rect-${ee%2===0?"even":"odd"}`)}let $=A.line(O,u.height+L,N+O,u.height+L,R);c.insert(()=>$).attr("class","divider"),$=A.line(m+O,u.height+L,m+O,I+L,R),c.insert(()=>$).attr("class","divider"),x&&($=A.line(m+y+O,u.height+L,m+y+O,I+L,R),c.insert(()=>$).attr("class","divider")),w&&($=A.line(m+y+b+O,u.height+L,m+y+b+O,I+L,R),c.insert(()=>$).attr("class","divider"));for(const ee of h)$=A.line(O,u.height+L+ee,N+O,u.height+L+ee,R),c.insert(()=>$).attr("class","divider");return Nn(t,V),t.intersect=function(ee){return _n.rect(t,ee)},c}ie(m6,"erBox");async function a0(e,t,n,r=0,s=0,i=[],a=""){const o=e.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${r}, ${s})`).attr("style",a);t!==o7(t)&&(t=o7(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));const l=o.node().appendChild(await Zh(o,t,{width:qd(t,n)+100,style:a,useHtmlLabels:n.htmlLabels},n));if(t.includes("&lt;")||t.includes("&gt;")){let u=l.children[0];for(u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");u.childNodes[0];)u=u.childNodes[0],u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let c=l.getBBox();if(Vi(n.htmlLabels)){const u=l.children[0];u.style.textAlign="start";const d=Kr(l);c=u.getBoundingClientRect(),d.attr("width",c.width),d.attr("height",c.height)}return c}ie(a0,"addText");async function wne(e,t,n,r,s=n.class.padding??12){const i=r?0:3,a=e.insert("g").attr("class",tr(t)).attr("id",t.domId||t.id);let o=null,l=null,c=null,u=null,d=0,h=0,m=0;if(o=a.insert("g").attr("class","annotation-group text"),t.annotations.length>0){const w=t.annotations[0];await Qv(o,{text:`${w}`},0),d=o.node().getBBox().height}l=a.insert("g").attr("class","label-group text"),await Qv(l,t,0,["font-weight: bolder"]);const y=l.node().getBBox();h=y.height,c=a.insert("g").attr("class","members-group text");let b=0;for(const w of t.members){const S=await Qv(c,w,b,[w.parseClassifier()]);b+=S+i}m=c.node().getBBox().height,m<=0&&(m=s/2),u=a.insert("g").attr("class","methods-group text");let v=0;for(const w of t.methods){const S=await Qv(u,w,v,[w.parseClassifier()]);v+=S+i}let x=a.node().getBBox();if(o!==null){const w=o.node().getBBox();o.attr("transform",`translate(${-w.width/2})`)}return l.attr("transform",`translate(${-y.width/2}, ${d})`),x=a.node().getBBox(),c.attr("transform",`translate(0, ${d+h+s*2})`),x=a.node().getBBox(),u.attr("transform",`translate(0, ${d+h+(m?m+s*4:s*2)})`),x=a.node().getBBox(),{shapeSvg:a,bbox:x}}ie(wne,"textHelper");async function Qv(e,t,n,r=[]){const s=e.insert("g").attr("class","label").attr("style",r.join("; ")),i=Ro();let a="useHtmlLabels"in t?t.useHtmlLabels:Vi(i.htmlLabels)??!0,o="";"text"in t?o=t.text:o=t.label,!a&&o.startsWith("\\")&&(o=o.substring(1)),yy(o)&&(a=!0);const l=await Zh(s,kD(qm(o)),{width:qd(o,i)+50,classes:"markdown-node-label",useHtmlLabels:a},i);let c,u=1;if(a){const d=l.children[0],h=Kr(l);u=d.innerHTML.split("<br>").length,d.innerHTML.includes("</math>")&&(u+=d.innerHTML.split("<mrow>").length-1);const m=d.getElementsByTagName("img");if(m){const y=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...m].map(b=>new Promise(v=>{function x(){var w;if(b.style.display="flex",b.style.flexDirection="column",y){const S=((w=i.fontSize)==null?void 0:w.toString())??window.getComputedStyle(document.body).fontSize,k=parseInt(S,10)*5+"px";b.style.minWidth=k,b.style.maxWidth=k}else b.style.width="100%";v(b)}ie(x,"setupImage"),setTimeout(()=>{b.complete&&x()}),b.addEventListener("error",x),b.addEventListener("load",x)})))}c=d.getBoundingClientRect(),h.attr("width",c.width),h.attr("height",c.height)}else{r.includes("font-weight: bolder")&&Kr(l).selectAll("tspan").attr("font-weight",""),u=l.children.length;const d=l.children[0];(l.textContent===""||l.textContent.includes("&gt"))&&(d.textContent=o[0]+o.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),o[1]===" "&&(d.textContent=d.textContent[0]+" "+d.textContent.substring(1))),d.textContent==="undefined"&&(d.textContent=""),c=l.getBBox()}return s.attr("transform","translate(0,"+(-c.height/(2*u)+n)+")"),c.height}ie(Qv,"addText");async function _ne(e,t){var I,O;const n=as(),r=n.class.padding??12,s=r,i=t.useHtmlLabels??Vi(n.htmlLabels)??!0,a=t;a.annotations=a.annotations??[],a.members=a.members??[],a.methods=a.methods??[];const{shapeSvg:o,bbox:l}=await wne(e,t,n,i,s),{labelStyles:c,nodeStyles:u}=Mn(t);t.labelStyle=c,t.cssStyles=a.styles||"";const d=((I=a.styles)==null?void 0:I.join(";"))||u||"";t.cssStyles||(t.cssStyles=d.replaceAll("!important","").split(";"));const h=a.members.length===0&&a.methods.length===0&&!((O=n.class)!=null&&O.hideEmptyMembersBox),m=kn.svg(o),y=Tn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=l.width;let v=l.height;a.members.length===0&&a.methods.length===0?v+=s:a.members.length>0&&a.methods.length===0&&(v+=s*2);const x=-b/2,w=-v/2,S=m.rectangle(x-r,w-r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0),b+2*r,v+2*r+(h?r*2:a.members.length===0&&a.methods.length===0?-r:0),y),C=o.insert(()=>S,":first-child");C.attr("class","basic label-container");const k=C.node().getBBox();o.selectAll(".text").each((L,P,V)=>{var ne;const F=Kr(V[P]),X=F.attr("transform");let U=0;if(X){const Q=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(X);Q&&(U=parseFloat(Q[2]))}let H=U+w+r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0);i||(H-=4);let $=x;(F.attr("class").includes("label-group")||F.attr("class").includes("annotation-group"))&&($=-((ne=F.node())==null?void 0:ne.getBBox().width)/2||0,o.selectAll("text").each(function(W,Q,ee){window.getComputedStyle(ee[Q]).textAnchor==="middle"&&($=0)})),F.attr("transform",`translate(${$}, ${H})`)});const A=o.select(".annotation-group").node().getBBox().height-(h?r/2:0)||0,R=o.select(".label-group").node().getBBox().height-(h?r/2:0)||0,N=o.select(".members-group").node().getBBox().height-(h?r/2:0)||0;if(a.members.length>0||a.methods.length>0||h){const L=m.line(k.x,A+R+w+r,k.x+k.width,A+R+w+r,y);o.insert(()=>L).attr("class","divider").attr("style",d)}if(h||a.members.length>0||a.methods.length>0){const L=m.line(k.x,A+R+N+w+s*2+r,k.x+k.width,A+R+N+w+r+s*2,y);o.insert(()=>L).attr("class","divider").attr("style",d)}if(a.look!=="handDrawn"&&o.selectAll("path").attr("style",d),C.select(":nth-child(2)").attr("style",d),o.selectAll(".divider").select("path").attr("style",d),t.labelStyle?o.selectAll("span").attr("style",t.labelStyle):o.selectAll("span").attr("style",d),!i){const L=RegExp(/color\s*:\s*([^;]*)/),P=L.exec(d);if(P){const V=P[0].replace("color","fill");o.selectAll("tspan").attr("style",V)}else if(c){const V=L.exec(c);if(V){const F=V[0].replace("color","fill");o.selectAll("tspan").attr("style",F)}}}return Nn(t,C),t.intersect=function(L){return _n.rect(t,L)},o}ie(_ne,"classBox");async function Sne(e,t){var A,R;const{labelStyles:n,nodeStyles:r}=Mn(t);t.labelStyle=n;const s=t,i=t,a=20,o=20,l="verifyMethod"in t,c=tr(t),u=e.insert("g").attr("class",c).attr("id",t.domId??t.id);let d;l?d=await Jc(u,`&lt;&lt;${s.type}&gt;&gt;`,0,t.labelStyle):d=await Jc(u,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let h=d;const m=await Jc(u,s.name,h,t.labelStyle+"; font-weight: bold;");if(h+=m+o,l){const N=await Jc(u,`${s.requirementId?`Id: ${s.requirementId}`:""}`,h,t.labelStyle);h+=N;const I=await Jc(u,`${s.text?`Text: ${s.text}`:""}`,h,t.labelStyle);h+=I;const O=await Jc(u,`${s.risk?`Risk: ${s.risk}`:""}`,h,t.labelStyle);h+=O,await Jc(u,`${s.verifyMethod?`Verification: ${s.verifyMethod}`:""}`,h,t.labelStyle)}else{const N=await Jc(u,`${i.type?`Type: ${i.type}`:""}`,h,t.labelStyle);h+=N,await Jc(u,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,h,t.labelStyle)}const y=(((A=u.node())==null?void 0:A.getBBox().width)??200)+a,b=(((R=u.node())==null?void 0:R.getBBox().height)??200)+a,v=-y/2,x=-b/2,w=kn.svg(u),S=Tn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const C=w.rectangle(v,x,y,b,S),k=u.insert(()=>C,":first-child");if(k.attr("class","basic label-container").attr("style",r),u.selectAll(".label").each((N,I,O)=>{const L=Kr(O[I]),P=L.attr("transform");let V=0,F=0;if(P){const $=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(P);$&&(V=parseFloat($[1]),F=parseFloat($[2]))}const X=F-b/2;let U=v+a/2;(I===0||I===1)&&(U=V),L.attr("transform",`translate(${U}, ${X+a})`)}),h>d+m+o){const N=w.line(v,x+d+m+o,v+y,x+d+m+o,S);u.insert(()=>N).attr("style",r)}return Nn(t,k),t.intersect=function(N){return _n.rect(t,N)},u}ie(Sne,"requirementBox");async function Jc(e,t,n,r=""){if(t==="")return 0;const s=e.insert("g").attr("class","label").attr("style",r),i=as(),a=i.htmlLabels??!0,o=await Zh(s,kD(qm(t)),{width:qd(t,i)+50,classes:"markdown-node-label",useHtmlLabels:a,style:r},i);let l;if(a){const c=o.children[0],u=Kr(o);l=c.getBoundingClientRect(),u.attr("width",l.width),u.attr("height",l.height)}else{const c=o.children[0];for(const u of c.children)u.textContent=u.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),r&&u.setAttribute("style",r);l=o.getBBox(),l.height+=6}return s.attr("transform",`translate(${-l.width/2},${-l.height/2+n})`),l.height}ie(Jc,"addText");var z8e=ie(e=>{switch(e){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function Cne(e,t,{config:n}){var P,V;const{labelStyles:r,nodeStyles:s}=Mn(t);t.labelStyle=r||"";const i=10,a=t.width;t.width=(t.width??200)-10;const{shapeSvg:o,bbox:l,label:c}=await ur(e,t,tr(t)),u=t.padding||10;let d="",h;"ticket"in t&&t.ticket&&((P=n==null?void 0:n.kanban)!=null&&P.ticketBaseUrl)&&(d=(V=n==null?void 0:n.kanban)==null?void 0:V.ticketBaseUrl.replace("#TICKET#",t.ticket),h=o.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",d).attr("target","_blank"));const m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1};let y,b;h?{label:y,bbox:b}=await MI(h,"ticket"in t&&t.ticket||"",m):{label:y,bbox:b}=await MI(o,"ticket"in t&&t.ticket||"",m);const{label:v,bbox:x}=await MI(o,"assigned"in t&&t.assigned||"",m);t.width=a;const w=10,S=(t==null?void 0:t.width)||0,C=Math.max(b.height,x.height)/2,k=Math.max(l.height+w*2,(t==null?void 0:t.height)||0)+C,A=-S/2,R=-k/2;c.attr("transform","translate("+(u-S/2)+", "+(-C-l.height/2)+")"),y.attr("transform","translate("+(u-S/2)+", "+(-C+l.height/2)+")"),v.attr("transform","translate("+(u+S/2-x.width-2*i)+", "+(-C+l.height/2)+")");let N;const{rx:I,ry:O}=t,{cssStyles:L}=t;if(t.look==="handDrawn"){const F=kn.svg(o),X=Tn(t,{}),U=I||O?F.path(rf(A,R,S,k,I||0),X):F.rectangle(A,R,S,k,X);N=o.insert(()=>U,":first-child"),N.attr("class","basic label-container").attr("style",L||null)}else{N=o.insert("rect",":first-child"),N.attr("class","basic label-container __APA__").attr("style",s).attr("rx",I??5).attr("ry",O??5).attr("x",A).attr("y",R).attr("width",S).attr("height",k);const F="priority"in t&&t.priority;if(F){const X=o.append("line"),U=A+2,H=R+Math.floor((I??0)/2),$=R+k-Math.floor((I??0)/2);X.attr("x1",U).attr("y1",H).attr("x2",U).attr("y2",$).attr("stroke-width","4").attr("stroke",z8e(F))}}return Nn(t,N),t.height=k,t.intersect=function(F){return _n.rect(t,F)},o}ie(Cne,"kanbanItem");var U8e=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:ine},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:nne},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:ane},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:une},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:Rte},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:_te},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Qte},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:Dte},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:Hte},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:Wte},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:mne},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:qte},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:Mte},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:hne},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:xte},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:rne},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:cne},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:lne},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:Ote},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:Fte},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:kte},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:Ete},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:Tte},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Gte},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:bne},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:Pte},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:pne},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:Kte},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:Ate},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:Nte},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:yne},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:xne},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:Ite},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:gne},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:jte},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:sne},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Xte},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Zte},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:vte},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:Cte},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:fne},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:dne},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:vne},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:ene},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Yte}],q8e=ie(()=>{const t=[...Object.entries({state:one,choice:wte,note:Jte,rectWithTitle:tne,labelRect:Vte,iconSquare:zte,iconCircle:Bte,icon:Lte,iconRounded:$te,imageSquare:Ute,anchor:bte,kanbanItem:Cne,classBox:_ne,erBox:m6,requirementBox:Sne}),...U8e.flatMap(n=>[n.shortName,..."aliases"in n?n.aliases:[],..."internalAliases"in n?n.internalAliases:[]].map(s=>[s,n.handler]))];return Object.fromEntries(t)},"generateShapeMap"),kne=q8e();function V8e(e){return e in kne}ie(V8e,"isValidShape");var NT=new Map;async function Ene(e,t,n){let r,s;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");const i=t.shape?kne[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let a;n.config.securityLevel==="sandbox"?a="_top":t.linkTarget&&(a=t.linkTarget||"_blank"),r=e.insert("svg:a").attr("xlink:href",t.link).attr("target",a??null),s=await i(r,t,n)}else s=await i(e,t,n),r=s;return t.tooltip&&s.attr("title",t.tooltip),NT.set(t.id,r),t.haveCallback&&r.attr("class",r.attr("class")+" clickable"),r}ie(Ene,"insertNode");var Xut=ie((e,t)=>{NT.set(t.id,e)},"setNodeElem"),Jut=ie(()=>{NT.clear()},"clear"),Qut=ie(e=>{const t=NT.get(e.id);zt.trace("Transforming node",e.diff,e,"translate("+(e.x-e.width/2-5)+", "+e.width/2+")");const n=8,r=e.diff||0;return e.clusterNode?t.attr("transform","translate("+(e.x+r-e.width/2)+", "+(e.y-e.height/2-n)+")"):t.attr("transform","translate("+e.x+", "+e.y+")"),r},"positionNode"),W8e=ie((e,t,n,r,s,i)=>{t.arrowTypeStart&&hU(e,"start",t.arrowTypeStart,n,r,s,i),t.arrowTypeEnd&&hU(e,"end",t.arrowTypeEnd,n,r,s,i)},"addEdgeMarkers"),H8e={arrow_cross:{type:"cross",fill:!1},arrow_point:{type:"point",fill:!0},arrow_barb:{type:"barb",fill:!0},arrow_circle:{type:"circle",fill:!1},aggregation:{type:"aggregation",fill:!1},extension:{type:"extension",fill:!1},composition:{type:"composition",fill:!0},dependency:{type:"dependency",fill:!0},lollipop:{type:"lollipop",fill:!1},only_one:{type:"onlyOne",fill:!1},zero_or_one:{type:"zeroOrOne",fill:!1},one_or_more:{type:"oneOrMore",fill:!1},zero_or_more:{type:"zeroOrMore",fill:!1},requirement_arrow:{type:"requirement_arrow",fill:!1},requirement_contains:{type:"requirement_contains",fill:!1}},hU=ie((e,t,n,r,s,i,a)=>{var d;const o=H8e[n];if(!o){zt.warn(`Unknown arrow type: ${n}`);return}const l=o.type,u=`${s}_${i}-${l}${t==="start"?"Start":"End"}`;if(a&&a.trim()!==""){const h=a.replace(/[^\dA-Za-z]/g,"_"),m=`${u}_${h}`;if(!document.getElementById(m)){const y=document.getElementById(u);if(y){const b=y.cloneNode(!0);b.id=m,b.querySelectorAll("path, circle, line").forEach(x=>{x.setAttribute("stroke",a),o.fill&&x.setAttribute("fill",a)}),(d=y.parentNode)==null||d.appendChild(b)}}e.attr(`marker-${t}`,`url(${r}#${m})`)}else e.attr(`marker-${t}`,`url(${r}#${u})`)},"addEdgeMarker"),jk=new Map,ga=new Map,edt=ie(()=>{jk.clear(),ga.clear()},"clear"),Uv=ie(e=>e?e.reduce((n,r)=>n+";"+r,""):"","getLabelStyles"),G8e=ie(async(e,t)=>{let n=Vi(as().flowchart.htmlLabels);const r=await Zh(e,t.label,{style:Uv(t.labelStyle),useHtmlLabels:n,addSvgBackground:!0,isNode:!1});zt.info("abc82",t,t.labelType);const s=e.insert("g").attr("class","edgeLabel"),i=s.insert("g").attr("class","label");i.node().appendChild(r);let a=r.getBBox();if(n){const l=r.children[0],c=Kr(r);a=l.getBoundingClientRect(),c.attr("width",a.width),c.attr("height",a.height)}i.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),jk.set(t.id,s),t.width=a.width,t.height=a.height;let o;if(t.startLabelLeft){const l=await Kp(t.startLabelLeft,Uv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ga.get(t.id)||ga.set(t.id,{}),ga.get(t.id).startLeft=c,ex(o,t.startLabelLeft)}if(t.startLabelRight){const l=await Kp(t.startLabelRight,Uv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=c.node().appendChild(l),u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ga.get(t.id)||ga.set(t.id,{}),ga.get(t.id).startRight=c,ex(o,t.startLabelRight)}if(t.endLabelLeft){const l=await Kp(t.endLabelLeft,Uv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ga.get(t.id)||ga.set(t.id,{}),ga.get(t.id).endLeft=c,ex(o,t.endLabelLeft)}if(t.endLabelRight){const l=await Kp(t.endLabelRight,Uv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ga.get(t.id)||ga.set(t.id,{}),ga.get(t.id).endRight=c,ex(o,t.endLabelRight)}return r},"insertEdgeLabel");function ex(e,t){as().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+"px",e.style.height="12px")}ie(ex,"setTerminalWidth");var K8e=ie((e,t)=>{zt.debug("Moving label abc88 ",e.id,e.label,jk.get(e.id),t);let n=t.updatedPath?t.updatedPath:t.originalPath;const r=as(),{subGraphTitleTotalMargin:s}=jD(r);if(e.label){const i=jk.get(e.id);let a=e.x,o=e.y;if(n){const l=lu.calcLabelPosition(n);zt.debug("Moving label "+e.label+" from (",a,",",o,") to (",l.x,",",l.y,") abc88"),t.updatedPath&&(a=l.x,o=l.y)}i.attr("transform",`translate(${a}, ${o+s/2})`)}if(e.startLabelLeft){const i=ga.get(e.id).startLeft;let a=e.x,o=e.y;if(n){const l=lu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.startLabelRight){const i=ga.get(e.id).startRight;let a=e.x,o=e.y;if(n){const l=lu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelLeft){const i=ga.get(e.id).endLeft;let a=e.x,o=e.y;if(n){const l=lu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelRight){const i=ga.get(e.id).endRight;let a=e.x,o=e.y;if(n){const l=lu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}},"positionEdgeLabel"),Y8e=ie((e,t)=>{const n=e.x,r=e.y,s=Math.abs(t.x-n),i=Math.abs(t.y-r),a=e.width/2,o=e.height/2;return s>=a||i>=o},"outsideNode"),Z8e=ie((e,t,n)=>{zt.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);const r=e.x,s=e.y,i=Math.abs(r-n.x),a=e.width/2;let o=n.x<t.x?a-i:a+i;const l=e.height/2,c=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(s-t.y)*a>Math.abs(r-t.x)*l){let d=n.y<t.y?t.y-l-s:s-l-t.y;o=u*d/c;const h={x:n.x<t.x?n.x+o:n.x-u+o,y:n.y<t.y?n.y+c-d:n.y-c+d};return o===0&&(h.x=t.x,h.y=t.y),u===0&&(h.x=t.x),c===0&&(h.y=t.y),zt.debug(`abc89 top/bottom calc, Q ${c}, q ${d}, R ${u}, r ${o}`,h),h}else{n.x<t.x?o=t.x-a-r:o=r-a-t.x;let d=c*o/u,h=n.x<t.x?n.x+u-o:n.x-u+o,m=n.y<t.y?n.y+d:n.y-d;return zt.debug(`sides calc abc89, Q ${c}, q ${d}, R ${u}, r ${o}`,{_x:h,_y:m}),o===0&&(h=t.x,m=t.y),u===0&&(h=t.x),c===0&&(m=t.y),{x:h,y:m}}},"intersection"),pU=ie((e,t)=>{zt.warn("abc88 cutPathAtIntersect",e,t);let n=[],r=e[0],s=!1;return e.forEach(i=>{if(zt.info("abc88 checking point",i,t),!Y8e(t,i)&&!s){const a=Z8e(t,r,i);zt.debug("abc88 inside",i,r,a),zt.debug("abc88 intersection",a,t);let o=!1;n.forEach(l=>{o=o||l.x===a.x&&l.y===a.y}),n.some(l=>l.x===a.x&&l.y===a.y)?zt.warn("abc88 no intersect",a,n):n.push(a),s=!0}else zt.warn("abc88 outside",i,r),r=i,s||n.push(i)}),zt.debug("returning points",n),n},"cutPathAtIntersect");function Tne(e){const t=[],n=[];for(let r=1;r<e.length-1;r++){const s=e[r-1],i=e[r],a=e[r+1];(s.x===i.x&&i.y===a.y&&Math.abs(i.x-a.x)>5&&Math.abs(i.y-s.y)>5||s.y===i.y&&i.x===a.x&&Math.abs(i.x-s.x)>5&&Math.abs(i.y-a.y)>5)&&(t.push(i),n.push(r))}return{cornerPoints:t,cornerPointPositions:n}}ie(Tne,"extractCornerPoints");var mU=ie(function(e,t,n){const r=t.x-e.x,s=t.y-e.y,i=Math.sqrt(r*r+s*s),a=n/i;return{x:t.x-a*r,y:t.y-a*s}},"findAdjacentPoint"),X8e=ie(function(e){const{cornerPointPositions:t}=Tne(e),n=[];for(let r=0;r<e.length;r++)if(t.includes(r)){const s=e[r-1],i=e[r+1],a=e[r],o=mU(s,a,5),l=mU(i,a,5),c=l.x-o.x,u=l.y-o.y;n.push(o);const d=Math.sqrt(2)*2;let h={x:a.x,y:a.y};if(Math.abs(i.x-s.x)>10&&Math.abs(i.y-s.y)>=10){zt.debug("Corner point fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));const m=5;a.x===o.x?h={x:c<0?o.x-m+d:o.x+m-d,y:u<0?o.y-d:o.y+d}:h={x:c<0?o.x-d:o.x+d,y:u<0?o.y-m+d:o.y+m-d}}else zt.debug("Corner point skipping fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));n.push(h,l)}else n.push(e[r]);return n},"fixCorners"),J8e=ie(function(e,t,n,r,s,i,a){var I;const{handDrawnSeed:o}=as();let l=t.points,c=!1;const u=s;var d=i;const h=[];for(const O in t.cssCompiledStyles)cte(O)||h.push(t.cssCompiledStyles[O]);d.intersect&&u.intersect&&(l=l.slice(1,t.points.length-1),l.unshift(u.intersect(l[0])),zt.debug("Last point APA12",t.start,"-->",t.end,l[l.length-1],d,d.intersect(l[l.length-1])),l.push(d.intersect(l[l.length-1]))),t.toCluster&&(zt.info("to cluster abc88",n.get(t.toCluster)),l=pU(t.points,n.get(t.toCluster).node),c=!0),t.fromCluster&&(zt.debug("from cluster abc88",n.get(t.fromCluster),JSON.stringify(l,null,2)),l=pU(l.reverse(),n.get(t.fromCluster).node).reverse(),c=!0);let m=l.filter(O=>!Number.isNaN(O.y));m=X8e(m);let y=F2;switch(y=yk,t.curve){case"linear":y=yk;break;case"basis":y=F2;break;case"cardinal":y=ZQ;break;case"bumpX":y=WQ;break;case"bumpY":y=HQ;break;case"catmullRom":y=JQ;break;case"monotoneX":y=see;break;case"monotoneY":y=iee;break;case"natural":y=oee;break;case"step":y=lee;break;case"stepAfter":y=uee;break;case"stepBefore":y=cee;break;default:y=F2}const{x:b,y:v}=wje(t),x=mDe().x(b).y(v).curve(y);let w;switch(t.thickness){case"normal":w="edge-thickness-normal";break;case"thick":w="edge-thickness-thick";break;case"invisible":w="edge-thickness-invisible";break;default:w="edge-thickness-normal"}switch(t.pattern){case"solid":w+=" edge-pattern-solid";break;case"dotted":w+=" edge-pattern-dotted";break;case"dashed":w+=" edge-pattern-dashed";break;default:w+=" edge-pattern-solid"}let S,C=x(m);const k=Array.isArray(t.style)?t.style:[t.style];let A=k.find(O=>O==null?void 0:O.startsWith("stroke:"));if(t.look==="handDrawn"){const O=kn.svg(e);Object.assign([],m);const L=O.path(C,{roughness:.3,seed:o});w+=" transition",S=Kr(L).select("path").attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")).attr("style",k?k.reduce((V,F)=>V+";"+F,""):"");let P=S.attr("d");S.attr("d",P),e.node().appendChild(S.node())}else{const O=h.join(";"),L=k?k.reduce((F,X)=>F+X+";",""):"";let P="";t.animate&&(P=" edge-animation-fast"),t.animation&&(P=" edge-animation-"+t.animation);const V=O?O+";"+L+";":L;S=e.append("path").attr("d",C).attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")+(P??"")).attr("style",V),A=(I=V.match(/stroke:([^;]+)/))==null?void 0:I[1]}let R="";(as().flowchart.arrowMarkerAbsolute||as().state.arrowMarkerAbsolute)&&(R=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,R=R.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),zt.info("arrowTypeStart",t.arrowTypeStart),zt.info("arrowTypeEnd",t.arrowTypeEnd),W8e(S,t,R,a,r,A);let N={};return c&&(N.updatedPath=l),N.originalPath=t.points,N},"insertEdge"),Q8e=ie((e,t,n,r)=>{t.forEach(s=>{mLe[s](e,n,r)})},"insertMarkers"),eLe=ie((e,t,n)=>{zt.trace("Making markers for ",n),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),tLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),nLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),rLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),sLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),iLe=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),aLe=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),oLe=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),lLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),cLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneStart").attr("class","marker onlyOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M9,0 L9,18 M15,0 L15,18"),e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneEnd").attr("class","marker onlyOne "+t).attr("refX",18).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M3,0 L3,18 M9,0 L9,18")},"only_one"),uLe=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneStart").attr("class","marker zeroOrOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",21).attr("cy",9).attr("r",6),r.append("path").attr("d","M9,0 L9,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneEnd").attr("class","marker zeroOrOne "+t).attr("refX",30).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",9).attr("r",6),s.append("path").attr("d","M21,0 L21,18")},"zero_or_one"),dLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreStart").attr("class","marker oneOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27"),e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreEnd").attr("class","marker oneOrMore "+t).attr("refX",27).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18")},"one_or_more"),fLe=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreStart").attr("class","marker zeroOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",48).attr("cy",18).attr("r",6),r.append("path").attr("d","M0,18 Q18,0 36,18 Q18,36 0,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreEnd").attr("class","marker zeroOrMore "+t).attr("refX",39).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",18).attr("r",6),s.append("path").attr("d","M21,18 Q39,0 57,18 Q39,36 21,18")},"zero_or_more"),hLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_arrowEnd").attr("refX",20).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d",`M0,0
      L20,10
      M20,10
      L0,20`)},"requirement_arrow"),pLe=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_containsStart").attr("refX",0).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("g");r.append("circle").attr("cx",10).attr("cy",10).attr("r",9).attr("fill","none"),r.append("line").attr("x1",1).attr("x2",19).attr("y1",10).attr("y2",10),r.append("line").attr("y1",1).attr("y2",19).attr("x1",10).attr("x2",10)},"requirement_contains"),mLe={extension:eLe,composition:tLe,aggregation:nLe,dependency:rLe,lollipop:sLe,point:iLe,circle:aLe,cross:oLe,barb:lLe,only_one:cLe,zero_or_one:uLe,one_or_more:dLe,zero_or_more:fLe,requirement_arrow:hLe,requirement_contains:pLe},gLe=Q8e,yLe={common:Qy,getConfig:Ro,insertCluster:k8e,insertEdge:J8e,insertEdgeLabel:G8e,insertMarkers:gLe,insertNode:Ene,interpolateToCurve:ZD,labelHelper:ur,log:zt,positionEdgeLabel:K8e},Aw={},Ane=ie(e=>{for(const t of e)Aw[t.name]=t},"registerLayoutLoaders"),bLe=ie(()=>{Ane([{name:"dagre",loader:ie(async()=>await Zr(()=>import("./dagre-OKDRZEBW-ygFLMWkS.js"),__vite__mapDeps([0,1,2,3,4,5])),"loader")}])},"registerDefaultLayoutLoaders");bLe();var tdt=ie(async(e,t)=>{if(!(e.layoutAlgorithm in Aw))throw new Error(`Unknown layout algorithm: ${e.layoutAlgorithm}`);const n=Aw[e.layoutAlgorithm];return(await n.loader()).render(e,t,yLe,{algorithm:n.algorithm})},"render"),ndt=ie((e="",{fallback:t="dagre"}={})=>{if(e in Aw)return e;if(t in Aw)return zt.warn(`Layout algorithm ${e} is not registered. Using ${t} as fallback.`),t;throw new Error(`Both layout algorithms ${e} and ${t} are not registered.`)},"getRegisteredLayoutAlgorithm"),gU={name:"mermaid",version:"11.6.0",description:"Markdown-ish syntax for generating flowcharts, mindmaps, sequence diagrams, class diagrams, gantt charts, git graphs and more.",type:"module",module:"./dist/mermaid.core.mjs",types:"./dist/mermaid.d.ts",exports:{".":{types:"./dist/mermaid.d.ts",import:"./dist/mermaid.core.mjs",default:"./dist/mermaid.core.mjs"},"./*":"./*"},keywords:["diagram","markdown","flowchart","sequence diagram","gantt","class diagram","git graph","mindmap","packet diagram","c4 diagram","er diagram","pie chart","pie diagram","quadrant chart","requirement diagram","graph"],scripts:{clean:"rimraf dist",dev:"pnpm -w dev","docs:code":"typedoc src/defaultConfig.ts src/config.ts src/mermaid.ts && prettier --write ./src/docs/config/setup","docs:build":"rimraf ../../docs && pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts","docs:verify":"pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts --verify","docs:pre:vitepress":"pnpm --filter ./src/docs prefetch && rimraf src/vitepress && pnpm docs:code && tsx scripts/docs.cli.mts --vitepress && pnpm --filter ./src/vitepress install --no-frozen-lockfile --ignore-scripts","docs:build:vitepress":"pnpm docs:pre:vitepress && (cd src/vitepress && pnpm run build) && cpy --flat src/docs/landing/ ./src/vitepress/.vitepress/dist/landing","docs:dev":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:dev:docker":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev:docker" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:serve":"pnpm docs:build:vitepress && vitepress serve src/vitepress","docs:spellcheck":'cspell "src/docs/**/*.md"',"docs:release-version":"tsx scripts/update-release-version.mts","docs:verify-version":"tsx scripts/update-release-version.mts --verify","types:build-config":"tsx scripts/create-types-from-json-schema.mts","types:verify-config":"tsx scripts/create-types-from-json-schema.mts --verify",checkCircle:"npx madge --circular ./src",prepublishOnly:"pnpm docs:verify-version"},repository:{type:"git",url:"https://github.com/mermaid-js/mermaid"},author:"Knut Sveidqvist",license:"MIT",standard:{ignore:["**/parser/*.js","dist/**/*.js","cypress/**/*.js"],globals:["page"]},dependencies:{"@braintree/sanitize-url":"^7.0.4","@iconify/utils":"^2.1.33","@mermaid-js/parser":"workspace:^","@types/d3":"^7.4.3",cytoscape:"^3.29.3","cytoscape-cose-bilkent":"^4.1.0","cytoscape-fcose":"^2.2.0",d3:"^7.9.0","d3-sankey":"^0.12.3","dagre-d3-es":"7.0.11",dayjs:"^1.11.13",dompurify:"^3.2.4",katex:"^0.16.9",khroma:"^2.1.0","lodash-es":"^4.17.21",marked:"^15.0.7",roughjs:"^4.6.6",stylis:"^4.3.6","ts-dedent":"^2.2.0",uuid:"^11.1.0"},devDependencies:{"@adobe/jsonschema2md":"^8.0.2","@iconify/types":"^2.0.0","@types/cytoscape":"^3.21.9","@types/cytoscape-fcose":"^2.2.4","@types/d3-sankey":"^0.12.4","@types/d3-scale":"^4.0.9","@types/d3-scale-chromatic":"^3.1.0","@types/d3-selection":"^3.0.11","@types/d3-shape":"^3.1.7","@types/jsdom":"^21.1.7","@types/katex":"^0.16.7","@types/lodash-es":"^4.17.12","@types/micromatch":"^4.0.9","@types/stylis":"^4.2.7","@types/uuid":"^10.0.0",ajv:"^8.17.1",chokidar:"^4.0.3",concurrently:"^9.1.2","csstree-validator":"^4.0.1",globby:"^14.0.2",jison:"^0.4.18","js-base64":"^3.7.7",jsdom:"^26.0.0","json-schema-to-typescript":"^15.0.4",micromatch:"^4.0.8","path-browserify":"^1.0.1",prettier:"^3.5.2",remark:"^15.0.1","remark-frontmatter":"^5.0.0","remark-gfm":"^4.0.1",rimraf:"^6.0.1","start-server-and-test":"^2.0.10","type-fest":"^4.35.0",typedoc:"^0.27.8","typedoc-plugin-markdown":"^4.4.2",typescript:"~5.7.3","unist-util-flatmap":"^1.0.0","unist-util-visit":"^5.0.0",vitepress:"^1.0.2","vitepress-plugin-search":"1.0.4-alpha.22"},files:["dist/","README.md"],publishConfig:{access:"public"}},vLe=ie(e=>{var s;const{securityLevel:t}=as();let n=Kr("body");if(t==="sandbox"){const a=((s=Kr(`#i${e}`).node())==null?void 0:s.contentDocument)??document;n=Kr(a.body)}return n.select(`#${e}`)},"selectSvgElement"),Rne="comm",Nne="rule",Mne="decl",xLe="@import",wLe="@namespace",_Le="@keyframes",SLe="@layer",Ine=Math.abs,g6=String.fromCharCode;function jne(e){return e.trim()}function z2(e,t,n){return e.replace(t,n)}function CLe(e,t,n){return e.indexOf(t,n)}function R0(e,t){return e.charCodeAt(t)|0}function _y(e,t,n){return e.slice(t,n)}function su(e){return e.length}function kLe(e){return e.length}function ZS(e,t){return t.push(e),e}var MT=1,Sy=1,One=0,Wl=0,Ri=0,sb="";function y6(e,t,n,r,s,i,a,o){return{value:e,root:t,parent:n,type:r,props:s,children:i,line:MT,column:Sy,length:a,return:"",siblings:o}}function ELe(){return Ri}function TLe(){return Ri=Wl>0?R0(sb,--Wl):0,Sy--,Ri===10&&(Sy=1,MT--),Ri}function wc(){return Ri=Wl<One?R0(sb,Wl++):0,Sy++,Ri===10&&(Sy=1,MT++),Ri}function ch(){return R0(sb,Wl)}function U2(){return Wl}function IT(e,t){return _y(sb,e,t)}function Rw(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ALe(e){return MT=Sy=1,One=su(sb=e),Wl=0,[]}function RLe(e){return sb="",e}function II(e){return jne(IT(Wl-1,x4(e===91?e+2:e===40?e+1:e)))}function NLe(e){for(;(Ri=ch())&&Ri<33;)wc();return Rw(e)>2||Rw(Ri)>3?"":" "}function MLe(e,t){for(;--t&&wc()&&!(Ri<48||Ri>102||Ri>57&&Ri<65||Ri>70&&Ri<97););return IT(e,U2()+(t<6&&ch()==32&&wc()==32))}function x4(e){for(;wc();)switch(Ri){case e:return Wl;case 34:case 39:e!==34&&e!==39&&x4(Ri);break;case 40:e===41&&x4(e);break;case 92:wc();break}return Wl}function ILe(e,t){for(;wc()&&e+Ri!==57;)if(e+Ri===84&&ch()===47)break;return"/*"+IT(t,Wl-1)+"*"+g6(e===47?e:wc())}function jLe(e){for(;!Rw(ch());)wc();return IT(e,Wl)}function OLe(e){return RLe(q2("",null,null,null,[""],e=ALe(e),0,[0],e))}function q2(e,t,n,r,s,i,a,o,l){for(var c=0,u=0,d=a,h=0,m=0,y=0,b=1,v=1,x=1,w=0,S="",C=s,k=i,A=r,R=S;v;)switch(y=w,w=wc()){case 40:if(y!=108&&R0(R,d-1)==58){CLe(R+=z2(II(w),"&","&\f"),"&\f",Ine(c?o[c-1]:0))!=-1&&(x=-1);break}case 34:case 39:case 91:R+=II(w);break;case 9:case 10:case 13:case 32:R+=NLe(y);break;case 92:R+=MLe(U2()-1,7);continue;case 47:switch(ch()){case 42:case 47:ZS(PLe(ILe(wc(),U2()),t,n,l),l),(Rw(y||1)==5||Rw(ch()||1)==5)&&su(R)&&_y(R,-1,void 0)!==" "&&(R+=" ");break;default:R+="/"}break;case 123*b:o[c++]=su(R)*x;case 125*b:case 59:case 0:switch(w){case 0:case 125:v=0;case 59+u:x==-1&&(R=z2(R,/\f/g,"")),m>0&&(su(R)-d||b===0&&y===47)&&ZS(m>32?bU(R+";",r,n,d-1,l):bU(z2(R," ","")+";",r,n,d-2,l),l);break;case 59:R+=";";default:if(ZS(A=yU(R,t,n,c,u,s,o,S,C=[],k=[],d,i),i),w===123)if(u===0)q2(R,t,A,A,C,i,d,o,k);else{switch(h){case 99:if(R0(R,3)===110)break;case 108:if(R0(R,2)===97)break;default:u=0;case 100:case 109:case 115:}u?q2(e,A,A,r&&ZS(yU(e,A,A,0,0,s,o,S,s,C=[],d,k),k),s,k,d,o,r?C:k):q2(R,A,A,A,[""],k,0,o,k)}}c=u=m=0,b=x=1,S=R="",d=a;break;case 58:d=1+su(R),m=y;default:if(b<1){if(w==123)--b;else if(w==125&&b++==0&&TLe()==125)continue}switch(R+=g6(w),w*b){case 38:x=u>0?1:(R+="\f",-1);break;case 44:o[c++]=(su(R)-1)*x,x=1;break;case 64:ch()===45&&(R+=II(wc())),h=ch(),u=d=su(S=R+=jLe(U2())),w++;break;case 45:y===45&&su(R)==2&&(b=0)}}return i}function yU(e,t,n,r,s,i,a,o,l,c,u,d){for(var h=s-1,m=s===0?i:[""],y=kLe(m),b=0,v=0,x=0;b<r;++b)for(var w=0,S=_y(e,h+1,h=Ine(v=a[b])),C=e;w<y;++w)(C=jne(v>0?m[w]+" "+S:z2(S,/&\f/g,m[w])))&&(l[x++]=C);return y6(e,t,n,s===0?Nne:o,l,c,u,d)}function PLe(e,t,n,r){return y6(e,t,n,Rne,g6(ELe()),_y(e,2,-2),0,r)}function bU(e,t,n,r,s){return y6(e,t,n,Mne,_y(e,0,r),_y(e,r+1,-1),r,s)}function w4(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function DLe(e,t,n,r){switch(e.type){case SLe:if(e.children.length)break;case xLe:case wLe:case Mne:return e.return=e.return||e.value;case Rne:return"";case _Le:return e.return=e.value+"{"+w4(e.children,r)+"}";case Nne:if(!su(e.value=e.props.join(",")))return""}return su(n=w4(e.children,r))?e.return=e.value+"{"+n+"}":""}var FLe=pee(Object.keys,Object),LLe=Object.prototype,BLe=LLe.hasOwnProperty;function $Le(e){if(!_T(e))return FLe(e);var t=[];for(var n in Object(e))BLe.call(e,n)&&n!="constructor"&&t.push(n);return t}var _4=Um(Du,"DataView"),S4=Um(Du,"Promise"),C4=Um(Du,"Set"),k4=Um(Du,"WeakMap"),vU="[object Map]",zLe="[object Object]",xU="[object Promise]",wU="[object Set]",_U="[object WeakMap]",SU="[object DataView]",ULe=zm(_4),qLe=zm(Tw),VLe=zm(S4),WLe=zm(C4),HLe=zm(k4),Dp=eb;(_4&&Dp(new _4(new ArrayBuffer(1)))!=SU||Tw&&Dp(new Tw)!=vU||S4&&Dp(S4.resolve())!=xU||C4&&Dp(new C4)!=wU||k4&&Dp(new k4)!=_U)&&(Dp=function(e){var t=eb(e),n=t==zLe?e.constructor:void 0,r=n?zm(n):"";if(r)switch(r){case ULe:return SU;case qLe:return vU;case VLe:return xU;case WLe:return wU;case HLe:return _U}return t});var GLe="[object Map]",KLe="[object Set]",YLe=Object.prototype,ZLe=YLe.hasOwnProperty;function CU(e){if(e==null)return!0;if(ST(e)&&(Ck(e)||typeof e=="string"||typeof e.splice=="function"||KD(e)||YD(e)||Sk(e)))return!e.length;var t=Dp(e);if(t==GLe||t==KLe)return!e.size;if(_T(e))return!$Le(e).length;for(var n in e)if(ZLe.call(e,n))return!1;return!0}var Pne="c4",XLe=ie(e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),"detector"),JLe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./c4Diagram-VJAJSXHY-C0JHu5Bn.js");return{diagram:t}},__vite__mapDeps([6,7]));return{id:Pne,diagram:e}},"loader"),QLe={id:Pne,detector:XLe,loader:JLe},eBe=QLe,Dne="flowchart",tBe=ie((e,t)=>{var n,r;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-wrapper"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},"detector"),nBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-DjWeIkqx.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Dne,diagram:e}},"loader"),rBe={id:Dne,detector:tBe,loader:nBe},sBe=rBe,Fne="flowchart-v2",iBe=ie((e,t)=>{var n,r,s;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-d3"?!1:(((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"&&(t.layout="elk"),/^\s*graph/.test(e)&&((s=t==null?void 0:t.flowchart)==null?void 0:s.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e))},"detector"),aBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-DjWeIkqx.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Fne,diagram:e}},"loader"),oBe={id:Fne,detector:iBe,loader:aBe},lBe=oBe,Lne="er",cBe=ie(e=>/^\s*erDiagram/.test(e),"detector"),uBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./erDiagram-Q7BY3M3F-CqvZTxw-.js");return{diagram:t}},__vite__mapDeps([11,9,10]));return{id:Lne,diagram:e}},"loader"),dBe={id:Lne,detector:cBe,loader:uBe},fBe=dBe,Bne="gitGraph",hBe=ie(e=>/^\s*gitGraph/.test(e),"detector"),pBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./gitGraphDiagram-7IBYFJ6S-CrOS15ap.js");return{diagram:t}},__vite__mapDeps([12,13,14,15,2,4,5]));return{id:Bne,diagram:e}},"loader"),mBe={id:Bne,detector:hBe,loader:pBe},gBe=mBe,$ne="gantt",yBe=ie(e=>/^\s*gantt/.test(e),"detector"),bBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./ganttDiagram-APWFNJXF-BtdPMneH.js");return{diagram:t}},__vite__mapDeps([16,17,18]));return{id:$ne,diagram:e}},"loader"),vBe={id:$ne,detector:yBe,loader:bBe},xBe=vBe,zne="info",wBe=ie(e=>/^\s*info/.test(e),"detector"),_Be=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./infoDiagram-PH2N3AL5-B94h_lQz.js");return{diagram:t}},__vite__mapDeps([19,15,2,4,5]));return{id:zne,diagram:e}},"loader"),SBe={id:zne,detector:wBe,loader:_Be},Une="pie",CBe=ie(e=>/^\s*pie/.test(e),"detector"),kBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./pieDiagram-IB7DONF6-BcnYEJVp.js");return{diagram:t}},__vite__mapDeps([20,13,15,2,4,5,21,22,18]));return{id:Une,diagram:e}},"loader"),EBe={id:Une,detector:CBe,loader:kBe},qne="quadrantChart",TBe=ie(e=>/^\s*quadrantChart/.test(e),"detector"),ABe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./quadrantDiagram-7GDLP6J5-DjEN7wIT.js");return{diagram:t}},__vite__mapDeps([23,17,18]));return{id:qne,diagram:e}},"loader"),RBe={id:qne,detector:TBe,loader:ABe},NBe=RBe,Vne="xychart",MBe=ie(e=>/^\s*xychart-beta/.test(e),"detector"),IBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./xychartDiagram-VJFVF3MP-DdpnWYNk.js");return{diagram:t}},__vite__mapDeps([24,18,22,17]));return{id:Vne,diagram:e}},"loader"),jBe={id:Vne,detector:MBe,loader:IBe},OBe=jBe,Wne="requirement",PBe=ie(e=>/^\s*requirement(Diagram)?/.test(e),"detector"),DBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./requirementDiagram-KVF5MWMF-CnTGZ5B1.js");return{diagram:t}},__vite__mapDeps([25,9]));return{id:Wne,diagram:e}},"loader"),FBe={id:Wne,detector:PBe,loader:DBe},LBe=FBe,Hne="sequence",BBe=ie(e=>/^\s*sequenceDiagram/.test(e),"detector"),$Be=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./sequenceDiagram-X6HHIX6F-m54nHszU.js");return{diagram:t}},__vite__mapDeps([26,7,14]));return{id:Hne,diagram:e}},"loader"),zBe={id:Hne,detector:BBe,loader:$Be},UBe=zBe,Gne="class",qBe=ie((e,t)=>{var n;return((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},"detector"),VBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./classDiagram-GIVACNV2-CJUeiuVN.js");return{diagram:t}},__vite__mapDeps([27,28,9]));return{id:Gne,diagram:e}},"loader"),WBe={id:Gne,detector:qBe,loader:VBe},HBe=WBe,Kne="classDiagram",GBe=ie((e,t)=>{var n;return/^\s*classDiagram/.test(e)&&((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},"detector"),KBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./classDiagram-v2-COTLJTTW-CJUeiuVN.js");return{diagram:t}},__vite__mapDeps([29,28,9]));return{id:Kne,diagram:e}},"loader"),YBe={id:Kne,detector:GBe,loader:KBe},ZBe=YBe,Yne="state",XBe=ie((e,t)=>{var n;return((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},"detector"),JBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./stateDiagram-DGXRK772-Be1vAabG.js");return{diagram:t}},__vite__mapDeps([30,31,9,1,2,3,4]));return{id:Yne,diagram:e}},"loader"),QBe={id:Yne,detector:XBe,loader:JBe},e$e=QBe,Zne="stateDiagram",t$e=ie((e,t)=>{var n;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper")},"detector"),n$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./stateDiagram-v2-YXO3MK2T-D314CdlD.js");return{diagram:t}},__vite__mapDeps([32,31,9]));return{id:Zne,diagram:e}},"loader"),r$e={id:Zne,detector:t$e,loader:n$e},s$e=r$e,Xne="journey",i$e=ie(e=>/^\s*journey/.test(e),"detector"),a$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./journeyDiagram-U35MCT3I-PWLGugHi.js");return{diagram:t}},__vite__mapDeps([33,7,21]));return{id:Xne,diagram:e}},"loader"),o$e={id:Xne,detector:i$e,loader:a$e},l$e=o$e,c$e=ie((e,t,n)=>{zt.debug(`rendering svg for syntax error
`);const r=vLe(t),s=r.append("g");r.attr("viewBox","0 0 2412 512"),MX(r,100,512,!0),s.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),s.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),s.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),s.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),s.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),s.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),s.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),s.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)},"draw"),Jne={draw:c$e},u$e=Jne,d$e={db:{},renderer:Jne,parser:{parse:ie(()=>{},"parse")}},f$e=d$e,Qne="flowchart-elk",h$e=ie((e,t={})=>{var n;return/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"?(t.layout="elk",!0):!1},"detector"),p$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-DjWeIkqx.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Qne,diagram:e}},"loader"),m$e={id:Qne,detector:h$e,loader:p$e},g$e=m$e,ere="timeline",y$e=ie(e=>/^\s*timeline/.test(e),"detector"),b$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./timeline-definition-BDJGKUSR-BLA-XwTJ.js");return{diagram:t}},__vite__mapDeps([34,21]));return{id:ere,diagram:e}},"loader"),v$e={id:ere,detector:y$e,loader:b$e},x$e=v$e,tre="mindmap",w$e=ie(e=>/^\s*mindmap/.test(e),"detector"),_$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./mindmap-definition-ALO5MXBD-CE2axBrk.js");return{diagram:t}},__vite__mapDeps([35,36]));return{id:tre,diagram:e}},"loader"),S$e={id:tre,detector:w$e,loader:_$e},C$e=S$e,nre="kanban",k$e=ie(e=>/^\s*kanban/.test(e),"detector"),E$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./kanban-definition-NDS4AKOZ-DBZhNmzr.js");return{diagram:t}},[]);return{id:nre,diagram:e}},"loader"),T$e={id:nre,detector:k$e,loader:E$e},A$e=T$e,rre="sankey",R$e=ie(e=>/^\s*sankey-beta/.test(e),"detector"),N$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./sankeyDiagram-QLVOVGJD-Ce29_sYZ.js");return{diagram:t}},__vite__mapDeps([37,22,18]));return{id:rre,diagram:e}},"loader"),M$e={id:rre,detector:R$e,loader:N$e},I$e=M$e,sre="packet",j$e=ie(e=>/^\s*packet-beta/.test(e),"detector"),O$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./diagram-VNBRO52H-BFR_g9QB.js");return{diagram:t}},__vite__mapDeps([38,13,15,2,4,5]));return{id:sre,diagram:e}},"loader"),P$e={id:sre,detector:j$e,loader:O$e},ire="radar",D$e=ie(e=>/^\s*radar-beta/.test(e),"detector"),F$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./diagram-SSKATNLV-BCUsWllE.js");return{diagram:t}},__vite__mapDeps([39,13,15,2,4,5]));return{id:ire,diagram:e}},"loader"),L$e={id:ire,detector:D$e,loader:F$e},are="block",B$e=ie(e=>/^\s*block-beta/.test(e),"detector"),$$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./blockDiagram-JOT3LUYC-N_VJrx4V.js");return{diagram:t}},__vite__mapDeps([40,5,2,1,10]));return{id:are,diagram:e}},"loader"),z$e={id:are,detector:B$e,loader:$$e},U$e=z$e,ore="architecture",q$e=ie(e=>/^\s*architecture/.test(e),"detector"),V$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./architectureDiagram-IEHRJDOE-BsoDInQZ.js");return{diagram:t}},__vite__mapDeps([41,13,14,15,2,4,5,36]));return{id:ore,diagram:e}},"loader"),W$e={id:ore,detector:q$e,loader:V$e},H$e=W$e,kU=!1,jT=ie(()=>{kU||(kU=!0,rk("error",f$e,e=>e.toLowerCase().trim()==="error"),rk("---",{db:{clear:ie(()=>{},"clear")},styles:{},renderer:{draw:ie(()=>{},"draw")},parser:{parse:ie(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:ie(()=>null,"init")},e=>e.toLowerCase().trimStart().startsWith("---")),bX(eBe,A$e,ZBe,HBe,fBe,xBe,SBe,EBe,LBe,UBe,g$e,lBe,sBe,C$e,x$e,gBe,s$e,e$e,l$e,NBe,I$e,P$e,OBe,U$e,H$e,L$e))},"addDiagrams"),G$e=ie(async()=>{zt.debug("Loading registered diagrams");const t=(await Promise.allSettled(Object.entries(py).map(async([n,{detector:r,loader:s}])=>{if(s)try{Fj(n)}catch{try{const{diagram:i,id:a}=await s();rk(a,i,r)}catch(i){throw zt.error(`Failed to load external diagram with key ${n}. Removing from detectors.`),delete py[n],i}}}))).filter(n=>n.status==="rejected");if(t.length>0){zt.error(`Failed to load ${t.length} external diagrams`);for(const n of t)zt.error(n);throw new Error(`Failed to load ${t.length} external diagrams`)}},"loadRegisteredDiagrams"),K$e="graphics-document document";function lre(e,t){e.attr("role",K$e),t!==""&&e.attr("aria-roledescription",t)}ie(lre,"setA11yDiagramInfo");function cre(e,t,n,r){if(e.insert!==void 0){if(n){const s=`chart-desc-${r}`;e.attr("aria-describedby",s),e.insert("desc",":first-child").attr("id",s).text(n)}if(t){const s=`chart-title-${r}`;e.attr("aria-labelledby",s),e.insert("title",":first-child").attr("id",s).text(t)}}}ie(cre,"addSVGa11yTitleDescription");var sm,E4=(sm=class{constructor(t,n,r,s,i){this.type=t,this.text=n,this.db=r,this.parser=s,this.renderer=i}static async fromText(t,n={}){var c,u;const r=Ro(),s=vD(t,r);t=mFe(t)+`
`;try{Fj(s)}catch{const d=wIe(s);if(!d)throw new yX(`Diagram ${s} not found.`);const{id:h,diagram:m}=await d();rk(h,m)}const{db:i,parser:a,renderer:o,init:l}=Fj(s);return a.parser&&(a.parser.yy=i),(c=i.clear)==null||c.call(i),l==null||l(r),n.title&&((u=i.setDiagramTitle)==null||u.call(i,n.title)),await a.parse(t),new sm(s,t,i,a,o)}async render(t,n){await this.renderer.draw(this.text,t,n,this)}getParser(){return this.parser}getType(){return this.type}},ie(sm,"Diagram"),sm),EU=[],Y$e=ie(()=>{EU.forEach(e=>{e()}),EU=[]},"attachFunctions"),Z$e=ie(e=>e.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function ure(e){const t=e.match(gX);if(!t)return{text:e,metadata:{}};let n=xje(t[1],{schema:vje})??{};n=typeof n=="object"&&!Array.isArray(n)?n:{};const r={};return n.displayMode&&(r.displayMode=n.displayMode.toString()),n.title&&(r.title=n.title.toString()),n.config&&(r.config=n.config),{text:e.slice(t[0].length),metadata:r}}ie(ure,"extractFrontMatter");var X$e=ie(e=>e.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(t,n,r)=>"<"+n+r.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),J$e=ie(e=>{const{text:t,metadata:n}=ure(e),{displayMode:r,title:s,config:i={}}=n;return r&&(i.gantt||(i.gantt={}),i.gantt.displayMode=r),{title:s,config:i,text:t}},"processFrontmatter"),Q$e=ie(e=>{const t=lu.detectInit(e)??{},n=lu.detectDirective(e,"wrap");return Array.isArray(n)?t.wrap=n.some(({type:r})=>r==="wrap"):(n==null?void 0:n.type)==="wrap"&&(t.wrap=!0),{text:nFe(e),directive:t}},"processDirectives");function b6(e){const t=X$e(e),n=J$e(t),r=Q$e(n.text),s=t6(n.config,r.directive);return e=Z$e(r.text),{code:e,title:n.title,config:s}}ie(b6,"preprocessDiagram");function dre(e){const t=new TextEncoder().encode(e),n=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(n)}ie(dre,"toBase64");var e9e=5e4,t9e="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",n9e="sandbox",r9e="loose",s9e="http://www.w3.org/2000/svg",i9e="http://www.w3.org/1999/xlink",a9e="http://www.w3.org/1999/xhtml",o9e="100%",l9e="100%",c9e="border:0;margin:0;",u9e="margin:0",d9e="allow-top-navigation-by-user-activation allow-popups",f9e='The "iframe" tag is not supported by your browser.',h9e=["foreignobject"],p9e=["dominant-baseline"];function v6(e){const t=b6(e);return tk(),FIe(t.config??{}),t}ie(v6,"processAndSetConfigs");async function fre(e,t){jT();try{const{code:n,config:r}=v6(e);return{diagramType:(await pre(n)).type,config:r}}catch(n){if(t!=null&&t.suppressErrors)return!1;throw n}}ie(fre,"parse");var TU=ie((e,t,n=[])=>`
.${e} ${t} { ${n.join(" !important; ")} !important; }`,"cssImportantStyles"),m9e=ie((e,t=new Map)=>{var r;let n="";if(e.themeCSS!==void 0&&(n+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(n+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(n+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),t instanceof Map){const o=e.htmlLabels??((r=e.flowchart)==null?void 0:r.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];t.forEach(l=>{CU(l.styles)||o.forEach(c=>{n+=TU(l.id,c,l.styles)}),CU(l.textStyles)||(n+=TU(l.id,"tspan",((l==null?void 0:l.textStyles)||[]).map(c=>c.replace("color","fill"))))})}return n},"createCssStyles"),g9e=ie((e,t,n,r)=>{const s=m9e(e,n),i=n3e(t,s,e.themeVariables);return w4(OLe(`${r}{${i}}`),DLe)},"createUserStyles"),y9e=ie((e="",t,n)=>{let r=e;return!n&&!t&&(r=r.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),r=qm(r),r=r.replace(/<br>/g,"<br/>"),r},"cleanUpSvgCode"),b9e=ie((e="",t)=>{var s,i;const n=(i=(s=t==null?void 0:t.viewBox)==null?void 0:s.baseVal)!=null&&i.height?t.viewBox.baseVal.height+"px":l9e,r=dre(`<body style="${u9e}">${e}</body>`);return`<iframe style="width:${o9e};height:${n};${c9e}" src="data:text/html;charset=UTF-8;base64,${r}" sandbox="${d9e}">
  ${f9e}
</iframe>`},"putIntoIFrame"),AU=ie((e,t,n,r,s)=>{const i=e.append("div");i.attr("id",n),r&&i.attr("style",r);const a=i.append("svg").attr("id",t).attr("width","100%").attr("xmlns",s9e);return s&&a.attr("xmlns:xlink",s),a.append("g"),e},"appendDivSvgG");function T4(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}ie(T4,"sandboxedIframe");var v9e=ie((e,t,n,r)=>{var s,i,a;(s=e.getElementById(t))==null||s.remove(),(i=e.getElementById(n))==null||i.remove(),(a=e.getElementById(r))==null||a.remove()},"removeExistingElements"),x9e=ie(async function(e,t,n){var P,V,F,X,U,H;jT();const r=v6(t);t=r.code;const s=Ro();zt.debug(s),t.length>((s==null?void 0:s.maxTextSize)??e9e)&&(t=t9e);const i="#"+e,a="i"+e,o="#"+a,l="d"+e,c="#"+l,u=ie(()=>{const ne=Kr(h?o:c).node();ne&&"remove"in ne&&ne.remove()},"removeTempElements");let d=Kr("body");const h=s.securityLevel===n9e,m=s.securityLevel===r9e,y=s.fontFamily;if(n!==void 0){if(n&&(n.innerHTML=""),h){const $=T4(Kr(n),a);d=Kr($.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Kr(n);AU(d,e,l,`font-family: ${y}`,i9e)}else{if(v9e(document,e,l,a),h){const $=T4(Kr("body"),a);d=Kr($.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Kr("body");AU(d,e,l)}let b,v;try{b=await E4.fromText(t,{title:r.title})}catch($){if(s.suppressErrorRendering)throw u(),$;b=await E4.fromText("error"),v=$}const x=d.select(c).node(),w=b.type,S=x.firstChild,C=S.firstChild,k=(V=(P=b.renderer).getClasses)==null?void 0:V.call(P,t,b),A=g9e(s,w,k,i),R=document.createElement("style");R.innerHTML=A,S.insertBefore(R,C);try{await b.renderer.draw(t,e,gU.version,b)}catch($){throw s.suppressErrorRendering?u():u$e.draw(t,e,gU.version),$}const N=d.select(`${c} svg`),I=(X=(F=b.db).getAccTitle)==null?void 0:X.call(F),O=(H=(U=b.db).getAccDescription)==null?void 0:H.call(U);mre(w,N,I,O),d.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",a9e);let L=d.select(c).node().innerHTML;if(zt.debug("config.arrowMarkerAbsolute",s.arrowMarkerAbsolute),L=y9e(L,h,Vi(s.arrowMarkerAbsolute)),h){const $=d.select(c+" svg").node();L=b9e(L,$)}else m||(L=hy.sanitize(L,{ADD_TAGS:h9e,ADD_ATTR:p9e,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(Y$e(),v)throw v;return u(),{diagramType:w,svg:L,bindFunctions:b.db.bindFunctions}},"render");function hre(e={}){var r;const t=va({},e);t!=null&&t.fontFamily&&!((r=t.themeVariables)!=null&&r.fontFamily)&&(t.themeVariables||(t.themeVariables={}),t.themeVariables.fontFamily=t.fontFamily),PIe(t),t!=null&&t.theme&&t.theme in Id?t.themeVariables=Id[t.theme].getThemeVariables(t.themeVariables):t&&(t.themeVariables=Id.default.getThemeVariables(t.themeVariables));const n=typeof t=="object"?OIe(t):CX();bD(n.logLevel),jT()}ie(hre,"initialize");var pre=ie((e,t={})=>{const{code:n}=b6(e);return E4.fromText(n,t)},"getDiagramFromText");function mre(e,t,n,r){lre(t,e),cre(t,n,r,t.attr("id"))}ie(mre,"addA11yInfo");var _m=Object.freeze({render:x9e,parse:fre,getDiagramFromText:pre,initialize:hre,getConfig:Ro,setConfig:kX,getSiteConfig:CX,updateSiteConfig:DIe,reset:ie(()=>{tk()},"reset"),globalReset:ie(()=>{tk(my)},"globalReset"),defaultConfig:my});bD(Ro().logLevel);tk(Ro());var w9e=ie((e,t,n)=>{zt.warn(e),e6(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},"handleError"),gre=ie(async function(e={querySelector:".mermaid"}){try{await _9e(e)}catch(t){if(e6(t)&&zt.error(t.str),al.parseError&&al.parseError(t),!e.suppressErrors)throw zt.error("Use the suppressErrors option to suppress these errors"),t}},"run"),_9e=ie(async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const r=_m.getConfig();zt.debug(`${e?"":"No "}Callback function found`);let s;if(n)s=n;else if(t)s=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");zt.debug(`Found ${s.length} diagrams`),(r==null?void 0:r.startOnLoad)!==void 0&&(zt.debug("Start On Load: "+(r==null?void 0:r.startOnLoad)),_m.updateSiteConfig({startOnLoad:r==null?void 0:r.startOnLoad}));const i=new lu.InitIDGenerator(r.deterministicIds,r.deterministicIDSeed);let a;const o=[];for(const l of Array.from(s)){if(zt.info("Rendering diagram: "+l.id),l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");const c=`mermaid-${i.next()}`;a=l.innerHTML,a=Vee(lu.entityDecode(a)).trim().replace(/<br\s*\/?>/gi,"<br/>");const u=lu.detectInit(a);u&&zt.debug("Detected early reinit: ",u);try{const{svg:d,bindFunctions:h}=await xre(c,a,l);l.innerHTML=d,e&&await e(c),h&&h(l)}catch(d){w9e(d,o,al.parseError)}}if(o.length>0)throw o[0]},"runThrowsErrors"),yre=ie(function(e){_m.initialize(e)},"initialize"),S9e=ie(async function(e,t,n){zt.warn("mermaid.init is deprecated. Please use run instead."),e&&yre(e);const r={postRenderCallback:n,querySelector:".mermaid"};typeof t=="string"?r.querySelector=t:t&&(t instanceof HTMLElement?r.nodes=[t]:r.nodes=t),await gre(r)},"init"),C9e=ie(async(e,{lazyLoad:t=!0}={})=>{jT(),bX(...e),t===!1&&await G$e()},"registerExternalDiagrams"),bre=ie(function(){if(al.startOnLoad){const{startOnLoad:e}=_m.getConfig();e&&al.run().catch(t=>zt.error("Mermaid failed to initialize",t))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",bre,!1);var k9e=ie(function(e){al.parseError=e},"setParseErrorHandler"),Ok=[],jI=!1,vre=ie(async()=>{if(!jI){for(jI=!0;Ok.length>0;){const e=Ok.shift();if(e)try{await e()}catch(t){zt.error("Error executing queue",t)}}jI=!1}},"executeQueue"),E9e=ie(async(e,t)=>new Promise((n,r)=>{const s=ie(()=>new Promise((i,a)=>{_m.parse(e,t).then(o=>{i(o),n(o)},o=>{var l;zt.error("Error parsing",o),(l=al.parseError)==null||l.call(al,o),a(o),r(o)})}),"performCall");Ok.push(s),vre().catch(r)}),"parse"),xre=ie((e,t,n)=>new Promise((r,s)=>{const i=ie(()=>new Promise((a,o)=>{_m.render(e,t,n).then(l=>{a(l),r(l)},l=>{var c;zt.error("Error parsing",l),(c=al.parseError)==null||c.call(al,l),o(l),s(l)})}),"performCall");Ok.push(i),vre().catch(s)}),"render"),al={startOnLoad:!0,mermaidAPI:_m,parse:E9e,render:xre,init:S9e,run:gre,registerExternalDiagrams:C9e,registerLayoutLoaders:Ane,initialize:yre,parseError:void 0,contentLoaded:bre,setParseErrorHandler:k9e,detectType:vD,registerIconPacks:qje},T9e=al;/*! Check if previously processed *//*!
 * Wait for document loaded before starting the execution
 */const A9e=new DOMParser,R9e=new XMLSerializer;function RU(e,t){const n=e.getAttribute(t);if(!n)return;let r="";for(const s of n.split(/\s+/)){const i=e.getElementById(s);i&&(r+=i.textContent)}return r}let NU=0;const N9e=async(e,t)=>{const n=document.createElement("div");n.ariaHidden="true",n.style.maxHeight="0",n.style.opacity="0",n.style.overflow="hidden",t!=null&&t.containerStyle&&Object.assign(n.style,t.containerStyle),document.body.append(n);const r=await Promise.allSettled(e.map(async s=>{const i=`${(t==null?void 0:t.prefix)??"mermaid"}-${NU}`;NU+=1;const{svg:a}=await T9e.render(i,s,n),o=A9e.parseFromString(a,"text/html"),[l]=o.getElementsByTagName("svg"),{height:c,width:u}=l.viewBox.baseVal,d=RU(l,"aria-describedby"),h=RU(l,"aria-labelledby"),m={height:c,id:i,svg:R9e.serializeToString(l),width:u};return d&&(m.description=d),h&&(m.title=h),m}));return n.remove(),r},M9e=()=>N9e,I9e=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=yr(yn(w=>({foldStreamingCodeBlocks:w.foldStreamingCodeBlocks}))),[r,s]=T.useState(t?n:!1),[i,a]=T.useState(null),[o,l]=T.useState(!1),[c,u]=T.useState(null),d=T.useRef(null),h=No(yn(w=>Object.values(w.canvasControls))),m=T.useCallback((w,S,C,k,A)=>h.filter(R=>R.type==="codeblock"&&R.targetSlot===w&&R.renderer).map(R=>{if(R.renderer){const N={codeBlockContent:S,codeBlockLang:"mermaid",isFolded:k,toggleFold:A,canvasContextType:"codeblock"};return f.jsx(We.Fragment,{children:R.renderer(N)},R.id)}return null}).filter(Boolean),[h]),y=T.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const S=await M9e()([e]);if(S.length>0&&S[0].status==="fulfilled")a(S[0].value.svg);else if(S.length>0&&S[0].status==="rejected"){const C=S[0].reason;u((C==null?void 0:C.message)||"Failed to render Mermaid diagram")}else u("No results returned from Mermaid renderer")}catch(w){console.error("Mermaid rendering error:",w),u(w instanceof Error?w.message:"Failed to render Mermaid diagram")}finally{l(!1)}}},[e,r]);T.useEffect(()=>{!r&&e.trim()&&y()},[e,r,y]);const b=()=>{const w=r;s(S=>!S),w&&setTimeout(y,0)},v=T.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),x=m("codeblock-header-actions",e,"mermaid",r,b);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"MERMAID"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:x})]}),f.jsx("div",{})]}),!r&&f.jsxs("div",{className:"overflow-hidden w-full",children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Qn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Rendering diagram..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(_c,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to render Mermaid diagram"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),i&&!o&&!c&&f.jsx("div",{ref:d,className:"mermaid-container p-4 bg-background border rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:i}})]}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:b,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:v})})]})},x6=T.memo(I9e),j9e=({markdownContent:e})=>{const t=aT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>{if(typeof n=="string")return f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`);if(n.type==="code"){const s=n;return f.jsx(Fy,{lang:s.lang,code:s.code,filepath:s.filepath},`code-${r}`)}else if(n.type==="mermaid"){const s=n;return f.jsx(x6,{code:s.code},`mermaid-${r}`)}return null})}):null},OT=We.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0})=>{var b,v;const s=yr(x=>x.foldUserMessagesOnCompletion),[i,a]=T.useState(r&&s),[o,l]=T.useState(!1);T.useEffect(()=>{r&&s&&a(!0)},[r,s]);const c=t?PZ(new Date(t),{addSuffix:!0}):"Sending...",u=((b=e.metadata)==null?void 0:b.attachedFiles)&&e.metadata.attachedFiles.length>0,d=e.content&&e.content.trim().length>0,h=T.useCallback(()=>a(x=>!x),[]),m=T.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),l(!0),Oe.success("User prompt copied!"),setTimeout(()=>l(!1),1500)}catch(x){Oe.error("Failed to copy prompt."),console.error("Clipboard copy failed:",x)}},[e.content]),y=T.useMemo(()=>{var w;let x="";return d&&(x+=`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`),d&&u&&(x+=" + "),u&&(x+=`${(w=e.metadata.attachedFiles)==null?void 0:w.length} file(s)`),x||"[Empty Prompt]"},[d,u,e.content,e.metadata]);return f.jsxs("div",{className:Ze("user-prompt relative group/user overflow-wrap-anywhere",n),children:[f.jsxs("div",{className:Ze("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-center gap-1 mb-1 sm:mb-0",children:[f.jsx(Pge,{className:"h-4 w-4 text-primary flex-shrink-0"}),f.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),f.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[d&&f.jsx(On,{tooltipText:"Copy Prompt",onClick:m,"aria-label":"Copy user prompt",icon:o?f.jsx(ro,{className:"text-green-500"}):f.jsx(lE,{}),className:"h-5 w-5"}),(d||u)&&f.jsx(On,{tooltipText:i?"Unfold":"Fold",onClick:h,"aria-label":i?"Unfold prompt":"Fold prompt",icon:i?f.jsx(Nc,{}):f.jsx(Dh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground",children:c})})]}),!i&&f.jsxs(f.Fragment,{children:[u&&f.jsx("div",{className:"mb-2 space-y-1",children:(v=e.metadata.attachedFiles)==null?void 0:v.map(x=>f.jsx(bZ,{fileMeta:x,isReadOnly:!0},x.id))}),f.jsx(j9e,{markdownContent:e.content})]}),i&&f.jsx("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:h,children:y})]})});OT.displayName="UserPromptDisplay";const O9e=(e,t,n,r,s)=>{if(typeof e=="string")return e.trim()?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null;if(e.type==="code"){const i=e,a=i.lang?`language-${i.lang}`:"language-plaintext";return n?f.jsx(Fy,{lang:i.lang,code:i.code,filepath:i.filepath,isStreaming:r},`code-${t}`):f.jsxs("pre",{className:"code-block-container my-4 border border-border rounded-lg overflow-x-auto",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border-b border-border bg-muted/50",children:f.jsx("div",{className:"text-sm font-medium",children:i.lang?i.lang.toUpperCase():"CODE"})}),f.jsx("code",{className:Ze(a,"block p-4 font-mono text-sm leading-relaxed"),children:i.code})]},`pre-${t}`)}else if(e.type==="mermaid"){const i=e;return f.jsx(x6,{code:i.code,isStreaming:r},`mermaid-${t}`)}return null},P9e=({interactionId:e,markdownContent:t,isStreaming:n=!1,className:r})=>{const{enableStreamingMarkdown:s,enableStreamingCodeBlockParsing:i}=yr(yn(m=>({enableStreamingMarkdown:m.enableStreamingMarkdown,enableStreamingCodeBlockParsing:m.enableStreamingCodeBlockParsing}))),a=aT(s?t:null),o=No(yn(m=>Object.values(m.canvasControls))),l=T.useCallback((m,y)=>o.filter(b=>b.type==="tool-call-step"&&b.targetSlot===m&&b.renderer).map(b=>b.renderer?f.jsx(We.Fragment,{children:b.renderer(y)},b.id):null).filter(Boolean),[o]),{toolCallStrings:c,toolResultStrings:u}=Bn(yn(m=>{var b,v;const y=m.interactions.find(x=>x.id===e);return{toolCallStrings:(b=y==null?void 0:y.metadata)==null?void 0:b.toolCalls,toolResultStrings:(v=y==null?void 0:y.metadata)==null?void 0:v.toolResults}})),d=T.useMemo(()=>{if(!c)return[];try{const m=c.map(b=>JSON.parse(b)),y=(u==null?void 0:u.map(b=>JSON.parse(b)))??[];return m.map(b=>{const v=y.find(x=>x.toolCallId===b.toolCallId);return{call:b,result:v}})}catch(m){return console.error("[StreamingContentView] Error parsing tool call/result strings:",m),[]}},[c,u]),h=T.useMemo(()=>s?a.map((m,y)=>O9e(m,y,i,n&&y===a.length-1)).filter(Boolean):[],[s,a,i,n,e]);return!s&&!t&&d.length===0?n?f.jsx("div",{className:Ze("text-muted-foreground italic",r),children:"Generating response..."}):null:f.jsxs("div",{className:Ze("streaming-content-view overflow-wrap-anywhere",r),children:[d.map(({call:m,result:y},b)=>{const v={interactionId:e,toolCall:m,toolResult:y,canvasContextType:"tool-call-step"};return f.jsx(We.Fragment,{children:l("tool-call-content",v)},`tool-step-${m.toolCallId||b}`)}),s?h:t?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:new dl().render(t)}}):null]})},D9e=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":s="Stop Generation"})=>f.jsx(On,{tooltipText:"Stop",onClick:e,"aria-label":s,icon:f.jsx(Sge,{}),variant:r,size:n,className:t}),F9e=Symbol("Let zodToJsonSchema decide on which parser to use"),MU={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},L9e=e=>typeof e=="string"?{...MU,name:e}:{...MU,...e},B9e=e=>{const t=L9e(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function wre(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function vs(e,t,n,r,s){e[t]=n,wre(e,t,r,s)}function $9e(){return{}}function z9e(e,t){var r,s,i;const n={type:"array"};return(r=e.type)!=null&&r._def&&((i=(s=e.type)==null?void 0:s._def)==null?void 0:i.typeName)!==Qt.ZodAny&&(n.items=os(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&vs(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&vs(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(vs(n,"minItems",e.exactLength.value,e.exactLength.message,t),vs(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function U9e(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?vs(n,"minimum",r.value,r.message,t):vs(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),vs(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?vs(n,"maximum",r.value,r.message,t):vs(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),vs(n,"maximum",r.value,r.message,t));break;case"multipleOf":vs(n,"multipleOf",r.value,r.message,t);break}return n}function q9e(){return{type:"boolean"}}function _re(e,t){return os(e.type._def,t)}const V9e=(e,t)=>os(e.innerType._def,t);function Sre(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>Sre(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return W9e(e,t)}}const W9e=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":vs(n,"minimum",r.value,r.message,t);break;case"max":vs(n,"maximum",r.value,r.message,t);break}return n};function H9e(e,t){return{...os(e.innerType._def,t),default:e.defaultValue()}}function G9e(e,t){return t.effectStrategy==="input"?os(e.schema._def,t):{}}function K9e(e){return{type:"string",enum:Array.from(e.values)}}const Y9e=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Z9e(e,t){const n=[os(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),os(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(i=>!!i);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(Y9e(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...l}=i;a=l}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function X9e(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let OI;const sc={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(OI===void 0&&(OI=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),OI),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Cre(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":vs(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":vs(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ic(n,"email",r.message,t);break;case"format:idn-email":ic(n,"idn-email",r.message,t);break;case"pattern:zod":Za(n,sc.email,r.message,t);break}break;case"url":ic(n,"uri",r.message,t);break;case"uuid":ic(n,"uuid",r.message,t);break;case"regex":Za(n,r.regex,r.message,t);break;case"cuid":Za(n,sc.cuid,r.message,t);break;case"cuid2":Za(n,sc.cuid2,r.message,t);break;case"startsWith":Za(n,RegExp(`^${PI(r.value,t)}`),r.message,t);break;case"endsWith":Za(n,RegExp(`${PI(r.value,t)}$`),r.message,t);break;case"datetime":ic(n,"date-time",r.message,t);break;case"date":ic(n,"date",r.message,t);break;case"time":ic(n,"time",r.message,t);break;case"duration":ic(n,"duration",r.message,t);break;case"length":vs(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),vs(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{Za(n,RegExp(PI(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&ic(n,"ipv4",r.message,t),r.version!=="v4"&&ic(n,"ipv6",r.message,t);break}case"base64url":Za(n,sc.base64url,r.message,t);break;case"jwt":Za(n,sc.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&Za(n,sc.ipv4Cidr,r.message,t),r.version!=="v4"&&Za(n,sc.ipv6Cidr,r.message,t);break}case"emoji":Za(n,sc.emoji(),r.message,t);break;case"ulid":{Za(n,sc.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{ic(n,"binary",r.message,t);break}case"contentEncoding:base64":{vs(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{Za(n,sc.base64,r.message,t);break}}break}case"nanoid":Za(n,sc.nanoid,r.message,t)}return n}function PI(e,t){return t.patternStrategy==="escape"?Q9e(e):e}const J9e=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Q9e(e){let t="";for(let n=0;n<e.length;n++)J9e.has(e[n])||(t+="\\"),t+=e[n];return t}function ic(e,t,n,r){var s;e.format||(s=e.anyOf)!=null&&s.some(i=>i.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):vs(e,"format",t,n,r)}function Za(e,t,n,r){var s;e.pattern||(s=e.allOf)!=null&&s.some(i=>i.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:IU(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):vs(e,"pattern",IU(t,r),n,r)}function IU(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let s="",i=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(i){s+=r[c],i=!1;continue}if(n.i){if(a){if(r[c].match(/[a-z]/)){o?(s+=r[c],s+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(s+=r[c],o=!0):s+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){s+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(n.m){if(r[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[c]==="."){s+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}s+=r[c],r[c]==="\\"?i=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function kre(e,t){var r,s,i,a,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===Qt.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((c,u)=>({...c,[u]:os(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:os(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((s=e.keyType)==null?void 0:s._def.typeName)===Qt.ZodString&&((i=e.keyType._def.checks)!=null&&i.length)){const{type:c,...u}=Cre(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((a=e.keyType)==null?void 0:a._def.typeName)===Qt.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===Qt.ZodBranded&&e.keyType._def.type._def.typeName===Qt.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=_re(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function eze(e,t){if(t.mapStrategy==="record")return kre(e,t);const n=os(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=os(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function tze(e){const t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function nze(){return{not:{}}}function rze(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Pk={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function sze(e,t){if(t.target==="openApi3")return jU(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Pk&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=Pk[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return jU(e,t)}const jU=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>os(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function ize(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Pk[e.innerType._def.typeName],nullable:!0}:{type:[Pk[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=os(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=os(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function aze(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",wre(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?vs(n,"minimum",r.value,r.message,t):vs(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),vs(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?vs(n,"maximum",r.value,r.message,t):vs(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),vs(n,"maximum",r.value,r.message,t));break;case"multipleOf":vs(n,"multipleOf",r.value,r.message,t);break}return n}function oze(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},s=[],i=e.shape();for(const o in i){let l=i[o];if(l===void 0||l._def===void 0)continue;let c=cze(l);c&&n&&(l instanceof gu&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=os(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||s.push(o))}s.length&&(r.required=s);const a=lze(e,t);return a!==void 0&&(r.additionalProperties=a),r}function lze(e,t){if(e.catchall._def.typeName!=="ZodNever")return os(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function cze(e){try{return e.isOptional()}catch{return!0}}const uze=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return os(e.innerType._def,t);const n=os(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},dze=(e,t)=>{if(t.pipeStrategy==="input")return os(e.in._def,t);if(t.pipeStrategy==="output")return os(e.out._def,t);const n=os(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=os(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function fze(e,t){return os(e.type._def,t)}function hze(e,t){const r={type:"array",uniqueItems:!0,items:os(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&vs(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&vs(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function pze(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>os(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:os(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>os(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function mze(){return{not:{}}}function gze(){return{}}const yze=(e,t)=>os(e.innerType._def,t),bze=(e,t,n)=>{switch(t){case Qt.ZodString:return Cre(e,n);case Qt.ZodNumber:return aze(e,n);case Qt.ZodObject:return oze(e,n);case Qt.ZodBigInt:return U9e(e,n);case Qt.ZodBoolean:return q9e();case Qt.ZodDate:return Sre(e,n);case Qt.ZodUndefined:return mze();case Qt.ZodNull:return rze(n);case Qt.ZodArray:return z9e(e,n);case Qt.ZodUnion:case Qt.ZodDiscriminatedUnion:return sze(e,n);case Qt.ZodIntersection:return Z9e(e,n);case Qt.ZodTuple:return pze(e,n);case Qt.ZodRecord:return kre(e,n);case Qt.ZodLiteral:return X9e(e,n);case Qt.ZodEnum:return K9e(e);case Qt.ZodNativeEnum:return tze(e);case Qt.ZodNullable:return ize(e,n);case Qt.ZodOptional:return uze(e,n);case Qt.ZodMap:return eze(e,n);case Qt.ZodSet:return hze(e,n);case Qt.ZodLazy:return()=>e.getter()._def;case Qt.ZodPromise:return fze(e,n);case Qt.ZodNaN:case Qt.ZodNever:return nze();case Qt.ZodEffects:return G9e(e,n);case Qt.ZodAny:return $9e();case Qt.ZodUnknown:return gze();case Qt.ZodDefault:return H9e(e,n);case Qt.ZodBranded:return _re(e,n);case Qt.ZodReadonly:return yze(e,n);case Qt.ZodCatch:return V9e(e,n);case Qt.ZodPipeline:return dze(e,n);case Qt.ZodFunction:case Qt.ZodVoid:case Qt.ZodSymbol:return;default:return(r=>{})()}};function os(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==F9e)return l}if(r&&!n){const l=vze(r,t);if(l!==void 0)return l}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const i=bze(e,e.typeName,t),a=typeof i=="function"?os(i(),t):i;if(a&&wze(e,t,a),t.postProcess){const l=t.postProcess(a,e,t);return s.jsonSchema=a,l}return s.jsonSchema=a,a}const vze=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:xze(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},xze=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},wze=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),_ze=(e,t)=>{const n=B9e(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[c,u])=>({...l,[c]:os(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,s=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,i=os(e._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1)??{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(i.title=a);const o=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Nw={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Mw={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Iw={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},jw={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Ow={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},Sze=[Nw,Mw,Iw,jw,Ow];Nw.code+"",Mw.code+"",Iw.code+"",jw.code+"",Ow.code+"";Nw.name+"",Nw.code,Mw.name+"",Mw.code,Iw.name+"",Iw.code,jw.name+"",jw.code,Ow.name+"",Ow.code;Sze.map(e=>e.code);function Cze(e){const t=["ROOT"];let n=-1,r=null;function s(l,c,u){switch(l){case'"':{n=c,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=c,r=c,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=c,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=c,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=c,t.pop();break}}}function a(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}}}for(let l=0;l<e.length;l++){const c=e[l];switch(t[t.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{n=l,t.pop();break}default:{n=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const d=e.substring(r,l+1);!"false".startsWith(d)&&!"true".startsWith(d)&&!"null".startsWith(d)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?o+="true".slice(u.length):"false".startsWith(u)?o+="false".slice(u.length):"null".startsWith(u)&&(o+="null".slice(u.length))}}return o}function kze(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=cm({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=cm({text:Cze(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Eze={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Tze={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},Aze={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Rze={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Nze={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Mze={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},Ize={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},jze={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Oze={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Pze={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},Dze={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},Fze={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},Lze={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},Bze={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},$ze={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},zze={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},PT=[Eze,Tze,Aze,Rze,Nze,Mze,Ize,jze,Oze,Pze,Dze,Fze,Lze,Bze,$ze,zze];Object.fromEntries(PT.map(e=>[e.code,e]));Object.fromEntries(PT.map(e=>[e.name,e.code]));PT.map(e=>e.code);function Aa(e,t){const n=PT.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function Uze(e,t){var n;const r=(n=void 0)!=null?n:!1;return Ere(_ze(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:s=>{const i=e.safeParse(s);return i.success?{success:!0,value:i.data}:{success:!1,error:i.error}}})}var A4=Symbol.for("vercel.ai.schema");function Ere(e,{validate:t}={}){return{[A4]:!0,_type:void 0,[aC]:!0,jsonSchema:e,validate:t}}function qze(e){return typeof e=="object"&&e!==null&&A4 in e&&e[A4]===!0&&"jsonSchema"in e&&"validate"in e}function DT(e){return qze(e)?e:Uze(e)}var Vze=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof h0=="object"?h0:{},Yp="1.9.0",OU=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function Wze(e){var t=new Set([e]),n=new Set,r=e.match(OU);if(!r)return function(){return!1};var s={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(s.prerelease!=null)return function(l){return l===e};function i(o){return n.add(o),!1}function a(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var c=l.match(OU);if(!c)return i(l);var u={major:+c[1],minor:+c[2],patch:+c[3],prerelease:c[4]};return u.prerelease!=null||s.major!==u.major?i(l):s.major===0?s.minor===u.minor&&s.patch<=u.patch?a(l):i(l):s.minor<=u.minor?a(l):i(l)}}var Hze=Wze(Yp),Gze=Yp.split(".")[0],Pw=Symbol.for("opentelemetry.js.api."+Gze),Dw=Vze;function w6(e,t,n,r){var s;r===void 0&&(r=!1);var i=Dw[Pw]=(s=Dw[Pw])!==null&&s!==void 0?s:{version:Yp};if(!r&&i[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}if(i.version!==Yp){var a=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+Yp);return n.error(a.stack||a.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+Yp+"."),!0}function Fw(e){var t,n,r=(t=Dw[Pw])===null||t===void 0?void 0:t.version;if(!(!r||!Hze(r)))return(n=Dw[Pw])===null||n===void 0?void 0:n[e]}function _6(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Yp+".");var n=Dw[Pw];n&&delete n[e]}var Kze=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Yze=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Zze=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return qv("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return qv("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return qv("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return qv("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return qv("verbose",this._namespace,t)},e}();function qv(e,t,n){var r=Fw("diag");if(r)return n.unshift(t),r[e].apply(r,Yze([],Kze(n),!1))}var Qo;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(Qo||(Qo={}));function Xze(e,t){e<Qo.NONE?e=Qo.NONE:e>Qo.ALL&&(e=Qo.ALL),t=t||{};function n(r,s){var i=t[r];return typeof i=="function"&&e>=s?i.bind(t):function(){}}return{error:n("error",Qo.ERROR),warn:n("warn",Qo.WARN),info:n("info",Qo.INFO),debug:n("debug",Qo.DEBUG),verbose:n("verbose",Qo.VERBOSE)}}var Jze=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Qze=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},e7e="diag",Dk=function(){function e(){function t(s){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=Fw("diag");if(o)return o[s].apply(o,Qze([],Jze(i),!1))}}var n=this,r=function(s,i){var a,o,l;if(i===void 0&&(i={logLevel:Qo.INFO}),s===n){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((a=c.stack)!==null&&a!==void 0?a:c.message),!1}typeof i=="number"&&(i={logLevel:i});var u=Fw("diag"),d=Xze((o=i.logLevel)!==null&&o!==void 0?o:Qo.INFO,s);if(u&&!i.suppressOverrideMessage){var h=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+h),d.warn("Current logger will overwrite one already registered from "+h)}return w6("diag",d,n,!0)};n.setLogger=r,n.disable=function(){_6(e7e,n)},n.createComponentLogger=function(s){return new Zze(s)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function t7e(e){return Symbol.for(e)}var n7e=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,s){var i=new e(n._currentContext);return i._currentContext.set(r,s),i},n.deleteValue=function(r){var s=new e(n._currentContext);return s._currentContext.delete(r),s}}return e}(),r7e=new n7e,s7e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},i7e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},a7e=function(){function e(){}return e.prototype.active=function(){return r7e},e.prototype.with=function(t,n,r){for(var s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return n.call.apply(n,i7e([r],s7e(s),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),o7e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},l7e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},DI="context",c7e=new a7e,Tre=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return w6(DI,t,Dk.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var s,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return(s=this._getContextManager()).with.apply(s,l7e([t,n,r],o7e(i),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return Fw(DI)||c7e},e.prototype.disable=function(){this._getContextManager().disable(),_6(DI,Dk.instance())},e}(),R4;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(R4||(R4={}));var Are="0000000000000000",Rre="00000000000000000000000000000000",u7e={traceId:Rre,spanId:Are,traceFlags:R4.NONE},_x=function(){function e(t){t===void 0&&(t=u7e),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),S6=t7e("OpenTelemetry Context Key SPAN");function C6(e){return e.getValue(S6)||void 0}function d7e(){return C6(Tre.getInstance().active())}function k6(e,t){return e.setValue(S6,t)}function f7e(e){return e.deleteValue(S6)}function h7e(e,t){return k6(e,new _x(t))}function Nre(e){var t;return(t=C6(e))===null||t===void 0?void 0:t.spanContext()}var p7e=/^([0-9a-f]{32})$/i,m7e=/^[0-9a-f]{16}$/i;function g7e(e){return p7e.test(e)&&e!==Rre}function y7e(e){return m7e.test(e)&&e!==Are}function Mre(e){return g7e(e.traceId)&&y7e(e.spanId)}function b7e(e){return new _x(e)}var FI=Tre.getInstance(),Ire=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=FI.active());var s=!!(n!=null&&n.root);if(s)return new _x;var i=r&&Nre(r);return v7e(i)&&Mre(i)?new _x(i):new _x},e.prototype.startActiveSpan=function(t,n,r,s){var i,a,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(i=n,o=r):(i=n,a=r,o=s);var l=a??FI.active(),c=this.startSpan(t,i,l),u=k6(l,c);return FI.with(u,o,void 0,c)}},e}();function v7e(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var x7e=new Ire,w7e=function(){function e(t,n,r,s){this._provider=t,this.name=n,this.version=r,this.options=s}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,s){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):x7e},e}(),_7e=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new Ire},e}(),S7e=new _7e,PU=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var s;return(s=this.getDelegateTracer(t,n,r))!==null&&s!==void 0?s:new w7e(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:S7e},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var s;return(s=this._delegate)===null||s===void 0?void 0:s.getTracer(t,n,r)},e}(),Fk;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(Fk||(Fk={}));var LI="trace",C7e=function(){function e(){this._proxyTracerProvider=new PU,this.wrapSpanContext=b7e,this.isSpanContextValid=Mre,this.deleteSpan=f7e,this.getSpan=C6,this.getActiveSpan=d7e,this.getSpanContext=Nre,this.setSpan=k6,this.setSpanContext=h7e}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=w6(LI,this._proxyTracerProvider,Dk.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return Fw(LI)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){_6(LI,Dk.instance()),this._proxyTracerProvider=new PU},e}(),k7e=C7e.getInstance(),E7e=Object.defineProperty,E6=(e,t)=>{for(var n in t)E7e(e,n,{get:t[n],enumerable:!0})};function Lk(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function DU(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[s,i]of Object.entries(e))r[s]=i;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function FU({response:e,status:t,statusText:n,headers:r,stream:s}){e.writeHead(t??200,n,r);const i=s.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await i.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var jre="AI_InvalidArgumentError",Ore=`vercel.ai.error.${jre}`,T7e=Symbol.for(Ore),Pre,cc=class extends er{constructor({parameter:e,value:t,message:n}){super({name:jre,message:`Invalid argument for parameter ${e}: ${n}`}),this[Pre]=!0,this.parameter=e,this.value=t}static isInstance(e){return er.hasMarker(e,Ore)}};Pre=T7e;var Dre="AI_RetryError",Fre=`vercel.ai.error.${Dre}`,A7e=Symbol.for(Fre),Lre,LU=class extends er{constructor({message:e,reason:t,errors:n}){super({name:Dre,message:e}),this[Lre]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return er.hasMarker(e,Fre)}};Lre=A7e;var R7e=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>Bre(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function Bre(e,{maxRetries:t,delayInMs:n,backoffFactor:r},s=[]){try{return await e()}catch(i){if(_2(i)||t===0)throw i;const a=fye(i),o=[...s,i],l=o.length;if(l>t)throw new LU({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(i instanceof Error&&$l.isInstance(i)&&i.isRetryable===!0&&l<=t)return await uye(n),Bre(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?i:new LU({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function N7e({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new cc({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new cc({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:R7e({maxRetries:t})}}function N4({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function M7e({model:e,settings:t,telemetry:n,headers:r}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((i,[a,o])=>(i[`ai.settings.${a}`]=o,i),{}),...Object.entries((s=n==null?void 0:n.metadata)!=null?s:{}).reduce((i,[a,o])=>(i[`ai.telemetry.metadata.${a}`]=o,i),{}),...Object.entries(r??{}).reduce((i,[a,o])=>(o!==void 0&&(i[`ai.request.headers.${a}`]=o),i),{})}}var I7e={startSpan(){return XS},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(XS);if(typeof n=="function")return n(XS);if(typeof r=="function")return r(XS)}},XS={spanContext(){return j7e},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},j7e={traceId:"",spanId:"",traceFlags:0};function O7e({isEnabled:e=!1,tracer:t}={}){return e?t||k7e.getTracer("ai"):I7e}function M4({name:e,tracer:t,attributes:n,fn:r,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:n},async i=>{try{const a=await r(i);return s&&i.end(),a}catch(a){try{a instanceof Error?(i.recordException({name:a.name,message:a.message,stack:a.stack}),i.setStatus({code:Fk.ERROR,message:a.message})):i.setStatus({code:Fk.ERROR})}finally{i.end()}throw a}})}function p0({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,s])=>{if(s===void 0)return n;if(typeof s=="object"&&"input"in s&&typeof s.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const i=s.input();return i===void 0?n:{...n,[r]:i}}if(typeof s=="object"&&"output"in s&&typeof s.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const i=s.output();return i===void 0?n:{...n,[r]:i}}return{...n,[r]:s}},{})}var P7e=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=Su(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=bE(this.base64Data)),this.uint8ArrayData}},D7e=class extends P7e{constructor(e){super(e),this.type="file"}},F7e=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],L7e=e=>{const t=typeof e=="string"?bE(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function B7e(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?L7e(e):e}function $7e({data:e,signatures:t}){const n=B7e(e);for(const r of t)if(typeof n=="string"?n.startsWith(r.base64Prefix):n.length>=r.bytesPrefix.length&&r.bytesPrefix.every((s,i)=>n[i]===s))return r.mimeType}var $re="AI_NoObjectGeneratedError",zre=`vercel.ai.error.${$re}`,z7e=Symbol.for(zre),Ure,BU=class extends er{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:s,finishReason:i}){super({name:$re,message:e,cause:t}),this[Ure]=!0,this.text=n,this.response=r,this.usage=s,this.finishReason=i}static isInstance(e){return er.hasMarker(e,zre)}};Ure=z7e;var qre="AI_DownloadError",Vre=`vercel.ai.error.${qre}`,U7e=Symbol.for(Vre),Wre,BI=class extends er{constructor({url:e,statusCode:t,statusText:n,cause:r,message:s=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:qre,message:s,cause:r}),this[Wre]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return er.hasMarker(e,Vre)}};Wre=U7e;async function q7e({url:e}){var t;const n=e.toString();try{const r=await fetch(n);if(!r.ok)throw new BI({url:n,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw BI.isInstance(r)?r:new BI({url:n,cause:r})}}var Hre="AI_InvalidDataContentError",Gre=`vercel.ai.error.${Hre}`,V7e=Symbol.for(Gre),Kre,$U=class extends er{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:Hre,message:n,cause:t}),this[Kre]=!0,this.content=e}static isInstance(e){return er.hasMarker(e,Gre)}};Kre=V7e;var Yre=hs([$e(),vC(Uint8Array),vC(ArrayBuffer),uG(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function T6(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Su(new Uint8Array(e)):Su(e)}function Bk(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return bE(e)}catch(t){throw new $U({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new $U({content:e})}function W7e(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var Zre="AI_InvalidMessageRoleError",Xre=`vercel.ai.error.${Zre}`,H7e=Symbol.for(Xre),Jre,G7e=class extends er{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:Zre,message:t}),this[Jre]=!0,this.role=e}static isInstance(e){return er.hasMarker(e,Xre)}};Jre=H7e;function K7e(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function Y7e({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=q7e}){const s=await X7e(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(i=>Z7e(i,s))]}function Z7e(e,t){var n,r,s,i,a,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(c=>J7e(c,t)).filter(c=>c.type!=="text"||c.text!==""),providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(c=>c.type!=="text"||c.text!=="").map(c=>{var u;const d=(u=c.providerOptions)!=null?u:c.experimental_providerMetadata;switch(c.type){case"file":return{type:"file",data:c.data instanceof URL?c.data:T6(c.data),filename:c.filename,mimeType:c.mimeType,providerMetadata:d};case"reasoning":return{type:"reasoning",text:c.text,signature:c.signature,providerMetadata:d};case"redacted-reasoning":return{type:"redacted-reasoning",data:c.data,providerMetadata:d};case"text":return{type:"text",text:c.text,providerMetadata:d};case"tool-call":return{type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,args:c.args,providerMetadata:d}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(c=>{var u;return{type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,result:c.result,content:c.experimental_content,isError:c.isError,providerMetadata:(u=c.providerOptions)!=null?u:c.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const c=l;throw new G7e({role:c})}}}async function X7e(e,t,n,r){const s=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&n===!0)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!r(a)),i=await Promise.all(s.map(async a=>({url:a,data:await t({url:a})})));return Object.fromEntries(i.map(({url:a,data:o})=>[a.toString(),o]))}function J7e(e,t){var n,r,s,i;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let a=e.mimeType,o,l,c;const u=e.type;switch(u){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:d,base64Content:h}=K7e(l.toString());if(d==null||h==null)throw new Error(`Invalid data URL format in part ${u}`);a=d,c=Bk(h)}else{const d=t[l.toString()];d?(c=d.data,a??(a=d.mimeType)):c=l}else c=Bk(l);switch(u){case"image":return c instanceof Uint8Array&&(a=(r=$7e({data:c,signatures:F7e}))!=null?r:a),{type:"image",image:c,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"file":{if(a==null)throw new Error("Mime type is missing for file part");return{type:"file",data:c instanceof Uint8Array?T6(c):c,filename:e.filename,mimeType:a,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}}}}function Q7e({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new cc({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new cc({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new cc({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new cc({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new cc({parameter:"topK",value:r,message:"topK must be a number"});if(s!=null&&typeof s!="number")throw new cc({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(i!=null&&typeof i!="number")throw new cc({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new cc({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a!=null&&a.length>0?a:void 0,seed:o}}function zU(e){var t,n,r;const s=[];for(const i of e){let a;try{a=new URL(i.url)}catch{throw new Error(`Invalid URL: ${i.url}`)}switch(a.protocol){case"http:":case"https:":{if((t=i.contentType)!=null&&t.startsWith("image/"))s.push({type:"image",image:a});else{if(!i.contentType)throw new Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:a,mimeType:i.contentType})}break}case"data:":{let o,l,c;try{[o,l]=i.url.split(","),c=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${i.url}`)}if(c==null||l==null)throw new Error(`Invalid data URL format: ${i.url}`);if((n=i.contentType)!=null&&n.startsWith("image/"))s.push({type:"image",image:Bk(l)});else if((r=i.contentType)!=null&&r.startsWith("text/"))s.push({type:"text",text:W7e(Bk(l))});else{if(!i.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:l,mimeType:i.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return s}var Qre="AI_MessageConversionError",ese=`vercel.ai.error.${Qre}`,eUe=Symbol.for(ese),tse,$I=class extends er{constructor({originalMessage:e,message:t}){super({name:Qre,message:t}),this[tse]=!0,this.originalMessage=e}static isInstance(e){return er.hasMarker(e,ese)}};tse=eUe;function tUe(e,t){var n,r;const s=(n=t==null?void 0:t.tools)!=null?n:{},i=[];for(let a=0;a<e.length;a++){const o=e[a],l=a===e.length-1,{role:c,content:u,experimental_attachments:d}=o;switch(c){case"system":{i.push({role:"system",content:u});break}case"user":{if(o.parts==null)i.push({role:"user",content:d?[{type:"text",text:u},...zU(d)]:u});else{const h=o.parts.filter(m=>m.type==="text").map(m=>({type:"text",text:m.text}));i.push({role:"user",content:d?[...h,...zU(d)]:h})}break}case"assistant":{if(o.parts!=null){let y=function(){const w=[];for(const C of x)switch(C.type){case"file":case"text":{w.push(C);break}case"reasoning":{for(const k of C.details)switch(k.type){case"text":w.push({type:"reasoning",text:k.text,signature:k.signature});break;case"redacted":w.push({type:"redacted-reasoning",data:k.data});break}break}case"tool-invocation":w.push({type:"tool-call",toolCallId:C.toolInvocation.toolCallId,toolName:C.toolInvocation.toolName,args:C.toolInvocation.args});break;default:{const k=C;throw new Error(`Unsupported part: ${k}`)}}i.push({role:"assistant",content:w});const S=x.filter(C=>C.type==="tool-invocation").map(C=>C.toolInvocation);S.length>0&&i.push({role:"tool",content:S.map(C=>{if(!("result"in C))throw new $I({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(C)});const{toolCallId:k,toolName:A,result:R}=C,N=s[A];return(N==null?void 0:N.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:k,toolName:A,result:N.experimental_toToolResultContent(R),experimental_content:N.experimental_toToolResultContent(R)}:{type:"tool-result",toolCallId:k,toolName:A,result:R}})}),x=[],v=!1,b++},b=0,v=!1,x=[];for(const w of o.parts)switch(w.type){case"text":{v&&y(),x.push(w);break}case"file":case"reasoning":{x.push(w);break}case"tool-invocation":{((r=w.toolInvocation.step)!=null?r:0)!==b&&y(),x.push(w),v=!0;break}}y();break}const h=o.toolInvocations;if(h==null||h.length===0){i.push({role:"assistant",content:u});break}const m=h.reduce((y,b)=>{var v;return Math.max(y,(v=b.step)!=null?v:0)},0);for(let y=0;y<=m;y++){const b=h.filter(v=>{var x;return((x=v.step)!=null?x:0)===y});b.length!==0&&(i.push({role:"assistant",content:[...l&&u&&y===0?[{type:"text",text:u}]:[],...b.map(({toolCallId:v,toolName:x,args:w})=>({type:"tool-call",toolCallId:v,toolName:x,args:w}))]}),i.push({role:"tool",content:b.map(v=>{if(!("result"in v))throw new $I({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(v)});const{toolCallId:x,toolName:w,result:S}=v,C=s[w];return(C==null?void 0:C.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:x,toolName:w,result:C.experimental_toToolResultContent(S),experimental_content:C.experimental_toToolResultContent(S)}:{type:"tool-result",toolCallId:x,toolName:w,result:S}})}))}u&&!l&&i.push({role:"assistant",content:u});break}case"data":break;default:{const h=c;throw new $I({originalMessage:o,message:`Unsupported role: ${h}`})}}}return i}var I4=Xye(()=>hs([Zye(),$e(),Tt(),br(),gh($e(),I4),ln(I4)])),oi=gh($e(),gh($e(),I4)),nUe=ln(hs([Ke({type:An("text"),text:$e()}),Ke({type:An("image"),data:$e(),mimeType:$e().optional()})])),nse=Ke({type:An("text"),text:$e(),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),rUe=Ke({type:An("image"),image:hs([Yre,vC(URL)]),mimeType:$e().optional(),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),rse=Ke({type:An("file"),data:hs([Yre,vC(URL)]),filename:$e().optional(),mimeType:$e(),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),sUe=Ke({type:An("reasoning"),text:$e(),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),iUe=Ke({type:An("redacted-reasoning"),data:$e(),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),aUe=Ke({type:An("tool-call"),toolCallId:$e(),toolName:$e(),args:jy(),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),oUe=Ke({type:An("tool-result"),toolCallId:$e(),toolName:$e(),result:jy(),content:nUe.optional(),isError:br().optional(),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),lUe=Ke({role:An("system"),content:$e(),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),cUe=Ke({role:An("user"),content:hs([$e(),ln(hs([nse,rUe,rse]))]),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),uUe=Ke({role:An("assistant"),content:hs([$e(),ln(hs([nse,rse,sUe,iUe,aUe]))]),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),dUe=Ke({role:An("tool"),content:ln(oUe),providerOptions:oi.optional(),experimental_providerMetadata:oi.optional()}),fUe=hs([lUe,cUe,uUe,dUe]);function hUe({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new uc({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new uc({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new uc({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new uc({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const r=pUe(e.messages)==="ui-messages"?tUe(e.messages,{tools:t}):e.messages;if(r.length===0)throw new uc({prompt:e,message:"messages must not be empty"});const s=Iy({value:r,schema:ln(fUe)});if(!s.success)throw new uc({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${s.error.message}`].join(`
`),cause:s.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function pUe(e){if(!Array.isArray(e))throw new uc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return"messages";const t=e.map(mUe);if(t.some(r=>r==="has-ui-specific-parts"))return"ui-messages";const n=t.findIndex(r=>r!=="has-core-specific-parts"&&r!=="message");if(n===-1)return"messages";throw new uc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[n]}" at index ${n}`,`messages[${n}]: ${JSON.stringify(e[n])}`].join(`
`),cause:e})}function mUe(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function gUe({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function yUe(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var bUe="JSON schema:",vUe="You MUST answer with a JSON object that matches the JSON schema above.",xUe="You MUST answer with JSON.";function wUe({prompt:e,schema:t,schemaPrefix:n=t!=null?bUe:void 0,schemaSuffix:r=t!=null?vUe:xUe}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(s=>s!=null).join(`
`)}function zI(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:s}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:s}}}},t}function _Ue(e){const t=e.map(n=>({...n,content:typeof n.content=="string"?n.content:n.content.map(SUe)}));return JSON.stringify(t)}function SUe(e){return e.type==="image"?{...e,image:e.image instanceof Uint8Array?T6(e.image):e.image}:e}Tm({prefix:"aiobj",size:24});var yo=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function UU(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}function CUe(){let e=[],t=null,n=!1,r=UU();const s=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=UU(),await r.promise,s();try{const{value:i,done:a}=await e[0].read();a?(e.shift(),e.length>0?await s():n&&(t==null||t.close())):t==null||t.enqueue(i)}catch(i){t==null||t.error(i),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(i){t=i},pull:s,async cancel(){for(const i of e)await i.cancel();e=[],n=!0}}),addStream:i=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(i.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(i=>i.cancel()),e=[],t==null||t.close()}}}function kUe(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}Tm({prefix:"aiobj",size:24});var sse="AI_NoOutputSpecifiedError",ise=`vercel.ai.error.${sse}`,EUe=Symbol.for(ise),ase,TUe=class extends er{constructor({message:e="No output specified."}={}){super({name:sse,message:e}),this[ase]=!0}static isInstance(e){return er.hasMarker(e,ise)}};ase=EUe;var ose="AI_ToolExecutionError",lse=`vercel.ai.error.${ose}`,AUe=Symbol.for(lse),cse,RUe=class extends er{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:s=`Error executing tool ${t}: ${a1(r)}`}){super({name:ose,message:s,cause:r}),this[cse]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return er.hasMarker(e,lse)}};cse=AUe;function NUe(e){return e!=null&&Object.keys(e).length>0}function MUe({tools:e,toolChoice:t,activeTools:n}){return NUe(e)?{tools:(n!=null?Object.entries(e).filter(([s])=>n.includes(s)):Object.entries(e)).map(([s,i])=>{const a=i.type;switch(a){case void 0:case"function":return{type:"function",name:s,description:i.description,parameters:DT(i.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:s,id:i.id,args:i.args};default:{const o=a;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var IUe=/^([\s\S]*?)(\s+)(\S*)$/;function jUe(e){const t=e.match(IUe);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var use="AI_InvalidToolArgumentsError",dse=`vercel.ai.error.${use}`,OUe=Symbol.for(dse),fse,hse=class extends er{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${a1(n)}`}){super({name:use,message:r,cause:n}),this[fse]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return er.hasMarker(e,dse)}};fse=OUe;var pse="AI_NoSuchToolError",mse=`vercel.ai.error.${pse}`,PUe=Symbol.for(mse),gse,j4=class extends er{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:pse,message:n}),this[gse]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return er.hasMarker(e,mse)}};gse=PUe;var yse="AI_ToolCallRepairError",bse=`vercel.ai.error.${yse}`,DUe=Symbol.for(bse),vse,FUe=class extends er{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${a1(e)}`}){super({name:yse,message:n,cause:e}),this[vse]=!0,this.originalError=t}static isInstance(e){return er.hasMarker(e,bse)}};vse=DUe;async function LUe({toolCall:e,tools:t,repairToolCall:n,system:r,messages:s}){if(t==null)throw new j4({toolName:e.toolName});try{return await qU({toolCall:e,tools:t})}catch(i){if(n==null||!(j4.isInstance(i)||hse.isInstance(i)))throw i;let a=null;try{a=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>DT(t[o].parameters).jsonSchema,system:r,messages:s,error:i})}catch(o){throw new FUe({cause:o,originalError:i})}if(a==null)throw i;return await qU({toolCall:a,tools:t})}}async function qU({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new j4({toolName:e.toolName,availableTools:Object.keys(t)});const s=DT(r.parameters),i=e.args.trim()===""?Iy({value:{},schema:s}):cm({text:e.args,schema:s});if(i.success===!1)throw new hse({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function BUe(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function VU({text:e="",files:t,reasoning:n,tools:r,toolCalls:s,toolResults:i,messageId:a,generateMessageId:o}){const l=[],c=[];return n.length>0&&c.push(...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&c.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&c.push({type:"text",text:e}),s.length>0&&c.push(...s),c.length>0&&l.push({role:"assistant",content:c,id:a}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(u=>{const d=r[u.toolName];return(d==null?void 0:d.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:d.experimental_toToolResultContent(u.result),experimental_content:d.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}Tm({prefix:"aitxt",size:24});Tm({prefix:"msg",size:24});var $Ue={};E6($Ue,{object:()=>HUe,text:()=>WUe});var xse="AI_InvalidStreamPartError",wse=`vercel.ai.error.${xse}`,zUe=Symbol.for(wse),_se,UUe=class extends er{constructor({chunk:e,message:t}){super({name:xse,message:t}),this[_se]=!0,this.chunk=e}static isInstance(e){return er.hasMarker(e,wse)}};_se=zUe;var qUe="AI_MCPClientError",Sse=`vercel.ai.error.${qUe}`,VUe=Symbol.for(Sse),Cse,ea=class extends er{constructor({name:e="MCPClientError",message:t,cause:n}){super({name:e,message:t,cause:n}),this[Cse]=!0}static isInstance(e){return er.hasMarker(e,Sse)}};Cse=VUe;var WUe=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),HUe=({schema:e})=>{const t=DT(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:wUe({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=kze(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const s=r.state;throw new Error(`Unsupported parse state: ${s}`)}}},parseOutput({text:n},r){const s=cm({text:n});if(!s.success)throw new BU({message:"No object generated: could not parse the response.",cause:s.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});const i=Iy({value:s.value,schema:t});if(!i.success)throw new BU({message:"No object generated: response did not match schema.",cause:i.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});return i.value}}};function GUe(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function KUe({stream:e,onError:t}){const n=e.getReader();try{for(;;){const{done:r}=await n.read();if(r)break}}catch(r){t==null||t(r)}finally{n.releaseLock()}}function A6(e,t){const n=e.getReader(),r=t.getReader();let s,i,a=!1,o=!1;async function l(u){try{s==null&&(s=n.read());const d=await s;s=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}async function c(u){try{i==null&&(i=r.read());const d=await i;i=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}return new ReadableStream({async pull(u){try{if(a){await c(u);return}if(o){await l(u);return}s==null&&(s=n.read()),i==null&&(i=r.read());const{result:d,reader:h}=await Promise.race([s.then(m=>({result:m,reader:n})),i.then(m=>({result:m,reader:r}))]);d.done||u.enqueue(d.value),h===n?(s=void 0,d.done&&(await c(u),a=!0)):(i=void 0,d.done&&(o=!0,await l(u)))}catch(d){u.error(d)}},cancel(){n.cancel(),r.cancel()}})}function YUe({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:s,system:i,messages:a,abortSignal:o,repairToolCall:l}){let c=null;const u=new ReadableStream({start(x){c=x}}),d={},h=new Set;let m=!1,y;function b(){m&&h.size===0&&(y!=null&&c.enqueue(y),c.close())}const v=new TransformStream({async transform(x,w){const S=x.type;switch(S){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{w.enqueue(x);break}case"file":{w.enqueue(new D7e({data:x.data,mimeType:x.mimeType}));break}case"tool-call-delta":{n&&(d[x.toolCallId]||(w.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),d[x.toolCallId]=!0),w.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case"tool-call":{try{const C=await LUe({toolCall:x,tools:e,repairToolCall:l,system:i,messages:a});w.enqueue(C);const k=e[C.toolName];if(k.execute!=null){const A=ra();h.add(A),M4({name:"ai.toolCall",attributes:p0({telemetry:s,attributes:{...N4({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":C.toolName,"ai.toolCall.id":C.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(C.args)}}}),tracer:r,fn:async R=>k.execute(C.args,{toolCallId:C.toolCallId,messages:a,abortSignal:o}).then(N=>{c.enqueue({...C,type:"tool-result",result:N}),h.delete(A),b();try{R.setAttributes(p0({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(N)}}}))}catch{}},N=>{c.enqueue({type:"error",error:new RUe({toolCallId:C.toolCallId,toolName:C.toolName,toolArgs:C.args,cause:N})}),h.delete(A),b()})})}}catch(C){c.enqueue({type:"error",error:C})}break}case"finish":{y={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:gUe(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{const C=S;throw new Error(`Unhandled chunk type: ${C}`)}}},flush(){m=!0,b()}});return new ReadableStream({async start(x){return Promise.all([t.pipeThrough(v).pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){}})),u.pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){x.close()}}))])}})}var ZUe=Tm({prefix:"aitxt",size:24}),XUe=Tm({prefix:"msg",size:24});function JUe({model:e,tools:t,toolChoice:n,system:r,prompt:s,messages:i,maxRetries:a,abortSignal:o,headers:l,maxSteps:c=1,experimental_generateMessageId:u=XUe,experimental_output:d,experimental_continueSteps:h=!1,experimental_telemetry:m,experimental_providerMetadata:y,providerOptions:b=y,experimental_toolCallStreaming:v=!1,toolCallStreaming:x=v,experimental_activeTools:w,experimental_repairToolCall:S,experimental_transform:C,onChunk:k,onError:A,onFinish:R,onStepFinish:N,_internal:{now:I=kUe,generateId:O=ZUe,currentDate:L=()=>new Date}={},...P}){return new eqe({model:e,telemetry:m,headers:l,settings:P,maxRetries:a,abortSignal:o,system:r,prompt:s,messages:i,tools:t,toolChoice:n,toolCallStreaming:x,transforms:GUe(C),activeTools:w,repairToolCall:S,maxSteps:c,output:d,continueSteps:h,providerOptions:b,onChunk:k,onError:A,onFinish:R,onStepFinish:N,now:I,currentDate:L,generateId:O,generateMessageId:u})}function QUe(e){if(!e)return new TransformStream({transform(i,a){a.enqueue({part:i,partialOutput:void 0})}});let t="",n="",r="";function s({controller:i,partialOutput:a=void 0}){i.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:a}),n=""}return new TransformStream({transform(i,a){if(i.type==="step-finish"&&s({controller:a}),i.type!=="text-delta"){a.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(s({controller:a,partialOutput:o.partial}),r=l)}},flush(i){n.length>0&&s({controller:i})}})}var eqe=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:s,abortSignal:i,system:a,prompt:o,messages:l,tools:c,toolChoice:u,toolCallStreaming:d,transforms:h,activeTools:m,repairToolCall:y,maxSteps:b,output:v,continueSteps:x,providerOptions:w,now:S,currentDate:C,generateId:k,generateMessageId:A,onChunk:R,onError:N,onFinish:I,onStepFinish:O}){this.warningsPromise=new yo,this.usagePromise=new yo,this.finishReasonPromise=new yo,this.providerMetadataPromise=new yo,this.textPromise=new yo,this.reasoningPromise=new yo,this.reasoningDetailsPromise=new yo,this.sourcesPromise=new yo,this.filesPromise=new yo,this.toolCallsPromise=new yo,this.toolResultsPromise=new yo,this.requestPromise=new yo,this.responsePromise=new yo,this.stepsPromise=new yo;var L;if(b<1)throw new cc({parameter:"maxSteps",value:b,message:"maxSteps must be at least 1"});this.output=v;let P="",V="",F="",X=[],U=[],H,$=[];const ne=[],W={id:k(),timestamp:C(),modelId:e.modelId,messages:[]};let Q=[],ee=[],se,pe,ce="initial";const Ie=[];let De;const Se=new TransformStream({async transform(le,oe){oe.enqueue(le);const{part:re}=le;if((re.type==="text-delta"||re.type==="reasoning"||re.type==="source"||re.type==="tool-call"||re.type==="tool-result"||re.type==="tool-call-streaming-start"||re.type==="tool-call-delta")&&await(R==null?void 0:R({chunk:re})),re.type==="error"&&await(N==null?void 0:N({error:re.error})),re.type==="text-delta"&&(P+=re.textDelta,V+=re.textDelta,F+=re.textDelta),re.type==="reasoning"&&(H==null?(H={type:"text",text:re.textDelta},X.push(H)):H.text+=re.textDelta),re.type==="reasoning-signature"){if(H==null)throw new er({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});H.signature=re.signature,H=void 0}if(re.type==="redacted-reasoning"&&X.push({type:"redacted",data:re.data}),re.type==="file"&&U.push(re),re.type==="source"&&(ne.push(re.source),$.push(re.source)),re.type==="tool-call"&&Q.push(re),re.type==="tool-result"&&ee.push(re),re.type==="step-finish"){const Te=VU({text:V,files:U,reasoning:X,tools:c??{},toolCalls:Q,toolResults:ee,messageId:re.messageId,generateMessageId:A}),Be=Ie.length;let ke="done";Be+1<b&&(x&&re.finishReason==="length"&&Q.length===0?ke="continue":Q.length>0&&ee.length===Q.length&&(ke="tool-result"));const lt={stepType:ce,text:P,reasoning:BUe(X),reasoningDetails:X,files:U,sources:$,toolCalls:Q,toolResults:ee,finishReason:re.finishReason,usage:re.usage,warnings:re.warnings,logprobs:re.logprobs,request:re.request,response:{...re.response,messages:[...W.messages,...Te]},providerMetadata:re.experimental_providerMetadata,experimental_providerMetadata:re.experimental_providerMetadata,isContinued:re.isContinued};await(O==null?void 0:O(lt)),Ie.push(lt),Q=[],ee=[],P="",$=[],X=[],U=[],H=void 0,ke!=="done"&&(ce=ke),ke!=="continue"&&(W.messages.push(...Te),V="")}re.type==="finish"&&(W.id=re.response.id,W.timestamp=re.response.timestamp,W.modelId=re.response.modelId,W.headers=re.response.headers,pe=re.usage,se=re.finishReason)},async flush(le){var oe;try{if(Ie.length===0)return;const re=Ie[Ie.length-1];Ae.warningsPromise.resolve(re.warnings),Ae.requestPromise.resolve(re.request),Ae.responsePromise.resolve(re.response),Ae.toolCallsPromise.resolve(re.toolCalls),Ae.toolResultsPromise.resolve(re.toolResults),Ae.providerMetadataPromise.resolve(re.experimental_providerMetadata),Ae.reasoningPromise.resolve(re.reasoning),Ae.reasoningDetailsPromise.resolve(re.reasoningDetails);const Te=se??"unknown",Be=pe??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Ae.finishReasonPromise.resolve(Te),Ae.usagePromise.resolve(Be),Ae.textPromise.resolve(F),Ae.sourcesPromise.resolve(ne),Ae.filesPromise.resolve(re.files),Ae.stepsPromise.resolve(Ie),await(I==null?void 0:I({finishReason:Te,logprobs:void 0,usage:Be,text:F,reasoning:re.reasoning,reasoningDetails:re.reasoningDetails,files:re.files,sources:re.sources,toolCalls:re.toolCalls,toolResults:re.toolResults,request:(oe=re.request)!=null?oe:{},response:re.response,warnings:re.warnings,providerMetadata:re.providerMetadata,experimental_providerMetadata:re.experimental_providerMetadata,steps:Ie})),De.setAttributes(p0({telemetry:t,attributes:{"ai.response.finishReason":Te,"ai.response.text":{output:()=>F},"ai.response.toolCalls":{output:()=>{var ke;return(ke=re.toolCalls)!=null&&ke.length?JSON.stringify(re.toolCalls):void 0}},"ai.usage.promptTokens":Be.promptTokens,"ai.usage.completionTokens":Be.completionTokens}}))}catch(re){le.error(re)}finally{De.end()}}}),Ce=CUe();this.addStream=Ce.addStream,this.closeStream=Ce.close;let qe=Ce.stream;for(const le of h)qe=qe.pipeThrough(le({tools:c,stopStream(){Ce.terminate()}}));this.baseStream=qe.pipeThrough(QUe(v)).pipeThrough(Se);const{maxRetries:Qe,retry:Ve}=N7e({maxRetries:s}),Ne=O7e(t),K=M7e({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:Qe}}),me=hUe({prompt:{system:(L=v==null?void 0:v.injectIntoSystemPrompt({system:a,model:e}))!=null?L:a,prompt:o,messages:l},tools:c}),Ae=this;M4({name:"ai.streamText",attributes:p0({telemetry:t,attributes:{...N4({operationId:"ai.streamText",telemetry:t}),...K,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:o,messages:l})},"ai.settings.maxSteps":b}}),tracer:Ne,endWhenDone:!1,fn:async le=>{De=le;async function oe({currentStep:re,responseMessages:Te,usage:Be,stepType:ke,previousStepText:lt,hasLeadingWhitespace:Rt,messageId:ft}){var jt;const qt=Te.length===0?me.type:"messages",Lt=[...me.messages,...Te],en=await Y7e({prompt:{type:qt,system:me.system,messages:Lt},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(jt=e.supportsUrl)==null?void 0:jt.bind(e)}),xe={type:"regular",...MUe({tools:c,toolChoice:u,activeTools:m})},{result:{stream:D,warnings:Z,rawResponse:ge,request:Fe},doStreamSpan:we,startTimestampMs:Me}=await Ve(()=>M4({name:"ai.streamText.doStream",attributes:p0({telemetry:t,attributes:{...N4({operationId:"ai.streamText.doStream",telemetry:t}),...K,"ai.prompt.format":{input:()=>qt},"ai.prompt.messages":{input:()=>_Ue(en)},"ai.prompt.tools":{input:()=>{var Xt;return(Xt=xe.tools)==null?void 0:Xt.map(nn=>JSON.stringify(nn))}},"ai.prompt.toolChoice":{input:()=>xe.toolChoice!=null?JSON.stringify(xe.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:Ne,endWhenDone:!1,fn:async Xt=>({startTimestampMs:S(),doStreamSpan:Xt,result:await e.doStream({mode:xe,...Q7e(r),inputFormat:qt,responseFormat:v==null?void 0:v.responseFormat({model:e}),prompt:en,providerMetadata:w,abortSignal:i,headers:n})})})),de=YUe({tools:c,generatorStream:D,toolCallStreaming:d,tracer:Ne,telemetry:t,system:a,messages:Lt,repairToolCall:y,abortSignal:i}),vt=Fe??{},ot=[],B=[],ze=[],st=[];let ye,_e="unknown",Ue={promptTokens:0,completionTokens:0,totalTokens:0},kt,fe=!0,Y="",G=ke==="continue"?lt:"",J,be={id:k(),timestamp:C(),modelId:e.modelId},Pe="",Ge=!1,_t=!0,tn=!1;async function Un({controller:Xt,chunk:nn}){Xt.enqueue(nn),Y+=nn.textDelta,G+=nn.textDelta,Ge=!0,tn=nn.textDelta.trimEnd()!==nn.textDelta}Ae.addStream(de.pipeThrough(new TransformStream({async transform(Xt,nn){var un,mr,Ar;if(fe){const rs=S()-Me;fe=!1,we.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":rs}),we.setAttributes({"ai.response.msToFirstChunk":rs}),nn.enqueue({type:"step-start",messageId:ft,request:vt,warnings:Z??[]})}if(Xt.type==="text-delta"&&Xt.textDelta.length===0)return;const ns=Xt.type;switch(ns){case"text-delta":{if(x){const rs=_t&&Rt?Xt.textDelta.trimStart():Xt.textDelta;if(rs.length===0)break;_t=!1,Pe+=rs;const Cr=jUe(Pe);Cr!=null&&(Pe=Cr.suffix,await Un({controller:nn,chunk:{type:"text-delta",textDelta:Cr.prefix+Cr.whitespace}}))}else await Un({controller:nn,chunk:Xt});break}case"reasoning":{nn.enqueue(Xt),ye==null?(ye={type:"text",text:Xt.textDelta},ze.push(ye)):ye.text+=Xt.textDelta;break}case"reasoning-signature":{if(nn.enqueue(Xt),ye==null)throw new UUe({chunk:Xt,message:"reasoning-signature without reasoning"});ye.signature=Xt.signature,ye=void 0;break}case"redacted-reasoning":{nn.enqueue(Xt),ze.push({type:"redacted",data:Xt.data});break}case"tool-call":{nn.enqueue(Xt),ot.push(Xt);break}case"tool-result":{nn.enqueue(Xt),B.push(Xt);break}case"response-metadata":{be={id:(un=Xt.id)!=null?un:be.id,timestamp:(mr=Xt.timestamp)!=null?mr:be.timestamp,modelId:(Ar=Xt.modelId)!=null?Ar:be.modelId};break}case"finish":{Ue=Xt.usage,_e=Xt.finishReason,kt=Xt.experimental_providerMetadata,J=Xt.logprobs;const rs=S()-Me;we.addEvent("ai.stream.finish"),we.setAttributes({"ai.response.msToFinish":rs,"ai.response.avgCompletionTokensPerSecond":1e3*Ue.completionTokens/rs});break}case"file":{st.push(Xt),nn.enqueue(Xt);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{nn.enqueue(Xt);break}case"error":{nn.enqueue(Xt),_e="error";break}default:{const rs=ns;throw new Error(`Unknown chunk type: ${rs}`)}}},async flush(Xt){const nn=ot.length>0?JSON.stringify(ot):void 0;let un="done";re+1<b&&(x&&_e==="length"&&ot.length===0?un="continue":ot.length>0&&B.length===ot.length&&(un="tool-result")),x&&Pe.length>0&&(un!=="continue"||ke==="continue"&&!Ge)&&(await Un({controller:Xt,chunk:{type:"text-delta",textDelta:Pe}}),Pe="");try{we.setAttributes(p0({telemetry:t,attributes:{"ai.response.finishReason":_e,"ai.response.text":{output:()=>Y},"ai.response.toolCalls":{output:()=>nn},"ai.response.id":be.id,"ai.response.model":be.modelId,"ai.response.timestamp":be.timestamp.toISOString(),"ai.usage.promptTokens":Ue.promptTokens,"ai.usage.completionTokens":Ue.completionTokens,"gen_ai.response.finish_reasons":[_e],"gen_ai.response.id":be.id,"gen_ai.response.model":be.modelId,"gen_ai.usage.input_tokens":Ue.promptTokens,"gen_ai.usage.output_tokens":Ue.completionTokens}}))}catch{}finally{we.end()}Xt.enqueue({type:"step-finish",finishReason:_e,usage:Ue,providerMetadata:kt,experimental_providerMetadata:kt,logprobs:J,request:vt,response:{...be,headers:ge==null?void 0:ge.headers},warnings:Z,isContinued:un==="continue",messageId:ft});const mr=yUe(Be,Ue);if(un==="done")Xt.enqueue({type:"finish",finishReason:_e,usage:mr,providerMetadata:kt,experimental_providerMetadata:kt,logprobs:J,response:{...be,headers:ge==null?void 0:ge.headers}}),Ae.closeStream();else{if(ke==="continue"){const Ar=Te[Te.length-1];typeof Ar.content=="string"?Ar.content+=Y:Ar.content.push({text:Y,type:"text"})}else Te.push(...VU({text:Y,files:st,reasoning:ze,tools:c??{},toolCalls:ot,toolResults:B,messageId:ft,generateMessageId:A}));await oe({currentStep:re+1,responseMessages:Te,usage:mr,stepType:un,previousStepText:G,hasLeadingWhitespace:tn,messageId:un==="continue"?ft:A()})}}})))}await oe({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:A()})}}).catch(le=>{Ae.addStream(new ReadableStream({start(oe){oe.enqueue({type:"error",error:le}),oe.close()}})),Ae.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return zI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return zI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await KUe({stream:this.fullStream,onError:e==null?void 0:e.onError})}catch(n){(t=e==null?void 0:e.onError)==null||t.call(e,n)}}get experimental_partialOutputStream(){if(this.output==null)throw new TUe;return zI(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:s=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,a)=>{const o=i.type;switch(o){case"text-delta":{a.enqueue(Aa("text",i.textDelta));break}case"reasoning":{n&&a.enqueue(Aa("reasoning",i.textDelta));break}case"redacted-reasoning":{n&&a.enqueue(Aa("redacted_reasoning",{data:i.data}));break}case"reasoning-signature":{n&&a.enqueue(Aa("reasoning_signature",{signature:i.signature}));break}case"file":{a.enqueue(Aa("file",{mimeType:i.mimeType,data:i.base64}));break}case"source":{r&&a.enqueue(Aa("source",i.source));break}case"tool-call-streaming-start":{a.enqueue(Aa("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break}case"tool-call-delta":{a.enqueue(Aa("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break}case"tool-call":{a.enqueue(Aa("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break}case"tool-result":{a.enqueue(Aa("tool_result",{toolCallId:i.toolCallId,result:i.result}));break}case"error":{a.enqueue(Aa("error",e(i.error)));break}case"step-start":{a.enqueue(Aa("start_step",{messageId:i.messageId}));break}case"step-finish":{a.enqueue(Aa("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break}case"finish":{s&&a.enqueue(Aa("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c}={}){FU({response:e,status:t,statusText:n,headers:DU(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c})})}pipeTextStreamToResponse(e,t){FU({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:DU(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?A6(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:Lk(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:Lk(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};var kse="2024-11-05",tqe=[kse,"2024-10-07"],nqe=Ke({name:$e(),version:$e()}).passthrough(),R6=Ke({_meta:ta(Ke({}).passthrough())}).passthrough(),Lw=R6,rqe=Ke({method:$e(),params:ta(R6)}),sqe=Ke({experimental:ta(Ke({}).passthrough()),logging:ta(Ke({}).passthrough()),prompts:ta(Ke({listChanged:ta(br())}).passthrough()),resources:ta(Ke({subscribe:ta(br()),listChanged:ta(br())}).passthrough()),tools:ta(Ke({listChanged:ta(br())}).passthrough())}).passthrough(),iqe=Lw.extend({protocolVersion:$e(),capabilities:sqe,serverInfo:nqe,instructions:ta($e())}),aqe=Lw.extend({nextCursor:ta($e())}),oqe=Ke({name:$e(),description:ta($e()),inputSchema:Ke({type:An("object"),properties:ta(Ke({}).passthrough())}).passthrough()}).passthrough(),lqe=aqe.extend({tools:ln(oqe)}),cqe=Ke({type:An("text"),text:$e()}).passthrough(),uqe=Ke({type:An("image"),data:$e().base64(),mimeType:$e()}).passthrough(),Ese=Ke({uri:$e(),mimeType:ta($e())}).passthrough(),dqe=Ese.extend({text:$e()}),fqe=Ese.extend({blob:$e().base64()}),hqe=Ke({type:An("resource"),resource:hs([dqe,fqe])}).passthrough(),pqe=Lw.extend({content:ln(hs([cqe,uqe,hqe])),isError:br().default(!1).optional()}).or(Lw.extend({toolResult:jy()})),FT="2.0",mqe=Ke({jsonrpc:An(FT),id:hs([$e(),Tt().int()])}).merge(rqe).strict(),gqe=Ke({jsonrpc:An(FT),id:hs([$e(),Tt().int()]),result:Lw}).strict(),yqe=Ke({jsonrpc:An(FT),id:hs([$e(),Tt().int()]),error:Ke({code:Tt().int(),message:$e(),data:ta(jy())})}).strict(),bqe=Ke({jsonrpc:An(FT)}).merge(Ke({method:$e(),params:ta(R6)})).strict(),vqe=hs([mqe,bqe,gqe,yqe]),xqe=class{constructor({url:e,headers:t}){this.connected=!1,this.url=new URL(e),this.headers=t}async start(){return new Promise((e,t)=>{if(this.connected)return e();this.abortController=new AbortController,(async()=>{var r,s,i;try{const a=new Headers(this.headers);a.set("Accept","text/event-stream");const o=await fetch(this.url.href,{headers:a,signal:(r=this.abortController)==null?void 0:r.signal});if(!o.ok||!o.body){const d=new ea({message:`MCP SSE Transport Error: ${o.status} ${o.statusText}`});return(s=this.onerror)==null||s.call(this,d),t(d)}const c=o.body.pipeThrough(new TextDecoderStream).pipeThrough(sG()).getReader(),u=async()=>{var d,h,m;try{for(;;){const{done:y,value:b}=await c.read();if(y){if(this.connected)throw this.connected=!1,new ea({message:"MCP SSE Transport Error: Connection closed unexpectedly"});return}const{event:v,data:x}=b;if(v==="endpoint"){if(this.endpoint=new URL(x,this.url),this.endpoint.origin!==this.url.origin)throw new ea({message:`MCP SSE Transport Error: Endpoint origin does not match connection origin: ${this.endpoint.origin}`});this.connected=!0,e()}else if(v==="message")try{const w=vqe.parse(JSON.parse(x));(d=this.onmessage)==null||d.call(this,w)}catch(w){const S=new ea({message:"MCP SSE Transport Error: Failed to parse message",cause:w});(h=this.onerror)==null||h.call(this,S)}}}catch(y){if(y instanceof Error&&y.name==="AbortError")return;(m=this.onerror)==null||m.call(this,y),t(y)}};this.sseConnection={close:()=>c.cancel()},u()}catch(a){if(a instanceof Error&&a.name==="AbortError")return;(i=this.onerror)==null||i.call(this,a),t(a)}})()})}async close(){var e,t,n;this.connected=!1,(e=this.sseConnection)==null||e.close(),(t=this.abortController)==null||t.abort(),(n=this.onclose)==null||n.call(this)}async send(e){var t,n,r;if(!this.endpoint||!this.connected)throw new ea({message:"MCP SSE Transport Error: Not connected"});try{const s=new Headers(this.headers);s.set("Content-Type","application/json");const i={method:"POST",headers:s,body:JSON.stringify(e),signal:(t=this.abortController)==null?void 0:t.signal},a=await fetch(this.endpoint,i);if(!a.ok){const o=await a.text().catch(()=>null),l=new ea({message:`MCP SSE Transport Error: POSTing to endpoint (HTTP ${a.status}): ${o}`});(n=this.onerror)==null||n.call(this,l);return}}catch(s){(r=this.onerror)==null||r.call(this,s);return}}};function wqe(e){if(e.type!=="sse")throw new ea({message:"Unsupported or invalid transport configuration. If you are using a custom transport, make sure it implements the MCPTransport interface."});return new xqe(e)}function _qe(e){return"start"in e&&typeof e.start=="function"&&"send"in e&&typeof e.send=="function"&&"close"in e&&typeof e.close=="function"}var Sqe="1.0.0";async function WU(e){const t=new Cqe(e);return await t.init(),t}var Cqe=class{constructor({transport:e,name:t="ai-sdk-mcp-client",onUncaughtError:n}){this.requestMessageId=0,this.responseHandlers=new Map,this.serverCapabilities={},this.isClosed=!0,this.onUncaughtError=n,_qe(e)?this.transport=e:this.transport=wqe(e),this.transport.onclose=()=>this.onClose(),this.transport.onerror=r=>this.onError(r),this.transport.onmessage=r=>{if("method"in r){this.onError(new ea({message:"Unsupported message type"}));return}this.onResponse(r)},this.clientInfo={name:t,version:Sqe}}async init(){try{await this.transport.start(),this.isClosed=!1;const e=await this.request({request:{method:"initialize",params:{protocolVersion:kse,capabilities:{},clientInfo:this.clientInfo}},resultSchema:iqe});if(e===void 0)throw new ea({message:"Server sent invalid initialize result"});if(!tqe.includes(e.protocolVersion))throw new ea({message:`Server's protocol version is not supported: ${e.protocolVersion}`});return this.serverCapabilities=e.capabilities,await this.notification({method:"notifications/initialized"}),this}catch(e){throw await this.close(),e}}async close(){var e;this.isClosed||(await((e=this.transport)==null?void 0:e.close()),this.onClose())}assertCapability(e){switch(e){case"initialize":break;case"tools/list":case"tools/call":if(!this.serverCapabilities.tools)throw new ea({message:"Server does not support tools"});break;default:throw new ea({message:`Unsupported method: ${e}`})}}async request({request:e,resultSchema:t,options:n}){return new Promise((r,s)=>{if(this.isClosed)return s(new ea({message:"Attempted to send a request from a closed client"}));this.assertCapability(e.method);const i=n==null?void 0:n.signal;i==null||i.throwIfAborted();const a=this.requestMessageId++,o={...e,jsonrpc:"2.0",id:a},l=()=>{this.responseHandlers.delete(a)};this.responseHandlers.set(a,c=>{if(i!=null&&i.aborted)return s(new ea({message:"Request was aborted",cause:i.reason}));if(c instanceof Error)return s(c);try{const u=t.parse(c.result);r(u)}catch(u){const d=new ea({message:"Failed to parse server response",cause:u});s(d)}}),this.transport.send(o).catch(c=>{l(),s(c)})})}async listTools({params:e,options:t}={}){try{return this.request({request:{method:"tools/list",params:e},resultSchema:lqe,options:t})}catch(n){throw n}}async callTool({name:e,args:t,options:n}){try{return this.request({request:{method:"tools/call",params:{name:e,arguments:t}},resultSchema:pqe,options:{signal:n==null?void 0:n.abortSignal}})}catch(r){throw r}}async notification(e){const t={...e,jsonrpc:"2.0"};await this.transport.send(t)}async tools({schemas:e="automatic"}={}){var t;const n={};try{const r=await this.listTools();for(const{name:s,description:i,inputSchema:a}of r.tools){if(e!=="automatic"&&!(s in e))continue;const o=e==="automatic"?Ere({...a,properties:(t=a.properties)!=null?t:{},additionalProperties:!1}):e[s].parameters,l=this,c={description:i,parameters:o,execute:async(u,d)=>{var h;return(h=d==null?void 0:d.abortSignal)==null||h.throwIfAborted(),l.callTool({name:s,args:u,options:d})}};n[s]=c}return n}catch(r){throw r}}onClose(){if(this.isClosed)return;this.isClosed=!0;const e=new ea({message:"Connection closed"});for(const t of this.responseHandlers.values())t(e);this.responseHandlers.clear()}onError(e){this.onUncaughtError&&this.onUncaughtError(e)}onResponse(e){const t=Number(e.id),n=this.responseHandlers.get(t);if(n===void 0)throw new ea({message:`Protocol error: Received a response for an unknown message ID: ${JSON.stringify(e)}`});this.responseHandlers.delete(t),n("result"in e?e:new ea({message:e.error.message,cause:e.error}))}},kqe={};E6(kqe,{mergeIntoDataStream:()=>Aqe,toDataStream:()=>Eqe,toDataStreamResponse:()=>Tqe});function Tse(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,s){s.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function N6(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var s;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&HU((s=n.data)==null?void 0:s.chunk,r);return}HU(n,r)}})).pipeThrough(Tse(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(Aa("text",n))}}))}function Eqe(e,t){return N6(e,t).pipeThrough(new TextEncoderStream)}function Tqe(e,t){var n;const r=N6(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),s=t==null?void 0:t.data,i=t==null?void 0:t.init,a=s?A6(s.stream,r):r;return new Response(a,{status:(n=i==null?void 0:i.status)!=null?n:200,statusText:i==null?void 0:i.statusText,headers:Lk(i==null?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Aqe(e,t){t.dataStream.merge(N6(e,t.callbacks))}function HU(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var Rqe={};E6(Rqe,{mergeIntoDataStream:()=>Iqe,toDataStream:()=>Nqe,toDataStreamResponse:()=>Mqe});function M6(e,t){const n=jqe();return cye(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,s){s.enqueue(n(r.delta))}})).pipeThrough(Tse(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,s)=>{s.enqueue(Aa("text",r))}}))}function Nqe(e,t){return M6(e,t).pipeThrough(new TextEncoderStream)}function Mqe(e,t={}){var n;const{init:r,data:s,callbacks:i}=t,a=M6(e,i).pipeThrough(new TextEncoderStream),o=s?A6(s.stream,a):a;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:Lk(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Iqe(e,t){t.dataStream.merge(M6(e,t.callbacks))}function jqe(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class Oqe{static async executeInteraction(t,n,r){let s,i=!1,a=null,o,l,c;try{s=await JUe(n);for await(const u of s.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(u.type){case"text-delta":r.onChunk(u.textDelta);break;case"reasoning":r.onReasoningChunk(u.textDelta);break;case"tool-call":r.onToolCall(u);break;case"tool-result":r.onToolResult(u);break;case"step-start":r.onStepStart&&r.onStepStart({messageId:u.messageId,request:u.request,warnings:u.warnings||[]}),console.log(`[AIService] Step started for ${t} - Message ID: ${u.messageId}`);break;case"step-finish":r.onStepFinish&&r.onStepFinish({finishReason:u.finishReason,usage:u.usage,isContinued:u.isContinued||!1,warnings:u.warnings||[]}),console.log(`[AIService] Step finished for ${t} - Reason: ${u.finishReason}, Continued: ${u.isContinued}`);break;case"finish":i=!0,a=u.finishReason,o=u.usage,l=u.providerMetadata;break;case"error":r.onError(new Error(`AI Stream Error Part: ${u.error instanceof Error?u.error.message:u.error}`));return;default:console.warn(`[AIService] Received unexpected stream part type: ${u.type} for ${t}`,u);break}}s!=null&&s.reasoning?(c=await s.reasoning,console.log(`[AIService] Extracted final reasoning for ${t}`)):console.log(`[AIService] No final reasoning found in stream result for ${t}.`),!n.abortSignal.aborted&&i?r.onFinish({finishReason:a,usage:o,providerMetadata:l,reasoning:c}):!n.abortSignal.aborted&&!i&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(u){console.error(`[AIService] Error during streamText call for ${t}:`,u),u instanceof Error&&u.name==="AbortError"||r.onError(u instanceof Error?u:new Error(String(u)))}finally{console.log(`[AIService] Stream processing finished for ${t}.`)}}}const Pqe=".litechat/conversations",Ase="/synced_repos";async function Dqe(e,t,n,r=!1){n(t.id,"syncing");const s=zr(`${Ase}/${t.id}`),i={username:t.username,password:t.password},a=t.branch||"main";try{let o=!1;try{await e.promises.stat(Au(s,".git")),o=!0}catch(l){if(l.code==="ENOENT")o=!1;else throw l}o?(r||Oe.info(`Pulling latest changes for "${t.name}"...`),await QE(s,a,i,{fsInstance:e}),r||Oe.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(r||Oe.info(`Cloning repository "${t.name}"...`),await fZ(s,t.remoteUrl,a,i,{fsInstance:e}),r||Oe.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(o){console.error(`Failed to initialize/sync repository ${t.name}:`,o),n(t.id,"error")}}async function Fqe(e,t,n,r,s,i,a,o=!1){var h,m;r(t.id,"syncing");const l=zr(`${Ase}/${n.id}`),c=Au(l,Pqe,`${t.id}.json`),u={username:n.username,password:n.password},d=n.branch||"main";try{try{await e.promises.stat(Au(l,".git"))}catch(w){if(w.code==="ENOENT"){Oe.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw w}o||Oe.info(`Pulling latest changes for "${n.name}"...`),await QE(l,d,u,{fsInstance:e});let y=null,b=null;try{const w=await Gh(c,{fsInstance:e}),S=new TextDecoder().decode(w);y=JSON.parse(S),b=(h=y==null?void 0:y.conversation)!=null&&h.updatedAt?new Date(y.conversation.updatedAt).getTime():null,isNaN(b??NaN)&&(b=null)}catch(w){w.code==="ENOENT"?console.log(`Conversation file ${c} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${w.message}`),Oe.warning(`Could not read remote version of conversation: ${w.message}`))}const v=t.updatedAt.getTime(),x=((m=t.lastSyncedAt)==null?void 0:m.getTime())??0;if(!y||v>(b??0)||v>x&&v>=(b??0)){o||Oe.info("Local changes detected. Pushing to remote...");const w=await Et.loadInteractionsForConversation(t.id),{lastSyncedAt:S,...C}=t,k=JSON.stringify({conversation:C,interactions:w},null,2);await eT(c,k,{fsInstance:e}),await aD(l,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await oD(l,d,u,{fsInstance:e}),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),o||Oe.success("Conversation synced successfully (pushed).")}else if(b&&b>v){o||Oe.info("Remote changes detected. Updating local conversation...");const w={...y.conversation,createdAt:new Date(y.conversation.createdAt),updatedAt:new Date(y.conversation.updatedAt),lastSyncedAt:new Date};await Et.saveConversation(w),await Et.deleteInteractionsForConversation(t.id);const S=y.interactions.map(C=>Et.saveInteraction({...C,conversationId:t.id,startedAt:C.startedAt?new Date(C.startedAt):null,endedAt:C.endedAt?new Date(C.endedAt):null}));await Promise.all(S),i()===t.id&&a()==="conversation"&&await Bn.getState().loadInteractions(t.id),r(t.id,"idle"),o||Oe.success("Conversation synced successfully (pulled).")}else o||Oe.info("Conversation already up-to-date."),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(y){console.error(`Sync failed for conversation ${t.id}:`,y),r(t.id,"error",y.message)}}const ba={loaded:"project.loaded",added:"project.added",updated:"project.updated",deleted:"project.deleted",loadingStateChanged:"project.loading.state.changed",loadProjectsRequest:"project.load.projects.request",addProjectRequest:"project.add.project.request",updateProjectRequest:"project.update.project.request",deleteProjectRequest:"project.delete.project.request"},Yn={conversationsLoaded:"conversation.conversations.loaded",selectedItemChanged:"conversation.selected.item.changed",conversationAdded:"conversation.added",conversationUpdated:"conversation.updated",conversationDeleted:"conversation.deleted",conversationSyncStatusChanged:"conversation.sync.status.changed",syncReposLoaded:"conversation.sync.repos.loaded",syncRepoChanged:"conversation.sync.repo.changed",syncRepoInitStatusChanged:"conversation.sync.repo.init.status.changed",loadingStateChanged:"conversation.loading.state.changed",loadConversationsRequest:"conversation.load.conversations.request",addConversationRequest:"conversation.add.conversation.request",updateConversationRequest:"conversation.update.conversation.request",deleteConversationRequest:"conversation.delete.conversation.request",selectItemRequest:"conversation.select.item.request",importConversationRequest:"conversation.import.conversation.request",exportConversationRequest:"conversation.export.conversation.request",exportProjectRequest:"conversation.export.project.request",exportAllConversationsRequest:"conversation.export.all.conversations.request",loadSyncReposRequest:"conversation.load.sync.repos.request",addSyncRepoRequest:"conversation.add.sync.repo.request",updateSyncRepoRequest:"conversation.update.sync.repo.request",deleteSyncRepoRequest:"conversation.delete.sync.repo.request",linkConversationToRepoRequest:"conversation.link.conversation.to.repo.request",syncConversationRequest:"conversation.sync.conversation.request",initializeOrSyncRepoRequest:"conversation.initialize.or.sync.repo.request",updateCurrentConversationToolSettingsRequest:"conversation.update.current.conversation.tool.settings.request"},Oo=Fo(Lo((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await Et.loadProjects();e({projects:n,isLoading:!1}),je.emit(ba.loaded,{projects:n})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1}),je.emit(ba.loadingStateChanged,{isLoading:!1,error:"Failed to load projects"})}},addProject:async n=>{var l;const r=qi(),s=new Date,i=n.parentId?((l=t().getProjectById(n.parentId))==null?void 0:l.path)??"/":"/",a=zr(`${i}/${n.name.replace(/\s+/g,"-").toLowerCase()}-${r.substring(0,4)}`),o={id:r,path:a,createdAt:s,updatedAt:s,name:n.name,parentId:n.parentId??null,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,defaultTagIds:n.defaultTagIds??null,defaultRuleIds:n.defaultRuleIds??null,metadata:n.metadata??{}};try{return await Et.saveProject(o),e(c=>{c.projects.unshift(o),c.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime())}),je.emit(ba.added,{project:o}),r}catch(c){throw console.error("ProjectStore: Error adding project",c),e({error:"Failed to save new project"}),c}},updateProject:async(n,r)=>{var a;const s=t().getProjectById(n);if(!s){console.warn(`ProjectStore: Project ${n} not found for update.`);return}const i={...s,...r,updatedAt:new Date};if(r.name&&r.name!==s.name){const o=s.parentId?((a=t().getProjectById(s.parentId))==null?void 0:a.path)??"/":"/";i.path=zr(`${o}/${r.name.replace(/\s+/g,"-").toLowerCase()}-${n.substring(0,4)}`)}try{await Et.saveProject(i),e(o=>{const l=o.projects.findIndex(c=>c.id===n);l!==-1&&(o.projects[l]=i,o.projects.sort((c,u)=>u.updatedAt.getTime()-c.updatedAt.getTime()))}),je.emit(ba.updated,{projectId:n,updates:i})}catch(o){throw console.error("ProjectStore: Error updating project",o),e({error:"Failed to save project update"}),o}},deleteProject:async n=>{const r=t().projects.find(a=>a.id===n);if(!r)return;const s=new Set,i=a=>{s.add(a),t().projects.filter(o=>o.parentId===a).forEach(o=>i(o.id))};i(n);try{await Et.deleteProject(n),e(a=>({projects:a.projects.filter(o=>!s.has(o.id))})),je.emit(Yn.loadConversationsRequest,void 0),je.emit(ba.deleted,{projectId:n}),Oe.success(`Project "${r.name}" and its contents deleted.`)}catch(a){throw console.error("ProjectStore: Error deleting project",a),e({error:"Failed to delete project"}),a}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getTopLevelProjectId:n=>{if(!n)return null;let r=t().getProjectById(n);if(!r)return null;for(;r.parentId;){const s=t().getProjectById(r.parentId);if(!s)break;r=s}return r.id},getEffectiveProjectSettings:n=>{const r=yr.getState(),s=Rr.getState().selectedModelId,i={systemPrompt:r.globalSystemPrompt,modelId:s,temperature:r.temperature,maxTokens:r.maxTokens,topP:r.topP,topK:r.topK,presencePenalty:r.presencePenalty,frequencyPenalty:r.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null};if(!n)return i;const a=t().getProjectById(n);if(!a)return i;const o=a.parentId?t().getEffectiveProjectSettings(a.parentId):i;return{systemPrompt:a.systemPrompt!==null&&a.systemPrompt!==void 0?a.systemPrompt:o.systemPrompt,modelId:a.modelId!==null&&a.modelId!==void 0?a.modelId:o.modelId,temperature:a.temperature!==null&&a.temperature!==void 0?a.temperature:o.temperature,maxTokens:a.maxTokens!==null&&a.maxTokens!==void 0?a.maxTokens:o.maxTokens,topP:a.topP!==null&&a.topP!==void 0?a.topP:o.topP,topK:a.topK!==null&&a.topK!==void 0?a.topK:o.topK,presencePenalty:a.presencePenalty!==null&&a.presencePenalty!==void 0?a.presencePenalty:o.presencePenalty,frequencyPenalty:a.frequencyPenalty!==null&&a.frequencyPenalty!==void 0?a.frequencyPenalty:o.frequencyPenalty,defaultTagIds:a.defaultTagIds!==null&&a.defaultTagIds!==void 0?a.defaultTagIds:o.defaultTagIds,defaultRuleIds:a.defaultRuleIds!==null&&a.defaultRuleIds!==void 0?a.defaultRuleIds:o.defaultRuleIds}},getRegisteredActionHandlers:()=>{const n="projectStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:ba.loadProjectsRequest,handler:r.loadProjects,storeId:n},{eventName:ba.addProjectRequest,handler:s(r.addProject),storeId:n},{eventName:ba.updateProjectRequest,handler:i=>r.updateProject(i.id,i.updates),storeId:n},{eventName:ba.deleteProjectRequest,handler:i=>r.deleteProject(i.id),storeId:n}]}}))),JS=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},Lqe=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${hw(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${hw(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,s)=>r.index-s.index).forEach(r=>{var s,i,a,o,l,c,u,d;((s=r.prompt)!=null&&s.content||(o=(a=(i=r.prompt)==null?void 0:i.metadata)==null?void 0:a.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(h=>{n+=`- ${h.name} (${h.type}, ${nw(h.size)}) ${h.source==="vfs"?`(VFS: ${h.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(c=r.metadata)!=null&&c.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((u=r.metadata)!=null&&u.promptTokens||(d=r.metadata)!=null&&d.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class m0{static async importConversation(t,n,r){try{const s=await t.text(),i=JSON.parse(s);if(!i||typeof i!="object"||!i.conversation||!Array.isArray(i.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const a=i.conversation,o=i.interactions;if(!a.id||!a.title||!a.createdAt||!a.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:a.title||"Imported Chat",metadata:a.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),c=o.map(u=>Et.saveInteraction({...u,conversationId:l,id:qi()}));await Promise.all(c),await r(l,"conversation"),Oe.success("Conversation imported successfully.")}catch(s){throw console.error("ImportExportService: Error importing conversation",s),Oe.error(`Import failed: ${s instanceof Error?s.message:String(s)}`),s}}static async exportConversation(t,n){try{const r=qn.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const s=await Et.loadInteractionsForConversation(t);let i,a;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const c=JSON.stringify({conversation:r,interactions:s},null,2);i=new Blob([c],{type:"application/json"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=Lqe(r,s);i=new Blob([l],{type:"text/markdown"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");JS(i,a),Oe.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),Oe.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=Oo.getState(),{conversations:s}=qn.getState(),i=r(t);if(!i)throw new Error("Project not found.");const a=async h=>{const m=n.find(x=>x.id===h);if(!m)throw new Error(`Project ${h} not found in state.`);const y=n.filter(x=>x.parentId===h),b=s.filter(x=>x.projectId===h),v=[];for(const x of y)v.push(await a(x.id));for(const x of b){const w=await Et.loadInteractionsForConversation(x.id);v.push({conversation:x,interactions:w})}return{project:m,children:v}},o=await a(t),l=JSON.stringify(o,null,2),c=new Blob([l],{type:"application/json"}),d=`litechat_project_${i.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;JS(c,d),Oe.success(`Project "${i.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),Oe.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=qn.getState().conversations,n=[];for(const a of t){const o=await Et.loadInteractionsForConversation(a.id);n.push({conversation:a,interactions:o})}const r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;JS(s,i),Oe.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),Oe.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportFullConfiguration(t){try{const n=await Et.getAllDataForExport(t),r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_full_export_${new Date().toISOString().split("T")[0]}.json`;JS(s,i),Oe.success("Full configuration exported successfully.")}catch(n){throw console.error("ImportExportService: Error exporting full configuration",n),Oe.error(`Full export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importFullConfiguration(t,n){try{const r=await t.text(),s=JSON.parse(r);if(!s||typeof s!="object"||!s.version)throw new Error("Invalid import file format. Missing version or basic structure.");await Et.importAllData(s,n),Oe.success("Configuration imported successfully. Reloading application..."),setTimeout(()=>window.location.reload(),1500)}catch(r){throw console.error("ImportExportService: Error importing full configuration",r),Oe.error(`Full import failed: ${r instanceof Error?r.message:String(r)}`),r}}}const Yc="sync_repos",cs={repoChanged:"sync.repo.changed",repoInitStatusChanged:"sync.repo.init.status.changed",bulkSyncStarted:"sync.bulk.sync.started",bulkSyncProgress:"sync.bulk.sync.progress",bulkSyncCompleted:"sync.bulk.sync.completed",bulkSyncFailed:"sync.bulk.sync.failed"},Xs=Fo(Lo((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)}),je.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n}),je.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&Oe.error(`VFS Error: ${n}`)}),je.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_addNodes:n=>{e(r=>{const s={};n.forEach(i=>{r.nodes[i.id]=i;const a=i.parentId??r.rootId??"";s[a]||(s[a]=r.childrenMap[a]?[...r.childrenMap[a]]:[]),s[a].includes(i.id)||s[a].push(i.id)});for(const i in s)(!r.childrenMap[i]||JSON.stringify(r.childrenMap[i].sort())!==JSON.stringify(s[i].sort()))&&(r.childrenMap[i]=s[i])}),je.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_updateNode:(n,r)=>{e(s=>{s.nodes[n]&&Object.assign(s.nodes[n],r)}),je.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_removeNodes:n=>{e(r=>{n.forEach(s=>{const i=r.nodes[s];if(i){const a=i.parentId??r.rootId??"";if(r.childrenMap[a]&&(r.childrenMap[a]=r.childrenMap[a].filter(o=>o!==s)),delete r.nodes[s],r.selectedFileIds.delete(s),i.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===s).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[s]}}})}),je.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap}),je.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},_setFsInstance:n=>{e({fs:n}),je.emit(dn.fsInstanceChanged,{fsInstance:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),je.emit(dn.vfsEnabledChanged,{enabled:n}),n||(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),je.emit(dn.vfsKeyChanged,{vfsKey:null,configuredVfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),je.emit(dn.vfsKeyChanged,{vfsKey:t().vfsKey,configuredVfsKey:n})},setVfsKey:n=>{if(n!==null){const r=t().vfsKey,s=t().configuredVfsKey;if(n===r){n&&n!==s&&!t().initializingKey&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,i)});return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${s}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),je.emit(dn.vfsKeyChanged,{vfsKey:n,configuredVfsKey:null}),n!==null&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,i)})}},initializeVFS:async(n,r)=>{let s,i;if(typeof n=="object"&&n!==null&&"vfsKey"in n)console.warn("[VfsStore] initializeVFS called with a single object payload. Correcting. Input:",JSON.parse(JSON.stringify(n))),s=String(n.vfsKey),i=n.options;else if(typeof n=="string")s=n,i=r;else{const h=`[VfsStore] initializeVFS called with invalid vfsKey type. Type: ${typeof n}, Value: "${String(n)}". Aborting.`;throw console.error(h,n),new Error("VFS key must be a string and cannot be empty.")}if(!s||s.trim()===""){const h=`[VfsStore] initializeVFS: Derived vfsKey is empty or invalid. Original param: ${String(n)}, Derived key: "${s}". Aborting.`;throw console.error(h,{originalVfsKeyParam:n,originalOptionsParam:r}),new Error("VFS key cannot be empty after processing.")}const a=(i==null?void 0:i.force)===!0;if(t().initializingKey===s){const h=`Initialization skipped for "${s}". Already actively initializing this exact key.`;return console.warn(`[VfsStore] ${h}`),new Promise((m,y)=>{const b=setInterval(()=>{const v=t();v.initializingKey!==s&&(clearInterval(b),v.configuredVfsKey===s&&v.fs?m(v.fs):y(new Error(`VFS initialization for "${s}" failed or was interrupted`)))},100);setTimeout(()=>{clearInterval(b),y(new Error(`Timeout waiting for VFS "${s}" initialization to complete`))},1e4)})}if(t().configuredVfsKey===s&&t().fs)return a||e({loading:!1}),t().fs;if(!a){if(t().vfsKey!==s){const h=`UI Initialization aborted for "${s}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}if(t().initializingKey!==null&&t().initializingKey!==s){const h=`UI Initialization skipped for "${s}". Already initializing a different key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}}const{_setLoading:o,_setError:l,_addNodes:c,_setFsInstance:u,_setConfiguredVfsKey:d}=t();console.log(`[VfsStore] Initializing VFS with key: ${s} (Forced: ${a})`),e({initializingKey:s}),a||(o(!0),l(null));try{const h=await oTe(s);if(!h)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==s){const b=`UI Initialization for key "${s}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${b}`),e({initializingKey:null,loading:!1}),new Error(b)}if(a)return u(h),d(s),e({initializingKey:null}),je.emit(dn.loadingStateChanged,{isLoading:!1,operationLoading:!1,error:null}),h;u(h),d(s),console.log(`[VfsStore] UI VFS instance configured for key: ${s}`);const m="vfs-root";let y=t().nodes[m];try{await h.promises.stat("/")}catch(b){if(b.code==="ENOENT")console.warn("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw b}if(!y||y.path!=="/"){const b=Date.now();y={id:m,parentId:null,name:"",path:"/",type:"folder",createdAt:b,lastModified:b},c([y])}return e(b=>{b.rootId=y.id,b.currentParentId=y.id}),await t().fetchNodes(y.id),h}catch(h){const m=`Failed to initialize VFS (${s}): ${h instanceof Error?h.message:String(h)}`;throw console.error(`[VfsStore DEBUG] Error in initializeVFS catch block: ${m}`,h),t().initializingKey===s&&(l(m),a||(u(null),d(null))),new Error(m)}finally{t().initializingKey===s&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:s,_addNodes:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u,initializingKey:d}=t();if(!a||c!==u||d){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!a}, Match: ${c===u}, Init: ${d}`);return}r(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=await lD(m,{fsInstance:a}),b=n??l??"",v=new Set(y.map(k=>k.path)),S=(t().childrenMap[b]||[]).map(k=>t().nodes[k]).filter(Boolean).filter(k=>!v.has(k.path)).map(k=>k.id);S.length>0&&t()._removeNodes(S);const C=y.map(k=>{const A=Object.values(t().nodes).find(N=>N.path===k.path),R=Date.now();return{id:(A==null?void 0:A.id)||qi(),parentId:n,name:k.name,path:k.path,type:k.isDirectory?"folder":"file",size:k.size,createdAt:(A==null?void 0:A.createdAt)??R,lastModified:k.lastModified.getTime(),mimeType:k.isDirectory?void 0:k.mimeType}});C.length>0&&i(C),e(k=>{const A=C.map(R=>R.id);(!k.childrenMap[b]||JSON.stringify(k.childrenMap[b].sort())!==JSON.stringify(A.sort()))&&(k.childrenMap[b]=A)})}catch(h){console.error("Failed to fetch VFS nodes:",h),s("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=zr(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const s=t().rootId;return s?t().nodes[s]:void 0}return Object.values(t().nodes).find(s=>s.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:s,rootId:i,fs:a}=t();if(!a||t().vfsKey!==t().configuredVfsKey)return;const o=zr(n),l=r(o);l&&l.type==="folder"?(e(c=>{c.currentParentId=l.id}),t().childrenMap[l.id]||await s(l.id)):o==="/"&&i?(e(c=>{c.currentParentId=i}),t().childrenMap[i]||await s(i)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,_addNodes:c,configuredVfsKey:u,vfsKey:d}=t();if(!a||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Directory name cannot be empty.");return}s(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=Sj(m,r.trim());try{throw await a.promises.stat(y),new Error(`"${r.trim()}" already exists.`)}catch(w){if(w.code!=="ENOENT")throw w}await mZ(y,{fsInstance:a});const b=Date.now(),x={id:qi(),parentId:n,name:r.trim(),path:y,type:"folder",createdAt:b,lastModified:b};c([x])}catch(h){console.error("Failed to create directory:",h),i(h.message||"Failed to create directory.")}finally{s(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u}=t();if(!a||c!==u){i("Filesystem not ready.");return}s(!0);try{const d=n?o[n]:o[l||""],h=d?d.path:"/";await gZ(Array.from(r),h,{fsInstance:a}),await t().fetchNodes(n)}catch(d){console.error("Failed to upload files:",d),i("Failed to upload one or more files.")}finally{s(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:s,_removeNodes:i,fs:a,configuredVfsKey:o,vfsKey:l}=t();if(!a||o!==l){s("Filesystem not ready.");return}r(!0);try{const c=n.map(u=>t().nodes[u]).filter(Boolean);for(const u of c)await cD(u.path,u.type==="folder",{fsInstance:a});i(n)}catch(c){console.error("Failed to delete nodes:",c),s("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:s,_setError:i,_updateNode:a,nodes:o,fs:l,rootId:c,configuredVfsKey:u,vfsKey:d}=t();if(!l||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Name cannot be empty.");return}const h=o[n];if(!h){i("Item not found.");return}if(h.name!==r.trim()){s(!0);try{const m=h.parentId?o[h.parentId]:o[c||""],y=m?m.path:"/",b=Sj(y,r.trim());try{throw await l.promises.stat(b),new Error(`"${r.trim()}" already exists.`)}catch(x){if(x.code!=="ENOENT")throw x}await yZ(h.path,b,{fsInstance:l});const v={name:r.trim(),path:b,lastModified:Date.now()};a(n,v)}catch(m){console.error("Failed to rename item:",m),i(m.message||"Failed to rename item.")}finally{s(!1)}}},downloadFile:async n=>{const{nodes:r,fs:s,_setError:i,configuredVfsKey:a,vfsKey:o}=t();if(!s||a!==o)return i("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return i("File not found."),null;try{const c=await Gh(l.path,{fsInstance:s}),u=l.mimeType||"application/octet-stream",d=new Blob([c],{type:u});return{name:l.name,blob:d}}catch(c){return console.error("Failed to download file:",c),i("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{r.selectedFileIds.add(n)}),je.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)}),je.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()}),je.emit(dn.selectionChanged,{selectedFileIds:[]})},resetStuckInitialization:()=>{console.warn("[VfsStore] Force resetting stuck initialization state"),e({initializingKey:null,loading:!1,operationLoading:!1,error:null})},getRegisteredActionHandlers:()=>{const n="vfsStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:dn.setVfsKeyRequest,handler:i=>r.setVfsKey(i.key),storeId:n},{eventName:dn.initializeVFSRequest,handler:async i=>{await r.initializeVFS(i.vfsKey,i.options)},storeId:n},{eventName:dn.fetchNodesRequest,handler:i=>r.fetchNodes(i.parentId),storeId:n},{eventName:dn.setCurrentPathRequest,handler:i=>r.setCurrentPath(i.path),storeId:n},{eventName:dn.createDirectoryRequest,handler:i=>r.createDirectory(i.parentId,i.name),storeId:n},{eventName:dn.uploadFilesRequest,handler:i=>r.uploadFiles(i.parentId,i.files),storeId:n},{eventName:dn.deleteNodesRequest,handler:i=>r.deleteNodes(i.ids),storeId:n},{eventName:dn.renameNodeRequest,handler:i=>r.renameNode(i.id,i.newName),storeId:n},{eventName:dn.downloadFileRequest,handler:s(r.downloadFile),storeId:n},{eventName:dn.selectFileRequest,handler:i=>r.selectFile(i.fileId),storeId:n},{eventName:dn.deselectFileRequest,handler:i=>r.deselectFile(i.fileId),storeId:n},{eventName:dn.clearSelectionRequest,handler:r.clearSelection,storeId:n},{eventName:dn.setEnableVfsRequest,handler:i=>r._setEnableVfs(i.enabled),storeId:n}]}}))),Bqe="/synced_repos",qn=Fo(Lo((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>(console.log("[ConversationStore] Ensuring Sync VFS is ready..."),Xs.getState().initializingKey===Yc&&(console.warn("[ConversationStore] VFS appears stuck in initializing state, resetting..."),Xs.getState().resetStuckInitialization()),new Promise((r,s)=>{let i=null;const a=()=>{je.off(dn.fsInstanceChanged,o),je.off(dn.loadingStateChanged,l),i&&(clearTimeout(i),i=null)},o=u=>{Xs.getState().configuredVfsKey===Yc&&u.fsInstance&&(console.log(`[ConversationStore] Sync VFS ready via fsInstanceChanged for key ${Yc}.`),a(),r(u.fsInstance))},l=u=>{const d=Xs.getState();d.configuredVfsKey===Yc&&(u.error?(console.error(`[ConversationStore] Sync VFS initialization error for key ${Yc}: ${u.error}`),a(),s(new Error(u.error))):!u.isLoading&&!u.operationLoading&&d.fs&&(console.log(`[ConversationStore] Sync VFS ready via loadingStateChanged for key ${Yc}.`),a(),r(d.fs)))};je.on(dn.fsInstanceChanged,o),je.on(dn.loadingStateChanged,l);const c=Xs.getState();if(c.configuredVfsKey===Yc&&c.fs&&!c.loading&&!c.operationLoading&&!c.error){console.log(`[ConversationStore] Sync VFS already ready for key ${Yc}.`),a(),r(c.fs);return}i=setTimeout(()=>{const u=`Timeout waiting for Sync VFS (${Yc}) to become ready.`;console.error(`[ConversationStore] ${u}`),a(),s(new Error(u))},3e4),je.emit(dn.initializeVFSRequest,{vfsKey:Yc,options:{force:!0}})})),loadConversations:async()=>{e({isLoading:!0,error:null});try{const[n,r]=await Promise.all([Et.loadConversations(),Et.loadSyncRepos()]),s={};n.forEach(i=>{if(i.syncRepoId){const a=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,o=i.updatedAt instanceof Date?i.updatedAt.getTime():null;a?o&&o>a?s[i.id]="needs-sync":s[i.id]="idle":s[i.id]="needs-sync"}else s[i.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:s,repoInitializationStatus:{},isLoading:!1}),je.emit(Yn.conversationsLoaded,{conversations:n}),je.emit(Yn.syncReposLoaded,{repos:r})}catch(n){console.error("ConversationStore: Error loading conversations",n),e({error:"Failed load conversations",isLoading:!1}),je.emit(Yn.loadingStateChanged,{isLoading:!1,error:"Failed load conversations"})}},addConversation:async n=>{const r=qi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};let a=!1;try{const o=JSON.stringify(i);return await Et.saveConversation(JSON.parse(o)),a=!0,e(l=>{l.conversations.some(c=>c.id===i.id)||(l.conversations.unshift(i),l.conversationSyncStatus[r]=i.syncRepoId?"needs-sync":"idle")}),je.emit(Yn.conversationAdded,{conversation:i}),r}catch(o){throw console.error("ConversationStore: Error adding conversation",o),a&&e(l=>({error:"Failed to save new conversation to state",conversations:l.conversations.filter(c=>c.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(l.conversationSyncStatus).filter(([c])=>c!==r))})),o}},updateConversation:async(n,r)=>{const s=t().getConversationById(n);if(!s){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=a.conversations[o].metadata??{},c=r.metadata??{},u={...l,...c};Object.assign(a.conversations[o],{...r,metadata:u,updatedAt:new Date});const d=["title","metadata","projectId"].some(y=>y in r),h=a.conversations[o].lastSyncedAt instanceof Date?a.conversations[o].lastSyncedAt.getTime():null,m=a.conversations[o].updatedAt.getTime();"syncRepoId"in r?a.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":d&&a.conversations[o].syncRepoId&&a.conversationSyncStatus[n]==="idle"&&(!h||m>h)&&(a.conversationSyncStatus[n]="needs-sync")}});const i=t().getConversationById(n);if(i)try{const a=JSON.parse(JSON.stringify(i));await Et.saveConversation(a),je.emit(Yn.conversationUpdated,{conversationId:n,updates:r})}catch(a){throw console.error("ConversationStore: Error updating conversation",a),e(o=>{const l=o.conversations.findIndex(c=>c.id===n);if(l!==-1){o.conversations[l]=s;const c=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,u=s.updatedAt.getTime();o.conversationSyncStatus[n]=s.syncRepoId&&c&&u<=c?"idle":s.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),a}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){a.conversations[o]=s;const l=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,c=s.updatedAt.getTime();a.conversationSyncStatus[n]=s.syncRepoId&&l&&c<=l?"idle":s.syncRepoId?"needs-sync":"idle"}a.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,s=t().selectedItemType,i=t().conversations.find(a=>a.id===n);if(i){e(a=>({conversations:a.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&s==="conversation"?null:r,selectedItemType:r===n&&s==="conversation"?null:s,conversationSyncStatus:Object.fromEntries(Object.entries(a.conversationSyncStatus).filter(([o])=>o!==n))}));try{await Et.deleteConversation(n),await Et.deleteInteractionsForConversation(n),je.emit(Yn.conversationDeleted,{conversationId:n}),r===n&&s==="conversation"&&(je.emit(Zn.setCurrentConversationIdRequest,{id:null}),je.emit(Yn.selectedItemChanged,{itemId:null,itemType:null}))}catch(a){throw console.error("ConversationStore: Error deleting conversation",a),e(o=>{if(i){o.conversations.push(i);const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,c=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&l&&c<=l?"idle":i.syncRepoId?"needs-sync":"idle"}r===n&&s==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),a}}},selectItem:async(n,r)=>{const s=t().selectedItemId,i=t().selectedItemType;if(s===n&&i===r)return;console.log(`ConversationStore: Selecting item. ID: ${n}, Type: ${r}. Previous: ${s} (${i})`);const a=r==="conversation"?n:null;a&&(je.emit(Zn.setCurrentConversationIdRequest,{id:a}),je.emit(Zn.loadInteractionsRequest,{conversationId:a})),e({selectedItemId:n,selectedItemType:r}),je.emit(Yn.selectedItemChanged,{itemId:n,itemType:r})},importConversation:async n=>{await m0.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await m0.exportConversation(n,r)},exportProject:async n=>{await m0.exportProject(n)},exportAllConversations:async()=>{await m0.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await Et.loadSyncRepos();e({syncRepos:n,isLoading:!1}),je.emit(Yn.syncReposLoaded,{repos:n})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1}),je.emit(Yn.loadingStateChanged,{isLoading:!1,error:"Failed load sync repositories"})}}},addSyncRepo:async n=>{const r=qi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(a=>{a.syncRepos.push(i)});try{const a=t().syncRepos.find(o=>o.id===r);if(a){const o=JSON.parse(JSON.stringify(a));await Et.saveSyncRepo(o),je.emit(cs.repoChanged,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");Oe.success(`Sync repository "${i.name}" added.`);try{await t().initializeOrSyncRepo(r)}catch(o){console.warn(`Failed to automatically initialize repository "${i.name}":`,o),Oe.warning(`Repository "${i.name}" added but initialization failed. You can manually sync it later.`)}return r}catch(a){throw console.error("ConversationStore: Error adding sync repo",a),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),a}},updateSyncRepo:async(n,r)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(a.syncRepos[o],{...r,branch:r.branch||a.syncRepos[o].branch||"main",updatedAt:new Date})});const i=t().syncRepos.find(a=>a.id===n);if(i)try{const a=JSON.parse(JSON.stringify(i));await Et.saveSyncRepo(a),je.emit(cs.repoChanged,{repoId:n,action:"updated"}),Oe.success(`Sync repository "${i.name}" updated.`)}catch(a){throw console.error("ConversationStore: Error updating sync repo",a),e(o=>{const l=o.syncRepos.findIndex(c=>c.id===n);l!==-1&&(o.syncRepos[l]=s),o.error="Failed to save sync repository update"}),a}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&(a.syncRepos[o]=s),a.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(s=>s.id===n);if(r)try{let s;try{s=await t()._ensureSyncVfsReady()}catch(a){throw console.error("ConversationStore: Failed to initialize sync VFS for deletion",a),Oe.error("Failed to initialize filesystem for deletion. Repository not deleted."),a}await Et.deleteSyncRepo(n);const i=zr(`${Bqe}/${n}`);try{await cD(i,!0,{fsInstance:s}),console.log(`[ConversationStore] Successfully deleted VFS directory: ${i}`)}catch(a){console.error(`[ConversationStore] Failed to delete VFS directory ${i}:`,a),a.code!=="ENOENT"&&console.warn(`Could not remove local sync folder for "${r.name}": ${a.message}`)}e(a=>({syncRepos:a.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(a.repoInitializationStatus).filter(([o])=>o!==n))})),je.emit(cs.repoChanged,{repoId:n,action:"deleted"}),Oe.success(`Sync repository "${r.name}" deleted.`)}catch(s){throw console.error("ConversationStore: Error deleting sync repo",s),e(i=>{i.error="Failed to delete sync repository"}),s}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),Oe.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,s=null)=>{e(i=>{i.conversationSyncStatus[n]=r,r==="error"&&s&&console.error(`Sync error for ${n}: ${s}`)}),je.emit(Yn.conversationSyncStatusChanged,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(s=>{s.repoInitializationStatus[n]=r}),je.emit(cs.repoInitStatusChanged,{repoId:n,status:r})},initializeOrSyncRepo:async(n,r=!1)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){r||Oe.error("Sync repsitory configuration not found.");return}let i;try{i=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await Dqe(i,s,t()._setRepoInitializationStatus,r)},syncConversation:async(n,r=!1)=>{const s=t().getConversationById(n);if(!s){r||Oe.error("Conversation not found for syncing.");return}if(!s.syncRepoId){r||Oe.info("Conversation not linked to a sync repository.");return}const i=t().syncRepos.find(l=>l.id===s.syncRepoId);if(!i){r||Oe.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let a;try{a=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await Fqe(a,s,i,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType,r);const o=t().getConversationById(n);o&&e(l=>{const c=l.conversations.findIndex(u=>u.id===n);c!==-1&&(l.conversations[c]=o)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},syncAllConversations:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>j0);return{BulkSyncService:r}},void 0);await n.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:3})},syncPendingConversations:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>j0);return{BulkSyncService:r}},void 0);await n.syncPendingConversations()},initializeAllRepositories:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>j0);return{BulkSyncService:r}},void 0);await n.initializeAllRepositories()},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:s,updateConversation:i}=t();if(s!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const a=t().getConversationById(r);if(!a){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=a.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!a.metadata)&&await i(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(s=>{s.conversations=s.conversations.map(i=>i.projectId&&r.has(i.projectId)?{...i,projectId:null}:i)})},getRegisteredActionHandlers:()=>{const n="conversationStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Yn.loadConversationsRequest,handler:r.loadConversations,storeId:n},{eventName:Yn.addConversationRequest,handler:s(r.addConversation),storeId:n},{eventName:Yn.updateConversationRequest,handler:i=>r.updateConversation(i.id,i.updates),storeId:n},{eventName:Yn.deleteConversationRequest,handler:i=>r.deleteConversation(i.id),storeId:n},{eventName:Yn.selectItemRequest,handler:i=>r.selectItem(i.id,i.type),storeId:n},{eventName:Yn.importConversationRequest,handler:i=>r.importConversation(i.file),storeId:n},{eventName:Yn.exportConversationRequest,handler:i=>r.exportConversation(i.conversationId,i.format),storeId:n},{eventName:Yn.exportProjectRequest,handler:i=>r.exportProject(i.projectId),storeId:n},{eventName:Yn.exportAllConversationsRequest,handler:r.exportAllConversations,storeId:n},{eventName:Yn.loadSyncReposRequest,handler:r.loadSyncRepos,storeId:n},{eventName:Yn.addSyncRepoRequest,handler:s(r.addSyncRepo),storeId:n},{eventName:Yn.updateSyncRepoRequest,handler:i=>r.updateSyncRepo(i.id,i.updates),storeId:n},{eventName:Yn.deleteSyncRepoRequest,handler:i=>r.deleteSyncRepo(i.id),storeId:n},{eventName:Yn.linkConversationToRepoRequest,handler:i=>r.linkConversationToRepo(i.conversationId,i.repoId),storeId:n},{eventName:Yn.syncConversationRequest,handler:i=>r.syncConversation(i.conversationId),storeId:n},{eventName:Yn.initializeOrSyncRepoRequest,handler:i=>r.initializeOrSyncRepo(i.repoId),storeId:n},{eventName:Yn.updateCurrentConversationToolSettingsRequest,handler:i=>r.updateCurrentConversationToolSettings(i),storeId:n}]}}))),fc={copyInteractionResponseRequest:"canvas.interaction.copy.response.request",regenerateInteractionRequest:"canvas.interaction.regenerate.request",regenerateInteractionWithModelRequest:"canvas.interaction.regenerate.with.model.request",raceInteractionRequest:"canvas.interaction.race.request",editResponseRequest:"canvas.interaction.edit.response.request",copyCodeBlockRequest:"canvas.codeblock.copy.request"},Sx={async submitPrompt(e){var O,L,P,V,F,X;console.log("[ConversationService] submitPrompt called",e);const t=Bn.getState(),n=Oo.getState(),r=Mo.getState(),s=qn.getState(),i=yr.getState(),a=t.currentConversationId;if(!a){Oe.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=s.getConversationById(a),l=(o==null?void 0:o.projectId)??null,c=n.getEffectiveProjectSettings(l),d=t.interactions.filter(U=>U.conversationId===a).length===0&&i.autoTitleEnabled&&((O=e.metadata)==null?void 0:O.autoTitleEnabledForTurn)===!0&&i.autoTitleModelId,m=t.interactions.filter(U=>U.parentId===null&&U.status==="COMPLETED").sort((U,H)=>U.index-H.index).map(U=>{var H;if(U.type==="message.assistant_regen"&&((H=U.metadata)!=null&&H.regeneratedFromId)){const $=t.interactions.find(ne=>ne.id===U.metadata.regeneratedFromId);if($&&$.prompt&&$.type==="message.user_assistant")return{...U,prompt:$.prompt,type:"message.user_assistant"}}return U.type==="message.user_assistant"&&U.prompt?U:null}).filter(Boolean),y=lj(m);let b=e.content;const v=[],x=((L=e.metadata)==null?void 0:L.effectiveRulesContent)??[],w=x.filter(U=>U.type==="system").map(U=>U.content),S=x.filter(U=>U.type==="before").map(U=>U.content),C=x.filter(U=>U.type==="after").map(U=>U.content);S.length>0&&(b=`${S.join(`
`)}

${b}`),C.length>0&&(b=`${b}

    ${C.join(`
`)}`),b&&v.push({type:"text",text:b});const k=((P=e.metadata)==null?void 0:P.attachedFiles)??[];if(k.length>0){const U=await this._processFilesForPrompt(k,a);v.unshift(...U)}v.length>0?y.push({role:"user",content:v}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");let R=((V=e.metadata)==null?void 0:V.turnSystemPrompt)??c.systemPrompt??void 0;w.length>0&&(R=`${R?`${R}

        `:""}${w.join(`
`)}`);const N={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys(N).forEach(U=>{(N[U]===null||N[U]===void 0)&&delete N[U]});const I={system:R,messages:y,parameters:N,metadata:{...(({turnSystemPrompt:U,activeTagIds:H,activeRuleIds:$,effectiveRulesContent:ne,autoTitleEnabledForTurn:W,...Q})=>({...Q,effectivelyAppliedTagIds:H,effectivelyAppliedRuleIds:$}))(e.metadata??{}),modelId:r.modelId??void 0,attachedFiles:(F=e.metadata.attachedFiles)==null?void 0:F.map(({contentBase64:U,contentText:H,...$})=>$)}};try{const U=tm.startInteraction(I,a,e);if(d){console.log("[ConversationService] Triggering asynchronous title generation.");const H=(((X=e.metadata)==null?void 0:X.effectiveRulesContent)??[]).map($=>({id:$.sourceRuleId||qi(),name:$.sourceRuleId?`Rule ${$.sourceRuleId.substring(0,4)}`:"Context Rule",content:$.content,type:$.type,createdAt:new Date,updatedAt:new Date}));this.generateConversationTitle(a,e,H).catch($=>{console.error("[ConversationService] Background title generation failed:",$)})}await U}catch(U){throw console.error("[ConversationService] Error starting interaction:",U),Oe.error(`Failed to start interaction: ${U instanceof Error?U.message:String(U)}`),U}},async generateConversationTitle(e,t,n){var o,l;const r=yr.getState();if(!r.autoTitleModelId){console.warn("[ConversationService] Auto-title generation skipped: No model selected in settings.");return}let s=t.content;if(s.length>r.autoTitlePromptMaxLength&&(s=s.substring(0,r.autoTitlePromptMaxLength)+"..."),r.autoTitleIncludeFiles&&((l=(o=t.metadata)==null?void 0:o.attachedFiles)!=null&&l.length)){const c=t.metadata.attachedFiles.map(u=>u.name).join(", ");s+=`

[Attached files: ${c}]`}if(r.autoTitleIncludeRules&&n.length>0){const c=n.map(u=>u.name).join(", ");s+=`

[Active rules: ${c}]`}const i={system:"Generate a concise, descriptive title (max 8-10 words) for the following user prompt. Output ONLY the title text, nothing else.",messages:[{role:"user",content:s}],parameters:{temperature:.5,max_tokens:20},metadata:{modelId:r.autoTitleModelId,isTitleGeneration:!0},tools:void 0,toolChoice:"none"},a={id:qi(),content:`[Generate title based on: ${t.content.substring(0,50)}...]`,parameters:i.parameters,metadata:{...i.metadata,originalTurnId:t.id}};try{await tm.startInteraction(i,e,a,"conversation.title_generation")}catch(c){console.error("[ConversationService] Error starting title generation interaction:",c)}},async regenerateInteraction(e){var P,V,F,X;console.log(`[ConversationService] regenerateInteraction called for ID: ${e}`);const t=Bn.getState(),n=Oo.getState(),r=Mo.getState(),s=qn.getState(),i=t.interactions.find(U=>U.id===e);if(console.log("[ConversationService] Target interaction for regen:",JSON.parse(JSON.stringify(i))),!i||!i.prompt){Oe.error("Cannot regenerate: Original interaction data missing.");return}const a=null,o=i.index,l=i.prompt,c=i.conversationId,u=s.getConversationById(c),d=(u==null?void 0:u.projectId)??null,h=n.getEffectiveProjectSettings(d),m=i.index,y=t.interactions.filter(U=>U.conversationId===c&&U.index<m&&U.status==="COMPLETED"&&U.type==="message.user_assistant"&&U.parentId===null).sort((U,H)=>U.index-H.index),b=lj(y);let v=l.content;const x=[],w=((P=l.metadata)==null?void 0:P.effectiveRulesContent)??[],S=w.filter(U=>U.type==="system").map(U=>U.content),C=w.filter(U=>U.type==="before").map(U=>U.content),k=w.filter(U=>U.type==="after").map(U=>U.content);C.length>0&&(v=`${C.join(`
`)}

${v}`),k.length>0&&(v=`${v}

    ${k.join(`
`)}`),v&&x.push({type:"text",text:v});const A=((V=l.metadata)==null?void 0:V.attachedFiles)??[];if(A.length>0){const U=await this._processFilesForPrompt(A,c);x.unshift(...U)}x.length>0?b.push({role:"user",content:x}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");let N=((F=l.metadata)==null?void 0:F.turnSystemPrompt)??h.systemPrompt??void 0;S.length>0&&(N=`${N?`${N}

        `:""}${S.join(`
`)}`);const I={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...l.parameters??{}};Object.keys(I).forEach(U=>{(I[U]===null||I[U]===void 0)&&delete I[U]});const O={system:N,messages:b,parameters:I,metadata:{...(({turnSystemPrompt:U,activeTagIds:H,activeRuleIds:$,effectiveRulesContent:ne,autoTitleEnabledForTurn:W,...Q})=>({...Q,effectivelyAppliedTagIds:H,effectivelyAppliedRuleIds:$}))(l.metadata??{}),modelId:r.modelId??void 0,regeneratedFromId:e,attachedFiles:A.map(({contentBase64:U,contentText:H,...$})=>$)}};let L=null;try{if(L=await tm.startInteraction(O,c,l,"message.assistant_regen"),!L)throw new Error("Failed to create new interaction for regeneration.");const U={};let H=!1;L.index!==o&&(U.index=o,H=!0),L.parentId!==a&&(U.parentId=a,H=!0);let $=L;H&&(t._updateInteractionInState(L.id,U),$={...L,...U},await Et.saveInteraction($)),console.log("[ConversationService] New active interaction state after potential updates:",JSON.parse(JSON.stringify($)));const ne=[];let W=i;for(;W;){ne.push(W);const ee=(X=W.metadata)==null?void 0:X.regeneratedFromId;ee?W=t.interactions.find(se=>se.id===ee):W=null}const Q=ne.sort((ee,se)=>{var Ie,De;const pe=((Ie=ee.startedAt)==null?void 0:Ie.getTime())??0,ce=((De=se.startedAt)==null?void 0:De.getTime())??0;return pe-ce});for(let ee=0;ee<Q.length;ee++){const se=Q[ee],pe={parentId:$.id,index:ee};console.log(`[ConversationService] Updating old version ${se.id} to be child of ${$.id} with childIndex ${ee}`,JSON.parse(JSON.stringify(pe))),t._updateInteractionInState(se.id,pe),await Et.saveInteraction({...se,...pe})}}catch(U){throw console.error("[ConversationService] Error during regeneration process:",U),Oe.error(`Failed to regenerate response: ${U instanceof Error?U.message:String(U)}`),U}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(i=>i.source==="vfs");let s;if(r.length>0){const i=qn.getState().getConversationById(t),a=(i==null?void 0:i.projectId)??"orphan";try{s=await this._ensureVfsReady(a)}catch{Oe.error(`Filesystem unavailable for key ${a}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),s=void 0}}for(const i of e){let a=null;try{if(i.source==="direct")a=p$(i);else if(i.source==="vfs"&&s&&i.path){console.log(`[ConversationService] Fetching VFS file: ${i.path}`);const o=await Gh(i.path,{fsInstance:s});a=p$({...i,contentBytes:o})}else if(i.source==="vfs"&&!s)continue;a&&n.push(a)}catch(o){console.error(`[ConversationService] Error processing file ${i.name}:`,o),n.push({type:"text",text:`[Error processing file: ${i.name}]`})}}return n},async _ensureVfsReady(e){return console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`),new Promise((t,n)=>{const r=o=>{Xs.getState().configuredVfsKey===e&&(i(),t(o.fsInstance))},s=o=>{if(Xs.getState().configuredVfsKey===e&&!o.isLoading&&!o.operationLoading)if(o.error)i(),n(new Error(o.error));else{const l=Xs.getState().fs;l&&(i(),t(l))}},i=()=>{je.off(dn.fsInstanceChanged,r),je.off(dn.loadingStateChanged,s)};je.on(dn.fsInstanceChanged,r),je.on(dn.loadingStateChanged,s);const a=Xs.getState();if(a.configuredVfsKey===e&&a.fs&&!a.loading&&!a.operationLoading&&!a.error){i(),t(a.fs);return}if(a.configuredVfsKey===e&&a.error&&!a.loading&&!a.operationLoading){i(),n(new Error(a.error));return}je.emit(dn.initializeVFSRequest,{vfsKey:e,options:{force:!0}})})}},tm={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,_pendingRegenerations:new Set,initializeCanvasEventHandlers(){je.on(fc.copyInteractionResponseRequest,async e=>{const{interactionId:t}=e,n=Bn.getState().interactions.find(s=>s.id===t);if(!n){Oe.error(`Copy failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Copy request for unknown interaction ${t}`);return}const r=n.response??"";if(typeof r!="string"||r.trim()===""){Oe.info("No response content to copy.");return}try{await navigator.clipboard.writeText(r),Oe.success("Response copied!")}catch(s){Oe.error("Failed to copy response."),console.error("[InteractionService] Error copying response:",s)}}),je.on(fc.regenerateInteractionRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received regenerateInteractionRequest for ${t}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const n=Bn.getState().interactions.find(o=>o.id===t);if(!n){Oe.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const r=Bn.getState();if(r.status==="streaming"){Oe.info("Cannot regenerate while another response is streaming.");return}const i=r.interactions.filter(o=>o.conversationId===n.conversationId&&o.parentId===null&&(o.type==="message.user_assistant"||o.type==="message.assistant_regen")).sort((o,l)=>o.index-l.index),a=i.length>0?i[i.length-1]:null;if((a==null?void 0:a.id)!==t){Oe.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t),console.log(`[InteractionService] Starting ConversationService.regenerateInteraction for ${t}`),await Sx.regenerateInteraction(t),console.log(`[InteractionService] Finished ConversationService.regenerateInteraction for ${t}`)}catch(o){Oe.error(`Failed to regenerate response: ${String(o)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,o)}finally{this._pendingRegenerations.delete(t)}}),je.on(fc.regenerateInteractionWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(console.log(`[InteractionService] Received regenerateInteractionWithModelRequest for ${t} with model ${n}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const r=Bn.getState().interactions.find(l=>l.id===t);if(!r){Oe.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const s=Bn.getState();if(s.status==="streaming"){Oe.info("Cannot regenerate while another response is streaming.");return}const a=s.interactions.filter(l=>l.conversationId===r.conversationId&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)!==t){Oe.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t);const l=Mo.getState(),c=l.modelId;console.log(`[InteractionService] Temporarily setting model to ${n} for regeneration`),l.setModelId(n);try{console.log(`[InteractionService] Starting ConversationService.regenerateInteraction for ${t} with model ${n}`),await Sx.regenerateInteraction(t),console.log(`[InteractionService] Finished ConversationService.regenerateInteraction for ${t}`)}finally{console.log(`[InteractionService] Restoring original model ${c}`),l.setModelId(c)}}catch(l){Oe.error(`Failed to regenerate response: ${String(l)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,l)}finally{this._pendingRegenerations.delete(t)}}),je.on(fc.raceInteractionRequest,async e=>{const{interactionId:t,modelIds:n,staggerMs:r}=e;console.log(`[InteractionService] Received raceInteractionRequest for ${t} with ${n.length} models`);const s=Bn.getState().interactions.find(c=>c.id===t);if(!s){Oe.error(`Race failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Race request for unknown interaction ${t}`);return}const i=Bn.getState();if(i.status==="streaming"){Oe.info("Cannot start race while another response is streaming.");return}const o=i.interactions.filter(c=>c.conversationId===s.conversationId&&c.parentId===null&&(c.type==="message.user_assistant"||c.type==="message.assistant_regen")).sort((c,u)=>c.index-u.index),l=o.length>0?o[o.length-1]:null;if((l==null?void 0:l.id)!==t){Oe.info("Can only race from the last response in the conversation.");return}if(n.length<2){Oe.error("Need at least 2 models to race");return}try{const c=Mo.getState(),u=c.modelId;console.log(`[InteractionService] Starting race with ${n.length} models`),Oe.info(`Starting race with ${n.length} models...`);const d=n.map((b,v)=>new Promise(x=>{setTimeout(async()=>{try{c.setModelId(b),console.log(`[InteractionService] Starting race participant ${v+1}/${n.length} with model ${b}`),await Sx.regenerateInteraction(t),console.log(`[InteractionService] Race participant ${v+1} finished`),x({success:!0,modelId:b,index:v})}catch(w){console.error(`[InteractionService] Race participant ${v+1} failed:`,w),x({success:!1,modelId:b,index:v,error:w})}},v*r)})),h=await Promise.all(d);c.setModelId(u);const m=h.filter(b=>b.success).length,y=h.length-m;m>0?Oe.success(`Race completed! ${m} models responded${y>0?`, ${y} failed`:""}`):Oe.error(`Race failed: All ${n.length} models failed to respond`)}catch(c){Oe.error(`Race failed: ${String(c)}`),console.error("[InteractionService] Error during race:",c)}}),je.on(fc.copyCodeBlockRequest,async e=>{const{content:t,interactionId:n,codeBlockId:r,language:s}=e;if(!t||t.trim()===""){Oe.info("No code to copy.");return}try{await navigator.clipboard.writeText(t),Oe.success(`Code block ${s?`(${s}) `:""}copied!`),console.log(`[InteractionService] Code block copied. InteractionID: ${n}, CodeBlockID: ${r}, Language: ${s}`)}catch(i){Oe.error("Failed to copy code block."),console.error("[InteractionService] Error copying code block:",i)}})},async startInteraction(e,t,n,r="message.user_assistant"){var F,X,U,H,$,ne,W,Q,ee,se,pe,ce,Ie,De;console.log(`[InteractionService] startInteraction called (Type: ${r})`,e,t,n);const s=await RC(Y0.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(s===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const i=s&&typeof s=="object"?s.prompt:e,a=qi(),o=new AbortController;this._activeControllers.set(a,o),this._streamingToolData.set(a,{calls:[],results:[]}),this._firstChunkTimestamps.delete(a),this._interactionStartTimes.delete(a);const l=Bn.getState(),u=l.interactions.filter(Se=>Se.conversationId===t),d=r==="conversation.title_generation"?-1:u.reduce((Se,Ce)=>Math.max(Se,Ce.index),-1)+1,h=null,m=performance.now();this._interactionStartTimes.set(a,m);const y={id:a,conversationId:t,type:r,prompt:{...n},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...i.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0,timeToFirstToken:void 0,generationTime:void 0,isTitleGeneration:r==="conversation.title_generation"},index:d,parentId:h};r!=="conversation.title_generation"?(l._addInteractionToState(y),l._addStreamingId(a)):(l._addInteractionToState(y),l._addStreamingId(a),console.log(`[InteractionService] Added title generation interaction ${a} to state.`)),Et.saveInteraction({...y}).catch(Se=>{console.error(`[InteractionService] Failed initial persistence for ${a}`,Se)}),je.emit(Zn.started,{interactionId:a,conversationId:t,type:y.type});const b=(F=i.metadata)==null?void 0:F.modelId;if(!b)return this._finalizeInteraction(a,"ERROR",new Error("No model ID specified in prompt metadata."),r),null;const{providerId:v,modelId:x}=yc(b);if(!v||!x)return this._finalizeInteraction(a,"ERROR",new Error(`Invalid combined model ID format: ${b}`),r),null;const w=Rr.getState().dbProviderConfigs.find(Se=>Se.id===v);if(!w)return this._finalizeInteraction(a,"ERROR",new Error(`Provider configuration not found for ID: ${v}`),r),null;const S=Rr.getState().getApiKeyForProvider(v),C=GO(w,x,S);if(!C)return this._finalizeInteraction(a,"ERROR",new Error(`Failed to instantiate model instance ${b} from provider ${w.name}`),r),null;console.log(`[InteractionService] Using model instance for ${b}`);const k=r!=="conversation.title_generation"?(((X=i.metadata)==null?void 0:X.enabledTools)??[]).reduce((Se,Ce)=>{if(Ce.startsWith("mcp_")){const qe=globalThis.mcpToolsModuleInstance;if(qe&&qe.mcpClients){const Qe=Ce.substring(4).split("_");if(Qe.length>=2){const Ve=Qe[0],Ne=Qe.slice(1).join("_");for(const[,K]of qe.mcpClients)if(K.name===Ve&&K.tools[Ne]){const me=No.getState().getRegisteredTools(),Ae=`mcp_${Ve}_${Ne}`,le=me[Ae];if(le&&le.definition){const oe={description:le.definition.description,parameters:le.definition.parameters,execute:async re=>{if(le.implementation)return await le.implementation(re,h$());throw console.error(`[InteractionService] MCP tool ${Ne} has no implementation`),new Error(`MCP tool ${Ne} has no implementation`)}};Se[Ce]=oe}else console.warn(`[InteractionService] MCP tool ${Ae} not found in control registry`);break}}}}else{const Qe=No.getState().getRegisteredTools()[Ce];if(Qe&&Qe.implementation){const Ve={description:Qe.definition.description,parameters:Qe.definition.parameters,execute:async Ne=>{const K=Bn.getState().currentConversationId,me=K?qn.getState().getConversationById(K):null;let Ae;me&&me.projectId?typeof me.projectId=="string"?Ae=me.projectId:(console.warn(`[InteractionService] conversation.projectId for conversation ${K} is not a string (type: ${typeof me.projectId}). Defaulting VFS key to "orphan". Value:`,me.projectId),Ae="orphan"):Ae="orphan";let le;try{if(je.emit(dn.initializeVFSRequest,{vfsKey:Ae,options:{force:!0}}),await new Promise(oe=>setTimeout(oe,100)),le=Xs.getState().fs,Xs.getState().configuredVfsKey!==Ae||!le)throw new Error(`Filesystem for key "${Ae}" not ready after request.`)}catch(oe){throw new Error(`Filesystem error: ${oe.message}`)}try{const oe=h$(),re=Qe.definition.parameters.parse(Ne),Te=Qe.implementation,Be={...oe,fsInstance:le};return await Te(re,Be)}catch(oe){throw oe instanceof Cu?new Error(`Invalid arguments: ${oe.errors.map(re=>`${re.path.join(".")} (${re.message})`).join(", ")}`):new Error(oe instanceof Error?oe.message:String(oe))}}};Se[Ce]=Ve}}return Se},{}):void 0,{getSelectedModel:A}=Rr.getState(),R=A(),N=((H=(U=R==null?void 0:R.metadata)==null?void 0:U.supported_parameters)==null?void 0:H.includes("tools"))??!1,I=((($=i.metadata)==null?void 0:$.enabledTools)??[]).filter(Se=>Se.startsWith("mcp_")).length,O=(((ne=i.metadata)==null?void 0:ne.enabledTools)??[]).filter(Se=>!Se.startsWith("mcp_")).length;!N&&(I>0||O>0)&&console.warn(`[InteractionService] Model ${(R==null?void 0:R.name)||"unknown"} does not support tools. Ignoring ${I+O} enabled tools.`);const L=((W=i.parameters)==null?void 0:W.maxSteps)??yr.getState().toolMaxSteps,P={model:C,messages:i.messages,abortSignal:o.signal,system:i.system,temperature:(Q=i.parameters)==null?void 0:Q.temperature,maxTokens:(ee=i.parameters)==null?void 0:ee.max_tokens,topP:(se=i.parameters)==null?void 0:se.top_p,topK:(pe=i.parameters)==null?void 0:pe.top_k,presencePenalty:(ce=i.parameters)==null?void 0:ce.presence_penalty,frequencyPenalty:(Ie=i.parameters)==null?void 0:Ie.frequency_penalty,maxSteps:L,...N&&k&&Object.keys(k).length>0&&{tools:k},...((De=i.parameters)==null?void 0:De.providerOptions)&&{providerOptions:i.parameters.providerOptions},...N&&i.toolChoice&&{toolChoice:i.toolChoice}},V={onChunk:Se=>this._handleChunk(a,Se),onReasoningChunk:Se=>this._handleReasoningChunk(a,Se),onToolCall:Se=>this._handleToolCall(a,Se),onToolResult:Se=>this._handleToolResult(a,Se),onFinish:Se=>this._handleFinish(a,Se,r),onError:Se=>this._handleError(a,Se,r)};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${a}`),Oqe.executeInteraction(a,P,V).catch(Se=>{console.error(`[InteractionService] Error during AIService.executeInteraction for ${a}:`,Se);const Ce=Bn.getState().interactions.find(qe=>qe.id===a);Ce&&Ce.status==="STREAMING"&&this._finalizeInteraction(a,"ERROR",Se instanceof Error?Se:new Error(String(Se)),r)}),y},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);if(t&&!t.signal.aborted)t.abort(),Oe.info("Interaction cancelled.");else{console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`);const n=Bn.getState(),r=n.interactions.find(s=>s.id===e);n.streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"),(r==null?void 0:r.type)??"message.user_assistant"))}},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await RC(Y0.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const s=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;Bn.getState().appendInteractionResponseChunk(e,s),je.emit(Zn.streamChunk,{interactionId:e,chunk:s})}},_handleReasoningChunk(e,t){Bn.getState().appendReasoningChunk(e,t)},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),Bn.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),Bn.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},_handleFinish(e,t,n){console.log(`[InteractionService] Finishing interaction ${e} (Type: ${n}). Reason: ${t.finishReason}`),this._finalizeInteraction(e,"COMPLETED",void 0,n,t)},_handleError(e,t,n){console.error(`[InteractionService] Handling error for interaction ${e} (Type: ${n}):`,t);const r=t.name==="AbortError";this._finalizeInteraction(e,r?"CANCELLED":"ERROR",r?void 0:t,n)},_finalizeInteraction(e,t,n,r="message.user_assistant",s){var k;const i=Bn.getState(),a=i.interactions.find(A=>A.id===e);if(!a||a.status!=="STREAMING"&&r!=="conversation.title_generation"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const o=i.activeStreamBuffers[e]??"",l=i.activeReasoningBuffers[e]??"",c=this._streamingToolData.get(e)||{calls:[],results:[]},u=(a==null?void 0:a.metadata)||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${o.length}, Reasoning Length: ${l.length}`);const d=performance.now(),h=this._interactionStartTimes.get(e),m=this._firstChunkTimestamps.get(e),y=h?Math.round(d-h):void 0,b=h&&m?Math.round(m-h):void 0,v=(s==null?void 0:s.reasoning)??l,x={status:t,endedAt:new Date,response:o||null,metadata:{...u,...(s==null?void 0:s.usage)&&{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens,totalTokens:s.usage.totalTokens},...(s==null?void 0:s.providerMetadata)&&{providerMetadata:s.providerMetadata},toolCalls:c.calls,toolResults:c.results,reasoning:v||void 0,timeToFirstToken:b,generationTime:y,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};if(r==="conversation.title_generation"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const A=x.response.trim().replace(/^"|"$/g,"");A&&a&&(console.log(`[InteractionService] Updating conversation ${a.conversationId} title to: "${A}"`),je.emit(Yn.updateConversationRequest,{id:a.conversationId,updates:{title:A}}))}i._updateInteractionInState(e,x),i._removeStreamingId(e);const w=Bn.getState().interactions.find(A=>A.id===e);w?(console.log(`[InteractionService] Persisting final state for ${e}. Response length: ${((k=w.response)==null?void 0:k.length)??0}`),Et.saveInteraction({...w}).catch(A=>{console.error(`[InteractionService] Failed final persistence for ${e}`,A)})):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let S=[],C=[];try{S=c.calls.map(A=>JSON.parse(A)),C=c.results.map(A=>JSON.parse(A))}catch(A){console.error("[InteractionService] Failed to parse tool strings for event emitter:",A)}je.emit(Zn.completed,{interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:S,toolResults:C}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e),console.log(`[InteractionService] Finalized interaction ${e} with status ${t}.`)}},$k=We.memo(({interactionId:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var F;const{interaction:s,interactionStatus:i}=Bn(yn(X=>{const U=X.interactions.find(H=>H.id===e);return{interaction:U,interactionStatus:U==null?void 0:U.status}})),a=yr(X=>X.streamingRenderFPS),[o,l]=T.useState(""),[c,u]=T.useState(""),[d,h]=T.useState(!0),[m,y]=T.useState(!1),b=T.useRef(null),v=T.useRef(0),x=T.useRef(null);T.useEffect(()=>{const X=1e3/a;let U=!0;const H=$=>{if(!U)return;if(Bn.getState().streamingInteractionIds.includes(e)){if($-v.current>=X){const W=Bn.getState().activeStreamBuffers[e]??"",Q=Bn.getState().activeReasoningBuffers[e]??"";l(W),u(Q),v.current=$}b.current=requestAnimationFrame(H)}else{const W=Bn.getState().activeStreamBuffers[e]??"",Q=Bn.getState().activeReasoningBuffers[e]??"";l(W),u(Q),b.current=null}};return b.current=requestAnimationFrame(H),()=>{U=!1,b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[e,a]),T.useEffect(()=>{if(i&&i!=="STREAMING"){const X=Bn.getState().activeStreamBuffers[e]??"",U=Bn.getState().activeReasoningBuffers[e]??"";l(X),u(U),b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[i,e]);const{dbProviderConfigs:w,getAllAvailableModelDefsForProvider:S}=Rr(yn(X=>({dbProviderConfigs:X.dbProviderConfigs,getAllAvailableModelDefsForProvider:X.getAllAvailableModelDefsForProvider}))),C=T.useMemo(()=>{var ee;const X=(ee=s==null?void 0:s.metadata)==null?void 0:ee.modelId;if(!X)return"Loading Model...";const{providerId:U,modelId:H}=yc(X);if(!U||!H)return X;const $=w.find(se=>se.id===U),ne=($==null?void 0:$.name)??U,Q=S(U).find(se=>se.id===H);return`${(Q==null?void 0:Q.name)??H} (${ne})`},[(F=s==null?void 0:s.metadata)==null?void 0:F.modelId,w,S]),k=T.useCallback(()=>h(X=>!X),[]),A=T.useCallback(()=>{y(!1)},[]),R=T.useCallback(()=>{y(!0)},[]),N=T.useCallback(()=>{m?A():R()},[m,A,R]);if(!s)return r?f.jsxs("div",{className:Ze("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),f.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]})]}):f.jsxs("div",{className:Ze("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]});const I=()=>{tm.abortInteraction(e)},O=n==null?void 0:n("header-actions",s,{isFolded:m,toggleFold:N}),L=n==null?void 0:n("actions",s),P=n==null?void 0:n("content",s),V=n==null?void 0:n("menu",s);return f.jsxs("div",{ref:x,className:Ze("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors",i==="ERROR"?"border-destructive/50 bg-destructive/5":i==="STREAMING"?"border-primary/30":"border-border",t),children:[r&&s.prompt&&f.jsx(OT,{turnData:s.prompt,timestamp:s.startedAt,isAssistantComplete:!1}),f.jsxs("div",{className:Ze("relative group/assistant",r&&s.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[V,f.jsxs("div",{className:Ze("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(iH,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsx("div",{className:"flex flex-col min-w-0",children:f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",C,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:O})]})})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:"Streaming..."})})]}),!m&&f.jsxs(f.Fragment,{children:[P,c&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:k,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Ph,{className:"h-3.5 w-3.5"})," Reasoning (Streaming)"]}),f.jsx("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx(On,{tooltipText:d?"Show Reasoning":"Hide Reasoning",onClick:X=>{X.stopPropagation(),k()},"aria-label":d?"Show reasoning":"Hide reasoning",icon:d?f.jsx(Nc,{}):f.jsx(Dh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})})]}),!d&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:c})]}),f.jsx(P9e,{interactionId:e,markdownContent:o,isStreaming:!0})]}),m&&f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:N,children:[c?"[Reasoning] ":"",o&&typeof o=="string"?`"${o.substring(0,80)}${o.length>80?"...":""}"`:"[Streaming...]"]})]}),f.jsxs("div",{className:Ze("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:[L,f.jsx(D9e,{onStop:I,"aria-label":"Stop Generation"})]})]})});$k.displayName="StreamingInteractionCard";const GU=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,$qe=({displayModelName:e,timeAgo:t,promptTokens:n,completionTokens:r,timeToFirstToken:s,generationTime:i,headerActionsSlot:a})=>{const o=n!==void 0&&r!==void 0?n+r:void 0;return f.jsxs("div",{className:Ze("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(iH,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsxs("div",{className:"flex flex-col min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",e,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:a})]}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[o!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(zpe,{className:"h-3 w-3"}),f.jsx("span",{children:o.toLocaleString()})]}),f.jsxs(Sr,{side:"bottom",children:["Tokens: ",n??"?"," (Prompt) +"," ",r??"?"," (Completion) = ",o]})]})}),s!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Uge,{className:"h-3 w-3"}),f.jsx("span",{children:GU(s)})]}),f.jsx(Sr,{side:"bottom",children:"Time to First Token"})]})}),i!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Ppe,{className:"h-3 w-3"}),f.jsx("span",{children:GU(i)})]}),f.jsx(Sr,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:t})})]})},zqe=({markdownContent:e})=>{const t=aT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>{if(typeof n=="string")return f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`);if(n.type==="code"){const s=n;return f.jsx(Fy,{lang:s.lang,code:s.code,filepath:s.filepath},`code-${r}`)}else if(n.type==="mermaid"){const s=n;return f.jsx(x6,{code:s.code},`mermaid-${r}`)}return null})}):null},Uqe=({interactionId:e,response:t,toolCalls:n,toolResults:r,reasoning:s,isError:i,errorMessage:a,isFolded:o,toggleFold:l})=>{const[c,u]=T.useState(!0),[d,h]=T.useState(!1),m=No(yn(k=>Object.values(k.canvasControls))),y=T.useCallback((k,A)=>m.filter(R=>R.type==="tool-call-step"&&R.targetSlot===k&&R.renderer).map(R=>R.renderer?f.jsx(We.Fragment,{children:R.renderer(A)},R.id):null).filter(Boolean),[m]),b=T.useMemo(()=>{if(!n)return[];const k=n.map(R=>JSON.parse(R)),A=(r==null?void 0:r.map(R=>JSON.parse(R)))??[];return k.map(R=>{const N=A.find(I=>I.toolCallId===R.toolCallId);return{call:R,result:N}})},[n,r]),v=T.useCallback(()=>u(k=>!k),[]),x=T.useCallback(async()=>{if(s)try{await navigator.clipboard.writeText(s),h(!0),Oe.success("Reasoning copied!"),setTimeout(()=>h(!1),1500)}catch(k){Oe.error("Failed to copy reasoning."),console.error("Clipboard copy failed for reasoning:",k)}},[s]),w=!!s,S=t&&(typeof t!="string"||t.trim().length>0),C=b&&b.length>0;return o?f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:l,children:[w?"[Reasoning] ":"",C?`[${b==null?void 0:b.length} Tool Call(s)] `:"",S&&typeof t=="string"?`"${t.substring(0,80)}${t.length>80?"...":""}"`:C||w?"":"[No text response]"]}):f.jsxs(f.Fragment,{children:[i&&a&&f.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[f.jsx("p",{className:"font-semibold",children:"Error:"}),f.jsx("p",{children:a})]}),w&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:v,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Ph,{className:"h-3.5 w-3.5"})," Reasoning"]}),f.jsxs("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx(On,{tooltipText:"Copy Reasoning",onClick:k=>{k.stopPropagation(),x()},"aria-label":"Copy reasoning",icon:d?f.jsx(ro,{className:"text-green-500"}):f.jsx(lE,{}),className:"h-5 w-5 text-muted-foreground"}),f.jsx(On,{tooltipText:c?"Show Reasoning":"Hide Reasoning",onClick:k=>{k.stopPropagation(),v()},"aria-label":c?"Show reasoning":"Hide reasoning",icon:c?f.jsx(Nc,{}):f.jsx(Dh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]})]}),!c&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:s})]}),b.map(({call:k,result:A},R)=>{const N={interactionId:e,toolCall:k,toolResult:A,canvasContextType:"tool-call-step"};return f.jsx(We.Fragment,{children:y("tool-call-content",N)},`tool-step-${k.toolCallId||R}`)}),S&&typeof t=="string"&&f.jsx(zqe,{markdownContent:t,interactionId:e}),!S&&!C&&!w&&!i&&f.jsx("div",{className:"text-xs text-muted-foreground italic p-1",children:"[No text response]"})]})},O4=We.memo(({interaction:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var O,L,P,V,F,X,U,H,$,ne,W,Q;const[s,i]=T.useState(!1),a=T.useRef(null),o=T.useCallback(()=>{i(!1)},[]),l=T.useCallback(()=>{i(!0)},[]),c=T.useCallback(()=>{s?o():l()},[s,o,l]),{dbProviderConfigs:u,getAllAvailableModelDefsForProvider:d}=Rr(yn(ee=>({dbProviderConfigs:ee.dbProviderConfigs,getAllAvailableModelDefsForProvider:ee.getAllAvailableModelDefsForProvider}))),h=e.endedAt?PZ(new Date(e.endedAt),{addSuffix:!0}):"Processing...",m=T.useMemo(()=>{var Ce;const ee=(Ce=e.metadata)==null?void 0:Ce.modelId;if(!ee)return"Unknown Model";const{providerId:se,modelId:pe}=yc(ee);if(!se||!pe)return ee;const ce=u.find(qe=>qe.id===se),Ie=(ce==null?void 0:ce.name)??se,Se=d(se).find(qe=>qe.id===pe);return`${(Se==null?void 0:Se.name)??pe} (${Ie})`},[(O=e.metadata)==null?void 0:O.modelId,u,d]),y=e.status==="COMPLETED",b=y||e.status==="ERROR",v=e.status==="ERROR",x=e.response&&(typeof e.response!="string"||e.response.trim().length>0),w=((L=e.metadata)==null?void 0:L.toolCalls)&&e.metadata.toolCalls.length>0,S=((P=e.metadata)==null?void 0:P.toolResults)&&e.metadata.toolResults.length>0,C=!!((V=e.metadata)!=null&&V.reasoning),k=x||w||S||C,A=n==null?void 0:n("header-actions",e,{isFolded:s,toggleFold:c}),R=n==null?void 0:n("actions",e),N=n==null?void 0:n("content",e),I=n==null?void 0:n("menu",e);return f.jsxs("div",{ref:a,className:Ze("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors hover:bg-muted/50","overflow-wrap-anywhere",v?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&f.jsx(OT,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:y}),f.jsxs("div",{className:Ze("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[I,f.jsx($qe,{displayModelName:m,timeAgo:h,isFolded:s,toggleFold:c,canFold:k,promptTokens:(F=e.metadata)==null?void 0:F.promptTokens,completionTokens:(X=e.metadata)==null?void 0:X.completionTokens,timeToFirstToken:(U=e.metadata)==null?void 0:U.timeToFirstToken,generationTime:(H=e.metadata)==null?void 0:H.generationTime,headerActionsSlot:A&&A.length>0?f.jsx(f.Fragment,{children:A}):void 0}),N,f.jsx(Uqe,{interactionId:e.id,response:e.response,toolCalls:($=e.metadata)==null?void 0:$.toolCalls,toolResults:(ne=e.metadata)==null?void 0:ne.toolResults,reasoning:(W=e.metadata)==null?void 0:W.reasoning,isError:v,errorMessage:(Q=e.metadata)==null?void 0:Q.error,isFolded:s,toggleFold:c})]}),b&&R&&R.length>0&&f.jsx("div",{className:Ze("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:R})]})});O4.displayName="InteractionCard";const qqe=({interactionGroup:e,renderSlot:t,activeStreamingInteractionId:n})=>{const[r,s]=T.useState(0);if(!e||e.length===0)return null;if(e.length===1){const a=e[0];return f.jsxs("div",{className:"tab-content pt-0",children:[" ",a.id===n&&a.status==="STREAMING"?f.jsx($k,{interactionId:a.id,renderSlot:t,showPrompt:!1},a.id):f.jsx(O4,{interaction:a,renderSlot:t,showPrompt:!1},a.id)]})}const i=e[r];return f.jsxs("div",{className:"response-tabs-container flex flex-col",children:[f.jsxs("div",{className:"tabs-header flex border-b mb-1",children:[" ",e.map((a,o)=>{const l=()=>{var c,u,d;return o===0?(c=a.metadata)!=null&&c.editedResponse?f.jsx(vB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(vB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(u=a.metadata)!=null&&u.raceTab?f.jsx(fH,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(d=a.metadata)!=null&&d.originalVersion?f.jsx(hH,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(Eme,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"})};return f.jsxs(bt,{variant:"ghost",size:"sm",onClick:()=>s(o),className:`mr-0.5 rounded-b-none flex items-center px-2 py-1 text-xs font-medium hover:bg-muted/50 focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 transition-colors duration-150 ease-in-out                 ${r===o?"border-b-2 border-primary text-primary":"border-b-2 border-transparent text-muted-foreground hover:text-foreground"}`,children:[l(),o+1," "]},a.id)})]}),f.jsxs("div",{className:"tab-content pt-1",children:[" ",i&&(i.id===n&&i.status==="STREAMING"?f.jsx($k,{interactionId:i.id,renderSlot:t,showPrompt:!1},i.id):f.jsx(O4,{interaction:i,renderSlot:t,showPrompt:!1},i.id))]})]})};var Vqe=T.createContext(void 0);function ib(e){const t=T.useContext(Vqe);return e||t||"ltr"}function Bw(e,[t,n]){return Math.min(n,Math.max(t,e))}function Wqe(e,t){return T.useReducer((n,r)=>t[n][r]??n,e)}var I6="ScrollArea",[Rse,rdt]=Wi(I6),[Hqe,Xl]=Rse(I6),Nse=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...a}=e,[o,l]=T.useState(null),[c,u]=T.useState(null),[d,h]=T.useState(null),[m,y]=T.useState(null),[b,v]=T.useState(null),[x,w]=T.useState(0),[S,C]=T.useState(0),[k,A]=T.useState(!1),[R,N]=T.useState(!1),I=Rn(t,L=>l(L)),O=ib(s);return f.jsx(Hqe,{scope:n,type:r,dir:O,scrollHideDelay:i,scrollArea:o,viewport:c,onViewportChange:u,content:d,onContentChange:h,scrollbarX:m,onScrollbarXChange:y,scrollbarXEnabled:k,onScrollbarXEnabledChange:A,scrollbarY:b,onScrollbarYChange:v,scrollbarYEnabled:R,onScrollbarYEnabledChange:N,onCornerWidthChange:w,onCornerHeightChange:C,children:f.jsx(ar.div,{dir:O,...a,ref:I,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":S+"px",...e.style}})})});Nse.displayName=I6;var Mse="ScrollAreaViewport",Ise=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,a=Xl(Mse,n),o=T.useRef(null),l=Rn(t,o,a.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),f.jsx(ar.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:f.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});Ise.displayName=Mse;var Fu="ScrollAreaScrollbar",jse=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Xl(Fu,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,o=e.orientation==="horizontal";return T.useEffect(()=>(o?i(!0):a(!0),()=>{o?i(!1):a(!1)}),[o,i,a]),s.type==="hover"?f.jsx(Gqe,{...r,ref:t,forceMount:n}):s.type==="scroll"?f.jsx(Kqe,{...r,ref:t,forceMount:n}):s.type==="auto"?f.jsx(Ose,{...r,ref:t,forceMount:n}):s.type==="always"?f.jsx(j6,{...r,ref:t}):null});jse.displayName=Fu;var Gqe=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Xl(Fu,e.__scopeScrollArea),[i,a]=T.useState(!1);return T.useEffect(()=>{const o=s.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),f.jsx(oa,{present:n||i,children:f.jsx(Ose,{"data-state":i?"visible":"hidden",...r,ref:t})})}),Kqe=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Xl(Fu,e.__scopeScrollArea),i=e.orientation==="horizontal",a=BT(()=>l("SCROLL_END"),100),[o,l]=Wqe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return T.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,s.scrollHideDelay,l]),T.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let d=c[u];const h=()=>{const m=c[u];d!==m&&(l("SCROLL"),a()),d=m};return c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[s.viewport,i,l,a]),f.jsx(oa,{present:n||o!=="hidden",children:f.jsx(j6,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Wt(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Wt(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),Ose=T.forwardRef((e,t)=>{const n=Xl(Fu,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,a]=T.useState(!1),o=e.orientation==="horizontal",l=BT(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(o?c:u)}},10);return Cy(n.viewport,l),Cy(n.content,l),f.jsx(oa,{present:r||i,children:f.jsx(j6,{"data-state":i?"visible":"hidden",...s,ref:t})})}),j6=T.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=Xl(Fu,e.__scopeScrollArea),i=T.useRef(null),a=T.useRef(0),[o,l]=T.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=Bse(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:h=>i.current=h,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:h=>a.current=h};function d(h,m){return eVe(h,a.current,o,m)}return n==="horizontal"?f.jsx(Yqe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollLeft,m=KU(h,o,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=d(h,s.dir))}}):n==="vertical"?f.jsx(Zqe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollTop,m=KU(h,o);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=d(h))}}):null}),Yqe=T.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=Xl(Fu,e.__scopeScrollArea),[a,o]=T.useState(),l=T.useRef(null),c=Rn(t,l,i.onScrollbarXChange);return T.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(Dse,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":LT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(h),zse(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:Uk(a.paddingLeft),paddingEnd:Uk(a.paddingRight)}})}})}),Zqe=T.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=Xl(Fu,e.__scopeScrollArea),[a,o]=T.useState(),l=T.useRef(null),c=Rn(t,l,i.onScrollbarYChange);return T.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(Dse,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":LT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(h),zse(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:Uk(a.paddingTop),paddingEnd:Uk(a.paddingBottom)}})}})}),[Xqe,Pse]=Rse(Fu),Dse=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:d,...h}=e,m=Xl(Fu,n),[y,b]=T.useState(null),v=Rn(t,I=>b(I)),x=T.useRef(null),w=T.useRef(""),S=m.viewport,C=r.content-r.viewport,k=Cs(u),A=Cs(l),R=BT(d,10);function N(I){if(x.current){const O=I.clientX-x.current.left,L=I.clientY-x.current.top;c({x:O,y:L})}}return T.useEffect(()=>{const I=O=>{const L=O.target;(y==null?void 0:y.contains(L))&&k(O,C)};return document.addEventListener("wheel",I,{passive:!1}),()=>document.removeEventListener("wheel",I,{passive:!1})},[S,y,C,k]),T.useEffect(A,[r,A]),Cy(y,R),Cy(m.content,R),f.jsx(Xqe,{scope:n,scrollbar:y,hasThumb:s,onThumbChange:Cs(i),onThumbPointerUp:Cs(a),onThumbPositionChange:A,onThumbPointerDown:Cs(o),children:f.jsx(ar.div,{...h,ref:v,style:{position:"absolute",...h.style},onPointerDown:Wt(e.onPointerDown,I=>{I.button===0&&(I.target.setPointerCapture(I.pointerId),x.current=y.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),N(I))}),onPointerMove:Wt(e.onPointerMove,N),onPointerUp:Wt(e.onPointerUp,I=>{const O=I.target;O.hasPointerCapture(I.pointerId)&&O.releasePointerCapture(I.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),x.current=null})})})}),zk="ScrollAreaThumb",Fse=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Pse(zk,e.__scopeScrollArea);return f.jsx(oa,{present:n||s.hasThumb,children:f.jsx(Jqe,{ref:t,...r})})}),Jqe=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=Xl(zk,n),a=Pse(zk,n),{onThumbPositionChange:o}=a,l=Rn(t,d=>a.onThumbChange(d)),c=T.useRef(void 0),u=BT(()=>{c.current&&(c.current(),c.current=void 0)},100);return T.useEffect(()=>{const d=i.viewport;if(d){const h=()=>{if(u(),!c.current){const m=tVe(d,o);c.current=m,o()}};return o(),d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[i.viewport,u,o]),f.jsx(ar.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Wt(e.onPointerDownCapture,d=>{const m=d.target.getBoundingClientRect(),y=d.clientX-m.left,b=d.clientY-m.top;a.onThumbPointerDown({x:y,y:b})}),onPointerUp:Wt(e.onPointerUp,a.onThumbPointerUp)})});Fse.displayName=zk;var O6="ScrollAreaCorner",Lse=T.forwardRef((e,t)=>{const n=Xl(O6,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?f.jsx(Qqe,{...e,ref:t}):null});Lse.displayName=O6;var Qqe=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=Xl(O6,n),[i,a]=T.useState(0),[o,l]=T.useState(0),c=!!(i&&o);return Cy(s.scrollbarX,()=>{var d;const u=((d=s.scrollbarX)==null?void 0:d.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),Cy(s.scrollbarY,()=>{var d;const u=((d=s.scrollbarY)==null?void 0:d.offsetWidth)||0;s.onCornerWidthChange(u),a(u)}),c?f.jsx(ar.div,{...r,ref:t,style:{width:i,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Uk(e){return e?parseInt(e,10):0}function Bse(e,t){const n=e/t;return isNaN(n)?0:n}function LT(e){const t=Bse(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function eVe(e,t,n,r="ltr"){const s=LT(n),i=s/2,a=t||i,o=s-a,l=n.scrollbar.paddingStart+a,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,d=r==="ltr"?[0,u]:[u*-1,0];return $se([l,c],d)(e)}function KU(e,t,n="ltr"){const r=LT(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,a=t.content-t.viewport,o=i-r,l=n==="ltr"?[0,a]:[a*-1,0],c=Bw(e,l);return $se([0,a],[0,o])(c)}function $se(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function zse(e,t){return e>0&&e<t}var tVe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},a=n.left!==i.left,o=n.top!==i.top;(a||o)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function BT(e,t){const n=Cs(e),r=T.useRef(0);return T.useEffect(()=>()=>window.clearTimeout(r.current),[]),T.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Cy(e,t){const n=Cs(t);ti(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var nVe=Nse,rVe=Ise,sVe=Lse;function Po({className:e,children:t,...n}){return f.jsxs(nVe,{"data-slot":"scroll-area",className:Ze("relative",e),...n,children:[f.jsx(rVe,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),f.jsx(iVe,{}),f.jsx(sVe,{})]})}function iVe({className:e,orientation:t="vertical",...n}){return f.jsx(jse,{"data-slot":"scroll-area-scrollbar",orientation:t,className:Ze("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:f.jsx(Fse,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Wr({className:e,...t}){return f.jsx("div",{"data-slot":"skeleton",className:Ze("bg-accent animate-pulse rounded-md",e),...t})}const aVe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})};function Vd({className:e,...t}){return f.jsx("div",{"data-slot":"card",className:Ze("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function Wd({className:e,...t}){return f.jsx("div",{"data-slot":"card-header",className:Ze("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function Hd({className:e,...t}){return f.jsx("div",{"data-slot":"card-title",className:Ze("leading-none font-semibold",e),...t})}function Y1({className:e,...t}){return f.jsx("div",{"data-slot":"card-description",className:Ze("text-muted-foreground text-sm",e),...t})}function Gd({className:e,...t}){return f.jsx("div",{"data-slot":"card-content",className:Ze("px-6",e),...t})}function oVe({className:e,...t}){return f.jsx("div",{"data-slot":"card-footer",className:Ze("flex items-center px-6 [.border-t]:pt-6",e),...t})}const jr={sidebarVisibilityChanged:"ui.sidebar.visibility.changed",chatControlPanelVisibilityChanged:"ui.chat.control.panel.visibility.changed",promptControlPanelVisibilityChanged:"ui.prompt.control.panel.visibility.changed",globalLoadingChanged:"ui.global.loading.changed",globalErrorChanged:"ui.global.error.changed",focusInputFlagChanged:"ui.focus.input.flag.changed",modalStateChanged:"ui.modal.state.changed",toggleSidebarRequest:"ui.toggle.sidebar.request",toggleChatControlPanelRequest:"ui.toggle.chat.control.panel.request",togglePromptControlPanelRequest:"ui.toggle.prompt.control.panel.request",setGlobalLoadingRequest:"ui.set.global.loading.request",setGlobalErrorRequest:"ui.set.global.error.request",setFocusInputFlagRequest:"ui.set.focus.input.flag.request",openModalRequest:"ui.modal.open.request",closeModalRequest:"ui.modal.close.request",contextChanged:"ui.legacy.contextChanged"},lVe=({title:e,description:t,icon:n,onClick:r})=>f.jsxs(Vd,{className:"hover:border-primary/50 hover:bg-muted/30 transition-all cursor-pointer group",onClick:r,children:[f.jsxs(Wd,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsxs(Hd,{className:"text-sm font-medium flex items-center gap-2",children:[n," ",e]}),f.jsx(npe,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]}),f.jsx(Gd,{children:f.jsx("p",{className:"text-xs text-muted-foreground",children:t})})]}),Use=()=>{const e=(r,s)=>{je.emit(jr.openModalRequest,{modalId:"settingsModal",initialTab:r,initialSubTab:s})},t=()=>{je.emit(jr.openModalRequest,{modalId:"core-vfs-modal-panel"})},n=[{title:"Configure Theme",description:"Customize colors, fonts, and code block appearance.",icon:f.jsx(J2,{className:"h-4 w-4 text-purple-500"}),onClick:()=>e("theme")},{title:"Manage Rules & Tags",description:"Define reusable prompt snippets and organize them.",icon:f.jsx(q3,{className:"h-4 w-4 text-blue-500"}),onClick:()=>e("rules-tags")},{title:"Add Files",description:"Upload or manage files in the virtual filesystem.",icon:f.jsx(jO,{className:"h-4 w-4 text-cyan-500"}),onClick:t},{title:"Add Provider",description:"Connect to AI services like OpenAI, Ollama, etc.",icon:f.jsx(q0,{className:"h-4 w-4 text-green-500"}),onClick:()=>e("providers","providers-config")},{title:"Add API Key",description:"Store API keys securely in your browser.",icon:f.jsx(Dx,{className:"h-4 w-4 text-amber-500"}),onClick:()=>e("providers","api-keys")},{title:"Setup Git Sync",description:"Configure repositories to sync conversations with Git.",icon:f.jsx(Sc,{className:"h-4 w-4 text-orange-500"}),onClick:()=>e("git")}];return f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl w-full pt-4",children:n.map(r=>f.jsx(lVe,{title:r.title,description:r.description,icon:r.icon,onClick:r.onClick},r.title))})},YU=()=>f.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[f.jsx(aVe,{className:"h-16 w-16 text-muted-foreground mb-4"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),f.jsx("p",{className:"text-muted-foreground max-w-md mb-8",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat. You can also explore these setup options:"}),f.jsx(Use,{})]}),P6=T.createContext({});function D6(e){const t=T.useRef(null);return t.current===null&&(t.current=e()),t.current}const F6=typeof window<"u",qse=F6?T.useLayoutEffect:T.useEffect,$T=T.createContext(null),L6=T.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class cVe extends T.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=r instanceof HTMLElement&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function uVe({children:e,isPresent:t,anchorX:n}){const r=T.useId(),s=T.useRef(null),i=T.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=T.useContext(L6);return T.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:u,right:d}=i.current;if(t||!s.current||!o||!l)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;s.current.dataset.motionPopId=r;const m=document.createElement("style");return a&&(m.nonce=a),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(m)&&document.head.removeChild(m)}},[t]),f.jsx(cVe,{isPresent:t,childRef:s,sizeRef:i,children:T.cloneElement(e,{ref:s})})}const dVe=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o})=>{const l=D6(fVe),c=T.useId();let u=!0,d=T.useMemo(()=>(u=!1,{id:c,initial:t,isPresent:n,custom:s,onExitComplete:h=>{l.set(h,!0);for(const m of l.values())if(!m)return;r&&r()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[n,l,r]);return i&&u&&(d={...d}),T.useMemo(()=>{l.forEach((h,m)=>l.set(m,!1))},[n]),T.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(e=f.jsx(uVe,{isPresent:n,anchorX:o,children:e})),f.jsx($T.Provider,{value:d,children:e})};function fVe(){return new Map}function Vse(e=!0){const t=T.useContext($T);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,i=T.useId();T.useEffect(()=>{if(e)return s(i)},[e]);const a=T.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const QS=e=>e.key||"";function ZU(e){const t=[];return T.Children.forEach(e,n=>{T.isValidElement(n)&&t.push(n)}),t}const hVe=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=Vse(a),u=T.useMemo(()=>ZU(e),[e]),d=a&&!l?[]:u.map(QS),h=T.useRef(!0),m=T.useRef(u),y=D6(()=>new Map),[b,v]=T.useState(u),[x,w]=T.useState(u);qse(()=>{h.current=!1,m.current=u;for(let k=0;k<x.length;k++){const A=QS(x[k]);d.includes(A)?y.delete(A):y.get(A)!==!0&&y.set(A,!1)}},[x,d.length,d.join("-")]);const S=[];if(u!==b){let k=[...u];for(let A=0;A<x.length;A++){const R=x[A],N=QS(R);d.includes(N)||(k.splice(A,0,R),S.push(R))}return i==="wait"&&S.length&&(k=S),w(ZU(k)),v(u),null}const{forceRender:C}=T.useContext(P6);return f.jsx(f.Fragment,{children:x.map(k=>{const A=QS(k),R=a&&!l?!1:u===x||d.includes(A),N=()=>{if(y.has(A))y.set(A,!0);else return;let I=!0;y.forEach(O=>{O||(I=!1)}),I&&(C==null||C(),w(m.current),a&&(c==null||c()),r&&r())};return f.jsx(dVe,{isPresent:R,initial:!h.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,onExitComplete:R?void 0:N,anchorX:o,children:k},A)})})},e2=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],XU={value:null};function pVe(e,t){let n=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){a.has(d)&&(u.schedule(d),e()),l++,d(o)}const u={schedule:(d,h=!1,m=!1)=>{const b=m&&s?n:r;return h&&a.add(d),b.has(d)||b.add(d),d},cancel:d=>{r.delete(d),a.delete(d)},process:d=>{if(o=d,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),t&&XU.value&&XU.value.frameloop[t].push(l),l=0,n.clear(),s=!1,i&&(i=!1,u.process(d))}};return u}const Kd={},mVe=40;function Wse(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=e2.reduce((S,C)=>(S[C]=pVe(i,t?C:void 0),S),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:m,postRender:y}=a,b=()=>{const S=Kd.useManualTiming?s.timestamp:performance.now();n=!1,Kd.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(S-s.timestamp,mVe),1)),s.timestamp=S,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),m.process(s),y.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(b))},v=()=>{n=!0,r=!0,s.isProcessing||e(b)};return{schedule:e2.reduce((S,C)=>{const k=a[C];return S[C]=(A,R=!1,N=!1)=>(n||v(),k.schedule(A,R,N)),S},{}),cancel:S=>{for(let C=0;C<e2.length;C++)a[e2[C]].cancel(S)},state:s,steps:a}}const Ul=e=>e,{schedule:ei,cancel:Mh,state:ya,steps:UI}=Wse(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ul,!0),Hse=T.createContext({strict:!1}),JU={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ky={};for(const e in JU)ky[e]={isEnabled:t=>JU[e].some(n=>!!t[n])};function gVe(e){for(const t in e)ky[t]={...ky[t],...e[t]}}const yVe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function qk(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||yVe.has(e)}let Gse=e=>!qk(e);function bVe(e){e&&(Gse=t=>t.startsWith("on")?!qk(t):e(t))}try{bVe(require("@emotion/is-prop-valid").default)}catch{}function vVe(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(Gse(s)||n===!0&&qk(s)||!t&&!qk(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}function xVe(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const zT=T.createContext({});function UT(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function $w(e){return typeof e=="string"||Array.isArray(e)}const B6=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],$6=["initial",...B6];function qT(e){return UT(e.animate)||$6.some(t=>$w(e[t]))}function Kse(e){return!!(qT(e)||e.variants)}function wVe(e,t){if(qT(e)){const{initial:n,animate:r}=e;return{initial:n===!1||$w(n)?n:void 0,animate:$w(r)?r:void 0}}return e.inherit!==!1?t:{}}function _Ve(e){const{initial:t,animate:n}=wVe(e,T.useContext(zT));return T.useMemo(()=>({initial:t,animate:n}),[QU(t),QU(n)])}function QU(e){return Array.isArray(e)?e.join(" "):e}const SVe=Symbol.for("motionComponentSymbol");function g0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function CVe(e,t,n){return T.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):g0(n)&&(n.current=r))},[t])}const z6=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),kVe="framerAppearId",Yse="data-"+z6(kVe),Zse=T.createContext({}),{schedule:U6}=Wse(queueMicrotask,!1);function EVe(e,t,n,r,s){var b,v;const{visualElement:i}=T.useContext(zT),a=T.useContext(Hse),o=T.useContext($T),l=T.useContext(L6).reducedMotion,c=T.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=T.useContext(Zse);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&TVe(c.current,n,s,d);const h=T.useRef(!1);T.useInsertionEffect(()=>{u&&h.current&&u.update(n,o)});const m=n[Yse],y=T.useRef(!!m&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,m))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,m)));return qse(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),U6.render(u.render),y.current&&u.animationState&&u.animationState.animateChanges())}),T.useEffect(()=>{u&&(!y.current&&u.animationState&&u.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)==null||x.call(window,m)}),y.current=!1))}),u}function TVe(e,t,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Xse(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&g0(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function Xse(e){if(e)return e.options.allowProjection!==!1?e.projection:Xse(e.parent)}let q6=()=>{};function AVe({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:s}){e&&gVe(e);function i(o,l){let c;const u={...T.useContext(L6),...o,layoutId:RVe(o)},{isStatic:d}=u,h=_Ve(o),m=r(o,d);if(!d&&F6){NVe();const y=MVe(u);c=y.MeasureLayout,h.visualElement=EVe(s,m,u,t,y.ProjectionNode)}return f.jsxs(zT.Provider,{value:h,children:[c&&h.visualElement?f.jsx(c,{visualElement:h.visualElement,...u}):null,n(s,o,CVe(m,h.visualElement,l),m,d,h.visualElement)]})}i.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const a=T.forwardRef(i);return a[SVe]=s,a}function RVe({layoutId:e}){const t=T.useContext(P6).id;return t&&e!==void 0?t+"-"+e:e}function NVe(e,t){T.useContext(Hse).strict}function MVe(e){const{drag:t,layout:n}=ky;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Jse=e=>t=>typeof t=="string"&&t.startsWith(e),V6=Jse("--"),IVe=Jse("var(--"),W6=e=>IVe(e)?jVe.test(e.split("/*")[0].trim()):!1,jVe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,zw={};function OVe(e){for(const t in e)zw[t]=e[t],V6(t)&&(zw[t].isCSSVariable=!0)}const ab=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ob=new Set(ab);function Qse(e,{layout:t,layoutId:n}){return ob.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!zw[e]||e==="opacity")}const Pa=e=>!!(e&&e.getVelocity),eie=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Yd=(e,t,n)=>n>t?t:n<e?e:n,lb={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Uw={...lb,transform:e=>Yd(0,1,e)},t2={...lb,default:1},eq={...lb,transform:Math.round},Z1=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Xf=Z1("deg"),vu=Z1("%"),ir=Z1("px"),PVe=Z1("vh"),DVe=Z1("vw"),tq={...vu,parse:e=>vu.parse(e)/100,transform:e=>vu.transform(e*100)},FVe={rotate:Xf,rotateX:Xf,rotateY:Xf,rotateZ:Xf,scale:t2,scaleX:t2,scaleY:t2,scaleZ:t2,skew:Xf,skewX:Xf,skewY:Xf,distance:ir,translateX:ir,translateY:ir,translateZ:ir,x:ir,y:ir,z:ir,perspective:ir,transformPerspective:ir,opacity:Uw,originX:tq,originY:tq,originZ:ir},H6={borderWidth:ir,borderTopWidth:ir,borderRightWidth:ir,borderBottomWidth:ir,borderLeftWidth:ir,borderRadius:ir,radius:ir,borderTopLeftRadius:ir,borderTopRightRadius:ir,borderBottomRightRadius:ir,borderBottomLeftRadius:ir,width:ir,maxWidth:ir,height:ir,maxHeight:ir,top:ir,right:ir,bottom:ir,left:ir,padding:ir,paddingTop:ir,paddingRight:ir,paddingBottom:ir,paddingLeft:ir,margin:ir,marginTop:ir,marginRight:ir,marginBottom:ir,marginLeft:ir,backgroundPositionX:ir,backgroundPositionY:ir,...FVe,zIndex:eq,fillOpacity:Uw,strokeOpacity:Uw,numOctaves:eq},LVe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},BVe=ab.length;function $Ve(e,t,n){let r="",s=!0;for(let i=0;i<BVe;i++){const a=ab[i],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=eie(o,H6[a]);if(!l){s=!1;const u=LVe[a]||a;r+=`${u}(${c}) `}n&&(t[a]=c)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function G6(e,t,n){const{style:r,vars:s,transformOrigin:i}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(ob.has(l)){a=!0;continue}else if(V6(l)){s[l]=c;continue}else{const u=eie(c,H6[l]);l.startsWith("origin")?(o=!0,i[l]=u):r[l]=u}}if(t.transform||(a||n?r.transform=$Ve(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const K6=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function tie(e,t,n){for(const r in t)!Pa(t[r])&&!Qse(r,n)&&(e[r]=t[r])}function zVe({transformTemplate:e},t){return T.useMemo(()=>{const n=K6();return G6(n,t,e),Object.assign({},n.vars,n.style)},[t])}function UVe(e,t){const n=e.style||{},r={};return tie(r,n,e),Object.assign(r,zVe(e,t)),r}function qVe(e,t){const n={},r=UVe(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const VVe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Y6(e){return typeof e!="string"||e.includes("-")?!1:!!(VVe.indexOf(e)>-1||/[A-Z]/u.test(e))}const WVe={offset:"stroke-dashoffset",array:"stroke-dasharray"},HVe={offset:"strokeDashoffset",array:"strokeDasharray"};function GVe(e,t,n=1,r=0,s=!0){e.pathLength=1;const i=s?WVe:HVe;e[i.offset]=ir.transform(-r);const a=ir.transform(t),o=ir.transform(n);e[i.array]=`${a} ${o}`}function nie(e,{attrX:t,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(G6(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),s!==void 0&&GVe(d,s,i,a,!1)}const rie=()=>({...K6(),attrs:{}}),sie=e=>typeof e=="string"&&e.toLowerCase()==="svg";function KVe(e,t,n,r){const s=T.useMemo(()=>{const i=rie();return nie(i,t,sie(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};tie(i,e.style,e),s.style={...i,...s.style}}return s}function YVe(e=!1){return(n,r,s,{latestValues:i},a)=>{const l=(Y6(n)?KVe:qVe)(r,i,a,n),c=vVe(r,typeof n=="string",e),u=n!==T.Fragment?{...c,...l,ref:s}:{},{children:d}=r,h=T.useMemo(()=>Pa(d)?d.get():d,[d]);return T.createElement(n,{...u,children:h})}}function nq(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function Z6(e,t,n,r){if(typeof t=="function"){const[s,i]=nq(r);t=t(n!==void 0?n:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=nq(r);t=t(n!==void 0?n:e.custom,s,i)}return t}function V2(e){return Pa(e)?e.get():e}function ZVe({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,s){return{latestValues:XVe(n,r,s,e),renderState:t()}}const iie=e=>(t,n)=>{const r=T.useContext(zT),s=T.useContext($T),i=()=>ZVe(e,t,r,s);return n?i():D6(i)};function XVe(e,t,n,r){const s={},i=r(e,{});for(const h in i)s[h]=V2(i[h]);let{initial:a,animate:o}=e;const l=qT(e),c=Kse(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!UT(d)){const h=Array.isArray(d)?d:[d];for(let m=0;m<h.length;m++){const y=Z6(e,h[m]);if(y){const{transitionEnd:b,transition:v,...x}=y;for(const w in x){let S=x[w];if(Array.isArray(S)){const C=u?S.length-1:0;S=S[C]}S!==null&&(s[w]=S)}for(const w in b)s[w]=b[w]}}}return s}function X6(e,t,n){var i;const{style:r}=e,s={};for(const a in r)(Pa(r[a])||t.style&&Pa(t.style[a])||Qse(a,e)||((i=n==null?void 0:n.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=r[a]);return s}const JVe={useVisualState:iie({scrapeMotionValuesFromProps:X6,createRenderState:K6})};function aie(e,t,n){const r=X6(e,t,n);for(const s in e)if(Pa(e[s])||Pa(t[s])){const i=ab.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=e[s]}return r}const QVe={useVisualState:iie({scrapeMotionValuesFromProps:aie,createRenderState:rie})};function eWe(e,t){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...Y6(r)?QVe:JVe,preloadedFeatures:e,useRender:YVe(s),createVisualElement:t,Component:r};return AVe(a)}}function qw(e,t,n){const r=e.getProps();return Z6(r,t,n!==void 0?n:r.custom,e)}const P4=e=>Array.isArray(e);let W2;function tWe(){W2=void 0}const ko={now:()=>(W2===void 0&&ko.set(ya.isProcessing||Kd.useManualTiming?ya.timestamp:performance.now()),W2),set:e=>{W2=e,queueMicrotask(tWe)}};function J6(e,t){e.indexOf(t)===-1&&e.push(t)}function Q6(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class e5{constructor(){this.subscriptions=[]}add(t){return J6(this.subscriptions,t),()=>Q6(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function oie(e,t){return t?e*(1e3/t):0}const rq=30,nWe=e=>!isNaN(parseFloat(e));class rWe{constructor(t,n={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{var a,o;const i=ko.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),s&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=ko.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=nWe(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new e5);const r=this.events[t].add(n);return t==="change"?()=>{r(),ei.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ko.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>rq)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,rq);return oie(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Vw(e,t){return new rWe(e,t)}function sWe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Vw(n))}function iWe(e){return P4(e)?e[e.length-1]||0:e}function aWe(e,t){const n=qw(e,t);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const o=iWe(i[a]);sWe(e,a,o)}}function oWe(e){return!!(Pa(e)&&e.add)}function D4(e,t){const n=e.getValue("willChange");if(oWe(n))return n.add(t);if(!n&&Kd.WillChange){const r=new Kd.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function lie(e){return e.props[Yse]}const lWe=e=>e!==null;function cWe(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(lWe),i=t&&n!=="loop"&&t%2===1?0:s.length-1;return s[i]}const uWe={type:"spring",stiffness:500,damping:25,restSpeed:10},dWe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),fWe={type:"keyframes",duration:.8},hWe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},pWe=(e,{keyframes:t})=>t.length>2?fWe:ob.has(e)?e.startsWith("scale")?dWe(t[1]):uWe:hWe;function mWe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function t5(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const xu=e=>e*1e3,wu=e=>e/1e3,Cx=e=>Math.round(e*1e5)/1e5,n5=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function gWe(e){return e==null}const yWe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,r5=(e,t)=>n=>!!(typeof n=="string"&&yWe.test(n)&&n.startsWith(e)||t&&!gWe(n)&&Object.prototype.hasOwnProperty.call(n,t)),cie=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,o]=r.match(n5);return{[e]:parseFloat(s),[t]:parseFloat(i),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},bWe=e=>Yd(0,255,e),qI={...lb,transform:e=>Math.round(bWe(e))},Zp={test:r5("rgb","red"),parse:cie("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+qI.transform(e)+", "+qI.transform(t)+", "+qI.transform(n)+", "+Cx(Uw.transform(r))+")"};function vWe(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const F4={test:r5("#"),parse:vWe,transform:Zp.transform},y0={test:r5("hsl","hue"),parse:cie("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+vu.transform(Cx(t))+", "+vu.transform(Cx(n))+", "+Cx(Uw.transform(r))+")"},Ma={test:e=>Zp.test(e)||F4.test(e)||y0.test(e),parse:e=>Zp.test(e)?Zp.parse(e):y0.test(e)?y0.parse(e):F4.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Zp.transform(e):y0.transform(e)},xWe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function wWe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(n5))==null?void 0:t.length)||0)+(((n=e.match(xWe))==null?void 0:n.length)||0)>0}const uie="number",die="color",_We="var",SWe="var(",sq="${}",CWe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ww(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const o=t.replace(CWe,l=>(Ma.test(l)?(r.color.push(i),s.push(die),n.push(Ma.parse(l))):l.startsWith(SWe)?(r.var.push(i),s.push(_We),n.push(l)):(r.number.push(i),s.push(uie),n.push(parseFloat(l))),++i,sq)).split(sq);return{values:n,split:o,indexes:r,types:s}}function fie(e){return Ww(e).values}function hie(e){const{split:t,types:n}=Ww(e),r=t.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],s[a]!==void 0){const o=n[a];o===uie?i+=Cx(s[a]):o===die?i+=Ma.transform(s[a]):i+=s[a]}return i}}const kWe=e=>typeof e=="number"?0:e;function EWe(e){const t=fie(e);return hie(e)(t.map(kWe))}const Ih={test:wWe,parse:fie,createTransformer:hie,getAnimatableNone:EWe};function VI(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function TWe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,i=0,a=0;if(!t)s=i=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;s=VI(l,o,e+1/3),i=VI(l,o,e),a=VI(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function Vk(e,t){return n=>n>0?t:e}const Js=(e,t,n)=>e+(t-e)*n,WI=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},AWe=[F4,Zp,y0],RWe=e=>AWe.find(t=>t.test(e));function iq(e){const t=RWe(e);if(!t)return!1;let n=t.parse(e);return t===y0&&(n=TWe(n)),n}const aq=(e,t)=>{const n=iq(e),r=iq(t);if(!n||!r)return Vk(e,t);const s={...n};return i=>(s.red=WI(n.red,r.red,i),s.green=WI(n.green,r.green,i),s.blue=WI(n.blue,r.blue,i),s.alpha=Js(n.alpha,r.alpha,i),Zp.transform(s))},L4=new Set(["none","hidden"]);function NWe(e,t){return L4.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}const MWe=(e,t)=>n=>t(e(n)),X1=(...e)=>e.reduce(MWe);function IWe(e,t){return n=>Js(e,t,n)}function s5(e){return typeof e=="number"?IWe:typeof e=="string"?W6(e)?Vk:Ma.test(e)?aq:PWe:Array.isArray(e)?pie:typeof e=="object"?Ma.test(e)?aq:jWe:Vk}function pie(e,t){const n=[...e],r=n.length,s=e.map((i,a)=>s5(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function jWe(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=s5(e[s])(e[s],t[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function OWe(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],a=e.indexes[i][r[i]],o=e.values[a]??0;n[s]=o,r[i]++}return n}const PWe=(e,t)=>{const n=Ih.createTransformer(t),r=Ww(e),s=Ww(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?L4.has(e)&&!s.values.length||L4.has(t)&&!r.values.length?NWe(e,t):X1(pie(OWe(r,s),s.values),n):Vk(e,t)};function mie(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?Js(e,t,n):s5(e)(e,t)}const DWe=e=>{const t=({timestamp:n})=>e(n);return{start:()=>ei.update(t,!0),stop:()=>Mh(t),now:()=>ya.isProcessing?ya.timestamp:ko.now()}},gie=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let i=0;i<s;i++)r+=e(i/(s-1))+", ";return`linear(${r.substring(0,r.length-2)})`},Wk=2e4;function i5(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<Wk;)t+=n,r=e.next(t);return t>=Wk?1/0:t}function FWe(e,t=100,n){const r=n({...e,keyframes:[0,t]}),s=Math.min(i5(r),Wk);return{type:"keyframes",ease:i=>r.next(s*i).value/t,duration:wu(s)}}const LWe=5;function yie(e,t,n){const r=Math.max(t-LWe,0);return oie(n-e(r),t-r)}const ii={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},oq=.001;function BWe({duration:e=ii.duration,bounce:t=ii.bounce,velocity:n=ii.velocity,mass:r=ii.mass}){let s,i,a=1-t;a=Yd(ii.minDamping,ii.maxDamping,a),e=Yd(ii.minDuration,ii.maxDuration,wu(e)),a<1?(s=c=>{const u=c*a,d=u*e,h=u-n,m=B4(c,a),y=Math.exp(-d);return oq-h/m*y},i=c=>{const d=c*a*e,h=d*n+n,m=Math.pow(a,2)*Math.pow(c,2)*e,y=Math.exp(-d),b=B4(Math.pow(c,2),a);return(-s(c)+oq>0?-1:1)*((h-m)*y)/b}):(s=c=>{const u=Math.exp(-c*e),d=(c-n)*e+1;return-.001+u*d},i=c=>{const u=Math.exp(-c*e),d=(n-c)*(e*e);return u*d});const o=5/e,l=zWe(s,i,o);if(e=xu(e),isNaN(l))return{stiffness:ii.stiffness,damping:ii.damping,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:e}}}const $We=12;function zWe(e,t,n){let r=n;for(let s=1;s<$We;s++)r=r-e(r)/t(r);return r}function B4(e,t){return e*Math.sqrt(1-t*t)}const UWe=["duration","bounce"],qWe=["stiffness","damping","mass"];function lq(e,t){return t.some(n=>e[n]!==void 0)}function VWe(e){let t={velocity:ii.velocity,stiffness:ii.stiffness,damping:ii.damping,mass:ii.mass,isResolvedFromDuration:!1,...e};if(!lq(e,qWe)&&lq(e,UWe))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*Yd(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:ii.mass,stiffness:s,damping:i}}else{const n=BWe(e);t={...t,...n,mass:ii.mass},t.isResolvedFromDuration=!0}return t}function Hk(e=ii.visualDuration,t=ii.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:m}=VWe({...n,velocity:-wu(n.velocity||0)}),y=h||0,b=c/(2*Math.sqrt(l*u)),v=a-i,x=wu(Math.sqrt(l/u)),w=Math.abs(v)<5;r||(r=w?ii.restSpeed.granular:ii.restSpeed.default),s||(s=w?ii.restDelta.granular:ii.restDelta.default);let S;if(b<1){const k=B4(x,b);S=A=>{const R=Math.exp(-b*x*A);return a-R*((y+b*x*v)/k*Math.sin(k*A)+v*Math.cos(k*A))}}else if(b===1)S=k=>a-Math.exp(-x*k)*(v+(y+x*v)*k);else{const k=x*Math.sqrt(b*b-1);S=A=>{const R=Math.exp(-b*x*A),N=Math.min(k*A,300);return a-R*((y+b*x*v)*Math.sinh(N)+k*v*Math.cosh(N))/k}}const C={calculatedDuration:m&&d||null,next:k=>{const A=S(k);if(m)o.done=k>=d;else{let R=k===0?y:0;b<1&&(R=k===0?xu(y):yie(S,k,A));const N=Math.abs(R)<=r,I=Math.abs(a-A)<=s;o.done=N&&I}return o.value=o.done?a:A,o},toString:()=>{const k=Math.min(i5(C),Wk),A=gie(R=>C.next(k*R).value,k,30);return k+"ms "+A},toTransition:()=>{}};return C}Hk.applyToOptions=e=>{const t=FWe(e,100,Hk);return e.ease=t.ease,e.duration=xu(t.duration),e.type="keyframes",e};function $4({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],h={done:!1,value:d},m=N=>o!==void 0&&N<o||l!==void 0&&N>l,y=N=>o===void 0?l:l===void 0||Math.abs(o-N)<Math.abs(l-N)?o:l;let b=n*t;const v=d+b,x=a===void 0?v:a(v);x!==v&&(b=x-d);const w=N=>-b*Math.exp(-N/r),S=N=>x+w(N),C=N=>{const I=w(N),O=S(N);h.done=Math.abs(I)<=c,h.value=h.done?x:O};let k,A;const R=N=>{m(h.value)&&(k=N,A=Hk({keyframes:[h.value,y(h.value)],velocity:yie(S,N,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return R(0),{calculatedDuration:null,next:N=>{let I=!1;return!A&&k===void 0&&(I=!0,C(N),R(N)),k!==void 0&&N>=k?A.next(N-k):(!I&&C(N),h)}}}const Hw=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};function WWe(e,t,n){const r=[],s=n||Kd.mix||mie,i=e.length-1;for(let a=0;a<i;a++){let o=s(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Ul:t;o=X1(l,o)}r.push(o)}return r}function HWe(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const i=e.length;if(q6(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=WWe(t,r,s),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const h=Hw(e[d],e[d+1],u);return o[d](h)};return n?u=>c(Yd(e[0],e[i-1],u)):c}function GWe(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=Hw(0,t,r);e.push(Js(n,1,s))}}function KWe(e){const t=[0];return GWe(t,e.length-1),t}function YWe(e,t){return e.map(n=>n*t)}const bie=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,ZWe=1e-7,XWe=12;function JWe(e,t,n,r,s){let i,a,o=0;do a=t+(n-t)/2,i=bie(a,r,s)-e,i>0?n=a:t=a;while(Math.abs(i)>ZWe&&++o<XWe);return a}function J1(e,t,n,r){if(e===t&&n===r)return Ul;const s=i=>JWe(i,0,1,e,n);return i=>i===0||i===1?i:bie(s(i),t,r)}const QWe=J1(.42,0,1,1),eHe=J1(0,0,.58,1),vie=J1(.42,0,.58,1),tHe=e=>Array.isArray(e)&&typeof e[0]!="number",xie=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,wie=e=>t=>1-e(1-t),_ie=J1(.33,1.53,.69,.99),a5=wie(_ie),Sie=xie(a5),Cie=e=>(e*=2)<1?.5*a5(e):.5*(2-Math.pow(2,-10*(e-1))),o5=e=>1-Math.sin(Math.acos(e)),kie=wie(o5),Eie=xie(o5),Tie=e=>Array.isArray(e)&&typeof e[0]=="number",nHe={linear:Ul,easeIn:QWe,easeInOut:vie,easeOut:eHe,circIn:o5,circInOut:Eie,circOut:kie,backIn:a5,backInOut:Sie,backOut:_ie,anticipate:Cie},rHe=e=>typeof e=="string",cq=e=>{if(Tie(e)){q6(e.length===4);const[t,n,r,s]=e;return J1(t,n,r,s)}else if(rHe(e))return nHe[e];return e};function sHe(e,t){return e.map(()=>t||vie).splice(0,e.length-1)}function kx({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=tHe(r)?r.map(cq):cq(r),i={done:!1,value:t[0]},a=YWe(n&&n.length===t.length?n:KWe(t),e),o=HWe(a,t,{ease:Array.isArray(s)?s:sHe(t,s)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}const iHe=e=>e!==null;function l5(e,{repeat:t,repeatType:n="loop"},r,s=1){const i=e.filter(iHe),o=s<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const aHe={decay:$4,inertia:$4,tween:kx,keyframes:kx,spring:Hk};function Aie(e){typeof e.type=="string"&&(e.type=aHe[e.type])}class c5{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const oHe=e=>e/100;class Rie extends c5{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;if(n&&n.updatedAt!==ko.now()&&this.tick(ko.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:r}=this.options;r&&r()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Aie(t);const{type:n=kx,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=t;let{keyframes:o}=t;const l=n||kx;l!==kx&&typeof o[0]!="number"&&(this.mixKeyframes=X1(oHe,mie(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=i5(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:m,type:y,onUpdate:b,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-c*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?x<0:x>s;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let S=this.currentTime,C=r;if(d){const N=Math.min(this.currentTime,s)/o;let I=Math.floor(N),O=N%1;!O&&N>=1&&(O=1),O===1&&I--,I=Math.min(I,d+1),!!(I%2)&&(h==="reverse"?(O=1-O,m&&(O-=m/o)):h==="mirror"&&(C=a)),S=Yd(0,1,O)*o}const k=w?{done:!1,value:u[0]}:C.next(S);i&&(k.value=i(k.value));let{done:A}=k;!w&&l!==null&&(A=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&A);return R&&y!==$4&&(k.value=l5(u,this.options,v,this.speed)),b&&b(k.value),R&&this.finish(),k}then(t,n){return this.finished.then(t,n)}get duration(){return wu(this.calculatedDuration)}get time(){return wu(this.currentTime)}set time(t){t=xu(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(ko.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=wu(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=DWe,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ko.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function lHe(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Xp=e=>e*180/Math.PI,z4=e=>{const t=Xp(Math.atan2(e[1],e[0]));return U4(t)},cHe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:z4,rotateZ:z4,skewX:e=>Xp(Math.atan(e[1])),skewY:e=>Xp(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},U4=e=>(e=e%360,e<0&&(e+=360),e),uq=z4,dq=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),fq=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),uHe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:dq,scaleY:fq,scale:e=>(dq(e)+fq(e))/2,rotateX:e=>U4(Xp(Math.atan2(e[6],e[5]))),rotateY:e=>U4(Xp(Math.atan2(-e[2],e[0]))),rotateZ:uq,rotate:uq,skewX:e=>Xp(Math.atan(e[4])),skewY:e=>Xp(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function hq(e){return e.includes("scale")?1:0}function q4(e,t){if(!e||e==="none")return hq(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=uHe,s=n;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=cHe,s=o}if(!s)return hq(t);const i=r[t],a=s[1].split(",").map(fHe);return typeof i=="function"?i(a):a[i]}const dHe=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return q4(n,t)};function fHe(e){return parseFloat(e.trim())}const pq=e=>e===lb||e===ir,hHe=new Set(["x","y","z"]),pHe=ab.filter(e=>!hHe.has(e));function mHe(e){const t=[];return pHe.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const nm={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>q4(t,"x"),y:(e,{transform:t})=>q4(t,"y")};nm.translateX=nm.x;nm.translateY=nm.y;const rm=new Set;let V4=!1,W4=!1,H4=!1;function Nie(){if(W4){const e=Array.from(rm).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=mHe(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{var o;(o=r.getValue(i))==null||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}W4=!1,V4=!1,rm.forEach(e=>e.complete(H4)),rm.clear()}function Mie(){rm.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(W4=!0)})}function gHe(){H4=!0,Mie(),Nie(),H4=!1}class u5{constructor(t,n,r,s,i,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(rm.add(this),V4||(V4=!0,ei.read(Mie),ei.resolveKeyframes(Nie))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const o=r.readValue(n,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),s&&i===void 0&&s.set(t[0])}lHe(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),rm.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,rm.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const yHe=e=>e.startsWith("--");function bHe(e,t,n){yHe(t)?e.style.setProperty(t,n):e.style[t]=n}function d5(e){let t;return()=>(t===void 0&&(t=e()),t)}const vHe=d5(()=>window.ScrollTimeline!==void 0),xHe={};function wHe(e,t){const n=d5(e);return()=>xHe[t]??n()}const Iie=wHe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),tx=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,mq={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:tx([0,.65,.55,1]),circOut:tx([.55,0,1,.45]),backIn:tx([.31,.01,.66,-.59]),backOut:tx([.33,1.53,.69,.99])};function jie(e,t){if(e)return typeof e=="function"?Iie()?gie(e,t):"ease-out":Tie(e)?tx(e):Array.isArray(e)?e.map(n=>jie(n,t)||mq.easeOut):mq[e]}function _He(e,t,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:n};l&&(u.offset=l);const d=jie(o,s);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(u,h)}function Oie(e){return typeof e=="function"&&"applyToOptions"in e}function SHe({type:e,...t}){return Oie(e)&&Iie()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class CHe extends c5{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,q6(typeof t.type!="string");const c=SHe(t);this.animation=_He(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=l5(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):bHe(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return wu(Number(t))}get time(){return wu(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=xu(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&vHe()?(this.animation.timeline=t,Ul):n(this)}}const Pie={anticipate:Cie,backInOut:Sie,circInOut:Eie};function kHe(e){return e in Pie}function EHe(e){typeof e.ease=="string"&&kHe(e.ease)&&(e.ease=Pie[e.ease])}const gq=10;class THe extends CHe{constructor(t){EHe(t),Aie(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const o=new Rie({...a,autoplay:!1}),l=xu(this.finishedTime??this.time);n.setWithVelocity(o.sample(l-gq).value,o.sample(l).value,gq),o.stop()}}const yq=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ih.test(e)||e==="0")&&!e.startsWith("url("));function AHe(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function RHe(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=yq(s,t),o=yq(i,t);return!a||!o?!1:AHe(e)||(n==="spring"||Oie(n))&&r}const NHe=new Set(["opacity","clipPath","filter","transform"]),MHe=d5(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function IHe(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:s,damping:i,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return MHe()&&n&&NHe.has(n)&&(n!=="transform"||!l)&&!o&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const jHe=40;class OHe extends c5{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...d}){var y;super(),this.stop=()=>{var b,v;this._animation?(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)):(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=ko.now();const h={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...d},m=(u==null?void 0:u.KeyframeResolver)||u5;this.keyframeResolver=new m(o,(b,v,x)=>this.onKeyframesResolved(b,v,h,!x),l,c,u),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(t,n,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=ko.now(),RHe(t,i,a,o)||((Kd.instantAnimations||!l)&&(u==null||u(l5(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>jHe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},m=!c&&IHe(h)?new THe({...h,element:h.motionValue.owner.current}):new Rie(h);m.finished.then(()=>this.notifyFinished()).catch(Ul),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||gHe(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const f5=(e,t,n,r={},s,i)=>a=>{const o=t5(r,e)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-xu(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:s};mWe(o)||Object.assign(u,pWe(e,u)),u.duration&&(u.duration=xu(u.duration)),u.repeatDelay&&(u.repeatDelay=xu(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),(Kd.instantAnimations||Kd.skipAnimations)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!o.type&&!o.ease,d&&!i&&t.get()!==void 0){const h=cWe(u.keyframes,o);if(h!==void 0){ei.update(()=>{u.onUpdate(h),u.onComplete()});return}}return new OHe(u)},Die=new Set(["width","height","top","left","right","bottom",...ab]);function PHe({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function Fie(e,t,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(i=r);const l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(const u in o){const d=e.getValue(u,e.latestValues[u]??null),h=o[u];if(h===void 0||c&&PHe(c,u))continue;const m={delay:n,...t5(i||{},u)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===y&&!m.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const x=lie(e);if(x){const w=window.MotionHandoffAnimation(x,u,ei);w!==null&&(m.startTime=w,b=!0)}}D4(e,u),d.start(f5(u,d,h,e.shouldReduceMotion&&Die.has(u)?{type:!1}:m,e,b));const v=d.animation;v&&l.push(v)}return a&&Promise.all(l).then(()=>{ei.update(()=>{a&&aWe(e,a)})}),l}function G4(e,t,n={}){var l;const r=qw(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(Fie(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return DHe(e,t,u+c,d,h,n)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(n.delay)])}function DHe(e,t,n=0,r=0,s=1,i){const a=[],o=(e.variantChildren.size-1)*r,l=s===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(FHe).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(G4(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function FHe(e,t){return e.sortNodePosition(t)}function LHe(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(i=>G4(e,i,n));r=Promise.all(s)}else if(typeof t=="string")r=G4(e,t,n);else{const s=typeof t=="function"?qw(e,t,n.custom):t;r=Promise.all(Fie(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function Lie(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const BHe=$6.length;function Bie(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?Bie(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<BHe;n++){const r=$6[n],s=e.props[r];($w(s)||s===!1)&&(t[r]=s)}return t}const $He=[...B6].reverse(),zHe=B6.length;function UHe(e){return t=>Promise.all(t.map(({animation:n,options:r})=>LHe(e,n,r)))}function qHe(e){let t=UHe(e),n=bq(),r=!0;const s=l=>(c,u)=>{var h;const d=qw(e,u,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:m,transitionEnd:y,...b}=d;c={...c,...b,...y}}return c};function i(l){t=l(e)}function a(l){const{props:c}=e,u=Bie(e.parent)||{},d=[],h=new Set;let m={},y=1/0;for(let v=0;v<zHe;v++){const x=$He[v],w=n[x],S=c[x]!==void 0?c[x]:u[x],C=$w(S),k=x===l?w.isActive:null;k===!1&&(y=v);let A=S===u[x]&&S!==c[x]&&C;if(A&&r&&e.manuallyAnimateOnMount&&(A=!1),w.protectedKeys={...m},!w.isActive&&k===null||!S&&!w.prevProp||UT(S)||typeof S=="boolean")continue;const R=VHe(w.prevProp,S);let N=R||x===l&&w.isActive&&!A&&C||v>y&&C,I=!1;const O=Array.isArray(S)?S:[S];let L=O.reduce(s(x),{});k===!1&&(L={});const{prevResolvedValues:P={}}=w,V={...P,...L},F=H=>{N=!0,h.has(H)&&(I=!0,h.delete(H)),w.needsAnimating[H]=!0;const $=e.getValue(H);$&&($.liveStyle=!1)};for(const H in V){const $=L[H],ne=P[H];if(m.hasOwnProperty(H))continue;let W=!1;P4($)&&P4(ne)?W=!Lie($,ne):W=$!==ne,W?$!=null?F(H):h.add(H):$!==void 0&&h.has(H)?F(H):w.protectedKeys[H]=!0}w.prevProp=S,w.prevResolvedValues=L,w.isActive&&(m={...m,...L}),r&&e.blockInitialAnimation&&(N=!1),N&&(!(A&&R)||I)&&d.push(...O.map(H=>({animation:H,options:{type:x}})))}if(h.size){const v={};if(typeof c.initial!="boolean"){const x=qw(e,Array.isArray(c.initial)?c.initial[0]:c.initial);x&&x.transition&&(v.transition=x.transition)}h.forEach(x=>{const w=e.getBaseTarget(x),S=e.getValue(x);S&&(S.liveStyle=!0),v[x]=w??null}),d.push({animation:v})}let b=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(b=!1),r=!1,b?t(d):Promise.resolve()}function o(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(l,c)}),n[l].isActive=c;const u=a(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>n,reset:()=>{n=bq(),r=!0}}}function VHe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Lie(t,e):!1}function Ip(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function bq(){return{animate:Ip(!0),whileInView:Ip(),whileHover:Ip(),whileTap:Ip(),whileDrag:Ip(),whileFocus:Ip(),exit:Ip()}}class Xh{constructor(t){this.isMounted=!1,this.node=t}update(){}}class WHe extends Xh{constructor(t){super(t),t.animationState||(t.animationState=qHe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();UT(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let HHe=0;class GHe extends Xh{constructor(){super(...arguments),this.id=HHe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const KHe={animation:{Feature:WHe},exit:{Feature:GHe}};function Gw(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const h5=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function Q1(e){return{point:{x:e.pageX,y:e.pageY}}}const YHe=e=>t=>h5(t)&&e(t,Q1(t));function Ex(e,t,n,r){return Gw(e,t,YHe(n),r)}function $ie({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function ZHe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function XHe(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const zie=1e-4,JHe=1-zie,QHe=1+zie,Uie=.01,eGe=0-Uie,tGe=0+Uie;function eo(e){return e.max-e.min}function nGe(e,t,n){return Math.abs(e-t)<=n}function vq(e,t,n,r=.5){e.origin=r,e.originPoint=Js(t.min,t.max,e.origin),e.scale=eo(n)/eo(t),e.translate=Js(n.min,n.max,e.origin)-e.originPoint,(e.scale>=JHe&&e.scale<=QHe||isNaN(e.scale))&&(e.scale=1),(e.translate>=eGe&&e.translate<=tGe||isNaN(e.translate))&&(e.translate=0)}function Tx(e,t,n,r){vq(e.x,t.x,n.x,r?r.originX:void 0),vq(e.y,t.y,n.y,r?r.originY:void 0)}function xq(e,t,n){e.min=n.min+t.min,e.max=e.min+eo(t)}function rGe(e,t,n){xq(e.x,t.x,n.x),xq(e.y,t.y,n.y)}function wq(e,t,n){e.min=t.min-n.min,e.max=e.min+eo(t)}function Ax(e,t,n){wq(e.x,t.x,n.x),wq(e.y,t.y,n.y)}const _q=()=>({translate:0,scale:1,origin:0,originPoint:0}),b0=()=>({x:_q(),y:_q()}),Sq=()=>({min:0,max:0}),fi=()=>({x:Sq(),y:Sq()});function Ol(e){return[e("x"),e("y")]}function HI(e){return e===void 0||e===1}function K4({scale:e,scaleX:t,scaleY:n}){return!HI(e)||!HI(t)||!HI(n)}function Fp(e){return K4(e)||qie(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function qie(e){return Cq(e.x)||Cq(e.y)}function Cq(e){return e&&e!=="0%"}function Gk(e,t,n){const r=e-n,s=t*r;return n+s}function kq(e,t,n,r,s){return s!==void 0&&(e=Gk(e,s,r)),Gk(e,n,r)+t}function Y4(e,t=0,n=1,r,s){e.min=kq(e.min,t,n,r,s),e.max=kq(e.max,t,n,r,s)}function Vie(e,{x:t,y:n}){Y4(e.x,t.translate,t.scale,t.originPoint),Y4(e.y,n.translate,n.scale,n.originPoint)}const Eq=.999999999999,Tq=1.0000000000001;function sGe(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let i,a;for(let o=0;o<s;o++){i=n[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&x0(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Vie(e,a)),r&&Fp(i.latestValues)&&x0(e,i.latestValues))}t.x<Tq&&t.x>Eq&&(t.x=1),t.y<Tq&&t.y>Eq&&(t.y=1)}function v0(e,t){e.min=e.min+t,e.max=e.max+t}function Aq(e,t,n,r,s=.5){const i=Js(e.min,e.max,s);Y4(e,t,n,i,r)}function x0(e,t){Aq(e.x,t.x,t.scaleX,t.scale,t.originX),Aq(e.y,t.y,t.scaleY,t.scale,t.originY)}function Wie(e,t){return $ie(XHe(e.getBoundingClientRect(),t))}function iGe(e,t,n){const r=Wie(e,n),{scroll:s}=t;return s&&(v0(r.x,s.offset.x),v0(r.y,s.offset.y)),r}const Hie=({current:e})=>e?e.ownerDocument.defaultView:null,Rq=(e,t)=>Math.abs(e-t);function aGe(e,t){const n=Rq(e.x,t.x),r=Rq(e.y,t.y);return Math.sqrt(n**2+r**2)}class Gie{constructor(t,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=KI(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=aGe(d.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:y}=d,{timestamp:b}=ya;this.history.push({...y,timestamp:b});const{onStart:v,onMove:x}=this.handlers;h||(v&&v(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=GI(h,this.transformPagePoint),ei.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:m,onSessionEnd:y,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=KI(d.type==="pointercancel"?this.lastMoveEventInfo:GI(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(d,v),y&&y(d,v)},!h5(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=Q1(t),o=GI(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=ya;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,KI(o,this.history)),this.removeListeners=X1(Ex(this.contextWindow,"pointermove",this.handlePointerMove),Ex(this.contextWindow,"pointerup",this.handlePointerUp),Ex(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Mh(this.updatePoint)}}function GI(e,t){return t?{point:t(e.point)}:e}function Nq(e,t){return{x:e.x-t.x,y:e.y-t.y}}function KI({point:e},t){return{point:e,delta:Nq(e,Kie(t)),offset:Nq(e,oGe(t)),velocity:lGe(t,.1)}}function oGe(e){return e[0]}function Kie(e){return e[e.length-1]}function lGe(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=Kie(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>xu(t)));)n--;if(!r)return{x:0,y:0};const i=wu(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function cGe(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?Js(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?Js(n,e,r.max):Math.min(e,n)),e}function Mq(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function uGe(e,{top:t,left:n,bottom:r,right:s}){return{x:Mq(e.x,n,s),y:Mq(e.y,t,r)}}function Iq(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function dGe(e,t){return{x:Iq(e.x,t.x),y:Iq(e.y,t.y)}}function fGe(e,t){let n=.5;const r=eo(e),s=eo(t);return s>r?n=Hw(t.min,t.max-r,e.min):r>s&&(n=Hw(e.min,e.max-s,t.min)),Yd(0,1,n)}function hGe(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const Z4=.35;function pGe(e=Z4){return e===!1?e=0:e===!0&&(e=Z4),{x:jq(e,"left","right"),y:jq(e,"top","bottom")}}function jq(e,t,n){return{min:Oq(e,t),max:Oq(e,n)}}function Oq(e,t){return typeof e=="number"?e:e[t]||0}const oc={x:!1,y:!1};function Yie(){return oc.x||oc.y}function mGe(e){return e==="x"||e==="y"?oc[e]?null:(oc[e]=!0,()=>{oc[e]=!1}):oc.x||oc.y?null:(oc.x=oc.y=!0,()=>{oc.x=oc.y=!1})}const gGe=new WeakMap;class yGe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=fi(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Q1(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:m,onDragStart:y}=this.getProps();if(h&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=mGe(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ol(v=>{let x=this.getAxisMotionValue(v).get()||0;if(vu.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const S=w.layout.layoutBox[v];S&&(x=eo(S)*(parseFloat(x)/100))}}this.originPoint[v]=x}),y&&ei.postRender(()=>y(u,d)),D4(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,d)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:y,onDrag:b}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:v}=d;if(m&&this.currentDirection===null){this.currentDirection=bGe(v),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,v),this.updateAxis("y",d.point,v),this.visualElement.render(),b&&b(u,d)},o=(u,d)=>this.stop(u,d),l=()=>Ol(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new Gie(t,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:Hie(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&ei.postRender(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!n2(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=cGe(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&g0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=uGe(r.layoutBox,t):this.constraints=!1,this.elastic=pGe(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ol(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=hGe(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!g0(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=iGe(r,s.root,this.visualElement.getTransformPagePoint());let a=dGe(s.layout.layoutBox,i);if(n){const o=n(ZHe(a));this.hasMutatedConstraints=!!o,o&&(a=$ie(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ol(u=>{if(!n2(u,n,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,y={type:"inertia",velocity:r?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return D4(this.visualElement,t),r.start(f5(t,r,0,n,this.visualElement,!1))}stopAnimation(){Ol(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ol(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Ol(n=>{const{drag:r}=this.getProps();if(!n2(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[n];i.set(t[n]-Js(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!g0(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Ol(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=fGe({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ol(a=>{if(!n2(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(Js(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;gGe.set(this.visualElement,this);const t=this.visualElement.current,n=Ex(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();g0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ei.read(r);const a=Gw(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ol(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=Z4,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function n2(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function bGe(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class vGe extends Xh{constructor(t){super(t),this.removeGroupControls=Ul,this.removeListeners=Ul,this.controls=new yGe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ul}unmount(){this.removeGroupControls(),this.removeListeners()}}const Pq=e=>(t,n)=>{e&&ei.postRender(()=>e(t,n))};class xGe extends Xh{constructor(){super(...arguments),this.removePointerDownListener=Ul}onPointerDown(t){this.session=new Gie(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Hie(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:Pq(t),onStart:Pq(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&ei.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Ex(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const H2={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Dq(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Vv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ir.test(e))e=parseFloat(e);else return e;const n=Dq(e,t.target.x),r=Dq(e,t.target.y);return`${n}% ${r}%`}},wGe={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=Ih.parse(e);if(s.length>5)return r;const i=Ih.createTransformer(e),a=typeof s[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;s[0+a]/=o,s[1+a]/=l;const c=Js(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};class _Ge extends T.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=t;OVe(SGe),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),H2.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,s||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ei.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),U6.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Zie(e){const[t,n]=Vse(),r=T.useContext(P6);return f.jsx(_Ge,{...e,layoutGroup:r,switchLayoutGroup:T.useContext(Zse),isPresent:t,safeToRemove:n})}const SGe={borderRadius:{...Vv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Vv,borderTopRightRadius:Vv,borderBottomLeftRadius:Vv,borderBottomRightRadius:Vv,boxShadow:wGe};function CGe(e,t,n){const r=Pa(e)?e:Vw(e);return r.start(f5("",r,t,n)),r.animation}function kGe(e){return e instanceof SVGElement&&e.tagName!=="svg"}const EGe=(e,t)=>e.depth-t.depth;class TGe{constructor(){this.children=[],this.isDirty=!1}add(t){J6(this.children,t),this.isDirty=!0}remove(t){Q6(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(EGe),this.isDirty=!1,this.children.forEach(t)}}function AGe(e,t){const n=ko.now(),r=({timestamp:s})=>{const i=s-n;i>=t&&(Mh(r),e(i-t))};return ei.setup(r,!0),()=>Mh(r)}const Xie=["TopLeft","TopRight","BottomLeft","BottomRight"],RGe=Xie.length,Fq=e=>typeof e=="string"?parseFloat(e):e,Lq=e=>typeof e=="number"||ir.test(e);function NGe(e,t,n,r,s,i){s?(e.opacity=Js(0,n.opacity??1,MGe(r)),e.opacityExit=Js(t.opacity??1,0,IGe(r))):i&&(e.opacity=Js(t.opacity??1,n.opacity??1,r));for(let a=0;a<RGe;a++){const o=`border${Xie[a]}Radius`;let l=Bq(t,o),c=Bq(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||Lq(l)===Lq(c)?(e[o]=Math.max(Js(Fq(l),Fq(c),r),0),(vu.test(c)||vu.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=Js(t.rotate||0,n.rotate||0,r))}function Bq(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const MGe=Jie(0,.5,kie),IGe=Jie(.5,.95,Ul);function Jie(e,t,n){return r=>r<e?0:r>t?1:n(Hw(e,t,r))}function $q(e,t){e.min=t.min,e.max=t.max}function Il(e,t){$q(e.x,t.x),$q(e.y,t.y)}function zq(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Uq(e,t,n,r,s){return e-=t,e=Gk(e,1/n,r),s!==void 0&&(e=Gk(e,1/s,r)),e}function jGe(e,t=0,n=1,r=.5,s,i=e,a=e){if(vu.test(t)&&(t=parseFloat(t),t=Js(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=Js(i.min,i.max,r);e===i&&(o-=t),e.min=Uq(e.min,t,n,o,s),e.max=Uq(e.max,t,n,o,s)}function qq(e,t,[n,r,s],i,a){jGe(e,t[n],t[r],t[s],t.scale,i,a)}const OGe=["x","scaleX","originX"],PGe=["y","scaleY","originY"];function Vq(e,t,n,r){qq(e.x,t,OGe,n?n.x:void 0,r?r.x:void 0),qq(e.y,t,PGe,n?n.y:void 0,r?r.y:void 0)}function Wq(e){return e.translate===0&&e.scale===1}function Qie(e){return Wq(e.x)&&Wq(e.y)}function Hq(e,t){return e.min===t.min&&e.max===t.max}function DGe(e,t){return Hq(e.x,t.x)&&Hq(e.y,t.y)}function Gq(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function eae(e,t){return Gq(e.x,t.x)&&Gq(e.y,t.y)}function Kq(e){return eo(e.x)/eo(e.y)}function Yq(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class FGe{constructor(){this.members=[]}add(t){J6(this.members,t),t.scheduleRender()}remove(t){if(Q6(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function LGe(e,t,n){let r="";const s=e.x.translate/t.x,i=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:m,skewY:y}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),m&&(r+=`skewX(${m}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const YI=["","X","Y","Z"],BGe={visibility:"hidden"},Zq=1e3;let $Ge=0;function ZI(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function tae(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=lie(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",ei,!(s||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&tae(r)}function nae({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},o=t==null?void 0:t()){this.id=$Ge++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(qGe),this.nodes.forEach(KGe),this.nodes.forEach(YGe),this.nodes.forEach(VGe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new TGe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new e5),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=kGe(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=AGe(d,250),H2.hasAnimatedSinceResize&&(H2.hasAnimatedSinceResize=!1,this.nodes.forEach(Jq))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||c.getDefaultTransition()||eKe,{onLayoutAnimationStart:b,onLayoutAnimationComplete:v}=c.getProps(),x=!this.targetLayout||!eae(this.targetLayout,m),w=!d&&h;if(this.options.layoutRoot||this.resumeFrom||w||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const S={...t5(y,"layout"),onPlay:b,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else d||Jq(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Mh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ZGe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&tae(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Xq);return}this.isUpdating||this.nodes.forEach(HGe),this.isUpdating=!1,this.nodes.forEach(GGe),this.nodes.forEach(zGe),this.nodes.forEach(UGe),this.clearAllSnapshots();const o=ko.now();ya.delta=Yd(0,1e3/60,o-ya.timestamp),ya.timestamp=o,ya.isProcessing=!0,UI.update.process(ya),UI.preRender.process(ya),UI.render.process(ya),ya.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,U6.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(WGe),this.sharedNodes.forEach(XGe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ei.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ei.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!eo(this.snapshot.measuredBox.x)&&!eo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=fi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!Qie(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||Fp(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),tKe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return fi();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(nKe))){const{scroll:u}=this.root;u&&(v0(o.x,u.offset.x),v0(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=fi();if(Il(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&Il(o,a),v0(o.x,d.offset.x),v0(o.y,d.offset.y))}return o}applyTransform(a,o=!1){const l=fi();Il(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&x0(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Fp(u.latestValues)&&x0(l,u.latestValues)}return Fp(this.latestValues)&&x0(l,this.latestValues),l}removeTransform(a){const o=fi();Il(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Fp(c.latestValues))continue;K4(c.latestValues)&&c.updateSnapshot();const u=fi(),d=c.measurePageBox();Il(u,d),Vq(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Fp(this.latestValues)&&Vq(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ya.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=ya.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=fi(),this.relativeTargetOrigin=fi(),Ax(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Il(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=fi(),this.targetWithTransforms=fi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),rGe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Il(this.target,this.layout.layoutBox),Vie(this.target,this.targetDelta)):Il(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=fi(),this.relativeTargetOrigin=fi(),Ax(this.relativeTargetOrigin,this.target,m.target),Il(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||K4(this.parent.latestValues)||qie(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var y;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===ya.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Il(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;sGe(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=fi());const{target:m}=a;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(zq(this.prevProjectionDelta.x,this.projectionDelta.x),zq(this.prevProjectionDelta.y,this.projectionDelta.y)),Tx(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!Yq(this.projectionDelta.x,this.prevProjectionDelta.x)||!Yq(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=b0(),this.projectionDelta=b0(),this.projectionDeltaWithTransform=b0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=b0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=fi(),m=l?l.source:void 0,y=this.layout?this.layout.source:void 0,b=m!==y,v=this.getStack(),x=!v||v.members.length<=1,w=!!(b&&!x&&this.options.crossfade===!0&&!this.path.some(QGe));this.animationProgress=0;let S;this.mixTargetDelta=C=>{const k=C/1e3;Qq(d.x,a.x,k),Qq(d.y,a.y,k),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ax(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),JGe(this.relativeTarget,this.relativeTargetOrigin,h,k),S&&DGe(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=fi()),Il(S,this.relativeTarget)),b&&(this.animationValues=u,NGe(u,c,this.latestValues,k,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Mh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ei.update(()=>{H2.hasAnimatedSinceResize=!0,this.currentAnimation=CGe(0,Zq,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Zq),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&rae(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||fi();const d=eo(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const h=eo(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}Il(o,l),x0(o,u),Tx(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new FGe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&ZI("z",a,c,this.animationValues);for(let u=0;u<YI.length;u++)ZI(`rotate${YI[u]}`,a,c,this.animationValues),ZI(`skew${YI[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return BGe;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=V2(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=V2(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Fp(this.latestValues)&&(m.transform=l?l({},""):"none",this.hasProjected=!1),m}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=LGe(this.projectionDeltaWithTransform,this.treeScale,u),l&&(o.transform=l(u,o.transform));const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const m in zw){if(u[m]===void 0)continue;const{correct:y,applyTo:b,isCSSVariable:v}=zw[m],x=o.transform==="none"?u[m]:y(u[m],c);if(b){const w=b.length;for(let S=0;S<w;S++)o[b[S]]=x}else v?this.options.visualElement.renderState.vars[m]=x:o[m]=x}return this.options.layoutId&&(o.pointerEvents=c===this?V2(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(Xq),this.root.sharedNodes.clear()}}}function zGe(e){e.updateLayout()}function UGe(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;i==="size"?Ol(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=eo(h);h.min=r[d].min,h.max=h.min+m}):rae(i,t.layoutBox,r)&&Ol(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=eo(r[d]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+m)});const o=b0();Tx(o,r,t.layoutBox);const l=b0();a?Tx(l,e.applyTransform(s,!0),t.measuredBox):Tx(l,r,t.layoutBox);const c=!Qie(o);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:m}=d;if(h&&m){const y=fi();Ax(y,t.layoutBox,h.layoutBox);const b=fi();Ax(b,r,m.layoutBox),eae(y,b)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=y,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function qGe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function VGe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function WGe(e){e.clearSnapshot()}function Xq(e){e.clearMeasurements()}function HGe(e){e.isLayoutDirty=!1}function GGe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Jq(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function KGe(e){e.resolveTargetDelta()}function YGe(e){e.calcProjection()}function ZGe(e){e.resetSkewAndRotation()}function XGe(e){e.removeLeadSnapshot()}function Qq(e,t,n){e.translate=Js(t.translate,0,n),e.scale=Js(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function eV(e,t,n,r){e.min=Js(t.min,n.min,r),e.max=Js(t.max,n.max,r)}function JGe(e,t,n,r){eV(e.x,t.x,n.x,r),eV(e.y,t.y,n.y,r)}function QGe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const eKe={duration:.45,ease:[.4,0,.1,1]},tV=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),nV=tV("applewebkit/")&&!tV("chrome/")?Math.round:Ul;function rV(e){e.min=nV(e.min),e.max=nV(e.max)}function tKe(e){rV(e.x),rV(e.y)}function rae(e,t,n){return e==="position"||e==="preserve-aspect"&&!nGe(Kq(t),Kq(n),.2)}function nKe(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const rKe=nae({attachResizeListener:(e,t)=>Gw(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),XI={current:void 0},sae=nae({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!XI.current){const e=new rKe({});e.mount(window),e.setOptions({layoutScroll:!0}),XI.current=e}return XI.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),sKe={pan:{Feature:xGe},drag:{Feature:vGe,ProjectionNode:sae,MeasureLayout:Zie}};function iKe(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=(n==null?void 0:n[e])??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function iae(e,t){const n=iKe(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function sV(e){return!(e.pointerType==="touch"||Yie())}function aKe(e,t,n={}){const[r,s,i]=iae(e,n),a=o=>{if(!sV(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=d=>{sV(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}function iV(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&ei.postRender(()=>i(t,Q1(t)))}class oKe extends Xh{mount(){const{current:t}=this.node;t&&(this.unmount=aKe(t,(n,r)=>(iV(this.node,r,"Start"),s=>iV(this.node,s,"End"))))}unmount(){}}class lKe extends Xh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=X1(Gw(this.node.current,"focus",()=>this.onFocus()),Gw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const aae=(e,t)=>t?e===t?!0:aae(e,t.parentElement):!1,cKe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function uKe(e){return cKe.has(e.tagName)||e.tabIndex!==-1}const nx=new WeakSet;function aV(e){return t=>{t.key==="Enter"&&e(t)}}function JI(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const dKe=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=aV(()=>{if(nx.has(n))return;JI(n,"down");const s=aV(()=>{JI(n,"up")}),i=()=>JI(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function oV(e){return h5(e)&&!Yie()}function fKe(e,t,n={}){const[r,s,i]=iae(e,n),a=o=>{const l=o.currentTarget;if(!oV(o)||nx.has(l))return;nx.add(l);const c=t(l,o),u=(m,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!oV(m)||!nx.has(l))&&(nx.delete(l),typeof c=="function"&&c(m,{success:y}))},d=m=>{u(m,l===window||l===document||n.useGlobalTarget||aae(l,m.target))},h=m=>{u(m,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),o instanceof HTMLElement&&(o.addEventListener("focus",c=>dKe(c,s)),!uKe(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function lV(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&ei.postRender(()=>i(t,Q1(t)))}class hKe extends Xh{mount(){const{current:t}=this.node;t&&(this.unmount=fKe(t,(n,r)=>(lV(this.node,r,"Start"),(s,{success:i})=>lV(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const X4=new WeakMap,QI=new WeakMap,pKe=e=>{const t=X4.get(e.target);t&&t(e)},mKe=e=>{e.forEach(pKe)};function gKe({root:e,...t}){const n=e||document;QI.has(n)||QI.set(n,{});const r=QI.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(mKe,{root:e,...t})),r[s]}function yKe(e,t,n){const r=gKe(t);return X4.set(e,n),r.observe(e),()=>{X4.delete(e),r.unobserve(e)}}const bKe={some:0,all:1};class vKe extends Xh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:bKe[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return yKe(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(xKe(t,n))&&this.startObserver()}unmount(){}}function xKe({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const wKe={inView:{Feature:vKe},tap:{Feature:hKe},focus:{Feature:lKe},hover:{Feature:oKe}},_Ke={layout:{ProjectionNode:sae,MeasureLayout:Zie}},J4={current:null},oae={current:!1};function SKe(){if(oae.current=!0,!!F6)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>J4.current=e.matches;e.addListener(t),t()}else J4.current=!1}const CKe=new WeakMap;function kKe(e,t,n){for(const r in t){const s=t[r],i=n[r];if(Pa(s))e.addValue(r,s);else if(Pa(i))e.addValue(r,Vw(s,{owner:e}));else if(i!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,Vw(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const lae=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),cae=e=>/^0[^.\s]+$/u.test(e),EKe={test:e=>e==="auto",parse:e=>e},uae=e=>t=>t.test(e),dae=[lb,ir,vu,Xf,DVe,PVe,EKe],cV=e=>dae.find(uae(e)),TKe=[...dae,Ma,Ih],AKe=e=>TKe.find(uae(e)),RKe=new Set(["brightness","contrast","saturate","opacity"]);function NKe(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(n5)||[];if(!r)return e;const s=n.replace(r,"");let i=RKe.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+s+")"}const MKe=/\b([a-z-]*)\(.*?\)/gu,Q4={...Ih,getAnimatableNone:e=>{const t=e.match(MKe);return t?t.map(NKe).join(" "):e}},IKe={...H6,color:Ma,backgroundColor:Ma,outlineColor:Ma,fill:Ma,stroke:Ma,borderColor:Ma,borderTopColor:Ma,borderRightColor:Ma,borderBottomColor:Ma,borderLeftColor:Ma,filter:Q4,WebkitFilter:Q4},fae=e=>IKe[e];function hae(e,t){let n=fae(e);return n!==Q4&&(n=Ih),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const uV=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class jKe{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=u5,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=ko.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,ei.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=qT(n),this.isVariantNode=Kse(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const m=d[h];l[h]!==void 0&&Pa(m)&&m.set(l[h],!1)}}mount(t){this.current=t,CKe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),oae.current||SKe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:J4.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Mh(this.notifyUpdate),Mh(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=ob.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ei.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in ky){const n=ky[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):fi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<uV.length;r++){const s=uV[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=t[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=kKe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=Vw(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(lae(r)||cae(r))?r=parseFloat(r):!AKe(r)&&Ih.test(n)&&(r=hae(t,n)),this.setBaseTarget(t,Pa(r)?r.get():r)),Pa(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=Z6(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Pa(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new e5),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}const OKe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function PKe(e){const t=OKe.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function pae(e,t,n=1){const[r,s]=PKe(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return lae(a)?parseFloat(a):a}return W6(s)?pae(s,t,n+1):s}function DKe(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||cae(e):!0}const FKe=new Set(["auto","none","0"]);function LKe(e,t,n){let r=0,s;for(;r<e.length&&!s;){const i=e[r];typeof i=="string"&&!FKe.has(i)&&Ww(i).values.length&&(s=e[r]),r++}if(s&&n)for(const i of t)e[i]=hae(n,s)}class BKe extends u5{constructor(t,n,r,s,i){super(t,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),W6(c))){const u=pae(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Die.has(r)||t.length!==2)return;const[s,i]=t,a=cV(s),o=cV(i);if(a!==o)if(pq(a)&&pq(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else nm[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||DKe(t[s]))&&r.push(s);r.length&&LKe(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=nm[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=nm[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class mae extends jKe{constructor(){super(...arguments),this.KeyframeResolver=BKe}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Pa(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function gae(e,{style:t,vars:n},r,s){Object.assign(e.style,t,s&&s.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}function $Ke(e){return window.getComputedStyle(e)}class zKe extends mae{constructor(){super(...arguments),this.type="html",this.renderInstance=gae}readValueFromInstance(t,n){if(ob.has(n))return dHe(t,n);{const r=$Ke(t),s=(V6(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return Wie(t,n)}build(t,n,r){G6(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return X6(t,n,r)}}const yae=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function UKe(e,t,n,r){gae(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(yae.has(s)?s:z6(s),t.attrs[s])}class qKe extends mae{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=fi}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(ob.has(n)){const r=fae(n);return r&&r.default||0}return n=yae.has(n)?n:z6(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return aie(t,n,r)}build(t,n,r){nie(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,s){UKe(t,n,r,s)}mount(t){this.isSVGTag=sie(t.tagName),super.mount(t)}}const VKe=(e,t)=>Y6(e)?new qKe(t):new zKe(t,{allowProjection:e!==T.Fragment}),WKe=eWe({...KHe,...wKe,...sKe,..._Ke},VKe),iu=xVe(WKe),N0=new WeakMap,G2=new WeakMap,Kk={current:[]};let e3=!1,Rx=0;const rx=new Set,r2=new Map;function bae(e){const t=Array.from(e).sort((n,r)=>n instanceof Od&&n.options.deps.includes(r)?1:r instanceof Od&&r.options.deps.includes(n)?-1:0);for(const n of t){if(Kk.current.includes(n))continue;Kk.current.push(n),n.recompute();const r=G2.get(n);if(r)for(const s of r){const i=N0.get(s);i&&bae(i)}}}function HKe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function GKe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function vae(e){if(Rx>0&&!r2.has(e)&&r2.set(e,e.prevState),rx.add(e),!(Rx>0)&&!e3)try{for(e3=!0;rx.size>0;){const t=Array.from(rx);rx.clear();for(const n of t){const r=r2.get(n)??n.prevState;n.prevState=r,HKe(n)}for(const n of t){const r=N0.get(n);r&&(Kk.current.push(n),bae(r))}for(const n of t){const r=N0.get(n);if(r)for(const s of r)GKe(s)}}}finally{e3=!1,Kk.current=[],r2.clear()}}function Qc(e){Rx++;try{e()}finally{if(Rx--,Rx===0){const t=Array.from(rx)[0];t&&vae(t)}}}function KKe(e){return typeof e=="function"}class eO{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const a=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),a==null||a()}},this.prevState=t,this.state=t,this.options=n}setState(t){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(t):KKe(t)?this.state=t(this.prevState):this.state=t,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),vae(this)}}class Od{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const s of this.options.deps)n.push(s.prevState),r.push(s.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:s,currDepVals:i,prevVal:a}=this.getDepVals();this.state=this.options.fn({prevDepVals:s,currDepVals:i,prevVal:a}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof Od&&i.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:s}=this.getDepVals();for(let i=0;i<s.length;i++)if(s[i]!==r[i]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,s;this.listeners.add(n);const i=(s=(r=this.options).onSubscribe)==null?void 0:s.call(r,n,this);return()=>{this.listeners.delete(n),i==null||i()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof Od)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof eO){let r=N0.get(n);r||(r=new Set,N0.set(n,r)),r.add(this);let s=G2.get(this);s||(s=new Set,G2.set(this,s)),s.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof Od)this.unregisterFromGraph(n.options.deps);else if(n instanceof eO){const r=N0.get(n);r&&r.delete(this);const s=G2.get(this);s&&s.delete(n)}}}function VT(e,t){return typeof e=="function"?e(t):e}function sx(e,t){return p5(t).reduce((r,s)=>{if(r===null)return null;if(typeof r<"u")return r[s]},e)}function s2(e,t,n){const r=p5(t);function s(i){if(!r.length)return VT(n,i);const a=r.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(i))return typeof i=="object"?(i===null&&(i={}),{...i,[a]:s(i[a])}):{[a]:s()};if(Array.isArray(i)&&typeof a=="number"){const o=i.slice(0,a);return[...o.length?o:new Array(a),s(i[a]),...i.slice(a+1)]}return[...new Array(a),s()]}return s(e)}function YKe(e,t){const n=p5(t);function r(s){if(!s)return;if(n.length===1){const a=n[0];if(Array.isArray(s)&&typeof a=="number")return s.filter((c,u)=>u!==a);const{[a]:o,...l}=s;return l}const i=n.shift();if(typeof i=="string"&&typeof s=="object")return{...s,[i]:r(s[i])};if(typeof i=="number"&&Array.isArray(s)){if(i>=s.length)return s;const a=s.slice(0,i);return[...a.length?a:new Array(i),r(s[i]),...s.slice(i+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return r(e)}const ZKe=/^(\d+)$/gm,XKe=/\.(\d+)(?=\.)/gm,JKe=/^(\d+)\./gm,QKe=/\.(\d+$)/gm,eYe=/\.{2,}/gm,tO="__int__",i2=`${tO}$1`;function p5(e){if(Array.isArray(e))return[...e];if(typeof e!="string")throw new Error("Path must be a string.");return e.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(ZKe,i2).replace(XKe,`.${i2}.`).replace(JKe,`${i2}.`).replace(QKe,`.${i2}`).replace(eYe,".").split(".").map(t=>t.indexOf(tO)===0?parseInt(t.substring(tO.length),10):t)}function tYe(e){return!(Array.isArray(e)&&e.length===0)}function nO(e,t){const{asyncDebounceMs:n}=t,{onChangeAsync:r,onBlurAsync:s,onSubmitAsync:i,onBlurAsyncDebounceMs:a,onChangeAsyncDebounceMs:o}=t.validators||{},l=n??0,c={cause:"change",validate:r,debounceMs:o??l},u={cause:"blur",validate:s,debounceMs:a??l},d={cause:"submit",validate:i,debounceMs:0},h=m=>({...m,debounceMs:0});switch(e){case"submit":return[h(c),h(u),d];case"blur":return[u];case"change":return[c];case"server":default:return[]}}function rO(e,t){const{onChange:n,onBlur:r,onSubmit:s,onMount:i}=t.validators||{},a={cause:"change",validate:n},o={cause:"blur",validate:r},l={cause:"submit",validate:s},c={cause:"mount",validate:i},u={cause:"server",validate:()=>{}};switch(e){case"mount":return[c];case"submit":return[a,o,l,u];case"server":return[u];case"blur":return[o,u];case"change":default:return[a,u]}}const sO=e=>!!e&&typeof e=="object"&&"fields"in e;function o0(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,i]of e)if(!t.has(s)||!Object.is(i,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!o0(e[s],t[s]))return!1;return!0}const dV=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},fV=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function nYe(e){const t=new Map;for(const n of e){const r=[...n.path??[]].map(s=>{const i=typeof s=="object"?s.key:s;return typeof i=="number"?`[${i}]`:i}).join(".").replace(/\.\[/g,"[");t.set(r,(t.get(r)??[]).concat(n))}return Object.fromEntries(t)}const hV=e=>{const t=nYe(e);return{form:t,fields:t}},M0={validate({value:e,validationSource:t},n){const r=n["~standard"].validate(e);if(r instanceof Promise)throw new Error("async function passed to sync validator");if(r.issues)return t==="field"?r.issues:hV(r.issues)},async validateAsync({value:e,validationSource:t},n){const r=await n["~standard"].validate(e);if(r.issues)return t==="field"?r.issues:hV(r.issues)}},xae=e=>!!e&&"~standard"in e,Yk={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function a2(e){function t(d,h,m,y){const b=r(d,h,m,y);({insert:()=>o(b,d,h),remove:()=>l(b),swap:()=>y!==void 0&&u(b,d,h,y),move:()=>y!==void 0&&c(b,d,h,y)})[m]()}function n(d,h){return`${d}[${h}]`}function r(d,h,m,y){const b=[n(d,h)];if(m==="swap")b.push(n(d,y));else if(m==="move"){const[v,x]=[Math.min(h,y),Math.max(h,y)];for(let w=v;w<=x;w++)b.push(n(d,w))}else{const v=e.getFieldValue(d),x=Array.isArray(v)?v.length:0;for(let w=h+1;w<x;w++)b.push(n(d,w))}return Object.keys(e.fieldInfo).filter(v=>b.some(x=>v.startsWith(x)))}function s(d,h){return d.replace(/\[(\d+)\]/,(m,y)=>{const b=parseInt(y,10);return`[${h==="up"?b+1:Math.max(0,b-1)}]`})}function i(d,h){(h==="up"?d:[...d].reverse()).forEach(y=>{const b=s(y.toString(),h),v=e.getFieldMeta(b);v?e.setFieldMeta(y,v):e.setFieldMeta(y,a())})}const a=()=>Yk,o=(d,h,m)=>{i(d,"down"),d.forEach(y=>{y.toString().startsWith(n(h,m))&&e.setFieldMeta(y,a())})},l=d=>{i(d,"up")},c=(d,h,m,y)=>{const b=new Map(Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,m))).map(v=>[v,e.getFieldMeta(v)]));i(d,m<y?"up":"down"),Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,y))).forEach(v=>{const x=v.replace(n(h,y),n(h,m)),w=b.get(x);w&&e.setFieldMeta(v,w)})},u=(d,h,m,y)=>{d.forEach(b=>{if(!b.toString().startsWith(n(h,m)))return;const v=b.toString().replace(n(h,m),n(h,y)),[x,w]=[e.getFieldMeta(b),e.getFieldMeta(v)];x&&e.setFieldMeta(v,x),w&&e.setFieldMeta(b,w)})};return{handleArrayFieldMetaShift:t}}function t3(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class rYe{constructor(t){var n;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var r,s;const i=this.fieldMetaDerived.mount(),a=this.store.mount(),o=()=>{i(),a()};(s=(r=this.options.listeners)==null?void 0:r.onMount)==null||s.call(r,{formApi:this});const{onMount:l}=this.options.validators||{};return l&&this.validateSync("mount"),o},this.update=r=>{var s,i;if(!r)return;const a=this.options;this.options=r;const o=!!((i=(s=r.transform)==null?void 0:s.deps)!=null&&i.some((u,d)=>u!==this.prevTransformArray[d])),l=r.defaultValues&&!o0(r.defaultValues,a.defaultValues)&&!this.state.isTouched,c=!o0(r.defaultState,a.defaultState)&&!this.state.isTouched;!l&&!c&&!o||Qc(()=>{this.baseStore.setState(()=>t3(Object.assign({},this.state,c?r.defaultState:{},l?{values:r.defaultValues}:{},o?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(r,s)=>{const{fieldMeta:i}=this.state,a=this.resetFieldMeta(i);r&&!(s!=null&&s.keepDefaultValues)&&(this.options={...this.options,defaultValues:r}),this.baseStore.setState(()=>{var o;return t3({...this.options.defaultState,values:r??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async r=>{const s=[];return Qc(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;s.push(Promise.resolve().then(()=>o.validate(r,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(s)).flat()},this.validateArrayFieldsStartingFrom=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${r}[${s}]`];for(let h=s+1;h<=(o??0);h++)l.push(`${r}[${h}]`);const c=Object.keys(this.fieldInfo).filter(h=>l.some(m=>h.startsWith(m))),u=[];return Qc(()=>{c.forEach(h=>{u.push(Promise.resolve().then(()=>this.validateField(h,i)))})}),(await Promise.all(u)).flat()},this.validateField=(r,s)=>{var i;const a=(i=this.fieldInfo[r])==null?void 0:i.instance;return a?(a.state.meta.isTouched||a.setMeta(o=>({...o,isTouched:!0})),a.validate(s)):[]},this.validateSync=r=>{const s=rO(r,this.options);let i=!1;const a={};return Qc(()=>{var o,l;for(const u of s){if(!u.validate)continue;const d=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:h,fieldErrors:m}=K2(d),y=o2(u.cause);for(const b of Object.keys(this.state.fieldMeta)){const v=this.getFieldMeta(b);if(!v)continue;const{errorMap:x,errorSourceMap:w}=v,S=m==null?void 0:m[b],{newErrorValue:C,newSource:k}=dV({newFormValidatorError:S,isPreviousErrorFromFormValidator:(w==null?void 0:w[y])==="form",previousErrorValue:x==null?void 0:x[y]});k==="form"&&(a[b]={...a[b],[y]:S}),(x==null?void 0:x[y])!==C&&this.setFieldMeta(b,A=>({...A,errorMap:{...A.errorMap,[y]:C},errorSourceMap:{...A.errorSourceMap,[y]:k}}))}((o=this.state.errorMap)==null?void 0:o[y])!==h&&this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[y]:h}})),(h||m)&&(i=!0)}const c=o2("submit");(l=this.state.errorMap)!=null&&l[c]&&r!=="submit"&&!i&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[c]:void 0}}))}),{hasErrored:i,fieldsErrorMap:a}},this.validateAsync=async r=>{const s=nO(r,this.options);this.state.isFormValidating||this.baseStore.setState(c=>({...c,isFormValidating:!0}));const i=[];let a;for(const c of s){if(!c.validate)continue;const u=o2(c.cause),d=this.state.validationMetaMap[u];d==null||d.lastAbortController.abort();const h=new AbortController;this.state.validationMetaMap[u]={lastAbortController:h},i.push(new Promise(async m=>{let y;try{y=await new Promise((w,S)=>{setTimeout(async()=>{if(h.signal.aborted)return w(void 0);try{w(await this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:h.signal},type:"validateAsync"}))}catch(C){S(C)}},c.debounceMs)})}catch(w){y=w}const{formError:b,fieldErrors:v}=K2(y);v&&(a=a?{...a,...v}:v);const x=o2(c.cause);for(const w of Object.keys(this.state.fieldMeta)){const S=this.getFieldMeta(w);if(!S)continue;const{errorMap:C,errorSourceMap:k}=S,A=a==null?void 0:a[w],{newErrorValue:R,newSource:N}=dV({newFormValidatorError:A,isPreviousErrorFromFormValidator:(k==null?void 0:k[x])==="form",previousErrorValue:C==null?void 0:C[x]});(C==null?void 0:C[x])!==R&&this.setFieldMeta(w,I=>({...I,errorMap:{...I.errorMap,[x]:R},errorSourceMap:{...I.errorSourceMap,[x]:N}}))}this.baseStore.setState(w=>({...w,errorMap:{...w.errorMap,[x]:b}})),m(a?{fieldErrors:a,errorMapKey:x}:void 0)}))}let o=[];const l={};if(i.length){o=await Promise.all(i);for(const c of o)if(c!=null&&c.fieldErrors){const{errorMapKey:u}=c;for(const[d,h]of Object.entries(c.fieldErrors)){const y={...l[d]||{},[u]:h};l[d]=y}}}return this.baseStore.setState(c=>({...c,isFormValidating:!1})),l},this.validate=r=>{const{hasErrored:s,fieldsErrorMap:i}=this.validateSync(r);return s&&!this.options.asyncAlways?i:this.validateAsync(r)},this.getFieldValue=r=>sx(this.state.values,r),this.getFieldMeta=r=>this.state.fieldMeta[r],this.getFieldInfo=r=>{var s;return(s=this.fieldInfo)[r]||(s[r]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(r,s)=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[r]:VT(s,i.fieldMetaBase[r])}}))},this.resetFieldMeta=r=>Object.keys(r).reduce((s,i)=>{const a=i;return s[a]=Yk,s},{}),this.setFieldValue=(r,s,i)=>{const a=(i==null?void 0:i.dontUpdateMeta)??!1;Qc(()=>{a||this.setFieldMeta(r,o=>({...o,isTouched:!0,isDirty:!0,errorMap:{...o==null?void 0:o.errorMap,onMount:void 0}})),this.baseStore.setState(o=>({...o,values:s2(o.values,r,s)}))})},this.deleteField=r=>{const i=[...Object.keys(this.fieldInfo).filter(a=>{const o=r.toString();return a!==o&&a.startsWith(o)}),r];this.baseStore.setState(a=>{const o={...a};return i.forEach(l=>{o.values=YKe(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(r,s,i)=>{this.setFieldValue(r,a=>[...Array.isArray(a)?a:[],s],i),this.validateField(r,"change")},this.insertFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>[...o.slice(0,s),i,...o.slice(s)],a),await this.validateField(r,"change"),a2(this).handleArrayFieldMetaShift(r,s,"insert"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.replaceFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>o.map((l,c)=>c===s?i:l),a),await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.removeFieldValue=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(r,l=>l.filter((c,u)=>u!==s),i),a2(this).handleArrayFieldMetaShift(r,s,"remove"),o!==null){const l=`${r}[${o}]`;this.deleteField(l)}await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.swapFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=o[s],c=o[i];return s2(s2(o,`${s}`,c),`${i}`,l)},a),a2(this).handleArrayFieldMetaShift(r,s,"swap",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.moveFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=[...o];return l.splice(i,0,l.splice(s,1)[0]),l},a),a2(this).handleArrayFieldMetaShift(r,s,"move",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.clearFieldValues=(r,s)=>{const i=this.getFieldValue(r),a=Array.isArray(i)?Math.max(i.length-1,0):null;if(this.setFieldValue(r,[],s),a!==null)for(let o=0;o<=a;o++){const l=`${r}[${o}]`;this.deleteField(l)}this.validateField(r,"change")},this.resetField=r=>{this.baseStore.setState(s=>({...s,fieldMetaBase:{...s.fieldMetaBase,[r]:Yk},values:this.options.defaultValues?s2(s.values,r,sx(this.options.defaultValues,r)):s.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((r,[s,i])=>(Object.keys(i).length&&i.errors.length&&(r[s]={errors:i.errors,errorMap:i.errorMap}),r),{})}),this.parseValuesWithSchema=r=>M0.validate({value:this.state.values,validationSource:"form"},r),this.parseValuesWithSchemaAsync=r=>M0.validateAsync({value:this.state.values,validationSource:"form"},r),this.baseStore=new eO(t3({...t==null?void 0:t.defaultState,values:(t==null?void 0:t.defaultValues)??((n=t==null?void 0:t.defaultState)==null?void 0:n.values)})),this.fieldMetaDerived=new Od({deps:[this.baseStore],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l;const c=i,u=r==null?void 0:r[0],d=s[0];let h=0;const m={};for(const y of Object.keys(d.fieldMetaBase)){const b=d.fieldMetaBase[y],v=u==null?void 0:u.fieldMetaBase[y],x=c==null?void 0:c[y],w=sx(d.values,y);let S=x==null?void 0:x.errors;if(!v||b.errorMap!==v.errorMap){S=Object.values(b.errorMap??{}).filter(N=>N!==void 0);const R=(a=this.getFieldInfo(y))==null?void 0:a.instance;R&&!R.options.disableErrorFlat&&(S=S==null?void 0:S.flat(1))}const C=!tYe(S??[]),k=!b.isDirty,A=o0(w,sx(this.options.defaultValues,y))||o0(w,(l=(o=this.getFieldInfo(y))==null?void 0:o.instance)==null?void 0:l.options.defaultValue);if(x&&x.isPristine===k&&x.isValid===C&&x.isDefaultValue===A&&x.errors===S&&b===v){m[y]=x,h++;continue}m[y]={...b,errors:S,isPristine:k,isValid:C,isDefaultValue:A}}return Object.keys(d.fieldMetaBase).length&&c&&h===Object.keys(d.fieldMetaBase).length?c:m}}),this.store=new Od({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l,c;const u=i,d=r==null?void 0:r[0],h=s[0],m=s[1],y=Object.values(m).filter(Boolean),b=y.some($=>$.isValidating),v=y.every($=>$.isValid),x=y.some($=>$.isTouched),w=y.some($=>$.isBlurred),S=y.every($=>$.isDefaultValue),C=x&&((a=h.errorMap)==null?void 0:a.onMount),k=y.some($=>$.isDirty),A=!k,R=!!((o=h.errorMap)!=null&&o.onMount||y.some($=>{var ne;return(ne=$==null?void 0:$.errorMap)==null?void 0:ne.onMount})),N=!!b;let I=(u==null?void 0:u.errors)??[];(!d||h.errorMap!==d.errorMap)&&(I=Object.values(h.errorMap).reduce(($,ne)=>ne===void 0?$:ne&&sO(ne)?($.push(ne.form),$):($.push(ne),$),[]));const O=I.length===0,L=v&&O,P=this.options.canSubmitWhenInvalid??!1,V=h.submissionAttempts===0&&!x&&!R||!N&&!h.isSubmitting&&L||P;let F=h.errorMap;if(C&&(I=I.filter($=>$!==h.errorMap.onMount),F=Object.assign(F,{onMount:void 0})),u&&d&&u.errorMap===F&&u.fieldMeta===this.fieldMetaDerived.state&&u.errors===I&&u.isFieldsValidating===b&&u.isFieldsValid===v&&u.isFormValid===O&&u.isValid===L&&u.canSubmit===V&&u.isTouched===x&&u.isBlurred===w&&u.isPristine===A&&u.isDefaultValue===S&&u.isDirty===k&&o0(d,h))return u;let X={...h,errorMap:F,fieldMeta:this.fieldMetaDerived.state,errors:I,isFieldsValidating:b,isFieldsValid:v,isFormValid:O,isValid:L,canSubmit:V,isTouched:x,isBlurred:w,isPristine:A,isDefaultValue:S,isDirty:k};const U=((l=this.options.transform)==null?void 0:l.deps)??[];if(U.length!==this.prevTransformArray.length||U.some(($,ne)=>$!==this.prevTransformArray[ne])){const $=Object.assign({},this,{state:X});(c=this.options.transform)==null||c.fn($),X=$.state,this.prevTransformArray=U}return X}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(t||{})}get state(){return this.store.state}runValidator(t){return xae(t.validate)?M0[t.type](t.value,t.validate):t.validate(t.value)}async handleSubmit(t){var n,r,s,i,a,o,l,c;if(this.baseStore.setState(d=>({...d,isSubmitted:!1,submissionAttempts:d.submissionAttempts+1,isSubmitSuccessful:!1})),Qc(()=>{Object.values(this.fieldInfo).forEach(d=>{d.instance&&(d.instance.state.meta.isTouched||d.instance.setMeta(h=>({...h,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(d=>({...d,isSubmitting:!0}));const u=()=>{this.baseStore.setState(d=>({...d,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){u(),(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){u(),(i=(s=this.options).onSubmitInvalid)==null||i.call(s,{value:this.state.values,formApi:this});return}Qc(()=>{Object.values(this.fieldInfo).forEach(d=>{var h,m,y;(y=(m=(h=d.instance)==null?void 0:h.options.listeners)==null?void 0:m.onSubmit)==null||y.call(m,{value:d.instance.state.value,fieldApi:d.instance})})}),(o=(a=this.options.listeners)==null?void 0:a.onSubmit)==null||o.call(a,{formApi:this});try{await((c=(l=this.options).onSubmit)==null?void 0:c.call(l,{value:this.state.values,formApi:this,meta:t??this.options.onSubmitMeta})),Qc(()=>{this.baseStore.setState(d=>({...d,isSubmitted:!0,isSubmitSuccessful:!0})),u()})}catch(d){throw this.baseStore.setState(h=>({...h,isSubmitSuccessful:!1})),u(),d}}setErrorMap(t){Qc(()=>{Object.entries(t).forEach(([n,r])=>{const s=n;if(sO(r)){const{formError:i,fieldErrors:a}=K2(r);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,c=>({...c,errorMap:{...c.errorMap,[s]:a==null?void 0:a[o]},errorSourceMap:{...c.errorSourceMap,[s]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[s]:i}}))}else this.baseStore.setState(i=>({...i,errorMap:{...i.errorMap,[s]:r}}))})})}}function K2(e){if(e){if(sO(e)){const t=K2(e.form).formError,n=e.fields;return{formError:t,fieldErrors:n}}return{formError:e}}return{formError:void 0}}function o2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class sYe{constructor(t){this.options={},this.mount=()=>{var n,r;const s=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const i=this.getInfo();i.instance=this,this.update(this.options);const{onMount:a}=this.options.validators||{};if(a){const o=this.runValidator({validate:a,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(r=(n=this.options.listeners)==null?void 0:n.onMount)==null||r.call(n,{value:this.state.value,fieldApi:this}),s},this.update=n=>{this.options=n;const r=this.name!==n.name;if(this.name=n.name,this.state.value===void 0){const s=sx(n.form.options.defaultValues,n.name),i=n.defaultValue??s;r?this.setValue(a=>a||i,{dontUpdateMeta:!0}):i!==void 0&&this.setValue(i,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(n,r)=>{this.form.setFieldValue(this.name,n,r),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=n=>this.form.setFieldMeta(this.name,n),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(n,r)=>{this.form.pushFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.insertValue=(n,r,s)=>{this.form.insertFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.replaceValue=(n,r,s)=>{this.form.replaceFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.removeValue=(n,r)=>{this.form.removeFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.swapValues=(n,r,s)=>{this.form.swapFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.moveValue=(n,r,s)=>{this.form.moveFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.clearValues=n=>{this.form.clearFieldValues(this.name,n),this.triggerOnChangeListener()},this.getLinkedFields=n=>{const r=Object.values(this.form.fieldInfo),s=[];for(const i of r){if(!i.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=i.instance.options.validators||{};n==="change"&&(a!=null&&a.includes(this.name))&&s.push(i.instance),n==="blur"&&(o!=null&&o.includes(this.name))&&s.push(i.instance)}return s},this.validateSync=(n,r)=>{var s;const i=rO(n,this.options),o=this.getLinkedFields(n).reduce((u,d)=>{const h=rO(n,d.options);return h.forEach(m=>{m.field=d}),u.concat(h)},[]);let l=!1;Qc(()=>{const u=(d,h)=>{var m;const y=l2(h.cause),b=h.validate?pV(d.runValidator({validate:h.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,v=r[y],{newErrorValue:x,newSource:w}=fV({formLevelError:v,fieldLevelError:b});((m=d.state.meta.errorMap)==null?void 0:m[y])!==x&&d.setMeta(S=>({...S,errorMap:{...S.errorMap,[y]:x},errorSourceMap:{...S.errorSourceMap,[y]:w}})),x&&(l=!0)};for(const d of i)u(this,d);for(const d of o)d.validate&&u(d.field,d)});const c=l2("submit");return(s=this.state.meta.errorMap)!=null&&s[c]&&n!=="submit"&&!l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[c]:void 0},errorSourceMap:{...u.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(n,r)=>{const s=nO(n,this.options),i=await r,a=this.getLinkedFields(n),o=a.reduce((h,m)=>{const y=nO(n,m.options);return y.forEach(b=>{b.field=m}),h.concat(y)},[]);this.state.meta.isValidating||this.setMeta(h=>({...h,isValidating:!0}));for(const h of a)h.setMeta(m=>({...m,isValidating:!0}));const l=[],c=[],u=(h,m,y)=>{const b=l2(m.cause),v=h.getInfo().validationMetaMap[b];v==null||v.lastAbortController.abort();const x=new AbortController;this.getInfo().validationMetaMap[b]={lastAbortController:x},y.push(new Promise(async w=>{var S;let C;try{C=await new Promise((I,O)=>{this.timeoutIds.validations[m.cause]&&clearTimeout(this.timeoutIds.validations[m.cause]),this.timeoutIds.validations[m.cause]=setTimeout(async()=>{if(x.signal.aborted)return I(void 0);try{I(await this.runValidator({validate:m.validate,value:{value:h.store.state.value,fieldApi:h,signal:x.signal,validationSource:"field"},type:"validateAsync"}))}catch(L){O(L)}},m.debounceMs)})}catch(I){C=I}if(x.signal.aborted)return w(void 0);const k=pV(C),A=(S=i[this.name])==null?void 0:S[b],{newErrorValue:R,newSource:N}=fV({formLevelError:A,fieldLevelError:k});h.setMeta(I=>({...I,errorMap:{...I==null?void 0:I.errorMap,[b]:R},errorSourceMap:{...I.errorSourceMap,[b]:N}})),w(R)}))};for(const h of s)h.validate&&u(this,h,l);for(const h of o)h.validate&&u(h.field,h,c);let d=[];(l.length||c.length)&&(d=await Promise.all(l),await Promise.all(c)),this.setMeta(h=>({...h,isValidating:!1}));for(const h of a)h.setMeta(m=>({...m,isValidating:!1}));return d.filter(Boolean)},this.validate=(n,r)=>{var s;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=r!=null&&r.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(n),{hasErrored:a}=this.validateSync(n,i[this.name]??{});if(a&&!this.options.asyncAlways)return(s=this.getInfo().validationMetaMap[l2(n)])==null||s.lastAbortController.abort(),this.state.meta.errors;const o=r!=null&&r.skipFormValidation?Promise.resolve({}):this.form.validateAsync(n);return this.validateAsync(n,o)},this.handleChange=n=>{this.setValue(n)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(r=>({...r,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(r=>({...r,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=n=>M0.validate({value:this.state.value,validationSource:"field"},n),this.parseValueWithSchemaAsync=n=>M0.validateAsync({value:this.state.value,validationSource:"field"},n),this.form=t.form,this.name=t.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new Od({deps:[this.form.store],fn:()=>{const n=this.form.getFieldValue(this.name),r=this.form.getFieldMeta(this.name)??{...Yk,...t.defaultMeta};return{value:n,meta:r}}}),this.options=t}get state(){return this.store.state}runValidator(t){return xae(t.validate)?M0[t.type](t.value,t.validate):t.validate(t.value)}setErrorMap(t){this.setMeta(n=>({...n,errorMap:{...n.errorMap,...t}}))}triggerOnBlurListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onBlurDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onBlurDebounceMs;l&&l>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onBlur)==null||a.call(i,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onChangeDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onChangeDebounceMs;l&&l>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onChange)==null||a.call(i,{value:this.state.value,fieldApi:this})}}function pV(e){if(e)return e}function l2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var n3={exports:{}},r3={},s3={exports:{}},i3={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mV;function iYe(){if(mV)return i3;mV=1;var e=r1();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function o(d,h){var m=h(),y=r({inst:{value:m,getSnapshot:h}}),b=y[0].inst,v=y[1];return i(function(){b.value=m,b.getSnapshot=h,l(b)&&v({inst:b})},[d,m,h]),s(function(){return l(b)&&v({inst:b}),d(function(){l(b)&&v({inst:b})})},[d]),a(m),m}function l(d){var h=d.getSnapshot;d=d.value;try{var m=h();return!n(d,m)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return i3.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,i3}var gV;function aYe(){return gV||(gV=1,s3.exports=iYe()),s3.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yV;function oYe(){if(yV)return r3;yV=1;var e=r1(),t=aYe();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,o=e.useMemo,l=e.useDebugValue;return r3.useSyncExternalStoreWithSelector=function(c,u,d,h,m){var y=i(null);if(y.current===null){var b={hasValue:!1,value:null};y.current=b}else b=y.current;y=o(function(){function x(A){if(!w){if(w=!0,S=A,A=h(A),m!==void 0&&b.hasValue){var R=b.value;if(m(R,A))return C=R}return C=A}if(R=C,r(S,A))return R;var N=h(A);return m!==void 0&&m(R,N)?(S=A,R):(S=A,C=N)}var w=!1,S,C,k=d===void 0?null:d;return[function(){return x(u())},k===null?void 0:function(){return x(k())}]},[u,d,h,m]);var v=s(c,y[0],y[1]);return a(function(){b.hasValue=!0,b.value=v},[v]),l(v),v},r3}var bV;function lYe(){return bV||(bV=1,n3.exports=oYe()),n3.exports}var cYe=lYe();function m5(e,t=n=>n){return cYe.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,uYe)}function uYe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!t.has(r)||!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const Zk=typeof window<"u"?T.useLayoutEffect:T.useEffect;function dYe(e){const[t]=T.useState(()=>{const r=new sYe({...e,form:e.form,name:e.name});return r.Field=wae,r});return Zk(t.mount,[t]),Zk(()=>{t.update(e)}),m5(t.store,e.mode==="array"?n=>[n.meta,Object.keys(n.value??[]).length]:void 0),t}const wae=({children:e,...t})=>{const n=dYe(t),r=T.useMemo(()=>VT(e,n),[e,n,n.state.value,n.state.meta]);return f.jsx(f.Fragment,{children:r})};function fYe({form:e,selector:t,children:n}){const r=m5(e.store,t);return VT(n,r)}function ni(e){const[t]=T.useState(()=>{const n=new rYe(e),r=n;return r.Field=function(i){return f.jsx(wae,{...i,form:n})},r.Subscribe=s=>f.jsx(fYe,{form:n,selector:s.selector,children:s.children}),r});return Zk(t.mount,[]),m5(t.store,n=>n.isSubmitting),Zk(()=>{t.update(e)}),t}function Cn({className:e,type:t,...n}){return f.jsx("input",{type:t,"data-slot":"input",className:Ze("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}function hYe(e){const t=e+"CollectionProvider",[n,r]=Wi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=We.useRef(null),S=We.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=_u(o),c=We.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),C=Rn(v,S.collectionRef);return f.jsx(l,{ref:C,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=_u(u),m=We.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,C=We.useRef(null),k=Rn(v,C),A=i(u,x);return We.useEffect(()=>(A.itemMap.set(C,{ref:C,...S}),()=>void A.itemMap.delete(C))),f.jsx(h,{[d]:"",ref:k,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return We.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((A,R)=>S.indexOf(A.ref.current)-S.indexOf(R.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var pYe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],vi=pYe.reduce((e,t)=>{const n=_u(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function mYe(e,t){e&&rl.flushSync(()=>e.dispatchEvent(t))}var gYe="DismissableLayer",iO="dismissableLayer.update",yYe="dismissableLayer.pointerDownOutside",bYe="dismissableLayer.focusOutside",vV,_ae=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Sae=T.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=T.useContext(_ae),[u,d]=T.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=T.useState({}),y=Rn(t,R=>d(R)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,C=w>=x,k=wYe(R=>{const N=R.target,I=[...c.branches].some(O=>O.contains(N));!C||I||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),A=_Ye(R=>{const N=R.target;[...c.branches].some(O=>O.contains(N))||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return KO(R=>{w===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),T.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(vV=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),xV(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=vV)}},[u,h,n,c]),T.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),xV())},[u,c]),T.useEffect(()=>{const R=()=>m({});return document.addEventListener(iO,R),()=>document.removeEventListener(iO,R)},[]),f.jsx(vi.div,{...l,ref:y,style:{pointerEvents:S?C?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,A.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,k.onPointerDownCapture)})});Sae.displayName=gYe;var vYe="DismissableLayerBranch",xYe=T.forwardRef((e,t)=>{const n=T.useContext(_ae),r=T.useRef(null),s=Rn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(vi.div,{...e,ref:s})});xYe.displayName=vYe;function wYe(e,t=globalThis==null?void 0:globalThis.document){const n=Cs(e),r=T.useRef(!1),s=T.useRef(()=>{});return T.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Cae(yYe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function _Ye(e,t=globalThis==null?void 0:globalThis.document){const n=Cs(e),r=T.useRef(!1);return T.useEffect(()=>{const s=i=>{i.target&&!r.current&&Cae(bYe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function xV(){const e=new CustomEvent(iO);document.dispatchEvent(e)}function Cae(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?mYe(s,i):s.dispatchEvent(i)}var a3=0;function WT(){T.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??wV()),document.body.insertAdjacentElement("beforeend",e[1]??wV()),a3++,()=>{a3===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),a3--}},[])}function wV(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var o3="focusScope.autoFocusOnMount",l3="focusScope.autoFocusOnUnmount",_V={bubbles:!1,cancelable:!0},SYe="FocusScope",kae=T.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=T.useState(null),c=Cs(s),u=Cs(i),d=T.useRef(null),h=Rn(t,b=>l(b)),m=T.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;T.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const C=S.target;o.contains(C)?d.current=C:Jf(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const C=S.relatedTarget;C!==null&&(o.contains(C)||Jf(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const k of S)k.removedNodes.length>0&&Jf(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),T.useEffect(()=>{if(o){CV.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(o3,_V);o.addEventListener(o3,c),o.dispatchEvent(x),x.defaultPrevented||(CYe(RYe(Eae(o)),{select:!0}),document.activeElement===b&&Jf(o))}return()=>{o.removeEventListener(o3,c),setTimeout(()=>{const x=new CustomEvent(l3,_V);o.addEventListener(l3,u),o.dispatchEvent(x),x.defaultPrevented||Jf(b??document.body,{select:!0}),o.removeEventListener(l3,u),CV.remove(m)},0)}}},[o,c,u,m]);const y=T.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,C]=kYe(w);S&&C?!b.shiftKey&&x===C?(b.preventDefault(),n&&Jf(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&Jf(C,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(vi.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});kae.displayName=SYe;function CYe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Jf(r,{select:t}),document.activeElement!==n)return}function kYe(e){const t=Eae(e),n=SV(t,e),r=SV(t.reverse(),e);return[n,r]}function Eae(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function SV(e,t){for(const n of e)if(!EYe(n,{upTo:t}))return n}function EYe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function TYe(e){return e instanceof HTMLInputElement&&"select"in e}function Jf(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&TYe(e)&&t&&e.select()}}var CV=AYe();function AYe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=kV(e,t),e.unshift(t)},remove(t){var n;e=kV(e,t),(n=e[0])==null||n.resume()}}}function kV(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function RYe(e){return e.filter(t=>t.tagName!=="A")}var NYe="Arrow",Tae=T.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(vi.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Tae.displayName=NYe;var MYe=Tae,g5="Popper",[Aae,Rae]=Wi(g5),[IYe,Nae]=Aae(g5),Mae=e=>{const{__scopePopper:t,children:n}=e,[r,s]=T.useState(null);return f.jsx(IYe,{scope:t,anchor:r,onAnchorChange:s,children:n})};Mae.displayName=g5;var Iae="PopperAnchor",jae=T.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Nae(Iae,n),a=T.useRef(null),o=Rn(t,a);return T.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(vi.div,{...s,ref:o})});jae.displayName=Iae;var y5="PopperContent",[jYe,OYe]=Aae(y5),Oae=T.forwardRef((e,t)=>{var De,Se,Ce,qe,Qe,Ve;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=Nae(y5,n),[x,w]=T.useState(null),S=Rn(t,Ne=>w(Ne)),[C,k]=T.useState(null),A=Dy(C),R=(A==null?void 0:A.width)??0,N=(A==null?void 0:A.height)??0,I=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],P=L.length>0,V={padding:O,boundary:L.filter(DYe),altBoundary:P},{refs:F,floatingStyles:X,placement:U,isPositioned:H,middlewareData:$}=rP({strategy:"fixed",placement:I,whileElementsMounted:(...Ne)=>nP(...Ne,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[sP({mainAxis:s+N,alignmentAxis:a}),l&&iP({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?aP():void 0,...V}),l&&oP({...V}),lP({...V,apply:({elements:Ne,rects:K,availableWidth:me,availableHeight:Ae})=>{const{width:le,height:oe}=K.reference,re=Ne.floating.style;re.setProperty("--radix-popper-available-width",`${me}px`),re.setProperty("--radix-popper-available-height",`${Ae}px`),re.setProperty("--radix-popper-anchor-width",`${le}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),C&&uP({element:C,padding:o}),FYe({arrowWidth:R,arrowHeight:N}),h&&cP({strategy:"referenceHidden",...V})]}),[ne,W]=Fae(U),Q=Cs(y);ti(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(De=$.arrow)==null?void 0:De.x,se=(Se=$.arrow)==null?void 0:Se.y,pe=((Ce=$.arrow)==null?void 0:Ce.centerOffset)!==0,[ce,Ie]=T.useState();return ti(()=>{x&&Ie(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...X,transform:H?X.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(qe=$.transformOrigin)==null?void 0:qe.x,(Qe=$.transformOrigin)==null?void 0:Qe.y].join(" "),...((Ve=$.hide)==null?void 0:Ve.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(jYe,{scope:n,placedSide:ne,onArrowChange:k,arrowX:ee,arrowY:se,shouldHideArrow:pe,children:f.jsx(vi.div,{"data-side":ne,"data-align":W,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});Oae.displayName=y5;var Pae="PopperArrow",PYe={top:"bottom",right:"left",bottom:"top",left:"right"},Dae=T.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=OYe(Pae,r),a=PYe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(MYe,{...s,ref:n,style:{...s.style,display:"block"}})})});Dae.displayName=Pae;function DYe(e){return e!==null}var FYe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=Fae(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function Fae(e){const[t,n="center"]=e.split("-");return[t,n]}var LYe=Mae,BYe=jae,$Ye=Oae,zYe=Dae,UYe="Portal",Lae=T.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=T.useState(!1);ti(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?pE.createPortal(f.jsx(vi.div,{...r,ref:t}),a):null});Lae.displayName=UYe;function HT(e){const t=T.useRef({value:e,previous:e});return T.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Bae=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),qYe="VisuallyHidden",VYe=T.forwardRef((e,t)=>f.jsx(vi.span,{...e,ref:t,style:{...Bae,...e.style}}));VYe.displayName=qYe;var WYe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Jg=new WeakMap,c2=new WeakMap,u2={},c3=0,$ae=function(e){return e&&(e.host||$ae(e.parentNode))},HYe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=$ae(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},GYe=function(e,t,n,r){var s=HYe(t,Array.isArray(e)?e:[e]);u2[n]||(u2[n]=new WeakMap);var i=u2[n],a=[],o=new Set,l=new Set(s),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))u(h);else try{var m=h.getAttribute(r),y=m!==null&&m!=="false",b=(Jg.get(h)||0)+1,v=(i.get(h)||0)+1;Jg.set(h,b),i.set(h,v),a.push(h),b===1&&y&&c2.set(h,!0),v===1&&h.setAttribute(n,"true"),y||h.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),o.clear(),c3++,function(){a.forEach(function(d){var h=Jg.get(d)-1,m=i.get(d)-1;Jg.set(d,h),i.set(d,m),h||(c2.has(d)||d.removeAttribute(r),c2.delete(d)),m||d.removeAttribute(n)}),c3--,c3||(Jg=new WeakMap,Jg=new WeakMap,c2=new WeakMap,u2={})}},GT=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=WYe(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),GYe(r,s,n,"aria-hidden")):function(){return null}},cu=function(){return cu=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},cu.apply(this,arguments)};function zae(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function KYe(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var Y2="right-scroll-bar-position",Z2="width-before-scroll-bar",YYe="with-scroll-bars-hidden",ZYe="--removed-body-scroll-bar-size";function u3(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function XYe(e,t){var n=T.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var JYe=typeof window<"u"?T.useLayoutEffect:T.useEffect,EV=new WeakMap;function QYe(e,t){var n=XYe(null,function(r){return e.forEach(function(s){return u3(s,r)})});return JYe(function(){var r=EV.get(n);if(r){var s=new Set(r),i=new Set(e),a=n.current;s.forEach(function(o){i.has(o)||u3(o,null)}),i.forEach(function(o){s.has(o)||u3(o,a)})}EV.set(n,e)},[e]),n}function eZe(e){return e}function tZe(e,t){t===void 0&&(t=eZe);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var l=function(){var u=a;a=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return s}function nZe(e){e===void 0&&(e={});var t=tZe(null);return t.options=cu({async:!0,ssr:!1},e),t}var Uae=function(e){var t=e.sideCar,n=zae(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return T.createElement(r,cu({},n))};Uae.isSideCarExport=!0;function rZe(e,t){return e.useMedium(t),Uae}var qae=nZe(),d3=function(){},KT=T.forwardRef(function(e,t){var n=T.useRef(null),r=T.useState({onScrollCapture:d3,onWheelCapture:d3,onTouchMoveCapture:d3}),s=r[0],i=r[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,m=e.noIsolation,y=e.inert,b=e.allowPinchZoom,v=e.as,x=v===void 0?"div":v,w=e.gapMode,S=zae(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=h,k=QYe([n,t]),A=cu(cu({},S),s);return T.createElement(T.Fragment,null,u&&T.createElement(C,{sideCar:qae,removeScrollBar:c,shards:d,noIsolation:m,inert:y,setCallbacks:i,allowPinchZoom:!!b,lockRef:n,gapMode:w}),a?T.cloneElement(T.Children.only(o),cu(cu({},A),{ref:k})):T.createElement(x,cu({},A,{className:l,ref:k}),o))});KT.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};KT.classNames={fullWidth:Z2,zeroRight:Y2};var sZe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function iZe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=sZe();return t&&e.setAttribute("nonce",t),e}function aZe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function oZe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var lZe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=iZe())&&(aZe(t,n),oZe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},cZe=function(){var e=lZe();return function(t,n){T.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Vae=function(){var e=cZe(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},uZe={left:0,top:0,right:0,gap:0},f3=function(e){return parseInt(e||"",10)||0},dZe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[f3(n),f3(r),f3(s)]},fZe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return uZe;var t=dZe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},hZe=Vae(),I0="data-scroll-locked",pZe=function(e,t,n,r){var s=e.left,i=e.top,a=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(YYe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(I0,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Y2,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Z2,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Y2," .").concat(Y2,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Z2," .").concat(Z2,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(I0,`] {
    `).concat(ZYe,": ").concat(o,`px;
  }
`)},TV=function(){var e=parseInt(document.body.getAttribute(I0)||"0",10);return isFinite(e)?e:0},mZe=function(){T.useEffect(function(){return document.body.setAttribute(I0,(TV()+1).toString()),function(){var e=TV()-1;e<=0?document.body.removeAttribute(I0):document.body.setAttribute(I0,e.toString())}},[])},gZe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;mZe();var i=T.useMemo(function(){return fZe(s)},[s]);return T.createElement(hZe,{styles:pZe(i,!t,s,n?"":"!important")})},aO=!1;if(typeof window<"u")try{var d2=Object.defineProperty({},"passive",{get:function(){return aO=!0,!0}});window.addEventListener("test",d2,d2),window.removeEventListener("test",d2,d2)}catch{aO=!1}var Qg=aO?{passive:!1}:!1,yZe=function(e){return e.tagName==="TEXTAREA"},Wae=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!yZe(e)&&n[t]==="visible")},bZe=function(e){return Wae(e,"overflowY")},vZe=function(e){return Wae(e,"overflowX")},AV=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Hae(e,r);if(s){var i=Gae(e,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},xZe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},wZe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Hae=function(e,t){return e==="v"?bZe(t):vZe(t)},Gae=function(e,t){return e==="v"?xZe(t):wZe(t)},_Ze=function(e,t){return e==="h"&&t==="rtl"?-1:1},SZe=function(e,t,n,r,s){var i=_Ze(e,window.getComputedStyle(t).direction),a=i*r,o=n.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var m=Gae(e,o),y=m[0],b=m[1],v=m[2],x=b-v-i*y;(y||x)&&Hae(e,o)&&(d+=x,h+=y),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},f2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},RV=function(e){return[e.deltaX,e.deltaY]},NV=function(e){return e&&"current"in e?e.current:e},CZe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},kZe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},EZe=0,e0=[];function TZe(e){var t=T.useRef([]),n=T.useRef([0,0]),r=T.useRef(),s=T.useState(EZe++)[0],i=T.useState(Vae)[0],a=T.useRef(e);T.useEffect(function(){a.current=e},[e]),T.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var b=KYe([e.lockRef.current],(e.shards||[]).map(NV),!0).filter(Boolean);return b.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=T.useCallback(function(b,v){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var x=f2(b),w=n.current,S="deltaX"in b?b.deltaX:w[0]-x[0],C="deltaY"in b?b.deltaY:w[1]-x[1],k,A=b.target,R=Math.abs(S)>Math.abs(C)?"h":"v";if("touches"in b&&R==="h"&&A.type==="range")return!1;var N=AV(R,A);if(!N)return!0;if(N?k=R:(k=R==="v"?"h":"v",N=AV(R,A)),!N)return!1;if(!r.current&&"changedTouches"in b&&(S||C)&&(r.current=k),!k)return!0;var I=r.current||k;return SZe(I,v,b,I==="h"?S:C)},[]),l=T.useCallback(function(b){var v=b;if(!(!e0.length||e0[e0.length-1]!==i)){var x="deltaY"in v?RV(v):f2(v),w=t.current.filter(function(k){return k.name===v.type&&(k.target===v.target||v.target===k.shadowParent)&&CZe(k.delta,x)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var S=(a.current.shards||[]).map(NV).filter(Boolean).filter(function(k){return k.contains(v.target)}),C=S.length>0?o(v,S[0]):!a.current.noIsolation;C&&v.cancelable&&v.preventDefault()}}},[]),c=T.useCallback(function(b,v,x,w){var S={name:b,delta:v,target:x,should:w,shadowParent:AZe(x)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(C){return C!==S})},1)},[]),u=T.useCallback(function(b){n.current=f2(b),r.current=void 0},[]),d=T.useCallback(function(b){c(b.type,RV(b),b.target,o(b,e.lockRef.current))},[]),h=T.useCallback(function(b){c(b.type,f2(b),b.target,o(b,e.lockRef.current))},[]);T.useEffect(function(){return e0.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Qg),document.addEventListener("touchmove",l,Qg),document.addEventListener("touchstart",u,Qg),function(){e0=e0.filter(function(b){return b!==i}),document.removeEventListener("wheel",l,Qg),document.removeEventListener("touchmove",l,Qg),document.removeEventListener("touchstart",u,Qg)}},[]);var m=e.removeScrollBar,y=e.inert;return T.createElement(T.Fragment,null,y?T.createElement(i,{styles:kZe(s)}):null,m?T.createElement(gZe,{gapMode:e.gapMode}):null)}function AZe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const RZe=rZe(qae,TZe);var e_=T.forwardRef(function(e,t){return T.createElement(KT,cu({},e,{ref:t,sideCar:RZe}))});e_.classNames=KT.classNames;var NZe=[" ","Enter","ArrowUp","ArrowDown"],MZe=[" ","Enter"],Sm="Select",[YT,ZT,IZe]=hYe(Sm),[cb,idt]=Wi(Sm,[IZe,Rae]),XT=Rae(),[jZe,Jh]=cb(Sm),[OZe,PZe]=cb(Sm),Kae=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:m,form:y}=e,b=XT(t),[v,x]=T.useState(null),[w,S]=T.useState(null),[C,k]=T.useState(!1),A=ib(c),[R,N]=Ec({prop:r,defaultProp:s??!1,onChange:i,caller:Sm}),[I,O]=Ec({prop:a,defaultProp:o,onChange:l,caller:Sm}),L=T.useRef(null),P=v?y||!!v.closest("form"):!0,[V,F]=T.useState(new Set),X=Array.from(V).map(U=>U.props.value).join(";");return f.jsx(LYe,{...b,children:f.jsxs(jZe,{required:m,scope:t,trigger:v,onTriggerChange:x,valueNode:w,onValueNodeChange:S,valueNodeHasChildren:C,onValueNodeHasChildrenChange:k,contentId:ia(),value:I,onValueChange:O,open:R,onOpenChange:N,dir:A,triggerPointerDownPosRef:L,disabled:h,children:[f.jsx(YT.Provider,{scope:t,children:f.jsx(OZe,{scope:e.__scopeSelect,onNativeOptionAdd:T.useCallback(U=>{F(H=>new Set(H).add(U))},[]),onNativeOptionRemove:T.useCallback(U=>{F(H=>{const $=new Set(H);return $.delete(U),$})},[]),children:n})}),P?f.jsxs(goe,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:d,value:I,onChange:U=>O(U.target.value),disabled:h,form:y,children:[I===void 0?f.jsx("option",{value:""}):null,Array.from(V)]},X):null]})})};Kae.displayName=Sm;var Yae="SelectTrigger",Zae=T.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=XT(n),a=Jh(Yae,n),o=a.disabled||r,l=Rn(t,a.onTriggerChange),c=ZT(n),u=T.useRef("touch"),[d,h,m]=boe(b=>{const v=c().filter(S=>!S.disabled),x=v.find(S=>S.value===a.value),w=voe(v,b,x);w!==void 0&&a.onValueChange(w.value)}),y=b=>{o||(a.onOpenChange(!0),m()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return f.jsx(BYe,{asChild:!0,...i,children:f.jsx(vi.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":yoe(a.value)?"":void 0,...s,ref:l,onClick:Wt(s.onClick,b=>{b.currentTarget.focus(),u.current!=="mouse"&&y(b)}),onPointerDown:Wt(s.onPointerDown,b=>{u.current=b.pointerType;const v=b.target;v.hasPointerCapture(b.pointerId)&&v.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:Wt(s.onKeyDown,b=>{const v=d.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&h(b.key),!(v&&b.key===" ")&&NZe.includes(b.key)&&(y(),b.preventDefault())})})})});Zae.displayName=Yae;var Xae="SelectValue",Jae=T.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:a="",...o}=e,l=Jh(Xae,n),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,d=Rn(t,l.onValueNodeChange);return ti(()=>{c(u)},[c,u]),f.jsx(vi.span,{...o,ref:d,style:{pointerEvents:"none"},children:yoe(l.value)?f.jsx(f.Fragment,{children:a}):i})});Jae.displayName=Xae;var DZe="SelectIcon",Qae=T.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return f.jsx(vi.span,{"aria-hidden":!0,...s,ref:t,children:r||""})});Qae.displayName=DZe;var FZe="SelectPortal",eoe=e=>f.jsx(Lae,{asChild:!0,...e});eoe.displayName=FZe;var Cm="SelectContent",toe=T.forwardRef((e,t)=>{const n=Jh(Cm,e.__scopeSelect),[r,s]=T.useState();if(ti(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?rl.createPortal(f.jsx(noe,{scope:e.__scopeSelect,children:f.jsx(YT.Slot,{scope:e.__scopeSelect,children:f.jsx("div",{children:e.children})})}),i):null}return f.jsx(roe,{...e,ref:t})});toe.displayName=Cm;var lc=10,[noe,Qh]=cb(Cm),LZe="SelectContentImpl",BZe=_u("SelectContent.RemoveScroll"),roe=T.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v,...x}=e,w=Jh(Cm,n),[S,C]=T.useState(null),[k,A]=T.useState(null),R=Rn(t,De=>C(De)),[N,I]=T.useState(null),[O,L]=T.useState(null),P=ZT(n),[V,F]=T.useState(!1),X=T.useRef(!1);T.useEffect(()=>{if(S)return GT(S)},[S]),WT();const U=T.useCallback(De=>{const[Se,...Ce]=P().map(Ve=>Ve.ref.current),[qe]=Ce.slice(-1),Qe=document.activeElement;for(const Ve of De)if(Ve===Qe||(Ve==null||Ve.scrollIntoView({block:"nearest"}),Ve===Se&&k&&(k.scrollTop=0),Ve===qe&&k&&(k.scrollTop=k.scrollHeight),Ve==null||Ve.focus(),document.activeElement!==Qe))return},[P,k]),H=T.useCallback(()=>U([N,S]),[U,N,S]);T.useEffect(()=>{V&&H()},[V,H]);const{onOpenChange:$,triggerPointerDownPosRef:ne}=w;T.useEffect(()=>{if(S){let De={x:0,y:0};const Se=qe=>{var Qe,Ve;De={x:Math.abs(Math.round(qe.pageX)-(((Qe=ne.current)==null?void 0:Qe.x)??0)),y:Math.abs(Math.round(qe.pageY)-(((Ve=ne.current)==null?void 0:Ve.y)??0))}},Ce=qe=>{De.x<=10&&De.y<=10?qe.preventDefault():S.contains(qe.target)||$(!1),document.removeEventListener("pointermove",Se),ne.current=null};return ne.current!==null&&(document.addEventListener("pointermove",Se),document.addEventListener("pointerup",Ce,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Se),document.removeEventListener("pointerup",Ce,{capture:!0})}}},[S,$,ne]),T.useEffect(()=>{const De=()=>$(!1);return window.addEventListener("blur",De),window.addEventListener("resize",De),()=>{window.removeEventListener("blur",De),window.removeEventListener("resize",De)}},[$]);const[W,Q]=boe(De=>{const Se=P().filter(Qe=>!Qe.disabled),Ce=Se.find(Qe=>Qe.ref.current===document.activeElement),qe=voe(Se,De,Ce);qe&&setTimeout(()=>qe.ref.current.focus())}),ee=T.useCallback((De,Se,Ce)=>{const qe=!X.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&(I(De),qe&&(X.current=!0))},[w.value]),se=T.useCallback(()=>S==null?void 0:S.focus(),[S]),pe=T.useCallback((De,Se,Ce)=>{const qe=!X.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&L(De)},[w.value]),ce=r==="popper"?oO:soe,Ie=ce===oO?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v}:{};return f.jsx(noe,{scope:n,content:S,viewport:k,onViewportChange:A,itemRefCallback:ee,selectedItem:N,onItemLeave:se,itemTextRefCallback:pe,focusSelectedItem:H,selectedItemText:O,position:r,isPositioned:V,searchRef:W,children:f.jsx(e_,{as:BZe,allowPinchZoom:!0,children:f.jsx(kae,{asChild:!0,trapped:w.open,onMountAutoFocus:De=>{De.preventDefault()},onUnmountAutoFocus:Wt(s,De=>{var Se;(Se=w.trigger)==null||Se.focus({preventScroll:!0}),De.preventDefault()}),children:f.jsx(Sae,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:De=>De.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:f.jsx(ce,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:De=>De.preventDefault(),...x,...Ie,onPlaced:()=>F(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Wt(x.onKeyDown,De=>{const Se=De.ctrlKey||De.altKey||De.metaKey;if(De.key==="Tab"&&De.preventDefault(),!Se&&De.key.length===1&&Q(De.key),["ArrowUp","ArrowDown","Home","End"].includes(De.key)){let qe=P().filter(Qe=>!Qe.disabled).map(Qe=>Qe.ref.current);if(["ArrowUp","End"].includes(De.key)&&(qe=qe.slice().reverse()),["ArrowUp","ArrowDown"].includes(De.key)){const Qe=De.target,Ve=qe.indexOf(Qe);qe=qe.slice(Ve+1)}setTimeout(()=>U(qe)),De.preventDefault()}})})})})})})});roe.displayName=LZe;var $Ze="SelectItemAlignedPosition",soe=T.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=Jh(Cm,n),a=Qh(Cm,n),[o,l]=T.useState(null),[c,u]=T.useState(null),d=Rn(t,R=>u(R)),h=ZT(n),m=T.useRef(!1),y=T.useRef(!0),{viewport:b,selectedItem:v,selectedItemText:x,focusSelectedItem:w}=a,S=T.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&b&&v&&x){const R=i.trigger.getBoundingClientRect(),N=c.getBoundingClientRect(),I=i.valueNode.getBoundingClientRect(),O=x.getBoundingClientRect();if(i.dir!=="rtl"){const Qe=O.left-N.left,Ve=I.left-Qe,Ne=R.left-Ve,K=R.width+Ne,me=Math.max(K,N.width),Ae=window.innerWidth-lc,le=Bw(Ve,[lc,Math.max(lc,Ae-me)]);o.style.minWidth=K+"px",o.style.left=le+"px"}else{const Qe=N.right-O.right,Ve=window.innerWidth-I.right-Qe,Ne=window.innerWidth-R.right-Ve,K=R.width+Ne,me=Math.max(K,N.width),Ae=window.innerWidth-lc,le=Bw(Ve,[lc,Math.max(lc,Ae-me)]);o.style.minWidth=K+"px",o.style.right=le+"px"}const L=h(),P=window.innerHeight-lc*2,V=b.scrollHeight,F=window.getComputedStyle(c),X=parseInt(F.borderTopWidth,10),U=parseInt(F.paddingTop,10),H=parseInt(F.borderBottomWidth,10),$=parseInt(F.paddingBottom,10),ne=X+U+V+$+H,W=Math.min(v.offsetHeight*5,ne),Q=window.getComputedStyle(b),ee=parseInt(Q.paddingTop,10),se=parseInt(Q.paddingBottom,10),pe=R.top+R.height/2-lc,ce=P-pe,Ie=v.offsetHeight/2,De=v.offsetTop+Ie,Se=X+U+De,Ce=ne-Se;if(Se<=pe){const Qe=L.length>0&&v===L[L.length-1].ref.current;o.style.bottom="0px";const Ve=c.clientHeight-b.offsetTop-b.offsetHeight,Ne=Math.max(ce,Ie+(Qe?se:0)+Ve+H),K=Se+Ne;o.style.height=K+"px"}else{const Qe=L.length>0&&v===L[0].ref.current;o.style.top="0px";const Ne=Math.max(pe,X+b.offsetTop+(Qe?ee:0)+Ie)+Ce;o.style.height=Ne+"px",b.scrollTop=Se-pe+b.offsetTop}o.style.margin=`${lc}px 0`,o.style.minHeight=W+"px",o.style.maxHeight=P+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[h,i.trigger,i.valueNode,o,c,b,v,x,i.dir,r]);ti(()=>S(),[S]);const[C,k]=T.useState();ti(()=>{c&&k(window.getComputedStyle(c).zIndex)},[c]);const A=T.useCallback(R=>{R&&y.current===!0&&(S(),w==null||w(),y.current=!1)},[S,w]);return f.jsx(UZe,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:A,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C},children:f.jsx(vi.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});soe.displayName=$Ze;var zZe="SelectPopperPosition",oO=T.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=lc,...i}=e,a=XT(n);return f.jsx($Ye,{...a,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});oO.displayName=zZe;var[UZe,b5]=cb(Cm,{}),lO="SelectViewport",ioe=T.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=Qh(lO,n),a=b5(lO,n),o=Rn(t,i.onViewportChange),l=T.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(YT.Slot,{scope:n,children:f.jsx(vi.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Wt(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=a;if(h!=null&&h.current&&d){const m=Math.abs(l.current-u.scrollTop);if(m>0){const y=window.innerHeight-lc*2,b=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),x=Math.max(b,v);if(x<y){const w=x+m,S=Math.min(y,w),C=w-S;d.style.height=S+"px",d.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});ioe.displayName=lO;var aoe="SelectGroup",[qZe,VZe]=cb(aoe),WZe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=ia();return f.jsx(qZe,{scope:n,id:s,children:f.jsx(vi.div,{role:"group","aria-labelledby":s,...r,ref:t})})});WZe.displayName=aoe;var ooe="SelectLabel",HZe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=VZe(ooe,n);return f.jsx(vi.div,{id:s.id,...r,ref:t})});HZe.displayName=ooe;var Xk="SelectItem",[GZe,loe]=cb(Xk),coe=T.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...a}=e,o=Jh(Xk,n),l=Qh(Xk,n),c=o.value===r,[u,d]=T.useState(i??""),[h,m]=T.useState(!1),y=Rn(t,w=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,w,r,s)}),b=ia(),v=T.useRef("touch"),x=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(GZe,{scope:n,value:r,disabled:s,textId:b,isSelected:c,onItemTextChange:T.useCallback(w=>{d(S=>S||((w==null?void 0:w.textContent)??"").trim())},[]),children:f.jsx(YT.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:f.jsx(vi.div,{role:"option","aria-labelledby":b,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:y,onFocus:Wt(a.onFocus,()=>m(!0)),onBlur:Wt(a.onBlur,()=>m(!1)),onClick:Wt(a.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:Wt(a.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:Wt(a.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:Wt(a.onPointerMove,w=>{var S;v.current=w.pointerType,s?(S=l.onItemLeave)==null||S.call(l):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Wt(a.onPointerLeave,w=>{var S;w.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:Wt(a.onKeyDown,w=>{var C;((C=l.searchRef)==null?void 0:C.current)!==""&&w.key===" "||(MZe.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});coe.displayName=Xk;var ix="SelectItemText",uoe=T.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,a=Jh(ix,n),o=Qh(ix,n),l=loe(ix,n),c=PZe(ix,n),[u,d]=T.useState(null),h=Rn(t,x=>d(x),l.onItemTextChange,x=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,x,l.value,l.disabled)}),m=u==null?void 0:u.textContent,y=T.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:b,onNativeOptionRemove:v}=c;return ti(()=>(b(y),()=>v(y)),[b,v,y]),f.jsxs(f.Fragment,{children:[f.jsx(vi.span,{id:l.textId,...i,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?rl.createPortal(i.children,a.valueNode):null]})});uoe.displayName=ix;var doe="SelectItemIndicator",foe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return loe(doe,n).isSelected?f.jsx(vi.span,{"aria-hidden":!0,...r,ref:t}):null});foe.displayName=doe;var cO="SelectScrollUpButton",hoe=T.forwardRef((e,t)=>{const n=Qh(cO,e.__scopeSelect),r=b5(cO,e.__scopeSelect),[s,i]=T.useState(!1),a=Rn(t,r.onScrollButtonChange);return ti(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;i(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(moe,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});hoe.displayName=cO;var uO="SelectScrollDownButton",poe=T.forwardRef((e,t)=>{const n=Qh(uO,e.__scopeSelect),r=b5(uO,e.__scopeSelect),[s,i]=T.useState(!1),a=Rn(t,r.onScrollButtonChange);return ti(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(moe,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});poe.displayName=uO;var moe=T.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=Qh("SelectScrollButton",n),a=T.useRef(null),o=ZT(n),l=T.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return T.useEffect(()=>()=>l(),[l]),ti(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),f.jsx(vi.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Wt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Wt(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Wt(s.onPointerLeave,()=>{l()})})}),KZe="SelectSeparator",YZe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return f.jsx(vi.div,{"aria-hidden":!0,...r,ref:t})});YZe.displayName=KZe;var dO="SelectArrow",ZZe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=XT(n),i=Jh(dO,n),a=Qh(dO,n);return i.open&&a.position==="popper"?f.jsx(zYe,{...s,...r,ref:t}):null});ZZe.displayName=dO;var XZe="SelectBubbleInput",goe=T.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=T.useRef(null),i=Rn(r,s),a=HT(t);return T.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(vi.select,{...n,style:{...Bae,...n.style},ref:i,defaultValue:t})});goe.displayName=XZe;function yoe(e){return e===""||e===void 0}function boe(e){const t=Cs(e),n=T.useRef(""),r=T.useRef(0),s=T.useCallback(a=>{const o=n.current+a;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),i=T.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return T.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function voe(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=JZe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function JZe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var QZe=Kae,eXe=Zae,tXe=Jae,nXe=Qae,rXe=eoe,sXe=toe,iXe=ioe,aXe=coe,oXe=uoe,lXe=foe,cXe=hoe,uXe=poe;function Wm({...e}){return f.jsx(QZe,{"data-slot":"select",...e})}function Hm({...e}){return f.jsx(tXe,{"data-slot":"select-value",...e})}function Gm({className:e,size:t="default",children:n,...r}){return f.jsxs(eXe,{"data-slot":"select-trigger","data-size":t,className:Ze("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,f.jsx(nXe,{asChild:!0,children:f.jsx(Nc,{className:"size-4 opacity-50"})})]})}function Km({className:e,children:t,position:n="popper",...r}){return f.jsx(rXe,{children:f.jsxs(sXe,{"data-slot":"select-content",className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[f.jsx(dXe,{}),f.jsx(iXe,{className:Ze("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),f.jsx(fXe,{})]})})}function sl({className:e,children:t,...n}){return f.jsxs(aXe,{"data-slot":"select-item",className:Ze("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[f.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:f.jsx(lXe,{children:f.jsx(ro,{className:"size-4"})})}),f.jsx(oXe,{children:t})]})}function dXe({className:e,...t}){return f.jsx(cXe,{"data-slot":"select-scroll-up-button",className:Ze("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Dh,{className:"size-4"})})}function fXe({className:e,...t}){return f.jsx(uXe,{"data-slot":"select-scroll-down-button",className:Ze("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Nc,{className:"size-4"})})}var hXe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],pXe=hXe.reduce((e,t)=>{const n=_u(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),mXe="Label",xoe=T.forwardRef((e,t)=>f.jsx(pXe.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));xoe.displayName=mXe;var gXe=xoe;function Dt({className:e,...t}){return f.jsx(gXe,{"data-slot":"label",className:Ze("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const Ni=({field:e,className:t})=>e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:`text-xs text-destructive mt-1 block ${t||""}`,children:e.state.meta.errors.map(r=>typeof r=="string"?r:typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"?r.message:(console.warn("[GlobalFieldMetaMessages] Encountered an unexpected error structure:",r),"Validation error")).join(", ")}):null,yXe=xo.map(e=>e.value),h2=Ke({keyName:$e().min(1,"Key Name is required."),providerType:hl(yXe,{errorMap:()=>({message:"Provider Type is required."})}),keyValue:$e().min(1,"API Key Value is required.")}),woe=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:s,disabled:i=!1,className:a})=>{const o=T.useRef(null),l=ni({defaultValues:{keyName:t,providerType:e,keyValue:n},validators:{onChangeAsync:h2,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{await r(u.keyName,u.providerType,u.keyValue)}});T.useEffect(()=>{l.reset({keyName:t,providerType:e,keyValue:n})},[t,n,e,l]);const c=(u,d)=>{var b,v;if(!u)return;const h=(b=xo.find(x=>x.value===u))==null?void 0:b.label,m=l.getFieldValue("providerType"),y=(v=xo.find(x=>x.value===m))==null?void 0:v.label;h&&(!(d!=null&&d.trim())||d===y)&&l.setFieldValue("keyName",h),requestAnimationFrame(()=>{var x;(x=o.current)==null||x.focus()})};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:Ze("space-y-6",a),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(l.Field,{name:"providerType",validators:{onChange:h2.shape.providerType},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:u.name,children:"Provider Type"}),f.jsxs(Wm,{value:u.state.value??"",onValueChange:d=>{const h=d;u.handleChange(h),u.handleBlur(),c(h,l.getFieldValue("keyName"))},disabled:i||l.state.isSubmitting,children:[f.jsx(Gm,{id:u.name,children:f.jsx(Hm,{placeholder:"Select Provider Type"})}),f.jsx(Km,{children:xo.map(d=>f.jsx(sl,{value:d.value,children:d.label},d.value))})]}),f.jsx(Ni,{field:u})]})}),f.jsx(l.Field,{name:"keyName",validators:{onChange:h2.shape.keyName},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:u.name,children:"Key Name"}),f.jsx(Cn,{id:u.name,value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"e.g., My OpenAI Key",disabled:i||l.state.isSubmitting}),f.jsx(Ni,{field:u})]})}),f.jsx(l.Field,{name:"keyValue",validators:{onChange:h2.shape.keyValue},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:u.name,children:"API Key Value"}),f.jsx(Cn,{ref:o,id:u.name,type:"password",value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"Enter your API key",disabled:i||l.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Ni,{field:u})]})})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(bt,{variant:"ghost",size:"sm",onClick:s,disabled:i||l.state.isSubmitting,type:"button",children:[f.jsx(wa,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:u=>[u.canSubmit,u.isSubmitting,u.isValidating,u.isValid],children:([u,d,h,m])=>f.jsxs(bt,{type:"submit",size:"sm",disabled:i||!u||d||h||!m,children:[(d||h)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Jd,{className:"h-4 w-4 mr-1"}),d||h?"Saving...":"Save API Key"]})})]})]})},bXe=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:s,disabled:i=!1})=>{var c;const a=u=>{r(u==="none"?null:u)},o=(c=s.find(u=>u.id===n))==null?void 0:c.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return f.jsxs(Wm,{value:n??"none",onValueChange:a,disabled:i||s.length===0,children:[f.jsx(Gm,{className:Ze("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:f.jsx(Hm,{asChild:!0,children:f.jsxs("div",{className:"flex items-center overflow-hidden",children:[f.jsx(Dx,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),f.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&f.jsxs("span",{className:"mr-1",children:[t,":"]}),s.length===0?f.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),f.jsxs(Km,{className:"bg-popover border-border text-popover-foreground",children:[f.jsx(sl,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(u=>f.jsx(sl,{value:u.id,children:u.name||`Key ID: ${u.id.substring(0,6)}...`},u.id))]})]})};function Kw({form:e,name:t,label:n,type:r="text",placeholder:s,disabled:i,wrapperClassName:a,className:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="string"||typeof c.state.value=="number"?String(c.state.value):"";return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[f.jsx(Dt,{htmlFor:c.name,className:"text-sm",children:n}),f.jsx(Cn,{id:c.name,name:c.name,type:r,value:u,onBlur:c.handleBlur,onChange:d=>c.handleChange(d.target.value),placeholder:s,disabled:i??c.form.state.isSubmitting,className:Ze(o,c.state.meta.errors.length?"border-destructive":""),...l}),f.jsx(Ni,{field:c})]})}})}function Nx({form:e,name:t,label:n,options:r,placeholder:s,disabled:i,wrapperClassName:a,triggerClassName:o,contentClassName:l,...c}){return console.log("SelectField",t),f.jsx(e.Field,{name:t,children:u=>{const d=u.state.value!==null&&u.state.value!==void 0?String(u.state.value):"";return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[f.jsx(Dt,{htmlFor:u.name,className:"text-sm",children:n}),f.jsxs(Wm,{value:d,onValueChange:h=>u.handleChange(h),disabled:i??u.form.state.isSubmitting,...c,children:[f.jsx(Gm,{id:u.name,onBlur:u.handleBlur,className:Ze(o,u.state.meta.errors.length?"border-destructive":""),children:f.jsx(Hm,{placeholder:s})}),f.jsx(Km,{className:l,children:r.map(h=>f.jsx(sl,{value:String(h.value),disabled:h.disabled,children:h.label},h.value))})]}),f.jsx(Ni,{field:u})]})}})}var vXe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],_oe=vXe.reduce((e,t)=>{const n=_u(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),JT="Switch",[xXe,adt]=Wi(JT),[wXe,_Xe]=xXe(JT),Soe=T.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,m]=T.useState(null),y=Rn(t,S=>m(S)),b=T.useRef(!1),v=h?u||!!h.closest("form"):!0,[x,w]=Ec({prop:s,defaultProp:i??!1,onChange:c,caller:JT});return f.jsxs(wXe,{scope:n,checked:x,disabled:o,children:[f.jsx(_oe.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":Toe(x),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:y,onClick:Wt(e.onClick,S=>{w(C=>!C),v&&(b.current=S.isPropagationStopped(),b.current||S.stopPropagation())})}),v&&f.jsx(Eoe,{control:h,bubbles:!b.current,name:r,value:l,checked:x,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});Soe.displayName=JT;var Coe="SwitchThumb",koe=T.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=_Xe(Coe,n);return f.jsx(_oe.span,{"data-state":Toe(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});koe.displayName=Coe;var SXe="SwitchBubbleInput",Eoe=T.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=T.useRef(null),o=Rn(a,i),l=HT(n),c=Dy(t);return T.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&m){const y=new Event("click",{bubbles:r});m.call(u,n),u.dispatchEvent(y)}},[l,n,r]),f.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Eoe.displayName=SXe;function Toe(e){return e?"checked":"unchecked"}var CXe=Soe,kXe=koe;function ol({className:e,...t}){return f.jsx(CXe,{"data-slot":"switch",className:Ze("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(kXe,{"data-slot":"switch-thumb",className:Ze("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function $p({form:e,name:t,label:n,description:r,disabled:s,wrapperClassName:i,className:a,labelClassName:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="boolean"?c.state.value:!1;return f.jsxs("div",{className:Ze("space-y-1.5",i),children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(Dt,{htmlFor:c.name,className:Ze("text-sm font-medium leading-none cursor-pointer",o),children:n}),f.jsx(ol,{id:c.name,name:c.name,checked:u,onCheckedChange:d=>c.handleChange(d),onBlur:c.handleBlur,disabled:s??c.form.state.isSubmitting,className:Ze(a,c.state.meta.errors.length?"border-destructive":""),...l})]}),r&&f.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:r}),f.jsx(Ni,{field:c})]})}})}const EXe=xo.map(e=>e.value),TXe=Ke({name:$e().min(1,"Provider Name is required."),type:hl(EXe,{errorMap:()=>({message:"Provider Type is required."})}),isEnabled:br(),apiKeyId:$e().nullable(),baseURL:$e().url().nullable().or(An("")),autoFetchModels:br()}).refine(e=>AC(e.type)?!(!e.baseURL||e.baseURL.trim()===""):!0,{message:"Base URL is required and must be a valid URL for this provider type.",path:["baseURL"]}).refine(e=>K0(e.type)?!!e.apiKeyId:!0,{message:"API Key is required for this provider type.",path:["apiKeyId"]}),AXe=xo.map(e=>({value:e.value,label:e.label})),Aoe=({initialData:e,onSubmit:t,onChange:n,onCancel:r,apiKeys:s,isSavingExt:i=!1,disabled:a=!1,className:o})=>{var v;const l=ni({defaultValues:{name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||((v=xo[0])==null?void 0:v.value),isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??!1},validators:{onChangeAsync:TXe,onChangeAsyncDebounceMs:500},onSubmit:async({value:x})=>{const w={...x,baseURL:(x.baseURL===null||typeof x.baseURL=="string"&&x.baseURL.trim()==="")&&!AC(x.type)?null:x.baseURL};await t(w)}}),c=T.useRef(l.state.values);T.useEffect(()=>{const x=l.store.subscribe(()=>{const w=l.state.values,S=c.current;if(n&&S)for(const C in w){const k=C;w[k]!==S[k]&&n(k,w[k])}c.current={...w}});return l.state.values!==c.current&&(c.current=l.state.values),x},[l,n]),T.useEffect(()=>{var S,C;const x=(e==null?void 0:e.type)||((S=xo[0])==null?void 0:S.value),w={name:(e==null?void 0:e.name)||((C=xo.find(k=>k.value===x))==null?void 0:C.label)||"",type:x,isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??Qp(x)};l.reset(w),c.current=w},[e]);const u=l.state.values.type,d=K0(u??null),h=AC(u??null),m=Qp(u??null),y=T.useCallback(x=>{var S,C;if(!x)return;const w=l.state.values.type;if(x!==w){l.setFieldValue("apiKeyId",null),l.setFieldValue("baseURL",null),l.setFieldValue("autoFetchModels",Qp(x));const k=(S=xo.find(N=>N.value===x))==null?void 0:S.label,A=(C=xo.find(N=>N.value===w))==null?void 0:C.label,R=l.state.values.name;k&&(!(R!=null&&R.trim())||R===A)&&l.setFieldValue("name",k)}},[l]);T.useEffect(()=>{const x=l.state.values.type;x!==void 0&&y(x)},[l.state.values.type,y]);const b=(s||[]).filter(x=>!u||x.providerId===u);return f.jsxs("form",{onSubmit:x=>{x.preventDefault(),x.stopPropagation(),l.handleSubmit()},className:Ze("space-y-4 border rounded-md p-4 bg-card shadow-sm",o),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3",children:[f.jsx(Nx,{form:l,name:"type",label:"Provider Type",options:AXe,disabled:a||i,placeholder:"Select Type",wrapperClassName:"md:col-span-1"}),f.jsx(Kw,{form:l,name:"name",label:"Provider Name",placeholder:"e.g., My Ollama",disabled:a||i,"aria-label":"Provider Name",wrapperClassName:"md:col-span-1"}),d&&f.jsx(l.Field,{name:"apiKeyId",children:x=>f.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[f.jsx(Dt,{htmlFor:`${x.name}-trigger`,children:"API Key"})," ",f.jsx(bXe,{selectedKeyId:x.state.value??null,onKeySelected:w=>{x.handleChange(w),x.handleBlur()},apiKeys:b,disabled:a||i||!u}),f.jsx(Ni,{field:x})]})}),h&&f.jsx(Kw,{form:l,name:"baseURL",label:"Base URL",placeholder:"e.g., http://localhost:11434",type:"url",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),m&&f.jsx($p,{form:l,name:"autoFetchModels",label:"Auto-Fetch Models",description:"Automatically fetch and update the list of available models from this provider.",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),f.jsx($p,{form:l,name:"isEnabled",label:"Enable Provider",description:"Allow this provider to be used for generating responses.",disabled:a||i,wrapperClassName:"md:col-span-2"})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(bt,{variant:"ghost",size:"sm",onClick:r,disabled:a||i,type:"button",children:[f.jsx(wa,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:x=>[x.canSubmit,x.isSubmitting,x.isValidating,x.isValid],children:([x,w,S,C])=>f.jsxs(bt,{type:"submit",size:"sm",disabled:a||i||!x||w||!C||S,children:[(i||w||S)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Jd,{className:"h-4 w-4 mr-1"})," ",i||w||S?"Saving...":e!=null&&e.name?"Save Changes":"Add Provider"]})})]})]})},Roe=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:s="",initialApiKeyId:i=null})=>{const[a,o]=T.useState(!1),[l,c]=T.useState({name:s,type:r,isEnabled:!0,apiKeyId:i,baseURL:null,autoFetchModels:Qp(r)});T.useEffect(()=>{c(h=>({...h,name:s||h.name||"",type:r||h.type||null,apiKeyId:i||h.apiKeyId||null,autoFetchModels:!1}))},[s,r,i]);const u=T.useCallback((h,m)=>new Promise(y=>{c(b=>{var w,S;const v={...b,[h]:m},x=b.name||"";if(h==="type"){const C=m,k=(w=xo.find(R=>R.value===b.type))==null?void 0:w.label;v.apiKeyId=null,v.baseURL=null,v.autoFetchModels=C?Qp(C):!1;const A=(S=xo.find(R=>R.value===C))==null?void 0:S.label;if(A&&(!x.trim()||x===k)&&(v.name=A),C&&K0(C)){const R=(e||[]).filter(N=>N.providerId===C);R.length>0&&(v.apiKeyId=R[0].id)}}return v}),y(void 0)}),[e]),d=T.useCallback(async()=>{var h,m;if(!((h=l.name)!=null&&h.trim())||!l.type){Oe.error("Provider Name and Type are required.");return}o(!0);try{const y=l.type,b=l.autoFetchModels??Qp(y),v={name:l.name.trim(),type:y,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((m=l.baseURL)==null?void 0:m.trim())||null,enabledModels:null,autoFetchModels:b,fetchedModels:null,modelsLastFetchedAt:null};await t(v),n()}catch(y){console.error("Failed to add provider (from form component):",y)}finally{o(!1)}},[l,t,n]);return f.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),f.jsx(Aoe,{initialData:l,onSubmit:d,onCancel:n,onChange:u,apiKeys:e,disabled:a})]})},xd=We.forwardRef(({className:e,href:t,children:n,...r},s)=>f.jsx("a",{ref:s,href:t,target:"_blank",rel:"noopener noreferrer",className:Ze("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));xd.displayName="Lnk";const RXe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})},NXe=TO("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function mi({className:e,variant:t,asChild:n=!1,...r}){const s=n?qW:"span";return f.jsx(s,{"data-slot":"badge",className:Ze(NXe({variant:t}),e),...r})}const MXe=()=>{const[e,t]=T.useState(!1);T.useEffect(()=>{t(!0)},[]);const n={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},r={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{duration:.5}}},s=[{word:"LiteChat",color:"bg-gradient-to-tr from-lime-500 via-amber-400 to-red-600 bg-clip-text text-transparent"},{word:"library",color:"text-emerald-500"},{word:"browser",color:"text-violet-500"},{word:"local",color:"text-amber-500"},{word:"remote",color:"text-sky-500"},{word:"providers",color:"text-purple-500"},{word:" AI ",color:"bg-gradient-to-b from-amber-300 to-rose-700 bg-clip-text text-transparent"},{word:"Open Source",color:"bg-gradient-to-r from-lime-500 to-yellow-500 bg-clip-text text-transparent"}],i=o=>{let l=[o];return s.forEach(({word:c,color:u})=>{l=l.reduce((d,h)=>typeof h!="string"?(d.push(h),d):(h.split(new RegExp(`(${c})`,"gi")).forEach((y,b)=>{y.toLowerCase()===c.toLowerCase()?d.push(f.jsx("span",{className:`${u} font-medium`,children:y},`${y}-${b}`)):d.push(y)}),d),[])}),l=l.reduce((c,u,d)=>{if(typeof u!="string")return c.push(u),c;const h=/(\([^)]*\))/g;return u.split(h).forEach((y,b)=>{h.test(y)?c.push(f.jsx("span",{className:"text-sm text-muted",children:y},`paren-${d}-${b}`)):c.push(y)}),c},[]),l},a=["Oh, hey?! Hi there!! How are you doing!?","Nice of you to pop by to checkout LiteChat!","What'd you mean you don't know what LiteChat is? Oh Boy hey, you in for a treat!","To start with, it's an(other) AI chat app (yes...shocker, right ?) and it's Open Source ! ","But, it is also an extensible library, so you can go on and create your own, AI chat app! With your own functionnalities !","(are AI chat apps the new JS frameworks?)","And cause I might be a wee bit on the reluctant side when it comes to parting with my coins, it doesn't require no servers! It all stays in your browser.","(that means I couldn't snoop on what you do here, even if I wanted to!)","While able to run LLM both local (did I tell you I ain't liking throwing coins out?) and from remote providers","(but sometimes you have to :(..)","To cap things off, there is no fancy/crazy tech involved, I just glued bricks together with AI","(kids call it vibing apparently ^^)","Enough of this interminable babble! Go setup your future chat to prompt your brains out!"];return f.jsxs(iu.div,{className:"text-center max-w-4xl mx-auto space-y-3 my-6",initial:"hidden",animate:e?"show":"hidden",variants:n,children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsxs(mi,{variant:"outline",className:"px-3 py-1 bg-black/5 dark:bg-white/10 backdrop-blur-sm border-none",children:[f.jsx(pH,{className:"w-4 h-4 mr-2 text-yellow-500"}),f.jsx("span",{className:"text-sm",children:"Welcome to your future AI chat"})]})}),a.map((o,l)=>f.jsx(iu.p,{className:`text-sm md:text-base ${l===0?"font-medium":""} leading-relaxed`,variants:r,children:i(o)},l)),f.jsxs(iu.div,{variants:r,className:"pt-2",children:[f.jsx(mi,{className:"bg-gradient-to-r from-violet-600 to-primary border-none",children:"No server required!"}),f.jsx(mi,{className:"ml-2 bg-gradient-to-r from-amber-500 to-emerald-500 border-none",children:"100% in-browser"})]})]})};var v5="Progress",x5=100,[IXe,odt]=Wi(v5),[jXe,OXe]=IXe(v5),Noe=T.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=PXe,...a}=e;(s||s===0)&&!MV(s)&&console.error(DXe(`${s}`,"Progress"));const o=MV(s)?s:x5;r!==null&&!IV(r,o)&&console.error(FXe(`${r}`,"Progress"));const l=IV(r,o)?r:null,c=Jk(l)?i(l,o):void 0;return f.jsx(jXe,{scope:n,value:l,max:o,children:f.jsx(ar.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Jk(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":joe(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});Noe.displayName=v5;var Moe="ProgressIndicator",Ioe=T.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=OXe(Moe,n);return f.jsx(ar.div,{"data-state":joe(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});Ioe.displayName=Moe;function PXe(e,t){return`${Math.round(e/t*100)}%`}function joe(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Jk(e){return typeof e=="number"}function MV(e){return Jk(e)&&!isNaN(e)&&e>0}function IV(e,t){return Jk(e)&&!isNaN(e)&&e<=t&&e>=0}function DXe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${x5}\`.`}function FXe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${x5} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ooe=Noe,LXe=Ioe;const Ey=T.forwardRef(({className:e,value:t,...n},r)=>f.jsx(Ooe,{ref:r,className:Ze("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:f.jsx(LXe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ey.displayName=Ooe.displayName;var BXe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],af=BXe.reduce((e,t)=>{const n=_u(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function $Xe(e,t){e&&rl.flushSync(()=>e.dispatchEvent(t))}var zXe="DismissableLayer",fO="dismissableLayer.update",UXe="dismissableLayer.pointerDownOutside",qXe="dismissableLayer.focusOutside",jV,Poe=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Doe=T.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=T.useContext(Poe),[u,d]=T.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=T.useState({}),y=Rn(t,R=>d(R)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,C=w>=x,k=HXe(R=>{const N=R.target,I=[...c.branches].some(O=>O.contains(N));!C||I||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),A=GXe(R=>{const N=R.target;[...c.branches].some(O=>O.contains(N))||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return KO(R=>{w===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),T.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(jV=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),OV(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=jV)}},[u,h,n,c]),T.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),OV())},[u,c]),T.useEffect(()=>{const R=()=>m({});return document.addEventListener(fO,R),()=>document.removeEventListener(fO,R)},[]),f.jsx(af.div,{...l,ref:y,style:{pointerEvents:S?C?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,A.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,k.onPointerDownCapture)})});Doe.displayName=zXe;var VXe="DismissableLayerBranch",WXe=T.forwardRef((e,t)=>{const n=T.useContext(Poe),r=T.useRef(null),s=Rn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(af.div,{...e,ref:s})});WXe.displayName=VXe;function HXe(e,t=globalThis==null?void 0:globalThis.document){const n=Cs(e),r=T.useRef(!1),s=T.useRef(()=>{});return T.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Foe(UXe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function GXe(e,t=globalThis==null?void 0:globalThis.document){const n=Cs(e),r=T.useRef(!1);return T.useEffect(()=>{const s=i=>{i.target&&!r.current&&Foe(qXe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function OV(){const e=new CustomEvent(fO);document.dispatchEvent(e)}function Foe(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?$Xe(s,i):s.dispatchEvent(i)}var h3="focusScope.autoFocusOnMount",p3="focusScope.autoFocusOnUnmount",PV={bubbles:!1,cancelable:!0},KXe="FocusScope",Loe=T.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=T.useState(null),c=Cs(s),u=Cs(i),d=T.useRef(null),h=Rn(t,b=>l(b)),m=T.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;T.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const C=S.target;o.contains(C)?d.current=C:Qf(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const C=S.relatedTarget;C!==null&&(o.contains(C)||Qf(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const k of S)k.removedNodes.length>0&&Qf(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),T.useEffect(()=>{if(o){FV.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(h3,PV);o.addEventListener(h3,c),o.dispatchEvent(x),x.defaultPrevented||(YXe(eJe(Boe(o)),{select:!0}),document.activeElement===b&&Qf(o))}return()=>{o.removeEventListener(h3,c),setTimeout(()=>{const x=new CustomEvent(p3,PV);o.addEventListener(p3,u),o.dispatchEvent(x),x.defaultPrevented||Qf(b??document.body,{select:!0}),o.removeEventListener(p3,u),FV.remove(m)},0)}}},[o,c,u,m]);const y=T.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,C]=ZXe(w);S&&C?!b.shiftKey&&x===C?(b.preventDefault(),n&&Qf(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&Qf(C,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(af.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});Loe.displayName=KXe;function YXe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Qf(r,{select:t}),document.activeElement!==n)return}function ZXe(e){const t=Boe(e),n=DV(t,e),r=DV(t.reverse(),e);return[n,r]}function Boe(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function DV(e,t){for(const n of e)if(!XXe(n,{upTo:t}))return n}function XXe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function JXe(e){return e instanceof HTMLInputElement&&"select"in e}function Qf(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&JXe(e)&&t&&e.select()}}var FV=QXe();function QXe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=LV(e,t),e.unshift(t)},remove(t){var n;e=LV(e,t),(n=e[0])==null||n.resume()}}}function LV(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function eJe(e){return e.filter(t=>t.tagName!=="A")}var tJe="Arrow",$oe=T.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(af.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});$oe.displayName=tJe;var nJe=$oe,w5="Popper",[zoe,Uoe]=Wi(w5),[rJe,qoe]=zoe(w5),Voe=e=>{const{__scopePopper:t,children:n}=e,[r,s]=T.useState(null);return f.jsx(rJe,{scope:t,anchor:r,onAnchorChange:s,children:n})};Voe.displayName=w5;var Woe="PopperAnchor",Hoe=T.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=qoe(Woe,n),a=T.useRef(null),o=Rn(t,a);return T.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(af.div,{...s,ref:o})});Hoe.displayName=Woe;var _5="PopperContent",[sJe,iJe]=zoe(_5),Goe=T.forwardRef((e,t)=>{var De,Se,Ce,qe,Qe,Ve;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=qoe(_5,n),[x,w]=T.useState(null),S=Rn(t,Ne=>w(Ne)),[C,k]=T.useState(null),A=Dy(C),R=(A==null?void 0:A.width)??0,N=(A==null?void 0:A.height)??0,I=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],P=L.length>0,V={padding:O,boundary:L.filter(oJe),altBoundary:P},{refs:F,floatingStyles:X,placement:U,isPositioned:H,middlewareData:$}=rP({strategy:"fixed",placement:I,whileElementsMounted:(...Ne)=>nP(...Ne,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[sP({mainAxis:s+N,alignmentAxis:a}),l&&iP({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?aP():void 0,...V}),l&&oP({...V}),lP({...V,apply:({elements:Ne,rects:K,availableWidth:me,availableHeight:Ae})=>{const{width:le,height:oe}=K.reference,re=Ne.floating.style;re.setProperty("--radix-popper-available-width",`${me}px`),re.setProperty("--radix-popper-available-height",`${Ae}px`),re.setProperty("--radix-popper-anchor-width",`${le}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),C&&uP({element:C,padding:o}),lJe({arrowWidth:R,arrowHeight:N}),h&&cP({strategy:"referenceHidden",...V})]}),[ne,W]=Zoe(U),Q=Cs(y);ti(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(De=$.arrow)==null?void 0:De.x,se=(Se=$.arrow)==null?void 0:Se.y,pe=((Ce=$.arrow)==null?void 0:Ce.centerOffset)!==0,[ce,Ie]=T.useState();return ti(()=>{x&&Ie(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...X,transform:H?X.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(qe=$.transformOrigin)==null?void 0:qe.x,(Qe=$.transformOrigin)==null?void 0:Qe.y].join(" "),...((Ve=$.hide)==null?void 0:Ve.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(sJe,{scope:n,placedSide:ne,onArrowChange:k,arrowX:ee,arrowY:se,shouldHideArrow:pe,children:f.jsx(af.div,{"data-side":ne,"data-align":W,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});Goe.displayName=_5;var Koe="PopperArrow",aJe={top:"bottom",right:"left",bottom:"top",left:"right"},Yoe=T.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=iJe(Koe,r),a=aJe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(nJe,{...s,ref:n,style:{...s.style,display:"block"}})})});Yoe.displayName=Koe;function oJe(e){return e!==null}var lJe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=Zoe(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function Zoe(e){const[t,n="center"]=e.split("-");return[t,n]}var cJe=Voe,Xoe=Hoe,uJe=Goe,dJe=Yoe,fJe="Portal",Joe=T.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=T.useState(!1);ti(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?pE.createPortal(f.jsx(af.div,{...r,ref:t}),a):null});Joe.displayName=fJe;var QT="Popover",[Qoe,ldt]=Wi(QT,[Uoe]),t_=Uoe(),[hJe,ep]=Qoe(QT),ele=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=e,o=t_(t),l=T.useRef(null),[c,u]=T.useState(!1),[d,h]=Ec({prop:r,defaultProp:s??!1,onChange:i,caller:QT});return f.jsx(cJe,{...o,children:f.jsx(hJe,{scope:t,contentId:ia(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:T.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:c,onCustomAnchorAdd:T.useCallback(()=>u(!0),[]),onCustomAnchorRemove:T.useCallback(()=>u(!1),[]),modal:a,children:n})})};ele.displayName=QT;var tle="PopoverAnchor",pJe=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=ep(tle,n),i=t_(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=s;return T.useEffect(()=>(a(),()=>o()),[a,o]),f.jsx(Xoe,{...i,...r,ref:t})});pJe.displayName=tle;var nle="PopoverTrigger",rle=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=ep(nle,n),i=t_(n),a=Rn(t,s.triggerRef),o=f.jsx(af.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":lle(s.open),...r,ref:a,onClick:Wt(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:f.jsx(Xoe,{asChild:!0,...i,children:o})});rle.displayName=nle;var S5="PopoverPortal",[mJe,gJe]=Qoe(S5,{forceMount:void 0}),sle=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=ep(S5,t);return f.jsx(mJe,{scope:t,forceMount:n,children:f.jsx(oa,{present:n||i.open,children:f.jsx(Joe,{asChild:!0,container:s,children:r})})})};sle.displayName=S5;var Ty="PopoverContent",ile=T.forwardRef((e,t)=>{const n=gJe(Ty,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=ep(Ty,e.__scopePopover);return f.jsx(oa,{present:r||i.open,children:i.modal?f.jsx(bJe,{...s,ref:t}):f.jsx(vJe,{...s,ref:t})})});ile.displayName=Ty;var yJe=_u("PopoverContent.RemoveScroll"),bJe=T.forwardRef((e,t)=>{const n=ep(Ty,e.__scopePopover),r=T.useRef(null),s=Rn(t,r),i=T.useRef(!1);return T.useEffect(()=>{const a=r.current;if(a)return GT(a)},[]),f.jsx(e_,{as:yJe,allowPinchZoom:!0,children:f.jsx(ale,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),i.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Wt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),vJe=T.forwardRef((e,t)=>{const n=ep(Ty,e.__scopePopover),r=T.useRef(!1),s=T.useRef(!1);return f.jsx(ale,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),ale=T.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=ep(Ty,n),m=t_(n);return WT(),f.jsx(Loe,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(Doe,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(uJe,{"data-state":lle(h.open),role:"dialog",id:h.contentId,...m,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ole="PopoverClose",xJe=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=ep(ole,n);return f.jsx(af.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});xJe.displayName=ole;var wJe="PopoverArrow",_Je=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=t_(n);return f.jsx(dJe,{...s,...r,ref:t})});_Je.displayName=wJe;function lle(e){return e?"open":"closed"}var SJe=ele,CJe=rle,kJe=sle,EJe=ile;function pl({...e}){return f.jsx(SJe,{"data-slot":"popover",...e})}function ml({...e}){return f.jsx(CJe,{"data-slot":"popover-trigger",...e})}function gl({className:e,align:t="center",sideOffset:n=4,...r}){return f.jsx(kJe,{children:f.jsx(EJe,{"data-slot":"popover-content",align:t,sideOffset:n,className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}function t0(e,t,n){let r=n.initialDeps??[],s;function i(){var a,o,l,c;let u;n.key&&((a=n.debug)!=null&&a.call(n))&&(u=Date.now());const d=e();if(!(d.length!==r.length||d.some((y,b)=>r[b]!==y)))return s;r=d;let m;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(m=Date.now()),s=t(...d),n.key&&((l=n.debug)!=null&&l.call(n))){const y=Math.round((Date.now()-u)*100)/100,b=Math.round((Date.now()-m)*100)/100,v=b/16,x=(w,S)=>{for(w=String(w);w.length<S;)w=" "+w;return w};console.info(`%c ${x(b,5)} /${x(y,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,n==null?void 0:n.key)}return(c=n==null?void 0:n.onChange)==null||c.call(n,s),s}return i.updateDeps=a=>{r=a},i}function m3(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const TJe=(e,t)=>Math.abs(e-t)<=1,AJe=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},BV=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},RJe=e=>e,NJe=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},MJe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=a=>{const{width:o,height:l}=a;t({width:Math.round(o),height:Math.round(l)})};if(s(BV(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){s({width:c.inlineSize,height:c.blockSize});return}}s(BV(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},$V={passive:!0},zV=typeof window>"u"?!0:"onscrollend"in window,IJe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&zV?()=>{}:AJe(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),a=u=>()=>{const{horizontal:d,isRtl:h}=e.options;s=d?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,u)},o=a(!0),l=a(!1);l(),n.addEventListener("scroll",o,$V);const c=e.options.useScrollendEvent&&zV;return c&&n.addEventListener("scrollend",l,$V),()=>{n.removeEventListener("scroll",o),c&&n.removeEventListener("scrollend",l)}},jJe=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},OJe=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const a=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:a,behavior:n})};class PJe{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const a=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:RJe,rangeExtractor:NJe,onChange:()=>{},measureElement:jJe,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=t0(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let a=r-1;a>=0;a--){const o=n[a];if(s.has(o.lane))continue;const l=i.get(o.lane);if(l==null||o.end>l.end?i.set(o.lane,o):o.end<l.end&&s.set(o.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=t0(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,s,i,a)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a}),{key:!1}),this.getMeasurements=t0(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<n;u++){const d=i(u),h=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),m=h?h.end+this.options.gap:r+s,y=o.get(d),b=typeof y=="number"?y:this.options.estimateSize(u),v=m+b,x=h?h.lane:u%this.options.lanes;c[u]={index:u,start:m,size:b,end:v,key:d,lane:x}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=t0(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?DJe({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=t0(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,a)=>i===null||a===null?[]:n({startIndex:i,endIndex:a,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const a=i.key,o=this.elementsCache.get(a);o!==n&&(o&&this.observer.unobserve(o),this.observer.observe(n),this.elementsCache.set(a,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,a=r-i;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,a,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=t0(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,a=n.length;i<a;i++){const o=n[i],l=r[o];s.push(l)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return m3(r[cle(0,r.length-1,s=>m3(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=n>=a+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const o=this.getTotalSize()-i;return Math.max(Math.min(o,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(s.end>=a+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const i=this.getOffsetForIndex(n,r);if(!i)return;const[a,o]=i;this._scrollToOffset(a,{adjustments:void 0,behavior:s}),s!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=m3(this.getOffsetForIndex(n,o)),u=this.getScrollOffset();TJe(c,u)||this.scrollToIndex(n,{align:o,behavior:s})}else this.scrollToIndex(n,{align:o,behavior:s})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&i.some(o=>o===null);){const o=r[a];i[o.lane]===null&&(i[o.lane]=o.end),a--}s=Math.max(...i.filter(o=>o!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const cle=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function DJe({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=l=>e[l].start;if(e.length<=r)return{startIndex:0,endIndex:s};let a=cle(0,s,i,n),o=a;if(r===1)for(;o<s&&e[o].end<n+t;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<s&&l.some(u=>u<n+t);){const u=e[o];l[u.lane]=u.end,o++}const c=Array(r).fill(n+t);for(;a>=0&&c.some(u=>u>=n);){const u=e[a];c[u.lane]=u.start,a--}a=Math.max(0,a-a%r),o=Math.min(s,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const UV=typeof document<"u"?T.useLayoutEffect:T.useEffect;function FJe(e){const t=T.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var a;i?rl.flushSync(t):t(),(a=e.onChange)==null||a.call(e,s,i)}},[r]=T.useState(()=>new PJe(n));return r.setOptions(n),UV(()=>r._didMount(),[]),UV(()=>r._willUpdate()),r}function C5(e){return FJe({observeElementRect:MJe,observeElementOffset:IJe,scrollToFn:OJe,...e})}const qV=e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?null:t/1e6},k5=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:s=!1,disabled:i=!1,listHeightClass:a="h-[26rem]",onModelClick:o})=>{const[l,c]=T.useState(null),u=T.useCallback(X=>{if(X){const U=X.querySelector("[data-radix-scroll-area-viewport]");if(U)c(U);else{const H=new MutationObserver(()=>{const $=X.querySelector("[data-radix-scroll-area-viewport]");$&&(c($),H.disconnect())});return H.observe(X,{childList:!0,subtree:!0}),()=>H.disconnect()}}else c(null)},[]),[d,h]=T.useState(""),[m,y]=T.useState(!1),[b,v]=T.useState("all"),[x,w]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),[S,C]=T.useState(""),[k,A]=T.useState(""),[R,N]=T.useState(""),[I,O]=T.useState(""),L=T.useMemo(()=>{let X=[...t];if(b==="enabled"?X=X.filter(ce=>n.has(ce.id)):b==="disabled"&&(X=X.filter(ce=>!n.has(ce.id))),d.trim()){const ce=d.toLowerCase();X=X.filter(Ie=>Ie.name.toLowerCase().includes(ce)||Ie.id.toLowerCase().includes(ce))}const U=Object.entries(x).filter(([,ce])=>ce).map(([ce])=>ce);U.length>0&&(X=X.filter(ce=>{var Se;const Ie=new Set(ce.supported_parameters??[]),De=new Set(((Se=ce.architecture)==null?void 0:Se.input_modalities)??[]);return U.every(Ce=>{switch(Ce){case"reasoning":return Ie.has("reasoning");case"webSearch":return Ie.has("web_search")||Ie.has("web_search_options");case"tools":return Ie.has("tools");case"multimodal":return Array.from(De).some(qe=>qe!=="text");default:return!0}})}));const H=parseFloat(S),$=parseFloat(k),ne=parseFloat(R),W=parseFloat(I),Q=!isNaN(H),ee=!isNaN($),se=!isNaN(ne),pe=!isNaN(W);return(Q||ee||se||pe)&&(X=X.filter(ce=>{var me,Ae;const Ie=qV((me=ce.pricing)==null?void 0:me.prompt),De=qV((Ae=ce.pricing)==null?void 0:Ae.completion),Se=Q?H/1e6:-1/0,Ce=ee?$/1e6:1/0,qe=se?ne/1e6:-1/0,Qe=pe?W/1e6:1/0,Ve=Ie!==null&&Ie>=Se&&Ie<=Ce,Ne=De!==null&&De>=qe&&De<=Qe;let K=!0;return(Q||ee)&&K&&(K=Ve),(se||pe)&&K&&(K=Ne),K})),X},[t,d,b,n,x,S,k,R,I]),P=C5({count:L.length,getScrollElement:()=>l,estimateSize:()=>40,overscan:10}),V=X=>{w(U=>({...U,[X]:!U[X]}))},F=(b!=="all"?1:0)+Object.values(x).filter(Boolean).length+(S||k||R||I?1:0);return s?f.jsxs("div",{className:Ze("space-y-2",a),children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):t.length===0?f.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):f.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{value:d,onChange:X=>h(X.target.value),placeholder:"Filter models by name...",className:"pl-8 h-9 w-full text-xs",type:"text",disabled:i})]}),f.jsxs(pl,{open:m,onOpenChange:y,children:[f.jsx(ml,{asChild:!0,children:f.jsxs(bt,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:i,children:[f.jsx(MO,{className:"h-4 w-4 mr-1"}),"Filters",F>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:F})]})}),f.jsxs(gl,{className:"w-72 p-4 space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{className:"text-xs font-semibold",children:"Status"}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx(bt,{variant:b==="all"?"secondary":"outline",size:"sm",onClick:()=>v("all"),children:"All"}),f.jsxs(bt,{variant:b==="enabled"?"secondary":"outline",size:"sm",onClick:()=>v("enabled"),children:[f.jsx(ro,{className:"h-3 w-3 mr-1"})," Enabled"]}),f.jsxs(bt,{variant:b==="disabled"?"secondary":"outline",size:"sm",onClick:()=>v("disabled"),children:[f.jsx(ape,{className:"h-3 w-3 mr-1"})," Disabled"]})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{className:"text-xs font-semibold",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsx(On,{tooltipText:"Reasoning","aria-label":"Reasoning",icon:f.jsx(Ph,{}),onClick:()=>V("reasoning"),variant:x.reasoning?"secondary":"outline",className:Ze(x.reasoning&&"text-primary")}),f.jsx(On,{tooltipText:"Web Search","aria-label":"Web Search",icon:f.jsx(Fa,{}),onClick:()=>V("webSearch"),variant:x.webSearch?"secondary":"outline",className:Ze(x.webSearch&&"text-primary")}),f.jsx(On,{tooltipText:"Tools","aria-label":"Tools",icon:f.jsx(om,{}),onClick:()=>V("tools"),variant:x.tools?"secondary":"outline",className:Ze(x.tools&&"text-primary")}),f.jsx(On,{tooltipText:"Multimodal","aria-label":"Multimodal",icon:f.jsx(im,{}),onClick:()=>V("multimodal"),variant:x.multimodal?"secondary":"outline",className:Ze(x.multimodal&&"text-primary")})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Dt,{className:"text-xs font-semibold flex items-center gap-1",children:[f.jsx(Wpe,{className:"h-3 w-3"})," Price Range ($ / 1M Tokens)"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(Cn,{type:"number",min:"0",step:"0.01",placeholder:"Min Input",value:S,onChange:X=>C(X.target.value),className:"h-8 text-xs"}),f.jsx(Cn,{type:"number",min:"0",step:"0.01",placeholder:"Max Input",value:k,onChange:X=>A(X.target.value),className:"h-8 text-xs"}),f.jsx(Cn,{type:"number",min:"0",step:"0.01",placeholder:"Min Output",value:R,onChange:X=>N(X.target.value),className:"h-8 text-xs"}),f.jsx(Cn,{type:"number",min:"0",step:"0.01",placeholder:"Max Output",value:I,onChange:X=>O(X.target.value),className:"h-8 text-xs"})]})]})]})]})]}),f.jsxs(Po,{className:Ze("w-full rounded-md border border-border p-1 bg-background/50 flex-grow",a),ref:u,children:[l&&f.jsx("div",{style:{height:`${P.getTotalSize()}px`,width:"100%",position:"relative"},children:L.length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match the current filters."}):P.getVirtualItems().map(X=>{const U=L[X.index];return U?f.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${X.size}px`,transform:`translateY(${X.start}px)`},className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[f.jsx(ol,{id:`enable-model-${e}-${U.id}`,checked:n.has(U.id),onCheckedChange:H=>r(U.id,H),disabled:i,"aria-label":`Enable model ${U.name||U.id}`,className:"flex-shrink-0",onClick:H=>H.stopPropagation()}),f.jsx(Dt,{htmlFor:`enable-model-${e}-${U.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate pl-2",title:U.name||U.id,onClick:o?()=>o(U.id):void 0,children:U.name||U.id})]},U.id):null})}),!l&&!s&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},LJe=({stepNumber:e,title:t,description:n,isComplete:r,isActive:s,openOnComplete:i=!1,contentClassName:a="",icon:o,children:l})=>{const[c,u]=T.useState(!1);return T.useEffect(()=>{u(s||r&&i)},[s,r,i]),f.jsxs(Vd,{className:`border border-border/40 bg-card/50 backdrop-blur-sm shadow-lg ${r?"border-l-4 border-l-green-500/70":s?"border-l-4 border-l-primary/70":""}`,children:[f.jsx(Wd,{className:"pb-2",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r?"bg-green-500/20 text-green-500":s?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:r?f.jsx(oE,{className:"h-5 w-5"}):f.jsx("div",{className:"flex items-center justify-center",children:o})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(!c),children:[f.jsxs(Hd,{className:"text-base",children:[f.jsxs("span",{className:"opacity-60 mr-2",children:[e,"."]}),t]}),f.jsx("button",{className:`p-1 rounded-full transition-all ${c?"rotate-90":""} hover:bg-muted/60`,children:f.jsx(RO,{className:"h-4 w-4"})})]}),!c&&f.jsx(Y1,{className:"text-xs mt-1",children:typeof n=="string"?n.substring(0,60)+(n.length>60?"...":""):"Click to expand"})]})]})}),f.jsx(hVe,{children:c&&f.jsx(iu.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:f.jsxs(Gd,{className:"pt-2",children:[typeof n=="string"?f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n}):f.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:n}),f.jsx("div",{className:a,children:l})]})})})]})},BJe=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:s,getAllAvailableModelDefsForProvider:i,isLoading:a,enableApiKeyManagement:o}=Rr(yn(se=>({apiKeys:se.dbApiKeys,addApiKey:se.addApiKey,providers:se.dbProviderConfigs,addProviderConfig:se.addProviderConfig,updateProviderConfig:se.updateProviderConfig,getAllAvailableModelDefsForProvider:se.getAllAvailableModelDefsForProvider,isLoading:se.isLoading,enableApiKeyManagement:se.enableApiKeyManagement}))),{addConversation:l,selectItem:c}=qn(yn(se=>({addConversation:se.addConversation,selectItem:se.selectItem}))),[u,d]=T.useState(!1),[h,m]=T.useState(!1),[y,b]=T.useState(!1),[v,x]=T.useState(!1),[w,S]=T.useState(!1),C=T.useMemo(()=>!o||e.length>0,[o,e]),k=T.useMemo(()=>n.length>0,[n]),A=T.useMemo(()=>n.some(se=>se.isEnabled&&se.enabledModels&&se.enabledModels.length>0),[n]),R=T.useMemo(()=>{const se=[...n].sort((pe,ce)=>ce.createdAt.getTime()-pe.createdAt.getTime());return se.length>0?se[0]:null},[n]),N=T.useMemo(()=>R?i(R.id):[],[R,i]),I=T.useMemo(()=>new Set((R==null?void 0:R.enabledModels)??[]),[R]),{initialProviderTypeForForm:O,initialProviderNameForForm:L,initialApiKeyIdForForm:P}=T.useMemo(()=>{var se;if(k)return{type:void 0,name:void 0,keyId:void 0};if(e.length>0){const ce=[...e].sort((Ie,De)=>De.createdAt.getTime()-Ie.createdAt.getTime()).find(Ie=>K0(Ie.providerId));if(ce){const Ie=ce.providerId,De=((se=xo.find(Se=>Se.value===Ie))==null?void 0:se.label)||Ie;return{initialProviderTypeForForm:Ie,initialProviderNameForForm:De,initialApiKeyIdForForm:ce.id}}}return{initialProviderTypeForForm:void 0,initialProviderNameForForm:void 0,initialApiKeyIdForForm:void 0}},[e,k]),V=T.useCallback(async(se,pe,ce)=>{d(!0);try{await t(se,pe,ce),Oe.success("API key added successfully!")}finally{d(!1)}},[t]),F=T.useCallback(async se=>{m(!0);try{const pe={...se,apiKeyId:se.apiKeyId??(K0(se.type)?P??null:null)},ce=await r(pe);return Oe.success("Provider added successfully!"),ce}finally{m(!1)}},[r,P]),X=T.useCallback(async(se,pe)=>{if(!R)return;x(!0);const ce=new Set(R.enabledModels??[]);pe?ce.add(se):ce.delete(se);const Ie=Array.from(ce);try{await s(R.id,{enabledModels:Ie}),Oe.success(pe?"Model enabled successfully!":"Model disabled successfully!")}catch(De){Oe.error("Failed to update model status."),console.error("Failed to save model toggle:",De)}finally{x(!1)}},[R,s]),U=T.useCallback(async()=>{b(!0),S(!0);try{await new Promise(pe=>setTimeout(pe,800));const se=await l({title:"New Chat"});await c(se,"conversation"),Oe.success("Welcome to your first chat!")}catch(se){Oe.error("Failed to start your first chat."),console.error("Failed to start first chat:",se),b(!1),S(!1)}},[l,c]),H=()=>{je.emit(jr.openModalRequest,{modalId:"settingsModal",initialTab:"providers"})},$=[C,k,A].filter(Boolean).length,ne=o?3:2,W=$/ne*100,Q=[...o?[{id:"api-key",title:"Add API Key",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["To use providers like"," ",f.jsx(xd,{href:"https://platform.openai.com/api-keys",className:"text-blue-500 hover:text-blue-700 transition-colors",children:"OpenAI"}),","," ",f.jsx(xd,{href:"https://aistudio.google.com/app/apikey",className:"text-green-600 hover:text-green-700 transition-colors",children:"Google"}),","," ",f.jsx(xd,{href:"https://console.anthropic.com/settings/keys",className:"text-purple-500 hover:text-purple-700 transition-colors",children:"Anthropic (Claude)"}),", or"," ",f.jsx(xd,{href:"https://openrouter.ai/keys",className:"text-orange-500 hover:text-orange-700 transition-colors",children:"OpenRouter"})," ","or any OpenAI API compatible provider, add an API key. Keys are stored securely in your browser."]}),f.jsxs("p",{children:['If you want truly local AI, "no internet required", you can setup'," ",f.jsx(xd,{href:"https://www.ollama.com/",className:"text-teal-500 hover:text-teal-700 transition-colors",children:"Ollama"})," ","or,"," ",f.jsx(xd,{href:"https://lmstudio.ai/",className:"text-indigo-500 hover:text-indigo-700 transition-colors",children:"LMStudio"})," ","(or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys so see you in step 2."]})]}),isComplete:C,content:f.jsx(woe,{onSave:V,onCancel:()=>{},disabled:u,className:"border-none shadow-none p-0",initialProviderType:O}),icon:f.jsx(Dx,{className:"h-4 w-4"})}]:[],{id:"add-provider",title:"Add AI Provider",description:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{children:"Connect to an AI provider you configured the key for..."}),f.jsx("p",{children:"This might look redundant, but it allows you to have multiple keys for the same provider (personal, professional, etc.)"})]}),isComplete:k,content:f.jsx(Roe,{apiKeys:e,onAddProvider:F,onCancel:()=>{},initialType:O,initialName:L,initialApiKeyId:P}),icon:f.jsx(q0,{className:"h-4 w-4"})},{id:"enable-models",title:"Enable Models",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["Enable models for the provider you just added (",f.jsx("span",{className:"font-medium text-primary",children:(R==null?void 0:R.name)||"..."}),")."]}),f.jsx("p",{children:"Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."}),f.jsx("p",{children:"And just like before, you can choose to activate a model for a certain combination of key/provider!"})]}),isComplete:A,content:R?f.jsx("div",{className:"bg-card/40 rounded-lg p-3 border border-border/30 shadow-inner",children:f.jsx(k5,{providerId:R.id,allAvailableModels:N,enabledModelIds:I,onToggleModel:X,isLoading:a||v,listHeightClass:"h-[26rem]"})}):f.jsxs("p",{className:"text-sm text-muted-foreground italic flex items-center",children:[f.jsx(_c,{className:"h-4 w-4 mr-2 text-amber-500"}),"Add a provider in Step ",o?"2":"1"," first."]}),icon:f.jsx(Ph,{className:"h-4 w-4"})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:f.jsxs("div",{children:[w&&f.jsx(iu.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-4",children:f.jsx(Ey,{value:y?void 0:100,className:"h-2"})}),f.jsxs(bt,{onClick:U,disabled:y||!A,className:"w-full bg-gradient-to-r from-indigo-500 to-primary hover:opacity-90 transition-all",children:[f.jsx(Bme,{className:"mr-2 h-4 w-4"}),y?"Launching...":"Start First Chat"]}),f.jsx(Use,{})]}),contentClassName:"p-4",icon:f.jsx(age,{className:"h-4 w-4"})}],ee=Q.findIndex(se=>!se.isComplete);return a?f.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-4xl mx-auto w-full",children:f.jsxs(iu.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:[f.jsx(Wr,{className:"h-12 w-1/2 mx-auto mb-6"}),f.jsx(Wr,{className:"h-8 w-3/4 mx-auto mb-2"}),f.jsx(Wr,{className:"h-4 w-1/2 mx-auto mb-8"}),f.jsx(Wr,{className:"h-20 w-full mb-6"}),f.jsx(Wr,{className:"h-20 w-full mb-6"}),f.jsx(Wr,{className:"h-20 w-full"})]})}):f.jsx("div",{className:"flex h-full flex-col items-center justify-start p-4 bg-gradient-to-b from-background to-background/80",children:f.jsxs("div",{className:"w-full max-w-4xl space-y-6 pt-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx(iu.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:f.jsxs("div",{className:"relative mx-auto w-16 h-16 mb-4",children:[f.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl"}),f.jsx("div",{className:"relative bg-gradient-to-br from-primary to-indigo-600 p-3 rounded-full",children:f.jsx(RXe,{className:"h-10 w-10 text-white"})})]})}),f.jsx("h2",{className:"text-3xl font-bold mb-3 bg-gradient-to-r from-primary to-indigo-500 bg-clip-text text-transparent",children:"Welcome to LiteChat"}),f.jsx(MXe,{})]}),f.jsxs(iu.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("div",{className:"mt-6 bg-card/40 backdrop-blur-sm border border-border/30 rounded-xl p-3 w-3/4 mx-auto",children:[f.jsx(Ey,{value:W,className:"h-1.5"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Setup Progress: ",Math.round(W),"%"]})]})}),f.jsx(Sr,{children:f.jsxs("p",{children:["Steps completed: ",$," of ",ne]})})]})}),Q.map((se,pe)=>{const ce=pe===ee;return f.jsx(iu.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:pe*.1,duration:.3},children:f.jsx(LJe,{stepNumber:pe+1,title:se.title,description:se.description,isComplete:se.id!=="start-chat"&&se.isComplete,isActive:ce,openOnComplete:se.id==="enable-models",contentClassName:se.id==="add-provider"||se.id==="api-key"?"p-0 border-none shadow-none bg-transparent":se.contentClassName,icon:se.icon,children:se.content})},se.id)})]}),!a&&!k&&ee===-1&&f.jsxs(iu.div,{className:"text-center mt-6 p-4 bg-red-500/10 rounded-lg border border-red-500/30",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[f.jsx(_c,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),f.jsx("p",{className:"text-sm mb-3",children:"Configuration issue detected. Please review provider settings."}),f.jsx(bt,{variant:"outline",size:"sm",onClick:H,className:"border-red-500/50 hover:bg-red-500/20 transition-colors",children:"Open Provider Settings"})]})]})})},p2=["conversation.title_generation"],$Je=({conversationId:e,interactions:t,status:n,className:r})=>{const s=T.useRef(null),i=T.useRef(null),[a,o]=T.useState(!1),l=T.useRef(null),c=Bn(F=>F.streamingInteractionIds),{chatMaxWidth:u,autoScrollInterval:d,enableAutoScrollOnStream:h}=yr(yn(F=>({chatMaxWidth:F.chatMaxWidth,autoScrollInterval:F.autoScrollInterval,enableAutoScrollOnStream:F.enableAutoScrollOnStream}))),m=yr(F=>F.setEnableAutoScrollOnStream),y=T.useMemo(()=>F=>({isLoading:F.isLoading}),[]),b=T.useMemo(()=>F=>({conversationCount:F.conversations.length,isConversationLoading:F.isLoading}),[]),{isLoading:v}=Rr(yn(y)),{conversationCount:x,isConversationLoading:w}=qn(yn(b)),{projectCount:S,isProjectLoading:C}=Oo(yn(F=>({projectCount:F.projects.length,isProjectLoading:F.isLoading}))),k=T.useMemo(()=>v||w||C?!1:x===0&&S===0,[x,S,v,w,C]),A=T.useMemo(()=>t.filter(U=>U.parentId===null&&!p2.includes(U.type)).sort((U,H)=>U.index-H.index).map(U=>{const H=t.filter($=>$.parentId===U.id&&!p2.includes($.type)).sort(($,ne)=>$.index-ne.index);return[U,...H]}),[t]),R=No(yn(F=>Object.values(F.canvasControls))),N=T.useCallback((F,X,U,H)=>R.filter(ne=>{const W=ne.type===F,Q=ne.targetSlot===X,ee=!!ne.renderer;return W&&Q&&ee}).map(ne=>{if(ne.renderer){const Q={...{interaction:U,interactionId:U==null?void 0:U.id,responseContent:typeof(U==null?void 0:U.response)=="string"?U.response:void 0,canvasContextType:F},...H};return f.jsx(We.Fragment,{children:ne.renderer(Q)},ne.id)}return null}).filter(Boolean),[R]),I=(F="smooth")=>{i.current&&i.current.scrollTo({top:i.current.scrollHeight,behavior:F})};T.useEffect(()=>{if(i.current){const{scrollHeight:F,clientHeight:X,scrollTop:U}=i.current;(F-X<=U+150||n!=="streaming")&&requestAnimationFrame(()=>{I(n==="streaming"?"smooth":"auto")})}},[A.length,n]),T.useEffect(()=>(n==="streaming"&&h?(l.current&&clearInterval(l.current),l.current=setInterval(()=>{I("smooth")},d)):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[n,d,h]),T.useEffect(()=>{const F=i.current;if(!F)return;const X=()=>{if(!i.current)return;const{scrollHeight:U,clientHeight:H,scrollTop:$}=i.current,ne=$<U-H-H*.5;o(ne)};return F.addEventListener("scroll",X,{passive:!0}),X(),()=>{i.current&&i.current.removeEventListener("scroll",X)}},[]),T.useEffect(()=>{s.current&&(i.current=s.current.querySelector("[data-radix-scroll-area-viewport]"))},[]);const O=T.useMemo(()=>{const F=[];return[...t].sort((H,$)=>{var ne,W;return H.index!==$.index?H.index-$.index:H.parentId===null&&$.parentId!==null?-1:H.parentId!==null&&$.parentId===null?1:H.parentId!==null&&$.parentId!==null&&H.parentId===$.parentId?H.index-$.index:(((ne=H.startedAt)==null?void 0:ne.getTime())??0)-(((W=$.startedAt)==null?void 0:W.getTime())??0)}).filter(H=>H.parentId===null&&!p2.includes(H.type)).forEach(H=>{var Q,ee;let $=null;if(H.type==="message.user_assistant"&&H.prompt)$=H.prompt;else if(H.type==="message.assistant_regen"&&((Q=H.metadata)!=null&&Q.regeneratedFromId)){let se,pe=H;const ce=new Set;for(;pe&&!ce.has(pe.id);){if(ce.add(pe.id),pe.type==="message.user_assistant"&&pe.prompt){se=pe;break}if((ee=pe.metadata)!=null&&ee.regeneratedFromId)pe=t.find(Ie=>Ie.id===pe.metadata.regeneratedFromId);else break}se?$=se.prompt:H.prompt?$=H.prompt:console.warn(`[ChatCanvas] Could not reliably find user prompt for active interaction ${H.id} of type ${H.type}. Displaying turn without prompt.`)}if($)F.push(f.jsx(OT,{turnData:$,timestamp:H.startedAt,isAssistantComplete:H.status==="COMPLETED"||H.status==="ERROR"},`prompt-${H.id}`));else if(H.type!=="message.user_assistant"&&H.type!=="message.assistant_regen"){console.log("[ChatCanvas] Skipping active interaction on spine due to no user prompt and non-standard type:",H.id,H.type);return}const ne=t.filter(se=>se.parentId===H.id&&!p2.includes(se.type)).sort((se,pe)=>se.index-pe.index),W=[H,...ne];W.length>0&&F.push(f.jsx(qqe,{interactionGroup:W,renderSlot:(se,pe,ce)=>N("interaction",se,pe,ce),activeStreamingInteractionId:c.find(se=>W.some(pe=>pe.id===se))},`tabs-${H.id}`))}),F},[t,N,c]),L=T.useMemo(()=>c.filter(F=>!t.some(X=>X.id===F)).map(F=>f.jsx($k,{interactionId:F,renderSlot:(X,U,H)=>N("interaction",X,U,H)},`${F}-streaming-new`)),[c,t,N]),P=()=>v||w||C?f.jsxs("div",{className:"space-y-4 p-2 md:p-4",children:[f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-32 w-full"}),f.jsx(Wr,{className:"h-20 w-full"})]}):e?A.length===0&&n!=="streaming"&&c.length===0?f.jsx(YU,{}):f.jsxs("div",{className:"space-y-4 p-2 md:p-4 break-words",children:[O,L]}):f.jsx(YU,{}),V=u||"max-w-7xl";return f.jsx("div",{className:Ze("flex-grow relative",r),children:k?f.jsx(Po,{className:"h-full w-full",children:f.jsx("div",{className:Ze("mx-auto w-full",V),children:f.jsx(BJe,{})})}):f.jsxs(f.Fragment,{children:[f.jsx(Po,{className:"h-full w-full",ref:s,children:f.jsx("div",{className:Ze("mx-auto w-full",V),children:P()})}),a&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>I(),"aria-label":"Scroll to bottom",children:f.jsx(sH,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"left",children:"Scroll to Bottom"})]})}),n==="streaming"&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"outline",size:"icon",className:"absolute bottom-4 right-14 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>m(!h),"aria-label":h?"Disable follow stream":"Enable follow stream",children:h?f.jsx(Jme,{className:"h-4 w-4"}):f.jsx(tge,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"left",children:h?"Stop Following Stream":"Follow Stream"})]})})]})})},zJe=We.memo($Je),n0=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const s=e.filter(i=>(i.panel??"main")===t&&(i.show?i.show():!0));return s.length===0?null:f.jsx("div",{className:Ze(r),children:s.map(i=>{const a=n==="icon"?i.iconRenderer:i.renderer;return f.jsx(We.Fragment,{children:a?a():null},i.id)})})},Yw=Fo(Lo((e,t)=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,toggleChatControlPanel:(n,r)=>{const s=t().isChatControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isChatControlPanelOpen[n]=i}),je.emit(jr.chatControlPanelVisibilityChanged,{panelId:n,isOpen:i}))},togglePromptControlPanel:(n,r)=>{const s=t().isPromptControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isPromptControlPanelOpen[n]=i}),je.emit(jr.promptControlPanelVisibilityChanged,{controlId:n,isOpen:i}))},toggleSidebar:n=>{const r=t().isSidebarCollapsed,s=n??!r;r!==s&&(e({isSidebarCollapsed:s}),je.emit(jr.sidebarVisibilityChanged,{isCollapsed:s}))},setGlobalLoading:n=>{t().globalLoading!==n&&(e({globalLoading:n}),je.emit(jr.globalLoadingChanged,{loading:n}))},setGlobalError:n=>{t().globalError!==n&&(e({globalError:n}),je.emit(jr.globalErrorChanged,{error:n}))},setFocusInputFlag:n=>{t().focusInputOnNextRender!==n&&(e({focusInputOnNextRender:n}),je.emit(jr.focusInputFlagChanged,{focus:n}))},getRegisteredActionHandlers:()=>{const n="uiStateStore",r=t();return[{eventName:jr.toggleSidebarRequest,handler:s=>r.toggleSidebar(s==null?void 0:s.isCollapsed),storeId:n},{eventName:jr.toggleChatControlPanelRequest,handler:s=>r.toggleChatControlPanel(s.panelId,s.isOpen),storeId:n},{eventName:jr.togglePromptControlPanelRequest,handler:s=>r.togglePromptControlPanel(s.controlId,s.isOpen),storeId:n},{eventName:jr.setGlobalLoadingRequest,handler:s=>r.setGlobalLoading(s.loading),storeId:n},{eventName:jr.setGlobalErrorRequest,handler:s=>r.setGlobalError(s.error),storeId:n},{eventName:jr.setFocusInputFlagRequest,handler:s=>r.setFocusInputFlag(s.focus),storeId:n}]}})));var UJe=(e,t,n,r,s,i,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(m){(Array.isArray(e)?e:[e]).forEach(y=>{let b=y==="class",v=b&&i?s.map(x=>i[x]||x):s;b?(l.classList.remove(...v),l.classList.add(i&&i[m]?i[m]:m)):l.setAttribute(y,m)}),d(m)}function d(m){o&&c.includes(m)&&(l.style.colorScheme=m)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let m=localStorage.getItem(t)||n,y=a&&m==="system"?h():m;u(y)}catch{}},qJe=T.createContext(void 0),VJe={setTheme:e=>{},themes:[]},WJe=()=>{var e;return(e=T.useContext(qJe))!=null?e:VJe};T.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,t,i,e,o,a,r,s]).slice(1,-1);return T.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${UJe.toString()})(${u})`}})});const HJe=({...e})=>{const{theme:t="system"}=WJe();return f.jsx(D0e,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function Do({className:e,...t}){return f.jsx("textarea",{"data-slot":"textarea",className:Ze("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const ule=T.memo(T.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:s,onValueChange:i,...a},o)=>{const l=T.useRef(null),[c,u]=T.useState(e);T.useImperativeHandle(o,()=>({getValue:()=>c,setValue:m=>{u(m),i&&i(m),je.emit(Fn.inputChanged,{value:m}),requestAnimationFrame(()=>{const y=l.current;y&&(y.style.height="auto",y.style.height=`${y.scrollHeight}px`,y.style.overflowY=y.scrollHeight>250?"auto":"hidden")})},focus:()=>{var m;return(m=l.current)==null?void 0:m.focus()},clearValue:()=>{u(""),i&&i(""),je.emit(Fn.inputChanged,{value:""}),requestAnimationFrame(()=>{const m=l.current;m&&(m.style.height="auto",m.style.height=`${m.scrollHeight}px`,m.style.overflowY="hidden")})}}));const d=m=>{var y;if(m.key==="Enter"&&!m.shiftKey&&!n){m.preventDefault();const b=hh.getState().attachedFilesMetadata.length>0;(c.trim().length>0||b)&&(t(),(y=o==null?void 0:o.current)==null||y.clearValue())}},h=m=>{const y=m.target.value;u(y),i&&i(y),je.emit(Fn.inputChanged,{value:y})};return T.useEffect(()=>{const m=l.current;if(m){m.style.height="auto";const y=m.scrollHeight,b=250;m.style.height=`${Math.min(y,b)}px`,m.style.overflowY=y>b?"auto":"hidden"}},[c]),T.useEffect(()=>{e!==c&&(u(e),i&&i(e))},[e,i]),T.useEffect(()=>{const m=y=>{u(y.text),i&&i(y.text),je.emit(Fn.inputChanged,{value:y.text}),requestAnimationFrame(()=>{const b=l.current;b&&(b.style.height="auto",b.style.height=`${b.scrollHeight}px`,b.style.overflowY=b.scrollHeight>250?"auto":"hidden")})};return je.on(Fn.setInputTextRequest,m),()=>{je.off(Fn.setInputTextRequest,m)}},[i]),f.jsx(Do,{ref:l,value:c,onChange:h,onKeyDown:d,disabled:n,placeholder:r,rows:1,className:Ze("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",s),"aria-label":"Chat input",...a})}));ule.displayName="InputArea";const ki={dbModsLoaded:"mod.db.mods.loaded",loadedInstancesChanged:"mod.loaded.instances.changed",settingsTabsChanged:"mod.settings.tabs.changed",loadingStateChanged:"mod.loading.state.changed",modLoaded:"mod.sdk.loaded",modError:"mod.sdk.error",loadDbModsRequest:"mod.load.db.mods.request",addDbModRequest:"mod.add.db.mod.request",updateDbModRequest:"mod.update.db.mod.request",deleteDbModRequest:"mod.delete.db.mod.request"},jh=Fo(Lo((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await Et.loadMods();e({dbMods:n,isLoading:!1}),je.emit(ki.dbModsLoaded,{dbMods:n})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),je.emit(ki.loadingStateChanged,{isLoading:!1,error:r}),Oe.error(r)}},addDbMod:async n=>{const r=qi(),s={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(i=>{i.dbMods.push(s),i.dbMods.sort((a,o)=>a.loadOrder-o.loadOrder)});try{return await Et.saveMod(s),Oe.success(`Mod "${s.name}" added.`),je.emit(ki.dbModsLoaded,{dbMods:t().dbMods}),r}catch(i){const a="Failed to save new mod";throw console.error("ModStore: Error adding mod",i),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=a}),je.emit(ki.loadingStateChanged,{isLoading:t().isLoading,error:a}),Oe.error(a),i}},updateDbMod:async(n,r)=>{let s,i=-1;e(o=>{i=o.dbMods.findIndex(l=>l.id===n),i!==-1?(s={...o.dbMods[i]},o.dbMods[i]={...o.dbMods[i],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const a=i!==-1?t().dbMods[i]:void 0;if(a)try{await Et.saveMod(a),Oe.success(`Mod "${a.name}" updated.`),je.emit(ki.dbModsLoaded,{dbMods:t().dbMods})}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(c=>{const u=c.dbMods.findIndex(d=>d.id===n);u!==-1&&s&&(c.dbMods[u]=s,c.dbMods.sort((d,h)=>d.loadOrder-h.loadOrder)),c.error=l}),je.emit(ki.loadingStateChanged,{isLoading:t().isLoading,error:l}),Oe.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(i=>i.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const s=r.name;e(i=>({dbMods:i.dbMods.filter(a=>a.id!==n)}));try{await Et.deleteMod(n),Oe.success(`Mod "${s}" deleted.`),je.emit(ki.dbModsLoaded,{dbMods:t().dbMods})}catch(i){const a="Failed to delete mod";throw console.error("ModStore: Error deleting mod",i),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder),o.error=a}),je.emit(ki.loadingStateChanged,{isLoading:t().isLoading,error:a}),Oe.error(a),i}},setLoadedMods:n=>{e({loadedMods:n}),je.emit(ki.loadedInstancesChanged,{loadedMods:n})},_addSettingsTab:n=>{e(r=>{if(!r.modSettingsTabs.some(s=>s.id===n.id))r.modSettingsTabs.push(n),r.modSettingsTabs.sort((s,i)=>(s.order??999)-(i.order??999));else{console.warn(`ModStore: Settings tab with ID "${n.id}" already registered. Overwriting.`);const s=r.modSettingsTabs.findIndex(i=>i.id===n.id);r.modSettingsTabs[s]=n,r.modSettingsTabs.sort((i,a)=>(i.order??999)-(a.order??999))}}),je.emit(ki.settingsTabsChanged,{tabs:t().modSettingsTabs})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(s=>s.id!==n)}),je.emit(ki.settingsTabsChanged,{tabs:t().modSettingsTabs})},getRegisteredActionHandlers:()=>{const n="modStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:ki.loadDbModsRequest,handler:r.loadDbMods,storeId:n},{eventName:ki.addDbModRequest,handler:s(r.addDbMod),storeId:n},{eventName:ki.updateDbModRequest,handler:i=>r.updateDbMod(i.id,i.changes),storeId:n},{eventName:ki.deleteDbModRequest,handler:i=>r.deleteDbMod(i.id),storeId:n}]}}))),tp={loaded:"app.loaded",errorBoundaryTriggered:"app.error.boundary.triggered",initializationPhaseCompleted:"app.initialization.phase.completed"};function hO(e){const t=e.id,n=e.name;return{modId:t,modName:n,registerPromptControl:s=>(je.emit($r.registerPromptControlRequest,{control:s}),()=>je.emit($r.unregisterPromptControlRequest,{id:s.id})),registerChatControl:s=>{const i={...s,status:s.status??(()=>"ready")};return je.emit($r.registerChatControlRequest,{control:i}),()=>je.emit($r.unregisterChatControlRequest,{id:s.id})},registerCanvasControl:s=>(je.emit($r.registerCanvasControlRequest,{control:s}),()=>je.emit($r.unregisterCanvasControlRequest,{id:s.id})),registerTool:(s,i,a)=>(console.log(`[${n}] Registering tool: ${s}`),je.emit($r.registerToolRequest,{modId:t,toolName:s,definition:i,implementation:a}),()=>je.emit($r.unregisterToolRequest,{toolName:s})),on:(s,i)=>(je.on(s,i),()=>je.off(s,i)),emit:(s,i)=>{je.emit(s,i)},addMiddleware:(s,i)=>(je.emit($r.registerMiddlewareRequest,{hookName:s,modId:t,callback:i}),()=>je.emit($r.unregisterMiddlewareRequest,{hookName:s,modId:t,callback:i})),registerSettingsTab:s=>(jh.getState()._addSettingsTab(s),()=>jh.getState()._removeSettingsTab(s.id)),getContextSnapshot:()=>{const s=Bn.getState(),i=qn.getState(),a=yr.getState(),o=Rr.getState(),{providerId:l}=yc(o.selectedModelId),c=i.selectedItemType==="conversation"?i.selectedItemId:null;return Object.freeze({selectedConversationId:c,interactions:Object.freeze(s.currentConversationId===c?s.interactions.map(u=>Object.freeze({...u})):[]),isStreaming:s.status==="streaming",selectedProviderId:l,selectedModelId:o.selectedModelId,activeSystemPrompt:a.globalSystemPrompt,temperature:a.temperature,maxTokens:a.maxTokens,theme:a.theme,gitUserName:a.gitUserName,gitUserEmail:a.gitUserEmail})},showToast:(s,i)=>{Oe[s](`[Mod: ${n}] ${i}`)},log:(s,...i)=>{console[s](`[Mod: ${n}]`,...i)},registerModalProvider:(s,i)=>(je.emit($r.registerModalProviderRequest,{modalId:s,provider:i}),()=>je.emit($r.unregisterModalProviderRequest,{modalId:s})),getVfsInstance:async s=>Xs.getState().initializeVFS(s,{force:!0})}}async function GJe(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let s=r.scriptContent,i=null,a=null;try{if(i=hO(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const c=await fetch(r.sourceUrl);if(!c.ok)throw new Error(`Failed to fetch mod script: ${c.status} ${c.statusText}`);s=await c.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(c){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,c),c}}if(!s)throw new Error("Mod script content is empty.");new Function("modApi",s)(i),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){a=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),Oe.error(`Error loading mod "${r.name}": ${a instanceof Error?a.message:a}`)}i||(i=hO(r));const o={id:r.id,name:r.name,api:i,error:a};return je.emit(o.error?ki.modError:ki.modLoaded,{id:r.id,name:r.name,error:o.error??"unknown error"}),o}));return je.emit(tp.loaded,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}const gr={dataLoaded:"rules.data.loaded",ruleSaved:"rules.rule.saved",ruleDeleted:"rules.rule.deleted",tagSaved:"rules.tag.saved",tagDeleted:"rules.tag.deleted",linkSaved:"rules.link.saved",linkDeleted:"rules.link.deleted",loadingStateChanged:"rules.loading.state.changed",loadRulesAndTagsRequest:"rules.load.rules.and.tags.request",addRuleRequest:"rules.add.rule.request",updateRuleRequest:"rules.update.rule.request",deleteRuleRequest:"rules.delete.rule.request",addTagRequest:"rules.add.tag.request",updateTagRequest:"rules.update.tag.request",deleteTagRequest:"rules.delete.tag.request",linkTagToRuleRequest:"rules.link.tag.to.rule.request",unlinkTagFromRuleRequest:"rules.unlink.tag.from.rule.request"},VV=null;class KJe{static async applyBundledConfig(t){{console.log("[BundledConfig] No bundled user configuration found, skipping...");return}}static hasBundledConfig(){return VV!==null}static getBundledConfig(){return VV}}class Zw{static async syncAll(t={}){const n={syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3,...t};if(this.isRunning){Oe.warning("Bulk sync already in progress");return}this.isRunning=!0,this.abortController=new AbortController;const r=qn.getState(),s=r.syncRepos,i=r.conversations.filter(o=>o.syncRepoId),a={totalRepos:n.syncRepos?s.length:0,completedRepos:0,totalConversations:n.syncConversations?i.length:0,completedConversations:0,currentOperation:"Starting bulk sync...",errors:[]};try{je.emit(cs.bulkSyncStarted,{progress:a}),Oe.info(`Starting bulk sync: ${s.length} repositories, ${i.length} conversations`),n.syncRepos&&s.length>0&&await this.syncRepositoriesInBatches(s,n,a),n.syncConversations&&i.length>0&&await this.syncConversationsInBatches(i,n,a);const o=a.errors.length>0;je.emit(cs.bulkSyncCompleted,{progress:a,success:!o}),o?(Oe.warning(`Bulk sync completed with ${a.errors.length} errors. Check console for details.`),console.warn("Bulk sync errors:",a.errors)):Oe.success("Bulk sync completed successfully!")}catch(o){console.error("Bulk sync failed:",o),Oe.error(`Bulk sync failed: ${o instanceof Error?o.message:"Unknown error"}`),je.emit(cs.bulkSyncFailed,{progress:a,error:String(o)})}finally{this.isRunning=!1,this.abortController=null}}static async syncPendingConversations(){const t=qn.getState(),n=t.conversations.filter(r=>{const s=t.conversationSyncStatus[r.id];return r.syncRepoId&&s==="needs-sync"});if(n.length===0){Oe.info("No conversations need syncing");return}Oe.info(`Syncing ${n.length} pending conversations...`),await this.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:2})}static async initializeAllRepositories(){const n=qn.getState().syncRepos;if(n.length===0){Oe.info("No repositories configured");return}Oe.info(`Initializing ${n.length} repositories...`),await this.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:2})}static abort(){this.isRunning&&this.abortController&&(this.abortController.abort(),Oe.info("Bulk sync operation cancelled"))}static isActive(){return this.isRunning}static async syncRepositoriesInBatches(t,n,r){var i;r.currentOperation="Initializing repositories...",je.emit(cs.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing repository: ${l.name}`,je.emit(cs.bulkSyncProgress,{progress:r}),await qn.getState().initializeOrSyncRepo(l.id,!0),r.completedRepos++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"repo",id:l.id,error:u}),console.error(`Failed to sync repository ${l.name}:`,c),!n.continueOnError)throw c}});await Promise.all(o),je.emit(cs.bulkSyncProgress,{progress:r})}}static async syncConversationsInBatches(t,n,r){var i;r.currentOperation="Syncing conversations...",je.emit(cs.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing conversation: ${l.title}`,je.emit(cs.bulkSyncProgress,{progress:r}),await qn.getState().syncConversation(l.id,!0),r.completedConversations++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"conversation",id:l.id,error:u}),console.error(`Failed to sync conversation ${l.title}:`,c),!n.continueOnError)throw c}});await Promise.all(o),je.emit(cs.bulkSyncProgress,{progress:r})}}static createBatches(t,n){const r=[];for(let s=0;s<t.length;s+=n)r.push(t.slice(s,s+n));return r}}ve(Zw,"isRunning",!1),ve(Zw,"abortController",null);const j0=Object.freeze(Object.defineProperty({__proto__:null,BulkSyncService:Zw},Symbol.toStringTag,{value:"Module"}));class dle{static async runStartupSync(){if(!this.hasRunStartupSync){this.hasRunStartupSync=!0;try{const t=qn.getState(),n=yr.getState();await new Promise(o=>setTimeout(o,1e3));const r=t.syncRepos,s=t.conversations.filter(o=>o.syncRepoId);if(r.length===0){console.log("[StartupSync] No repositories configured, skipping startup sync");return}console.log(`[StartupSync] Found ${r.length} repositories and ${s.length} synced conversations`);const i=r.filter(o=>{const l=t.repoInitializationStatus[o.id];return!l||l==="error"});i.length>0&&n.autoInitializeReposOnStartup?(console.log(`[StartupSync] Initializing ${i.length} repositories in background`),setTimeout(async()=>{try{await Zw.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:1})}catch(o){console.warn("[StartupSync] Background repo initialization failed:",o)}},2e3)):i.length>0&&console.log(`[StartupSync] Found ${i.length} uninitialized repositories, but auto-initialization is disabled`);const a=s.filter(o=>t.conversationSyncStatus[o.id]==="needs-sync");a.length>0&&n.autoSyncOnStreamComplete&&(console.log(`[StartupSync] Found ${a.length} conversations pending sync`),setTimeout(async()=>{try{await Zw.syncPendingConversations()}catch(o){console.warn("[StartupSync] Background conversation sync failed:",o)}},5e3))}catch(t){console.error("[StartupSync] Startup sync failed:",t)}}}static reset(){this.hasRunStartupSync=!1}}ve(dle,"hasRunStartupSync",!1);function YJe(e){const t=new Map(e.map(a=>[a.id,a])),n=new Set,r=new Set,s=[];function i(a){if(n.has(a.id))return!0;if(r.has(a.id))return console.error(`[Init] Circular dependency detected involving module: ${a.id}`),Oe.error("Initialization Error: Circular dependency in controls."),!1;r.add(a.id);for(const o of a.dependencies??[]){const l=t.get(o);if(!l)return console.error(`[Init] Missing dependency "${o}" for module "${a.id}"`),Oe.error(`Initialization Error: Missing dependency "${o}" for "${a.id}".`),r.delete(a.id),!1;if(!i(l))return r.delete(a.id),!1}return r.delete(a.id),n.add(a.id),s.push(a),!0}for(const a of e)if(!n.has(a.id)&&!i(a))return null;return s}async function ZJe(e,t){console.log("[Init] Core Data: Applying bundled configuration..."),await KJe.applyBundledConfig(),console.log("[Init] Core Data: Requesting loads..."),t.emit(sn.loadSettingsRequest,void 0),t.emit(dr.loadInitialDataRequest,void 0),t.emit(gr.loadRulesAndTagsRequest,void 0),t.emit(Yn.loadConversationsRequest,void 0),t.emit(ba.loadProjectsRequest,void 0),await new Promise(n=>{let r=!1,s=!1,i=!1,a=!1,o=!1;const l=()=>{r&&s&&i&&a&&o&&n()},c=t.on(sn.loaded,()=>{r=!0,c(),l()}),u=t.on(dr.initialDataLoaded,()=>{s=!0,u(),l()}),d=t.on(gr.dataLoaded,()=>{i=!0,d(),l()}),h=t.on(Yn.conversationsLoaded,()=>{a=!0,h(),l()}),m=t.on(ba.loaded,()=>{o=!0,m(),l()})}),je.emit(tp.initializationPhaseCompleted,{phase:"coreData"}),console.log("[Init] Core Data: Loaded (or load requested)."),setTimeout(()=>{dle.runStartupSync().catch(n=>{console.warn("[Init] Startup sync failed:",n)})},1e3)}async function XJe(e,t){console.log("[Init] Control Modules: Instantiation & Dependency Resolution START");const n=e.map(s=>new s),r=YJe(n);if(!r)throw console.error("[Init] Control Modules: Dependency resolution FAILED."),new Error("Failed to resolve control module dependency order.");console.log(`[Init] Control Modules: Dependency order resolved (${r.length} modules):`,r.map(s=>s.id)),console.log("[Init] Control Modules: Instantiation & Dependency Resolution COMPLETE"),console.log("[Init] Control Modules: Initialization START");for(const s of r)try{await s.initialize(t)}catch(i){console.error(`[Init] Error initializing module "${s.id}":`,i),Oe.error(`Module Init Error (${s.id}): ${i instanceof Error?i.message:String(i)}`)}return je.emit(tp.initializationPhaseCompleted,{phase:"controlModulesInit"}),console.log("[Init] Control Modules: Initialization COMPLETE."),r}function JJe(e,t){console.log("[Init] Control Modules: Registration START");for(const n of e)try{n.register(t)}catch(r){console.error(`[Init] Error registering module "${n.id}":`,r),Oe.error(`Module Registration Error (${n.id}): ${r instanceof Error?r.message:String(r)}`)}je.emit(tp.initializationPhaseCompleted,{phase:"controlModulesRegister"}),console.log("[Init] Control Modules: Registration COMPLETE.")}async function QJe(e,t){console.log("[Init] External Mods: Loading DB records..."),t.emit(ki.loadDbModsRequest,void 0),await new Promise(s=>{const i=t.on(ki.dbModsLoaded,()=>{i(),s()})});const n=jh.getState().dbMods;console.log(`[Init] External Mods: Processing ${n.length} mods...`);const r=await GJe(n);jh.getState().setLoadedMods(r),je.emit(tp.initializationPhaseCompleted,{phase:"externalMods"}),console.log(`[Init] External Mods: ${r.length} mods processed.`)}function eQe(e,t){var a;console.log("[Init] Core UI States: Initializing...");const n=e.selectedItemId,r=e.selectedItemType,s=r==="project"?n:r==="conversation"?((a=e.getConversationById(n))==null?void 0:a.projectId)??null:null,i=e.getEffectiveProjectSettings(s);t.emit(Fn.initializePromptStateRequest,{effectiveSettings:i}),je.emit(tp.initializationPhaseCompleted,{phase:"uiStateSync"}),console.log("[Init] Core UI States: Initial prompt state synchronization requested.")}async function tQe(e,t){console.log("[Init] LiteChat Full Initialization START"),tm.initializeCanvasEventHandlers();const n={requestLoadSettings:()=>t.emit(sn.loadSettingsRequest,void 0),requestLoadProviderData:()=>t.emit(dr.loadInitialDataRequest,void 0),requestLoadRulesAndTags:()=>t.emit(gr.loadRulesAndTagsRequest,void 0),requestLoadConversations:()=>t.emit(Yn.loadConversationsRequest,void 0),requestLoadProjects:()=>t.emit(ba.loadProjectsRequest,void 0),requestLoadDbMods:()=>t.emit(ki.loadDbModsRequest,void 0),setLoadedMods:jh.getState().setLoadedMods,getConversationById:qn.getState().getConversationById,getEffectiveProjectSettings:Oo.getState().getEffectiveProjectSettings,initializePromptState:Mo.getState().initializePromptState,selectedItemId:qn.getState().selectedItemId,selectedItemType:qn.getState().selectedItemType};let r=[];try{await ZJe(n,t),r=await XJe(e,t),JJe(r,t),await QJe(n,t),eQe(n,t),je.emit(tp.initializationPhaseCompleted,{phase:"all"}),console.log("LiteChat: Full initialization sequence COMPLETE.")}catch(s){throw console.error("LiteChat: Full initialization sequence FAILED:",s),Oe.error(`Initialization sequence failed: ${s instanceof Error?s.message:String(s)}`),Yw.getState().setGlobalError("Initialization sequence failed."),s}return r}const fle=Fo(Lo((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,s]=await Promise.all([Et.loadRules(),Et.loadTags(),Et.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:s,isLoading:!1}),je.emit(gr.dataLoaded,{rules:n,tags:r,links:s})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),Oe.error("Failed to load rules and tags."),je.emit(gr.loadingStateChanged,{isLoading:!1,error:"Failed load rules/tags"})}},addRule:async n=>{const r=qi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.rules.push(i),a.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{await Et.saveRule(i),Oe.success(`Rule "${i.name}" added.`),je.emit(gr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return je.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding rule",a),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),Oe.error("Failed to save new rule."),a}},updateRule:async(n,r)=>{const s=t().rules.find(a=>a.id===n);if(!s)throw Oe.error("Rule not found for update."),new Error("Rule not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.rules.findIndex(l=>l.id===n);o!==-1&&(a.rules[o]=i,a.rules.sort((l,c)=>l.name.localeCompare(c.name)))});try{await Et.saveRule(i),Oe.success(`Rule "${i.name}" updated.`),je.emit(gr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();je.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating rule",a),e(o=>{const l=o.rules.findIndex(c=>c.id===n);l!==-1&&(o.rules[l]=s,o.rules.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save rule update"}),Oe.error("Failed to save rule update."),a}},deleteRule:async n=>{const r=t().rules.find(a=>a.id===n);if(!r)throw Oe.error("Rule not found for deletion."),new Error("Rule not found");const s=[...t().tagRuleLinks.filter(a=>a.ruleId===n)],i={...r};e(a=>{a.rules=a.rules.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.ruleId!==n)});try{await Et.deleteRule(n),Oe.success(`Rule "${r.name}" deleted.`),je.emit(gr.ruleDeleted,{ruleId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();je.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting rule",a),e(o=>{o.rules.find(l=>l.id===i.id)||(o.rules.push(i),o.rules.sort((l,c)=>l.name.localeCompare(c.name))),s.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete rule"}),Oe.error("Failed to delete rule."),a}},addTag:async n=>{const r=qi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.tags.push(i),a.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{await Et.saveTag(i),Oe.success(`Tag "${i.name}" added.`),je.emit(gr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return je.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding tag",a),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),Oe.error("Failed to save new tag."),a}},updateTag:async(n,r)=>{const s=t().tags.find(a=>a.id===n);if(!s)throw Oe.error("Tag not found for update."),new Error("Tag not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.tags.findIndex(l=>l.id===n);o!==-1&&(a.tags[o]=i,a.tags.sort((l,c)=>l.name.localeCompare(c.name)))});try{await Et.saveTag(i),Oe.success(`Tag "${i.name}" updated.`),je.emit(gr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();je.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating tag",a),e(o=>{const l=o.tags.findIndex(c=>c.id===n);l!==-1&&(o.tags[l]=s,o.tags.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save tag update"}),Oe.error("Failed to save tag update."),a}},deleteTag:async n=>{const r=t().tags.find(a=>a.id===n);if(!r)throw Oe.error("Tag not found for deletion."),new Error("Tag not found");const s={...r},i=[...t().tagRuleLinks.filter(a=>a.tagId===n)];e(a=>{a.tags=a.tags.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.tagId!==n)});try{await Et.deleteTag(n),Oe.success(`Tag "${r.name}" deleted.`),je.emit(gr.tagDeleted,{tagId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();je.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting tag",a),e(o=>{o.tags.find(l=>l.id===s.id)||(o.tags.push(s),o.tags.sort((l,c)=>l.name.localeCompare(c.name))),i.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete tag"}),Oe.error("Failed to delete tag."),a}},linkTagToRule:async(n,r)=>{const s=`${n}-${r}`;if(t().tagRuleLinks.some(a=>a.id===s)){Oe.info("Link already exists.");return}const i={id:s,tagId:n,ruleId:r};e(a=>{a.tagRuleLinks.push(i)});try{await Et.saveTagRuleLink(i),Oe.success("Tag linked to rule."),gr.linkSaved&&je.emit(gr.linkSaved,{link:i});const{rules:a,tags:o,tagRuleLinks:l}=t();je.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error linking tag to rule",a),e(o=>{o.tagRuleLinks=o.tagRuleLinks.filter(l=>l.id!==s),o.error="Failed to link tag to rule"}),Oe.error("Failed to link tag to rule."),a}},unlinkTagFromRule:async(n,r)=>{const s=`${n}-${r}`,i=t().tagRuleLinks.find(a=>a.id===s);i||Oe.info("Link not found for unlinking."),e(a=>{a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.id!==s)});try{await Et.deleteTagRuleLink(s),Oe.success("Tag unlinked from rule."),gr.linkDeleted&&je.emit(gr.linkDeleted,{linkId:s});const{rules:a,tags:o,tagRuleLinks:l}=t();je.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error unlinking tag from rule",a),i&&e(o=>{o.tagRuleLinks.some(l=>l.id===i.id)||o.tagRuleLinks.push(i),o.error="Failed to unlink tag from rule"}),Oe.error("Failed to unlink tag from rule."),a}},getRulesForTag:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.tagId===n).map(i=>i.ruleId));return r.rules.filter(i=>s.has(i.id))},getTagsForRule:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.ruleId===n).map(i=>i.tagId));return r.tags.filter(i=>s.has(i.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(s=>r.has(s.id))},getRegisteredActionHandlers:()=>{const n="rulesStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:gr.loadRulesAndTagsRequest,handler:r.loadRulesAndTags,storeId:n},{eventName:gr.addRuleRequest,handler:s(r.addRule),storeId:n},{eventName:gr.updateRuleRequest,handler:i=>r.updateRule(i.id,i.updates),storeId:n},{eventName:gr.deleteRuleRequest,handler:i=>r.deleteRule(i.id),storeId:n},{eventName:gr.addTagRequest,handler:s(r.addTag),storeId:n},{eventName:gr.updateTagRequest,handler:i=>r.updateTag(i.id,i.updates),storeId:n},{eventName:gr.deleteTagRequest,handler:i=>r.deleteTag(i.id),storeId:n},{eventName:gr.linkTagToRuleRequest,handler:i=>r.linkTagToRule(i.tagId,i.ruleId),storeId:n},{eventName:gr.unlinkTagFromRuleRequest,handler:i=>r.unlinkTagFromRule(i.tagId,i.ruleId),storeId:n}]}}))),fd={promptTemplatesChanged:"prompt-template.prompts.changed",promptTemplateAdded:"prompt-template.added",promptTemplateUpdated:"prompt-template.updated",promptTemplateDeleted:"prompt-template.deleted",loadPromptTemplatesRequest:"prompt-template.load.request",addPromptTemplateRequest:"prompt-template.add.request",updatePromptTemplateRequest:"prompt-template.update.request",deletePromptTemplateRequest:"prompt-template.delete.request",selectPromptTemplateRequest:"prompt-template.select.request",compilePromptTemplateRequest:"prompt-template.compile.request"},eA=Fo(Lo((e,t)=>({promptTemplates:[],loading:!1,error:null,loadPromptTemplates:async()=>{e(n=>{n.loading=!0,n.error=null});try{const n=await Et.loadPromptTemplates();e(r=>{r.promptTemplates=n,r.loading=!1}),je.emit(fd.promptTemplatesChanged,{promptTemplates:n})}catch(n){const r=n instanceof Error?n.message:"Failed to load prompt templates";e(s=>{s.error=r,s.loading=!1}),Oe.error(r)}},addPromptTemplate:async n=>{const r={id:qi(),createdAt:new Date,updatedAt:new Date,...n};e(s=>{s.promptTemplates.push(r)});try{return await Et.savePromptTemplate(r),je.emit(fd.promptTemplateAdded,{promptTemplate:r}),Oe.success("Prompt template created successfully"),r.id}catch(s){e(a=>{a.promptTemplates=a.promptTemplates.filter(o=>o.id!==r.id)});const i=s instanceof Error?s.message:"Failed to create prompt template";throw e(a=>{a.error=i}),Oe.error(i),s}},updatePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(a=>a.id===n);if(!s){Oe.error("Prompt template not found");return}const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.promptTemplates.findIndex(l=>l.id===n);o!==-1&&(a.promptTemplates[o]=i)});try{await Et.savePromptTemplate(i),je.emit(fd.promptTemplateUpdated,{promptTemplate:i}),Oe.success("Prompt template updated successfully")}catch(a){e(l=>{const c=l.promptTemplates.findIndex(u=>u.id===n);c!==-1&&(l.promptTemplates[c]=s)});const o=a instanceof Error?a.message:"Failed to update prompt template";throw e(l=>{l.error=o}),Oe.error(o),a}},deletePromptTemplate:async n=>{const r=t().promptTemplates.find(s=>s.id===n);if(!r){Oe.error("Prompt template not found");return}e(s=>{s.promptTemplates=s.promptTemplates.filter(i=>i.id!==n)});try{await Et.deletePromptTemplate(n),je.emit(fd.promptTemplateDeleted,{id:n}),Oe.success("Prompt template deleted successfully")}catch(s){e(a=>{a.promptTemplates.push(r)});const i=s instanceof Error?s.message:"Failed to delete prompt template";throw e(a=>{a.error=i}),Oe.error(i),s}},compilePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(i=>i.id===n);if(!s)throw new Error("Template not found");try{let i=s.prompt;for(const o of s.variables){const l=r[o.name],c=[new RegExp(`{{\\s*${o.name}\\s*}}`,"g"),new RegExp(`{{${o.name}}}`,"g"),new RegExp(`{{ ${o.name} }}`,"g")];if(l!=null){let u;typeof l=="object"?u=JSON.stringify(l):u=String(l);for(const d of c){const h=i;i=i.replace(d,u),h!==i&&console.log(`Replaced "${o.name}" using pattern ${d} in:`,h,"",i)}}else{if(o.required)throw new Error(`Required variable "${o.name}" is missing`);if(o.default)for(const u of c)i=i.replace(u,o.default)}}return{content:i,selectedTools:s.tools,selectedRules:s.rules}}catch(i){const a=i instanceof Error?i.message:"Failed to compile prompt template";throw Oe.error(a),i}},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:fd.loadPromptTemplatesRequest,handler:()=>n.loadPromptTemplates(),storeId:"promptTemplateStore"},{eventName:fd.addPromptTemplateRequest,handler:async r=>{await n.addPromptTemplate(r.promptTemplate)},storeId:"promptTemplateStore"},{eventName:fd.updatePromptTemplateRequest,handler:r=>n.updatePromptTemplate(r.id,r.updates),storeId:"promptTemplateStore"},{eventName:fd.deletePromptTemplateRequest,handler:r=>n.deletePromptTemplate(r.id),storeId:"promptTemplateStore"},{eventName:fd.compilePromptTemplateRequest,handler:async r=>{await n.compilePromptTemplate(r.templateId,r.formData)},storeId:"promptTemplateStore"}]}}))),kr={serversChanged:"mcp.servers.changed",serverAdded:"mcp.server.added",serverUpdated:"mcp.server.updated",serverDeleted:"mcp.server.deleted",serverConnectionChanged:"mcp.server.connection.changed",toolsChanged:"mcp.tools.changed",retryAttemptsChanged:"mcp.retry.attempts.changed",retryDelayChanged:"mcp.retry.delay.changed",connectionTimeoutChanged:"mcp.connection.timeout.changed",maxResponseSizeChanged:"mcp.max.response.size.changed",bridgeConfigChanged:"mcp.bridge.config.changed",beforeToolCall:"mcp.tool.before.call",afterToolCall:"mcp.tool.after.call",toolCallFailed:"mcp.tool.call.failed",beforeToolExecution:"mcp.tool.before.execution",toolDiscovered:"mcp.tool.discovered",toolRegistered:"mcp.tool.registered",toolUnregistered:"mcp.tool.unregistered",setServersRequest:"mcp.set.servers.request",addServerRequest:"mcp.add.server.request",updateServerRequest:"mcp.update.server.request",deleteServerRequest:"mcp.delete.server.request",connectServerRequest:"mcp.connect.server.request",disconnectServerRequest:"mcp.disconnect.server.request",refreshToolsRequest:"mcp.refresh.tools.request",loadMcpStateRequest:"mcp.load.state.request",resetMcpStateRequest:"mcp.reset.state.request",setRetryAttemptsRequest:"mcp.set.retry.attempts.request",setRetryDelayRequest:"mcp.set.retry.delay.request",setConnectionTimeoutRequest:"mcp.set.connection.timeout.request",setMaxResponseSizeRequest:"mcp.set.max.response.size.request"},ax=3,ox=2e3,lx=1e4,cx=128e3,nQe={servers:[],serverStatuses:{},loading:!1,error:null,retryAttempts:ax,retryDelay:ox,connectionTimeout:lx,maxResponseSize:cx,bridgeConfig:{}},el=Fo(Lo((e,t)=>({...nQe,setServers:n=>{e(r=>{r.servers=n,r.error=null}),Et.saveSetting("mcpServers",n).catch(r=>{console.error("Failed to persist MCP servers:",r)}),je.emit(kr.serversChanged,{servers:n})},addServer:n=>{const r={...n,id:`mcp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};e(i=>{i.servers.push(r),i.error=null});const s=t().servers;Et.saveSetting("mcpServers",s).catch(i=>{console.error("Failed to persist MCP servers:",i)}),je.emit(kr.serverAdded,{server:r}),je.emit(kr.serversChanged,{servers:s})},updateServer:(n,r)=>{let s=null;if(e(i=>{const a=i.servers.findIndex(o=>o.id===n);a!==-1&&(i.servers[a]={...i.servers[a],...r},s=i.servers[a],i.error=null)}),s){const i=t().servers;Et.saveSetting("mcpServers",i).catch(a=>{console.error("Failed to persist MCP servers:",a)}),je.emit(kr.serverUpdated,{server:s}),je.emit(kr.serversChanged,{servers:i})}},deleteServer:n=>{e(s=>{s.servers=s.servers.filter(i=>i.id!==n),delete s.serverStatuses[n],s.error=null});const r=t().servers;Et.saveSetting("mcpServers",r).catch(s=>{console.error("Failed to persist MCP servers:",s)}),je.emit(kr.serverDeleted,{serverId:n}),je.emit(kr.serversChanged,{servers:r})},setServerStatus:n=>{e(r=>{r.serverStatuses[n.serverId]=n}),je.emit(kr.serverConnectionChanged,{serverId:n.serverId,connected:n.connected,error:n.error}),n.tools.length>0&&je.emit(kr.toolsChanged,{serverId:n.serverId,tools:n.tools})},clearServerStatus:n=>{e(r=>{delete r.serverStatuses[n]}),je.emit(kr.serverConnectionChanged,{serverId:n,connected:!1})},setRetryAttempts:n=>{const r=Math.max(0,Math.min(10,n));e(s=>{s.retryAttempts=r}),Et.saveSetting("mcpRetryAttempts",r).catch(s=>{console.error("Failed to persist MCP retry attempts:",s)}),je.emit(kr.retryAttemptsChanged,{attempts:r})},setRetryDelay:n=>{const r=Math.max(500,Math.min(3e4,n));e(s=>{s.retryDelay=r}),Et.saveSetting("mcpRetryDelay",r).catch(s=>{console.error("Failed to persist MCP retry delay:",s)}),je.emit(kr.retryDelayChanged,{delay:r})},setConnectionTimeout:n=>{const r=Math.max(1e3,Math.min(6e4,n));e(s=>{s.connectionTimeout=r}),Et.saveSetting("mcpConnectionTimeout",r).catch(s=>{console.error("Failed to persist MCP connection timeout:",s)}),je.emit(kr.connectionTimeoutChanged,{timeout:r})},setMaxResponseSize:n=>{const r=Math.max(1e3,Math.min(1e7,n));e(s=>{s.maxResponseSize=r}),Et.saveSetting("mcpMaxResponseSize",r).catch(s=>{console.error("Failed to persist MCP max response size:",s)}),je.emit(kr.maxResponseSizeChanged,{size:r})},setBridgeConfig:n=>{e(r=>{r.bridgeConfig={...n}}),Et.saveSetting("mcpBridgeConfig",n).catch(r=>{console.error("Failed to persist MCP bridge config:",r)}),je.emit(kr.bridgeConfigChanged,{config:n})},setLoading:n=>{e(r=>{r.loading=n})},setError:n=>{e(r=>{r.error=n})},loadMcpState:async()=>{try{e(l=>{l.loading=!0,l.error=null});const[n,r,s,i,a,o]=await Promise.all([Et.loadSetting("mcpServers",[]),Et.loadSetting("mcpRetryAttempts",ax),Et.loadSetting("mcpRetryDelay",ox),Et.loadSetting("mcpConnectionTimeout",lx),Et.loadSetting("mcpMaxResponseSize",cx),Et.loadSetting("mcpBridgeConfig",{})]);e(l=>{l.servers=n||[],l.retryAttempts=r,l.retryDelay=s,l.connectionTimeout=i,l.maxResponseSize=a,l.bridgeConfig=o||{},l.loading=!1}),je.emit(kr.serversChanged,{servers:n||[]}),je.emit(kr.retryAttemptsChanged,{attempts:r}),je.emit(kr.retryDelayChanged,{delay:s}),je.emit(kr.connectionTimeoutChanged,{timeout:i}),je.emit(kr.maxResponseSizeChanged,{size:a}),je.emit(kr.bridgeConfigChanged,{config:o||{}})}catch(n){console.error("Failed to load MCP state:",n),e(r=>{r.error=n.message||"Failed to load MCP state",r.loading=!1})}},resetMcpState:()=>{e(n=>{n.servers=[],n.serverStatuses={},n.retryAttempts=ax,n.retryDelay=ox,n.connectionTimeout=lx,n.maxResponseSize=cx,n.bridgeConfig={},n.loading=!1,n.error=null}),Promise.all([Et.saveSetting("mcpServers",[]),Et.saveSetting("mcpRetryAttempts",ax),Et.saveSetting("mcpRetryDelay",ox),Et.saveSetting("mcpConnectionTimeout",lx),Et.saveSetting("mcpMaxResponseSize",cx)]).catch(n=>{console.error("Failed to clear MCP settings from storage:",n)}),je.emit(kr.serversChanged,{servers:[]}),je.emit(kr.retryAttemptsChanged,{attempts:ax}),je.emit(kr.retryDelayChanged,{delay:ox}),je.emit(kr.connectionTimeoutChanged,{timeout:lx}),je.emit(kr.maxResponseSizeChanged,{size:cx})},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:kr.setServersRequest,handler:r=>n.setServers(r.servers),storeId:"mcpStore"},{eventName:kr.addServerRequest,handler:r=>n.addServer(r.server),storeId:"mcpStore"},{eventName:kr.updateServerRequest,handler:r=>n.updateServer(r.id,r.updates),storeId:"mcpStore"},{eventName:kr.deleteServerRequest,handler:r=>n.deleteServer(r.id),storeId:"mcpStore"},{eventName:kr.setRetryAttemptsRequest,handler:r=>n.setRetryAttempts(r.attempts),storeId:"mcpStore"},{eventName:kr.setRetryDelayRequest,handler:r=>n.setRetryDelay(r.delay),storeId:"mcpStore"},{eventName:kr.setConnectionTimeoutRequest,handler:r=>n.setConnectionTimeout(r.timeout),storeId:"mcpStore"},{eventName:kr.setMaxResponseSizeRequest,handler:r=>n.setMaxResponseSize(r.size),storeId:"mcpStore"},{eventName:kr.loadMcpStateRequest,handler:()=>n.loadMcpState(),storeId:"mcpStore"},{eventName:kr.resetMcpStateRequest,handler:()=>n.resetMcpState(),storeId:"mcpStore"}]},exportProxyConfig:()=>t().servers.map(r=>({id:r.id,name:r.name,url:r.url,enabled:r.enabled}))}))),rQe=[yr,Rr,fle,qn,Oo,Bn,hh,Mo,jh,Yw,Xs,No,eA,el];class hle{static initialize(){if(this.isInitialized){console.warn("[Coordinator] Already initialized. Skipping re-initialization.");return}console.log("[Coordinator] Initializing dynamic event listeners for action requests...");const t=[];rQe.forEach(n=>{const r=n.getState();if(r&&typeof r.getRegisteredActionHandlers=="function")try{const s=r.getRegisteredActionHandlers();Array.isArray(s)?t.push(...s):console.warn(`[Coordinator] getRegisteredActionHandlers for store did not return an array. Store ID: ${r.id||"Unknown"}`)}catch(s){console.error("[Coordinator] Error calling getRegisteredActionHandlers for a store:",s)}}),t.length===0?console.warn("[Coordinator] No action handlers were registered by any store."):t.forEach(n=>{n&&n.eventName&&typeof n.handler=="function"?je.on(n.eventName,n.handler):console.error("[Coordinator] Invalid action handler structure encountered:",n)}),this.isInitialized=!0,console.log(`[Coordinator] Dynamic event listeners initialized. Total handlers: ${t.length}.`)}}ve(hle,"isInitialized",!1);const sQe=()=>{const[e,t]=T.useState({}),n=No(r=>r.modalProviders);return T.useEffect(()=>{const r=i=>{t(a=>({...a,[i.modalId]:{...i,isOpen:!0}})),je.emit(jr.modalStateChanged,{...i,isOpen:!0})},s=i=>{t(a=>{const o={...a};return o[i.modalId]&&(o[i.modalId].isOpen=!1),o}),je.emit(jr.modalStateChanged,{modalId:i.modalId,isOpen:!1})};return je.on(jr.openModalRequest,r),je.on(jr.closeModalRequest,s),()=>{je.off(jr.openModalRequest,r),je.off(jr.closeModalRequest,s)}},[]),f.jsx(f.Fragment,{children:Object.entries(e).map(([r,s])=>{if(!s.isOpen)return null;const i=n[r];if(!i)return console.warn(`[ModalManager] No provider for modalId: ${r}`),null;const a={isOpen:!0,onClose:()=>je.emit(jr.closeModalRequest,{modalId:r}),modalProps:s.modalProps,targetId:s.targetId,initialTab:s.initialTab,initialSubTab:s.initialSubTab};return f.jsx(i,{...a},r)})})};let WV=[],HV=null,hd=!1;const iQe=({controls:e=[]})=>{const[t,n]=T.useState(!0),[r,s]=T.useState(!1),i=T.useRef(null),a=T.useRef(null),{selectedItemId:o,selectedItemType:l,getConversationById:c}=qn(yn(I=>({selectedItemId:I.selectedItemId,selectedItemType:I.selectedItemType,getConversationById:I.getConversationById}))),{getEffectiveProjectSettings:u}=Oo(yn(I=>({getEffectiveProjectSettings:I.getEffectiveProjectSettings}))),{interactions:d,status:h}=Bn(yn(I=>({interactions:I.interactions,status:I.status}))),{globalError:m,isSidebarCollapsed:y,isChatControlPanelOpen:b}=Yw(yn(I=>({globalError:I.globalError,isSidebarCollapsed:I.isSidebarCollapsed,isChatControlPanelOpen:I.isChatControlPanelOpen}))),v=No(yn(I=>Object.values(I.chatControls))),x=T.useMemo(()=>v.filter(I=>(I.panel??"main")==="sidebar"&&(I.show?I.show():!0)),[v]),w=T.useMemo(()=>v.filter(I=>I.panel==="sidebar-footer"&&(I.show?I.show():!0)),[v]),S=T.useMemo(()=>v.filter(I=>I.panel==="header"&&(I.show?I.show():!0)),[v]),C=T.useCallback(()=>{s(I=>!I)},[]);T.useEffect(()=>{r&&o&&(l==="conversation"||l==="project")&&s(!1)},[o,l]),T.useEffect(()=>{a.current||(a.current=hO({id:"core-litechat-app",name:"LiteChat App Core"}));const I=a.current;hle.initialize(),HV||(HV=(async()=>{if(hd){n(!1);return}n(!0);try{WV=await tQe(e,I),hd=!0}catch(L){console.error("[LiteChat] App: Top-level initialization error:",L),hd=!1}finally{n(!1)}})().then(()=>WV))},[e]);const k=T.useRef({itemId:null,itemType:null,effectiveSettingsString:""});T.useEffect(()=>{if(t||!hd||!a.current)return;const I=a.current,O={itemId:o,itemType:l};let L=null;if(l==="project")L=o;else if(l==="conversation"&&o){const F=c(o);L=(F==null?void 0:F.projectId)??null}const P=u(L),V=JSON.stringify(P);(O.itemId!==k.current.itemId||O.itemType!==k.current.itemType||V!==k.current.effectiveSettingsString)&&(I.emit(Fn.initializePromptStateRequest,{effectiveSettings:P}),I.emit(jr.contextChanged,{selectedItemId:o,selectedItemType:l}),k.current={...O,effectiveSettingsString:V})},[o,l,c,u,t,hd]),T.useEffect(()=>{if(t||!hd||!a.current)return;const I=a.current,O=()=>{let X=null;if(l==="project")X=o;else if(l==="conversation"&&o){const H=c(o);X=(H==null?void 0:H.projectId)??null}const U=u(X);I.emit(Fn.initializePromptStateRequest,{effectiveSettings:U})},L=I.on(sn.loaded,O),P=I.on(ba.updated,O),V=I.on(sn.globalSystemPromptChanged,O),F=I.on(sn.temperatureChanged,O);return()=>{L(),P(),V(),F()}},[o,l,c,u,t,hd]),T.useEffect(()=>{if(t||!hd||!a.current)return;const I=a.current;let O=null;if(b["core-vfs-modal-panel"]||l==="project")if(l==="project")O=o;else if(l==="conversation"){const V=c(o);O=(V==null?void 0:V.projectId)??"orphan"}else O="orphan";else if(l==="conversation"){const V=c(o);O=(V==null?void 0:V.projectId)??"orphan"}let P=null;typeof O=="string"?P=O:O===null?P=null:(console.warn(`[LiteChatVFS] Calculated VFS key was not a string or null. Type: ${typeof O}, Value:`,O,"Defaulting to 'orphan'."),P="orphan"),Xs.getState().vfsKey!==P&&I.emit(dn.setVfsKeyRequest,{key:P})},[o,l,c,t,hd,b]);const A=async I=>{const O=qn.getState(),L=await O.addConversation(I);return console.log("New conversation ID:",L),await O.selectItem(L,"conversation"),console.log("conv selected:",L),L},R=T.useCallback(async I=>{var V;if(!a.current){Oe.error("Application core not ready. Please try again.");return}const O=qn.getState();let L=O.selectedItemType==="conversation"?O.selectedItemId:null;const P=O.selectedItemType==="project"?O.selectedItemId:O.selectedItemType==="conversation"?((V=O.getConversationById(O.selectedItemId))==null?void 0:V.projectId)??null:null;if(!L)try{L=await A({title:"New Chat",projectId:P}),console.log("New conversation ID 2:",L)}catch(F){console.error("[LiteChat] App: Failed to create new conversation",F),Oe.error("Failed to start new chat.");return}try{const F=Mo.getState(),X={...I,metadata:{...I.metadata,modelId:F.modelId}};await Sx.submitPrompt(X)}catch(F){console.error("[LiteChat] App: Error submitting prompt:",F),Oe.error("Failed to send message.")}},[]),N=l==="conversation"?o:null;return t?f.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx(Qn,{className:"h-12 w-12 animate-spin text-primary"}),f.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):f.jsxs(f.Fragment,{children:[f.jsx(sQe,{}),f.jsxs("div",{className:"flex h-full w-full border border-border rounded-lg overflow-hidden bg-background text-foreground",children:[f.jsxs("div",{className:Ze("hidden md:flex flex-col border-r border-border bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",y?"w-16":"w-64"),children:[f.jsxs("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:[f.jsx("div",{className:Ze(y?"hidden":"block"),children:f.jsx(n0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"})}),f.jsx("div",{className:Ze(y?"block":"hidden"),children:f.jsx(n0,{controls:x,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),f.jsx("div",{className:Ze("flex-shrink-0 border-t border-border p-2",y?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:f.jsx(n0,{controls:w,panelId:"sidebar-footer",renderMode:y?"icon":"full",className:Ze("flex",y?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),r&&f.jsxs("div",{className:"md:hidden fixed inset-0 z-40 flex",children:[f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:C}),f.jsxs("div",{className:"relative w-4/5 max-w-sm bg-card border-r border-border h-full flex flex-col animate-slideInFromLeft shadow-2xl",children:[f.jsxs("div",{className:"sticky top-0 z-10 flex justify-between items-center p-4 border-b border-border bg-card",children:[f.jsx("h2",{className:"font-semibold text-card-foreground",children:"LiteChat Menu"}),f.jsx("button",{onClick:C,className:"p-2 rounded-md hover:bg-muted text-card-foreground touch-manipulation","aria-label":"Close menu",style:{minHeight:"44px",minWidth:"44px"},children:f.jsx(wa,{className:"h-5 w-5"})})]}),f.jsx("div",{className:"flex-grow overflow-y-auto overflow-x-hidden bg-card",children:x.length>0?f.jsx(n0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"}):f.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[f.jsx("p",{className:"text-sm",children:"Loading menu..."}),f.jsx("p",{className:"text-xs mt-2",children:"Please wait while the application initializes."})]})}),f.jsx("div",{className:"flex-shrink-0 border-t border-border p-4 bg-card",children:w.length>0?f.jsx(n0,{controls:w,panelId:"sidebar-footer",renderMode:"full",className:"flex items-center justify-between"}):f.jsx("div",{className:"text-center text-muted-foreground text-xs",children:"Footer controls loading..."})})]})]}),f.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-border bg-card flex-shrink-0",children:[f.jsx("button",{className:Ze("md:hidden p-3 rounded-md hover:bg-muted active:bg-muted/80 transition-colors touch-manipulation",r&&"bg-muted"),onClick:C,"aria-label":r?"Close menu":"Open menu",style:{minHeight:"44px",minWidth:"44px"},children:r?f.jsx(wa,{className:"h-6 w-6"}):f.jsx(Fme,{className:"h-6 w-6"})}),f.jsx(n0,{controls:S,panelId:"header",className:"flex items-center justify-end gap-1 flex-grow"})]}),f.jsx(zJe,{conversationId:N,interactions:d,status:h,className:"flex-grow overflow-y-hidden"}),m&&f.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",m]}),f.jsx(rxe,{InputAreaRenderer:ule,onSubmit:R,className:"border-t border-border bg-card flex-shrink-0",inputAreaRef:i,selectedItemId:o,selectedItemType:l})]})]}),f.jsx(HJe,{richColors:!0,position:"bottom-right",closeButton:!0})]})},aQe="prism-theme-link",oQe="prism-default-light-theme-link",lQe="prism-default-dark-theme-link",cQe="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css",uQe="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css",g3=e=>{let t=document.getElementById(e);return t||(t=document.createElement("link"),t.id=e,t.rel="stylesheet",document.head.appendChild(t)),t},dQe=()=>{const{prismThemeUrl:e,theme:t}=yr(yn(s=>({prismThemeUrl:s.prismThemeUrl,theme:s.theme}))),n=T.useMemo(()=>typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),r=T.useMemo(()=>{const s=t==="system"?n:t;return s==="dark"||s==="TijuDark"?"dark":"light"},[t,n]);return T.useEffect(()=>{if(typeof window>"u")return;const s=g3(oQe),i=g3(lQe),a=g3(aQe);return s.disabled=!0,i.disabled=!0,a.disabled=!0,s.href=cQe,i.href=uQe,e?(a.href=e,a.disabled=!1):(console.log(r),r==="dark"?i.disabled=!1:s.disabled=!1),()=>{}},[e,r]),null},y3=e=>e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),b3=["background","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","border","input","ring","chart1","chart2","chart3","chart4","chart5","sidebar","sidebarForeground","sidebarPrimary","sidebarPrimaryForeground","sidebarAccent","sidebarAccentForeground","sidebarBorder","sidebarRing"],fQe=()=>{const{theme:e,customFontFamily:t,customFontSize:n,customThemeColors:r}=yr(yn(s=>({theme:s.theme,customFontFamily:s.customFontFamily,customFontSize:s.customFontSize,customThemeColors:s.customThemeColors})));return T.useEffect(()=>{const s=document.body,i=document.documentElement;s.classList.remove("light","dark","TijuLight","TijuDark","custom"),b3.forEach(a=>{i.style.removeProperty(`--${y3(a)}`)}),i.style.removeProperty("--custom-font-family"),i.style.removeProperty("--custom-font-size"),e==="light"?s.classList.add("light"):e==="dark"?s.classList.add("dark"):e==="TijuLight"?s.classList.add("TijuLight"):e==="TijuDark"?s.classList.add("TijuDark"):e==="custom"?(s.classList.add("custom"),t?i.style.setProperty("--custom-font-family",t):i.style.removeProperty("--custom-font-family"),n?i.style.setProperty("--custom-font-size",`${n}px`):i.style.removeProperty("--custom-font-size"),r&&Object.entries(r).forEach(([a,o])=>{if(o&&b3.includes(a)){const l=`--${y3(a)}`;i.style.setProperty(l,o)}else if(b3.includes(a)){const l=`--${y3(a)}`;i.style.removeProperty(l)}})):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.add("light")},[e,t,n,r]),null},hQe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1750 c-26 15 -48 65 -41 94
             15 61 181 167 304 196
             30 7 100 12 155 12
             81 -1 115 -6 178 -27
             135 -45 247 -133 249 -194
             2 -60 -48 -103 -104 -88
             -13 3 -50 25 -83 50
             -85 64 -172 90 -280 84
             -92 -6 -165 -35 -259 -103
             -49 -35 -86 -43 -119 -24z`})})]})},GV="0.1.0-dev",KV="https://github.com/DimitriGilbert/LiteChat",YV=({textToCopy:e,label:t,className:n})=>{const[r,s]=T.useState(!1),i=async()=>{try{await navigator.clipboard.writeText(e),s(!0),Oe.success(`${t} copied to clipboard!`),setTimeout(()=>s(!1),2e3)}catch(a){Oe.error(`Failed to copy ${t.toLowerCase()}.`),console.error(`Clipboard copy failed for ${t}:`,a)}};return f.jsxs(bt,{variant:"outline",onClick:i,className:n,children:[r?f.jsx(ro,{className:"mr-2 h-4 w-4 text-green-500"}):f.jsx(qpe,{className:"mr-2 h-4 w-4"}),r?"Copied!":`Copy ${t}`]})};class pQe extends T.Component{constructor(){super(...arguments);ve(this,"state",{hasError:!1,error:null,errorInfo:null});ve(this,"handleReportOnGitHub",async()=>{const n=this.generateErrorReport(!0);try{await navigator.clipboard.writeText(n),Oe.success("Error report copied to clipboard. Paste it into the GitHub issue body.");const r=`${KV}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(r,"_blank","noopener,noreferrer")}catch(r){Oe.error("Failed to copy error report. Please copy manually."),console.error("Clipboard copy failed for GitHub report:",r);const s=`${KV}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(s,"_blank","noopener,noreferrer")}})}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,r){console.error("Uncaught error:",n,r),this.setState({errorInfo:r})}getGitHubIssueTitle(){var i;const{error:n,errorInfo:r}=this.state;let s="Crash Report: ";if(r!=null&&r.componentStack){const a=(i=r.componentStack.trim().split(/\s+at\s+/)[1])==null?void 0:i.split(" ")[0];a&&(s+=`Error in <${a}> - `)}return s+=(n==null?void 0:n.message.substring(0,70))??"Unknown Error",n&&n.message.length>70&&(s+="..."),s}generateErrorReport(n=!1){const{error:r,errorInfo:s}=this.state,i=`
`,a=n?"```":"";let o=`## LiteChat Error Report${i}${i}`;return o+=`**Version:** ${GV}${i}`,o+=`**Timestamp:** ${new Date().toISOString()}${i}`,o+=`**User Agent:** ${typeof navigator<"u"?navigator.userAgent:"N/A"}${i}${i}`,r?o+=`**Error Message:**${i}${a}${i}${r.message}${i}${a}${i}${i}`:o+=`**Error Message:** Unknown Error${i}${i}`,s!=null&&s.componentStack&&(o+=`**Component Stack:**${i}${a}text${i}${s.componentStack.trim()}${i}${a}${i}${i}`),r!=null&&r.stack&&(o+=`**Error Stack Trace:**${i}${a}text${i}${r.stack.trim()}${i}${a}${i}${i}`),o+=`**Steps to Reproduce (Please Describe):**${i}1. ...${i}2. ...${i}${i}`,o+=`**Expected Behavior:**${i}...${i}${i}`,o+=`**Actual Behavior:**${i}...${i}`,o}generateAIPrompt(){var i,a;const{error:n,errorInfo:r}=this.state;return`I encountered an error in a React application (LiteChat v${GV}). Please help me debug it.

Error Message:
\`\`\`
${(n==null?void 0:n.message)??"Unknown Error"}
\`\`\`

Component Stack (if available):
\`\`\`
${((i=r==null?void 0:r.componentStack)==null?void 0:i.trim())??"Not available"}
\`\`\`

Error Stack Trace (if available):
\`\`\`
${((a=n==null?void 0:n.stack)==null?void 0:a.trim())??"Not available"}
\`\`\`

Based on this information, what are the likely causes and potential solutions? Focus on React-specific issues if the component stack is present.`}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:f.jsx("div",{role:"alert",className:"flex flex-col items-center justify-center h-screen w-screen p-4 bg-background text-foreground",children:f.jsxs("div",{className:"max-w-2xl w-full border border-destructive bg-destructive/10 rounded-lg p-6 text-center shadow-lg",children:[f.jsx(hQe,{className:"h-24 w-24 text-destructive mx-auto mb-4"}),f.jsx("h1",{className:"text-2xl font-semibold text-destructive mb-2",children:"Oops! Something went wrong."}),f.jsx("p",{className:"text-destructive/90 mb-4",children:"LiteChat encountered an unexpected error. Please try refreshing the page. If the problem persists, consider reporting the issue. Copy the details and paste them into the GitHub issue."}),f.jsx("pre",{className:"text-left text-xs bg-destructive/10 border border-destructive/30 rounded p-3 max-h-32 overflow-auto mb-4 font-mono text-destructive/80",children:((n=this.state.error)==null?void 0:n.message)??"Unknown Error"}),f.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[f.jsx(bt,{variant:"destructive",onClick:()=>window.location.reload(),children:"Refresh Page"}),f.jsx(YV,{textToCopy:this.generateErrorReport(),label:"Details"}),f.jsx(YV,{textToCopy:this.generateAIPrompt(),label:"AI Debug Prompt"}),f.jsxs(bt,{variant:"outline",onClick:this.handleReportOnGitHub,children:[f.jsx(aH,{className:"mr-2 h-4 w-4"})," Report on GitHub"]})]})]})}):this.props.children}}const ple=(e,t)=>{if(!t)return null;let n=Sc,r="text-muted-foreground/70",s=`Linked to ${t}`;switch(e){case"syncing":n=Qn,r="animate-spin text-blue-500",s=`Syncing with ${t}...`;break;case"error":n=_c,r="text-destructive",s=`Sync error with ${t}`;break;case"needs-sync":n=PO,r="text-orange-500",s=`Needs sync with ${t}`;break;case"idle":n=oE,r="text-green-500",s=`Synced with ${t}`;break;default:n=Sc,r="text-muted-foreground/70",s=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(n,{className:Ze("h-3 w-3 ml-1 flex-shrink-0",r)})}),f.jsx(Sr,{side:"right",children:s})]})})},mle=T.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:s,onSelectItem:i,onDeleteConversation:a,onDeleteProject:o,onExportConversation:l,onExportProject:c,expandedProjects:u,toggleProjectExpansion:d,editingItemId:h,editingItemType:m,handleStartEditing:y,handleSaveEdit:b,handleCancelEdit:v,isSavingEdit:x,originalNameToCompare:w})=>{const S=e.id===n,C=e.itemType==="project",k=e.id===h&&e.itemType===m,[A,R]=T.useState(C?e.name:e.title),N=T.useRef(null);T.useEffect(()=>{if(k){const ce=C?e.name:e.title;R(ce),requestAnimationFrame(()=>{var Ie,De;(Ie=N.current)==null||Ie.focus(),(De=N.current)==null||De.select()})}},[k,e,C]),T.useEffect(()=>{if(!k){const ce=C?e.name:e.title;A!==ce&&R(ce)}},[C?e.name:e.title,k,A,C]);const I=C&&u.has(e.id),O=C,L=!C&&e.syncRepoId?r[e.id]:void 0,P=!C&&e.syncRepoId?s.get(e.syncRepoId):void 0,V=!C&&P?ple(L,P):null,F=ce=>{ce.stopPropagation(),je.emit(jr.openModalRequest,{modalId:"projectSettingsModal",targetId:e.id})},X=()=>{k||(C&&d(e.id),i(e.id,e.itemType))},U=ce=>{ce.stopPropagation(),C?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,ce):a(e.id,ce)},H=ce=>{ce.stopPropagation(),y(e)},$=()=>{R(w),v(e.itemType==="project"&&w==="New Project")},ne=async()=>{if(x)return;const ce=A.trim();await b(e.id,e.itemType,ce)},W=()=>{var De;if(x)return;const ce=A.trim(),Ie=e.itemType==="project"&&w==="New Project";if(!ce){w!=="New Project"?(Oe.error("Name cannot be empty."),R(w),(De=N.current)==null||De.focus()):$();return}ce!==w||Ie?ne():$()},Q=ce=>{ce.key==="Enter"?(ce.preventDefault(),ne()):ce.key==="Escape"&&(ce.preventDefault(),$())},ee=C?e.name:e.title,se=x?Qn:ro,pe=x?"h-3 w-3 animate-spin":"h-3 w-3";return f.jsxs("li",{className:Ze("relative flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!k&&"hover:bg-muted/50 hover:text-primary/80",S&&!k?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",k&&"bg-muted ring-1 ring-primary",!k&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:X,title:k?"":ee,children:[f.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[O&&f.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:ce=>{ce.stopPropagation(),d(e.id)},children:I?f.jsx(Nc,{className:"h-3 w-3 text-muted-foreground"}):f.jsx(RO,{className:"h-3 w-3 text-muted-foreground"})}),!O&&f.jsx("span",{className:"w-3 flex-shrink-0"}),C?f.jsx(fh,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):f.jsx(U3,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),k?f.jsx(Cn,{ref:N,value:A,onChange:ce=>R(ce.target.value),onKeyDown:Q,onBlur:W,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:ce=>ce.stopPropagation(),disabled:x}):f.jsx("span",{className:"truncate min-w-0 flex-1",children:ee}),V]}),f.jsx("div",{className:Ze("items-center flex-shrink-0 ml-1",k?"flex":"hidden group-hover:flex transition-all duration-150"),onClick:ce=>ce.stopPropagation(),children:k?f.jsxs(f.Fragment,{children:[f.jsx(On,{tooltipText:"Save (Enter)",onClick:ce=>{ce.stopPropagation(),ne()},disabled:x||!A.trim(),"aria-label":"Save changes",icon:f.jsx(se,{}),iconClassName:pe,className:"h-5 w-5 text-green-500 hover:text-green-600"}),f.jsx(On,{tooltipText:"Cancel (Esc)",onClick:ce=>{ce.stopPropagation(),$()},disabled:x,"aria-label":"Cancel edit",icon:f.jsx(wa,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[C&&f.jsx(On,{tooltipText:"Project Settings",onClick:F,"aria-label":`Settings for ${ee}`,icon:f.jsx(Bpe,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),f.jsx(On,{tooltipText:"Edit",onClick:H,"aria-label":`Edit ${ee}`,icon:f.jsx(s1,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),C?f.jsx(On,{tooltipText:"Export Project (JSON)",onClick:ce=>c(e.id,ce),"aria-label":`Export project ${ee}`,icon:f.jsx(eme,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):f.jsxs("div",{className:"relative group/export",children:[f.jsx(On,{tooltipText:"Export Conversation","aria-label":`Export ${ee}`,icon:f.jsx(pu,{}),className:"h-5 w-5 text-muted-foreground group-hover/export:text-foreground"}),f.jsxs("div",{className:`absolute right-0 top-full mt-1 hidden group-hover/export:flex
                                 bg-popover border border-border rounded-md shadow-lg p-0.5 z-10 gap-0.5`,onClick:ce=>ce.stopPropagation(),children:[f.jsx(bt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ce=>l(e.id,"json",ce),children:"JSON"}),f.jsx(bt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ce=>l(e.id,"md",ce),children:"MD"})]})]}),f.jsx(On,{tooltipText:"Delete",onClick:U,"aria-label":`Delete ${ee}`,icon:f.jsx(Eo,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]})});mle.displayName="ConversationItemRenderer";function mQe({updateProject:e,updateConversation:t,deleteProject:n}){const[r,s]=T.useState(null),[i,a]=T.useState(null),[o,l]=T.useState(""),[c,u]=T.useState(!1),d=T.useCallback(y=>{s(y.id),a(y.itemType);const b=y.itemType==="project"?y.name:y.title;l(b),u(!1)},[]),h=T.useCallback(y=>{const b=r,v=y??(i==="project"&&o==="New Project");s(null),a(null),l(""),u(!1),v&&b&&n(b).catch(x=>{console.error("Failed to delete new project on cancel:",x),Oe.error("Failed to clean up cancelled new project.")})},[r,i,o,n]),m=T.useCallback(async(y,b,v)=>{if(y!==r||b!==i||c)return;const x=v==null?void 0:v.trim();if(!x){Oe.error("Name cannot be empty.");return}if(x===o&&!(b==="project"&&o==="New Project")){h();return}u(!0);try{b==="project"?await e(y,{name:x}):await t(y,{title:x}),Oe.success("Item renamed successfully."),s(null),a(null),l("")}catch(S){console.error("Failed to save item name:",S),Oe.error(`Failed to rename item: ${S instanceof Error?S.message:String(S)}`)}finally{u(!1)}},[r,i,c,e,t,h,o]);return{editingItemId:r,editingItemType:i,isSavingEdit:c,handleStartEditing:d,handleSaveEdit:m,handleCancelEdit:h,originalNameToCompare:o}}const gle=(e,t,n,r,s,i,a,o,l)=>{if(!n)return!0;const c=`${t}-${e}`;if(l[c]!==void 0)return l[c];let u=!1;{const d=i.get(e);if(d)if(d.name.toLowerCase().includes(n))u=!0;else{const h=o.get(e)||[],m=a.get(e)||[];for(const y of m)if(y.title.toLowerCase().includes(n)){u=!0;break}if(!u){for(const y of h)if(gle(y.id,"project",n,r,s,i,a,o,l)){u=!0;break}}}}return l[c]=u,u},gQe=({module:e})=>{const t=T.useRef(null),n=T.useRef(null),[r,s]=T.useState(!1),[,i]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>i({})),e.isLoading&&!qn.getState().isLoading&&!Oo.getState().isLoading&&e.setIsLoading(!1),()=>e.setNotifyCallback(null)),[e]),T.useEffect(()=>{const me=t.current;if(me){const Ae=me.querySelector("[data-radix-scroll-area-viewport]");if(Ae&&n.current!==Ae?(n.current=Ae,r||s(!0),i({})):!Ae&&n.current&&(n.current=null,s(!1)),!n.current){const le=new MutationObserver(()=>{const oe=me.querySelector("[data-radix-scroll-area-viewport]");oe&&n.current!==oe&&(n.current=oe,s(!0),i({}),le.disconnect())});return le.observe(me,{childList:!0,subtree:!0}),()=>le.disconnect()}}},[t.current,r]);const{selectedItemId:a,selectedItemType:o,conversations:l,syncRepos:c,conversationSyncStatus:u,selectItem:d,addConversation:h,updateConversation:m,deleteConversation:y,exportConversation:b,exportProject:v,getConversationById:x}=qn(yn(me=>({selectedItemId:me.selectedItemId,selectedItemType:me.selectedItemType,conversations:me.conversations,syncRepos:me.syncRepos,conversationSyncStatus:me.conversationSyncStatus,selectItem:me.selectItem,addConversation:me.addConversation,updateConversation:me.updateConversation,deleteConversation:me.deleteConversation,exportConversation:me.exportConversation,exportProject:me.exportProject,getConversationById:me.getConversationById}))),{projects:w,addProject:S,updateProject:C,deleteProject:k,getProjectById:A}=Oo(yn(me=>({projects:me.projects,addProject:me.addProject,updateProject:me.updateProject,deleteProject:me.deleteProject,getProjectById:me.getProjectById}))),R=e.isLoading,[N,I]=We.useState(new Set),[O,L]=T.useState(""),P=mQe({updateProject:C,updateConversation:m,deleteProject:k}),{editingItemId:V,editingItemType:F,isSavingEdit:X,handleStartEditing:U,handleSaveEdit:H,handleCancelEdit:$,originalNameToCompare:ne}=P,W=T.useCallback(me=>{I(Ae=>{const le=new Set(Ae);return le.has(me)?le.delete(me):le.add(me),le})},[]),Q=T.useCallback(()=>{if(o==="project")return a;if(o==="conversation"&&a){const me=x(a);return(me==null?void 0:me.projectId)??null}return null},[a,o,x]),ee=T.useCallback(async()=>{if(!V)try{const me=Q(),Ae=await h({title:"New Chat",projectId:me});d(Ae,"conversation")}catch(me){console.error("Failed to create new chat:",me),Oe.error("Failed to create new chat.")}},[V,Q,h,d]),se=T.useCallback(async()=>{if(!V)try{const me=Q(),Ae=await S({name:"New Project",parentId:me});d(Ae,"project"),me&&I(le=>new Set(le).add(me)),setTimeout(()=>{const le=A(Ae);le&&U({...le,itemType:"project"})},50)}catch(me){console.error("Failed to create new project:",me)}},[V,Q,S,d,A,U]),pe=T.useCallback((me,Ae)=>{me===V&&Ae===F||(V&&(me!==V||Ae!==F)&&$(),(me!==a||Ae!==o)&&d(me,Ae))},[V,F,a,o,$,d]),ce=T.useCallback((me,Ae)=>{Ae.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&y(me).catch(le=>{console.error("Failed to delete conversation:",le),Oe.error("Failed to delete conversation.")})},[y]),Ie=T.useCallback((me,Ae)=>{Ae.stopPropagation(),k(me).catch(le=>{console.error("Failed to delete project:",le),Oe.error("Failed to delete project.")})},[k]),De=T.useCallback(async(me,Ae,le)=>{le.stopPropagation();try{await b(me,Ae)}catch(oe){console.error(`Failed to export conversation as ${Ae}:`,oe)}},[b]),Se=T.useCallback(async(me,Ae)=>{Ae.stopPropagation();try{await v(me)}catch(le){console.error("Failed to export project:",le)}},[v]),Ce=T.useMemo(()=>new Map((c||[]).map(me=>[me.id,me.name])),[c]),{projectsById:qe,conversationsByProjectId:Qe,projectsByParentId:Ve}=T.useMemo(()=>{const me=new Map(w.map(oe=>[oe.id,oe])),Ae=new Map;l.forEach(oe=>{const re=oe.projectId??null;Ae.has(re)||Ae.set(re,[]),Ae.get(re).push(oe)});const le=new Map;return w.forEach(oe=>{const re=oe.parentId??null;le.has(re)||le.set(re,[]),le.get(re).push(oe)}),{projectsById:me,conversationsByProjectId:Ae,projectsByParentId:le}},[w,l]),Ne=T.useMemo(()=>{const me=[],Ae=O.toLowerCase(),le={};function oe(re,Te){const Be=(Ve.get(re)||[]).filter(Rt=>gle(Rt.id,"project",Ae,w,l,qe,Qe,Ve,le)),ke=(Qe.get(re)||[]).filter(Rt=>Rt.title.toLowerCase().includes(Ae)),lt=[...Be,...ke];lt.sort((Rt,ft)=>new Date(ft.updatedAt).getTime()-new Date(Rt.updatedAt).getTime()),lt.forEach(Rt=>{"path"in Rt?(me.push({id:`project-${Rt.id}`,originalId:Rt.id,type:"project",level:Te,data:Rt,updatedAt:Rt.updatedAt}),N.has(Rt.id)&&oe(Rt.id,Te+1)):me.push({id:`conversation-${Rt.id}`,originalId:Rt.id,type:"conversation",level:Te,data:Rt,updatedAt:Rt.updatedAt})})}return oe(null,0),me},[w,l,O,N,qe,Qe,Ve]),K=C5({count:Ne.length,getScrollElement:()=>n.current,estimateSize:()=>30,overscan:10});return f.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("h3",{className:"text-sm font-semibold",children:"LiteChat"}),f.jsx(xd,{href:"https://github.com/DimitriGilbert/LiteChat",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub Repository",children:f.jsx(bt,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(xme,{className:"h-4 w-4"})})}),f.jsx(xd,{href:"release/latest.zip",download:"LiteChat.zip","aria-label":"Download LiteChat",children:f.jsx(bt,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(pu,{className:"h-4 w-4"})})})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{size:"sm",variant:"ghost",onClick:se,"aria-label":"New Project",disabled:R||!!V,className:"h-7 w-7 p-0",children:f.jsx(cH,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"bottom",children:"New Project"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{size:"sm",variant:"ghost",onClick:ee,"aria-label":"New Chat",disabled:R||!!V,className:"h-7 w-7 p-0",children:f.jsx(Pd,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"bottom",children:"New Chat"})]})})]})]}),f.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[f.jsx(Fa,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter...",value:O,onChange:me=>L(me.target.value),className:"h-8 text-xs pl-8",disabled:R})]}),f.jsxs(Po,{className:"flex-grow",ref:t,children:[R&&Ne.length===0?f.jsxs("div",{className:"space-y-1 p-1",children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):!R&&Ne.length===0?f.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:O.trim()!==""?"No items match your filter.":"Workspace is empty."}):r&&f.jsx("div",{style:{height:`${K.getTotalSize()}px`,width:"100%",position:"relative"},children:K.getVirtualItems().map(me=>{const Ae=Ne[me.index];if(!Ae)return null;const le={...Ae.data,itemType:Ae.type};return f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${me.size}px`,transform:`translateY(${me.start}px)`},className:"px-1",children:f.jsx(mle,{item:le,level:Ae.level,selectedItemId:a,conversationSyncStatus:u,repoNameMap:Ce,onSelectItem:()=>pe(Ae.originalId,Ae.type),onDeleteConversation:ce,onDeleteProject:Ie,onExportConversation:De,onExportProject:Se,expandedProjects:N,toggleProjectExpansion:W,editingItemId:V,editingItemType:F,handleStartEditing:U,handleSaveEdit:H,handleCancelEdit:$,isSavingEdit:X,originalNameToCompare:ne})},Ae.id)})}),!r&&!R&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},yQe=({module:e})=>{const{selectedItemType:t}=qn(yn(r=>({selectedItemType:r.selectedItemType})));return e.isLoading?f.jsx(Qn,{className:"h-5 w-5 animate-spin text-muted-foreground"}):t==="project"?f.jsx(fh,{className:"h-5 w-5 text-primary"}):t==="conversation"?f.jsx(gB,{className:"h-5 w-5 text-primary"}):f.jsx(gB,{className:"h-5 w-5 text-muted-foreground"})};class bQe{constructor(){ve(this,"id","core-conversation-list");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"isLoading",!0);ve(this,"conversationsLoading",!0);ve(this,"projectsLoading",!0);ve(this,"notifyComponentUpdate",null);ve(this,"setIsLoading",t=>{var n;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.conversationsLoading=qn.getState().isLoading,this.projectsLoading=Oo.getState().isLoading,this.updateCombinedLoadingState(),t.emit(Yn.loadConversationsRequest,void 0),t.emit(ba.loadProjectsRequest,void 0);const n=t.on(Yn.conversationsLoaded,()=>{this.conversationsLoading=!1,this.updateCombinedLoadingState()}),r=t.on(ba.loaded,()=>{this.projectsLoading=!1,this.updateCombinedLoadingState()}),s=t.on(Yn.loadingStateChanged,a=>{a.isLoading!==this.conversationsLoading&&(this.conversationsLoading=a.isLoading,this.updateCombinedLoadingState())}),i=t.on(ba.loadingStateChanged,a=>{a.isLoading!==this.projectsLoading&&(this.projectsLoading=a.isLoading,this.updateCombinedLoadingState())});this.eventUnsubscribers.push(n,r,s,i)}updateCombinedLoadingState(){var n;const t=this.conversationsLoading||this.projectsLoading;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Module "${this.id}" already registered. Skipping.`);return}this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar",status:()=>this.isLoading?"loading":"ready",renderer:()=>We.createElement(gQe,{module:this}),iconRenderer:()=>We.createElement(yQe,{module:this}),show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const ZV=({module:e})=>{const t=(n,r)=>{e.openSettingsModal(n,r)};return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",onClick:()=>t(),className:"h-8 w-8","aria-label":"Open Settings",children:f.jsx(Q2,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Settings"})]})})};var v3="focusScope.autoFocusOnMount",x3="focusScope.autoFocusOnUnmount",XV={bubbles:!1,cancelable:!0},vQe="FocusScope",E5=T.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=T.useState(null),c=Cs(s),u=Cs(i),d=T.useRef(null),h=Rn(t,b=>l(b)),m=T.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;T.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const C=S.target;o.contains(C)?d.current=C:eh(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const C=S.relatedTarget;C!==null&&(o.contains(C)||eh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const k of S)k.removedNodes.length>0&&eh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),T.useEffect(()=>{if(o){QV.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(v3,XV);o.addEventListener(v3,c),o.dispatchEvent(x),x.defaultPrevented||(xQe(kQe(yle(o)),{select:!0}),document.activeElement===b&&eh(o))}return()=>{o.removeEventListener(v3,c),setTimeout(()=>{const x=new CustomEvent(x3,XV);o.addEventListener(x3,u),o.dispatchEvent(x),x.defaultPrevented||eh(b??document.body,{select:!0}),o.removeEventListener(x3,u),QV.remove(m)},0)}}},[o,c,u,m]);const y=T.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,C]=wQe(w);S&&C?!b.shiftKey&&x===C?(b.preventDefault(),n&&eh(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&eh(C,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(ar.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});E5.displayName=vQe;function xQe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(eh(r,{select:t}),document.activeElement!==n)return}function wQe(e){const t=yle(e),n=JV(t,e),r=JV(t.reverse(),e);return[n,r]}function yle(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function JV(e,t){for(const n of e)if(!_Qe(n,{upTo:t}))return n}function _Qe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function SQe(e){return e instanceof HTMLInputElement&&"select"in e}function eh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&SQe(e)&&t&&e.select()}}var QV=CQe();function CQe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=eW(e,t),e.unshift(t)},remove(t){var n;e=eW(e,t),(n=e[0])==null||n.resume()}}}function eW(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function kQe(e){return e.filter(t=>t.tagName!=="A")}function EQe(e){const t=TQe(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(RQe);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function TQe(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=MQe(s),o=NQe(i,s.props);return s.type!==T.Fragment&&(o.ref=r?ll(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var AQe=Symbol("radix.slottable");function RQe(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===AQe}function NQe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function MQe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var tA="Dialog",[ble,cdt]=Wi(tA),[IQe,Pc]=ble(tA),vle=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,o=T.useRef(null),l=T.useRef(null),[c,u]=Ec({prop:r,defaultProp:s??!1,onChange:i,caller:tA});return f.jsx(IQe,{scope:t,triggerRef:o,contentRef:l,contentId:ia(),titleId:ia(),descriptionId:ia(),open:c,onOpenChange:u,onOpenToggle:T.useCallback(()=>u(d=>!d),[u]),modal:a,children:n})};vle.displayName=tA;var xle="DialogTrigger",jQe=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Pc(xle,n),i=Rn(t,s.triggerRef);return f.jsx(ar.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":R5(s.open),...r,ref:i,onClick:Wt(e.onClick,s.onOpenToggle)})});jQe.displayName=xle;var T5="DialogPortal",[OQe,wle]=ble(T5,{forceMount:void 0}),_le=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=Pc(T5,t);return f.jsx(OQe,{scope:t,forceMount:n,children:T.Children.map(r,a=>f.jsx(oa,{present:n||i.open,children:f.jsx(EE,{asChild:!0,container:s,children:a})}))})};_le.displayName=T5;var Qk="DialogOverlay",Sle=T.forwardRef((e,t)=>{const n=wle(Qk,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Pc(Qk,e.__scopeDialog);return i.modal?f.jsx(oa,{present:r||i.open,children:f.jsx(DQe,{...s,ref:t})}):null});Sle.displayName=Qk;var PQe=EQe("DialogOverlay.RemoveScroll"),DQe=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Pc(Qk,n);return f.jsx(e_,{as:PQe,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(ar.div,{"data-state":R5(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),km="DialogContent",Cle=T.forwardRef((e,t)=>{const n=wle(km,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Pc(km,e.__scopeDialog);return f.jsx(oa,{present:r||i.open,children:i.modal?f.jsx(FQe,{...s,ref:t}):f.jsx(LQe,{...s,ref:t})})});Cle.displayName=km;var FQe=T.forwardRef((e,t)=>{const n=Pc(km,e.__scopeDialog),r=T.useRef(null),s=Rn(t,n.contentRef,r);return T.useEffect(()=>{const i=r.current;if(i)return GT(i)},[]),f.jsx(kle,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&i.preventDefault()}),onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault())})}),LQe=T.forwardRef((e,t)=>{const n=Pc(km,e.__scopeDialog),r=T.useRef(!1),s=T.useRef(!1);return f.jsx(kle,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),kle=T.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,o=Pc(km,n),l=T.useRef(null),c=Rn(t,l);return WT(),f.jsxs(f.Fragment,{children:[f.jsx(E5,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(wE,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":R5(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(BQe,{titleId:o.titleId}),f.jsx(zQe,{contentRef:l,descriptionId:o.descriptionId})]})]})}),A5="DialogTitle",Ele=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Pc(A5,n);return f.jsx(ar.h2,{id:s.titleId,...r,ref:t})});Ele.displayName=A5;var Tle="DialogDescription",Ale=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Pc(Tle,n);return f.jsx(ar.p,{id:s.descriptionId,...r,ref:t})});Ale.displayName=Tle;var Rle="DialogClose",Nle=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Pc(Rle,n);return f.jsx(ar.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});Nle.displayName=Rle;function R5(e){return e?"open":"closed"}var Mle="DialogTitleWarning",[udt,Ile]=sxe(Mle,{contentName:km,titleName:A5,docsSlug:"dialog"}),BQe=({titleId:e})=>{const t=Ile(Mle),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return T.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},$Qe="DialogDescriptionWarning",zQe=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Ile($Qe).contentName}}.`;return T.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},jle=vle,Ole=_le,Ple=Sle,Dle=Cle,UQe=Ele,qQe=Ale,Fle=Nle;function Ym({...e}){return f.jsx(jle,{"data-slot":"dialog",...e})}function VQe({...e}){return f.jsx(Ole,{"data-slot":"dialog-portal",...e})}function WQe({...e}){return f.jsx(Fle,{"data-slot":"dialog-close",...e})}function HQe({className:e,...t}){return f.jsx(Ple,{"data-slot":"dialog-overlay",className:Ze("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function Zm({className:e,children:t,...n}){return f.jsxs(VQe,{"data-slot":"dialog-portal",children:[f.jsx(HQe,{}),f.jsxs(Dle,{"data-slot":"dialog-content",className:Ze("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,f.jsxs(Fle,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[f.jsx(wa,{}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Xm({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-header",className:Ze("flex flex-col gap-2 text-center sm:text-left",e),...t})}function ub({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-footer",className:Ze("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function Jm({className:e,...t}){return f.jsx(UQe,{"data-slot":"dialog-title",className:Ze("text-lg leading-none font-semibold",e),...t})}function db({className:e,...t}){return f.jsx(qQe,{"data-slot":"dialog-description",className:Ze("text-muted-foreground text-sm",e),...t})}function tW(e){const t=GQe(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(YQe);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function GQe(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=XQe(s),o=ZQe(i,s.props);return s.type!==T.Fragment&&(o.ref=r?ll(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var KQe=Symbol("radix.slottable");function YQe(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===KQe}function ZQe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function XQe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function N5(e){const t=e+"CollectionProvider",[n,r]=Wi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=We.useRef(null),S=We.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=tW(o),c=We.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),C=Rn(v,S.collectionRef);return f.jsx(l,{ref:C,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=tW(u),m=We.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,C=We.useRef(null),k=Rn(v,C),A=i(u,x);return We.useEffect(()=>(A.itemMap.set(C,{ref:C,...S}),()=>void A.itemMap.delete(C))),f.jsx(h,{[d]:"",ref:k,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return We.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((A,R)=>S.indexOf(A.ref.current)-S.indexOf(R.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var w3="rovingFocusGroup.onEntryFocus",JQe={bubbles:!1,cancelable:!0},n_="RovingFocusGroup",[pO,Lle,QQe]=N5(n_),[eet,nA]=Wi(n_,[QQe]),[tet,net]=eet(n_),Ble=T.forwardRef((e,t)=>f.jsx(pO.Provider,{scope:e.__scopeRovingFocusGroup,children:f.jsx(pO.Slot,{scope:e.__scopeRovingFocusGroup,children:f.jsx(ret,{...e,ref:t})})}));Ble.displayName=n_;var ret=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=T.useRef(null),m=Rn(t,h),y=ib(i),[b,v]=Ec({prop:a,defaultProp:o??null,onChange:l,caller:n_}),[x,w]=T.useState(!1),S=Cs(c),C=Lle(n),k=T.useRef(!1),[A,R]=T.useState(0);return T.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(w3,S),()=>N.removeEventListener(w3,S)},[S]),f.jsx(tet,{scope:n,orientation:r,dir:y,loop:s,currentTabStopId:b,onItemFocus:T.useCallback(N=>v(N),[v]),onItemShiftTab:T.useCallback(()=>w(!0),[]),onFocusableItemAdd:T.useCallback(()=>R(N=>N+1),[]),onFocusableItemRemove:T.useCallback(()=>R(N=>N-1),[]),children:f.jsx(ar.div,{tabIndex:x||A===0?-1:0,"data-orientation":r,...d,ref:m,style:{outline:"none",...e.style},onMouseDown:Wt(e.onMouseDown,()=>{k.current=!0}),onFocus:Wt(e.onFocus,N=>{const I=!k.current;if(N.target===N.currentTarget&&I&&!x){const O=new CustomEvent(w3,JQe);if(N.currentTarget.dispatchEvent(O),!O.defaultPrevented){const L=C().filter(U=>U.focusable),P=L.find(U=>U.active),V=L.find(U=>U.id===b),X=[P,V,...L].filter(Boolean).map(U=>U.ref.current);Ule(X,u)}}k.current=!1}),onBlur:Wt(e.onBlur,()=>w(!1))})})}),$le="RovingFocusGroupItem",zle=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:a,...o}=e,l=ia(),c=i||l,u=net($le,n),d=u.currentTabStopId===c,h=Lle(n),{onFocusableItemAdd:m,onFocusableItemRemove:y,currentTabStopId:b}=u;return T.useEffect(()=>{if(r)return m(),()=>y()},[r,m,y]),f.jsx(pO.ItemSlot,{scope:n,id:c,focusable:r,active:s,children:f.jsx(ar.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Wt(e.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:Wt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Wt(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=aet(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let S=h().filter(C=>C.focusable).map(C=>C.ref.current);if(x==="last")S.reverse();else if(x==="prev"||x==="next"){x==="prev"&&S.reverse();const C=S.indexOf(v.currentTarget);S=u.loop?oet(S,C+1):S.slice(C+1)}setTimeout(()=>Ule(S))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:b!=null}):a})})});zle.displayName=$le;var set={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function iet(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function aet(e,t,n){const r=iet(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return set[r]}function Ule(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function oet(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var qle=Ble,Vle=zle,rA="Tabs",[cet,ddt]=Wi(rA,[nA]),Wle=nA(),[uet,M5]=cet(rA),Hle=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=ib(o),[d,h]=Ec({prop:r,onChange:s,defaultProp:i??"",caller:rA});return f.jsx(uet,{scope:n,baseId:ia(),value:d,onValueChange:h,orientation:a,dir:u,activationMode:l,children:f.jsx(ar.div,{dir:u,"data-orientation":a,...c,ref:t})})});Hle.displayName=rA;var Gle="TabsList",Kle=T.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=M5(Gle,n),a=Wle(n);return f.jsx(qle,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:f.jsx(ar.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});Kle.displayName=Gle;var Yle="TabsTrigger",Zle=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,a=M5(Yle,n),o=Wle(n),l=Qle(a.baseId,r),c=ece(a.baseId,r),u=r===a.value;return f.jsx(Vle,{asChild:!0,...o,focusable:!s,active:u,children:f.jsx(ar.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:t,onMouseDown:Wt(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:Wt(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:Wt(e.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!s&&d&&a.onValueChange(r)})})})});Zle.displayName=Yle;var Xle="TabsContent",Jle=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...a}=e,o=M5(Xle,n),l=Qle(o.baseId,r),c=ece(o.baseId,r),u=r===o.value,d=T.useRef(u);return T.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),f.jsx(oa,{present:s||u,children:({present:h})=>f.jsx(ar.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&i})})});Jle.displayName=Xle;function Qle(e,t){return`${e}-trigger-${t}`}function ece(e,t){return`${e}-content-${t}`}var det=Hle,fet=Kle,het=Zle,pet=Jle;function met({className:e,...t}){return f.jsx(det,{"data-slot":"tabs",className:Ze("flex flex-col gap-2",e),...t})}function get({className:e,...t}){return f.jsx(fet,{"data-slot":"tabs-list",className:Ze("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function yet({className:e,...t}){return f.jsx(het,{"data-slot":"tabs-trigger",className:Ze("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function bet({className:e,...t}){return f.jsx(pet,{"data-slot":"tabs-content",className:Ze("flex-1 outline-none",e),...t})}const Dc=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:s,listClassName:i,contentContainerClassName:a,scrollable:o})=>{var m;const[l,c]=T.useState(n??t??((m=e[0])==null?void 0:m.value));T.useEffect(()=>{n!==void 0&&n!==l&&c(n)},[n,l]);const u=y=>{console.log("handleValueChange",y),c(y),r&&r(y)},d=Ze("px-1 py-0.25 text-xs sm:px-3 sm:py-1.5 sm:text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),h=({children:y})=>{const v=Ze(o?"flex-grow overflow-y-auto pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2":"flex-grow pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",a);return o?f.jsx(Po,{className:v,children:y}):f.jsx("div",{className:v,children:y})};return f.jsxs(met,{value:l,onValueChange:u,defaultValue:t,className:Ze("flex flex-col h-full",s),children:[f.jsx(get,{className:Ze("flex-shrink-0 sticky top-0 bg-background z-10 flex-wrap h-auto justify-start border-b gap-0.5 sm:gap-1 p-0.5 sm:p-1 px-2 sm:px-6",i),children:e.map(y=>f.jsx(yet,{value:y.value,disabled:y.disabled,className:d,children:y.label},y.value))}),f.jsx(h,{children:e.map(y=>f.jsx(bet,{value:y.value,className:"data-[state=inactive]:hidden h-full",children:y.content},y.value))})]})},tce=T.memo(({isOpen:e,onClose:t,initialTab:n})=>{const{modSettingsTabs:r}=jh(yn(u=>({modSettingsTabs:u.modSettingsTabs||[]}))),s=T.useMemo(()=>[...r.map(h=>{const m=h.component;return{value:h.id,label:h.title,content:f.jsx(m,{}),order:h.order??999}})].sort((h,m)=>(h.order??999)-(m.order??999)),[r]),i=T.useCallback(()=>s.length>0?s[0].value:"general",[s]),[a,o]=T.useState(i());T.useEffect(()=>{if(e){let u=i();n&&s.some(d=>d.value===n)?u=n:n&&(console.warn(`[SettingsModal] Initial tab "${n}" not found. Defaulting to "${u}".`),Oe.error(`Settings tab "${n}" not found. Opening default tab.`)),o(u)}},[e,n,s,i]);const l=u=>{u||t()},c=u=>{o(u)};return f.jsx(Ym,{open:e,onOpenChange:l,children:f.jsxs(Zm,{className:Ze("w-[95vw] h-[90vh] flex flex-col p-0","sm:w-[90vw] sm:h-[85vh]","md:w-[85vw] md:max-w-[1200px] md:h-[80vh]","lg:w-[75vw]","min-h-[500px] max-h-[95vh]"),children:[f.jsxs(Xm,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsx(Jm,{children:"Settings"}),f.jsx(db,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),s.length>0?f.jsx(Dc,{tabs:s,initialValue:a,onValueChange:c,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"flex-grow overflow-y-auto pb-4 md:pb-6",scrollable:!1},a):f.jsx("div",{className:"flex-grow flex items-center justify-center text-muted-foreground p-4",children:"No settings tabs available or still loading. Check console for module registration errors."}),f.jsx(ub,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:f.jsx(bt,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});tce.displayName="SettingsModalComponent";const vet=tce;class xet{constructor(){ve(this,"id","core-settings-trigger");ve(this,"modalId","settingsModal");ve(this,"unregisterChatControlCallback",null);ve(this,"unregisterModalProviderCallback",null);ve(this,"modApiRef",null);ve(this,"openSettingsModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(jr.openModalRequest,{modalId:this.modalId,initialTab:t||"general",initialSubTab:n})});ve(this,"closeSettingsModal",()=>{var t;(t=this.modApiRef)==null||t.emit(jr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterChatControlCallback&&this.unregisterModalProviderCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterChatControlCallback||(this.unregisterChatControlCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:()=>We.createElement(ZV,{module:this}),iconRenderer:()=>We.createElement(ZV,{module:this}),show:()=>!0})),this.unregisterModalProviderCallback||(this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>We.createElement(vet,{isOpen:n.isOpen,onClose:n.onClose,initialTab:n.initialTab,initialSubTab:n.initialSubTab})))}destroy(){this.unregisterChatControlCallback&&(this.unregisterChatControlCallback(),this.unregisterChatControlCallback=null),this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const wet=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsSidebarCollapsed();return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",onClick:()=>e.toggleSidebar(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?f.jsx(Yme,{className:"h-4 w-4"}):f.jsx(Gme,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};class _et{constructor(){ve(this,"id","core-sidebar-toggle");ve(this,"unregisterCallback",null);ve(this,"notifyComponentUpdate",null);ve(this,"modApiRef",null);ve(this,"getIsSidebarCollapsed",()=>Yw.getState().isSidebarCollapsed);ve(this,"toggleSidebar",t=>{var s,i;const n=Yw.getState().isSidebarCollapsed,r=t??!n;n!==r&&((s=this.modApiRef)==null||s.emit(jr.toggleSidebarRequest,{isCollapsed:r}),(i=this.notifyComponentUpdate)==null||i.call(this))});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>We.createElement(wet,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}function Ay({form:e,name:t,label:n,placeholder:r,disabled:s,wrapperClassName:i,allowNull:a=!1,min:o,max:l,step:c,className:u,onBlurInput:d,...h}){return f.jsx(e.Field,{name:t,children:m=>{const y=x=>{const w=x.target.value;if(w===""&&a)m.handleChange(null);else{const S=parseFloat(w);isNaN(S)?w===""&&!a&&m.handleChange(w):m.handleChange(S)}},b=typeof m.state.value=="number"?m.state.value.toString():(m.state.value===null&&a,""),v=x=>{m.handleBlur(),d&&d(x)};return f.jsxs("div",{className:Ze("space-y-1.5",i),children:[" ",f.jsx(Dt,{htmlFor:m.name,className:"text-sm",children:n}),f.jsx(Cn,{id:m.name,name:m.name,type:"number",value:b,onBlur:v,onChange:y,placeholder:r,disabled:s??m.form.state.isSubmitting,min:o,max:l,step:c,className:Ze(u,m.state.meta.errors.length?"border-destructive":""),...h}),f.jsx(Ni,{field:m})]})}})}var nce=["PageUp","PageDown"],rce=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],sce={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},fb="Slider",[mO,Cet,ket]=N5(fb),[ice,fdt]=Wi(fb,[ket]),[Eet,sA]=ice(fb),ace=T.forwardRef((e,t)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:m=!1,form:y,...b}=e,v=T.useRef(new Set),x=T.useRef(0),S=a==="horizontal"?Tet:Aet,[C=[],k]=Ec({prop:u,defaultProp:c,onChange:L=>{var V;(V=[...v.current][x.current])==null||V.focus(),d(L)}}),A=T.useRef(C);function R(L){const P=jet(C,L);O(L,P)}function N(L){O(L,x.current)}function I(){const L=A.current[x.current];C[x.current]!==L&&h(C)}function O(L,P,{commit:V}={commit:!1}){const F=Fet(i),X=Let(Math.round((L-r)/i)*i+r,F),U=Bw(X,[r,s]);k((H=[])=>{const $=Met(H,U,P);if(Det($,l*i)){x.current=$.indexOf(U);const ne=String($)!==String(H);return ne&&V&&h($),ne?$:H}else return H})}return f.jsx(Eet,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:s,valueIndexToChangeRef:x,thumbs:v.current,values:C,orientation:a,form:y,children:f.jsx(mO.Provider,{scope:e.__scopeSlider,children:f.jsx(mO.Slot,{scope:e.__scopeSlider,children:f.jsx(S,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:t,onPointerDown:Wt(b.onPointerDown,()=>{o||(A.current=C)}),min:r,max:s,inverted:m,onSlideStart:o?void 0:R,onSlideMove:o?void 0:N,onSlideEnd:o?void 0:I,onHomeKeyDown:()=>!o&&O(r,0,{commit:!0}),onEndKeyDown:()=>!o&&O(s,C.length-1,{commit:!0}),onStepKeyDown:({event:L,direction:P})=>{if(!o){const X=nce.includes(L.key)||L.shiftKey&&rce.includes(L.key)?10:1,U=x.current,H=C[U],$=i*X*P;O(H+$,U,{commit:!0})}}})})})})});ace.displayName=fb;var[oce,lce]=ice(fb,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Tet=T.forwardRef((e,t)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=T.useState(null),m=Rn(t,S=>h(S)),y=T.useRef(void 0),b=ib(s),v=b==="ltr",x=v&&!i||!v&&i;function w(S){const C=y.current||d.getBoundingClientRect(),k=[0,C.width],R=I5(k,x?[n,r]:[r,n]);return y.current=C,R(S-C.left)}return f.jsx(oce,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:f.jsx(cce,{dir:b,"data-orientation":"horizontal",...u,ref:m,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const C=w(S.clientX);a==null||a(C)},onSlideMove:S=>{const C=w(S.clientX);o==null||o(C)},onSlideEnd:()=>{y.current=void 0,l==null||l()},onStepKeyDown:S=>{const k=sce[x?"from-left":"from-right"].includes(S.key);c==null||c({event:S,direction:k?-1:1})}})})}),Aet=T.forwardRef((e,t)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,u=T.useRef(null),d=Rn(t,u),h=T.useRef(void 0),m=!s;function y(b){const v=h.current||u.current.getBoundingClientRect(),x=[0,v.height],S=I5(x,m?[r,n]:[n,r]);return h.current=v,S(b-v.top)}return f.jsx(oce,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:f.jsx(cce,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const v=y(b.clientY);i==null||i(v)},onSlideMove:b=>{const v=y(b.clientY);a==null||a(v)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:b=>{const x=sce[m?"from-bottom":"from-top"].includes(b.key);l==null||l({event:b,direction:x?-1:1})}})})}),cce=T.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,u=sA(fb,n);return f.jsx(ar.span,{...c,ref:t,onKeyDown:Wt(e.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(o(d),d.preventDefault()):nce.concat(rce).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:Wt(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Wt(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&s(d)}),onPointerUp:Wt(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),i(d))})})}),uce="SliderTrack",dce=T.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=sA(uce,n);return f.jsx(ar.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});dce.displayName=uce;var gO="SliderRange",fce=T.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=sA(gO,n),i=lce(gO,n),a=T.useRef(null),o=Rn(t,a),l=s.values.length,c=s.values.map(h=>mce(h,s.min,s.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return f.jsx(ar.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:o,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:d+"%"}})});fce.displayName=gO;var yO="SliderThumb",hce=T.forwardRef((e,t)=>{const n=Cet(e.__scopeSlider),[r,s]=T.useState(null),i=Rn(t,o=>s(o)),a=T.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return f.jsx(Ret,{...e,ref:i,index:a})}),Ret=T.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:s,...i}=e,a=sA(yO,n),o=lce(yO,n),[l,c]=T.useState(null),u=Rn(t,w=>c(w)),d=l?a.form||!!l.closest("form"):!0,h=Dy(l),m=a.values[r],y=m===void 0?0:mce(m,a.min,a.max),b=Iet(r,a.values.length),v=h==null?void 0:h[o.size],x=v?Oet(v,y,o.direction):0;return T.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),f.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${y}% + ${x}px)`},children:[f.jsx(mO.ItemSlot,{scope:e.__scopeSlider,children:f.jsx(ar.span,{role:"slider","aria-label":e["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":m,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:u,style:m===void 0?{display:"none"}:e.style,onFocus:Wt(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&f.jsx(pce,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:m},r)]})});hce.displayName=yO;var Net="RadioBubbleInput",pce=T.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const s=T.useRef(null),i=Rn(s,r),a=HT(t);return T.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(ar.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});pce.displayName=Net;function Met(e=[],t,n){const r=[...e];return r[n]=t,r.sort((s,i)=>s-i)}function mce(e,t,n){const i=100/(n-t)*(e-t);return Bw(i,[0,100])}function Iet(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function jet(e,t){if(e.length===1)return 0;const n=e.map(s=>Math.abs(s-t)),r=Math.min(...n);return n.indexOf(r)}function Oet(e,t,n){const r=e/2,i=I5([0,50],[0,r]);return(r-i(t)*n)*n}function Pet(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function Det(e,t){if(t>0){const n=Pet(e);return Math.min(...n)>=t}return!0}function I5(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function Fet(e){return(String(e).split(".")[1]||"").length}function Let(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var Bet=ace,$et=dce,zet=fce,Uet=hce;function w0({className:e,defaultValue:t,value:n,min:r=0,max:s=100,...i}){const a=T.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,s],[n,t,r,s]);return f.jsxs(Bet,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:s,className:Ze("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[f.jsx($et,{"data-slot":"slider-track",className:Ze("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:f.jsx(zet,{"data-slot":"slider-range",className:Ze("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(o,l)=>f.jsx(Uet,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}function pc({form:e,name:t,label:n,valueLabelPrefix:r="",valueLabelSuffix:s="",valueDisplayPrecision:i=2,showRawValue:a=!1,disabled:o,wrapperClassName:l,className:c,min:u,max:d,step:h,...m}){return f.jsx(e.Field,{name:t,children:y=>{const b=typeof y.state.value=="number"?y.state.value:u??0,v=b.toFixed(i);return f.jsxs("div",{className:Ze("space-y-1.5",l),children:[f.jsxs(Dt,{htmlFor:y.name,className:"text-sm",children:[n," (",r,v,s,")",a&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.state.value,")"]})]}),f.jsx(w0,{id:y.name,name:y.name,value:[b],onValueChange:x=>y.handleChange(x[0]),onBlur:y.handleBlur,disabled:o??y.form.state.isSubmitting,min:u,max:d,step:h,className:Ze(c,y.state.meta.errors.length?"border-destructive":""),...m}),f.jsx(Ni,{field:y})]})}})}const qet=Ke({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),Vet=({module:e,className:t})=>{const n=ni({defaultValues:{temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0},validators:{onChangeAsync:qet,onChangeAsyncDebounceMs:500}});T.useEffect(()=>{n.reset({temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0})},[e.temperature,e.defaultTemperature,e.topP,e.defaultTopP,e.maxTokens,e.defaultMaxTokens,e.topK,e.defaultTopK,e.presencePenalty,e.defaultPresencePenalty,e.frequencyPenalty,e.defaultFrequencyPenalty]);const[,r]=We.useState({});T.useEffect(()=>{const u=()=>r({});return e.setNotifyCallback(u),()=>e.setNotifyCallback(null)},[e]);const s=T.useCallback((u,d,h)=>{var m;((m=n.getFieldMeta(u))==null?void 0:m.errors.length)===0&&d(h)},[n,e]),i=T.useCallback((u,d)=>{var h;if(((h=n.getFieldMeta(u))==null?void 0:h.errors.length)===0){const m=n.getFieldValue(u);d(m)}},[n,e]),a=T.useCallback((u,d,h)=>{n.setFieldValue(u,h),d(null)},[n,e]),o=e.supportedParams,l=e.defaultTemperature!==void 0||e.defaultTopP!==void 0||e.defaultMaxTokens!==void 0||e.defaultTopK!==void 0||e.defaultPresencePenalty!==void 0||e.defaultFrequencyPenalty!==void 0,c=(u,d,h,m,y="N/A")=>{var b;return!l||m===void 0?null:f.jsxs(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a(u,h,m??null),disabled:d===null,children:["Use Default (",((b=m==null?void 0:m.toFixed)==null?void 0:b.call(m,2))??y,")"]})};return f.jsxs("div",{className:Ze("space-y-4 p-4",t),children:[o.has("temperature")&&f.jsxs("div",{className:"space-y-0.5",children:[" ",f.jsx(pc,{form:n,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("temperature",e.setTemperature,u[0]),wrapperClassName:"text-xs"}),c("temperature",e.temperature,e.setTemperature,e.defaultTemperature,"0.70")]}),o.has("top_p")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(pc,{form:n,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("topP",e.setTopP,u[0]),wrapperClassName:"text-xs"}),c("topP",e.topP,e.setTopP,e.defaultTopP,"1.00")]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[" ",o.has("max_tokens")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Ay,{form:n,name:"maxTokens",label:"Max Tokens",placeholder:`Default: ${e.defaultMaxTokens??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("maxTokens",e.setMaxTokens),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("maxTokens",e.maxTokens,e.setMaxTokens,e.defaultMaxTokens,"None")]}),o.has("top_k")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Ay,{form:n,name:"topK",label:"Top K",placeholder:`Default: ${e.defaultTopK??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("topK",e.setTopK),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("topK",e.topK,e.setTopK,e.defaultTopK,"None")]})]}),o.has("presence_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(pc,{form:n,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("presencePenalty",e.setPresencePenalty,u[0]),wrapperClassName:"text-xs"}),c("presencePenalty",e.presencePenalty,e.setPresencePenalty,e.defaultPresencePenalty,"0.00")]}),o.has("frequency_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(pc,{form:n,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("frequencyPenalty",e.setFrequencyPenalty,u[0]),wrapperClassName:"text-xs"}),c("frequencyPenalty",e.frequencyPenalty,e.setFrequencyPenalty,e.defaultFrequencyPenalty,"0.00")]})]})},Wet=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsStreaming();return e.getIsVisible()?f.jsxs(pl,{children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ml,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:f.jsx(gge,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:"Advanced Parameters"})]})}),f.jsx(gl,{className:"w-auto p-0",align:"start",children:f.jsx(Vet,{module:e})})]}):null};class Het{constructor(){ve(this,"id","core-parameters");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"temperature",null);ve(this,"topP",null);ve(this,"maxTokens",null);ve(this,"topK",null);ve(this,"presencePenalty",null);ve(this,"frequencyPenalty",null);ve(this,"defaultTemperature",null);ve(this,"defaultTopP",null);ve(this,"defaultMaxTokens",null);ve(this,"defaultTopK",null);ve(this,"defaultPresencePenalty",null);ve(this,"defaultFrequencyPenalty",null);ve(this,"isStreaming",!1);ve(this,"isVisible",!0);ve(this,"supportedParams",new Set);ve(this,"notifyComponentUpdate",null);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"getIsVisible",()=>this.isVisible);ve(this,"setTemperature",t=>{var n,r;this.temperature=t,(n=this.modApiRef)==null||n.emit(Fn.setTemperatureRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setTopP",t=>{var n,r;this.topP=t,(n=this.modApiRef)==null||n.emit(Fn.setTopPRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setMaxTokens",t=>{var n,r;this.maxTokens=t,(n=this.modApiRef)==null||n.emit(Fn.setMaxTokensRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setTopK",t=>{var n,r;this.topK=t,(n=this.modApiRef)==null||n.emit(Fn.setTopKRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setPresencePenalty",t=>{var n,r;this.presencePenalty=t,(n=this.modApiRef)==null||n.emit(Fn.setPresencePenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setFrequencyPenalty",t=>{var n,r;this.frequencyPenalty=t,(n=this.modApiRef)==null||n.emit(Fn.setFrequencyPenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState(),this.updateSupportedParams();const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var a;this.updateSupportedParams(),this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(sn.enableAdvancedSettingsChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(Fn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;let c=!1;"temperature"in l&&this.temperature!==l.temperature&&(this.temperature=l.temperature??null,c=!0),"topP"in l&&this.topP!==l.topP&&(this.topP=l.topP??null,c=!0),"maxTokens"in l&&this.maxTokens!==l.maxTokens&&(this.maxTokens=l.maxTokens??null,c=!0),"topK"in l&&this.topK!==l.topK&&(this.topK=l.topK??null,c=!0),"presencePenalty"in l&&this.presencePenalty!==l.presencePenalty&&(this.presencePenalty=l.presencePenalty??null,c=!0),"frequencyPenalty"in l&&this.frequencyPenalty!==l.frequencyPenalty&&(this.frequencyPenalty=l.frequencyPenalty??null,c=!0),c&&((o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s,i)}loadInitialState(){const t=yr.getState(),n=Mo.getState();this.isStreaming=Bn.getState().status==="streaming",this.temperature=n.temperature,this.topP=n.topP,this.maxTokens=n.maxTokens,this.topK=n.topK,this.presencePenalty=n.presencePenalty,this.frequencyPenalty=n.frequencyPenalty,this.defaultTemperature=t.temperature,this.defaultTopP=t.topP,this.defaultMaxTokens=t.maxTokens,this.defaultTopK=t.topK,this.defaultPresencePenalty=t.presencePenalty,this.defaultFrequencyPenalty=t.frequencyPenalty,this.updateVisibility()}updateSupportedParams(){var o;const t=Rr.getState();if(!t.selectedModelId){this.supportedParams=new Set;return}const{providerId:n,modelId:r}=yc(t.selectedModelId);if(!n||!r){this.supportedParams=new Set;return}const s=t.dbProviderConfigs.find(l=>l.id===n);if(!s){this.supportedParams=new Set;return}const i=t.dbApiKeys.find(l=>l.id===s.apiKeyId),a=kG(s,r,i==null?void 0:i.value);this.supportedParams=new Set(((o=a==null?void 0:a.metadata)==null?void 0:o.supported_parameters)??[])}updateVisibility(){const r=yr.getState().enableAdvancedSettings&&["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"].some(s=>this.supportedParams.has(s));this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Wet,{module:this}),getParameters:()=>{const n={},r=(s,i)=>{i!==null&&(n[s]=i)};return r("temperature",this.temperature),r("top_p",this.topP),r("max_tokens",this.maxTokens),r("top_k",this.topK),r("presence_penalty",this.presencePenalty),r("frequency_penalty",this.frequencyPenalty),Object.keys(n).length>0?n:void 0}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Get=({module:e})=>{const t=T.useRef(null),[,n]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>n({})),()=>e.setNotifyCallback(null)),[e]);const r=e.getIsStreaming(),s=e.getModelSupportsNonText(),i=T.useCallback(async l=>{const c=l.target.files;if(c){for(const u of Array.from(c))try{let d={};const h=e.isLikelyTextFile(u.name,u.type),m=u.type.startsWith("image/");if(h)d.contentText=await u.text();else if(m&&s){const y=new FileReader,b=new Promise((x,w)=>{y.onload=()=>x(y.result),y.onerror=S=>w(S)});y.readAsDataURL(u);const v=await b;v&&v.includes(",")&&(d.contentBase64=v.split(",")[1])}e.onFileAdd({source:"direct",name:u.name,type:u.type||"application/octet-stream",size:u.size,...d})}catch(d){console.error(`Error processing file ${u.name}:`,d),Oe.error(`Failed to process file "${u.name}": ${d instanceof Error?d.message:String(d)}`)}l.target&&(l.target.value="")}},[e,s]),a=()=>{var l;(l=t.current)==null||l.click()},o=s?"Attach Files (Text, Images, etc.)":"Attach Text Files";return f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:t,onChange:i,multiple:!0,className:"hidden",disabled:r}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{type:"button",variant:"ghost",size:"icon",onClick:a,disabled:r,className:"h-8 w-8","aria-label":o,children:f.jsx(cE,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:o})]})})]})},Ket=({module:e})=>{const[,t]=T.useState({}),n=e.getAttachedFiles(),r=e.getIsStreaming();return T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),n.length===0?null:f.jsx("div",{className:Ze("max-h-40 overflow-y-auto pr-1","flex flex-wrap gap-1"),children:n.map(s=>f.jsx(bZ,{fileMeta:s,onRemove:e.onFileRemove,isReadOnly:r},s.id))})},gce=20,Yet=gce*1024*1024;class Zet{constructor(){ve(this,"id","core-file-attachment");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"isStreaming",!1);ve(this,"modelSupportsNonText",!0);ve(this,"attachedFiles",[]);ve(this,"notifyComponentUpdate",null);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"getModelSupportsNonText",()=>this.modelSupportsNonText);ve(this,"getAttachedFiles",()=>this.attachedFiles);ve(this,"isLikelyTextFile",(t,n)=>zx(t,n));ve(this,"onFileAdd",t=>{var r;if(t.size>Yet){Oe.error(`File "${t.name}" exceeds the ${gce}MB limit.`);return}if(!zx(t.name,t.type)&&!this.modelSupportsNonText){Oe.warning(`File "${t.name}" (${t.type}) cannot be uploaded. The current model only supports text input.`);return}(r=this.modApiRef)==null||r.emit(Ll.addAttachedFileRequest,t)});ve(this,"onFileRemove",t=>{var n;(n=this.modApiRef)==null||n.emit(Ll.removeAttachedFileRequest,{attachmentId:t})});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.isStreaming=Bn.getState().status==="streaming",this.attachedFiles=hh.getState().attachedFilesMetadata,this.updateModelSupport(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var a;this.updateModelSupport(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Ll.attachedFilesChanged,a=>{var o;typeof a=="object"&&a&&"files"in a&&JSON.stringify(this.attachedFiles)!==JSON.stringify(a.files)&&(this.attachedFiles=a.files,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s)}updateModelSupport(){var i,a;const{getSelectedModel:t}=Rr.getState(),n=t(),r=(a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.input_modalities,s=!r||r.some(o=>o!=="text");this.modelSupportsNonText!==s&&(this.modelSupportsNonText=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>We.createElement(Get,{module:this}),renderer:()=>We.createElement(Ket,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Xet=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>{if(e&&typeof e.setNotifyTriggerUpdate=="function")return e.setNotifyTriggerUpdate(()=>t({})),()=>{e&&typeof e.setNotifyTriggerUpdate=="function"&&e.setNotifyTriggerUpdate(null)}},[e]);const n=e&&typeof e.getIsVfsModalOpen=="function"?e.getIsVfsModalOpen():!1,r=e&&typeof e.getSelectedFileIdsCount=="function"?e.getSelectedFileIdsCount():0,s=e&&typeof e.getEnableVfs=="function"?e.getEnableVfs():!1,i=hh.getState().addAttachedFile,a=()=>{const o=Xs.getState().selectedFileIds;if(o.size===0){Oe.info("No files selected in VFS to attach.");return}let l=0;const c=e.getVfsNodes();o.forEach(u=>{const d=c[u];d&&d.type==="file"&&(i({source:"vfs",name:d.name,type:d.mimeType||"application/octet-stream",size:d.size,path:d.path}),l++)}),l>0?(Oe.success(`Attached ${l} file(s) from VFS to the next prompt.`),typeof e.clearVfsSelection=="function"&&e.clearVfsSelection(),e.toggleVfsModal):Oe.warning("No valid files were selected to attach.")};return s?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:Ze("h-8 w-8",n&&"bg-muted text-primary"),onClick:()=>e&&typeof e.toggleVfsModal=="function"&&e.toggleVfsModal(),"aria-label":"Toggle Virtual File System",children:f.jsx(jO,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Virtual Filesystem"})]})}),r>0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(bt,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:a,"aria-label":`Attach ${r} selected VFS file(s)`,children:[f.jsx(cE,{className:"h-4 w-4 mr-1"}),"Attach (",r,")"]})}),f.jsx(Sr,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null};function of({className:e,...t}){return f.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:f.jsx("table",{"data-slot":"table",className:Ze("w-full caption-bottom text-sm",e),...t})})}function np({className:e,...t}){return f.jsx("thead",{"data-slot":"table-header",className:Ze("[&_tr]:border-b",e),...t})}function lf({className:e,...t}){return f.jsx("tbody",{"data-slot":"table-body",className:Ze("[&_tr:last-child]:border-0",e),...t})}function ks({className:e,...t}){return f.jsx("tr",{"data-slot":"table-row",className:Ze("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function Or({className:e,...t}){return f.jsx("th",{"data-slot":"table-head",className:Ze("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function zn({className:e,...t}){return f.jsx("td",{"data-slot":"table-cell",className:Ze("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function Jet({className:e,...t}){return f.jsx("caption",{"data-slot":"table-caption",className:Ze("text-muted-foreground mt-4 text-sm",e),...t})}const yce=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:s,isOperationLoading:i,isMobile:a=!1})=>{const o=l=>{l.key==="Enter"?n():l.key==="Escape"&&r()};return a?f.jsxs("div",{className:"flex items-center gap-2 p-1",children:[f.jsx(fh,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),f.jsx(Cn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary flex-grow",placeholder:"New folder name",disabled:i}),f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx(bt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(ro,{className:"h-4 w-4"})}),f.jsx(bt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(wa,{className:"h-4 w-4"})})]})]}):f.jsxs(ks,{className:"bg-muted/30",children:[f.jsx(zn,{className:"px-2 py-1"}),f.jsx(zn,{className:"px-2 py-1",children:f.jsx(fh,{className:"h-5 w-5 text-yellow-400"})}),f.jsx(zn,{className:"py-1 px-2",colSpan:3,children:f.jsx(Cn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:i})}),f.jsx(zn,{className:"text-right pr-4 py-1",children:f.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(ro,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Create (Enter)"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(wa,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};var Qet=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],j5=Qet.reduce((e,t)=>{const n=_u(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),iA="Checkbox",[ett,hdt]=Wi(iA),[ttt,O5]=ett(iA);function ntt(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:s,disabled:i,form:a,name:o,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=e,[h,m]=Ec({prop:n,defaultProp:s??!1,onChange:l,caller:iA}),[y,b]=T.useState(null),[v,x]=T.useState(null),w=T.useRef(!1),S=y?!!a||!!y.closest("form"):!0,C={checked:h,disabled:i,setChecked:m,control:y,setControl:b,name:o,form:a,value:u,hasConsumerStoppedPropagationRef:w,required:c,defaultChecked:dh(s)?!1:s,isFormControl:S,bubbleInput:v,setBubbleInput:x};return f.jsx(ttt,{scope:t,...C,children:rtt(d)?d(C):r})}var bce="CheckboxTrigger",vce=T.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},s)=>{const{control:i,value:a,disabled:o,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:y}=O5(bce,e),b=Rn(s,u),v=T.useRef(l);return T.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const w=()=>d(v.current);return x.addEventListener("reset",w),()=>x.removeEventListener("reset",w)}},[i,d]),f.jsx(j5.button,{type:"button",role:"checkbox","aria-checked":dh(l)?"mixed":l,"aria-required":c,"data-state":kce(l),"data-disabled":o?"":void 0,disabled:o,value:a,...r,ref:b,onKeyDown:Wt(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Wt(n,x=>{d(w=>dh(w)?!0:!w),y&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});vce.displayName=bce;var xce=T.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l,onCheckedChange:c,form:u,...d}=e;return f.jsx(ntt,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:o,required:a,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:h})=>f.jsxs(f.Fragment,{children:[f.jsx(vce,{...d,ref:t,__scopeCheckbox:n}),h&&f.jsx(Cce,{__scopeCheckbox:n})]})})});xce.displayName=iA;var wce="CheckboxIndicator",_ce=T.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=O5(wce,n);return f.jsx(oa,{present:r||dh(i.checked)||i.checked===!0,children:f.jsx(j5.span,{"data-state":kce(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});_ce.displayName=wce;var Sce="CheckboxBubbleInput",Cce=T.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:a,required:o,disabled:l,name:c,value:u,form:d,bubbleInput:h,setBubbleInput:m}=O5(Sce,e),y=Rn(n,m),b=HT(i),v=Dy(r);T.useEffect(()=>{const w=h;if(!w)return;const S=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(S,"checked").set,A=!s.current;if(b!==i&&k){const R=new Event("click",{bubbles:A});w.indeterminate=dh(i),k.call(w,dh(i)?!1:i),w.dispatchEvent(R)}},[h,b,i,s]);const x=T.useRef(dh(i)?!1:i);return f.jsx(j5.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??x.current,required:o,disabled:l,name:c,value:u,form:d,...t,tabIndex:-1,ref:y,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Cce.displayName=Sce;function rtt(e){return typeof e=="function"}function dh(e){return e==="indeterminate"}function kce(e){return dh(e)?"indeterminate":e?"checked":"unchecked"}function Hl({className:e,...t}){return f.jsx(xce,{"data-slot":"checkbox",className:Ze("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(_ce,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:f.jsx(ro,{className:"size-3.5"})})})}function stt(e){const t=itt(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(ott);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function itt(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=ctt(s),o=ltt(i,s.props);return s.type!==T.Fragment&&(o.ref=r?ll(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var att=Symbol("radix.slottable");function ott(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===att}function ltt(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function ctt(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var bO=["Enter"," "],utt=["ArrowDown","PageUp","Home"],Ece=["ArrowUp","PageDown","End"],dtt=[...utt,...Ece],ftt={ltr:[...bO,"ArrowRight"],rtl:[...bO,"ArrowLeft"]},htt={ltr:["ArrowLeft"],rtl:["ArrowRight"]},r_="Menu",[Xw,ptt,mtt]=N5(r_),[Qm,aA]=Wi(r_,[mtt,kE,nA]),oA=kE(),Tce=nA(),[gtt,eg]=Qm(r_),[ytt,s_]=Qm(r_),Ace=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=e,o=oA(t),[l,c]=T.useState(null),u=T.useRef(!1),d=Cs(i),h=ib(s);return T.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),f.jsx(ZG,{...o,children:f.jsx(gtt,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c,children:f.jsx(ytt,{scope:t,onClose:T.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:a,children:r})})})};Ace.displayName=r_;var btt="MenuAnchor",P5=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=oA(n);return f.jsx(XG,{...s,...r,ref:t})});P5.displayName=btt;var D5="MenuPortal",[vtt,Rce]=Qm(D5,{forceMount:void 0}),Nce=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=eg(D5,t);return f.jsx(vtt,{scope:t,forceMount:n,children:f.jsx(oa,{present:n||i.open,children:f.jsx(EE,{asChild:!0,container:s,children:r})})})};Nce.displayName=D5;var ql="MenuContent",[xtt,F5]=Qm(ql),Mce=T.forwardRef((e,t)=>{const n=Rce(ql,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=eg(ql,e.__scopeMenu),a=s_(ql,e.__scopeMenu);return f.jsx(Xw.Provider,{scope:e.__scopeMenu,children:f.jsx(oa,{present:r||i.open,children:f.jsx(Xw.Slot,{scope:e.__scopeMenu,children:a.modal?f.jsx(wtt,{...s,ref:t}):f.jsx(_tt,{...s,ref:t})})})})}),wtt=T.forwardRef((e,t)=>{const n=eg(ql,e.__scopeMenu),r=T.useRef(null),s=Rn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return GT(i)},[]),f.jsx(L5,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),_tt=T.forwardRef((e,t)=>{const n=eg(ql,e.__scopeMenu);return f.jsx(L5,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Stt=stt("MenuContent.ScrollLock"),L5=T.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,disableOutsideScroll:y,...b}=e,v=eg(ql,n),x=s_(ql,n),w=oA(n),S=Tce(n),C=ptt(n),[k,A]=T.useState(null),R=T.useRef(null),N=Rn(t,R,v.onContentChange),I=T.useRef(0),O=T.useRef(""),L=T.useRef(0),P=T.useRef(null),V=T.useRef("right"),F=T.useRef(0),X=y?e_:T.Fragment,U=y?{as:Stt,allowPinchZoom:!0}:void 0,H=ne=>{var De,Se;const W=O.current+ne,Q=C().filter(Ce=>!Ce.disabled),ee=document.activeElement,se=(De=Q.find(Ce=>Ce.ref.current===ee))==null?void 0:De.textValue,pe=Q.map(Ce=>Ce.textValue),ce=Ptt(pe,W,se),Ie=(Se=Q.find(Ce=>Ce.textValue===ce))==null?void 0:Se.ref.current;(function Ce(qe){O.current=qe,window.clearTimeout(I.current),qe!==""&&(I.current=window.setTimeout(()=>Ce(""),1e3))})(W),Ie&&setTimeout(()=>Ie.focus())};T.useEffect(()=>()=>window.clearTimeout(I.current),[]),WT();const $=T.useCallback(ne=>{var Q,ee;return V.current===((Q=P.current)==null?void 0:Q.side)&&Ftt(ne,(ee=P.current)==null?void 0:ee.area)},[]);return f.jsx(xtt,{scope:n,searchRef:O,onItemEnter:T.useCallback(ne=>{$(ne)&&ne.preventDefault()},[$]),onItemLeave:T.useCallback(ne=>{var W;$(ne)||((W=R.current)==null||W.focus(),A(null))},[$]),onTriggerLeave:T.useCallback(ne=>{$(ne)&&ne.preventDefault()},[$]),pointerGraceTimerRef:L,onPointerGraceIntentChange:T.useCallback(ne=>{P.current=ne},[]),children:f.jsx(X,{...U,children:f.jsx(E5,{asChild:!0,trapped:s,onMountAutoFocus:Wt(i,ne=>{var W;ne.preventDefault(),(W=R.current)==null||W.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:f.jsx(wE,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,children:f.jsx(qle,{asChild:!0,...S,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:k,onCurrentTabStopIdChange:A,onEntryFocus:Wt(l,ne=>{x.isUsingKeyboardRef.current||ne.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(JG,{role:"menu","aria-orientation":"vertical","data-state":Gce(v.open),"data-radix-menu-content":"",dir:x.dir,...w,...b,ref:N,style:{outline:"none",...b.style},onKeyDown:Wt(b.onKeyDown,ne=>{const Q=ne.target.closest("[data-radix-menu-content]")===ne.currentTarget,ee=ne.ctrlKey||ne.altKey||ne.metaKey,se=ne.key.length===1;Q&&(ne.key==="Tab"&&ne.preventDefault(),!ee&&se&&H(ne.key));const pe=R.current;if(ne.target!==pe||!dtt.includes(ne.key))return;ne.preventDefault();const Ie=C().filter(De=>!De.disabled).map(De=>De.ref.current);Ece.includes(ne.key)&&Ie.reverse(),jtt(Ie)}),onBlur:Wt(e.onBlur,ne=>{ne.currentTarget.contains(ne.target)||(window.clearTimeout(I.current),O.current="")}),onPointerMove:Wt(e.onPointerMove,Jw(ne=>{const W=ne.target,Q=F.current!==ne.clientX;if(ne.currentTarget.contains(W)&&Q){const ee=ne.clientX>F.current?"right":"left";V.current=ee,F.current=ne.clientX}}))})})})})})})});Mce.displayName=ql;var Ctt="MenuGroup",B5=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(ar.div,{role:"group",...r,ref:t})});B5.displayName=Ctt;var ktt="MenuLabel",Ice=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(ar.div,{...r,ref:t})});Ice.displayName=ktt;var eE="MenuItem",nW="menu.itemSelect",lA=T.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=T.useRef(null),a=s_(eE,e.__scopeMenu),o=F5(eE,e.__scopeMenu),l=Rn(t,i),c=T.useRef(!1),u=()=>{const d=i.current;if(!n&&d){const h=new CustomEvent(nW,{bubbles:!0,cancelable:!0});d.addEventListener(nW,m=>r==null?void 0:r(m),{once:!0}),TG(d,h),h.defaultPrevented?c.current=!1:a.onClose()}};return f.jsx(jce,{...s,ref:l,disabled:n,onClick:Wt(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:Wt(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Wt(e.onKeyDown,d=>{const h=o.searchRef.current!=="";n||h&&d.key===" "||bO.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});lA.displayName=eE;var jce=T.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,a=F5(eE,n),o=Tce(n),l=T.useRef(null),c=Rn(t,l),[u,d]=T.useState(!1),[h,m]=T.useState("");return T.useEffect(()=>{const y=l.current;y&&m((y.textContent??"").trim())},[i.children]),f.jsx(Xw.ItemSlot,{scope:n,disabled:r,textValue:s??h,children:f.jsx(Vle,{asChild:!0,...o,focusable:!r,children:f.jsx(ar.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:Wt(e.onPointerMove,Jw(y=>{r?a.onItemLeave(y):(a.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Wt(e.onPointerLeave,Jw(y=>a.onItemLeave(y))),onFocus:Wt(e.onFocus,()=>d(!0)),onBlur:Wt(e.onBlur,()=>d(!1))})})})}),Ett="MenuCheckboxItem",Oce=T.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return f.jsx(Bce,{scope:e.__scopeMenu,checked:n,children:f.jsx(lA,{role:"menuitemcheckbox","aria-checked":tE(n)?"mixed":n,...s,ref:t,"data-state":z5(n),onSelect:Wt(s.onSelect,()=>r==null?void 0:r(tE(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Oce.displayName=Ett;var Pce="MenuRadioGroup",[Ttt,Att]=Qm(Pce,{value:void 0,onValueChange:()=>{}}),Dce=T.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=Cs(r);return f.jsx(Ttt,{scope:e.__scopeMenu,value:n,onValueChange:i,children:f.jsx(B5,{...s,ref:t})})});Dce.displayName=Pce;var Fce="MenuRadioItem",Lce=T.forwardRef((e,t)=>{const{value:n,...r}=e,s=Att(Fce,e.__scopeMenu),i=n===s.value;return f.jsx(Bce,{scope:e.__scopeMenu,checked:i,children:f.jsx(lA,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":z5(i),onSelect:Wt(r.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,n)},{checkForDefaultPrevented:!1})})})});Lce.displayName=Fce;var $5="MenuItemIndicator",[Bce,Rtt]=Qm($5,{checked:!1}),$ce=T.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=Rtt($5,n);return f.jsx(oa,{present:r||tE(i.checked)||i.checked===!0,children:f.jsx(ar.span,{...s,ref:t,"data-state":z5(i.checked)})})});$ce.displayName=$5;var Ntt="MenuSeparator",zce=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(ar.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});zce.displayName=Ntt;var Mtt="MenuArrow",Uce=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=oA(n);return f.jsx(QG,{...s,...r,ref:t})});Uce.displayName=Mtt;var Itt="MenuSub",[pdt,qce]=Qm(Itt),ux="MenuSubTrigger",Vce=T.forwardRef((e,t)=>{const n=eg(ux,e.__scopeMenu),r=s_(ux,e.__scopeMenu),s=qce(ux,e.__scopeMenu),i=F5(ux,e.__scopeMenu),a=T.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},u=T.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return T.useEffect(()=>u,[u]),T.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),f.jsx(P5,{asChild:!0,...c,children:f.jsx(jce,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":Gce(n.open),...e,ref:ll(t,s.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Wt(e.onPointerMove,Jw(d=>{i.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Wt(e.onPointerLeave,Jw(d=>{var m,y;u();const h=(m=n.content)==null?void 0:m.getBoundingClientRect();if(h){const b=(y=n.content)==null?void 0:y.dataset.side,v=b==="right",x=v?-5:5,w=h[v?"left":"right"],S=h[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:h.top},{x:S,y:h.top},{x:S,y:h.bottom},{x:w,y:h.bottom}],side:b}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Wt(e.onKeyDown,d=>{var m;const h=i.searchRef.current!=="";e.disabled||h&&d.key===" "||ftt[r.dir].includes(d.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),d.preventDefault())})})})});Vce.displayName=ux;var Wce="MenuSubContent",Hce=T.forwardRef((e,t)=>{const n=Rce(ql,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=eg(ql,e.__scopeMenu),a=s_(ql,e.__scopeMenu),o=qce(Wce,e.__scopeMenu),l=T.useRef(null),c=Rn(t,l);return f.jsx(Xw.Provider,{scope:e.__scopeMenu,children:f.jsx(oa,{present:r||i.open,children:f.jsx(Xw.Slot,{scope:e.__scopeMenu,children:f.jsx(L5,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;a.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Wt(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Wt(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:Wt(e.onKeyDown,u=>{var m;const d=u.currentTarget.contains(u.target),h=htt[a.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),(m=o.trigger)==null||m.focus(),u.preventDefault())})})})})})});Hce.displayName=Wce;function Gce(e){return e?"open":"closed"}function tE(e){return e==="indeterminate"}function z5(e){return tE(e)?"indeterminate":e?"checked":"unchecked"}function jtt(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Ott(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Ptt(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=Ott(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function Dtt(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function Ftt(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Dtt(n,t)}function Jw(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Kce=Ace,Yce=P5,Zce=Nce,Xce=Mce,Jce=B5,Qce=Ice,eue=lA,tue=Oce,nue=Dce,rue=Lce,sue=$ce,iue=zce,aue=Uce,oue=Vce,lue=Hce,U5="ContextMenu",[Ltt,mdt]=Wi(U5,[aA]),uo=aA(),[Btt,cue]=Ltt(U5),uue=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:s,modal:i=!0}=e,[a,o]=T.useState(!1),l=uo(t),c=Cs(r),u=T.useCallback(d=>{o(d),c(d)},[c]);return f.jsx(Btt,{scope:t,open:a,onOpenChange:u,modal:i,children:f.jsx(Kce,{...l,dir:s,open:a,onOpenChange:u,modal:i,children:n})})};uue.displayName=U5;var due="ContextMenuTrigger",fue=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=e,i=cue(due,n),a=uo(n),o=T.useRef({x:0,y:0}),l=T.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),c=T.useRef(0),u=T.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{o.current={x:h.clientX,y:h.clientY},i.onOpenChange(!0)};return T.useEffect(()=>u,[u]),T.useEffect(()=>void(r&&u()),[r,u]),f.jsxs(f.Fragment,{children:[f.jsx(Yce,{...a,virtualRef:l}),f.jsx(ar.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...s,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Wt(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:Wt(e.onPointerDown,m2(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:Wt(e.onPointerMove,m2(u)),onPointerCancel:r?e.onPointerCancel:Wt(e.onPointerCancel,m2(u)),onPointerUp:r?e.onPointerUp:Wt(e.onPointerUp,m2(u))})]})});fue.displayName=due;var $tt="ContextMenuPortal",hue=e=>{const{__scopeContextMenu:t,...n}=e,r=uo(t);return f.jsx(Zce,{...r,...n})};hue.displayName=$tt;var pue="ContextMenuContent",mue=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=cue(pue,n),i=uo(n),a=T.useRef(!1);return f.jsx(Xce,{...i,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&a.current&&o.preventDefault(),a.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!s.modal&&(a.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mue.displayName=pue;var ztt="ContextMenuGroup",Utt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(Jce,{...s,...r,ref:t})});Utt.displayName=ztt;var qtt="ContextMenuLabel",Vtt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(Qce,{...s,...r,ref:t})});Vtt.displayName=qtt;var Wtt="ContextMenuItem",gue=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(eue,{...s,...r,ref:t})});gue.displayName=Wtt;var Htt="ContextMenuCheckboxItem",Gtt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(tue,{...s,...r,ref:t})});Gtt.displayName=Htt;var Ktt="ContextMenuRadioGroup",Ytt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(nue,{...s,...r,ref:t})});Ytt.displayName=Ktt;var Ztt="ContextMenuRadioItem",Xtt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(rue,{...s,...r,ref:t})});Xtt.displayName=Ztt;var Jtt="ContextMenuItemIndicator",Qtt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(sue,{...s,...r,ref:t})});Qtt.displayName=Jtt;var ent="ContextMenuSeparator",yue=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(iue,{...s,...r,ref:t})});yue.displayName=ent;var tnt="ContextMenuArrow",nnt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(aue,{...s,...r,ref:t})});nnt.displayName=tnt;var rnt="ContextMenuSubTrigger",snt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(oue,{...s,...r,ref:t})});snt.displayName=rnt;var int="ContextMenuSubContent",ant=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=uo(n);return f.jsx(lue,{...s,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ant.displayName=int;function m2(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var ont=uue,lnt=fue,cnt=hue,unt=mue,dnt=gue,fnt=yue;function rW({...e}){return f.jsx(ont,{"data-slot":"context-menu",...e})}function sW({...e}){return f.jsx(lnt,{"data-slot":"context-menu-trigger",...e})}function iW({className:e,...t}){return f.jsx(cnt,{children:f.jsx(unt,{"data-slot":"context-menu-content",className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function Jo({className:e,inset:t,variant:n="default",...r}){return f.jsx(dnt,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:Ze("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function aW({className:e,...t}){return f.jsx(fnt,{"data-slot":"context-menu-separator",className:Ze("bg-border -mx-1 my-1 h-px",e),...t})}const hnt=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:s,isOperationLoading:i,creatingFolder:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:h,handleDelete:m,setNewName:y,renameInputRef:b,handleGitInit:v,handleGitPull:x,handleGitCommit:w,handleGitPush:S,handleGitStatus:C})=>{const k=e.type==="folder",A=L=>{L.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||i||(k?o(e):l(!n,e.id))},R=L=>{L.key==="Enter"?d():L.key==="Escape"&&u()},N=k?r?lH:fh:oH,I=k?r?"text-green-400":"text-yellow-400":"text-blue-400",O=f.jsxs(ks,{className:Ze("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",i&&"opacity-70 cursor-not-allowed",!k&&"cursor-pointer"),onClick:A,onDoubleClick:()=>!i&&!t&&o(e),children:[f.jsx(zn,{className:"px-2 py-1",children:f.jsx(Hl,{checked:n,onCheckedChange:L=>l(!!L,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:i||k})}),f.jsx(zn,{className:"px-2 py-1",children:f.jsx(N,{className:Ze("h-5 w-5",I)})}),f.jsx(zn,{className:"py-1 px-2",children:t?f.jsx(Cn,{ref:b,value:s,onChange:L=>y(L.target.value),onBlur:d,onKeyDown:R,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:L=>L.stopPropagation(),disabled:i}):f.jsx("span",{className:Ze("truncate",k&&"cursor-pointer hover:underline"),title:e.name,onClick:L=>{k&&(L.stopPropagation(),o(e))},children:e.name})}),f.jsx(zn,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?nw(e.size):""}),f.jsx(zn,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),f.jsx(zn,{className:"text-right pr-4 py-1",children:f.jsx("div",{className:Ze("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",i&&"opacity-30"),children:t?f.jsxs(f.Fragment,{children:[f.jsx(On,{tooltipText:"Save (Enter)",onClick:L=>{L.stopPropagation(),d()},"aria-label":"Save name",disabled:i||!s.trim(),icon:i?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(ro,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),f.jsx(On,{tooltipText:"Cancel (Esc)",onClick:L=>{L.stopPropagation(),u()},"aria-label":"Cancel edit",disabled:i,icon:f.jsx(wa,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[f.jsx(On,{tooltipText:"Rename",onClick:L=>{L.stopPropagation(),c(e)},"aria-label":"Rename",disabled:i||a,icon:f.jsx(S0,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(On,{tooltipText:k?"Download folder (.zip)":"Download file",onClick:L=>{L.stopPropagation(),h(e)},"aria-label":k?"Download folder as ZIP":"Download file",disabled:i,icon:f.jsx(pu,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(On,{tooltipText:"Delete",onClick:L=>{L.stopPropagation(),m(e)},"aria-label":`Delete ${k?"folder":"file"}`,disabled:i,icon:f.jsx(Eo,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return k?f.jsxs(rW,{children:[f.jsx(sW,{disabled:t||i,asChild:!0,children:O}),f.jsxs(iW,{children:[f.jsx(Jo,{onSelect:()=>o(e),disabled:t||i,children:"Open Folder"}),f.jsx(aW,{}),r?f.jsxs(f.Fragment,{children:[f.jsxs(Jo,{onSelect:()=>x(e.path),disabled:i,children:[f.jsx(dH,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),f.jsxs(Jo,{onSelect:()=>w(e.path),disabled:i,children:[f.jsx(uH,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),f.jsxs(Jo,{onSelect:()=>S(e.path),disabled:i,children:[f.jsx(IO,{className:"mr-2 h-4 w-4"}),"Git Push"]}),f.jsxs(Jo,{onSelect:()=>C(e.path),disabled:i,children:[f.jsx(OO,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):f.jsxs(Jo,{onSelect:()=>v(e.path),disabled:i,children:[f.jsx(Sc,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),f.jsx(aW,{}),f.jsxs(Jo,{onSelect:()=>c(e),disabled:i,children:[f.jsx(S0,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(Jo,{onSelect:()=>h(e),disabled:i,children:[f.jsx(pu,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),f.jsxs(Jo,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Eo,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):f.jsxs(rW,{children:[f.jsx(sW,{disabled:t||i,asChild:!0,children:O}),f.jsxs(iW,{children:[f.jsxs(Jo,{onSelect:()=>l(!n,e.id),disabled:i,children:[n?"Deselect":"Select"," File"]}),f.jsxs(Jo,{onSelect:()=>c(e),disabled:i,children:[f.jsx(S0,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(Jo,{onSelect:()=>h(e),disabled:i,children:[f.jsx(pu,{className:"mr-2 h-4 w-4"}),"Download File"]}),f.jsxs(Jo,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Eo,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},pnt=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:C,handleGitInit:k,handleGitPull:A,handleGitCommit:R,handleGitPush:N,handleGitStatus:I})=>{const O=T.useMemo(()=>e,[e]);return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):f.jsx("div",{className:"relative h-full",children:f.jsxs(of,{className:"w-full text-sm",children:[f.jsx(np,{className:"sticky top-0 bg-card z-10",children:f.jsxs(ks,{className:"hover:bg-card",children:[f.jsx(Or,{className:"w-[40px] px-2"}),f.jsx(Or,{className:"w-[40px] px-2"}),f.jsx(Or,{children:"Name"}),f.jsx(Or,{className:"w-[100px] text-right",children:"Size"}),f.jsx(Or,{className:"w-[150px] text-right",children:"Modified"}),f.jsx(Or,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),f.jsxs(lf,{children:[r&&f.jsx(yce,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a}),O.map(L=>{const P=t===L.path,V=i.has(L.id),F=C[L.path]??!1;return f.jsx(hnt,{entry:L,isEditingThis:P,isChecked:V,isGitRepo:F,newName:P?n:"",isOperationLoading:a,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:y,handleDelete:b,setNewName:v,renameInputRef:w,handleGitInit:k,handleGitPull:A,handleGitCommit:R,handleGitPush:N,handleGitStatus:I},L.id)}),e.length===0&&!r&&!a&&f.jsx(ks,{children:f.jsx(zn,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},mnt=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:s,creatingFolder:i,handleNavigateHome:a,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:c,handleUploadClick:u,handleFolderUploadClick:d,handleArchiveUploadClick:h,handleDownloadAll:m,handleCloneClick:y,fileInputRef:b,folderInputRef:v,archiveInputRef:x,handleFileChange:w,handleArchiveChange:S})=>f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:b,onChange:w,className:"hidden",multiple:!0,disabled:t}),f.jsx("input",{type:"file",ref:v,onChange:w,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),f.jsx("input",{type:"file",ref:x,onChange:S,className:"hidden",accept:".zip",disabled:t}),f.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(bt,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),a()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:f.jsx(Ame,{className:"h-4 w-4"})}),f.jsx(bt,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:f.jsx(fme,{className:"h-4 w-4"})}),f.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[150px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),f.jsx("div",{className:"flex-grow"}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap justify-end",children:[" ",f.jsx(bt,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(am,{className:"h-4 w-4"})}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),c()},disabled:t||i||!!s,className:"h-8",title:"Create New Folder",type:"button",children:[n&&i?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(cH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),u()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(NO,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Files"})," "]}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),d()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(fh,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),h()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Zpe,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"ZIP"})," "]}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),y()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Sc,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Clone"})," "]}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),m()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(rH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Export"})," "]})]})]})]}),bue=({isOpen:e,onOpenChange:t,title:n,description:r,children:s,submitLabel:i="Submit",onSubmit:a,isSubmitting:o,submitDisabled:l=!1,className:c,contentClassName:u})=>{const d=async h=>{h==null||h.preventDefault(),!(o||l)&&await a()};return f.jsx(Ym,{open:e,onOpenChange:t,children:f.jsxs(Zm,{className:Ze(c),children:[f.jsxs(Xm,{children:[f.jsx(Jm,{children:n}),r&&f.jsx(db,{children:r})]}),f.jsx("div",{className:Ze("py-4",u),children:s}),f.jsxs(ub,{children:[f.jsx(WQe,{asChild:!0,children:f.jsx(bt,{variant:"outline",disabled:o,children:"Cancel"})}),f.jsxs(bt,{onClick:d,disabled:o||l,children:[o&&f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":i]})]})]})})},gnt=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:s,setCloneBranch:i,isCloning:a,onSubmitClone:o,currentPath:l})=>f.jsx(bue,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:f.jsxs(f.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",f.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:a,submitDisabled:!n.trim(),children:f.jsxs("div",{className:"grid gap-4",children:[f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(Dt,{htmlFor:"clone-url",className:"text-right",children:"URL"}),f.jsx(Cn,{id:"clone-url",value:n,onChange:c=>r(c.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:a})]}),f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(Dt,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),f.jsx(Cn,{id:"clone-branch",value:s,onChange:c=>i(c.target.value),className:"col-span-3",placeholder:"main (default)",disabled:a})]})]})}),ynt=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:s,isCommitting:i,onSubmitCommit:a})=>f.jsx(bue,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:f.jsxs(f.Fragment,{children:["Enter a commit message for the changes in ",f.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:a,isSubmitting:i,submitDisabled:!r.trim(),children:f.jsx("div",{className:"grid gap-4",children:f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(Dt,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),f.jsx(Cn,{id:"commit-msg",value:r,onChange:o=>s(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:i})]})})});var cA="DropdownMenu",[bnt,gdt]=Wi(cA,[aA]),fo=aA(),[vnt,vue]=bnt(cA),xue=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=fo(t),c=T.useRef(null),[u,d]=Ec({prop:s,defaultProp:i??!1,onChange:a,caller:cA});return f.jsx(vnt,{scope:t,triggerId:ia(),triggerRef:c,contentId:ia(),open:u,onOpenChange:d,onOpenToggle:T.useCallback(()=>d(h=>!h),[d]),modal:o,children:f.jsx(Kce,{...l,open:u,onOpenChange:d,dir:r,modal:o,children:n})})};xue.displayName=cA;var wue="DropdownMenuTrigger",_ue=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=vue(wue,n),a=fo(n);return f.jsx(Yce,{asChild:!0,...a,children:f.jsx(ar.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:ll(t,i.triggerRef),onPointerDown:Wt(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Wt(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});_ue.displayName=wue;var xnt="DropdownMenuPortal",Sue=e=>{const{__scopeDropdownMenu:t,...n}=e,r=fo(t);return f.jsx(Zce,{...r,...n})};Sue.displayName=xnt;var Cue="DropdownMenuContent",kue=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vue(Cue,n),i=fo(n),a=T.useRef(!1);return f.jsx(Xce,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:Wt(e.onCloseAutoFocus,o=>{var l;a.current||(l=s.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Wt(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});kue.displayName=Cue;var wnt="DropdownMenuGroup",_nt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(Jce,{...s,...r,ref:t})});_nt.displayName=wnt;var Snt="DropdownMenuLabel",Cnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(Qce,{...s,...r,ref:t})});Cnt.displayName=Snt;var knt="DropdownMenuItem",Eue=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(eue,{...s,...r,ref:t})});Eue.displayName=knt;var Ent="DropdownMenuCheckboxItem",Tnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(tue,{...s,...r,ref:t})});Tnt.displayName=Ent;var Ant="DropdownMenuRadioGroup",Rnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(nue,{...s,...r,ref:t})});Rnt.displayName=Ant;var Nnt="DropdownMenuRadioItem",Mnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(rue,{...s,...r,ref:t})});Mnt.displayName=Nnt;var Int="DropdownMenuItemIndicator",jnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(sue,{...s,...r,ref:t})});jnt.displayName=Int;var Ont="DropdownMenuSeparator",Tue=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(iue,{...s,...r,ref:t})});Tue.displayName=Ont;var Pnt="DropdownMenuArrow",Dnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(aue,{...s,...r,ref:t})});Dnt.displayName=Pnt;var Fnt="DropdownMenuSubTrigger",Lnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(oue,{...s,...r,ref:t})});Lnt.displayName=Fnt;var Bnt="DropdownMenuSubContent",$nt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fo(n);return f.jsx(lue,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$nt.displayName=Bnt;var znt=xue,Unt=_ue,qnt=Sue,Vnt=kue,Wnt=Eue,Hnt=Tue;function Gnt({...e}){return f.jsx(znt,{"data-slot":"dropdown-menu",...e})}function Knt({...e}){return f.jsx(Unt,{"data-slot":"dropdown-menu-trigger",...e})}function Ynt({className:e,sideOffset:t=4,...n}){return f.jsx(qnt,{children:f.jsx(Vnt,{"data-slot":"dropdown-menu-content",sideOffset:t,className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function Zc({className:e,inset:t,variant:n="default",...r}){return f.jsx(Wnt,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:Ze("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function oW({className:e,...t}){return f.jsx(Hnt,{"data-slot":"dropdown-menu-separator",className:Ze("bg-border -mx-1 my-1 h-px",e),...t})}const Znt=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:C,handleGitInit:k,handleGitPull:A,handleGitCommit:R,handleGitPush:N,handleGitStatus:I})=>{const O=L=>{L.key==="Enter"?d():L.key==="Escape"&&u()};return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground p-4",children:"Loading..."}):f.jsxs("div",{className:"p-2 space-y-1",children:[r&&f.jsx("div",{className:"border rounded-md p-2 bg-muted/30",children:f.jsx(yce,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a,isMobile:!0})}),e.map(L=>{const P=t===L.path,V=i.has(L.id),F=C[L.path]??!1,X=L.type==="folder",U=X?F?lH:fh:oH,H=X?F?"text-green-400":"text-yellow-400":"text-blue-400";return f.jsxs("div",{className:Ze("flex items-center justify-between p-2 border rounded-md",P&&"bg-muted ring-1 ring-primary",a&&"opacity-70 cursor-not-allowed",!P&&"hover:bg-muted/50",!P&&"cursor-pointer"),onClick:()=>{P||a||(X?o(L):l(!V,L.id))},children:[f.jsxs("div",{className:"flex items-center gap-2 flex-grow min-w-0",children:[!X&&f.jsx(Hl,{checked:V,onCheckedChange:$=>l(!!$,L.id),"aria-label":`Select ${L.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground flex-shrink-0",disabled:a,onClick:$=>$.stopPropagation()}),X&&f.jsx("div",{className:"w-6 flex-shrink-0"}),f.jsx(U,{className:Ze("h-5 w-5 flex-shrink-0",H)}),f.jsxs("div",{className:"flex flex-col min-w-0 flex-grow",children:[P?f.jsx(Cn,{ref:w,value:n,onChange:$=>v($.target.value),onBlur:d,onKeyDown:O,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:$=>$.stopPropagation(),disabled:a}):f.jsx("span",{className:"text-sm font-medium truncate",title:L.name,children:L.name}),f.jsx("span",{className:"text-xs text-muted-foreground",children:L.type==="file"&&L.size!==void 0?nw(L.size):L.type==="folder"?F?"Git Repository":"Folder":""})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 ml-2",children:P?f.jsxs(f.Fragment,{children:[f.jsx(bt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-600",onClick:$=>{$.stopPropagation(),d()},disabled:a||!n.trim(),"aria-label":"Save name",children:a?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(ro,{className:"h-4 w-4"})}),f.jsx(bt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:$=>{$.stopPropagation(),u()},disabled:a,"aria-label":"Cancel edit",children:f.jsx(wa,{className:"h-4 w-4"})})]}):f.jsxs(Gnt,{children:[f.jsx(Knt,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:$=>$.stopPropagation(),disabled:a,"aria-label":"More actions",children:f.jsx(Kpe,{className:"h-4 w-4"})})}),f.jsxs(Ynt,{align:"end",onClick:$=>$.stopPropagation(),children:[X&&f.jsx(Zc,{onSelect:()=>o(L),children:"Open Folder"}),!X&&f.jsxs(Zc,{onSelect:()=>l(!V,L.id),children:[V?"Deselect":"Select"," File"]}),f.jsxs(Zc,{onSelect:()=>c(L),children:[f.jsx(S0,{className:"mr-2 h-4 w-4"})," Rename"]}),f.jsxs(Zc,{onSelect:()=>y(L),children:[f.jsx(pu,{className:"mr-2 h-4 w-4"})," Download"," ",X?"as ZIP":""]}),X&&f.jsx(oW,{}),X&&F&&f.jsxs(f.Fragment,{children:[f.jsxs(Zc,{onSelect:()=>A(L.path),children:[f.jsx(dH,{className:"mr-2 h-4 w-4"})," Git Pull"]}),f.jsxs(Zc,{onSelect:()=>R(L.path),children:[f.jsx(uH,{className:"mr-2 h-4 w-4"})," Git Commit..."]}),f.jsxs(Zc,{onSelect:()=>N(L.path),children:[f.jsx(IO,{className:"mr-2 h-4 w-4"})," Git Push"]}),f.jsxs(Zc,{onSelect:()=>I(L.path),children:[f.jsx(OO,{className:"mr-2 h-4 w-4"})," Git Status"]})]}),X&&!F&&f.jsxs(Zc,{onSelect:()=>k(L.path),children:[f.jsx(Sc,{className:"mr-2 h-4 w-4"})," Initialize Git Repo"]}),f.jsx(oW,{}),f.jsxs(Zc,{className:"text-red-600 focus:text-red-600",onSelect:()=>b(L),children:[f.jsx(Eo,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},L.id)}),e.length===0&&!r&&!a&&f.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Folder is empty"})]})},q5=T.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:s,error:i,rootId:a,selectedFileIds:o,vfsKey:l,configuredVfsKey:c,initializingKey:u}=Xs(yn(_e=>({nodes:_e.nodes,childrenMap:_e.childrenMap,currentParentId:_e.currentParentId,selectedFileIds:_e.selectedFileIds,loading:_e.loading,operationLoading:_e.operationLoading,error:_e.error,rootId:_e.rootId,vfsKey:_e.vfsKey,configuredVfsKey:_e.configuredVfsKey,initializingKey:_e.initializingKey}))),[d,h]=T.useState(""),[m,y]=T.useState(null),[b,v]=T.useState(!1),[x,w]=T.useState(""),[S,C]=T.useState({}),[k,A]=T.useState(!1),[R,N]=T.useState(""),[I,O]=T.useState(""),[L,P]=T.useState(!1),[V,F]=T.useState(!1),[X,U]=T.useState(null),[H,$]=T.useState(""),[ne,W]=T.useState(!1),[Q,ee]=T.useState({}),se=T.useRef(null),pe=T.useRef(null),ce=T.useRef(null),Ie=T.useRef(null),De=T.useRef(null),Se=n?e[n]:null,Ce=Se?Se.path:"/",Qe=(t[n||a||""]||[]).map(_e=>e[_e]).filter(_e=>!!_e).sort((_e,Ue)=>_e.type==="folder"&&Ue.type==="file"?-1:_e.type==="file"&&Ue.type==="folder"?1:_e.name.localeCompare(Ue.name)),Ve=T.useMemo(()=>Qe.filter(_e=>_e.type==="folder").map(_e=>_e.path),[Qe]),Ne=r||u!==null||l!==c,K=s||L||ne||Object.values(Q).some(Boolean);T.useEffect(()=>{n!==null&&!t[n]&&!Ne&&c===l?je.emit(dn.fetchNodesRequest,{parentId:n}):n===null&&a&&!t[a]&&!Ne&&c===l&&je.emit(dn.fetchNodesRequest,{parentId:a})},[n,t,a,Ne,c,l]),T.useEffect(()=>{var _e,Ue;m&&((_e=Ie.current)==null||_e.focus(),(Ue=Ie.current)==null||Ue.select())},[m]),T.useEffect(()=>{var _e;b&&((_e=De.current)==null||_e.focus())},[b]),T.useEffect(()=>{(async()=>{if(Ne||Ve.length===0)return;const Ue={};let kt=!1;for(const fe of Ve)try{const Y=await aTe(fe);S[fe]!==Y&&(Ue[fe]=Y,kt=!0)}catch(Y){console.error(`Error checking git status for ${fe}:`,Y),S[fe]!==!1&&(Ue[fe]=!1,kt=!0)}kt&&C(fe=>({...fe,...Ue}))})()},[Ve,Ne,S]);const me=T.useCallback(async(_e,Ue,kt)=>{if(!(K||Ne)){kt!==!1&&je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{je.emit(_e,Ue)}catch(fe){console.error("[FileManager Operation Error]:",fe),je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:fe instanceof Error?fe.message:String(fe)})}finally{kt!==!1&&je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[K,Ne,r,s,i]),Ae=T.useCallback(_e=>{K||Ne||m||_e.type==="folder"&&me(dn.setCurrentPathRequest,{path:_e.path},!1)},[K,Ne,m,me]),le=T.useCallback(()=>{if(K||Ne||Ce==="/")return;const _e=GE(Ce);me(dn.setCurrentPathRequest,{path:_e},!1)},[K,Ne,Ce,me]),oe=T.useCallback(()=>{K||Ne||Ce==="/"||me(dn.setCurrentPathRequest,{path:"/"},!1)},[K,Ne,Ce,me]),re=T.useCallback(()=>{Ne||me(dn.fetchNodesRequest,{parentId:n},!1)},[me,n,Ne]),Te=T.useCallback((_e,Ue)=>{const kt=e[Ue];kt&&kt.type==="file"?_e?je.emit(dn.selectFileRequest,{fileId:Ue}):je.emit(dn.deselectFileRequest,{fileId:Ue}):kt&&kt.type==="folder"&&Oe.info("Folders cannot be attached to the prompt.")},[e]),Be=T.useCallback(_e=>{K||Ne||b||(y(_e.path),h(_e.name),v(!1))},[K,Ne,b]),ke=T.useCallback(()=>{y(null),h("")},[]),lt=T.useCallback(async()=>{if(!m||!d.trim()){ke();return}const _e=Object.values(e).find(Ue=>Ue.path===m);_e&&_e.name!==d.trim()&&await me(dn.renameNodeRequest,{id:_e.id,newName:d.trim()}),ke()},[m,d,e,ke,me]),Rt=T.useCallback(()=>{K||Ne||m||(v(!0),w(""),y(null))},[K,Ne,m]),ft=T.useCallback(()=>{v(!1),w("")},[]),jt=T.useCallback(async()=>{if(!x.trim()){ft();return}await me(dn.createDirectoryRequest,{parentId:n,name:x.trim()}),ft()},[x,n,ft,me]),qt=()=>{var _e;return(_e=se.current)==null?void 0:_e.click()},Lt=()=>{var _e;return(_e=pe.current)==null?void 0:_e.click()},en=()=>{var _e;return(_e=ce.current)==null?void 0:_e.click()},xe=T.useCallback(async _e=>{const Ue=_e.target.files;Ue&&Ue.length>0&&(await me(dn.uploadFilesRequest,{parentId:n,files:Ue}),_e.target&&(_e.target.value=""))},[n,me]),D=T.useCallback(async _e=>{var kt;const Ue=(kt=_e.target.files)==null?void 0:kt[0];if(Ue){je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{await cTe(Ue,Ce),je.emit(dn.fetchNodesRequest,{parentId:n})}catch(fe){console.error("Archive upload error:",fe)}finally{je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i}),_e.target&&(_e.target.value="")}}},[Ce,n,r,i]),Z=T.useCallback(async _e=>{window.confirm(`Delete ${_e.type} "${_e.name}"?${_e.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await me(dn.deleteNodesRequest,{ids:[_e.id]})},[me]),ge=T.useCallback(async _e=>{je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{_e.type==="file"?await lTe(_e.path):await _z(`${_e.name}.zip`,_e.path)}catch(Ue){console.error("Download error:",Ue)}finally{je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}},[r,i]),Fe=T.useCallback(async()=>{if(Qe.length!==0){je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{const _e=gi(Ce)||"root";await _z(`${_e}_export.zip`,Ce)}catch(_e){console.error("Download all error:",_e)}finally{je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[Ce,Qe.length,r,i]),we=T.useCallback(async(_e,Ue)=>{if(!(Q[_e]||Ne||s)){ee(kt=>({...kt,[_e]:!0})),je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await Ue()}catch(kt){console.error(`[FileManager Git Op Error @ ${_e}]:`,kt)}finally{ee(kt=>({...kt,[_e]:!1}))}}},[Q,Ne,s,r]),Me=T.useCallback(_e=>{we(_e,async()=>{await hZ(_e),C(Ue=>({...Ue,[_e]:!0}))})},[we]),de=T.useCallback(_e=>{Oe.info("Pulling default branch (auth not implemented yet)..."),we(_e,()=>QE(_e,"main"))},[we]),vt=T.useCallback(_e=>{U(_e),$(""),F(!0)},[]),ot=T.useCallback(_e=>{Oe.info("Pushing default branch (auth not implemented yet)..."),we(_e,()=>oD(_e,"main"))},[we]),B=T.useCallback(_e=>{we(_e,()=>pZ(_e))},[we]),ze=T.useCallback(()=>{N(""),O(""),A(!0)},[]),st=T.useCallback(async()=>{if(!R.trim()){Oe.error("Repository URL cannot be empty.");return}P(!0),je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{const _e=gi(R.trim().replace(/\.git$/,""))||"cloned_repo",Ue=Sj(Ce,_e);await fZ(Ue,R.trim(),I.trim()||void 0),A(!1),je.emit(dn.fetchNodesRequest,{parentId:n})}catch{}finally{P(!1)}},[R,I,Ce,n,r,s]),ye=T.useCallback(async()=>{if(!X||!H.trim()){Oe.error("Commit message cannot be empty.");return}W(!0),je.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await aD(X,H.trim()),F(!1)}catch{}finally{W(!1)}},[X,H,r,s]);return Ne?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[f.jsx(Qn,{className:"h-8 w-8 animate-spin mb-2"}),f.jsx("p",{children:u?`Initializing filesystem: ${u}`:"Loading filesystem..."}),i&&f.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",i]})]}):i&&!Ne?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[f.jsxs("p",{children:["Error loading filesystem: ",i]}),f.jsx(bt,{variant:"outline",size:"sm",onClick:()=>je.emit(dn.initializeVFSRequest,{vfsKey:l||"default_fallback_key"}),className:"mt-2",children:"Retry"})]}):f.jsxs("div",{className:Ze("flex h-full flex-col bg-card text-card-foreground"),children:[f.jsx(mnt,{currentPath:Ce,isAnyLoading:K||Ne,isOperationLoading:s,entries:Qe,editingPath:m,creatingFolder:b,handleNavigateHome:oe,handleNavigateUp:le,handleRefresh:re,startCreatingFolder:Rt,handleUploadClick:qt,handleFolderUploadClick:Lt,handleArchiveUploadClick:en,handleDownloadAll:Fe,handleCloneClick:ze,fileInputRef:se,folderInputRef:pe,archiveInputRef:ce,handleFileChange:xe,handleArchiveChange:D}),f.jsx("div",{className:"flex-grow overflow-auto hidden md:block",children:f.jsx(pnt,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:K,handleNavigate:Ae,handleCheckboxChange:Te,startEditing:Be,cancelEditing:ke,handleRename:lt,cancelCreatingFolder:ft,handleCreateFolder:jt,handleDownload:ge,handleDelete:Z,setNewName:h,setNewFolderName:w,renameInputRef:Ie,newFolderInputRef:De,gitRepoStatus:S,handleGitInit:Me,handleGitPull:de,handleGitCommit:vt,handleGitPush:ot,handleGitStatus:B})}),f.jsx("div",{className:"flex-grow overflow-auto block md:hidden",children:f.jsx(Znt,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:K,handleNavigate:Ae,handleCheckboxChange:Te,startEditing:Be,cancelEditing:ke,handleRename:lt,cancelCreatingFolder:ft,handleCreateFolder:jt,handleDownload:ge,handleDelete:Z,setNewName:h,setNewFolderName:w,renameInputRef:Ie,newFolderInputRef:De,gitRepoStatus:S,handleGitInit:Me,handleGitPull:de,handleGitCommit:vt,handleGitPush:ot,handleGitStatus:B})}),f.jsx(gnt,{isOpen:k,onOpenChange:A,cloneRepoUrl:R,setCloneRepoUrl:N,cloneBranch:I,setCloneBranch:O,isCloning:L,onSubmitClone:st,currentPath:Ce}),f.jsx(ynt,{isOpen:V,onOpenChange:F,commitPath:X,commitMessage:H,setCommitMessage:$,isCommitting:ne,onSubmitCommit:ye})]})});q5.displayName="FileManager";const Xnt=({vfsKey:e,selectedItemType:t})=>e==="orphan"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(xB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Shared VFS:"})," All chats ",f.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(xB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(fh,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null,Jnt=({module:e,isOpen:t,onClose:n})=>{const[r,s]=T.useState(e.getSelectedFileIdsCount()),[i,a]=T.useState(null);T.useEffect(()=>{const u=h=>{s(h.selectedFileIds.length)},d=h=>{a(h.itemType)};return je.on(dn.selectionChanged,u),je.on(Yn.selectedItemChanged,d),()=>{je.off(dn.selectionChanged,u),je.off(Yn.selectedItemChanged,d)}},[]);const o=Xs.getState().vfsKey,l=()=>{const u=Xs.getState().selectedFileIds,d=e.getVfsNodes();if(u.size===0){Oe.info("No files selected in VFS to attach.");return}let h=0;u.forEach(m=>{const y=d[m];y&&y.type==="file"&&(je.emit(Ll.addAttachedFileRequest,{source:"vfs",name:y.name,type:y.mimeType||"application/octet-stream",size:y.size,path:y.path}),h++)}),h>0?(Oe.success(`Attached ${h} file(s) from VFS to the next prompt.`),e.clearVfsSelection(),n()):Oe.warning("No valid files were selected to attach.")},c=()=>{e.clearVfsSelection(),n()};return f.jsx(Ym,{open:t,onOpenChange:u=>!u&&c(),children:f.jsxs(Zm,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[f.jsxs(Xm,{className:"p-4 pb-2 border-b flex-shrink-0",children:[f.jsx(Jm,{children:"Virtual Filesystem"}),f.jsx(db,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),f.jsx(Xnt,{vfsKey:o,selectedItemType:i})]}),f.jsx("div",{className:"flex-grow overflow-hidden",children:f.jsx(q5,{})}),f.jsxs(ub,{className:"p-4 pt-2 border-t flex-shrink-0",children:[f.jsx(bt,{variant:"outline",onClick:c,children:"Close"}),f.jsxs(bt,{onClick:l,disabled:r===0,children:[f.jsx(cE,{className:"h-4 w-4 mr-2"}),"Attach Selected (",r,")"]})]})]})})};class Qnt{constructor(){ve(this,"id","core-vfs");ve(this,"modalId","core-vfs-modal-panel");ve(this,"unregisterCallbacks",[]);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"notifyTriggerUpdate",null);ve(this,"isModalOpenByManager",!1);ve(this,"getEnableVfs",()=>Xs.getState().enableVfs);ve(this,"getIsVfsModalOpen",()=>this.isModalOpenByManager);ve(this,"getSelectedFileIdsCount",()=>Xs.getState().selectedFileIds.size);ve(this,"toggleVfsModal",()=>{var t,n;this.isModalOpenByManager?(t=this.modApiRef)==null||t.emit(jr.closeModalRequest,{modalId:this.modalId}):(n=this.modApiRef)==null||n.emit(jr.openModalRequest,{modalId:this.modalId})});ve(this,"clearVfsSelection",()=>{var t;(t=this.modApiRef)==null||t.emit(dn.clearSelectionRequest,void 0)});ve(this,"getVfsNodes",()=>Xs.getState().nodes);ve(this,"setNotifyTriggerUpdate",t=>{this.notifyTriggerUpdate=t})}async initialize(t){this.modApiRef=t,this.updateVfsKeyBasedOnContext();const n=t.on(jr.contextChanged,()=>{var s;this.updateVfsKeyBasedOnContext(),(s=this.notifyTriggerUpdate)==null||s.call(this)}),r=t.on(jr.modalStateChanged,s=>{var i;if(s.modalId===this.modalId){const a=s.isOpen;this.isModalOpenByManager!==a&&(this.isModalOpenByManager=a,(i=this.notifyTriggerUpdate)==null||i.call(this),a&&this.updateVfsKeyBasedOnContext())}});this.eventUnsubscribers.push(n,r)}updateVfsKeyBasedOnContext(){var i;const{selectedItemId:t,selectedItemType:n}=qn.getState(),r=Xs.getState().vfsKey;let s=null;if(this.isModalOpenByManager)if(n==="project")s=t;else if(n==="conversation"){const a=qn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";else if(n==="project")s=t;else if(n==="conversation"){const a=qn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";r!==s&&(console.log(`[${this.id}] Updating VFS key from "${r}" to "${s}"`),(i=this.modApiRef)==null||i.emit(dn.setVfsKeyRequest,{key:s}))}register(t){if(this.modApiRef=t,this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=t.registerPromptControl({id:"core-vfs-prompt-trigger",triggerRenderer:()=>We.createElement(Xet,{module:this})});this.unregisterCallbacks.push(n);const r=t.registerModalProvider(this.modalId,s=>We.createElement(Jnt,{module:this,...s}));this.unregisterCallbacks.push(r)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.notifyTriggerUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const ert=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.selectedItemId,r=e.selectedItemType,s=e.syncRepos,i=e.conversationSyncStatus,a=e.isStreaming,[o,l]=T.useState(null),[c,u]=T.useState("idle"),[d,h]=T.useState(!1),[m,y]=T.useState(!1);T.useEffect(()=>{if(r==="conversation"&&n){const A=e.getConversationById(n);l((A==null?void 0:A.syncRepoId)??null),u(i[n]??"idle")}else l(null),u("idle")},[n,r,i,e]);const b=We.useMemo(()=>new Map(s.map(A=>[A.id,A.name])),[s]),v=o?b.get(o):void 0,x=T.useCallback(async A=>{if(!n||r!=="conversation")return;h(!0);const R=A==="none"?null:A;await e.linkConversationToRepo(n,R),h(!1)},[n,r,e]),w=T.useCallback(async()=>{!n||!o||(y(!0),await e.syncConversation(n),y(!1))},[n,o,e]),S=ple(c,v),C=!o||m||d||a||c==="syncing";return r==="conversation"&&s.length>0?f.jsxs(pl,{children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ml,{asChild:!0,children:f.jsx(bt,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:a||d||m,"aria-label":"Configure Git Sync",children:c==="syncing"||m||d?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Sc,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:o?`Sync Status: ${c}`:"Link to Sync Repo"})]})}),f.jsxs(gl,{className:"w-64 p-4 space-y-3",align:"start",children:[f.jsx(Dt,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),f.jsxs(Wm,{value:o??"none",onValueChange:x,disabled:d||m||a,children:[f.jsx(Gm,{id:"sync-repo-select",className:"w-full h-9",children:f.jsx(Hm,{placeholder:"Select repository..."})}),f.jsxs(Km,{children:[f.jsx(sl,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(A=>f.jsx(sl,{value:A.id,children:A.name},A.id))]})]}),f.jsxs("div",{className:"flex items-center justify-between pt-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",S||"Not Linked"]}),f.jsxs(bt,{size:"sm",variant:"outline",onClick:w,disabled:C,className:"h-8",children:[m||c==="syncing"?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(IO,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]}):null},dx=({title:e,description:t,children:n,className:r,titleClassName:s,descriptionClassName:i,contentClassName:a})=>f.jsxs("div",{className:Ze("space-y-2",r),children:[f.jsxs("div",{children:[f.jsx("h3",{className:Ze("text-lg font-medium",s),children:e}),t&&f.jsx("p",{className:Ze("text-sm text-muted-foreground",i),children:t})]}),f.jsx("div",{className:Ze(a),children:n})]}),trt=Ke({gitUserName:$e().min(1,"User name cannot be empty."),gitUserEmail:$e().email("Invalid email address.")});function lW({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.map(t=>typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"?t.message:(console.warn("FieldMetaMessages encountered an unexpected error object:",t),"Invalid input")).join(", ")}):null})}const nrt=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=yr(yn(i=>({gitUserName:i.gitUserName,setGitUserName:i.setGitUserName,gitUserEmail:i.gitUserEmail,setGitUserEmail:i.setGitUserEmail}))),s=ni({defaultValues:{gitUserName:e??"",gitUserEmail:n??""},validators:{onChange:trt},onSubmit:async({value:i})=>{try{t(i.gitUserName),r(i.gitUserEmail),Oe.success("Git user configuration updated!")}catch(a){Oe.error("Failed to update Git configuration."),console.error("Error submitting Git config form:",a)}}});return T.useEffect(()=>{s.reset({gitUserName:e??"",gitUserEmail:n??""})},[e,n,s]),f.jsx("div",{className:"space-y-4 p-1",children:f.jsx(dx,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(s.Field,{name:"gitUserName",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:i.name,children:"Git User Name"}),f.jsx(Cn,{id:i.name,value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"Your Name",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(lW,{field:i})]})}),f.jsx(s.Field,{name:"gitUserEmail",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:i.name,children:"Git User Email"}),f.jsx(Cn,{id:i.name,type:"email",value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"your.email@example.com",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(lW,{field:i})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsx(bt,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Git Config"})})})]})})})},rrt=We.memo(nrt),srt=TO("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Aue({className:e,variant:t,...n}){return f.jsx("div",{"data-slot":"alert",role:"alert",className:Ze(srt({variant:t}),e),...n})}function Rue({className:e,...t}){return f.jsx("div",{"data-slot":"alert-title",className:Ze("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function Nue({className:e,...t}){return f.jsx("div",{"data-slot":"alert-description",className:Ze("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var irt="Separator",cW="horizontal",art=["horizontal","vertical"],Mue=T.forwardRef((e,t)=>{const{decorative:n,orientation:r=cW,...s}=e,i=ort(r)?r:cW,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return f.jsx(ar.div,{"data-orientation":i,...o,...s,ref:t})});Mue.displayName=irt;function ort(e){return art.includes(e)}var lrt=Mue;function Zd({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return f.jsx(lrt,{"data-slot":"separator-root",decorative:n,orientation:t,className:Ze("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const crt=({onSyncAll:e,onSyncPending:t,onInitializeRepos:n,onAbortSync:r,isRunning:s=!1,totalRepos:i,totalConversations:a,pendingConversations:o})=>{const[l,c]=T.useState(null),[u,d]=T.useState(!1);T.useEffect(()=>{const S=R=>{R&&R.progress&&(c(R.progress),d(!0))},C=R=>{R&&R.progress&&c(R.progress)},k=R=>{R&&R.progress&&(c(R.progress),setTimeout(()=>{c(null),d(!1)},2e3))},A=R=>{R&&R.progress&&(c(R.progress),setTimeout(()=>{c(null),d(!1)},5e3))};return je.on(cs.bulkSyncStarted,S),je.on(cs.bulkSyncProgress,C),je.on(cs.bulkSyncCompleted,k),je.on(cs.bulkSyncFailed,A),()=>{je.off(cs.bulkSyncStarted,S),je.off(cs.bulkSyncProgress,C),je.off(cs.bulkSyncCompleted,k),je.off(cs.bulkSyncFailed,A)}},[]);const h=s||u,m=l?l.completedRepos/Math.max(l.totalRepos,1)*100:0,y=l?l.completedConversations/Math.max(l.totalConversations,1)*100:0,b=async()=>{d(!0);try{await e()}catch(S){console.error("Sync all failed:",S),d(!1)}},v=async()=>{d(!0);try{await t()}catch(S){console.error("Sync pending failed:",S),d(!1)}},x=async()=>{d(!0);try{await n()}catch(S){console.error("Initialize repos failed:",S),d(!1)}},w=async()=>{try{await r()}catch(S){console.error("Abort sync failed:",S)}};return f.jsxs(Vd,{className:"w-full",children:[f.jsxs(Wd,{className:"pb-3",children:[f.jsxs(Hd,{className:"flex items-center gap-2",children:[f.jsx(Sc,{className:"h-5 w-5"}),"Bulk Git Sync"]}),f.jsx(Y1,{children:"Manage synchronization across all repositories and conversations"})]}),f.jsxs(Gd,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:i}),f.jsx("div",{className:"text-muted-foreground",children:"Repositories"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:a}),f.jsx("div",{className:"text-muted-foreground",children:"Total Conversations"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:Ze("font-medium text-lg",o>0?"text-orange-600":"text-green-600"),children:o}),f.jsx("div",{className:"text-muted-foreground",children:"Pending Sync"})]})]}),f.jsx(Zd,{}),l&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsx("span",{className:"font-medium",children:"Current Operation"}),f.jsx(mi,{variant:l.errors.length>0?"destructive":"default",children:l.errors.length>0?"Errors":"Running"})]}),f.jsx("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:l.currentOperation}),l.totalRepos>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Repository Progress"}),f.jsxs("span",{children:[l.completedRepos,"/",l.totalRepos]})]}),f.jsx(Ey,{value:m,className:"h-2"})]}),l.totalConversations>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Conversation Progress"}),f.jsxs("span",{children:[l.completedConversations,"/",l.totalConversations]})]}),f.jsx(Ey,{value:y,className:"h-2"})]}),l.errors.length>0&&f.jsxs("div",{className:"mt-2",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive mb-2",children:[f.jsx(_c,{className:"h-4 w-4"}),l.errors.length," Error",l.errors.length!==1?"s":""]}),f.jsxs("div",{className:"max-h-24 overflow-y-auto space-y-1",children:[l.errors.slice(0,5).map((S,C)=>f.jsxs("div",{className:"text-xs text-muted-foreground bg-destructive/10 p-2 rounded",children:[f.jsxs("span",{className:"font-medium",children:[S.type,":"]})," ",S.error]},C)),l.errors.length>5&&f.jsxs("div",{className:"text-xs text-muted-foreground",children:["...and ",l.errors.length-5," more errors"]})]})]})]}),f.jsx(Zd,{}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(bt,{onClick:x,disabled:h||i===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(pu,{className:"h-4 w-4 mr-1"}),"Clone Repos"]})}),f.jsx(Sr,{children:"Initialize/clone all configured repositories"})]})}),f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(bt,{onClick:v,disabled:h||o===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(mH,{className:"h-4 w-4 mr-1"}),"Sync Pending"]})}),f.jsx(Sr,{children:"Sync only conversations that need syncing"})]})}),f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(bt,{onClick:b,disabled:h||i===0&&a===0,size:"sm",className:"w-full",children:[f.jsx(am,{className:Ze("h-4 w-4 mr-1",h&&"animate-spin")}),"Sync All"]})}),f.jsx(Sr,{children:"Sync all repositories and conversations"})]})}),f.jsxs(bt,{onClick:w,disabled:!h,variant:"destructive",size:"sm",className:"w-full",children:[f.jsx(Ape,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]})]})},urt=Ke({name:$e().min(1,"Repository Name is required."),remoteUrl:$e().min(1,"Remote URL is required.").url("Invalid URL format (e.g., https://github.com/user/repo.git)"),branch:$e().min(1,"Branch name is required (e.g., main)."),username:$e().nullable().optional(),password:$e().nullable().optional()}),g2={name:"",remoteUrl:"",branch:"main",username:null,password:null},drt=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,repoInitializationStatus:r,isLoading:s}=qn(yn(C=>({syncRepos:C.syncRepos,addSyncRepo:C.addSyncRepo,updateSyncRepo:C.updateSyncRepo,repoInitializationStatus:C.repoInitializationStatus,isLoading:C.isLoading}))),{autoSyncOnStreamComplete:i,setAutoSyncOnStreamComplete:a}=yr(yn(C=>({autoSyncOnStreamComplete:C.autoSyncOnStreamComplete,setAutoSyncOnStreamComplete:C.setAutoSyncOnStreamComplete}))),[o,l]=T.useState(!1),[c,u]=T.useState(null),[d,h]=T.useState({});T.useEffect(()=>{const C=k=>{k&&k.action==="deleted"&&k.repoId&&h(A=>({...A,[k.repoId]:!1}))};return je.on(cs.repoChanged,C),()=>je.off(cs.repoChanged,C)},[]);const m=ni({defaultValues:g2,validators:{onChangeAsync:urt,onChangeAsyncDebounceMs:500},onSubmit:async({value:C})=>{var k,A,R,N;if(!((k=C.name)!=null&&k.trim())||!((A=C.remoteUrl)!=null&&A.trim())){Oe.error("Repository Name and Remote URL are required.");return}try{const I={name:C.name.trim(),remoteUrl:C.remoteUrl.trim(),branch:((R=C.branch)==null?void 0:R.trim())||"main",username:((N=C.username)==null?void 0:N.trim())||null,password:C.password||null};c?await n(c,I):await t(I),y()}catch(I){console.error("Failed to save sync repo:",I)}}}),y=T.useCallback(()=>{m.reset(g2),l(!1),u(null)},[m]);T.useEffect(()=>{if(c){const C=e.find(k=>k.id===c);C?(m.reset({name:C.name,remoteUrl:C.remoteUrl,branch:C.branch||"main",username:C.username??null,password:C.password??null}),l(!1)):y()}else o||m.reset(g2)},[c,e,m,o,y]);const b=C=>{u(C.id),l(!1)},v=T.useCallback((C,k)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${k}"? This will unlink it from any conversations and remove the local copy.`)){h(A=>({...A,[C]:!0}));try{je.emit(Yn.deleteSyncRepoRequest,{id:C}),c===C&&y()}catch(A){console.error("Failed to delete sync repo:",A),h(R=>({...R,[C]:!1}))}}},[c,y]),x=T.useCallback(C=>{je.emit(Yn.initializeOrSyncRepoRequest,{repoId:C})},[]),w=()=>{u(null),m.reset(g2),l(!0)},S=()=>f.jsxs("form",{onSubmit:C=>{C.preventDefault(),C.stopPropagation(),m.handleSubmit()},className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:c?"Edit Sync Repository":"Add New Sync Repository"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx(m.Field,{name:"name",children:C=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(Dt,{htmlFor:C.name,children:"Name"}),f.jsx(Cn,{id:C.name,value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"e.g., My Backup",disabled:m.state.isSubmitting}),f.jsx(Ni,{field:C})]})}),f.jsx(m.Field,{name:"remoteUrl",children:C=>f.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[f.jsx(Dt,{htmlFor:C.name,children:"Remote URL (HTTPS)"}),f.jsx(Cn,{id:C.name,type:"url",value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"https://github.com/user/repo.git",disabled:m.state.isSubmitting}),f.jsx(Ni,{field:C})]})}),f.jsx(m.Field,{name:"branch",children:C=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(Dt,{htmlFor:C.name,children:"Branch"}),f.jsx(Cn,{id:C.name,value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"main",disabled:m.state.isSubmitting}),f.jsx(Ni,{field:C})]})})]}),f.jsxs("div",{className:"pt-2",children:[f.jsx(Dt,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),f.jsxs(Aue,{variant:"destructive",className:"mt-2 mb-3",children:[f.jsx(PO,{className:"h-4 w-4"}),f.jsx(Rue,{children:"Security Warning"}),f.jsx(Nue,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsx(m.Field,{name:"username",children:C=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:C.name,children:"Username"}),f.jsx(Cn,{id:C.name,value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"Git Username (Optional)",disabled:m.state.isSubmitting,autoComplete:"off"}),f.jsx(Ni,{field:C})]})}),f.jsx(m.Field,{name:"password",children:C=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:C.name,children:"Password / Token"}),f.jsx(Cn,{id:C.name,type:"password",value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"Password or PAT (Optional)",disabled:m.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Ni,{field:C})]})})]})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(bt,{variant:"ghost",size:"sm",onClick:y,disabled:m.state.isSubmitting,type:"button",children:[f.jsx(wa,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(m.Subscribe,{selector:C=>[C.canSubmit,C.isSubmitting,C.isValidating,C.isValid],children:([C,k,A,R])=>f.jsxs(bt,{variant:"secondary",size:"sm",type:"submit",disabled:k||!C||!R||A,children:[(k||A)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Jd,{className:"h-4 w-4 mr-1"})," ",k||A?"Saving...":"Save Repository"]})})]})]});return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(Dt,{htmlFor:"auto-sync-toggle",className:"text-sm font-medium",children:"Auto-sync after stream completion"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically sync conversations with linked repositories when a message stream completes"})]}),f.jsx(ol,{id:"auto-sync-toggle",checked:i,onCheckedChange:a})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(Dt,{htmlFor:"auto-init-repos-toggle",className:"text-sm font-medium",children:"Auto-initialize repositories on startup"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically clone/initialize configured repositories when the app starts (off by default)"})]}),f.jsx(ol,{id:"auto-init-repos-toggle",checked:yr(C=>C.autoInitializeReposOnStartup),onCheckedChange:yr.getState().setAutoInitializeReposOnStartup})]})]}),e.length>0&&f.jsx(crt,{onSyncAll:async()=>{await qn.getState().syncAllConversations()},onSyncPending:async()=>{await qn.getState().syncPendingConversations()},onInitializeRepos:async()=>{await qn.getState().initializeAllRepositories()},onAbortSync:async()=>{const{BulkSyncService:C}=await Zr(async()=>{const{BulkSyncService:k}=await Promise.resolve().then(()=>j0);return{BulkSyncService:k}},void 0);C.abort()},totalRepos:e.length,totalConversations:qn.getState().conversations.filter(C=>C.syncRepoId).length,pendingConversations:qn.getState().conversations.filter(C=>{const k=qn.getState().conversationSyncStatus[C.id];return C.syncRepoId&&k==="needs-sync"}).length})]}),!o&&!c&&f.jsxs(bt,{onClick:w,variant:"outline",className:"w-full mb-4",disabled:s,children:[f.jsx(Pd,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||c)&&S(),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),s&&!o&&!c?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]}):e.length===0&&!o&&!c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):f.jsx("div",{className:"border rounded-md overflow-x-auto",children:f.jsxs(of,{children:[f.jsx(np,{children:f.jsxs(ks,{children:[f.jsx(Or,{children:"Name"}),f.jsx(Or,{className:"hidden md:table-cell",children:"Remote URL"}),f.jsx(Or,{className:"hidden lg:table-cell",children:"Branch"}),f.jsx(Or,{className:"hidden lg:table-cell",children:"Auth"}),f.jsx(Or,{className:"text-right",children:"Actions"})]})}),f.jsx(lf,{children:e.map(C=>{const k=d[C.id],A=c===C.id,R=!!C.username||!!C.password,N=r[C.id]||"idle",I=N==="syncing",O=k||m.state.isSubmitting||!!c||I;let L=null,P="Initialize/Sync Repository";return N==="syncing"?(L=f.jsx(Qn,{className:"h-4 w-4 animate-spin mr-1"}),P="Initializing/Syncing..."):N==="idle"?(L=f.jsx(oE,{className:"h-4 w-4 text-green-500 mr-1"}),P="Sync Successful / Ready"):N==="error"?(L=f.jsx(_c,{className:"h-4 w-4 text-destructive mr-1"}),P="Sync Failed"):L=f.jsx(am,{className:"h-4 w-4 mr-1"}),f.jsxs(ks,{className:Ze(A?"bg-muted/50":"",O&&!A?"opacity-70":""),children:[f.jsx(zn,{className:"font-medium truncate max-w-[100px] sm:max-w-xs",children:C.name}),f.jsx(zn,{className:"text-xs truncate max-w-[100px] sm:max-w-xs hidden md:table-cell",children:C.remoteUrl}),f.jsx(zn,{className:"hidden lg:table-cell",children:C.branch||"main"}),f.jsx(zn,{className:"text-xs hidden lg:table-cell",children:R?"Configured":"None"}),f.jsxs(zn,{className:"text-right space-x-1",children:[f.jsx(On,{tooltipText:P,onClick:()=>x(C.id),"aria-label":`Initialize or Sync repo ${C.name}`,disabled:O,icon:L,variant:"outline",className:"h-8 w-8"}),f.jsx(On,{tooltipText:"Edit",onClick:()=>b(C),"aria-label":`Edit repo ${C.name}`,disabled:O,icon:f.jsx(s1,{}),className:"h-8 w-8"}),f.jsx(On,{tooltipText:"Delete",onClick:()=>v(C.id,C.name),"aria-label":`Delete repo ${C.name}`,disabled:O,icon:k?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Eo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},C.id)})})]})})]})]})},frt=We.memo(drt),hrt=()=>{const e=T.useMemo(()=>[{value:"config",label:"User Config",content:f.jsx(rrt,{})},{value:"sync",label:"Sync Repositories",content:f.jsx(frt,{})}],[]);return f.jsx(Dc,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},prt=We.memo(hrt);class mrt{constructor(){ve(this,"id","core-git-sync");ve(this,"unregisterPromptControlCallback",null);ve(this,"unregisterSettingsTabCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"selectedItemId",null);ve(this,"selectedItemType",null);ve(this,"syncRepos",[]);ve(this,"conversationSyncStatus",{});ve(this,"isStreaming",!1);ve(this,"autoSyncEnabled",!1);ve(this,"isBulkSyncing",!1);ve(this,"bulkSyncProgress",null);ve(this,"notifyComponentUpdate",null);ve(this,"linkConversationToRepo",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Yn.linkConversationToRepoRequest,{conversationId:t,repoId:n})});ve(this,"syncConversation",t=>{var n;(n=this.modApiRef)==null||n.emit(Yn.syncConversationRequest,{conversationId:t})});ve(this,"getConversationById",t=>qn.getState().getConversationById(t));ve(this,"syncAllConversations",async()=>{await qn.getState().syncAllConversations()});ve(this,"syncPendingConversations",async()=>{await qn.getState().syncPendingConversations()});ve(this,"initializeAllRepositories",async()=>{await qn.getState().initializeAllRepositories()});ve(this,"abortBulkSync",async()=>{const{BulkSyncService:t}=await Zr(async()=>{const{BulkSyncService:n}=await Promise.resolve().then(()=>j0);return{BulkSyncService:n}},void 0);t.abort()});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(jr.contextChanged,m=>{var y;this.selectedItemId=m.selectedItemId,this.selectedItemType=m.selectedItemType,(y=this.notifyComponentUpdate)==null||y.call(this)}),r=t.on(cs.repoChanged,()=>{var m;this.syncRepos=qn.getState().syncRepos,(m=this.notifyComponentUpdate)==null||m.call(this)}),s=t.on(Yn.conversationSyncStatusChanged,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"status"in m&&(this.conversationSyncStatus={...this.conversationSyncStatus,[m.conversationId]:m.status},(y=this.notifyComponentUpdate)==null||y.call(this))}),i=t.on(Zn.statusChanged,m=>{var y;typeof m=="object"&&m&&"status"in m&&(this.isStreaming=m.status==="streaming",(y=this.notifyComponentUpdate)==null||y.call(this))}),a=t.on(Zn.completed,async m=>{typeof m=="object"&&m&&"interactionId"in m&&"status"in m&&m.status==="COMPLETED"&&this.autoSyncEnabled&&await this.handleAutoSync()}),o=t.on(sn.autoSyncOnStreamCompleteChanged,m=>{var y;typeof m=="object"&&m&&"enabled"in m&&(this.autoSyncEnabled=m.enabled,(y=this.notifyComponentUpdate)==null||y.call(this))}),l=t.on(cs.bulkSyncStarted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!0,this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),c=t.on(cs.bulkSyncProgress,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),u=t.on(cs.bulkSyncCompleted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),d=t.on(cs.bulkSyncFailed,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),h=t.on(Yn.conversationUpdated,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"updates"in m&&m.conversationId===this.selectedItemId&&m.updates.syncRepoId!==void 0&&(this.loadInitialState(),(y=this.notifyComponentUpdate)==null||y.call(this))});this.eventUnsubscribers.push(n,r,s,i,a,o,l,c,u,d,h)}loadInitialState(){const t=qn.getState();this.selectedItemId=t.selectedItemId,this.selectedItemType=t.selectedItemType,this.syncRepos=t.syncRepos,this.conversationSyncStatus=t.conversationSyncStatus,this.isStreaming=Bn.getState().status==="streaming",this.autoSyncEnabled=yr.getState().autoSyncOnStreamComplete}async handleAutoSync(){if(!this.selectedItemId||this.selectedItemType!=="conversation")return;const t=this.getConversationById(this.selectedItemId);if(!(t!=null&&t.syncRepoId))return;const n=this.conversationSyncStatus[this.selectedItemId];if(!(n==="syncing"||n==="idle")){console.log(`[GitSyncControlModule] Auto-syncing conversation ${this.selectedItemId}`);try{await this.syncConversation(this.selectedItemId)}catch(r){console.error("[GitSyncControlModule] Auto-sync failed:",r)}}}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>We.createElement(ert,{module:this})})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"git",title:"Git",component:prt,order:60}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const grt=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const{syncRepos:n,repoInitializationStatus:r}=qn(yn(c=>({syncRepos:c.syncRepos,repoInitializationStatus:c.repoInitializationStatus}))),s=()=>{e.syncAllRepos()},i=c=>{e.syncRepo(c)},a=e.isSyncing,o=n.length>0,l=Object.values(r).some(c=>c==="syncing");return f.jsx(xr,{delayDuration:100,children:f.jsxs(pl,{children:[f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ml,{asChild:!0,children:f.jsx(bt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:!o,"aria-label":"Manual Git Sync",children:a||l?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Sc,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:o?"Manual Git Sync":"No sync repositories configured"})]}),f.jsx(gl,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-semibold text-sm",children:"Git Sync Repositories"}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:s,disabled:!o||a||l,className:"h-8",children:[a||l?f.jsx(Qn,{className:"h-3 w-3 mr-1 animate-spin"}):f.jsx(am,{className:"h-3 w-3 mr-1"}),"Sync All"]})]}),o?f.jsx("div",{className:"space-y-2",children:n.map(c=>{const u=r[c.id]||"idle",d=u==="syncing";return f.jsxs("div",{className:Ze("flex items-center justify-between p-3 border rounded-lg","bg-card hover:bg-muted/50 transition-colors"),children:[f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm font-medium truncate",children:c.name}),f.jsx(mi,{variant:u==="idle"?"secondary":u==="syncing"?"default":u==="error"?"destructive":"outline",className:"text-xs",children:u==="idle"?"Ready":u==="syncing"?"Syncing":u==="error"?"Error":"Unknown"})]}),f.jsx("p",{className:"text-xs text-muted-foreground truncate",children:c.branch||"main"})]}),f.jsx(bt,{variant:"ghost",size:"sm",onClick:()=>i(c.id),disabled:d||a,className:"h-8 w-8 p-0",children:d?f.jsx(Qn,{className:"h-3 w-3 animate-spin"}):f.jsx(am,{className:"h-3 w-3"})})]},c.id)})}):f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured. Go to Settings  Git  Sync Repositories to add one."})]})})]})})};class yrt{constructor(){ve(this,"id","core-manual-git-sync-sidebar");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"syncRepos",[]);ve(this,"repoInitializationStatus",{});ve(this,"isSyncing",!1);ve(this,"notifyComponentUpdate",null);ve(this,"syncAllRepos",async()=>{var t,n;if(!(this.isSyncing||this.syncRepos.length===0)){this.isSyncing=!0,(t=this.notifyComponentUpdate)==null||t.call(this);try{console.log("[ManualSyncSidebarControlModule] Starting bulk sync for all repositories and conversations");const{BulkSyncService:r}=await Zr(async()=>{const{BulkSyncService:s}=await Promise.resolve().then(()=>j0);return{BulkSyncService:s}},void 0);await r.syncAll({syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3}),console.log("[ManualSyncSidebarControlModule] Completed bulk sync")}catch(r){console.error("[ManualSyncSidebarControlModule] Error in bulk sync:",r)}finally{this.isSyncing=!1,(n=this.notifyComponentUpdate)==null||n.call(this)}}});ve(this,"syncRepo",async t=>{var r;const n=this.syncRepos.find(s=>s.id===t);if(!n){console.warn(`[ManualSyncSidebarControlModule] Repository ${t} not found`);return}console.log(`[ManualSyncSidebarControlModule] Starting sync for repository: ${n.name}`),(r=this.modApiRef)==null||r.emit(Yn.initializeOrSyncRepoRequest,{repoId:t})});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(cs.repoChanged,()=>{var i;this.syncRepos=qn.getState().syncRepos,(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(cs.repoInitStatusChanged,i=>{var a;typeof i=="object"&&i&&"repoId"in i&&"status"in i&&(this.repoInitializationStatus={...this.repoInitializationStatus,[i.repoId]:i.status},(a=this.notifyComponentUpdate)==null||a.call(this))}),s=t.on(Yn.syncReposLoaded,()=>{var i;this.loadInitialState(),(i=this.notifyComponentUpdate)==null||i.call(this)});this.eventUnsubscribers.push(n,r,s)}loadInitialState(){const t=qn.getState();this.syncRepos=t.syncRepos,this.repoInitializationStatus=t.repoInitializationStatus}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>We.createElement(grt,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const brt=Ke({path:$e().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),vrt=Ke({path:$e().describe("The path of the file to read within the VFS."),encoding:hl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),xrt=Ke({path:$e().describe("The path where the file should be written."),content:$e().describe("The content to write to the file."),encoding:hl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),wrt=Ke({path:$e().describe("The path of the file or directory to delete."),recursive:br().optional().default(!1).describe("Whether to delete directories recursively.")}),_rt=Ke({path:$e().describe("The path of the directory to create (including parents).")}),Srt=Ke({oldPath:$e().describe("The current path of the item to rename."),newName:$e().describe("The new name for the item.")});class Crt{constructor(){ve(this,"id","core-vfs-tools");ve(this,"unregisterCallbacks",[])}async initialize(t){console.log(`[${this.id}] Initialized.`)}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}console.log(`[${this.id}] Registering Core VFS Tools...`);const n={description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:brt};this.unregisterCallbacks.push(t.registerTool("vfsListFiles",n,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=zr(l||"/");try{const h=await lD(d,{fsInstance:u});return{success:!0,path:d,entries:h.map(m=>({name:m.name,type:m.isDirectory?"folder":"file",size:m.size,lastModified:m.lastModified.toISOString()}))}}catch(h){return{success:!1,path:d,error:h.message}}}));const r={description:"Read the content of a file from the VFS.",parameters:vrt};this.unregisterCallbacks.push(t.registerTool("vfsReadFile",r,async({path:l,encoding:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l);try{const m=await Gh(h,{fsInstance:d});let y;return c==="base64"?y=btoa(String.fromCharCode(...m)):y=new TextDecoder().decode(m),{success:!0,path:h,content:y,encoding:c}}catch(m){return{success:!1,path:h,error:m.message}}}));const s={description:"Write content to a file in the VFS.",parameters:xrt};this.unregisterCallbacks.push(t.registerTool("vfsWriteFile",s,async({path:l,content:c,encoding:u},d)=>{const h=d==null?void 0:d.fsInstance;if(!h)return{success:!1,error:"Filesystem instance not available in context."};const m=zr(l);try{let y;if(u==="base64"){const b=atob(c),v=b.length,x=new Uint8Array(v);for(let w=0;w<v;w++)x[w]=b.charCodeAt(w);y=x}else y=c;return await eT(m,y,{fsInstance:h}),{success:!0,path:m}}catch(y){return{success:!1,path:m,error:y.message}}}));const i={description:"Delete a file or directory from the VFS.",parameters:wrt};this.unregisterCallbacks.push(t.registerTool("vfsDelete",i,async({path:l,recursive:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l);try{return await cD(h,c,{fsInstance:d}),{success:!0,path:h}}catch(m){return{success:!1,path:h,error:m.message}}}));const a={description:"Create a directory (including parents) in the VFS.",parameters:_rt};this.unregisterCallbacks.push(t.registerTool("vfsCreateDirectory",a,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=zr(l);try{return await mZ(d,{fsInstance:u}),{success:!0,path:d}}catch(h){return{success:!1,path:d,error:h.message}}}));const o={description:"Rename a file or directory in the VFS.",parameters:Srt};this.unregisterCallbacks.push(t.registerTool("vfsRename",o,async({oldPath:l,newName:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l),m=zr(h.substring(0,h.lastIndexOf("/"))||"/"),y=Au(m,c);try{return await yZ(h,y,{fsInstance:d}),{success:!0,oldPath:h,newPath:y}}catch(b){return{success:!1,oldPath:h,newName:c,error:b.message}}})),console.log(`[${this.id}] Core VFS Tools Registered.`)}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const krt=Ke({path:$e().describe("The directory path within the VFS to initialize as a Git repository.")}),Ert=Ke({path:$e().describe("The directory path of the Git repository within the VFS to commit."),message:$e().describe("The commit message.")}),Trt=Ke({path:$e().describe("The directory path of the Git repository within the VFS to pull from."),branch:$e().optional().describe("The branch name to pull.")}),Art=Ke({path:$e().describe("The directory path of the Git repository within the VFS to push."),branch:$e().optional().describe("The branch name to push.")}),Rrt=Ke({path:$e().describe("The directory path of the Git repository within the VFS to check status.")});class Nrt{constructor(){ve(this,"id","core-git-tools");ve(this,"unregisterCallbacks",[])}async initialize(t){}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={description:"Initialize an empty Git repository in a VFS directory.",parameters:krt};this.unregisterCallbacks.push(t.registerTool("gitInit",n,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await hZ(o,{fsInstance:c}),{success:!0,message:`Repository initialized at ${o}`}}catch(u){return{success:!1,error:u.message}}}));const r={description:"Stage all changes and commit them in a VFS Git repository.",parameters:Ert};this.unregisterCallbacks.push(t.registerTool("gitCommit",r,async({path:o,message:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=yr.getState();if(!d.gitUserName||!d.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await aD(o,l,{fsInstance:u}),{success:!0,message:`Changes committed in ${o}`}}catch(h){return{success:!1,error:h.message}}}));const s={description:"Pull changes from the remote repository for the specified branch.",parameters:Trt};this.unregisterCallbacks.push(t.registerTool("gitPull",s,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await QE(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const i={description:"Push committed changes from the local branch to the remote repository.",parameters:Art};this.unregisterCallbacks.push(t.registerTool("gitPush",i,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await oD(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const a={description:"Get the Git status for a VFS repository.",parameters:Rrt};this.unregisterCallbacks.push(t.registerTool("gitStatus",a,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await pZ(o,{fsInstance:c}),{success:!0,message:`Status checked for ${o}`}}catch(u){return{success:!1,error:u.message}}}))}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}class Mrt{constructor(){ve(this,"id","core-mcp-tools");ve(this,"unregisterCallbacks",[]);ve(this,"mcpToolUnregisterCallbacks",[]);ve(this,"mcpClients",new Map);ve(this,"modApi");ve(this,"connectionAttempts",new Map);ve(this,"retryTimeouts",new Map)}async initialize(t){this.modApi=t,globalThis.mcpToolsModuleInstance=this,je.emit(kr.loadMcpStateRequest,void 0),this.setupEventListeners(),await this.initializeMcpClients()}register(t){}destroy(){this.retryTimeouts.forEach(t=>{clearTimeout(t)}),this.retryTimeouts.clear(),this.connectionAttempts.clear(),this.mcpClients.forEach(t=>{try{t.client&&typeof t.client.disconnect=="function"&&t.client.disconnect()}catch(n){console.error(`[${this.id}] Error disconnecting MCP client ${t.id}:`,n)}}),this.mcpClients.clear(),this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.mcpToolUnregisterCallbacks.forEach(t=>t()),this.mcpToolUnregisterCallbacks=[]}setupEventListeners(){const t=n=>{this.initializeMcpClients().catch(r=>{console.error(`[${this.id}] Error reinitializing MCP clients:`,r)})};je.on(kr.serversChanged,t),this.unregisterCallbacks.push(()=>{je.off(kr.serversChanged,t)})}getRetryConfig(){const t=el.getState();return{maxAttempts:t.retryAttempts,baseDelay:t.retryDelay,timeout:t.connectionTimeout}}async initializeMcpClients(){try{const n=el.getState().servers.filter(r=>r.enabled);this.connectionAttempts.clear(),this.retryTimeouts.forEach(r=>{clearTimeout(r)}),this.retryTimeouts.clear(),this.mcpClients.forEach(r=>{try{r.client&&typeof r.client.disconnect=="function"&&r.client.disconnect()}catch(s){console.error(`[${this.id}] Error disconnecting existing MCP client ${r.id}:`,s)}}),this.mcpClients.clear(),this.mcpToolUnregisterCallbacks.forEach(r=>r()),this.mcpToolUnregisterCallbacks=[];for(const r of n)this.connectToMcpServerWithRetry(r)}catch(t){console.error(`[${this.id}] Error initializing MCP clients:`,t),Oe.error("Failed to initialize MCP clients",{description:t instanceof Error?t.message:"Unknown error occurred"})}}async connectToMcpServerWithRetry(t){const n=this.getRetryConfig(),r=this.connectionAttempts.get(t.id)||0;try{await this.connectToMcpServer(t),this.connectionAttempts.delete(t.id);const s=this.retryTimeouts.get(t.id);s&&(clearTimeout(s),this.retryTimeouts.delete(t.id)),Oe.success(`Connected to MCP server: ${t.name}`,{description:"Successfully connected and loaded tools"})}catch(s){if(console.error(`[${this.id}] Failed to connect to MCP server ${t.name} (attempt ${r+1}):`,s),el.getState().setServerStatus({serverId:t.id,connected:!1,error:s instanceof Error?s.message:"Connection failed",lastConnected:void 0,toolCount:0,tools:[]}),r<n.maxAttempts){this.connectionAttempts.set(t.id,r+1);const a=r+1,o=n.baseDelay*Math.pow(1.5,r),l=setTimeout(()=>{this.retryTimeouts.delete(t.id),this.connectToMcpServerWithRetry(t)},o);this.retryTimeouts.set(t.id,l),Oe.warning(`MCP server connection failed: ${t.name}`,{description:`Retrying in ${Math.round(o/1e3)}s (attempt ${a+1}/${n.maxAttempts+1})`})}else{this.connectionAttempts.delete(t.id);const a=s instanceof Error?s.message:"Connection failed";Oe.error(`Failed to connect to MCP server: ${t.name}`,{description:`All ${n.maxAttempts+1} connection attempts failed. ${a}`,duration:1e4}),console.error(`[${this.id}] All retry attempts exhausted for MCP server ${t.name}`)}}}async connectToMcpServer(t){const n=this.getRetryConfig();try{let r,s="streamable-http";if(t.url.startsWith("stdio://"))r=await this.connectWithStdioTransport(t),s="stdio";else{const i=new Promise((a,o)=>{setTimeout(()=>{o(new Error(`Connection timeout after ${n.timeout}ms`))},n.timeout)});try{r=await Promise.race([this.connectWithStreamableHttp(t),i]),s="streamable-http"}catch{r=await Promise.race([this.connectWithSseTransport(t),i]),s="sse"}}await this.handleSuccessfulConnection(t,r,s)}catch(r){let s=r;throw r instanceof Error&&(r.message.includes("Bridge service not healthy")||r.message.includes("stdio bridge connection failed")?s=new Error("Stdio MCP server requires LiteChat MCP Bridge. Please install and start the bridge service: npm install -g litechat-mcp-bridge && litechat-mcp-bridge"):r.message.includes("fetch")?s=new Error(`Network error: Unable to reach MCP server at ${t.url}. Please check if the server is running and accessible.`):r.message.includes("timeout")?s=new Error(`Connection timeout: MCP server at ${t.url} did not respond within ${n.timeout}ms.`):r.message.includes("401")||r.message.includes("403")?s=new Error(`Authentication error: Invalid credentials for MCP server at ${t.url}.`):r.message.includes("404")?s=new Error(`Server not found: MCP server endpoint ${t.url} does not exist.`):r.message.includes("500")&&(s=new Error(`Server error: MCP server at ${t.url} returned an internal server error.`))),console.error(`[${this.id}] Failed to connect to MCP server ${t.name}:`,s),s}}async connectWithStreamableHttp(t){const n=this.createStreamableHttpTransport(t);return WU({transport:n})}async getBridgeUrl(){const n=el.getState().bridgeConfig||{};if(n.url)return n.url;if(n.host||n.port){const r=n.host||"localhost",s=n.port||3001;return`http://${r}:${s}`}return"http://localhost:3001"}async connectWithStdioTransport(t){var o;if(!t.url.startsWith("stdio://"))throw new Error("Not a stdio server configuration");const n=new URL(t.url),r=n.hostname||n.pathname.replace("//",""),s=n.searchParams.get("args")||"";if(!r)throw new Error("stdio:// URL must specify a command (e.g., stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,.)");const i=await this.getBridgeUrl(),a=`${r}-${Date.now()}`;try{const l=new URLSearchParams;l.set("command",r),s&&l.set("args",s);const c=`${i}/servers/${a}/mcp?${l.toString()}`,u=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"tools/list",params:{}})});if(!u.ok)throw new Error(`Failed to get tools: ${u.status} ${u.statusText}`);const d=await u.json();if(d.error)throw new Error(`Tools request failed: ${d.error.message}`);let h=0;return{tools:((o=d.result)==null?void 0:o.tools)||[],serverEndpoint:c,callTool:async m=>{const y=`${Date.now()}_${++h}`,b=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:y,method:"tools/call",params:{name:m.name,arguments:m.arguments}})});if(!b.ok)throw new Error(`Tool call failed: ${b.status} ${b.statusText}`);const v=await b.json();if(v.error)throw new Error(`Tool execution failed: ${v.error.message}`);return v.result}}}catch(l){throw new Error(`Bridge connection failed: ${l instanceof Error?l.message:l}. Ensure bridge is running with: npm run mcp-proxy. Command: ${r}, Args: ${s||"none"}`)}}async connectWithSseTransport(t){return WU({transport:{type:"sse",url:t.url,headers:t.headers||{}}})}createStreamableHttpTransport(t){let n=null,r=!1;return{async start(){const s=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...t.headers},body:JSON.stringify({jsonrpc:"2.0",id:`init_${Date.now()}`,method:"initialize",params:{protocolVersion:"2025-03-26",capabilities:{tools:{}},clientInfo:{name:"LiteChat",version:"1.0.0"}}})});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);n=s.headers.get("Mcp-Session-Id");const i=await s.json();if(i.error)throw new Error(`MCP Initialize Error: ${i.error.message}`);const a=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify({jsonrpc:"2.0",method:"initialized",params:{}})});if(!a.ok)throw new Error(`Failed to send initialized notification: ${a.status}`);r=!0},async send(s){var o,l;if(!r)throw new Error("Transport not connected");const i=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify(s)});if(!i.ok)throw i.status===404&&n?(n=null,r=!1,new Error("Session expired, reinitializing connection")):new Error(`HTTP ${i.status}: ${i.statusText}`);const a=i.headers.get("Content-Type")||"";if(a.includes("text/event-stream"))(o=i.body)==null||o.getReader();else if(a.includes("application/json")){const c=await i.json();(l=this.onmessage)==null||l.call(this,c)}},async close(){var s;if(n)try{await fetch(t.url,{method:"DELETE",headers:{Origin:window.location.origin,"Mcp-Session-Id":n,...t.headers}})}catch{}r=!1,n=null,(s=this.onclose)==null||s.call(this)},onclose:void 0,onerror:void 0,onmessage:void 0}}async handleSuccessfulConnection(t,n,r){let s;try{if(n.tools&&Array.isArray(n.tools))s={},n.tools.forEach(l=>{s[l.name]={description:l.description,parameters:l.inputSchema}});else throw console.error(`[${this.id}] Bridge client missing tools array:`,n),new Error("Bridge client missing tools array")}catch(l){throw console.error(`[${this.id}] Failed to retrieve tools from ${t.name}:`,l),console.error(`[${this.id}] Error stack:`,l instanceof Error?l.stack:"No stack trace available"),l}const i={id:t.id,name:t.name,client:n,tools:s,transport:r};this.mcpClients.set(t.id,i),i.tools=s,this.modApi&&Object.entries(s).forEach(([l,c])=>{const u=`mcp_${t.name}_${l}`,d=c;let h;if(d.parameters&&typeof d.parameters=="object"&&d.parameters.properties){const v={},x=d.parameters.required||[];for(const[w,S]of Object.entries(d.parameters.properties)){let C;switch(S.type){case"string":C=$e();break;case"number":C=Tt();break;case"boolean":C=br();break;case"array":C=ln(mh());break;case"object":C=Ke({}).passthrough();break;default:C=mh()}S.description&&(C=C.describe(S.description)),x.includes(w)||(C=C.optional()),v[w]=C}h=Ke(v)}else h=Ke({});const m={description:d.description||`MCP tool ${l} from ${t.name}`,parameters:h},y=async v=>{const x=await i.client.callTool({name:l,arguments:v});return x&&x.content?Array.isArray(x.content)?x.content.map(S=>S.type==="text"?S.text:S.type==="image"?`[Image: ${S.mimeType||"unknown format"}]`:JSON.stringify(S)).join(`
`):typeof x.content=="string"?x.content:JSON.stringify(x.content):JSON.stringify(x)},b=this.modApi.registerTool(u,m,y);this.mcpToolUnregisterCallbacks.push(b),je.emit(kr.toolDiscovered,{toolName:l,serverId:t.id,serverName:t.name,toolDefinition:d})}),el.getState().setServerStatus({serverId:t.id,connected:!0,error:void 0,lastConnected:new Date,toolCount:Object.keys(s).length,tools:Object.keys(s)});const o={"streamable-http":"Streamable HTTP (latest)",sse:"SSE (legacy)",stdio:"Stdio (local bridge)"};Oe.success(`Connected to MCP server: ${t.name}`,{description:`Using ${o[r]} transport with ${Object.keys(s).length} tools`})}retryServerConnection(t){const r=el.getState().servers.find(a=>a.id===t);if(!r){console.error(`[${this.id}] Server with ID ${t} not found`);return}if(!r.enabled)return;this.connectionAttempts.delete(t);const s=this.retryTimeouts.get(t);s&&(clearTimeout(s),this.retryTimeouts.delete(t));const i=this.mcpClients.get(t);if(i){try{i.client&&typeof i.client.disconnect=="function"&&i.client.disconnect()}catch(a){console.error(`[${this.id}] Error disconnecting existing client for ${r.name}:`,a)}this.mcpClients.delete(t)}this.connectToMcpServerWithRetry(r)}getConnectionStatus(){const t={},n=el.getState();return n.servers.forEach(r=>{const s=n.serverStatuses[r.id];t[r.id]={connected:(s==null?void 0:s.connected)||!1,error:s==null?void 0:s.error,toolCount:(s==null?void 0:s.toolCount)||0}}),t}registerMcpToolWithAI(t,n){const r=this.mcpClients.get(t);if(!r)return console.error(`[${this.id}] No MCP client found for server ${t}`),()=>{};const s=r.tools[n];if(!s)return console.error(`[${this.id}] Tool ${n} not found in server ${r.name}`),()=>{};if(!this.modApi)return console.error(`[${this.id}] ModApi not available for tool registration`),()=>{};const i=`mcp_${r.name}_${n}`;try{const a={description:s.description||`MCP tool ${n} from ${r.name}`,parameters:s.parameters||Ke({})},o=async c=>{const u=await r.client.callTool({name:n,arguments:c});let d="";u&&u.content?Array.isArray(u.content)?d=u.content.map(m=>m.type==="text"?m.text:m.type==="image"?`[Image: ${m.mimeType||"unknown format"}]`:JSON.stringify(m)).join(`
`):typeof u.content=="string"?d=u.content:d=JSON.stringify(u.content):d=JSON.stringify(u);const{maxResponseSize:h}=el.getState();return d.length>h&&(d=d.substring(0,h)+`

[... response truncated due to size ...]`),d},l=this.modApi.registerTool(i,a,o);return this.mcpToolUnregisterCallbacks.push(l),je.emit(kr.toolRegistered,{toolName:n,serverId:r.id,serverName:r.name,prefixedToolName:i}),l}catch(a){return console.error(`[${this.id}] Error registering MCP tool ${n} with AI SDK:`,a),()=>{}}}unregisterMcpToolFromAI(t,n){const r=this.mcpClients.get(t);if(!r){console.error(`[${this.id}] No MCP client found for server ${t}`);return}const s=`mcp_${r.name}_${n}`;je.emit(kr.toolUnregistered,{toolName:n,serverId:r.id,prefixedToolName:s})}}const Irt=(e,t=80)=>e.length<=t?e:e.slice(0,t).trim()+"...",Iue=({module:e,popoverMaxSteps:t,setPopoverMaxSteps:n,className:r})=>{const s=e.getEnabledTools(),i=e.getSelectedItemId(),a=e.getSelectedItemType(),o=e.getGlobalDefaultMaxSteps(),l=No(w=>w.tools),[c,u]=T.useState(""),d=T.useMemo(()=>Object.entries(l).map(([w,{definition:S,modId:C}])=>({name:w,description:S.description??"No description provided.",modId:C})).sort((w,S)=>w.name.localeCompare(S.name)),[l]),h=T.useMemo(()=>{const w=c.trim().toLowerCase();return w?d.filter(S=>S.name.toLowerCase().includes(w)||S.description.toLowerCase().includes(w)||S.modId.toLowerCase().includes(w)):d},[d,c]),m=T.useCallback((w,S)=>{e.setEnabledTools(C=>{const k=new Set(C);return S?k.add(w):k.delete(w),k})},[e]),y=T.useCallback(w=>{e.setEnabledTools(()=>w?new Set(d.map(S=>S.name)):new Set)},[d,e]),b=w=>{const S=w.target.value;if(S===""){n(null);return}const C=parseInt(S,10);if(isNaN(C))n(null);else{const k=Math.max(1,Math.min(20,C));n(k)}},v=t===null?"":String(t),x=a!=="conversation"||!i;return f.jsxs("div",{className:Ze("p-4 max-w-2xl space-y-3",r),children:[f.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter tools...",value:c,onChange:w=>u(w.target.value),className:"pl-8 h-9",disabled:x})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs(Dt,{className:"text-xs text-muted-foreground",children:[h.length," tools shown (",s.size," enabled)"]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(bt,{variant:"outline",size:"sm",onClick:()=>y(!0),disabled:x||d.length===0,children:"Enable All"}),f.jsx(bt,{variant:"outline",size:"sm",onClick:()=>y(!1),disabled:x||d.length===0||s.size===0,children:"Disable All"})]})]}),f.jsx("div",{className:"border rounded-md bg-background/50",children:x?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Select a conversation to manage tools."}):d.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):h.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):f.jsx(Po,{className:"h-96 w-full",children:f.jsx("div",{className:"p-2 space-y-1",children:h.map(w=>f.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[f.jsx(ol,{id:`tool-switch-${w.name}`,checked:s.has(w.name),onCheckedChange:S=>m(w.name,S),className:"flex-shrink-0",disabled:x}),f.jsxs("div",{className:"flex-grow pl-2 space-y-0.5",children:[f.jsx(Dt,{htmlFor:`tool-switch-${w.name}`,className:Ze("block text-sm font-medium",x?"cursor-not-allowed":"cursor-pointer"),children:w.name}),f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"block text-xs text-muted-foreground break-words cursor-help",children:Irt(w.description)})}),f.jsx(Sr,{side:"bottom",className:"max-w-sm",children:f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"font-medium",children:w.name}),f.jsxs("div",{className:"text-xs opacity-90",children:["From: ",w.modId]}),f.jsx("div",{className:"text-xs",children:w.description})]})})]})]})]},w.name))})})}),f.jsxs("div",{className:"pt-2",children:[f.jsx(Dt,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),f.jsx(Cn,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:v,onChange:b,className:"w-20 h-8 text-xs mt-1",placeholder:String(o??5),disabled:x}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})},jrt=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=T.useState(!1),[s,i]=T.useState(e.getMaxStepsOverride()),a=e.getEnabledTools(),o=e.getMaxStepsOverride(),l=e.getIsStreaming(),c=e.getIsVisible();T.useEffect(()=>{i(e.getMaxStepsOverride())},[e.getMaxStepsOverride()]);const u=m=>{r(m),!m&&s!==e.getMaxStepsOverride()&&e.setMaxStepsOverride(s)},d=a.size>0||o!==null,h=l;return c?f.jsxs(pl,{open:n,onOpenChange:u,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ml,{asChild:!0,children:f.jsx(bt,{variant:d?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:h,"aria-label":"Configure Tools",children:f.jsx(om,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:`Tools (${a.size} enabled)`})]})}),f.jsx(gl,{className:"w-auto p-0",align:"start",children:f.jsx(Iue,{module:e,popoverMaxSteps:s,setPopoverMaxSteps:i})})]}):null};class Ort{constructor(){ve(this,"id","core-tool-selector");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"transientEnabledTools",new Set);ve(this,"transientMaxStepsOverride",null);ve(this,"isStreaming",!1);ve(this,"isVisible",!0);ve(this,"selectedItemId",null);ve(this,"selectedItemType",null);ve(this,"allToolsCount",0);ve(this,"globalDefaultMaxSteps",5);ve(this,"notifyComponentUpdate",null);ve(this,"getEnabledTools",()=>this.transientEnabledTools);ve(this,"getMaxStepsOverride",()=>this.transientMaxStepsOverride);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"getIsVisible",()=>this.isVisible);ve(this,"getSelectedItemId",()=>this.selectedItemId);ve(this,"getSelectedItemType",()=>this.selectedItemType);ve(this,"getAllToolsCount",()=>this.allToolsCount);ve(this,"getGlobalDefaultMaxSteps",()=>this.globalDefaultMaxSteps);ve(this,"setEnabledTools",t=>{var n;this.transientEnabledTools=t(this.transientEnabledTools),(n=this.notifyComponentUpdate)==null||n.call(this)});ve(this,"setMaxStepsOverride",t=>{var n;this.transientMaxStepsOverride=t,(n=this.notifyComponentUpdate)==null||n.call(this)});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var o;this.loadInitialState(),this.updateVisibility(),(o=this.notifyComponentUpdate)==null||o.call(this);const n=t.on(Zn.statusChanged,l=>{var c;typeof l=="object"&&l&&"status"in l&&this.isStreaming!==(l.status==="streaming")&&(this.isStreaming=l.status==="streaming",(c=this.notifyComponentUpdate)==null||c.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var l;this.updateVisibility(),(l=this.notifyComponentUpdate)==null||l.call(this)}),s=t.on(jr.contextChanged,l=>{var c;this.selectedItemId=l.selectedItemId,this.selectedItemType=l.selectedItemType,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this)}),i=t.on(sn.toolMaxStepsChanged,l=>{var c;typeof l=="object"&&l&&"steps"in l&&(this.globalDefaultMaxSteps=l.steps,(c=this.notifyComponentUpdate)==null||c.call(this))}),a=t.on($r.toolsChanged,l=>{var c;if(l&&typeof l.tools=="object"){const u=Object.keys(l.tools).length;this.allToolsCount!==u&&(this.allToolsCount=u,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this))}});this.eventUnsubscribers.push(n,r,s,i,a)}loadInitialState(){this.isStreaming=Bn.getState().status==="streaming",this.selectedItemId=qn.getState().selectedItemId,this.selectedItemType=qn.getState().selectedItemType,this.allToolsCount=Object.keys(No.getState().tools).length,this.globalDefaultMaxSteps=yr.getState().toolMaxSteps}updateVisibility(){var a,o;const{getSelectedModel:t}=Rr.getState(),n=t(),r=this.allToolsCount>0,s=((o=(a=n==null?void 0:n.metadata)==null?void 0:a.supported_parameters)==null?void 0:o.includes("tools"))??!1,i=r&&s;this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>We.createElement(jrt,{module:this}),getMetadata:()=>{if(this.transientEnabledTools.size>0||this.transientMaxStepsOverride!==null)return{enabledTools:Array.from(this.transientEnabledTools),...this.transientMaxStepsOverride!==null&&{maxSteps:this.transientMaxStepsOverride}}},clearOnSubmit:()=>{var r;let n=!1;this.transientEnabledTools.size>0&&(this.transientEnabledTools=new Set,n=!0),this.transientMaxStepsOverride!==null&&(this.transientMaxStepsOverride=null,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}var uW=1,Prt=.9,Drt=.8,Frt=.17,_3=.1,S3=.999,Lrt=.9999,Brt=.99,$rt=/[\\\/_+.#"@\[\(\{&]/,zrt=/[\\\/_+.#"@\[\(\{&]/g,Urt=/[\s-]/,jue=/[\s-]/g;function vO(e,t,n,r,s,i,a){if(i===t.length)return s===e.length?uW:Brt;var o=`${s},${i}`;if(a[o]!==void 0)return a[o];for(var l=r.charAt(i),c=n.indexOf(l,s),u=0,d,h,m,y;c>=0;)d=vO(e,t,n,r,c+1,i+1,a),d>u&&(c===s?d*=uW:$rt.test(e.charAt(c-1))?(d*=Drt,m=e.slice(s,c-1).match(zrt),m&&s>0&&(d*=Math.pow(S3,m.length))):Urt.test(e.charAt(c-1))?(d*=Prt,y=e.slice(s,c-1).match(jue),y&&s>0&&(d*=Math.pow(S3,y.length))):(d*=Frt,s>0&&(d*=Math.pow(S3,c-s))),e.charAt(c)!==t.charAt(i)&&(d*=Lrt)),(d<_3&&n.charAt(c-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(c-1)!==r.charAt(i))&&(h=vO(e,t,n,r,c+1,i+2,a),h*_3>d&&(d=h*_3)),d>u&&(u=d),c=n.indexOf(l,c+1);return a[o]=u,u}function dW(e){return e.toLowerCase().replace(jue," ")}function qrt(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,vO(e,t,dW(e),dW(t),0,0,{})}var Wv='[cmdk-group=""]',C3='[cmdk-group-items=""]',Vrt='[cmdk-group-heading=""]',Oue='[cmdk-item=""]',fW=`${Oue}:not([aria-disabled="true"])`,xO="cmdk-item-select",l0="data-value",Wrt=(e,t,n)=>qrt(e,t,n),Pue=T.createContext(void 0),i_=()=>T.useContext(Pue),Due=T.createContext(void 0),V5=()=>T.useContext(Due),Fue=T.createContext(void 0),Lue=T.forwardRef((e,t)=>{let n=c0(()=>{var ee,se;return{search:"",value:(se=(ee=e.value)!=null?ee:e.defaultValue)!=null?se:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=c0(()=>new Set),s=c0(()=>new Map),i=c0(()=>new Map),a=c0(()=>new Set),o=Bue(e),{label:l,children:c,value:u,onValueChange:d,filter:h,shouldFilter:m,loop:y,disablePointerSelection:b=!1,vimBindings:v=!0,...x}=e,w=ia(),S=ia(),C=ia(),k=T.useRef(null),A=nst();Em(()=>{if(u!==void 0){let ee=u.trim();n.current.value=ee,R.emit()}},[u]),Em(()=>{A(6,V)},[]);let R=T.useMemo(()=>({subscribe:ee=>(a.current.add(ee),()=>a.current.delete(ee)),snapshot:()=>n.current,setState:(ee,se,pe)=>{var ce,Ie,De,Se;if(!Object.is(n.current[ee],se)){if(n.current[ee]=se,ee==="search")P(),O(),A(1,L);else if(ee==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Ce=document.getElementById(C);Ce?Ce.focus():(ce=document.getElementById(w))==null||ce.focus()}if(A(7,()=>{var Ce;n.current.selectedItemId=(Ce=F())==null?void 0:Ce.id,R.emit()}),pe||A(5,V),((Ie=o.current)==null?void 0:Ie.value)!==void 0){let Ce=se??"";(Se=(De=o.current).onValueChange)==null||Se.call(De,Ce);return}}R.emit()}},emit:()=>{a.current.forEach(ee=>ee())}}),[]),N=T.useMemo(()=>({value:(ee,se,pe)=>{var ce;se!==((ce=i.current.get(ee))==null?void 0:ce.value)&&(i.current.set(ee,{value:se,keywords:pe}),n.current.filtered.items.set(ee,I(se,pe)),A(2,()=>{O(),R.emit()}))},item:(ee,se)=>(r.current.add(ee),se&&(s.current.has(se)?s.current.get(se).add(ee):s.current.set(se,new Set([ee]))),A(3,()=>{P(),O(),n.current.value||L(),R.emit()}),()=>{i.current.delete(ee),r.current.delete(ee),n.current.filtered.items.delete(ee);let pe=F();A(4,()=>{P(),(pe==null?void 0:pe.getAttribute("id"))===ee&&L(),R.emit()})}),group:ee=>(s.current.has(ee)||s.current.set(ee,new Set),()=>{i.current.delete(ee),s.current.delete(ee)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:w,inputId:C,labelId:S,listInnerRef:k}),[]);function I(ee,se){var pe,ce;let Ie=(ce=(pe=o.current)==null?void 0:pe.filter)!=null?ce:Wrt;return ee?Ie(ee,n.current.search,se):0}function O(){if(!n.current.search||o.current.shouldFilter===!1)return;let ee=n.current.filtered.items,se=[];n.current.filtered.groups.forEach(ce=>{let Ie=s.current.get(ce),De=0;Ie.forEach(Se=>{let Ce=ee.get(Se);De=Math.max(Ce,De)}),se.push([ce,De])});let pe=k.current;X().sort((ce,Ie)=>{var De,Se;let Ce=ce.getAttribute("id"),qe=Ie.getAttribute("id");return((De=ee.get(qe))!=null?De:0)-((Se=ee.get(Ce))!=null?Se:0)}).forEach(ce=>{let Ie=ce.closest(C3);Ie?Ie.appendChild(ce.parentElement===Ie?ce:ce.closest(`${C3} > *`)):pe.appendChild(ce.parentElement===pe?ce:ce.closest(`${C3} > *`))}),se.sort((ce,Ie)=>Ie[1]-ce[1]).forEach(ce=>{var Ie;let De=(Ie=k.current)==null?void 0:Ie.querySelector(`${Wv}[${l0}="${encodeURIComponent(ce[0])}"]`);De==null||De.parentElement.appendChild(De)})}function L(){let ee=X().find(pe=>pe.getAttribute("aria-disabled")!=="true"),se=ee==null?void 0:ee.getAttribute(l0);R.setState("value",se||void 0)}function P(){var ee,se,pe,ce;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let Ie=0;for(let De of r.current){let Se=(se=(ee=i.current.get(De))==null?void 0:ee.value)!=null?se:"",Ce=(ce=(pe=i.current.get(De))==null?void 0:pe.keywords)!=null?ce:[],qe=I(Se,Ce);n.current.filtered.items.set(De,qe),qe>0&&Ie++}for(let[De,Se]of s.current)for(let Ce of Se)if(n.current.filtered.items.get(Ce)>0){n.current.filtered.groups.add(De);break}n.current.filtered.count=Ie}function V(){var ee,se,pe;let ce=F();ce&&(((ee=ce.parentElement)==null?void 0:ee.firstChild)===ce&&((pe=(se=ce.closest(Wv))==null?void 0:se.querySelector(Vrt))==null||pe.scrollIntoView({block:"nearest"})),ce.scrollIntoView({block:"nearest"}))}function F(){var ee;return(ee=k.current)==null?void 0:ee.querySelector(`${Oue}[aria-selected="true"]`)}function X(){var ee;return Array.from(((ee=k.current)==null?void 0:ee.querySelectorAll(fW))||[])}function U(ee){let se=X()[ee];se&&R.setState("value",se.getAttribute(l0))}function H(ee){var se;let pe=F(),ce=X(),Ie=ce.findIndex(Se=>Se===pe),De=ce[Ie+ee];(se=o.current)!=null&&se.loop&&(De=Ie+ee<0?ce[ce.length-1]:Ie+ee===ce.length?ce[0]:ce[Ie+ee]),De&&R.setState("value",De.getAttribute(l0))}function $(ee){let se=F(),pe=se==null?void 0:se.closest(Wv),ce;for(;pe&&!ce;)pe=ee>0?est(pe,Wv):tst(pe,Wv),ce=pe==null?void 0:pe.querySelector(fW);ce?R.setState("value",ce.getAttribute(l0)):H(ee)}let ne=()=>U(X().length-1),W=ee=>{ee.preventDefault(),ee.metaKey?ne():ee.altKey?$(1):H(1)},Q=ee=>{ee.preventDefault(),ee.metaKey?U(0):ee.altKey?$(-1):H(-1)};return T.createElement(ar.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:ee=>{var se;(se=x.onKeyDown)==null||se.call(x,ee);let pe=ee.nativeEvent.isComposing||ee.keyCode===229;if(!(ee.defaultPrevented||pe))switch(ee.key){case"n":case"j":{v&&ee.ctrlKey&&W(ee);break}case"ArrowDown":{W(ee);break}case"p":case"k":{v&&ee.ctrlKey&&Q(ee);break}case"ArrowUp":{Q(ee);break}case"Home":{ee.preventDefault(),U(0);break}case"End":{ee.preventDefault(),ne();break}case"Enter":{ee.preventDefault();let ce=F();if(ce){let Ie=new Event(xO);ce.dispatchEvent(Ie)}}}}},T.createElement("label",{"cmdk-label":"",htmlFor:N.inputId,id:N.labelId,style:sst},l),uA(e,ee=>T.createElement(Due.Provider,{value:R},T.createElement(Pue.Provider,{value:N},ee))))}),Hrt=T.forwardRef((e,t)=>{var n,r;let s=ia(),i=T.useRef(null),a=T.useContext(Fue),o=i_(),l=Bue(e),c=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:a==null?void 0:a.forceMount;Em(()=>{if(!c)return o.item(s,a==null?void 0:a.id)},[c]);let u=$ue(s,i,[e.value,e.children,i],e.keywords),d=V5(),h=Oh(A=>A.value&&A.value===u.current),m=Oh(A=>c||o.filter()===!1?!0:A.search?A.filtered.items.get(s)>0:!0);T.useEffect(()=>{let A=i.current;if(!(!A||e.disabled))return A.addEventListener(xO,y),()=>A.removeEventListener(xO,y)},[m,e.onSelect,e.disabled]);function y(){var A,R;b(),(R=(A=l.current).onSelect)==null||R.call(A,u.current)}function b(){d.setState("value",u.current,!0)}if(!m)return null;let{disabled:v,value:x,onSelect:w,forceMount:S,keywords:C,...k}=e;return T.createElement(ar.div,{ref:ll(i,t),...k,id:s,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!h,"data-disabled":!!v,"data-selected":!!h,onPointerMove:v||o.getDisablePointerSelection()?void 0:b,onClick:v?void 0:y},e.children)}),Grt=T.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...i}=e,a=ia(),o=T.useRef(null),l=T.useRef(null),c=ia(),u=i_(),d=Oh(m=>s||u.filter()===!1?!0:m.search?m.filtered.groups.has(a):!0);Em(()=>u.group(a),[]),$ue(a,o,[e.value,e.heading,l]);let h=T.useMemo(()=>({id:a,forceMount:s}),[s]);return T.createElement(ar.div,{ref:ll(o,t),...i,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&T.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},n),uA(e,m=>T.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?c:void 0},T.createElement(Fue.Provider,{value:h},m))))}),Krt=T.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=T.useRef(null),i=Oh(a=>!a.search);return!n&&!i?null:T.createElement(ar.div,{ref:ll(s,t),...r,"cmdk-separator":"",role:"separator"})}),Yrt=T.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,i=V5(),a=Oh(c=>c.search),o=Oh(c=>c.selectedItemId),l=i_();return T.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),T.createElement(ar.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:s?e.value:a,onChange:c=>{s||i.setState("search",c.target.value),n==null||n(c.target.value)}})}),Zrt=T.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,i=T.useRef(null),a=T.useRef(null),o=Oh(c=>c.selectedItemId),l=i_();return T.useEffect(()=>{if(a.current&&i.current){let c=a.current,u=i.current,d,h=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let m=c.offsetHeight;u.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return h.observe(c),()=>{cancelAnimationFrame(d),h.unobserve(c)}}},[]),T.createElement(ar.div,{ref:ll(i,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},uA(e,c=>T.createElement("div",{ref:ll(a,l.listInnerRef),"cmdk-list-sizer":""},c)))}),Xrt=T.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:i,container:a,...o}=e;return T.createElement(jle,{open:n,onOpenChange:r},T.createElement(Ole,{container:a},T.createElement(Ple,{"cmdk-overlay":"",className:s}),T.createElement(Dle,{"aria-label":e.label,"cmdk-dialog":"",className:i},T.createElement(Lue,{ref:t,...o}))))}),Jrt=T.forwardRef((e,t)=>Oh(n=>n.filtered.count===0)?T.createElement(ar.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Qrt=T.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...i}=e;return T.createElement(ar.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},uA(e,a=>T.createElement("div",{"aria-hidden":!0},a)))}),hb=Object.assign(Lue,{List:Zrt,Item:Hrt,Input:Yrt,Group:Grt,Separator:Krt,Dialog:Xrt,Empty:Jrt,Loading:Qrt});function est(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function tst(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function Bue(e){let t=T.useRef(e);return Em(()=>{t.current=e}),t}var Em=typeof window>"u"?T.useEffect:T.useLayoutEffect;function c0(e){let t=T.useRef();return t.current===void 0&&(t.current=e()),t}function Oh(e){let t=V5(),n=()=>e(t.snapshot());return T.useSyncExternalStore(t.subscribe,n,n)}function $ue(e,t,n,r=[]){let s=T.useRef(),i=i_();return Em(()=>{var a;let o=(()=>{var c;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():s.current}})(),l=r.map(c=>c.trim());i.value(e,o,l),(a=t.current)==null||a.setAttribute(l0,o),s.current=o}),s}var nst=()=>{let[e,t]=T.useState(),n=c0(()=>new Map);return Em(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function rst(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function uA({asChild:e,children:t},n){return e&&T.isValidElement(t)?T.cloneElement(rst(t),{ref:t.ref},n(t.props.children)):n(t)}var sst={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function zue({className:e,...t}){return f.jsx(hb,{"data-slot":"command",className:Ze("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function Uue({className:e,...t}){return f.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[f.jsx(Fa,{className:"size-4 shrink-0 opacity-50"}),f.jsx(hb.Input,{"data-slot":"command-input",className:Ze("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function que({className:e,...t}){return f.jsx(hb.List,{"data-slot":"command-list",className:Ze("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function Vue({...e}){return f.jsx(hb.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function Wue({className:e,...t}){return f.jsx(hb.Group,{"data-slot":"command-group",className:Ze("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function Hue({className:e,...t}){return f.jsx(hb.Item,{"data-slot":"command-item",className:Ze("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const W5=({models:e,value:t,onChange:n,className:r,disabled:s,isLoading:i})=>{const[a,o]=T.useState(!1),[l,c]=T.useState(""),[u,d]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),h=T.useMemo(()=>{let w=e;if(l.trim()){const C=l.toLowerCase();w=e.filter(k=>k.name.toLowerCase().includes(C)||k.providerName.toLowerCase().includes(C)||k.id.toLowerCase().includes(C))}const S=Object.entries(u).filter(([,C])=>C).map(([C])=>C);return S.length===0?w:w.filter(C=>{var N,I,O;const k=new Set(((N=C.metadataSummary)==null?void 0:N.supported_parameters)??[]),A=new Set(((I=C.metadataSummary)==null?void 0:I.input_modalities)??[]),R=new Set(((O=C.metadataSummary)==null?void 0:O.output_modalities)??[]);return S.every(L=>{switch(L){case"reasoning":return k.has("reasoning");case"webSearch":return k.has("web_search")||k.has("web_search_options");case"tools":return k.has("tools");case"multimodal":return Array.from(A).some(P=>P!=="text");case"imageGeneration":return R.has("image");default:return!0}})})},[e,l,u]),m=T.useMemo(()=>e.find(w=>w.id===t),[e,t]),y=T.useCallback(w=>{const S=w===t?null:w;n==null||n(S),o(!1),c("")},[t,n]),b=w=>{d(S=>({...S,[w]:!S[w]}))};if(i)return f.jsx(Wr,{className:Ze("h-9 w-[250px]",r)});const x=Object.values(u).filter(Boolean).length;return f.jsxs(pl,{open:a,onOpenChange:o,children:[f.jsx(ml,{asChild:!0,children:f.jsxs(bt,{variant:"outline",role:"combobox","aria-expanded":a,disabled:s||e.length===0,className:Ze("w-auto justify-between h-9 text-sm font-normal relative",r),children:[f.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:m?`${m.name} (${m.providerName})`:"Select Model..."}),f.jsx(aE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsx(gl,{className:"w-[--radix-popover-trigger-width] p-0",style:{maxHeight:"min(40vh, 400px)",overflow:"hidden"},children:f.jsxs(zue,{shouldFilter:!1,children:[f.jsxs("div",{className:"flex items-center border-b px-3",children:[f.jsx(Fa,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),f.jsx(Uue,{placeholder:"Search model...",value:l,onValueChange:c,className:"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto pl-2",children:[f.jsx(bt,{variant:u.reasoning?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.reasoning&&"text-primary"),onClick:()=>b("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(hB,{className:"h-4 w-4"})}),f.jsx(bt,{variant:u.webSearch?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.webSearch&&"text-primary"),onClick:()=>b("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(mB,{className:"h-4 w-4"})}),f.jsx(bt,{variant:u.tools?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.tools&&"text-primary"),onClick:()=>b("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(om,{className:"h-4 w-4"})}),f.jsx(bt,{variant:u.multimodal?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.multimodal&&"text-primary"),onClick:()=>b("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(im,{className:"h-4 w-4"})}),f.jsx(bt,{variant:u.imageGeneration?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.imageGeneration&&"text-primary"),onClick:()=>b("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(J2,{className:"h-4 w-4"})})]})]}),f.jsxs(que,{className:"max-h-[calc(min(40vh,400px)-70px)] overflow-y-auto",children:[f.jsx(Vue,{children:x>0?"No models match all active filters.":e.length===0?"No models available.":"No model found."}),f.jsx(Wue,{children:h.map(w=>{var S,C,k,A,R,N,I,O,L,P,V,F;return f.jsx(Hue,{value:w.id,onSelect:y,className:"flex items-center",children:f.jsxs("div",{className:"flex-1 truncate flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium",children:w.name}),f.jsx("div",{className:"text-xs text-muted-foreground",children:w.providerName})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((C=(S=w.metadataSummary)==null?void 0:S.supported_parameters)==null?void 0:C.includes("reasoning"))&&f.jsx(hB,{className:"h-3.5 w-3.5 text-purple-500"}),(((A=(k=w.metadataSummary)==null?void 0:k.supported_parameters)==null?void 0:A.includes("web_search"))||((N=(R=w.metadataSummary)==null?void 0:R.supported_parameters)==null?void 0:N.includes("web_search_options")))&&f.jsx(mB,{className:"h-3.5 w-3.5 text-blue-500"}),((O=(I=w.metadataSummary)==null?void 0:I.supported_parameters)==null?void 0:O.includes("tools"))&&f.jsx(om,{className:"h-3.5 w-3.5 text-orange-500"}),((P=(L=w.metadataSummary)==null?void 0:L.input_modalities)==null?void 0:P.some(X=>X!=="text"))&&f.jsx(im,{className:"h-3.5 w-3.5 text-green-500"}),((F=(V=w.metadataSummary)==null?void 0:V.output_modalities)==null?void 0:F.includes("image"))&&f.jsx(J2,{className:"h-3.5 w-3.5 text-pink-500"})]})]})},w.id)})})]})]})})]})},k3=Ke({systemPrompt:$e().nullable(),modelId:$e().nullable()}),ist=({initialSystemPrompt:e,initialModelId:t,onSave:n,effectiveSystemPrompt:r,effectiveModelId:s,isParentSaving:i=!1})=>{var u;const{getAvailableModelListItems:a}=Rr(yn(d=>({getAvailableModelListItems:d.getAvailableModelListItems}))),o=a(),l=((u=o.find(d=>d.id===s))==null?void 0:u.name)||s,c=ni({defaultValues:{systemPrompt:e??null,modelId:t??null},validators:{onChangeAsync:k3,onChangeAsyncDebounceMs:500},onSubmit:async({value:d})=>{await n({systemPrompt:d.systemPrompt,modelId:d.modelId})}});return T.useEffect(()=>{c.reset({systemPrompt:e??null,modelId:t??null})},[e,t,c]),f.jsxs("form",{onSubmit:d=>{d.preventDefault(),d.stopPropagation(),c.handleSubmit()},className:"space-y-6",children:[f.jsx(c.Field,{name:"systemPrompt",validators:{onChange:k3.shape.systemPrompt},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:`${d.name}-textarea`,children:"System Prompt (Overrides Parent/Global)"}),f.jsx(Do,{id:`${d.name}-textarea`,placeholder:`Inherited: ${(r==null?void 0:r.substring(0,100))||"Default"}${r&&r.length>100?"...":""}`,value:d.state.value??"",onChange:h=>d.handleChange(h.target.value),onBlur:d.handleBlur,rows:6,disabled:c.state.isSubmitting||i,className:"mt-1"}),f.jsx(Ni,{field:d}),f.jsx(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("systemPrompt",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx(c.Field,{name:"modelId",validators:{onChange:k3.shape.modelId},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{children:"Default Model (Overrides Parent/Global)"}),f.jsx(W5,{models:o,value:d.state.value,onChange:h=>{d.handleChange(h),d.handleBlur()},disabled:c.state.isSubmitting||i,className:"w-full mt-1"}),f.jsx(Ni,{field:d}),f.jsxs(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("modelId",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:["Use Inherited/Default (",l||"Global Default",")"]})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(c.Subscribe,{selector:d=>[d.canSubmit,d.isSubmitting,d.isValidating,d.isValid],children:([d,h,m,y])=>f.jsxs(bt,{type:"submit",size:"sm",disabled:i||!d||h||m||!y,children:[(h||m)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Jd,{className:"h-4 w-4 mr-1"}),h||m?"Saving...":"Save Prompt Settings"]})})})]})};function r0({field:e}){return e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive pt-1 block",children:e.state.meta.errors.join(", ")}):null}const ast=({form:e,isSaving:t,effectiveTemperature:n,effectiveMaxTokens:r,effectiveTopP:s,effectiveTopK:i,effectivePresencePenalty:a,effectiveFrequencyPenalty:o})=>f.jsxs("div",{className:"space-y-4",children:[f.jsx(e.Field,{name:"temperature",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Dt,{htmlFor:l.name,className:"text-xs",children:["Temperature (",(l.state.value??n??.7).toFixed(2),")"]}),f.jsx(w0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??n??.7],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(n==null?void 0:n.toFixed(2))??"N/A",")"]}),f.jsx(r0,{field:l})]})}),f.jsx(e.Field,{name:"topP",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Dt,{htmlFor:l.name,className:"text-xs",children:["Top P (",(l.state.value??s??1).toFixed(2),")"]}),f.jsx(w0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??s??1],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(s==null?void 0:s.toFixed(2))??"N/A",")"]}),f.jsx(r0,{field:l})]})}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(e.Field,{name:"maxTokens",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:l.name,className:"text-xs",children:"Max Tokens"}),f.jsx(Cn,{id:l.name,type:"number",placeholder:`Inherited: ${r??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(r0,{field:l})]})}),f.jsx(e.Field,{name:"topK",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:l.name,className:"text-xs",children:"Top K"}),f.jsx(Cn,{id:l.name,type:"number",placeholder:`Inherited: ${i??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(r0,{field:l})]})})]}),f.jsx(e.Field,{name:"presencePenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Dt,{htmlFor:l.name,className:"text-xs",children:["Presence Penalty (",(l.state.value??a??0).toFixed(2),")"]}),f.jsx(w0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??a??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(a==null?void 0:a.toFixed(2))??"N/A",")"]}),f.jsx(r0,{field:l})]})}),f.jsx(e.Field,{name:"frequencyPenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Dt,{htmlFor:l.name,className:"text-xs",children:["Frequency Penalty (",(l.state.value??o??0).toFixed(2),")"]}),f.jsx(w0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??o??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(o==null?void 0:o.toFixed(2))??"N/A",")"]}),f.jsx(r0,{field:l})]})})]}),hW=Ke({syncRepoId:$e().nullable()}),ost=({initialSyncRepoId:e,onSave:t,effectiveSyncRepoId:n,syncRepos:r,isParentSaving:s=!1})=>{var o;const i=((o=r.find(l=>l.id===n))==null?void 0:o.name)??"None",a=ni({defaultValues:{syncRepoId:e??null},validators:{onChangeAsync:hW,onChangeAsyncDebounceMs:500},onSubmit:async({value:l})=>{await t(l)}});return T.useEffect(()=>{a.reset({syncRepoId:e??null})},[e,a]),f.jsxs("form",{onSubmit:l=>{l.preventDefault(),l.stopPropagation(),a.handleSubmit()},className:"space-y-6",children:[f.jsx(a.Field,{name:"syncRepoId",validators:{onChange:hW.shape.syncRepoId},children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:l.name,children:"Sync Repository (Overrides Parent/Global)"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),f.jsxs(Wm,{value:l.state.value??"none",onValueChange:c=>{l.handleChange(c==="none"?null:c),l.handleBlur()},disabled:a.state.isSubmitting||s||r.length===0,children:[f.jsx(Gm,{id:l.name,children:f.jsx(Hm,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${i}`})}),f.jsxs(Km,{children:[f.jsx(sl,{value:"none",children:f.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",i,")"]})}),r.map(c=>f.jsx(sl,{value:c.id,children:c.name},c.id))]})]}),f.jsx(Ni,{field:l}),f.jsx(bt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a.setFieldValue("syncRepoId",null),disabled:a.state.isSubmitting||s||l.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(a.Subscribe,{selector:l=>[l.canSubmit,l.isSubmitting,l.isValidating,l.isValid],children:([l,c,u,d])=>f.jsxs(bt,{type:"submit",size:"sm",disabled:s||!l||c||u||!d||r.length===0,children:[(c||u)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Jd,{className:"h-4 w-4 mr-1"}),c||u?"Saving...":"Save Sync Settings"]})})})]})},lst=({projectId:e})=>{const t=T.useMemo(()=>[{value:"manage",label:"Manage Files",content:f.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?f.jsx(q5,{}):f.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings",content:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(Dt,{children:"Project Filesystem Info"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),f.jsxs("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2 break-all",children:[" ",f.jsxs("p",{children:[f.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",f.jsx("code",{className:"text-xs",children:e||"N/A"})]})]})]}),f.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[f.jsx(Dt,{className:"text-destructive",children:"Danger Zone"}),f.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."})]})]})}],[e]);return f.jsx(Dc,{tabs:t,defaultValue:"manage",className:"h-full flex flex-col",listClassName:Ze("bg-muted/50 rounded-md","flex-wrap justify-start h-auto","p-1 gap-1"),contentContainerClassName:"mt-3 flex-grow flex flex-col overflow-y-auto"})},cst=({allRules:e,selectedRuleIds:t,onSelectionChange:n,disabled:r=!1})=>{const[s,i]=T.useState(""),a=T.useMemo(()=>{const o=s.toLowerCase();return o?e.filter(l=>l.name.toLowerCase().includes(o)||l.content.toLowerCase().includes(o)||l.type.toLowerCase().includes(o)):e},[e,s]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter rules...",value:s,onChange:o=>i(o.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Po,{className:"h-48 border rounded-md p-2 bg-background/50",children:a.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No rules defined globally.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:a.map(o=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Hl,{id:`project-default-rule-${o.id}`,checked:t.has(o.id),onCheckedChange:l=>n(o.id,!!l),className:"mt-0.5",disabled:r}),f.jsxs(Dt,{htmlFor:`project-default-rule-${o.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:o.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",o.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",o.content]})]})]})},o.id))})})]})},ust=({defaultRuleIds:e,setDefaultRuleIds:t,isSaving:n,allRules:r})=>{const s=T.useMemo(()=>new Set(e??[]),[e]),i=T.useCallback((a,o)=>{const l=new Set(s);o?l.add(a):l.delete(a);const c=Array.from(l);t(c.length>0?c:null)},[s,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(Dt,{children:"Default Rules for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select rules that will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(cst,{allRules:r,selectedRuleIds:s,onSelectionChange:i,disabled:n})]})},dst=({allTags:e,selectedTagIds:t,onSelectionChange:n,disabled:r=!1,getRulesForTag:s})=>{const[i,a]=T.useState(""),o=T.useMemo(()=>{const l=i.toLowerCase();return l?e.filter(c=>{var u;return c.name.toLowerCase().includes(l)||((u=c.description)==null?void 0:u.toLowerCase().includes(l))}):e},[e,i]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter tags...",value:i,onChange:l=>a(l.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Po,{className:"h-48 border rounded-md p-2 bg-background/50",children:o.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No tags defined globally.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:o.map(l=>{const c=s(l.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Hl,{id:`project-default-tag-${l.id}`,checked:t.has(l.id),onCheckedChange:u=>n(l.id,!!u),className:"mt-0.5",disabled:r}),f.jsxs(Dt,{htmlFor:`project-default-tag-${l.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:l.name}),l.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:l.description}),c.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",c.map(u=>u.name).join(", ")]})]})]})},l.id)})})})]})},fst=({defaultTagIds:e,setDefaultTagIds:t,isSaving:n,allTags:r,getRulesForTag:s})=>{const i=T.useMemo(()=>new Set(e??[]),[e]),a=T.useCallback((o,l)=>{const c=new Set(i);l?c.add(o):c.delete(o);const u=Array.from(c);t(u.length>0?u:null)},[i,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(Dt,{children:"Default Tags for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select tags whose rules will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(dst,{allTags:r,selectedTagIds:i,onSelectionChange:a,disabled:n,getRulesForTag:s})]})},hst=Ke({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),pst=({isOpen:e,onClose:t,projectId:n,module:r})=>{const{getProjectById:s,updateProject:i}=Oo(yn(U=>({getProjectById:U.getProjectById,updateProject:U.updateProject}))),a=Oo(U=>U.getEffectiveProjectSettings),o=qn(U=>U.syncRepos),l=yr(yn(U=>({globalSystemPrompt:U.globalSystemPrompt,temperature:U.temperature,maxTokens:U.maxTokens,topP:U.topP,topK:U.topK,presencePenalty:U.presencePenalty,frequencyPenalty:U.frequencyPenalty}))),c=Rr(U=>U.selectedModelId),u=Xs(U=>U.setVfsKey),[d,h]=T.useState(null),[m,y]=T.useState(null),[b,v]=T.useState(null),[x,w]=T.useState(null),[S,C]=T.useState(null),[k,A]=T.useState(!1),[R,N]=T.useState("prompt"),{project:I,effectiveSettings:O}=T.useMemo(()=>{const U=n?s(n):null,H=n?a(n):null;return{project:U,effectiveSettings:H}},[n,s,a]),L=ni({defaultValues:{temperature:(I==null?void 0:I.temperature)??.7,topP:(I==null?void 0:I.topP)??1,maxTokens:(I==null?void 0:I.maxTokens)??null,topK:(I==null?void 0:I.topK)??null,presencePenalty:(I==null?void 0:I.presencePenalty)??0,frequencyPenalty:(I==null?void 0:I.presencePenalty)??0},validators:{onChangeAsync:hst,onChangeAsyncDebounceMs:500}}),P=T.useCallback(U=>{var $;if(!U)return null;const H=s(U);return H?(($=H.metadata)==null?void 0:$.syncRepoId)!==void 0?H.metadata.syncRepoId:P(H.parentId):null},[s]),V=n?P(n):null;T.useEffect(()=>{var U;e&&n&&I&&O?(u(n),h(I.systemPrompt??null),y(I.modelId??null),v(((U=I.metadata)==null?void 0:U.syncRepoId)??null),w(I.defaultTagIds??null),C(I.defaultRuleIds??null),L.reset({temperature:I.temperature??.7,topP:I.topP??1,maxTokens:I.maxTokens??null,topK:I.topK??null,presencePenalty:I.presencePenalty??0,frequencyPenalty:I.frequencyPenalty??0}),N("prompt")):e||(u(null),h(null),y(null),v(null),w(null),C(null),L.reset({temperature:.7,topP:1,maxTokens:null,topK:null,presencePenalty:0,frequencyPenalty:0}))},[e,n,I,O,u,L]);const F=async()=>{if(!(!n||!I)){A(!0);try{const U=I.parentId?a(I.parentId):{systemPrompt:l.globalSystemPrompt,modelId:c,temperature:l.temperature,maxTokens:l.maxTokens,topP:l.topP,topK:l.topK,presencePenalty:l.presencePenalty,frequencyPenalty:l.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null},H=I.parentId?P(I.parentId):null,$={},ne={...I.metadata??{}},W=L.state.values;d!==U.systemPrompt?$.systemPrompt=d:$.systemPrompt=void 0,m!==U.modelId?$.modelId=m:$.modelId=void 0,W.temperature!==U.temperature?$.temperature=W.temperature:$.temperature=void 0,W.maxTokens!==U.maxTokens?$.maxTokens=W.maxTokens:$.maxTokens=void 0,W.topP!==U.topP?$.topP=W.topP:$.topP=void 0,W.topK!==U.topK?$.topK=W.topK:$.topK=void 0,W.presencePenalty!==U.presencePenalty?$.presencePenalty=W.presencePenalty:$.presencePenalty=void 0,W.frequencyPenalty!==U.frequencyPenalty?$.frequencyPenalty=W.frequencyPenalty:$.frequencyPenalty=void 0,b!==H?ne.syncRepoId=b:delete ne.syncRepoId,JSON.stringify(x)!==JSON.stringify(U.defaultTagIds)?$.defaultTagIds=x:$.defaultTagIds=void 0,JSON.stringify(S)!==JSON.stringify(U.defaultRuleIds)?$.defaultRuleIds=S:$.defaultRuleIds=void 0,$.metadata=ne,await i(n,$),Oe.success(`Project "${I.name}" settings updated.`),t()}catch(U){Oe.error("Failed to save project settings."),console.error("Failed to save project settings:",U)}finally{A(!1)}}},X=T.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:f.jsx(ist,{initialSystemPrompt:d,initialModelId:m,onSave:({systemPrompt:U,modelId:H})=>{h(U),y(H)},effectiveSystemPrompt:(O==null?void 0:O.systemPrompt)??l.globalSystemPrompt,effectiveModelId:(O==null?void 0:O.modelId)??c,isParentSaving:k})},{value:"params",label:"Parameters",content:f.jsx(ast,{form:L,effectiveTemperature:(O==null?void 0:O.temperature)??l.temperature,effectiveMaxTokens:(O==null?void 0:O.maxTokens)??l.maxTokens,effectiveTopP:(O==null?void 0:O.topP)??l.topP??1,effectiveTopK:(O==null?void 0:O.topK)??l.topK,effectivePresencePenalty:(O==null?void 0:O.presencePenalty)??l.presencePenalty??0,effectiveFrequencyPenalty:(O==null?void 0:O.frequencyPenalty)??l.frequencyPenalty??0,isSaving:k})},{value:"rules-tags",label:"Rules & Tags",content:f.jsxs("div",{className:"space-y-6",children:[f.jsx(ust,{defaultRuleIds:S,setDefaultRuleIds:C,isSaving:k,allRules:r.getAllRules()}),f.jsx(fst,{defaultTagIds:x,setDefaultTagIds:w,isSaving:k,allTags:r.getAllTags(),getRulesForTag:r.getRulesForTag})]})},{value:"sync",label:"Sync",content:f.jsx(ost,{initialSyncRepoId:b,onSave:({syncRepoId:U})=>{v(U)},effectiveSyncRepoId:V,syncRepos:o,isParentSaving:k})},{value:"vfs",label:"Filesystem",content:f.jsx(lst,{projectId:n,projectName:(I==null?void 0:I.name)??null,isSaving:k})}],[d,m,b,x,S,L,O,l,c,k,V,o,n,I==null?void 0:I.name,r]);return f.jsx(Ym,{open:e,onOpenChange:t,children:f.jsxs(Zm,{className:Ze("w-[95vw] h-[85vh] flex flex-col p-0","sm:w-[90vw] sm:max-w-[800px]","md:h-[75vh]","min-h-[500px] max-h-[90vh]"),children:[f.jsxs(Xm,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsxs(Jm,{children:["Project Settings: ",I==null?void 0:I.name]}),f.jsx(db,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),f.jsx(Dc,{tabs:X,initialValue:R,onValueChange:N,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"pb-4 md:pb-6 overflow-y-auto",scrollable:!1}),f.jsxs(ub,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:[f.jsx(bt,{variant:"outline",onClick:t,disabled:k,children:"Cancel"}),f.jsxs(bt,{onClick:F,disabled:k,children:[k&&f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};class mst{constructor(){ve(this,"id","core-project-settings");ve(this,"modalId","projectSettingsModal");ve(this,"unregisterModalProviderCallback",null);ve(this,"modApiRef",null);ve(this,"eventUnsubscribers",[]);ve(this,"allRules",[]);ve(this,"allTags",[]);ve(this,"tagRuleLinks",[]);ve(this,"getAllRules",()=>this.allRules);ve(this,"getAllTags",()=>this.allTags);ve(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});ve(this,"openModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(jr.openModalRequest,{modalId:this.modalId,targetId:t,initialTab:n})});ve(this,"closeModal",()=>{var t;(t=this.modApiRef)==null||t.emit(jr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t;const n=t.on(gr.dataLoaded,r=>{r&&(this.allRules=r.rules||[],this.allTags=r.tags||[],this.tagRuleLinks=(r.links||[]).map(s=>({tagId:s.tagId,ruleId:s.ruleId})))});this.eventUnsubscribers.push(n),t.emit(gr.loadRulesAndTagsRequest,void 0),console.log(`[${this.id}] Initialized.`)}register(t){if(this.modApiRef=t,this.unregisterModalProviderCallback){console.warn(`[${this.id}] Modal provider already registered. Skipping.`);return}this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>We.createElement(pst,{isOpen:n.isOpen,onClose:n.onClose,projectId:n.targetId||null,module:this})),console.log(`[${this.id}] Modal provider registered for ${this.modalId}.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const H5=We.memo(({module:e,value:t,onChange:n,className:r,disabled:s})=>{const[,i]=T.useState({});T.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=!!e,o=a?e.selectedModelId:t,l=a?e.isStreaming:s,c=a?e.isLoadingProviders:!1,u=a?e.globallyEnabledModels:Rr(h=>h.getGloballyEnabledModelDefinitions()),d=T.useCallback(h=>{a&&e?e.handleSelectionChange(h):n&&n(h)},[a,e,n]);return f.jsx(W5,{models:u,value:o,onChange:d,className:r,disabled:l,isLoading:c})});H5.displayName="GlobalModelSelector";class gst{constructor(){ve(this,"id","core-global-model-selector");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"selectedModelId",null);ve(this,"isStreaming",!1);ve(this,"isLoadingProviders",!0);ve(this,"globallyEnabledModels",[]);ve(this,"notifyComponentUpdate",null);ve(this,"handleSelectionChange",t=>{var n,r;(n=this.modApiRef)==null||n.emit(dr.selectModelRequest,{modelId:t}),(r=this.modApiRef)==null||r.emit(Fn.setModelIdRequest,{id:t})});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t;const n=Rr.getState();this.isLoadingProviders=n.isLoading,this.selectedModelId=n.selectedModelId,this.isStreaming=Bn.getState().status==="streaming",this.isLoadingProviders||(this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions());const r=t.on(Zn.statusChanged,o=>{var l;if(typeof o=="object"&&o&&"status"in o){const c=o.status==="streaming";this.isStreaming!==c&&(this.isStreaming=c,(l=this.notifyComponentUpdate)==null||l.call(this))}}),s=t.on(dr.selectedModelChanged,o=>{var l,c;typeof o=="object"&&o&&"modelId"in o&&this.selectedModelId!==o.modelId&&(this.selectedModelId=o.modelId,(l=this.modApiRef)==null||l.emit(Fn.setModelIdRequest,{id:o.modelId}),(c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(dr.globallyEnabledModelsUpdated,o=>{var d,h;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Rr.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0);const u=Rr.getState().selectedModelId;this.selectedModelId!==u&&(this.selectedModelId=u,(d=this.modApiRef)==null||d.emit(Fn.setModelIdRequest,{id:this.selectedModelId}),l=!0),l&&((h=this.notifyComponentUpdate)==null||h.call(this))}),a=t.on(dr.initialDataLoaded,()=>{var u,d;const o=Rr.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0),this.selectedModelId!==o.selectedModelId&&(this.selectedModelId=o.selectedModelId,(u=this.modApiRef)==null||u.emit(Fn.setModelIdRequest,{id:this.selectedModelId}),l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((d=this.notifyComponentUpdate)==null||d.call(this))});this.eventUnsubscribers.push(r,s,i,a)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingProviders?"loading":"ready",triggerRenderer:()=>We.createElement(H5,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const yst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=T.useState(!1),[s,i]=T.useState(e.getTurnSystemPrompt()),a=e.getEffectiveSystemPrompt(),o=e.getIsStreaming(),l=e.getTurnSystemPrompt();T.useEffect(()=>{n&&i(e.getTurnSystemPrompt())},[n,e]),T.useEffect(()=>{const m=e.getTurnSystemPrompt();s!==m&&i(m)},[e.getTurnSystemPrompt(),s]);const c=T.useCallback(()=>{e.setTurnSystemPrompt(s.trim()),r(!1)},[s,e]),u=T.useCallback(()=>{i(""),e.setTurnSystemPrompt(""),r(!1)},[e]),d=m=>{m&&i(e.getTurnSystemPrompt()),r(m)},h=l.trim().length>0;return f.jsxs(pl,{open:n,onOpenChange:d,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ml,{asChild:!0,children:f.jsx(bt,{variant:h?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:o,"aria-label":"Set System Prompt for Next Turn",children:f.jsx(Age,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:h?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),f.jsxs(gl,{className:"w-80 p-4 space-y-3",align:"start",children:[f.jsx(Dt,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),f.jsx(Do,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:s,onChange:m=>i(m.target.value),rows:5,className:"text-sm"}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx(bt,{variant:"outline",size:"sm",onClick:u,disabled:!s.trim(),children:"Clear Override"}),f.jsx(bt,{size:"sm",onClick:c,children:"Set for Next Turn"})]})]})]})};class bst{constructor(){ve(this,"id","core-system-prompt");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"turnSystemPromptValue","");ve(this,"effectiveSystemPrompt",null);ve(this,"isStreaming",!1);ve(this,"notifyComponentUpdate",null);ve(this,"getTurnSystemPrompt",()=>this.turnSystemPromptValue);ve(this,"getEffectiveSystemPrompt",()=>this.effectiveSystemPrompt);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"setTurnSystemPrompt",t=>{var n;this.turnSystemPromptValue!==t&&(this.turnSystemPromptValue=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=Bn.getState().status==="streaming",this.updateEffectivePrompt();const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(jr.contextChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(ba.updated,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(sn.globalSystemPromptChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r,s,i)}updateEffectivePrompt(){var a;const t=qn.getState(),n=Oo.getState(),r=yr.getState(),s=t.selectedItemType==="project"?t.selectedItemId:t.selectedItemType==="conversation"?((a=t.getConversationById(t.selectedItemId))==null?void 0:a.projectId)??null:null,i=n.getEffectiveProjectSettings(s).systemPrompt??r.globalSystemPrompt;this.effectiveSystemPrompt!==i&&(this.effectiveSystemPrompt=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(yst,{module:this}),getMetadata:()=>{const n=this.turnSystemPromptValue.trim();return n?{turnSystemPrompt:n}:void 0},clearOnSubmit:()=>{var n;this.turnSystemPromptValue!==""&&(this.turnSystemPromptValue="",(n=this.notifyComponentUpdate)==null||n.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const vst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getStructuredOutputJson(),[r,s]=T.useState(!1),[i,a]=T.useState(n??""),[o,l]=T.useState(""),[c,u]=T.useState([]),d=T.useCallback(()=>{try{JSON.parse(i),e.setStructuredOutputJson(i.trim()||null),s(!1),Oe.success("Structured output applied for next turn.")}catch{Oe.error("Invalid JSON format.")}},[i,e]),h=T.useCallback(()=>{a(""),e.setStructuredOutputJson(null),s(!1),Oe.info("Structured output cleared.")},[e]),m=T.useCallback(()=>{if(!o.trim()){Oe.error("Please provide a name to save to the library.");return}try{JSON.parse(i);const w={id:Date.now().toString(),name:o.trim(),json:i};u(S=>[...S,w]),l(""),Oe.success(`"${w.name}" saved to library.`)}catch{Oe.error("Cannot save invalid JSON to library.")}},[i,o]),y=T.useCallback(w=>{a(w.json),e.setStructuredOutputJson(w.json),s(!1),Oe.success(`Loaded "${w.name}" from library.`)},[e]),b=T.useCallback(w=>{u(S=>S.filter(C=>C.id!==w)),Oe.info("Item removed from library.")},[]);T.useEffect(()=>{r&&a(e.getStructuredOutputJson()??"")},[r,e]);const v=[{value:"entry",label:"Entry",content:f.jsxs("div",{className:"space-y-3 p-1",children:[f.jsx(Dt,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),f.jsx(Do,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:i,onChange:w=>a(w.target.value),rows:8,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-between items-end gap-2",children:[f.jsxs("div",{className:"flex-grow space-y-1",children:[f.jsx(Dt,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),f.jsx(Cn,{id:"structured-output-name",value:o,onChange:w=>l(w.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),f.jsxs(bt,{size:"sm",variant:"outline",onClick:m,disabled:!o.trim()||!i.trim(),className:"h-8",children:[f.jsx(Jd,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),f.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[f.jsx(bt,{variant:"outline",size:"sm",onClick:h,disabled:!n,children:"Clear Applied Schema"}),f.jsx(bt,{size:"sm",onClick:d,disabled:!i,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:f.jsx("div",{className:"space-y-2 p-1",children:c.length===0?f.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):c.map(w=>f.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[f.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:w.name}),f.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[f.jsx(bt,{size:"sm",variant:"outline",onClick:()=>y(w),className:"h-7 px-2 text-xs",children:"Use"}),f.jsx(bt,{size:"icon",variant:"ghost",onClick:()=>b(w.id),className:"h-7 w-7 text-destructive",children:f.jsx(Eo,{className:"h-3.5 w-3.5"})})]})]},w.id))})}],x=!!n;return f.jsxs(pl,{open:r,onOpenChange:s,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ml,{asChild:!0,children:f.jsx(bt,{variant:x?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:f.jsx(aH,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:x?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),f.jsx(gl,{className:"w-[450px] p-0",align:"start",children:f.jsx(Dc,{tabs:v,defaultValue:"entry"})})]})},xst=({module:e})=>{const[,t]=T.useState({});return T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),e.getIsVisible()?f.jsx(vst,{module:e}):null};class wst{constructor(){ve(this,"id","core-structured-output");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"structuredOutputJson",null);ve(this,"isVisible",!0);ve(this,"notifyComponentUpdate",null);ve(this,"getStructuredOutputJson",()=>this.structuredOutputJson);ve(this,"getIsVisible",()=>this.isVisible);ve(this,"setStructuredOutputJson",t=>{var n,r;this.structuredOutputJson=t,(n=this.modApiRef)==null||n.emit(Fn.setStructuredOutputJsonRequest,{json:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.structuredOutputJson=Mo.getState().structuredOutputJson,this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(dr.selectedModelChanged,()=>{var i;this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(Fn.parameterChanged,i=>{var a;if(typeof i=="object"&&i&&"params"in i){const o=i.params;"structuredOutputJson"in o&&this.structuredOutputJson!==(o.structuredOutputJson??null)&&(this.structuredOutputJson=o.structuredOutputJson??null,(a=this.notifyComponentUpdate)==null||a.call(this))}});this.eventUnsubscribers.push(n,r)}updateVisibility(){var i;const{getSelectedModel:t}=Rr.getState(),n=t(),r=(i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters,s=Array.isArray(r)&&r.includes("structured_output");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(xst,{module:this}),getParameters:()=>{if(this.structuredOutputJson)try{return{structured_output:JSON.parse(this.structuredOutputJson)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Fn.setStructuredOutputJsonRequest,{json:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const _st=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.contextLength,r=e.getEstimatedInputTokens(),s=e.getTotalEstimatedTokens(),i=e.getContextPercentage(),a=e.historyTokens,o=e.selectedModelId,l=T.useMemo(()=>i>85?"text-red-600 dark:text-red-500":i>70?"text-orange-500 dark:text-orange-400":i>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[i]);if(!(o!==null&&n>0))return null;const u=`Context: ~${s.toLocaleString()} / ${n.toLocaleString()} tokens (${i}%) [History: ${a}, Input: ${r}]`;return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:f.jsx(Npe,{className:Ze("h-3 w-3 fill-current",l)})})}),f.jsx(Sr,{side:"top",children:u})]})})},Gue=4,Sst=e=>{let t=0;return e.forEach(n=>{var r,s,i,a;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(a=(i=(s=n.prompt)==null?void 0:s.metadata)==null?void 0:i.attachedFiles)==null||a.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/Gue)};class Cst{constructor(){ve(this,"id","core-usage-display");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"currentInputText","");ve(this,"historyTokens",0);ve(this,"attachedFiles",[]);ve(this,"selectedModelId",null);ve(this,"contextLength",0);ve(this,"notifyComponentUpdate",null);ve(this,"getEstimatedInputTokens",()=>{const t=new TextEncoder().encode(this.currentInputText).length,n=this.attachedFiles.reduce((r,s)=>r+s.size,0);return Math.ceil((t+n)/Gue)});ve(this,"getTotalEstimatedTokens",()=>this.historyTokens+this.getEstimatedInputTokens());ve(this,"getContextPercentage",()=>this.contextLength?Math.min(100,Math.round(this.getTotalEstimatedTokens()/this.contextLength*100)):0);ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.loadInitialState(),this.updateContextLength();const n=t.on(Fn.inputChanged,o=>{var l;typeof o=="object"&&o&&"value"in o&&(this.currentInputText=o.value,(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Ll.attachedFilesChanged,o=>{var l;typeof o=="object"&&o&&"files"in o&&(this.attachedFiles=o.files,(l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(dr.selectedModelChanged,o=>{var l;typeof o=="object"&&o&&"modelId"in o&&(this.selectedModelId=o.modelId,this.updateContextLength(),(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(Zn.completed,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)}),a=t.on(jr.contextChanged,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)});this.eventUnsubscribers.push(n,r,s,i,a),console.log(`[${this.id}] Initialized.`)}loadInitialState(){const t=hh.getState(),n=Rr.getState();this.attachedFiles=t.attachedFilesMetadata,this.selectedModelId=n.selectedModelId,this.updateHistoryTokens()}updateHistoryTokens(){const t=Bn.getState();if(t.currentConversationId){const n=t.interactions.filter(r=>r.status==="COMPLETED");this.historyTokens=Sst(n)}else this.historyTokens=0}updateContextLength(){var c;if(!this.selectedModelId){this.contextLength=0;return}const{dbProviderConfigs:t,dbApiKeys:n}=Rr.getState(),{providerId:r,modelId:s}=yc(this.selectedModelId);if(!r||!s){this.contextLength=0;return}const i=t.find(u=>u.id===r);if(!i){this.contextLength=0;return}const a=n.find(u=>u.id===i.apiKeyId),o=kG(i,s,a==null?void 0:a.value),l=o==null?void 0:o.metadata;this.contextLength=((c=l==null?void 0:l.top_provider)==null?void 0:c.context_length)??(l==null?void 0:l.context_length)??0}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(_st,{module:this})}),console.log(`[${this.id}] Registered.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const kst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getReasoningEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=T.useCallback(()=>{const o=i?null:!0;e.setReasoningEnabled(o)},[i,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:f.jsx(Ph,{className:Ze("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:i?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};class Est{constructor(){ve(this,"id","core-reasoning");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"reasoningEnabled",null);ve(this,"isStreaming",!1);ve(this,"isVisible",!0);ve(this,"notifyComponentUpdate",null);ve(this,"getReasoningEnabled",()=>this.reasoningEnabled);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"getIsVisible",()=>this.isVisible);ve(this,"setReasoningEnabled",t=>{var n,r;this.reasoningEnabled=t,(n=this.modApiRef)==null||n.emit(Fn.setReasoningEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.reasoningEnabled=Mo.getState().reasoningEnabled,this.isStreaming=Bn.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Fn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"reasoningEnabled"in l&&this.reasoningEnabled!==l.reasoningEnabled&&(this.reasoningEnabled=l.reasoningEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var s,i;const{getSelectedModel:t}=Rr.getState(),n=t(),r=((i=(s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters)==null?void 0:i.includes("reasoning"))??!1;this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(kst,{module:this}),getMetadata:()=>this.reasoningEnabled===!0?{reasoningEnabled:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Fn.setReasoningEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Tst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getWebSearchEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=T.useCallback(()=>{const o=i?null:!0;e.setWebSearchEnabled(o)},[i,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:f.jsx(Fa,{className:Ze("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:i?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};class Ast{constructor(){ve(this,"id","core-web-search");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"webSearchEnabled",null);ve(this,"isStreaming",!1);ve(this,"isVisible",!0);ve(this,"notifyComponentUpdate",null);ve(this,"getWebSearchEnabled",()=>this.webSearchEnabled);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"getIsVisible",()=>this.isVisible);ve(this,"setWebSearchEnabled",t=>{var n,r;this.webSearchEnabled=t,(n=this.modApiRef)==null||n.emit(Fn.setWebSearchEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.webSearchEnabled=Mo.getState().webSearchEnabled,this.isStreaming=Bn.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Fn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"webSearchEnabled"in l&&this.webSearchEnabled!==l.webSearchEnabled&&(this.webSearchEnabled=l.webSearchEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var i;const{getSelectedModel:t}=Rr.getState(),n=t(),r=((i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters)??[],s=r.includes("web_search")||r.includes("web_search_options");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Tst,{module:this}),getParameters:()=>this.webSearchEnabled===!0?{web_search:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Fn.setWebSearchEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Kue=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r,allRules:s,allTags:i,getRulesForTag:a})=>{const[o,l]=T.useState(""),[c,u]=T.useState(""),d=T.useMemo(()=>{const w=o.toLowerCase();return w?i.filter(S=>{var C;return S.name.toLowerCase().includes(w)||((C=S.description)==null?void 0:C.toLowerCase().includes(w))}):i},[i,o]),h=T.useMemo(()=>{const w=c.toLowerCase();return w?s.filter(S=>S.name.toLowerCase().includes(w)||S.content.toLowerCase().includes(w)||S.type.toLowerCase().includes(w)):s},[s,c]),m=T.useCallback((w,S)=>{n(w,S)},[n]),y=T.useCallback((w,S)=>{r(w,S)},[r]),b=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter tags...",value:o,onChange:w=>l(w.target.value),className:"pl-8 h-9"})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:d.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No tags defined.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:d.map(w=>{const S=a(w.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Hl,{id:`tag-activate-${w.id}`,checked:e.has(w.id),onCheckedChange:C=>m(w.id,!!C),className:"mt-0.5"}),f.jsxs(Dt,{htmlFor:`tag-activate-${w.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:w.name}),w.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:w.description}),S.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",S.map(C=>C.name).join(", ")]})]})]})},w.id)})})})]}),v=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter rules...",value:c,onChange:w=>u(w.target.value),className:"pl-8 h-9"})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:h.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:s.length===0?"No rules defined.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:h.map(w=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Hl,{id:`rule-activate-${w.id}`,checked:t.has(w.id),onCheckedChange:S=>y(w.id,!!S),className:"mt-0.5"}),f.jsxs(Dt,{htmlFor:`rule-activate-${w.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:w.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",w.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",w.content]})]})]})},w.id))})})]}),x=[{value:"tags",label:"Activate Tags",content:b()},{value:"rules",label:"Activate Rules",content:v()}];return f.jsx("div",{className:"p-0 max-w-lg",children:f.jsx(Dc,{tabs:x,defaultValue:"tags",scrollable:!1})})},Rst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=T.useState(!1),s=e.getActiveTagIds(),i=e.getActiveRuleIds(),a=e.getIsStreaming(),o=e.getHasRulesOrTags(),l=e.getAllRules(),c=e.getAllTags(),u=e.getRulesForTag,d=T.useCallback((v,x)=>{e.setActiveTagIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),h=T.useCallback((v,x)=>{e.setActiveRuleIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),m=()=>{o?r(v=>!v):e.handleTriggerClick()&&r(!1)},y=s.size>0||i.size>0,b=a;return f.jsxs(pl,{open:n,onOpenChange:r,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:o?f.jsx(ml,{asChild:!0,children:f.jsx(bt,{variant:y?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Configure Rules & Tags for Next Turn",onClick:m,children:f.jsx(bB,{className:"h-4 w-4"})})}):f.jsx(bt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Add Rules & Tags (Opens Settings)",onClick:m,children:f.jsx(bB,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:o?y?`Rules/Tags Active (${s.size} tags, ${i.size} rules)`:"Activate Rules/Tags (Next Turn)":"Add Rules/Tags (Opens Settings)"})]})}),o&&f.jsx(gl,{className:"w-auto p-0",align:"start",children:f.jsx(Kue,{activeTagIds:s,activeRuleIds:i,onToggleTag:d,onToggleRule:h,allRules:l,allTags:c,getRulesForTag:u})})]})};function Nst({form:e,name:t,label:n,description:r,placeholder:s,disabled:i,wrapperClassName:a,className:o,rows:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=typeof u.state.value=="string"||typeof u.state.value=="number"?String(u.state.value):"";return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[f.jsx(Dt,{htmlFor:u.name,className:"text-sm",children:n}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Do,{id:u.name,name:u.name,value:d,onBlur:u.handleBlur,onChange:h=>u.handleChange(h.target.value),placeholder:s,disabled:i??u.form.state.isSubmitting,rows:l,className:Ze(o,u.state.meta.errors.length?"border-destructive":""),...c}),f.jsx(Ni,{field:u})]})}})}const Mst=Ke({name:$e().min(1,"Rule Name is required."),content:$e().min(1,"Rule Content is required."),type:hl(["system","before","after"],{errorMap:()=>({message:"Rule Type is required."})})}),Ist=[{value:"system",label:"System Prompt"},{value:"before",label:"Before User Prompt"},{value:"after",label:"After User Prompt"}],jst=({initialData:e,isSavingExt:t,onSave:n,onCancel:r})=>{const s=ni({defaultValues:{name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"},validators:{onChangeAsync:Mst,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{await n({name:i.name.trim(),content:i.content.trim(),type:i.type})}});return T.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(Kw,{form:s,name:"name",label:"Rule Name",placeholder:"e.g., Always respond in JSON",required:!0,disabled:t,wrapperClassName:"md:col-span-2"}),f.jsx(Nx,{form:s,name:"type",label:"Rule Type",options:Ist,placeholder:"Select Type",disabled:t})]}),f.jsx(Nst,{form:s,name:"content",label:"Rule Content",placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(bt,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[f.jsx(wa,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(bt,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||!l||o,children:[(t||a||o)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Jd,{className:"h-4 w-4 mr-1"})," ",t||a||o?"Saving...":"Save Rule"]})})]})]})},Ost=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:s})=>{const i=a=>{window.confirm(`Are you sure you want to delete the rule "${a.name}"? This will also remove it from any tags.`)&&s(a.id,a.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(of,{children:[f.jsx(np,{children:f.jsxs(ks,{children:[f.jsx(Or,{children:"Name"}),f.jsx(Or,{children:"Type"}),f.jsx(Or,{children:"Content Preview"}),f.jsx(Or,{className:"text-right",children:"Actions"})]})}),f.jsx(lf,{children:t?f.jsxs(f.Fragment,{children:[f.jsx(ks,{children:f.jsx(zn,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(ks,{children:f.jsx(zn,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(ks,{children:f.jsx(zn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(a=>{const o=n[a.id];return f.jsxs(ks,{children:[f.jsx(zn,{className:"font-medium",children:a.name}),f.jsx(zn,{className:"capitalize",children:a.type}),f.jsx(zn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:a.content}),f.jsxs(zn,{className:"text-right space-x-1",children:[f.jsx(On,{tooltipText:"Edit Rule",onClick:()=>r(a),disabled:o,icon:f.jsx(s1,{}),className:"h-8 w-8","aria-label":`Edit rule ${a.name}`}),f.jsx(On,{tooltipText:"Delete Rule",onClick:()=>i(a),disabled:o,icon:o?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Eo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${a.name}`})]})]},a.id)})})]})})},Pst=({module:e})=>{const[,t]=T.useState(Date.now()),n=e.getAllRules(),r=e.getIsLoadingRules(),[s,i]=T.useState(!1),[a,o]=T.useState(null),[l,c]=T.useState(!1),[u,d]=T.useState({});T.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const h=()=>{o(null),i(!0)},m=x=>{o(x),i(!0)},y=T.useCallback(()=>{i(!1),o(null),c(!1)},[]),b=T.useCallback(async x=>{c(!0);try{a?e.updateRule(a.id,x):e.addRule(x),y()}catch{}finally{c(!1)}},[e,a,y]),v=T.useCallback(async x=>{d(w=>({...w,[x]:!0}));try{e.deleteRule(x),(a==null?void 0:a.id)===x&&y()}catch{}finally{d(w=>({...w,[x]:!1}))}},[e,a,y]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!s&&f.jsxs(bt,{onClick:h,variant:"outline",className:"w-full",disabled:r,children:[f.jsx(Pd,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),s&&f.jsx(jst,{initialData:a??void 0,isSavingExt:l,onSave:b,onCancel:y}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),f.jsx(Ost,{rules:n,isLoading:r,isDeleting:u,onEdit:m,onDelete:v})]})]})},E3=Ke({name:$e().min(1,"Tag Name is required."),description:$e().nullable()}),Dst=({initialData:e,isParentSaving:t=!1,onSave:n,onCancel:r})=>{const s=ni({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null},validators:{onChangeAsync:E3,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{var a;await n({name:i.name.trim(),description:((a=i.description)==null?void 0:a.trim())||null})}});return T.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),f.jsx(s.Field,{name:"name",validators:{onChange:E3.shape.name},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:i.name,children:"Tag Name"}),f.jsx(Cn,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"e.g., Code Generation, Summarization",disabled:s.state.isSubmitting||t}),f.jsx(Ni,{field:i})]})}),f.jsx(s.Field,{name:"description",validators:{onChange:E3.shape.description},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:i.name,children:"Description (Optional)"}),f.jsx(Do,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"Describe when to use this tag...",rows:2,disabled:s.state.isSubmitting||t}),f.jsx(Ni,{field:i})]})}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(bt,{variant:"ghost",size:"sm",onClick:r,disabled:s.state.isSubmitting||t,type:"button",children:[f.jsx(wa,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(bt,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||o||!l,children:[(a||o)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Jd,{className:"h-4 w-4 mr-1"})," ",a||o?"Saving...":"Save Tag"]})})]})]})},Fst=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:s,onDelete:i})=>{const a=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&i(o.id,o.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(of,{children:[f.jsx(np,{children:f.jsxs(ks,{children:[f.jsx(Or,{children:"Name"}),f.jsx(Or,{children:"Description"}),f.jsx(Or,{children:"Linked Rules"}),f.jsx(Or,{className:"text-right",children:"Actions"})]})}),f.jsx(lf,{children:n?f.jsxs(f.Fragment,{children:[f.jsx(ks,{children:f.jsx(zn,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(ks,{children:f.jsx(zn,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(ks,{children:f.jsx(zn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],c=t.get(o.id)||[];return f.jsxs(ks,{children:[f.jsx(zn,{className:"font-medium",children:o.name}),f.jsx(zn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),f.jsx(zn,{className:"text-xs",children:c.length>0?c.map(u=>u.name).join(", "):"None"}),f.jsxs(zn,{className:"text-right space-x-1",children:[f.jsx(On,{tooltipText:"Edit Tag & Rules",onClick:()=>s(o),disabled:l,icon:f.jsx(s1,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),f.jsx(On,{tooltipText:"Delete Tag",onClick:()=>a(o),disabled:l,icon:l?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Eo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})},Lst=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:s=!1})=>{const[i,a]=T.useState(!1),[o,l]=T.useState(""),c=T.useMemo(()=>[...t].sort((y,b)=>y.name.localeCompare(b.name)),[t]),u=T.useMemo(()=>{const y=o.toLowerCase();return y?c.filter(b=>b.name.toLowerCase().includes(y)||b.content.toLowerCase().includes(y)||b.type.toLowerCase().includes(y)):c},[c,o]),d=T.useCallback(y=>{const b=n.has(y);r(e.id,y,!b),l("")},[n,r,e.id]),h=T.useCallback((y,b)=>{b.stopPropagation(),r(e.id,y,!1)},[r,e.id]),m=T.useMemo(()=>c.filter(y=>n.has(y.id)),[c,n]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs(Dt,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),f.jsxs(pl,{open:i,onOpenChange:a,children:[f.jsx(ml,{asChild:!0,children:f.jsxs(bt,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between h-9",disabled:s||t.length===0,children:[f.jsx("span",{className:"truncate",children:m.length>0?`${m.length} rule(s) selected`:"Select rules..."}),f.jsx(aE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),f.jsx(gl,{className:"w-[--radix-popover-trigger-width] p-0",children:f.jsxs(zue,{shouldFilter:!1,children:[f.jsx(Uue,{placeholder:"Search rules...",value:o,onValueChange:l}),f.jsxs(que,{children:[f.jsx(Vue,{children:t.length===0?"No rules defined.":"No rules found."}),f.jsx(Wue,{children:u.map(y=>{const b=n.has(y.id);return f.jsxs(Hue,{value:y.id,onSelect:()=>d(y.id),className:"cursor-pointer",children:[f.jsx(ro,{className:Ze("mr-2 h-4 w-4",b?"opacity-100":"opacity-0")}),f.jsx("span",{className:"truncate",children:y.name}),f.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",y.type,")"]})]},y.id)})})]})]})})]}),m.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:m.map(y=>f.jsxs(mi,{variant:"secondary",className:"flex items-center gap-1",children:[f.jsx("span",{className:"truncate",children:y.name}),f.jsx(bt,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:b=>h(y.id,b),disabled:s,"aria-label":`Unlink rule ${y.name}`,children:f.jsx(wa,{className:"h-3 w-3"})})]},y.id))})]})},Bst=({module:e})=>{const[,t]=T.useState(Date.now()),n=e.getAllTags(),r=e.getAllRules(),s=e.getTagRuleLinks(),i=e.getRulesForTag,a=e.getIsLoadingRules(),[o,l]=T.useState(!1),[c,u]=T.useState(null),[d,h]=T.useState(!1),[m,y]=T.useState({});T.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const b=()=>{u(null),l(!0)},v=R=>{u(R),l(!0)},x=T.useCallback(()=>{l(!1),u(null),h(!1)},[]),w=T.useCallback(async R=>{h(!0);try{c?e.updateTag(c.id,R):e.addTag(R),c||x()}catch{}finally{h(!1)}},[e,c,x]),S=T.useCallback(async R=>{y(N=>({...N,[R]:!0}));try{e.deleteTag(R),(c==null?void 0:c.id)===R&&x()}catch{}finally{y(N=>({...N,[R]:!1}))}},[e,c,x]),C=T.useCallback(async(R,N,I)=>{try{I?e.linkTagToRule(R,N):e.unlinkTagFromRule(R,N)}catch{}},[e]),k=T.useMemo(()=>{const R=new Map;return n.forEach(N=>{R.set(N.id,i(N.id))}),R},[n,i]),A=T.useMemo(()=>c?new Set(s.filter(R=>R.tagId===c.id).map(R=>R.ruleId)):new Set,[c,s]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!o&&f.jsxs(bt,{onClick:b,variant:"outline",className:"w-full",disabled:a,children:[f.jsx(Pd,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),o&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx(Dst,{initialData:c??void 0,isParentSaving:d,onSave:w,onCancel:x}),c&&f.jsx(Lst,{tag:c,allRules:r,linkedRuleIds:A,onLinkChange:C,disabled:d})]}),f.jsx(Zd,{}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),f.jsx(Fst,{tags:n,rulesByTagId:k,isLoading:a,isDeleting:m,onEdit:v,onDelete:S})]})]})},$st=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifySettingsCallback(()=>t({})),()=>e.setNotifySettingsCallback(null)),[e]);const n=T.useMemo(()=>[{value:"rules",label:"Rules",content:f.jsx(Pst,{module:e})},{value:"tags",label:"Tags",content:f.jsx(Bst,{module:e})}],[e]);return f.jsx(Dc,{tabs:n,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})};class zst{constructor(){ve(this,"id","core-rules-tags");ve(this,"unregisterPromptControlCallback",null);ve(this,"unregisterSettingsTabCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"modApiRef",null);ve(this,"allRules",[]);ve(this,"allTags",[]);ve(this,"tagRuleLinks",[]);ve(this,"transientActiveTagIds",new Set);ve(this,"transientActiveRuleIds",new Set);ve(this,"isStreaming",!1);ve(this,"hasRulesOrTags",!1);ve(this,"isLoadingRules",!0);ve(this,"notifyComponentUpdate",null);ve(this,"notifySettingsComponentUpdate",null);ve(this,"getAllRules",()=>this.allRules);ve(this,"getAllTags",()=>this.allTags);ve(this,"getTagRuleLinks",()=>this.tagRuleLinks);ve(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});ve(this,"getRuleById",t=>this.allRules.find(n=>n.id===t));ve(this,"getTagById",t=>this.allTags.find(n=>n.id===t));ve(this,"getRulesByIds",t=>{const n=new Set(t);return this.allRules.filter(r=>n.has(r.id))});ve(this,"addRule",t=>{var n;(n=this.modApiRef)==null||n.emit(gr.addRuleRequest,t)});ve(this,"updateRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(gr.updateRuleRequest,{id:t,updates:n})});ve(this,"deleteRule",t=>{var n;(n=this.modApiRef)==null||n.emit(gr.deleteRuleRequest,{id:t})});ve(this,"addTag",t=>{var n;(n=this.modApiRef)==null||n.emit(gr.addTagRequest,t)});ve(this,"updateTag",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(gr.updateTagRequest,{id:t,updates:n})});ve(this,"deleteTag",t=>{var n;(n=this.modApiRef)==null||n.emit(gr.deleteTagRequest,{id:t})});ve(this,"linkTagToRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(gr.linkTagToRuleRequest,{tagId:t,ruleId:n})});ve(this,"unlinkTagFromRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(gr.unlinkTagFromRuleRequest,{tagId:t,ruleId:n})});ve(this,"handleTriggerClick",()=>!this.hasRulesOrTags&&this.modApiRef?(this.modApiRef.emit(jr.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"}),!0):!1);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"getHasRulesOrTags",()=>this.hasRulesOrTags);ve(this,"getIsLoadingRules",()=>this.isLoadingRules);ve(this,"getActiveTagIds",()=>this.transientActiveTagIds);ve(this,"getActiveRuleIds",()=>this.transientActiveRuleIds);ve(this,"setActiveTagIds",t=>{var n;this.transientActiveTagIds=t(this.transientActiveTagIds),(n=this.notifyComponentUpdate)==null||n.call(this)});ve(this,"setActiveRuleIds",t=>{var n;this.transientActiveRuleIds=t(this.transientActiveRuleIds),(n=this.notifyComponentUpdate)==null||n.call(this)});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ve(this,"setNotifySettingsCallback",t=>{this.notifySettingsComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=t.getContextSnapshot().isStreaming,t.emit(gr.loadRulesAndTagsRequest,void 0);const n=t.on(Zn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))}),r=t.on(gr.dataLoaded,s=>{var i,a;s&&(this.allRules=s.rules||[],this.allTags=s.tags||[],this.tagRuleLinks=(s.links||[]).map(o=>({tagId:o.tagId,ruleId:o.ruleId}))),this.updateHasRulesOrTags(),this.isLoadingRules=!1,(i=this.notifyComponentUpdate)==null||i.call(this),(a=this.notifySettingsComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r)}updateHasRulesOrTags(){const t=this.allRules.length>0||this.allTags.length>0;this.hasRulesOrTags!==t&&(this.hasRulesOrTags=t)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingRules?"loading":"ready",triggerRenderer:()=>We.createElement(Rst,{module:this}),getMetadata:()=>{const n=Array.from(this.transientActiveTagIds),r=Array.from(this.transientActiveRuleIds),s=[],i=new Set(r);if(n.forEach(a=>{this.getRulesForTag(a).forEach(o=>i.add(o.id))}),i.forEach(a=>{const o=this.getRuleById(a);o&&s.push({type:o.type,content:o.content,sourceRuleId:o.id})}),n.length>0||r.length>0||s.length>0)return{activeTagIds:n,activeRuleIds:r,effectiveRulesContent:s}},clearOnSubmit:()=>{var r;let n=!1;this.transientActiveTagIds.size>0&&(this.transientActiveTagIds=new Set,n=!0),this.transientActiveRuleIds.size>0&&(this.transientActiveRuleIds=new Set,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"rules-tags",title:"Rules & Tags",component:()=>We.createElement($st,{module:this}),order:50}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.notifySettingsComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Ust=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getTurnEnabled(),r=e.getIsStreaming(),s=e.getGlobalAutoTitleEnabled()&&e.getIsFirstInteraction(),i=T.useCallback(()=>{const a=!n;e.setTurnEnabled(a)},[n,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:n?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:i,disabled:r,"aria-label":n?"Disable Auto-Title for this Chat":"Enable Auto-Title for this Chat",children:f.jsx(pH,{className:Ze("h-4 w-4",n?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:n?"Auto-Title Enabled (Click to Disable)":"Auto-Title Disabled (Click to Enable)"})]})}):null};class qst{constructor(){ve(this,"id","core-auto-title");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"turnAutoTitleEnabled",!1);ve(this,"isStreaming",!1);ve(this,"isFirstInteraction",!1);ve(this,"globalAutoTitleEnabled",!0);ve(this,"notifyComponentUpdate",null);ve(this,"getTurnEnabled",()=>this.turnAutoTitleEnabled);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"getIsFirstInteraction",()=>this.isFirstInteraction);ve(this,"getGlobalAutoTitleEnabled",()=>this.globalAutoTitleEnabled);ve(this,"setTurnEnabled",t=>{var n;this.turnAutoTitleEnabled!==t&&(this.turnAutoTitleEnabled=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var a;this.turnAutoTitleEnabled=!1,this.isStreaming=Bn.getState().status==="streaming",this.globalAutoTitleEnabled=yr.getState().autoTitleEnabled,this.checkFirstInteraction(),(a=this.notifyComponentUpdate)==null||a.call(this);const n=t.on(Zn.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&this.isStreaming!==(o.status==="streaming")&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(jr.contextChanged,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(Zn.completed,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(sn.autoTitleEnabledChanged,o=>{var l;typeof o=="object"&&o&&"enabled"in o&&this.globalAutoTitleEnabled!==o.enabled&&(this.globalAutoTitleEnabled=o.enabled,(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,s,i)}checkFirstInteraction(){const t=Bn.getState(),n=t.currentConversationId===null||t.interactions.filter(r=>r.conversationId===t.currentConversationId).length===0;this.isFirstInteraction!==n&&(this.isFirstInteraction=n,!n&&this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>We.createElement(Ust,{module:this});this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:n,getMetadata:()=>this.turnAutoTitleEnabled?{autoTitleEnabledForTurn:!0}:void 0,clearOnSubmit:()=>{var r;this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1,(r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}function Vst(){const e=new URLSearchParams(window.location.search),t=e.get("q")??void 0,n=e.get("m")??void 0,r=e.getAll("vfs").filter(Boolean),s=e.get("s")??"1";return{query:t,modelId:n,vfsFiles:r.length>0?r:void 0,submit:s}}class Wst{constructor(){ve(this,"id","core-url-parameters");ve(this,"modApiRef",null)}async initialize(t){this.modApiRef=t,console.log(`[${this.id}] Initializing...`),t.on(tp.initializationPhaseCompleted,n=>{n.phase==="all"&&this.processUrlParameters().catch(r=>{console.error(`[${this.id}] Error processing URL parameters:`,r),Oe.error("Failed to process URL parameters.")})}),console.log(`[${this.id}] Initialized, awaiting full app load.`)}register(t){}destroy(){this.modApiRef=null}async processUrlParameters(){var r,s;if(!this.modApiRef){console.warn(`[${this.id}] ModAPI not available, cannot process URL parameters.`);return}const t=this.modApiRef,n=Vst();if(!(!n.query&&!n.modelId&&!((r=n.vfsFiles)!=null&&r.length))){Oe.info("Processing parameters from URL...");try{const i=await new Promise((a,o)=>{const l=t.on(Yn.conversationAdded,c=>{c.conversation.title.startsWith("From URL:")&&(l(),a(c.conversation.id))});setTimeout(()=>{l(),o(new Error("Timeout waiting for conversation creation event."))},5e3),t.emit(Yn.addConversationRequest,{title:n.query?`From URL: ${n.query.substring(0,30)}...`:"From URL Parameters"})});if(t.emit(Yn.selectItemRequest,{id:i,type:"conversation"}),n.modelId){const a=Rr.getState().getAvailableModelListItems();let o=null;const l=n.modelId.toLowerCase();if(n.modelId.includes(":")){const c=a.find(u=>u.id===n.modelId);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase()===l);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase().startsWith(l));c&&(o=c.id)}if(!o){const c=a.find(u=>{const d=u.id.toLowerCase().split("/");return d.length>1&&d[1].startsWith(l)});c&&(o=c.id)}if(o){t.emit(Fn.setModelIdRequest,{id:o}),t.emit(dr.selectModelRequest,{modelId:o});const c=a.find(u=>u.id===o);Oe.success(`Model set to: ${c==null?void 0:c.name} (${c==null?void 0:c.providerName})`)}else Oe.warning(`Model matching "${n.modelId}" not found or not enabled. Using default.`)}if(n.vfsFiles&&n.vfsFiles.length>0){const a="orphan";let o;try{if(o=await t.getVfsInstance(a),!o)throw new Error("Failed to get VFS instance via ModAPI.")}catch(l){Oe.error(`Failed to initialize VFS for URL files: ${l instanceof Error?l.message:String(l)}`)}if(o)for(const l of n.vfsFiles)try{const c=await Gh(l,{fsInstance:o}),u=await o.promises.stat(l),d=gi(l),h="application/octet-stream",m=zx(d,h);let y={};if(m)y.contentText=new TextDecoder().decode(c);else{let b="";const v=c.byteLength;for(let x=0;x<v;x++)b+=String.fromCharCode(c[x]);y.contentBase64=window.btoa(b)}t.emit(Ll.addAttachedFileRequest,{source:"vfs",name:d,type:h,size:u.size,path:l,...y}),Oe.success(`Attached VFS file: ${d}`)}catch(c){c.code==="ENOENT"?Oe.warning(`VFS file not found: ${l}`):Oe.warning(`Failed to attach VFS file "${l}": ${c.message}`),console.error(`Error processing VFS file ${l}:`,c)}}if(n.query)if(n.submit==="0")t.emit(Fn.inputChanged,{value:n.query}),Oe.info("Query from URL loaded into input area."),window.history.replaceState({},document.title,window.location.pathname);else{let a={},o={};const l=hh.getState().attachedFilesMetadata;l.length>0&&(o.attachedFiles=[...l]);let c={id:qi(),content:n.query,parameters:a,metadata:o};t.emit(Fn.submitted,{turnData:c});const u=await RC(Y0.PROMPT_TURN_FINALIZE,{turnData:c});if(u===!1){Oe.warning("Prompt submission from URL cancelled by middleware.");return}const d=u&&typeof u=="object"?u.turnData:c;await Sx.submitPrompt(d),window.history.replaceState({},document.title,window.location.pathname)}else(n.modelId||(s=n.vfsFiles)!=null&&s.length)&&(Oe.info("Model and/or VFS files from URL applied. Type your message."),window.history.replaceState({},document.title,window.location.pathname))}catch(i){Oe.error(`Failed to process URL parameters: ${i instanceof Error?i.message:String(i)}`),console.error("Error processing URL parameters:",i)}}}}const Hst=({module:e})=>{const[t,n]=T.useState(!1),[,r]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>r({})),()=>e.setNotifyCallback(null)),[e]),T.useEffect(()=>{const o=e.getImageGenerationEnabled();n(o===!0)},[e]);const s=e.getIsVisible(),i=e.getIsStreaming(),a=T.useCallback(()=>{const o=!t;e.setImageGenerationEnabled(o?!0:null),n(o)},[t,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(bt,{variant:t?"secondary":"ghost",size:"icon",onClick:a,disabled:i,className:"h-8 w-8","aria-label":t?"Disable Image Generation for Next Turn":"Enable Image Generation for Next Turn",children:f.jsx(J2,{className:Ze("h-4 w-4",t?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:t?"Image Generation Enabled (Click to Disable)":"Image Generation Disabled (Click to Enable)"})]})}):null};class Gst{constructor(){ve(this,"id","core-image-generation");ve(this,"modApiRef",null);ve(this,"isImageGenerationEnabled",null);ve(this,"unregisterCallback",null);ve(this,"notifyComponentUpdate",null);ve(this,"eventUnsubscribers",[]);ve(this,"isVisible",!1);ve(this,"isStreaming",!1);ve(this,"getImageGenerationEnabled",()=>this.isImageGenerationEnabled);ve(this,"getIsVisible",()=>this.isVisible);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"setImageGenerationEnabled",t=>{var n,r;this.isImageGenerationEnabled=t,(n=this.modApiRef)==null||n.emit(Fn.setImageGenerationEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isImageGenerationEnabled=null,this.isStreaming=Bn.getState().status==="streaming",this.updateVisibility();const n=t.on(dr.selectedModelChanged,()=>{var s;this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this)}),r=t.on(Zn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))});this.eventUnsubscribers.push(n,r),console.log(`[${this.id}] Initialized.`)}updateVisibility(){var i,a;const{getSelectedModel:t}=Rr.getState(),n=t(),s=(((a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.output_modalities)??[]).includes("image");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Hst,{module:this}),getMetadata:()=>this.isImageGenerationEnabled===!0?{imageGenerationEnabled:!0}:void 0,clearOnSubmit:()=>{var s;(s=this.modApiRef)==null||s.emit(Fn.setImageGenerationEnabledRequest,{enabled:null})}});const n=s=>{var i;s.enabled!==this.isImageGenerationEnabled&&(this.isImageGenerationEnabled=s.enabled,(i=this.notifyComponentUpdate)==null||i.call(this))},r=this.modApiRef.on(Fn.setImageGenerationEnabledRequest,n);this.eventUnsubscribers.push(r),console.log(`[${this.id}] Registered successfully`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Kst=({module:e})=>{const[t,n]=T.useState(!1),[r,s]=T.useState([]),[i,a]=T.useState(250),[,o]=T.useState({}),{status:l}=Bn(yn(b=>({status:b.status})));T.useEffect(()=>{if(e)return e.setNotifyCallback(()=>o({})),()=>e.setNotifyCallback(null)},[e]);const c=(b,v)=>{s(x=>v?[...x,b]:x.filter(w=>w!==b))},u=()=>{if(r.length<2){Oe.error("Please select at least 2 models to race");return}e.setRaceMode(!0,r,i),n(!1),Oe.info(`Race mode enabled! Send your prompt to race ${r.length} models.`),s([]),a(250)},d=()=>{e.setRaceMode(!1),Oe.info("Race mode disabled")},h=b=>{if(b.stopPropagation(),e.isRaceModeActive){d();return}if(l==="streaming"){Oe.info("Cannot start race while another response is streaming");return}if(e.globallyEnabledModels.length<2){Oe.info("Need at least 2 models enabled to race");return}n(!0)},m=l!=="streaming"&&e.globallyEnabledModels.length>=2,y=()=>e.isRaceModeActive?"Race mode active - click to cancel, or send your prompt to race models":l==="streaming"?"Cannot race while streaming":e.globallyEnabledModels.length<2?`Need at least 2 models enabled to race (currently have ${e.globallyEnabledModels.length})`:"Race multiple models with your prompt";return f.jsxs(f.Fragment,{children:[f.jsx(On,{tooltipText:y(),onClick:h,"aria-label":"Race Multiple Models Against Each Other",disabled:!m,icon:f.jsx(fH,{}),className:`h-5 w-5 md:h-6 md:w-6 ${e.isRaceModeActive?"bg-primary text-primary-foreground":""}`}),f.jsx(Ym,{open:t,onOpenChange:n,children:f.jsxs(Zm,{className:"max-w-md",children:[f.jsxs(Xm,{children:[f.jsx(Jm,{children:"Race Models"}),f.jsx(db,{children:'Select multiple models to race against each other. After clicking "Enable Race Mode", send your prompt and all selected models will respond.'})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:"stagger-input",children:"Stagger Delay (ms)"}),f.jsx(Cn,{id:"stagger-input",type:"number",min:"0",max:"5000",step:"50",value:i,onChange:b=>a(parseInt(b.target.value)||250),placeholder:"250",className:"w-full"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Delay between starting each model (0-5000ms)"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Dt,{children:["Select Models to Race (",r.length," selected)"]}),f.jsx(Po,{className:"h-48 w-full border rounded-md p-3",children:f.jsx("div",{className:"space-y-2",children:e.globallyEnabledModels.map(b=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Hl,{id:`model-${b.id}`,checked:r.includes(b.id),onCheckedChange:v=>c(b.id,v===!0)}),f.jsx(Dt,{htmlFor:`model-${b.id}`,className:"text-sm cursor-pointer flex-1 min-w-0",children:f.jsxs("div",{className:"truncate",children:[f.jsx("span",{className:"font-medium",children:b.name}),f.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",b.providerName,")"]})]})})]},b.id))})}),e.globallyEnabledModels.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No models available"})]})]}),f.jsxs(ub,{children:[f.jsx(bt,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),f.jsx(bt,{onClick:u,disabled:r.length<2||e.isLoadingProviders,children:"Enable Race Mode"})]})]})})]})};class Yst{constructor(){ve(this,"id","race-prompt-control");ve(this,"eventUnsubscribers",[]);ve(this,"modApi",null);ve(this,"notifyComponentUpdate",null);ve(this,"isRaceMode",!1);ve(this,"raceModelIds",[]);ve(this,"raceStaggerMs",250);ve(this,"globallyEnabledModels",[]);ve(this,"isLoadingProviders",!1)}async initialize(t){this.modApi=t;const n=Rr.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading;const r=t.on(dr.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on(dr.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),i=t.addMiddleware(Y0.PROMPT_TURN_FINALIZE,async a=>this.isRaceMode?await this.handleRaceSubmission(a.turnData):a);this.eventUnsubscribers.push(r,s,i)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}setRaceMode(t,n,r){var s;this.isRaceMode=t,t&&n&&r!==void 0?(this.raceModelIds=n,this.raceStaggerMs=r):(this.raceModelIds=[],this.raceStaggerMs=250),(s=this.notifyComponentUpdate)==null||s.call(this)}get isRaceModeActive(){return this.isRaceMode}async handleRaceSubmission(t){try{console.log(`[RacePromptControlModule] Starting race submission with ${this.raceModelIds.length} models:`,this.raceModelIds);const n=Bn.getState(),r=n.currentConversationId;if(!r)return Oe.error("No active conversation for racing"),!1;if(this.raceModelIds.length===0)return Oe.error("No models selected for racing"),this.setRaceMode(!1),!1;Oe.info(`Racing ${this.raceModelIds.length} models with your prompt...`);const i=n.interactions.filter(y=>y.conversationId===r).reduce((y,b)=>Math.max(y,b.index),-1)+1,a=await this.buildPromptObject(t,r,i),o=[...this.raceModelIds],l=this.raceStaggerMs,u=Mo.getState().modelId;if(!u)return Oe.error("No model currently selected"),this.setRaceMode(!1),!1;this.setRaceMode(!1);const d={...a,metadata:{...a.metadata,modelId:u}},h=await tm.startInteraction(d,r,t,"message.user_assistant");if(!h)throw new Error("Failed to create main race interaction");const m=o.map((y,b)=>new Promise(v=>{setTimeout(async()=>{try{const x={...a,metadata:{...a.metadata,modelId:y,raceTab:!0,raceParticipantIndex:b+1}},w=await tm.startInteraction(x,r,t,"message.assistant_regen");if(w){const S={parentId:h.id,index:b+1};n._updateInteractionInState(w.id,S),await Et.saveInteraction({...w,...S})}v()}catch(x){console.error(`[RacePromptControlModule] Race participant ${b+1} failed:`,x),v()}},(b+1)*l)}));return await Promise.all(m),Oe.success(`Race started! Current model + ${o.length} race models responding in tabs.`),!1}catch(n){return Oe.error(`Race failed: ${String(n)}`),console.error("[RacePromptControlModule] Error during race:",n),this.setRaceMode(!1),!1}}async buildPromptObject(t,n,r){var R,N,I;const s=Bn.getState(),i=Oo.getState(),o=qn.getState().getConversationById(n),l=(o==null?void 0:o.projectId)??null,c=i.getEffectiveProjectSettings(l),u=s.interactions.filter(O=>O.conversationId===n&&O.index<r&&O.status==="COMPLETED"&&O.type==="message.user_assistant"&&O.parentId===null).sort((O,L)=>O.index-L.index),d=lj(u);let h=t.content;const m=[],y=((R=t.metadata)==null?void 0:R.effectiveRulesContent)??[],b=y.filter(O=>O.type==="system").map(O=>O.content),v=y.filter(O=>O.type==="before").map(O=>O.content),x=y.filter(O=>O.type==="after").map(O=>O.content);v.length>0&&(h=`${v.join(`
`)}

${h}`),x.length>0&&(h=`${h}

${x.join(`
`)}`),h&&m.push({type:"text",text:h});const w=((N=t.metadata)==null?void 0:N.attachedFiles)??[];w.length>0,m.length>0&&d.push({role:"user",content:m});let C=((I=t.metadata)==null?void 0:I.turnSystemPrompt)??c.systemPrompt??void 0;b.length>0&&(C=`${C?`${C}

`:""}${b.join(`
`)}`);const k=Mo.getState(),A={temperature:k.temperature,max_tokens:k.maxTokens,top_p:k.topP,top_k:k.topK,presence_penalty:k.presencePenalty,frequency_penalty:k.frequencyPenalty,...t.parameters??{}};return Object.keys(A).forEach(O=>{(A[O]===null||A[O]===void 0)&&delete A[O]}),{system:C,messages:d,parameters:A,metadata:{...t.metadata??{},attachedFiles:w.map(({contentBase64:O,contentText:L,...P})=>P)}}}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Kst,{module:this})})}}const fx=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,type:o="text"})=>{const{name:l,state:c,handleChange:u,handleBlur:d}=e,h=c.value,m=y=>{u(y.target.value)};return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[t&&f.jsx(Dt,{htmlFor:l,className:Ze("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(Cn,{id:l,name:l,type:o,value:h==null?"":String(h),onBlur:d,onChange:m,placeholder:r,className:Ze(s,c.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),c.meta.isTouched&&c.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:c.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},Zst=({fieldApi:e,label:t,placeholder:n,description:r,rows:s=3,inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ze("space-y-1.5",o),children:[t&&f.jsx(Dt,{htmlFor:e.name,className:Ze("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Do,{id:e.name,name:e.name,value:e.state.value||"",onBlur:e.handleBlur,onChange:l=>e.handleChange(l.target.value),placeholder:n,rows:s,className:Ze(i,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),Xst=({fieldApi:e,label:t,placeholder:n,description:r,options:s=[],inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ze("space-y-1.5",o),children:[t&&f.jsx(Dt,{htmlFor:e.name+"-trigger",className:Ze("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(Wm,{value:e.state.value||"",onValueChange:l=>e.handleChange(l),disabled:e.form.state.isSubmitting,children:[f.jsx(Gm,{id:e.name+"-trigger",onBlur:e.handleBlur,className:Ze(i,e.state.meta.errors.length?"border-destructive":""),children:f.jsx(Hm,{placeholder:n||"Select an option"})}),f.jsx(Km,{children:s.map((l,c)=>{const u=typeof l=="string"?l:l.value,d=typeof l=="string"?l:l.label;return f.jsx(sl,{value:u,children:d},u+c)})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),Jst=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ze("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Hl,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(!!i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(Dt,{htmlFor:e.name,className:Ze("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),Qst=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ze("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ol,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(Dt,{htmlFor:e.name,className:Ze("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),eit=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,min:o,max:l,step:c})=>{const{name:u,state:d,handleChange:h,handleBlur:m}=e,y=d.value,b=x=>{const w=x.target.value;if(w==="")h(void 0);else{const S=parseFloat(w);h(isNaN(S)?w:S)}};let v="";return(typeof y=="number"||typeof y=="string")&&(v=y),f.jsxs("div",{className:Ze("space-y-1.5",a),children:[t&&f.jsx(Dt,{htmlFor:u,className:Ze("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(Cn,{id:u,name:u,type:"number",value:v,onBlur:m,onChange:b,placeholder:r,min:o,max:l,step:c,className:Ze(s,d.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),d.meta.isTouched&&d.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:d.meta.errors.map((x,w)=>f.jsx("p",{children:typeof x=="string"?x:(x==null?void 0:x.message)||"Invalid"},w))})]})},T3={},hx={};function Mx(e,t){try{const r=(T3[e]||(T3[e]=new Intl.DateTimeFormat("en-GB",{timeZone:e,hour:"numeric",timeZoneName:"longOffset"}).format))(t).split("GMT")[1]||"";return r in hx?hx[r]:pW(r,r.split(":"))}catch{if(e in hx)return hx[e];const n=e==null?void 0:e.match(tit);return n?pW(e,n.slice(1)):NaN}}const tit=/([+-]\d\d):?(\d\d)?/;function pW(e,t){const n=+t[0],r=+(t[1]||0);return hx[e]=n>0?n*60+r:n*60-r}class hu extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Mx(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),Yue(this),wO(this)):this.setTime(Date.now())}static tz(t,...n){return n.length?new hu(...n,t):new hu(Date.now(),t)}withTimeZone(t){return new hu(+this,t)}getTimezoneOffset(){return-Mx(this.timeZone,this)}setTime(t){return Date.prototype.setTime.apply(this,arguments),wO(this),+this}[Symbol.for("constructDateFrom")](t){return new hu(+new Date(t),this.timeZone)}}const mW=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!mW.test(e))return;const t=e.replace(mW,"$1UTC");hu.prototype[t]&&(e.startsWith("get")?hu.prototype[e]=function(){return this.internal[t]()}:(hu.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),nit(this),+this},hu.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),wO(this),+this}))});function wO(e){e.internal.setTime(+e),e.internal.setUTCMinutes(e.internal.getUTCMinutes()-e.getTimezoneOffset())}function nit(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),Yue(e)}function Yue(e){const t=Mx(e.timeZone,e),n=new Date(+e);n.setUTCHours(n.getUTCHours()-1);const r=-new Date(+e).getTimezoneOffset(),s=-new Date(+n).getTimezoneOffset(),i=r-s,a=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();i&&a&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+i);const o=r-t;o&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+o);const l=Mx(e.timeZone,e),u=-new Date(+e).getTimezoneOffset()-l,d=l!==t,h=u-o;if(d&&h){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+h);const m=Mx(e.timeZone,e),y=l-m;y&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+y),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+y))}}class Ia extends hu{static tz(t,...n){return n.length?new Ia(...n,t):new Ia(Date.now(),t)}toISOString(){const[t,n,r]=this.tzComponents(),s=`${t}${n}:${r}`;return this.internal.toISOString().slice(0,-1)+s}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,n,r,s]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${r} ${n} ${s}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[n,r,s]=this.tzComponents();return`${t} GMT${n}${r}${s} (${rit(this.timeZone,this)})`}toLocaleString(t,n){return Date.prototype.toLocaleString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleDateString(t,n){return Date.prototype.toLocaleDateString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleTimeString(t,n){return Date.prototype.toLocaleTimeString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),n=t>0?"-":"+",r=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),s=String(Math.abs(t)%60).padStart(2,"0");return[n,r,s]}withTimeZone(t){return new Ia(+this,t)}[Symbol.for("constructDateFrom")](t){return new Ia(+new Date(t),this.timeZone)}}function rit(e,t){return new Intl.DateTimeFormat("en-GB",{timeZone:e,timeZoneName:"long"}).format(t).slice(12)}var Dn;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(Dn||(Dn={}));var Zs;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(Zs||(Zs={}));var mc;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(mc||(mc={}));var tl;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(tl||(tl={}));const gW=5,sit=4;function iit(e,t){const n=t.startOfMonth(e),r=n.getDay()>0?n.getDay():7,s=t.addDays(e,-r+1),i=t.addDays(s,gW*7-1);return t.getMonth(e)===t.getMonth(i)?gW:sit}function Zue(e,t){const n=t.startOfMonth(e),r=n.getDay();return r===1?n:r===0?t.addDays(n,-1*6):t.addDays(n,-1*(r-1))}function ait(e,t){const n=Zue(e,t),r=iit(e,t);return t.addDays(n,r*7-1)}class cf{constructor(t,n){this.Date=Date,this.today=()=>{var r;return(r=this.overrides)!=null&&r.today?this.overrides.today():this.options.timeZone?Ia.tz(this.options.timeZone):new this.Date},this.newDate=(r,s,i)=>{var a;return(a=this.overrides)!=null&&a.newDate?this.overrides.newDate(r,s,i):this.options.timeZone?new Ia(r,s,i,this.options.timeZone):new Date(r,s,i)},this.addDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(r,s):_Z(r,s)},this.addMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(r,s):SZ(r,s)},this.addWeeks=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(r,s):mTe(r,s)},this.addYears=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(r,s):gTe(r,s)},this.differenceInCalendarDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(r,s):kZ(r,s)},this.differenceInCalendarMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(r,s):TZ(r,s)},this.eachMonthOfInterval=r=>{var s;return(s=this.overrides)!=null&&s.eachMonthOfInterval?this.overrides.eachMonthOfInterval(r):RTe(r)},this.endOfBroadcastWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(r):ait(r,this)},this.endOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfISOWeek?this.overrides.endOfISOWeek(r):ITe(r)},this.endOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.endOfMonth?this.overrides.endOfMonth(r):AZ(r)},this.endOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.endOfWeek?this.overrides.endOfWeek(r,s):NZ(r,this.options)},this.endOfYear=r=>{var s;return(s=this.overrides)!=null&&s.endOfYear?this.overrides.endOfYear(r):MTe(r)},this.format=(r,s,i)=>{var o;const a=(o=this.overrides)!=null&&o.format?this.overrides.format(r,s,this.options):hw(r,s,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(a):a},this.getISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.getISOWeek?this.overrides.getISOWeek(r):MZ(r)},this.getMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getMonth?this.overrides.getMonth(r,this.options):NAe(r,this.options)},this.getYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getYear?this.overrides.getYear(r,this.options):MAe(r,this.options)},this.getWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getWeek?this.overrides.getWeek(r,this.options):jZ(r,this.options)},this.isAfter=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(r,s):IAe(r,s)},this.isBefore=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(r,s):jAe(r,s)},this.isDate=r=>{var s;return(s=this.overrides)!=null&&s.isDate?this.overrides.isDate(r):EZ(r)},this.isSameDay=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(r,s):xTe(r,s)},this.isSameMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(r,s):OAe(r,s)},this.isSameYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(r,s):PAe(r,s)},this.max=r=>{var s;return(s=this.overrides)!=null&&s.max?this.overrides.max(r):yTe(r)},this.min=r=>{var s;return(s=this.overrides)!=null&&s.min?this.overrides.min(r):bTe(r)},this.setMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(r,s):JAe(r,s)},this.setYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(r,s):QAe(r,s)},this.startOfBroadcastWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(r,this):Zue(r,this)},this.startOfDay=r=>{var s;return(s=this.overrides)!=null&&s.startOfDay?this.overrides.startOfDay(r):fw(r)},this.startOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.startOfISOWeek?this.overrides.startOfISOWeek(r):dw(r)},this.startOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.startOfMonth?this.overrides.startOfMonth(r):NTe(r)},this.startOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfWeek?this.overrides.startOfWeek(r,this.options):uy(r,this.options)},this.startOfYear=r=>{var s;return(s=this.overrides)!=null&&s.startOfYear?this.overrides.startOfYear(r):RZ(r)},this.options={locale:tT,...t},this.overrides=n}getDigitMap(){const{numerals:t="latn"}=this.options,n=new Intl.NumberFormat("en-US",{numberingSystem:t}),r={};for(let s=0;s<10;s++)r[s.toString()]=n.format(s);return r}replaceDigits(t){const n=this.getDigitMap();return t.replace(/\d/g,r=>n[r]||r)}formatNumber(t){return this.replaceDigits(t.toString())}}const Lu=new cf;class Xue{constructor(t,n,r=Lu){this.date=t,this.displayMonth=n,this.outside=!!(n&&!r.isSameMonth(t,n)),this.dateLib=r}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class oit{constructor(t,n){this.date=t,this.weeks=n}}class lit{constructor(t,n){this.days=n,this.weekNumber=t}}function kd(e,t,n=!1,r=Lu){let{from:s,to:i}=e;const{differenceInCalendarDays:a,isSameDay:o}=r;return s&&i?(a(i,s)<0&&([s,i]=[i,s]),a(t,s)>=(n?1:0)&&a(i,t)>=(n?1:0)):!n&&i?o(i,t):!n&&s?o(s,t):!1}function Jue(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function G5(e){return!!(e&&typeof e=="object"&&"from"in e)}function Que(e){return!!(e&&typeof e=="object"&&"after"in e)}function ede(e){return!!(e&&typeof e=="object"&&"before"in e)}function tde(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function nde(e,t){return Array.isArray(e)&&e.every(t.isDate)}function Ed(e,t,n=Lu){const r=Array.isArray(t)?t:[t],{isSameDay:s,differenceInCalendarDays:i,isAfter:a}=n;return r.some(o=>{if(typeof o=="boolean")return o;if(n.isDate(o))return s(e,o);if(nde(o,n))return o.includes(e);if(G5(o))return kd(o,e,!1,n);if(tde(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(e.getDay()):o.dayOfWeek===e.getDay();if(Jue(o)){const l=i(o.before,e),c=i(o.after,e),u=l>0,d=c<0;return a(o.before,o.after)?d&&u:u||d}return Que(o)?i(e,o.after)>0:ede(o)?i(o.before,e)>0:typeof o=="function"?o(e):!1})}function cit(e,t,n){const{disabled:r,hidden:s,modifiers:i,showOutsideDays:a,broadcastCalendar:o,today:l}=t,{isSameDay:c,isSameMonth:u,startOfMonth:d,isBefore:h,endOfMonth:m,isAfter:y}=n,b=t.startMonth&&d(t.startMonth),v=t.endMonth&&m(t.endMonth),x={[Zs.focused]:[],[Zs.outside]:[],[Zs.disabled]:[],[Zs.hidden]:[],[Zs.today]:[]},w={};for(const S of e){const{date:C,displayMonth:k}=S,A=!!(k&&!u(C,k)),R=!!(b&&h(C,b)),N=!!(v&&y(C,v)),I=!!(r&&Ed(C,r,n)),O=!!(s&&Ed(C,s,n))||R||N||!o&&!a&&A||o&&a===!1&&A,L=c(C,l??n.today());A&&x.outside.push(S),I&&x.disabled.push(S),O&&x.hidden.push(S),L&&x.today.push(S),i&&Object.keys(i).forEach(P=>{const V=i==null?void 0:i[P];V&&Ed(C,V,n)&&(w[P]?w[P].push(S):w[P]=[S])})}return S=>{const C={[Zs.focused]:!1,[Zs.disabled]:!1,[Zs.hidden]:!1,[Zs.outside]:!1,[Zs.today]:!1},k={};for(const A in x){const R=x[A];C[A]=R.some(N=>N===S)}for(const A in w)k[A]=w[A].some(R=>R===S);return{...C,...k}}}function uit(e,t,n={}){return Object.entries(e).filter(([,s])=>s===!0).reduce((s,[i])=>(n[i]?s.push(n[i]):t[Zs[i]]?s.push(t[Zs[i]]):t[mc[i]]&&s.push(t[mc[i]]),s),[t[Dn.Day]])}function dit(e){return We.createElement("button",{...e})}function fit(e){return We.createElement("span",{...e})}function hit(e){const{size:t=24,orientation:n="left",className:r}=e;return We.createElement("svg",{className:r,width:t,height:t,viewBox:"0 0 24 24"},n==="up"&&We.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),n==="down"&&We.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),n==="left"&&We.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),n==="right"&&We.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function pit(e){const{day:t,modifiers:n,...r}=e;return We.createElement("td",{...r})}function mit(e){const{day:t,modifiers:n,...r}=e,s=We.useRef(null);return We.useEffect(()=>{var i;n.focused&&((i=s.current)==null||i.focus())},[n.focused]),We.createElement("button",{ref:s,...r})}function git(e){const{options:t,className:n,components:r,classNames:s,...i}=e,a=[s[Dn.Dropdown],n].join(" "),o=t==null?void 0:t.find(({value:l})=>l===i.value);return We.createElement("span",{"data-disabled":i.disabled,className:s[Dn.DropdownRoot]},We.createElement(r.Select,{className:a,...i},t==null?void 0:t.map(({value:l,label:c,disabled:u})=>We.createElement(r.Option,{key:l,value:l,disabled:u},c))),We.createElement("span",{className:s[Dn.CaptionLabel],"aria-hidden":!0},o==null?void 0:o.label,We.createElement(r.Chevron,{orientation:"down",size:18,className:s[Dn.Chevron]})))}function yit(e){return We.createElement("div",{...e})}function bit(e){return We.createElement("div",{...e})}function vit(e){const{calendarMonth:t,displayIndex:n,...r}=e;return We.createElement("div",{...r},e.children)}function xit(e){const{calendarMonth:t,displayIndex:n,...r}=e;return We.createElement("div",{...r})}function wit(e){return We.createElement("table",{...e})}function _it(e){return We.createElement("div",{...e})}const rde=T.createContext(void 0);function a_(){const e=T.useContext(rde);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function Sit(e){const{components:t}=a_();return We.createElement(t.Dropdown,{...e})}function Cit(e){const{onPreviousClick:t,onNextClick:n,previousMonth:r,nextMonth:s,...i}=e,{components:a,classNames:o,labels:{labelPrevious:l,labelNext:c}}=a_(),u=T.useCallback(h=>{s&&(n==null||n(h))},[s,n]),d=T.useCallback(h=>{r&&(t==null||t(h))},[r,t]);return We.createElement("nav",{...i},We.createElement(a.PreviousMonthButton,{type:"button",className:o[Dn.PreviousMonthButton],tabIndex:r?void 0:-1,"aria-disabled":r?void 0:!0,"aria-label":l(r),onClick:d},We.createElement(a.Chevron,{disabled:r?void 0:!0,className:o[Dn.Chevron],orientation:"left"})),We.createElement(a.NextMonthButton,{type:"button",className:o[Dn.NextMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":c(s),onClick:u},We.createElement(a.Chevron,{disabled:s?void 0:!0,orientation:"right",className:o[Dn.Chevron]})))}function kit(e){const{components:t}=a_();return We.createElement(t.Button,{...e})}function Eit(e){return We.createElement("option",{...e})}function Tit(e){const{components:t}=a_();return We.createElement(t.Button,{...e})}function Ait(e){const{rootRef:t,...n}=e;return We.createElement("div",{...n,ref:t})}function Rit(e){return We.createElement("select",{...e})}function Nit(e){const{week:t,...n}=e;return We.createElement("tr",{...n})}function Mit(e){return We.createElement("th",{...e})}function Iit(e){return We.createElement("thead",{"aria-hidden":!0},We.createElement("tr",{...e}))}function jit(e){const{week:t,...n}=e;return We.createElement("th",{...n})}function Oit(e){return We.createElement("th",{...e})}function Pit(e){return We.createElement("tbody",{...e})}function Dit(e){const{components:t}=a_();return We.createElement(t.Dropdown,{...e})}const Fit=Object.freeze(Object.defineProperty({__proto__:null,Button:dit,CaptionLabel:fit,Chevron:hit,Day:pit,DayButton:mit,Dropdown:git,DropdownNav:yit,Footer:bit,Month:vit,MonthCaption:xit,MonthGrid:wit,Months:_it,MonthsDropdown:Sit,Nav:Cit,NextMonthButton:kit,Option:Eit,PreviousMonthButton:Tit,Root:Ait,Select:Rit,Week:Nit,WeekNumber:jit,WeekNumberHeader:Oit,Weekday:Mit,Weekdays:Iit,Weeks:Pit,YearsDropdown:Dit},Symbol.toStringTag,{value:"Module"}));function Lit(e){return{...Fit,...e}}function Bit(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([n,r])=>{n.startsWith("data-")&&(t[n]=r)}),t}function K5(){const e={};for(const t in Dn)e[Dn[t]]=`rdp-${Dn[t]}`;for(const t in Zs)e[Zs[t]]=`rdp-${Zs[t]}`;for(const t in mc)e[mc[t]]=`rdp-${mc[t]}`;for(const t in tl)e[tl[t]]=`rdp-${tl[t]}`;return e}function sde(e,t,n){return(n??new cf(t)).format(e,"LLLL y")}const $it=sde;function zit(e,t,n){return(n??new cf(t)).format(e,"d")}function Uit(e,t=Lu){return t.format(e,"LLLL")}function qit(e,t=Lu){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function Vit(){return""}function Wit(e,t,n){return(n??new cf(t)).format(e,"cccccc")}function ide(e,t=Lu){return t.format(e,"yyyy")}const Hit=ide,Git=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:sde,formatDay:zit,formatMonthCaption:$it,formatMonthDropdown:Uit,formatWeekNumber:qit,formatWeekNumberHeader:Vit,formatWeekdayName:Wit,formatYearCaption:Hit,formatYearDropdown:ide},Symbol.toStringTag,{value:"Module"}));function Kit(e){return e!=null&&e.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e!=null&&e.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...Git,...e}}function Yit(e,t,n,r,s){const{startOfMonth:i,startOfYear:a,endOfYear:o,eachMonthOfInterval:l,getMonth:c}=s;return l({start:a(e),end:o(e)}).map(h=>{const m=r.formatMonthDropdown(h,s),y=c(h),b=t&&h<i(t)||n&&h>i(n)||!1;return{value:y,label:m,disabled:b}})}function Zit(e,t={},n={}){let r={...t==null?void 0:t[Dn.Day]};return Object.entries(e).filter(([,s])=>s===!0).forEach(([s])=>{r={...r,...n==null?void 0:n[s]}}),r}function Xit(e,t,n){const r=e.today(),s=t?e.startOfISOWeek(r):e.startOfWeek(r),i=[];for(let a=0;a<7;a++){const o=e.addDays(s,a);i.push(o)}return i}function Jit(e,t,n,r){if(!e||!t)return;const{startOfYear:s,endOfYear:i,addYears:a,getYear:o,isBefore:l,isSameYear:c}=r,u=s(e),d=i(t),h=[];let m=u;for(;l(m,d)||c(m,d);)h.push(m),m=a(m,1);return h.map(y=>{const b=n.formatYearDropdown(y,r);return{value:o(y),label:b,disabled:!1}})}function ade(e,t,n){return(n??new cf(t)).format(e,"LLLL y")}const Qit=ade;function eat(e,t,n,r){let s=(r??new cf(n)).format(e,"PPPP");return t!=null&&t.today&&(s=`Today, ${s}`),s}function ode(e,t,n,r){let s=(r??new cf(n)).format(e,"PPPP");return t.today&&(s=`Today, ${s}`),t.selected&&(s=`${s}, selected`),s}const tat=ode;function nat(){return""}function rat(e){return"Choose the Month"}function sat(e){return"Go to the Next Month"}function iat(e){return"Go to the Previous Month"}function aat(e,t,n){return(n??new cf(t)).format(e,"cccc")}function oat(e,t){return`Week ${e}`}function lat(e){return"Week Number"}function cat(e){return"Choose the Year"}const uat=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:Qit,labelDay:tat,labelDayButton:ode,labelGrid:ade,labelGridcell:eat,labelMonthDropdown:rat,labelNav:nat,labelNext:sat,labelPrevious:iat,labelWeekNumber:oat,labelWeekNumberHeader:lat,labelWeekday:aat,labelYearDropdown:cat},Symbol.toStringTag,{value:"Module"})),o_=e=>e instanceof HTMLElement?e:null,A3=e=>[...e.querySelectorAll("[data-animated-month]")??[]],dat=e=>o_(e.querySelector("[data-animated-month]")),R3=e=>o_(e.querySelector("[data-animated-caption]")),N3=e=>o_(e.querySelector("[data-animated-weeks]")),fat=e=>o_(e.querySelector("[data-animated-nav]")),hat=e=>o_(e.querySelector("[data-animated-weekdays]"));function pat(e,t,{classNames:n,months:r,focused:s,dateLib:i}){const a=T.useRef(null),o=T.useRef(r),l=T.useRef(!1);T.useLayoutEffect(()=>{const c=o.current;if(o.current=r,!t||!e.current||!(e.current instanceof HTMLElement)||r.length===0||c.length===0||r.length!==c.length)return;const u=i.isSameMonth(r[0].date,c[0].date),d=i.isAfter(r[0].date,c[0].date),h=d?n[tl.caption_after_enter]:n[tl.caption_before_enter],m=d?n[tl.weeks_after_enter]:n[tl.weeks_before_enter],y=a.current,b=e.current.cloneNode(!0);if(b instanceof HTMLElement?(A3(b).forEach(S=>{if(!(S instanceof HTMLElement))return;const C=dat(S);C&&S.contains(C)&&S.removeChild(C);const k=R3(S);k&&k.classList.remove(h);const A=N3(S);A&&A.classList.remove(m)}),a.current=b):a.current=null,l.current||u||s)return;const v=y instanceof HTMLElement?A3(y):[],x=A3(e.current);if(x&&x.every(w=>w instanceof HTMLElement)&&v&&v.every(w=>w instanceof HTMLElement)){l.current=!0,e.current.style.isolation="isolate";const w=fat(e.current);w&&(w.style.zIndex="1"),x.forEach((S,C)=>{const k=v[C];if(!k)return;S.style.position="relative",S.style.overflow="hidden";const A=R3(S);A&&A.classList.add(h);const R=N3(S);R&&R.classList.add(m);const N=()=>{l.current=!1,e.current&&(e.current.style.isolation=""),w&&(w.style.zIndex=""),A&&A.classList.remove(h),R&&R.classList.remove(m),S.style.position="",S.style.overflow="",S.contains(k)&&S.removeChild(k)};k.style.pointerEvents="none",k.style.position="absolute",k.style.overflow="hidden",k.setAttribute("aria-hidden","true");const I=hat(k);I&&(I.style.opacity="0");const O=R3(k);O&&(O.classList.add(d?n[tl.caption_before_exit]:n[tl.caption_after_exit]),O.addEventListener("animationend",N));const L=N3(k);L&&L.classList.add(d?n[tl.weeks_before_exit]:n[tl.weeks_after_exit]),S.insertBefore(k,S.firstChild)})}})}function mat(e,t,n,r){const s=e[0],i=e[e.length-1],{ISOWeek:a,fixedWeeks:o,broadcastCalendar:l}=n??{},{addDays:c,differenceInCalendarDays:u,differenceInCalendarMonths:d,endOfBroadcastWeek:h,endOfISOWeek:m,endOfMonth:y,endOfWeek:b,isAfter:v,startOfBroadcastWeek:x,startOfISOWeek:w,startOfWeek:S}=r,C=l?x(s,r):a?w(s):S(s),k=l?h(i):a?m(y(i)):b(y(i)),A=u(k,C),R=d(i,s)+1,N=[];for(let L=0;L<=A;L++){const P=c(C,L);if(t&&v(P,t))break;N.push(P)}const O=(l?35:42)*R;if(o&&N.length<O){const L=O-N.length;for(let P=0;P<L;P++){const V=c(N[N.length-1],1);N.push(V)}}return N}function gat(e){const t=[];return e.reduce((n,r)=>{const s=r.weeks.reduce((i,a)=>[...i,...a.days],t);return[...n,...s]},t)}function yat(e,t,n,r){const{numberOfMonths:s=1}=n,i=[];for(let a=0;a<s;a++){const o=r.addMonths(e,a);if(t&&o>t)break;i.push(o)}return i}function yW(e,t){const{month:n,defaultMonth:r,today:s=t.today(),numberOfMonths:i=1,endMonth:a,startMonth:o}=e;let l=n||r||s;const{differenceInCalendarMonths:c,addMonths:u,startOfMonth:d}=t;if(a&&c(a,l)<0){const h=-1*(i-1);l=u(a,h)}return o&&c(l,o)<0&&(l=o),d(l)}function bat(e,t,n,r){const{addDays:s,endOfBroadcastWeek:i,endOfISOWeek:a,endOfMonth:o,endOfWeek:l,getISOWeek:c,getWeek:u,startOfBroadcastWeek:d,startOfISOWeek:h,startOfWeek:m}=r,y=e.reduce((b,v)=>{const x=n.broadcastCalendar?d(v,r):n.ISOWeek?h(v):m(v),w=n.broadcastCalendar?i(v):n.ISOWeek?a(o(v)):l(o(v)),S=t.filter(R=>R>=x&&R<=w),C=n.broadcastCalendar?35:42;if(n.fixedWeeks&&S.length<C){const R=t.filter(N=>{const I=C-S.length;return N>w&&N<=s(w,I)});S.push(...R)}const k=S.reduce((R,N)=>{const I=n.ISOWeek?c(N):u(N),O=R.find(P=>P.weekNumber===I),L=new Xue(N,v,r);return O?O.days.push(L):R.push(new lit(I,[L])),R},[]),A=new oit(v,k);return b.push(A),b},[]);return n.reverseMonths?y.reverse():y}function vat(e,t){let{startMonth:n,endMonth:r}=e;const{startOfYear:s,startOfDay:i,startOfMonth:a,endOfMonth:o,addYears:l,endOfYear:c,newDate:u,today:d}=t,{fromYear:h,toYear:m,fromMonth:y,toMonth:b}=e;!n&&y&&(n=y),!n&&h&&(n=t.newDate(h,0,1)),!r&&b&&(r=b),!r&&m&&(r=u(m,11,31));const v=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return n?n=a(n):h?n=u(h,0,1):!n&&v&&(n=s(l(e.today??d(),-100))),r?r=o(r):m?r=u(m,11,31):!r&&v&&(r=c(e.today??d())),[n&&i(n),r&&i(r)]}function xat(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i=1}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i:1,u=a(e);if(!t)return o(u,c);if(!(l(t,e)<i))return o(u,c)}function wat(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i??1:1,u=a(e);if(!t)return o(u,-c);if(!(l(u,t)<=0))return o(u,-c)}function _at(e){const t=[];return e.reduce((n,r)=>[...n,...r.weeks],t)}function dA(e,t){const[n,r]=T.useState(e);return[t===void 0?n:t,r]}function Sat(e,t){const[n,r]=vat(e,t),{startOfMonth:s,endOfMonth:i}=t,a=yW(e,t),[o,l]=dA(a,e.month?a:void 0);T.useEffect(()=>{const A=yW(e,t);l(A)},[e.timeZone]);const c=yat(o,r,e,t),u=mat(c,e.endMonth?i(e.endMonth):void 0,e,t),d=bat(c,u,e,t),h=_at(d),m=gat(d),y=wat(o,n,e,t),b=xat(o,r,e,t),{disableNavigation:v,onMonthChange:x}=e,w=A=>h.some(R=>R.days.some(N=>N.isEqualTo(A))),S=A=>{if(v)return;let R=s(A);n&&R<s(n)&&(R=s(n)),r&&R>s(r)&&(R=s(r)),l(R),x==null||x(R)};return{months:d,weeks:h,days:m,navStart:n,navEnd:r,previousMonth:y,nextMonth:b,goToMonth:S,goToDay:A=>{w(A)||S(A.date)}}}var tu;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(tu||(tu={}));function bW(e){return!e[Zs.disabled]&&!e[Zs.hidden]&&!e[Zs.outside]}function Cat(e,t,n,r){let s,i=-1;for(const a of e){const o=t(a);bW(o)&&(o[Zs.focused]&&i<tu.FocusedModifier?(s=a,i=tu.FocusedModifier):r!=null&&r.isEqualTo(a)&&i<tu.LastFocused?(s=a,i=tu.LastFocused):n(a.date)&&i<tu.Selected?(s=a,i=tu.Selected):o[Zs.today]&&i<tu.Today&&(s=a,i=tu.Today))}return s||(s=e.find(a=>bW(t(a)))),s}function kat(e,t,n,r,s,i,a){const{ISOWeek:o,broadcastCalendar:l}=i,{addDays:c,addMonths:u,addWeeks:d,addYears:h,endOfBroadcastWeek:m,endOfISOWeek:y,endOfWeek:b,max:v,min:x,startOfBroadcastWeek:w,startOfISOWeek:S,startOfWeek:C}=a;let A={day:c,week:d,month:u,year:h,startOfWeek:R=>l?w(R,a):o?S(R):C(R),endOfWeek:R=>l?m(R):o?y(R):b(R)}[e](n,t==="after"?1:-1);return t==="before"&&r?A=v([r,A]):t==="after"&&s&&(A=x([s,A])),A}function lde(e,t,n,r,s,i,a,o=0){if(o>365)return;const l=kat(e,t,n.date,r,s,i,a),c=!!(i.disabled&&Ed(l,i.disabled,a)),u=!!(i.hidden&&Ed(l,i.hidden,a)),d=l,h=new Xue(l,d,a);return!c&&!u?h:lde(e,t,h,r,s,i,a,o+1)}function Eat(e,t,n,r,s){const{autoFocus:i}=e,[a,o]=T.useState(),l=Cat(t.days,n,r||(()=>!1),a),[c,u]=T.useState(i?l:void 0);return{isFocusTarget:b=>!!(l!=null&&l.isEqualTo(b)),setFocused:u,focused:c,blur:()=>{o(c),u(void 0)},moveFocus:(b,v)=>{if(!c)return;const x=lde(b,v,c,t.navStart,t.navEnd,e,s);x&&(t.goToDay(x),u(x))}}}function Tat(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=dA(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t,c=m=>(o==null?void 0:o.some(y=>l(y,m)))??!1,{min:u,max:d}=e;return{selected:o,select:(m,y,b)=>{let v=[...o??[]];if(c(m)){if((o==null?void 0:o.length)===u||r&&(o==null?void 0:o.length)===1)return;v=o==null?void 0:o.filter(x=>!l(x,m))}else(o==null?void 0:o.length)===d?v=[m]:v=[...v,m];return s||a(v),s==null||s(v,m,y,b),v},isSelected:c}}function Aat(e,t,n=0,r=0,s=!1,i=Lu){const{from:a,to:o}=t||{},{isSameDay:l,isAfter:c,isBefore:u}=i;let d;if(!a&&!o)d={from:e,to:n>0?void 0:e};else if(a&&!o)l(a,e)?s?d={from:a,to:void 0}:d=void 0:u(e,a)?d={from:e,to:a}:d={from:a,to:e};else if(a&&o)if(l(a,e)&&l(o,e))s?d={from:a,to:o}:d=void 0;else if(l(a,e))d={from:a,to:n>0?void 0:e};else if(l(o,e))d={from:e,to:n>0?void 0:e};else if(u(e,a))d={from:e,to:o};else if(c(e,a))d={from:a,to:e};else if(c(e,o))d={from:a,to:e};else throw new Error("Invalid range");if(d!=null&&d.from&&(d!=null&&d.to)){const h=i.differenceInCalendarDays(d.to,d.from);r>0&&h>r?d={from:e,to:void 0}:n>1&&h<n&&(d={from:e,to:void 0})}return d}function Rat(e,t,n=Lu){const r=Array.isArray(t)?t:[t];let s=e.from;const i=n.differenceInCalendarDays(e.to,e.from),a=Math.min(i,6);for(let o=0;o<=a;o++){if(r.includes(s.getDay()))return!0;s=n.addDays(s,1)}return!1}function vW(e,t,n=Lu){return kd(e,t.from,!1,n)||kd(e,t.to,!1,n)||kd(t,e.from,!1,n)||kd(t,e.to,!1,n)}function Nat(e,t,n=Lu){const r=Array.isArray(t)?t:[t];if(r.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:n.isDate(o)?kd(e,o,!1,n):nde(o,n)?o.some(l=>kd(e,l,!1,n)):G5(o)?o.from&&o.to?vW(e,{from:o.from,to:o.to},n):!1:tde(o)?Rat(e,o.dayOfWeek,n):Jue(o)?n.isAfter(o.before,o.after)?vW(e,{from:n.addDays(o.after,1),to:n.addDays(o.before,-1)},n):Ed(e.from,o,n)||Ed(e.to,o,n):Que(o)||ede(o)?Ed(e.from,o,n)||Ed(e.to,o,n):!1))return!0;const a=r.filter(o=>typeof o=="function");if(a.length){let o=e.from;const l=n.differenceInCalendarDays(e.to,e.from);for(let c=0;c<=l;c++){if(a.some(u=>u(o)))return!0;o=n.addDays(o,1)}}return!1}function Mat(e,t){const{disabled:n,excludeDisabled:r,selected:s,required:i,onSelect:a}=e,[o,l]=dA(s,a?s:void 0),c=a?s:o;return{selected:c,select:(h,m,y)=>{const{min:b,max:v}=e,x=h?Aat(h,c,b,v,i,t):void 0;return r&&n&&(x!=null&&x.from)&&x.to&&Nat({from:x.from,to:x.to},n,t)&&(x.from=h,x.to=void 0),a||l(x),a==null||a(x,h,m,y),x},isSelected:h=>c&&kd(c,h,!1,t)}}function Iat(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=dA(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t;return{selected:o,select:(d,h,m)=>{let y=d;return!r&&o&&o&&l(d,o)&&(y=void 0),s||a(y),s==null||s(y,d,h,m),y},isSelected:d=>o?l(o,d):!1}}function jat(e,t){const n=Iat(e,t),r=Tat(e,t),s=Mat(e,t);switch(e.mode){case"single":return n;case"multiple":return r;case"range":return s;default:return}}function Oat(e){var vt;let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new Ia(t.today,t.timeZone)),t.month&&(t.month=new Ia(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new Ia(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new Ia(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new Ia(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new Ia(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=(vt=t.selected)==null?void 0:vt.map(ot=>new Ia(ot,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new Ia(t.selected.from,t.timeZone):void 0,to:t.selected.to?new Ia(t.selected.to,t.timeZone):void 0}));const{components:n,formatters:r,labels:s,dateLib:i,locale:a,classNames:o}=T.useMemo(()=>{const ot={...tT,...t.locale};return{dateLib:new cf({locale:ot,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:Lit(t.components),formatters:Kit(t.formatters),labels:{...uat,...t.labels},locale:ot,classNames:{...K5(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:l,mode:c,navLayout:u,numberOfMonths:d=1,onDayBlur:h,onDayClick:m,onDayFocus:y,onDayKeyDown:b,onDayMouseEnter:v,onDayMouseLeave:x,onNextClick:w,onPrevClick:S,showWeekNumber:C,styles:k}=t,{formatCaption:A,formatDay:R,formatMonthDropdown:N,formatWeekNumber:I,formatWeekNumberHeader:O,formatWeekdayName:L,formatYearDropdown:P}=r,V=Sat(t,i),{days:F,months:X,navStart:U,navEnd:H,previousMonth:$,nextMonth:ne,goToMonth:W}=V,Q=cit(F,t,i),{isSelected:ee,select:se,selected:pe}=jat(t,i)??{},{blur:ce,focused:Ie,isFocusTarget:De,moveFocus:Se,setFocused:Ce}=Eat(t,V,Q,ee??(()=>!1),i),{labelDayButton:qe,labelGridcell:Qe,labelGrid:Ve,labelMonthDropdown:Ne,labelNav:K,labelPrevious:me,labelNext:Ae,labelWeekday:le,labelWeekNumber:oe,labelWeekNumberHeader:re,labelYearDropdown:Te}=s,Be=T.useMemo(()=>Xit(i,t.ISOWeek),[i,t.ISOWeek]),ke=c!==void 0||m!==void 0,lt=T.useCallback(()=>{$&&(W($),S==null||S($))},[$,W,S]),Rt=T.useCallback(()=>{ne&&(W(ne),w==null||w(ne))},[W,ne,w]),ft=T.useCallback((ot,B)=>ze=>{ze.preventDefault(),ze.stopPropagation(),Ce(ot),se==null||se(ot.date,B,ze),m==null||m(ot.date,B,ze)},[se,m,Ce]),jt=T.useCallback((ot,B)=>ze=>{Ce(ot),y==null||y(ot.date,B,ze)},[y,Ce]),qt=T.useCallback((ot,B)=>ze=>{ce(),h==null||h(ot.date,B,ze)},[ce,h]),Lt=T.useCallback((ot,B)=>ze=>{const st={ArrowLeft:["day",t.dir==="rtl"?"after":"before"],ArrowRight:["day",t.dir==="rtl"?"before":"after"],ArrowDown:["week","after"],ArrowUp:["week","before"],PageUp:[ze.shiftKey?"year":"month","before"],PageDown:[ze.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(st[ze.key]){ze.preventDefault(),ze.stopPropagation();const[ye,_e]=st[ze.key];Se(ye,_e)}b==null||b(ot.date,B,ze)},[Se,b,t.dir]),en=T.useCallback((ot,B)=>ze=>{v==null||v(ot.date,B,ze)},[v]),xe=T.useCallback((ot,B)=>ze=>{x==null||x(ot.date,B,ze)},[x]),D=T.useCallback(ot=>B=>{const ze=Number(B.target.value),st=i.setMonth(i.startOfMonth(ot),ze);W(st)},[i,W]),Z=T.useCallback(ot=>B=>{const ze=Number(B.target.value),st=i.setYear(i.startOfMonth(ot),ze);W(st)},[i,W]),{className:ge,style:Fe}=T.useMemo(()=>({className:[o[Dn.Root],t.className].filter(Boolean).join(" "),style:{...k==null?void 0:k[Dn.Root],...t.style}}),[o,t.className,t.style,k]),we=Bit(t),Me=T.useRef(null);pat(Me,!!t.animate,{classNames:o,months:X,focused:Ie,dateLib:i});const de={dayPickerProps:t,selected:pe,select:se,isSelected:ee,months:X,nextMonth:ne,previousMonth:$,goToMonth:W,getModifiers:Q,components:n,classNames:o,styles:k,labels:s,formatters:r};return We.createElement(rde.Provider,{value:de},We.createElement(n.Root,{rootRef:t.animate?Me:void 0,className:ge,style:Fe,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...we},We.createElement(n.Months,{className:o[Dn.Months],style:k==null?void 0:k[Dn.Months]},!t.hideNavigation&&!u&&We.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[Dn.Nav],style:k==null?void 0:k[Dn.Nav],"aria-label":K(),onPreviousClick:lt,onNextClick:Rt,previousMonth:$,nextMonth:ne}),X.map((ot,B)=>{const ze=Yit(ot.date,U,H,r,i),st=Jit(U,H,r,i);return We.createElement(n.Month,{"data-animated-month":t.animate?"true":void 0,className:o[Dn.Month],style:k==null?void 0:k[Dn.Month],key:B,displayIndex:B,calendarMonth:ot},u==="around"&&!t.hideNavigation&&B===0&&We.createElement(n.PreviousMonthButton,{type:"button",className:o[Dn.PreviousMonthButton],tabIndex:$?void 0:-1,"aria-disabled":$?void 0:!0,"aria-label":me($),onClick:lt,"data-animated-button":t.animate?"true":void 0},We.createElement(n.Chevron,{disabled:$?void 0:!0,className:o[Dn.Chevron],orientation:t.dir==="rtl"?"right":"left"})),We.createElement(n.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:o[Dn.MonthCaption],style:k==null?void 0:k[Dn.MonthCaption],calendarMonth:ot,displayIndex:B},l!=null&&l.startsWith("dropdown")?We.createElement(n.DropdownNav,{className:o[Dn.Dropdowns],style:k==null?void 0:k[Dn.Dropdowns]},l==="dropdown"||l==="dropdown-months"?We.createElement(n.MonthsDropdown,{className:o[Dn.MonthsDropdown],"aria-label":Ne(),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:D(ot.date),options:ze,style:k==null?void 0:k[Dn.Dropdown],value:i.getMonth(ot.date)}):We.createElement("span",null,N(ot.date,i)),l==="dropdown"||l==="dropdown-years"?We.createElement(n.YearsDropdown,{className:o[Dn.YearsDropdown],"aria-label":Te(i.options),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:Z(ot.date),options:st,style:k==null?void 0:k[Dn.Dropdown],value:i.getYear(ot.date)}):We.createElement("span",null,P(ot.date,i)),We.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},A(ot.date,i.options,i))):We.createElement(n.CaptionLabel,{className:o[Dn.CaptionLabel],role:"status","aria-live":"polite"},A(ot.date,i.options,i))),u==="around"&&!t.hideNavigation&&B===d-1&&We.createElement(n.NextMonthButton,{type:"button",className:o[Dn.NextMonthButton],tabIndex:ne?void 0:-1,"aria-disabled":ne?void 0:!0,"aria-label":Ae(ne),onClick:Rt,"data-animated-button":t.animate?"true":void 0},We.createElement(n.Chevron,{disabled:ne?void 0:!0,className:o[Dn.Chevron],orientation:t.dir==="rtl"?"left":"right"})),B===d-1&&u==="after"&&!t.hideNavigation&&We.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[Dn.Nav],style:k==null?void 0:k[Dn.Nav],"aria-label":K(),onPreviousClick:lt,onNextClick:Rt,previousMonth:$,nextMonth:ne}),We.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":c==="multiple"||c==="range","aria-label":Ve(ot.date,i.options,i)||void 0,className:o[Dn.MonthGrid],style:k==null?void 0:k[Dn.MonthGrid]},!t.hideWeekdays&&We.createElement(n.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:o[Dn.Weekdays],style:k==null?void 0:k[Dn.Weekdays]},C&&We.createElement(n.WeekNumberHeader,{"aria-label":re(i.options),className:o[Dn.WeekNumberHeader],style:k==null?void 0:k[Dn.WeekNumberHeader],scope:"col"},O()),Be.map((ye,_e)=>We.createElement(n.Weekday,{"aria-label":le(ye,i.options,i),className:o[Dn.Weekday],key:_e,style:k==null?void 0:k[Dn.Weekday],scope:"col"},L(ye,i.options,i)))),We.createElement(n.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:o[Dn.Weeks],style:k==null?void 0:k[Dn.Weeks]},ot.weeks.map((ye,_e)=>We.createElement(n.Week,{className:o[Dn.Week],key:ye.weekNumber,style:k==null?void 0:k[Dn.Week],week:ye},C&&We.createElement(n.WeekNumber,{week:ye,style:k==null?void 0:k[Dn.WeekNumber],"aria-label":oe(ye.weekNumber,{locale:a}),className:o[Dn.WeekNumber],scope:"row",role:"rowheader"},I(ye.weekNumber,i)),ye.days.map(Ue=>{const{date:kt}=Ue,fe=Q(Ue);if(fe[Zs.focused]=!fe.hidden&&!!(Ie!=null&&Ie.isEqualTo(Ue)),fe[mc.selected]=(ee==null?void 0:ee(kt))||fe.selected,G5(pe)){const{from:be,to:Pe}=pe;fe[mc.range_start]=!!(be&&Pe&&i.isSameDay(kt,be)),fe[mc.range_end]=!!(be&&Pe&&i.isSameDay(kt,Pe)),fe[mc.range_middle]=kd(pe,kt,!0,i)}const Y=Zit(fe,k,t.modifiersStyles),G=uit(fe,o,t.modifiersClassNames),J=!ke&&!fe.hidden?Qe(kt,fe,i.options,i):void 0;return We.createElement(n.Day,{key:`${i.format(kt,"yyyy-MM-dd")}_${i.format(Ue.displayMonth,"yyyy-MM")}`,day:Ue,modifiers:fe,className:G.join(" "),style:Y,role:"gridcell","aria-selected":fe.selected||void 0,"aria-label":J,"data-day":i.format(kt,"yyyy-MM-dd"),"data-month":Ue.outside?i.format(kt,"yyyy-MM"):void 0,"data-selected":fe.selected||void 0,"data-disabled":fe.disabled||void 0,"data-hidden":fe.hidden||void 0,"data-outside":Ue.outside||void 0,"data-focused":fe.focused||void 0,"data-today":fe.today||void 0},!fe.hidden&&ke?We.createElement(n.DayButton,{className:o[Dn.DayButton],style:k==null?void 0:k[Dn.DayButton],type:"button",day:Ue,modifiers:fe,disabled:fe.disabled||void 0,tabIndex:De(Ue)?0:-1,"aria-label":qe(kt,fe,i.options,i),onClick:ft(Ue,fe),onBlur:qt(Ue,fe),onFocus:jt(Ue,fe),onKeyDown:Lt(Ue,fe),onMouseEnter:en(Ue,fe),onMouseLeave:xe(Ue,fe)},R(kt,i.options,i)):!fe.hidden&&R(Ue.date,i.options,i))}))))))})),t.footer&&We.createElement(n.Footer,{className:o[Dn.Footer],style:k==null?void 0:k[Dn.Footer],role:"status","aria-live":"polite"},t.footer)))}function Pat({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:r="label",buttonVariant:s="ghost",formatters:i,components:a,...o}){const l=K5();return f.jsx(Oat,{showOutsideDays:n,className:Ze("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:r,formatters:{formatMonthDropdown:c=>c.toLocaleString("default",{month:"short"}),...i},classNames:{root:Ze("w-fit",l.root),months:Ze("flex gap-4 flex-col md:flex-row relative",l.months),month:Ze("flex flex-col w-full gap-4",l.month),nav:Ze("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",l.nav),button_previous:Ze(z3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_previous),button_next:Ze(z3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_next),month_caption:Ze("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",l.month_caption),dropdowns:Ze("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",l.dropdowns),dropdown_root:Ze("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",l.dropdown_root),dropdown:Ze("absolute inset-0 opacity-0",l.dropdown),caption_label:Ze("select-none font-medium",r==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",l.caption_label),table:"w-full border-collapse",weekdays:Ze("flex",l.weekdays),weekday:Ze("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",l.weekday),week:Ze("flex w-full mt-2",l.week),week_number_header:Ze("select-none w-(--cell-size)",l.week_number_header),week_number:Ze("text-[0.8rem] select-none text-muted-foreground",l.week_number),day:Ze("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",l.day),range_start:Ze("rounded-l-md bg-accent",l.range_start),range_middle:Ze("rounded-none",l.range_middle),range_end:Ze("rounded-r-md bg-accent",l.range_end),today:Ze("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",l.today),outside:Ze("text-muted-foreground aria-selected:text-muted-foreground",l.outside),disabled:Ze("text-muted-foreground opacity-50",l.disabled),hidden:Ze("invisible",l.hidden),...t},components:{Root:({className:c,rootRef:u,...d})=>f.jsx("div",{"data-slot":"calendar",ref:u,className:Ze(c),...d}),Chevron:({className:c,orientation:u,...d})=>u==="left"?f.jsx(ype,{className:Ze("size-4",c),...d}):u==="right"?f.jsx(RO,{className:Ze("size-4",c),...d}):f.jsx(Nc,{className:Ze("size-4",c),...d}),DayButton:Dat,WeekNumber:({children:c,...u})=>f.jsx("td",{...u,children:f.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:c})}),...a},...o})}function Dat({className:e,day:t,modifiers:n,...r}){const s=K5(),i=T.useRef(null);return T.useEffect(()=>{var a;n.focused&&((a=i.current)==null||a.focus())},[n.focused]),f.jsx(bt,{ref:i,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:Ze("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",s.day,e),...r})}const Fat=({fieldApi:e,label:t,placeholder:n="Pick a date",description:r,inputClassName:s,labelClassName:i,wrapperClassName:a})=>{const[o,l]=We.useState(!1),c=e.state.value?e.state.value instanceof Date?e.state.value:typeof e.state.value=="string"?DAe(e.state.value):void 0:void 0,u=d=>{e.handleChange(d),e.handleBlur(),l(!1)};return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[t&&f.jsx(Dt,{htmlFor:e.name+"-trigger",className:Ze("text-sm font-medium",i),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(pl,{open:o,onOpenChange:l,children:[f.jsx(ml,{asChild:!0,children:f.jsxs(bt,{id:e.name+"-trigger",variant:"outline",className:Ze("w-full justify-start text-left font-normal",!c&&"text-muted-foreground",s,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting,onBlur:e.handleBlur,children:[f.jsx(hpe,{className:"mr-2 h-4 w-4"}),c?hw(c,"PPP"):f.jsx("span",{children:n})]})}),f.jsx(gl,{className:"w-auto p-0",children:f.jsx(Pat,{mode:"single",selected:c,onSelect:u,initialFocus:!0,disabled:e.form.state.isSubmitting})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((d,h)=>f.jsx("p",{children:String(d)},h))})]})},Lat=({fieldApi:e,label:t,description:n,min:r=0,max:s=100,step:i=1,valueLabelPrefix:a="",valueLabelSuffix:o="",valueDisplayPrecision:l=0,showRawValue:c=!1,wrapperClassName:u,inputClassName:d,labelClassName:h})=>{const{name:m,state:y,handleChange:b,handleBlur:v}=e,x=typeof y.value=="number"?y.value:r,w=x.toFixed(l);return f.jsxs("div",{className:Ze("space-y-1.5",u),children:[t&&f.jsxs(Dt,{htmlFor:m,className:Ze("text-sm font-medium",h),children:[t," (",a,w,o,")",c&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.value,")"]})]}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(w0,{id:m,name:m,value:[x],onValueChange:S=>b(S[0]),onBlur:v,disabled:e.form.state.isSubmitting,min:r,max:s,step:i,className:Ze(d,y.meta.errors.length?"border-destructive":"")}),y.meta.isTouched&&y.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:y.meta.errors.map((S,C)=>f.jsx("p",{children:typeof S=="string"?S:(S==null?void 0:S.message)||"Invalid"},C))})]})},Bat=({fieldApi:e,label:t,accept:n,className:r,wrapperClassName:s,description:i})=>{const{name:a,state:o,handleChange:l,handleBlur:c}=e,u=o.value,d=y=>{var v;const b=((v=y.target.files)==null?void 0:v[0])??null;l(b),c()},h=()=>{l(null);const y=document.getElementById(a);y&&(y.value=""),c()},m=()=>{const y=document.getElementById(a);y==null||y.click()};return f.jsxs("div",{className:Ze("space-y-1.5",s),children:[t&&f.jsx(Dt,{className:"text-sm font-medium cursor-pointer",onClick:m,children:t}),i&&f.jsx("p",{className:"text-xs text-muted-foreground",children:i}),f.jsx(Cn,{id:a,name:a,type:"file",accept:n,onChange:d,className:"hidden"}),u?f.jsxs("div",{className:"flex items-center justify-between p-2.5 border rounded-lg bg-muted/40 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm overflow-hidden",children:[f.jsx(cE,{className:"h-5 w-5 text-primary shrink-0"}),f.jsx("span",{className:"truncate",title:u.name,children:u.name}),f.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["(",(u.size/1024).toFixed(1)," KB)"]})]}),f.jsx(bt,{type:"button",variant:"ghost",size:"icon",onClick:h,className:"h-7 w-7 text-destructive hover:bg-destructive/10 shrink-0","aria-label":"Remove file",children:f.jsx(wa,{className:"h-4 w-4"})})]}):f.jsxs("button",{type:"button",onClick:m,className:Ze("w-full flex flex-col items-center justify-center p-4 border-2 border-dashed rounded-lg hover:border-primary transition-colors cursor-pointer bg-background hover:bg-muted/50",r,o.meta.errors.length?"border-destructive hover:border-destructive":"border-muted-foreground/50"),children:[f.jsx(NO,{className:"h-8 w-8 text-muted-foreground mb-2"}),f.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Click or drag and drop a file"}),n&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 mt-1",children:["Accepted types: ",n]})]}),o.meta.isTouched&&o.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:o.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},$at={text:fx,email:fx,password:fx,url:fx,textarea:Zst,select:Xst,checkbox:Jst,switch:Qst,number:eit,date:Fat,slider:Lat,file:Bat},zat=({value:e,currentPage:t,totalPages:n,className:r})=>f.jsxs("div",{className:Ze("space-y-2",r),children:[f.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[f.jsxs("span",{children:["Step ",t," of ",n]}),f.jsxs("span",{children:[Math.round(e),"%"]})]}),f.jsx(Ey,{value:e,className:"h-2"})]}),Uat=({children:e,title:t,description:n})=>f.jsxs("div",{className:"space-y-6",children:[(t||n)&&f.jsxs("div",{className:"space-y-2",children:[t&&f.jsx("h3",{className:"text-lg font-semibold",children:t}),n&&f.jsx("p",{className:"text-muted-foreground",children:n})]}),f.jsx("div",{className:"space-y-4",children:e})]});function qat(e){const{fields:t=[],schema:n,submitLabel:r="Submit",nextLabel:s="Next",previousLabel:i="Previous",formClassName:a,fieldClassName:o,pages:l=[],progress:c,defaultComponents:u={},globalWrapper:d,formOptions:h,onPageChange:m,autoSubmitOnChange:y=!1,autoSubmitDebounceMs:b=1e3,disabled:v=!1,loading:x=!1,resetOnSubmitSuccess:w=!1}=e,[S,C]=T.useState(1),k={...$at,...u},A=T.useMemo(()=>{const ne={};return t.forEach(W=>{const Q=W.page||1;ne[Q]||(ne[Q]=[]),ne[Q].push(W)}),ne},[t]),R=Math.max(...Object.keys(A).map(Number),1),N=R>1,I=N?(S-1)/(R-1)*100:100,O={...h,...n&&{validators:{onChange:n,...h==null?void 0:h.validators}},...w&&(h==null?void 0:h.onSubmit)&&{onSubmit:async ne=>{try{const W=await h.onSubmit(ne);return L.reset(),W}catch(W){throw W}}}},L=ni(O);We.useEffect(()=>{const ne=[];let W,Q;if(h!=null&&h.onChange||y){const ee=L.store.subscribe(()=>{const se=L,pe=se.state.values;h!=null&&h.onChange&&se.state.isValid&&(clearTimeout(Q),Q=setTimeout(()=>{h.onChange({value:pe,formApi:se})},300)),y&&!v&&!x&&(clearTimeout(W),W=setTimeout(()=>{L.state.canSubmit&&L.handleSubmit()},b))});ne.push(ee)}return ne.push(()=>{clearTimeout(W),clearTimeout(Q)}),()=>{ne.forEach(ee=>ee())}},[L,y,b,v,x]);const P=()=>A[S]||[],V=()=>l.find(ne=>ne.page===S),F=()=>{if(S<R){const ne=S+1;C(ne),m==null||m(ne,"next")}},X=()=>{if(S>1){const ne=S-1;C(ne),m==null||m(ne,"previous")}},U=S===R,H=S===1;return{form:L,Form:({className:ne,children:W,onSubmit:Q})=>{const ee=Se=>{Se.preventDefault(),Se.stopPropagation(),Q?Q(Se):U?L.handleSubmit():F()},se=Ze("space-y-6",a,ne),pe=Se=>{const{name:Ce,type:qe,label:Qe,placeholder:Ve,description:Ne,options:K,min:me,max:Ae,step:le,accept:oe,multiple:re,component:Te,wrapper:Be,conditional:ke,validation:lt}=Se;return f.jsx(L.Field,{name:Ce,validators:lt?{onChange:lt}:void 0,children:Rt=>{const ft=Rt.form.state.values;if(ke&&!ke(ft))return null;const jt={fieldApi:Rt,label:Qe,placeholder:Ve,description:Ne,wrapperClassName:o,min:me,max:Ae,step:le,accept:oe,multiple:re,disabled:v||x||Rt.form.state.isSubmitting},qt=Te||k[qe]||fx,Lt=qe==="select"?{...jt,options:K||[]}:{...jt,type:["text","email","password","url"].includes(qe)?qe:void 0},en=f.jsx(qt,{...Lt}),xe=Be||d;return xe?f.jsx(xe,{field:Se,children:en}):en}},Ce)},ce=()=>{const Se=P(),Ce=V(),qe=Se.map(Ve=>pe(Ve)).filter(Boolean),Qe=(Ce==null?void 0:Ce.component)||Uat;return f.jsx(Qe,{title:Ce==null?void 0:Ce.title,description:Ce==null?void 0:Ce.description,page:S,totalPages:R,children:qe})},Ie=()=>{if(!N||!c)return null;const Se=c.component||zat;return f.jsx(Se,{value:I,currentPage:S,totalPages:R,className:c.className})},De=()=>N?f.jsx(L.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsxs("div",{className:"flex justify-between gap-4",children:[f.jsx(bt,{type:"button",variant:"outline",onClick:X,disabled:H||v||x,className:H?"invisible":"",children:i}),f.jsx(bt,{type:"submit",disabled:(!Ce||qe||v||x)&&U,className:"flex-1 max-w-xs",children:x&&U?"Loading...":qe&&U?"Submitting...":U?r:s})]})}}):f.jsx(L.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsx(bt,{type:"submit",disabled:!Ce||qe||v||x,className:"w-full",children:x?"Loading...":qe?"Submitting...":r})}});return f.jsx("form",{onSubmit:ee,className:se,children:W||f.jsxs(f.Fragment,{children:[Ie(),ce(),De()]})})},currentPage:S,totalPages:R,goToNextPage:F,goToPreviousPage:X,setCurrentPage:C,isFirstPage:H,isLastPage:U,progressValue:I}}function Vat({templates:e,onSelect:t}){const[n,r]=T.useState(""),s=e.filter(i=>i.name.toLowerCase().includes(n.toLowerCase())||i.description.toLowerCase().includes(n.toLowerCase())||i.tags.some(a=>a.toLowerCase().includes(n.toLowerCase())));return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(Dt,{htmlFor:"search",children:"Search Templates"}),f.jsx(Cn,{id:"search",placeholder:"Search by name, description, or tags...",value:n,onChange:i=>r(i.target.value)})]}),f.jsx("div",{className:"grid gap-3",children:s.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:n?"No templates match your search.":"No templates available."}):s.map(i=>f.jsxs(Vd,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>t(i),children:[f.jsx(Wd,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx(Hd,{className:"text-sm",children:i.name}),f.jsx(Y1,{className:"text-xs",children:i.description})]}),i.isPublic&&f.jsx(mi,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsx(Gd,{className:"pt-0",children:f.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.tags.map(a=>f.jsx(mi,{variant:"outline",className:"text-xs",children:a},a)),i.variables.length>0&&f.jsxs(mi,{variant:"secondary",className:"text-xs",children:[i.variables.length," variables"]}),i.tools&&i.tools.length>0&&f.jsxs(mi,{variant:"secondary",className:"text-xs",children:[i.tools.length," tools"]}),i.rules&&i.rules.length>0&&f.jsxs(mi,{variant:"secondary",className:"text-xs",children:[i.rules.length," rules"]})]})})]},i.id))})]})}function Wat({template:e,onSubmit:t,onBack:n,previewElementRef:r,onCompile:s}){const i=e.variables.map(l=>({name:l.name,type:l.type==="boolean"?"switch":l.type==="number"?"number":l.type==="array"?"textarea":"text",label:l.name,placeholder:l.default||`Enter ${l.name}`,description:l.description||l.instructions,required:l.required})),a=e.variables.reduce((l,c)=>{if(c.default)if(c.type==="number")l[c.name]=parseFloat(c.default)||0;else if(c.type==="boolean")l[c.name]=c.default.toLowerCase()==="true";else if(c.type==="array")try{l[c.name]=JSON.parse(c.default)}catch{l[c.name]=c.default.split(",").map(u=>u.trim())}else l[c.name]=c.default;return l},{}),{Form:o}=qat({fields:i,submitLabel:"Proompt !",formOptions:{defaultValues:a,onSubmit:async({value:l})=>{t(l)},onChange:async({value:l})=>{await s(l)}}});return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(bt,{variant:"outline",size:"sm",onClick:n,children:" Back"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e.name}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})]}),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-muted-foreground",children:"This template has no variables defined. The template will be applied as-is."}),f.jsx(bt,{onClick:()=>t({}),className:"mt-3",children:"Proompt !"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Dt,{className:"text-sm font-medium mb-4 block",children:"Template Variables"}),f.jsx(o,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(Dt,{className:"text-sm font-medium",children:"Live Preview"}),f.jsx("div",{ref:r,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto",children:e.prompt})]})]})]})}const Hat=({module:e})=>{const[t,n]=T.useState(!1),[r,s]=T.useState(null),i=T.useRef(null),{promptTemplates:a,loadPromptTemplates:o}=eA(yn(h=>({promptTemplates:h.promptTemplates,loadPromptTemplates:h.loadPromptTemplates})));T.useEffect(()=>{t&&o()},[t,o]);const l=h=>{s(h),i.current&&(i.current.textContent=h.prompt)},c=async h=>{if(r)try{await e.applyTemplate(r.id,h),n(!1),s(null),Oe.success("Template applied to input area!")}catch(m){console.error("Failed to Proompt :",m),Oe.error("Failed to Proompt !")}},u=()=>{s(null)},d=async h=>{if(!(!r||!i.current))try{const m=await e.compileTemplate(r.id,h);i.current.textContent=m.content}catch(m){i.current.textContent=`Error: ${m instanceof Error?m.message:"Compilation failed"}`}};return f.jsxs(f.Fragment,{children:[f.jsx(bt,{variant:"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:"Open Prompt Library",children:f.jsx(lpe,{className:"h-4 w-4"})}),f.jsx(Ym,{open:t,onOpenChange:n,children:f.jsxs(Zm,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(Xm,{children:[f.jsx(Jm,{children:r?"Fill Template Variables":"Prompt Library"}),f.jsx(db,{children:r?"Provide values for the template variables below.":"Select a prompt template to use. Templates can include dynamic variables, auto-select tools, and rules."})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:r?f.jsx(Wat,{template:r,onSubmit:c,onBack:u,module:e,previewElementRef:i,onCompile:d}):f.jsx(Vat,{templates:a,onSelect:l})})]})})]})};class Gat{constructor(){ve(this,"id","core-prompt-library");ve(this,"unregisterCallback",null);ve(this,"eventUnsubscribers",[]);ve(this,"notifyComponentUpdate",null);ve(this,"isStreaming",!1);ve(this,"modApiRef",null);ve(this,"getIsStreaming",()=>this.isStreaming);ve(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ve(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=eA.getState();return await r(t,n)});ve(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(Fn.setInputTextRequest,{text:r.content})})}async initialize(t){this.modApiRef=t,this.isStreaming=Bn.getState().status==="streaming";const n=t.on(Zn.statusChanged,r=>{var s;typeof r=="object"&&r&&"status"in r&&this.isStreaming!==(r.status==="streaming")&&(this.isStreaming=r.status==="streaming",(s=this.notifyComponentUpdate)==null||s.call(this))});this.eventUnsubscribers.push(n)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Hat,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Kat=Ke({enableStreamingMarkdown:br(),enableStreamingCodeBlockParsing:br(),foldStreamingCodeBlocks:br(),foldUserMessagesOnCompletion:br(),enableAutoScrollOnStream:br(),streamingRenderFPS:Tt().min(3,"Min 3 FPS").max(60,"Max 60 FPS"),autoScrollInterval:Tt().min(50,"Min 50ms").max(5e3,"Max 5000ms")}),Yat=()=>{const e=yr(yn(s=>({setEnableStreamingMarkdown:s.setEnableStreamingMarkdown,setEnableStreamingCodeBlockParsing:s.setEnableStreamingCodeBlockParsing,setFoldStreamingCodeBlocks:s.setFoldStreamingCodeBlocks,setFoldUserMessagesOnCompletion:s.setFoldUserMessagesOnCompletion,setStreamingRenderFPS:s.setStreamingRenderFPS,setAutoScrollInterval:s.setAutoScrollInterval,setEnableAutoScrollOnStream:s.setEnableAutoScrollOnStream,resetGeneralSettings:s.resetGeneralSettings}))),t=yr(yn(s=>({enableStreamingMarkdown:s.enableStreamingMarkdown,enableStreamingCodeBlockParsing:s.enableStreamingCodeBlockParsing,foldStreamingCodeBlocks:s.foldStreamingCodeBlocks,foldUserMessagesOnCompletion:s.foldUserMessagesOnCompletion,streamingRenderFPS:s.streamingRenderFPS,autoScrollInterval:s.autoScrollInterval,enableAutoScrollOnStream:s.enableAutoScrollOnStream}))),n=ni({defaultValues:{enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3},validators:{onChangeAsync:Kat,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{e.setEnableStreamingMarkdown(s.enableStreamingMarkdown),e.setEnableStreamingCodeBlockParsing(s.enableStreamingCodeBlockParsing),e.setFoldStreamingCodeBlocks(s.foldStreamingCodeBlocks),e.setFoldUserMessagesOnCompletion(s.foldUserMessagesOnCompletion),e.setEnableAutoScrollOnStream(s.enableAutoScrollOnStream),e.setStreamingRenderFPS(s.streamingRenderFPS),e.setAutoScrollInterval(s.autoScrollInterval)}});T.useEffect(()=>{n.reset({enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3})},[t.enableStreamingMarkdown,t.enableStreamingCodeBlockParsing,t.foldStreamingCodeBlocks,t.foldUserMessagesOnCompletion,t.enableAutoScrollOnStream,t.streamingRenderFPS,t.autoScrollInterval,n]);const r=()=>{window.confirm("Are you sure you want to reset Streaming & Display settings to their defaults?")&&e.resetGeneralSettings()};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"p-1 space-y-4",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),f.jsx($p,{form:n,name:"enableStreamingMarkdown",label:"Parse Markdown While Streaming",description:"Render Markdown formatting as the response arrives (may impact performance slightly)."}),f.jsx($p,{form:n,name:"enableStreamingCodeBlockParsing",label:"Use Full Code Blocks While Streaming",description:"Use the syntax-highlighting component for code blocks during streaming."}),f.jsx($p,{form:n,name:"foldStreamingCodeBlocks",label:"Fold Code Blocks by Default During Streaming",description:"Automatically collapse code blocks as they stream in. Useful for long code outputs."}),f.jsx($p,{form:n,name:"foldUserMessagesOnCompletion",label:"Fold User Messages After Response",description:"Automatically collapse the user's prompt message once the assistant finishes responding."}),f.jsx($p,{form:n,name:"enableAutoScrollOnStream",label:"Auto-Scroll While Streaming",description:"Automatically scroll to the bottom as new content arrives."}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(pc,{form:n,name:"streamingRenderFPS",label:"Streaming Update Rate",min:3,max:60,step:1,valueLabelSuffix:" FPS"}),f.jsx(Ay,{form:n,name:"streamingRenderFPS",label:"FPS Input",min:3,max:60,step:1,className:"w-24 h-8 text-xs ml-auto","aria-label":"Streaming Render FPS Value"}),f.jsx("p",{className:Ze("text-sm text-muted-foreground"),children:"Controls how frequently the UI updates during streaming (3-60 FPS)."})]}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(pc,{form:n,name:"autoScrollInterval",label:"Auto-Scroll Interval",min:50,max:5e3,step:50,valueLabelSuffix:" ms",disabled:!n.state.values.enableAutoScrollOnStream}),f.jsx(Ay,{form:n,name:"autoScrollInterval",label:"Interval Input (ms)",min:50,max:5e3,step:50,className:"w-24 h-8 text-xs ml-auto",disabled:!n.state.values.enableAutoScrollOnStream,"aria-label":"Auto Scroll Interval Value"}),f.jsx("p",{className:Ze("text-sm text-muted-foreground"),children:"How often to scroll to the bottom during streaming (50-5000 ms)."})]})]}),f.jsx(Zd,{}),f.jsx("div",{className:"flex items-center justify-between pt-3",children:f.jsx(n.Subscribe,{children:s=>{const i=s.canSubmit,a=s.isSubmitting,o=s.isValidating,l=s.isValid;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(bt,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Changes"}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(i1,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})]})}})})]})},Zat=We.memo(Yat);class Xat{constructor(){ve(this,"id","core-settings-general");ve(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"general",title:"General",component:Zat,order:10})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Jat=({label:e,colorKey:t,value:n,onChange:r})=>{const[s,i]=T.useState(n??"");T.useEffect(()=>{i(n??"")},[n]);const a=()=>{r(t,s.trim()||null)},o=l=>{i(l.target.value)};return f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Dt,{htmlFor:`color-${t}`,className:"text-xs w-28 shrink-0",children:e}),f.jsx(Cn,{id:`color-${t}`,type:"text",value:s,onChange:o,onBlur:a,className:"h-8 text-xs flex-grow",placeholder:"e.g., #ffffff or oklch(0.5 0.2 180)"}),f.jsx(Cn,{type:"color",value:s!=null&&s.startsWith("#")?s:"#000000",onChange:l=>{i(l.target.value),r(t,l.target.value)},className:"h-8 w-10 p-1 border-none cursor-pointer bg-transparent","aria-label":`Pick ${e} color`})]})},Qat=[{label:"Default Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css"},{label:"A11y Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css"},{label:"Atom Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css"},{label:"Atelier Sulphurpool Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-base16-ateliersulphurpool.light.min.css"},{label:"CB",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-cb.min.css"},{label:"Coldark Cold",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-cold.min.css"},{label:"Coldark Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-dark.min.css"},{label:"Coy (No Shadow)",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coy-without-shadows.min.css"},{label:"Darcula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-darcula.min.css"},{label:"Dracula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"},{label:"Duotone Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-dark.min.css"},{label:"Duotone Earth",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-earth.min.css"},{label:"Duotone Forest",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-forest.min.css"},{label:"Duotone Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-light.min.css"},{label:"Duotone Sea",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-sea.min.css"},{label:"Duotone Space",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-space.min.css"},{label:"GH Colors",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css"},{label:"Gruvbox Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-dark.min.css"},{label:"Gruvbox Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-light.min.css"},{label:"Holi",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-holi-theme.min.css"},{label:"Hopscotch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-hopscotch.min.css"},{label:"Lucario",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css"},{label:"Material Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css"},{label:"Material Oceanic",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-oceanic.min.css"},{label:"Night Owl",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-night-owl.min.css"},{label:"Nord",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-nord.min.css"},{label:"One Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-dark.min.css"},{label:"One Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-light.min.css"},{label:"Pojoaque",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-pojoaque.min.css"},{label:"Shades of Purple",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-shades-of-purple.min.css"},{label:"Solarized Dark Atom",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-solarized-dark-atom.min.css"},{label:"Synthwave '84",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-synthwave84.min.css"},{label:"VS",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css"},{label:"VSC Dark Plus",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css"},{label:"Xonokai",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"},{label:"Z-Touch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-z-touch.min.css"}],eot=hl(["system","light","dark","TijuLight","TijuDark","custom"]),tot=Ke({theme:eot,prismThemeUrl:$e(),customFontFamily:$e(),customFontSize:Tt().min(12).max(20),chatMaxWidth:$e(),customThemeColors:gh($e(),$e().nullable())}),not=()=>{const e=yr(yn(a=>({setTheme:a.setTheme,setPrismThemeUrl:a.setPrismThemeUrl,setCustomFontFamily:a.setCustomFontFamily,setCustomFontSize:a.setCustomFontSize,setChatMaxWidth:a.setChatMaxWidth,setCustomThemeColor:a.setCustomThemeColor,resetThemeSettings:a.resetThemeSettings}))),t=yr(yn(a=>({theme:a.theme,prismThemeUrl:a.prismThemeUrl,customFontFamily:a.customFontFamily,customFontSize:a.customFontSize,chatMaxWidth:a.chatMaxWidth,_rawCustomThemeColors:a.customThemeColors}))),n=ni({defaultValues:{theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}},onSubmit:async({value:a})=>{e.setTheme(a.theme),e.setPrismThemeUrl(a.prismThemeUrl||null),e.setCustomFontFamily(a.customFontFamily),e.setCustomFontSize(a.customFontSize),e.setChatMaxWidth(a.chatMaxWidth),a.customThemeColors&&Object.entries(a.customThemeColors).forEach(([o,l])=>{e.setCustomThemeColor(o,l)})},validators:{onChangeAsync:tot,onChangeAsyncDebounceMs:300}});T.useEffect(()=>{n.reset({theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}})},[t.theme,t.prismThemeUrl,t.customFontFamily,t.customFontSize,t.chatMaxWidth,t._rawCustomThemeColors]);const r=()=>{window.confirm("Are you sure you want to reset all Theme settings to their defaults?")&&e.resetThemeSettings()},s=[{value:"max-w-3xl",label:"Very Small"},{value:"max-w-4xl",label:"Small"},{value:"max-w-5xl",label:"Medium"},{value:"max-w-6xl",label:"Large"},{value:"max-w-7xl",label:"Very Large"},{value:"max-w-full",label:"Full Width"}],i=[{key:"background",label:"Background"},{key:"foreground",label:"Foreground"},{key:"card",label:"Card BG"},{key:"cardForeground",label:"Card FG"},{key:"popover",label:"Popover BG"},{key:"popoverForeground",label:"Popover FG"},{key:"primary",label:"Primary"},{key:"primaryForeground",label:"Primary FG"},{key:"secondary",label:"Secondary"},{key:"secondaryForeground",label:"Secondary FG"},{key:"muted",label:"Muted BG"},{key:"mutedForeground",label:"Muted FG"},{key:"accent",label:"Accent"},{key:"accentForeground",label:"Accent FG"},{key:"destructive",label:"Destructive"},{key:"destructiveForeground",label:"Destructive FG"},{key:"border",label:"Border"},{key:"input",label:"Input BG"},{key:"ring",label:"Ring (Focus)"},{key:"sidebar",label:"Sidebar BG"},{key:"sidebarForeground",label:"Sidebar FG"},{key:"sidebarPrimary",label:"Sidebar Primary"},{key:"sidebarPrimaryForeground",label:"Sidebar Primary FG"},{key:"sidebarAccent",label:"Sidebar Accent"},{key:"sidebarAccentForeground",label:"Sidebar Accent FG"},{key:"sidebarBorder",label:"Sidebar Border"},{key:"sidebarRing",label:"Sidebar Ring"},{key:"chart1",label:"Chart 1"},{key:"chart2",label:"Chart 2"},{key:"chart3",label:"Chart 3"},{key:"chart4",label:"Chart 4"},{key:"chart5",label:"Chart 5"}];return f.jsxs("form",{onSubmit:a=>{a.preventDefault(),a.stopPropagation(),n.handleSubmit()},className:"space-y-4 p-1",children:[f.jsx(dx,{title:"Base Theme",description:"Select the overall look and feel.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(Dt,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),f.jsx(Nx,{form:n,name:"theme",label:"Theme",options:[{value:"light",label:"Default Light"},{value:"dark",label:"Default Dark"},{value:"system",label:"System"},{value:"TijuLight",label:"Tiju Light"},{value:"TijuDark",label:"Tiju Dark"},{value:"custom",label:"User Custom"}],triggerClassName:"w-[180px]"})]})}),f.jsxs(dx,{title:"Font & Layout",description:"Customize typography and content width.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsxs("div",{children:[f.jsx(Kw,{form:n,name:"customFontFamily",label:"Custom Font Family",placeholder:"e.g., 'Inter', sans-serif (Leave blank for default)",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies only when 'User Custom' theme is selected. Ensure the font is available (system or web font)."})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(pc,{form:n,name:"customFontSize",label:`Base Font Size (${n.getFieldValue("customFontSize")}px)`,min:12,max:20,step:1,className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Applies only when 'User Custom' theme is selected. Affects base text size (Default: 16px)."})]}),f.jsxs("div",{children:[f.jsx(Nx,{form:n,name:"chatMaxWidth",label:"Chat Content Max Width",options:s,triggerClassName:"w-full mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Controls the maximum width of the main chat message area."})]})]}),f.jsxs(dx,{title:"Code Block Theme",description:"Customize syntax highlighting appearance.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsx(Nx,{form:n,name:"prismThemeUrl",label:"Code Block Theme",options:Qat,triggerClassName:"w-full"}),f.jsx(Kw,{form:n,name:"prismThemeUrl",label:"Or paste custom theme URL here...",placeholder:"Or paste custom theme URL here...",type:"url",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a preset theme or paste a URL to a PrismJS CSS file. Leave blank or select 'Default' to use themes matching light/dark mode."})]}),n.getFieldValue("theme")==="custom"&&f.jsx(dx,{title:"Custom Theme Colors",description:"Define custom colors. Use valid CSS color values (hex, rgb, oklch, etc.). Leave blank to use default light/dark theme colors.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",children:i.map(({key:a,label:o})=>{var l;return f.jsx(Jat,{label:o,colorKey:a,value:(l=n.getFieldValue("customThemeColors"))==null?void 0:l[a],onChange:(c,u)=>n.setFieldValue(`customThemeColors.${c}`,u===null?"":u)},a)})})}),f.jsx(Zd,{}),f.jsxs("div",{className:"flex justify-between pt-3",children:[f.jsxs(bt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(i1,{className:"mr-2 h-4 w-4"}),"Reset Theme Settings"]}),f.jsx(bt,{type:"submit",size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Apply Theme Settings"})]})]})},rot=We.memo(not);class sot{constructor(){ve(this,"id","core-settings-theme");ve(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"theme",title:"Theme",component:rot,order:20})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const iot=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:s,onUpdate:i,fetchStatus:a,isDeleting:o,allAvailableModelsForView:l})=>{var N,I;const[c,u]=T.useState(!0),d=K0(e.type),h=AC(e.type),m=Qp(e.type),y=a==="fetching"||o,b=o||a==="fetching",v=o||a==="fetching",x=T.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),w=e.apiKeyId?t.some(O=>O.id===e.apiKeyId):!1,S=d&&!w,C=T.useCallback(async(O,L)=>{const P=new Set(e.enabledModels??[]);L?P.add(O):P.delete(O);const V=Array.from(P);try{await i(e.id,{enabledModels:V})}catch(F){Oe.error("Failed to update model status."),console.error("Failed to save model toggle:",F)}},[e.enabledModels,e.id,i]),k=()=>u(O=>!O),A=((N=e.enabledModels)==null?void 0:N.length)??0,R=l.length;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{children:f.jsx("span",{className:Ze("h-2.5 w-2.5 rounded-full flex-shrink-0 block",a==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),f.jsx(Sr,{side:"top",children:a==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),f.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),f.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),S&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{children:f.jsx(_c,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),f.jsx(Sr,{side:"top",children:f.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),f.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[f.jsx(On,{tooltipText:"Edit",onClick:n,disabled:b,"aria-label":"Edit provider",icon:f.jsx(s1,{}),className:"h-8 w-8"}),f.jsx(On,{tooltipText:"Delete",onClick:r,disabled:v,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Eo,{})})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[d&&f.jsxs("div",{children:["API Key:"," ",e.apiKeyId?w?f.jsx("span",{className:"text-green-400",children:((I=t.find(O=>O.id===e.apiKeyId))==null?void 0:I.name)||"Linked (Unnamed Key)"}):f.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):f.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),h&&f.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),f.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?f.jsx("span",{className:"text-green-400",children:"Enabled"}):f.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),m&&f.jsx("div",{className:"pt-1",children:f.jsxs(bt,{variant:"outline",size:"sm",onClick:s,disabled:y,className:"text-xs h-7 px-2",children:[a==="fetching"&&f.jsx(Qn,{className:"h-3 w-3 mr-1 animate-spin"}),a==="success"&&f.jsx(ro,{className:"h-3 w-3 mr-1 text-green-500"}),a==="error"&&f.jsx(_c,{className:"h-3 w-3 mr-1 text-destructive"}),a==="idle"&&f.jsx(am,{className:"h-3 w-3 mr-1"}),a==="fetching"?"Fetching...":a==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),f.jsxs("div",{className:"space-y-1 pt-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",A," / ",R," enabled)"]}),f.jsx(On,{tooltipText:c?"Show Models":"Hide Models",onClick:k,"aria-label":c?"Show model list":"Hide model list",icon:c?f.jsx(Nc,{}):f.jsx(Dh,{}),className:"h-6 w-6"})]}),!c&&f.jsx(k5,{providerId:e.id,allAvailableModels:l,enabledModelIds:x,onToggleModel:C,isLoading:a==="fetching",disabled:o,listHeightClass:"h-[26rem]"})]})]})},aot=We.memo(iot),oot=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:s,onCancel:i,onSave:a,onChange:o})=>{const l=T.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),c=T.useCallback((d,h)=>{const m=new Set(t.enabledModels??[]);h?m.add(d):m.delete(d);const y=Array.from(m);o("enabledModels",y)},[t.enabledModels,o]),u=T.useCallback((d,h)=>new Promise(m=>{o(d,h),m(void 0)}),[o]);return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),f.jsx(Aoe,{initialData:t,onChange:u,onSubmit:a,onCancel:i,apiKeys:n,disabled:s})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),f.jsx(k5,{providerId:e,allAvailableModels:r,enabledModelIds:l,onToggleModel:c,disabled:s,listHeightClass:"h-[calc(100%-8rem)]"})]})]})})},lot=We.memo(oot),cot=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:s,fetchStatus:i,onSelectModelForDetails:a})=>{const[o,l]=T.useState(!1),[c,u]=T.useState(!1),[d,h]=T.useState(!1),[m,y]=T.useState({name:"placeholder"}),b=Rr(I=>I.getAllAvailableModelDefsForProvider),[v,x]=T.useState([]),w=T.useMemo(()=>[...b(e.id)].sort((O,L)=>(O.name||O.id).localeCompare(L.name||L.id)),[e.id,b]);T.useEffect(()=>{if(o){const I=b(e.id);x([...I].sort((O,L)=>(O.name||O.id).localeCompare(L.name||L.id))),y({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else x([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,b]);const S=()=>l(!0),C=()=>{l(!1),y({}),u(!1)},k=T.useCallback(async()=>{u(!0);try{const I=m.enabledModels&&m.enabledModels.length>0?m.enabledModels:null,O={name:m.name,type:m.type,isEnabled:m.isEnabled,apiKeyId:m.apiKeyId,baseURL:m.baseURL,autoFetchModels:m.autoFetchModels,enabledModels:I};Object.keys(O).forEach(L=>{O[L]===void 0&&delete O[L]}),await n(e.id,O),l(!1),y({}),Oe.success(`Provider "${O.name||e.name}" updated.`)}catch(I){console.error("Failed to save provider update:",I),Oe.error("Failed to save provider configuration.")}finally{u(!1)}},[m,n,e.id,e.name]),A=T.useCallback((I,O)=>{y(L=>({...L,[I]:O}))},[]),R=T.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){h(!0);try{await r(e.id)}catch(I){console.error("Failed to delete provider:",I),h(!1)}}},[r,e.id,e.name]),N=T.useCallback(async()=>{if(await s(e.id),o){const I=b(e.id);x([...I].sort((O,L)=>(O.name||O.id).localeCompare(L.name||L.id)))}},[s,e.id,o,b]);return f.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?f.jsx(lot,{providerId:e.id,editData:m,apiKeys:t,allAvailableModels:v,isSaving:c,onCancel:C,onSave:k,onChange:A}):f.jsx(aot,{provider:e,apiKeys:t,onEdit:S,onDelete:R,onFetchModels:N,onUpdate:n,fetchStatus:i,isDeleting:d,onSelectModelForDetails:a,allAvailableModelsForView:w})})},uot=We.memo(cot);function dot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return T.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const fA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function pb(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Y5(e){return"nodeType"in e}function $o(e){var t,n;return e?pb(e)?e:Y5(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Z5(e){const{Document:t}=$o(e);return e instanceof t}function l_(e){return pb(e)?!1:e instanceof $o(e).HTMLElement}function cde(e){return e instanceof $o(e).SVGElement}function mb(e){return e?pb(e)?e.document:Y5(e)?Z5(e)?e:l_(e)||cde(e)?e.ownerDocument:document:document:document}const Mu=fA?T.useLayoutEffect:T.useEffect;function X5(e){const t=T.useRef(e);return Mu(()=>{t.current=e}),T.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function fot(){const e=T.useRef(null),t=T.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=T.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Qw(e,t){t===void 0&&(t=[e]);const n=T.useRef(e);return Mu(()=>{n.current!==e&&(n.current=e)},t),n}function c_(e,t){const n=T.useRef();return T.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function nE(e){const t=X5(e),n=T.useRef(null),r=T.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function _O(e){const t=T.useRef();return T.useEffect(()=>{t.current=e},[e]),t.current}let M3={};function u_(e,t){return T.useMemo(()=>{if(t)return t;const n=M3[e]==null?0:M3[e]+1;return M3[e]=n,e+"-"+n},[e,t])}function ude(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=i[l];u!=null&&(i[l]=u+e*c)}return i},{...t})}}const O0=ude(1),e1=ude(-1);function hot(e){return"clientX"in e&&"clientY"in e}function J5(e){if(!e)return!1;const{KeyboardEvent:t}=$o(e.target);return t&&e instanceof t}function pot(e){if(!e)return!1;const{TouchEvent:t}=$o(e.target);return t&&e instanceof t}function SO(e){if(pot(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return hot(e)?{x:e.clientX,y:e.clientY}:null}const t1=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[t1.Translate.toString(e),t1.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),xW="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function mot(e){return e.matches(xW)?e:e.querySelector(xW)}const got={display:"none"};function yot(e){let{id:t,value:n}=e;return We.createElement("div",{id:t,style:got},n)}function bot(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return We.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function vot(){const[e,t]=T.useState("");return{announce:T.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const dde=T.createContext(null);function xot(e){const t=T.useContext(dde);T.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function wot(){const[e]=T.useState(()=>new Set),t=T.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[T.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[e]),t]}const _ot={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Sot={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Cot(e){let{announcements:t=Sot,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=_ot}=e;const{announce:i,announcement:a}=vot(),o=u_("DndLiveRegion"),[l,c]=T.useState(!1);if(T.useEffect(()=>{c(!0)},[]),xot(T.useMemo(()=>({onDragStart(d){let{active:h}=d;i(t.onDragStart({active:h}))},onDragMove(d){let{active:h,over:m}=d;t.onDragMove&&i(t.onDragMove({active:h,over:m}))},onDragOver(d){let{active:h,over:m}=d;i(t.onDragOver({active:h,over:m}))},onDragEnd(d){let{active:h,over:m}=d;i(t.onDragEnd({active:h,over:m}))},onDragCancel(d){let{active:h,over:m}=d;i(t.onDragCancel({active:h,over:m}))}}),[i,t])),!l)return null;const u=We.createElement(We.Fragment,null,We.createElement(yot,{id:r,value:s.draggable}),We.createElement(bot,{id:o,announcement:a}));return n?rl.createPortal(u,n):u}var Li;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Li||(Li={}));function rE(){}function wW(e,t){return T.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function kot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return T.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Rc=Object.freeze({x:0,y:0});function fde(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function hde(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Eot(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function _W(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function pde(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function SW(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Tot=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=SW(t,t.left,t.top),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=fde(SW(l),s);i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(hde)},Aot=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=_W(t),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=_W(l),u=s.reduce((h,m,y)=>h+fde(c[y],m),0),d=Number((u/4).toFixed(4));i.push({id:o,data:{droppableContainer:a,value:d}})}}return i.sort(hde)};function Rot(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,o=i-n;if(r<s&&n<i){const l=t.width*t.height,c=e.width*e.height,u=a*o,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const Not=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,o=n.get(a);if(o){const l=Rot(o,t);l>0&&s.push({id:a,data:{droppableContainer:i,value:l}})}}return s.sort(Eot)};function Mot(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function mde(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Rc}function Iot(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const jot=Iot(1);function Oot(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Pot(e,t,n){const r=Oot(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:o}=r,l=e.left-a-(1-s)*parseFloat(n),c=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const Dot={ignoreTransform:!1};function gb(e,t){t===void 0&&(t=Dot);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=$o(e).getComputedStyle(e);c&&(n=Pot(n,c,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:l}=n;return{top:r,left:s,width:i,height:a,bottom:o,right:l}}function CW(e){return gb(e,{ignoreTransform:!0})}function Fot(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Lot(e,t){return t===void 0&&(t=$o(e).getComputedStyle(e)),t.position==="fixed"}function Bot(e,t){t===void 0&&(t=$o(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function hA(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(Z5(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!l_(s)||cde(s)||n.includes(s))return n;const i=$o(e).getComputedStyle(s);return s!==e&&Bot(s,i)&&n.push(s),Lot(s,i)?n:r(s.parentNode)}return e?r(e):n}function gde(e){const[t]=hA(e,1);return t??null}function I3(e){return!fA||!e?null:pb(e)?e:Y5(e)?Z5(e)||e===mb(e).scrollingElement?window:l_(e)?e:null:null}function yde(e){return pb(e)?e.scrollX:e.scrollLeft}function bde(e){return pb(e)?e.scrollY:e.scrollTop}function CO(e){return{x:yde(e),y:bde(e)}}var na;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(na||(na={}));function vde(e){return!fA||!e?!1:e===document.scrollingElement}function xde(e){const t={x:0,y:0},n=vde(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const $ot={x:.2,y:.2};function zot(e,t,n,r,s){let{top:i,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),s===void 0&&(s=$ot);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=xde(e),m={x:0,y:0},y={x:0,y:0},b={height:t.height*s.y,width:t.width*s.x};return!c&&i<=t.top+b.height?(m.y=na.Backward,y.y=r*Math.abs((t.top+b.height-i)/b.height)):!u&&l>=t.bottom-b.height&&(m.y=na.Forward,y.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!h&&o>=t.right-b.width?(m.x=na.Forward,y.x=r*Math.abs((t.right-b.width-o)/b.width)):!d&&a<=t.left+b.width&&(m.x=na.Backward,y.x=r*Math.abs((t.left+b.width-a)/b.width)),{direction:m,speed:y}}function Uot(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function wde(e){return e.reduce((t,n)=>O0(t,CO(n)),Rc)}function qot(e){return e.reduce((t,n)=>t+yde(n),0)}function Vot(e){return e.reduce((t,n)=>t+bde(n),0)}function Wot(e,t){if(t===void 0&&(t=gb),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);gde(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Hot=[["x",["left","right"],qot],["y",["top","bottom"],Vot]];class Q5{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=hA(n),s=wde(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,o]of Hot)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=s[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ix{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Got(e){const{EventTarget:t}=$o(e);return e instanceof t?e:mb(e)}function j3(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Fl;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Fl||(Fl={}));function kW(e){e.preventDefault()}function Kot(e){e.stopPropagation()}var Vr;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Vr||(Vr={}));const _de={start:[Vr.Space,Vr.Enter],cancel:[Vr.Esc],end:[Vr.Space,Vr.Enter,Vr.Tab]},Yot=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Vr.Right:return{...n,x:n.x+25};case Vr.Left:return{...n,x:n.x-25};case Vr.Down:return{...n,y:n.y+25};case Vr.Up:return{...n,y:n.y-25}}};class eF{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Ix(mb(n)),this.windowListeners=new Ix($o(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Fl.Resize,this.handleCancel),this.windowListeners.add(Fl.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Fl.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Wot(r),n(Rc)}handleKeyDown(t){if(J5(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=_de,coordinateGetter:a=Yot,scrollBehavior:o="smooth"}=s,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:Rc;this.referenceCoordinates||(this.referenceCoordinates=u);const d=a(t,{active:n,context:r.current,currentCoordinates:u});if(d){const h=e1(d,u),m={x:0,y:0},{scrollableAncestors:y}=r.current;for(const b of y){const v=t.code,{isTop:x,isRight:w,isLeft:S,isBottom:C,maxScroll:k,minScroll:A}=xde(b),R=Uot(b),N={x:Math.min(v===Vr.Right?R.right-R.width/2:R.right,Math.max(v===Vr.Right?R.left:R.left+R.width/2,d.x)),y:Math.min(v===Vr.Down?R.bottom-R.height/2:R.bottom,Math.max(v===Vr.Down?R.top:R.top+R.height/2,d.y))},I=v===Vr.Right&&!w||v===Vr.Left&&!S,O=v===Vr.Down&&!C||v===Vr.Up&&!x;if(I&&N.x!==d.x){const L=b.scrollLeft+h.x,P=v===Vr.Right&&L<=k.x||v===Vr.Left&&L>=A.x;if(P&&!h.y){b.scrollTo({left:L,behavior:o});return}P?m.x=b.scrollLeft-L:m.x=v===Vr.Right?b.scrollLeft-k.x:b.scrollLeft-A.x,m.x&&b.scrollBy({left:-m.x,behavior:o});break}else if(O&&N.y!==d.y){const L=b.scrollTop+h.y,P=v===Vr.Down&&L<=k.y||v===Vr.Up&&L>=A.y;if(P&&!h.x){b.scrollTo({top:L,behavior:o});return}P?m.y=b.scrollTop-L:m.y=v===Vr.Down?b.scrollTop-k.y:b.scrollTop-A.y,m.y&&b.scrollBy({top:-m.y,behavior:o});break}}this.handleMove(t,O0(e1(d,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}eF.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=_de,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function EW(e){return!!(e&&"distance"in e)}function TW(e){return!!(e&&"delay"in e)}class tF{constructor(t,n,r){var s;r===void 0&&(r=Got(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=mb(a),this.documentListeners=new Ix(this.document),this.listeners=new Ix(r),this.windowListeners=new Ix($o(a)),this.initialCoordinates=(s=SO(i))!=null?s:Rc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Fl.Resize,this.handleCancel),this.windowListeners.add(Fl.DragStart,kW),this.windowListeners.add(Fl.VisibilityChange,this.handleCancel),this.windowListeners.add(Fl.ContextMenu,kW),this.documentListeners.add(Fl.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(TW(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(EW(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Fl.Click,Kot,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Fl.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const l=(n=SO(t))!=null?n:Rc,c=e1(s,l);if(!r&&o){if(EW(o)){if(o.tolerance!=null&&j3(c,o.tolerance))return this.handleCancel();if(j3(c,o.distance))return this.handleStart()}if(TW(o)&&j3(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Vr.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Zot={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class nF extends tF{constructor(t){const{event:n}=t,r=mb(n.target);super(t,Zot,r)}}nF.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Xot={move:{name:"mousemove"},end:{name:"mouseup"}};var kO;(function(e){e[e.RightClick=2]="RightClick"})(kO||(kO={}));class Jot extends tF{constructor(t){super(t,Xot,mb(t.event.target))}}Jot.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===kO.RightClick?!1:(r==null||r({event:n}),!0)}}];const O3={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Qot extends tF{constructor(t){super(t,O3)}static setup(){return window.addEventListener(O3.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(O3.move.name,t)};function t(){}}}Qot.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var jx;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(jx||(jx={}));var sE;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(sE||(sE={}));function elt(e){let{acceleration:t,activator:n=jx.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=sE.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=e;const m=nlt({delta:d,disabled:!i}),[y,b]=fot(),v=T.useRef({x:0,y:0}),x=T.useRef({x:0,y:0}),w=T.useMemo(()=>{switch(n){case jx.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case jx.DraggableRect:return s}},[n,s,l]),S=T.useRef(null),C=T.useCallback(()=>{const A=S.current;if(!A)return;const R=v.current.x*x.current.x,N=v.current.y*x.current.y;A.scrollBy(R,N)},[]),k=T.useMemo(()=>o===sE.TreeOrder?[...c].reverse():c,[o,c]);T.useEffect(()=>{if(!i||!c.length||!w){b();return}for(const A of k){if((r==null?void 0:r(A))===!1)continue;const R=c.indexOf(A),N=u[R];if(!N)continue;const{direction:I,speed:O}=zot(A,N,w,t,h);for(const L of["x","y"])m[L][I[L]]||(O[L]=0,I[L]=0);if(O.x>0||O.y>0){b(),S.current=A,y(C,a),v.current=O,x.current=I;return}}v.current={x:0,y:0},x.current={x:0,y:0},b()},[t,C,r,b,i,a,JSON.stringify(w),JSON.stringify(m),y,c,k,u,JSON.stringify(h)])}const tlt={x:{[na.Backward]:!1,[na.Forward]:!1},y:{[na.Backward]:!1,[na.Forward]:!1}};function nlt(e){let{delta:t,disabled:n}=e;const r=_O(t);return c_(s=>{if(n||!r||!s)return tlt;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[na.Backward]:s.x[na.Backward]||i.x===-1,[na.Forward]:s.x[na.Forward]||i.x===1},y:{[na.Backward]:s.y[na.Backward]||i.y===-1,[na.Forward]:s.y[na.Forward]||i.y===1}}},[n,t,r])}function rlt(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return c_(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function slt(e,t){return T.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var n1;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(n1||(n1={}));var EO;(function(e){e.Optimized="optimized"})(EO||(EO={}));const AW=new Map;function ilt(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=T.useState(null),{frequency:o,measure:l,strategy:c}=s,u=T.useRef(e),d=v(),h=Qw(d),m=T.useCallback(function(x){x===void 0&&(x=[]),!h.current&&a(w=>w===null?x:w.concat(x.filter(S=>!w.includes(S))))},[h]),y=T.useRef(null),b=c_(x=>{if(d&&!n)return AW;if(!x||x===AW||u.current!==e||i!=null){const w=new Map;for(let S of e){if(!S)continue;if(i&&i.length>0&&!i.includes(S.id)&&S.rect.current){w.set(S.id,S.rect.current);continue}const C=S.node.current,k=C?new Q5(l(C),C):null;S.rect.current=k,k&&w.set(S.id,k)}return w}return x},[e,i,n,d,l]);return T.useEffect(()=>{u.current=e},[e]),T.useEffect(()=>{d||m()},[n,d]),T.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),T.useEffect(()=>{d||typeof o!="number"||y.current!==null||(y.current=setTimeout(()=>{m(),y.current=null},o))},[o,d,m,...r]),{droppableRects:b,measureDroppableContainers:m,measuringScheduled:i!=null};function v(){switch(c){case n1.Always:return!1;case n1.BeforeDragging:return n;default:return!n}}}function Sde(e,t){return c_(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function alt(e,t){return Sde(e,t)}function olt(e){let{callback:t,disabled:n}=e;const r=X5(t),s=T.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return T.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function pA(e){let{callback:t,disabled:n}=e;const r=X5(t),s=T.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return T.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function llt(e){return new Q5(gb(e),e)}function RW(e,t,n){t===void 0&&(t=llt);const[r,s]=T.useState(null);function i(){s(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=t(e);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=olt({callback(l){if(e)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(e)){i();break}}}}),o=pA({callback:i});return Mu(()=>{i(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function clt(e){const t=Sde(e);return mde(e,t)}const NW=[];function ult(e){const t=T.useRef(e),n=c_(r=>e?r&&r!==NW&&e&&t.current&&e.parentNode===t.current.parentNode?r:hA(e):NW,[e]);return T.useEffect(()=>{t.current=e},[e]),n}function dlt(e){const[t,n]=T.useState(null),r=T.useRef(e),s=T.useCallback(i=>{const a=I3(i.target);a&&n(o=>o?(o.set(a,CO(a)),new Map(o)):null)},[]);return T.useEffect(()=>{const i=r.current;if(e!==i){a(i);const o=e.map(l=>{const c=I3(l);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,CO(c)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(i)};function a(o){o.forEach(l=>{const c=I3(l);c==null||c.removeEventListener("scroll",s)})}},[s,e]),T.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>O0(i,a),Rc):wde(e):Rc,[e,t])}function MW(e,t){t===void 0&&(t=[]);const n=T.useRef(null);return T.useEffect(()=>{n.current=null},t),T.useEffect(()=>{const r=e!==Rc;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?e1(e,n.current):Rc}function flt(e){T.useEffect(()=>{if(!fA)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function hlt(e,t){return T.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function Cde(e){return T.useMemo(()=>e?Fot(e):null,[e])}const IW=[];function plt(e,t){t===void 0&&(t=gb);const[n]=e,r=Cde(n?$o(n):null),[s,i]=T.useState(IW);function a(){i(()=>e.length?e.map(l=>vde(l)?r:new Q5(t(l),l)):IW)}const o=pA({callback:a});return Mu(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),s}function mlt(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return l_(t)?t:e}function glt(e){let{measure:t}=e;const[n,r]=T.useState(null),s=T.useCallback(c=>{for(const{target:u}of c)if(l_(u)){r(d=>{const h=t(u);return d?{...d,width:h.width,height:h.height}:h});break}},[t]),i=pA({callback:s}),a=T.useCallback(c=>{const u=mlt(c);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[o,l]=nE(a);return T.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const ylt=[{sensor:nF,options:{}},{sensor:eF,options:{}}],blt={current:{}},X2={draggable:{measure:CW},droppable:{measure:CW,strategy:n1.WhileDragging,frequency:EO.Optimized},dragOverlay:{measure:gb}};class Ox extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const vlt={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ox,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:rE},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:X2,measureDroppableContainers:rE,windowRect:null,measuringScheduled:!1},xlt={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:rE,draggableNodes:new Map,over:null,measureDroppableContainers:rE},mA=T.createContext(xlt),kde=T.createContext(vlt);function wlt(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ox}}}function _lt(e,t){switch(t.type){case Li.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Li.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Li.DragEnd:case Li.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Li.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Ox(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case Li.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Ox(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case Li.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Ox(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Slt(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=T.useContext(mA),i=_O(r),a=_O(n==null?void 0:n.id);return T.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!J5(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=mot(u);if(d){d.focus();break}}})}},[r,t,s,a,i]),null}function Clt(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function klt(e){return T.useMemo(()=>({draggable:{...X2.draggable,...e==null?void 0:e.draggable},droppable:{...X2.droppable,...e==null?void 0:e.droppable},dragOverlay:{...X2.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Elt(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=T.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Mu(()=>{if(!a&&!o||!t){i.current=!1;return}if(i.current||!r)return;const c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;const u=n(c),d=mde(u,r);if(a||(d.x=0),o||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=gde(c);h&&h.scrollBy({top:d.y,left:d.x})}},[t,a,o,r,n])}const Ede=T.createContext({...Rc,scaleX:1,scaleY:1});var sh;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(sh||(sh={}));const Tlt=T.memo(function(t){var n,r,s,i;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=ylt,collisionDetection:d=Not,measuring:h,modifiers:m,...y}=t;const b=T.useReducer(_lt,void 0,wlt),[v,x]=b,[w,S]=wot(),[C,k]=T.useState(sh.Uninitialized),A=C===sh.Initialized,{draggable:{active:R,nodes:N,translate:I},droppable:{containers:O}}=v,L=R!=null?N.get(R):null,P=T.useRef({initial:null,translated:null}),V=T.useMemo(()=>{var st;return R!=null?{id:R,data:(st=L==null?void 0:L.data)!=null?st:blt,rect:P}:null},[R,L]),F=T.useRef(null),[X,U]=T.useState(null),[H,$]=T.useState(null),ne=Qw(y,Object.values(y)),W=u_("DndDescribedBy",a),Q=T.useMemo(()=>O.getEnabled(),[O]),ee=klt(h),{droppableRects:se,measureDroppableContainers:pe,measuringScheduled:ce}=ilt(Q,{dragging:A,dependencies:[I.x,I.y],config:ee.droppable}),Ie=rlt(N,R),De=T.useMemo(()=>H?SO(H):null,[H]),Se=ze(),Ce=alt(Ie,ee.draggable.measure);Elt({activeNode:R!=null?N.get(R):null,config:Se.layoutShiftCompensation,initialRect:Ce,measure:ee.draggable.measure});const qe=RW(Ie,ee.draggable.measure,Ce),Qe=RW(Ie?Ie.parentElement:null),Ve=T.useRef({activatorEvent:null,active:null,activeNode:Ie,collisionRect:null,collisions:null,droppableRects:se,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ne=O.getNodeFor((n=Ve.current.over)==null?void 0:n.id),K=glt({measure:ee.dragOverlay.measure}),me=(r=K.nodeRef.current)!=null?r:Ie,Ae=A?(s=K.rect)!=null?s:qe:null,le=!!(K.nodeRef.current&&K.rect),oe=clt(le?null:qe),re=Cde(me?$o(me):null),Te=ult(A?Ne??Ie:null),Be=plt(Te),ke=Clt(m,{transform:{x:I.x-oe.x,y:I.y-oe.y,scaleX:1,scaleY:1},activatorEvent:H,active:V,activeNodeRect:qe,containerNodeRect:Qe,draggingNodeRect:Ae,over:Ve.current.over,overlayNodeRect:K.rect,scrollableAncestors:Te,scrollableAncestorRects:Be,windowRect:re}),lt=De?O0(De,I):null,Rt=dlt(Te),ft=MW(Rt),jt=MW(Rt,[qe]),qt=O0(ke,ft),Lt=Ae?jot(Ae,ke):null,en=V&&Lt?d({active:V,collisionRect:Lt,droppableRects:se,droppableContainers:Q,pointerCoordinates:lt}):null,xe=pde(en,"id"),[D,Z]=T.useState(null),ge=le?ke:O0(ke,jt),Fe=Mot(ge,(i=D==null?void 0:D.rect)!=null?i:null,qe),we=T.useRef(null),Me=T.useCallback((st,ye)=>{let{sensor:_e,options:Ue}=ye;if(F.current==null)return;const kt=N.get(F.current);if(!kt)return;const fe=st.nativeEvent,Y=new _e({active:F.current,activeNode:kt,event:fe,options:Ue,context:Ve,onAbort(J){if(!N.get(J))return;const{onDragAbort:Pe}=ne.current,Ge={id:J};Pe==null||Pe(Ge),w({type:"onDragAbort",event:Ge})},onPending(J,be,Pe,Ge){if(!N.get(J))return;const{onDragPending:tn}=ne.current,Un={id:J,constraint:be,initialCoordinates:Pe,offset:Ge};tn==null||tn(Un),w({type:"onDragPending",event:Un})},onStart(J){const be=F.current;if(be==null)return;const Pe=N.get(be);if(!Pe)return;const{onDragStart:Ge}=ne.current,_t={activatorEvent:fe,active:{id:be,data:Pe.data,rect:P}};rl.unstable_batchedUpdates(()=>{Ge==null||Ge(_t),k(sh.Initializing),x({type:Li.DragStart,initialCoordinates:J,active:be}),w({type:"onDragStart",event:_t}),U(we.current),$(fe)})},onMove(J){x({type:Li.DragMove,coordinates:J})},onEnd:G(Li.DragEnd),onCancel:G(Li.DragCancel)});we.current=Y;function G(J){return async function(){const{active:Pe,collisions:Ge,over:_t,scrollAdjustedTranslate:tn}=Ve.current;let Un=null;if(Pe&&tn){const{cancelDrop:Xt}=ne.current;Un={activatorEvent:fe,active:Pe,collisions:Ge,delta:tn,over:_t},J===Li.DragEnd&&typeof Xt=="function"&&await Promise.resolve(Xt(Un))&&(J=Li.DragCancel)}F.current=null,rl.unstable_batchedUpdates(()=>{x({type:J}),k(sh.Uninitialized),Z(null),U(null),$(null),we.current=null;const Xt=J===Li.DragEnd?"onDragEnd":"onDragCancel";if(Un){const nn=ne.current[Xt];nn==null||nn(Un),w({type:Xt,event:Un})}})}}},[N]),de=T.useCallback((st,ye)=>(_e,Ue)=>{const kt=_e.nativeEvent,fe=N.get(Ue);if(F.current!==null||!fe||kt.dndKit||kt.defaultPrevented)return;const Y={active:fe};st(_e,ye.options,Y)===!0&&(kt.dndKit={capturedBy:ye.sensor},F.current=Ue,Me(_e,ye))},[N,Me]),vt=slt(u,de);flt(u),Mu(()=>{qe&&C===sh.Initializing&&k(sh.Initialized)},[qe,C]),T.useEffect(()=>{const{onDragMove:st}=ne.current,{active:ye,activatorEvent:_e,collisions:Ue,over:kt}=Ve.current;if(!ye||!_e)return;const fe={active:ye,activatorEvent:_e,collisions:Ue,delta:{x:qt.x,y:qt.y},over:kt};rl.unstable_batchedUpdates(()=>{st==null||st(fe),w({type:"onDragMove",event:fe})})},[qt.x,qt.y]),T.useEffect(()=>{const{active:st,activatorEvent:ye,collisions:_e,droppableContainers:Ue,scrollAdjustedTranslate:kt}=Ve.current;if(!st||F.current==null||!ye||!kt)return;const{onDragOver:fe}=ne.current,Y=Ue.get(xe),G=Y&&Y.rect.current?{id:Y.id,rect:Y.rect.current,data:Y.data,disabled:Y.disabled}:null,J={active:st,activatorEvent:ye,collisions:_e,delta:{x:kt.x,y:kt.y},over:G};rl.unstable_batchedUpdates(()=>{Z(G),fe==null||fe(J),w({type:"onDragOver",event:J})})},[xe]),Mu(()=>{Ve.current={activatorEvent:H,active:V,activeNode:Ie,collisionRect:Lt,collisions:en,droppableRects:se,draggableNodes:N,draggingNode:me,draggingNodeRect:Ae,droppableContainers:O,over:D,scrollableAncestors:Te,scrollAdjustedTranslate:qt},P.current={initial:Ae,translated:Lt}},[V,Ie,en,Lt,N,me,Ae,se,O,D,Te,qt]),elt({...Se,delta:I,draggingRect:Lt,pointerCoordinates:lt,scrollableAncestors:Te,scrollableAncestorRects:Be});const ot=T.useMemo(()=>({active:V,activeNode:Ie,activeNodeRect:qe,activatorEvent:H,collisions:en,containerNodeRect:Qe,dragOverlay:K,draggableNodes:N,droppableContainers:O,droppableRects:se,over:D,measureDroppableContainers:pe,scrollableAncestors:Te,scrollableAncestorRects:Be,measuringConfiguration:ee,measuringScheduled:ce,windowRect:re}),[V,Ie,qe,H,en,Qe,K,N,O,se,D,pe,Te,Be,ee,ce,re]),B=T.useMemo(()=>({activatorEvent:H,activators:vt,active:V,activeNodeRect:qe,ariaDescribedById:{draggable:W},dispatch:x,draggableNodes:N,over:D,measureDroppableContainers:pe}),[H,vt,V,qe,x,W,N,D,pe]);return We.createElement(dde.Provider,{value:S},We.createElement(mA.Provider,{value:B},We.createElement(kde.Provider,{value:ot},We.createElement(Ede.Provider,{value:Fe},c)),We.createElement(Slt,{disabled:(o==null?void 0:o.restoreFocus)===!1})),We.createElement(Cot,{...o,hiddenTextDescribedById:W}));function ze(){const st=(X==null?void 0:X.autoScrollEnabled)===!1,ye=typeof l=="object"?l.enabled===!1:l===!1,_e=A&&!st&&!ye;return typeof l=="object"?{...l,enabled:_e}:{enabled:_e}}}),Alt=T.createContext(null),jW="button",Rlt="Draggable";function Nlt(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=u_(Rlt),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=T.useContext(mA),{role:m=jW,roleDescription:y="draggable",tabIndex:b=0}=s??{},v=(l==null?void 0:l.id)===t,x=T.useContext(v?Ede:Alt),[w,S]=nE(),[C,k]=nE(),A=hlt(a,t),R=Qw(n);Mu(()=>(d.set(t,{id:t,key:i,node:w,activatorNode:C,data:R}),()=>{const I=d.get(t);I&&I.key===i&&d.delete(t)}),[d,t]);const N=T.useMemo(()=>({role:m,tabIndex:b,"aria-disabled":r,"aria-pressed":v&&m===jW?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[r,m,b,v,y,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:N,isDragging:v,listeners:r?void 0:A,node:w,over:h,setNodeRef:S,setActivatorNodeRef:k,transform:x}}function Mlt(){return T.useContext(kde)}const Ilt="Droppable",jlt={timeout:25};function Olt(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=u_(Ilt),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=T.useContext(mA),u=T.useRef({disabled:n}),d=T.useRef(!1),h=T.useRef(null),m=T.useRef(null),{disabled:y,updateMeasurementsFor:b,timeout:v}={...jlt,...s},x=Qw(b??r),w=T.useCallback(()=>{if(!d.current){d.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(x.current)?x.current:[x.current]),m.current=null},v)},[v]),S=pA({callback:w,disabled:y||!a}),C=T.useCallback((N,I)=>{S&&(I&&(S.unobserve(I),d.current=!1),N&&S.observe(N))},[S]),[k,A]=nE(C),R=Qw(t);return T.useEffect(()=>{!S||!k.current||(S.disconnect(),d.current=!1,S.observe(k.current))},[k,S]),T.useEffect(()=>(o({type:Li.RegisterDroppable,element:{id:r,key:i,disabled:n,node:k,rect:h,data:R}}),()=>o({type:Li.UnregisterDroppable,key:i,id:r})),[r]),T.useEffect(()=>{n!==u.current.disabled&&(o({type:Li.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,o]),{active:a,rect:h,isOver:(l==null?void 0:l.id)===r,node:k,over:l,setNodeRef:A}}function Px(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Plt(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function y2(e){return e!==null&&e>=0}function Dlt(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Flt(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Tde=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=Px(t,r,n),a=t[s],o=i[s];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},b2={scaleX:1,scaleY:1},Llt=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(s===n){const c=i[a];return c?{x:0,y:n<a?c.top+c.height-(o.top+o.height):c.top-o.top,...b2}:null}const l=Blt(i,s,n);return s>n&&s<=a?{x:0,y:-o.height-l,...b2}:s<n&&s>=a?{x:0,y:o.height+l,...b2}:{x:0,y:0,...b2}};function Blt(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const Ade="Sortable",Rde=We.createContext({activeIndex:-1,containerId:Ade,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Tde,disabled:{draggable:!1,droppable:!1}});function $lt(e){let{children:t,id:n,items:r,strategy:s=Tde,disabled:i=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:c,measureDroppableContainers:u}=Mlt(),d=u_(Ade,n),h=o.rect!==null,m=T.useMemo(()=>r.map(A=>typeof A=="object"&&"id"in A?A.id:A),[r]),y=a!=null,b=a?m.indexOf(a.id):-1,v=c?m.indexOf(c.id):-1,x=T.useRef(m),w=!Dlt(m,x.current),S=v!==-1&&b===-1||w,C=Flt(i);Mu(()=>{w&&y&&u(m)},[w,m,y,u]),T.useEffect(()=>{x.current=m},[m]);const k=T.useMemo(()=>({activeIndex:b,containerId:d,disabled:C,disableTransforms:S,items:m,overIndex:v,useDragOverlay:h,sortedRects:Plt(m,l),strategy:s}),[b,d,C.draggable,C.droppable,S,m,v,l,h,s]);return We.createElement(Rde.Provider,{value:k},t)}const zlt=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Px(n,r,s).indexOf(t)},Ult=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!c||!r||o!==i&&s===a?!1:n?!0:a!==s&&t===l},qlt={duration:200,easing:"ease"},Nde="transform",Vlt=t1.Transition.toString({property:Nde,duration:0,easing:"linear"}),Wlt={roleDescription:"sortable"};function Hlt(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=T.useState(null),o=T.useRef(n);return Mu(()=>{if(!t&&n!==o.current&&r.current){const l=s.current;if(l){const c=gb(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,s]),T.useEffect(()=>{i&&a(null)},[i]),i}function Glt(e){let{animateLayoutChanges:t=Ult,attributes:n,disabled:r,data:s,getNewIndex:i=zlt,id:a,strategy:o,resizeObserverConfig:l,transition:c=qlt}=e;const{items:u,containerId:d,activeIndex:h,disabled:m,disableTransforms:y,sortedRects:b,overIndex:v,useDragOverlay:x,strategy:w}=T.useContext(Rde),S=Klt(r,m),C=u.indexOf(a),k=T.useMemo(()=>({sortable:{containerId:d,index:C,items:u},...s}),[d,s,C,u]),A=T.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:R,node:N,isOver:I,setNodeRef:O}=Olt({id:a,data:k,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:A,...l}}),{active:L,activatorEvent:P,activeNodeRect:V,attributes:F,setNodeRef:X,listeners:U,isDragging:H,over:$,setActivatorNodeRef:ne,transform:W}=Nlt({id:a,data:k,attributes:{...Wlt,...n},disabled:S.draggable}),Q=dot(O,X),ee=!!L,se=ee&&!y&&y2(h)&&y2(v),pe=!x&&H,ce=pe&&se?W:null,De=se?ce??(o??w)({rects:b,activeNodeRect:V,activeIndex:h,overIndex:v,index:C}):null,Se=y2(h)&&y2(v)?i({id:a,items:u,activeIndex:h,overIndex:v}):C,Ce=L==null?void 0:L.id,qe=T.useRef({activeId:Ce,items:u,newIndex:Se,containerId:d}),Qe=u!==qe.current.items,Ve=t({active:L,containerId:d,isDragging:H,isSorting:ee,id:a,index:C,items:u,newIndex:qe.current.newIndex,previousItems:qe.current.items,previousContainerId:qe.current.containerId,transition:c,wasDragging:qe.current.activeId!=null}),Ne=Hlt({disabled:!Ve,index:C,node:N,rect:R});return T.useEffect(()=>{ee&&qe.current.newIndex!==Se&&(qe.current.newIndex=Se),d!==qe.current.containerId&&(qe.current.containerId=d),u!==qe.current.items&&(qe.current.items=u)},[ee,Se,d,u]),T.useEffect(()=>{if(Ce===qe.current.activeId)return;if(Ce!=null&&qe.current.activeId==null){qe.current.activeId=Ce;return}const me=setTimeout(()=>{qe.current.activeId=Ce},50);return()=>clearTimeout(me)},[Ce]),{active:L,activeIndex:h,attributes:F,data:k,rect:R,index:C,newIndex:Se,items:u,isOver:I,isSorting:ee,isDragging:H,listeners:U,node:N,overIndex:v,over:$,setNodeRef:Q,setActivatorNodeRef:ne,setDroppableNodeRef:O,setDraggableNodeRef:X,transform:Ne??De,transition:K()};function K(){if(Ne||Qe&&qe.current.newIndex===C)return Vlt;if(!(pe&&!J5(P)||!c)&&(ee||Ve))return t1.Transition.toString({...c,property:Nde})}}function Klt(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function iE(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Ylt=[Vr.Down,Vr.Right,Vr.Up,Vr.Left],Zlt=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:o}}=t;if(Ylt.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];i.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const h=s.get(d.id);if(h)switch(e.code){case Vr.Down:r.top<h.top&&l.push(d);break;case Vr.Up:r.top>h.top&&l.push(d);break;case Vr.Left:r.left>h.left&&l.push(d);break;case Vr.Right:r.left<h.left&&l.push(d);break}});const c=Aot({collisionRect:r,droppableRects:s,droppableContainers:l});let u=pde(c,"id");if(u===(a==null?void 0:a.id)&&c.length>1&&(u=c[1].id),u!=null){const d=i.get(n.id),h=i.get(u),m=h?s.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&m&&d&&h){const v=hA(y).some((A,R)=>o[R]!==A),x=Mde(d,h),w=Xlt(d,h),S=v||!x?{x:0,y:0}:{x:w?r.width-m.width:0,y:w?r.height-m.height:0},C={x:m.left,y:m.top};return S.x&&S.y?C:e1(C,S)}}}};function Mde(e,t){return!iE(e)||!iE(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Xlt(e,t){return!iE(e)||!iE(t)||!Mde(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Jlt=({id:e,modelDetails:t,buttonsDisabled:n,onMoveToTop:r,onMoveUp:s,onMoveDown:i,isFirst:a,isLast:o})=>{var k,A,R;const{attributes:l,listeners:c,setNodeRef:u,transform:d,transition:h,isDragging:m}=Glt({id:e,disabled:!1}),y={transform:t1.Transform.toString(d),transition:h,zIndex:m?10:void 0},b=new Set(((k=t.metadataSummary)==null?void 0:k.supported_parameters)??[]),v=new Set(((A=t.metadataSummary)==null?void 0:A.input_modalities)??[]),x=b.has("reasoning"),w=b.has("web_search")||b.has("web_search_options"),S=b.has("tools"),C=Array.from(v).some(N=>N!=="text");return f.jsxs("div",{ref:u,style:y,className:Ze("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",m&&"shadow-lg border-primary bg-card","cursor-grab active:cursor-grabbing"),"aria-label":`Drag to reorder model ${t.name}`,children:[f.jsx("button",{...l,...c,type:"button",className:Ze("p-1 flex-shrink-0","hover:text-foreground"),"aria-hidden":"true",tabIndex:-1,children:f.jsx(Sme,{className:"h-5 w-5 text-muted-foreground"})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs(Dt,{className:Ze("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:[t.name," ",f.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[x&&f.jsx(Ph,{className:"h-3 w-3 text-blue-500"}),w&&f.jsx(Fa,{className:"h-3 w-3 text-green-500"}),S&&f.jsx(om,{className:"h-3 w-3 text-orange-500"}),C&&f.jsx(im,{className:"h-3 w-3 text-purple-500"})]})]}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto flex-shrink-0",children:[((R=t.metadataSummary)==null?void 0:R.description)&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"p-1 text-muted-foreground hover:text-foreground cursor-default","aria-label":"Model information",children:f.jsx(OO,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",align:"end",className:"max-w-xs break-words",children:f.jsx("p",{children:t.metadataSummary.description})})]})}),f.jsx(On,{tooltipText:"Move to Top",onClick:()=>r(e),disabled:a||n,icon:f.jsx(_pe,{}),className:"h-6 w-6"}),f.jsx(On,{tooltipText:"Move Up",onClick:()=>s(e),disabled:a||n,icon:f.jsx(spe,{}),className:"h-6 w-6"}),f.jsx(On,{tooltipText:"Move Down",onClick:()=>i(e),disabled:o||n,icon:f.jsx(sH,{}),className:"h-6 w-6"})]})]})},Qlt=({setGlobalModelSortOrderFromModule:e})=>{const{dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAvailableModelListItems:s}=Rr(yn(I=>({dbProviderConfigs:I.dbProviderConfigs,globalModelSortOrder:I.globalModelSortOrder,isLoading:I.isLoading,getAvailableModelListItems:I.getAvailableModelListItems}))),[i,a]=T.useState(""),[o,l]=T.useState(!1),[c,u]=T.useState(()=>new Set(t.map(I=>I.id))),[d,h]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1});T.useEffect(()=>{u(new Set(t.map(I=>I.id)))},[t]);const m=T.useMemo(()=>{const I=s(),O=new Map(I.map(X=>[X.id,X])),L=new Set;t.forEach(X=>{X.isEnabled&&X.enabledModels&&X.enabledModels.forEach(U=>{L.add(px(X.id,U))})});const P=I.filter(X=>L.has(X.id)),V=[],F=new Set;return n.forEach(X=>{if(L.has(X)){const U=O.get(X);U&&!F.has(X)&&(V.push(U),F.add(X))}}),P.forEach(X=>{F.has(X.id)||V.push(X)}),V},[t,n,s]),y=T.useMemo(()=>{let I=m;if(c.size!==t.length&&(I=I.filter(L=>c.has(L.providerId))),i.trim()){const L=i.toLowerCase();I=I.filter(P=>P.name.toLowerCase().includes(L)||P.providerName.toLowerCase().includes(L)||P.id.toLowerCase().includes(L))}const O=Object.entries(d).filter(([,L])=>L).map(([L])=>L);return O.length>0&&(I=I.filter(L=>{var F,X;const P=new Set(((F=L.metadataSummary)==null?void 0:F.supported_parameters)??[]),V=new Set(((X=L.metadataSummary)==null?void 0:X.input_modalities)??[]);return O.every(U=>{switch(U){case"reasoning":return P.has("reasoning");case"webSearch":return P.has("web_search")||P.has("web_search_options");case"tools":return P.has("tools");case"multimodal":return Array.from(V).some(H=>H!=="text");default:return!0}})})),I},[m,i,c,t.length,d]),b=i.trim().length>0||c.size!==t.length||Object.values(d).some(Boolean),v=T.useMemo(()=>y.map(I=>I.id),[y]),x=T.useCallback(I=>{const{active:O,over:L}=I;if(L&&O.id!==L.id){const P=m.map(H=>H.id),V=O.id,F=L.id,X=P.indexOf(V),U=P.indexOf(F);if(X!==-1&&U!==-1){const H=Px(P,X,U);e(H)}else console.warn("DND: Could not find dragged items in the full model order. This might happen if the underlying list changed during drag or items are filtered out.")}},[m,e]),w=T.useCallback((I,O)=>{if(b)return;const L=m.map(F=>F.id),P=L.indexOf(I);if(P===-1)return;let V;if(O==="top"){if(P===0)return;const F=L.splice(P,1)[0];L.unshift(F),V=L}else if(O==="up"){if(P===0)return;V=Px(L,P,P-1)}else{if(P===L.length-1)return;V=Px(L,P,P+1)}e(V)},[m,e,b]),S=kot(wW(nF),wW(eF,{coordinateGetter:Zlt})),C=T.useCallback((I,O)=>{u(L=>{const P=new Set(L);return O?P.add(I):P.delete(I),P})},[]),k=I=>{h(O=>({...O,[I]:!O[I]}))},A=c.size!==t.length?1:0,R=Object.values(d).filter(Boolean).length,N=A+R;return r?f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx(Wr,{className:"h-8 w-1/3"}),f.jsx(Wr,{className:"h-6 w-1/2"}),f.jsx(Wr,{className:"h-64 w-full"})]}):f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models to define their display order. Filtering affects the view below. Move buttons (up/down/top) are disabled when filters are active."}),f.jsx(Zd,{}),f.jsxs("div",{className:"space-y-3",children:[f.jsx(Dt,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter models by name or provider...",value:i,onChange:I=>a(I.target.value),className:"pl-8 w-full h-9",disabled:r})]}),f.jsxs(pl,{open:o,onOpenChange:l,children:[f.jsx(ml,{asChild:!0,children:f.jsxs(bt,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:r||t.length===0,children:[f.jsx(MO,{className:"h-4 w-4 mr-1"}),"Filters",N>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:N})]})}),f.jsx(gl,{className:"w-64 p-0",children:f.jsxs("div",{className:"p-2 space-y-3",children:[f.jsxs("div",{children:[f.jsx(Dt,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),f.jsx(Po,{className:"h-32 border rounded-md p-1",children:t.map(I=>f.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[f.jsx(Hl,{id:`organizer-provider-filter-${I.id}`,checked:c.has(I.id),onCheckedChange:O=>C(I.id,!!O)}),f.jsxs(Dt,{htmlFor:`organizer-provider-filter-${I.id}`,className:"text-sm font-normal cursor-pointer",children:[I.name," (",I.type,")"]})]},I.id))})]}),f.jsxs("div",{children:[f.jsx(Dt,{className:"text-xs px-2 font-semibold block mb-1",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1 p-1 border rounded-md",children:[f.jsx(On,{tooltipText:"Reasoning",icon:f.jsx(Ph,{}),onClick:()=>k("reasoning"),variant:d.reasoning?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",d.reasoning&&"text-primary"),children:"Reasoning"}),f.jsx(On,{tooltipText:"Web Search",icon:f.jsx(Fa,{}),onClick:()=>k("webSearch"),variant:d.webSearch?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",d.webSearch&&"text-primary"),children:"Web"}),f.jsx(On,{tooltipText:"Tools",icon:f.jsx(om,{}),onClick:()=>k("tools"),variant:d.tools?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",d.tools&&"text-primary"),children:"Tools"}),f.jsx(On,{tooltipText:"Multimodal",icon:f.jsx(im,{}),onClick:()=>k("multimodal"),variant:d.multimodal?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",d.multimodal&&"text-primary"),children:"Multimodal"})]})]})]})})]})]}),f.jsx(Po,{className:"h-[calc(20*2.75rem+2px)] w-full rounded-md border border-border p-3 bg-background/50",children:y.length>0?f.jsx(Tlt,{sensors:S,collisionDetection:Tot,onDragEnd:x,children:f.jsx($lt,{items:v,strategy:Llt,children:y.map(I=>f.jsx(Jlt,{id:I.id,modelDetails:I,onMoveToTop:()=>w(I.id,"top"),onMoveUp:()=>w(I.id,"up"),onMoveDown:()=>w(I.id,"down"),isFirst:m.findIndex(O=>O.id===I.id)===0,isLast:m.findIndex(O=>O.id===I.id)===m.length-1,buttonsDisabled:b},I.id))})}):f.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:b?"No models match your filters.":"No models enabled globally. Enable models within provider configurations."})})]})]})},v2=e=>{if(!e)return"N/A";const t=parseFloat(e);return isNaN(t)?"N/A":`$${(t/1e3).toFixed(4)} / 1K tokens`},jl=(e,t,n=!1,r="secondary")=>t==null||String(t).trim()===""?null:f.jsxs(ks,{children:[f.jsx(zn,{className:"font-medium text-xs w-1/3 py-1.5 px-3",children:e}),f.jsx(zn,{className:"text-xs py-1.5 px-3 break-all",children:n?f.jsx(mi,{variant:r,className:"text-xs",children:String(t)}):Array.isArray(t)?f.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((s,i)=>f.jsx(mi,{variant:"outline",className:"text-xs",children:String(s)},i))}):String(t)})]}),ect=({modelId:e})=>{var m,y,b,v,x,w,S,C,k,A,R,N;const{createAiModelConfig:t,dbProviderConfigs:n,dbApiKeys:r,updateProviderConfig:s,isLoading:i}=Rr(yn(I=>({createAiModelConfig:I.createAiModelConfig,dbProviderConfigs:I.dbProviderConfigs,dbApiKeys:I.dbApiKeys,updateProviderConfig:I.updateProviderConfig,isLoading:I.isLoading}))),a=T.useMemo(()=>{if(!e)return;const{providerId:I,modelId:O}=yc(e);if(!I||!O)return;const L=n.find(V=>V.id===I);if(!L)return;const P=r.find(V=>V.id===L.apiKeyId);return t(L,O,P==null?void 0:P.value)},[e,n,r,t]),o=a==null?void 0:a.metadata,l=T.useCallback(async()=>{if(!a||!e)return;const{providerId:I,modelId:O}=yc(e);if(!I||!O)return;const L=n.find(X=>X.id===I);if(!L){Oe.error("Provider configuration not found.");return}const P=new Set(L.enabledModels??[]),V=P.has(O);V?P.delete(O):P.add(O);const F=Array.from(P);try{await s(L.id,{enabledModels:F}),Oe.success(`Model "${a.name}" ${V?"disabled":"enabled"}.`)}catch{Oe.error("Failed to update model status.")}},[a,e,n,s]);if(i)return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(Wr,{className:"h-8 w-3/4 flex-shrink-0"}),f.jsx(Wr,{className:"h-4 w-1/2 flex-shrink-0"}),f.jsxs("div",{className:"flex-grow space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]})]});if(!e)return f.jsxs("div",{className:"p-4 text-center text-muted-foreground h-full flex flex-col items-center justify-center",children:[f.jsx(_c,{className:"mx-auto h-10 w-10 mb-2 text-amber-500"}),f.jsx("p",{className:"text-sm",children:'No model selected. Click a model in the "Configuration" or "Browse Models" tab to view its details.'})]});if(!a||!o)return f.jsxs("div",{className:"p-4 text-center text-destructive h-full flex flex-col items-center justify-center",children:[f.jsx(_c,{className:"mx-auto h-10 w-10 mb-2"}),f.jsxs("p",{className:"text-sm",children:["Details not available for model: ",e,". It might be misconfigured or no longer available."]})]});const{providerId:c,modelId:u}=yc(e),d=n.find(I=>I.id===c),h=u!=null&&(d==null?void 0:d.isEnabled)&&((m=d==null?void 0:d.enabledModels)==null?void 0:m.includes(u))===!0;return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between flex-shrink-0",children:[f.jsxs("h4",{className:"text-lg font-semibold text-card-foreground truncate",children:[a.name,f.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Dt,{htmlFor:`enable-details-${u}`,className:"text-xs",children:h?"Enabled":"Disabled"}),f.jsx(ol,{id:`enable-details-${u}`,checked:h,onCheckedChange:l,disabled:!(d!=null&&d.isEnabled),"aria-label":`Enable model ${a.name}`})]})]}),o.description&&f.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:o.description}),f.jsx(Po,{className:"flex-grow border rounded-md bg-background/30",children:f.jsxs(of,{children:[f.jsxs(Jet,{className:"py-2 text-xs",children:["Model ID: ",o.id]}),f.jsxs(lf,{children:[jl("Context Length",((y=o.top_provider)==null?void 0:y.context_length)??o.context_length),jl("Max Completion Tokens",(b=o.top_provider)==null?void 0:b.max_completion_tokens),jl("Input Modalities",(v=o.architecture)==null?void 0:v.input_modalities),jl("Output Modalities",(x=o.architecture)==null?void 0:x.output_modalities),jl("Tokenizer",(w=o.architecture)==null?void 0:w.tokenizer,!0),jl("Instruct Type",(S=o.architecture)==null?void 0:S.instruct_type,!0),jl("Pricing (Prompt)",v2((C=o.pricing)==null?void 0:C.prompt)),jl("Pricing (Completion)",v2((k=o.pricing)==null?void 0:k.completion)),jl("Pricing (Image)",v2((A=o.pricing)==null?void 0:A.image)),jl("Pricing (Request)",v2((R=o.pricing)==null?void 0:R.request)),jl("Supported Parameters",o.supported_parameters),jl("Moderated",(N=o.top_provider)!=null&&N.is_moderated?f.jsx(oE,{className:"h-4 w-4 text-green-500"}):"No")]})]})})]})},tct=()=>{const{apiKeys:e,addApiKey:t,deleteApiKey:n,isLoading:r}=Rr(yn(h=>({apiKeys:h.dbApiKeys,addApiKey:h.addApiKey,deleteApiKey:h.deleteApiKey,isLoading:h.isLoading}))),[s,i]=T.useState(!1),[a,o]=T.useState(!1),[l,c]=T.useState({}),u=T.useCallback(async(h,m,y)=>{o(!0);try{await t(h,m,y),i(!1)}catch(b){console.error("Failed to add API key (from component):",b)}finally{o(!1)}},[t]),d=T.useCallback(async(h,m)=>{if(window.confirm(`Are you sure you want to delete the API key "${m}"? This will unlink it from any providers using it.`)){c(y=>({...y,[h]:!0}));try{await n(h)}catch(y){console.error("Failed to delete API key (from component):",y)}finally{c(y=>({...y,[h]:!1}))}}},[n]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!s&&f.jsxs(bt,{onClick:()=>i(!0),variant:"outline",className:"w-full mb-4",disabled:r,children:[f.jsx(Pd,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),s&&f.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),f.jsx(woe,{onSave:u,onCancel:()=>i(!1),disabled:a})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),r&&!s?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]}):(e||[]).length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(of,{children:[f.jsx(np,{children:f.jsxs(ks,{children:[f.jsx(Or,{children:"Name"}),f.jsx(Or,{children:"Provider Type"}),f.jsx(Or,{children:"Created"}),f.jsx(Or,{className:"text-right",children:"Actions"})]})}),f.jsx(lf,{children:(e||[]).map(h=>{const m=l[h.id];return f.jsxs(ks,{className:m?"opacity-50":"",children:[f.jsx(zn,{className:"font-medium",children:h.name||"Unnamed Key"}),f.jsx(zn,{children:h.providerId||"Unknown"}),f.jsx(zn,{className:"text-xs text-muted-foreground",children:hw(new Date(h.createdAt),"PPp")}),f.jsx(zn,{className:"text-right",children:f.jsx(On,{tooltipText:"Delete Key",onClick:()=>d(h.id,h.name||"Unnamed Key"),disabled:m,"aria-label":`Delete key ${h.name||"Unnamed Key"}`,icon:m?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Eo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})})]},h.id)})})]})})]})]})},nct=We.memo(tct),rct=({onSelectModelForDetails:e})=>{const[t,n]=T.useState(null),[r,s]=T.useState(null),i=T.useCallback(O=>{if(O){n(O);const L=O.querySelector("[data-radix-scroll-area-viewport]");if(L)s(L);else{const P=new MutationObserver(()=>{const V=O.querySelector("[data-radix-scroll-area-viewport]");V&&(s(V),P.disconnect())});return P.observe(O,{childList:!0,subtree:!0}),()=>P.disconnect()}}else n(null),s(null)},[]),{getAvailableModelListItems:a,isLoading:o,dbProviderConfigs:l}=Rr(yn(O=>({getAvailableModelListItems:O.getAvailableModelListItems,isLoading:O.isLoading,dbProviderConfigs:O.dbProviderConfigs}))),[c,u]=T.useState(""),[d,h]=T.useState(!1),[m,y]=T.useState(()=>new Set(l.map(O=>O.id))),[b,v]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),x=T.useMemo(()=>a(),[a]);T.useEffect(()=>{y(new Set(l.map(O=>O.id)))},[l]);const w=T.useMemo(()=>{let O=x;if(m.size!==l.length&&(O=O.filter(P=>m.has(P.providerId))),c.trim()){const P=c.toLowerCase();O=O.filter(V=>V.name.toLowerCase().includes(P)||V.providerName.toLowerCase().includes(P)||V.id.toLowerCase().includes(P))}const L=Object.entries(b).filter(([,P])=>P).map(([P])=>P);return L.length>0&&(O=O.filter(P=>{var X,U;const V=new Set(((X=P.metadataSummary)==null?void 0:X.supported_parameters)??[]),F=new Set(((U=P.metadataSummary)==null?void 0:U.input_modalities)??[]);return L.every(H=>{switch(H){case"reasoning":return V.has("reasoning");case"webSearch":return V.has("web_search")||V.has("web_search_options");case"tools":return V.has("tools");case"multimodal":return Array.from(F).some($=>$!=="text");default:return!0}})})),O.sort((P,V)=>{const F=P.providerName.localeCompare(V.providerName);return F!==0?F:P.name.localeCompare(V.name)})},[x,c,m,l.length,b]),S=C5({count:w.length,getScrollElement:()=>r,estimateSize:()=>48,overscan:10}),C=T.useCallback((O,L)=>{y(P=>{const V=new Set(P);return L?V.add(O):V.delete(O),V})},[]),k=O=>{v(L=>({...L,[O]:!L[O]}))},A=O=>{e(O)},R=m.size!==l.length?1:0,N=Object.values(b).filter(Boolean).length,I=R+N;return o?f.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[f.jsx(Wr,{className:"h-9 w-full flex-shrink-0"}),f.jsx(Wr,{className:"h-full w-full flex-grow"})]}):f.jsxs("div",{className:"space-y-3 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter models by name or provider...",value:c,onChange:O=>u(O.target.value),className:"pl-8 w-full h-9",disabled:o})]}),f.jsxs(pl,{open:d,onOpenChange:h,children:[f.jsx(ml,{asChild:!0,children:f.jsxs(bt,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:o||l.length===0,children:[f.jsx(MO,{className:"h-4 w-4 mr-1"}),"Filters",I>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:I})]})}),f.jsx(gl,{className:"w-64 p-0",children:f.jsxs("div",{className:"p-2 space-y-3",children:[f.jsxs("div",{children:[f.jsx(Dt,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),f.jsx(Po,{className:"h-32 border rounded-md p-1",children:l.map(O=>f.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[f.jsx(Hl,{id:`model-browser-provider-filter-${O.id}`,checked:m.has(O.id),onCheckedChange:L=>C(O.id,!!L)}),f.jsxs(Dt,{htmlFor:`model-browser-provider-filter-${O.id}`,className:"text-sm font-normal cursor-pointer",children:[O.name," (",O.type,")"]})]},O.id))})]}),f.jsxs("div",{children:[f.jsx(Dt,{className:"text-xs px-2 font-semibold block mb-1",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1 p-1 border rounded-md",children:[f.jsx(On,{tooltipText:"Reasoning",icon:f.jsx(Ph,{}),onClick:()=>k("reasoning"),variant:b.reasoning?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",b.reasoning&&"text-primary"),children:"Reasoning"}),f.jsx(On,{tooltipText:"Web Search",icon:f.jsx(Fa,{}),onClick:()=>k("webSearch"),variant:b.webSearch?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",b.webSearch&&"text-primary"),children:"Web"}),f.jsx(On,{tooltipText:"Tools",icon:f.jsx(om,{}),onClick:()=>k("tools"),variant:b.tools?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",b.tools&&"text-primary"),children:"Tools"}),f.jsx(On,{tooltipText:"Multimodal",icon:f.jsx(im,{}),onClick:()=>k("multimodal"),variant:b.multimodal?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",b.multimodal&&"text-primary"),children:"Multimodal"})]})]})]})})]})]}),f.jsxs(Po,{className:"flex-grow border rounded-md bg-background/50 h-[calc(15*2.5rem+2px)]",ref:i,children:[r&&f.jsx("div",{style:{height:`${S.getTotalSize()}px`,width:"100%",position:"relative"},children:w.length===0&&!o?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match your filters."}):S.getVirtualItems().map(O=>{var P;const L=w[O.index];return L?f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${O.size}px`,transform:`translateY(${O.start}px)`},className:"p-1",children:f.jsx(xr,{delayDuration:300,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("button",{className:"w-full text-left p-1.5 rounded hover:bg-muted/50 flex flex-col",onClick:()=>A(L.id),children:[f.jsx("span",{className:"text-sm font-medium truncate",children:L.name}),f.jsx("span",{className:"text-xs text-muted-foreground truncate",children:L.providerName})]})}),((P=L.metadataSummary)==null?void 0:P.description)&&f.jsx(Sr,{side:"bottom",align:"start",className:"max-w-xs",children:f.jsx("p",{children:L.metadataSummary.description})})]})})},L.id):null})}),!r&&!o&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},sct=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:s,providerFetchStatus:i,dbProviderConfigs:a,apiKeys:o,isLoading:l}=Rr(yn(b=>({addDbProviderConfig:b.addProviderConfig,updateDbProviderConfig:b.updateProviderConfig,deleteDbProviderConfig:b.deleteProviderConfig,fetchModels:b.fetchModels,providerFetchStatus:b.providerFetchStatus,dbProviderConfigs:b.dbProviderConfigs,apiKeys:b.dbApiKeys,isLoading:b.isLoading}))),[c,u]=T.useState(!1),d=()=>u(!0),h=T.useCallback(()=>u(!1),[]),m=T.useCallback(async b=>{await s(b)},[s]),y=T.useMemo(()=>a||[],[a]);return f.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),f.jsx("div",{className:"flex-shrink-0",children:c?f.jsx(Roe,{apiKeys:o||[],onAddProvider:t,onCancel:h}):f.jsxs(bt,{onClick:d,variant:"outline",className:"w-full",disabled:l,children:[f.jsx(Pd,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),f.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:f.jsxs("div",{className:"space-y-2",children:[l&&!c?f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-24 w-full"})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:y.map(b=>f.jsx(uot,{provider:b,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:m,fetchStatus:i[b.id]||"idle",onSelectModelForDetails:e},b.id))}),!l&&y.length===0&&!c&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},ict=({setGlobalModelSortOrderFromModule:e})=>{const{selectedModelForDetails:t,setSelectedModelForDetails:n}=Rr(yn(o=>({selectedModelForDetails:o._selectedModelForDetails,setSelectedModelForDetails:o.setSelectedModelForDetails}))),[r,s]=T.useState("providers-config"),i=T.useCallback(o=>{n(o),o&&s("providers-details-current")},[n,s]),a=T.useMemo(()=>[{value:"providers-config",label:"Configuration",content:f.jsx(sct,{onSelectModelForDetails:i})},{value:"providers-order",label:"Model Order",content:f.jsx(Qlt,{setGlobalModelSortOrderFromModule:e})},{value:"api-keys",label:"API Keys",content:f.jsx(nct,{})},{value:"providers-details-current",label:"Selected Model",content:f.jsx(ect,{modelId:t})},{value:"providers-browse-all",label:"Browse Models",content:f.jsx(rct,{onSelectModelForDetails:i})}],[t,i,e]);return f.jsx(Dc,{tabs:a,initialValue:r,onValueChange:s,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},act=We.memo(ict);class oct{constructor(){ve(this,"id","core-provider-settings");ve(this,"modApiRef",null);ve(this,"eventUnsubscribers",[]);ve(this,"setGlobalModelSortOrderFromModule",t=>{var n;(n=this.modApiRef)==null||n.emit(dr.setGlobalModelSortOrderRequest,{ids:t})})}async initialize(t){this.modApiRef=t}register(t){this.modApiRef=t,t.registerSettingsTab({id:"providers",title:"Providers & Models",order:20,component:()=>We.createElement(act,{setGlobalModelSortOrderFromModule:this.setGlobalModelSortOrderFromModule})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.modApiRef=null}}const lct=Ke({globalSystemPrompt:$e()});function cct({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const uct=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t}=yr(yn(r=>({globalSystemPrompt:r.globalSystemPrompt,setGlobalSystemPrompt:r.setGlobalSystemPrompt}))),n=ni({defaultValues:{globalSystemPrompt:e??""},validators:{onChangeAsync:lct,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.globalSystemPrompt),Oe.success("Global system prompt updated!")}catch(s){Oe.error("Failed to update prompt. Please try again."),console.error("Error submitting assistant prompt form:",s)}}});return T.useEffect(()=>{n.state.values.globalSystemPrompt!==(e??"")&&n.reset({globalSystemPrompt:e??""})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx("div",{children:f.jsx(n.Field,{name:"globalSystemPrompt",children:r=>f.jsxs(f.Fragment,{children:[f.jsx(Dt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Global System Prompt"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),f.jsx(Do,{id:r.name,placeholder:"Enter default system instructions for the assistant...",value:r.state.value,onBlur:r.handleBlur,onChange:s=>r.handleChange(s.target.value),rows:6,className:r.state.meta.errors.length?"border-destructive":""}),f.jsx(cct,{field:r})]})})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(bt,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Prompt"})})})]})},dct=Ke({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),fct=()=>{const e=yr(yn(n=>({temperature:n.temperature,setTemperature:n.setTemperature,topP:n.topP,setTopP:n.setTopP,maxTokens:n.maxTokens,setMaxTokens:n.setMaxTokens,topK:n.topK,setTopK:n.setTopK,presencePenalty:n.presencePenalty,setPresencePenalty:n.setPresencePenalty,frequencyPenalty:n.frequencyPenalty,setFrequencyPenalty:n.setFrequencyPenalty}))),t=ni({defaultValues:{temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0},validators:{onChangeAsync:dct,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setTemperature(n.temperature),e.setTopP(n.topP),e.setMaxTokens(n.maxTokens??null),e.setTopK(n.topK??null),e.setPresencePenalty(n.presencePenalty),e.setFrequencyPenalty(n.frequencyPenalty),Oe.success("Assistant parameters updated!")}catch(r){Oe.error("Failed to update parameters."),console.error("Error submitting parameters form:",r)}}});return T.useEffect(()=>{t.reset({temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0})},[e.temperature,e.topP,e.maxTokens,e.topK,e.presencePenalty,e.frequencyPenalty,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-4",children:[f.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),f.jsx(pc,{form:t,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(pc,{form:t,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(Ay,{form:t,name:"maxTokens",label:"Max Tokens",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"}),f.jsx(Ay,{form:t,name:"topK",label:"Top K",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"})]}),f.jsx(pc,{form:t,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(pc,{form:t,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(bt,{type:"button",variant:"ghost",onClick:()=>t.reset(),disabled:!t.state.isDirty,children:"Reset"}),f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting],children:([n,r])=>f.jsx(bt,{type:"submit",disabled:!n||r,children:r?"Saving...":"Save Changes"})})]})]})},hct=Ke({toolMaxSteps:Tt({required_error:"Max steps is required",invalid_type_error:"Max steps must be a number"}).min(1,"Must be at least 1").max(20,"Cannot exceed 20")});function pct({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const mct=()=>{const{toolMaxSteps:e,setToolMaxSteps:t}=yr(yn(r=>({toolMaxSteps:r.toolMaxSteps,setToolMaxSteps:r.setToolMaxSteps}))),n=ni({defaultValues:{toolMaxSteps:e??5},validators:{onChangeAsync:hct,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.toolMaxSteps),Oe.success("Tool settings updated!")}catch(s){Oe.error("Failed to update tool settings."),console.error("Error submitting tool settings form:",s)}}});return T.useEffect(()=>{n.state.values.toolMaxSteps!==(e??5)&&n.reset({toolMaxSteps:e??5})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx(n.Field,{name:"toolMaxSteps",children:r=>f.jsxs("div",{children:[f.jsx(Dt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),f.jsx(Cn,{id:r.name,type:"number",min:1,max:20,step:1,value:r.state.value,onBlur:r.handleBlur,onChange:s=>{const i=s.target.valueAsNumber;isNaN(i)?s.target.value===""&&r.handleChange(void 0):r.handleChange(i)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),f.jsx(pct,{field:r})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(bt,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Tool Settings"})})})]})},gct=Ke({autoTitleEnabled:br(),autoTitleModelId:$e().nullable(),autoTitlePromptMaxLength:Tt().min(100).max(4e3),autoTitleIncludeFiles:br(),autoTitleIncludeRules:br()});function Hv({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const yct=()=>{const e=yr(yn(n=>({autoTitleEnabled:n.autoTitleEnabled,setAutoTitleEnabled:n.setAutoTitleEnabled,autoTitleModelId:n.autoTitleModelId,setAutoTitleModelId:n.setAutoTitleModelId,autoTitlePromptMaxLength:n.autoTitlePromptMaxLength,setAutoTitlePromptMaxLength:n.setAutoTitlePromptMaxLength,autoTitleIncludeFiles:n.autoTitleIncludeFiles,setAutoTitleIncludeFiles:n.setAutoTitleIncludeFiles,autoTitleIncludeRules:n.autoTitleIncludeRules,setAutoTitleIncludeRules:n.setAutoTitleIncludeRules}))),t=ni({defaultValues:{autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1},validators:{onChangeAsync:gct,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setAutoTitleEnabled(n.autoTitleEnabled),e.setAutoTitleModelId(n.autoTitleModelId??null),e.setAutoTitlePromptMaxLength(n.autoTitlePromptMaxLength),e.setAutoTitleIncludeFiles(n.autoTitleIncludeFiles),e.setAutoTitleIncludeRules(n.autoTitleIncludeRules),Oe.success("Auto-title settings updated!")}catch(r){Oe.error("Failed to update auto-title settings."),console.error("Error submitting auto-title settings form:",r)}}});return T.useEffect(()=>{t.reset({autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1})},[e.autoTitleEnabled,e.autoTitleModelId,e.autoTitlePromptMaxLength,e.autoTitleIncludeFiles,e.autoTitleIncludeRules,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-3",children:[f.jsx(t.Field,{name:"autoTitleEnabled",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ol,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(Dt,{id:`${n.name}-label`,htmlFor:n.name,children:"Enable Auto-Title Generation"}),f.jsx(Hv,{field:n})]})}),t.state.values.autoTitleEnabled&&f.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-muted",children:[f.jsx(t.Field,{name:"autoTitleModelId",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:n.name,children:"Model for Title Generation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose which model to use for generating conversation titles. Uses global default model if not specified."}),f.jsx(H5,{value:n.state.value,onChange:r=>n.handleChange(r),className:"w-full"}),f.jsx(Hv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitlePromptMaxLength",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Dt,{htmlFor:n.name,children:"Conversation Content Length Limit"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum characters from conversation to include in title generation prompt (100-4000)."}),f.jsx(Cn,{id:n.name,type:"number",min:100,max:4e3,step:1,value:n.state.value,onBlur:n.handleBlur,onChange:r=>{const s=r.target.valueAsNumber;isNaN(s)||n.handleChange(s)},className:`w-32 ${n.state.meta.errors.length?"border-destructive":""}`}),f.jsx(Hv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeFiles",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ol,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(Dt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include file context in title prompt"}),f.jsx(Hv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeRules",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ol,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(Dt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include active rules in title prompt"}),f.jsx(Hv,{field:n})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting,n.isValidating,n.isValid],children:([n,r,s,i])=>f.jsx(bt,{type:"submit",size:"sm",disabled:!n||r||s||!i,children:r?"Saving...":s?"Validating...":"Save Title Settings"})})})]})},bct=Ke({name:$e().min(1,"Name is required"),description:$e(),variables:ln(Ke({name:$e().min(1,"Variable name is required"),description:$e(),type:hl(["string","number","boolean","array"]),required:br(),default:$e().optional(),instructions:$e().optional()})),prompt:$e().min(1,"Prompt content is required"),tags:ln($e()),tools:ln($e()),rules:ln($e())}),vct=(e,t)=>({getEnabledTools:()=>new Set(e),setEnabledTools:n=>{const r=n(new Set(e));t(Array.from(r))},getSelectedItemId:()=>"mock-id",getSelectedItemType:()=>"conversation",getGlobalDefaultMaxSteps:()=>5});function OW({template:e,onSubmit:t,onSuccess:n}){const[r,s]=T.useState({name:"",description:"",type:"string",required:!1,default:"",instructions:""}),[i,a]=T.useState(null),{rules:o,tags:l,tagRuleLinks:c,loadRulesAndTags:u}=fle(yn(b=>({rules:b.rules,tags:b.tags,tagRuleLinks:b.tagRuleLinks,loadRulesAndTags:b.loadRulesAndTags})));T.useEffect(()=>{u()},[u]);const d=ni({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",variables:(e==null?void 0:e.variables)||[],prompt:(e==null?void 0:e.prompt)||"",tags:(e==null?void 0:e.tags)||[],tools:(e==null?void 0:e.tools)||[],rules:(e==null?void 0:e.rules)||[]},validators:{onChangeAsync:bct,onChangeAsyncDebounceMs:500},onSubmit:async({value:b})=>{t(b),n()}});T.useEffect(()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[e==null?void 0:e.id]),T.useEffect(()=>()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""}),a(null)},[]);const h=()=>{r.name&&(d.setFieldValue("variables",[...d.getFieldValue("variables"),{...r}]),s({name:"",description:"",type:"string",required:!1,default:"",instructions:""}))},m=b=>{const v=d.getFieldValue("variables");d.setFieldValue("variables",v.filter((x,w)=>w!==b))},y=b=>{const v=c.filter(x=>x.tagId===b).map(x=>x.ruleId);return o.filter(x=>v.includes(x.id))};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e?"Edit Template":"New Template"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?"Update your prompt template":"Create a reusable prompt template with variables"})]}),f.jsxs("form",{onSubmit:b=>{b.preventDefault(),b.stopPropagation(),d.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx(d.Field,{name:"name",children:b=>{var v;return f.jsxs("div",{children:[f.jsx(Dt,{htmlFor:b.name,children:"Template Name"}),f.jsx(Cn,{id:b.name,value:b.state.value,onChange:x=>b.handleChange(x.target.value),onBlur:b.handleBlur,placeholder:"Enter template name"}),b.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:((v=b.state.meta.errors[0])==null?void 0:v.message)||"Invalid input"})]})}}),f.jsx(d.Field,{name:"description",children:b=>f.jsxs("div",{children:[f.jsx(Dt,{htmlFor:b.name,children:"Description"}),f.jsx(Do,{id:b.name,value:b.state.value,onChange:v=>b.handleChange(v.target.value),onBlur:b.handleBlur,placeholder:"Describe what this template does",rows:3})]})}),f.jsx(d.Field,{name:"prompt",children:b=>{var v;return f.jsxs("div",{children:[f.jsx(Dt,{htmlFor:b.name,children:"Prompt Template"}),f.jsx(Do,{id:b.name,value:b.state.value,onChange:x=>b.handleChange(x.target.value),onBlur:b.handleBlur,placeholder:"Enter your prompt template using {{ variable_name }} syntax",rows:6,className:"font-mono"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Use double curly braces to reference variables:"," ","{{ variable_name }}"]}),b.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:((v=b.state.meta.errors[0])==null?void 0:v.message)||"Invalid input"})]})}})]}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Dt,{className:"text-base font-medium",children:"Variables"}),f.jsxs("div",{className:"space-y-3 mt-2",children:[d.getFieldValue("variables").map((b,v)=>f.jsxs("div",{className:"p-3 border rounded-lg space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-medium",children:b.name}),f.jsx(bt,{variant:"ghost",size:"sm",onClick:()=>m(v),children:f.jsx(wa,{className:"h-4 w-4"})})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:b.description}),f.jsxs("div",{className:"flex gap-2 text-xs",children:[f.jsx(mi,{variant:b.required?"default":"secondary",children:b.required?"Required":"Optional"}),f.jsx(mi,{variant:"outline",children:b.type}),b.default&&f.jsxs(mi,{variant:"outline",children:["Default: ",b.default]})]})]},`${b.name}-${v}`)),f.jsxs("div",{className:"p-3 border-2 border-dashed rounded-lg space-y-3",children:[f.jsx(Dt,{children:"Add New Variable"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(Dt,{children:"Name"}),f.jsx(Cn,{value:r.name,onChange:b=>s(v=>({...v,name:b.target.value})),placeholder:"Variable name"})]}),f.jsxs("div",{children:[f.jsx(Dt,{children:"Type"}),f.jsxs(Wm,{value:r.type,onValueChange:b=>s(v=>({...v,type:b})),children:[f.jsx(Gm,{children:f.jsx(Hm,{})}),f.jsxs(Km,{children:[f.jsx(sl,{value:"string",children:"String"}),f.jsx(sl,{value:"number",children:"Number"}),f.jsx(sl,{value:"boolean",children:"Boolean"}),f.jsx(sl,{value:"array",children:"Array"})]})]},`new-variable-type-${(e==null?void 0:e.id)||"new"}`)]})]}),f.jsxs("div",{children:[f.jsx(Dt,{children:"Description"}),f.jsx(Cn,{value:r.description,onChange:b=>s(v=>({...v,description:b.target.value})),placeholder:"Describe this variable"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(Dt,{children:"Default Value"}),f.jsx(Cn,{value:r.default,onChange:b=>s(v=>({...v,default:b.target.value})),placeholder:"Default value (optional)"})]}),f.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[f.jsx(Hl,{checked:r.required,onCheckedChange:b=>s(v=>({...v,required:!!b}))}),f.jsx(Dt,{children:"Required"})]})]}),f.jsxs(bt,{type:"button",onClick:h,className:"w-full",children:[f.jsx(Pd,{className:"h-4 w-4 mr-2"}),"Add Variable"]})]})]})]})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Dt,{className:"text-base font-medium",children:"Auto-select Tools"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Choose tools that will be automatically enabled when this template is applied."}),f.jsx(Iue,{module:vct(d.getFieldValue("tools"),b=>d.setFieldValue("tools",b)),popoverMaxSteps:i,setPopoverMaxSteps:a,className:"p-0 max-w-none"})]})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Dt,{className:"text-base font-medium",children:"Auto-select Rules & Tags"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Choose rules and tags that will be automatically enabled when this template is applied."}),f.jsx(Kue,{activeTagIds:new Set(d.getFieldValue("tags")),activeRuleIds:new Set(d.getFieldValue("rules")),onToggleTag:(b,v)=>{const x=d.getFieldValue("tags");v?d.setFieldValue("tags",[...x,b]):d.setFieldValue("tags",x.filter(w=>w!==b))},onToggleRule:(b,v)=>{const x=d.getFieldValue("rules");v?d.setFieldValue("rules",[...x,b]):d.setFieldValue("rules",x.filter(w=>w!==b))},allRules:o,allTags:l,getRulesForTag:y})]})}),f.jsx("div",{className:"flex gap-3 pt-4 border-t",children:f.jsxs(bt,{type:"submit",className:"flex-1",children:[f.jsx(Jd,{className:"h-4 w-4 mr-2"}),e?"Update Template":"Create Template"]})})]})]})}function xct({templates:e,onEdit:t,onDelete:n}){return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Prompt Templates"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your reusable prompt templates with dynamic variables"})]}),e.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx("h4",{className:"font-medium text-muted-foreground",children:"No Templates Yet"}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'Use the "New Template" tab to create your first template'})]}):f.jsxs(of,{children:[f.jsx(np,{children:f.jsxs(ks,{children:[f.jsx(Or,{children:"Name"}),f.jsx(Or,{children:"Description"}),f.jsx(Or,{children:"Variables"}),f.jsx(Or,{children:"Tools"}),f.jsx(Or,{children:"Rules/Tags"}),f.jsx(Or,{className:"text-right",children:"Actions"})]})}),f.jsx(lf,{children:e.map(r=>{var s,i,a;return f.jsxs(ks,{children:[f.jsx(zn,{className:"font-medium",children:r.name}),f.jsx(zn,{className:"max-w-xs truncate",children:r.description}),f.jsx(zn,{children:f.jsx(mi,{variant:"secondary",children:r.variables.length})}),f.jsx(zn,{children:f.jsx(mi,{variant:"secondary",children:((s=r.tools)==null?void 0:s.length)||0})}),f.jsx(zn,{children:f.jsxs("div",{className:"flex gap-1",children:[f.jsxs(mi,{variant:"secondary",children:[((i=r.tags)==null?void 0:i.length)||0," tags"]}),f.jsxs(mi,{variant:"secondary",children:[((a=r.rules)==null?void 0:a.length)||0," rules"]})]})}),f.jsx(zn,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[f.jsx(bt,{variant:"ghost",size:"sm",onClick:()=>t(r),children:f.jsx(S0,{className:"h-4 w-4"})}),f.jsx(bt,{variant:"ghost",size:"sm",onClick:()=>n(r.id),children:f.jsx(Eo,{className:"h-4 w-4"})})]})})]},r.id)})})]})]})}const wct=()=>{const[e,t]=T.useState("templates"),[n,r]=T.useState(),{promptTemplates:s,loadPromptTemplates:i,addPromptTemplate:a,updatePromptTemplate:o,deletePromptTemplate:l}=eA(yn(b=>({promptTemplates:b.promptTemplates,loadPromptTemplates:b.loadPromptTemplates,addPromptTemplate:b.addPromptTemplate,updatePromptTemplate:b.updatePromptTemplate,deletePromptTemplate:b.deletePromptTemplate})));T.useEffect(()=>{i()},[i]);const c=async b=>{await a({...b,isPublic:!1})},u=async b=>{n&&await o(n.id,b)},d=async b=>{confirm("Are you sure you want to delete this template?")&&await l(b)},h=b=>{r(b),t("edit")},m=()=>{t("templates"),r(void 0)},y=[{value:"templates",label:"Templates",content:f.jsx(xct,{templates:s,onEdit:h,onDelete:d})},{value:"new",label:"New Template",content:f.jsx(OW,{onSubmit:c,onSuccess:m},"new-template-form")}];return n&&y.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(OW,{template:n,onSubmit:u,onSuccess:m},`edit-template-form-${n.id}`)}),f.jsx(Dc,{tabs:y,initialValue:e,onValueChange:t,defaultValue:"templates",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},_ct=Ke({name:$e().min(1,"Name is required"),url:$e().url("Must be a valid URL"),description:$e(),headers:$e(),enabled:br()}),Sct=Ke({retryAttempts:Tt().min(0,"Min 0 attempts").max(10,"Max 10 attempts"),retryDelay:Tt().min(500,"Min 500ms").max(3e4,"Max 30000ms"),connectionTimeout:Tt().min(1e3,"Min 1000ms").max(6e4,"Max 60000ms"),maxResponseSize:Tt().min(1e3,"Min 1KB").max(1e7,"Max 10MB")});function gc({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}function Cct(){const{bridgeConfig:e,setBridgeConfig:t}=el(yn(s=>({bridgeConfig:s.bridgeConfig,setBridgeConfig:s.setBridgeConfig}))),n=ni({defaultValues:{url:e.url||"",host:e.host||"",port:e.port||void 0},onSubmit:async({value:s})=>{t({url:s.url||void 0,host:s.host||void 0,port:s.port})}});T.useEffect(()=>{n.reset({url:e.url||"",host:e.host||"",port:e.port||void 0})},[e,n]);const r=()=>{window.confirm("Reset bridge configuration to defaults?")&&t({})};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Dynamic MCP Bridge Configuration"}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure where LiteChat looks for the dynamic MCP bridge service (required for stdio:// servers). Start the bridge with: ",f.jsx("code",{className:"bg-muted px-1 rounded",children:"npm run mcp-proxy"})]})]}),f.jsxs(Vd,{children:[f.jsxs(Wd,{children:[f.jsxs(Hd,{className:"text-base flex items-center",children:[f.jsx(Q2,{className:"mr-2 h-4 w-4"}),"Bridge Location"]}),f.jsx(Y1,{children:"Specify where your dynamic MCP bridge is running (default: localhost:3001)"})]}),f.jsxs(Gd,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(n.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:s.name,children:"Full Bridge URL (highest priority)"}),f.jsx(Cn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"http://192.168.1.100:3001"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete URL where the dynamic MCP bridge is running"}),f.jsx(gc,{field:s})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{children:"Or configure Host + Port"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(n.Field,{name:"host",children:s=>f.jsxs("div",{className:"flex-1",children:[f.jsx(Cn,{value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"localhost"}),f.jsx(gc,{field:s})]})}),f.jsx(n.Field,{name:"port",children:s=>f.jsxs("div",{className:"w-20",children:[f.jsx(Cn,{type:"number",value:s.state.value||"",onChange:i=>s.handleChange(parseInt(i.target.value)||void 0),onBlur:s.handleBlur,placeholder:"3001"}),f.jsx(gc,{field:s})]})})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Host and port (uses HTTP by default)"})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:[f.jsx("p",{className:"font-medium mb-1",children:"Bridge Detection Priority:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[f.jsx("li",{children:"Full URL (if specified above)"}),f.jsx("li",{children:"Host + Port combination (if specified above)"}),f.jsx("li",{children:"Auto-detection fallback: localhost:3001"})]}),f.jsx("p",{className:"mt-2 text-xs",children:"Leave empty for auto-detection. For remote bridge, use full URL or configure host binding."})]})]})]}),f.jsxs(Vd,{children:[f.jsx(Wd,{children:f.jsx(Hd,{className:"text-base",children:"Bridge Setup Instructions"})}),f.jsx(Gd,{className:"space-y-3",children:f.jsxs("div",{className:"text-sm space-y-2",children:[f.jsx("p",{className:"font-medium",children:"To use stdio MCP servers, install and run the bridge:"}),f.jsxs("div",{className:"bg-muted p-3 rounded font-mono text-xs",children:[f.jsx("p",{children:"# Start the bridge (from LiteChat project directory)"}),f.jsx("p",{children:"node bin/mcp-bridge.js"}),f.jsx("p",{}),f.jsx("p",{children:"# Or with custom settings"}),f.jsx("p",{children:"node bin/mcp-bridge.js --host 0.0.0.0 --port 3001"})]})]})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(n.Subscribe,{children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(bt,{type:"submit",size:"sm",disabled:!s.canSubmit||s.isSubmitting||s.isValidating||!s.isValid,children:s.isSubmitting?"Saving...":s.isValidating?"Validating...":"Save Bridge Config"}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(i1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function kct(){const{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r,setRetryAttempts:s,setRetryDelay:i,setConnectionTimeout:a,setMaxResponseSize:o}=el(yn(u=>({retryAttempts:u.retryAttempts,retryDelay:u.retryDelay,connectionTimeout:u.connectionTimeout,maxResponseSize:u.maxResponseSize,setRetryAttempts:u.setRetryAttempts,setRetryDelay:u.setRetryDelay,setConnectionTimeout:u.setConnectionTimeout,setMaxResponseSize:u.setMaxResponseSize}))),l=ni({defaultValues:{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r},validators:{onChangeAsync:Sct,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{s(u.retryAttempts),i(u.retryDelay),a(u.connectionTimeout),o(u.maxResponseSize)}});T.useEffect(()=>{l.reset({retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r})},[e,t,n,r,l]);const c=()=>{window.confirm("Reset connection settings to defaults?")&&(s(3),i(2e3),a(1e4),o(128e3))};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Connection Settings"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure retry behavior and timeouts for MCP server connections"})]}),f.jsxs(Vd,{children:[f.jsxs(Wd,{children:[f.jsx(Hd,{className:"text-base",children:"Retry Configuration"}),f.jsx(Y1,{children:"How LiteChat handles failed connections"})]}),f.jsx(Gd,{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsx(l.Field,{name:"retryAttempts",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:u.name,children:"Retry Attempts"}),f.jsx(Cn,{id:u.name,type:"number",min:"0",max:"10",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||0),onBlur:u.handleBlur,placeholder:"3"}),f.jsx(gc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of retry attempts (0-10)"})]})}),f.jsx(l.Field,{name:"retryDelay",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:u.name,children:"Retry Delay (ms)"}),f.jsx(Cn,{id:u.name,type:"number",min:"500",max:"30000",step:"500",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||2e3),onBlur:u.handleBlur,placeholder:"2000"}),f.jsx(gc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Initial delay between retries (500-30000ms)"})]})}),f.jsx(l.Field,{name:"connectionTimeout",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:u.name,children:"Connection Timeout (ms)"}),f.jsx(Cn,{id:u.name,type:"number",min:"1000",max:"60000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||1e4),onBlur:u.handleBlur,placeholder:"10000"}),f.jsx(gc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Connection timeout (1000-60000ms)"})]})}),f.jsx(l.Field,{name:"maxResponseSize",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:u.name,children:"Max Response Size (bytes)"}),f.jsx(Cn,{id:u.name,type:"number",min:"1000",max:"10000000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||128e3),onBlur:u.handleBlur,placeholder:"128000"}),f.jsx(gc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Max tool response size (1KB-10MB)"})]})})]})})]}),f.jsxs(Vd,{children:[f.jsx(Wd,{children:f.jsx(Hd,{className:"text-base",children:"How It Works"})}),f.jsx(Gd,{children:f.jsx("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:f.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[f.jsx("li",{children:"Failed connections will be retried automatically with exponential backoff"}),f.jsx("li",{children:"Toast notifications will show connection status and retry progress"}),f.jsx("li",{children:"Servers that fail all retry attempts will be marked as disconnected"}),f.jsx("li",{children:"You can manually retry connections from the server cards in the Servers tab"}),f.jsxs("li",{children:[f.jsx("strong",{children:"Max Response Size:"})," Tool responses larger than this limit will be automatically truncated to prevent API errors"]})]})})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(l.Subscribe,{children:u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(bt,{type:"submit",size:"sm",disabled:!u.canSubmit||u.isSubmitting||u.isValidating||!u.isValid,children:u.isSubmitting?"Saving...":u.isValidating?"Validating...":"Save Connection Settings"}),f.jsxs(bt,{variant:"outline",size:"sm",onClick:c,type:"button",children:[f.jsx(i1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function PW({server:e,onSubmit:t,onCancel:n}){const r=ni({defaultValues:{name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0},validators:{onChangeAsync:_ct,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{t(s)}});return T.useEffect(()=>{r.reset({name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0})},[e,r]),f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),r.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:e?"Edit MCP Server":"Add New MCP Server"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?"Modify the server configuration below.":"Configure a new MCP server to connect to."})]}),f.jsxs(Vd,{children:[f.jsx(Wd,{children:f.jsxs(Hd,{className:"text-base flex items-center",children:[f.jsx(q0,{className:"mr-2 h-4 w-4"}),"Server Details"]})}),f.jsxs(Gd,{className:"space-y-4",children:[f.jsx(r.Field,{name:"name",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:s.name,children:"Server Name"}),f.jsx(Cn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"My MCP Server"}),f.jsx(gc,{field:s})]})}),f.jsx(r.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:s.name,children:"Server URL"}),f.jsx(Cn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"https://api.example.com/mcp or stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,."}),f.jsx(gc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"HTTP/HTTPS URLs for remote servers, or stdio://command?args=arg1,arg2 for dynamic bridge servers"})]})}),f.jsx(r.Field,{name:"description",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:s.name,children:"Description (Optional)"}),f.jsx(Do,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"Brief description of this server's purpose",rows:2}),f.jsx(gc,{field:s})]})}),f.jsx(r.Field,{name:"headers",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:s.name,children:"Authentication Headers (Optional)"}),f.jsx(Do,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:'{"Authorization": "Bearer your-token-here"}',rows:3}),f.jsx(gc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"JSON object with authentication headers (not applicable for stdio servers)"})]})}),f.jsx(r.Field,{name:"enabled",children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ol,{id:s.name,checked:s.state.value,onCheckedChange:s.handleChange}),f.jsx(Dt,{htmlFor:s.name,children:"Enable this server"})]})})]}),f.jsxs(oVe,{className:"flex gap-2",children:[f.jsx(r.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting],children:([s,i])=>f.jsx(bt,{type:"submit",disabled:!s||i,children:i?e?"Updating...":"Adding...":e?"Update Server":"Add Server"})}),f.jsx(bt,{type:"button",variant:"outline",onClick:n,children:"Cancel"})]})]})]})}function Ect({onNewServer:e,onEditServer:t}){const{servers:n,deleteServer:r,updateServer:s}=el(yn(o=>({servers:o.servers,deleteServer:o.deleteServer,updateServer:o.updateServer}))),i=o=>{window.confirm("Are you sure you want to delete this MCP server?")&&r(o)},a=o=>{s(o.id,{enabled:!o.enabled})};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your Model Context Protocol servers"})]}),f.jsxs(bt,{onClick:e,children:[f.jsx(Pd,{className:"mr-2 h-4 w-4"}),"Add Server"]})]}),n.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx(q0,{className:"h-12 w-12 text-muted-foreground mb-4 mx-auto"}),f.jsx("h4",{className:"font-medium text-muted-foreground",children:"No MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-4",children:"Add HTTP-based MCP servers to extend LiteChat with additional tools and capabilities"}),f.jsxs(bt,{onClick:e,children:[f.jsx(Pd,{className:"mr-2 h-4 w-4"}),"Add Your First Server"]})]}):f.jsxs(of,{children:[f.jsx(np,{children:f.jsxs(ks,{children:[f.jsx(Or,{children:"Name"}),f.jsx(Or,{children:"URL"}),f.jsx(Or,{children:"Status"}),f.jsx(Or,{children:"Description"}),f.jsx(Or,{className:"text-right",children:"Actions"})]})}),f.jsx(lf,{children:n.map(o=>f.jsxs(ks,{children:[f.jsx(zn,{className:"font-medium",children:o.name}),f.jsx(zn,{className:"max-w-xs truncate font-mono text-xs",children:o.url}),f.jsx(zn,{children:f.jsx(mi,{variant:o.enabled?"default":"secondary",children:o.enabled?f.jsxs(f.Fragment,{children:[f.jsx(kpe,{className:"mr-1 h-3 w-3"}),"Enabled"]}):f.jsxs(f.Fragment,{children:[f.jsx(Ipe,{className:"mr-1 h-3 w-3"}),"Disabled"]})})}),f.jsx(zn,{className:"max-w-xs truncate",children:o.description||""}),f.jsx(zn,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[f.jsx(ol,{checked:o.enabled,onCheckedChange:()=>a(o),className:"scale-75"}),f.jsx(bt,{variant:"ghost",size:"sm",onClick:()=>t(o),children:f.jsx(S0,{className:"h-4 w-4"})}),f.jsx(bt,{variant:"ghost",size:"sm",onClick:()=>i(o.id),children:f.jsx(Mge,{className:"h-4 w-4"})})]})})]},o.id))})]})]})}const Tct=()=>{const[e,t]=T.useState("servers"),[n,r]=T.useState(),{addServer:s,updateServer:i}=el(yn(h=>({addServer:h.addServer,updateServer:h.updateServer}))),a=async h=>{try{const m=h.headers?JSON.parse(h.headers):void 0;s({name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers")}catch(m){console.error("Invalid headers JSON:",m),Oe.error("Invalid JSON in headers field")}},o=async h=>{if(n)try{const m=h.headers?JSON.parse(h.headers):void 0;i(n.id,{name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers"),r(void 0)}catch(m){console.error("Invalid headers JSON:",m),Oe.error("Invalid JSON in headers field")}},l=()=>{r(void 0),t("new")},c=h=>{r(h),t("edit")},u=()=>{t("servers"),r(void 0)},d=[{value:"servers",label:"Servers",content:f.jsx(Ect,{onNewServer:l,onEditServer:c})},{value:"bridge",label:"Bridge Config",content:f.jsx(Cct,{})},{value:"connection",label:"Connection",content:f.jsx(kct,{})},{value:"new",label:"Add Server",content:f.jsx(PW,{onSubmit:a,onCancel:u},"new-server-form")}];return n&&d.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(PW,{server:n,onSubmit:o,onCancel:u},`edit-server-form-${n.id}`)}),f.jsx(Dc,{tabs:d,initialValue:e,onValueChange:t,defaultValue:"servers",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},Act=()=>{const{resetAssistantSettings:e}=yr(yn(r=>({resetAssistantSettings:r.resetAssistantSettings}))),t=()=>{window.confirm("Are you sure you want to reset all Assistant settings (Prompt, Parameters, Tools, Auto-Title) to their defaults?")&&e()},n=T.useMemo(()=>[{value:"prompt",label:"System Prompt",content:f.jsx(uct,{})},{value:"parameters",label:"Parameters",content:f.jsx(fct,{})},{value:"tools",label:"Tools",content:f.jsx(mct,{})},{value:"mcp",label:"MCP",content:f.jsx(Tct,{})},{value:"titles",label:"Auto-Titles",content:f.jsx(yct,{})},{value:"prompts",label:"Prompts",content:f.jsx(wct,{})}],[]);return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(Dc,{tabs:n,defaultValue:"prompt",className:"flex-grow",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-3",scrollable:!1}),f.jsx(Zd,{className:"mt-auto"}),f.jsx("div",{className:"flex justify-end pt-3 flex-shrink-0",children:f.jsxs(bt,{variant:"outline",size:"sm",onClick:t,children:[f.jsx(i1,{className:"mr-2 h-4 w-4"}),"Reset All Assistant Settings"]})})]})},Rct=We.memo(Act);class Nct{constructor(){ve(this,"id","core-settings-assistant");ve(this,"unregisterCallback",null);ve(this,"modApiRef",null);ve(this,"eventUnsubscribers",[]);ve(this,"isVisible",!1)}async initialize(t){this.modApiRef=t,this.isVisible=yr.getState().enableAdvancedSettings;const n=t.on(sn.enableAdvancedSettingsChanged,r=>{typeof r=="object"&&r&&"enabled"in r&&this.isVisible!==r.enabled&&(this.isVisible=r.enabled,this.reregisterTab())});this.eventUnsubscribers.push(n)}reregisterTab(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef&&this.register(this.modApiRef)}register(t){this.modApiRef=t,this.isVisible?this.unregisterCallback||(this.unregisterCallback=t.registerSettingsTab({id:"assistant",title:"Assistant",component:Rct,order:40})):this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Mct=Ke({importSettings:br(),importApiKeys:br(),importProviderConfigs:br(),importProjects:br(),importConversations:br(),importRulesAndTags:br(),importMods:br(),importSyncRepos:br()}),Ict=Ke({importSettings:br(),importApiKeys:br(),importProviderConfigs:br(),importProjects:br(),importConversations:br(),importRulesAndTags:br(),importMods:br(),importSyncRepos:br()}),jct=()=>{const{importConversation:e,exportAllConversations:t}=qn(yn(N=>({importConversation:N.importConversation,exportAllConversations:N.exportAllConversations}))),n=T.useRef(null),r=T.useRef(null),[s,i]=T.useState(!1),[a,o]=T.useState(!1),[l,c]=T.useState(!1),[u,d]=T.useState(!1),[h,m]=T.useState(!1),y=ni({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0},validators:{onChange:Mct}}),b=ni({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0},validators:{onChange:Ict}}),v=()=>{var N;(N=n.current)==null||N.click()},x=()=>{var N;(N=r.current)==null||N.click()},w=T.useCallback(async N=>{var O;const I=(O=N.target.files)==null?void 0:O[0];if(I){i(!0);try{await e(I)}catch(L){console.error("Import failed (from component):",L)}finally{n.current&&(n.current.value=""),i(!1)}}},[e]),S=T.useCallback(async N=>{var O;const I=(O=N.target.files)==null?void 0:O[0];if(I){if(!window.confirm("Importing this file will OVERWRITE existing data for the selected categories. Are you sure you want to proceed?")){r.current&&(r.current.value="");return}m(!0);try{await m0.importFullConfiguration(I,y.state.values)}catch(L){console.error("Full import failed (from component):",L)}finally{r.current&&(r.current.value=""),m(!1)}}},[y]),C=T.useCallback(async()=>{o(!0);try{await t()}catch(N){console.error("Export all failed (from component):",N)}finally{o(!1)}},[t]),k=T.useCallback(async()=>{d(!0);try{await m0.exportFullConfiguration(b.state.values)}catch(N){console.error("Full export failed (from component):",N)}finally{d(!1)}},[b]),A=T.useCallback(async()=>{if(window.confirm(` ARE YOU ABSOLUTELY SURE? 

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){c(!0);try{await Et.clearAllData(),Oe.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(N){const I="Failed to clear all data";console.error(I,N),Oe.error(`${I}: ${N instanceof Error?N.message:String(N)}`),c(!1)}}},[]),R=(N,I,O,L,P,V)=>{const F=`${V}-${I}-checkbox`;return f.jsx(N.Field,{name:I,children:X=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Hl,{id:F,checked:X.state.value,onCheckedChange:U=>X.handleChange(!!U),disabled:P}),f.jsxs(Dt,{htmlFor:F,className:"text-sm font-normal flex items-center gap-1.5",children:[f.jsx(L,{className:"h-4 w-4 text-muted-foreground"})," ",O]})]})},I)};return f.jsxs("div",{className:"space-y-4 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Single Conversation"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(Dt,{className:"font-semibold",children:"Import Conversation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import a previously exported single conversation (.json file)."}),f.jsx("input",{type:"file",ref:n,onChange:w,accept:".json",className:"hidden",id:"import-file-input",disabled:s}),f.jsxs(bt,{onClick:v,variant:"outline",size:"sm",disabled:s,children:[s?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(mH,{className:"mr-2 h-4 w-4"}),s?"Importing...":"Select File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(Dt,{className:"font-semibold",children:"Export All Conversations"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all conversations and messages into a single JSON file."}),f.jsxs(bt,{onClick:C,variant:"outline",size:"sm",disabled:a,children:[a?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(pu,{className:"mr-2 h-4 w-4"}),a?"Exporting...":"Export All Chats"]})]})]})]}),f.jsx(Zd,{}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Full Configuration Backup"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(Dt,{className:"font-semibold",children:"Import Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import settings, providers, keys, projects, conversations, etc., from a backup file. Select which data types to restore."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[R(y,"importSettings","Settings",Q2,h,"import"),R(y,"importApiKeys","API Keys",Dx,h,"import"),R(y,"importProviderConfigs","Providers",q0,h,"import"),R(y,"importProjects","Projects",pB,h,"import"),R(y,"importConversations","Conversations",U3,h,"import"),R(y,"importRulesAndTags","Rules & Tags",q3,h,"import"),R(y,"importMods","Mods",yB,h,"import"),R(y,"importSyncRepos","Sync Repos",Sc,h,"import")]}),f.jsx("input",{type:"file",ref:r,onChange:S,accept:".json",className:"hidden",id:"full-import-file-input",disabled:h}),f.jsxs(bt,{onClick:x,variant:"outline",size:"sm",disabled:h,children:[h?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(ame,{className:"mr-2 h-4 w-4"}),h?"Importing...":"Select Backup File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(Dt,{className:"font-semibold",children:"Export Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all settings, providers, keys, projects, conversations, rules, tags, mods, etc., into a single backup file. Select which data types to include."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[R(b,"importSettings","Settings",Q2,u,"export"),R(b,"importApiKeys","API Keys",Dx,u,"export"),R(b,"importProviderConfigs","Providers",q0,u,"export"),R(b,"importProjects","Projects",pB,u,"export"),R(b,"importConversations","Conversations",U3,u,"export"),R(b,"importRulesAndTags","Rules & Tags",q3,u,"export"),R(b,"importMods","Mods",yB,u,"export"),R(b,"importSyncRepos","Sync Repos",Sc,u,"export")]}),f.jsxs(bt,{onClick:k,variant:"secondary",size:"sm",disabled:u,children:[u?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Jpe,{className:"mr-2 h-4 w-4"}),u?"Exporting...":"Export Configuration"]})]})]})]}),f.jsx(Zd,{}),f.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[f.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),f.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),f.jsxs(bt,{onClick:A,variant:"destructive",disabled:l,children:[l?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Eo,{className:"mr-2 h-4 w-4"}),l?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},Oct=We.memo(jct);class Pct{constructor(){ve(this,"id","core-settings-data");ve(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"data",title:"Data",component:Oct,order:70})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Dct=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:s,isLoading:i}=jh(yn(A=>({loadedMods:A.loadedMods,addDbMod:A.addDbMod,updateDbMod:A.updateDbMod,deleteDbMod:A.deleteDbMod,dbMods:A.dbMods,isLoading:A.isLoading}))),[a,o]=T.useState(""),[l,c]=T.useState(""),[u,d]=T.useState(""),[h,m]=T.useState(!1),[y,b]=T.useState({}),[v,x]=T.useState({}),w=T.useCallback(async()=>{if(!a.trim()){Oe.error("Mod name cannot be empty.");return}if(!l.trim()&&!u.trim()){Oe.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&u.trim()){Oe.error("Provide either a Mod URL or Script Content, not both.");return}m(!0);try{const A={name:a.trim(),sourceUrl:l.trim()||null,scriptContent:u.trim()||null,enabled:!0,loadOrder:((s==null?void 0:s.length)??1)*10};await t(A),o(""),c(""),d(""),Oe.info("Mod added. Reload required for changes to take effect.")}catch(A){console.error("Failed to add mod (from component):",A)}finally{m(!1)}},[a,l,u,t,s==null?void 0:s.length]),S=T.useCallback(async A=>{b(R=>({...R,[A.id]:!0}));try{await n(A.id,{enabled:!A.enabled}),Oe.info(`Mod "${A.name}" ${A.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(R){console.error("Failed to update mod (from component):",R)}finally{b(R=>({...R,[A.id]:!1}))}},[n]),C=T.useCallback(async A=>{if(window.confirm(`Are you sure you want to delete the mod "${A.name}"? This cannot be undone.`)){x(R=>({...R,[A.id]:!0}));try{await r(A.id),Oe.info("Mod deleted. Reload required for changes to take effect.")}catch(R){console.error("Failed to delete mod (from component):",R)}finally{x(R=>({...R,[A.id]:!1}))}}},[r]),k=T.useCallback(A=>{const R=e.find(I=>I.id===A);if(R)if(R.error){const I=R.error instanceof Error?R.error.message:String(R.error);return{status:"Error",error:R.error,tooltip:I}}else return{status:"Loaded"};const N=(s||[]).find(I=>I.id===A);return N?N.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,s]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs(Aue,{variant:"destructive",className:"border-destructive/50",children:[f.jsx(PO,{className:"h-4 w-4"}),f.jsx(Rue,{children:"Security Warning"}),f.jsx(Nue,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),f.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:"mod-name",children:"Mod Name"}),f.jsx(Cn,{id:"mod-name",value:a,onChange:A=>o(A.target.value),placeholder:"My Awesome Mod",disabled:h})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:"mod-url",children:"Source URL (Optional)"}),f.jsx(Cn,{id:"mod-url",type:"url",value:l,onChange:A=>c(A.target.value),placeholder:"https://example.com/my-mod.js",disabled:h||!!u.trim()})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Dt,{htmlFor:"mod-script",children:"Script Content (Optional)"}),f.jsx(Do,{id:"mod-script",value:u,onChange:A=>d(A.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:h||!!l.trim()})]}),f.jsxs(bt,{onClick:w,disabled:h,children:[h&&f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}),h?"Adding...":"Add Mod"]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),f.jsx("div",{className:"rounded-md border",children:f.jsx(xr,{delayDuration:100,children:f.jsxs(of,{children:[f.jsx(np,{children:f.jsxs(ks,{children:[f.jsx(Or,{children:"Name"}),f.jsx(Or,{children:"Source"}),f.jsx(Or,{children:"Status"}),f.jsx(Or,{className:"text-center",children:"Enabled"}),f.jsx(Or,{className:"text-right",children:"Actions"})]})}),f.jsx(lf,{children:i?f.jsxs(f.Fragment,{children:[f.jsx(ks,{children:f.jsx(zn,{colSpan:5,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(ks,{children:f.jsx(zn,{colSpan:5,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):(s||[]).length===0?f.jsx(ks,{children:f.jsx(zn,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(s||[]).map(A=>{const{status:R,error:N,tooltip:I}=k(A.id),O=A.sourceUrl?new URL(A.sourceUrl).hostname:"Direct Script",L=y[A.id],P=v[A.id],V=L||P,F=R==="Error";return f.jsxs(ks,{children:[f.jsx(zn,{className:"font-medium",children:A.name}),f.jsx(zn,{className:"text-muted-foreground",children:O}),f.jsxs(zn,{children:[f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:F?"text-destructive font-semibold cursor-help":"",children:R})}),I&&f.jsx(Sr,{className:"max-w-xs break-words",children:f.jsx("p",{children:I})})]}),F&&N&&f.jsx("p",{className:"text-xs text-destructive truncate",children:N instanceof Error?N.message:String(N)})]}),f.jsxs(zn,{className:"text-center",children:[f.jsx(ol,{checked:A.enabled??!1,onCheckedChange:()=>S(A),disabled:V,"aria-label":`Enable ${A.name}`}),L&&f.jsx(Qn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),f.jsx(zn,{className:"text-right",children:f.jsx(bt,{variant:"ghost",size:"icon",onClick:()=>C(A),disabled:V,"aria-label":`Delete ${A.name}`,className:"text-destructive hover:text-destructive/80",children:P?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Eo,{className:"h-4 w-4"})})})]},A.id)})})]})})})]})]})},Fct=We.memo(Dct);class Lct{constructor(){ve(this,"id","core-settings-mods");ve(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"mods",title:"Mods",component:Fct,order:80})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Bct=({interactionId:e,contentToCopy:t,disabled:n})=>{const[r]=T.useState(!1),s=T.useCallback(async i=>{if(i.stopPropagation(),n||!t){Oe.info("No content to copy or action disabled.");return}je.emit(fc.copyInteractionResponseRequest,{interactionId:e})},[e,t,n]);return f.jsx(On,{tooltipText:"Copy",onClick:s,"aria-label":"Copy content",disabled:n||!t,icon:r?f.jsx(ro,{className:"text-green-500"}):f.jsx(lE,{}),className:"h-5 w-5"})};class $ct{constructor(){ve(this,"id","core-canvas-copy-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>n.interactionId?We.createElement(Bct,{interactionId:n.interactionId,contentToCopy:n.responseContent??"",disabled:!n.responseContent||n.responseContent.trim()===""}):(console.warn("CopyActionControlModule: interactionId is missing in context for an interaction control."),null)})}destroy(t){}}const zct=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){Oe.info("Regeneration is currently disabled.");return}je.emit(fc.regenerateInteractionRequest,{interactionId:e})};return f.jsx(On,{tooltipText:"Regenerate",onClick:n,"aria-label":"Regenerate Response",disabled:t,icon:f.jsx(am,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class Uct{constructor(){ve(this,"id","core-canvas-regenerate-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=Bn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,c=(o==null?void 0:o.id)===r.id&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return We.createElement(zct,{interactionId:r.id,disabled:!c})}})}destroy(t){}}const qct=({module:e,interactionId:t,disabled:n})=>{const[r,s]=T.useState(!1),[,i]=T.useState({});T.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),je.emit(fc.regenerateInteractionWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){Oe.info("Regeneration is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(W5,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(On,{tooltipText:"Regenerate with Model",onClick:o,"aria-label":"Regenerate Response with Model Selection",disabled:n,icon:f.jsx(Ome,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class Vct{constructor(){ve(this,"id","core-canvas-regenerate-with-model-action");ve(this,"eventUnsubscribers",[]);ve(this,"notifyComponentUpdate",null);ve(this,"globallyEnabledModels",[]);ve(this,"isLoadingProviders",!0)}async initialize(t){const n=Rr.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(dr.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Rr.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(dr.initialDataLoaded,()=>{var c;const a=Rr.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(Zn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=Bn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,c=(o==null?void 0:o.id)===r.id&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return We.createElement(qct,{module:this,interactionId:r.id,disabled:!c})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const Wct=({interactionId:e,currentRating:t})=>{const n=s=>{const i=s===t?null:s;je.emit(Zn.rateInteractionRequest,{interactionId:e,rating:i})},r=Array.from({length:11},(s,i)=>i-5);return f.jsx("div",{className:"flex items-center gap-1",children:r.map(s=>{let i="";s===-5?i="Terrible":s===-4?i="Very Bad":s===-3?i="Bad":s===-2?i="Poor":s===-1?i="Below Average":s===0?i="Neutral":s===1?i="Above Average":s===2?i="Good":s===3?i="Very Good":s===4?i="Excellent":s===5&&(i="Perfect");let a="text-muted-foreground",o="hover:text-foreground",l="";s<0?(o="hover:text-red-500",t===s&&(a="text-red-500",l="fill-red-500")):s===0?(o="hover:text-gray-500",t===s&&(a="text-gray-500",l="fill-gray-500")):(o="hover:text-green-500",t===s&&(a="text-green-500",l="fill-green-500"));const c=t===s?"bg-muted":"";return f.jsx(On,{tooltipText:i,onClick:()=>n(s),"aria-label":`Rate response as ${i}`,icon:f.jsx(kge,{className:Ze(l,t===s?"fill-current":"fill-none")}),variant:"ghost",className:Ze("h-4 w-4 md:h-5 md:w-5 p-0",a,o,c)},s)})})};class Hct{constructor(){ve(this,"id","core-canvas-rating-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>!n.interactionId||!n.interaction?null:We.createElement(Wct,{interactionId:n.interactionId,currentRating:n.interaction.rating})})}destroy(t){}}const Gct=({interactionId:e,response:t,disabled:n})=>{const[r,s]=T.useState(!1),[i,a]=T.useState(""),o=u=>{if(u.stopPropagation(),n){Oe.info("Response editing is currently disabled.");return}a(t||""),s(!0)},l=()=>{if(i.trim()===""){Oe.error("Response cannot be empty");return}je.emit(fc.editResponseRequest,{interactionId:e,newContent:i.trim()}),s(!1),Oe.success("Response edited successfully")},c=()=>{s(!1),a("")};return f.jsxs(f.Fragment,{children:[f.jsx(On,{tooltipText:"Edit Response",onClick:o,"aria-label":"Edit Assistant Response",disabled:n,icon:f.jsx(hH,{}),className:"h-5 max-w-7xl md:h-6 md:max-w-6xl"}),f.jsx(Ym,{open:r,onOpenChange:s,children:f.jsxs(Zm,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsx(Xm,{children:f.jsx(Jm,{children:"Edit Assistant Response"})}),f.jsx("div",{className:"flex-1 space-y-4 overflow-hidden",children:f.jsxs("div",{className:"space-y-2 h-full",children:[f.jsx(Dt,{htmlFor:"response-edit",children:"Response Content"}),f.jsx(Do,{id:"response-edit",value:i,onChange:u=>a(u.target.value),placeholder:"Edit the assistant's response...",className:"min-h-[60vh] h-full resize-none text-sm leading-relaxed"})]})}),f.jsxs(ub,{className:"flex-shrink-0",children:[f.jsx(bt,{variant:"outline",onClick:c,children:"Cancel"}),f.jsx(bt,{onClick:l,children:"Save Changes"})]})]})})]})};class Kct{constructor(){ve(this,"id","core-canvas-edit-response-action");ve(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(fc.editResponseRequest,async r=>{await this.handleResponseEdit(r.interactionId,r.newContent)});this.eventUnsubscribers.push(n)}async handleResponseEdit(t,n){var r;try{const s=Bn.getState(),i=s.interactions.find(y=>y.id===t);if(!i)throw new Error("Original interaction not found");if(i.status!=="COMPLETED")throw new Error("Can only edit completed interactions");const a=qi(),o={...i,id:a,response:n,parentId:null,index:i.index,metadata:{...i.metadata,editedResponse:!0,editedFromId:i.id},endedAt:new Date};s._addInteractionToState(o);const l=s.interactions.filter(y=>y.parentId===i.id),c=[];let u=i;for(;u;){c.push(u);const y=(r=u.metadata)==null?void 0:r.editedFromId;y?u=s.interactions.find(b=>b.id===y):u=void 0}const d=c.sort((y,b)=>{var w,S;const v=((w=y.startedAt)==null?void 0:w.getTime())??0,x=((S=b.startedAt)==null?void 0:S.getTime())??0;return v-x}),h=d.map(async(y,b)=>{const v={parentId:a,index:b,metadata:{...y.metadata,originalVersion:b===0}};return console.log(`[EditResponseControlModule] Updating version ${y.id} to be child of ${a} with childIndex ${b}`),s._updateInteractionInState(y.id,v),Et.saveInteraction({...y,...v})}),m=l.map(async y=>{const b={parentId:a,index:d.length+y.index};return s._updateInteractionInState(y.id,b),Et.saveInteraction({...y,...b})});await Promise.all([Et.saveInteraction(o),...h,...m]),console.log(`[EditResponseControlModule] Response edited successfully. Original: ${t}, Edited: ${a}`)}catch(s){throw console.error("[EditResponseControlModule] Failed to edit response:",s),s}}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=Bn.getState().status,a=r.status==="COMPLETED"&&r.response&&typeof r.response=="string"&&i!=="streaming"&&(r.type==="message.user_assistant"||r.type==="message.assistant_regen");return a?We.createElement(Gct,{interactionId:r.id,response:r.response,disabled:!a}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}const Yct=({context:e})=>{const t=()=>{Oe.info(`Example Canvas Action Clicked! Interaction ID: ${e.interactionId}`)};return f.jsxs(bt,{variant:"outline",size:"sm",onClick:t,className:"h-6 px-2 text-xs",children:[f.jsx(bge,{className:"h-3 w-3 mr-1"})," Example Action"]})};class Zct{constructor(){ve(this,"id","example-canvas-control-module")}async initialize(t){}register(t){t.registerCanvasControl({id:"example-canvas-action",type:"interaction",targetSlot:"actions",renderer:n=>We.createElement(Yct,{context:n})})}destroy(t){}}const Xct=({isFolded:e,toggleFold:t,canFold:n})=>{if(!n)return null;const r=s=>{s.stopPropagation(),t()};return f.jsx(On,{tooltipText:e?"Unfold":"Fold",onClick:r,"aria-label":e?"Unfold response":"Fold response",icon:e?f.jsx(Nc,{}):f.jsx(Dh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})};class Jct{constructor(){ve(this,"id","core-canvas-fold-interaction")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.toggleFold||n.isFolded===void 0?null:We.createElement(Xct,{isFolded:n.isFolded,toggleFold:n.toggleFold,canFold:!0})})}destroy(t){}}const Qct=({context:e})=>{const t=aT(e.responseContent||""),n=T.useMemo(()=>{const s=[];return t.forEach(i=>{if(typeof i=="object"&&i.type==="code"){const a=i;a.filepath&&a.filepath.trim()&&s.push({filepath:a.filepath,code:a.code,lang:a.lang})}}),s},[t]),r=T.useCallback(async()=>{var s;if(n.length===0){Oe.info("No code blocks with filepaths found to download");return}try{const i=new XP,a=new Set;n.forEach(({filepath:h,code:m})=>{const y=h.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),b=y.split("/");if(b.length>1)for(let w=1;w<b.length;w++){const S=b.slice(0,w).join("/");a.has(S)||(i.folder(S),a.add(S))}let v=y,x=1;for(;i.file(v);){const w=y.lastIndexOf(".");if(w>0){const S=y.substring(0,w),C=y.substring(w);v=`${S}_${x}${C}`}else v=`${y}_${x}`;x++}i.file(v,m)});const o=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l;const u=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-"),d=((s=e.interactionId)==null?void 0:s.slice(0,8))||"unknown";c.download=`codeblocks_${d}_${u}.zip`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),Oe.success(`Downloaded ${n.length} code files as ZIP`)}catch(i){console.error("ZIP download failed:",i),Oe.error("Failed to create ZIP file")}},[n,e.interactionId]);return n.length===0?null:f.jsx(On,{tooltipText:`Download ${n.length} code files as ZIP`,onClick:r,"aria-label":"Download code blocks as ZIP file",icon:f.jsx(rH,{}),iconClassName:"h-4 w-4",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class eut{constructor(){ve(this,"id","core-interaction-zip-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.interactionId||!n.responseContent?null:We.createElement(Qct,{context:n})})}destroy(t){}}const tut=({interactionId:e,codeBlockId:t,language:n,codeToCopy:r,disabled:s})=>{const[i,a]=T.useState(!1),o=T.useCallback(async l=>{l.stopPropagation(),!(s||!r)&&(je.emit(fc.copyCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,content:r}),a(!0),setTimeout(()=>a(!1),1500))},[e,t,n,r,s]);return f.jsx(On,{tooltipText:"Copy Code",onClick:o,"aria-label":"Copy code block",disabled:s||!r,icon:i?f.jsx(ro,{className:"text-green-500"}):f.jsx(lE,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class nut{constructor(){ve(this,"id","core-codeblock-copy")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>We.createElement(tut,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToCopy:n.codeBlockContent??"",disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const rut=({isFolded:e,toggleFold:t})=>{const n=r=>{r.stopPropagation(),t()};return f.jsx(On,{tooltipText:e?"Unfold Code":"Fold Code",onClick:n,"aria-label":e?"Unfold code block":"Fold code block",icon:f.jsx(aE,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class sut{constructor(){ve(this,"id","core-codeblock-fold")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>n.toggleFold===void 0||n.isFolded===void 0?null:We.createElement(rut,{isFolded:n.isFolded,toggleFold:n.toggleFold})})}destroy(t){}}const iut=({interactionId:e,codeBlockId:t,language:n,codeToDownload:r,filepath:s,disabled:i})=>{const a=T.useCallback(l=>{if(l.stopPropagation(),!(i||!r))try{let c;if(s){const m=s.split("/");c=m[m.length-1]}else c=`code${aut(n)}`;const u=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(d),Oe.success(`Downloaded ${c}`)}catch(c){console.error("Download failed:",c),Oe.error("Failed to download file")}},[e,t,n,r,s,i]);return s||r&&r.trim().length>5e3?f.jsx(On,{tooltipText:"Download File",onClick:a,"aria-label":"Download code as file",disabled:i||!r,icon:f.jsx(pu,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null};function aut(e){return e&&{javascript:".js",js:".js",typescript:".ts",ts:".ts",tsx:".tsx",jsx:".jsx",python:".py",py:".py",java:".java",c:".c",cpp:".cpp",cxx:".cxx",cc:".cc","c++":".cpp",csharp:".cs",cs:".cs",php:".php",ruby:".rb",rb:".rb",go:".go",rust:".rs",rs:".rs",swift:".swift",kotlin:".kt",kt:".kt",scala:".scala",html:".html",css:".css",scss:".scss",sass:".sass",less:".less",json:".json",xml:".xml",yaml:".yaml",yml:".yml",toml:".toml",ini:".ini",conf:".conf",config:".config",sh:".sh",bash:".sh",zsh:".zsh",fish:".fish",powershell:".ps1",ps1:".ps1",bat:".bat",cmd:".cmd",sql:".sql",r:".r",matlab:".m",octave:".m",lua:".lua",perl:".pl",vim:".vim",dockerfile:"Dockerfile",makefile:"Makefile",markdown:".md",md:".md",tex:".tex",latex:".tex"}[e.toLowerCase()]||".txt"}class out{constructor(){ve(this,"id","core-codeblock-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>We.createElement(iut,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToDownload:n.codeBlockContent??"",filepath:n.codeBlockFilepath,disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const lut=({toolCall:e})=>{const[t,n]=T.useState(!0),r=()=>n(i=>!i),s=T.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return f.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(On,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?f.jsx(Nc,{}):f.jsx(Dh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Fy,{lang:"json",code:s})]})},cut=({toolResult:e})=>{const[t,n]=T.useState(!0),r=()=>n(a=>!a),s=T.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),i=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return f.jsxs("div",{className:Ze("my-2 p-2 border rounded-md text-xs",i?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:Ze("font-semibold",i?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(On,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?f.jsx(Nc,{}):f.jsx(Dh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Fy,{lang:i?"text":"json",code:s})]})},uut=({interactionId:e,toolCall:t,toolResult:n})=>f.jsxs("div",{className:"tool-call-step my-1","data-interaction-id":e,"data-tool-call-id":t.toolCallId,children:[f.jsx(lut,{toolCall:t}),n&&f.jsx(cut,{toolResult:n})]});class dut{constructor(){ve(this,"id","core-tool-call-step-display")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"tool-call-step",targetSlot:"tool-call-content",renderer:n=>!n.interactionId||!n.toolCall?(console.warn("[ToolCallStepControlModule] Missing interactionId or toolCall in context"),null):We.createElement(uut,{interactionId:n.interactionId,toolCall:n.toolCall,toolResult:n.toolResult})})}destroy(t){}}const fut=[Wst,Xat,sot,oct,Nct,Pct,Lct,bQe,_et,xet,mst,gst,qst,Cst,Est,Ast,Gst,Zet,Qnt,zst,bst,Ort,Het,wst,Yst,Gat,mrt,yrt,Crt,Nrt,Mrt,$ct,Jct,eut,Uct,Vct,Kct,Hct,nut,sut,out,Zct,dut];function hut(){return f.jsxs(pQe,{children:[f.jsx(fQe,{}),f.jsx(dQe,{}),f.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:f.jsx("main",{className:"flex-grow overflow-hidden",children:f.jsx(iQe,{controls:fut})})})]})}n0e();che.createRoot(document.getElementById("root")).render(f.jsx(We.StrictMode,{children:f.jsx(hut,{})}));export{dDe as $,yx as A,vIe as B,d3e as C,t6 as D,Ro as E,_X as F,oFe as G,vLe as H,gU as I,vje as J,TIe as K,yy as L,Out as M,CT as N,xD as O,o7 as P,mDe as Q,F2 as R,aFe as S,$1 as T,QIe as U,B1 as V,wn as W,$n as X,IX as Y,J5e as Z,ie as _,i3e as a,VMe as a$,zD as a0,$ut as a1,qut as a2,Zg as a3,O7 as a4,j7 as a5,Wut as a6,Vut as a7,Uut as a8,Lut as a9,K5e as aA,$6e as aB,z5e as aC,HD as aD,CU as aE,JFe as aF,fDe as aG,_a as aH,hT as aI,qje as aJ,Uje as aK,$m as aL,Y5e as aM,_ee as aN,vT as aO,ST as aP,Ck as aQ,Cee as aR,wee as aS,k5e as aT,Co as aU,LOe as aV,DD as aW,RQ as aX,q1 as aY,IQ as aZ,Fut as a_,But as aa,Gut as ab,zut as ac,Hut as ad,k8e as ae,Ene as af,Qut as ag,wje as ah,Vi as ai,Zh as aj,jD as ak,ete as al,qm as am,Nee as an,lr as ao,Ru as ap,h0 as aq,gLe as ar,Jut as as,edt as at,Zut as au,Nn as av,Xut as aw,J8e as ax,K8e as ay,G8e as az,s3e as b,FD as b0,rh as b1,T7 as b2,WOe as b3,Cw as b4,G5e as b5,$5e as b6,T6e as b7,GD as b8,w5e as b9,Ai as bA,Zr as bB,X5e as ba,W1 as bb,eb as bc,wk as bd,I5e as be,$Le as bf,V1 as bg,Sk as bh,E5e as bi,mee as bj,N6e as bk,M6e as bl,Dp as bm,Y7 as bn,I6e as bo,KD as bp,R6e as bq,P6e as br,tb as bs,Yh as bt,V7 as bu,YD as bv,yee as bw,C4 as bx,Z5e as by,_T as bz,as as c,Kr as d,MX as e,va as f,o3e as g,qd as h,ym as i,Gje as j,Qy as k,zt as l,Iee as m,Put as n,ndt as o,l3e as p,c3e as q,tdt as r,a3e as s,xje as t,lu as u,V8e as v,uFe as w,Kut as x,r3e as y,Dut as z};
