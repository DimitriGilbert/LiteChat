var eZ=Object.defineProperty;var tZ=(e,t,n)=>t in e?eZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ne=(e,t,n)=>tZ(e,typeof t!="symbol"?t+"":t,n);function nZ(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ni(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lE={exports:{}},Ug={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s4;function rZ(){if(s4)return Ug;s4=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:e,type:r,key:a,ref:s!==void 0?s:null,props:i}}return Ug.Fragment=t,Ug.jsx=n,Ug.jsxs=n,Ug}var i4;function sZ(){return i4||(i4=1,lE.exports=rZ()),lE.exports}var p=sZ(),cE={exports:{}};function iZ(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var M8={exports:{}},Es=M8.exports={},yl,bl;function yT(){throw new Error("setTimeout has not been defined")}function bT(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?yl=setTimeout:yl=yT}catch{yl=yT}try{typeof clearTimeout=="function"?bl=clearTimeout:bl=bT}catch{bl=bT}})();function O8(e){if(yl===setTimeout)return setTimeout(e,0);if((yl===yT||!yl)&&setTimeout)return yl=setTimeout,setTimeout(e,0);try{return yl(e,0)}catch{try{return yl.call(null,e,0)}catch{return yl.call(this,e,0)}}}function aZ(e){if(bl===clearTimeout)return clearTimeout(e);if((bl===bT||!bl)&&clearTimeout)return bl=clearTimeout,clearTimeout(e);try{return bl(e)}catch{try{return bl.call(null,e)}catch{return bl.call(this,e)}}}var xc=[],bp=!1,pf,qw=-1;function oZ(){!bp||!pf||(bp=!1,pf.length?xc=pf.concat(xc):qw=-1,xc.length&&P8())}function P8(){if(!bp){var e=O8(oZ);bp=!0;for(var t=xc.length;t;){for(pf=xc,xc=[];++qw<t;)pf&&pf[qw].run();qw=-1,t=xc.length}pf=null,bp=!1,aZ(e)}}Es.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];xc.push(new D8(e,t)),xc.length===1&&!bp&&O8(P8)};function D8(e,t){this.fun=e,this.array=t}D8.prototype.run=function(){this.fun.apply(null,this.array)};Es.title="browser";Es.browser=!0;Es.env={};Es.argv=[];Es.version="";Es.versions={};function $c(){}Es.on=$c;Es.addListener=$c;Es.once=$c;Es.off=$c;Es.removeListener=$c;Es.removeAllListeners=$c;Es.emit=$c;Es.prependListener=$c;Es.prependOnceListener=$c;Es.listeners=function(e){return[]};Es.binding=function(e){throw new Error("process.binding is not supported")};Es.cwd=function(){return"/"};Es.chdir=function(e){throw new Error("process.chdir is not supported")};Es.umask=function(){return 0};var lZ=M8.exports;const vs=iZ(lZ);var Vn={},a4;function cZ(){if(a4)return Vn;a4=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),f=Symbol.iterator;function m(Y){return Y===null||typeof Y!="object"?null:(Y=f&&Y[f]||Y["@@iterator"],typeof Y=="function"?Y:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,b={};function w(Y,te,Q){this.props=Y,this.context=te,this.refs=b,this.updater=Q||g}w.prototype.isReactComponent={},w.prototype.setState=function(Y,te){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,te,"setState")},w.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function x(){}x.prototype=w.prototype;function _(Y,te,Q){this.props=Y,this.context=te,this.refs=b,this.updater=Q||g}var E=_.prototype=new x;E.constructor=_,v(E,w.prototype),E.isPureReactComponent=!0;var C=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},R=Object.prototype.hasOwnProperty;function I(Y,te,Q,ae,xe,ge){return Q=ge.ref,{$$typeof:e,type:Y,key:te,ref:Q!==void 0?Q:null,props:ge}}function j(Y,te){return I(Y.type,te,void 0,void 0,void 0,Y.props)}function M(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===e}function L(Y){var te={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(Q){return te[Q]})}var q=/\/+/g;function P(Y,te){return typeof Y=="object"&&Y!==null&&Y.key!=null?L(""+Y.key):te.toString(36)}function V(){}function z(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(V,V):(Y.status="pending",Y.then(function(te){Y.status==="pending"&&(Y.status="fulfilled",Y.value=te)},function(te){Y.status==="pending"&&(Y.status="rejected",Y.reason=te)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function re(Y,te,Q,ae,xe){var ge=typeof Y;(ge==="undefined"||ge==="boolean")&&(Y=null);var Me=!1;if(Y===null)Me=!0;else switch(ge){case"bigint":case"string":case"number":Me=!0;break;case"object":switch(Y.$$typeof){case e:case t:Me=!0;break;case u:return Me=Y._init,re(Me(Y._payload),te,Q,ae,xe)}}if(Me)return xe=xe(Y),Me=ae===""?"."+P(Y,0):ae,C(xe)?(Q="",Me!=null&&(Q=Me.replace(q,"$&/")+"/"),re(xe,te,Q,"",function(Ce){return Ce})):xe!=null&&(M(xe)&&(xe=j(xe,Q+(xe.key==null||Y&&Y.key===xe.key?"":(""+xe.key).replace(q,"$&/")+"/")+Me)),te.push(xe)),1;Me=0;var Pe=ae===""?".":ae+":";if(C(Y))for(var Ie=0;Ie<Y.length;Ie++)ae=Y[Ie],ge=Pe+P(ae,Ie),Me+=re(ae,te,Q,ge,xe);else if(Ie=m(Y),typeof Ie=="function")for(Y=Ie.call(Y),Ie=0;!(ae=Y.next()).done;)ae=ae.value,ge=Pe+P(ae,Ie++),Me+=re(ae,te,Q,ge,xe);else if(ge==="object"){if(typeof Y.then=="function")return re(z(Y),te,Q,ae,xe);throw te=String(Y),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Me}function K(Y,te,Q){if(Y==null)return Y;var ae=[],xe=0;return re(Y,ae,"","",function(ge){return te.call(Q,ge,xe++)}),ae}function ee(Y){if(Y._status===-1){var te=Y._result;te=te(),te.then(function(Q){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=Q)},function(Q){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=Q)}),Y._status===-1&&(Y._status=0,Y._result=te)}if(Y._status===1)return Y._result.default;throw Y._result}var W=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(te))return}else if(typeof vs=="object"&&typeof vs.emit=="function"){vs.emit("uncaughtException",Y);return}console.error(Y)};function se(){}return Vn.Children={map:K,forEach:function(Y,te,Q){K(Y,function(){te.apply(this,arguments)},Q)},count:function(Y){var te=0;return K(Y,function(){te++}),te},toArray:function(Y){return K(Y,function(te){return te})||[]},only:function(Y){if(!M(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},Vn.Component=w,Vn.Fragment=n,Vn.Profiler=s,Vn.PureComponent=_,Vn.StrictMode=r,Vn.Suspense=l,Vn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Vn.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return k.H.useMemoCache(Y)}},Vn.cache=function(Y){return function(){return Y.apply(null,arguments)}},Vn.cloneElement=function(Y,te,Q){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var ae=v({},Y.props),xe=Y.key,ge=void 0;if(te!=null)for(Me in te.ref!==void 0&&(ge=void 0),te.key!==void 0&&(xe=""+te.key),te)!R.call(te,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&te.ref===void 0||(ae[Me]=te[Me]);var Me=arguments.length-2;if(Me===1)ae.children=Q;else if(1<Me){for(var Pe=Array(Me),Ie=0;Ie<Me;Ie++)Pe[Ie]=arguments[Ie+2];ae.children=Pe}return I(Y.type,xe,void 0,void 0,ge,ae)},Vn.createContext=function(Y){return Y={$$typeof:a,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:i,_context:Y},Y},Vn.createElement=function(Y,te,Q){var ae,xe={},ge=null;if(te!=null)for(ae in te.key!==void 0&&(ge=""+te.key),te)R.call(te,ae)&&ae!=="key"&&ae!=="__self"&&ae!=="__source"&&(xe[ae]=te[ae]);var Me=arguments.length-2;if(Me===1)xe.children=Q;else if(1<Me){for(var Pe=Array(Me),Ie=0;Ie<Me;Ie++)Pe[Ie]=arguments[Ie+2];xe.children=Pe}if(Y&&Y.defaultProps)for(ae in Me=Y.defaultProps,Me)xe[ae]===void 0&&(xe[ae]=Me[ae]);return I(Y,ge,void 0,void 0,null,xe)},Vn.createRef=function(){return{current:null}},Vn.forwardRef=function(Y){return{$$typeof:o,render:Y}},Vn.isValidElement=M,Vn.lazy=function(Y){return{$$typeof:u,_payload:{_status:-1,_result:Y},_init:ee}},Vn.memo=function(Y,te){return{$$typeof:c,type:Y,compare:te===void 0?null:te}},Vn.startTransition=function(Y){var te=k.T,Q={};k.T=Q;try{var ae=Y(),xe=k.S;xe!==null&&xe(Q,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(se,W)}catch(ge){W(ge)}finally{k.T=te}},Vn.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Vn.use=function(Y){return k.H.use(Y)},Vn.useActionState=function(Y,te,Q){return k.H.useActionState(Y,te,Q)},Vn.useCallback=function(Y,te){return k.H.useCallback(Y,te)},Vn.useContext=function(Y){return k.H.useContext(Y)},Vn.useDebugValue=function(){},Vn.useDeferredValue=function(Y,te){return k.H.useDeferredValue(Y,te)},Vn.useEffect=function(Y,te,Q){var ae=k.H;if(typeof Q=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ae.useEffect(Y,te)},Vn.useId=function(){return k.H.useId()},Vn.useImperativeHandle=function(Y,te,Q){return k.H.useImperativeHandle(Y,te,Q)},Vn.useInsertionEffect=function(Y,te){return k.H.useInsertionEffect(Y,te)},Vn.useLayoutEffect=function(Y,te){return k.H.useLayoutEffect(Y,te)},Vn.useMemo=function(Y,te){return k.H.useMemo(Y,te)},Vn.useOptimistic=function(Y,te){return k.H.useOptimistic(Y,te)},Vn.useReducer=function(Y,te,Q){return k.H.useReducer(Y,te,Q)},Vn.useRef=function(Y){return k.H.useRef(Y)},Vn.useState=function(Y){return k.H.useState(Y)},Vn.useSyncExternalStore=function(Y,te,Q){return k.H.useSyncExternalStore(Y,te,Q)},Vn.useTransition=function(){return k.H.useTransition()},Vn.version="19.1.0",Vn}var o4;function qy(){return o4||(o4=1,cE.exports=cZ()),cE.exports}var T=qy();const dt=Ni(T),F8=nZ({__proto__:null,default:dt},[T]);var uE={exports:{}},qg={},dE={exports:{}},fE={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l4;function uZ(){return l4||(l4=1,function(e){function t(K,ee){var W=K.length;K.push(ee);e:for(;0<W;){var se=W-1>>>1,Y=K[se];if(0<s(Y,ee))K[se]=ee,K[W]=Y,W=se;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var ee=K[0],W=K.pop();if(W!==ee){K[0]=W;e:for(var se=0,Y=K.length,te=Y>>>1;se<te;){var Q=2*(se+1)-1,ae=K[Q],xe=Q+1,ge=K[xe];if(0>s(ae,W))xe<Y&&0>s(ge,ae)?(K[se]=ge,K[xe]=W,se=xe):(K[se]=ae,K[Q]=W,se=Q);else if(xe<Y&&0>s(ge,W))K[se]=ge,K[xe]=W,se=xe;else break e}}return ee}function s(K,ee){var W=K.sortIndex-ee.sortIndex;return W!==0?W:K.id-ee.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,m=3,g=!1,v=!1,b=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(K){for(var ee=n(c);ee!==null;){if(ee.callback===null)r(c);else if(ee.startTime<=K)r(c),ee.sortIndex=ee.expirationTime,t(l,ee);else break;ee=n(c)}}function k(K){if(b=!1,C(K),!v)if(n(l)!==null)v=!0,R||(R=!0,P());else{var ee=n(c);ee!==null&&re(k,ee.startTime-K)}}var R=!1,I=-1,j=5,M=-1;function L(){return w?!0:!(e.unstable_now()-M<j)}function q(){if(w=!1,R){var K=e.unstable_now();M=K;var ee=!0;try{e:{v=!1,b&&(b=!1,_(I),I=-1),g=!0;var W=m;try{t:{for(C(K),f=n(l);f!==null&&!(f.expirationTime>K&&L());){var se=f.callback;if(typeof se=="function"){f.callback=null,m=f.priorityLevel;var Y=se(f.expirationTime<=K);if(K=e.unstable_now(),typeof Y=="function"){f.callback=Y,C(K),ee=!0;break t}f===n(l)&&r(l),C(K)}else r(l);f=n(l)}if(f!==null)ee=!0;else{var te=n(c);te!==null&&re(k,te.startTime-K),ee=!1}}break e}finally{f=null,m=W,g=!1}ee=void 0}}finally{ee?P():R=!1}}}var P;if(typeof E=="function")P=function(){E(q)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,z=V.port2;V.port1.onmessage=q,P=function(){z.postMessage(null)}}else P=function(){x(q,0)};function re(K,ee){I=x(function(){K(e.unstable_now())},ee)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(K){switch(m){case 1:case 2:case 3:var ee=3;break;default:ee=m}var W=m;m=ee;try{return K()}finally{m=W}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(K,ee){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var W=m;m=K;try{return ee()}finally{m=W}},e.unstable_scheduleCallback=function(K,ee,W){var se=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?se+W:se):W=se,K){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=W+Y,K={id:u++,callback:ee,priorityLevel:K,startTime:W,expirationTime:Y,sortIndex:-1},W>se?(K.sortIndex=W,t(c,K),n(l)===null&&K===n(c)&&(b?(_(I),I=-1):b=!0,re(k,W-se))):(K.sortIndex=Y,t(l,K),v||g||(v=!0,R||(R=!0,P()))),K},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(K){var ee=m;return function(){var W=m;m=ee;try{return K.apply(this,arguments)}finally{m=W}}}}(fE)),fE}var c4;function dZ(){return c4||(c4=1,dE.exports=uZ()),dE.exports}var hE={exports:{}},wi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u4;function fZ(){if(u4)return wi;u4=1;var e=qy();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:f==null?null:""+f,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return wi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,wi.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return i(l,c,null,u)},wi.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},wi.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},wi.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},wi.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,f=o(u,c.crossOrigin),m=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:f,integrity:m,fetchPriority:g}):u==="script"&&r.d.X(l,{crossOrigin:f,integrity:m,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},wi.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},wi.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,f=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},wi.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},wi.requestFormReset=function(l){r.d.r(l)},wi.unstable_batchedUpdates=function(l,c){return l(c)},wi.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},wi.useFormStatus=function(){return a.H.useHostTransitionStatus()},wi.version="19.1.0",wi}var d4;function L8(){if(d4)return hE.exports;d4=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),hE.exports=fZ(),hE.exports}var f4;function hZ(){if(f4)return qg;f4=1;var e=dZ(),t=qy(),n=L8();function r(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)h+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function i(d){var h=d,y=d;if(d.alternate)for(;h.return;)h=h.return;else{d=h;do h=d,(h.flags&4098)!==0&&(y=h.return),d=h.return;while(d)}return h.tag===3?y:null}function a(d){if(d.tag===13){var h=d.memoizedState;if(h===null&&(d=d.alternate,d!==null&&(h=d.memoizedState)),h!==null)return h.dehydrated}return null}function o(d){if(i(d)!==d)throw Error(r(188))}function l(d){var h=d.alternate;if(!h){if(h=i(d),h===null)throw Error(r(188));return h!==d?null:d}for(var y=d,S=h;;){var N=y.return;if(N===null)break;var $=N.alternate;if($===null){if(S=N.return,S!==null){y=S;continue}break}if(N.child===$.child){for($=N.child;$;){if($===y)return o(N),d;if($===S)return o(N),h;$=$.sibling}throw Error(r(188))}if(y.return!==S.return)y=N,S=$;else{for(var le=!1,Ee=N.child;Ee;){if(Ee===y){le=!0,y=N,S=$;break}if(Ee===S){le=!0,S=N,y=$;break}Ee=Ee.sibling}if(!le){for(Ee=$.child;Ee;){if(Ee===y){le=!0,y=$,S=N;break}if(Ee===S){le=!0,S=$,y=N;break}Ee=Ee.sibling}if(!le)throw Error(r(189))}}if(y.alternate!==S)throw Error(r(190))}if(y.tag!==3)throw Error(r(188));return y.stateNode.current===y?d:h}function c(d){var h=d.tag;if(h===5||h===26||h===27||h===6)return d;for(d=d.child;d!==null;){if(h=c(d),h!==null)return h;d=d.sibling}return null}var u=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function P(d){return d===null||typeof d!="object"?null:(d=q&&d[q]||d["@@iterator"],typeof d=="function"?d:null)}var V=Symbol.for("react.client.reference");function z(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===V?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case v:return"Fragment";case w:return"Profiler";case b:return"StrictMode";case k:return"Suspense";case R:return"SuspenseList";case M:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case g:return"Portal";case E:return(d.displayName||"Context")+".Provider";case _:return(d._context.displayName||"Context")+".Consumer";case C:var h=d.render;return d=d.displayName,d||(d=h.displayName||h.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case I:return h=d.displayName||null,h!==null?h:z(d.type)||"Memo";case j:h=d._payload,d=d._init;try{return z(d(h))}catch{}}return null}var re=Array.isArray,K=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},se=[],Y=-1;function te(d){return{current:d}}function Q(d){0>Y||(d.current=se[Y],se[Y]=null,Y--)}function ae(d,h){Y++,se[Y]=d.current,d.current=h}var xe=te(null),ge=te(null),Me=te(null),Pe=te(null);function Ie(d,h){switch(ae(Me,h),ae(ge,d),ae(xe,null),h.nodeType){case 9:case 11:d=(d=h.documentElement)&&(d=d.namespaceURI)?jM(d):0;break;default:if(d=h.tagName,h=h.namespaceURI)h=jM(h),d=MM(h,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}Q(xe),ae(xe,d)}function Ce(){Q(xe),Q(ge),Q(Me)}function He(d){d.memoizedState!==null&&ae(Pe,d);var h=xe.current,y=MM(h,d.type);h!==y&&(ae(ge,d),ae(xe,y))}function it(d){ge.current===d&&(Q(xe),Q(ge)),Pe.current===d&&(Q(Pe),Fg._currentValue=W)}var Ge=Object.prototype.hasOwnProperty,Re=e.unstable_scheduleCallback,H=e.unstable_cancelCallback,me=e.unstable_shouldYield,Te=e.unstable_requestPaint,ce=e.unstable_now,oe=e.unstable_getCurrentPriorityLevel,ne=e.unstable_ImmediatePriority,Se=e.unstable_UserBlockingPriority,Fe=e.unstable_NormalPriority,ke=e.unstable_LowPriority,Xe=e.unstable_IdlePriority,St=e.log,ht=e.unstable_setDisableYieldValue,It=null,Vt=null;function Ot(d){if(typeof St=="function"&&ht(d),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(It,d)}catch{}}var Gt=Math.clz32?Math.clz32:Z,be=Math.log,O=Math.LN2;function Z(d){return d>>>=0,d===0?32:31-(be(d)/O|0)|0}var fe=256,Oe=4194304;function ve(d){var h=d&42;if(h!==0)return h;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function Ae(d,h,y){var S=d.pendingLanes;if(S===0)return 0;var N=0,$=d.suspendedLanes,le=d.pingedLanes;d=d.warmLanes;var Ee=S&134217727;return Ee!==0?(S=Ee&~$,S!==0?N=ve(S):(le&=Ee,le!==0?N=ve(le):y||(y=Ee&~d,y!==0&&(N=ve(y))))):(Ee=S&~$,Ee!==0?N=ve(Ee):le!==0?N=ve(le):y||(y=S&~d,y!==0&&(N=ve(y)))),N===0?0:h!==0&&h!==N&&(h&$)===0&&($=N&-N,y=h&-h,$>=y||$===32&&(y&4194048)!==0)?h:N}function ue(d,h){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&h)===0}function mt(d,h){switch(d){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wt(){var d=fe;return fe<<=1,(fe&4194048)===0&&(fe=256),d}function B(){var d=Oe;return Oe<<=1,(Oe&62914560)===0&&(Oe=4194304),d}function ze(d){for(var h=[],y=0;31>y;y++)h.push(d);return h}function rt(d,h){d.pendingLanes|=h,h!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function ye(d,h,y,S,N,$){var le=d.pendingLanes;d.pendingLanes=y,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=y,d.entangledLanes&=y,d.errorRecoveryDisabledLanes&=y,d.shellSuspendCounter=0;var Ee=d.entanglements,qe=d.expirationTimes,pt=d.hiddenUpdates;for(y=le&~y;0<y;){var Tt=31-Gt(y),jt=1<<Tt;Ee[Tt]=0,qe[Tt]=-1;var yt=pt[Tt];if(yt!==null)for(pt[Tt]=null,Tt=0;Tt<yt.length;Tt++){var vt=yt[Tt];vt!==null&&(vt.lane&=-536870913)}y&=~jt}S!==0&&we(d,S,0),$!==0&&N===0&&d.tag!==0&&(d.suspendedLanes|=$&~(le&~h))}function we(d,h,y){d.pendingLanes|=h,d.suspendedLanes&=~h;var S=31-Gt(h);d.entangledLanes|=h,d.entanglements[S]=d.entanglements[S]|1073741824|y&4194090}function Ue(d,h){var y=d.entangledLanes|=h;for(d=d.entanglements;y;){var S=31-Gt(y),N=1<<S;N&h|d[S]&h&&(d[S]|=h),y&=~N}}function Et(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function he(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function G(){var d=ee.p;return d!==0?d:(d=window.event,d===void 0?32:JM(d.type))}function U(d,h){var y=ee.p;try{return ee.p=d,h()}finally{ee.p=y}}var X=Math.random().toString(36).slice(2),pe="__reactFiber$"+X,je="__reactProps$"+X,Ke="__reactContainer$"+X,bt="__reactEvents$"+X,Kt="__reactListeners$"+X,yn="__reactHandles$"+X,Ht="__reactResources$"+X,Yt="__reactMarker$"+X;function an(d){delete d[pe],delete d[je],delete d[bt],delete d[Kt],delete d[yn]}function qn(d){var h=d[pe];if(h)return h;for(var y=d.parentNode;y;){if(h=y[Ke]||y[pe]){if(y=h.alternate,h.child!==null||y!==null&&y.child!==null)for(d=FM(d);d!==null;){if(y=d[pe])return y;d=FM(d)}return h}d=y,y=d.parentNode}return null}function Qn(d){if(d=d[pe]||d[Ke]){var h=d.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return d}return null}function jr(d){var h=d.tag;if(h===5||h===26||h===27||h===6)return d.stateNode;throw Error(r(33))}function Mr(d){var h=d[Ht];return h||(h=d[Ht]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Gn(d){d[Yt]=!0}var Mi=new Set,Zo={};function Yo(d,h){Xo(d,h),Xo(d+"Capture",h)}function Xo(d,h){for(Zo[d]=h,d=0;d<h.length;d++)Mi.add(h[d])}var rs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Jo={},Pa={};function Vb(d){return Ge.call(Pa,d)?!0:Ge.call(Jo,d)?!1:rs.test(d)?Pa[d]=!0:(Jo[d]=!0,!1)}function mo(d,h,y){if(Vb(h))if(y===null)d.removeAttribute(h);else{switch(typeof y){case"undefined":case"function":case"symbol":d.removeAttribute(h);return;case"boolean":var S=h.toLowerCase().slice(0,5);if(S!=="data-"&&S!=="aria-"){d.removeAttribute(h);return}}d.setAttribute(h,""+y)}}function Ul(d,h,y){if(y===null)d.removeAttribute(h);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(h);return}d.setAttribute(h,""+y)}}function pa(d,h,y,S){if(S===null)d.removeAttribute(y);else{switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(y);return}d.setAttributeNS(h,y,""+S)}}var Nd,Qo;function ql(d){if(Nd===void 0)try{throw Error()}catch(y){var h=y.stack.trim().match(/\n( *(at )?)/);Nd=h&&h[1]||"",Qo=-1<y.stack.indexOf(`
    at`)?" (<anonymous>)":-1<y.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nd+d+Qo}var Hc=!1;function rh(d,h){if(!d||Hc)return"";Hc=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(h){var jt=function(){throw Error()};if(Object.defineProperty(jt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(jt,[])}catch(vt){var yt=vt}Reflect.construct(d,[],jt)}else{try{jt.call()}catch(vt){yt=vt}d.call(jt.prototype)}}else{try{throw Error()}catch(vt){yt=vt}(jt=d())&&typeof jt.catch=="function"&&jt.catch(function(){})}}catch(vt){if(vt&&yt&&typeof vt.stack=="string")return[vt.stack,yt.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var $=S.DetermineComponentFrameRoot(),le=$[0],Ee=$[1];if(le&&Ee){var qe=le.split(`
`),pt=Ee.split(`
`);for(N=S=0;S<qe.length&&!qe[S].includes("DetermineComponentFrameRoot");)S++;for(;N<pt.length&&!pt[N].includes("DetermineComponentFrameRoot");)N++;if(S===qe.length||N===pt.length)for(S=qe.length-1,N=pt.length-1;1<=S&&0<=N&&qe[S]!==pt[N];)N--;for(;1<=S&&0<=N;S--,N--)if(qe[S]!==pt[N]){if(S!==1||N!==1)do if(S--,N--,0>N||qe[S]!==pt[N]){var Tt=`
`+qe[S].replace(" at new "," at ");return d.displayName&&Tt.includes("<anonymous>")&&(Tt=Tt.replace("<anonymous>",d.displayName)),Tt}while(1<=S&&0<=N);break}}}finally{Hc=!1,Error.prepareStackTrace=y}return(y=d?d.displayName||d.name:"")?ql(y):""}function er(d){switch(d.tag){case 26:case 27:case 5:return ql(d.type);case 16:return ql("Lazy");case 13:return ql("Suspense");case 19:return ql("SuspenseList");case 0:case 15:return rh(d.type,!1);case 11:return rh(d.type.render,!1);case 1:return rh(d.type,!0);case 31:return ql("Activity");default:return""}}function Bm(d){try{var h="";do h+=er(d),d=d.return;while(d);return h}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}function Oi(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function $m(d){var h=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function $r(d){var h=$m(d)?"checked":"value",y=Object.getOwnPropertyDescriptor(d.constructor.prototype,h),S=""+d[h];if(!d.hasOwnProperty(h)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var N=y.get,$=y.set;return Object.defineProperty(d,h,{configurable:!0,get:function(){return N.call(this)},set:function(le){S=""+le,$.call(this,le)}}),Object.defineProperty(d,h,{enumerable:y.enumerable}),{getValue:function(){return S},setValue:function(le){S=""+le},stopTracking:function(){d._valueTracker=null,delete d[h]}}}}function el(d){d._valueTracker||(d._valueTracker=$r(d))}function Gc(d){if(!d)return!1;var h=d._valueTracker;if(!h)return!0;var y=h.getValue(),S="";return d&&(S=$m(d)?d.checked?"true":"false":d.value),d=S,d!==y?(h.setValue(d),!0):!1}function go(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var zm=/[\n"\\]/g;function gi(d){return d.replace(zm,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Kc(d,h,y,S,N,$,le,Ee){d.name="",le!=null&&typeof le!="function"&&typeof le!="symbol"&&typeof le!="boolean"?d.type=le:d.removeAttribute("type"),h!=null?le==="number"?(h===0&&d.value===""||d.value!=h)&&(d.value=""+Oi(h)):d.value!==""+Oi(h)&&(d.value=""+Oi(h)):le!=="submit"&&le!=="reset"||d.removeAttribute("value"),h!=null?Wc(d,le,Oi(h)):y!=null?Wc(d,le,Oi(y)):S!=null&&d.removeAttribute("value"),N==null&&$!=null&&(d.defaultChecked=!!$),N!=null&&(d.checked=N&&typeof N!="function"&&typeof N!="symbol"),Ee!=null&&typeof Ee!="function"&&typeof Ee!="symbol"&&typeof Ee!="boolean"?d.name=""+Oi(Ee):d.removeAttribute("name")}function Um(d,h,y,S,N,$,le,Ee){if($!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"&&(d.type=$),h!=null||y!=null){if(!($!=="submit"&&$!=="reset"||h!=null))return;y=y!=null?""+Oi(y):"",h=h!=null?""+Oi(h):y,Ee||h===d.value||(d.value=h),d.defaultValue=h}S=S??N,S=typeof S!="function"&&typeof S!="symbol"&&!!S,d.checked=Ee?d.checked:!!S,d.defaultChecked=!!S,le!=null&&typeof le!="function"&&typeof le!="symbol"&&typeof le!="boolean"&&(d.name=le)}function Wc(d,h,y){h==="number"&&go(d.ownerDocument)===d||d.defaultValue===""+y||(d.defaultValue=""+y)}function Vl(d,h,y,S){if(d=d.options,h){h={};for(var N=0;N<y.length;N++)h["$"+y[N]]=!0;for(y=0;y<d.length;y++)N=h.hasOwnProperty("$"+d[y].value),d[y].selected!==N&&(d[y].selected=N),N&&S&&(d[y].defaultSelected=!0)}else{for(y=""+Oi(y),h=null,N=0;N<d.length;N++){if(d[N].value===y){d[N].selected=!0,S&&(d[N].defaultSelected=!0);return}h!==null||d[N].disabled||(h=d[N])}h!==null&&(h.selected=!0)}}function Zc(d,h,y){if(h!=null&&(h=""+Oi(h),h!==d.value&&(d.value=h),y==null)){d.defaultValue!==h&&(d.defaultValue=h);return}d.defaultValue=y!=null?""+Oi(y):""}function qm(d,h,y,S){if(h==null){if(S!=null){if(y!=null)throw Error(r(92));if(re(S)){if(1<S.length)throw Error(r(93));S=S[0]}y=S}y==null&&(y=""),h=y}y=Oi(h),d.defaultValue=y,S=d.textContent,S===y&&S!==""&&S!==null&&(d.value=S)}function Yc(d,h){if(h){var y=d.firstChild;if(y&&y===d.lastChild&&y.nodeType===3){y.nodeValue=h;return}}d.textContent=h}var fr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sh(d,h,y){var S=h.indexOf("--")===0;y==null||typeof y=="boolean"||y===""?S?d.setProperty(h,""):h==="float"?d.cssFloat="":d[h]="":S?d.setProperty(h,y):typeof y!="number"||y===0||fr.has(h)?h==="float"?d.cssFloat=y:d[h]=(""+y).trim():d[h]=y+"px"}function Hb(d,h,y){if(h!=null&&typeof h!="object")throw Error(r(62));if(d=d.style,y!=null){for(var S in y)!y.hasOwnProperty(S)||h!=null&&h.hasOwnProperty(S)||(S.indexOf("--")===0?d.setProperty(S,""):S==="float"?d.cssFloat="":d[S]="");for(var N in h)S=h[N],h.hasOwnProperty(N)&&y[N]!==S&&sh(d,N,S)}else for(var $ in h)h.hasOwnProperty($)&&sh(d,$,h[$])}function Vm(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hl(d){return Xc.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}var Da=null;function ih(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Gl=null,Wr=null;function ma(d){var h=Qn(d);if(h&&(d=h.stateNode)){var y=d[je]||null;e:switch(d=h.stateNode,h.type){case"input":if(Kc(d,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name),h=y.name,y.type==="radio"&&h!=null){for(y=d;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll('input[name="'+gi(""+h)+'"][type="radio"]'),h=0;h<y.length;h++){var S=y[h];if(S!==d&&S.form===d.form){var N=S[je]||null;if(!N)throw Error(r(90));Kc(S,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(h=0;h<y.length;h++)S=y[h],S.form===d.form&&Gc(S)}break e;case"textarea":Zc(d,y.value,y.defaultValue);break e;case"select":h=y.value,h!=null&&Vl(d,!!y.multiple,h,!1)}}}var Kl=!1;function Jc(d,h,y){if(Kl)return d(h,y);Kl=!0;try{var S=d(h);return S}finally{if(Kl=!1,(Gl!==null||Wr!==null)&&(Mv(),Gl&&(h=Gl,d=Wr,Wr=Gl=null,ma(h),d)))for(h=0;h<d.length;h++)ma(d[h])}}function Wl(d,h){var y=d.stateNode;if(y===null)return null;var S=y[je]||null;if(S===null)return null;y=S[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(S=!S.disabled)||(d=d.type,S=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!S;break e;default:d=!1}if(d)return null;if(y&&typeof y!="function")throw Error(r(231,h,typeof y));return y}var zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hm=!1;if(zs)try{var yi={};Object.defineProperty(yi,"passive",{get:function(){Hm=!0}}),window.addEventListener("test",yi,yi),window.removeEventListener("test",yi,yi)}catch{Hm=!1}var Fa=null,ah=null,Qc=null;function eu(){if(Qc)return Qc;var d,h=ah,y=h.length,S,N="value"in Fa?Fa.value:Fa.textContent,$=N.length;for(d=0;d<y&&h[d]===N[d];d++);var le=y-d;for(S=1;S<=le&&h[y-S]===N[$-S];S++);return Qc=N.slice(d,1<S?1-S:void 0)}function tu(d){var h=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&h===13&&(d=13)):d=h,d===10&&(d=13),32<=d||d===13?d:0}function Id(){return!0}function Gb(){return!1}function Cs(d){function h(y,S,N,$,le){this._reactName=y,this._targetInst=N,this.type=S,this.nativeEvent=$,this.target=le,this.currentTarget=null;for(var Ee in d)d.hasOwnProperty(Ee)&&(y=d[Ee],this[Ee]=y?y($):$[Ee]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?Id:Gb,this.isPropagationStopped=Gb,this}return u(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!="unknown"&&(y.returnValue=!1),this.isDefaultPrevented=Id)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!="unknown"&&(y.cancelBubble=!0),this.isPropagationStopped=Id)},persist:function(){},isPersistent:Id}),h}var Zl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oh=Cs(Zl),tl=u({},Zl,{view:0,detail:0}),lh=Cs(tl),jd,Gm,Md,ch=u({},tl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yl,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Md&&(Md&&d.type==="mousemove"?(jd=d.screenX-Md.screenX,Gm=d.screenY-Md.screenY):Gm=jd=0,Md=d),jd)},movementY:function(d){return"movementY"in d?d.movementY:Gm}}),uh=Cs(ch),Km=u({},ch,{dataTransfer:0}),Kb=Cs(Km),dh=u({},tl,{relatedTarget:0}),nu=Cs(dh),fh=u({},Zl,{animationName:0,elapsedTime:0,pseudoElement:0}),Wb=Cs(fh),_S=u({},Zl,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),hh=Cs(_S),Wm=u({},Zl,{data:0}),ph=Cs(Wm),Zm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ym={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Us={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Od(d){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(d):(d=Us[d])?!!h[d]:!1}function Yl(){return Od}var Zb=u({},tl,{key:function(d){if(d.key){var h=Zm[d.key]||d.key;if(h!=="Unidentified")return h}return d.type==="keypress"?(d=tu(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Ym[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yl,charCode:function(d){return d.type==="keypress"?tu(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?tu(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),mh=Cs(Zb),Yb=u({},ch,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xm=Cs(Yb),gh=u({},tl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yl}),Jm=Cs(gh),Xl=u({},Zl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qm=Cs(Xl),eg=u({},ch,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),yh=Cs(eg),tg=u({},Zl,{newState:0,oldState:0}),Xb=Cs(tg),SS=[9,13,27,32],Pd=zs&&"CompositionEvent"in window,nl=null;zs&&"documentMode"in document&&(nl=document.documentMode);var ES=zs&&"TextEvent"in window&&!nl,bh=zs&&(!Pd||nl&&8<nl&&11>=nl),vh=" ",Jb=!1;function ng(d,h){switch(d){case"keyup":return SS.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qb(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Jl=!1;function ev(d,h){switch(d){case"compositionend":return Qb(h);case"keypress":return h.which!==32?null:(Jb=!0,vh);case"textInput":return d=h.data,d===vh&&Jb?null:d;default:return null}}function CS(d,h){if(Jl)return d==="compositionend"||!Pd&&ng(d,h)?(d=eu(),Qc=ah=Fa=null,Jl=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return bh&&h.locale!=="ko"?null:h.data;default:return null}}var tv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wh(d){var h=d&&d.nodeName&&d.nodeName.toLowerCase();return h==="input"?!!tv[d.type]:h==="textarea"}function rg(d,h,y,S){Gl?Wr?Wr.push(S):Wr=[S]:Gl=S,h=Bv(h,"onChange"),0<h.length&&(y=new oh("onChange","change",null,y,S),d.push({event:y,listeners:h}))}var ru=null,Dd=null;function kS(d){TM(d,0)}function xh(d){var h=jr(d);if(Gc(h))return d}function Fd(d,h){if(d==="change")return h}var La=!1;if(zs){var Zr;if(zs){var su="oninput"in document;if(!su){var Di=document.createElement("div");Di.setAttribute("oninput","return;"),su=typeof Di.oninput=="function"}Zr=su}else Zr=!1;La=Zr&&(!document.documentMode||9<document.documentMode)}function nv(){ru&&(ru.detachEvent("onpropertychange",_h),Dd=ru=null)}function _h(d){if(d.propertyName==="value"&&xh(Dd)){var h=[];rg(h,Dd,d,ih(d)),Jc(kS,h)}}function rv(d,h,y){d==="focusin"?(nv(),ru=h,Dd=y,ru.attachEvent("onpropertychange",_h)):d==="focusout"&&nv()}function Ql(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return xh(Dd)}function sg(d,h){if(d==="click")return xh(h)}function iu(d,h){if(d==="input"||d==="change")return xh(h)}function rl(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var bi=typeof Object.is=="function"?Object.is:rl;function A(d,h){if(bi(d,h))return!0;if(typeof d!="object"||d===null||typeof h!="object"||h===null)return!1;var y=Object.keys(d),S=Object.keys(h);if(y.length!==S.length)return!1;for(S=0;S<y.length;S++){var N=y[S];if(!Ge.call(h,N)||!bi(d[N],h[N]))return!1}return!0}function F(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function J(d,h){var y=F(d);d=0;for(var S;y;){if(y.nodeType===3){if(S=d+y.textContent.length,d<=h&&S>=h)return{node:y,offset:h-d};d=S}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=F(y)}}function ie(d,h){return d&&h?d===h?!0:d&&d.nodeType===3?!1:h&&h.nodeType===3?ie(d,h.parentNode):"contains"in d?d.contains(h):d.compareDocumentPosition?!!(d.compareDocumentPosition(h)&16):!1:!1}function de(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var h=go(d.document);h instanceof d.HTMLIFrameElement;){try{var y=typeof h.contentWindow.location.href=="string"}catch{y=!1}if(y)d=h.contentWindow;else break;h=go(d.document)}return h}function _e(d){var h=d&&d.nodeName&&d.nodeName.toLowerCase();return h&&(h==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||h==="textarea"||d.contentEditable==="true")}var De=zs&&"documentMode"in document&&11>=document.documentMode,$e=null,Ye=null,Qe=null,st=!1;function We(d,h,y){var S=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;st||$e==null||$e!==go(S)||(S=$e,"selectionStart"in S&&_e(S)?S={start:S.selectionStart,end:S.selectionEnd}:(S=(S.ownerDocument&&S.ownerDocument.defaultView||window).getSelection(),S={anchorNode:S.anchorNode,anchorOffset:S.anchorOffset,focusNode:S.focusNode,focusOffset:S.focusOffset}),Qe&&A(Qe,S)||(Qe=S,S=Bv(Ye,"onSelect"),0<S.length&&(h=new oh("onSelect","select",null,h,y),d.push({event:h,listeners:S}),h.target=$e)))}function ot(d,h){var y={};return y[d.toLowerCase()]=h.toLowerCase(),y["Webkit"+d]="webkit"+h,y["Moz"+d]="moz"+h,y}var Ze={animationend:ot("Animation","AnimationEnd"),animationiteration:ot("Animation","AnimationIteration"),animationstart:ot("Animation","AnimationStart"),transitionrun:ot("Transition","TransitionRun"),transitionstart:ot("Transition","TransitionStart"),transitioncancel:ot("Transition","TransitionCancel"),transitionend:ot("Transition","TransitionEnd")},nt={},lt={};zs&&(lt=document.createElement("div").style,"AnimationEvent"in window||(delete Ze.animationend.animation,delete Ze.animationiteration.animation,delete Ze.animationstart.animation),"TransitionEvent"in window||delete Ze.transitionend.transition);function et(d){if(nt[d])return nt[d];if(!Ze[d])return d;var h=Ze[d],y;for(y in h)if(h.hasOwnProperty(y)&&y in lt)return nt[d]=h[y];return d}var gt=et("animationend"),xt=et("animationiteration"),_t=et("animationstart"),kt=et("transitionrun"),Bt=et("transitionstart"),Wt=et("transitioncancel"),Dt=et("transitionend"),qt=new Map,Zt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zt.push("scrollEnd");function Ft(d,h){qt.set(d,h),Yo(h,[d])}var nn=new WeakMap;function pn(d,h){if(typeof d=="object"&&d!==null){var y=nn.get(d);return y!==void 0?y:(h={value:d,source:h,stack:Bm(h)},nn.set(d,h),h)}return{value:d,source:h,stack:Bm(h)}}var bn=[],jn=0,ai=0;function En(){for(var d=jn,h=ai=jn=0;h<d;){var y=bn[h];bn[h++]=null;var S=bn[h];bn[h++]=null;var N=bn[h];bn[h++]=null;var $=bn[h];if(bn[h++]=null,S!==null&&N!==null){var le=S.pending;le===null?N.next=N:(N.next=le.next,le.next=N),S.pending=N}$!==0&&qs(y,N,$)}}function ps(d,h,y,S){bn[jn++]=d,bn[jn++]=h,bn[jn++]=y,bn[jn++]=S,ai|=S,d.lanes|=S,d=d.alternate,d!==null&&(d.lanes|=S)}function ks(d,h,y,S){return ps(d,h,y,S),Ba(d)}function yo(d,h){return ps(d,null,null,h),Ba(d)}function qs(d,h,y){d.lanes|=y;var S=d.alternate;S!==null&&(S.lanes|=y);for(var N=!1,$=d.return;$!==null;)$.childLanes|=y,S=$.alternate,S!==null&&(S.childLanes|=y),$.tag===22&&(d=$.stateNode,d===null||d._visibility&1||(N=!0)),d=$,$=$.return;return d.tag===3?($=d.stateNode,N&&h!==null&&(N=31-Gt(y),d=$.hiddenUpdates,S=d[N],S===null?d[N]=[h]:S.push(h),h.lane=y|536870912),$):null}function Ba(d){if(50<Rg)throw Rg=0,j2=null,Error(r(185));for(var h=d.return;h!==null;)d=h,h=d.return;return d.tag===3?d.stateNode:null}var sl={};function BK(d,h,y,S){this.tag=d,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ga(d,h,y,S){return new BK(d,h,y,S)}function TS(d){return d=d.prototype,!(!d||!d.isReactComponent)}function ec(d,h){var y=d.alternate;return y===null?(y=ga(d.tag,h,d.key,d.mode),y.elementType=d.elementType,y.type=d.type,y.stateNode=d.stateNode,y.alternate=d,d.alternate=y):(y.pendingProps=h,y.type=d.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=d.flags&65011712,y.childLanes=d.childLanes,y.lanes=d.lanes,y.child=d.child,y.memoizedProps=d.memoizedProps,y.memoizedState=d.memoizedState,y.updateQueue=d.updateQueue,h=d.dependencies,y.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},y.sibling=d.sibling,y.index=d.index,y.ref=d.ref,y.refCleanup=d.refCleanup,y}function f3(d,h){d.flags&=65011714;var y=d.alternate;return y===null?(d.childLanes=0,d.lanes=h,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=y.childLanes,d.lanes=y.lanes,d.child=y.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=y.memoizedProps,d.memoizedState=y.memoizedState,d.updateQueue=y.updateQueue,d.type=y.type,h=y.dependencies,d.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),d}function sv(d,h,y,S,N,$){var le=0;if(S=d,typeof d=="function")TS(d)&&(le=1);else if(typeof d=="string")le=zW(d,y,xe.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case M:return d=ga(31,y,h,N),d.elementType=M,d.lanes=$,d;case v:return Ld(y.children,N,$,h);case b:le=8,N|=24;break;case w:return d=ga(12,y,h,N|2),d.elementType=w,d.lanes=$,d;case k:return d=ga(13,y,h,N),d.elementType=k,d.lanes=$,d;case R:return d=ga(19,y,h,N),d.elementType=R,d.lanes=$,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case x:case E:le=10;break e;case _:le=9;break e;case C:le=11;break e;case I:le=14;break e;case j:le=16,S=null;break e}le=29,y=Error(r(130,d===null?"null":typeof d,"")),S=null}return h=ga(le,y,h,N),h.elementType=d,h.type=S,h.lanes=$,h}function Ld(d,h,y,S){return d=ga(7,d,S,h),d.lanes=y,d}function AS(d,h,y){return d=ga(6,d,null,h),d.lanes=y,d}function RS(d,h,y){return h=ga(4,d.children!==null?d.children:[],d.key,h),h.lanes=y,h.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},h}var Sh=[],Eh=0,iv=null,av=0,$a=[],za=0,Bd=null,tc=1,nc="";function $d(d,h){Sh[Eh++]=av,Sh[Eh++]=iv,iv=d,av=h}function h3(d,h,y){$a[za++]=tc,$a[za++]=nc,$a[za++]=Bd,Bd=d;var S=tc;d=nc;var N=32-Gt(S)-1;S&=~(1<<N),y+=1;var $=32-Gt(h)+N;if(30<$){var le=N-N%5;$=(S&(1<<le)-1).toString(32),S>>=le,N-=le,tc=1<<32-Gt(h)+N|y<<N|S,nc=$+d}else tc=1<<$|y<<N|S,nc=d}function NS(d){d.return!==null&&($d(d,1),h3(d,1,0))}function IS(d){for(;d===iv;)iv=Sh[--Eh],Sh[Eh]=null,av=Sh[--Eh],Sh[Eh]=null;for(;d===Bd;)Bd=$a[--za],$a[za]=null,nc=$a[--za],$a[za]=null,tc=$a[--za],$a[za]=null}var Fi=null,cs=null,xr=!1,zd=null,il=!1,jS=Error(r(519));function Ud(d){var h=Error(r(418,""));throw og(pn(h,d)),jS}function p3(d){var h=d.stateNode,y=d.type,S=d.memoizedProps;switch(h[pe]=d,h[je]=S,y){case"dialog":nr("cancel",h),nr("close",h);break;case"iframe":case"object":case"embed":nr("load",h);break;case"video":case"audio":for(y=0;y<Ig.length;y++)nr(Ig[y],h);break;case"source":nr("error",h);break;case"img":case"image":case"link":nr("error",h),nr("load",h);break;case"details":nr("toggle",h);break;case"input":nr("invalid",h),Um(h,S.value,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name,!0),el(h);break;case"select":nr("invalid",h);break;case"textarea":nr("invalid",h),qm(h,S.value,S.defaultValue,S.children),el(h)}y=S.children,typeof y!="string"&&typeof y!="number"&&typeof y!="bigint"||h.textContent===""+y||S.suppressHydrationWarning===!0||IM(h.textContent,y)?(S.popover!=null&&(nr("beforetoggle",h),nr("toggle",h)),S.onScroll!=null&&nr("scroll",h),S.onScrollEnd!=null&&nr("scrollend",h),S.onClick!=null&&(h.onclick=$v),h=!0):h=!1,h||Ud(d)}function m3(d){for(Fi=d.return;Fi;)switch(Fi.tag){case 5:case 13:il=!1;return;case 27:case 3:il=!0;return;default:Fi=Fi.return}}function ig(d){if(d!==Fi)return!1;if(!xr)return m3(d),xr=!0,!1;var h=d.tag,y;if((y=h!==3&&h!==27)&&((y=h===5)&&(y=d.type,y=!(y!=="form"&&y!=="button")||W2(d.type,d.memoizedProps)),y=!y),y&&cs&&Ud(d),m3(d),h===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));e:{for(d=d.nextSibling,h=0;d;){if(d.nodeType===8)if(y=d.data,y==="/$"){if(h===0){cs=vo(d.nextSibling);break e}h--}else y!=="$"&&y!=="$!"&&y!=="$?"||h++;d=d.nextSibling}cs=null}}else h===27?(h=cs,xu(d.type)?(d=J2,J2=null,cs=d):cs=h):cs=Fi?vo(d.stateNode.nextSibling):null;return!0}function ag(){cs=Fi=null,xr=!1}function g3(){var d=zd;return d!==null&&(Ji===null?Ji=d:Ji.push.apply(Ji,d),zd=null),d}function og(d){zd===null?zd=[d]:zd.push(d)}var MS=te(null),qd=null,rc=null;function au(d,h,y){ae(MS,h._currentValue),h._currentValue=y}function sc(d){d._currentValue=MS.current,Q(MS)}function OS(d,h,y){for(;d!==null;){var S=d.alternate;if((d.childLanes&h)!==h?(d.childLanes|=h,S!==null&&(S.childLanes|=h)):S!==null&&(S.childLanes&h)!==h&&(S.childLanes|=h),d===y)break;d=d.return}}function PS(d,h,y,S){var N=d.child;for(N!==null&&(N.return=d);N!==null;){var $=N.dependencies;if($!==null){var le=N.child;$=$.firstContext;e:for(;$!==null;){var Ee=$;$=N;for(var qe=0;qe<h.length;qe++)if(Ee.context===h[qe]){$.lanes|=y,Ee=$.alternate,Ee!==null&&(Ee.lanes|=y),OS($.return,y,d),S||(le=null);break e}$=Ee.next}}else if(N.tag===18){if(le=N.return,le===null)throw Error(r(341));le.lanes|=y,$=le.alternate,$!==null&&($.lanes|=y),OS(le,y,d),le=null}else le=N.child;if(le!==null)le.return=N;else for(le=N;le!==null;){if(le===d){le=null;break}if(N=le.sibling,N!==null){N.return=le.return,le=N;break}le=le.return}N=le}}function lg(d,h,y,S){d=null;for(var N=h,$=!1;N!==null;){if(!$){if((N.flags&524288)!==0)$=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var le=N.alternate;if(le===null)throw Error(r(387));if(le=le.memoizedProps,le!==null){var Ee=N.type;bi(N.pendingProps.value,le.value)||(d!==null?d.push(Ee):d=[Ee])}}else if(N===Pe.current){if(le=N.alternate,le===null)throw Error(r(387));le.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(d!==null?d.push(Fg):d=[Fg])}N=N.return}d!==null&&PS(h,d,y,S),h.flags|=262144}function ov(d){for(d=d.firstContext;d!==null;){if(!bi(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function Vd(d){qd=d,rc=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function vi(d){return y3(qd,d)}function lv(d,h){return qd===null&&Vd(d),y3(d,h)}function y3(d,h){var y=h._currentValue;if(h={context:h,memoizedValue:y,next:null},rc===null){if(d===null)throw Error(r(308));rc=h,d.dependencies={lanes:0,firstContext:h},d.flags|=524288}else rc=rc.next=h;return y}var $K=typeof AbortController<"u"?AbortController:function(){var d=[],h=this.signal={aborted:!1,addEventListener:function(y,S){d.push(S)}};this.abort=function(){h.aborted=!0,d.forEach(function(y){return y()})}},zK=e.unstable_scheduleCallback,UK=e.unstable_NormalPriority,Os={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function DS(){return{controller:new $K,data:new Map,refCount:0}}function cg(d){d.refCount--,d.refCount===0&&zK(UK,function(){d.controller.abort()})}var ug=null,FS=0,Ch=0,kh=null;function qK(d,h){if(ug===null){var y=ug=[];FS=0,Ch=B2(),kh={status:"pending",value:void 0,then:function(S){y.push(S)}}}return FS++,h.then(b3,b3),h}function b3(){if(--FS===0&&ug!==null){kh!==null&&(kh.status="fulfilled");var d=ug;ug=null,Ch=0,kh=null;for(var h=0;h<d.length;h++)(0,d[h])()}}function VK(d,h){var y=[],S={status:"pending",value:null,reason:null,then:function(N){y.push(N)}};return d.then(function(){S.status="fulfilled",S.value=h;for(var N=0;N<y.length;N++)(0,y[N])(h)},function(N){for(S.status="rejected",S.reason=N,N=0;N<y.length;N++)(0,y[N])(void 0)}),S}var v3=K.S;K.S=function(d,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&qK(d,h),v3!==null&&v3(d,h)};var Hd=te(null);function LS(){var d=Hd.current;return d!==null?d:Hr.pooledCache}function cv(d,h){h===null?ae(Hd,Hd.current):ae(Hd,h.pool)}function w3(){var d=LS();return d===null?null:{parent:Os._currentValue,pool:d}}var dg=Error(r(460)),x3=Error(r(474)),uv=Error(r(542)),BS={then:function(){}};function _3(d){return d=d.status,d==="fulfilled"||d==="rejected"}function dv(){}function S3(d,h,y){switch(y=d[y],y===void 0?d.push(h):y!==h&&(h.then(dv,dv),h=y),h.status){case"fulfilled":return h.value;case"rejected":throw d=h.reason,C3(d),d;default:if(typeof h.status=="string")h.then(dv,dv);else{if(d=Hr,d!==null&&100<d.shellSuspendCounter)throw Error(r(482));d=h,d.status="pending",d.then(function(S){if(h.status==="pending"){var N=h;N.status="fulfilled",N.value=S}},function(S){if(h.status==="pending"){var N=h;N.status="rejected",N.reason=S}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw d=h.reason,C3(d),d}throw fg=h,dg}}var fg=null;function E3(){if(fg===null)throw Error(r(459));var d=fg;return fg=null,d}function C3(d){if(d===dg||d===uv)throw Error(r(483))}var ou=!1;function $S(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zS(d,h){d=d.updateQueue,h.updateQueue===d&&(h.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function lu(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function cu(d,h,y){var S=d.updateQueue;if(S===null)return null;if(S=S.shared,(Tr&2)!==0){var N=S.pending;return N===null?h.next=h:(h.next=N.next,N.next=h),S.pending=h,h=Ba(d),qs(d,null,y),h}return ps(d,S,h,y),Ba(d)}function hg(d,h,y){if(h=h.updateQueue,h!==null&&(h=h.shared,(y&4194048)!==0)){var S=h.lanes;S&=d.pendingLanes,y|=S,h.lanes=y,Ue(d,y)}}function US(d,h){var y=d.updateQueue,S=d.alternate;if(S!==null&&(S=S.updateQueue,y===S)){var N=null,$=null;if(y=y.firstBaseUpdate,y!==null){do{var le={lane:y.lane,tag:y.tag,payload:y.payload,callback:null,next:null};$===null?N=$=le:$=$.next=le,y=y.next}while(y!==null);$===null?N=$=h:$=$.next=h}else N=$=h;y={baseState:S.baseState,firstBaseUpdate:N,lastBaseUpdate:$,shared:S.shared,callbacks:S.callbacks},d.updateQueue=y;return}d=y.lastBaseUpdate,d===null?y.firstBaseUpdate=h:d.next=h,y.lastBaseUpdate=h}var qS=!1;function pg(){if(qS){var d=kh;if(d!==null)throw d}}function mg(d,h,y,S){qS=!1;var N=d.updateQueue;ou=!1;var $=N.firstBaseUpdate,le=N.lastBaseUpdate,Ee=N.shared.pending;if(Ee!==null){N.shared.pending=null;var qe=Ee,pt=qe.next;qe.next=null,le===null?$=pt:le.next=pt,le=qe;var Tt=d.alternate;Tt!==null&&(Tt=Tt.updateQueue,Ee=Tt.lastBaseUpdate,Ee!==le&&(Ee===null?Tt.firstBaseUpdate=pt:Ee.next=pt,Tt.lastBaseUpdate=qe))}if($!==null){var jt=N.baseState;le=0,Tt=pt=qe=null,Ee=$;do{var yt=Ee.lane&-536870913,vt=yt!==Ee.lane;if(vt?(hr&yt)===yt:(S&yt)===yt){yt!==0&&yt===Ch&&(qS=!0),Tt!==null&&(Tt=Tt.next={lane:0,tag:Ee.tag,payload:Ee.payload,callback:null,next:null});e:{var Cn=d,vn=Ee;yt=h;var Dr=y;switch(vn.tag){case 1:if(Cn=vn.payload,typeof Cn=="function"){jt=Cn.call(Dr,jt,yt);break e}jt=Cn;break e;case 3:Cn.flags=Cn.flags&-65537|128;case 0:if(Cn=vn.payload,yt=typeof Cn=="function"?Cn.call(Dr,jt,yt):Cn,yt==null)break e;jt=u({},jt,yt);break e;case 2:ou=!0}}yt=Ee.callback,yt!==null&&(d.flags|=64,vt&&(d.flags|=8192),vt=N.callbacks,vt===null?N.callbacks=[yt]:vt.push(yt))}else vt={lane:yt,tag:Ee.tag,payload:Ee.payload,callback:Ee.callback,next:null},Tt===null?(pt=Tt=vt,qe=jt):Tt=Tt.next=vt,le|=yt;if(Ee=Ee.next,Ee===null){if(Ee=N.shared.pending,Ee===null)break;vt=Ee,Ee=vt.next,vt.next=null,N.lastBaseUpdate=vt,N.shared.pending=null}}while(!0);Tt===null&&(qe=jt),N.baseState=qe,N.firstBaseUpdate=pt,N.lastBaseUpdate=Tt,$===null&&(N.shared.lanes=0),yu|=le,d.lanes=le,d.memoizedState=jt}}function k3(d,h){if(typeof d!="function")throw Error(r(191,d));d.call(h)}function T3(d,h){var y=d.callbacks;if(y!==null)for(d.callbacks=null,d=0;d<y.length;d++)k3(y[d],h)}var Th=te(null),fv=te(0);function A3(d,h){d=dc,ae(fv,d),ae(Th,h),dc=d|h.baseLanes}function VS(){ae(fv,dc),ae(Th,Th.current)}function HS(){dc=fv.current,Q(Th),Q(fv)}var uu=0,Zn=null,Or=null,Ts=null,hv=!1,Ah=!1,Gd=!1,pv=0,gg=0,Rh=null,HK=0;function ms(){throw Error(r(321))}function GS(d,h){if(h===null)return!1;for(var y=0;y<h.length&&y<d.length;y++)if(!bi(d[y],h[y]))return!1;return!0}function KS(d,h,y,S,N,$){return uu=$,Zn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,K.H=d===null||d.memoizedState===null?dj:fj,Gd=!1,$=y(S,N),Gd=!1,Ah&&($=N3(h,y,S,N)),R3(d),$}function R3(d){K.H=wv;var h=Or!==null&&Or.next!==null;if(uu=0,Ts=Or=Zn=null,hv=!1,gg=0,Rh=null,h)throw Error(r(300));d===null||Vs||(d=d.dependencies,d!==null&&ov(d)&&(Vs=!0))}function N3(d,h,y,S){Zn=d;var N=0;do{if(Ah&&(Rh=null),gg=0,Ah=!1,25<=N)throw Error(r(301));if(N+=1,Ts=Or=null,d.updateQueue!=null){var $=d.updateQueue;$.lastEffect=null,$.events=null,$.stores=null,$.memoCache!=null&&($.memoCache.index=0)}K.H=JK,$=h(y,S)}while(Ah);return $}function GK(){var d=K.H,h=d.useState()[0];return h=typeof h.then=="function"?yg(h):h,d=d.useState()[0],(Or!==null?Or.memoizedState:null)!==d&&(Zn.flags|=1024),h}function WS(){var d=pv!==0;return pv=0,d}function ZS(d,h,y){h.updateQueue=d.updateQueue,h.flags&=-2053,d.lanes&=~y}function YS(d){if(hv){for(d=d.memoizedState;d!==null;){var h=d.queue;h!==null&&(h.pending=null),d=d.next}hv=!1}uu=0,Ts=Or=Zn=null,Ah=!1,gg=pv=0,Rh=null}function Yi(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ts===null?Zn.memoizedState=Ts=d:Ts=Ts.next=d,Ts}function As(){if(Or===null){var d=Zn.alternate;d=d!==null?d.memoizedState:null}else d=Or.next;var h=Ts===null?Zn.memoizedState:Ts.next;if(h!==null)Ts=h,Or=d;else{if(d===null)throw Zn.alternate===null?Error(r(467)):Error(r(310));Or=d,d={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},Ts===null?Zn.memoizedState=Ts=d:Ts=Ts.next=d}return Ts}function XS(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function yg(d){var h=gg;return gg+=1,Rh===null&&(Rh=[]),d=S3(Rh,d,h),h=Zn,(Ts===null?h.memoizedState:Ts.next)===null&&(h=h.alternate,K.H=h===null||h.memoizedState===null?dj:fj),d}function mv(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return yg(d);if(d.$$typeof===E)return vi(d)}throw Error(r(438,String(d)))}function JS(d){var h=null,y=Zn.updateQueue;if(y!==null&&(h=y.memoCache),h==null){var S=Zn.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(h={data:S.data.map(function(N){return N.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),y===null&&(y=XS(),Zn.updateQueue=y),y.memoCache=h,y=h.data[h.index],y===void 0)for(y=h.data[h.index]=Array(d),S=0;S<d;S++)y[S]=L;return h.index++,y}function ic(d,h){return typeof h=="function"?h(d):h}function gv(d){var h=As();return QS(h,Or,d)}function QS(d,h,y){var S=d.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=y;var N=d.baseQueue,$=S.pending;if($!==null){if(N!==null){var le=N.next;N.next=$.next,$.next=le}h.baseQueue=N=$,S.pending=null}if($=d.baseState,N===null)d.memoizedState=$;else{h=N.next;var Ee=le=null,qe=null,pt=h,Tt=!1;do{var jt=pt.lane&-536870913;if(jt!==pt.lane?(hr&jt)===jt:(uu&jt)===jt){var yt=pt.revertLane;if(yt===0)qe!==null&&(qe=qe.next={lane:0,revertLane:0,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null}),jt===Ch&&(Tt=!0);else if((uu&yt)===yt){pt=pt.next,yt===Ch&&(Tt=!0);continue}else jt={lane:0,revertLane:pt.revertLane,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null},qe===null?(Ee=qe=jt,le=$):qe=qe.next=jt,Zn.lanes|=yt,yu|=yt;jt=pt.action,Gd&&y($,jt),$=pt.hasEagerState?pt.eagerState:y($,jt)}else yt={lane:jt,revertLane:pt.revertLane,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null},qe===null?(Ee=qe=yt,le=$):qe=qe.next=yt,Zn.lanes|=jt,yu|=jt;pt=pt.next}while(pt!==null&&pt!==h);if(qe===null?le=$:qe.next=Ee,!bi($,d.memoizedState)&&(Vs=!0,Tt&&(y=kh,y!==null)))throw y;d.memoizedState=$,d.baseState=le,d.baseQueue=qe,S.lastRenderedState=$}return N===null&&(S.lanes=0),[d.memoizedState,S.dispatch]}function e2(d){var h=As(),y=h.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=d;var S=y.dispatch,N=y.pending,$=h.memoizedState;if(N!==null){y.pending=null;var le=N=N.next;do $=d($,le.action),le=le.next;while(le!==N);bi($,h.memoizedState)||(Vs=!0),h.memoizedState=$,h.baseQueue===null&&(h.baseState=$),y.lastRenderedState=$}return[$,S]}function I3(d,h,y){var S=Zn,N=As(),$=xr;if($){if(y===void 0)throw Error(r(407));y=y()}else y=h();var le=!bi((Or||N).memoizedState,y);le&&(N.memoizedState=y,Vs=!0),N=N.queue;var Ee=O3.bind(null,S,N,d);if(bg(2048,8,Ee,[d]),N.getSnapshot!==h||le||Ts!==null&&Ts.memoizedState.tag&1){if(S.flags|=2048,Nh(9,yv(),M3.bind(null,S,N,y,h),null),Hr===null)throw Error(r(349));$||(uu&124)!==0||j3(S,h,y)}return y}function j3(d,h,y){d.flags|=16384,d={getSnapshot:h,value:y},h=Zn.updateQueue,h===null?(h=XS(),Zn.updateQueue=h,h.stores=[d]):(y=h.stores,y===null?h.stores=[d]:y.push(d))}function M3(d,h,y,S){h.value=y,h.getSnapshot=S,P3(h)&&D3(d)}function O3(d,h,y){return y(function(){P3(h)&&D3(d)})}function P3(d){var h=d.getSnapshot;d=d.value;try{var y=h();return!bi(d,y)}catch{return!0}}function D3(d){var h=yo(d,2);h!==null&&xa(h,d,2)}function t2(d){var h=Yi();if(typeof d=="function"){var y=d;if(d=y(),Gd){Ot(!0);try{y()}finally{Ot(!1)}}}return h.memoizedState=h.baseState=d,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ic,lastRenderedState:d},h}function F3(d,h,y,S){return d.baseState=y,QS(d,Or,typeof S=="function"?S:ic)}function KK(d,h,y,S,N){if(vv(d))throw Error(r(485));if(d=h.action,d!==null){var $={payload:N,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(le){$.listeners.push(le)}};K.T!==null?y(!0):$.isTransition=!1,S($),y=h.pending,y===null?($.next=h.pending=$,L3(h,$)):($.next=y.next,h.pending=y.next=$)}}function L3(d,h){var y=h.action,S=h.payload,N=d.state;if(h.isTransition){var $=K.T,le={};K.T=le;try{var Ee=y(N,S),qe=K.S;qe!==null&&qe(le,Ee),B3(d,h,Ee)}catch(pt){n2(d,h,pt)}finally{K.T=$}}else try{$=y(N,S),B3(d,h,$)}catch(pt){n2(d,h,pt)}}function B3(d,h,y){y!==null&&typeof y=="object"&&typeof y.then=="function"?y.then(function(S){$3(d,h,S)},function(S){return n2(d,h,S)}):$3(d,h,y)}function $3(d,h,y){h.status="fulfilled",h.value=y,z3(h),d.state=y,h=d.pending,h!==null&&(y=h.next,y===h?d.pending=null:(y=y.next,h.next=y,L3(d,y)))}function n2(d,h,y){var S=d.pending;if(d.pending=null,S!==null){S=S.next;do h.status="rejected",h.reason=y,z3(h),h=h.next;while(h!==S)}d.action=null}function z3(d){d=d.listeners;for(var h=0;h<d.length;h++)(0,d[h])()}function U3(d,h){return h}function q3(d,h){if(xr){var y=Hr.formState;if(y!==null){e:{var S=Zn;if(xr){if(cs){t:{for(var N=cs,$=il;N.nodeType!==8;){if(!$){N=null;break t}if(N=vo(N.nextSibling),N===null){N=null;break t}}$=N.data,N=$==="F!"||$==="F"?N:null}if(N){cs=vo(N.nextSibling),S=N.data==="F!";break e}}Ud(S)}S=!1}S&&(h=y[0])}}return y=Yi(),y.memoizedState=y.baseState=h,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:U3,lastRenderedState:h},y.queue=S,y=lj.bind(null,Zn,S),S.dispatch=y,S=t2(!1),$=o2.bind(null,Zn,!1,S.queue),S=Yi(),N={state:h,dispatch:null,action:d,pending:null},S.queue=N,y=KK.bind(null,Zn,N,$,y),N.dispatch=y,S.memoizedState=d,[h,y,!1]}function V3(d){var h=As();return H3(h,Or,d)}function H3(d,h,y){if(h=QS(d,h,U3)[0],d=gv(ic)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var S=yg(h)}catch(le){throw le===dg?uv:le}else S=h;h=As();var N=h.queue,$=N.dispatch;return y!==h.memoizedState&&(Zn.flags|=2048,Nh(9,yv(),WK.bind(null,N,y),null)),[S,$,d]}function WK(d,h){d.action=h}function G3(d){var h=As(),y=Or;if(y!==null)return H3(h,y,d);As(),h=h.memoizedState,y=As();var S=y.queue.dispatch;return y.memoizedState=d,[h,S,!1]}function Nh(d,h,y,S){return d={tag:d,create:y,deps:S,inst:h,next:null},h=Zn.updateQueue,h===null&&(h=XS(),Zn.updateQueue=h),y=h.lastEffect,y===null?h.lastEffect=d.next=d:(S=y.next,y.next=d,d.next=S,h.lastEffect=d),d}function yv(){return{destroy:void 0,resource:void 0}}function K3(){return As().memoizedState}function bv(d,h,y,S){var N=Yi();S=S===void 0?null:S,Zn.flags|=d,N.memoizedState=Nh(1|h,yv(),y,S)}function bg(d,h,y,S){var N=As();S=S===void 0?null:S;var $=N.memoizedState.inst;Or!==null&&S!==null&&GS(S,Or.memoizedState.deps)?N.memoizedState=Nh(h,$,y,S):(Zn.flags|=d,N.memoizedState=Nh(1|h,$,y,S))}function W3(d,h){bv(8390656,8,d,h)}function Z3(d,h){bg(2048,8,d,h)}function Y3(d,h){return bg(4,2,d,h)}function X3(d,h){return bg(4,4,d,h)}function J3(d,h){if(typeof h=="function"){d=d();var y=h(d);return function(){typeof y=="function"?y():h(null)}}if(h!=null)return d=d(),h.current=d,function(){h.current=null}}function Q3(d,h,y){y=y!=null?y.concat([d]):null,bg(4,4,J3.bind(null,h,d),y)}function r2(){}function ej(d,h){var y=As();h=h===void 0?null:h;var S=y.memoizedState;return h!==null&&GS(h,S[1])?S[0]:(y.memoizedState=[d,h],d)}function tj(d,h){var y=As();h=h===void 0?null:h;var S=y.memoizedState;if(h!==null&&GS(h,S[1]))return S[0];if(S=d(),Gd){Ot(!0);try{d()}finally{Ot(!1)}}return y.memoizedState=[S,h],S}function s2(d,h,y){return y===void 0||(uu&1073741824)!==0?d.memoizedState=h:(d.memoizedState=y,d=sM(),Zn.lanes|=d,yu|=d,y)}function nj(d,h,y,S){return bi(y,h)?y:Th.current!==null?(d=s2(d,y,S),bi(d,h)||(Vs=!0),d):(uu&42)===0?(Vs=!0,d.memoizedState=y):(d=sM(),Zn.lanes|=d,yu|=d,h)}function rj(d,h,y,S,N){var $=ee.p;ee.p=$!==0&&8>$?$:8;var le=K.T,Ee={};K.T=Ee,o2(d,!1,h,y);try{var qe=N(),pt=K.S;if(pt!==null&&pt(Ee,qe),qe!==null&&typeof qe=="object"&&typeof qe.then=="function"){var Tt=VK(qe,S);vg(d,h,Tt,wa(d))}else vg(d,h,S,wa(d))}catch(jt){vg(d,h,{then:function(){},status:"rejected",reason:jt},wa())}finally{ee.p=$,K.T=le}}function ZK(){}function i2(d,h,y,S){if(d.tag!==5)throw Error(r(476));var N=sj(d).queue;rj(d,N,h,W,y===null?ZK:function(){return ij(d),y(S)})}function sj(d){var h=d.memoizedState;if(h!==null)return h;h={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ic,lastRenderedState:W},next:null};var y={};return h.next={memoizedState:y,baseState:y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ic,lastRenderedState:y},next:null},d.memoizedState=h,d=d.alternate,d!==null&&(d.memoizedState=h),h}function ij(d){var h=sj(d).next.queue;vg(d,h,{},wa())}function a2(){return vi(Fg)}function aj(){return As().memoizedState}function oj(){return As().memoizedState}function YK(d){for(var h=d.return;h!==null;){switch(h.tag){case 24:case 3:var y=wa();d=lu(y);var S=cu(h,d,y);S!==null&&(xa(S,h,y),hg(S,h,y)),h={cache:DS()},d.payload=h;return}h=h.return}}function XK(d,h,y){var S=wa();y={lane:S,revertLane:0,action:y,hasEagerState:!1,eagerState:null,next:null},vv(d)?cj(h,y):(y=ks(d,h,y,S),y!==null&&(xa(y,d,S),uj(y,h,S)))}function lj(d,h,y){var S=wa();vg(d,h,y,S)}function vg(d,h,y,S){var N={lane:S,revertLane:0,action:y,hasEagerState:!1,eagerState:null,next:null};if(vv(d))cj(h,N);else{var $=d.alternate;if(d.lanes===0&&($===null||$.lanes===0)&&($=h.lastRenderedReducer,$!==null))try{var le=h.lastRenderedState,Ee=$(le,y);if(N.hasEagerState=!0,N.eagerState=Ee,bi(Ee,le))return ps(d,h,N,0),Hr===null&&En(),!1}catch{}finally{}if(y=ks(d,h,N,S),y!==null)return xa(y,d,S),uj(y,h,S),!0}return!1}function o2(d,h,y,S){if(S={lane:2,revertLane:B2(),action:S,hasEagerState:!1,eagerState:null,next:null},vv(d)){if(h)throw Error(r(479))}else h=ks(d,y,S,2),h!==null&&xa(h,d,2)}function vv(d){var h=d.alternate;return d===Zn||h!==null&&h===Zn}function cj(d,h){Ah=hv=!0;var y=d.pending;y===null?h.next=h:(h.next=y.next,y.next=h),d.pending=h}function uj(d,h,y){if((y&4194048)!==0){var S=h.lanes;S&=d.pendingLanes,y|=S,h.lanes=y,Ue(d,y)}}var wv={readContext:vi,use:mv,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useLayoutEffect:ms,useInsertionEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useSyncExternalStore:ms,useId:ms,useHostTransitionStatus:ms,useFormState:ms,useActionState:ms,useOptimistic:ms,useMemoCache:ms,useCacheRefresh:ms},dj={readContext:vi,use:mv,useCallback:function(d,h){return Yi().memoizedState=[d,h===void 0?null:h],d},useContext:vi,useEffect:W3,useImperativeHandle:function(d,h,y){y=y!=null?y.concat([d]):null,bv(4194308,4,J3.bind(null,h,d),y)},useLayoutEffect:function(d,h){return bv(4194308,4,d,h)},useInsertionEffect:function(d,h){bv(4,2,d,h)},useMemo:function(d,h){var y=Yi();h=h===void 0?null:h;var S=d();if(Gd){Ot(!0);try{d()}finally{Ot(!1)}}return y.memoizedState=[S,h],S},useReducer:function(d,h,y){var S=Yi();if(y!==void 0){var N=y(h);if(Gd){Ot(!0);try{y(h)}finally{Ot(!1)}}}else N=h;return S.memoizedState=S.baseState=N,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:N},S.queue=d,d=d.dispatch=XK.bind(null,Zn,d),[S.memoizedState,d]},useRef:function(d){var h=Yi();return d={current:d},h.memoizedState=d},useState:function(d){d=t2(d);var h=d.queue,y=lj.bind(null,Zn,h);return h.dispatch=y,[d.memoizedState,y]},useDebugValue:r2,useDeferredValue:function(d,h){var y=Yi();return s2(y,d,h)},useTransition:function(){var d=t2(!1);return d=rj.bind(null,Zn,d.queue,!0,!1),Yi().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,h,y){var S=Zn,N=Yi();if(xr){if(y===void 0)throw Error(r(407));y=y()}else{if(y=h(),Hr===null)throw Error(r(349));(hr&124)!==0||j3(S,h,y)}N.memoizedState=y;var $={value:y,getSnapshot:h};return N.queue=$,W3(O3.bind(null,S,$,d),[d]),S.flags|=2048,Nh(9,yv(),M3.bind(null,S,$,y,h),null),y},useId:function(){var d=Yi(),h=Hr.identifierPrefix;if(xr){var y=nc,S=tc;y=(S&~(1<<32-Gt(S)-1)).toString(32)+y,h=""+h+"R"+y,y=pv++,0<y&&(h+="H"+y.toString(32)),h+=""}else y=HK++,h=""+h+"r"+y.toString(32)+"";return d.memoizedState=h},useHostTransitionStatus:a2,useFormState:q3,useActionState:q3,useOptimistic:function(d){var h=Yi();h.memoizedState=h.baseState=d;var y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=y,h=o2.bind(null,Zn,!0,y),y.dispatch=h,[d,h]},useMemoCache:JS,useCacheRefresh:function(){return Yi().memoizedState=YK.bind(null,Zn)}},fj={readContext:vi,use:mv,useCallback:ej,useContext:vi,useEffect:Z3,useImperativeHandle:Q3,useInsertionEffect:Y3,useLayoutEffect:X3,useMemo:tj,useReducer:gv,useRef:K3,useState:function(){return gv(ic)},useDebugValue:r2,useDeferredValue:function(d,h){var y=As();return nj(y,Or.memoizedState,d,h)},useTransition:function(){var d=gv(ic)[0],h=As().memoizedState;return[typeof d=="boolean"?d:yg(d),h]},useSyncExternalStore:I3,useId:aj,useHostTransitionStatus:a2,useFormState:V3,useActionState:V3,useOptimistic:function(d,h){var y=As();return F3(y,Or,d,h)},useMemoCache:JS,useCacheRefresh:oj},JK={readContext:vi,use:mv,useCallback:ej,useContext:vi,useEffect:Z3,useImperativeHandle:Q3,useInsertionEffect:Y3,useLayoutEffect:X3,useMemo:tj,useReducer:e2,useRef:K3,useState:function(){return e2(ic)},useDebugValue:r2,useDeferredValue:function(d,h){var y=As();return Or===null?s2(y,d,h):nj(y,Or.memoizedState,d,h)},useTransition:function(){var d=e2(ic)[0],h=As().memoizedState;return[typeof d=="boolean"?d:yg(d),h]},useSyncExternalStore:I3,useId:aj,useHostTransitionStatus:a2,useFormState:G3,useActionState:G3,useOptimistic:function(d,h){var y=As();return Or!==null?F3(y,Or,d,h):(y.baseState=d,[d,y.queue.dispatch])},useMemoCache:JS,useCacheRefresh:oj},Ih=null,wg=0;function xv(d){var h=wg;return wg+=1,Ih===null&&(Ih=[]),S3(Ih,d,h)}function xg(d,h){h=h.props.ref,d.ref=h!==void 0?h:null}function _v(d,h){throw h.$$typeof===f?Error(r(525)):(d=Object.prototype.toString.call(h),Error(r(31,d==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":d)))}function hj(d){var h=d._init;return h(d._payload)}function pj(d){function h(at,Je){if(d){var ft=at.deletions;ft===null?(at.deletions=[Je],at.flags|=16):ft.push(Je)}}function y(at,Je){if(!d)return null;for(;Je!==null;)h(at,Je),Je=Je.sibling;return null}function S(at){for(var Je=new Map;at!==null;)at.key!==null?Je.set(at.key,at):Je.set(at.index,at),at=at.sibling;return Je}function N(at,Je){return at=ec(at,Je),at.index=0,at.sibling=null,at}function $(at,Je,ft){return at.index=ft,d?(ft=at.alternate,ft!==null?(ft=ft.index,ft<Je?(at.flags|=67108866,Je):ft):(at.flags|=67108866,Je)):(at.flags|=1048576,Je)}function le(at){return d&&at.alternate===null&&(at.flags|=67108866),at}function Ee(at,Je,ft,Nt){return Je===null||Je.tag!==6?(Je=AS(ft,at.mode,Nt),Je.return=at,Je):(Je=N(Je,ft),Je.return=at,Je)}function qe(at,Je,ft,Nt){var on=ft.type;return on===v?Tt(at,Je,ft.props.children,Nt,ft.key):Je!==null&&(Je.elementType===on||typeof on=="object"&&on!==null&&on.$$typeof===j&&hj(on)===Je.type)?(Je=N(Je,ft.props),xg(Je,ft),Je.return=at,Je):(Je=sv(ft.type,ft.key,ft.props,null,at.mode,Nt),xg(Je,ft),Je.return=at,Je)}function pt(at,Je,ft,Nt){return Je===null||Je.tag!==4||Je.stateNode.containerInfo!==ft.containerInfo||Je.stateNode.implementation!==ft.implementation?(Je=RS(ft,at.mode,Nt),Je.return=at,Je):(Je=N(Je,ft.children||[]),Je.return=at,Je)}function Tt(at,Je,ft,Nt,on){return Je===null||Je.tag!==7?(Je=Ld(ft,at.mode,Nt,on),Je.return=at,Je):(Je=N(Je,ft),Je.return=at,Je)}function jt(at,Je,ft){if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return Je=AS(""+Je,at.mode,ft),Je.return=at,Je;if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case m:return ft=sv(Je.type,Je.key,Je.props,null,at.mode,ft),xg(ft,Je),ft.return=at,ft;case g:return Je=RS(Je,at.mode,ft),Je.return=at,Je;case j:var Nt=Je._init;return Je=Nt(Je._payload),jt(at,Je,ft)}if(re(Je)||P(Je))return Je=Ld(Je,at.mode,ft,null),Je.return=at,Je;if(typeof Je.then=="function")return jt(at,xv(Je),ft);if(Je.$$typeof===E)return jt(at,lv(at,Je),ft);_v(at,Je)}return null}function yt(at,Je,ft,Nt){var on=Je!==null?Je.key:null;if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return on!==null?null:Ee(at,Je,""+ft,Nt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case m:return ft.key===on?qe(at,Je,ft,Nt):null;case g:return ft.key===on?pt(at,Je,ft,Nt):null;case j:return on=ft._init,ft=on(ft._payload),yt(at,Je,ft,Nt)}if(re(ft)||P(ft))return on!==null?null:Tt(at,Je,ft,Nt,null);if(typeof ft.then=="function")return yt(at,Je,xv(ft),Nt);if(ft.$$typeof===E)return yt(at,Je,lv(at,ft),Nt);_v(at,ft)}return null}function vt(at,Je,ft,Nt,on){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return at=at.get(ft)||null,Ee(Je,at,""+Nt,on);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case m:return at=at.get(Nt.key===null?ft:Nt.key)||null,qe(Je,at,Nt,on);case g:return at=at.get(Nt.key===null?ft:Nt.key)||null,pt(Je,at,Nt,on);case j:var Jn=Nt._init;return Nt=Jn(Nt._payload),vt(at,Je,ft,Nt,on)}if(re(Nt)||P(Nt))return at=at.get(ft)||null,Tt(Je,at,Nt,on,null);if(typeof Nt.then=="function")return vt(at,Je,ft,xv(Nt),on);if(Nt.$$typeof===E)return vt(at,Je,ft,lv(Je,Nt),on);_v(Je,Nt)}return null}function Cn(at,Je,ft,Nt){for(var on=null,Jn=null,fn=Je,_n=Je=0,Gs=null;fn!==null&&_n<ft.length;_n++){fn.index>_n?(Gs=fn,fn=null):Gs=fn.sibling;var vr=yt(at,fn,ft[_n],Nt);if(vr===null){fn===null&&(fn=Gs);break}d&&fn&&vr.alternate===null&&h(at,fn),Je=$(vr,Je,_n),Jn===null?on=vr:Jn.sibling=vr,Jn=vr,fn=Gs}if(_n===ft.length)return y(at,fn),xr&&$d(at,_n),on;if(fn===null){for(;_n<ft.length;_n++)fn=jt(at,ft[_n],Nt),fn!==null&&(Je=$(fn,Je,_n),Jn===null?on=fn:Jn.sibling=fn,Jn=fn);return xr&&$d(at,_n),on}for(fn=S(fn);_n<ft.length;_n++)Gs=vt(fn,at,_n,ft[_n],Nt),Gs!==null&&(d&&Gs.alternate!==null&&fn.delete(Gs.key===null?_n:Gs.key),Je=$(Gs,Je,_n),Jn===null?on=Gs:Jn.sibling=Gs,Jn=Gs);return d&&fn.forEach(function(ku){return h(at,ku)}),xr&&$d(at,_n),on}function vn(at,Je,ft,Nt){if(ft==null)throw Error(r(151));for(var on=null,Jn=null,fn=Je,_n=Je=0,Gs=null,vr=ft.next();fn!==null&&!vr.done;_n++,vr=ft.next()){fn.index>_n?(Gs=fn,fn=null):Gs=fn.sibling;var ku=yt(at,fn,vr.value,Nt);if(ku===null){fn===null&&(fn=Gs);break}d&&fn&&ku.alternate===null&&h(at,fn),Je=$(ku,Je,_n),Jn===null?on=ku:Jn.sibling=ku,Jn=ku,fn=Gs}if(vr.done)return y(at,fn),xr&&$d(at,_n),on;if(fn===null){for(;!vr.done;_n++,vr=ft.next())vr=jt(at,vr.value,Nt),vr!==null&&(Je=$(vr,Je,_n),Jn===null?on=vr:Jn.sibling=vr,Jn=vr);return xr&&$d(at,_n),on}for(fn=S(fn);!vr.done;_n++,vr=ft.next())vr=vt(fn,at,_n,vr.value,Nt),vr!==null&&(d&&vr.alternate!==null&&fn.delete(vr.key===null?_n:vr.key),Je=$(vr,Je,_n),Jn===null?on=vr:Jn.sibling=vr,Jn=vr);return d&&fn.forEach(function(QW){return h(at,QW)}),xr&&$d(at,_n),on}function Dr(at,Je,ft,Nt){if(typeof ft=="object"&&ft!==null&&ft.type===v&&ft.key===null&&(ft=ft.props.children),typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case m:e:{for(var on=ft.key;Je!==null;){if(Je.key===on){if(on=ft.type,on===v){if(Je.tag===7){y(at,Je.sibling),Nt=N(Je,ft.props.children),Nt.return=at,at=Nt;break e}}else if(Je.elementType===on||typeof on=="object"&&on!==null&&on.$$typeof===j&&hj(on)===Je.type){y(at,Je.sibling),Nt=N(Je,ft.props),xg(Nt,ft),Nt.return=at,at=Nt;break e}y(at,Je);break}else h(at,Je);Je=Je.sibling}ft.type===v?(Nt=Ld(ft.props.children,at.mode,Nt,ft.key),Nt.return=at,at=Nt):(Nt=sv(ft.type,ft.key,ft.props,null,at.mode,Nt),xg(Nt,ft),Nt.return=at,at=Nt)}return le(at);case g:e:{for(on=ft.key;Je!==null;){if(Je.key===on)if(Je.tag===4&&Je.stateNode.containerInfo===ft.containerInfo&&Je.stateNode.implementation===ft.implementation){y(at,Je.sibling),Nt=N(Je,ft.children||[]),Nt.return=at,at=Nt;break e}else{y(at,Je);break}else h(at,Je);Je=Je.sibling}Nt=RS(ft,at.mode,Nt),Nt.return=at,at=Nt}return le(at);case j:return on=ft._init,ft=on(ft._payload),Dr(at,Je,ft,Nt)}if(re(ft))return Cn(at,Je,ft,Nt);if(P(ft)){if(on=P(ft),typeof on!="function")throw Error(r(150));return ft=on.call(ft),vn(at,Je,ft,Nt)}if(typeof ft.then=="function")return Dr(at,Je,xv(ft),Nt);if(ft.$$typeof===E)return Dr(at,Je,lv(at,ft),Nt);_v(at,ft)}return typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint"?(ft=""+ft,Je!==null&&Je.tag===6?(y(at,Je.sibling),Nt=N(Je,ft),Nt.return=at,at=Nt):(y(at,Je),Nt=AS(ft,at.mode,Nt),Nt.return=at,at=Nt),le(at)):y(at,Je)}return function(at,Je,ft,Nt){try{wg=0;var on=Dr(at,Je,ft,Nt);return Ih=null,on}catch(fn){if(fn===dg||fn===uv)throw fn;var Jn=ga(29,fn,null,at.mode);return Jn.lanes=Nt,Jn.return=at,Jn}finally{}}}var jh=pj(!0),mj=pj(!1),Ua=te(null),al=null;function du(d){var h=d.alternate;ae(Ps,Ps.current&1),ae(Ua,d),al===null&&(h===null||Th.current!==null||h.memoizedState!==null)&&(al=d)}function gj(d){if(d.tag===22){if(ae(Ps,Ps.current),ae(Ua,d),al===null){var h=d.alternate;h!==null&&h.memoizedState!==null&&(al=d)}}else fu()}function fu(){ae(Ps,Ps.current),ae(Ua,Ua.current)}function ac(d){Q(Ua),al===d&&(al=null),Q(Ps)}var Ps=te(0);function Sv(d){for(var h=d;h!==null;){if(h.tag===13){var y=h.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||y.data==="$?"||X2(y)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===d)break;for(;h.sibling===null;){if(h.return===null||h.return===d)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function l2(d,h,y,S){h=d.memoizedState,y=y(S,h),y=y==null?h:u({},h,y),d.memoizedState=y,d.lanes===0&&(d.updateQueue.baseState=y)}var c2={enqueueSetState:function(d,h,y){d=d._reactInternals;var S=wa(),N=lu(S);N.payload=h,y!=null&&(N.callback=y),h=cu(d,N,S),h!==null&&(xa(h,d,S),hg(h,d,S))},enqueueReplaceState:function(d,h,y){d=d._reactInternals;var S=wa(),N=lu(S);N.tag=1,N.payload=h,y!=null&&(N.callback=y),h=cu(d,N,S),h!==null&&(xa(h,d,S),hg(h,d,S))},enqueueForceUpdate:function(d,h){d=d._reactInternals;var y=wa(),S=lu(y);S.tag=2,h!=null&&(S.callback=h),h=cu(d,S,y),h!==null&&(xa(h,d,y),hg(h,d,y))}};function yj(d,h,y,S,N,$,le){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(S,$,le):h.prototype&&h.prototype.isPureReactComponent?!A(y,S)||!A(N,$):!0}function bj(d,h,y,S){d=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(y,S),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(y,S),h.state!==d&&c2.enqueueReplaceState(h,h.state,null)}function Kd(d,h){var y=h;if("ref"in h){y={};for(var S in h)S!=="ref"&&(y[S]=h[S])}if(d=d.defaultProps){y===h&&(y=u({},y));for(var N in d)y[N]===void 0&&(y[N]=d[N])}return y}var Ev=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(h))return}else if(typeof vs=="object"&&typeof vs.emit=="function"){vs.emit("uncaughtException",d);return}console.error(d)};function vj(d){Ev(d)}function wj(d){console.error(d)}function xj(d){Ev(d)}function Cv(d,h){try{var y=d.onUncaughtError;y(h.value,{componentStack:h.stack})}catch(S){setTimeout(function(){throw S})}}function _j(d,h,y){try{var S=d.onCaughtError;S(y.value,{componentStack:y.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function u2(d,h,y){return y=lu(y),y.tag=3,y.payload={element:null},y.callback=function(){Cv(d,h)},y}function Sj(d){return d=lu(d),d.tag=3,d}function Ej(d,h,y,S){var N=y.type.getDerivedStateFromError;if(typeof N=="function"){var $=S.value;d.payload=function(){return N($)},d.callback=function(){_j(h,y,S)}}var le=y.stateNode;le!==null&&typeof le.componentDidCatch=="function"&&(d.callback=function(){_j(h,y,S),typeof N!="function"&&(bu===null?bu=new Set([this]):bu.add(this));var Ee=S.stack;this.componentDidCatch(S.value,{componentStack:Ee!==null?Ee:""})})}function QK(d,h,y,S,N){if(y.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(h=y.alternate,h!==null&&lg(h,y,N,!0),y=Ua.current,y!==null){switch(y.tag){case 13:return al===null?O2():y.alternate===null&&us===0&&(us=3),y.flags&=-257,y.flags|=65536,y.lanes=N,S===BS?y.flags|=16384:(h=y.updateQueue,h===null?y.updateQueue=new Set([S]):h.add(S),D2(d,S,N)),!1;case 22:return y.flags|=65536,S===BS?y.flags|=16384:(h=y.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([S])},y.updateQueue=h):(y=h.retryQueue,y===null?h.retryQueue=new Set([S]):y.add(S)),D2(d,S,N)),!1}throw Error(r(435,y.tag))}return D2(d,S,N),O2(),!1}if(xr)return h=Ua.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=N,S!==jS&&(d=Error(r(422),{cause:S}),og(pn(d,y)))):(S!==jS&&(h=Error(r(423),{cause:S}),og(pn(h,y))),d=d.current.alternate,d.flags|=65536,N&=-N,d.lanes|=N,S=pn(S,y),N=u2(d.stateNode,S,N),US(d,N),us!==4&&(us=2)),!1;var $=Error(r(520),{cause:S});if($=pn($,y),Ag===null?Ag=[$]:Ag.push($),us!==4&&(us=2),h===null)return!0;S=pn(S,y),y=h;do{switch(y.tag){case 3:return y.flags|=65536,d=N&-N,y.lanes|=d,d=u2(y.stateNode,S,d),US(y,d),!1;case 1:if(h=y.type,$=y.stateNode,(y.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(bu===null||!bu.has($))))return y.flags|=65536,N&=-N,y.lanes|=N,N=Sj(N),Ej(N,d,y,S),US(y,N),!1}y=y.return}while(y!==null);return!1}var Cj=Error(r(461)),Vs=!1;function oi(d,h,y,S){h.child=d===null?mj(h,null,y,S):jh(h,d.child,y,S)}function kj(d,h,y,S,N){y=y.render;var $=h.ref;if("ref"in S){var le={};for(var Ee in S)Ee!=="ref"&&(le[Ee]=S[Ee])}else le=S;return Vd(h),S=KS(d,h,y,le,$,N),Ee=WS(),d!==null&&!Vs?(ZS(d,h,N),oc(d,h,N)):(xr&&Ee&&NS(h),h.flags|=1,oi(d,h,S,N),h.child)}function Tj(d,h,y,S,N){if(d===null){var $=y.type;return typeof $=="function"&&!TS($)&&$.defaultProps===void 0&&y.compare===null?(h.tag=15,h.type=$,Aj(d,h,$,S,N)):(d=sv(y.type,null,S,h,h.mode,N),d.ref=h.ref,d.return=h,h.child=d)}if($=d.child,!b2(d,N)){var le=$.memoizedProps;if(y=y.compare,y=y!==null?y:A,y(le,S)&&d.ref===h.ref)return oc(d,h,N)}return h.flags|=1,d=ec($,S),d.ref=h.ref,d.return=h,h.child=d}function Aj(d,h,y,S,N){if(d!==null){var $=d.memoizedProps;if(A($,S)&&d.ref===h.ref)if(Vs=!1,h.pendingProps=S=$,b2(d,N))(d.flags&131072)!==0&&(Vs=!0);else return h.lanes=d.lanes,oc(d,h,N)}return d2(d,h,y,S,N)}function Rj(d,h,y){var S=h.pendingProps,N=S.children,$=d!==null?d.memoizedState:null;if(S.mode==="hidden"){if((h.flags&128)!==0){if(S=$!==null?$.baseLanes|y:y,d!==null){for(N=h.child=d.child,$=0;N!==null;)$=$|N.lanes|N.childLanes,N=N.sibling;h.childLanes=$&~S}else h.childLanes=0,h.child=null;return Nj(d,h,S,y)}if((y&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},d!==null&&cv(h,$!==null?$.cachePool:null),$!==null?A3(h,$):VS(),gj(h);else return h.lanes=h.childLanes=536870912,Nj(d,h,$!==null?$.baseLanes|y:y,y)}else $!==null?(cv(h,$.cachePool),A3(h,$),fu(),h.memoizedState=null):(d!==null&&cv(h,null),VS(),fu());return oi(d,h,N,y),h.child}function Nj(d,h,y,S){var N=LS();return N=N===null?null:{parent:Os._currentValue,pool:N},h.memoizedState={baseLanes:y,cachePool:N},d!==null&&cv(h,null),VS(),gj(h),d!==null&&lg(d,h,S,!0),null}function kv(d,h){var y=h.ref;if(y===null)d!==null&&d.ref!==null&&(h.flags|=4194816);else{if(typeof y!="function"&&typeof y!="object")throw Error(r(284));(d===null||d.ref!==y)&&(h.flags|=4194816)}}function d2(d,h,y,S,N){return Vd(h),y=KS(d,h,y,S,void 0,N),S=WS(),d!==null&&!Vs?(ZS(d,h,N),oc(d,h,N)):(xr&&S&&NS(h),h.flags|=1,oi(d,h,y,N),h.child)}function Ij(d,h,y,S,N,$){return Vd(h),h.updateQueue=null,y=N3(h,S,y,N),R3(d),S=WS(),d!==null&&!Vs?(ZS(d,h,$),oc(d,h,$)):(xr&&S&&NS(h),h.flags|=1,oi(d,h,y,$),h.child)}function jj(d,h,y,S,N){if(Vd(h),h.stateNode===null){var $=sl,le=y.contextType;typeof le=="object"&&le!==null&&($=vi(le)),$=new y(S,$),h.memoizedState=$.state!==null&&$.state!==void 0?$.state:null,$.updater=c2,h.stateNode=$,$._reactInternals=h,$=h.stateNode,$.props=S,$.state=h.memoizedState,$.refs={},$S(h),le=y.contextType,$.context=typeof le=="object"&&le!==null?vi(le):sl,$.state=h.memoizedState,le=y.getDerivedStateFromProps,typeof le=="function"&&(l2(h,y,le,S),$.state=h.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof $.getSnapshotBeforeUpdate=="function"||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(le=$.state,typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount(),le!==$.state&&c2.enqueueReplaceState($,$.state,null),mg(h,S,$,N),pg(),$.state=h.memoizedState),typeof $.componentDidMount=="function"&&(h.flags|=4194308),S=!0}else if(d===null){$=h.stateNode;var Ee=h.memoizedProps,qe=Kd(y,Ee);$.props=qe;var pt=$.context,Tt=y.contextType;le=sl,typeof Tt=="object"&&Tt!==null&&(le=vi(Tt));var jt=y.getDerivedStateFromProps;Tt=typeof jt=="function"||typeof $.getSnapshotBeforeUpdate=="function",Ee=h.pendingProps!==Ee,Tt||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(Ee||pt!==le)&&bj(h,$,S,le),ou=!1;var yt=h.memoizedState;$.state=yt,mg(h,S,$,N),pg(),pt=h.memoizedState,Ee||yt!==pt||ou?(typeof jt=="function"&&(l2(h,y,jt,S),pt=h.memoizedState),(qe=ou||yj(h,y,qe,S,yt,pt,le))?(Tt||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(h.flags|=4194308)):(typeof $.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=S,h.memoizedState=pt),$.props=S,$.state=pt,$.context=le,S=qe):(typeof $.componentDidMount=="function"&&(h.flags|=4194308),S=!1)}else{$=h.stateNode,zS(d,h),le=h.memoizedProps,Tt=Kd(y,le),$.props=Tt,jt=h.pendingProps,yt=$.context,pt=y.contextType,qe=sl,typeof pt=="object"&&pt!==null&&(qe=vi(pt)),Ee=y.getDerivedStateFromProps,(pt=typeof Ee=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(le!==jt||yt!==qe)&&bj(h,$,S,qe),ou=!1,yt=h.memoizedState,$.state=yt,mg(h,S,$,N),pg();var vt=h.memoizedState;le!==jt||yt!==vt||ou||d!==null&&d.dependencies!==null&&ov(d.dependencies)?(typeof Ee=="function"&&(l2(h,y,Ee,S),vt=h.memoizedState),(Tt=ou||yj(h,y,Tt,S,yt,vt,qe)||d!==null&&d.dependencies!==null&&ov(d.dependencies))?(pt||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(S,vt,qe),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(S,vt,qe)),typeof $.componentDidUpdate=="function"&&(h.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof $.componentDidUpdate!="function"||le===d.memoizedProps&&yt===d.memoizedState||(h.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||le===d.memoizedProps&&yt===d.memoizedState||(h.flags|=1024),h.memoizedProps=S,h.memoizedState=vt),$.props=S,$.state=vt,$.context=qe,S=Tt):(typeof $.componentDidUpdate!="function"||le===d.memoizedProps&&yt===d.memoizedState||(h.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||le===d.memoizedProps&&yt===d.memoizedState||(h.flags|=1024),S=!1)}return $=S,kv(d,h),S=(h.flags&128)!==0,$||S?($=h.stateNode,y=S&&typeof y.getDerivedStateFromError!="function"?null:$.render(),h.flags|=1,d!==null&&S?(h.child=jh(h,d.child,null,N),h.child=jh(h,null,y,N)):oi(d,h,y,N),h.memoizedState=$.state,d=h.child):d=oc(d,h,N),d}function Mj(d,h,y,S){return ag(),h.flags|=256,oi(d,h,y,S),h.child}var f2={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function h2(d){return{baseLanes:d,cachePool:w3()}}function p2(d,h,y){return d=d!==null?d.childLanes&~y:0,h&&(d|=qa),d}function Oj(d,h,y){var S=h.pendingProps,N=!1,$=(h.flags&128)!==0,le;if((le=$)||(le=d!==null&&d.memoizedState===null?!1:(Ps.current&2)!==0),le&&(N=!0,h.flags&=-129),le=(h.flags&32)!==0,h.flags&=-33,d===null){if(xr){if(N?du(h):fu(),xr){var Ee=cs,qe;if(qe=Ee){e:{for(qe=Ee,Ee=il;qe.nodeType!==8;){if(!Ee){Ee=null;break e}if(qe=vo(qe.nextSibling),qe===null){Ee=null;break e}}Ee=qe}Ee!==null?(h.memoizedState={dehydrated:Ee,treeContext:Bd!==null?{id:tc,overflow:nc}:null,retryLane:536870912,hydrationErrors:null},qe=ga(18,null,null,0),qe.stateNode=Ee,qe.return=h,h.child=qe,Fi=h,cs=null,qe=!0):qe=!1}qe||Ud(h)}if(Ee=h.memoizedState,Ee!==null&&(Ee=Ee.dehydrated,Ee!==null))return X2(Ee)?h.lanes=32:h.lanes=536870912,null;ac(h)}return Ee=S.children,S=S.fallback,N?(fu(),N=h.mode,Ee=Tv({mode:"hidden",children:Ee},N),S=Ld(S,N,y,null),Ee.return=h,S.return=h,Ee.sibling=S,h.child=Ee,N=h.child,N.memoizedState=h2(y),N.childLanes=p2(d,le,y),h.memoizedState=f2,S):(du(h),m2(h,Ee))}if(qe=d.memoizedState,qe!==null&&(Ee=qe.dehydrated,Ee!==null)){if($)h.flags&256?(du(h),h.flags&=-257,h=g2(d,h,y)):h.memoizedState!==null?(fu(),h.child=d.child,h.flags|=128,h=null):(fu(),N=S.fallback,Ee=h.mode,S=Tv({mode:"visible",children:S.children},Ee),N=Ld(N,Ee,y,null),N.flags|=2,S.return=h,N.return=h,S.sibling=N,h.child=S,jh(h,d.child,null,y),S=h.child,S.memoizedState=h2(y),S.childLanes=p2(d,le,y),h.memoizedState=f2,h=N);else if(du(h),X2(Ee)){if(le=Ee.nextSibling&&Ee.nextSibling.dataset,le)var pt=le.dgst;le=pt,S=Error(r(419)),S.stack="",S.digest=le,og({value:S,source:null,stack:null}),h=g2(d,h,y)}else if(Vs||lg(d,h,y,!1),le=(y&d.childLanes)!==0,Vs||le){if(le=Hr,le!==null&&(S=y&-y,S=(S&42)!==0?1:Et(S),S=(S&(le.suspendedLanes|y))!==0?0:S,S!==0&&S!==qe.retryLane))throw qe.retryLane=S,yo(d,S),xa(le,d,S),Cj;Ee.data==="$?"||O2(),h=g2(d,h,y)}else Ee.data==="$?"?(h.flags|=192,h.child=d.child,h=null):(d=qe.treeContext,cs=vo(Ee.nextSibling),Fi=h,xr=!0,zd=null,il=!1,d!==null&&($a[za++]=tc,$a[za++]=nc,$a[za++]=Bd,tc=d.id,nc=d.overflow,Bd=h),h=m2(h,S.children),h.flags|=4096);return h}return N?(fu(),N=S.fallback,Ee=h.mode,qe=d.child,pt=qe.sibling,S=ec(qe,{mode:"hidden",children:S.children}),S.subtreeFlags=qe.subtreeFlags&65011712,pt!==null?N=ec(pt,N):(N=Ld(N,Ee,y,null),N.flags|=2),N.return=h,S.return=h,S.sibling=N,h.child=S,S=N,N=h.child,Ee=d.child.memoizedState,Ee===null?Ee=h2(y):(qe=Ee.cachePool,qe!==null?(pt=Os._currentValue,qe=qe.parent!==pt?{parent:pt,pool:pt}:qe):qe=w3(),Ee={baseLanes:Ee.baseLanes|y,cachePool:qe}),N.memoizedState=Ee,N.childLanes=p2(d,le,y),h.memoizedState=f2,S):(du(h),y=d.child,d=y.sibling,y=ec(y,{mode:"visible",children:S.children}),y.return=h,y.sibling=null,d!==null&&(le=h.deletions,le===null?(h.deletions=[d],h.flags|=16):le.push(d)),h.child=y,h.memoizedState=null,y)}function m2(d,h){return h=Tv({mode:"visible",children:h},d.mode),h.return=d,d.child=h}function Tv(d,h){return d=ga(22,d,null,h),d.lanes=0,d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},d}function g2(d,h,y){return jh(h,d.child,null,y),d=m2(h,h.pendingProps.children),d.flags|=2,h.memoizedState=null,d}function Pj(d,h,y){d.lanes|=h;var S=d.alternate;S!==null&&(S.lanes|=h),OS(d.return,h,y)}function y2(d,h,y,S,N){var $=d.memoizedState;$===null?d.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:S,tail:y,tailMode:N}:($.isBackwards=h,$.rendering=null,$.renderingStartTime=0,$.last=S,$.tail=y,$.tailMode=N)}function Dj(d,h,y){var S=h.pendingProps,N=S.revealOrder,$=S.tail;if(oi(d,h,S.children,y),S=Ps.current,(S&2)!==0)S=S&1|2,h.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=h.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&Pj(d,y,h);else if(d.tag===19)Pj(d,y,h);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===h)break e;for(;d.sibling===null;){if(d.return===null||d.return===h)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}S&=1}switch(ae(Ps,S),N){case"forwards":for(y=h.child,N=null;y!==null;)d=y.alternate,d!==null&&Sv(d)===null&&(N=y),y=y.sibling;y=N,y===null?(N=h.child,h.child=null):(N=y.sibling,y.sibling=null),y2(h,!1,N,y,$);break;case"backwards":for(y=null,N=h.child,h.child=null;N!==null;){if(d=N.alternate,d!==null&&Sv(d)===null){h.child=N;break}d=N.sibling,N.sibling=y,y=N,N=d}y2(h,!0,y,null,$);break;case"together":y2(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function oc(d,h,y){if(d!==null&&(h.dependencies=d.dependencies),yu|=h.lanes,(y&h.childLanes)===0)if(d!==null){if(lg(d,h,y,!1),(y&h.childLanes)===0)return null}else return null;if(d!==null&&h.child!==d.child)throw Error(r(153));if(h.child!==null){for(d=h.child,y=ec(d,d.pendingProps),h.child=y,y.return=h;d.sibling!==null;)d=d.sibling,y=y.sibling=ec(d,d.pendingProps),y.return=h;y.sibling=null}return h.child}function b2(d,h){return(d.lanes&h)!==0?!0:(d=d.dependencies,!!(d!==null&&ov(d)))}function eW(d,h,y){switch(h.tag){case 3:Ie(h,h.stateNode.containerInfo),au(h,Os,d.memoizedState.cache),ag();break;case 27:case 5:He(h);break;case 4:Ie(h,h.stateNode.containerInfo);break;case 10:au(h,h.type,h.memoizedProps.value);break;case 13:var S=h.memoizedState;if(S!==null)return S.dehydrated!==null?(du(h),h.flags|=128,null):(y&h.child.childLanes)!==0?Oj(d,h,y):(du(h),d=oc(d,h,y),d!==null?d.sibling:null);du(h);break;case 19:var N=(d.flags&128)!==0;if(S=(y&h.childLanes)!==0,S||(lg(d,h,y,!1),S=(y&h.childLanes)!==0),N){if(S)return Dj(d,h,y);h.flags|=128}if(N=h.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),ae(Ps,Ps.current),S)break;return null;case 22:case 23:return h.lanes=0,Rj(d,h,y);case 24:au(h,Os,d.memoizedState.cache)}return oc(d,h,y)}function Fj(d,h,y){if(d!==null)if(d.memoizedProps!==h.pendingProps)Vs=!0;else{if(!b2(d,y)&&(h.flags&128)===0)return Vs=!1,eW(d,h,y);Vs=(d.flags&131072)!==0}else Vs=!1,xr&&(h.flags&1048576)!==0&&h3(h,av,h.index);switch(h.lanes=0,h.tag){case 16:e:{d=h.pendingProps;var S=h.elementType,N=S._init;if(S=N(S._payload),h.type=S,typeof S=="function")TS(S)?(d=Kd(S,d),h.tag=1,h=jj(null,h,S,d,y)):(h.tag=0,h=d2(null,h,S,d,y));else{if(S!=null){if(N=S.$$typeof,N===C){h.tag=11,h=kj(null,h,S,d,y);break e}else if(N===I){h.tag=14,h=Tj(null,h,S,d,y);break e}}throw h=z(S)||S,Error(r(306,h,""))}}return h;case 0:return d2(d,h,h.type,h.pendingProps,y);case 1:return S=h.type,N=Kd(S,h.pendingProps),jj(d,h,S,N,y);case 3:e:{if(Ie(h,h.stateNode.containerInfo),d===null)throw Error(r(387));S=h.pendingProps;var $=h.memoizedState;N=$.element,zS(d,h),mg(h,S,null,y);var le=h.memoizedState;if(S=le.cache,au(h,Os,S),S!==$.cache&&PS(h,[Os],y,!0),pg(),S=le.element,$.isDehydrated)if($={element:S,isDehydrated:!1,cache:le.cache},h.updateQueue.baseState=$,h.memoizedState=$,h.flags&256){h=Mj(d,h,S,y);break e}else if(S!==N){N=pn(Error(r(424)),h),og(N),h=Mj(d,h,S,y);break e}else{switch(d=h.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(cs=vo(d.firstChild),Fi=h,xr=!0,zd=null,il=!0,y=mj(h,null,S,y),h.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling}else{if(ag(),S===N){h=oc(d,h,y);break e}oi(d,h,S,y)}h=h.child}return h;case 26:return kv(d,h),d===null?(y=zM(h.type,null,h.pendingProps,null))?h.memoizedState=y:xr||(y=h.type,d=h.pendingProps,S=zv(Me.current).createElement(y),S[pe]=h,S[je]=d,ci(S,y,d),Gn(S),h.stateNode=S):h.memoizedState=zM(h.type,d.memoizedProps,h.pendingProps,d.memoizedState),null;case 27:return He(h),d===null&&xr&&(S=h.stateNode=LM(h.type,h.pendingProps,Me.current),Fi=h,il=!0,N=cs,xu(h.type)?(J2=N,cs=vo(S.firstChild)):cs=N),oi(d,h,h.pendingProps.children,y),kv(d,h),d===null&&(h.flags|=4194304),h.child;case 5:return d===null&&xr&&((N=S=cs)&&(S=AW(S,h.type,h.pendingProps,il),S!==null?(h.stateNode=S,Fi=h,cs=vo(S.firstChild),il=!1,N=!0):N=!1),N||Ud(h)),He(h),N=h.type,$=h.pendingProps,le=d!==null?d.memoizedProps:null,S=$.children,W2(N,$)?S=null:le!==null&&W2(N,le)&&(h.flags|=32),h.memoizedState!==null&&(N=KS(d,h,GK,null,null,y),Fg._currentValue=N),kv(d,h),oi(d,h,S,y),h.child;case 6:return d===null&&xr&&((d=y=cs)&&(y=RW(y,h.pendingProps,il),y!==null?(h.stateNode=y,Fi=h,cs=null,d=!0):d=!1),d||Ud(h)),null;case 13:return Oj(d,h,y);case 4:return Ie(h,h.stateNode.containerInfo),S=h.pendingProps,d===null?h.child=jh(h,null,S,y):oi(d,h,S,y),h.child;case 11:return kj(d,h,h.type,h.pendingProps,y);case 7:return oi(d,h,h.pendingProps,y),h.child;case 8:return oi(d,h,h.pendingProps.children,y),h.child;case 12:return oi(d,h,h.pendingProps.children,y),h.child;case 10:return S=h.pendingProps,au(h,h.type,S.value),oi(d,h,S.children,y),h.child;case 9:return N=h.type._context,S=h.pendingProps.children,Vd(h),N=vi(N),S=S(N),h.flags|=1,oi(d,h,S,y),h.child;case 14:return Tj(d,h,h.type,h.pendingProps,y);case 15:return Aj(d,h,h.type,h.pendingProps,y);case 19:return Dj(d,h,y);case 31:return S=h.pendingProps,y=h.mode,S={mode:S.mode,children:S.children},d===null?(y=Tv(S,y),y.ref=h.ref,h.child=y,y.return=h,h=y):(y=ec(d.child,S),y.ref=h.ref,h.child=y,y.return=h,h=y),h;case 22:return Rj(d,h,y);case 24:return Vd(h),S=vi(Os),d===null?(N=LS(),N===null&&(N=Hr,$=DS(),N.pooledCache=$,$.refCount++,$!==null&&(N.pooledCacheLanes|=y),N=$),h.memoizedState={parent:S,cache:N},$S(h),au(h,Os,N)):((d.lanes&y)!==0&&(zS(d,h),mg(h,null,null,y),pg()),N=d.memoizedState,$=h.memoizedState,N.parent!==S?(N={parent:S,cache:S},h.memoizedState=N,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=N),au(h,Os,S)):(S=$.cache,au(h,Os,S),S!==N.cache&&PS(h,[Os],y,!0))),oi(d,h,h.pendingProps.children,y),h.child;case 29:throw h.pendingProps}throw Error(r(156,h.tag))}function lc(d){d.flags|=4}function Lj(d,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!GM(h)){if(h=Ua.current,h!==null&&((hr&4194048)===hr?al!==null:(hr&62914560)!==hr&&(hr&536870912)===0||h!==al))throw fg=BS,x3;d.flags|=8192}}function Av(d,h){h!==null&&(d.flags|=4),d.flags&16384&&(h=d.tag!==22?B():536870912,d.lanes|=h,Dh|=h)}function _g(d,h){if(!xr)switch(d.tailMode){case"hidden":h=d.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?d.tail=null:y.sibling=null;break;case"collapsed":y=d.tail;for(var S=null;y!==null;)y.alternate!==null&&(S=y),y=y.sibling;S===null?h||d.tail===null?d.tail=null:d.tail.sibling=null:S.sibling=null}}function ss(d){var h=d.alternate!==null&&d.alternate.child===d.child,y=0,S=0;if(h)for(var N=d.child;N!==null;)y|=N.lanes|N.childLanes,S|=N.subtreeFlags&65011712,S|=N.flags&65011712,N.return=d,N=N.sibling;else for(N=d.child;N!==null;)y|=N.lanes|N.childLanes,S|=N.subtreeFlags,S|=N.flags,N.return=d,N=N.sibling;return d.subtreeFlags|=S,d.childLanes=y,h}function tW(d,h,y){var S=h.pendingProps;switch(IS(h),h.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ss(h),null;case 1:return ss(h),null;case 3:return y=h.stateNode,S=null,d!==null&&(S=d.memoizedState.cache),h.memoizedState.cache!==S&&(h.flags|=2048),sc(Os),Ce(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(d===null||d.child===null)&&(ig(h)?lc(h):d===null||d.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,g3())),ss(h),null;case 26:return y=h.memoizedState,d===null?(lc(h),y!==null?(ss(h),Lj(h,y)):(ss(h),h.flags&=-16777217)):y?y!==d.memoizedState?(lc(h),ss(h),Lj(h,y)):(ss(h),h.flags&=-16777217):(d.memoizedProps!==S&&lc(h),ss(h),h.flags&=-16777217),null;case 27:it(h),y=Me.current;var N=h.type;if(d!==null&&h.stateNode!=null)d.memoizedProps!==S&&lc(h);else{if(!S){if(h.stateNode===null)throw Error(r(166));return ss(h),null}d=xe.current,ig(h)?p3(h):(d=LM(N,S,y),h.stateNode=d,lc(h))}return ss(h),null;case 5:if(it(h),y=h.type,d!==null&&h.stateNode!=null)d.memoizedProps!==S&&lc(h);else{if(!S){if(h.stateNode===null)throw Error(r(166));return ss(h),null}if(d=xe.current,ig(h))p3(h);else{switch(N=zv(Me.current),d){case 1:d=N.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:d=N.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":d=N.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":d=N.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":d=N.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof S.is=="string"?N.createElement("select",{is:S.is}):N.createElement("select"),S.multiple?d.multiple=!0:S.size&&(d.size=S.size);break;default:d=typeof S.is=="string"?N.createElement(y,{is:S.is}):N.createElement(y)}}d[pe]=h,d[je]=S;e:for(N=h.child;N!==null;){if(N.tag===5||N.tag===6)d.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===h)break e;for(;N.sibling===null;){if(N.return===null||N.return===h)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}h.stateNode=d;e:switch(ci(d,y,S),y){case"button":case"input":case"select":case"textarea":d=!!S.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&lc(h)}}return ss(h),h.flags&=-16777217,null;case 6:if(d&&h.stateNode!=null)d.memoizedProps!==S&&lc(h);else{if(typeof S!="string"&&h.stateNode===null)throw Error(r(166));if(d=Me.current,ig(h)){if(d=h.stateNode,y=h.memoizedProps,S=null,N=Fi,N!==null)switch(N.tag){case 27:case 5:S=N.memoizedProps}d[pe]=h,d=!!(d.nodeValue===y||S!==null&&S.suppressHydrationWarning===!0||IM(d.nodeValue,y)),d||Ud(h)}else d=zv(d).createTextNode(S),d[pe]=h,h.stateNode=d}return ss(h),null;case 13:if(S=h.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(N=ig(h),S!==null&&S.dehydrated!==null){if(d===null){if(!N)throw Error(r(318));if(N=h.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[pe]=h}else ag(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;ss(h),N=!1}else N=g3(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=N),N=!0;if(!N)return h.flags&256?(ac(h),h):(ac(h),null)}if(ac(h),(h.flags&128)!==0)return h.lanes=y,h;if(y=S!==null,d=d!==null&&d.memoizedState!==null,y){S=h.child,N=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(N=S.alternate.memoizedState.cachePool.pool);var $=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&($=S.memoizedState.cachePool.pool),$!==N&&(S.flags|=2048)}return y!==d&&y&&(h.child.flags|=8192),Av(h,h.updateQueue),ss(h),null;case 4:return Ce(),d===null&&q2(h.stateNode.containerInfo),ss(h),null;case 10:return sc(h.type),ss(h),null;case 19:if(Q(Ps),N=h.memoizedState,N===null)return ss(h),null;if(S=(h.flags&128)!==0,$=N.rendering,$===null)if(S)_g(N,!1);else{if(us!==0||d!==null&&(d.flags&128)!==0)for(d=h.child;d!==null;){if($=Sv(d),$!==null){for(h.flags|=128,_g(N,!1),d=$.updateQueue,h.updateQueue=d,Av(h,d),h.subtreeFlags=0,d=y,y=h.child;y!==null;)f3(y,d),y=y.sibling;return ae(Ps,Ps.current&1|2),h.child}d=d.sibling}N.tail!==null&&ce()>Iv&&(h.flags|=128,S=!0,_g(N,!1),h.lanes=4194304)}else{if(!S)if(d=Sv($),d!==null){if(h.flags|=128,S=!0,d=d.updateQueue,h.updateQueue=d,Av(h,d),_g(N,!0),N.tail===null&&N.tailMode==="hidden"&&!$.alternate&&!xr)return ss(h),null}else 2*ce()-N.renderingStartTime>Iv&&y!==536870912&&(h.flags|=128,S=!0,_g(N,!1),h.lanes=4194304);N.isBackwards?($.sibling=h.child,h.child=$):(d=N.last,d!==null?d.sibling=$:h.child=$,N.last=$)}return N.tail!==null?(h=N.tail,N.rendering=h,N.tail=h.sibling,N.renderingStartTime=ce(),h.sibling=null,d=Ps.current,ae(Ps,S?d&1|2:d&1),h):(ss(h),null);case 22:case 23:return ac(h),HS(),S=h.memoizedState!==null,d!==null?d.memoizedState!==null!==S&&(h.flags|=8192):S&&(h.flags|=8192),S?(y&536870912)!==0&&(h.flags&128)===0&&(ss(h),h.subtreeFlags&6&&(h.flags|=8192)):ss(h),y=h.updateQueue,y!==null&&Av(h,y.retryQueue),y=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),S=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(S=h.memoizedState.cachePool.pool),S!==y&&(h.flags|=2048),d!==null&&Q(Hd),null;case 24:return y=null,d!==null&&(y=d.memoizedState.cache),h.memoizedState.cache!==y&&(h.flags|=2048),sc(Os),ss(h),null;case 25:return null;case 30:return null}throw Error(r(156,h.tag))}function nW(d,h){switch(IS(h),h.tag){case 1:return d=h.flags,d&65536?(h.flags=d&-65537|128,h):null;case 3:return sc(Os),Ce(),d=h.flags,(d&65536)!==0&&(d&128)===0?(h.flags=d&-65537|128,h):null;case 26:case 27:case 5:return it(h),null;case 13:if(ac(h),d=h.memoizedState,d!==null&&d.dehydrated!==null){if(h.alternate===null)throw Error(r(340));ag()}return d=h.flags,d&65536?(h.flags=d&-65537|128,h):null;case 19:return Q(Ps),null;case 4:return Ce(),null;case 10:return sc(h.type),null;case 22:case 23:return ac(h),HS(),d!==null&&Q(Hd),d=h.flags,d&65536?(h.flags=d&-65537|128,h):null;case 24:return sc(Os),null;case 25:return null;default:return null}}function Bj(d,h){switch(IS(h),h.tag){case 3:sc(Os),Ce();break;case 26:case 27:case 5:it(h);break;case 4:Ce();break;case 13:ac(h);break;case 19:Q(Ps);break;case 10:sc(h.type);break;case 22:case 23:ac(h),HS(),d!==null&&Q(Hd);break;case 24:sc(Os)}}function Sg(d,h){try{var y=h.updateQueue,S=y!==null?y.lastEffect:null;if(S!==null){var N=S.next;y=N;do{if((y.tag&d)===d){S=void 0;var $=y.create,le=y.inst;S=$(),le.destroy=S}y=y.next}while(y!==N)}}catch(Ee){zr(h,h.return,Ee)}}function hu(d,h,y){try{var S=h.updateQueue,N=S!==null?S.lastEffect:null;if(N!==null){var $=N.next;S=$;do{if((S.tag&d)===d){var le=S.inst,Ee=le.destroy;if(Ee!==void 0){le.destroy=void 0,N=h;var qe=y,pt=Ee;try{pt()}catch(Tt){zr(N,qe,Tt)}}}S=S.next}while(S!==$)}}catch(Tt){zr(h,h.return,Tt)}}function $j(d){var h=d.updateQueue;if(h!==null){var y=d.stateNode;try{T3(h,y)}catch(S){zr(d,d.return,S)}}}function zj(d,h,y){y.props=Kd(d.type,d.memoizedProps),y.state=d.memoizedState;try{y.componentWillUnmount()}catch(S){zr(d,h,S)}}function Eg(d,h){try{var y=d.ref;if(y!==null){switch(d.tag){case 26:case 27:case 5:var S=d.stateNode;break;case 30:S=d.stateNode;break;default:S=d.stateNode}typeof y=="function"?d.refCleanup=y(S):y.current=S}}catch(N){zr(d,h,N)}}function ol(d,h){var y=d.ref,S=d.refCleanup;if(y!==null)if(typeof S=="function")try{S()}catch(N){zr(d,h,N)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof y=="function")try{y(null)}catch(N){zr(d,h,N)}else y.current=null}function Uj(d){var h=d.type,y=d.memoizedProps,S=d.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":y.autoFocus&&S.focus();break e;case"img":y.src?S.src=y.src:y.srcSet&&(S.srcset=y.srcSet)}}catch(N){zr(d,d.return,N)}}function v2(d,h,y){try{var S=d.stateNode;SW(S,d.type,y,h),S[je]=h}catch(N){zr(d,d.return,N)}}function qj(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&xu(d.type)||d.tag===4}function w2(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||qj(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&xu(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function x2(d,h,y){var S=d.tag;if(S===5||S===6)d=d.stateNode,h?(y.nodeType===9?y.body:y.nodeName==="HTML"?y.ownerDocument.body:y).insertBefore(d,h):(h=y.nodeType===9?y.body:y.nodeName==="HTML"?y.ownerDocument.body:y,h.appendChild(d),y=y._reactRootContainer,y!=null||h.onclick!==null||(h.onclick=$v));else if(S!==4&&(S===27&&xu(d.type)&&(y=d.stateNode,h=null),d=d.child,d!==null))for(x2(d,h,y),d=d.sibling;d!==null;)x2(d,h,y),d=d.sibling}function Rv(d,h,y){var S=d.tag;if(S===5||S===6)d=d.stateNode,h?y.insertBefore(d,h):y.appendChild(d);else if(S!==4&&(S===27&&xu(d.type)&&(y=d.stateNode),d=d.child,d!==null))for(Rv(d,h,y),d=d.sibling;d!==null;)Rv(d,h,y),d=d.sibling}function Vj(d){var h=d.stateNode,y=d.memoizedProps;try{for(var S=d.type,N=h.attributes;N.length;)h.removeAttributeNode(N[0]);ci(h,S,y),h[pe]=d,h[je]=y}catch($){zr(d,d.return,$)}}var cc=!1,gs=!1,_2=!1,Hj=typeof WeakSet=="function"?WeakSet:Set,Hs=null;function rW(d,h){if(d=d.containerInfo,G2=Kv,d=de(d),_e(d)){if("selectionStart"in d)var y={start:d.selectionStart,end:d.selectionEnd};else e:{y=(y=d.ownerDocument)&&y.defaultView||window;var S=y.getSelection&&y.getSelection();if(S&&S.rangeCount!==0){y=S.anchorNode;var N=S.anchorOffset,$=S.focusNode;S=S.focusOffset;try{y.nodeType,$.nodeType}catch{y=null;break e}var le=0,Ee=-1,qe=-1,pt=0,Tt=0,jt=d,yt=null;t:for(;;){for(var vt;jt!==y||N!==0&&jt.nodeType!==3||(Ee=le+N),jt!==$||S!==0&&jt.nodeType!==3||(qe=le+S),jt.nodeType===3&&(le+=jt.nodeValue.length),(vt=jt.firstChild)!==null;)yt=jt,jt=vt;for(;;){if(jt===d)break t;if(yt===y&&++pt===N&&(Ee=le),yt===$&&++Tt===S&&(qe=le),(vt=jt.nextSibling)!==null)break;jt=yt,yt=jt.parentNode}jt=vt}y=Ee===-1||qe===-1?null:{start:Ee,end:qe}}else y=null}y=y||{start:0,end:0}}else y=null;for(K2={focusedElem:d,selectionRange:y},Kv=!1,Hs=h;Hs!==null;)if(h=Hs,d=h.child,(h.subtreeFlags&1024)!==0&&d!==null)d.return=h,Hs=d;else for(;Hs!==null;){switch(h=Hs,$=h.alternate,d=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&$!==null){d=void 0,y=h,N=$.memoizedProps,$=$.memoizedState,S=y.stateNode;try{var Cn=Kd(y.type,N,y.elementType===y.type);d=S.getSnapshotBeforeUpdate(Cn,$),S.__reactInternalSnapshotBeforeUpdate=d}catch(vn){zr(y,y.return,vn)}}break;case 3:if((d&1024)!==0){if(d=h.stateNode.containerInfo,y=d.nodeType,y===9)Y2(d);else if(y===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":Y2(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(r(163))}if(d=h.sibling,d!==null){d.return=h.return,Hs=d;break}Hs=h.return}}function Gj(d,h,y){var S=y.flags;switch(y.tag){case 0:case 11:case 15:pu(d,y),S&4&&Sg(5,y);break;case 1:if(pu(d,y),S&4)if(d=y.stateNode,h===null)try{d.componentDidMount()}catch(le){zr(y,y.return,le)}else{var N=Kd(y.type,h.memoizedProps);h=h.memoizedState;try{d.componentDidUpdate(N,h,d.__reactInternalSnapshotBeforeUpdate)}catch(le){zr(y,y.return,le)}}S&64&&$j(y),S&512&&Eg(y,y.return);break;case 3:if(pu(d,y),S&64&&(d=y.updateQueue,d!==null)){if(h=null,y.child!==null)switch(y.child.tag){case 27:case 5:h=y.child.stateNode;break;case 1:h=y.child.stateNode}try{T3(d,h)}catch(le){zr(y,y.return,le)}}break;case 27:h===null&&S&4&&Vj(y);case 26:case 5:pu(d,y),h===null&&S&4&&Uj(y),S&512&&Eg(y,y.return);break;case 12:pu(d,y);break;case 13:pu(d,y),S&4&&Zj(d,y),S&64&&(d=y.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(y=fW.bind(null,y),NW(d,y))));break;case 22:if(S=y.memoizedState!==null||cc,!S){h=h!==null&&h.memoizedState!==null||gs,N=cc;var $=gs;cc=S,(gs=h)&&!$?mu(d,y,(y.subtreeFlags&8772)!==0):pu(d,y),cc=N,gs=$}break;case 30:break;default:pu(d,y)}}function Kj(d){var h=d.alternate;h!==null&&(d.alternate=null,Kj(h)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(h=d.stateNode,h!==null&&an(h)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Qr=null,Xi=!1;function uc(d,h,y){for(y=y.child;y!==null;)Wj(d,h,y),y=y.sibling}function Wj(d,h,y){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(It,y)}catch{}switch(y.tag){case 26:gs||ol(y,h),uc(d,h,y),y.memoizedState?y.memoizedState.count--:y.stateNode&&(y=y.stateNode,y.parentNode.removeChild(y));break;case 27:gs||ol(y,h);var S=Qr,N=Xi;xu(y.type)&&(Qr=y.stateNode,Xi=!1),uc(d,h,y),Mg(y.stateNode),Qr=S,Xi=N;break;case 5:gs||ol(y,h);case 6:if(S=Qr,N=Xi,Qr=null,uc(d,h,y),Qr=S,Xi=N,Qr!==null)if(Xi)try{(Qr.nodeType===9?Qr.body:Qr.nodeName==="HTML"?Qr.ownerDocument.body:Qr).removeChild(y.stateNode)}catch($){zr(y,h,$)}else try{Qr.removeChild(y.stateNode)}catch($){zr(y,h,$)}break;case 18:Qr!==null&&(Xi?(d=Qr,DM(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,y.stateNode),zg(d)):DM(Qr,y.stateNode));break;case 4:S=Qr,N=Xi,Qr=y.stateNode.containerInfo,Xi=!0,uc(d,h,y),Qr=S,Xi=N;break;case 0:case 11:case 14:case 15:gs||hu(2,y,h),gs||hu(4,y,h),uc(d,h,y);break;case 1:gs||(ol(y,h),S=y.stateNode,typeof S.componentWillUnmount=="function"&&zj(y,h,S)),uc(d,h,y);break;case 21:uc(d,h,y);break;case 22:gs=(S=gs)||y.memoizedState!==null,uc(d,h,y),gs=S;break;default:uc(d,h,y)}}function Zj(d,h){if(h.memoizedState===null&&(d=h.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{zg(d)}catch(y){zr(h,h.return,y)}}function sW(d){switch(d.tag){case 13:case 19:var h=d.stateNode;return h===null&&(h=d.stateNode=new Hj),h;case 22:return d=d.stateNode,h=d._retryCache,h===null&&(h=d._retryCache=new Hj),h;default:throw Error(r(435,d.tag))}}function S2(d,h){var y=sW(d);h.forEach(function(S){var N=hW.bind(null,d,S);y.has(S)||(y.add(S),S.then(N,N))})}function ya(d,h){var y=h.deletions;if(y!==null)for(var S=0;S<y.length;S++){var N=y[S],$=d,le=h,Ee=le;e:for(;Ee!==null;){switch(Ee.tag){case 27:if(xu(Ee.type)){Qr=Ee.stateNode,Xi=!1;break e}break;case 5:Qr=Ee.stateNode,Xi=!1;break e;case 3:case 4:Qr=Ee.stateNode.containerInfo,Xi=!0;break e}Ee=Ee.return}if(Qr===null)throw Error(r(160));Wj($,le,N),Qr=null,Xi=!1,$=N.alternate,$!==null&&($.return=null),N.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)Yj(h,d),h=h.sibling}var bo=null;function Yj(d,h){var y=d.alternate,S=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:ya(h,d),ba(d),S&4&&(hu(3,d,d.return),Sg(3,d),hu(5,d,d.return));break;case 1:ya(h,d),ba(d),S&512&&(gs||y===null||ol(y,y.return)),S&64&&cc&&(d=d.updateQueue,d!==null&&(S=d.callbacks,S!==null&&(y=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=y===null?S:y.concat(S))));break;case 26:var N=bo;if(ya(h,d),ba(d),S&512&&(gs||y===null||ol(y,y.return)),S&4){var $=y!==null?y.memoizedState:null;if(S=d.memoizedState,y===null)if(S===null)if(d.stateNode===null){e:{S=d.type,y=d.memoizedProps,N=N.ownerDocument||N;t:switch(S){case"title":$=N.getElementsByTagName("title")[0],(!$||$[Yt]||$[pe]||$.namespaceURI==="http://www.w3.org/2000/svg"||$.hasAttribute("itemprop"))&&($=N.createElement(S),N.head.insertBefore($,N.querySelector("head > title"))),ci($,S,y),$[pe]=d,Gn($),S=$;break e;case"link":var le=VM("link","href",N).get(S+(y.href||""));if(le){for(var Ee=0;Ee<le.length;Ee++)if($=le[Ee],$.getAttribute("href")===(y.href==null||y.href===""?null:y.href)&&$.getAttribute("rel")===(y.rel==null?null:y.rel)&&$.getAttribute("title")===(y.title==null?null:y.title)&&$.getAttribute("crossorigin")===(y.crossOrigin==null?null:y.crossOrigin)){le.splice(Ee,1);break t}}$=N.createElement(S),ci($,S,y),N.head.appendChild($);break;case"meta":if(le=VM("meta","content",N).get(S+(y.content||""))){for(Ee=0;Ee<le.length;Ee++)if($=le[Ee],$.getAttribute("content")===(y.content==null?null:""+y.content)&&$.getAttribute("name")===(y.name==null?null:y.name)&&$.getAttribute("property")===(y.property==null?null:y.property)&&$.getAttribute("http-equiv")===(y.httpEquiv==null?null:y.httpEquiv)&&$.getAttribute("charset")===(y.charSet==null?null:y.charSet)){le.splice(Ee,1);break t}}$=N.createElement(S),ci($,S,y),N.head.appendChild($);break;default:throw Error(r(468,S))}$[pe]=d,Gn($),S=$}d.stateNode=S}else HM(N,d.type,d.stateNode);else d.stateNode=qM(N,S,d.memoizedProps);else $!==S?($===null?y.stateNode!==null&&(y=y.stateNode,y.parentNode.removeChild(y)):$.count--,S===null?HM(N,d.type,d.stateNode):qM(N,S,d.memoizedProps)):S===null&&d.stateNode!==null&&v2(d,d.memoizedProps,y.memoizedProps)}break;case 27:ya(h,d),ba(d),S&512&&(gs||y===null||ol(y,y.return)),y!==null&&S&4&&v2(d,d.memoizedProps,y.memoizedProps);break;case 5:if(ya(h,d),ba(d),S&512&&(gs||y===null||ol(y,y.return)),d.flags&32){N=d.stateNode;try{Yc(N,"")}catch(vt){zr(d,d.return,vt)}}S&4&&d.stateNode!=null&&(N=d.memoizedProps,v2(d,N,y!==null?y.memoizedProps:N)),S&1024&&(_2=!0);break;case 6:if(ya(h,d),ba(d),S&4){if(d.stateNode===null)throw Error(r(162));S=d.memoizedProps,y=d.stateNode;try{y.nodeValue=S}catch(vt){zr(d,d.return,vt)}}break;case 3:if(Vv=null,N=bo,bo=Uv(h.containerInfo),ya(h,d),bo=N,ba(d),S&4&&y!==null&&y.memoizedState.isDehydrated)try{zg(h.containerInfo)}catch(vt){zr(d,d.return,vt)}_2&&(_2=!1,Xj(d));break;case 4:S=bo,bo=Uv(d.stateNode.containerInfo),ya(h,d),ba(d),bo=S;break;case 12:ya(h,d),ba(d);break;case 13:ya(h,d),ba(d),d.child.flags&8192&&d.memoizedState!==null!=(y!==null&&y.memoizedState!==null)&&(R2=ce()),S&4&&(S=d.updateQueue,S!==null&&(d.updateQueue=null,S2(d,S)));break;case 22:N=d.memoizedState!==null;var qe=y!==null&&y.memoizedState!==null,pt=cc,Tt=gs;if(cc=pt||N,gs=Tt||qe,ya(h,d),gs=Tt,cc=pt,ba(d),S&8192)e:for(h=d.stateNode,h._visibility=N?h._visibility&-2:h._visibility|1,N&&(y===null||qe||cc||gs||Wd(d)),y=null,h=d;;){if(h.tag===5||h.tag===26){if(y===null){qe=y=h;try{if($=qe.stateNode,N)le=$.style,typeof le.setProperty=="function"?le.setProperty("display","none","important"):le.display="none";else{Ee=qe.stateNode;var jt=qe.memoizedProps.style,yt=jt!=null&&jt.hasOwnProperty("display")?jt.display:null;Ee.style.display=yt==null||typeof yt=="boolean"?"":(""+yt).trim()}}catch(vt){zr(qe,qe.return,vt)}}}else if(h.tag===6){if(y===null){qe=h;try{qe.stateNode.nodeValue=N?"":qe.memoizedProps}catch(vt){zr(qe,qe.return,vt)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===d)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===d)break e;for(;h.sibling===null;){if(h.return===null||h.return===d)break e;y===h&&(y=null),h=h.return}y===h&&(y=null),h.sibling.return=h.return,h=h.sibling}S&4&&(S=d.updateQueue,S!==null&&(y=S.retryQueue,y!==null&&(S.retryQueue=null,S2(d,y))));break;case 19:ya(h,d),ba(d),S&4&&(S=d.updateQueue,S!==null&&(d.updateQueue=null,S2(d,S)));break;case 30:break;case 21:break;default:ya(h,d),ba(d)}}function ba(d){var h=d.flags;if(h&2){try{for(var y,S=d.return;S!==null;){if(qj(S)){y=S;break}S=S.return}if(y==null)throw Error(r(160));switch(y.tag){case 27:var N=y.stateNode,$=w2(d);Rv(d,$,N);break;case 5:var le=y.stateNode;y.flags&32&&(Yc(le,""),y.flags&=-33);var Ee=w2(d);Rv(d,Ee,le);break;case 3:case 4:var qe=y.stateNode.containerInfo,pt=w2(d);x2(d,pt,qe);break;default:throw Error(r(161))}}catch(Tt){zr(d,d.return,Tt)}d.flags&=-3}h&4096&&(d.flags&=-4097)}function Xj(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var h=d;Xj(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),d=d.sibling}}function pu(d,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)Gj(d,h.alternate,h),h=h.sibling}function Wd(d){for(d=d.child;d!==null;){var h=d;switch(h.tag){case 0:case 11:case 14:case 15:hu(4,h,h.return),Wd(h);break;case 1:ol(h,h.return);var y=h.stateNode;typeof y.componentWillUnmount=="function"&&zj(h,h.return,y),Wd(h);break;case 27:Mg(h.stateNode);case 26:case 5:ol(h,h.return),Wd(h);break;case 22:h.memoizedState===null&&Wd(h);break;case 30:Wd(h);break;default:Wd(h)}d=d.sibling}}function mu(d,h,y){for(y=y&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var S=h.alternate,N=d,$=h,le=$.flags;switch($.tag){case 0:case 11:case 15:mu(N,$,y),Sg(4,$);break;case 1:if(mu(N,$,y),S=$,N=S.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(pt){zr(S,S.return,pt)}if(S=$,N=S.updateQueue,N!==null){var Ee=S.stateNode;try{var qe=N.shared.hiddenCallbacks;if(qe!==null)for(N.shared.hiddenCallbacks=null,N=0;N<qe.length;N++)k3(qe[N],Ee)}catch(pt){zr(S,S.return,pt)}}y&&le&64&&$j($),Eg($,$.return);break;case 27:Vj($);case 26:case 5:mu(N,$,y),y&&S===null&&le&4&&Uj($),Eg($,$.return);break;case 12:mu(N,$,y);break;case 13:mu(N,$,y),y&&le&4&&Zj(N,$);break;case 22:$.memoizedState===null&&mu(N,$,y),Eg($,$.return);break;case 30:break;default:mu(N,$,y)}h=h.sibling}}function E2(d,h){var y=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),d=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(d=h.memoizedState.cachePool.pool),d!==y&&(d!=null&&d.refCount++,y!=null&&cg(y))}function C2(d,h){d=null,h.alternate!==null&&(d=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==d&&(h.refCount++,d!=null&&cg(d))}function ll(d,h,y,S){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)Jj(d,h,y,S),h=h.sibling}function Jj(d,h,y,S){var N=h.flags;switch(h.tag){case 0:case 11:case 15:ll(d,h,y,S),N&2048&&Sg(9,h);break;case 1:ll(d,h,y,S);break;case 3:ll(d,h,y,S),N&2048&&(d=null,h.alternate!==null&&(d=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==d&&(h.refCount++,d!=null&&cg(d)));break;case 12:if(N&2048){ll(d,h,y,S),d=h.stateNode;try{var $=h.memoizedProps,le=$.id,Ee=$.onPostCommit;typeof Ee=="function"&&Ee(le,h.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(qe){zr(h,h.return,qe)}}else ll(d,h,y,S);break;case 13:ll(d,h,y,S);break;case 23:break;case 22:$=h.stateNode,le=h.alternate,h.memoizedState!==null?$._visibility&2?ll(d,h,y,S):Cg(d,h):$._visibility&2?ll(d,h,y,S):($._visibility|=2,Mh(d,h,y,S,(h.subtreeFlags&10256)!==0)),N&2048&&E2(le,h);break;case 24:ll(d,h,y,S),N&2048&&C2(h.alternate,h);break;default:ll(d,h,y,S)}}function Mh(d,h,y,S,N){for(N=N&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var $=d,le=h,Ee=y,qe=S,pt=le.flags;switch(le.tag){case 0:case 11:case 15:Mh($,le,Ee,qe,N),Sg(8,le);break;case 23:break;case 22:var Tt=le.stateNode;le.memoizedState!==null?Tt._visibility&2?Mh($,le,Ee,qe,N):Cg($,le):(Tt._visibility|=2,Mh($,le,Ee,qe,N)),N&&pt&2048&&E2(le.alternate,le);break;case 24:Mh($,le,Ee,qe,N),N&&pt&2048&&C2(le.alternate,le);break;default:Mh($,le,Ee,qe,N)}h=h.sibling}}function Cg(d,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var y=d,S=h,N=S.flags;switch(S.tag){case 22:Cg(y,S),N&2048&&E2(S.alternate,S);break;case 24:Cg(y,S),N&2048&&C2(S.alternate,S);break;default:Cg(y,S)}h=h.sibling}}var kg=8192;function Oh(d){if(d.subtreeFlags&kg)for(d=d.child;d!==null;)Qj(d),d=d.sibling}function Qj(d){switch(d.tag){case 26:Oh(d),d.flags&kg&&d.memoizedState!==null&&qW(bo,d.memoizedState,d.memoizedProps);break;case 5:Oh(d);break;case 3:case 4:var h=bo;bo=Uv(d.stateNode.containerInfo),Oh(d),bo=h;break;case 22:d.memoizedState===null&&(h=d.alternate,h!==null&&h.memoizedState!==null?(h=kg,kg=16777216,Oh(d),kg=h):Oh(d));break;default:Oh(d)}}function eM(d){var h=d.alternate;if(h!==null&&(d=h.child,d!==null)){h.child=null;do h=d.sibling,d.sibling=null,d=h;while(d!==null)}}function Tg(d){var h=d.deletions;if((d.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var S=h[y];Hs=S,nM(S,d)}eM(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)tM(d),d=d.sibling}function tM(d){switch(d.tag){case 0:case 11:case 15:Tg(d),d.flags&2048&&hu(9,d,d.return);break;case 3:Tg(d);break;case 12:Tg(d);break;case 22:var h=d.stateNode;d.memoizedState!==null&&h._visibility&2&&(d.return===null||d.return.tag!==13)?(h._visibility&=-3,Nv(d)):Tg(d);break;default:Tg(d)}}function Nv(d){var h=d.deletions;if((d.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var S=h[y];Hs=S,nM(S,d)}eM(d)}for(d=d.child;d!==null;){switch(h=d,h.tag){case 0:case 11:case 15:hu(8,h,h.return),Nv(h);break;case 22:y=h.stateNode,y._visibility&2&&(y._visibility&=-3,Nv(h));break;default:Nv(h)}d=d.sibling}}function nM(d,h){for(;Hs!==null;){var y=Hs;switch(y.tag){case 0:case 11:case 15:hu(8,y,h);break;case 23:case 22:if(y.memoizedState!==null&&y.memoizedState.cachePool!==null){var S=y.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:cg(y.memoizedState.cache)}if(S=y.child,S!==null)S.return=y,Hs=S;else e:for(y=d;Hs!==null;){S=Hs;var N=S.sibling,$=S.return;if(Kj(S),S===y){Hs=null;break e}if(N!==null){N.return=$,Hs=N;break e}Hs=$}}}var iW={getCacheForType:function(d){var h=vi(Os),y=h.data.get(d);return y===void 0&&(y=d(),h.data.set(d,y)),y}},aW=typeof WeakMap=="function"?WeakMap:Map,Tr=0,Hr=null,tr=null,hr=0,Ar=0,va=null,gu=!1,Ph=!1,k2=!1,dc=0,us=0,yu=0,Zd=0,T2=0,qa=0,Dh=0,Ag=null,Ji=null,A2=!1,R2=0,Iv=1/0,jv=null,bu=null,li=0,vu=null,Fh=null,Lh=0,N2=0,I2=null,rM=null,Rg=0,j2=null;function wa(){if((Tr&2)!==0&&hr!==0)return hr&-hr;if(K.T!==null){var d=Ch;return d!==0?d:B2()}return G()}function sM(){qa===0&&(qa=(hr&536870912)===0||xr?wt():536870912);var d=Ua.current;return d!==null&&(d.flags|=32),qa}function xa(d,h,y){(d===Hr&&(Ar===2||Ar===9)||d.cancelPendingCommit!==null)&&(Bh(d,0),wu(d,hr,qa,!1)),rt(d,y),((Tr&2)===0||d!==Hr)&&(d===Hr&&((Tr&2)===0&&(Zd|=y),us===4&&wu(d,hr,qa,!1)),cl(d))}function iM(d,h,y){if((Tr&6)!==0)throw Error(r(327));var S=!y&&(h&124)===0&&(h&d.expiredLanes)===0||ue(d,h),N=S?cW(d,h):P2(d,h,!0),$=S;do{if(N===0){Ph&&!S&&wu(d,h,0,!1);break}else{if(y=d.current.alternate,$&&!oW(y)){N=P2(d,h,!1),$=!1;continue}if(N===2){if($=h,d.errorRecoveryDisabledLanes&$)var le=0;else le=d.pendingLanes&-536870913,le=le!==0?le:le&536870912?536870912:0;if(le!==0){h=le;e:{var Ee=d;N=Ag;var qe=Ee.current.memoizedState.isDehydrated;if(qe&&(Bh(Ee,le).flags|=256),le=P2(Ee,le,!1),le!==2){if(k2&&!qe){Ee.errorRecoveryDisabledLanes|=$,Zd|=$,N=4;break e}$=Ji,Ji=N,$!==null&&(Ji===null?Ji=$:Ji.push.apply(Ji,$))}N=le}if($=!1,N!==2)continue}}if(N===1){Bh(d,0),wu(d,h,0,!0);break}e:{switch(S=d,$=N,$){case 0:case 1:throw Error(r(345));case 4:if((h&4194048)!==h)break;case 6:wu(S,h,qa,!gu);break e;case 2:Ji=null;break;case 3:case 5:break;default:throw Error(r(329))}if((h&62914560)===h&&(N=R2+300-ce(),10<N)){if(wu(S,h,qa,!gu),Ae(S,0,!0)!==0)break e;S.timeoutHandle=OM(aM.bind(null,S,y,Ji,jv,A2,h,qa,Zd,Dh,gu,$,2,-0,0),N);break e}aM(S,y,Ji,jv,A2,h,qa,Zd,Dh,gu,$,0,-0,0)}}break}while(!0);cl(d)}function aM(d,h,y,S,N,$,le,Ee,qe,pt,Tt,jt,yt,vt){if(d.timeoutHandle=-1,jt=h.subtreeFlags,(jt&8192||(jt&16785408)===16785408)&&(Dg={stylesheets:null,count:0,unsuspend:UW},Qj(h),jt=VW(),jt!==null)){d.cancelPendingCommit=jt(hM.bind(null,d,h,$,y,S,N,le,Ee,qe,Tt,1,yt,vt)),wu(d,$,le,!pt);return}hM(d,h,$,y,S,N,le,Ee,qe)}function oW(d){for(var h=d;;){var y=h.tag;if((y===0||y===11||y===15)&&h.flags&16384&&(y=h.updateQueue,y!==null&&(y=y.stores,y!==null)))for(var S=0;S<y.length;S++){var N=y[S],$=N.getSnapshot;N=N.value;try{if(!bi($(),N))return!1}catch{return!1}}if(y=h.child,h.subtreeFlags&16384&&y!==null)y.return=h,h=y;else{if(h===d)break;for(;h.sibling===null;){if(h.return===null||h.return===d)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function wu(d,h,y,S){h&=~T2,h&=~Zd,d.suspendedLanes|=h,d.pingedLanes&=~h,S&&(d.warmLanes|=h),S=d.expirationTimes;for(var N=h;0<N;){var $=31-Gt(N),le=1<<$;S[$]=-1,N&=~le}y!==0&&we(d,y,h)}function Mv(){return(Tr&6)===0?(Ng(0),!1):!0}function M2(){if(tr!==null){if(Ar===0)var d=tr.return;else d=tr,rc=qd=null,YS(d),Ih=null,wg=0,d=tr;for(;d!==null;)Bj(d.alternate,d),d=d.return;tr=null}}function Bh(d,h){var y=d.timeoutHandle;y!==-1&&(d.timeoutHandle=-1,CW(y)),y=d.cancelPendingCommit,y!==null&&(d.cancelPendingCommit=null,y()),M2(),Hr=d,tr=y=ec(d.current,null),hr=h,Ar=0,va=null,gu=!1,Ph=ue(d,h),k2=!1,Dh=qa=T2=Zd=yu=us=0,Ji=Ag=null,A2=!1,(h&8)!==0&&(h|=h&32);var S=d.entangledLanes;if(S!==0)for(d=d.entanglements,S&=h;0<S;){var N=31-Gt(S),$=1<<N;h|=d[N],S&=~$}return dc=h,En(),y}function oM(d,h){Zn=null,K.H=wv,h===dg||h===uv?(h=E3(),Ar=3):h===x3?(h=E3(),Ar=4):Ar=h===Cj?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,va=h,tr===null&&(us=1,Cv(d,pn(h,d.current)))}function lM(){var d=K.H;return K.H=wv,d===null?wv:d}function cM(){var d=K.A;return K.A=iW,d}function O2(){us=4,gu||(hr&4194048)!==hr&&Ua.current!==null||(Ph=!0),(yu&134217727)===0&&(Zd&134217727)===0||Hr===null||wu(Hr,hr,qa,!1)}function P2(d,h,y){var S=Tr;Tr|=2;var N=lM(),$=cM();(Hr!==d||hr!==h)&&(jv=null,Bh(d,h)),h=!1;var le=us;e:do try{if(Ar!==0&&tr!==null){var Ee=tr,qe=va;switch(Ar){case 8:M2(),le=6;break e;case 3:case 2:case 9:case 6:Ua.current===null&&(h=!0);var pt=Ar;if(Ar=0,va=null,$h(d,Ee,qe,pt),y&&Ph){le=0;break e}break;default:pt=Ar,Ar=0,va=null,$h(d,Ee,qe,pt)}}lW(),le=us;break}catch(Tt){oM(d,Tt)}while(!0);return h&&d.shellSuspendCounter++,rc=qd=null,Tr=S,K.H=N,K.A=$,tr===null&&(Hr=null,hr=0,En()),le}function lW(){for(;tr!==null;)uM(tr)}function cW(d,h){var y=Tr;Tr|=2;var S=lM(),N=cM();Hr!==d||hr!==h?(jv=null,Iv=ce()+500,Bh(d,h)):Ph=ue(d,h);e:do try{if(Ar!==0&&tr!==null){h=tr;var $=va;t:switch(Ar){case 1:Ar=0,va=null,$h(d,h,$,1);break;case 2:case 9:if(_3($)){Ar=0,va=null,dM(h);break}h=function(){Ar!==2&&Ar!==9||Hr!==d||(Ar=7),cl(d)},$.then(h,h);break e;case 3:Ar=7;break e;case 4:Ar=5;break e;case 7:_3($)?(Ar=0,va=null,dM(h)):(Ar=0,va=null,$h(d,h,$,7));break;case 5:var le=null;switch(tr.tag){case 26:le=tr.memoizedState;case 5:case 27:var Ee=tr;if(!le||GM(le)){Ar=0,va=null;var qe=Ee.sibling;if(qe!==null)tr=qe;else{var pt=Ee.return;pt!==null?(tr=pt,Ov(pt)):tr=null}break t}}Ar=0,va=null,$h(d,h,$,5);break;case 6:Ar=0,va=null,$h(d,h,$,6);break;case 8:M2(),us=6;break e;default:throw Error(r(462))}}uW();break}catch(Tt){oM(d,Tt)}while(!0);return rc=qd=null,K.H=S,K.A=N,Tr=y,tr!==null?0:(Hr=null,hr=0,En(),us)}function uW(){for(;tr!==null&&!me();)uM(tr)}function uM(d){var h=Fj(d.alternate,d,dc);d.memoizedProps=d.pendingProps,h===null?Ov(d):tr=h}function dM(d){var h=d,y=h.alternate;switch(h.tag){case 15:case 0:h=Ij(y,h,h.pendingProps,h.type,void 0,hr);break;case 11:h=Ij(y,h,h.pendingProps,h.type.render,h.ref,hr);break;case 5:YS(h);default:Bj(y,h),h=tr=f3(h,dc),h=Fj(y,h,dc)}d.memoizedProps=d.pendingProps,h===null?Ov(d):tr=h}function $h(d,h,y,S){rc=qd=null,YS(h),Ih=null,wg=0;var N=h.return;try{if(QK(d,N,h,y,hr)){us=1,Cv(d,pn(y,d.current)),tr=null;return}}catch($){if(N!==null)throw tr=N,$;us=1,Cv(d,pn(y,d.current)),tr=null;return}h.flags&32768?(xr||S===1?d=!0:Ph||(hr&536870912)!==0?d=!1:(gu=d=!0,(S===2||S===9||S===3||S===6)&&(S=Ua.current,S!==null&&S.tag===13&&(S.flags|=16384))),fM(h,d)):Ov(h)}function Ov(d){var h=d;do{if((h.flags&32768)!==0){fM(h,gu);return}d=h.return;var y=tW(h.alternate,h,dc);if(y!==null){tr=y;return}if(h=h.sibling,h!==null){tr=h;return}tr=h=d}while(h!==null);us===0&&(us=5)}function fM(d,h){do{var y=nW(d.alternate,d);if(y!==null){y.flags&=32767,tr=y;return}if(y=d.return,y!==null&&(y.flags|=32768,y.subtreeFlags=0,y.deletions=null),!h&&(d=d.sibling,d!==null)){tr=d;return}tr=d=y}while(d!==null);us=6,tr=null}function hM(d,h,y,S,N,$,le,Ee,qe){d.cancelPendingCommit=null;do Pv();while(li!==0);if((Tr&6)!==0)throw Error(r(327));if(h!==null){if(h===d.current)throw Error(r(177));if($=h.lanes|h.childLanes,$|=ai,ye(d,y,$,le,Ee,qe),d===Hr&&(tr=Hr=null,hr=0),Fh=h,vu=d,Lh=y,N2=$,I2=N,rM=S,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,pW(Fe,function(){return bM(),null})):(d.callbackNode=null,d.callbackPriority=0),S=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||S){S=K.T,K.T=null,N=ee.p,ee.p=2,le=Tr,Tr|=4;try{rW(d,h,y)}finally{Tr=le,ee.p=N,K.T=S}}li=1,pM(),mM(),gM()}}function pM(){if(li===1){li=0;var d=vu,h=Fh,y=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||y){y=K.T,K.T=null;var S=ee.p;ee.p=2;var N=Tr;Tr|=4;try{Yj(h,d);var $=K2,le=de(d.containerInfo),Ee=$.focusedElem,qe=$.selectionRange;if(le!==Ee&&Ee&&Ee.ownerDocument&&ie(Ee.ownerDocument.documentElement,Ee)){if(qe!==null&&_e(Ee)){var pt=qe.start,Tt=qe.end;if(Tt===void 0&&(Tt=pt),"selectionStart"in Ee)Ee.selectionStart=pt,Ee.selectionEnd=Math.min(Tt,Ee.value.length);else{var jt=Ee.ownerDocument||document,yt=jt&&jt.defaultView||window;if(yt.getSelection){var vt=yt.getSelection(),Cn=Ee.textContent.length,vn=Math.min(qe.start,Cn),Dr=qe.end===void 0?vn:Math.min(qe.end,Cn);!vt.extend&&vn>Dr&&(le=Dr,Dr=vn,vn=le);var at=J(Ee,vn),Je=J(Ee,Dr);if(at&&Je&&(vt.rangeCount!==1||vt.anchorNode!==at.node||vt.anchorOffset!==at.offset||vt.focusNode!==Je.node||vt.focusOffset!==Je.offset)){var ft=jt.createRange();ft.setStart(at.node,at.offset),vt.removeAllRanges(),vn>Dr?(vt.addRange(ft),vt.extend(Je.node,Je.offset)):(ft.setEnd(Je.node,Je.offset),vt.addRange(ft))}}}}for(jt=[],vt=Ee;vt=vt.parentNode;)vt.nodeType===1&&jt.push({element:vt,left:vt.scrollLeft,top:vt.scrollTop});for(typeof Ee.focus=="function"&&Ee.focus(),Ee=0;Ee<jt.length;Ee++){var Nt=jt[Ee];Nt.element.scrollLeft=Nt.left,Nt.element.scrollTop=Nt.top}}Kv=!!G2,K2=G2=null}finally{Tr=N,ee.p=S,K.T=y}}d.current=h,li=2}}function mM(){if(li===2){li=0;var d=vu,h=Fh,y=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||y){y=K.T,K.T=null;var S=ee.p;ee.p=2;var N=Tr;Tr|=4;try{Gj(d,h.alternate,h)}finally{Tr=N,ee.p=S,K.T=y}}li=3}}function gM(){if(li===4||li===3){li=0,Te();var d=vu,h=Fh,y=Lh,S=rM;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?li=5:(li=0,Fh=vu=null,yM(d,d.pendingLanes));var N=d.pendingLanes;if(N===0&&(bu=null),he(y),h=h.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(It,h,void 0,(h.current.flags&128)===128)}catch{}if(S!==null){h=K.T,N=ee.p,ee.p=2,K.T=null;try{for(var $=d.onRecoverableError,le=0;le<S.length;le++){var Ee=S[le];$(Ee.value,{componentStack:Ee.stack})}}finally{K.T=h,ee.p=N}}(Lh&3)!==0&&Pv(),cl(d),N=d.pendingLanes,(y&4194090)!==0&&(N&42)!==0?d===j2?Rg++:(Rg=0,j2=d):Rg=0,Ng(0)}}function yM(d,h){(d.pooledCacheLanes&=h)===0&&(h=d.pooledCache,h!=null&&(d.pooledCache=null,cg(h)))}function Pv(d){return pM(),mM(),gM(),bM()}function bM(){if(li!==5)return!1;var d=vu,h=N2;N2=0;var y=he(Lh),S=K.T,N=ee.p;try{ee.p=32>y?32:y,K.T=null,y=I2,I2=null;var $=vu,le=Lh;if(li=0,Fh=vu=null,Lh=0,(Tr&6)!==0)throw Error(r(331));var Ee=Tr;if(Tr|=4,tM($.current),Jj($,$.current,le,y),Tr=Ee,Ng(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(It,$)}catch{}return!0}finally{ee.p=N,K.T=S,yM(d,h)}}function vM(d,h,y){h=pn(y,h),h=u2(d.stateNode,h,2),d=cu(d,h,2),d!==null&&(rt(d,2),cl(d))}function zr(d,h,y){if(d.tag===3)vM(d,d,y);else for(;h!==null;){if(h.tag===3){vM(h,d,y);break}else if(h.tag===1){var S=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(bu===null||!bu.has(S))){d=pn(y,d),y=Sj(2),S=cu(h,y,2),S!==null&&(Ej(y,S,h,d),rt(S,2),cl(S));break}}h=h.return}}function D2(d,h,y){var S=d.pingCache;if(S===null){S=d.pingCache=new aW;var N=new Set;S.set(h,N)}else N=S.get(h),N===void 0&&(N=new Set,S.set(h,N));N.has(y)||(k2=!0,N.add(y),d=dW.bind(null,d,h,y),h.then(d,d))}function dW(d,h,y){var S=d.pingCache;S!==null&&S.delete(h),d.pingedLanes|=d.suspendedLanes&y,d.warmLanes&=~y,Hr===d&&(hr&y)===y&&(us===4||us===3&&(hr&62914560)===hr&&300>ce()-R2?(Tr&2)===0&&Bh(d,0):T2|=y,Dh===hr&&(Dh=0)),cl(d)}function wM(d,h){h===0&&(h=B()),d=yo(d,h),d!==null&&(rt(d,h),cl(d))}function fW(d){var h=d.memoizedState,y=0;h!==null&&(y=h.retryLane),wM(d,y)}function hW(d,h){var y=0;switch(d.tag){case 13:var S=d.stateNode,N=d.memoizedState;N!==null&&(y=N.retryLane);break;case 19:S=d.stateNode;break;case 22:S=d.stateNode._retryCache;break;default:throw Error(r(314))}S!==null&&S.delete(h),wM(d,y)}function pW(d,h){return Re(d,h)}var Dv=null,zh=null,F2=!1,Fv=!1,L2=!1,Yd=0;function cl(d){d!==zh&&d.next===null&&(zh===null?Dv=zh=d:zh=zh.next=d),Fv=!0,F2||(F2=!0,gW())}function Ng(d,h){if(!L2&&Fv){L2=!0;do for(var y=!1,S=Dv;S!==null;){if(d!==0){var N=S.pendingLanes;if(N===0)var $=0;else{var le=S.suspendedLanes,Ee=S.pingedLanes;$=(1<<31-Gt(42|d)+1)-1,$&=N&~(le&~Ee),$=$&201326741?$&201326741|1:$?$|2:0}$!==0&&(y=!0,EM(S,$))}else $=hr,$=Ae(S,S===Hr?$:0,S.cancelPendingCommit!==null||S.timeoutHandle!==-1),($&3)===0||ue(S,$)||(y=!0,EM(S,$));S=S.next}while(y);L2=!1}}function mW(){xM()}function xM(){Fv=F2=!1;var d=0;Yd!==0&&(EW()&&(d=Yd),Yd=0);for(var h=ce(),y=null,S=Dv;S!==null;){var N=S.next,$=_M(S,h);$===0?(S.next=null,y===null?Dv=N:y.next=N,N===null&&(zh=y)):(y=S,(d!==0||($&3)!==0)&&(Fv=!0)),S=N}Ng(d)}function _M(d,h){for(var y=d.suspendedLanes,S=d.pingedLanes,N=d.expirationTimes,$=d.pendingLanes&-62914561;0<$;){var le=31-Gt($),Ee=1<<le,qe=N[le];qe===-1?((Ee&y)===0||(Ee&S)!==0)&&(N[le]=mt(Ee,h)):qe<=h&&(d.expiredLanes|=Ee),$&=~Ee}if(h=Hr,y=hr,y=Ae(d,d===h?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),S=d.callbackNode,y===0||d===h&&(Ar===2||Ar===9)||d.cancelPendingCommit!==null)return S!==null&&S!==null&&H(S),d.callbackNode=null,d.callbackPriority=0;if((y&3)===0||ue(d,y)){if(h=y&-y,h===d.callbackPriority)return h;switch(S!==null&&H(S),he(y)){case 2:case 8:y=Se;break;case 32:y=Fe;break;case 268435456:y=Xe;break;default:y=Fe}return S=SM.bind(null,d),y=Re(y,S),d.callbackPriority=h,d.callbackNode=y,h}return S!==null&&S!==null&&H(S),d.callbackPriority=2,d.callbackNode=null,2}function SM(d,h){if(li!==0&&li!==5)return d.callbackNode=null,d.callbackPriority=0,null;var y=d.callbackNode;if(Pv()&&d.callbackNode!==y)return null;var S=hr;return S=Ae(d,d===Hr?S:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),S===0?null:(iM(d,S,h),_M(d,ce()),d.callbackNode!=null&&d.callbackNode===y?SM.bind(null,d):null)}function EM(d,h){if(Pv())return null;iM(d,h,!0)}function gW(){kW(function(){(Tr&6)!==0?Re(ne,mW):xM()})}function B2(){return Yd===0&&(Yd=wt()),Yd}function CM(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:Hl(""+d)}function kM(d,h){var y=h.ownerDocument.createElement("input");return y.name=h.name,y.value=h.value,d.id&&y.setAttribute("form",d.id),h.parentNode.insertBefore(y,h),d=new FormData(d),y.parentNode.removeChild(y),d}function yW(d,h,y,S,N){if(h==="submit"&&y&&y.stateNode===N){var $=CM((N[je]||null).action),le=S.submitter;le&&(h=(h=le[je]||null)?CM(h.formAction):le.getAttribute("formAction"),h!==null&&($=h,le=null));var Ee=new oh("action","action",null,S,N);d.push({event:Ee,listeners:[{instance:null,listener:function(){if(S.defaultPrevented){if(Yd!==0){var qe=le?kM(N,le):new FormData(N);i2(y,{pending:!0,data:qe,method:N.method,action:$},null,qe)}}else typeof $=="function"&&(Ee.preventDefault(),qe=le?kM(N,le):new FormData(N),i2(y,{pending:!0,data:qe,method:N.method,action:$},$,qe))},currentTarget:N}]})}}for(var $2=0;$2<Zt.length;$2++){var z2=Zt[$2],bW=z2.toLowerCase(),vW=z2[0].toUpperCase()+z2.slice(1);Ft(bW,"on"+vW)}Ft(gt,"onAnimationEnd"),Ft(xt,"onAnimationIteration"),Ft(_t,"onAnimationStart"),Ft("dblclick","onDoubleClick"),Ft("focusin","onFocus"),Ft("focusout","onBlur"),Ft(kt,"onTransitionRun"),Ft(Bt,"onTransitionStart"),Ft(Wt,"onTransitionCancel"),Ft(Dt,"onTransitionEnd"),Xo("onMouseEnter",["mouseout","mouseover"]),Xo("onMouseLeave",["mouseout","mouseover"]),Xo("onPointerEnter",["pointerout","pointerover"]),Xo("onPointerLeave",["pointerout","pointerover"]),Yo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Yo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Yo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Yo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Yo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Yo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ig="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wW=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ig));function TM(d,h){h=(h&4)!==0;for(var y=0;y<d.length;y++){var S=d[y],N=S.event;S=S.listeners;e:{var $=void 0;if(h)for(var le=S.length-1;0<=le;le--){var Ee=S[le],qe=Ee.instance,pt=Ee.currentTarget;if(Ee=Ee.listener,qe!==$&&N.isPropagationStopped())break e;$=Ee,N.currentTarget=pt;try{$(N)}catch(Tt){Ev(Tt)}N.currentTarget=null,$=qe}else for(le=0;le<S.length;le++){if(Ee=S[le],qe=Ee.instance,pt=Ee.currentTarget,Ee=Ee.listener,qe!==$&&N.isPropagationStopped())break e;$=Ee,N.currentTarget=pt;try{$(N)}catch(Tt){Ev(Tt)}N.currentTarget=null,$=qe}}}}function nr(d,h){var y=h[bt];y===void 0&&(y=h[bt]=new Set);var S=d+"__bubble";y.has(S)||(AM(h,d,2,!1),y.add(S))}function U2(d,h,y){var S=0;h&&(S|=4),AM(y,d,S,h)}var Lv="_reactListening"+Math.random().toString(36).slice(2);function q2(d){if(!d[Lv]){d[Lv]=!0,Mi.forEach(function(y){y!=="selectionchange"&&(wW.has(y)||U2(y,!1,d),U2(y,!0,d))});var h=d.nodeType===9?d:d.ownerDocument;h===null||h[Lv]||(h[Lv]=!0,U2("selectionchange",!1,h))}}function AM(d,h,y,S){switch(JM(h)){case 2:var N=KW;break;case 8:N=WW;break;default:N=rE}y=N.bind(null,h,y,d),N=void 0,!Hm||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(N=!0),S?N!==void 0?d.addEventListener(h,y,{capture:!0,passive:N}):d.addEventListener(h,y,!0):N!==void 0?d.addEventListener(h,y,{passive:N}):d.addEventListener(h,y,!1)}function V2(d,h,y,S,N){var $=S;if((h&1)===0&&(h&2)===0&&S!==null)e:for(;;){if(S===null)return;var le=S.tag;if(le===3||le===4){var Ee=S.stateNode.containerInfo;if(Ee===N)break;if(le===4)for(le=S.return;le!==null;){var qe=le.tag;if((qe===3||qe===4)&&le.stateNode.containerInfo===N)return;le=le.return}for(;Ee!==null;){if(le=qn(Ee),le===null)return;if(qe=le.tag,qe===5||qe===6||qe===26||qe===27){S=$=le;continue e}Ee=Ee.parentNode}}S=S.return}Jc(function(){var pt=$,Tt=ih(y),jt=[];e:{var yt=qt.get(d);if(yt!==void 0){var vt=oh,Cn=d;switch(d){case"keypress":if(tu(y)===0)break e;case"keydown":case"keyup":vt=mh;break;case"focusin":Cn="focus",vt=nu;break;case"focusout":Cn="blur",vt=nu;break;case"beforeblur":case"afterblur":vt=nu;break;case"click":if(y.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":vt=uh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":vt=Kb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":vt=Jm;break;case gt:case xt:case _t:vt=Wb;break;case Dt:vt=Qm;break;case"scroll":case"scrollend":vt=lh;break;case"wheel":vt=yh;break;case"copy":case"cut":case"paste":vt=hh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":vt=Xm;break;case"toggle":case"beforetoggle":vt=Xb}var vn=(h&4)!==0,Dr=!vn&&(d==="scroll"||d==="scrollend"),at=vn?yt!==null?yt+"Capture":null:yt;vn=[];for(var Je=pt,ft;Je!==null;){var Nt=Je;if(ft=Nt.stateNode,Nt=Nt.tag,Nt!==5&&Nt!==26&&Nt!==27||ft===null||at===null||(Nt=Wl(Je,at),Nt!=null&&vn.push(jg(Je,Nt,ft))),Dr)break;Je=Je.return}0<vn.length&&(yt=new vt(yt,Cn,null,y,Tt),jt.push({event:yt,listeners:vn}))}}if((h&7)===0){e:{if(yt=d==="mouseover"||d==="pointerover",vt=d==="mouseout"||d==="pointerout",yt&&y!==Da&&(Cn=y.relatedTarget||y.fromElement)&&(qn(Cn)||Cn[Ke]))break e;if((vt||yt)&&(yt=Tt.window===Tt?Tt:(yt=Tt.ownerDocument)?yt.defaultView||yt.parentWindow:window,vt?(Cn=y.relatedTarget||y.toElement,vt=pt,Cn=Cn?qn(Cn):null,Cn!==null&&(Dr=i(Cn),vn=Cn.tag,Cn!==Dr||vn!==5&&vn!==27&&vn!==6)&&(Cn=null)):(vt=null,Cn=pt),vt!==Cn)){if(vn=uh,Nt="onMouseLeave",at="onMouseEnter",Je="mouse",(d==="pointerout"||d==="pointerover")&&(vn=Xm,Nt="onPointerLeave",at="onPointerEnter",Je="pointer"),Dr=vt==null?yt:jr(vt),ft=Cn==null?yt:jr(Cn),yt=new vn(Nt,Je+"leave",vt,y,Tt),yt.target=Dr,yt.relatedTarget=ft,Nt=null,qn(Tt)===pt&&(vn=new vn(at,Je+"enter",Cn,y,Tt),vn.target=ft,vn.relatedTarget=Dr,Nt=vn),Dr=Nt,vt&&Cn)t:{for(vn=vt,at=Cn,Je=0,ft=vn;ft;ft=Uh(ft))Je++;for(ft=0,Nt=at;Nt;Nt=Uh(Nt))ft++;for(;0<Je-ft;)vn=Uh(vn),Je--;for(;0<ft-Je;)at=Uh(at),ft--;for(;Je--;){if(vn===at||at!==null&&vn===at.alternate)break t;vn=Uh(vn),at=Uh(at)}vn=null}else vn=null;vt!==null&&RM(jt,yt,vt,vn,!1),Cn!==null&&Dr!==null&&RM(jt,Dr,Cn,vn,!0)}}e:{if(yt=pt?jr(pt):window,vt=yt.nodeName&&yt.nodeName.toLowerCase(),vt==="select"||vt==="input"&&yt.type==="file")var on=Fd;else if(wh(yt))if(La)on=iu;else{on=Ql;var Jn=rv}else vt=yt.nodeName,!vt||vt.toLowerCase()!=="input"||yt.type!=="checkbox"&&yt.type!=="radio"?pt&&Vm(pt.elementType)&&(on=Fd):on=sg;if(on&&(on=on(d,pt))){rg(jt,on,y,Tt);break e}Jn&&Jn(d,yt,pt),d==="focusout"&&pt&&yt.type==="number"&&pt.memoizedProps.value!=null&&Wc(yt,"number",yt.value)}switch(Jn=pt?jr(pt):window,d){case"focusin":(wh(Jn)||Jn.contentEditable==="true")&&($e=Jn,Ye=pt,Qe=null);break;case"focusout":Qe=Ye=$e=null;break;case"mousedown":st=!0;break;case"contextmenu":case"mouseup":case"dragend":st=!1,We(jt,y,Tt);break;case"selectionchange":if(De)break;case"keydown":case"keyup":We(jt,y,Tt)}var fn;if(Pd)e:{switch(d){case"compositionstart":var _n="onCompositionStart";break e;case"compositionend":_n="onCompositionEnd";break e;case"compositionupdate":_n="onCompositionUpdate";break e}_n=void 0}else Jl?ng(d,y)&&(_n="onCompositionEnd"):d==="keydown"&&y.keyCode===229&&(_n="onCompositionStart");_n&&(bh&&y.locale!=="ko"&&(Jl||_n!=="onCompositionStart"?_n==="onCompositionEnd"&&Jl&&(fn=eu()):(Fa=Tt,ah="value"in Fa?Fa.value:Fa.textContent,Jl=!0)),Jn=Bv(pt,_n),0<Jn.length&&(_n=new ph(_n,d,null,y,Tt),jt.push({event:_n,listeners:Jn}),fn?_n.data=fn:(fn=Qb(y),fn!==null&&(_n.data=fn)))),(fn=ES?ev(d,y):CS(d,y))&&(_n=Bv(pt,"onBeforeInput"),0<_n.length&&(Jn=new ph("onBeforeInput","beforeinput",null,y,Tt),jt.push({event:Jn,listeners:_n}),Jn.data=fn)),yW(jt,d,pt,y,Tt)}TM(jt,h)})}function jg(d,h,y){return{instance:d,listener:h,currentTarget:y}}function Bv(d,h){for(var y=h+"Capture",S=[];d!==null;){var N=d,$=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||$===null||(N=Wl(d,y),N!=null&&S.unshift(jg(d,N,$)),N=Wl(d,h),N!=null&&S.push(jg(d,N,$))),d.tag===3)return S;d=d.return}return[]}function Uh(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function RM(d,h,y,S,N){for(var $=h._reactName,le=[];y!==null&&y!==S;){var Ee=y,qe=Ee.alternate,pt=Ee.stateNode;if(Ee=Ee.tag,qe!==null&&qe===S)break;Ee!==5&&Ee!==26&&Ee!==27||pt===null||(qe=pt,N?(pt=Wl(y,$),pt!=null&&le.unshift(jg(y,pt,qe))):N||(pt=Wl(y,$),pt!=null&&le.push(jg(y,pt,qe)))),y=y.return}le.length!==0&&d.push({event:h,listeners:le})}var xW=/\r\n?/g,_W=/\u0000|\uFFFD/g;function NM(d){return(typeof d=="string"?d:""+d).replace(xW,`
`).replace(_W,"")}function IM(d,h){return h=NM(h),NM(d)===h}function $v(){}function Pr(d,h,y,S,N,$){switch(y){case"children":typeof S=="string"?h==="body"||h==="textarea"&&S===""||Yc(d,S):(typeof S=="number"||typeof S=="bigint")&&h!=="body"&&Yc(d,""+S);break;case"className":Ul(d,"class",S);break;case"tabIndex":Ul(d,"tabindex",S);break;case"dir":case"role":case"viewBox":case"width":case"height":Ul(d,y,S);break;case"style":Hb(d,S,$);break;case"data":if(h!=="object"){Ul(d,"data",S);break}case"src":case"href":if(S===""&&(h!=="a"||y!=="href")){d.removeAttribute(y);break}if(S==null||typeof S=="function"||typeof S=="symbol"||typeof S=="boolean"){d.removeAttribute(y);break}S=Hl(""+S),d.setAttribute(y,S);break;case"action":case"formAction":if(typeof S=="function"){d.setAttribute(y,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof $=="function"&&(y==="formAction"?(h!=="input"&&Pr(d,h,"name",N.name,N,null),Pr(d,h,"formEncType",N.formEncType,N,null),Pr(d,h,"formMethod",N.formMethod,N,null),Pr(d,h,"formTarget",N.formTarget,N,null)):(Pr(d,h,"encType",N.encType,N,null),Pr(d,h,"method",N.method,N,null),Pr(d,h,"target",N.target,N,null)));if(S==null||typeof S=="symbol"||typeof S=="boolean"){d.removeAttribute(y);break}S=Hl(""+S),d.setAttribute(y,S);break;case"onClick":S!=null&&(d.onclick=$v);break;case"onScroll":S!=null&&nr("scroll",d);break;case"onScrollEnd":S!=null&&nr("scrollend",d);break;case"dangerouslySetInnerHTML":if(S!=null){if(typeof S!="object"||!("__html"in S))throw Error(r(61));if(y=S.__html,y!=null){if(N.children!=null)throw Error(r(60));d.innerHTML=y}}break;case"multiple":d.multiple=S&&typeof S!="function"&&typeof S!="symbol";break;case"muted":d.muted=S&&typeof S!="function"&&typeof S!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(S==null||typeof S=="function"||typeof S=="boolean"||typeof S=="symbol"){d.removeAttribute("xlink:href");break}y=Hl(""+S),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",y);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":S!=null&&typeof S!="function"&&typeof S!="symbol"?d.setAttribute(y,""+S):d.removeAttribute(y);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":S&&typeof S!="function"&&typeof S!="symbol"?d.setAttribute(y,""):d.removeAttribute(y);break;case"capture":case"download":S===!0?d.setAttribute(y,""):S!==!1&&S!=null&&typeof S!="function"&&typeof S!="symbol"?d.setAttribute(y,S):d.removeAttribute(y);break;case"cols":case"rows":case"size":case"span":S!=null&&typeof S!="function"&&typeof S!="symbol"&&!isNaN(S)&&1<=S?d.setAttribute(y,S):d.removeAttribute(y);break;case"rowSpan":case"start":S==null||typeof S=="function"||typeof S=="symbol"||isNaN(S)?d.removeAttribute(y):d.setAttribute(y,S);break;case"popover":nr("beforetoggle",d),nr("toggle",d),mo(d,"popover",S);break;case"xlinkActuate":pa(d,"http://www.w3.org/1999/xlink","xlink:actuate",S);break;case"xlinkArcrole":pa(d,"http://www.w3.org/1999/xlink","xlink:arcrole",S);break;case"xlinkRole":pa(d,"http://www.w3.org/1999/xlink","xlink:role",S);break;case"xlinkShow":pa(d,"http://www.w3.org/1999/xlink","xlink:show",S);break;case"xlinkTitle":pa(d,"http://www.w3.org/1999/xlink","xlink:title",S);break;case"xlinkType":pa(d,"http://www.w3.org/1999/xlink","xlink:type",S);break;case"xmlBase":pa(d,"http://www.w3.org/XML/1998/namespace","xml:base",S);break;case"xmlLang":pa(d,"http://www.w3.org/XML/1998/namespace","xml:lang",S);break;case"xmlSpace":pa(d,"http://www.w3.org/XML/1998/namespace","xml:space",S);break;case"is":mo(d,"is",S);break;case"innerText":case"textContent":break;default:(!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(y=Pi.get(y)||y,mo(d,y,S))}}function H2(d,h,y,S,N,$){switch(y){case"style":Hb(d,S,$);break;case"dangerouslySetInnerHTML":if(S!=null){if(typeof S!="object"||!("__html"in S))throw Error(r(61));if(y=S.__html,y!=null){if(N.children!=null)throw Error(r(60));d.innerHTML=y}}break;case"children":typeof S=="string"?Yc(d,S):(typeof S=="number"||typeof S=="bigint")&&Yc(d,""+S);break;case"onScroll":S!=null&&nr("scroll",d);break;case"onScrollEnd":S!=null&&nr("scrollend",d);break;case"onClick":S!=null&&(d.onclick=$v);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Zo.hasOwnProperty(y))e:{if(y[0]==="o"&&y[1]==="n"&&(N=y.endsWith("Capture"),h=y.slice(2,N?y.length-7:void 0),$=d[je]||null,$=$!=null?$[y]:null,typeof $=="function"&&d.removeEventListener(h,$,N),typeof S=="function")){typeof $!="function"&&$!==null&&(y in d?d[y]=null:d.hasAttribute(y)&&d.removeAttribute(y)),d.addEventListener(h,S,N);break e}y in d?d[y]=S:S===!0?d.setAttribute(y,""):mo(d,y,S)}}}function ci(d,h,y){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":nr("error",d),nr("load",d);var S=!1,N=!1,$;for($ in y)if(y.hasOwnProperty($)){var le=y[$];if(le!=null)switch($){case"src":S=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,h));default:Pr(d,h,$,le,y,null)}}N&&Pr(d,h,"srcSet",y.srcSet,y,null),S&&Pr(d,h,"src",y.src,y,null);return;case"input":nr("invalid",d);var Ee=$=le=N=null,qe=null,pt=null;for(S in y)if(y.hasOwnProperty(S)){var Tt=y[S];if(Tt!=null)switch(S){case"name":N=Tt;break;case"type":le=Tt;break;case"checked":qe=Tt;break;case"defaultChecked":pt=Tt;break;case"value":$=Tt;break;case"defaultValue":Ee=Tt;break;case"children":case"dangerouslySetInnerHTML":if(Tt!=null)throw Error(r(137,h));break;default:Pr(d,h,S,Tt,y,null)}}Um(d,$,Ee,qe,pt,le,N,!1),el(d);return;case"select":nr("invalid",d),S=le=$=null;for(N in y)if(y.hasOwnProperty(N)&&(Ee=y[N],Ee!=null))switch(N){case"value":$=Ee;break;case"defaultValue":le=Ee;break;case"multiple":S=Ee;default:Pr(d,h,N,Ee,y,null)}h=$,y=le,d.multiple=!!S,h!=null?Vl(d,!!S,h,!1):y!=null&&Vl(d,!!S,y,!0);return;case"textarea":nr("invalid",d),$=N=S=null;for(le in y)if(y.hasOwnProperty(le)&&(Ee=y[le],Ee!=null))switch(le){case"value":S=Ee;break;case"defaultValue":N=Ee;break;case"children":$=Ee;break;case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(r(91));break;default:Pr(d,h,le,Ee,y,null)}qm(d,S,N,$),el(d);return;case"option":for(qe in y)if(y.hasOwnProperty(qe)&&(S=y[qe],S!=null))switch(qe){case"selected":d.selected=S&&typeof S!="function"&&typeof S!="symbol";break;default:Pr(d,h,qe,S,y,null)}return;case"dialog":nr("beforetoggle",d),nr("toggle",d),nr("cancel",d),nr("close",d);break;case"iframe":case"object":nr("load",d);break;case"video":case"audio":for(S=0;S<Ig.length;S++)nr(Ig[S],d);break;case"image":nr("error",d),nr("load",d);break;case"details":nr("toggle",d);break;case"embed":case"source":case"link":nr("error",d),nr("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pt in y)if(y.hasOwnProperty(pt)&&(S=y[pt],S!=null))switch(pt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,h));default:Pr(d,h,pt,S,y,null)}return;default:if(Vm(h)){for(Tt in y)y.hasOwnProperty(Tt)&&(S=y[Tt],S!==void 0&&H2(d,h,Tt,S,y,void 0));return}}for(Ee in y)y.hasOwnProperty(Ee)&&(S=y[Ee],S!=null&&Pr(d,h,Ee,S,y,null))}function SW(d,h,y,S){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,$=null,le=null,Ee=null,qe=null,pt=null,Tt=null;for(vt in y){var jt=y[vt];if(y.hasOwnProperty(vt)&&jt!=null)switch(vt){case"checked":break;case"value":break;case"defaultValue":qe=jt;default:S.hasOwnProperty(vt)||Pr(d,h,vt,null,S,jt)}}for(var yt in S){var vt=S[yt];if(jt=y[yt],S.hasOwnProperty(yt)&&(vt!=null||jt!=null))switch(yt){case"type":$=vt;break;case"name":N=vt;break;case"checked":pt=vt;break;case"defaultChecked":Tt=vt;break;case"value":le=vt;break;case"defaultValue":Ee=vt;break;case"children":case"dangerouslySetInnerHTML":if(vt!=null)throw Error(r(137,h));break;default:vt!==jt&&Pr(d,h,yt,vt,S,jt)}}Kc(d,le,Ee,qe,pt,Tt,$,N);return;case"select":vt=le=Ee=yt=null;for($ in y)if(qe=y[$],y.hasOwnProperty($)&&qe!=null)switch($){case"value":break;case"multiple":vt=qe;default:S.hasOwnProperty($)||Pr(d,h,$,null,S,qe)}for(N in S)if($=S[N],qe=y[N],S.hasOwnProperty(N)&&($!=null||qe!=null))switch(N){case"value":yt=$;break;case"defaultValue":Ee=$;break;case"multiple":le=$;default:$!==qe&&Pr(d,h,N,$,S,qe)}h=Ee,y=le,S=vt,yt!=null?Vl(d,!!y,yt,!1):!!S!=!!y&&(h!=null?Vl(d,!!y,h,!0):Vl(d,!!y,y?[]:"",!1));return;case"textarea":vt=yt=null;for(Ee in y)if(N=y[Ee],y.hasOwnProperty(Ee)&&N!=null&&!S.hasOwnProperty(Ee))switch(Ee){case"value":break;case"children":break;default:Pr(d,h,Ee,null,S,N)}for(le in S)if(N=S[le],$=y[le],S.hasOwnProperty(le)&&(N!=null||$!=null))switch(le){case"value":yt=N;break;case"defaultValue":vt=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==$&&Pr(d,h,le,N,S,$)}Zc(d,yt,vt);return;case"option":for(var Cn in y)if(yt=y[Cn],y.hasOwnProperty(Cn)&&yt!=null&&!S.hasOwnProperty(Cn))switch(Cn){case"selected":d.selected=!1;break;default:Pr(d,h,Cn,null,S,yt)}for(qe in S)if(yt=S[qe],vt=y[qe],S.hasOwnProperty(qe)&&yt!==vt&&(yt!=null||vt!=null))switch(qe){case"selected":d.selected=yt&&typeof yt!="function"&&typeof yt!="symbol";break;default:Pr(d,h,qe,yt,S,vt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var vn in y)yt=y[vn],y.hasOwnProperty(vn)&&yt!=null&&!S.hasOwnProperty(vn)&&Pr(d,h,vn,null,S,yt);for(pt in S)if(yt=S[pt],vt=y[pt],S.hasOwnProperty(pt)&&yt!==vt&&(yt!=null||vt!=null))switch(pt){case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(r(137,h));break;default:Pr(d,h,pt,yt,S,vt)}return;default:if(Vm(h)){for(var Dr in y)yt=y[Dr],y.hasOwnProperty(Dr)&&yt!==void 0&&!S.hasOwnProperty(Dr)&&H2(d,h,Dr,void 0,S,yt);for(Tt in S)yt=S[Tt],vt=y[Tt],!S.hasOwnProperty(Tt)||yt===vt||yt===void 0&&vt===void 0||H2(d,h,Tt,yt,S,vt);return}}for(var at in y)yt=y[at],y.hasOwnProperty(at)&&yt!=null&&!S.hasOwnProperty(at)&&Pr(d,h,at,null,S,yt);for(jt in S)yt=S[jt],vt=y[jt],!S.hasOwnProperty(jt)||yt===vt||yt==null&&vt==null||Pr(d,h,jt,yt,S,vt)}var G2=null,K2=null;function zv(d){return d.nodeType===9?d:d.ownerDocument}function jM(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function MM(d,h){if(d===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&h==="foreignObject"?0:d}function W2(d,h){return d==="textarea"||d==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Z2=null;function EW(){var d=window.event;return d&&d.type==="popstate"?d===Z2?!1:(Z2=d,!0):(Z2=null,!1)}var OM=typeof setTimeout=="function"?setTimeout:void 0,CW=typeof clearTimeout=="function"?clearTimeout:void 0,PM=typeof Promise=="function"?Promise:void 0,kW=typeof queueMicrotask=="function"?queueMicrotask:typeof PM<"u"?function(d){return PM.resolve(null).then(d).catch(TW)}:OM;function TW(d){setTimeout(function(){throw d})}function xu(d){return d==="head"}function DM(d,h){var y=h,S=0,N=0;do{var $=y.nextSibling;if(d.removeChild(y),$&&$.nodeType===8)if(y=$.data,y==="/$"){if(0<S&&8>S){y=S;var le=d.ownerDocument;if(y&1&&Mg(le.documentElement),y&2&&Mg(le.body),y&4)for(y=le.head,Mg(y),le=y.firstChild;le;){var Ee=le.nextSibling,qe=le.nodeName;le[Yt]||qe==="SCRIPT"||qe==="STYLE"||qe==="LINK"&&le.rel.toLowerCase()==="stylesheet"||y.removeChild(le),le=Ee}}if(N===0){d.removeChild($),zg(h);return}N--}else y==="$"||y==="$?"||y==="$!"?N++:S=y.charCodeAt(0)-48;else S=0;y=$}while(y);zg(h)}function Y2(d){var h=d.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var y=h;switch(h=h.nextSibling,y.nodeName){case"HTML":case"HEAD":case"BODY":Y2(y),an(y);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(y.rel.toLowerCase()==="stylesheet")continue}d.removeChild(y)}}function AW(d,h,y,S){for(;d.nodeType===1;){var N=y;if(d.nodeName.toLowerCase()!==h.toLowerCase()){if(!S&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(S){if(!d[Yt])switch(h){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if($=d.getAttribute("rel"),$==="stylesheet"&&d.hasAttribute("data-precedence"))break;if($!==N.rel||d.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||d.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||d.getAttribute("title")!==(N.title==null?null:N.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if($=d.getAttribute("src"),($!==(N.src==null?null:N.src)||d.getAttribute("type")!==(N.type==null?null:N.type)||d.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&$&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(h==="input"&&d.type==="hidden"){var $=N.name==null?null:""+N.name;if(N.type==="hidden"&&d.getAttribute("name")===$)return d}else return d;if(d=vo(d.nextSibling),d===null)break}return null}function RW(d,h,y){if(h==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!y||(d=vo(d.nextSibling),d===null))return null;return d}function X2(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState==="complete"}function NW(d,h){var y=d.ownerDocument;if(d.data!=="$?"||y.readyState==="complete")h();else{var S=function(){h(),y.removeEventListener("DOMContentLoaded",S)};y.addEventListener("DOMContentLoaded",S),d._reactRetry=S}}function vo(d){for(;d!=null;d=d.nextSibling){var h=d.nodeType;if(h===1||h===3)break;if(h===8){if(h=d.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return d}var J2=null;function FM(d){d=d.previousSibling;for(var h=0;d;){if(d.nodeType===8){var y=d.data;if(y==="$"||y==="$!"||y==="$?"){if(h===0)return d;h--}else y==="/$"&&h++}d=d.previousSibling}return null}function LM(d,h,y){switch(h=zv(y),d){case"html":if(d=h.documentElement,!d)throw Error(r(452));return d;case"head":if(d=h.head,!d)throw Error(r(453));return d;case"body":if(d=h.body,!d)throw Error(r(454));return d;default:throw Error(r(451))}}function Mg(d){for(var h=d.attributes;h.length;)d.removeAttributeNode(h[0]);an(d)}var Va=new Map,BM=new Set;function Uv(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var fc=ee.d;ee.d={f:IW,r:jW,D:MW,C:OW,L:PW,m:DW,X:LW,S:FW,M:BW};function IW(){var d=fc.f(),h=Mv();return d||h}function jW(d){var h=Qn(d);h!==null&&h.tag===5&&h.type==="form"?ij(h):fc.r(d)}var qh=typeof document>"u"?null:document;function $M(d,h,y){var S=qh;if(S&&typeof h=="string"&&h){var N=gi(h);N='link[rel="'+d+'"][href="'+N+'"]',typeof y=="string"&&(N+='[crossorigin="'+y+'"]'),BM.has(N)||(BM.add(N),d={rel:d,crossOrigin:y,href:h},S.querySelector(N)===null&&(h=S.createElement("link"),ci(h,"link",d),Gn(h),S.head.appendChild(h)))}}function MW(d){fc.D(d),$M("dns-prefetch",d,null)}function OW(d,h){fc.C(d,h),$M("preconnect",d,h)}function PW(d,h,y){fc.L(d,h,y);var S=qh;if(S&&d&&h){var N='link[rel="preload"][as="'+gi(h)+'"]';h==="image"&&y&&y.imageSrcSet?(N+='[imagesrcset="'+gi(y.imageSrcSet)+'"]',typeof y.imageSizes=="string"&&(N+='[imagesizes="'+gi(y.imageSizes)+'"]')):N+='[href="'+gi(d)+'"]';var $=N;switch(h){case"style":$=Vh(d);break;case"script":$=Hh(d)}Va.has($)||(d=u({rel:"preload",href:h==="image"&&y&&y.imageSrcSet?void 0:d,as:h},y),Va.set($,d),S.querySelector(N)!==null||h==="style"&&S.querySelector(Og($))||h==="script"&&S.querySelector(Pg($))||(h=S.createElement("link"),ci(h,"link",d),Gn(h),S.head.appendChild(h)))}}function DW(d,h){fc.m(d,h);var y=qh;if(y&&d){var S=h&&typeof h.as=="string"?h.as:"script",N='link[rel="modulepreload"][as="'+gi(S)+'"][href="'+gi(d)+'"]',$=N;switch(S){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":$=Hh(d)}if(!Va.has($)&&(d=u({rel:"modulepreload",href:d},h),Va.set($,d),y.querySelector(N)===null)){switch(S){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(y.querySelector(Pg($)))return}S=y.createElement("link"),ci(S,"link",d),Gn(S),y.head.appendChild(S)}}}function FW(d,h,y){fc.S(d,h,y);var S=qh;if(S&&d){var N=Mr(S).hoistableStyles,$=Vh(d);h=h||"default";var le=N.get($);if(!le){var Ee={loading:0,preload:null};if(le=S.querySelector(Og($)))Ee.loading=5;else{d=u({rel:"stylesheet",href:d,"data-precedence":h},y),(y=Va.get($))&&Q2(d,y);var qe=le=S.createElement("link");Gn(qe),ci(qe,"link",d),qe._p=new Promise(function(pt,Tt){qe.onload=pt,qe.onerror=Tt}),qe.addEventListener("load",function(){Ee.loading|=1}),qe.addEventListener("error",function(){Ee.loading|=2}),Ee.loading|=4,qv(le,h,S)}le={type:"stylesheet",instance:le,count:1,state:Ee},N.set($,le)}}}function LW(d,h){fc.X(d,h);var y=qh;if(y&&d){var S=Mr(y).hoistableScripts,N=Hh(d),$=S.get(N);$||($=y.querySelector(Pg(N)),$||(d=u({src:d,async:!0},h),(h=Va.get(N))&&eE(d,h),$=y.createElement("script"),Gn($),ci($,"link",d),y.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},S.set(N,$))}}function BW(d,h){fc.M(d,h);var y=qh;if(y&&d){var S=Mr(y).hoistableScripts,N=Hh(d),$=S.get(N);$||($=y.querySelector(Pg(N)),$||(d=u({src:d,async:!0,type:"module"},h),(h=Va.get(N))&&eE(d,h),$=y.createElement("script"),Gn($),ci($,"link",d),y.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},S.set(N,$))}}function zM(d,h,y,S){var N=(N=Me.current)?Uv(N):null;if(!N)throw Error(r(446));switch(d){case"meta":case"title":return null;case"style":return typeof y.precedence=="string"&&typeof y.href=="string"?(h=Vh(y.href),y=Mr(N).hoistableStyles,S=y.get(h),S||(S={type:"style",instance:null,count:0,state:null},y.set(h,S)),S):{type:"void",instance:null,count:0,state:null};case"link":if(y.rel==="stylesheet"&&typeof y.href=="string"&&typeof y.precedence=="string"){d=Vh(y.href);var $=Mr(N).hoistableStyles,le=$.get(d);if(le||(N=N.ownerDocument||N,le={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},$.set(d,le),($=N.querySelector(Og(d)))&&!$._p&&(le.instance=$,le.state.loading=5),Va.has(d)||(y={rel:"preload",as:"style",href:y.href,crossOrigin:y.crossOrigin,integrity:y.integrity,media:y.media,hrefLang:y.hrefLang,referrerPolicy:y.referrerPolicy},Va.set(d,y),$||$W(N,d,y,le.state))),h&&S===null)throw Error(r(528,""));return le}if(h&&S!==null)throw Error(r(529,""));return null;case"script":return h=y.async,y=y.src,typeof y=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Hh(y),y=Mr(N).hoistableScripts,S=y.get(h),S||(S={type:"script",instance:null,count:0,state:null},y.set(h,S)),S):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,d))}}function Vh(d){return'href="'+gi(d)+'"'}function Og(d){return'link[rel="stylesheet"]['+d+"]"}function UM(d){return u({},d,{"data-precedence":d.precedence,precedence:null})}function $W(d,h,y,S){d.querySelector('link[rel="preload"][as="style"]['+h+"]")?S.loading=1:(h=d.createElement("link"),S.preload=h,h.addEventListener("load",function(){return S.loading|=1}),h.addEventListener("error",function(){return S.loading|=2}),ci(h,"link",y),Gn(h),d.head.appendChild(h))}function Hh(d){return'[src="'+gi(d)+'"]'}function Pg(d){return"script[async]"+d}function qM(d,h,y){if(h.count++,h.instance===null)switch(h.type){case"style":var S=d.querySelector('style[data-href~="'+gi(y.href)+'"]');if(S)return h.instance=S,Gn(S),S;var N=u({},y,{"data-href":y.href,"data-precedence":y.precedence,href:null,precedence:null});return S=(d.ownerDocument||d).createElement("style"),Gn(S),ci(S,"style",N),qv(S,y.precedence,d),h.instance=S;case"stylesheet":N=Vh(y.href);var $=d.querySelector(Og(N));if($)return h.state.loading|=4,h.instance=$,Gn($),$;S=UM(y),(N=Va.get(N))&&Q2(S,N),$=(d.ownerDocument||d).createElement("link"),Gn($);var le=$;return le._p=new Promise(function(Ee,qe){le.onload=Ee,le.onerror=qe}),ci($,"link",S),h.state.loading|=4,qv($,y.precedence,d),h.instance=$;case"script":return $=Hh(y.src),(N=d.querySelector(Pg($)))?(h.instance=N,Gn(N),N):(S=y,(N=Va.get($))&&(S=u({},y),eE(S,N)),d=d.ownerDocument||d,N=d.createElement("script"),Gn(N),ci(N,"link",S),d.head.appendChild(N),h.instance=N);case"void":return null;default:throw Error(r(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(S=h.instance,h.state.loading|=4,qv(S,y.precedence,d));return h.instance}function qv(d,h,y){for(var S=y.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=S.length?S[S.length-1]:null,$=N,le=0;le<S.length;le++){var Ee=S[le];if(Ee.dataset.precedence===h)$=Ee;else if($!==N)break}$?$.parentNode.insertBefore(d,$.nextSibling):(h=y.nodeType===9?y.head:y,h.insertBefore(d,h.firstChild))}function Q2(d,h){d.crossOrigin==null&&(d.crossOrigin=h.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=h.referrerPolicy),d.title==null&&(d.title=h.title)}function eE(d,h){d.crossOrigin==null&&(d.crossOrigin=h.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=h.referrerPolicy),d.integrity==null&&(d.integrity=h.integrity)}var Vv=null;function VM(d,h,y){if(Vv===null){var S=new Map,N=Vv=new Map;N.set(y,S)}else N=Vv,S=N.get(y),S||(S=new Map,N.set(y,S));if(S.has(d))return S;for(S.set(d,null),y=y.getElementsByTagName(d),N=0;N<y.length;N++){var $=y[N];if(!($[Yt]||$[pe]||d==="link"&&$.getAttribute("rel")==="stylesheet")&&$.namespaceURI!=="http://www.w3.org/2000/svg"){var le=$.getAttribute(h)||"";le=d+le;var Ee=S.get(le);Ee?Ee.push($):S.set(le,[$])}}return S}function HM(d,h,y){d=d.ownerDocument||d,d.head.insertBefore(y,h==="title"?d.querySelector("head > title"):null)}function zW(d,h,y){if(y===1||h.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return d=h.disabled,typeof h.precedence=="string"&&d==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function GM(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}var Dg=null;function UW(){}function qW(d,h,y){if(Dg===null)throw Error(r(475));var S=Dg;if(h.type==="stylesheet"&&(typeof y.media!="string"||matchMedia(y.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var N=Vh(y.href),$=d.querySelector(Og(N));if($){d=$._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(S.count++,S=Hv.bind(S),d.then(S,S)),h.state.loading|=4,h.instance=$,Gn($);return}$=d.ownerDocument||d,y=UM(y),(N=Va.get(N))&&Q2(y,N),$=$.createElement("link"),Gn($);var le=$;le._p=new Promise(function(Ee,qe){le.onload=Ee,le.onerror=qe}),ci($,"link",y),h.instance=$}S.stylesheets===null&&(S.stylesheets=new Map),S.stylesheets.set(h,d),(d=h.state.preload)&&(h.state.loading&3)===0&&(S.count++,h=Hv.bind(S),d.addEventListener("load",h),d.addEventListener("error",h))}}function VW(){if(Dg===null)throw Error(r(475));var d=Dg;return d.stylesheets&&d.count===0&&tE(d,d.stylesheets),0<d.count?function(h){var y=setTimeout(function(){if(d.stylesheets&&tE(d,d.stylesheets),d.unsuspend){var S=d.unsuspend;d.unsuspend=null,S()}},6e4);return d.unsuspend=h,function(){d.unsuspend=null,clearTimeout(y)}}:null}function Hv(){if(this.count--,this.count===0){if(this.stylesheets)tE(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var Gv=null;function tE(d,h){d.stylesheets=null,d.unsuspend!==null&&(d.count++,Gv=new Map,h.forEach(HW,d),Gv=null,Hv.call(d))}function HW(d,h){if(!(h.state.loading&4)){var y=Gv.get(d);if(y)var S=y.get(null);else{y=new Map,Gv.set(d,y);for(var N=d.querySelectorAll("link[data-precedence],style[data-precedence]"),$=0;$<N.length;$++){var le=N[$];(le.nodeName==="LINK"||le.getAttribute("media")!=="not all")&&(y.set(le.dataset.precedence,le),S=le)}S&&y.set(null,S)}N=h.instance,le=N.getAttribute("data-precedence"),$=y.get(le)||S,$===S&&y.set(null,N),y.set(le,N),this.count++,S=Hv.bind(this),N.addEventListener("load",S),N.addEventListener("error",S),$?$.parentNode.insertBefore(N,$.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(N,d.firstChild)),h.state.loading|=4}}var Fg={$$typeof:E,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function GW(d,h,y,S,N,$,le,Ee){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ze(0),this.hiddenUpdates=ze(null),this.identifierPrefix=S,this.onUncaughtError=N,this.onCaughtError=$,this.onRecoverableError=le,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ee,this.incompleteTransitions=new Map}function KM(d,h,y,S,N,$,le,Ee,qe,pt,Tt,jt){return d=new GW(d,h,y,le,Ee,qe,pt,jt),h=1,$===!0&&(h|=24),$=ga(3,null,null,h),d.current=$,$.stateNode=d,h=DS(),h.refCount++,d.pooledCache=h,h.refCount++,$.memoizedState={element:S,isDehydrated:y,cache:h},$S($),d}function WM(d){return d?(d=sl,d):sl}function ZM(d,h,y,S,N,$){N=WM(N),S.context===null?S.context=N:S.pendingContext=N,S=lu(h),S.payload={element:y},$=$===void 0?null:$,$!==null&&(S.callback=$),y=cu(d,S,h),y!==null&&(xa(y,d,h),hg(y,d,h))}function YM(d,h){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var y=d.retryLane;d.retryLane=y!==0&&y<h?y:h}}function nE(d,h){YM(d,h),(d=d.alternate)&&YM(d,h)}function XM(d){if(d.tag===13){var h=yo(d,67108864);h!==null&&xa(h,d,67108864),nE(d,67108864)}}var Kv=!0;function KW(d,h,y,S){var N=K.T;K.T=null;var $=ee.p;try{ee.p=2,rE(d,h,y,S)}finally{ee.p=$,K.T=N}}function WW(d,h,y,S){var N=K.T;K.T=null;var $=ee.p;try{ee.p=8,rE(d,h,y,S)}finally{ee.p=$,K.T=N}}function rE(d,h,y,S){if(Kv){var N=sE(S);if(N===null)V2(d,h,S,Wv,y),QM(d,S);else if(YW(N,d,h,y,S))S.stopPropagation();else if(QM(d,S),h&4&&-1<ZW.indexOf(d)){for(;N!==null;){var $=Qn(N);if($!==null)switch($.tag){case 3:if($=$.stateNode,$.current.memoizedState.isDehydrated){var le=ve($.pendingLanes);if(le!==0){var Ee=$;for(Ee.pendingLanes|=2,Ee.entangledLanes|=2;le;){var qe=1<<31-Gt(le);Ee.entanglements[1]|=qe,le&=~qe}cl($),(Tr&6)===0&&(Iv=ce()+500,Ng(0))}}break;case 13:Ee=yo($,2),Ee!==null&&xa(Ee,$,2),Mv(),nE($,2)}if($=sE(S),$===null&&V2(d,h,S,Wv,y),$===N)break;N=$}N!==null&&S.stopPropagation()}else V2(d,h,S,null,y)}}function sE(d){return d=ih(d),iE(d)}var Wv=null;function iE(d){if(Wv=null,d=qn(d),d!==null){var h=i(d);if(h===null)d=null;else{var y=h.tag;if(y===13){if(d=a(h),d!==null)return d;d=null}else if(y===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;d=null}else h!==d&&(d=null)}}return Wv=d,null}function JM(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oe()){case ne:return 2;case Se:return 8;case Fe:case ke:return 32;case Xe:return 268435456;default:return 32}default:return 32}}var aE=!1,_u=null,Su=null,Eu=null,Lg=new Map,Bg=new Map,Cu=[],ZW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function QM(d,h){switch(d){case"focusin":case"focusout":_u=null;break;case"dragenter":case"dragleave":Su=null;break;case"mouseover":case"mouseout":Eu=null;break;case"pointerover":case"pointerout":Lg.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bg.delete(h.pointerId)}}function $g(d,h,y,S,N,$){return d===null||d.nativeEvent!==$?(d={blockedOn:h,domEventName:y,eventSystemFlags:S,nativeEvent:$,targetContainers:[N]},h!==null&&(h=Qn(h),h!==null&&XM(h)),d):(d.eventSystemFlags|=S,h=d.targetContainers,N!==null&&h.indexOf(N)===-1&&h.push(N),d)}function YW(d,h,y,S,N){switch(h){case"focusin":return _u=$g(_u,d,h,y,S,N),!0;case"dragenter":return Su=$g(Su,d,h,y,S,N),!0;case"mouseover":return Eu=$g(Eu,d,h,y,S,N),!0;case"pointerover":var $=N.pointerId;return Lg.set($,$g(Lg.get($)||null,d,h,y,S,N)),!0;case"gotpointercapture":return $=N.pointerId,Bg.set($,$g(Bg.get($)||null,d,h,y,S,N)),!0}return!1}function e4(d){var h=qn(d.target);if(h!==null){var y=i(h);if(y!==null){if(h=y.tag,h===13){if(h=a(y),h!==null){d.blockedOn=h,U(d.priority,function(){if(y.tag===13){var S=wa();S=Et(S);var N=yo(y,S);N!==null&&xa(N,y,S),nE(y,S)}});return}}else if(h===3&&y.stateNode.current.memoizedState.isDehydrated){d.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Zv(d){if(d.blockedOn!==null)return!1;for(var h=d.targetContainers;0<h.length;){var y=sE(d.nativeEvent);if(y===null){y=d.nativeEvent;var S=new y.constructor(y.type,y);Da=S,y.target.dispatchEvent(S),Da=null}else return h=Qn(y),h!==null&&XM(h),d.blockedOn=y,!1;h.shift()}return!0}function t4(d,h,y){Zv(d)&&y.delete(h)}function XW(){aE=!1,_u!==null&&Zv(_u)&&(_u=null),Su!==null&&Zv(Su)&&(Su=null),Eu!==null&&Zv(Eu)&&(Eu=null),Lg.forEach(t4),Bg.forEach(t4)}function Yv(d,h){d.blockedOn===h&&(d.blockedOn=null,aE||(aE=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,XW)))}var Xv=null;function n4(d){Xv!==d&&(Xv=d,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Xv===d&&(Xv=null);for(var h=0;h<d.length;h+=3){var y=d[h],S=d[h+1],N=d[h+2];if(typeof S!="function"){if(iE(S||y)===null)continue;break}var $=Qn(y);$!==null&&(d.splice(h,3),h-=3,i2($,{pending:!0,data:N,method:y.method,action:S},S,N))}}))}function zg(d){function h(qe){return Yv(qe,d)}_u!==null&&Yv(_u,d),Su!==null&&Yv(Su,d),Eu!==null&&Yv(Eu,d),Lg.forEach(h),Bg.forEach(h);for(var y=0;y<Cu.length;y++){var S=Cu[y];S.blockedOn===d&&(S.blockedOn=null)}for(;0<Cu.length&&(y=Cu[0],y.blockedOn===null);)e4(y),y.blockedOn===null&&Cu.shift();if(y=(d.ownerDocument||d).$$reactFormReplay,y!=null)for(S=0;S<y.length;S+=3){var N=y[S],$=y[S+1],le=N[je]||null;if(typeof $=="function")le||n4(y);else if(le){var Ee=null;if($&&$.hasAttribute("formAction")){if(N=$,le=$[je]||null)Ee=le.formAction;else if(iE(N)!==null)continue}else Ee=le.action;typeof Ee=="function"?y[S+1]=Ee:(y.splice(S,3),S-=3),n4(y)}}}function oE(d){this._internalRoot=d}Jv.prototype.render=oE.prototype.render=function(d){var h=this._internalRoot;if(h===null)throw Error(r(409));var y=h.current,S=wa();ZM(y,S,d,h,null,null)},Jv.prototype.unmount=oE.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var h=d.containerInfo;ZM(d.current,2,null,d,null,null),Mv(),h[Ke]=null}};function Jv(d){this._internalRoot=d}Jv.prototype.unstable_scheduleHydration=function(d){if(d){var h=G();d={blockedOn:null,target:d,priority:h};for(var y=0;y<Cu.length&&h!==0&&h<Cu[y].priority;y++);Cu.splice(y,0,d),y===0&&e4(d)}};var r4=t.version;if(r4!=="19.1.0")throw Error(r(527,r4,"19.1.0"));ee.findDOMNode=function(d){var h=d._reactInternals;if(h===void 0)throw typeof d.render=="function"?Error(r(188)):(d=Object.keys(d).join(","),Error(r(268,d)));return d=l(h),d=d!==null?c(d):null,d=d===null?null:d.stateNode,d};var JW={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qv.isDisabled&&Qv.supportsFiber)try{It=Qv.inject(JW),Vt=Qv}catch{}}return qg.createRoot=function(d,h){if(!s(d))throw Error(r(299));var y=!1,S="",N=vj,$=wj,le=xj,Ee=null;return h!=null&&(h.unstable_strictMode===!0&&(y=!0),h.identifierPrefix!==void 0&&(S=h.identifierPrefix),h.onUncaughtError!==void 0&&(N=h.onUncaughtError),h.onCaughtError!==void 0&&($=h.onCaughtError),h.onRecoverableError!==void 0&&(le=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(Ee=h.unstable_transitionCallbacks)),h=KM(d,1,!1,null,null,y,S,N,$,le,Ee,null),d[Ke]=h.current,q2(d),new oE(h)},qg.hydrateRoot=function(d,h,y){if(!s(d))throw Error(r(299));var S=!1,N="",$=vj,le=wj,Ee=xj,qe=null,pt=null;return y!=null&&(y.unstable_strictMode===!0&&(S=!0),y.identifierPrefix!==void 0&&(N=y.identifierPrefix),y.onUncaughtError!==void 0&&($=y.onUncaughtError),y.onCaughtError!==void 0&&(le=y.onCaughtError),y.onRecoverableError!==void 0&&(Ee=y.onRecoverableError),y.unstable_transitionCallbacks!==void 0&&(qe=y.unstable_transitionCallbacks),y.formState!==void 0&&(pt=y.formState)),h=KM(d,1,!0,h,y??null,S,N,$,le,Ee,qe,pt),h.context=WM(null),y=h.current,S=wa(),S=Et(S),N=lu(S),N.callback=null,cu(y,N,S),y=S,h.current.lanes=y,rt(h,y),cl(h),d[Ke]=h.current,q2(d),new Jv(h)},qg.version="19.1.0",qg}var h4;function pZ(){if(h4)return uE.exports;h4=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),uE.exports=hZ(),uE.exports}var mZ=pZ();const gZ=Ni(mZ);function p4(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Tc(...e){return t=>{let n=!1;const r=e.map(s=>{const i=p4(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():p4(e[s],null)}}}}function Nn(...e){return T.useCallback(Tc(...e),e)}function zu(e){const t=yZ(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(vZ);if(l){const c=l.props.children,u=o.map(f=>f===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:f);return p.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return p.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var B8=zu("Slot");function yZ(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=xZ(s),o=wZ(i,s.props);return s.type!==T.Fragment&&(o.ref=r?Tc(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var $8=Symbol("radix.slottable");function bZ(e){const t=({children:n})=>p.jsx(p.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=$8,t}function vZ(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===$8}function wZ(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function xZ(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function z8(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=z8(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function U8(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=z8(e))&&(r&&(r+=" "),r+=t);return r}const m4=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,g4=U8,uR=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return g4(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,a=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],f=i==null?void 0:i[c];if(u===null)return null;const m=m4(u)||m4(f);return s[c][m]}),o=n&&Object.entries(n).reduce((c,u)=>{let[f,m]=u;return m===void 0||(c[f]=m),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:f,className:m,...g}=u;return Object.entries(g).every(v=>{let[b,w]=v;return Array.isArray(w)?w.includes({...i,...o}[b]):{...i,...o}[b]===w})?[...c,f,m]:c},[]);return g4(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},dR="-",_Z=e=>{const t=EZ(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(dR);return o[0]===""&&o.length!==1&&o.shift(),q8(o,t)||SZ(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},q8=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?q8(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(dR);return(a=t.validators.find(({validator:o})=>o(i)))==null?void 0:a.classGroupId},y4=/^\[(.+)\]$/,SZ=e=>{if(y4.test(e)){const t=y4.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},EZ=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const s in n)vT(n[s],r,s,t);return r},vT=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:b4(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(CZ(s)){vT(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{vT(a,b4(t,i),n,r)})})},b4=(e,t)=>{let n=e;return t.split(dR).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},CZ=e=>e.isThemeGetter,kZ=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},wT="!",xT=":",TZ=xT.length,AZ=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=s=>{const i=[];let a=0,o=0,l=0,c;for(let v=0;v<s.length;v++){let b=s[v];if(a===0&&o===0){if(b===xT){i.push(s.slice(l,v)),l=v+TZ;continue}if(b==="/"){c=v;continue}}b==="["?a++:b==="]"?a--:b==="("?o++:b===")"&&o--}const u=i.length===0?s:s.substring(l),f=RZ(u),m=f!==u,g=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:m,baseClassName:f,maybePostfixModifierPosition:g}};if(t){const s=t+xT,i=r;r=a=>a.startsWith(s)?i(a.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(n){const s=r;r=i=>n({className:i,parseClassName:s})}return r},RZ=e=>e.endsWith(wT)?e.substring(0,e.length-1):e.startsWith(wT)?e.substring(1):e,NZ=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let i=[];return r.forEach(a=>{a[0]==="["||t[a]?(s.push(...i.sort(),a),i=[]):i.push(a)}),s.push(...i.sort()),s}},IZ=e=>({cache:kZ(e.cacheSize),parseClassName:AZ(e),sortModifiers:NZ(e),..._Z(e)}),jZ=/\s+/,MZ=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:i}=t,a=[],o=e.trim().split(jZ);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:f,modifiers:m,hasImportantModifier:g,baseClassName:v,maybePostfixModifierPosition:b}=n(u);if(f){l=u+(l.length>0?" "+l:l);continue}let w=!!b,x=r(w?v.substring(0,b):v);if(!x){if(!w){l=u+(l.length>0?" "+l:l);continue}if(x=r(v),!x){l=u+(l.length>0?" "+l:l);continue}w=!1}const _=i(m).join(":"),E=g?_+wT:_,C=E+x;if(a.includes(C))continue;a.push(C);const k=s(x,w);for(let R=0;R<k.length;++R){const I=k[R];a.push(E+I)}l=u+(l.length>0?" "+l:l)}return l};function OZ(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=V8(t))&&(r&&(r+=" "),r+=n);return r}const V8=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=V8(e[r]))&&(n&&(n+=" "),n+=t);return n};function PZ(e,...t){let n,r,s,i=a;function a(l){const c=t.reduce((u,f)=>f(u),e());return n=IZ(c),r=n.cache.get,s=n.cache.set,i=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=MZ(l,n);return s(l,u),u}return function(){return i(OZ.apply(null,arguments))}}const Ds=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},H8=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,G8=/^\((?:(\w[\w-]*):)?(.+)\)$/i,DZ=/^\d+\/\d+$/,FZ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,LZ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,BZ=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,$Z=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,zZ=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Gh=e=>DZ.test(e),Yn=e=>!!e&&!Number.isNaN(Number(e)),Tu=e=>!!e&&Number.isInteger(Number(e)),pE=e=>e.endsWith("%")&&Yn(e.slice(0,-1)),hc=e=>FZ.test(e),UZ=()=>!0,qZ=e=>LZ.test(e)&&!BZ.test(e),K8=()=>!1,VZ=e=>$Z.test(e),HZ=e=>zZ.test(e),GZ=e=>!ln(e)&&!cn(e),KZ=e=>nm(e,Y8,K8),ln=e=>H8.test(e),Xd=e=>nm(e,X8,qZ),mE=e=>nm(e,JZ,Yn),v4=e=>nm(e,W8,K8),WZ=e=>nm(e,Z8,HZ),ew=e=>nm(e,J8,VZ),cn=e=>G8.test(e),Vg=e=>rm(e,X8),ZZ=e=>rm(e,QZ),w4=e=>rm(e,W8),YZ=e=>rm(e,Y8),XZ=e=>rm(e,Z8),tw=e=>rm(e,J8,!0),nm=(e,t,n)=>{const r=H8.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},rm=(e,t,n=!1)=>{const r=G8.exec(e);return r?r[1]?t(r[1]):n:!1},W8=e=>e==="position"||e==="percentage",Z8=e=>e==="image"||e==="url",Y8=e=>e==="length"||e==="size"||e==="bg-size",X8=e=>e==="length",JZ=e=>e==="number",QZ=e=>e==="family-name",J8=e=>e==="shadow",eY=()=>{const e=Ds("color"),t=Ds("font"),n=Ds("text"),r=Ds("font-weight"),s=Ds("tracking"),i=Ds("leading"),a=Ds("breakpoint"),o=Ds("container"),l=Ds("spacing"),c=Ds("radius"),u=Ds("shadow"),f=Ds("inset-shadow"),m=Ds("text-shadow"),g=Ds("drop-shadow"),v=Ds("blur"),b=Ds("perspective"),w=Ds("aspect"),x=Ds("ease"),_=Ds("animate"),E=()=>["auto","avoid","all","avoid-page","page","left","right","column"],C=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[...C(),cn,ln],R=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto","contain","none"],j=()=>[cn,ln,l],M=()=>[Gh,"full","auto",...j()],L=()=>[Tu,"none","subgrid",cn,ln],q=()=>["auto",{span:["full",Tu,cn,ln]},Tu,cn,ln],P=()=>[Tu,"auto",cn,ln],V=()=>["auto","min","max","fr",cn,ln],z=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],re=()=>["start","end","center","stretch","center-safe","end-safe"],K=()=>["auto",...j()],ee=()=>[Gh,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...j()],W=()=>[e,cn,ln],se=()=>[...C(),w4,v4,{position:[cn,ln]}],Y=()=>["no-repeat",{repeat:["","x","y","space","round"]}],te=()=>["auto","cover","contain",YZ,KZ,{size:[cn,ln]}],Q=()=>[pE,Vg,Xd],ae=()=>["","none","full",c,cn,ln],xe=()=>["",Yn,Vg,Xd],ge=()=>["solid","dashed","dotted","double"],Me=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Pe=()=>[Yn,pE,w4,v4],Ie=()=>["","none",v,cn,ln],Ce=()=>["none",Yn,cn,ln],He=()=>["none",Yn,cn,ln],it=()=>[Yn,cn,ln],Ge=()=>[Gh,"full",...j()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[hc],breakpoint:[hc],color:[UZ],container:[hc],"drop-shadow":[hc],ease:["in","out","in-out"],font:[GZ],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[hc],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[hc],shadow:[hc],spacing:["px",Yn],text:[hc],"text-shadow":[hc],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Gh,ln,cn,w]}],container:["container"],columns:[{columns:[Yn,ln,cn,o]}],"break-after":[{"break-after":E()}],"break-before":[{"break-before":E()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:M()}],"inset-x":[{"inset-x":M()}],"inset-y":[{"inset-y":M()}],start:[{start:M()}],end:[{end:M()}],top:[{top:M()}],right:[{right:M()}],bottom:[{bottom:M()}],left:[{left:M()}],visibility:["visible","invisible","collapse"],z:[{z:[Tu,"auto",cn,ln]}],basis:[{basis:[Gh,"full","auto",o,...j()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Yn,Gh,"auto","initial","none",ln]}],grow:[{grow:["",Yn,cn,ln]}],shrink:[{shrink:["",Yn,cn,ln]}],order:[{order:[Tu,"first","last","none",cn,ln]}],"grid-cols":[{"grid-cols":L()}],"col-start-end":[{col:q()}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":L()}],"row-start-end":[{row:q()}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":V()}],"auto-rows":[{"auto-rows":V()}],gap:[{gap:j()}],"gap-x":[{"gap-x":j()}],"gap-y":[{"gap-y":j()}],"justify-content":[{justify:[...z(),"normal"]}],"justify-items":[{"justify-items":[...re(),"normal"]}],"justify-self":[{"justify-self":["auto",...re()]}],"align-content":[{content:["normal",...z()]}],"align-items":[{items:[...re(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...re(),{baseline:["","last"]}]}],"place-content":[{"place-content":z()}],"place-items":[{"place-items":[...re(),"baseline"]}],"place-self":[{"place-self":["auto",...re()]}],p:[{p:j()}],px:[{px:j()}],py:[{py:j()}],ps:[{ps:j()}],pe:[{pe:j()}],pt:[{pt:j()}],pr:[{pr:j()}],pb:[{pb:j()}],pl:[{pl:j()}],m:[{m:K()}],mx:[{mx:K()}],my:[{my:K()}],ms:[{ms:K()}],me:[{me:K()}],mt:[{mt:K()}],mr:[{mr:K()}],mb:[{mb:K()}],ml:[{ml:K()}],"space-x":[{"space-x":j()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":j()}],"space-y-reverse":["space-y-reverse"],size:[{size:ee()}],w:[{w:[o,"screen",...ee()]}],"min-w":[{"min-w":[o,"screen","none",...ee()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...ee()]}],h:[{h:["screen",...ee()]}],"min-h":[{"min-h":["screen","none",...ee()]}],"max-h":[{"max-h":["screen",...ee()]}],"font-size":[{text:["base",n,Vg,Xd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,cn,mE]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",pE,ln]}],"font-family":[{font:[ZZ,ln,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,cn,ln]}],"line-clamp":[{"line-clamp":[Yn,"none",cn,mE]}],leading:[{leading:[i,...j()]}],"list-image":[{"list-image":["none",cn,ln]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",cn,ln]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:W()}],"text-color":[{text:W()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ge(),"wavy"]}],"text-decoration-thickness":[{decoration:[Yn,"from-font","auto",cn,Xd]}],"text-decoration-color":[{decoration:W()}],"underline-offset":[{"underline-offset":[Yn,"auto",cn,ln]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",cn,ln]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",cn,ln]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:se()}],"bg-repeat":[{bg:Y()}],"bg-size":[{bg:te()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Tu,cn,ln],radial:["",cn,ln],conic:[Tu,cn,ln]},XZ,WZ]}],"bg-color":[{bg:W()}],"gradient-from-pos":[{from:Q()}],"gradient-via-pos":[{via:Q()}],"gradient-to-pos":[{to:Q()}],"gradient-from":[{from:W()}],"gradient-via":[{via:W()}],"gradient-to":[{to:W()}],rounded:[{rounded:ae()}],"rounded-s":[{"rounded-s":ae()}],"rounded-e":[{"rounded-e":ae()}],"rounded-t":[{"rounded-t":ae()}],"rounded-r":[{"rounded-r":ae()}],"rounded-b":[{"rounded-b":ae()}],"rounded-l":[{"rounded-l":ae()}],"rounded-ss":[{"rounded-ss":ae()}],"rounded-se":[{"rounded-se":ae()}],"rounded-ee":[{"rounded-ee":ae()}],"rounded-es":[{"rounded-es":ae()}],"rounded-tl":[{"rounded-tl":ae()}],"rounded-tr":[{"rounded-tr":ae()}],"rounded-br":[{"rounded-br":ae()}],"rounded-bl":[{"rounded-bl":ae()}],"border-w":[{border:xe()}],"border-w-x":[{"border-x":xe()}],"border-w-y":[{"border-y":xe()}],"border-w-s":[{"border-s":xe()}],"border-w-e":[{"border-e":xe()}],"border-w-t":[{"border-t":xe()}],"border-w-r":[{"border-r":xe()}],"border-w-b":[{"border-b":xe()}],"border-w-l":[{"border-l":xe()}],"divide-x":[{"divide-x":xe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":xe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ge(),"hidden","none"]}],"divide-style":[{divide:[...ge(),"hidden","none"]}],"border-color":[{border:W()}],"border-color-x":[{"border-x":W()}],"border-color-y":[{"border-y":W()}],"border-color-s":[{"border-s":W()}],"border-color-e":[{"border-e":W()}],"border-color-t":[{"border-t":W()}],"border-color-r":[{"border-r":W()}],"border-color-b":[{"border-b":W()}],"border-color-l":[{"border-l":W()}],"divide-color":[{divide:W()}],"outline-style":[{outline:[...ge(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Yn,cn,ln]}],"outline-w":[{outline:["",Yn,Vg,Xd]}],"outline-color":[{outline:W()}],shadow:[{shadow:["","none",u,tw,ew]}],"shadow-color":[{shadow:W()}],"inset-shadow":[{"inset-shadow":["none",f,tw,ew]}],"inset-shadow-color":[{"inset-shadow":W()}],"ring-w":[{ring:xe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:W()}],"ring-offset-w":[{"ring-offset":[Yn,Xd]}],"ring-offset-color":[{"ring-offset":W()}],"inset-ring-w":[{"inset-ring":xe()}],"inset-ring-color":[{"inset-ring":W()}],"text-shadow":[{"text-shadow":["none",m,tw,ew]}],"text-shadow-color":[{"text-shadow":W()}],opacity:[{opacity:[Yn,cn,ln]}],"mix-blend":[{"mix-blend":[...Me(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Me()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Yn]}],"mask-image-linear-from-pos":[{"mask-linear-from":Pe()}],"mask-image-linear-to-pos":[{"mask-linear-to":Pe()}],"mask-image-linear-from-color":[{"mask-linear-from":W()}],"mask-image-linear-to-color":[{"mask-linear-to":W()}],"mask-image-t-from-pos":[{"mask-t-from":Pe()}],"mask-image-t-to-pos":[{"mask-t-to":Pe()}],"mask-image-t-from-color":[{"mask-t-from":W()}],"mask-image-t-to-color":[{"mask-t-to":W()}],"mask-image-r-from-pos":[{"mask-r-from":Pe()}],"mask-image-r-to-pos":[{"mask-r-to":Pe()}],"mask-image-r-from-color":[{"mask-r-from":W()}],"mask-image-r-to-color":[{"mask-r-to":W()}],"mask-image-b-from-pos":[{"mask-b-from":Pe()}],"mask-image-b-to-pos":[{"mask-b-to":Pe()}],"mask-image-b-from-color":[{"mask-b-from":W()}],"mask-image-b-to-color":[{"mask-b-to":W()}],"mask-image-l-from-pos":[{"mask-l-from":Pe()}],"mask-image-l-to-pos":[{"mask-l-to":Pe()}],"mask-image-l-from-color":[{"mask-l-from":W()}],"mask-image-l-to-color":[{"mask-l-to":W()}],"mask-image-x-from-pos":[{"mask-x-from":Pe()}],"mask-image-x-to-pos":[{"mask-x-to":Pe()}],"mask-image-x-from-color":[{"mask-x-from":W()}],"mask-image-x-to-color":[{"mask-x-to":W()}],"mask-image-y-from-pos":[{"mask-y-from":Pe()}],"mask-image-y-to-pos":[{"mask-y-to":Pe()}],"mask-image-y-from-color":[{"mask-y-from":W()}],"mask-image-y-to-color":[{"mask-y-to":W()}],"mask-image-radial":[{"mask-radial":[cn,ln]}],"mask-image-radial-from-pos":[{"mask-radial-from":Pe()}],"mask-image-radial-to-pos":[{"mask-radial-to":Pe()}],"mask-image-radial-from-color":[{"mask-radial-from":W()}],"mask-image-radial-to-color":[{"mask-radial-to":W()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":C()}],"mask-image-conic-pos":[{"mask-conic":[Yn]}],"mask-image-conic-from-pos":[{"mask-conic-from":Pe()}],"mask-image-conic-to-pos":[{"mask-conic-to":Pe()}],"mask-image-conic-from-color":[{"mask-conic-from":W()}],"mask-image-conic-to-color":[{"mask-conic-to":W()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:se()}],"mask-repeat":[{mask:Y()}],"mask-size":[{mask:te()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",cn,ln]}],filter:[{filter:["","none",cn,ln]}],blur:[{blur:Ie()}],brightness:[{brightness:[Yn,cn,ln]}],contrast:[{contrast:[Yn,cn,ln]}],"drop-shadow":[{"drop-shadow":["","none",g,tw,ew]}],"drop-shadow-color":[{"drop-shadow":W()}],grayscale:[{grayscale:["",Yn,cn,ln]}],"hue-rotate":[{"hue-rotate":[Yn,cn,ln]}],invert:[{invert:["",Yn,cn,ln]}],saturate:[{saturate:[Yn,cn,ln]}],sepia:[{sepia:["",Yn,cn,ln]}],"backdrop-filter":[{"backdrop-filter":["","none",cn,ln]}],"backdrop-blur":[{"backdrop-blur":Ie()}],"backdrop-brightness":[{"backdrop-brightness":[Yn,cn,ln]}],"backdrop-contrast":[{"backdrop-contrast":[Yn,cn,ln]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Yn,cn,ln]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Yn,cn,ln]}],"backdrop-invert":[{"backdrop-invert":["",Yn,cn,ln]}],"backdrop-opacity":[{"backdrop-opacity":[Yn,cn,ln]}],"backdrop-saturate":[{"backdrop-saturate":[Yn,cn,ln]}],"backdrop-sepia":[{"backdrop-sepia":["",Yn,cn,ln]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":j()}],"border-spacing-x":[{"border-spacing-x":j()}],"border-spacing-y":[{"border-spacing-y":j()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",cn,ln]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Yn,"initial",cn,ln]}],ease:[{ease:["linear","initial",x,cn,ln]}],delay:[{delay:[Yn,cn,ln]}],animate:[{animate:["none",_,cn,ln]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,cn,ln]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:Ce()}],"rotate-x":[{"rotate-x":Ce()}],"rotate-y":[{"rotate-y":Ce()}],"rotate-z":[{"rotate-z":Ce()}],scale:[{scale:He()}],"scale-x":[{"scale-x":He()}],"scale-y":[{"scale-y":He()}],"scale-z":[{"scale-z":He()}],"scale-3d":["scale-3d"],skew:[{skew:it()}],"skew-x":[{"skew-x":it()}],"skew-y":[{"skew-y":it()}],transform:[{transform:[cn,ln,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ge()}],"translate-x":[{"translate-x":Ge()}],"translate-y":[{"translate-y":Ge()}],"translate-z":[{"translate-z":Ge()}],"translate-none":["translate-none"],accent:[{accent:W()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:W()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",cn,ln]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",cn,ln]}],fill:[{fill:["none",...W()]}],"stroke-w":[{stroke:[Yn,Vg,Xd,mE]}],stroke:[{stroke:["none",...W()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},tY=PZ(eY);function ct(...e){return tY(U8(e))}const nY=uR("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Ct({className:e,variant:t,size:n,asChild:r=!1,...s}){const i=r?B8:"button";return p.jsx(i,{"data-slot":"button",className:ct(nY({variant:t,size:n,className:e})),...s})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rY=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sY=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),x4=e=>{const t=sY(e);return t.charAt(0).toUpperCase()+t.slice(1)},Q8=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var iY={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aY=T.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},l)=>T.createElement("svg",{ref:l,...iY,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:Q8("lucide",s),...o},[...a.map(([c,u])=>T.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=(e,t)=>{const n=T.forwardRef(({className:r,...s},i)=>T.createElement(aY,{ref:i,iconNode:t,className:Q8(`lucide-${rY(x4(e))}`,`lucide-${e}`,r),...s}));return n.displayName=x4(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oY=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],lY=$t("archive",oY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cY=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],eF=$t("arrow-down",cY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uY=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],dY=$t("arrow-right",uY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fY=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],hY=$t("arrow-up",fY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],mY=$t("ban",pY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gY=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],tF=$t("bot",gY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yY=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],dd=$t("brain-circuit",yY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bY=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],_4=$t("brain",bY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vY=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ui=$t("check",vY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wY=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Fl=$t("chevron-down",wY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xY=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],nF=$t("chevron-right",xY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _Y=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],fd=$t("chevron-up",_Y);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SY=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],M1=$t("chevrons-up-down",SY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EY=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],CY=$t("chevrons-up",EY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ac=$t("circle-alert",kY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],O1=$t("circle-check",TY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],RY=$t("circle",AY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NY=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],P1=$t("clipboard",NY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],jY=$t("clock",IY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MY=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],rF=$t("cloud-upload",MY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OY=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],sF=$t("code",OY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PY=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],DY=$t("cog",PY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FY=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],LY=$t("coins",FY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BY=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],$Y=$t("copy",BY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zY=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],UY=$t("dollar-sign",zY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qY=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],vf=$t("download",qY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VY=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],HY=$t("ellipsis-vertical",VY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GY=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],KY=$t("file-archive",GY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WY=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],ZY=$t("file-down",WY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YY=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],XY=$t("file-json",YY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JY=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],QY=$t("file-question",JY);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eX=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tX=$t("file-text",eX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nX=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],rX=$t("file-up",nX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sX=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],iF=$t("file",sX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iX=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],aF=$t("folder-git",iX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aX=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],oF=$t("folder-plus",aX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oX=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],S4=$t("folder-tree",oX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lX=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],cX=$t("folder-up",lX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uX=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Uu=$t("folder",uX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dX=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],fR=$t("funnel",dX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fX=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],qu=$t("git-branch",fX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hX=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],lF=$t("git-commit-horizontal",hX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pX=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],cF=$t("git-merge",pX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mX=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],hR=$t("git-pull-request",mX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gX=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],E4=$t("globe",gX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yX=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],bX=$t("grip-vertical",yX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vX=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],pR=$t("hard-drive",vX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wX=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],xX=$t("history",wX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _X=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],SX=$t("house",_X);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EX=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Ef=$t("image",EX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CX=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],mR=$t("info",CX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kX=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],k0=$t("key",kX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TX=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Pn=$t("loader-circle",TX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AX=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],RX=$t("menu",AX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NX=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],IX=$t("message-square-plus",NX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jX=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],C4=$t("message-square-text",jX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MX=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],_T=$t("message-square",MX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OX=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],PX=$t("music",OX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DX=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],FX=$t("palette",DX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LX=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],BX=$t("panel-left-close",LX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $X=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],zX=$t("panel-right-close",$X);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UX=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],gR=$t("paperclip",UX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qX=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Vy=$t("pen",qX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VX=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],sm=$t("plus",VX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HX=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],k4=$t("puzzle",HX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GX=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],D1=$t("refresh-cw",GX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KX=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],WX=$t("rocket",KX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZX=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],yR=$t("rotate-ccw",ZX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YX=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],hd=$t("save",YX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XX=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],ki=$t("search",XX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JX=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],QX=$t("send-horizontal",JX);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eJ=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],ox=$t("server",eJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tJ=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ST=$t("settings",tJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nJ=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],T4=$t("shield-alert",nJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rJ=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],sJ=$t("sliders-horizontal",rJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iJ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],aJ=$t("smile",iJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oJ=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],uF=$t("sparkles",oJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lJ=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],cJ=$t("sparkle",lJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uJ=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Vw=$t("square-pen",uJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dJ=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],fJ=$t("square",dJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hJ=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],pJ=$t("star",hJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mJ=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],ET=$t("tags",mJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gJ=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],yJ=$t("text",gJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bJ=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Aa=$t("trash-2",bJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vJ=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],bR=$t("triangle-alert",vJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wJ=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],xJ=$t("upload",wJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _J=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],SJ=$t("user",_J);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EJ=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],A4=$t("users",EJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CJ=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],kJ=$t("video",CJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TJ=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],Cf=$t("wrench",TJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AJ=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],la=$t("x",AJ);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RJ=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],NJ=$t("zap",RJ),R4=({controls:e,area:t,className:n})=>{const r=e.filter(s=>t==="trigger"?!!s.triggerRenderer:!!s.renderer);return r.length===0?null:p.jsx("div",{className:ct(n),children:r.map(s=>{var a,o;const i=t==="trigger"?(a=s.triggerRenderer)==null?void 0:a.call(s):(o=s.renderer)==null?void 0:o.call(s);return i?p.jsx(dt.Fragment,{children:i},s.id):null})})},N4=e=>{let t;const n=new Set,r=(c,u)=>{const f=typeof c=="function"?c(t):c;if(!Object.is(f,t)){const m=t;t=u??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(g=>g(t,m))}},s=()=>t,o={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,s,o);return o},IJ=e=>e?N4(e):N4,jJ=e=>e;function MJ(e,t=jJ){const n=dt.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return dt.useDebugValue(n),n}const I4=e=>{const t=IJ(e),n=r=>MJ(t,r);return Object.assign(n,t),n},oo=e=>e?I4(e):I4;var dF=Symbol.for("immer-nothing"),j4=Symbol.for("immer-draftable"),Er=Symbol.for("immer-state");function no(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Np=Object.getPrototypeOf;function Ip(e){return!!e&&!!e[Er]}function Rc(e){var t;return e?fF(e)||Array.isArray(e)||!!e[j4]||!!((t=e.constructor)!=null&&t[j4])||L1(e)||B1(e):!1}var OJ=Object.prototype.constructor.toString();function fF(e){if(!e||typeof e!="object")return!1;const t=Np(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===OJ}function T0(e,t){F1(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function F1(e){const t=e[Er];return t?t.type_:Array.isArray(e)?1:L1(e)?2:B1(e)?3:0}function CT(e,t){return F1(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function hF(e,t,n){const r=F1(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function PJ(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function L1(e){return e instanceof Map}function B1(e){return e instanceof Set}function Zs(e){return e.copy_||e.base_}function kT(e,t){if(L1(e))return new Map(e);if(B1(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=fF(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[Er];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Np(e),r)}else{const r=Np(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function vR(e,t=!1){return $1(e)||Ip(e)||!Rc(e)||(F1(e)>1&&(e.set=e.add=e.clear=e.delete=DJ),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>vR(r,!0))),e}function DJ(){no(2)}function $1(e){return Object.isFrozen(e)}var TT={};function kf(e){const t=TT[e];return t||no(0,e),t}function FJ(e,t){TT[e]||(TT[e]=t)}var A0;function lx(){return A0}function LJ(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function M4(e,t){t&&(kf("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function AT(e){RT(e),e.drafts_.forEach(BJ),e.drafts_=null}function RT(e){e===A0&&(A0=e.parent_)}function O4(e){return A0=LJ(A0,e)}function BJ(e){const t=e[Er];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function P4(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[Er].modified_&&(AT(t),no(4)),Rc(e)&&(e=cx(t,e),t.parent_||ux(t,e)),t.patches_&&kf("Patches").generateReplacementPatches_(n[Er].base_,e,t.patches_,t.inversePatches_)):e=cx(t,n,[]),AT(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==dF?e:void 0}function cx(e,t,n){if($1(t))return t;const r=t[Er];if(!r)return T0(t,(s,i)=>D4(e,r,t,s,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return ux(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),T0(i,(o,l)=>D4(e,r,s,o,l,n,a)),ux(e,s,!1),n&&e.patches_&&kf("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function D4(e,t,n,r,s,i,a){if(Ip(s)){const o=i&&t&&t.type_!==3&&!CT(t.assigned_,r)?i.concat(r):void 0,l=cx(e,s,o);if(hF(n,r,l),Ip(l))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(Rc(s)&&!$1(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;cx(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&ux(e,s)}}function ux(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&vR(t,n)}function $J(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:lx(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=wR;n&&(s=[r],i=R0);const{revoke:a,proxy:o}=Proxy.revocable(s,i);return r.draft_=o,r.revoke_=a,o}var wR={get(e,t){if(t===Er)return e;const n=Zs(e);if(!CT(n,t))return zJ(e,n,t);const r=n[t];return e.finalized_||!Rc(r)?r:r===gE(e.base_,t)?(yE(e),e.copy_[t]=N0(r,e)):r},has(e,t){return t in Zs(e)},ownKeys(e){return Reflect.ownKeys(Zs(e))},set(e,t,n){const r=pF(Zs(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=gE(Zs(e),t),i=s==null?void 0:s[Er];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(PJ(n,s)&&(n!==void 0||CT(e.base_,t)))return!0;yE(e),yc(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return gE(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,yE(e),yc(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=Zs(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){no(11)},getPrototypeOf(e){return Np(e.base_)},setPrototypeOf(){no(12)}},R0={};T0(wR,(e,t)=>{R0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});R0.deleteProperty=function(e,t){return R0.set.call(this,e,t,void 0)};R0.set=function(e,t,n){return wR.set.call(this,e[0],t,n,e[0])};function gE(e,t){const n=e[Er];return(n?Zs(n):e)[t]}function zJ(e,t,n){var s;const r=pF(t,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(e.draft_):void 0}function pF(e,t){if(!(t in e))return;let n=Np(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Np(n)}}function yc(e){e.modified_||(e.modified_=!0,e.parent_&&yc(e.parent_))}function yE(e){e.copy_||(e.copy_=kT(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var UJ=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const a=this;return function(l=i,...c){return a.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&no(6),r!==void 0&&typeof r!="function"&&no(7);let s;if(Rc(t)){const i=O4(this),a=N0(t,void 0);let o=!0;try{s=n(a),o=!1}finally{o?AT(i):RT(i)}return M4(i,r),P4(s,i)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===dF&&(s=void 0),this.autoFreeze_&&vR(s,!0),r){const i=[],a=[];kf("Patches").generateReplacementPatches_(t,s,i,a),r(i,a)}return s}else no(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let r,s;return[this.produce(t,n,(a,o)=>{r=a,s=o}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Rc(e)||no(8),Ip(e)&&(e=qJ(e));const t=O4(this),n=N0(e,void 0);return n[Er].isManual_=!0,RT(t),n}finishDraft(e,t){const n=e&&e[Er];(!n||!n.isManual_)&&no(9);const{scope_:r}=n;return M4(r,t),P4(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=kf("Patches").applyPatches_;return Ip(e)?r(e,t):this.produce(e,s=>r(s,t))}};function N0(e,t){const n=L1(e)?kf("MapSet").proxyMap_(e,t):B1(e)?kf("MapSet").proxySet_(e,t):$J(e,t);return(t?t.scope_:lx()).drafts_.push(n),n}function qJ(e){return Ip(e)||no(10,e),mF(e)}function mF(e){if(!Rc(e)||$1(e))return e;const t=e[Er];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=kT(e,t.scope_.immer_.useStrictShallowCopy_)}else n=kT(e,!0);return T0(n,(r,s)=>{hF(n,r,mF(s))}),t&&(t.finalized_=!1),n}function VJ(){class e extends Map{constructor(l,c){super(),this[Er]={type_:2,parent_:c,scope_:c?c.scope_:lx(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return Zs(this[Er]).size}has(l){return Zs(this[Er]).has(l)}set(l,c){const u=this[Er];return a(u),(!Zs(u).has(l)||Zs(u).get(l)!==c)&&(n(u),yc(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[Er];return a(c),n(c),yc(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[Er];a(l),Zs(l).size&&(n(l),yc(l),l.assigned_=new Map,T0(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[Er];Zs(u).forEach((f,m,g)=>{l.call(c,this.get(m),m,this)})}get(l){const c=this[Er];a(c);const u=Zs(c).get(l);if(c.finalized_||!Rc(u)||u!==c.base_.get(l))return u;const f=N0(u,c);return n(c),c.copy_.set(l,f),f}keys(){return Zs(this[Er]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[Er]={type_:3,parent_:c,scope_:c?c.scope_:lx(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return Zs(this[Er]).size}has(l){const c=this[Er];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[Er];return a(c),this.has(l)||(i(c),yc(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[Er];return a(c),i(c),yc(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[Er];a(l),Zs(l).size&&(i(l),yc(l),l.copy_.clear())}values(){const l=this[Er];return a(l),i(l),l.copy_.values()}entries(){const l=this[Er];return a(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let f=u.next();for(;!f.done;)l.call(c,f.value,f.value,this),f=u.next()}}function s(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(Rc(l)){const c=N0(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&no(3,JSON.stringify(Zs(o)))}FJ("MapSet",{proxyMap_:t,proxySet_:s})}var Ia=new UJ,HJ=Ia.produce;Ia.produceWithPatches.bind(Ia);Ia.setAutoFreeze.bind(Ia);Ia.setUseStrictShallowCopy.bind(Ia);Ia.applyPatches.bind(Ia);Ia.createDraft.bind(Ia);Ia.finishDraft.bind(Ia);const GJ=e=>(t,n,r)=>(r.setState=(s,i,...a)=>{const o=typeof s=="function"?HJ(s):s;return t(o,i,...a)},e(r.setState,n,r)),lo=GJ;function KJ(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}const Be=KJ(),rr={promptControlsChanged:"control.registry.prompt.controls.changed",chatControlsChanged:"control.registry.chat.controls.changed",canvasControlsChanged:"control.registry.canvas.controls.changed",middlewareChanged:"control.registry.middleware.changed",toolsChanged:"control.registry.tools.changed",modalProvidersChanged:"control.registry.modal.providers.changed",registerPromptControlRequest:"control.registry.register.prompt.control.request",unregisterPromptControlRequest:"control.registry.unregister.prompt.control.request",registerChatControlRequest:"control.registry.register.chat.control.request",unregisterChatControlRequest:"control.registry.unregister.chat.control.request",registerCanvasControlRequest:"control.registry.register.canvas.control.request",unregisterCanvasControlRequest:"control.registry.unregister.canvas.control.request",registerMiddlewareRequest:"control.registry.register.middleware.request",unregisterMiddlewareRequest:"control.registry.unregister.middleware.request",registerToolRequest:"control.registry.register.tool.request",unregisterToolRequest:"control.registry.unregister.tool.request",registerModalProviderRequest:"control.registry.register.modal.provider.request",unregisterModalProviderRequest:"control.registry.unregister.modal.provider.request"},co=oo(lo((e,t)=>({promptControls:{},chatControls:{},canvasControls:{},middlewareRegistry:{},tools:{},modalProviders:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),Be.emit(rr.promptControlsChanged,{controls:t().promptControls}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)}),Be.emit(rr.promptControlsChanged,{controls:t().promptControls})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),Be.emit(rr.chatControlsChanged,{controls:t().chatControls}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)}),Be.emit(rr.chatControlsChanged,{controls:t().chatControls})},registerCanvasControl:n=>(e(r=>{r.canvasControls[n.id]&&console.warn(`ControlRegistryStore: CanvasControl with ID "${n.id}" already registered. Overwriting.`),r.canvasControls[n.id]=n}),Be.emit(rr.canvasControlsChanged,{controls:t().canvasControls}),()=>t().unregisterCanvasControl(n.id)),unregisterCanvasControl:n=>{e(r=>{r.canvasControls[n]?delete r.canvasControls[n]:console.warn(`ControlRegistryStore: CanvasControl with ID "${n}" not found for unregistration.`)}),Be.emit(rr.canvasControlsChanged,{controls:t().canvasControls})},registerMiddleware:(n,r,s,i=0)=>{const a={modId:r,callback:s,order:i};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(a),o.middlewareRegistry[n].sort((l,c)=>(l.order??0)-(c.order??0))}),Be.emit(rr.middlewareChanged,{middleware:t().middlewareRegistry}),()=>t().unregisterMiddleware(n,r,s)},unregisterMiddleware:(n,r,s)=>{e(i=>{var a;i.middlewareRegistry[n]?(i.middlewareRegistry[n]=i.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===s)),((a=i.middlewareRegistry[n])==null?void 0:a.length)===0&&delete i.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)}),Be.emit(rr.middlewareChanged,{middleware:t().middlewareRegistry})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((s,i)=>(s.order??0)-(i.order??0)))},registerTool:(n,r,s,i)=>(e(a=>{a.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${a.tools[r].modId}". Overwriting with registration from mod "${n}".`),a.tools[r]={definition:s,implementation:i,modId:n}}),Be.emit(rr.toolsChanged,{tools:t().tools}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)}),Be.emit(rr.toolsChanged,{tools:t().tools})},getRegisteredTools:()=>Object.freeze({...t().tools}),registerModalProvider:(n,r)=>(e(s=>{s.modalProviders[n]&&console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" already registered. Overwriting.`),s.modalProviders[n]=r}),Be.emit(rr.modalProvidersChanged,{providers:t().modalProviders}),()=>t().unregisterModalProvider(n)),unregisterModalProvider:n=>{e(r=>{r.modalProviders[n]?delete r.modalProviders[n]:console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" not found for unregistration.`)}),Be.emit(rr.modalProvidersChanged,{providers:t().modalProviders})},getRegisteredActionHandlers:()=>{const n="controlRegistryStore",r=t();return[{eventName:rr.registerPromptControlRequest,handler:s=>{r.registerPromptControl(s.control)},storeId:n},{eventName:rr.unregisterPromptControlRequest,handler:s=>{r.unregisterPromptControl(s.id)},storeId:n},{eventName:rr.registerChatControlRequest,handler:s=>{r.registerChatControl(s.control)},storeId:n},{eventName:rr.unregisterChatControlRequest,handler:s=>{r.unregisterChatControl(s.id)},storeId:n},{eventName:rr.registerCanvasControlRequest,handler:s=>{r.registerCanvasControl(s.control)},storeId:n},{eventName:rr.unregisterCanvasControlRequest,handler:s=>{r.unregisterCanvasControl(s.id)},storeId:n},{eventName:rr.registerMiddlewareRequest,handler:s=>{r.registerMiddleware(s.hookName,s.modId,s.callback,s.order)},storeId:n},{eventName:rr.unregisterMiddlewareRequest,handler:s=>{r.unregisterMiddleware(s.hookName,s.modId,s.callback)},storeId:n},{eventName:rr.registerToolRequest,handler:s=>{r.registerTool(s.modId,s.toolName,s.definition,s.implementation)},storeId:n},{eventName:rr.unregisterToolRequest,handler:s=>{r.unregisterTool(s.toolName)},storeId:n},{eventName:rr.registerModalProviderRequest,handler:s=>{r.registerModalProvider(s.modalId,s.provider)},storeId:n},{eventName:rr.unregisterModalProviderRequest,handler:s=>{r.unregisterModalProvider(s.modalId)},storeId:n}]}})));var Hw={exports:{}},WJ=Hw.exports,F4;function ZJ(){return F4||(F4=1,function(e,t){(function(n,r){e.exports=r()})(WJ,function(){var n=function(A,F){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(J,ie){J.__proto__=ie}||function(J,ie){for(var de in ie)Object.prototype.hasOwnProperty.call(ie,de)&&(J[de]=ie[de])})(A,F)},r=function(){return(r=Object.assign||function(A){for(var F,J=1,ie=arguments.length;J<ie;J++)for(var de in F=arguments[J])Object.prototype.hasOwnProperty.call(F,de)&&(A[de]=F[de]);return A}).apply(this,arguments)};function s(A,F,J){for(var ie,de=0,_e=F.length;de<_e;de++)!ie&&de in F||((ie=ie||Array.prototype.slice.call(F,0,de))[de]=F[de]);return A.concat(ie||Array.prototype.slice.call(F))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:hf,a=Object.keys,o=Array.isArray;function l(A,F){return typeof F!="object"||a(F).forEach(function(J){A[J]=F[J]}),A}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function f(A,F){return u.call(A,F)}function m(A,F){typeof F=="function"&&(F=F(c(A))),(typeof Reflect>"u"?a:Reflect.ownKeys)(F).forEach(function(J){v(A,J,F[J])})}var g=Object.defineProperty;function v(A,F,J,ie){g(A,F,l(J&&f(J,"get")&&typeof J.get=="function"?{get:J.get,set:J.set,configurable:!0}:{value:J,configurable:!0,writable:!0},ie))}function b(A){return{from:function(F){return A.prototype=Object.create(F.prototype),v(A.prototype,"constructor",A),{extend:m.bind(null,A.prototype)}}}}var w=Object.getOwnPropertyDescriptor,x=[].slice;function _(A,F,J){return x.call(A,F,J)}function E(A,F){return F(A)}function C(A){if(!A)throw new Error("Assertion Failed")}function k(A){i.setImmediate?setImmediate(A):setTimeout(A,0)}function R(A,F){if(typeof F=="string"&&f(A,F))return A[F];if(!F)return A;if(typeof F!="string"){for(var J=[],ie=0,de=F.length;ie<de;++ie){var _e=R(A,F[ie]);J.push(_e)}return J}var De=F.indexOf(".");if(De!==-1){var $e=A[F.substr(0,De)];return $e==null?void 0:R($e,F.substr(De+1))}}function I(A,F,J){if(A&&F!==void 0&&!("isFrozen"in Object&&Object.isFrozen(A)))if(typeof F!="string"&&"length"in F){C(typeof J!="string"&&"length"in J);for(var ie=0,de=F.length;ie<de;++ie)I(A,F[ie],J[ie])}else{var _e,De,$e=F.indexOf(".");$e!==-1?(_e=F.substr(0,$e),(De=F.substr($e+1))===""?J===void 0?o(A)&&!isNaN(parseInt(_e))?A.splice(_e,1):delete A[_e]:A[_e]=J:I($e=!($e=A[_e])||!f(A,_e)?A[_e]={}:$e,De,J)):J===void 0?o(A)&&!isNaN(parseInt(F))?A.splice(F,1):delete A[F]:A[F]=J}}function j(A){var F,J={};for(F in A)f(A,F)&&(J[F]=A[F]);return J}var M=[].concat;function L(A){return M.apply([],A)}var It="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(L([8,16,32,64].map(function(A){return["Int","Uint","Float"].map(function(F){return F+A+"Array"})}))).filter(function(A){return i[A]}),q=new Set(It.map(function(A){return i[A]})),P=null;function V(A){return P=new WeakMap,A=function F(J){if(!J||typeof J!="object")return J;var ie=P.get(J);if(ie)return ie;if(o(J)){ie=[],P.set(J,ie);for(var de=0,_e=J.length;de<_e;++de)ie.push(F(J[de]))}else if(q.has(J.constructor))ie=J;else{var De,$e=c(J);for(De in ie=$e===Object.prototype?{}:Object.create($e),P.set(J,ie),J)f(J,De)&&(ie[De]=F(J[De]))}return ie}(A),P=null,A}var z={}.toString;function re(A){return z.call(A).slice(8,-1)}var K=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ee=typeof K=="symbol"?function(A){var F;return A!=null&&(F=A[K])&&F.apply(A)}:function(){return null};function W(A,F){return F=A.indexOf(F),0<=F&&A.splice(F,1),0<=F}var se={};function Y(A){var F,J,ie,de;if(arguments.length===1){if(o(A))return A.slice();if(this===se&&typeof A=="string")return[A];if(de=ee(A)){for(J=[];!(ie=de.next()).done;)J.push(ie.value);return J}if(A==null)return[A];if(typeof(F=A.length)!="number")return[A];for(J=new Array(F);F--;)J[F]=A[F];return J}for(F=arguments.length,J=new Array(F);F--;)J[F]=arguments[F];return J}var te=typeof Symbol<"u"?function(A){return A[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ht=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Di=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ht),Q={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ae(A,F){this.name=A,this.message=F}function xe(A,F){return A+". Errors: "+Object.keys(F).map(function(J){return F[J].toString()}).filter(function(J,ie,de){return de.indexOf(J)===ie}).join(`
`)}function ge(A,F,J,ie){this.failures=F,this.failedKeys=ie,this.successCount=J,this.message=xe(A,F)}function Me(A,F){this.name="BulkError",this.failures=Object.keys(F).map(function(J){return F[J]}),this.failuresByPos=F,this.message=xe(A,this.failures)}b(ae).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(ge).from(ae),b(Me).from(ae);var Pe=Di.reduce(function(A,F){return A[F]=F+"Error",A},{}),Ie=ae,Ce=Di.reduce(function(A,F){var J=F+"Error";function ie(de,_e){this.name=J,de?typeof de=="string"?(this.message="".concat(de).concat(_e?`
 `+_e:""),this.inner=_e||null):typeof de=="object"&&(this.message="".concat(de.name," ").concat(de.message),this.inner=de):(this.message=Q[F]||J,this.inner=null)}return b(ie).from(Ie),A[F]=ie,A},{});Ce.Syntax=SyntaxError,Ce.Type=TypeError,Ce.Range=RangeError;var He=ht.reduce(function(A,F){return A[F+"Error"]=Ce[F],A},{}),it=Di.reduce(function(A,F){return["Syntax","Type","Range"].indexOf(F)===-1&&(A[F+"Error"]=Ce[F]),A},{});function Ge(){}function Re(A){return A}function H(A,F){return A==null||A===Re?F:function(J){return F(A(J))}}function me(A,F){return function(){A.apply(this,arguments),F.apply(this,arguments)}}function Te(A,F){return A===Ge?F:function(){var J=A.apply(this,arguments);J!==void 0&&(arguments[0]=J);var ie=this.onsuccess,de=this.onerror;this.onsuccess=null,this.onerror=null;var _e=F.apply(this,arguments);return ie&&(this.onsuccess=this.onsuccess?me(ie,this.onsuccess):ie),de&&(this.onerror=this.onerror?me(de,this.onerror):de),_e!==void 0?_e:J}}function ce(A,F){return A===Ge?F:function(){A.apply(this,arguments);var J=this.onsuccess,ie=this.onerror;this.onsuccess=this.onerror=null,F.apply(this,arguments),J&&(this.onsuccess=this.onsuccess?me(J,this.onsuccess):J),ie&&(this.onerror=this.onerror?me(ie,this.onerror):ie)}}function oe(A,F){return A===Ge?F:function(J){var ie=A.apply(this,arguments);l(J,ie);var de=this.onsuccess,_e=this.onerror;return this.onsuccess=null,this.onerror=null,J=F.apply(this,arguments),de&&(this.onsuccess=this.onsuccess?me(de,this.onsuccess):de),_e&&(this.onerror=this.onerror?me(_e,this.onerror):_e),ie===void 0?J===void 0?void 0:J:l(ie,J)}}function ne(A,F){return A===Ge?F:function(){return F.apply(this,arguments)!==!1&&A.apply(this,arguments)}}function Se(A,F){return A===Ge?F:function(){var J=A.apply(this,arguments);if(J&&typeof J.then=="function"){for(var ie=this,de=arguments.length,_e=new Array(de);de--;)_e[de]=arguments[de];return J.then(function(){return F.apply(ie,_e)})}return F.apply(this,arguments)}}it.ModifyError=ge,it.DexieError=ae,it.BulkError=Me;var Fe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ke(A){Fe=A}var Xe={},St=100,It=typeof Promise>"u"?[]:function(){var A=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[A,c(A),A];var F=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[F,c(F),A]}(),ht=It[0],Di=It[1],It=It[2],Di=Di&&Di.then,Vt=ht&&ht.constructor,Ot=!!It,Gt=function(A,F){ue.push([A,F]),O&&(queueMicrotask(he),O=!1)},be=!0,O=!0,Z=[],fe=[],Oe=Re,ve={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ge,pgp:!1,env:{},finalize:Ge},Ae=ve,ue=[],mt=0,wt=[];function B(A){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var F=this._PSD=Ae;if(typeof A!="function"){if(A!==Xe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ye(this,this._value))}this._state=null,this._value=null,++F.ref,function J(ie,de){try{de(function(_e){if(ie._state===null){if(_e===ie)throw new TypeError("A promise cannot be resolved with itself.");var De=ie._lib&&G();_e&&typeof _e.then=="function"?J(ie,function($e,Ye){_e instanceof B?_e._then($e,Ye):_e.then($e,Ye)}):(ie._state=!0,ie._value=_e,we(ie)),De&&U()}},ye.bind(null,ie))}catch(_e){ye(ie,_e)}}(this,A)}var ze={get:function(){var A=Ae,F=Ht;function J(ie,de){var _e=this,De=!A.global&&(A!==Ae||F!==Ht),$e=De&&!Qn(),Ye=new B(function(Qe,st){Ue(_e,new rt(Yo(ie,A,De,$e),Yo(de,A,De,$e),Qe,st,A))});return this._consoleTask&&(Ye._consoleTask=this._consoleTask),Ye}return J.prototype=Xe,J},set:function(A){v(this,"then",A&&A.prototype===Xe?ze:{get:function(){return A},set:ze.set})}};function rt(A,F,J,ie,de){this.onFulfilled=typeof A=="function"?A:null,this.onRejected=typeof F=="function"?F:null,this.resolve=J,this.reject=ie,this.psd=de}function ye(A,F){var J,ie;fe.push(F),A._state===null&&(J=A._lib&&G(),F=Oe(F),A._state=!1,A._value=F,ie=A,Z.some(function(de){return de._value===ie._value})||Z.push(ie),we(A),J&&U())}function we(A){var F=A._listeners;A._listeners=[];for(var J=0,ie=F.length;J<ie;++J)Ue(A,F[J]);var de=A._PSD;--de.ref||de.finalize(),mt===0&&(++mt,Gt(function(){--mt==0&&X()},[]))}function Ue(A,F){if(A._state!==null){var J=A._state?F.onFulfilled:F.onRejected;if(J===null)return(A._state?F.resolve:F.reject)(A._value);++F.psd.ref,++mt,Gt(Et,[J,A,F])}else A._listeners.push(F)}function Et(A,F,J){try{var ie,de=F._value;!F._state&&fe.length&&(fe=[]),ie=Fe&&F._consoleTask?F._consoleTask.run(function(){return A(de)}):A(de),F._state||fe.indexOf(de)!==-1||function(_e){for(var De=Z.length;De;)if(Z[--De]._value===_e._value)return Z.splice(De,1)}(F),J.resolve(ie)}catch(_e){J.reject(_e)}finally{--mt==0&&X(),--J.psd.ref||J.psd.finalize()}}function he(){Zo(ve,function(){G()&&U()})}function G(){var A=be;return O=be=!1,A}function U(){var A,F,J;do for(;0<ue.length;)for(A=ue,ue=[],J=A.length,F=0;F<J;++F){var ie=A[F];ie[0].apply(null,ie[1])}while(0<ue.length);O=be=!0}function X(){var A=Z;Z=[],A.forEach(function(ie){ie._PSD.onunhandled.call(null,ie._value,ie)});for(var F=wt.slice(0),J=F.length;J;)F[--J]()}function pe(A){return new B(Xe,!1,A)}function je(A,F){var J=Ae;return function(){var ie=G(),de=Ae;try{return Gn(J,!0),A.apply(this,arguments)}catch(_e){F&&F(_e)}finally{Gn(de,!1),ie&&U()}}}m(B.prototype,{then:ze,_then:function(A,F){Ue(this,new rt(null,null,A,F,Ae))},catch:function(A){if(arguments.length===1)return this.then(null,A);var F=A,J=arguments[1];return typeof F=="function"?this.then(null,function(ie){return(ie instanceof F?J:pe)(ie)}):this.then(null,function(ie){return(ie&&ie.name===F?J:pe)(ie)})},finally:function(A){return this.then(function(F){return B.resolve(A()).then(function(){return F})},function(F){return B.resolve(A()).then(function(){return pe(F)})})},timeout:function(A,F){var J=this;return A<1/0?new B(function(ie,de){var _e=setTimeout(function(){return de(new Ce.Timeout(F))},A);J.then(ie,de).finally(clearTimeout.bind(null,_e))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&v(B.prototype,Symbol.toStringTag,"Dexie.Promise"),ve.env=Mi(),m(B,{all:function(){var A=Y.apply(null,arguments).map(jr);return new B(function(F,J){A.length===0&&F([]);var ie=A.length;A.forEach(function(de,_e){return B.resolve(de).then(function(De){A[_e]=De,--ie||F(A)},J)})})},resolve:function(A){return A instanceof B?A:A&&typeof A.then=="function"?new B(function(F,J){A.then(F,J)}):new B(Xe,!0,A)},reject:pe,race:function(){var A=Y.apply(null,arguments).map(jr);return new B(function(F,J){A.map(function(ie){return B.resolve(ie).then(F,J)})})},PSD:{get:function(){return Ae},set:function(A){return Ae=A}},totalEchoes:{get:function(){return Ht}},newPSD:an,usePSD:Zo,scheduler:{get:function(){return Gt},set:function(A){Gt=A}},rejectionMapper:{get:function(){return Oe},set:function(A){Oe=A}},follow:function(A,F){return new B(function(J,ie){return an(function(de,_e){var De=Ae;De.unhandleds=[],De.onunhandled=_e,De.finalize=me(function(){var $e,Ye=this;$e=function(){Ye.unhandleds.length===0?de():_e(Ye.unhandleds[0])},wt.push(function Qe(){$e(),wt.splice(wt.indexOf(Qe),1)}),++mt,Gt(function(){--mt==0&&X()},[])},De.finalize),A()},F,J,ie)})}}),Vt&&(Vt.allSettled&&v(B,"allSettled",function(){var A=Y.apply(null,arguments).map(jr);return new B(function(F){A.length===0&&F([]);var J=A.length,ie=new Array(J);A.forEach(function(de,_e){return B.resolve(de).then(function(De){return ie[_e]={status:"fulfilled",value:De}},function(De){return ie[_e]={status:"rejected",reason:De}}).then(function(){return--J||F(ie)})})})}),Vt.any&&typeof AggregateError<"u"&&v(B,"any",function(){var A=Y.apply(null,arguments).map(jr);return new B(function(F,J){A.length===0&&J(new AggregateError([]));var ie=A.length,de=new Array(ie);A.forEach(function(_e,De){return B.resolve(_e).then(function($e){return F($e)},function($e){de[De]=$e,--ie||J(new AggregateError(de))})})})}),Vt.withResolvers&&(B.withResolvers=Vt.withResolvers));var Ke={awaits:0,echoes:0,id:0},bt=0,Kt=[],yn=0,Ht=0,Yt=0;function an(A,F,J,ie){var de=Ae,_e=Object.create(de);return _e.parent=de,_e.ref=0,_e.global=!1,_e.id=++Yt,ve.env,_e.env=Ot?{Promise:B,PromiseProp:{value:B,configurable:!0,writable:!0},all:B.all,race:B.race,allSettled:B.allSettled,any:B.any,resolve:B.resolve,reject:B.reject}:{},F&&l(_e,F),++de.ref,_e.finalize=function(){--this.parent.ref||this.parent.finalize()},ie=Zo(_e,A,J,ie),_e.ref===0&&_e.finalize(),ie}function qn(){return Ke.id||(Ke.id=++bt),++Ke.awaits,Ke.echoes+=St,Ke.id}function Qn(){return!!Ke.awaits&&(--Ke.awaits==0&&(Ke.id=0),Ke.echoes=Ke.awaits*St,!0)}function jr(A){return Ke.echoes&&A&&A.constructor===Vt?(qn(),A.then(function(F){return Qn(),F},function(F){return Qn(),rs(F)})):A}function Mr(){var A=Kt[Kt.length-1];Kt.pop(),Gn(A,!1)}function Gn(A,F){var J,ie=Ae;(F?!Ke.echoes||yn++&&A===Ae:!yn||--yn&&A===Ae)||queueMicrotask(F?(function(de){++Ht,Ke.echoes&&--Ke.echoes!=0||(Ke.echoes=Ke.awaits=Ke.id=0),Kt.push(Ae),Gn(de,!0)}).bind(null,A):Mr),A!==Ae&&(Ae=A,ie===ve&&(ve.env=Mi()),Ot&&(J=ve.env.Promise,F=A.env,(ie.global||A.global)&&(Object.defineProperty(i,"Promise",F.PromiseProp),J.all=F.all,J.race=F.race,J.resolve=F.resolve,J.reject=F.reject,F.allSettled&&(J.allSettled=F.allSettled),F.any&&(J.any=F.any))))}function Mi(){var A=i.Promise;return Ot?{Promise:A,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:A.all,race:A.race,allSettled:A.allSettled,any:A.any,resolve:A.resolve,reject:A.reject}:{}}function Zo(A,F,J,ie,de){var _e=Ae;try{return Gn(A,!0),F(J,ie,de)}finally{Gn(_e,!1)}}function Yo(A,F,J,ie){return typeof A!="function"?A:function(){var de=Ae;J&&qn(),Gn(F,!0);try{return A.apply(this,arguments)}finally{Gn(de,!1),ie&&queueMicrotask(Qn)}}}function Xo(A){Promise===Vt&&Ke.echoes===0?yn===0?A():enqueueNativeMicroTask(A):setTimeout(A,0)}(""+Di).indexOf("[native code]")===-1&&(qn=Qn=Ge);var rs=B.reject,Jo="",Pa="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Vb="String expected.",mo=[],Ul="__dbnames",pa="readonly",Nd="readwrite";function Qo(A,F){return A?F?function(){return A.apply(this,arguments)&&F.apply(this,arguments)}:A:F}var ql={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Hc(A){return typeof A!="string"||/\./.test(A)?function(F){return F}:function(F){return F[A]===void 0&&A in F&&delete(F=V(F))[A],F}}function rh(){throw Ce.Type()}function er(A,F){try{var J=Bm(A),ie=Bm(F);if(J!==ie)return J==="Array"?1:ie==="Array"?-1:J==="binary"?1:ie==="binary"?-1:J==="string"?1:ie==="string"?-1:J==="Date"?1:ie!=="Date"?NaN:-1;switch(J){case"number":case"Date":case"string":return F<A?1:A<F?-1:0;case"binary":return function(de,_e){for(var De=de.length,$e=_e.length,Ye=De<$e?De:$e,Qe=0;Qe<Ye;++Qe)if(de[Qe]!==_e[Qe])return de[Qe]<_e[Qe]?-1:1;return De===$e?0:De<$e?-1:1}(Oi(A),Oi(F));case"Array":return function(de,_e){for(var De=de.length,$e=_e.length,Ye=De<$e?De:$e,Qe=0;Qe<Ye;++Qe){var st=er(de[Qe],_e[Qe]);if(st!==0)return st}return De===$e?0:De<$e?-1:1}(A,F)}}catch{}return NaN}function Bm(A){var F=typeof A;return F!="object"?F:ArrayBuffer.isView(A)?"binary":(A=re(A),A==="ArrayBuffer"?"binary":A)}function Oi(A){return A instanceof Uint8Array?A:ArrayBuffer.isView(A)?new Uint8Array(A.buffer,A.byteOffset,A.byteLength):new Uint8Array(A)}var $m=($r.prototype._trans=function(A,F,J){var ie=this._tx||Ae.trans,de=this.name,_e=Fe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(A==="readonly"?"read":"write"," ").concat(this.name));function De(Qe,st,We){if(!We.schema[de])throw new Ce.NotFound("Table "+de+" not part of transaction");return F(We.idbtrans,We)}var $e=G();try{var Ye=ie&&ie.db._novip===this.db._novip?ie===Ae.trans?ie._promise(A,De,J):an(function(){return ie._promise(A,De,J)},{trans:ie,transless:Ae.transless||Ae}):function Qe(st,We,ot,Ze){if(st.idbdb&&(st._state.openComplete||Ae.letThrough||st._vip)){var nt=st._createTransaction(We,ot,st._dbSchema);try{nt.create(),st._state.PR1398_maxLoop=3}catch(lt){return lt.name===Pe.InvalidState&&st.isOpen()&&0<--st._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),st.close({disableAutoOpen:!1}),st.open().then(function(){return Qe(st,We,ot,Ze)})):rs(lt)}return nt._promise(We,function(lt,et){return an(function(){return Ae.trans=nt,Ze(lt,et,nt)})}).then(function(lt){if(We==="readwrite")try{nt.idbtrans.commit()}catch{}return We==="readonly"?lt:nt._completion.then(function(){return lt})})}if(st._state.openComplete)return rs(new Ce.DatabaseClosed(st._state.dbOpenError));if(!st._state.isBeingOpened){if(!st._state.autoOpen)return rs(new Ce.DatabaseClosed);st.open().catch(Ge)}return st._state.dbReadyPromise.then(function(){return Qe(st,We,ot,Ze)})}(this.db,A,[this.name],De);return _e&&(Ye._consoleTask=_e,Ye=Ye.catch(function(Qe){return console.trace(Qe),rs(Qe)})),Ye}finally{$e&&U()}},$r.prototype.get=function(A,F){var J=this;return A&&A.constructor===Object?this.where(A).first(F):A==null?rs(new Ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(ie){return J.core.get({trans:ie,key:A}).then(function(de){return J.hook.reading.fire(de)})}).then(F)},$r.prototype.where=function(A){if(typeof A=="string")return new this.db.WhereClause(this,A);if(o(A))return new this.db.WhereClause(this,"[".concat(A.join("+"),"]"));var F=a(A);if(F.length===1)return this.where(F[0]).equals(A[F[0]]);var J=this.schema.indexes.concat(this.schema.primKey).filter(function($e){if($e.compound&&F.every(function(Qe){return 0<=$e.keyPath.indexOf(Qe)})){for(var Ye=0;Ye<F.length;++Ye)if(F.indexOf($e.keyPath[Ye])===-1)return!1;return!0}return!1}).sort(function($e,Ye){return $e.keyPath.length-Ye.keyPath.length})[0];if(J&&this.db._maxKey!==Jo){var _e=J.keyPath.slice(0,F.length);return this.where(_e).equals(_e.map(function(Ye){return A[Ye]}))}!J&&Fe&&console.warn("The query ".concat(JSON.stringify(A)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(F.join("+"),"]"));var ie=this.schema.idxByName;function de($e,Ye){return er($e,Ye)===0}var De=F.reduce(function(We,Ye){var Qe=We[0],st=We[1],We=ie[Ye],ot=A[Ye];return[Qe||We,Qe||!We?Qo(st,We&&We.multi?function(Ze){return Ze=R(Ze,Ye),o(Ze)&&Ze.some(function(nt){return de(ot,nt)})}:function(Ze){return de(ot,R(Ze,Ye))}):st]},[null,null]),_e=De[0],De=De[1];return _e?this.where(_e.name).equals(A[_e.keyPath]).filter(De):J?this.filter(De):this.where(F).equals("")},$r.prototype.filter=function(A){return this.toCollection().and(A)},$r.prototype.count=function(A){return this.toCollection().count(A)},$r.prototype.offset=function(A){return this.toCollection().offset(A)},$r.prototype.limit=function(A){return this.toCollection().limit(A)},$r.prototype.each=function(A){return this.toCollection().each(A)},$r.prototype.toArray=function(A){return this.toCollection().toArray(A)},$r.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},$r.prototype.orderBy=function(A){return new this.db.Collection(new this.db.WhereClause(this,o(A)?"[".concat(A.join("+"),"]"):A))},$r.prototype.reverse=function(){return this.toCollection().reverse()},$r.prototype.mapToClass=function(A){var F,J=this.db,ie=this.name;function de(){return F!==null&&F.apply(this,arguments)||this}(this.schema.mappedClass=A).prototype instanceof rh&&(function(Ye,Qe){if(typeof Qe!="function"&&Qe!==null)throw new TypeError("Class extends value "+String(Qe)+" is not a constructor or null");function st(){this.constructor=Ye}n(Ye,Qe),Ye.prototype=Qe===null?Object.create(Qe):(st.prototype=Qe.prototype,new st)}(de,F=A),Object.defineProperty(de.prototype,"db",{get:function(){return J},enumerable:!1,configurable:!0}),de.prototype.table=function(){return ie},A=de);for(var _e=new Set,De=A.prototype;De;De=c(De))Object.getOwnPropertyNames(De).forEach(function(Ye){return _e.add(Ye)});function $e(Ye){if(!Ye)return Ye;var Qe,st=Object.create(A.prototype);for(Qe in Ye)if(!_e.has(Qe))try{st[Qe]=Ye[Qe]}catch{}return st}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=$e,this.hook("reading",$e),A},$r.prototype.defineClass=function(){return this.mapToClass(function(A){l(this,A)})},$r.prototype.add=function(A,F){var J=this,ie=this.schema.primKey,de=ie.auto,_e=ie.keyPath,De=A;return _e&&de&&(De=Hc(_e)(A)),this._trans("readwrite",function($e){return J.core.mutate({trans:$e,type:"add",keys:F!=null?[F]:null,values:[De]})}).then(function($e){return $e.numFailures?B.reject($e.failures[0]):$e.lastResult}).then(function($e){if(_e)try{I(A,_e,$e)}catch{}return $e})},$r.prototype.update=function(A,F){return typeof A!="object"||o(A)?this.where(":id").equals(A).modify(F):(A=R(A,this.schema.primKey.keyPath),A===void 0?rs(new Ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(A).modify(F))},$r.prototype.put=function(A,F){var J=this,ie=this.schema.primKey,de=ie.auto,_e=ie.keyPath,De=A;return _e&&de&&(De=Hc(_e)(A)),this._trans("readwrite",function($e){return J.core.mutate({trans:$e,type:"put",values:[De],keys:F!=null?[F]:null})}).then(function($e){return $e.numFailures?B.reject($e.failures[0]):$e.lastResult}).then(function($e){if(_e)try{I(A,_e,$e)}catch{}return $e})},$r.prototype.delete=function(A){var F=this;return this._trans("readwrite",function(J){return F.core.mutate({trans:J,type:"delete",keys:[A]})}).then(function(J){return J.numFailures?B.reject(J.failures[0]):void 0})},$r.prototype.clear=function(){var A=this;return this._trans("readwrite",function(F){return A.core.mutate({trans:F,type:"deleteRange",range:ql})}).then(function(F){return F.numFailures?B.reject(F.failures[0]):void 0})},$r.prototype.bulkGet=function(A){var F=this;return this._trans("readonly",function(J){return F.core.getMany({keys:A,trans:J}).then(function(ie){return ie.map(function(de){return F.hook.reading.fire(de)})})})},$r.prototype.bulkAdd=function(A,F,J){var ie=this,de=Array.isArray(F)?F:void 0,_e=(J=J||(de?void 0:F))?J.allKeys:void 0;return this._trans("readwrite",function(De){var Qe=ie.schema.primKey,$e=Qe.auto,Qe=Qe.keyPath;if(Qe&&de)throw new Ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(de&&de.length!==A.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var Ye=A.length,Qe=Qe&&$e?A.map(Hc(Qe)):A;return ie.core.mutate({trans:De,type:"add",keys:de,values:Qe,wantResults:_e}).then(function(nt){var We=nt.numFailures,ot=nt.results,Ze=nt.lastResult,nt=nt.failures;if(We===0)return _e?ot:Ze;throw new Me("".concat(ie.name,".bulkAdd(): ").concat(We," of ").concat(Ye," operations failed"),nt)})})},$r.prototype.bulkPut=function(A,F,J){var ie=this,de=Array.isArray(F)?F:void 0,_e=(J=J||(de?void 0:F))?J.allKeys:void 0;return this._trans("readwrite",function(De){var Qe=ie.schema.primKey,$e=Qe.auto,Qe=Qe.keyPath;if(Qe&&de)throw new Ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(de&&de.length!==A.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var Ye=A.length,Qe=Qe&&$e?A.map(Hc(Qe)):A;return ie.core.mutate({trans:De,type:"put",keys:de,values:Qe,wantResults:_e}).then(function(nt){var We=nt.numFailures,ot=nt.results,Ze=nt.lastResult,nt=nt.failures;if(We===0)return _e?ot:Ze;throw new Me("".concat(ie.name,".bulkPut(): ").concat(We," of ").concat(Ye," operations failed"),nt)})})},$r.prototype.bulkUpdate=function(A){var F=this,J=this.core,ie=A.map(function(De){return De.key}),de=A.map(function(De){return De.changes}),_e=[];return this._trans("readwrite",function(De){return J.getMany({trans:De,keys:ie,cache:"clone"}).then(function($e){var Ye=[],Qe=[];A.forEach(function(We,ot){var Ze=We.key,nt=We.changes,lt=$e[ot];if(lt){for(var et=0,gt=Object.keys(nt);et<gt.length;et++){var xt=gt[et],_t=nt[xt];if(xt===F.schema.primKey.keyPath){if(er(_t,Ze)!==0)throw new Ce.Constraint("Cannot update primary key in bulkUpdate()")}else I(lt,xt,_t)}_e.push(ot),Ye.push(Ze),Qe.push(lt)}});var st=Ye.length;return J.mutate({trans:De,type:"put",keys:Ye,values:Qe,updates:{keys:ie,changeSpecs:de}}).then(function(We){var ot=We.numFailures,Ze=We.failures;if(ot===0)return st;for(var nt=0,lt=Object.keys(Ze);nt<lt.length;nt++){var et,gt=lt[nt],xt=_e[Number(gt)];xt!=null&&(et=Ze[gt],delete Ze[gt],Ze[xt]=et)}throw new Me("".concat(F.name,".bulkUpdate(): ").concat(ot," of ").concat(st," operations failed"),Ze)})})})},$r.prototype.bulkDelete=function(A){var F=this,J=A.length;return this._trans("readwrite",function(ie){return F.core.mutate({trans:ie,type:"delete",keys:A})}).then(function(De){var de=De.numFailures,_e=De.lastResult,De=De.failures;if(de===0)return _e;throw new Me("".concat(F.name,".bulkDelete(): ").concat(de," of ").concat(J," operations failed"),De)})},$r);function $r(){}function el(A){function F(De,$e){if($e){for(var Ye=arguments.length,Qe=new Array(Ye-1);--Ye;)Qe[Ye-1]=arguments[Ye];return J[De].subscribe.apply(null,Qe),A}if(typeof De=="string")return J[De]}var J={};F.addEventType=_e;for(var ie=1,de=arguments.length;ie<de;++ie)_e(arguments[ie]);return F;function _e(De,$e,Ye){if(typeof De!="object"){var Qe;$e=$e||ne;var st={subscribers:[],fire:Ye=Ye||Ge,subscribe:function(We){st.subscribers.indexOf(We)===-1&&(st.subscribers.push(We),st.fire=$e(st.fire,We))},unsubscribe:function(We){st.subscribers=st.subscribers.filter(function(ot){return ot!==We}),st.fire=st.subscribers.reduce($e,Ye)}};return J[De]=F[De]=st}a(Qe=De).forEach(function(We){var ot=Qe[We];if(o(ot))_e(We,Qe[We][0],Qe[We][1]);else{if(ot!=="asap")throw new Ce.InvalidArgument("Invalid event config");var Ze=_e(We,Re,function(){for(var nt=arguments.length,lt=new Array(nt);nt--;)lt[nt]=arguments[nt];Ze.subscribers.forEach(function(et){k(function(){et.apply(null,lt)})})})}})}}function Gc(A,F){return b(F).from({prototype:A}),F}function go(A,F){return!(A.filter||A.algorithm||A.or)&&(F?A.justLimit:!A.replayFilter)}function zm(A,F){A.filter=Qo(A.filter,F)}function gi(A,F,J){var ie=A.replayFilter;A.replayFilter=ie?function(){return Qo(ie(),F())}:F,A.justLimit=J&&!ie}function Kc(A,F){if(A.isPrimKey)return F.primaryKey;var J=F.getIndexByKeyPath(A.index);if(!J)throw new Ce.Schema("KeyPath "+A.index+" on object store "+F.name+" is not indexed");return J}function Um(A,F,J){var ie=Kc(A,F.schema);return F.openCursor({trans:J,values:!A.keysOnly,reverse:A.dir==="prev",unique:!!A.unique,query:{index:ie,range:A.range}})}function Wc(A,F,J,ie){var de=A.replayFilter?Qo(A.filter,A.replayFilter()):A.filter;if(A.or){var _e={},De=function($e,Ye,Qe){var st,We;de&&!de(Ye,Qe,function(ot){return Ye.stop(ot)},function(ot){return Ye.fail(ot)})||((We=""+(st=Ye.primaryKey))=="[object ArrayBuffer]"&&(We=""+new Uint8Array(st)),f(_e,We)||(_e[We]=!0,F($e,Ye,Qe)))};return Promise.all([A.or._iterate(De,J),Vl(Um(A,ie,J),A.algorithm,De,!A.keysOnly&&A.valueMapper)])}return Vl(Um(A,ie,J),Qo(A.algorithm,de),F,!A.keysOnly&&A.valueMapper)}function Vl(A,F,J,ie){var de=je(ie?function(_e,De,$e){return J(ie(_e),De,$e)}:J);return A.then(function(_e){if(_e)return _e.start(function(){var De=function(){return _e.continue()};F&&!F(_e,function($e){return De=$e},function($e){_e.stop($e),De=Ge},function($e){_e.fail($e),De=Ge})||de(_e.value,_e,function($e){return De=$e}),De()})})}var Zc=(qm.prototype.execute=function(A){var F=this["@@propmod"];if(F.add!==void 0){var J=F.add;if(o(J))return s(s([],o(A)?A:[],!0),J).sort();if(typeof J=="number")return(Number(A)||0)+J;if(typeof J=="bigint")try{return BigInt(A)+J}catch{return BigInt(0)+J}throw new TypeError("Invalid term ".concat(J))}if(F.remove!==void 0){var ie=F.remove;if(o(ie))return o(A)?A.filter(function(de){return!ie.includes(de)}).sort():[];if(typeof ie=="number")return Number(A)-ie;if(typeof ie=="bigint")try{return BigInt(A)-ie}catch{return BigInt(0)-ie}throw new TypeError("Invalid subtrahend ".concat(ie))}return J=(J=F.replacePrefix)===null||J===void 0?void 0:J[0],J&&typeof A=="string"&&A.startsWith(J)?F.replacePrefix[1]+A.substring(J.length):A},qm);function qm(A){this["@@propmod"]=A}var Yc=(fr.prototype._read=function(A,F){var J=this._ctx;return J.error?J.table._trans(null,rs.bind(null,J.error)):J.table._trans("readonly",A).then(F)},fr.prototype._write=function(A){var F=this._ctx;return F.error?F.table._trans(null,rs.bind(null,F.error)):F.table._trans("readwrite",A,"locked")},fr.prototype._addAlgorithm=function(A){var F=this._ctx;F.algorithm=Qo(F.algorithm,A)},fr.prototype._iterate=function(A,F){return Wc(this._ctx,A,F,this._ctx.table.core)},fr.prototype.clone=function(A){var F=Object.create(this.constructor.prototype),J=Object.create(this._ctx);return A&&l(J,A),F._ctx=J,F},fr.prototype.raw=function(){return this._ctx.valueMapper=null,this},fr.prototype.each=function(A){var F=this._ctx;return this._read(function(J){return Wc(F,A,J,F.table.core)})},fr.prototype.count=function(A){var F=this;return this._read(function(J){var ie=F._ctx,de=ie.table.core;if(go(ie,!0))return de.count({trans:J,query:{index:Kc(ie,de.schema),range:ie.range}}).then(function(De){return Math.min(De,ie.limit)});var _e=0;return Wc(ie,function(){return++_e,!1},J,de).then(function(){return _e})}).then(A)},fr.prototype.sortBy=function(A,F){var J=A.split(".").reverse(),ie=J[0],de=J.length-1;function _e(Ye,Qe){return Qe?_e(Ye[J[Qe]],Qe-1):Ye[ie]}var De=this._ctx.dir==="next"?1:-1;function $e(Ye,Qe){return er(_e(Ye,de),_e(Qe,de))*De}return this.toArray(function(Ye){return Ye.sort($e)}).then(F)},fr.prototype.toArray=function(A){var F=this;return this._read(function(J){var ie=F._ctx;if(ie.dir==="next"&&go(ie,!0)&&0<ie.limit){var de=ie.valueMapper,_e=Kc(ie,ie.table.core.schema);return ie.table.core.query({trans:J,limit:ie.limit,values:!0,query:{index:_e,range:ie.range}}).then(function($e){return $e=$e.result,de?$e.map(de):$e})}var De=[];return Wc(ie,function($e){return De.push($e)},J,ie.table.core).then(function(){return De})},A)},fr.prototype.offset=function(A){var F=this._ctx;return A<=0||(F.offset+=A,go(F)?gi(F,function(){var J=A;return function(ie,de){return J===0||(J===1?--J:de(function(){ie.advance(J),J=0}),!1)}}):gi(F,function(){var J=A;return function(){return--J<0}})),this},fr.prototype.limit=function(A){return this._ctx.limit=Math.min(this._ctx.limit,A),gi(this._ctx,function(){var F=A;return function(J,ie,de){return--F<=0&&ie(de),0<=F}},!0),this},fr.prototype.until=function(A,F){return zm(this._ctx,function(J,ie,de){return!A(J.value)||(ie(de),F)}),this},fr.prototype.first=function(A){return this.limit(1).toArray(function(F){return F[0]}).then(A)},fr.prototype.last=function(A){return this.reverse().first(A)},fr.prototype.filter=function(A){var F;return zm(this._ctx,function(J){return A(J.value)}),(F=this._ctx).isMatch=Qo(F.isMatch,A),this},fr.prototype.and=function(A){return this.filter(A)},fr.prototype.or=function(A){return new this.db.WhereClause(this._ctx.table,A,this)},fr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},fr.prototype.desc=function(){return this.reverse()},fr.prototype.eachKey=function(A){var F=this._ctx;return F.keysOnly=!F.isMatch,this.each(function(J,ie){A(ie.key,ie)})},fr.prototype.eachUniqueKey=function(A){return this._ctx.unique="unique",this.eachKey(A)},fr.prototype.eachPrimaryKey=function(A){var F=this._ctx;return F.keysOnly=!F.isMatch,this.each(function(J,ie){A(ie.primaryKey,ie)})},fr.prototype.keys=function(A){var F=this._ctx;F.keysOnly=!F.isMatch;var J=[];return this.each(function(ie,de){J.push(de.key)}).then(function(){return J}).then(A)},fr.prototype.primaryKeys=function(A){var F=this._ctx;if(F.dir==="next"&&go(F,!0)&&0<F.limit)return this._read(function(ie){var de=Kc(F,F.table.core.schema);return F.table.core.query({trans:ie,values:!1,limit:F.limit,query:{index:de,range:F.range}})}).then(function(ie){return ie.result}).then(A);F.keysOnly=!F.isMatch;var J=[];return this.each(function(ie,de){J.push(de.primaryKey)}).then(function(){return J}).then(A)},fr.prototype.uniqueKeys=function(A){return this._ctx.unique="unique",this.keys(A)},fr.prototype.firstKey=function(A){return this.limit(1).keys(function(F){return F[0]}).then(A)},fr.prototype.lastKey=function(A){return this.reverse().firstKey(A)},fr.prototype.distinct=function(){var A=this._ctx,A=A.index&&A.table.schema.idxByName[A.index];if(!A||!A.multi)return this;var F={};return zm(this._ctx,function(de){var ie=de.primaryKey.toString(),de=f(F,ie);return F[ie]=!0,!de}),this},fr.prototype.modify=function(A){var F=this,J=this._ctx;return this._write(function(ie){var de,_e,De;De=typeof A=="function"?A:(de=a(A),_e=de.length,function(et){for(var gt=!1,xt=0;xt<_e;++xt){var _t=de[xt],kt=A[_t],Bt=R(et,_t);kt instanceof Zc?(I(et,_t,kt.execute(Bt)),gt=!0):Bt!==kt&&(I(et,_t,kt),gt=!0)}return gt});var $e=J.table.core,We=$e.schema.primaryKey,Ye=We.outbound,Qe=We.extractKey,st=200,We=F.db._options.modifyChunkSize;We&&(st=typeof We=="object"?We[$e.name]||We["*"]||200:We);function ot(et,_t){var xt=_t.failures,_t=_t.numFailures;nt+=et-_t;for(var kt=0,Bt=a(xt);kt<Bt.length;kt++){var Wt=Bt[kt];Ze.push(xt[Wt])}}var Ze=[],nt=0,lt=[];return F.clone().primaryKeys().then(function(et){function gt(_t){var kt=Math.min(st,et.length-_t);return $e.getMany({trans:ie,keys:et.slice(_t,_t+kt),cache:"immutable"}).then(function(Bt){for(var Wt=[],Dt=[],qt=Ye?[]:null,Zt=[],Ft=0;Ft<kt;++Ft){var nn=Bt[Ft],pn={value:V(nn),primKey:et[_t+Ft]};De.call(pn,pn.value,pn)!==!1&&(pn.value==null?Zt.push(et[_t+Ft]):Ye||er(Qe(nn),Qe(pn.value))===0?(Dt.push(pn.value),Ye&&qt.push(et[_t+Ft])):(Zt.push(et[_t+Ft]),Wt.push(pn.value)))}return Promise.resolve(0<Wt.length&&$e.mutate({trans:ie,type:"add",values:Wt}).then(function(bn){for(var jn in bn.failures)Zt.splice(parseInt(jn),1);ot(Wt.length,bn)})).then(function(){return(0<Dt.length||xt&&typeof A=="object")&&$e.mutate({trans:ie,type:"put",keys:qt,values:Dt,criteria:xt,changeSpec:typeof A!="function"&&A,isAdditionalChunk:0<_t}).then(function(bn){return ot(Dt.length,bn)})}).then(function(){return(0<Zt.length||xt&&A===sh)&&$e.mutate({trans:ie,type:"delete",keys:Zt,criteria:xt,isAdditionalChunk:0<_t}).then(function(bn){return ot(Zt.length,bn)})}).then(function(){return et.length>_t+kt&&gt(_t+st)})})}var xt=go(J)&&J.limit===1/0&&(typeof A!="function"||A===sh)&&{index:J.index,range:J.range};return gt(0).then(function(){if(0<Ze.length)throw new ge("Error modifying one or more objects",Ze,nt,lt);return et.length})})})},fr.prototype.delete=function(){var A=this._ctx,F=A.range;return go(A)&&(A.isPrimKey||F.type===3)?this._write(function(J){var ie=A.table.core.schema.primaryKey,de=F;return A.table.core.count({trans:J,query:{index:ie,range:de}}).then(function(_e){return A.table.core.mutate({trans:J,type:"deleteRange",range:de}).then(function(De){var $e=De.failures;if(De.lastResult,De.results,De=De.numFailures,De)throw new ge("Could not delete some values",Object.keys($e).map(function(Ye){return $e[Ye]}),_e-De);return _e-De})})}):this.modify(sh)},fr);function fr(){}var sh=function(A,F){return F.value=null};function Hb(A,F){return A<F?-1:A===F?0:1}function Vm(A,F){return F<A?-1:A===F?0:1}function Pi(A,F,J){return A=A instanceof Gl?new A.Collection(A):A,A._ctx.error=new(J||TypeError)(F),A}function Xc(A){return new A.Collection(A,function(){return ih("")}).limit(0)}function Hl(A,F,J,ie){var de,_e,De,$e,Ye,Qe,st,We=J.length;if(!J.every(function(nt){return typeof nt=="string"}))return Pi(A,Vb);function ot(nt){de=nt==="next"?function(et){return et.toUpperCase()}:function(et){return et.toLowerCase()},_e=nt==="next"?function(et){return et.toLowerCase()}:function(et){return et.toUpperCase()},De=nt==="next"?Hb:Vm;var lt=J.map(function(et){return{lower:_e(et),upper:de(et)}}).sort(function(et,gt){return De(et.lower,gt.lower)});$e=lt.map(function(et){return et.upper}),Ye=lt.map(function(et){return et.lower}),st=(Qe=nt)==="next"?"":ie}ot("next"),A=new A.Collection(A,function(){return Da($e[0],Ye[We-1]+ie)}),A._ondirectionchange=function(nt){ot(nt)};var Ze=0;return A._addAlgorithm(function(nt,lt,et){var gt=nt.key;if(typeof gt!="string")return!1;var xt=_e(gt);if(F(xt,Ye,Ze))return!0;for(var _t=null,kt=Ze;kt<We;++kt){var Bt=function(Wt,Dt,qt,Zt,Ft,nn){for(var pn=Math.min(Wt.length,Zt.length),bn=-1,jn=0;jn<pn;++jn){var ai=Dt[jn];if(ai!==Zt[jn])return Ft(Wt[jn],qt[jn])<0?Wt.substr(0,jn)+qt[jn]+qt.substr(jn+1):Ft(Wt[jn],Zt[jn])<0?Wt.substr(0,jn)+Zt[jn]+qt.substr(jn+1):0<=bn?Wt.substr(0,bn)+Dt[bn]+qt.substr(bn+1):null;Ft(Wt[jn],ai)<0&&(bn=jn)}return pn<Zt.length&&nn==="next"?Wt+qt.substr(Wt.length):pn<Wt.length&&nn==="prev"?Wt.substr(0,qt.length):bn<0?null:Wt.substr(0,bn)+Zt[bn]+qt.substr(bn+1)}(gt,xt,$e[kt],Ye[kt],De,Qe);Bt===null&&_t===null?Ze=kt+1:(_t===null||0<De(_t,Bt))&&(_t=Bt)}return lt(_t!==null?function(){nt.continue(_t+st)}:et),!1}),A}function Da(A,F,J,ie){return{type:2,lower:A,upper:F,lowerOpen:J,upperOpen:ie}}function ih(A){return{type:1,lower:A,upper:A}}var Gl=(Object.defineProperty(Wr.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Wr.prototype.between=function(A,F,J,ie){J=J!==!1,ie=ie===!0;try{return 0<this._cmp(A,F)||this._cmp(A,F)===0&&(J||ie)&&(!J||!ie)?Xc(this):new this.Collection(this,function(){return Da(A,F,!J,!ie)})}catch{return Pi(this,Pa)}},Wr.prototype.equals=function(A){return A==null?Pi(this,Pa):new this.Collection(this,function(){return ih(A)})},Wr.prototype.above=function(A){return A==null?Pi(this,Pa):new this.Collection(this,function(){return Da(A,void 0,!0)})},Wr.prototype.aboveOrEqual=function(A){return A==null?Pi(this,Pa):new this.Collection(this,function(){return Da(A,void 0,!1)})},Wr.prototype.below=function(A){return A==null?Pi(this,Pa):new this.Collection(this,function(){return Da(void 0,A,!1,!0)})},Wr.prototype.belowOrEqual=function(A){return A==null?Pi(this,Pa):new this.Collection(this,function(){return Da(void 0,A)})},Wr.prototype.startsWith=function(A){return typeof A!="string"?Pi(this,Vb):this.between(A,A+Jo,!0,!0)},Wr.prototype.startsWithIgnoreCase=function(A){return A===""?this.startsWith(A):Hl(this,function(F,J){return F.indexOf(J[0])===0},[A],Jo)},Wr.prototype.equalsIgnoreCase=function(A){return Hl(this,function(F,J){return F===J[0]},[A],"")},Wr.prototype.anyOfIgnoreCase=function(){var A=Y.apply(se,arguments);return A.length===0?Xc(this):Hl(this,function(F,J){return J.indexOf(F)!==-1},A,"")},Wr.prototype.startsWithAnyOfIgnoreCase=function(){var A=Y.apply(se,arguments);return A.length===0?Xc(this):Hl(this,function(F,J){return J.some(function(ie){return F.indexOf(ie)===0})},A,Jo)},Wr.prototype.anyOf=function(){var A=this,F=Y.apply(se,arguments),J=this._cmp;try{F.sort(J)}catch{return Pi(this,Pa)}if(F.length===0)return Xc(this);var ie=new this.Collection(this,function(){return Da(F[0],F[F.length-1])});ie._ondirectionchange=function(_e){J=_e==="next"?A._ascending:A._descending,F.sort(J)};var de=0;return ie._addAlgorithm(function(_e,De,$e){for(var Ye=_e.key;0<J(Ye,F[de]);)if(++de===F.length)return De($e),!1;return J(Ye,F[de])===0||(De(function(){_e.continue(F[de])}),!1)}),ie},Wr.prototype.notEqual=function(A){return this.inAnyRange([[-1/0,A],[A,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Wr.prototype.noneOf=function(){var A=Y.apply(se,arguments);if(A.length===0)return new this.Collection(this);try{A.sort(this._ascending)}catch{return Pi(this,Pa)}var F=A.reduce(function(J,ie){return J?J.concat([[J[J.length-1][1],ie]]):[[-1/0,ie]]},null);return F.push([A[A.length-1],this.db._maxKey]),this.inAnyRange(F,{includeLowers:!1,includeUppers:!1})},Wr.prototype.inAnyRange=function(gt,F){var J=this,ie=this._cmp,de=this._ascending,_e=this._descending,De=this._min,$e=this._max;if(gt.length===0)return Xc(this);if(!gt.every(function(xt){return xt[0]!==void 0&&xt[1]!==void 0&&de(xt[0],xt[1])<=0}))return Pi(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ce.InvalidArgument);var Ye=!F||F.includeLowers!==!1,Qe=F&&F.includeUppers===!0,st,We=de;function ot(xt,_t){return We(xt[0],_t[0])}try{(st=gt.reduce(function(xt,_t){for(var kt=0,Bt=xt.length;kt<Bt;++kt){var Wt=xt[kt];if(ie(_t[0],Wt[1])<0&&0<ie(_t[1],Wt[0])){Wt[0]=De(Wt[0],_t[0]),Wt[1]=$e(Wt[1],_t[1]);break}}return kt===Bt&&xt.push(_t),xt},[])).sort(ot)}catch{return Pi(this,Pa)}var Ze=0,nt=Qe?function(xt){return 0<de(xt,st[Ze][1])}:function(xt){return 0<=de(xt,st[Ze][1])},lt=Ye?function(xt){return 0<_e(xt,st[Ze][0])}:function(xt){return 0<=_e(xt,st[Ze][0])},et=nt,gt=new this.Collection(this,function(){return Da(st[0][0],st[st.length-1][1],!Ye,!Qe)});return gt._ondirectionchange=function(xt){We=xt==="next"?(et=nt,de):(et=lt,_e),st.sort(ot)},gt._addAlgorithm(function(xt,_t,kt){for(var Bt,Wt=xt.key;et(Wt);)if(++Ze===st.length)return _t(kt),!1;return!nt(Bt=Wt)&&!lt(Bt)||(J._cmp(Wt,st[Ze][1])===0||J._cmp(Wt,st[Ze][0])===0||_t(function(){We===de?xt.continue(st[Ze][0]):xt.continue(st[Ze][1])}),!1)}),gt},Wr.prototype.startsWithAnyOf=function(){var A=Y.apply(se,arguments);return A.every(function(F){return typeof F=="string"})?A.length===0?Xc(this):this.inAnyRange(A.map(function(F){return[F,F+Jo]})):Pi(this,"startsWithAnyOf() only works with strings")},Wr);function Wr(){}function ma(A){return je(function(F){return Kl(F),A(F.target.error),!1})}function Kl(A){A.stopPropagation&&A.stopPropagation(),A.preventDefault&&A.preventDefault()}var Jc="storagemutated",Wl="x-storagemutated-1",zs=el(null,Jc),Hm=(yi.prototype._lock=function(){return C(!Ae.global),++this._reculock,this._reculock!==1||Ae.global||(Ae.lockOwnerFor=this),this},yi.prototype._unlock=function(){if(C(!Ae.global),--this._reculock==0)for(Ae.global||(Ae.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var A=this._blockedFuncs.shift();try{Zo(A[1],A[0])}catch{}}return this},yi.prototype._locked=function(){return this._reculock&&Ae.lockOwnerFor!==this},yi.prototype.create=function(A){var F=this;if(!this.mode)return this;var J=this.db.idbdb,ie=this.db._state.dbOpenError;if(C(!this.idbtrans),!A&&!J)switch(ie&&ie.name){case"DatabaseClosedError":throw new Ce.DatabaseClosed(ie);case"MissingAPIError":throw new Ce.MissingAPI(ie.message,ie);default:throw new Ce.OpenFailed(ie)}if(!this.active)throw new Ce.TransactionInactive;return C(this._completion._state===null),(A=this.idbtrans=A||(this.db.core||J).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=je(function(de){Kl(de),F._reject(A.error)}),A.onabort=je(function(de){Kl(de),F.active&&F._reject(new Ce.Abort(A.error)),F.active=!1,F.on("abort").fire(de)}),A.oncomplete=je(function(){F.active=!1,F._resolve(),"mutatedParts"in A&&zs.storagemutated.fire(A.mutatedParts)}),this},yi.prototype._promise=function(A,F,J){var ie=this;if(A==="readwrite"&&this.mode!=="readwrite")return rs(new Ce.ReadOnly("Transaction is readonly"));if(!this.active)return rs(new Ce.TransactionInactive);if(this._locked())return new B(function(_e,De){ie._blockedFuncs.push([function(){ie._promise(A,F,J).then(_e,De)},Ae])});if(J)return an(function(){var _e=new B(function(De,$e){ie._lock();var Ye=F(De,$e,ie);Ye&&Ye.then&&Ye.then(De,$e)});return _e.finally(function(){return ie._unlock()}),_e._lib=!0,_e});var de=new B(function(_e,De){var $e=F(_e,De,ie);$e&&$e.then&&$e.then(_e,De)});return de._lib=!0,de},yi.prototype._root=function(){return this.parent?this.parent._root():this},yi.prototype.waitFor=function(A){var F,J=this._root(),ie=B.resolve(A);J._waitingFor?J._waitingFor=J._waitingFor.then(function(){return ie}):(J._waitingFor=ie,J._waitingQueue=[],F=J.idbtrans.objectStore(J.storeNames[0]),function _e(){for(++J._spinCount;J._waitingQueue.length;)J._waitingQueue.shift()();J._waitingFor&&(F.get(-1/0).onsuccess=_e)}());var de=J._waitingFor;return new B(function(_e,De){ie.then(function($e){return J._waitingQueue.push(je(_e.bind(null,$e)))},function($e){return J._waitingQueue.push(je(De.bind(null,$e)))}).finally(function(){J._waitingFor===de&&(J._waitingFor=null)})})},yi.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ce.Abort))},yi.prototype.table=function(A){var F=this._memoizedTables||(this._memoizedTables={});if(f(F,A))return F[A];var J=this.schema[A];if(!J)throw new Ce.NotFound("Table "+A+" not part of transaction");return J=new this.db.Table(A,J,this),J.core=this.db.core.table(A),F[A]=J},yi);function yi(){}function Fa(A,F,J,ie,de,_e,De){return{name:A,keyPath:F,unique:J,multi:ie,auto:de,compound:_e,src:(J&&!De?"&":"")+(ie?"*":"")+(de?"++":"")+ah(F)}}function ah(A){return typeof A=="string"?A:A?"["+[].join.call(A,"+")+"]":""}function Qc(A,F,J){return{name:A,primKey:F,indexes:J,mappedClass:null,idxByName:(ie=function(de){return[de.name,de]},J.reduce(function(de,_e,De){return De=ie(_e,De),De&&(de[De[0]]=De[1]),de},{}))};var ie}var eu=function(A){try{return A.only([[]]),eu=function(){return[[]]},[[]]}catch{return eu=function(){return Jo},Jo}};function tu(A){return A==null?function(){}:typeof A=="string"?(F=A).split(".").length===1?function(J){return J[F]}:function(J){return R(J,F)}:function(J){return R(J,A)};var F}function Id(A){return[].slice.call(A)}var Gb=0;function Cs(A){return A==null?":id":typeof A=="string"?A:"[".concat(A.join("+"),"]")}function Zl(A,F,Ye){function ie(et){if(et.type===3)return null;if(et.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Ze=et.lower,nt=et.upper,lt=et.lowerOpen,et=et.upperOpen;return Ze===void 0?nt===void 0?null:F.upperBound(nt,!!et):nt===void 0?F.lowerBound(Ze,!!lt):F.bound(Ze,nt,!!lt,!!et)}function de(ot){var Ze,nt=ot.name;return{name:nt,schema:ot,mutate:function(lt){var et=lt.trans,gt=lt.type,xt=lt.keys,_t=lt.values,kt=lt.range;return new Promise(function(Bt,Wt){Bt=je(Bt);var Dt=et.objectStore(nt),qt=Dt.keyPath==null,Zt=gt==="put"||gt==="add";if(!Zt&&gt!=="delete"&&gt!=="deleteRange")throw new Error("Invalid operation type: "+gt);var Ft,nn=(xt||_t||{length:1}).length;if(xt&&_t&&xt.length!==_t.length)throw new Error("Given keys array must have same length as given values array.");if(nn===0)return Bt({numFailures:0,failures:{},results:[],lastResult:void 0});function pn(qs){++ai,Kl(qs)}var bn=[],jn=[],ai=0;if(gt==="deleteRange"){if(kt.type===4)return Bt({numFailures:ai,failures:jn,results:[],lastResult:void 0});kt.type===3?bn.push(Ft=Dt.clear()):bn.push(Ft=Dt.delete(ie(kt)))}else{var qt=Zt?qt?[_t,xt]:[_t,null]:[xt,null],En=qt[0],ps=qt[1];if(Zt)for(var ks=0;ks<nn;++ks)bn.push(Ft=ps&&ps[ks]!==void 0?Dt[gt](En[ks],ps[ks]):Dt[gt](En[ks])),Ft.onerror=pn;else for(ks=0;ks<nn;++ks)bn.push(Ft=Dt[gt](En[ks])),Ft.onerror=pn}function yo(qs){qs=qs.target.result,bn.forEach(function(Ba,sl){return Ba.error!=null&&(jn[sl]=Ba.error)}),Bt({numFailures:ai,failures:jn,results:gt==="delete"?xt:bn.map(function(Ba){return Ba.result}),lastResult:qs})}Ft.onerror=function(qs){pn(qs),yo(qs)},Ft.onsuccess=yo})},getMany:function(lt){var et=lt.trans,gt=lt.keys;return new Promise(function(xt,_t){xt=je(xt);for(var kt,Bt=et.objectStore(nt),Wt=gt.length,Dt=new Array(Wt),qt=0,Zt=0,Ft=function(bn){bn=bn.target,Dt[bn._pos]=bn.result,++Zt===qt&&xt(Dt)},nn=ma(_t),pn=0;pn<Wt;++pn)gt[pn]!=null&&((kt=Bt.get(gt[pn]))._pos=pn,kt.onsuccess=Ft,kt.onerror=nn,++qt);qt===0&&xt(Dt)})},get:function(lt){var et=lt.trans,gt=lt.key;return new Promise(function(xt,_t){xt=je(xt);var kt=et.objectStore(nt).get(gt);kt.onsuccess=function(Bt){return xt(Bt.target.result)},kt.onerror=ma(_t)})},query:(Ze=Qe,function(lt){return new Promise(function(et,gt){et=je(et);var xt,_t,kt,qt=lt.trans,Bt=lt.values,Wt=lt.limit,Ft=lt.query,Dt=Wt===1/0?void 0:Wt,Zt=Ft.index,Ft=Ft.range,qt=qt.objectStore(nt),Zt=Zt.isPrimaryKey?qt:qt.index(Zt.name),Ft=ie(Ft);if(Wt===0)return et({result:[]});Ze?((Dt=Bt?Zt.getAll(Ft,Dt):Zt.getAllKeys(Ft,Dt)).onsuccess=function(nn){return et({result:nn.target.result})},Dt.onerror=ma(gt)):(xt=0,_t=!Bt&&"openKeyCursor"in Zt?Zt.openKeyCursor(Ft):Zt.openCursor(Ft),kt=[],_t.onsuccess=function(nn){var pn=_t.result;return pn?(kt.push(Bt?pn.value:pn.primaryKey),++xt===Wt?et({result:kt}):void pn.continue()):et({result:kt})},_t.onerror=ma(gt))})}),openCursor:function(lt){var et=lt.trans,gt=lt.values,xt=lt.query,_t=lt.reverse,kt=lt.unique;return new Promise(function(Bt,Wt){Bt=je(Bt);var Zt=xt.index,Dt=xt.range,qt=et.objectStore(nt),qt=Zt.isPrimaryKey?qt:qt.index(Zt.name),Zt=_t?kt?"prevunique":"prev":kt?"nextunique":"next",Ft=!gt&&"openKeyCursor"in qt?qt.openKeyCursor(ie(Dt),Zt):qt.openCursor(ie(Dt),Zt);Ft.onerror=ma(Wt),Ft.onsuccess=je(function(nn){var pn,bn,jn,ai,En=Ft.result;En?(En.___id=++Gb,En.done=!1,pn=En.continue.bind(En),bn=(bn=En.continuePrimaryKey)&&bn.bind(En),jn=En.advance.bind(En),ai=function(){throw new Error("Cursor not stopped")},En.trans=et,En.stop=En.continue=En.continuePrimaryKey=En.advance=function(){throw new Error("Cursor not started")},En.fail=je(Wt),En.next=function(){var ps=this,ks=1;return this.start(function(){return ks--?ps.continue():ps.stop()}).then(function(){return ps})},En.start=function(ps){function ks(){if(Ft.result)try{ps()}catch(qs){En.fail(qs)}else En.done=!0,En.start=function(){throw new Error("Cursor behind last entry")},En.stop()}var yo=new Promise(function(qs,Ba){qs=je(qs),Ft.onerror=ma(Ba),En.fail=Ba,En.stop=function(sl){En.stop=En.continue=En.continuePrimaryKey=En.advance=ai,qs(sl)}});return Ft.onsuccess=je(function(qs){Ft.onsuccess=ks,ks()}),En.continue=pn,En.continuePrimaryKey=bn,En.advance=jn,ks(),yo},Bt(En)):Bt(null)},Wt)})},count:function(lt){var et=lt.query,gt=lt.trans,xt=et.index,_t=et.range;return new Promise(function(kt,Bt){var Wt=gt.objectStore(nt),Dt=xt.isPrimaryKey?Wt:Wt.index(xt.name),Wt=ie(_t),Dt=Wt?Dt.count(Wt):Dt.count();Dt.onsuccess=je(function(qt){return kt(qt.target.result)}),Dt.onerror=ma(Bt)})}}}var _e,De,$e,st=(De=Ye,$e=Id((_e=A).objectStoreNames),{schema:{name:_e.name,tables:$e.map(function(ot){return De.objectStore(ot)}).map(function(ot){var Ze=ot.keyPath,et=ot.autoIncrement,nt=o(Ze),lt={},et={name:ot.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Ze==null,compound:nt,keyPath:Ze,autoIncrement:et,unique:!0,extractKey:tu(Ze)},indexes:Id(ot.indexNames).map(function(gt){return ot.index(gt)}).map(function(kt){var xt=kt.name,_t=kt.unique,Bt=kt.multiEntry,kt=kt.keyPath,Bt={name:xt,compound:o(kt),keyPath:kt,unique:_t,multiEntry:Bt,extractKey:tu(kt)};return lt[Cs(kt)]=Bt}),getIndexByKeyPath:function(gt){return lt[Cs(gt)]}};return lt[":id"]=et.primaryKey,Ze!=null&&(lt[Cs(Ze)]=et.primaryKey),et})},hasGetAll:0<$e.length&&"getAll"in De.objectStore($e[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),Ye=st.schema,Qe=st.hasGetAll,st=Ye.tables.map(de),We={};return st.forEach(function(ot){return We[ot.name]=ot}),{stack:"dbcore",transaction:A.transaction.bind(A),table:function(ot){if(!We[ot])throw new Error("Table '".concat(ot,"' not found"));return We[ot]},MIN_KEY:-1/0,MAX_KEY:eu(F),schema:Ye}}function oh(A,F,J,ie){var de=J.IDBKeyRange;return J.indexedDB,{dbcore:(ie=Zl(F,de,ie),A.dbcore.reduce(function(_e,De){return De=De.create,r(r({},_e),De(_e))},ie))}}function tl(A,ie){var J=ie.db,ie=oh(A._middlewares,J,A._deps,ie);A.core=ie.dbcore,A.tables.forEach(function(de){var _e=de.name;A.core.schema.tables.some(function(De){return De.name===_e})&&(de.core=A.core.table(_e),A[_e]instanceof A.Table&&(A[_e].core=de.core))})}function lh(A,F,J,ie){J.forEach(function(de){var _e=ie[de];F.forEach(function(De){var $e=function Ye(Qe,st){return w(Qe,st)||(Qe=c(Qe))&&Ye(Qe,st)}(De,de);(!$e||"value"in $e&&$e.value===void 0)&&(De===A.Transaction.prototype||De instanceof A.Transaction?v(De,de,{get:function(){return this.table(de)},set:function(Ye){g(this,de,{value:Ye,writable:!0,configurable:!0,enumerable:!0})}}):De[de]=new A.Table(de,_e))})})}function jd(A,F){F.forEach(function(J){for(var ie in J)J[ie]instanceof A.Table&&delete J[ie]})}function Gm(A,F){return A._cfg.version-F._cfg.version}function Md(A,F,J,ie){var de=A._dbSchema;J.objectStoreNames.contains("$meta")&&!de.$meta&&(de.$meta=Qc("$meta",Wb("")[0],[]),A._storeNames.push("$meta"));var _e=A._createTransaction("readwrite",A._storeNames,de);_e.create(J),_e._completion.catch(ie);var De=_e._reject.bind(_e),$e=Ae.transless||Ae;an(function(){return Ae.trans=_e,Ae.transless=$e,F!==0?(tl(A,J),Qe=F,((Ye=_e).storeNames.includes("$meta")?Ye.table("$meta").get("version").then(function(st){return st??Qe}):B.resolve(Qe)).then(function(st){return ot=st,Ze=_e,nt=J,lt=[],st=(We=A)._versions,et=We._dbSchema=nu(0,We.idbdb,nt),(st=st.filter(function(gt){return gt._cfg.version>=ot})).length!==0?(st.forEach(function(gt){lt.push(function(){var xt=et,_t=gt._cfg.dbschema;fh(We,xt,nt),fh(We,_t,nt),et=We._dbSchema=_t;var kt=uh(xt,_t);kt.add.forEach(function(Zt){Km(nt,Zt[0],Zt[1].primKey,Zt[1].indexes)}),kt.change.forEach(function(Zt){if(Zt.recreate)throw new Ce.Upgrade("Not yet support for changing primary key");var Ft=nt.objectStore(Zt.name);Zt.add.forEach(function(nn){return dh(Ft,nn)}),Zt.change.forEach(function(nn){Ft.deleteIndex(nn.name),dh(Ft,nn)}),Zt.del.forEach(function(nn){return Ft.deleteIndex(nn)})});var Bt=gt._cfg.contentUpgrade;if(Bt&&gt._cfg.version>ot){tl(We,nt),Ze._memoizedTables={};var Wt=j(_t);kt.del.forEach(function(Zt){Wt[Zt]=xt[Zt]}),jd(We,[We.Transaction.prototype]),lh(We,[We.Transaction.prototype],a(Wt),Wt),Ze.schema=Wt;var Dt,qt=te(Bt);return qt&&qn(),kt=B.follow(function(){var Zt;(Dt=Bt(Ze))&&qt&&(Zt=Qn.bind(null,null),Dt.then(Zt,Zt))}),Dt&&typeof Dt.then=="function"?B.resolve(Dt):kt.then(function(){return Dt})}}),lt.push(function(xt){var _t,kt,Bt=gt._cfg.dbschema;_t=Bt,kt=xt,[].slice.call(kt.db.objectStoreNames).forEach(function(Wt){return _t[Wt]==null&&kt.db.deleteObjectStore(Wt)}),jd(We,[We.Transaction.prototype]),lh(We,[We.Transaction.prototype],We._storeNames,We._dbSchema),Ze.schema=We._dbSchema}),lt.push(function(xt){We.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(We.idbdb.version/10)===gt._cfg.version?(We.idbdb.deleteObjectStore("$meta"),delete We._dbSchema.$meta,We._storeNames=We._storeNames.filter(function(_t){return _t!=="$meta"})):xt.objectStore("$meta").put(gt._cfg.version,"version"))})}),function gt(){return lt.length?B.resolve(lt.shift()(Ze.idbtrans)).then(gt):B.resolve()}().then(function(){Kb(et,nt)})):B.resolve();var We,ot,Ze,nt,lt,et}).catch(De)):(a(de).forEach(function(st){Km(J,st,de[st].primKey,de[st].indexes)}),tl(A,J),void B.follow(function(){return A.on.populate.fire(_e)}).catch(De));var Ye,Qe})}function ch(A,F){Kb(A._dbSchema,F),F.db.version%10!=0||F.objectStoreNames.contains("$meta")||F.db.createObjectStore("$meta").add(Math.ceil(F.db.version/10-1),"version");var J=nu(0,A.idbdb,F);fh(A,A._dbSchema,F);for(var ie=0,de=uh(J,A._dbSchema).change;ie<de.length;ie++){var _e=function(De){if(De.change.length||De.recreate)return console.warn("Unable to patch indexes of table ".concat(De.name," because it has changes on the type of index or primary key.")),{value:void 0};var $e=F.objectStore(De.name);De.add.forEach(function(Ye){Fe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(De.name,".").concat(Ye.src)),dh($e,Ye)})}(de[ie]);if(typeof _e=="object")return _e.value}}function uh(A,F){var J,ie={del:[],add:[],change:[]};for(J in A)F[J]||ie.del.push(J);for(J in F){var de=A[J],_e=F[J];if(de){var De={name:J,def:_e,recreate:!1,del:[],add:[],change:[]};if(""+(de.primKey.keyPath||"")!=""+(_e.primKey.keyPath||"")||de.primKey.auto!==_e.primKey.auto)De.recreate=!0,ie.change.push(De);else{var $e=de.idxByName,Ye=_e.idxByName,Qe=void 0;for(Qe in $e)Ye[Qe]||De.del.push(Qe);for(Qe in Ye){var st=$e[Qe],We=Ye[Qe];st?st.src!==We.src&&De.change.push(We):De.add.push(We)}(0<De.del.length||0<De.add.length||0<De.change.length)&&ie.change.push(De)}}else ie.add.push([J,_e])}return ie}function Km(A,F,J,ie){var de=A.db.createObjectStore(F,J.keyPath?{keyPath:J.keyPath,autoIncrement:J.auto}:{autoIncrement:J.auto});return ie.forEach(function(_e){return dh(de,_e)}),de}function Kb(A,F){a(A).forEach(function(J){F.db.objectStoreNames.contains(J)||(Fe&&console.debug("Dexie: Creating missing table",J),Km(F,J,A[J].primKey,A[J].indexes))})}function dh(A,F){A.createIndex(F.name,F.keyPath,{unique:F.unique,multiEntry:F.multi})}function nu(A,F,J){var ie={};return _(F.objectStoreNames,0).forEach(function(de){for(var _e=J.objectStore(de),De=Fa(ah(Qe=_e.keyPath),Qe||"",!0,!1,!!_e.autoIncrement,Qe&&typeof Qe!="string",!0),$e=[],Ye=0;Ye<_e.indexNames.length;++Ye){var st=_e.index(_e.indexNames[Ye]),Qe=st.keyPath,st=Fa(st.name,Qe,!!st.unique,!!st.multiEntry,!1,Qe&&typeof Qe!="string",!1);$e.push(st)}ie[de]=Qc(de,De,$e)}),ie}function fh(A,F,J){for(var ie=J.db.objectStoreNames,de=0;de<ie.length;++de){var _e=ie[de],De=J.objectStore(_e);A._hasGetAll="getAll"in De;for(var $e=0;$e<De.indexNames.length;++$e){var Ye=De.indexNames[$e],Qe=De.index(Ye).keyPath,st=typeof Qe=="string"?Qe:"["+_(Qe).join("+")+"]";!F[_e]||(Qe=F[_e].idxByName[st])&&(Qe.name=Ye,delete F[_e].idxByName[st],F[_e].idxByName[Ye]=Qe)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(A._hasGetAll=!1)}function Wb(A){return A.split(",").map(function(F,J){var ie=(F=F.trim()).replace(/([&*]|\+\+)/g,""),de=/^\[/.test(ie)?ie.match(/^\[(.*)\]$/)[1].split("+"):ie;return Fa(ie,de||null,/\&/.test(F),/\*/.test(F),/\+\+/.test(F),o(de),J===0)})}var _S=(hh.prototype._parseStoresSpec=function(A,F){a(A).forEach(function(J){if(A[J]!==null){var ie=Wb(A[J]),de=ie.shift();if(de.unique=!0,de.multi)throw new Ce.Schema("Primary key cannot be multi-valued");ie.forEach(function(_e){if(_e.auto)throw new Ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!_e.keyPath)throw new Ce.Schema("Index must have a name and cannot be an empty string")}),F[J]=Qc(J,de,ie)}})},hh.prototype.stores=function(J){var F=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,J):J;var J=F._versions,ie={},de={};return J.forEach(function(_e){l(ie,_e._cfg.storesSource),de=_e._cfg.dbschema={},_e._parseStoresSpec(ie,de)}),F._dbSchema=de,jd(F,[F._allTables,F,F.Transaction.prototype]),lh(F,[F._allTables,F,F.Transaction.prototype,this._cfg.tables],a(de),de),F._storeNames=a(de),this},hh.prototype.upgrade=function(A){return this._cfg.contentUpgrade=Se(this._cfg.contentUpgrade||Ge,A),this},hh);function hh(){}function Wm(A,F){var J=A._dbNamesDB;return J||(J=A._dbNamesDB=new La(Ul,{addons:[],indexedDB:A,IDBKeyRange:F})).version(1).stores({dbnames:"name"}),J.table("dbnames")}function ph(A){return A&&typeof A.databases=="function"}function Zm(A){return an(function(){return Ae.letThrough=!0,A()})}function Ym(A){return!("from"in A)}var Us=function(A,F){if(!this){var J=new Us;return A&&"d"in A&&l(J,A),J}l(this,arguments.length?{d:1,from:A,to:1<arguments.length?F:A}:{d:0})};function Od(A,F,J){var ie=er(F,J);if(!isNaN(ie)){if(0<ie)throw RangeError();if(Ym(A))return l(A,{from:F,to:J,d:1});var de=A.l,ie=A.r;if(er(J,A.from)<0)return de?Od(de,F,J):A.l={from:F,to:J,d:1,l:null,r:null},Yb(A);if(0<er(F,A.to))return ie?Od(ie,F,J):A.r={from:F,to:J,d:1,l:null,r:null},Yb(A);er(F,A.from)<0&&(A.from=F,A.l=null,A.d=ie?ie.d+1:1),0<er(J,A.to)&&(A.to=J,A.r=null,A.d=A.l?A.l.d+1:1),J=!A.r,de&&!A.l&&Yl(A,de),ie&&J&&Yl(A,ie)}}function Yl(A,F){Ym(F)||function J(ie,Ye){var _e=Ye.from,De=Ye.to,$e=Ye.l,Ye=Ye.r;Od(ie,_e,De),$e&&J(ie,$e),Ye&&J(ie,Ye)}(A,F)}function Zb(A,F){var J=mh(F),ie=J.next();if(ie.done)return!1;for(var de=ie.value,_e=mh(A),De=_e.next(de.from),$e=De.value;!ie.done&&!De.done;){if(er($e.from,de.to)<=0&&0<=er($e.to,de.from))return!0;er(de.from,$e.from)<0?de=(ie=J.next($e.from)).value:$e=(De=_e.next(de.from)).value}return!1}function mh(A){var F=Ym(A)?null:{s:0,n:A};return{next:function(J){for(var ie=0<arguments.length;F;)switch(F.s){case 0:if(F.s=1,ie)for(;F.n.l&&er(J,F.n.from)<0;)F={up:F,n:F.n.l,s:1};else for(;F.n.l;)F={up:F,n:F.n.l,s:1};case 1:if(F.s=2,!ie||er(J,F.n.to)<=0)return{value:F.n,done:!1};case 2:if(F.n.r){F.s=3,F={up:F,n:F.n.r,s:0};continue}case 3:F=F.up}return{done:!0}}}}function Yb(A){var F,J,ie=(((F=A.r)===null||F===void 0?void 0:F.d)||0)-(((J=A.l)===null||J===void 0?void 0:J.d)||0),de=1<ie?"r":ie<-1?"l":"";de&&(F=de=="r"?"l":"r",J=r({},A),ie=A[de],A.from=ie.from,A.to=ie.to,A[de]=ie[de],J[de]=ie[F],(A[F]=J).d=Xm(J)),A.d=Xm(A)}function Xm(J){var F=J.r,J=J.l;return(F?J?Math.max(F.d,J.d):F.d:J?J.d:0)+1}function gh(A,F){return a(F).forEach(function(J){A[J]?Yl(A[J],F[J]):A[J]=function ie(de){var _e,De,$e={};for(_e in de)f(de,_e)&&(De=de[_e],$e[_e]=!De||typeof De!="object"||q.has(De.constructor)?De:ie(De));return $e}(F[J])}),A}function Jm(A,F){return A.all||F.all||Object.keys(A).some(function(J){return F[J]&&Zb(F[J],A[J])})}m(Us.prototype,((Di={add:function(A){return Yl(this,A),this},addKey:function(A){return Od(this,A,A),this},addKeys:function(A){var F=this;return A.forEach(function(J){return Od(F,J,J)}),this},hasKey:function(A){var F=mh(this).next(A).value;return F&&er(F.from,A)<=0&&0<=er(F.to,A)}})[K]=function(){return mh(this)},Di));var Xl={},Qm={},eg=!1;function yh(A){gh(Qm,A),eg||(eg=!0,setTimeout(function(){eg=!1,tg(Qm,!(Qm={}))},0))}function tg(A,F){F===void 0&&(F=!1);var J=new Set;if(A.all)for(var ie=0,de=Object.values(Xl);ie<de.length;ie++)Xb(De=de[ie],A,J,F);else for(var _e in A){var De,$e=/^idb\:\/\/(.*)\/(.*)\//.exec(_e);$e&&(_e=$e[1],$e=$e[2],(De=Xl["idb://".concat(_e,"/").concat($e)])&&Xb(De,A,J,F))}J.forEach(function(Ye){return Ye()})}function Xb(A,F,J,ie){for(var de=[],_e=0,De=Object.entries(A.queries.query);_e<De.length;_e++){for(var $e=De[_e],Ye=$e[0],Qe=[],st=0,We=$e[1];st<We.length;st++){var ot=We[st];Jm(F,ot.obsSet)?ot.subscribers.forEach(function(et){return J.add(et)}):ie&&Qe.push(ot)}ie&&de.push([Ye,Qe])}if(ie)for(var Ze=0,nt=de;Ze<nt.length;Ze++){var lt=nt[Ze],Ye=lt[0],Qe=lt[1];A.queries.query[Ye]=Qe}}function SS(A){var F=A._state,J=A._deps.indexedDB;if(F.isBeingOpened||A.idbdb)return F.dbReadyPromise.then(function(){return F.dbOpenError?rs(F.dbOpenError):A});F.isBeingOpened=!0,F.dbOpenError=null,F.openComplete=!1;var ie=F.openCanceller,de=Math.round(10*A.verno),_e=!1;function De(){if(F.openCanceller!==ie)throw new Ce.DatabaseClosed("db.open() was cancelled")}function $e(){return new B(function(ot,Ze){if(De(),!J)throw new Ce.MissingAPI;var nt=A.name,lt=F.autoSchema||!de?J.open(nt):J.open(nt,de);if(!lt)throw new Ce.MissingAPI;lt.onerror=ma(Ze),lt.onblocked=je(A._fireOnBlocked),lt.onupgradeneeded=je(function(et){var gt;st=lt.transaction,F.autoSchema&&!A._options.allowEmptyDB?(lt.onerror=Kl,st.abort(),lt.result.close(),(gt=J.deleteDatabase(nt)).onsuccess=gt.onerror=je(function(){Ze(new Ce.NoSuchDatabase("Database ".concat(nt," doesnt exist")))})):(st.onerror=ma(Ze),et=et.oldVersion>Math.pow(2,62)?0:et.oldVersion,We=et<1,A.idbdb=lt.result,_e&&ch(A,st),Md(A,et/10,st,Ze))},Ze),lt.onsuccess=je(function(){st=null;var et,gt,xt,_t,kt,Bt=A.idbdb=lt.result,Wt=_(Bt.objectStoreNames);if(0<Wt.length)try{var Dt=Bt.transaction((_t=Wt).length===1?_t[0]:_t,"readonly");if(F.autoSchema)gt=Bt,xt=Dt,(et=A).verno=gt.version/10,xt=et._dbSchema=nu(0,gt,xt),et._storeNames=_(gt.objectStoreNames,0),lh(et,[et._allTables],a(xt),xt);else if(fh(A,A._dbSchema,Dt),((kt=uh(nu(0,(kt=A).idbdb,Dt),kt._dbSchema)).add.length||kt.change.some(function(qt){return qt.add.length||qt.change.length}))&&!_e)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Bt.close(),de=Bt.version+1,_e=!0,ot($e());tl(A,Dt)}catch{}mo.push(A),Bt.onversionchange=je(function(qt){F.vcFired=!0,A.on("versionchange").fire(qt)}),Bt.onclose=je(function(qt){A.on("close").fire(qt)}),We&&(kt=A._deps,Dt=nt,Bt=kt.indexedDB,kt=kt.IDBKeyRange,ph(Bt)||Dt===Ul||Wm(Bt,kt).put({name:Dt}).catch(Ge)),ot()},Ze)}).catch(function(ot){switch(ot==null?void 0:ot.name){case"UnknownError":if(0<F.PR1398_maxLoop)return F.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),$e();break;case"VersionError":if(0<de)return de=0,$e()}return B.reject(ot)})}var Ye,Qe=F.dbReadyResolve,st=null,We=!1;return B.race([ie,(typeof navigator>"u"?B.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(ot){function Ze(){return indexedDB.databases().finally(ot)}Ye=setInterval(Ze,100),Ze()}).finally(function(){return clearInterval(Ye)}):Promise.resolve()).then($e)]).then(function(){return De(),F.onReadyBeingFired=[],B.resolve(Zm(function(){return A.on.ready.fire(A.vip)})).then(function ot(){if(0<F.onReadyBeingFired.length){var Ze=F.onReadyBeingFired.reduce(Se,Ge);return F.onReadyBeingFired=[],B.resolve(Zm(function(){return Ze(A.vip)})).then(ot)}})}).finally(function(){F.openCanceller===ie&&(F.onReadyBeingFired=null,F.isBeingOpened=!1)}).catch(function(ot){F.dbOpenError=ot;try{st&&st.abort()}catch{}return ie===F.openCanceller&&A._close(),rs(ot)}).finally(function(){F.openComplete=!0,Qe()}).then(function(){var ot;return We&&(ot={},A.tables.forEach(function(Ze){Ze.schema.indexes.forEach(function(nt){nt.name&&(ot["idb://".concat(A.name,"/").concat(Ze.name,"/").concat(nt.name)]=new Us(-1/0,[[[]]]))}),ot["idb://".concat(A.name,"/").concat(Ze.name,"/")]=ot["idb://".concat(A.name,"/").concat(Ze.name,"/:dels")]=new Us(-1/0,[[[]]])}),zs(Jc).fire(ot),tg(ot,!0)),A})}function Pd(A){function F(_e){return A.next(_e)}var J=de(F),ie=de(function(_e){return A.throw(_e)});function de(_e){return function(Ye){var $e=_e(Ye),Ye=$e.value;return $e.done?Ye:Ye&&typeof Ye.then=="function"?Ye.then(J,ie):o(Ye)?Promise.all(Ye).then(J,ie):J(Ye)}}return de(F)()}function nl(A,F,J){for(var ie=o(A)?A.slice():[A],de=0;de<J;++de)ie.push(F);return ie}var ES={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(A){return r(r({},A),{table:function(F){var J=A.table(F),ie=J.schema,de={},_e=[];function De(We,ot,Ze){var nt=Cs(We),lt=de[nt]=de[nt]||[],et=We==null?0:typeof We=="string"?1:We.length,gt=0<ot,gt=r(r({},Ze),{name:gt?"".concat(nt,"(virtual-from:").concat(Ze.name,")"):Ze.name,lowLevelIndex:Ze,isVirtual:gt,keyTail:ot,keyLength:et,extractKey:tu(We),unique:!gt&&Ze.unique});return lt.push(gt),gt.isPrimaryKey||_e.push(gt),1<et&&De(et===2?We[0]:We.slice(0,et-1),ot+1,Ze),lt.sort(function(xt,_t){return xt.keyTail-_t.keyTail}),gt}F=De(ie.primaryKey.keyPath,0,ie.primaryKey),de[":id"]=[F];for(var $e=0,Ye=ie.indexes;$e<Ye.length;$e++){var Qe=Ye[$e];De(Qe.keyPath,0,Qe)}function st(We){var ot,Ze=We.query.index;return Ze.isVirtual?r(r({},We),{query:{index:Ze.lowLevelIndex,range:(ot=We.query.range,Ze=Ze.keyTail,{type:ot.type===1?2:ot.type,lower:nl(ot.lower,ot.lowerOpen?A.MAX_KEY:A.MIN_KEY,Ze),lowerOpen:!0,upper:nl(ot.upper,ot.upperOpen?A.MIN_KEY:A.MAX_KEY,Ze),upperOpen:!0})}}):We}return r(r({},J),{schema:r(r({},ie),{primaryKey:F,indexes:_e,getIndexByKeyPath:function(We){return(We=de[Cs(We)])&&We[0]}}),count:function(We){return J.count(st(We))},query:function(We){return J.query(st(We))},openCursor:function(We){var ot=We.query.index,Ze=ot.keyTail,nt=ot.isVirtual,lt=ot.keyLength;return nt?J.openCursor(st(We)).then(function(gt){return gt&&et(gt)}):J.openCursor(We);function et(gt){return Object.create(gt,{continue:{value:function(xt){xt!=null?gt.continue(nl(xt,We.reverse?A.MAX_KEY:A.MIN_KEY,Ze)):We.unique?gt.continue(gt.key.slice(0,lt).concat(We.reverse?A.MIN_KEY:A.MAX_KEY,Ze)):gt.continue()}},continuePrimaryKey:{value:function(xt,_t){gt.continuePrimaryKey(nl(xt,A.MAX_KEY,Ze),_t)}},primaryKey:{get:function(){return gt.primaryKey}},key:{get:function(){var xt=gt.key;return lt===1?xt[0]:xt.slice(0,lt)}},value:{get:function(){return gt.value}}})}}})}})}};function bh(A,F,J,ie){return J=J||{},ie=ie||"",a(A).forEach(function(de){var _e,De,$e;f(F,de)?(_e=A[de],De=F[de],typeof _e=="object"&&typeof De=="object"&&_e&&De?($e=re(_e))!==re(De)?J[ie+de]=F[de]:$e==="Object"?bh(_e,De,J,ie+de+"."):_e!==De&&(J[ie+de]=F[de]):_e!==De&&(J[ie+de]=F[de])):J[ie+de]=void 0}),a(F).forEach(function(de){f(A,de)||(J[ie+de]=F[de])}),J}function vh(A,F){return F.type==="delete"?F.keys:F.keys||F.values.map(A.extractKey)}var Jb={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(A){return r(r({},A),{table:function(F){var J=A.table(F),ie=J.schema.primaryKey;return r(r({},J),{mutate:function(de){var _e=Ae.trans,De=_e.table(F).hook,$e=De.deleting,Ye=De.creating,Qe=De.updating;switch(de.type){case"add":if(Ye.fire===Ge)break;return _e._promise("readwrite",function(){return st(de)},!0);case"put":if(Ye.fire===Ge&&Qe.fire===Ge)break;return _e._promise("readwrite",function(){return st(de)},!0);case"delete":if($e.fire===Ge)break;return _e._promise("readwrite",function(){return st(de)},!0);case"deleteRange":if($e.fire===Ge)break;return _e._promise("readwrite",function(){return function We(ot,Ze,nt){return J.query({trans:ot,values:!1,query:{index:ie,range:Ze},limit:nt}).then(function(lt){var et=lt.result;return st({type:"delete",keys:et,trans:ot}).then(function(gt){return 0<gt.numFailures?Promise.reject(gt.failures[0]):et.length<nt?{failures:[],numFailures:0,lastResult:void 0}:We(ot,r(r({},Ze),{lower:et[et.length-1],lowerOpen:!0}),nt)})})}(de.trans,de.range,1e4)},!0)}return J.mutate(de);function st(We){var ot,Ze,nt,lt=Ae.trans,et=We.keys||vh(ie,We);if(!et)throw new Error("Keys missing");return(We=We.type==="add"||We.type==="put"?r(r({},We),{keys:et}):r({},We)).type!=="delete"&&(We.values=s([],We.values)),We.keys&&(We.keys=s([],We.keys)),ot=J,nt=et,((Ze=We).type==="add"?Promise.resolve([]):ot.getMany({trans:Ze.trans,keys:nt,cache:"immutable"})).then(function(gt){var xt=et.map(function(_t,kt){var Bt,Wt,Dt,qt=gt[kt],Zt={onerror:null,onsuccess:null};return We.type==="delete"?$e.fire.call(Zt,_t,qt,lt):We.type==="add"||qt===void 0?(Bt=Ye.fire.call(Zt,_t,We.values[kt],lt),_t==null&&Bt!=null&&(We.keys[kt]=_t=Bt,ie.outbound||I(We.values[kt],ie.keyPath,_t))):(Bt=bh(qt,We.values[kt]),(Wt=Qe.fire.call(Zt,Bt,_t,qt,lt))&&(Dt=We.values[kt],Object.keys(Wt).forEach(function(Ft){f(Dt,Ft)?Dt[Ft]=Wt[Ft]:I(Dt,Ft,Wt[Ft])}))),Zt});return J.mutate(We).then(function(_t){for(var kt=_t.failures,Bt=_t.results,Wt=_t.numFailures,_t=_t.lastResult,Dt=0;Dt<et.length;++Dt){var qt=(Bt||et)[Dt],Zt=xt[Dt];qt==null?Zt.onerror&&Zt.onerror(kt[Dt]):Zt.onsuccess&&Zt.onsuccess(We.type==="put"&&gt[Dt]?We.values[Dt]:qt)}return{failures:kt,results:Bt,numFailures:Wt,lastResult:_t}}).catch(function(_t){return xt.forEach(function(kt){return kt.onerror&&kt.onerror(_t)}),Promise.reject(_t)})})}}})}})}};function ng(A,F,J){try{if(!F||F.keys.length<A.length)return null;for(var ie=[],de=0,_e=0;de<F.keys.length&&_e<A.length;++de)er(F.keys[de],A[_e])===0&&(ie.push(J?V(F.values[de]):F.values[de]),++_e);return ie.length===A.length?ie:null}catch{return null}}var Qb={stack:"dbcore",level:-1,create:function(A){return{table:function(F){var J=A.table(F);return r(r({},J),{getMany:function(ie){if(!ie.cache)return J.getMany(ie);var de=ng(ie.keys,ie.trans._cache,ie.cache==="clone");return de?B.resolve(de):J.getMany(ie).then(function(_e){return ie.trans._cache={keys:ie.keys,values:ie.cache==="clone"?V(_e):_e},_e})},mutate:function(ie){return ie.type!=="add"&&(ie.trans._cache=null),J.mutate(ie)}})}}}};function Jl(A,F){return A.trans.mode==="readonly"&&!!A.subscr&&!A.trans.explicit&&A.trans.db._options.cache!=="disabled"&&!F.schema.primaryKey.outbound}function ev(A,F){switch(A){case"query":return F.values&&!F.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var CS={stack:"dbcore",level:0,name:"Observability",create:function(A){var F=A.schema.name,J=new Us(A.MIN_KEY,A.MAX_KEY);return r(r({},A),{transaction:function(ie,de,_e){if(Ae.subscr&&de!=="readonly")throw new Ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ae.querier));return A.transaction(ie,de,_e)},table:function(ie){var de=A.table(ie),_e=de.schema,De=_e.primaryKey,We=_e.indexes,$e=De.extractKey,Ye=De.outbound,Qe=De.autoIncrement&&We.filter(function(Ze){return Ze.compound&&Ze.keyPath.includes(De.keyPath)}),st=r(r({},de),{mutate:function(Ze){function nt(Ft){return Ft="idb://".concat(F,"/").concat(ie,"/").concat(Ft),_t[Ft]||(_t[Ft]=new Us)}var lt,et,gt,xt=Ze.trans,_t=Ze.mutatedParts||(Ze.mutatedParts={}),kt=nt(""),Bt=nt(":dels"),Wt=Ze.type,Zt=Ze.type==="deleteRange"?[Ze.range]:Ze.type==="delete"?[Ze.keys]:Ze.values.length<50?[vh(De,Ze).filter(function(Ft){return Ft}),Ze.values]:[],Dt=Zt[0],qt=Zt[1],Zt=Ze.trans._cache;return o(Dt)?(kt.addKeys(Dt),(Zt=Wt==="delete"||Dt.length===qt.length?ng(Dt,Zt):null)||Bt.addKeys(Dt),(Zt||qt)&&(lt=nt,et=Zt,gt=qt,_e.indexes.forEach(function(Ft){var nn=lt(Ft.name||"");function pn(jn){return jn!=null?Ft.extractKey(jn):null}function bn(jn){return Ft.multiEntry&&o(jn)?jn.forEach(function(ai){return nn.addKey(ai)}):nn.addKey(jn)}(et||gt).forEach(function(jn,ps){var En=et&&pn(et[ps]),ps=gt&&pn(gt[ps]);er(En,ps)!==0&&(En!=null&&bn(En),ps!=null&&bn(ps))})}))):Dt?(qt={from:(qt=Dt.lower)!==null&&qt!==void 0?qt:A.MIN_KEY,to:(qt=Dt.upper)!==null&&qt!==void 0?qt:A.MAX_KEY},Bt.add(qt),kt.add(qt)):(kt.add(J),Bt.add(J),_e.indexes.forEach(function(Ft){return nt(Ft.name).add(J)})),de.mutate(Ze).then(function(Ft){return!Dt||Ze.type!=="add"&&Ze.type!=="put"||(kt.addKeys(Ft.results),Qe&&Qe.forEach(function(nn){for(var pn=Ze.values.map(function(En){return nn.extractKey(En)}),bn=nn.keyPath.findIndex(function(En){return En===De.keyPath}),jn=0,ai=Ft.results.length;jn<ai;++jn)pn[jn][bn]=Ft.results[jn];nt(nn.name).addKeys(pn)})),xt.mutatedParts=gh(xt.mutatedParts||{},_t),Ft})}}),We=function(nt){var lt=nt.query,nt=lt.index,lt=lt.range;return[nt,new Us((nt=lt.lower)!==null&&nt!==void 0?nt:A.MIN_KEY,(lt=lt.upper)!==null&&lt!==void 0?lt:A.MAX_KEY)]},ot={get:function(Ze){return[De,new Us(Ze.key)]},getMany:function(Ze){return[De,new Us().addKeys(Ze.keys)]},count:We,query:We,openCursor:We};return a(ot).forEach(function(Ze){st[Ze]=function(nt){var lt=Ae.subscr,et=!!lt,gt=Jl(Ae,de)&&ev(Ze,nt)?nt.obsSet={}:lt;if(et){var xt=function(qt){return qt="idb://".concat(F,"/").concat(ie,"/").concat(qt),gt[qt]||(gt[qt]=new Us)},_t=xt(""),kt=xt(":dels"),lt=ot[Ze](nt),et=lt[0],lt=lt[1];if((Ze==="query"&&et.isPrimaryKey&&!nt.values?kt:xt(et.name||"")).add(lt),!et.isPrimaryKey){if(Ze!=="count"){var Bt=Ze==="query"&&Ye&&nt.values&&de.query(r(r({},nt),{values:!1}));return de[Ze].apply(this,arguments).then(function(qt){if(Ze==="query"){if(Ye&&nt.values)return Bt.then(function(pn){return pn=pn.result,_t.addKeys(pn),qt});var Zt=nt.values?qt.result.map($e):qt.result;(nt.values?_t:kt).addKeys(Zt)}else if(Ze==="openCursor"){var Ft=qt,nn=nt.values;return Ft&&Object.create(Ft,{key:{get:function(){return kt.addKey(Ft.primaryKey),Ft.key}},primaryKey:{get:function(){var pn=Ft.primaryKey;return kt.addKey(pn),pn}},value:{get:function(){return nn&&_t.addKey(Ft.primaryKey),Ft.value}}})}return qt})}kt.add(J)}}return de[Ze].apply(this,arguments)}}),st}})}};function tv(A,F,J){if(J.numFailures===0)return F;if(F.type==="deleteRange")return null;var ie=F.keys?F.keys.length:"values"in F&&F.values?F.values.length:1;return J.numFailures===ie?null:(F=r({},F),o(F.keys)&&(F.keys=F.keys.filter(function(de,_e){return!(_e in J.failures)})),"values"in F&&o(F.values)&&(F.values=F.values.filter(function(de,_e){return!(_e in J.failures)})),F)}function wh(A,F){return J=A,((ie=F).lower===void 0||(ie.lowerOpen?0<er(J,ie.lower):0<=er(J,ie.lower)))&&(A=A,(F=F).upper===void 0||(F.upperOpen?er(A,F.upper)<0:er(A,F.upper)<=0));var J,ie}function rg(A,F,ot,ie,de,_e){if(!ot||ot.length===0)return A;var De=F.query.index,$e=De.multiEntry,Ye=F.query.range,Qe=ie.schema.primaryKey.extractKey,st=De.extractKey,We=(De.lowLevelIndex||De).extractKey,ot=ot.reduce(function(Ze,nt){var lt=Ze,et=[];if(nt.type==="add"||nt.type==="put")for(var gt=new Us,xt=nt.values.length-1;0<=xt;--xt){var _t,kt=nt.values[xt],Bt=Qe(kt);gt.hasKey(Bt)||(_t=st(kt),($e&&o(_t)?_t.some(function(Ft){return wh(Ft,Ye)}):wh(_t,Ye))&&(gt.addKey(Bt),et.push(kt)))}switch(nt.type){case"add":var Wt=new Us().addKeys(F.values?Ze.map(function(nn){return Qe(nn)}):Ze),lt=Ze.concat(F.values?et.filter(function(nn){return nn=Qe(nn),!Wt.hasKey(nn)&&(Wt.addKey(nn),!0)}):et.map(function(nn){return Qe(nn)}).filter(function(nn){return!Wt.hasKey(nn)&&(Wt.addKey(nn),!0)}));break;case"put":var Dt=new Us().addKeys(nt.values.map(function(nn){return Qe(nn)}));lt=Ze.filter(function(nn){return!Dt.hasKey(F.values?Qe(nn):nn)}).concat(F.values?et:et.map(function(nn){return Qe(nn)}));break;case"delete":var qt=new Us().addKeys(nt.keys);lt=Ze.filter(function(nn){return!qt.hasKey(F.values?Qe(nn):nn)});break;case"deleteRange":var Zt=nt.range;lt=Ze.filter(function(nn){return!wh(Qe(nn),Zt)})}return lt},A);return ot===A?A:(ot.sort(function(Ze,nt){return er(We(Ze),We(nt))||er(Qe(Ze),Qe(nt))}),F.limit&&F.limit<1/0&&(ot.length>F.limit?ot.length=F.limit:A.length===F.limit&&ot.length<F.limit&&(de.dirty=!0)),_e?Object.freeze(ot):ot)}function ru(A,F){return er(A.lower,F.lower)===0&&er(A.upper,F.upper)===0&&!!A.lowerOpen==!!F.lowerOpen&&!!A.upperOpen==!!F.upperOpen}function Dd(A,F){return function(J,ie,de,_e){if(J===void 0)return ie!==void 0?-1:0;if(ie===void 0)return 1;if((ie=er(J,ie))===0){if(de&&_e)return 0;if(de)return 1;if(_e)return-1}return ie}(A.lower,F.lower,A.lowerOpen,F.lowerOpen)<=0&&0<=function(J,ie,de,_e){if(J===void 0)return ie!==void 0?1:0;if(ie===void 0)return-1;if((ie=er(J,ie))===0){if(de&&_e)return 0;if(de)return-1;if(_e)return 1}return ie}(A.upper,F.upper,A.upperOpen,F.upperOpen)}function kS(A,F,J,ie){A.subscribers.add(J),ie.addEventListener("abort",function(){var de,_e;A.subscribers.delete(J),A.subscribers.size===0&&(de=A,_e=F,setTimeout(function(){de.subscribers.size===0&&W(_e,de)},3e3))})}var xh={stack:"dbcore",level:0,name:"Cache",create:function(A){var F=A.schema.name;return r(r({},A),{transaction:function(J,ie,de){var _e,De,$e=A.transaction(J,ie,de);return ie==="readwrite"&&(De=(_e=new AbortController).signal,de=function(Ye){return function(){if(_e.abort(),ie==="readwrite"){for(var Qe=new Set,st=0,We=J;st<We.length;st++){var ot=We[st],Ze=Xl["idb://".concat(F,"/").concat(ot)];if(Ze){var nt=A.table(ot),lt=Ze.optimisticOps.filter(function(nn){return nn.trans===$e});if($e._explicit&&Ye&&$e.mutatedParts)for(var et=0,gt=Object.values(Ze.queries.query);et<gt.length;et++)for(var xt=0,_t=(Wt=gt[et]).slice();xt<_t.length;xt++)Jm((Dt=_t[xt]).obsSet,$e.mutatedParts)&&(W(Wt,Dt),Dt.subscribers.forEach(function(nn){return Qe.add(nn)}));else if(0<lt.length){Ze.optimisticOps=Ze.optimisticOps.filter(function(nn){return nn.trans!==$e});for(var kt=0,Bt=Object.values(Ze.queries.query);kt<Bt.length;kt++)for(var Wt,Dt,qt,Zt=0,Ft=(Wt=Bt[kt]).slice();Zt<Ft.length;Zt++)(Dt=Ft[Zt]).res!=null&&$e.mutatedParts&&(Ye&&!Dt.dirty?(qt=Object.isFrozen(Dt.res),qt=rg(Dt.res,Dt.req,lt,nt,Dt,qt),Dt.dirty?(W(Wt,Dt),Dt.subscribers.forEach(function(nn){return Qe.add(nn)})):qt!==Dt.res&&(Dt.res=qt,Dt.promise=B.resolve({result:qt}))):(Dt.dirty&&W(Wt,Dt),Dt.subscribers.forEach(function(nn){return Qe.add(nn)})))}}}Qe.forEach(function(nn){return nn()})}}},$e.addEventListener("abort",de(!1),{signal:De}),$e.addEventListener("error",de(!1),{signal:De}),$e.addEventListener("complete",de(!0),{signal:De})),$e},table:function(J){var ie=A.table(J),de=ie.schema.primaryKey;return r(r({},ie),{mutate:function(_e){var De=Ae.trans;if(de.outbound||De.db._options.cache==="disabled"||De.explicit||De.idbtrans.mode!=="readwrite")return ie.mutate(_e);var $e=Xl["idb://".concat(F,"/").concat(J)];return $e?(De=ie.mutate(_e),_e.type!=="add"&&_e.type!=="put"||!(50<=_e.values.length||vh(de,_e).some(function(Ye){return Ye==null}))?($e.optimisticOps.push(_e),_e.mutatedParts&&yh(_e.mutatedParts),De.then(function(Ye){0<Ye.numFailures&&(W($e.optimisticOps,_e),(Ye=tv(0,_e,Ye))&&$e.optimisticOps.push(Ye),_e.mutatedParts&&yh(_e.mutatedParts))}),De.catch(function(){W($e.optimisticOps,_e),_e.mutatedParts&&yh(_e.mutatedParts)})):De.then(function(Ye){var Qe=tv(0,r(r({},_e),{values:_e.values.map(function(st,We){var ot;return Ye.failures[We]?st:(st=(ot=de.keyPath)!==null&&ot!==void 0&&ot.includes(".")?V(st):r({},st),I(st,de.keyPath,Ye.results[We]),st)})}),Ye);$e.optimisticOps.push(Qe),queueMicrotask(function(){return _e.mutatedParts&&yh(_e.mutatedParts)})}),De):ie.mutate(_e)},query:function(_e){if(!Jl(Ae,ie)||!ev("query",_e))return ie.query(_e);var De=((Qe=Ae.trans)===null||Qe===void 0?void 0:Qe.db._options.cache)==="immutable",We=Ae,$e=We.requery,Ye=We.signal,Qe=function(nt,lt,et,gt){var xt=Xl["idb://".concat(nt,"/").concat(lt)];if(!xt)return[];if(!(lt=xt.queries[et]))return[null,!1,xt,null];var _t=lt[(gt.query?gt.query.index.name:null)||""];if(!_t)return[null,!1,xt,null];switch(et){case"query":var kt=_t.find(function(Bt){return Bt.req.limit===gt.limit&&Bt.req.values===gt.values&&ru(Bt.req.query.range,gt.query.range)});return kt?[kt,!0,xt,_t]:[_t.find(function(Bt){return("limit"in Bt.req?Bt.req.limit:1/0)>=gt.limit&&(!gt.values||Bt.req.values)&&Dd(Bt.req.query.range,gt.query.range)}),!1,xt,_t];case"count":return kt=_t.find(function(Bt){return ru(Bt.req.query.range,gt.query.range)}),[kt,!!kt,xt,_t]}}(F,J,"query",_e),st=Qe[0],We=Qe[1],ot=Qe[2],Ze=Qe[3];return st&&We?st.obsSet=_e.obsSet:(We=ie.query(_e).then(function(nt){var lt=nt.result;if(st&&(st.res=lt),De){for(var et=0,gt=lt.length;et<gt;++et)Object.freeze(lt[et]);Object.freeze(lt)}else nt.result=V(lt);return nt}).catch(function(nt){return Ze&&st&&W(Ze,st),Promise.reject(nt)}),st={obsSet:_e.obsSet,promise:We,subscribers:new Set,type:"query",req:_e,dirty:!1},Ze?Ze.push(st):(Ze=[st],(ot=ot||(Xl["idb://".concat(F,"/").concat(J)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[_e.query.index.name||""]=Ze)),kS(st,Ze,$e,Ye),st.promise.then(function(nt){return{result:rg(nt.result,_e,ot==null?void 0:ot.optimisticOps,ie,st,De)}})}})}})}};function Fd(A,F){return new Proxy(A,{get:function(J,ie,de){return ie==="db"?F:Reflect.get(J,ie,de)}})}var La=(Zr.prototype.version=function(A){if(isNaN(A)||A<.1)throw new Ce.Type("Given version is not a positive number");if(A=Math.round(10*A)/10,this.idbdb||this._state.isBeingOpened)throw new Ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,A);var F=this._versions,J=F.filter(function(ie){return ie._cfg.version===A})[0];return J||(J=new this.Version(A),F.push(J),F.sort(Gm),J.stores({}),this._state.autoSchema=!1,J)},Zr.prototype._whenReady=function(A){var F=this;return this.idbdb&&(this._state.openComplete||Ae.letThrough||this._vip)?A():new B(function(J,ie){if(F._state.openComplete)return ie(new Ce.DatabaseClosed(F._state.dbOpenError));if(!F._state.isBeingOpened){if(!F._state.autoOpen)return void ie(new Ce.DatabaseClosed);F.open().catch(Ge)}F._state.dbReadyPromise.then(J,ie)}).then(A)},Zr.prototype.use=function(A){var F=A.stack,J=A.create,ie=A.level,de=A.name;return de&&this.unuse({stack:F,name:de}),A=this._middlewares[F]||(this._middlewares[F]=[]),A.push({stack:F,create:J,level:ie??10,name:de}),A.sort(function(_e,De){return _e.level-De.level}),this},Zr.prototype.unuse=function(A){var F=A.stack,J=A.name,ie=A.create;return F&&this._middlewares[F]&&(this._middlewares[F]=this._middlewares[F].filter(function(de){return ie?de.create!==ie:!!J&&de.name!==J})),this},Zr.prototype.open=function(){var A=this;return Zo(ve,function(){return SS(A)})},Zr.prototype._close=function(){var A=this._state,F=mo.indexOf(this);if(0<=F&&mo.splice(F,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}A.isBeingOpened||(A.dbReadyPromise=new B(function(J){A.dbReadyResolve=J}),A.openCanceller=new B(function(J,ie){A.cancelOpen=ie}))},Zr.prototype.close=function(J){var F=(J===void 0?{disableAutoOpen:!0}:J).disableAutoOpen,J=this._state;F?(J.isBeingOpened&&J.cancelOpen(new Ce.DatabaseClosed),this._close(),J.autoOpen=!1,J.dbOpenError=new Ce.DatabaseClosed):(this._close(),J.autoOpen=this._options.autoOpen||J.isBeingOpened,J.openComplete=!1,J.dbOpenError=null)},Zr.prototype.delete=function(A){var F=this;A===void 0&&(A={disableAutoOpen:!0});var J=0<arguments.length&&typeof arguments[0]!="object",ie=this._state;return new B(function(de,_e){function De(){F.close(A);var $e=F._deps.indexedDB.deleteDatabase(F.name);$e.onsuccess=je(function(){var Ye,Qe,st;Ye=F._deps,Qe=F.name,st=Ye.indexedDB,Ye=Ye.IDBKeyRange,ph(st)||Qe===Ul||Wm(st,Ye).delete(Qe).catch(Ge),de()}),$e.onerror=ma(_e),$e.onblocked=F._fireOnBlocked}if(J)throw new Ce.InvalidArgument("Invalid closeOptions argument to db.delete()");ie.isBeingOpened?ie.dbReadyPromise.then(De):De()})},Zr.prototype.backendDB=function(){return this.idbdb},Zr.prototype.isOpen=function(){return this.idbdb!==null},Zr.prototype.hasBeenClosed=function(){var A=this._state.dbOpenError;return A&&A.name==="DatabaseClosed"},Zr.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Zr.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Zr.prototype,"tables",{get:function(){var A=this;return a(this._allTables).map(function(F){return A._allTables[F]})},enumerable:!1,configurable:!0}),Zr.prototype.transaction=function(){var A=(function(F,J,ie){var de=arguments.length;if(de<2)throw new Ce.InvalidArgument("Too few arguments");for(var _e=new Array(de-1);--de;)_e[de-1]=arguments[de];return ie=_e.pop(),[F,L(_e),ie]}).apply(this,arguments);return this._transaction.apply(this,A)},Zr.prototype._transaction=function(A,F,J){var ie=this,de=Ae.trans;de&&de.db===this&&A.indexOf("!")===-1||(de=null);var _e,De,$e=A.indexOf("?")!==-1;A=A.replace("!","").replace("?","");try{if(De=F.map(function(Qe){if(Qe=Qe instanceof ie.Table?Qe.name:Qe,typeof Qe!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return Qe}),A=="r"||A===pa)_e=pa;else{if(A!="rw"&&A!=Nd)throw new Ce.InvalidArgument("Invalid transaction mode: "+A);_e=Nd}if(de){if(de.mode===pa&&_e===Nd){if(!$e)throw new Ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");de=null}de&&De.forEach(function(Qe){if(de&&de.storeNames.indexOf(Qe)===-1){if(!$e)throw new Ce.SubTransaction("Table "+Qe+" not included in parent transaction.");de=null}}),$e&&de&&!de.active&&(de=null)}}catch(Qe){return de?de._promise(null,function(st,We){We(Qe)}):rs(Qe)}var Ye=(function Qe(st,We,ot,Ze,nt){return B.resolve().then(function(){var lt=Ae.transless||Ae,et=st._createTransaction(We,ot,st._dbSchema,Ze);if(et.explicit=!0,lt={trans:et,transless:lt},Ze)et.idbtrans=Ze.idbtrans;else try{et.create(),et.idbtrans._explicit=!0,st._state.PR1398_maxLoop=3}catch(_t){return _t.name===Pe.InvalidState&&st.isOpen()&&0<--st._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),st.close({disableAutoOpen:!1}),st.open().then(function(){return Qe(st,We,ot,null,nt)})):rs(_t)}var gt,xt=te(nt);return xt&&qn(),lt=B.follow(function(){var _t;(gt=nt.call(et,et))&&(xt?(_t=Qn.bind(null,null),gt.then(_t,_t)):typeof gt.next=="function"&&typeof gt.throw=="function"&&(gt=Pd(gt)))},lt),(gt&&typeof gt.then=="function"?B.resolve(gt).then(function(_t){return et.active?_t:rs(new Ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):lt.then(function(){return gt})).then(function(_t){return Ze&&et._resolve(),et._completion.then(function(){return _t})}).catch(function(_t){return et._reject(_t),rs(_t)})})}).bind(null,this,_e,De,de,J);return de?de._promise(_e,Ye,"lock"):Ae.trans?Zo(Ae.transless,function(){return ie._whenReady(Ye)}):this._whenReady(Ye)},Zr.prototype.table=function(A){if(!f(this._allTables,A))throw new Ce.InvalidTable("Table ".concat(A," does not exist"));return this._allTables[A]},Zr);function Zr(A,F){var J=this;this._middlewares={},this.verno=0;var ie=Zr.dependencies;this._options=F=r({addons:Zr.addons,autoOpen:!0,indexedDB:ie.indexedDB,IDBKeyRange:ie.IDBKeyRange,cache:"cloned"},F),this._deps={indexedDB:F.indexedDB,IDBKeyRange:F.IDBKeyRange},ie=F.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var de,_e,De,$e,Ye,Qe={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ge,dbReadyPromise:null,cancelOpen:Ge,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:F.autoOpen};Qe.dbReadyPromise=new B(function(We){Qe.dbReadyResolve=We}),Qe.openCanceller=new B(function(We,ot){Qe.cancelOpen=ot}),this._state=Qe,this.name=A,this.on=el(this,"populate","blocked","versionchange","close",{ready:[Se,Ge]}),this.on.ready.subscribe=E(this.on.ready.subscribe,function(We){return function(ot,Ze){Zr.vip(function(){var nt,lt=J._state;lt.openComplete?(lt.dbOpenError||B.resolve().then(ot),Ze&&We(ot)):lt.onReadyBeingFired?(lt.onReadyBeingFired.push(ot),Ze&&We(ot)):(We(ot),nt=J,Ze||We(function et(){nt.on.ready.unsubscribe(ot),nt.on.ready.unsubscribe(et)}))})}}),this.Collection=(de=this,Gc(Yc.prototype,function(gt,et){this.db=de;var Ze=ql,nt=null;if(et)try{Ze=et()}catch(xt){nt=xt}var lt=gt._ctx,et=lt.table,gt=et.hook.reading.fire;this._ctx={table:et,index:lt.index,isPrimKey:!lt.index||et.schema.primKey.keyPath&&lt.index===et.schema.primKey.name,range:Ze,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:nt,or:lt.or,valueMapper:gt!==Re?gt:null}})),this.Table=(_e=this,Gc($m.prototype,function(We,ot,Ze){this.db=_e,this._tx=Ze,this.name=We,this.schema=ot,this.hook=_e._allTables[We]?_e._allTables[We].hook:el(null,{creating:[Te,Ge],reading:[H,Re],updating:[oe,Ge],deleting:[ce,Ge]})})),this.Transaction=(De=this,Gc(Hm.prototype,function(We,ot,Ze,nt,lt){var et=this;this.db=De,this.mode=We,this.storeNames=ot,this.schema=Ze,this.chromeTransactionDurability=nt,this.idbtrans=null,this.on=el(this,"complete","error","abort"),this.parent=lt||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new B(function(gt,xt){et._resolve=gt,et._reject=xt}),this._completion.then(function(){et.active=!1,et.on.complete.fire()},function(gt){var xt=et.active;return et.active=!1,et.on.error.fire(gt),et.parent?et.parent._reject(gt):xt&&et.idbtrans&&et.idbtrans.abort(),rs(gt)})})),this.Version=($e=this,Gc(_S.prototype,function(We){this.db=$e,this._cfg={version:We,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Ye=this,Gc(Gl.prototype,function(We,ot,Ze){if(this.db=Ye,this._ctx={table:We,index:ot===":id"?null:ot,or:Ze},this._cmp=this._ascending=er,this._descending=function(nt,lt){return er(lt,nt)},this._max=function(nt,lt){return 0<er(nt,lt)?nt:lt},this._min=function(nt,lt){return er(nt,lt)<0?nt:lt},this._IDBKeyRange=Ye._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ce.MissingAPI})),this.on("versionchange",function(We){0<We.newVersion?console.warn("Another connection wants to upgrade database '".concat(J.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(J.name,"'. Closing db now to resume the delete request.")),J.close({disableAutoOpen:!1})}),this.on("blocked",function(We){!We.newVersion||We.newVersion<We.oldVersion?console.warn("Dexie.delete('".concat(J.name,"') was blocked")):console.warn("Upgrade '".concat(J.name,"' blocked by other connection holding version ").concat(We.oldVersion/10))}),this._maxKey=eu(F.IDBKeyRange),this._createTransaction=function(We,ot,Ze,nt){return new J.Transaction(We,ot,Ze,J._options.chromeTransactionDurability,nt)},this._fireOnBlocked=function(We){J.on("blocked").fire(We),mo.filter(function(ot){return ot.name===J.name&&ot!==J&&!ot._state.vcFired}).map(function(ot){return ot.on("versionchange").fire(We)})},this.use(Qb),this.use(xh),this.use(CS),this.use(ES),this.use(Jb);var st=new Proxy(this,{get:function(We,ot,Ze){if(ot==="_vip")return!0;if(ot==="table")return function(lt){return Fd(J.table(lt),st)};var nt=Reflect.get(We,ot,Ze);return nt instanceof $m?Fd(nt,st):ot==="tables"?nt.map(function(lt){return Fd(lt,st)}):ot==="_createTransaction"?function(){return Fd(nt.apply(this,arguments),st)}:nt}});this.vip=st,ie.forEach(function(We){return We(J)})}var su,Di=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",nv=(_h.prototype.subscribe=function(A,F,J){return this._subscribe(A&&typeof A!="function"?A:{next:A,error:F,complete:J})},_h.prototype[Di]=function(){return this},_h);function _h(A){this._subscribe=A}try{su={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{su={indexedDB:null,IDBKeyRange:null}}function rv(A){var F,J=!1,ie=new nv(function(de){var _e=te(A),De,$e=!1,Ye={},Qe={},st={get closed(){return $e},unsubscribe:function(){$e||($e=!0,De&&De.abort(),We&&zs.storagemutated.unsubscribe(Ze))}};de.start&&de.start(st);var We=!1,ot=function(){return Xo(nt)},Ze=function(lt){gh(Ye,lt),Jm(Qe,Ye)&&ot()},nt=function(){var lt,et,gt;!$e&&su.indexedDB&&(Ye={},lt={},De&&De.abort(),De=new AbortController,gt=function(xt){var _t=G();try{_e&&qn();var kt=an(A,xt);return kt=_e?kt.finally(Qn):kt}finally{_t&&U()}}(et={subscr:lt,signal:De.signal,requery:ot,querier:A,trans:null}),Promise.resolve(gt).then(function(xt){J=!0,F=xt,$e||et.signal.aborted||(Ye={},function(_t){for(var kt in _t)if(f(_t,kt))return;return 1}(Qe=lt)||We||(zs(Jc,Ze),We=!0),Xo(function(){return!$e&&de.next&&de.next(xt)}))},function(xt){J=!1,["DatabaseClosedError","AbortError"].includes(xt==null?void 0:xt.name)||$e||Xo(function(){$e||de.error&&de.error(xt)})}))};return setTimeout(ot,0),st});return ie.hasValue=function(){return J},ie.getValue=function(){return F},ie}var Ql=La;function sg(A){var F=rl;try{rl=!0,zs.storagemutated.fire(A),tg(A,!0)}finally{rl=F}}m(Ql,r(r({},it),{delete:function(A){return new Ql(A,{addons:[]}).delete()},exists:function(A){return new Ql(A,{addons:[]}).open().then(function(F){return F.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(A){try{return F=Ql.dependencies,J=F.indexedDB,F=F.IDBKeyRange,(ph(J)?Promise.resolve(J.databases()).then(function(ie){return ie.map(function(de){return de.name}).filter(function(de){return de!==Ul})}):Wm(J,F).toCollection().primaryKeys()).then(A)}catch{return rs(new Ce.MissingAPI)}var F,J},defineClass:function(){return function(A){l(this,A)}},ignoreTransaction:function(A){return Ae.trans?Zo(Ae.transless,A):A()},vip:Zm,async:function(A){return function(){try{var F=Pd(A.apply(this,arguments));return F&&typeof F.then=="function"?F:B.resolve(F)}catch(J){return rs(J)}}},spawn:function(A,F,J){try{var ie=Pd(A.apply(J,F||[]));return ie&&typeof ie.then=="function"?ie:B.resolve(ie)}catch(de){return rs(de)}},currentTransaction:{get:function(){return Ae.trans||null}},waitFor:function(A,F){return F=B.resolve(typeof A=="function"?Ql.ignoreTransaction(A):A).timeout(F||6e4),Ae.trans?Ae.trans.waitFor(F):F},Promise:B,debug:{get:function(){return Fe},set:function(A){ke(A)}},derive:b,extend:l,props:m,override:E,Events:el,on:zs,liveQuery:rv,extendObservabilitySet:gh,getByKeyPath:R,setByKeyPath:I,delByKeyPath:function(A,F){typeof F=="string"?I(A,F,void 0):"length"in F&&[].map.call(F,function(J){I(A,J,void 0)})},shallowClone:j,deepClone:V,getObjectDiff:bh,cmp:er,asap:k,minKey:-1/0,addons:[],connections:mo,errnames:Pe,dependencies:su,cache:Xl,semVer:"4.0.11",version:"4.0.11".split(".").map(function(A){return parseInt(A)}).reduce(function(A,F,J){return A+F/Math.pow(10,2*J)})})),Ql.maxKey=eu(Ql.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(zs(Jc,function(A){rl||(A=new CustomEvent(Wl,{detail:A}),rl=!0,dispatchEvent(A),rl=!1)}),addEventListener(Wl,function(A){A=A.detail,rl||sg(A)}));var iu,rl=!1,bi=function(){};return typeof BroadcastChannel<"u"&&((bi=function(){(iu=new BroadcastChannel(Wl)).onmessage=function(A){return A.data&&sg(A.data)}})(),typeof iu.unref=="function"&&iu.unref(),zs(Jc,function(A){rl||iu.postMessage(A)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(A){if(!La.disableBfCache&&A.persisted){Fe&&console.debug("Dexie: handling persisted pagehide"),iu!=null&&iu.close();for(var F=0,J=mo;F<J.length;F++)J[F].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(A){!La.disableBfCache&&A.persisted&&(Fe&&console.debug("Dexie: handling persisted pageshow"),bi(),sg({all:new Us(-1/0,[[]])}))})),B.rejectionMapper=function(A,F){return!A||A instanceof ae||A instanceof TypeError||A instanceof SyntaxError||!A.name||!He[A.name]?A:(F=new He[A.name](F||A.message,A),"stack"in A&&v(F,"stack",{get:function(){return this.inner.stack}}),F)},ke(Fe),r(La,Object.freeze({__proto__:null,Dexie:La,liveQuery:rv,Entity:rh,cmp:er,PropModification:Zc,replacePrefix:function(A,F){return new Zc({replacePrefix:[A,F]})},add:function(A){return new Zc({add:A})},remove:function(A){return new Zc({remove:A})},default:La,RangeSet:Us,mergeRanges:Yl,rangesOverlap:Zb}),{default:La}),La})}(Hw)),Hw.exports}var YJ=ZJ();const NT=Ni(YJ),L4=Symbol.for("Dexie"),dx=globalThis[L4]||(globalThis[L4]=NT);if(NT.semVer!==dx.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${NT.semVer} and ${dx.semVer}`);const{liveQuery:DMe,mergeRanges:FMe,rangesOverlap:LMe,RangeSet:BMe,cmp:$Me,Entity:zMe,PropModification:UMe,replacePrefix:qMe,add:VMe,remove:HMe}=dx;class XJ extends dx{constructor(){super("LiteChatDatabase_Rewrite_v1");Ne(this,"conversations");Ne(this,"interactions");Ne(this,"mods");Ne(this,"appState");Ne(this,"providerConfigs");Ne(this,"apiKeys");Ne(this,"syncRepos");Ne(this,"projects");Ne(this,"rules");Ne(this,"tags");Ne(this,"tagRuleLinks");this.version(8).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const At=new XJ,Ks=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class Rt{static async loadConversations(){try{return(await At.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>Ks(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await At.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await At.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await At.interactions.where({conversationId:t}).sortBy("index")).map(r=>Ks(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await At.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await At.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await At.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await At.mods.orderBy("loadOrder").toArray()).map(n=>Ks(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await At.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await At.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await At.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await At.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=At.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>Ks(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await At.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await At.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=At.apiKeys)==null?void 0:t.toArray())??[]).map(r=>Ks(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await At.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await At.transaction("rw",[At.apiKeys,At.providerConfigs],async()=>{const n=await At.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(s=>At.providerConfigs.update(s.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await At.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await At.syncRepos.toArray()).map(n=>Ks(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await At.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await At.transaction("rw",[At.syncRepos,At.conversations],async()=>{const n=await At.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(s=>At.conversations.update(s.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await At.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await At.projects.orderBy("updatedAt").reverse().toArray()).map(n=>Ks(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,defaultTagIds:t.defaultTagIds??null,defaultRuleIds:t.defaultRuleIds??null,metadata:t.metadata?{...t.metadata}:{}};return await At.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const s=await At.projects.where("parentId").equals(r).toArray();for(const i of s)await n(i.id);await At.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await At.transaction("rw",[At.projects],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await At.rules.orderBy("name").toArray()).map(n=>Ks(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await At.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await At.transaction("rw",[At.rules,At.tagRuleLinks],async()=>{await At.tagRuleLinks.where("ruleId").equals(t).delete(),await At.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await At.tags.orderBy("name").toArray()).map(n=>Ks(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await At.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await At.transaction("rw",[At.tags,At.tagRuleLinks],async()=>{await At.tagRuleLinks.where("tagId").equals(t).delete(),await At.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await At.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await At.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await At.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async getAllDataForExport(t){const n={version:1,exportedAt:new Date().toISOString()};if(t.importSettings){const r=await At.appState.toArray();n.settings={},r.forEach(s=>{s.key.startsWith("settings:")&&(n.settings[s.key.substring(9)]=s.value)})}return t.importApiKeys&&(n.apiKeys=await At.apiKeys.toArray()),t.importProviderConfigs&&(n.providerConfigs=await At.providerConfigs.toArray()),t.importProjects&&(n.projects=await At.projects.toArray()),t.importConversations&&(n.conversations=await At.conversations.toArray(),n.interactions=await At.interactions.toArray()),t.importRulesAndTags&&(n.rules=await At.rules.toArray(),n.tags=await At.tags.toArray(),n.tagRuleLinks=await At.tagRuleLinks.toArray()),t.importMods&&(n.mods=await At.mods.toArray()),t.importSyncRepos&&(n.syncRepos=await At.syncRepos.toArray()),n}static async importAllData(t,n){if(t.version!==1)throw new Error(`Unsupported export version: ${t.version}. Expected version 1.`);await At.transaction("rw",[At.appState,At.apiKeys,At.providerConfigs,At.projects,At.conversations,At.interactions,At.rules,At.tags,At.tagRuleLinks,At.mods,At.syncRepos],async()=>{if(n.importSettings&&await At.appState.clear(),n.importApiKeys&&await At.apiKeys.clear(),n.importProviderConfigs&&await At.providerConfigs.clear(),n.importProjects&&await At.projects.clear(),n.importConversations&&(await At.conversations.clear(),await At.interactions.clear()),n.importRulesAndTags&&(await At.rules.clear(),await At.tags.clear(),await At.tagRuleLinks.clear()),n.importMods&&await At.mods.clear(),n.importSyncRepos&&await At.syncRepos.clear(),n.importSettings&&t.settings){const r=Object.entries(t.settings).map(([s,i])=>({key:`settings:${s}`,value:i}));await At.appState.bulkPut(r)}n.importApiKeys&&t.apiKeys&&await At.apiKeys.bulkPut(t.apiKeys.map(r=>Ks(r))),n.importProviderConfigs&&t.providerConfigs&&await At.providerConfigs.bulkPut(t.providerConfigs.map(r=>Ks(r,["modelsLastFetchedAt"]))),n.importProjects&&t.projects&&await At.projects.bulkPut(t.projects.map(r=>Ks(r))),n.importConversations&&t.conversations&&(await At.conversations.bulkPut(t.conversations.map(r=>Ks(r,["lastSyncedAt"]))),t.interactions&&await At.interactions.bulkPut(t.interactions.map(r=>Ks(r,["startedAt","endedAt"])))),n.importRulesAndTags&&(t.rules&&await At.rules.bulkPut(t.rules.map(r=>Ks(r))),t.tags&&await At.tags.bulkPut(t.tags.map(r=>Ks(r))),t.tagRuleLinks&&await At.tagRuleLinks.bulkPut(t.tagRuleLinks)),n.importMods&&t.mods&&await At.mods.bulkPut(t.mods.map(r=>Ks(r))),n.importSyncRepos&&t.syncRepos&&await At.syncRepos.bulkPut(t.syncRepos.map(r=>Ks(r,["lastPulledAt","lastPushedAt"])))})}static async clearAllData(){try{await At.transaction("rw",[At.conversations,At.interactions,At.mods,At.appState,At.providerConfigs,At.apiKeys,At.syncRepos,At.projects,At.rules,At.tags,At.tagRuleLinks],async()=>{await At.interactions.clear(),await At.conversations.clear(),await At.projects.clear(),await At.mods.clear(),await At.appState.clear(),await At.providerConfigs.clear(),await At.apiKeys.clear(),await At.syncRepos.clear(),await At.rules.clear(),await At.tags.clear(),await At.tagRuleLinks.clear()}),console.log("PersistenceService: All data cleared.")}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}const On={loaded:"interaction.loaded",currentConversationIdChanged:"interaction.current.conversation.id.changed",added:"interaction.added",updated:"interaction.updated",streamingIdsChanged:"interaction.streaming.ids.changed",activeStreamBuffersChanged:"interaction.active.stream.buffers.changed",activeReasoningBuffersChanged:"interaction.active.reasoning.buffers.changed",statusChanged:"interaction.status.changed",errorChanged:"interaction.error.changed",interactionRated:"interaction.rated",started:"interaction.sdk.started",streamChunk:"interaction.sdk.streamChunk",completed:"interaction.sdk.completed",loadInteractionsRequest:"interaction.load.interactions.request",rateInteractionRequest:"interaction.rate.interaction.request",setCurrentConversationIdRequest:"interaction.set.current.conversation.id.request",clearInteractionsRequest:"interaction.clear.interactions.request",setErrorRequest:"interaction.set.error.request",setStatusRequest:"interaction.set.status.request"};var ko=L8();const gF=Ni(ko);function JJ(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const QJ=e=>{switch(e){case"success":return nQ;case"info":return sQ;case"warning":return rQ;case"error":return iQ;default:return null}},eQ=Array(12).fill(0),tQ=({visible:e,className:t})=>dt.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},dt.createElement("div",{className:"sonner-spinner"},eQ.map((n,r)=>dt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),nQ=dt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},dt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),rQ=dt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},dt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),sQ=dt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},dt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),iQ=dt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},dt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),aQ=dt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},dt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),dt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),oQ=()=>{const[e,t]=dt.useState(document.hidden);return dt.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let IT=1;class lQ{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:IT++,a=this.toasts.find(l=>l.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let i=r!==void 0,a;const o=s.then(async c=>{if(a=["resolve",c],dt.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(uQ(c)&&!c.ok){i=!1;const f=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,m=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description,v=typeof f=="object"&&!dt.isValidElement(f)?f:{message:f};this.create({id:r,type:"error",description:m,...v})}else if(c instanceof Error){i=!1;const f=typeof n.error=="function"?await n.error(c):n.error,m=typeof n.description=="function"?await n.description(c):n.description,v=typeof f=="object"&&!dt.isValidElement(f)?f:{message:f};this.create({id:r,type:"error",description:m,...v})}else if(n.success!==void 0){i=!1;const f=typeof n.success=="function"?await n.success(c):n.success,m=typeof n.description=="function"?await n.description(c):n.description,v=typeof f=="object"&&!dt.isValidElement(f)?f:{message:f};this.create({id:r,type:"success",description:m,...v})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;const u=typeof n.error=="function"?await n.error(c):n.error,f=typeof n.description=="function"?await n.description(c):n.description,g=typeof u=="object"&&!dt.isValidElement(u)?u:{message:u};this.create({id:r,type:"error",description:f,...g})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||IT++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const ea=new lQ,cQ=(e,t)=>{const n=(t==null?void 0:t.id)||IT++;return ea.addToast({title:e,...t,id:n}),n},uQ=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",dQ=cQ,fQ=()=>ea.toasts,hQ=()=>ea.getActiveToasts(),Le=Object.assign(dQ,{success:ea.success,info:ea.info,warning:ea.warning,error:ea.error,custom:ea.custom,message:ea.message,promise:ea.promise,dismiss:ea.dismiss,loading:ea.loading},{getHistory:fQ,getToasts:hQ});JJ("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function nw(e){return e.label!==void 0}const pQ=3,mQ="24px",gQ="16px",B4=4e3,yQ=356,bQ=14,vQ=45,wQ=200;function ul(...e){return e.filter(Boolean).join(" ")}function xQ(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const _Q=e=>{var t,n,r,s,i,a,o,l,c;const{invert:u,toast:f,unstyled:m,interacting:g,setHeights:v,visibleToasts:b,heights:w,index:x,toasts:_,expanded:E,removeToast:C,defaultRichColors:k,closeButton:R,style:I,cancelButtonStyle:j,actionButtonStyle:M,className:L="",descriptionClassName:q="",duration:P,position:V,gap:z,expandByDefault:re,classNames:K,icons:ee,closeButtonAriaLabel:W="Close toast"}=e,[se,Y]=dt.useState(null),[te,Q]=dt.useState(null),[ae,xe]=dt.useState(!1),[ge,Me]=dt.useState(!1),[Pe,Ie]=dt.useState(!1),[Ce,He]=dt.useState(!1),[it,Ge]=dt.useState(!1),[Re,H]=dt.useState(0),[me,Te]=dt.useState(0),ce=dt.useRef(f.duration||P||B4),oe=dt.useRef(null),ne=dt.useRef(null),Se=x===0,Fe=x+1<=b,ke=f.type,Xe=f.dismissible!==!1,St=f.className||"",ht=f.descriptionClassName||"",It=dt.useMemo(()=>w.findIndex(we=>we.toastId===f.id)||0,[w,f.id]),Vt=dt.useMemo(()=>{var we;return(we=f.closeButton)!=null?we:R},[f.closeButton,R]),Ot=dt.useMemo(()=>f.duration||P||B4,[f.duration,P]),Gt=dt.useRef(0),be=dt.useRef(0),O=dt.useRef(0),Z=dt.useRef(null),[fe,Oe]=V.split("-"),ve=dt.useMemo(()=>w.reduce((we,Ue,Et)=>Et>=It?we:we+Ue.height,0),[w,It]),Ae=oQ(),ue=f.invert||u,mt=ke==="loading";be.current=dt.useMemo(()=>It*z+ve,[It,ve]),dt.useEffect(()=>{ce.current=Ot},[Ot]),dt.useEffect(()=>{xe(!0)},[]),dt.useEffect(()=>{const we=ne.current;if(we){const Ue=we.getBoundingClientRect().height;return Te(Ue),v(Et=>[{toastId:f.id,height:Ue,position:f.position},...Et]),()=>v(Et=>Et.filter(he=>he.toastId!==f.id))}},[v,f.id]),dt.useLayoutEffect(()=>{if(!ae)return;const we=ne.current,Ue=we.style.height;we.style.height="auto";const Et=we.getBoundingClientRect().height;we.style.height=Ue,Te(Et),v(he=>he.find(U=>U.toastId===f.id)?he.map(U=>U.toastId===f.id?{...U,height:Et}:U):[{toastId:f.id,height:Et,position:f.position},...he])},[ae,f.title,f.description,v,f.id]);const wt=dt.useCallback(()=>{Me(!0),H(be.current),v(we=>we.filter(Ue=>Ue.toastId!==f.id)),setTimeout(()=>{C(f)},wQ)},[f,C,v,be]);dt.useEffect(()=>{if(f.promise&&ke==="loading"||f.duration===1/0||f.type==="loading")return;let we;return E||g||Ae?(()=>{if(O.current<Gt.current){const he=new Date().getTime()-Gt.current;ce.current=ce.current-he}O.current=new Date().getTime()})():(()=>{ce.current!==1/0&&(Gt.current=new Date().getTime(),we=setTimeout(()=>{f.onAutoClose==null||f.onAutoClose.call(f,f),wt()},ce.current))})(),()=>clearTimeout(we)},[E,g,f,ke,Ae,wt]),dt.useEffect(()=>{f.delete&&wt()},[wt,f.delete]);function B(){var we;if(ee!=null&&ee.loading){var Ue;return dt.createElement("div",{className:ul(K==null?void 0:K.loader,f==null||(Ue=f.classNames)==null?void 0:Ue.loader,"sonner-loader"),"data-visible":ke==="loading"},ee.loading)}return dt.createElement(tQ,{className:ul(K==null?void 0:K.loader,f==null||(we=f.classNames)==null?void 0:we.loader),visible:ke==="loading"})}const ze=f.icon||(ee==null?void 0:ee[ke])||QJ(ke);var rt,ye;return dt.createElement("li",{tabIndex:0,ref:ne,className:ul(L,St,K==null?void 0:K.toast,f==null||(t=f.classNames)==null?void 0:t.toast,K==null?void 0:K.default,K==null?void 0:K[ke],f==null||(n=f.classNames)==null?void 0:n[ke]),"data-sonner-toast":"","data-rich-colors":(rt=f.richColors)!=null?rt:k,"data-styled":!(f.jsx||f.unstyled||m),"data-mounted":ae,"data-promise":!!f.promise,"data-swiped":it,"data-removed":ge,"data-visible":Fe,"data-y-position":fe,"data-x-position":Oe,"data-index":x,"data-front":Se,"data-swiping":Pe,"data-dismissible":Xe,"data-type":ke,"data-invert":ue,"data-swipe-out":Ce,"data-swipe-direction":te,"data-expanded":!!(E||re&&ae),style:{"--index":x,"--toasts-before":x,"--z-index":_.length-x,"--offset":`${ge?Re:be.current}px`,"--initial-height":re?"auto":`${me}px`,...I,...f.style},onDragEnd:()=>{Ie(!1),Y(null),Z.current=null},onPointerDown:we=>{mt||!Xe||(oe.current=new Date,H(be.current),we.target.setPointerCapture(we.pointerId),we.target.tagName!=="BUTTON"&&(Ie(!0),Z.current={x:we.clientX,y:we.clientY}))},onPointerUp:()=>{var we,Ue,Et;if(Ce||!Xe)return;Z.current=null;const he=Number(((we=ne.current)==null?void 0:we.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),G=Number(((Ue=ne.current)==null?void 0:Ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),U=new Date().getTime()-((Et=oe.current)==null?void 0:Et.getTime()),X=se==="x"?he:G,pe=Math.abs(X)/U;if(Math.abs(X)>=vQ||pe>.11){H(be.current),f.onDismiss==null||f.onDismiss.call(f,f),Q(se==="x"?he>0?"right":"left":G>0?"down":"up"),wt(),He(!0);return}else{var je,Ke;(je=ne.current)==null||je.style.setProperty("--swipe-amount-x","0px"),(Ke=ne.current)==null||Ke.style.setProperty("--swipe-amount-y","0px")}Ge(!1),Ie(!1),Y(null)},onPointerMove:we=>{var Ue,Et,he;if(!Z.current||!Xe||((Ue=window.getSelection())==null?void 0:Ue.toString().length)>0)return;const U=we.clientY-Z.current.y,X=we.clientX-Z.current.x;var pe;const je=(pe=e.swipeDirections)!=null?pe:xQ(V);!se&&(Math.abs(X)>1||Math.abs(U)>1)&&Y(Math.abs(X)>Math.abs(U)?"x":"y");let Ke={x:0,y:0};const bt=Kt=>1/(1.5+Math.abs(Kt)/20);if(se==="y"){if(je.includes("top")||je.includes("bottom"))if(je.includes("top")&&U<0||je.includes("bottom")&&U>0)Ke.y=U;else{const Kt=U*bt(U);Ke.y=Math.abs(Kt)<Math.abs(U)?Kt:U}}else if(se==="x"&&(je.includes("left")||je.includes("right")))if(je.includes("left")&&X<0||je.includes("right")&&X>0)Ke.x=X;else{const Kt=X*bt(X);Ke.x=Math.abs(Kt)<Math.abs(X)?Kt:X}(Math.abs(Ke.x)>0||Math.abs(Ke.y)>0)&&Ge(!0),(Et=ne.current)==null||Et.style.setProperty("--swipe-amount-x",`${Ke.x}px`),(he=ne.current)==null||he.style.setProperty("--swipe-amount-y",`${Ke.y}px`)}},Vt&&!f.jsx&&ke!=="loading"?dt.createElement("button",{"aria-label":W,"data-disabled":mt,"data-close-button":!0,onClick:mt||!Xe?()=>{}:()=>{wt(),f.onDismiss==null||f.onDismiss.call(f,f)},className:ul(K==null?void 0:K.closeButton,f==null||(r=f.classNames)==null?void 0:r.closeButton)},(ye=ee==null?void 0:ee.close)!=null?ye:aQ):null,(ke||f.icon||f.promise)&&f.icon!==null&&((ee==null?void 0:ee[ke])!==null||f.icon)?dt.createElement("div",{"data-icon":"",className:ul(K==null?void 0:K.icon,f==null||(s=f.classNames)==null?void 0:s.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||B():null,f.type!=="loading"?ze:null):null,dt.createElement("div",{"data-content":"",className:ul(K==null?void 0:K.content,f==null||(i=f.classNames)==null?void 0:i.content)},dt.createElement("div",{"data-title":"",className:ul(K==null?void 0:K.title,f==null||(a=f.classNames)==null?void 0:a.title)},f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title),f.description?dt.createElement("div",{"data-description":"",className:ul(q,ht,K==null?void 0:K.description,f==null||(o=f.classNames)==null?void 0:o.description)},typeof f.description=="function"?f.description():f.description):null),dt.isValidElement(f.cancel)?f.cancel:f.cancel&&nw(f.cancel)?dt.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||j,onClick:we=>{nw(f.cancel)&&Xe&&(f.cancel.onClick==null||f.cancel.onClick.call(f.cancel,we),wt())},className:ul(K==null?void 0:K.cancelButton,f==null||(l=f.classNames)==null?void 0:l.cancelButton)},f.cancel.label):null,dt.isValidElement(f.action)?f.action:f.action&&nw(f.action)?dt.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||M,onClick:we=>{nw(f.action)&&(f.action.onClick==null||f.action.onClick.call(f.action,we),!we.defaultPrevented&&wt())},className:ul(K==null?void 0:K.actionButton,f==null||(c=f.classNames)==null?void 0:c.actionButton)},f.action.label):null)};function $4(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function SQ(e,t){const n={};return[e,t].forEach((r,s)=>{const i=s===1,a=i?"--mobile-offset":"--offset",o=i?gQ:mQ;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=o:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}const EQ=dt.forwardRef(function(t,n){const{invert:r,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:f="light",richColors:m,duration:g,style:v,visibleToasts:b=pQ,toastOptions:w,dir:x=$4(),gap:_=bQ,icons:E,containerAriaLabel:C="Notifications"}=t,[k,R]=dt.useState([]),I=dt.useMemo(()=>Array.from(new Set([s].concat(k.filter(te=>te.position).map(te=>te.position)))),[k,s]),[j,M]=dt.useState([]),[L,q]=dt.useState(!1),[P,V]=dt.useState(!1),[z,re]=dt.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),K=dt.useRef(null),ee=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),W=dt.useRef(null),se=dt.useRef(!1),Y=dt.useCallback(te=>{R(Q=>{var ae;return(ae=Q.find(xe=>xe.id===te.id))!=null&&ae.delete||ea.dismiss(te.id),Q.filter(({id:xe})=>xe!==te.id)})},[]);return dt.useEffect(()=>ea.subscribe(te=>{if(te.dismiss){requestAnimationFrame(()=>{R(Q=>Q.map(ae=>ae.id===te.id?{...ae,delete:!0}:ae))});return}setTimeout(()=>{gF.flushSync(()=>{R(Q=>{const ae=Q.findIndex(xe=>xe.id===te.id);return ae!==-1?[...Q.slice(0,ae),{...Q[ae],...te},...Q.slice(ae+1)]:[te,...Q]})})})}),[k]),dt.useEffect(()=>{if(f!=="system"){re(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?re("dark"):re("light")),typeof window>"u")return;const te=window.matchMedia("(prefers-color-scheme: dark)");try{te.addEventListener("change",({matches:Q})=>{re(Q?"dark":"light")})}catch{te.addListener(({matches:ae})=>{try{re(ae?"dark":"light")}catch(xe){console.error(xe)}})}},[f]),dt.useEffect(()=>{k.length<=1&&q(!1)},[k]),dt.useEffect(()=>{const te=Q=>{var ae;if(i.every(Me=>Q[Me]||Q.code===Me)){var ge;q(!0),(ge=K.current)==null||ge.focus()}Q.code==="Escape"&&(document.activeElement===K.current||(ae=K.current)!=null&&ae.contains(document.activeElement))&&q(!1)};return document.addEventListener("keydown",te),()=>document.removeEventListener("keydown",te)},[i]),dt.useEffect(()=>{if(K.current)return()=>{W.current&&(W.current.focus({preventScroll:!0}),W.current=null,se.current=!1)}},[K.current]),dt.createElement("section",{ref:n,"aria-label":`${C} ${ee}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},I.map((te,Q)=>{var ae;const[xe,ge]=te.split("-");return k.length?dt.createElement("ol",{key:te,dir:x==="auto"?$4():x,tabIndex:-1,ref:K,className:l,"data-sonner-toaster":!0,"data-sonner-theme":z,"data-y-position":xe,"data-lifted":L&&k.length>1&&!a,"data-x-position":ge,style:{"--front-toast-height":`${((ae=j[0])==null?void 0:ae.height)||0}px`,"--width":`${yQ}px`,"--gap":`${_}px`,...v,...SQ(c,u)},onBlur:Me=>{se.current&&!Me.currentTarget.contains(Me.relatedTarget)&&(se.current=!1,W.current&&(W.current.focus({preventScroll:!0}),W.current=null))},onFocus:Me=>{Me.target instanceof HTMLElement&&Me.target.dataset.dismissible==="false"||se.current||(se.current=!0,W.current=Me.relatedTarget)},onMouseEnter:()=>q(!0),onMouseMove:()=>q(!0),onMouseLeave:()=>{P||q(!1)},onDragEnd:()=>q(!1),onPointerDown:Me=>{Me.target instanceof HTMLElement&&Me.target.dataset.dismissible==="false"||V(!0)},onPointerUp:()=>V(!1)},k.filter(Me=>!Me.position&&Q===0||Me.position===te).map((Me,Pe)=>{var Ie,Ce;return dt.createElement(_Q,{key:Me.id,icons:E,index:Pe,toast:Me,defaultRichColors:m,duration:(Ie=w==null?void 0:w.duration)!=null?Ie:g,className:w==null?void 0:w.className,descriptionClassName:w==null?void 0:w.descriptionClassName,invert:r,visibleToasts:b,closeButton:(Ce=w==null?void 0:w.closeButton)!=null?Ce:o,interacting:P,position:te,style:w==null?void 0:w.style,unstyled:w==null?void 0:w.unstyled,classNames:w==null?void 0:w.classNames,cancelButtonStyle:w==null?void 0:w.cancelButtonStyle,actionButtonStyle:w==null?void 0:w.actionButtonStyle,closeButtonAriaLabel:w==null?void 0:w.closeButtonAriaLabel,removeToast:Y,toasts:k.filter(He=>He.position==Me.position),heights:j.filter(He=>He.position==Me.position),setHeights:M,expandByDefault:a,gap:_,expanded:L,swipeDirections:t.swipeDirections})})):null}))}),Bn=oo(lo((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(t().currentConversationId!==n){console.warn(`InteractionStore: loadInteractions called for ${n}, but current is ${t().currentConversationId}. Aborting load.`);return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{}}),r!=="loading"&&Be.emit(On.statusChanged,{status:"loading"});try{const s=await Rt.loadInteractionsForConversation(n);s.sort((l,c)=>l.index-c.index);const i=t().interactions.filter(l=>l.conversationId===n),a=new Set(s.map(l=>l.id)),o=[...s,...i.filter(l=>!a.has(l.id))];o.sort((l,c)=>l.index-c.index),t().currentConversationId===n?(e({interactions:o,status:"idle"}),Be.emit(On.loaded,{conversationId:n,interactions:o}),Be.emit(On.statusChanged,{status:"idle"})):console.warn(`InteractionStore: loadInteractions for ${n} completed, but currentConversationId changed during fetch to ${t().currentConversationId}. Discarding.`)}catch(s){console.error(`InteractionStore: Error loading interactions for ${n}`,s),t().currentConversationId===n&&(e({error:"Failed load interactions",status:"error"}),Be.emit(On.statusChanged,{status:"error"}),Be.emit(On.errorChanged,{error:"Failed load interactions"}))}},_addInteractionToState:n=>{e(r=>{if(r.currentConversationId!==n.conversationId){console.warn(`InteractionStore: Attempted to add interaction for ${n.conversationId} but current is ${r.currentConversationId}. Skipping.`);return}if(!r.interactions.some(s=>s.id===n.id))r.interactions.push(n),r.interactions.sort((s,i)=>s.index-i.index);else{const s=r.interactions.findIndex(i=>i.id===n.id);s!==-1&&(r.interactions[s]={...r.interactions[s],...n})}}),Be.emit(On.added,{interaction:n})},_updateInteractionInState:(n,r)=>{e(s=>{const i=s.interactions.findIndex(a=>a.id===n);if(i!==-1){if(s.currentConversationId!==s.interactions[i].conversationId){console.warn(`InteractionStore: Attempted to update interaction ${n} which is not in the current conversation ${s.currentConversationId}. Skipping.`);return}const a=s.interactions[i];let o={...a.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]),r.metadata.reasoning!==void 0&&(o.reasoning=r.metadata.reasoning));const l={...a,...r,metadata:o};"response"in r&&(l.response=r.response),"rating"in r&&(l.rating=r.rating),s.interactions[i]=l}}),Be.emit(On.updated,{interactionId:n,updates:r})},appendInteractionResponseChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeStreamBuffers[n]=(s.activeStreamBuffers[n]||"")+r)}),Be.emit(On.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendReasoningChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeReasoningBuffers[n]=(s.activeReasoningBuffers[n]||"")+r)}),Be.emit(On.activeReasoningBuffersChanged,{buffers:t().activeReasoningBuffers})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(s=>s.id!==n)})},rateInteraction:async(n,r)=>{const s=t().interactions.find(i=>i.id===n);if(s&&t().currentConversationId===s.conversationId){t()._updateInteractionInState(n,{rating:r});try{await Rt.saveInteraction({...s,rating:r}),Be.emit(On.interactionRated,{interactionId:n,rating:r})}catch{t()._updateInteractionInState(n,{rating:s.rating}),Le.error("Failed to save rating.")}}},setCurrentConversationId:async n=>{const r=t().currentConversationId;if(r===n){n&&t().interactions.length===0&&t().status!=="loading"?(console.warn(`InteractionStore: Current ID ${n} matches, but no interactions. Forcing reload.`),await t().loadInteractions(n)):console.log(`InteractionStore: setCurrentConversationId called with the same ID (${n}). No change needed or already handled.`);return}console.log(`InteractionStore: Setting current conversation ID from ${r} to ${n}`),e({currentConversationId:n}),Be.emit(On.currentConversationIdChanged,{conversationId:n}),n?await t().loadInteractions(n):t().clearInteractions()},clearInteractions:()=>{const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&Be.emit(On.statusChanged,{status:"idle"}),Be.emit(On.currentConversationIdChanged,{conversationId:null})},setError:n=>{const r=t().status;let s="idle";e(i=>{i.error=n,n?(s="error",i.status="error"):i.status==="error"?(s=i.streamingInteractionIds.length>0?"streaming":"idle",i.status=s):s=i.status}),r!==s&&Be.emit(On.statusChanged,{status:s}),Be.emit(On.errorChanged,{error:n})},setStatus:n=>{t().status!==n&&(e({status:n}),Be.emit(On.statusChanged,{status:n}))},_addStreamingId:n=>{let r=!1;e(s=>{s.streamingInteractionIds.includes(n)||(s.streamingInteractionIds.push(n),s.activeStreamBuffers[n]="",s.activeReasoningBuffers[n]="",s.streamingInteractionIds.length===1&&(s.status="streaming",r=!0),s.error=null)}),r&&Be.emit(On.statusChanged,{status:"streaming"}),Be.emit(On.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},_removeStreamingId:n=>{let r=!1;e(s=>{const i=s.streamingInteractionIds.indexOf(n);i!==-1&&(s.streamingInteractionIds.splice(i,1),delete s.activeStreamBuffers[n],delete s.activeReasoningBuffers[n],s.streamingInteractionIds.length===0&&s.status==="streaming"&&(s.status=s.error?"error":"idle",r=!0))}),r&&Be.emit(On.statusChanged,{status:t().status}),Be.emit(On.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},getRegisteredActionHandlers:()=>{const n="interactionStore",r=t();return[{eventName:On.loadInteractionsRequest,handler:s=>r.loadInteractions(s.conversationId),storeId:n},{eventName:On.rateInteractionRequest,handler:s=>r.rateInteraction(s.interactionId,s.rating),storeId:n},{eventName:On.setCurrentConversationIdRequest,handler:s=>r.setCurrentConversationId(s.id),storeId:n},{eventName:On.clearInteractionsRequest,handler:()=>r.clearInteractions(),storeId:n},{eventName:On.setErrorRequest,handler:s=>r.setError(s.error),storeId:n},{eventName:On.setStatusRequest,handler:s=>r.setStatus(s.status),storeId:n}]}}))),CQ="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let pi=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=CQ[n[e]&63];return t};const eo={attachedFilesChanged:"input.attached.files.changed",addAttachedFileRequest:"input.add.attached.file.request",removeAttachedFileRequest:"input.remove.attached.file.request",clearAttachedFilesRequest:"input.clear.attached.files.request"},Vu=oo(lo((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(s=>{if(s.attachedFilesMetadata.some(a=>a.source==="direct"&&n.source==="direct"?a.name===n.name&&a.size===n.size:a.source==="vfs"&&n.source==="vfs"?a.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const a={id:pi(),...n};s.attachedFilesMetadata.push(a),r=!0}}),r&&Be.emit(eo.attachedFilesChanged,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(s=>{const i=s.attachedFilesMetadata.length;s.attachedFilesMetadata=s.attachedFilesMetadata.filter(a=>a.id!==n),r=s.attachedFilesMetadata.length<i}),r&&Be.emit(eo.attachedFilesChanged,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&Be.emit(eo.attachedFilesChanged,{files:[]})},getRegisteredActionHandlers:()=>{const n="inputStore",r=t();return[{eventName:eo.addAttachedFileRequest,handler:s=>r.addAttachedFile(s),storeId:n},{eventName:eo.removeAttachedFileRequest,handler:s=>r.removeAttachedFile(s.attachmentId),storeId:n},{eventName:eo.clearAttachedFilesRequest,handler:()=>r.clearAttachedFiles(),storeId:n}]}}))),yF=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(yF);const I0=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml"||n.split(".").length<2)return!0;const s="."+n.split(".").pop();return yF.has(s)};var bF="vercel.ai.error",kQ=Symbol.for(bF),vF,TQ=class wF extends Error{constructor({name:t,message:n,cause:r}){super(n),this[vF]=!0,this.name=t,this.cause=r}static isInstance(t){return wF.hasMarker(t,bF)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};vF=kQ;var In=TQ,xF="AI_APICallError",_F=`vercel.ai.error.${xF}`,AQ=Symbol.for(_F),SF,ro=class extends In{constructor({message:t,url:n,requestBodyValues:r,statusCode:s,responseHeaders:i,responseBody:a,cause:o,isRetryable:l=s!=null&&(s===408||s===409||s===429||s>=500),data:c}){super({name:xF,message:t,cause:o}),this[SF]=!0,this.url=n,this.requestBodyValues=r,this.statusCode=s,this.responseHeaders=i,this.responseBody=a,this.isRetryable=l,this.data=c}static isInstance(t){return In.hasMarker(t,_F)}};SF=AQ;var EF="AI_EmptyResponseBodyError",CF=`vercel.ai.error.${EF}`,RQ=Symbol.for(CF),kF,TF=class extends In{constructor({message:t="Empty response body"}={}){super({name:EF,message:t}),this[kF]=!0}static isInstance(t){return In.hasMarker(t,CF)}};kF=RQ;function Hy(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var AF="AI_InvalidArgumentError",RF=`vercel.ai.error.${AF}`,NQ=Symbol.for(RF),NF,IF=class extends In{constructor({message:t,cause:n,argument:r}){super({name:AF,message:t,cause:n}),this[NF]=!0,this.argument=r}static isInstance(t){return In.hasMarker(t,RF)}};NF=NQ;var jF="AI_InvalidPromptError",MF=`vercel.ai.error.${jF}`,IQ=Symbol.for(MF),OF,gc=class extends In{constructor({prompt:t,message:n,cause:r}){super({name:jF,message:`Invalid prompt: ${n}`,cause:r}),this[OF]=!0,this.prompt=t}static isInstance(t){return In.hasMarker(t,MF)}};OF=IQ;var PF="AI_InvalidResponseDataError",DF=`vercel.ai.error.${PF}`,jQ=Symbol.for(DF),FF,vp=class extends In{constructor({data:t,message:n=`Invalid response data: ${JSON.stringify(t)}.`}){super({name:PF,message:n}),this[FF]=!0,this.data=t}static isInstance(t){return In.hasMarker(t,DF)}};FF=jQ;var LF="AI_JSONParseError",BF=`vercel.ai.error.${LF}`,MQ=Symbol.for(BF),$F,fx=class extends In{constructor({text:t,cause:n}){super({name:LF,message:`JSON parsing failed: Text: ${t}.
Error message: ${Hy(n)}`,cause:n}),this[$F]=!0,this.text=t}static isInstance(t){return In.hasMarker(t,BF)}};$F=MQ;var zF="AI_LoadAPIKeyError",UF=`vercel.ai.error.${zF}`,OQ=Symbol.for(UF),qF,rw=class extends In{constructor({message:t}){super({name:zF,message:t}),this[qF]=!0}static isInstance(t){return In.hasMarker(t,UF)}};qF=OQ;var VF="AI_TooManyEmbeddingValuesForCallError",HF=`vercel.ai.error.${VF}`,PQ=Symbol.for(HF),GF,z1=class extends In{constructor(e){super({name:VF,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[GF]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return In.hasMarker(e,HF)}};GF=PQ;var KF="AI_TypeValidationError",WF=`vercel.ai.error.${KF}`,DQ=Symbol.for(WF),ZF,FQ=class jT extends In{constructor({value:t,cause:n}){super({name:KF,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${Hy(n)}`,cause:n}),this[ZF]=!0,this.value=t}static isInstance(t){return In.hasMarker(t,WF)}static wrap({value:t,cause:n}){return jT.isInstance(n)&&n.value===t?n:new jT({value:t,cause:n})}};ZF=DQ;var hx=FQ,YF="AI_UnsupportedFunctionalityError",XF=`vercel.ai.error.${YF}`,LQ=Symbol.for(XF),JF,wr=class extends In{constructor({functionality:t,message:n=`'${t}' functionality not supported.`}){super({name:YF,message:n}),this[JF]=!0,this.functionality=t}static isInstance(t){return In.hasMarker(t,XF)}};JF=LQ;let BQ=(e,t=21)=>(n=t)=>{let r="",s=n|0;for(;s--;)r+=e[Math.random()*e.length|0];return r};var xR={},U1={};U1.byteLength=UQ;U1.toByteArray=VQ;U1.fromByteArray=KQ;var wl=[],Xa=[],$Q=typeof Uint8Array<"u"?Uint8Array:Array,bE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Kh=0,zQ=bE.length;Kh<zQ;++Kh)wl[Kh]=bE[Kh],Xa[bE.charCodeAt(Kh)]=Kh;Xa[45]=62;Xa[95]=63;function QF(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function UQ(e){var t=QF(e),n=t[0],r=t[1];return(n+r)*3/4-r}function qQ(e,t,n){return(t+n)*3/4-n}function VQ(e){var t,n=QF(e),r=n[0],s=n[1],i=new $Q(qQ(e,r,s)),a=0,o=s>0?r-4:r,l;for(l=0;l<o;l+=4)t=Xa[e.charCodeAt(l)]<<18|Xa[e.charCodeAt(l+1)]<<12|Xa[e.charCodeAt(l+2)]<<6|Xa[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return s===2&&(t=Xa[e.charCodeAt(l)]<<2|Xa[e.charCodeAt(l+1)]>>4,i[a++]=t&255),s===1&&(t=Xa[e.charCodeAt(l)]<<10|Xa[e.charCodeAt(l+1)]<<4|Xa[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function HQ(e){return wl[e>>18&63]+wl[e>>12&63]+wl[e>>6&63]+wl[e&63]}function GQ(e,t,n){for(var r,s=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(HQ(r));return s.join("")}function KQ(e){for(var t,n=e.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push(GQ(e,a,a+i>o?o:a+i));return r===1?(t=e[n-1],s.push(wl[t>>2]+wl[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],s.push(wl[t>>10]+wl[t>>4&63]+wl[t<<2&63]+"=")),s.join("")}var _R={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */_R.read=function(e,t,n,r,s){var i,a,o=s*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,f=n?s-1:0,m=n?-1:1,g=e[t+f];for(f+=m,i=g&(1<<-u)-1,g>>=-u,u+=o;u>0;i=i*256+e[t+f],f+=m,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=a*256+e[t+f],f+=m,u-=8);if(i===0)i=1-c;else{if(i===l)return a?NaN:(g?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-c}return(g?-1:1)*a*Math.pow(2,i-r)};_R.write=function(e,t,n,r,s,i){var a,o,l,c=i*8-s-1,u=(1<<c)-1,f=u>>1,m=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,v=r?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+f>=1?t+=m/l:t+=m*Math.pow(2,1-f),t*l>=2&&(a++,l/=2),a+f>=u?(o=0,a=u):a+f>=1?(o=(t*l-1)*Math.pow(2,s),a=a+f):(o=t*Math.pow(2,f-1)*Math.pow(2,s),a=0));s>=8;e[n+g]=o&255,g+=v,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;e[n+g]=a&255,g+=v,a/=256,c-=8);e[n+g-v]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=U1,n=_R,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=k,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const be=new i(1),O={foo:function(){return 42}};return Object.setPrototypeOf(O,i.prototype),Object.setPrototypeOf(be,O),be.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(be){if(be>s)throw new RangeError('The value "'+be+'" is invalid for option "size"');const O=new i(be);return Object.setPrototypeOf(O,u.prototype),O}function u(be,O,Z){if(typeof be=="number"){if(typeof O=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(be)}return f(be,O,Z)}u.poolSize=8192;function f(be,O,Z){if(typeof be=="string")return b(be,O);if(a.isView(be))return x(be);if(be==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof be);if(ht(be,a)||be&&ht(be.buffer,a)||typeof o<"u"&&(ht(be,o)||be&&ht(be.buffer,o)))return _(be,O,Z);if(typeof be=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const fe=be.valueOf&&be.valueOf();if(fe!=null&&fe!==be)return u.from(fe,O,Z);const Oe=E(be);if(Oe)return Oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof be[Symbol.toPrimitive]=="function")return u.from(be[Symbol.toPrimitive]("string"),O,Z);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof be)}u.from=function(be,O,Z){return f(be,O,Z)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function m(be){if(typeof be!="number")throw new TypeError('"size" argument must be of type number');if(be<0)throw new RangeError('The value "'+be+'" is invalid for option "size"')}function g(be,O,Z){return m(be),be<=0?c(be):O!==void 0?typeof Z=="string"?c(be).fill(O,Z):c(be).fill(O):c(be)}u.alloc=function(be,O,Z){return g(be,O,Z)};function v(be){return m(be),c(be<0?0:C(be)|0)}u.allocUnsafe=function(be){return v(be)},u.allocUnsafeSlow=function(be){return v(be)};function b(be,O){if((typeof O!="string"||O==="")&&(O="utf8"),!u.isEncoding(O))throw new TypeError("Unknown encoding: "+O);const Z=R(be,O)|0;let fe=c(Z);const Oe=fe.write(be,O);return Oe!==Z&&(fe=fe.slice(0,Oe)),fe}function w(be){const O=be.length<0?0:C(be.length)|0,Z=c(O);for(let fe=0;fe<O;fe+=1)Z[fe]=be[fe]&255;return Z}function x(be){if(ht(be,i)){const O=new i(be);return _(O.buffer,O.byteOffset,O.byteLength)}return w(be)}function _(be,O,Z){if(O<0||be.byteLength<O)throw new RangeError('"offset" is outside of buffer bounds');if(be.byteLength<O+(Z||0))throw new RangeError('"length" is outside of buffer bounds');let fe;return O===void 0&&Z===void 0?fe=new i(be):Z===void 0?fe=new i(be,O):fe=new i(be,O,Z),Object.setPrototypeOf(fe,u.prototype),fe}function E(be){if(u.isBuffer(be)){const O=C(be.length)|0,Z=c(O);return Z.length===0||be.copy(Z,0,0,O),Z}if(be.length!==void 0)return typeof be.length!="number"||It(be.length)?c(0):w(be);if(be.type==="Buffer"&&Array.isArray(be.data))return w(be.data)}function C(be){if(be>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return be|0}function k(be){return+be!=be&&(be=0),u.alloc(+be)}u.isBuffer=function(O){return O!=null&&O._isBuffer===!0&&O!==u.prototype},u.compare=function(O,Z){if(ht(O,i)&&(O=u.from(O,O.offset,O.byteLength)),ht(Z,i)&&(Z=u.from(Z,Z.offset,Z.byteLength)),!u.isBuffer(O)||!u.isBuffer(Z))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(O===Z)return 0;let fe=O.length,Oe=Z.length;for(let ve=0,Ae=Math.min(fe,Oe);ve<Ae;++ve)if(O[ve]!==Z[ve]){fe=O[ve],Oe=Z[ve];break}return fe<Oe?-1:Oe<fe?1:0},u.isEncoding=function(O){switch(String(O).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(O,Z){if(!Array.isArray(O))throw new TypeError('"list" argument must be an Array of Buffers');if(O.length===0)return u.alloc(0);let fe;if(Z===void 0)for(Z=0,fe=0;fe<O.length;++fe)Z+=O[fe].length;const Oe=u.allocUnsafe(Z);let ve=0;for(fe=0;fe<O.length;++fe){let Ae=O[fe];if(ht(Ae,i))ve+Ae.length>Oe.length?(u.isBuffer(Ae)||(Ae=u.from(Ae)),Ae.copy(Oe,ve)):i.prototype.set.call(Oe,Ae,ve);else if(u.isBuffer(Ae))Ae.copy(Oe,ve);else throw new TypeError('"list" argument must be an Array of Buffers');ve+=Ae.length}return Oe};function R(be,O){if(u.isBuffer(be))return be.length;if(a.isView(be)||ht(be,a))return be.byteLength;if(typeof be!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof be);const Z=be.length,fe=arguments.length>2&&arguments[2]===!0;if(!fe&&Z===0)return 0;let Oe=!1;for(;;)switch(O){case"ascii":case"latin1":case"binary":return Z;case"utf8":case"utf-8":return Se(be).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z*2;case"hex":return Z>>>1;case"base64":return Xe(be).length;default:if(Oe)return fe?-1:Se(be).length;O=(""+O).toLowerCase(),Oe=!0}}u.byteLength=R;function I(be,O,Z){let fe=!1;if((O===void 0||O<0)&&(O=0),O>this.length||((Z===void 0||Z>this.length)&&(Z=this.length),Z<=0)||(Z>>>=0,O>>>=0,Z<=O))return"";for(be||(be="utf8");;)switch(be){case"hex":return Q(this,O,Z);case"utf8":case"utf-8":return ee(this,O,Z);case"ascii":return Y(this,O,Z);case"latin1":case"binary":return te(this,O,Z);case"base64":return K(this,O,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,O,Z);default:if(fe)throw new TypeError("Unknown encoding: "+be);be=(be+"").toLowerCase(),fe=!0}}u.prototype._isBuffer=!0;function j(be,O,Z){const fe=be[O];be[O]=be[Z],be[Z]=fe}u.prototype.swap16=function(){const O=this.length;if(O%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Z=0;Z<O;Z+=2)j(this,Z,Z+1);return this},u.prototype.swap32=function(){const O=this.length;if(O%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Z=0;Z<O;Z+=4)j(this,Z,Z+3),j(this,Z+1,Z+2);return this},u.prototype.swap64=function(){const O=this.length;if(O%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Z=0;Z<O;Z+=8)j(this,Z,Z+7),j(this,Z+1,Z+6),j(this,Z+2,Z+5),j(this,Z+3,Z+4);return this},u.prototype.toString=function(){const O=this.length;return O===0?"":arguments.length===0?ee(this,0,O):I.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(O){if(!u.isBuffer(O))throw new TypeError("Argument must be a Buffer");return this===O?!0:u.compare(this,O)===0},u.prototype.inspect=function(){let O="";const Z=e.INSPECT_MAX_BYTES;return O=this.toString("hex",0,Z).replace(/(.{2})/g,"$1 ").trim(),this.length>Z&&(O+=" ... "),"<Buffer "+O+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(O,Z,fe,Oe,ve){if(ht(O,i)&&(O=u.from(O,O.offset,O.byteLength)),!u.isBuffer(O))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof O);if(Z===void 0&&(Z=0),fe===void 0&&(fe=O?O.length:0),Oe===void 0&&(Oe=0),ve===void 0&&(ve=this.length),Z<0||fe>O.length||Oe<0||ve>this.length)throw new RangeError("out of range index");if(Oe>=ve&&Z>=fe)return 0;if(Oe>=ve)return-1;if(Z>=fe)return 1;if(Z>>>=0,fe>>>=0,Oe>>>=0,ve>>>=0,this===O)return 0;let Ae=ve-Oe,ue=fe-Z;const mt=Math.min(Ae,ue),wt=this.slice(Oe,ve),B=O.slice(Z,fe);for(let ze=0;ze<mt;++ze)if(wt[ze]!==B[ze]){Ae=wt[ze],ue=B[ze];break}return Ae<ue?-1:ue<Ae?1:0};function M(be,O,Z,fe,Oe){if(be.length===0)return-1;if(typeof Z=="string"?(fe=Z,Z=0):Z>2147483647?Z=2147483647:Z<-2147483648&&(Z=-2147483648),Z=+Z,It(Z)&&(Z=Oe?0:be.length-1),Z<0&&(Z=be.length+Z),Z>=be.length){if(Oe)return-1;Z=be.length-1}else if(Z<0)if(Oe)Z=0;else return-1;if(typeof O=="string"&&(O=u.from(O,fe)),u.isBuffer(O))return O.length===0?-1:L(be,O,Z,fe,Oe);if(typeof O=="number")return O=O&255,typeof i.prototype.indexOf=="function"?Oe?i.prototype.indexOf.call(be,O,Z):i.prototype.lastIndexOf.call(be,O,Z):L(be,[O],Z,fe,Oe);throw new TypeError("val must be string, number or Buffer")}function L(be,O,Z,fe,Oe){let ve=1,Ae=be.length,ue=O.length;if(fe!==void 0&&(fe=String(fe).toLowerCase(),fe==="ucs2"||fe==="ucs-2"||fe==="utf16le"||fe==="utf-16le")){if(be.length<2||O.length<2)return-1;ve=2,Ae/=2,ue/=2,Z/=2}function mt(B,ze){return ve===1?B[ze]:B.readUInt16BE(ze*ve)}let wt;if(Oe){let B=-1;for(wt=Z;wt<Ae;wt++)if(mt(be,wt)===mt(O,B===-1?0:wt-B)){if(B===-1&&(B=wt),wt-B+1===ue)return B*ve}else B!==-1&&(wt-=wt-B),B=-1}else for(Z+ue>Ae&&(Z=Ae-ue),wt=Z;wt>=0;wt--){let B=!0;for(let ze=0;ze<ue;ze++)if(mt(be,wt+ze)!==mt(O,ze)){B=!1;break}if(B)return wt}return-1}u.prototype.includes=function(O,Z,fe){return this.indexOf(O,Z,fe)!==-1},u.prototype.indexOf=function(O,Z,fe){return M(this,O,Z,fe,!0)},u.prototype.lastIndexOf=function(O,Z,fe){return M(this,O,Z,fe,!1)};function q(be,O,Z,fe){Z=Number(Z)||0;const Oe=be.length-Z;fe?(fe=Number(fe),fe>Oe&&(fe=Oe)):fe=Oe;const ve=O.length;fe>ve/2&&(fe=ve/2);let Ae;for(Ae=0;Ae<fe;++Ae){const ue=parseInt(O.substr(Ae*2,2),16);if(It(ue))return Ae;be[Z+Ae]=ue}return Ae}function P(be,O,Z,fe){return St(Se(O,be.length-Z),be,Z,fe)}function V(be,O,Z,fe){return St(Fe(O),be,Z,fe)}function z(be,O,Z,fe){return St(Xe(O),be,Z,fe)}function re(be,O,Z,fe){return St(ke(O,be.length-Z),be,Z,fe)}u.prototype.write=function(O,Z,fe,Oe){if(Z===void 0)Oe="utf8",fe=this.length,Z=0;else if(fe===void 0&&typeof Z=="string")Oe=Z,fe=this.length,Z=0;else if(isFinite(Z))Z=Z>>>0,isFinite(fe)?(fe=fe>>>0,Oe===void 0&&(Oe="utf8")):(Oe=fe,fe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ve=this.length-Z;if((fe===void 0||fe>ve)&&(fe=ve),O.length>0&&(fe<0||Z<0)||Z>this.length)throw new RangeError("Attempt to write outside buffer bounds");Oe||(Oe="utf8");let Ae=!1;for(;;)switch(Oe){case"hex":return q(this,O,Z,fe);case"utf8":case"utf-8":return P(this,O,Z,fe);case"ascii":case"latin1":case"binary":return V(this,O,Z,fe);case"base64":return z(this,O,Z,fe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,O,Z,fe);default:if(Ae)throw new TypeError("Unknown encoding: "+Oe);Oe=(""+Oe).toLowerCase(),Ae=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(be,O,Z){return O===0&&Z===be.length?t.fromByteArray(be):t.fromByteArray(be.slice(O,Z))}function ee(be,O,Z){Z=Math.min(be.length,Z);const fe=[];let Oe=O;for(;Oe<Z;){const ve=be[Oe];let Ae=null,ue=ve>239?4:ve>223?3:ve>191?2:1;if(Oe+ue<=Z){let mt,wt,B,ze;switch(ue){case 1:ve<128&&(Ae=ve);break;case 2:mt=be[Oe+1],(mt&192)===128&&(ze=(ve&31)<<6|mt&63,ze>127&&(Ae=ze));break;case 3:mt=be[Oe+1],wt=be[Oe+2],(mt&192)===128&&(wt&192)===128&&(ze=(ve&15)<<12|(mt&63)<<6|wt&63,ze>2047&&(ze<55296||ze>57343)&&(Ae=ze));break;case 4:mt=be[Oe+1],wt=be[Oe+2],B=be[Oe+3],(mt&192)===128&&(wt&192)===128&&(B&192)===128&&(ze=(ve&15)<<18|(mt&63)<<12|(wt&63)<<6|B&63,ze>65535&&ze<1114112&&(Ae=ze))}}Ae===null?(Ae=65533,ue=1):Ae>65535&&(Ae-=65536,fe.push(Ae>>>10&1023|55296),Ae=56320|Ae&1023),fe.push(Ae),Oe+=ue}return se(fe)}const W=4096;function se(be){const O=be.length;if(O<=W)return String.fromCharCode.apply(String,be);let Z="",fe=0;for(;fe<O;)Z+=String.fromCharCode.apply(String,be.slice(fe,fe+=W));return Z}function Y(be,O,Z){let fe="";Z=Math.min(be.length,Z);for(let Oe=O;Oe<Z;++Oe)fe+=String.fromCharCode(be[Oe]&127);return fe}function te(be,O,Z){let fe="";Z=Math.min(be.length,Z);for(let Oe=O;Oe<Z;++Oe)fe+=String.fromCharCode(be[Oe]);return fe}function Q(be,O,Z){const fe=be.length;(!O||O<0)&&(O=0),(!Z||Z<0||Z>fe)&&(Z=fe);let Oe="";for(let ve=O;ve<Z;++ve)Oe+=Vt[be[ve]];return Oe}function ae(be,O,Z){const fe=be.slice(O,Z);let Oe="";for(let ve=0;ve<fe.length-1;ve+=2)Oe+=String.fromCharCode(fe[ve]+fe[ve+1]*256);return Oe}u.prototype.slice=function(O,Z){const fe=this.length;O=~~O,Z=Z===void 0?fe:~~Z,O<0?(O+=fe,O<0&&(O=0)):O>fe&&(O=fe),Z<0?(Z+=fe,Z<0&&(Z=0)):Z>fe&&(Z=fe),Z<O&&(Z=O);const Oe=this.subarray(O,Z);return Object.setPrototypeOf(Oe,u.prototype),Oe};function xe(be,O,Z){if(be%1!==0||be<0)throw new RangeError("offset is not uint");if(be+O>Z)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(O,Z,fe){O=O>>>0,Z=Z>>>0,fe||xe(O,Z,this.length);let Oe=this[O],ve=1,Ae=0;for(;++Ae<Z&&(ve*=256);)Oe+=this[O+Ae]*ve;return Oe},u.prototype.readUintBE=u.prototype.readUIntBE=function(O,Z,fe){O=O>>>0,Z=Z>>>0,fe||xe(O,Z,this.length);let Oe=this[O+--Z],ve=1;for(;Z>0&&(ve*=256);)Oe+=this[O+--Z]*ve;return Oe},u.prototype.readUint8=u.prototype.readUInt8=function(O,Z){return O=O>>>0,Z||xe(O,1,this.length),this[O]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(O,Z){return O=O>>>0,Z||xe(O,2,this.length),this[O]|this[O+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(O,Z){return O=O>>>0,Z||xe(O,2,this.length),this[O]<<8|this[O+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(O,Z){return O=O>>>0,Z||xe(O,4,this.length),(this[O]|this[O+1]<<8|this[O+2]<<16)+this[O+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(O,Z){return O=O>>>0,Z||xe(O,4,this.length),this[O]*16777216+(this[O+1]<<16|this[O+2]<<8|this[O+3])},u.prototype.readBigUInt64LE=Ot(function(O){O=O>>>0,Te(O,"offset");const Z=this[O],fe=this[O+7];(Z===void 0||fe===void 0)&&ce(O,this.length-8);const Oe=Z+this[++O]*2**8+this[++O]*2**16+this[++O]*2**24,ve=this[++O]+this[++O]*2**8+this[++O]*2**16+fe*2**24;return BigInt(Oe)+(BigInt(ve)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ot(function(O){O=O>>>0,Te(O,"offset");const Z=this[O],fe=this[O+7];(Z===void 0||fe===void 0)&&ce(O,this.length-8);const Oe=Z*2**24+this[++O]*2**16+this[++O]*2**8+this[++O],ve=this[++O]*2**24+this[++O]*2**16+this[++O]*2**8+fe;return(BigInt(Oe)<<BigInt(32))+BigInt(ve)}),u.prototype.readIntLE=function(O,Z,fe){O=O>>>0,Z=Z>>>0,fe||xe(O,Z,this.length);let Oe=this[O],ve=1,Ae=0;for(;++Ae<Z&&(ve*=256);)Oe+=this[O+Ae]*ve;return ve*=128,Oe>=ve&&(Oe-=Math.pow(2,8*Z)),Oe},u.prototype.readIntBE=function(O,Z,fe){O=O>>>0,Z=Z>>>0,fe||xe(O,Z,this.length);let Oe=Z,ve=1,Ae=this[O+--Oe];for(;Oe>0&&(ve*=256);)Ae+=this[O+--Oe]*ve;return ve*=128,Ae>=ve&&(Ae-=Math.pow(2,8*Z)),Ae},u.prototype.readInt8=function(O,Z){return O=O>>>0,Z||xe(O,1,this.length),this[O]&128?(255-this[O]+1)*-1:this[O]},u.prototype.readInt16LE=function(O,Z){O=O>>>0,Z||xe(O,2,this.length);const fe=this[O]|this[O+1]<<8;return fe&32768?fe|4294901760:fe},u.prototype.readInt16BE=function(O,Z){O=O>>>0,Z||xe(O,2,this.length);const fe=this[O+1]|this[O]<<8;return fe&32768?fe|4294901760:fe},u.prototype.readInt32LE=function(O,Z){return O=O>>>0,Z||xe(O,4,this.length),this[O]|this[O+1]<<8|this[O+2]<<16|this[O+3]<<24},u.prototype.readInt32BE=function(O,Z){return O=O>>>0,Z||xe(O,4,this.length),this[O]<<24|this[O+1]<<16|this[O+2]<<8|this[O+3]},u.prototype.readBigInt64LE=Ot(function(O){O=O>>>0,Te(O,"offset");const Z=this[O],fe=this[O+7];(Z===void 0||fe===void 0)&&ce(O,this.length-8);const Oe=this[O+4]+this[O+5]*2**8+this[O+6]*2**16+(fe<<24);return(BigInt(Oe)<<BigInt(32))+BigInt(Z+this[++O]*2**8+this[++O]*2**16+this[++O]*2**24)}),u.prototype.readBigInt64BE=Ot(function(O){O=O>>>0,Te(O,"offset");const Z=this[O],fe=this[O+7];(Z===void 0||fe===void 0)&&ce(O,this.length-8);const Oe=(Z<<24)+this[++O]*2**16+this[++O]*2**8+this[++O];return(BigInt(Oe)<<BigInt(32))+BigInt(this[++O]*2**24+this[++O]*2**16+this[++O]*2**8+fe)}),u.prototype.readFloatLE=function(O,Z){return O=O>>>0,Z||xe(O,4,this.length),n.read(this,O,!0,23,4)},u.prototype.readFloatBE=function(O,Z){return O=O>>>0,Z||xe(O,4,this.length),n.read(this,O,!1,23,4)},u.prototype.readDoubleLE=function(O,Z){return O=O>>>0,Z||xe(O,8,this.length),n.read(this,O,!0,52,8)},u.prototype.readDoubleBE=function(O,Z){return O=O>>>0,Z||xe(O,8,this.length),n.read(this,O,!1,52,8)};function ge(be,O,Z,fe,Oe,ve){if(!u.isBuffer(be))throw new TypeError('"buffer" argument must be a Buffer instance');if(O>Oe||O<ve)throw new RangeError('"value" argument is out of bounds');if(Z+fe>be.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(O,Z,fe,Oe){if(O=+O,Z=Z>>>0,fe=fe>>>0,!Oe){const ue=Math.pow(2,8*fe)-1;ge(this,O,Z,fe,ue,0)}let ve=1,Ae=0;for(this[Z]=O&255;++Ae<fe&&(ve*=256);)this[Z+Ae]=O/ve&255;return Z+fe},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(O,Z,fe,Oe){if(O=+O,Z=Z>>>0,fe=fe>>>0,!Oe){const ue=Math.pow(2,8*fe)-1;ge(this,O,Z,fe,ue,0)}let ve=fe-1,Ae=1;for(this[Z+ve]=O&255;--ve>=0&&(Ae*=256);)this[Z+ve]=O/Ae&255;return Z+fe},u.prototype.writeUint8=u.prototype.writeUInt8=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,1,255,0),this[Z]=O&255,Z+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,2,65535,0),this[Z]=O&255,this[Z+1]=O>>>8,Z+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,2,65535,0),this[Z]=O>>>8,this[Z+1]=O&255,Z+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,4,4294967295,0),this[Z+3]=O>>>24,this[Z+2]=O>>>16,this[Z+1]=O>>>8,this[Z]=O&255,Z+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,4,4294967295,0),this[Z]=O>>>24,this[Z+1]=O>>>16,this[Z+2]=O>>>8,this[Z+3]=O&255,Z+4};function Me(be,O,Z,fe,Oe){me(O,fe,Oe,be,Z,7);let ve=Number(O&BigInt(4294967295));be[Z++]=ve,ve=ve>>8,be[Z++]=ve,ve=ve>>8,be[Z++]=ve,ve=ve>>8,be[Z++]=ve;let Ae=Number(O>>BigInt(32)&BigInt(4294967295));return be[Z++]=Ae,Ae=Ae>>8,be[Z++]=Ae,Ae=Ae>>8,be[Z++]=Ae,Ae=Ae>>8,be[Z++]=Ae,Z}function Pe(be,O,Z,fe,Oe){me(O,fe,Oe,be,Z,7);let ve=Number(O&BigInt(4294967295));be[Z+7]=ve,ve=ve>>8,be[Z+6]=ve,ve=ve>>8,be[Z+5]=ve,ve=ve>>8,be[Z+4]=ve;let Ae=Number(O>>BigInt(32)&BigInt(4294967295));return be[Z+3]=Ae,Ae=Ae>>8,be[Z+2]=Ae,Ae=Ae>>8,be[Z+1]=Ae,Ae=Ae>>8,be[Z]=Ae,Z+8}u.prototype.writeBigUInt64LE=Ot(function(O,Z=0){return Me(this,O,Z,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ot(function(O,Z=0){return Pe(this,O,Z,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(O,Z,fe,Oe){if(O=+O,Z=Z>>>0,!Oe){const mt=Math.pow(2,8*fe-1);ge(this,O,Z,fe,mt-1,-mt)}let ve=0,Ae=1,ue=0;for(this[Z]=O&255;++ve<fe&&(Ae*=256);)O<0&&ue===0&&this[Z+ve-1]!==0&&(ue=1),this[Z+ve]=(O/Ae>>0)-ue&255;return Z+fe},u.prototype.writeIntBE=function(O,Z,fe,Oe){if(O=+O,Z=Z>>>0,!Oe){const mt=Math.pow(2,8*fe-1);ge(this,O,Z,fe,mt-1,-mt)}let ve=fe-1,Ae=1,ue=0;for(this[Z+ve]=O&255;--ve>=0&&(Ae*=256);)O<0&&ue===0&&this[Z+ve+1]!==0&&(ue=1),this[Z+ve]=(O/Ae>>0)-ue&255;return Z+fe},u.prototype.writeInt8=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,1,127,-128),O<0&&(O=255+O+1),this[Z]=O&255,Z+1},u.prototype.writeInt16LE=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,2,32767,-32768),this[Z]=O&255,this[Z+1]=O>>>8,Z+2},u.prototype.writeInt16BE=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,2,32767,-32768),this[Z]=O>>>8,this[Z+1]=O&255,Z+2},u.prototype.writeInt32LE=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,4,2147483647,-2147483648),this[Z]=O&255,this[Z+1]=O>>>8,this[Z+2]=O>>>16,this[Z+3]=O>>>24,Z+4},u.prototype.writeInt32BE=function(O,Z,fe){return O=+O,Z=Z>>>0,fe||ge(this,O,Z,4,2147483647,-2147483648),O<0&&(O=4294967295+O+1),this[Z]=O>>>24,this[Z+1]=O>>>16,this[Z+2]=O>>>8,this[Z+3]=O&255,Z+4},u.prototype.writeBigInt64LE=Ot(function(O,Z=0){return Me(this,O,Z,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ot(function(O,Z=0){return Pe(this,O,Z,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ie(be,O,Z,fe,Oe,ve){if(Z+fe>be.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("Index out of range")}function Ce(be,O,Z,fe,Oe){return O=+O,Z=Z>>>0,Oe||Ie(be,O,Z,4),n.write(be,O,Z,fe,23,4),Z+4}u.prototype.writeFloatLE=function(O,Z,fe){return Ce(this,O,Z,!0,fe)},u.prototype.writeFloatBE=function(O,Z,fe){return Ce(this,O,Z,!1,fe)};function He(be,O,Z,fe,Oe){return O=+O,Z=Z>>>0,Oe||Ie(be,O,Z,8),n.write(be,O,Z,fe,52,8),Z+8}u.prototype.writeDoubleLE=function(O,Z,fe){return He(this,O,Z,!0,fe)},u.prototype.writeDoubleBE=function(O,Z,fe){return He(this,O,Z,!1,fe)},u.prototype.copy=function(O,Z,fe,Oe){if(!u.isBuffer(O))throw new TypeError("argument should be a Buffer");if(fe||(fe=0),!Oe&&Oe!==0&&(Oe=this.length),Z>=O.length&&(Z=O.length),Z||(Z=0),Oe>0&&Oe<fe&&(Oe=fe),Oe===fe||O.length===0||this.length===0)return 0;if(Z<0)throw new RangeError("targetStart out of bounds");if(fe<0||fe>=this.length)throw new RangeError("Index out of range");if(Oe<0)throw new RangeError("sourceEnd out of bounds");Oe>this.length&&(Oe=this.length),O.length-Z<Oe-fe&&(Oe=O.length-Z+fe);const ve=Oe-fe;return this===O&&typeof i.prototype.copyWithin=="function"?this.copyWithin(Z,fe,Oe):i.prototype.set.call(O,this.subarray(fe,Oe),Z),ve},u.prototype.fill=function(O,Z,fe,Oe){if(typeof O=="string"){if(typeof Z=="string"?(Oe=Z,Z=0,fe=this.length):typeof fe=="string"&&(Oe=fe,fe=this.length),Oe!==void 0&&typeof Oe!="string")throw new TypeError("encoding must be a string");if(typeof Oe=="string"&&!u.isEncoding(Oe))throw new TypeError("Unknown encoding: "+Oe);if(O.length===1){const Ae=O.charCodeAt(0);(Oe==="utf8"&&Ae<128||Oe==="latin1")&&(O=Ae)}}else typeof O=="number"?O=O&255:typeof O=="boolean"&&(O=Number(O));if(Z<0||this.length<Z||this.length<fe)throw new RangeError("Out of range index");if(fe<=Z)return this;Z=Z>>>0,fe=fe===void 0?this.length:fe>>>0,O||(O=0);let ve;if(typeof O=="number")for(ve=Z;ve<fe;++ve)this[ve]=O;else{const Ae=u.isBuffer(O)?O:u.from(O,Oe),ue=Ae.length;if(ue===0)throw new TypeError('The value "'+O+'" is invalid for argument "value"');for(ve=0;ve<fe-Z;++ve)this[ve+Z]=Ae[ve%ue]}return this};const it={};function Ge(be,O,Z){it[be]=class extends Z{constructor(){super(),Object.defineProperty(this,"message",{value:O.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${be}]`,this.stack,delete this.name}get code(){return be}set code(Oe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Oe,writable:!0})}toString(){return`${this.name} [${be}]: ${this.message}`}}}Ge("ERR_BUFFER_OUT_OF_BOUNDS",function(be){return be?`${be} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ge("ERR_INVALID_ARG_TYPE",function(be,O){return`The "${be}" argument must be of type number. Received type ${typeof O}`},TypeError),Ge("ERR_OUT_OF_RANGE",function(be,O,Z){let fe=`The value of "${be}" is out of range.`,Oe=Z;return Number.isInteger(Z)&&Math.abs(Z)>2**32?Oe=Re(String(Z)):typeof Z=="bigint"&&(Oe=String(Z),(Z>BigInt(2)**BigInt(32)||Z<-(BigInt(2)**BigInt(32)))&&(Oe=Re(Oe)),Oe+="n"),fe+=` It must be ${O}. Received ${Oe}`,fe},RangeError);function Re(be){let O="",Z=be.length;const fe=be[0]==="-"?1:0;for(;Z>=fe+4;Z-=3)O=`_${be.slice(Z-3,Z)}${O}`;return`${be.slice(0,Z)}${O}`}function H(be,O,Z){Te(O,"offset"),(be[O]===void 0||be[O+Z]===void 0)&&ce(O,be.length-(Z+1))}function me(be,O,Z,fe,Oe,ve){if(be>Z||be<O){const Ae=typeof O=="bigint"?"n":"";let ue;throw O===0||O===BigInt(0)?ue=`>= 0${Ae} and < 2${Ae} ** ${(ve+1)*8}${Ae}`:ue=`>= -(2${Ae} ** ${(ve+1)*8-1}${Ae}) and < 2 ** ${(ve+1)*8-1}${Ae}`,new it.ERR_OUT_OF_RANGE("value",ue,be)}H(fe,Oe,ve)}function Te(be,O){if(typeof be!="number")throw new it.ERR_INVALID_ARG_TYPE(O,"number",be)}function ce(be,O,Z){throw Math.floor(be)!==be?(Te(be,Z),new it.ERR_OUT_OF_RANGE("offset","an integer",be)):O<0?new it.ERR_BUFFER_OUT_OF_BOUNDS:new it.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${O}`,be)}const oe=/[^+/0-9A-Za-z-_]/g;function ne(be){if(be=be.split("=")[0],be=be.trim().replace(oe,""),be.length<2)return"";for(;be.length%4!==0;)be=be+"=";return be}function Se(be,O){O=O||1/0;let Z;const fe=be.length;let Oe=null;const ve=[];for(let Ae=0;Ae<fe;++Ae){if(Z=be.charCodeAt(Ae),Z>55295&&Z<57344){if(!Oe){if(Z>56319){(O-=3)>-1&&ve.push(239,191,189);continue}else if(Ae+1===fe){(O-=3)>-1&&ve.push(239,191,189);continue}Oe=Z;continue}if(Z<56320){(O-=3)>-1&&ve.push(239,191,189),Oe=Z;continue}Z=(Oe-55296<<10|Z-56320)+65536}else Oe&&(O-=3)>-1&&ve.push(239,191,189);if(Oe=null,Z<128){if((O-=1)<0)break;ve.push(Z)}else if(Z<2048){if((O-=2)<0)break;ve.push(Z>>6|192,Z&63|128)}else if(Z<65536){if((O-=3)<0)break;ve.push(Z>>12|224,Z>>6&63|128,Z&63|128)}else if(Z<1114112){if((O-=4)<0)break;ve.push(Z>>18|240,Z>>12&63|128,Z>>6&63|128,Z&63|128)}else throw new Error("Invalid code point")}return ve}function Fe(be){const O=[];for(let Z=0;Z<be.length;++Z)O.push(be.charCodeAt(Z)&255);return O}function ke(be,O){let Z,fe,Oe;const ve=[];for(let Ae=0;Ae<be.length&&!((O-=2)<0);++Ae)Z=be.charCodeAt(Ae),fe=Z>>8,Oe=Z%256,ve.push(Oe),ve.push(fe);return ve}function Xe(be){return t.toByteArray(ne(be))}function St(be,O,Z,fe){let Oe;for(Oe=0;Oe<fe&&!(Oe+Z>=O.length||Oe>=be.length);++Oe)O[Oe+Z]=be[Oe];return Oe}function ht(be,O){return be instanceof O||be!=null&&be.constructor!=null&&be.constructor.name!=null&&be.constructor.name===O.name}function It(be){return be!==be}const Vt=function(){const be="0123456789abcdef",O=new Array(256);for(let Z=0;Z<16;++Z){const fe=Z*16;for(let Oe=0;Oe<16;++Oe)O[fe+Oe]=be[Z]+be[Oe]}return O}();function Ot(be){return typeof BigInt>"u"?Gt:be}function Gt(){throw new Error("BigInt not supported")}})(xR);const Xt=xR.Buffer,Gr=xR.Buffer;var Jd={exports:{}},z4;function WQ(){if(z4)return Jd.exports;z4=1;const e=typeof Xt<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,c){c==null&&l!==null&&typeof l=="object"&&(c=l,l=void 0),e&&Xt.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const u=JSON.parse(o,l);if(u===null||typeof u!="object")return u;const f=c&&c.protoAction||"error",m=c&&c.constructorAction||"error";if(f==="ignore"&&m==="ignore")return u;if(f!=="ignore"&&m!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return u}else if(f!=="ignore"&&m==="ignore"){if(t.test(o)===!1)return u}else if(n.test(o)===!1)return u;return s(u,{protoAction:f,constructorAction:m,safe:c&&c.safe})}function s(o,{protoAction:l="error",constructorAction:c="error",safe:u}={}){let f=[o];for(;f.length;){const m=f;f=[];for(const g of m){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(g,"__proto__")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete g.__proto__}if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(g,"constructor")&&Object.prototype.hasOwnProperty.call(g.constructor,"prototype")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete g.constructor}for(const v in g){const b=g[v];b&&typeof b=="object"&&f.push(b)}}}return o}function i(o,l,c){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,c)}finally{Error.stackTraceLimit=u}}function a(o,l){const c=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=c}}return Jd.exports=i,Jd.exports.default=i,Jd.exports.parse=i,Jd.exports.safeParse=a,Jd.exports.scan=s,Jd.exports}var ZQ=WQ();const im=Ni(ZQ);var YQ={};function _s(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function XQ(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function JQ(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function QQ(){let e="",t,n=[],r,s;function i(l,c){if(l===""){a(c);return}if(l.startsWith(":"))return;const u=l.indexOf(":");if(u===-1){o(l,"");return}const f=l.slice(0,u),m=u+1,g=m<l.length&&l[m]===" "?l.slice(m+1):l.slice(m);o(f,g)}function a(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:s}),n=[],t=void 0,s=void 0)}function o(l,c){switch(l){case"event":t=c;break;case"data":n.push(c);break;case"id":r=c;break;case"retry":const u=parseInt(c,10);isNaN(u)||(s=u);break}}return new TransformStream({transform(l,c){const{lines:u,incompleteLine:f}=eee(e,l);e=f;for(let m=0;m<u.length;m++)i(u[m],c)},flush(l){i(e,l),a(l)}})}function eee(e,t){const n=[];let r=e;for(let s=0;s<t.length;){const i=t[s++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[s+1]===`
`&&s++):r+=i}return{lines:n,incompleteLine:r}}function am(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Bf=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const s=BQ(n,t);if(e==null)return s;if(n.includes(r))throw new IF({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${s(i)}`},ta=Bf();function tee(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function nee(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function Gw(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function eL({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new rw({message:`${r} API key must be a string.`});if(typeof vs>"u")throw new rw({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=YQ[t],e==null)throw new rw({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new rw({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var px=Symbol.for("vercel.ai.validator");function ree(e){return{[px]:!0,validate:e}}function see(e){return typeof e=="object"&&e!==null&&px in e&&e[px]===!0&&"validate"in e}function iee(e){return see(e)?e:aee(e)}function aee(e){return ree(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function oee({value:e,schema:t}){const n=om({value:e,schema:t});if(!n.success)throw hx.wrap({value:e,cause:n.error});return n.value}function om({value:e,schema:t}){const n=iee(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:hx.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:hx.wrap({value:e,cause:r})}}}function lee({text:e,schema:t}){try{const n=im.parse(e);return t==null?n:oee({value:n,schema:t})}catch(n){throw fx.isInstance(n)||hx.isInstance(n)?n:new fx({text:e,cause:n})}}function Tf({text:e,schema:t}){try{const n=im.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=om({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:fx.isInstance(n)?n:new fx({text:e,cause:n})}}}function mx(e){try{return im.parse(e),!0}catch{return!1}}function q1({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=om({value:t[e],schema:n});if(!r.success)throw new IF({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var cee=()=>globalThis.fetch,Ss=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>tL({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),uee=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>tL({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),tL=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:a=cee()})=>{try{const o=await a(e,{method:"POST",headers:nee(t),body:n.content,signal:i}),l=am(o);if(!o.ok){let c;try{c=await s({response:o,url:e,requestBodyValues:n.values})}catch(u){throw Gw(u)||ro.isInstance(u)?u:new ro({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(Gw(c)||ro.isInstance(c))?c:new ro({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(Gw(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new ro({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function MT(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var $f=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{const a=await r.text(),o=am(r);if(a.trim()==="")return{responseHeaders:o,value:new ro({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=lee({text:a,schema:e});return{responseHeaders:o,value:new ro({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new ro({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},lm=e=>async({response:t})=>{const n=am(t);if(t.body==null)throw new TF({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(QQ()).pipeThrough(new TransformStream({transform({data:r},s){r!=="[DONE]"&&s.enqueue(Tf({text:r,schema:e}))}}))}},da=e=>async({response:t,url:n,requestBodyValues:r})=>{const s=await t.text(),i=Tf({text:s,schema:e}),a=am(t);if(!i.success)throw new ro({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:a,value:i.value,rawValue:i.rawValue}},dee=()=>async({response:e,url:t,requestBodyValues:n})=>{const r=am(e);if(!e.body)throw new ro({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const s=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(s)}}catch(s){throw new ro({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:s})}},{btoa:fee,atob:hee}=globalThis;function V1(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=hee(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function Hu(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return fee(t)}function H1(e){return e==null?void 0:e.replace(/\/$/,"")}var pr;(function(e){e.assertEqual=s=>s;function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return e.objectValues(a)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},e.find=(s,i)=>{for(const a of s)if(i(a))return a},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(pr||(pr={}));var OT;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(OT||(OT={}));const rn=pr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),bc=e=>{switch(typeof e){case"undefined":return rn.undefined;case"string":return rn.string;case"number":return isNaN(e)?rn.nan:rn.number;case"boolean":return rn.boolean;case"function":return rn.function;case"bigint":return rn.bigint;case"symbol":return rn.symbol;case"object":return Array.isArray(e)?rn.array:e===null?rn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?rn.promise:typeof Map<"u"&&e instanceof Map?rn.map:typeof Set<"u"&&e instanceof Set?rn.set:typeof Date<"u"&&e instanceof Date?rn.date:rn.object;default:return rn.unknown}},Pt=pr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),pee=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Ra extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return s(this),r}static assert(t){if(!(t instanceof Ra))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,pr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Ra.create=e=>new Ra(e);const jp=(e,t)=>{let n;switch(e.code){case Pt.invalid_type:e.received===rn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Pt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,pr.jsonStringifyReplacer)}`;break;case Pt.unrecognized_keys:n=`Unrecognized key(s) in object: ${pr.joinValues(e.keys,", ")}`;break;case Pt.invalid_union:n="Invalid input";break;case Pt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${pr.joinValues(e.options)}`;break;case Pt.invalid_enum_value:n=`Invalid enum value. Expected ${pr.joinValues(e.options)}, received '${e.received}'`;break;case Pt.invalid_arguments:n="Invalid function arguments";break;case Pt.invalid_return_type:n="Invalid function return type";break;case Pt.invalid_date:n="Invalid date";break;case Pt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:pr.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Pt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Pt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Pt.custom:n="Invalid input";break;case Pt.invalid_intersection_types:n="Intersection results could not be merged";break;case Pt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Pt.not_finite:n="Number must be finite";break;default:n=t.defaultError,pr.assertNever(e)}return{message:n}};let nL=jp;function mee(e){nL=e}function gx(){return nL}const yx=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}},gee=[];function tn(e,t){const n=gx(),r=yx({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===jp?void 0:jp].filter(s=>!!s)});e.common.issues.push(r)}class Ti{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return An;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return Ti.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return An;i.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:t.value,value:r}}}const An=Object.freeze({status:"aborted"}),lp=e=>({status:"dirty",value:e}),qi=e=>({status:"valid",value:e}),PT=e=>e.status==="aborted",DT=e=>e.status==="dirty",Af=e=>e.status==="valid",j0=e=>typeof Promise<"u"&&e instanceof Promise;function bx(e,t,n,r){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function rL(e,t,n,r,s){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}var dn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(dn||(dn={}));var t0,n0;class Nl{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const U4=(e,t)=>{if(Af(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Ra(e.common.issues);return this._error=n,this._error}}};function Un(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(a,o)=>{var l,c;const{message:u}=e;return a.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(l=u??r)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??n)!==null&&c!==void 0?c:o.defaultError}},description:s}}class Kn{get description(){return this._def.description}_getType(t){return bc(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:bc(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Ti,ctx:{common:t.parent.common,data:t.data,parsedType:bc(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(j0(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){var r;const s={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:bc(t)},i=this._parseSync({data:t,path:s.path,parent:s});return U4(s,i)}"~validate"(t){var n,r;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:bc(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:s});return Af(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((r=(n=i==null?void 0:i.message)===null||n===void 0?void 0:n.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:s}).then(i=>Af(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:bc(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(j0(s)?s:Promise.resolve(s));return U4(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=t(s),o=()=>i.addIssue({code:Pt.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new Po({schema:this,typeName:zt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Io.create(this,this._def)}nullable(){return Zu.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return No.create(this)}promise(){return Op.create(this,this._def)}or(t){return D0.create([this,t],this._def)}and(t){return F0.create(this,t,this._def)}transform(t){return new Po({...Un(this._def),schema:this,typeName:zt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new U0({...Un(this._def),innerType:this,defaultValue:n,typeName:zt.ZodDefault})}brand(){return new SR({typeName:zt.ZodBranded,type:this,...Un(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new q0({...Un(this._def),innerType:this,catchValue:n,typeName:zt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Gy.create(this,t)}readonly(){return V0.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const yee=/^c[^\s-]{8,}$/i,bee=/^[0-9a-z]+$/,vee=/^[0-9A-HJKMNP-TV-Z]{26}$/i,wee=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,xee=/^[a-z0-9_-]{21}$/i,_ee=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,See=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Eee=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Cee="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let vE;const kee=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Tee=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Aee=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ree=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Nee=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Iee=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,sL="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",jee=new RegExp(`^${sL}$`);function iL(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Mee(e){return new RegExp(`^${iL(e)}$`)}function aL(e){let t=`${sL}T${iL(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Oee(e,t){return!!((t==="v4"||!t)&&kee.test(e)||(t==="v6"||!t)&&Aee.test(e))}function Pee(e,t){if(!_ee.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||!s.typ||!s.alg||t&&s.alg!==t)}catch{return!1}}function Dee(e,t){return!!((t==="v4"||!t)&&Tee.test(e)||(t==="v6"||!t)&&Ree.test(e))}class To extends Kn{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==rn.string){const i=this._getOrReturnCtx(t);return tn(i,{code:Pt.invalid_type,expected:rn.string,received:i.parsedType}),An}const r=new Ti;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=t.data.length>i.value,o=t.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(t,s),a?tn(s,{code:Pt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&tn(s,{code:Pt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Eee.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"email",code:Pt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")vE||(vE=new RegExp(Cee,"u")),vE.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"emoji",code:Pt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")wee.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"uuid",code:Pt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")xee.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"nanoid",code:Pt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")yee.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"cuid",code:Pt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")bee.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"cuid2",code:Pt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")vee.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"ulid",code:Pt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),tn(s,{validation:"url",code:Pt.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"regex",code:Pt.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?aL(i).test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?jee.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?Mee(i).test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?See.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"duration",code:Pt.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?Oee(t.data,i.version)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"ip",code:Pt.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?Pee(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"jwt",code:Pt.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?Dee(t.data,i.version)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"cidr",code:Pt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Nee.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"base64",code:Pt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Iee.test(t.data)||(s=this._getOrReturnCtx(t,s),tn(s,{validation:"base64url",code:Pt.invalid_string,message:i.message}),r.dirty()):pr.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:Pt.invalid_string,...dn.errToObj(r)})}_addCheck(t){return new To({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...dn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...dn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...dn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...dn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...dn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...dn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...dn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...dn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...dn.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...dn.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...dn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...dn.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...dn.errToObj(t)})}datetime(t){var n,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(n=t==null?void 0:t.offset)!==null&&n!==void 0?n:!1,local:(r=t==null?void 0:t.local)!==null&&r!==void 0?r:!1,...dn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...dn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...dn.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...dn.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...dn.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...dn.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...dn.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...dn.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...dn.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...dn.errToObj(n)})}nonempty(t){return this.min(1,dn.errToObj(t))}trim(){return new To({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new To({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new To({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}To.create=e=>{var t;return new To({checks:[],typeName:zt.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Un(e)})};function Fee(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(e.toFixed(s).replace(".","")),a=parseInt(t.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}class Gu extends Kn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==rn.number){const i=this._getOrReturnCtx(t);return tn(i,{code:Pt.invalid_type,expected:rn.number,received:i.parsedType}),An}let r;const s=new Ti;for(const i of this._def.checks)i.kind==="int"?pr.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),tn(r,{code:Pt.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),tn(r,{code:Pt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),tn(r,{code:Pt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Fee(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),tn(r,{code:Pt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),tn(r,{code:Pt.not_finite,message:i.message}),s.dirty()):pr.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,dn.toString(n))}gt(t,n){return this.setLimit("min",t,!1,dn.toString(n))}lte(t,n){return this.setLimit("max",t,!0,dn.toString(n))}lt(t,n){return this.setLimit("max",t,!1,dn.toString(n))}setLimit(t,n,r,s){return new Gu({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:dn.toString(s)}]})}_addCheck(t){return new Gu({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:dn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:dn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:dn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:dn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:dn.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:dn.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:dn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:dn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:dn.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&pr.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Gu.create=e=>new Gu({checks:[],typeName:zt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Un(e)});class Ku extends Kn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==rn.bigint)return this._getInvalidInput(t);let r;const s=new Ti;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),tn(r,{code:Pt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),tn(r,{code:Pt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),tn(r,{code:Pt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):pr.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return tn(n,{code:Pt.invalid_type,expected:rn.bigint,received:n.parsedType}),An}gte(t,n){return this.setLimit("min",t,!0,dn.toString(n))}gt(t,n){return this.setLimit("min",t,!1,dn.toString(n))}lte(t,n){return this.setLimit("max",t,!0,dn.toString(n))}lt(t,n){return this.setLimit("max",t,!1,dn.toString(n))}setLimit(t,n,r,s){return new Ku({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:dn.toString(s)}]})}_addCheck(t){return new Ku({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:dn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:dn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:dn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:dn.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:dn.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Ku.create=e=>{var t;return new Ku({checks:[],typeName:zt.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Un(e)})};class M0 extends Kn{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==rn.boolean){const r=this._getOrReturnCtx(t);return tn(r,{code:Pt.invalid_type,expected:rn.boolean,received:r.parsedType}),An}return qi(t.data)}}M0.create=e=>new M0({typeName:zt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Un(e)});class Rf extends Kn{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==rn.date){const i=this._getOrReturnCtx(t);return tn(i,{code:Pt.invalid_type,expected:rn.date,received:i.parsedType}),An}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return tn(i,{code:Pt.invalid_date}),An}const r=new Ti;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),tn(s,{code:Pt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):pr.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Rf({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:dn.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:dn.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}Rf.create=e=>new Rf({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:zt.ZodDate,...Un(e)});class vx extends Kn{_parse(t){if(this._getType(t)!==rn.symbol){const r=this._getOrReturnCtx(t);return tn(r,{code:Pt.invalid_type,expected:rn.symbol,received:r.parsedType}),An}return qi(t.data)}}vx.create=e=>new vx({typeName:zt.ZodSymbol,...Un(e)});class O0 extends Kn{_parse(t){if(this._getType(t)!==rn.undefined){const r=this._getOrReturnCtx(t);return tn(r,{code:Pt.invalid_type,expected:rn.undefined,received:r.parsedType}),An}return qi(t.data)}}O0.create=e=>new O0({typeName:zt.ZodUndefined,...Un(e)});class P0 extends Kn{_parse(t){if(this._getType(t)!==rn.null){const r=this._getOrReturnCtx(t);return tn(r,{code:Pt.invalid_type,expected:rn.null,received:r.parsedType}),An}return qi(t.data)}}P0.create=e=>new P0({typeName:zt.ZodNull,...Un(e)});class Mp extends Kn{constructor(){super(...arguments),this._any=!0}_parse(t){return qi(t.data)}}Mp.create=e=>new Mp({typeName:zt.ZodAny,...Un(e)});class wf extends Kn{constructor(){super(...arguments),this._unknown=!0}_parse(t){return qi(t.data)}}wf.create=e=>new wf({typeName:zt.ZodUnknown,...Un(e)});class Nc extends Kn{_parse(t){const n=this._getOrReturnCtx(t);return tn(n,{code:Pt.invalid_type,expected:rn.never,received:n.parsedType}),An}}Nc.create=e=>new Nc({typeName:zt.ZodNever,...Un(e)});class wx extends Kn{_parse(t){if(this._getType(t)!==rn.undefined){const r=this._getOrReturnCtx(t);return tn(r,{code:Pt.invalid_type,expected:rn.void,received:r.parsedType}),An}return qi(t.data)}}wx.create=e=>new wx({typeName:zt.ZodVoid,...Un(e)});class No extends Kn{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==rn.array)return tn(n,{code:Pt.invalid_type,expected:rn.array,received:n.parsedType}),An;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(tn(n,{code:a?Pt.too_big:Pt.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(tn(n,{code:Pt.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(tn(n,{code:Pt.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new Nl(n,a,n.path,o)))).then(a=>Ti.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new Nl(n,a,n.path,o)));return Ti.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new No({...this._def,minLength:{value:t,message:dn.toString(n)}})}max(t,n){return new No({...this._def,maxLength:{value:t,message:dn.toString(n)}})}length(t,n){return new No({...this._def,exactLength:{value:t,message:dn.toString(n)}})}nonempty(t){return this.min(1,t)}}No.create=(e,t)=>new No({type:e,minLength:null,maxLength:null,exactLength:null,typeName:zt.ZodArray,...Un(t)});function sp(e){if(e instanceof is){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Io.create(sp(r))}return new is({...e._def,shape:()=>t})}else return e instanceof No?new No({...e._def,type:sp(e.element)}):e instanceof Io?Io.create(sp(e.unwrap())):e instanceof Zu?Zu.create(sp(e.unwrap())):e instanceof Il?Il.create(e.items.map(t=>sp(t))):e}class is extends Kn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=pr.objectKeys(t);return this._cached={shape:t,keys:n}}_parse(t){if(this._getType(t)!==rn.object){const c=this._getOrReturnCtx(t);return tn(c,{code:Pt.invalid_type,expected:rn.object,received:c.parsedType}),An}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Nc&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=i[c],f=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Nl(s,f,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof Nc){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")o.length>0&&(tn(s,{code:Pt.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const f=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Nl(s,f,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const f=await u.key,m=await u.value;c.push({key:f,value:m,alwaysSet:u.alwaysSet})}return c}).then(c=>Ti.mergeObjectSync(r,c)):Ti.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return dn.errToObj,new is({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var s,i,a,o;const l=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&a!==void 0?a:r.defaultError;return n.code==="unrecognized_keys"?{message:(o=dn.errToObj(t).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new is({...this._def,unknownKeys:"strip"})}passthrough(){return new is({...this._def,unknownKeys:"passthrough"})}extend(t){return new is({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new is({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:zt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new is({...this._def,catchall:t})}pick(t){const n={};return pr.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new is({...this._def,shape:()=>n})}omit(t){const n={};return pr.objectKeys(this.shape).forEach(r=>{t[r]||(n[r]=this.shape[r])}),new is({...this._def,shape:()=>n})}deepPartial(){return sp(this)}partial(t){const n={};return pr.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}),new is({...this._def,shape:()=>n})}required(t){const n={};return pr.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Io;)i=i._def.innerType;n[r]=i}}),new is({...this._def,shape:()=>n})}keyof(){return oL(pr.objectKeys(this.shape))}}is.create=(e,t)=>new is({shape:()=>e,unknownKeys:"strip",catchall:Nc.create(),typeName:zt.ZodObject,...Un(t)});is.strictCreate=(e,t)=>new is({shape:()=>e,unknownKeys:"strict",catchall:Nc.create(),typeName:zt.ZodObject,...Un(t)});is.lazycreate=(e,t)=>new is({shape:e,unknownKeys:"strip",catchall:Nc.create(),typeName:zt.ZodObject,...Un(t)});class D0 extends Kn{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Ra(o.ctx.common.issues));return tn(n,{code:Pt.invalid_union,unionErrors:a}),An}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new Ra(l));return tn(n,{code:Pt.invalid_union,unionErrors:o}),An}}get options(){return this._def.options}}D0.create=(e,t)=>new D0({options:e,typeName:zt.ZodUnion,...Un(t)});const mc=e=>e instanceof B0?mc(e.schema):e instanceof Po?mc(e.innerType()):e instanceof $0?[e.value]:e instanceof Wu?e.options:e instanceof z0?pr.objectValues(e.enum):e instanceof U0?mc(e._def.innerType):e instanceof O0?[void 0]:e instanceof P0?[null]:e instanceof Io?[void 0,...mc(e.unwrap())]:e instanceof Zu?[null,...mc(e.unwrap())]:e instanceof SR||e instanceof V0?mc(e.unwrap()):e instanceof q0?mc(e._def.innerType):[];class G1 extends Kn{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==rn.object)return tn(n,{code:Pt.invalid_type,expected:rn.object,received:n.parsedType}),An;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(tn(n,{code:Pt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),An)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const i of n){const a=mc(i.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new G1({typeName:zt.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Un(r)})}}function FT(e,t){const n=bc(e),r=bc(t);if(e===t)return{valid:!0,data:e};if(n===rn.object&&r===rn.object){const s=pr.objectKeys(t),i=pr.objectKeys(e).filter(o=>s.indexOf(o)!==-1),a={...e,...t};for(const o of i){const l=FT(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===rn.array&&r===rn.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const a=e[i],o=t[i],l=FT(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===rn.date&&r===rn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class F0 extends Kn{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,a)=>{if(PT(i)||PT(a))return An;const o=FT(i.value,a.value);return o.valid?((DT(i)||DT(a))&&n.dirty(),{status:n.value,value:o.data}):(tn(r,{code:Pt.invalid_intersection_types}),An)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}F0.create=(e,t,n)=>new F0({left:e,right:t,typeName:zt.ZodIntersection,...Un(n)});class Il extends Kn{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==rn.array)return tn(r,{code:Pt.invalid_type,expected:rn.array,received:r.parsedType}),An;if(r.data.length<this._def.items.length)return tn(r,{code:Pt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),An;!this._def.rest&&r.data.length>this._def.items.length&&(tn(r,{code:Pt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Nl(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>Ti.mergeArray(n,a)):Ti.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new Il({...this._def,rest:t})}}Il.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Il({items:e,typeName:zt.ZodTuple,rest:null,...Un(t)})};class L0 extends Kn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==rn.object)return tn(r,{code:Pt.invalid_type,expected:rn.object,received:r.parsedType}),An;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new Nl(r,o,r.path,o)),value:a._parse(new Nl(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Ti.mergeObjectAsync(n,s):Ti.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Kn?new L0({keyType:t,valueType:n,typeName:zt.ZodRecord,...Un(r)}):new L0({keyType:To.create(),valueType:t,typeName:zt.ZodRecord,...Un(n)})}}class xx extends Kn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==rn.map)return tn(r,{code:Pt.invalid_type,expected:rn.map,received:r.parsedType}),An;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:s._parse(new Nl(r,o,r.path,[c,"key"])),value:i._parse(new Nl(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return An;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return An;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}xx.create=(e,t,n)=>new xx({valueType:t,keyType:e,typeName:zt.ZodMap,...Un(n)});class Nf extends Kn{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==rn.set)return tn(r,{code:Pt.invalid_type,expected:rn.set,received:r.parsedType}),An;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(tn(r,{code:Pt.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(tn(r,{code:Pt.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return An;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>i._parse(new Nl(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,n){return new Nf({...this._def,minSize:{value:t,message:dn.toString(n)}})}max(t,n){return new Nf({...this._def,maxSize:{value:t,message:dn.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Nf.create=(e,t)=>new Nf({valueType:e,minSize:null,maxSize:null,typeName:zt.ZodSet,...Un(t)});class wp extends Kn{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==rn.function)return tn(n,{code:Pt.invalid_type,expected:rn.function,received:n.parsedType}),An;function r(o,l){return yx({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,gx(),jp].filter(c=>!!c),issueData:{code:Pt.invalid_arguments,argumentsError:l}})}function s(o,l){return yx({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,gx(),jp].filter(c=>!!c),issueData:{code:Pt.invalid_return_type,returnTypeError:l}})}const i={errorMap:n.common.contextualErrorMap},a=n.data;if(this._def.returns instanceof Op){const o=this;return qi(async function(...l){const c=new Ra([]),u=await o._def.args.parseAsync(l,i).catch(g=>{throw c.addIssue(r(l,g)),c}),f=await Reflect.apply(a,this,u);return await o._def.returns._def.type.parseAsync(f,i).catch(g=>{throw c.addIssue(s(f,g)),c})})}else{const o=this;return qi(function(...l){const c=o._def.args.safeParse(l,i);if(!c.success)throw new Ra([r(l,c.error)]);const u=Reflect.apply(a,this,c.data),f=o._def.returns.safeParse(u,i);if(!f.success)throw new Ra([s(u,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new wp({...this._def,args:Il.create(t).rest(wf.create())})}returns(t){return new wp({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new wp({args:t||Il.create([]).rest(wf.create()),returns:n||wf.create(),typeName:zt.ZodFunction,...Un(r)})}}class B0 extends Kn{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}B0.create=(e,t)=>new B0({getter:e,typeName:zt.ZodLazy,...Un(t)});class $0 extends Kn{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return tn(n,{received:n.data,code:Pt.invalid_literal,expected:this._def.value}),An}return{status:"valid",value:t.data}}get value(){return this._def.value}}$0.create=(e,t)=>new $0({value:e,typeName:zt.ZodLiteral,...Un(t)});function oL(e,t){return new Wu({values:e,typeName:zt.ZodEnum,...Un(t)})}class Wu extends Kn{constructor(){super(...arguments),t0.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return tn(n,{expected:pr.joinValues(r),received:n.parsedType,code:Pt.invalid_type}),An}if(bx(this,t0)||rL(this,t0,new Set(this._def.values)),!bx(this,t0).has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return tn(n,{received:n.data,code:Pt.invalid_enum_value,options:r}),An}return qi(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Wu.create(t,{...this._def,...n})}exclude(t,n=this._def){return Wu.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}t0=new WeakMap;Wu.create=oL;class z0 extends Kn{constructor(){super(...arguments),n0.set(this,void 0)}_parse(t){const n=pr.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==rn.string&&r.parsedType!==rn.number){const s=pr.objectValues(n);return tn(r,{expected:pr.joinValues(s),received:r.parsedType,code:Pt.invalid_type}),An}if(bx(this,n0)||rL(this,n0,new Set(pr.getValidEnumValues(this._def.values))),!bx(this,n0).has(t.data)){const s=pr.objectValues(n);return tn(r,{received:r.data,code:Pt.invalid_enum_value,options:s}),An}return qi(t.data)}get enum(){return this._def.values}}n0=new WeakMap;z0.create=(e,t)=>new z0({values:e,typeName:zt.ZodNativeEnum,...Un(t)});class Op extends Kn{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==rn.promise&&n.common.async===!1)return tn(n,{code:Pt.invalid_type,expected:rn.promise,received:n.parsedType}),An;const r=n.parsedType===rn.promise?n.data:Promise.resolve(n.data);return qi(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Op.create=(e,t)=>new Op({type:e,typeName:zt.ZodPromise,...Un(t)});class Po extends Kn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===zt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:a=>{tn(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return An;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?An:l.status==="dirty"||n.value==="dirty"?lp(l.value):l});{if(n.value==="aborted")return An;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?An:o.status==="dirty"||n.value==="dirty"?lp(o.value):o}}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?An:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?An:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Af(a))return a;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Af(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):a);pr.assertNever(s)}}Po.create=(e,t,n)=>new Po({schema:e,typeName:zt.ZodEffects,effect:t,...Un(n)});Po.createWithPreprocess=(e,t,n)=>new Po({schema:t,effect:{type:"preprocess",transform:e},typeName:zt.ZodEffects,...Un(n)});class Io extends Kn{_parse(t){return this._getType(t)===rn.undefined?qi(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Io.create=(e,t)=>new Io({innerType:e,typeName:zt.ZodOptional,...Un(t)});class Zu extends Kn{_parse(t){return this._getType(t)===rn.null?qi(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Zu.create=(e,t)=>new Zu({innerType:e,typeName:zt.ZodNullable,...Un(t)});class U0 extends Kn{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===rn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}U0.create=(e,t)=>new U0({innerType:e,typeName:zt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Un(t)});class q0 extends Kn{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return j0(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ra(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ra(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}q0.create=(e,t)=>new q0({innerType:e,typeName:zt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Un(t)});class _x extends Kn{_parse(t){if(this._getType(t)!==rn.nan){const r=this._getOrReturnCtx(t);return tn(r,{code:Pt.invalid_type,expected:rn.nan,received:r.parsedType}),An}return{status:"valid",value:t.data}}}_x.create=e=>new _x({typeName:zt.ZodNaN,...Un(e)});const Lee=Symbol("zod_brand");class SR extends Kn{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Gy extends Kn{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?An:i.status==="dirty"?(n.dirty(),lp(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?An:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new Gy({in:t,out:n,typeName:zt.ZodPipeline})}}class V0 extends Kn{_parse(t){const n=this._def.innerType._parse(t),r=s=>(Af(s)&&(s.value=Object.freeze(s.value)),s);return j0(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}V0.create=(e,t)=>new V0({innerType:e,typeName:zt.ZodReadonly,...Un(t)});function q4(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function lL(e,t={},n){return e?Mp.create().superRefine((r,s)=>{var i,a;const o=e(r);if(o instanceof Promise)return o.then(l=>{var c,u;if(!l){const f=q4(t,r),m=(u=(c=f.fatal)!==null&&c!==void 0?c:n)!==null&&u!==void 0?u:!0;s.addIssue({code:"custom",...f,fatal:m})}});if(!o){const l=q4(t,r),c=(a=(i=l.fatal)!==null&&i!==void 0?i:n)!==null&&a!==void 0?a:!0;s.addIssue({code:"custom",...l,fatal:c})}}):Mp.create()}const Bee={object:is.lazycreate};var zt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(zt||(zt={}));const $ee=(e,t={message:`Input not instance of ${e.name}`})=>lL(n=>n instanceof e,t),cL=To.create,uL=Gu.create,zee=_x.create,Uee=Ku.create,dL=M0.create,qee=Rf.create,Vee=vx.create,Hee=O0.create,Gee=P0.create,Kee=Mp.create,Wee=wf.create,Zee=Nc.create,Yee=wx.create,Xee=No.create,Jee=is.create,Qee=is.strictCreate,ete=D0.create,tte=G1.create,nte=F0.create,rte=Il.create,ste=L0.create,ite=xx.create,ate=Nf.create,ote=wp.create,lte=B0.create,cte=$0.create,ute=Wu.create,dte=z0.create,fte=Op.create,V4=Po.create,hte=Io.create,pte=Zu.create,mte=Po.createWithPreprocess,gte=Gy.create,yte=()=>cL().optional(),bte=()=>uL().optional(),vte=()=>dL().optional(),wte={string:e=>To.create({...e,coerce:!0}),number:e=>Gu.create({...e,coerce:!0}),boolean:e=>M0.create({...e,coerce:!0}),bigint:e=>Ku.create({...e,coerce:!0}),date:e=>Rf.create({...e,coerce:!0})},xte=An;var D=Object.freeze({__proto__:null,defaultErrorMap:jp,setErrorMap:mee,getErrorMap:gx,makeIssue:yx,EMPTY_PATH:gee,addIssueToContext:tn,ParseStatus:Ti,INVALID:An,DIRTY:lp,OK:qi,isAborted:PT,isDirty:DT,isValid:Af,isAsync:j0,get util(){return pr},get objectUtil(){return OT},ZodParsedType:rn,getParsedType:bc,ZodType:Kn,datetimeRegex:aL,ZodString:To,ZodNumber:Gu,ZodBigInt:Ku,ZodBoolean:M0,ZodDate:Rf,ZodSymbol:vx,ZodUndefined:O0,ZodNull:P0,ZodAny:Mp,ZodUnknown:wf,ZodNever:Nc,ZodVoid:wx,ZodArray:No,ZodObject:is,ZodUnion:D0,ZodDiscriminatedUnion:G1,ZodIntersection:F0,ZodTuple:Il,ZodRecord:L0,ZodMap:xx,ZodSet:Nf,ZodFunction:wp,ZodLazy:B0,ZodLiteral:$0,ZodEnum:Wu,ZodNativeEnum:z0,ZodPromise:Op,ZodEffects:Po,ZodTransformer:Po,ZodOptional:Io,ZodNullable:Zu,ZodDefault:U0,ZodCatch:q0,ZodNaN:_x,BRAND:Lee,ZodBranded:SR,ZodPipeline:Gy,ZodReadonly:V0,custom:lL,Schema:Kn,ZodSchema:Kn,late:Bee,get ZodFirstPartyTypeKind(){return zt},coerce:wte,any:Kee,array:Xee,bigint:Uee,boolean:dL,date:qee,discriminatedUnion:tte,effect:V4,enum:ute,function:ote,instanceof:$ee,intersection:nte,lazy:lte,literal:cte,map:ite,nan:zee,nativeEnum:dte,never:Zee,null:Gee,nullable:pte,number:uL,object:Jee,oboolean:vte,onumber:bte,optional:hte,ostring:yte,pipeline:gte,preprocess:mte,promise:fte,record:ste,set:ate,strictObject:Qee,string:cL,symbol:Vee,transformer:V4,tuple:rte,undefined:Hee,union:ete,unknown:Wee,void:Yee,NEVER:xte,ZodIssueCode:Pt,quotelessJson:pee,ZodError:Ra});function _te({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],s=[];for(const{role:i,content:a}of e)switch(i){case"system":{switch(n){case"system":{r.push({role:"system",content:a});break}case"developer":{r.push({role:"developer",content:a});break}case"remove":{s.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(a.length===1&&a[0].type==="text"){r.push({role:"user",content:a[0].text});break}r.push({role:"user",content:a.map((o,l)=>{var c,u,f,m;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(c=o.mimeType)!=null?c:"image/jpeg"};base64,${Hu(o.image)}`,detail:(f=(u=o.providerMetadata)==null?void 0:u.openai)==null?void 0:f.imageDetail}};case"file":{if(o.data instanceof URL)throw new wr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(m=o.filename)!=null?m:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new wr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const c of a)switch(c.type){case"text":{o+=c.text;break}case"tool-call":{l.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.args)}});break}}if(t){if(l.length>1)throw new wr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of a)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:s}}function H4(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function Sx(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var ER=D.object({error:D.object({message:D.string(),type:D.string().nullish(),param:D.any().nullish(),code:D.union([D.string(),D.number()]).nullish()})}),jl=$f({errorSchema:ER,errorToMessage:e=>e.error.message});function Ex({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function Ste({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const s=(r=e.tools)!=null&&r.length?e.tools:void 0,i=[];if(s==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const a=e.toolChoice;if(t){const c=[];for(const f of s)f.type==="provider-defined"?i.push({type:"unsupported-tool",tool:f}):c.push({name:f.name,description:f.description,parameters:f.parameters});if(a==null)return{functions:c,function_call:void 0,toolWarnings:i};switch(a.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:i};case"required":throw new wr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:a.toolName},toolWarnings:i}}}const o=[];for(const c of s)c.type==="provider-defined"?i.push({type:"unsupported-tool",tool:c}):o.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:n?!0:void 0}});if(a==null)return{tools:o,tool_choice:void 0,toolWarnings:i};const l=a.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:i};default:{const c=l;throw new wr({functionality:`Unsupported tool choice type: ${c}`})}}}var Ete=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:LT(this.modelId)}get defaultObjectGenerationMode(){return Tte(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:f}){var m,g,v,b,w,x,_,E;const C=e.type,k=[];i!=null&&k.push({type:"unsupported-setting",setting:"topK"}),(c==null?void 0:c.type)==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&k.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const R=this.settings.useLegacyFunctionCalling;if(R&&this.settings.parallelToolCalls===!0)throw new wr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(R&&this.supportsStructuredOutputs)throw new wr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:I,warnings:j}=_te({prompt:t,useLegacyFunctionCalling:R,systemMessageMode:Ate(this.modelId)});k.push(...j);const M={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(c==null?void 0:c.type)==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(m=c.name)!=null?m:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(g=f==null?void 0:f.openai)==null?void 0:g.maxCompletionTokens,store:(v=f==null?void 0:f.openai)==null?void 0:v.store,metadata:(b=f==null?void 0:f.openai)==null?void 0:b.metadata,prediction:(w=f==null?void 0:f.openai)==null?void 0:w.prediction,reasoning_effort:(_=(x=f==null?void 0:f.openai)==null?void 0:x.reasoningEffort)!=null?_:this.settings.reasoningEffort,messages:I};switch(LT(this.modelId)?(M.temperature!=null&&(M.temperature=void 0,k.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),M.top_p!=null&&(M.top_p=void 0,k.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),M.frequency_penalty!=null&&(M.frequency_penalty=void 0,k.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),M.presence_penalty!=null&&(M.presence_penalty=void 0,k.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),M.logit_bias!=null&&(M.logit_bias=void 0,k.push({type:"other",message:"logitBias is not supported for reasoning models"})),M.logprobs!=null&&(M.logprobs=void 0,k.push({type:"other",message:"logprobs is not supported for reasoning models"})),M.top_logprobs!=null&&(M.top_logprobs=void 0,k.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),M.max_tokens!=null&&(M.max_completion_tokens==null&&(M.max_completion_tokens=M.max_tokens),M.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&M.temperature!=null&&(M.temperature=void 0,k.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),C){case"regular":{const{tools:L,tool_choice:q,functions:P,function_call:V,toolWarnings:z}=Ste({mode:e,useLegacyFunctionCalling:R,structuredOutputs:this.supportsStructuredOutputs});return{args:{...M,tools:L,tool_choice:q,functions:P,function_call:V},warnings:[...k,...z]}}case"object-json":return{args:{...M,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(E=e.name)!=null?E:"response",description:e.description}}:{type:"json_object"}},warnings:k};case"object-tool":return{args:R?{...M,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...M,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:k};default:{const L=C;throw new Error(`Unsupported type: ${L}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l;const{args:c,warnings:u}=this.getArgs(e),{responseHeaders:f,value:m,rawValue:g}=await Ss({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:c,failedResponseHandler:jl,successfulResponseHandler:da(Cte),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:v,...b}=c,w=m.choices[0],x=(t=m.usage)==null?void 0:t.completion_tokens_details,_=(n=m.usage)==null?void 0:n.prompt_tokens_details,E={openai:{}};return(x==null?void 0:x.reasoning_tokens)!=null&&(E.openai.reasoningTokens=x==null?void 0:x.reasoning_tokens),(x==null?void 0:x.accepted_prediction_tokens)!=null&&(E.openai.acceptedPredictionTokens=x==null?void 0:x.accepted_prediction_tokens),(x==null?void 0:x.rejected_prediction_tokens)!=null&&(E.openai.rejectedPredictionTokens=x==null?void 0:x.rejected_prediction_tokens),(_==null?void 0:_.cached_tokens)!=null&&(E.openai.cachedPromptTokens=_==null?void 0:_.cached_tokens),{text:(r=w.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&w.message.function_call?[{toolCallType:"function",toolCallId:ta(),toolName:w.message.function_call.name,args:w.message.function_call.arguments}]:(s=w.message.tool_calls)==null?void 0:s.map(C=>{var k;return{toolCallType:"function",toolCallId:(k=C.id)!=null?k:ta(),toolName:C.function.name,args:C.function.arguments}}),finishReason:Sx(w.finish_reason),usage:{promptTokens:(a=(i=m.usage)==null?void 0:i.prompt_tokens)!=null?a:NaN,completionTokens:(l=(o=m.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:v,rawSettings:b},rawResponse:{headers:f,body:g},request:{body:JSON.stringify(c)},response:Ex(m),warnings:u,logprobs:H4(w.logprobs),providerMetadata:E}}async doStream(e){if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const _ of b.toolCalls)x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:_.toolCallId,toolName:_.toolName,argsTextDelta:_.args}),x.enqueue({type:"tool-call",..._});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ss({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:r,failedResponseHandler:jl,successfulResponseHandler:lm(kte),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=t,l=[];let c="unknown",u={promptTokens:void 0,completionTokens:void 0},f,m=!0;const{useLegacyFunctionCalling:g}=this.settings,v={openai:{}};return{stream:i.pipeThrough(new TransformStream({transform(b,w){var x,_,E,C,k,R,I,j,M,L,q,P;if(!b.success){c="error",w.enqueue({type:"error",error:b.error});return}const V=b.value;if("error"in V){c="error",w.enqueue({type:"error",error:V.error});return}if(m&&(m=!1,w.enqueue({type:"response-metadata",...Ex(V)})),V.usage!=null){const{prompt_tokens:W,completion_tokens:se,prompt_tokens_details:Y,completion_tokens_details:te}=V.usage;u={promptTokens:W??void 0,completionTokens:se??void 0},(te==null?void 0:te.reasoning_tokens)!=null&&(v.openai.reasoningTokens=te==null?void 0:te.reasoning_tokens),(te==null?void 0:te.accepted_prediction_tokens)!=null&&(v.openai.acceptedPredictionTokens=te==null?void 0:te.accepted_prediction_tokens),(te==null?void 0:te.rejected_prediction_tokens)!=null&&(v.openai.rejectedPredictionTokens=te==null?void 0:te.rejected_prediction_tokens),(Y==null?void 0:Y.cached_tokens)!=null&&(v.openai.cachedPromptTokens=Y==null?void 0:Y.cached_tokens)}const z=V.choices[0];if((z==null?void 0:z.finish_reason)!=null&&(c=Sx(z.finish_reason)),(z==null?void 0:z.delta)==null)return;const re=z.delta;re.content!=null&&w.enqueue({type:"text-delta",textDelta:re.content});const K=H4(z==null?void 0:z.logprobs);K!=null&&K.length&&(f===void 0&&(f=[]),f.push(...K));const ee=g&&re.function_call!=null?[{type:"function",id:ta(),function:re.function_call,index:0}]:re.tool_calls;if(ee!=null)for(const W of ee){const se=W.index;if(l[se]==null){if(W.type!=="function")throw new vp({data:W,message:"Expected 'function' type."});if(W.id==null)throw new vp({data:W,message:"Expected 'id' to be a string."});if(((x=W.function)==null?void 0:x.name)==null)throw new vp({data:W,message:"Expected 'function.name' to be a string."});l[se]={id:W.id,type:"function",function:{name:W.function.name,arguments:(_=W.function.arguments)!=null?_:""},hasFinished:!1};const te=l[se];((E=te.function)==null?void 0:E.name)!=null&&((C=te.function)==null?void 0:C.arguments)!=null&&(te.function.arguments.length>0&&w.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:te.id,toolName:te.function.name,argsTextDelta:te.function.arguments}),mx(te.function.arguments)&&(w.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(k=te.id)!=null?k:ta(),toolName:te.function.name,args:te.function.arguments}),te.hasFinished=!0));continue}const Y=l[se];Y.hasFinished||(((R=W.function)==null?void 0:R.arguments)!=null&&(Y.function.arguments+=(j=(I=W.function)==null?void 0:I.arguments)!=null?j:""),w.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Y.id,toolName:Y.function.name,argsTextDelta:(M=W.function.arguments)!=null?M:""}),((L=Y.function)==null?void 0:L.name)!=null&&((q=Y.function)==null?void 0:q.arguments)!=null&&mx(Y.function.arguments)&&(w.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=Y.id)!=null?P:ta(),toolName:Y.function.name,args:Y.function.arguments}),Y.hasFinished=!0))}},flush(b){var w,x;b.enqueue({type:"finish",finishReason:c,logprobs:f,usage:{promptTokens:(w=u.promptTokens)!=null?w:NaN,completionTokens:(x=u.completionTokens)!=null?x:NaN},...v!=null?{providerMetadata:v}:{}})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(r)},warnings:n}}},fL=D.object({prompt_tokens:D.number().nullish(),completion_tokens:D.number().nullish(),prompt_tokens_details:D.object({cached_tokens:D.number().nullish()}).nullish(),completion_tokens_details:D.object({reasoning_tokens:D.number().nullish(),accepted_prediction_tokens:D.number().nullish(),rejected_prediction_tokens:D.number().nullish()}).nullish()}).nullish(),Cte=D.object({id:D.string().nullish(),created:D.number().nullish(),model:D.string().nullish(),choices:D.array(D.object({message:D.object({role:D.literal("assistant").nullish(),content:D.string().nullish(),function_call:D.object({arguments:D.string(),name:D.string()}).nullish(),tool_calls:D.array(D.object({id:D.string().nullish(),type:D.literal("function"),function:D.object({name:D.string(),arguments:D.string()})})).nullish()}),index:D.number(),logprobs:D.object({content:D.array(D.object({token:D.string(),logprob:D.number(),top_logprobs:D.array(D.object({token:D.string(),logprob:D.number()}))})).nullable()}).nullish(),finish_reason:D.string().nullish()})),usage:fL}),kte=D.union([D.object({id:D.string().nullish(),created:D.number().nullish(),model:D.string().nullish(),choices:D.array(D.object({delta:D.object({role:D.enum(["assistant"]).nullish(),content:D.string().nullish(),function_call:D.object({name:D.string().optional(),arguments:D.string().optional()}).nullish(),tool_calls:D.array(D.object({index:D.number(),id:D.string().nullish(),type:D.literal("function").nullish(),function:D.object({name:D.string().nullish(),arguments:D.string().nullish()})})).nullish()}).nullish(),logprobs:D.object({content:D.array(D.object({token:D.string(),logprob:D.number(),top_logprobs:D.array(D.object({token:D.string(),logprob:D.number()}))})).nullable()}).nullish(),finish_reason:D.string().nullish(),index:D.number()})),usage:fL}),ER]);function LT(e){return e.startsWith("o")}function Tte(e){return e.startsWith("gpt-4o-audio-preview")}function Ate(e){var t,n;return LT(e)?(n=(t=Rte[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var Rte={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function Nte({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new gc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new wr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new wr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new wr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}function G4(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,s])=>({token:r,logprob:s})):[]}))}var Ite=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:f}){var m;const g=e.type,v=[];a!=null&&v.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&v.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:b,stopSequences:w}=Nte({prompt:n,inputFormat:t}),x=[...w??[],...c??[]],_={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:f,prompt:b,stop:x.length>0?x:void 0};switch(g){case"regular":{if((m=e.tools)!=null&&m.length)throw new wr({functionality:"tools"});if(e.toolChoice)throw new wr({functionality:"toolChoice"});return{args:_,warnings:v}}case"object-json":throw new wr({functionality:"object-json mode"});case"object-tool":throw new wr({functionality:"object-tool mode"});default:{const E=g;throw new Error(`Unsupported type: ${E}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s,rawValue:i}=await Ss({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:t,failedResponseHandler:jl,successfulResponseHandler:da(jte),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t,l=s.choices[0];return{text:l.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:Sx(l.finish_reason),logprobs:G4(l.logprobs),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:r,body:i},response:Ex(s),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ss({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:r,failedResponseHandler:jl,successfulResponseHandler:lm(Mte),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,f=!0;return{stream:i.pipeThrough(new TransformStream({transform(m,g){if(!m.success){l="error",g.enqueue({type:"error",error:m.error});return}const v=m.value;if("error"in v){l="error",g.enqueue({type:"error",error:v.error});return}f&&(f=!1,g.enqueue({type:"response-metadata",...Ex(v)})),v.usage!=null&&(c={promptTokens:v.usage.prompt_tokens,completionTokens:v.usage.completion_tokens});const b=v.choices[0];(b==null?void 0:b.finish_reason)!=null&&(l=Sx(b.finish_reason)),(b==null?void 0:b.text)!=null&&g.enqueue({type:"text-delta",textDelta:b.text});const w=G4(b==null?void 0:b.logprobs);w!=null&&w.length&&(u===void 0&&(u=[]),u.push(...w))},flush(m){m.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},jte=D.object({id:D.string().nullish(),created:D.number().nullish(),model:D.string().nullish(),choices:D.array(D.object({text:D.string(),finish_reason:D.string(),logprobs:D.object({tokens:D.array(D.string()),token_logprobs:D.array(D.number()),top_logprobs:D.array(D.record(D.string(),D.number())).nullable()}).nullish()})),usage:D.object({prompt_tokens:D.number(),completion_tokens:D.number()})}),Mte=D.union([D.object({id:D.string().nullish(),created:D.number().nullish(),model:D.string().nullish(),choices:D.array(D.object({text:D.string(),finish_reason:D.string().nullish(),index:D.number(),logprobs:D.object({tokens:D.array(D.string()),token_logprobs:D.array(D.number()),top_logprobs:D.array(D.record(D.string(),D.number())).nullable()}).nullish()})),usage:D.object({prompt_tokens:D.number(),completion_tokens:D.number()}).nullish()}),ER]),Ote=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new z1({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:s}=await Ss({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:_s(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:jl,successfulResponseHandler:da(Pte),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},Pte=D.object({data:D.array(D.object({embedding:D.array(D.number())})),usage:D.object({prompt_tokens:D.number()}).nullish()}),Dte={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},Fte=new Set(["gpt-image-1"]),Lte=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:Dte[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,f;const m=[];r!=null&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&m.push({type:"unsupported-setting",setting:"seed"});const g=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:v,responseHeaders:b}=await Ss({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:_s(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(f=i.openai)!=null?f:{},...Fte.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:jl,successfulResponseHandler:da(Bte),abortSignal:o,fetch:this.config.fetch});return{images:v.data.map(w=>w.b64_json),warnings:m,response:{timestamp:g,modelId:this.modelId,headers:b}}}},Bte=D.object({data:D.array(D.object({b64_json:D.string()}))}),$te=D.object({include:D.array(D.string()).nullish(),language:D.string().nullish(),prompt:D.string().nullish(),temperature:D.number().min(0).max(1).nullish().default(0),timestampGranularities:D.array(D.enum(["word","segment"])).nullish().default(["segment"])}),K4={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},zte=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,s,i,a,o;const l=[],c=q1({provider:"openai",providerOptions:n,schema:$te}),u=new FormData,f=e instanceof Uint8Array?new Blob([e]):new Blob([V1(e)]);if(u.append("model",this.modelId),u.append("file",new File([f],"audio",{type:t})),c){const m={include:(r=c.include)!=null?r:void 0,language:(s=c.language)!=null?s:void 0,prompt:(i=c.prompt)!=null?i:void 0,temperature:(a=c.temperature)!=null?a:void 0,timestamp_granularities:(o=c.timestampGranularities)!=null?o:void 0};for(const g in m){const v=m[g];v!==void 0&&u.append(g,String(v))}}return{formData:u,warnings:l}}async doGenerate(e){var t,n,r,s,i,a;const o=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{formData:l,warnings:c}=this.getArgs(e),{value:u,responseHeaders:f,rawValue:m}=await uee({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),formData:l,failedResponseHandler:jl,successfulResponseHandler:da(Ute),abortSignal:e.abortSignal,fetch:this.config.fetch}),g=u.language!=null&&u.language in K4?K4[u.language]:void 0;return{text:u.text,segments:(i=(s=u.words)==null?void 0:s.map(v=>({text:v.word,startSecond:v.start,endSecond:v.end})))!=null?i:[],language:g,durationInSeconds:(a=u.duration)!=null?a:void 0,warnings:c,response:{timestamp:o,modelId:this.modelId,headers:f,body:m}}}},Ute=D.object({text:D.string(),language:D.string().nullish(),duration:D.number().nullish(),words:D.array(D.object({word:D.string(),start:D.number(),end:D.number()})).nullish()});function qte({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:s,content:i}of e)switch(s){case"system":{switch(t){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case"user":{n.push({role:"user",content:i.map((a,o)=>{var l,c,u,f;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image":return{type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(l=a.mimeType)!=null?l:"image/jpeg"};base64,${Hu(a.image)}`,detail:(u=(c=a.providerMetadata)==null?void 0:c.openai)==null?void 0:u.imageDetail};case"file":{if(a.data instanceof URL)throw new wr({functionality:"File URLs in user messages"});switch(a.mimeType){case"application/pdf":return{type:"input_file",filename:(f=a.filename)!=null?f:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new wr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const a of i)switch(a.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case"tool":{for(const a of i)n.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{const a=s;throw new Error(`Unsupported role: ${a}`)}}return{messages:n,warnings:r}}function W4({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function Vte({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)switch(l.type){case"function":a.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:s.push({type:"unsupported-tool",tool:l});break}break;default:s.push({type:"unsupported-tool",tool:l});break}if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return i.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:s}:{tools:a,tool_choice:{type:"function",name:i.toolName},toolWarnings:s};default:{const l=o;throw new wr({functionality:`Unsupported tool choice type: ${l}`})}}}var Hte=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:s,topK:i,presencePenalty:a,frequencyPenalty:o,seed:l,prompt:c,providerMetadata:u,responseFormat:f}){var m,g,v;const b=[],w=cne(this.modelId),x=e.type;i!=null&&b.push({type:"unsupported-setting",setting:"topK"}),l!=null&&b.push({type:"unsupported-setting",setting:"seed"}),a!=null&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&b.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:_,warnings:E}=qte({prompt:c,systemMessageMode:w.systemMessageMode});b.push(...E);const C=q1({provider:"openai",providerOptions:u,schema:une}),k=(m=C==null?void 0:C.strictSchemas)!=null?m:!0,R={model:this.modelId,input:_,temperature:n,top_p:s,max_output_tokens:t,...(f==null?void 0:f.type)==="json"&&{text:{format:f.schema!=null?{type:"json_schema",strict:k,name:(g=f.name)!=null?g:"response",description:f.description,schema:f.schema}:{type:"json_object"}}},metadata:C==null?void 0:C.metadata,parallel_tool_calls:C==null?void 0:C.parallelToolCalls,previous_response_id:C==null?void 0:C.previousResponseId,store:C==null?void 0:C.store,user:C==null?void 0:C.user,instructions:C==null?void 0:C.instructions,...w.isReasoningModel&&((C==null?void 0:C.reasoningEffort)!=null||(C==null?void 0:C.reasoningSummary)!=null)&&{reasoning:{...(C==null?void 0:C.reasoningEffort)!=null&&{effort:C.reasoningEffort},...(C==null?void 0:C.reasoningSummary)!=null&&{summary:C.reasoningSummary}}},...w.requiredAutoTruncation&&{truncation:"auto"}};switch(w.isReasoningModel&&(R.temperature!=null&&(R.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),R.top_p!=null&&(R.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),x){case"regular":{const{tools:I,tool_choice:j,toolWarnings:M}=Vte({mode:e,strict:k});return{args:{...R,tools:I,tool_choice:j},warnings:[...b,...M]}}case"object-json":return{args:{...R,text:{format:e.schema!=null?{type:"json_schema",strict:k,name:(v=e.name)!=null?v:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...R,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:k}]},warnings:b};default:{const I=x;throw new Error(`Unsupported type: ${I}`)}}}async doGenerate(e){var t,n,r,s,i,a,o;const{args:l,warnings:c}=this.getArgs(e),{responseHeaders:u,value:f,rawValue:m}=await Ss({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:l,failedResponseHandler:jl,successfulResponseHandler:da(D.object({id:D.string(),created_at:D.number(),model:D.string(),output:D.array(D.discriminatedUnion("type",[D.object({type:D.literal("message"),role:D.literal("assistant"),content:D.array(D.object({type:D.literal("output_text"),text:D.string(),annotations:D.array(D.object({type:D.literal("url_citation"),start_index:D.number(),end_index:D.number(),url:D.string(),title:D.string()}))}))}),D.object({type:D.literal("function_call"),call_id:D.string(),name:D.string(),arguments:D.string()}),D.object({type:D.literal("web_search_call")}),D.object({type:D.literal("computer_call")}),D.object({type:D.literal("reasoning"),summary:D.array(D.object({type:D.literal("summary_text"),text:D.string()}))})])),incomplete_details:D.object({reason:D.string()}).nullable(),usage:hL})),abortSignal:e.abortSignal,fetch:this.config.fetch}),g=f.output.filter(w=>w.type==="message").flatMap(w=>w.content).filter(w=>w.type==="output_text"),v=f.output.filter(w=>w.type==="function_call").map(w=>({toolCallType:"function",toolCallId:w.call_id,toolName:w.name,args:w.arguments})),b=(n=(t=f.output.find(w=>w.type==="reasoning"))==null?void 0:t.summary)!=null?n:null;return{text:g.map(w=>w.text).join(`
`),sources:g.flatMap(w=>w.annotations.map(x=>{var _,E,C;return{sourceType:"url",id:(C=(E=(_=this.config).generateId)==null?void 0:E.call(_))!=null?C:ta(),url:x.url,title:x.title}})),finishReason:W4({finishReason:(r=f.incomplete_details)==null?void 0:r.reason,hasToolCalls:v.length>0}),toolCalls:v.length>0?v:void 0,reasoning:b?b.map(w=>({type:"text",text:w.text})):void 0,usage:{promptTokens:f.usage.input_tokens,completionTokens:f.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:m},request:{body:JSON.stringify(l)},response:{id:f.id,timestamp:new Date(f.created_at*1e3),modelId:f.model},providerMetadata:{openai:{responseId:f.id,cachedPromptTokens:(i=(s=f.usage.input_tokens_details)==null?void 0:s.cached_tokens)!=null?i:null,reasoningTokens:(o=(a=f.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?o:null}},warnings:c}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s}=await Ss({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:jl,successfulResponseHandler:lm(ene),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this;let a="unknown",o=NaN,l=NaN,c=null,u=null,f=null;const m={};let g=!1;return{stream:s.pipeThrough(new TransformStream({transform(v,b){var w,x,_,E,C,k,R,I;if(!v.success){a="error",b.enqueue({type:"error",error:v.error});return}const j=v.value;if(ane(j))j.item.type==="function_call"&&(m[j.output_index]={toolName:j.item.name,toolCallId:j.item.call_id},b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:j.item.call_id,toolName:j.item.name,argsTextDelta:j.item.arguments}));else if(ine(j)){const M=m[j.output_index];M!=null&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:M.toolCallId,toolName:M.toolName,argsTextDelta:j.delta})}else sne(j)?(f=j.response.id,b.enqueue({type:"response-metadata",id:j.response.id,timestamp:new Date(j.response.created_at*1e3),modelId:j.response.model})):tne(j)?b.enqueue({type:"text-delta",textDelta:j.delta}):lne(j)?b.enqueue({type:"reasoning",textDelta:j.delta}):nne(j)&&j.item.type==="function_call"?(m[j.output_index]=void 0,g=!0,b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:j.item.call_id,toolName:j.item.name,args:j.item.arguments})):rne(j)?(a=W4({finishReason:(w=j.response.incomplete_details)==null?void 0:w.reason,hasToolCalls:g}),o=j.response.usage.input_tokens,l=j.response.usage.output_tokens,c=(_=(x=j.response.usage.input_tokens_details)==null?void 0:x.cached_tokens)!=null?_:c,u=(C=(E=j.response.usage.output_tokens_details)==null?void 0:E.reasoning_tokens)!=null?C:u):one(j)&&b.enqueue({type:"source",source:{sourceType:"url",id:(I=(R=(k=i.config).generateId)==null?void 0:R.call(k))!=null?I:ta(),url:j.annotation.url,title:j.annotation.title}})},flush(v){v.enqueue({type:"finish",finishReason:a,usage:{promptTokens:o,completionTokens:l},...(c!=null||u!=null)&&{providerMetadata:{openai:{responseId:f,cachedPromptTokens:c,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},hL=D.object({input_tokens:D.number(),input_tokens_details:D.object({cached_tokens:D.number().nullish()}).nullish(),output_tokens:D.number(),output_tokens_details:D.object({reasoning_tokens:D.number().nullish()}).nullish()}),Gte=D.object({type:D.literal("response.output_text.delta"),delta:D.string()}),Kte=D.object({type:D.enum(["response.completed","response.incomplete"]),response:D.object({incomplete_details:D.object({reason:D.string()}).nullish(),usage:hL})}),Wte=D.object({type:D.literal("response.created"),response:D.object({id:D.string(),created_at:D.number(),model:D.string()})}),Zte=D.object({type:D.literal("response.output_item.done"),output_index:D.number(),item:D.discriminatedUnion("type",[D.object({type:D.literal("message")}),D.object({type:D.literal("function_call"),id:D.string(),call_id:D.string(),name:D.string(),arguments:D.string(),status:D.literal("completed")})])}),Yte=D.object({type:D.literal("response.function_call_arguments.delta"),item_id:D.string(),output_index:D.number(),delta:D.string()}),Xte=D.object({type:D.literal("response.output_item.added"),output_index:D.number(),item:D.discriminatedUnion("type",[D.object({type:D.literal("message")}),D.object({type:D.literal("function_call"),id:D.string(),call_id:D.string(),name:D.string(),arguments:D.string()})])}),Jte=D.object({type:D.literal("response.output_text.annotation.added"),annotation:D.object({type:D.literal("url_citation"),url:D.string(),title:D.string()})}),Qte=D.object({type:D.literal("response.reasoning_summary_text.delta"),item_id:D.string(),output_index:D.number(),summary_index:D.number(),delta:D.string()}),ene=D.union([Gte,Kte,Wte,Zte,Yte,Xte,Jte,Qte,D.object({type:D.string()}).passthrough()]);function tne(e){return e.type==="response.output_text.delta"}function nne(e){return e.type==="response.output_item.done"}function rne(e){return e.type==="response.completed"||e.type==="response.incomplete"}function sne(e){return e.type==="response.created"}function ine(e){return e.type==="response.function_call_arguments.delta"}function ane(e){return e.type==="response.output_item.added"}function one(e){return e.type==="response.output_text.annotation.added"}function lne(e){return e.type==="response.reasoning_summary_text.delta"}function cne(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var une=D.object({metadata:D.any().nullish(),parallelToolCalls:D.boolean().nullish(),previousResponseId:D.string().nullish(),store:D.boolean().nullish(),user:D.string().nullish(),reasoningEffort:D.string().nullish(),strictSchemas:D.boolean().nullish(),instructions:D.string().nullish(),reasoningSummary:D.string().nullish()}),dne=D.object({});function fne({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:dne}}var hne={webSearchPreview:fne},pne=D.object({instructions:D.string().nullish(),speed:D.number().min(.25).max(4).default(1).nullish()}),mne=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:s,providerOptions:i}){const a=[],o=q1({provider:"openai",providerOptions:i,schema:pne}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:s};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){const c={};for(const u in c){const f=c[u];f!==void 0&&(l[u]=f)}}return{requestBody:l,warnings:a}}async doGenerate(e){var t,n,r;const s=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{requestBody:i,warnings:a}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:c}=await Ss({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:i,failedResponseHandler:jl,successfulResponseHandler:dee(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:a,request:{body:JSON.stringify(i)},response:{timestamp:s,modelId:this.modelId,headers:l,body:c}}}};function pL(e={}){var t,n,r;const s=(t=H1(e.baseURL))!=null?t:"https://api.openai.com/v1",i=(n=e.compatibility)!=null?n:"compatible",a=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${eL({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(x,_={})=>new Ete(x,_,{provider:`${a}.chat`,url:({path:E})=>`${s}${E}`,headers:o,compatibility:i,fetch:e.fetch}),c=(x,_={})=>new Ite(x,_,{provider:`${a}.completion`,url:({path:E})=>`${s}${E}`,headers:o,compatibility:i,fetch:e.fetch}),u=(x,_={})=>new Ote(x,_,{provider:`${a}.embedding`,url:({path:E})=>`${s}${E}`,headers:o,fetch:e.fetch}),f=(x,_={})=>new Lte(x,_,{provider:`${a}.image`,url:({path:E})=>`${s}${E}`,headers:o,fetch:e.fetch}),m=x=>new zte(x,{provider:`${a}.transcription`,url:({path:_})=>`${s}${_}`,headers:o,fetch:e.fetch}),g=x=>new mne(x,{provider:`${a}.speech`,url:({path:_})=>`${s}${_}`,headers:o,fetch:e.fetch}),v=(x,_)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return x==="gpt-3.5-turbo-instruct"?c(x,_):l(x,_)},b=x=>new Hte(x,{provider:`${a}.responses`,url:({path:_})=>`${s}${_}`,headers:o,fetch:e.fetch}),w=function(x,_){return v(x,_)};return w.languageModel=v,w.chat=l,w.completion=c,w.responses=b,w.embedding=u,w.textEmbedding=u,w.textEmbeddingModel=u,w.image=f,w.imageModel=f,w.transcription=m,w.transcriptionModel=m,w.speech=g,w.speechModel=g,w.tools=hne,w}pL({compatibility:"strict"});function Ja(e){if(gne(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:s,items:i,allOf:a,anyOf:o,oneOf:l,format:c,const:u,minLength:f,enum:m}=e,g={};if(n&&(g.description=n),r&&(g.required=r),c&&(g.format=c),u!==void 0&&(g.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(g.type=t.filter(v=>v!=="null")[0],g.nullable=!0):g.type=t:t==="null"?g.type="null":g.type=t),m!==void 0&&(g.enum=m),s!=null&&(g.properties=Object.entries(s).reduce((v,[b,w])=>(v[b]=Ja(w),v),{})),i&&(g.items=Array.isArray(i)?i.map(Ja):Ja(i)),a&&(g.allOf=a.map(Ja)),o)if(o.some(v=>typeof v=="object"&&(v==null?void 0:v.type)==="null")){const v=o.filter(b=>!(typeof b=="object"&&(b==null?void 0:b.type)==="null"));if(v.length===1){const b=Ja(v[0]);typeof b=="object"&&(g.nullable=!0,Object.assign(g,b))}else g.anyOf=v.map(Ja),g.nullable=!0}else g.anyOf=o.map(Ja);return l&&(g.oneOf=l.map(Ja)),f!==void 0&&(g.minLength=f),g}function gne(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function yne(e){var t,n;const r=[],s=[];let i=!0;for(const{role:a,content:o}of e)switch(a){case"system":{if(!i)throw new wr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{i=!1;const l=[];for(const c of o)switch(c.type){case"text":{l.push({text:c.text});break}case"image":{l.push(c.image instanceof URL?{fileData:{mimeType:(t=c.mimeType)!=null?t:"image/jpeg",fileUri:c.image.toString()}}:{inlineData:{mimeType:(n=c.mimeType)!=null?n:"image/jpeg",data:Hu(c.image)}});break}case"file":{l.push(c.data instanceof URL?{fileData:{mimeType:c.mimeType,fileUri:c.data.toString()}}:{inlineData:{mimeType:c.mimeType,data:c.data}});break}}s.push({role:"user",parts:l});break}case"assistant":{i=!1,s.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new wr({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new wr({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{i=!1,s.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:s}}function Z4(e){return e.includes("/")?e:`models/${e}`}var bne=D.object({error:D.object({code:D.number().nullable(),message:D.string(),status:D.string()})}),BT=$f({errorSchema:bne,errorToMessage:e=>e.error.message});function vne(e,t,n,r){var s,i;const a=(s=e.tools)!=null&&s.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),c=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!c||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(a==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const u=[];for(const g of a)g.type==="provider-defined"?o.push({type:"unsupported-tool",tool:g}):u.push({name:g.name,description:(i=g.description)!=null?i:"",parameters:Ja(g.parameters)});const f=e.toolChoice;if(f==null)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:o};const m=f.type;switch(m){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[f.toolName]}},toolWarnings:o};default:{const g=m;throw new wr({functionality:`Unsupported tool choice type: ${g}`})}}}function Y4({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var wne=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:f}){var m,g;const v=e.type,b=[],w=q1({provider:"google",providerOptions:f,schema:Ene}),x={maxOutputTokens:n,temperature:r,topK:i,topP:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,seed:u,responseMimeType:(c==null?void 0:c.type)==="json"?"application/json":void 0,responseSchema:(c==null?void 0:c.type)==="json"&&c.schema!=null&&this.supportsStructuredOutputs?Ja(c.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:w==null?void 0:w.responseModalities,thinkingConfig:w==null?void 0:w.thinkingConfig},{contents:_,systemInstruction:E}=yne(t);switch(v){case"regular":{const{tools:C,toolConfig:k,toolWarnings:R}=vne(e,(m=this.settings.useSearchGrounding)!=null?m:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:x,contents:_,systemInstruction:E,safetySettings:this.settings.safetySettings,tools:C,toolConfig:k,cachedContent:this.settings.cachedContent},warnings:[...b,...R]}}case"object-json":return{args:{generationConfig:{...x,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?Ja(e.schema):void 0},contents:_,systemInstruction:E,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:b};case"object-tool":return{args:{generationConfig:x,contents:_,tools:{functionDeclarations:[{name:e.tool.name,description:(g=e.tool.description)!=null?g:"",parameters:Ja(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:b};default:{const C=v;throw new Error(`Unsupported type: ${C}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,s,i;const{args:a,warnings:o}=await this.getArgs(e),l=JSON.stringify(a),c=_s(await MT(this.config.headers),e.headers),{responseHeaders:u,value:f,rawValue:m}=await Ss({url:`${this.config.baseURL}/${Z4(this.modelId)}:generateContent`,headers:c,body:a,failedResponseHandler:BT,successfulResponseHandler:da(_ne),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:g,...v}=a,b=f.candidates[0],w=b.content==null||typeof b.content!="object"||!("parts"in b.content)?[]:b.content.parts,x=X4({parts:w,generateId:this.config.generateId}),_=f.usageMetadata;return{text:J4(w),files:(t=Q4(w))==null?void 0:t.map(E=>({data:E.inlineData.data,mimeType:E.inlineData.mimeType})),toolCalls:x,finishReason:Y4({finishReason:b.finishReason,hasToolCalls:x!=null&&x.length>0}),usage:{promptTokens:(n=_==null?void 0:_.promptTokenCount)!=null?n:NaN,completionTokens:(r=_==null?void 0:_.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:g,rawSettings:v},rawResponse:{headers:u,body:m},warnings:o,providerMetadata:{google:{groundingMetadata:(s=b.groundingMetadata)!=null?s:null,safetyRatings:(i=b.safetyRatings)!=null?i:null}},sources:e6({groundingMetadata:b.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),s=_s(await MT(this.config.headers),e.headers),{responseHeaders:i,value:a}=await Ss({url:`${this.config.baseURL}/${Z4(this.modelId)}:streamGenerateContent?alt=sse`,headers:s,body:t,failedResponseHandler:BT,successfulResponseHandler:lm(Sne),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let c="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},f;const m=this.config.generateId;let g=!1;return{stream:a.pipeThrough(new TransformStream({transform(v,b){var w,x,_,E,C,k;if(!v.success){b.enqueue({type:"error",error:v.error});return}const R=v.value,I=R.usageMetadata;I!=null&&(u={promptTokens:(w=I.promptTokenCount)!=null?w:NaN,completionTokens:(x=I.candidatesTokenCount)!=null?x:NaN});const j=(_=R.candidates)==null?void 0:_[0];if(j==null)return;const M=j.content;if(M!=null){const L=J4(M.parts);L!=null&&b.enqueue({type:"text-delta",textDelta:L});const q=Q4(M.parts);if(q!=null)for(const V of q)b.enqueue({type:"file",mimeType:V.inlineData.mimeType,data:V.inlineData.data});const P=X4({parts:M.parts,generateId:m});if(P!=null)for(const V of P)b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:V.toolCallId,toolName:V.toolName,argsTextDelta:V.args}),b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:V.toolCallId,toolName:V.toolName,args:V.args}),g=!0}if(j.finishReason!=null){c=Y4({finishReason:j.finishReason,hasToolCalls:g});const L=(E=e6({groundingMetadata:j.groundingMetadata,generateId:m}))!=null?E:[];for(const q of L)b.enqueue({type:"source",source:q});f={google:{groundingMetadata:(C=j.groundingMetadata)!=null?C:null,safetyRatings:(k=j.safetyRatings)!=null?k:null}}}},flush(v){v.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:f})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:n,request:{body:r}}}};function X4({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function J4(e){const t=e==null?void 0:e.filter(n=>"text"in n);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function Q4(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function e6({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var mL=D.object({role:D.string(),parts:D.array(D.union([D.object({text:D.string()}),D.object({functionCall:D.object({name:D.string(),args:D.unknown()})}),D.object({inlineData:D.object({mimeType:D.string(),data:D.string()})})])).nullish()}),xne=D.object({web:D.object({uri:D.string(),title:D.string()}).nullish(),retrievedContext:D.object({uri:D.string(),title:D.string()}).nullish()}),gL=D.object({webSearchQueries:D.array(D.string()).nullish(),retrievalQueries:D.array(D.string()).nullish(),searchEntryPoint:D.object({renderedContent:D.string()}).nullish(),groundingChunks:D.array(xne).nullish(),groundingSupports:D.array(D.object({segment:D.object({startIndex:D.number().nullish(),endIndex:D.number().nullish(),text:D.string().nullish()}),segment_text:D.string().nullish(),groundingChunkIndices:D.array(D.number()).nullish(),supportChunkIndices:D.array(D.number()).nullish(),confidenceScores:D.array(D.number()).nullish(),confidenceScore:D.array(D.number()).nullish()})).nullish(),retrievalMetadata:D.union([D.object({webDynamicRetrievalScore:D.number()}),D.object({})]).nullish()}),yL=D.object({category:D.string().nullish(),probability:D.string().nullish(),probabilityScore:D.number().nullish(),severity:D.string().nullish(),severityScore:D.number().nullish(),blocked:D.boolean().nullish()}),_ne=D.object({candidates:D.array(D.object({content:mL.nullish().or(D.object({}).strict()),finishReason:D.string().nullish(),safetyRatings:D.array(yL).nullish(),groundingMetadata:gL.nullish()})),usageMetadata:D.object({promptTokenCount:D.number().nullish(),candidatesTokenCount:D.number().nullish(),totalTokenCount:D.number().nullish()}).nullish()}),Sne=D.object({candidates:D.array(D.object({content:mL.nullish(),finishReason:D.string().nullish(),safetyRatings:D.array(yL).nullish(),groundingMetadata:gL.nullish()})).nullish(),usageMetadata:D.object({promptTokenCount:D.number().nullish(),candidatesTokenCount:D.number().nullish(),totalTokenCount:D.number().nullish()}).nullish()}),Ene=D.object({responseModalities:D.array(D.enum(["TEXT","IMAGE"])).nullish(),thinkingConfig:D.object({thinkingBudget:D.number().nullish()}).nullish()}),Cne=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new z1({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=_s(await MT(this.config.headers),t),{responseHeaders:s,value:i}=await Ss({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:BT,successfulResponseHandler:da(kne),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.embeddings.map(a=>a.values),usage:void 0,rawResponse:{headers:s}}}},kne=D.object({embeddings:D.array(D.object({values:D.array(D.number())}))});function Tne(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function bL(e={}){var t;const n=(t=H1(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":eL({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),s=(o,l={})=>{var c;return new wne(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(c=e.generateId)!=null?c:ta,isSupportedUrl:Tne,fetch:e.fetch})},i=(o,l={})=>new Cne(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),a=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return s(o,l)};return a.languageModel=s,a.chat=s,a.generativeAI=s,a.embedding=i,a.textEmbedding=i,a.textEmbeddingModel=i,a}bL();var vL="vercel.ai.error",Ane=Symbol.for(vL),wL,Rne=class xL extends Error{constructor({name:t,message:n,cause:r}){super(n),this[wL]=!0,this.name=t,this.cause=r}static isInstance(t){return xL.hasMarker(t,vL)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};wL=Ane;var ti=Rne,_L="AI_APICallError",SL=`vercel.ai.error.${_L}`,Nne=Symbol.for(SL),EL,wc=class extends ti{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:s,responseBody:i,cause:a,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:_L,message:e,cause:a}),this[EL]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=s,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return ti.hasMarker(e,SL)}};EL=Nne;var CL="AI_EmptyResponseBodyError",kL=`vercel.ai.error.${CL}`,Ine=Symbol.for(kL),TL,jne=class extends ti{constructor({message:e="Empty response body"}={}){super({name:CL,message:e}),this[TL]=!0}static isInstance(e){return ti.hasMarker(e,kL)}};TL=Ine;function AL(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var RL="AI_InvalidArgumentError",NL=`vercel.ai.error.${RL}`,Mne=Symbol.for(NL),IL,One=class extends ti{constructor({message:t,cause:n,argument:r}){super({name:RL,message:t,cause:n}),this[IL]=!0,this.argument=r}static isInstance(t){return ti.hasMarker(t,NL)}};IL=Mne;var jL="AI_InvalidPromptError",ML=`vercel.ai.error.${jL}`,Pne=Symbol.for(ML),OL,Dne=class extends ti{constructor({prompt:e,message:t,cause:n}){super({name:jL,message:`Invalid prompt: ${t}`,cause:n}),this[OL]=!0,this.prompt=e}static isInstance(e){return ti.hasMarker(e,ML)}};OL=Pne;var PL="AI_InvalidResponseDataError",DL=`vercel.ai.error.${PL}`,Fne=Symbol.for(DL),FL,wE=class extends ti{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:PL,message:t}),this[FL]=!0,this.data=e}static isInstance(e){return ti.hasMarker(e,DL)}};FL=Fne;var LL="AI_JSONParseError",BL=`vercel.ai.error.${LL}`,Lne=Symbol.for(BL),$L,Cx=class extends ti{constructor({text:e,cause:t}){super({name:LL,message:`JSON parsing failed: Text: ${e}.
Error message: ${AL(t)}`,cause:t}),this[$L]=!0,this.text=e}static isInstance(e){return ti.hasMarker(e,BL)}};$L=Lne;var zL="AI_LoadAPIKeyError",UL=`vercel.ai.error.${zL}`,Bne=Symbol.for(UL),qL,sw=class extends ti{constructor({message:e}){super({name:zL,message:e}),this[qL]=!0}static isInstance(e){return ti.hasMarker(e,UL)}};qL=Bne;var VL="AI_TypeValidationError",HL=`vercel.ai.error.${VL}`,$ne=Symbol.for(HL),GL,zne=class $T extends ti{constructor({value:t,cause:n}){super({name:VL,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${AL(n)}`,cause:n}),this[GL]=!0,this.value=t}static isInstance(t){return ti.hasMarker(t,HL)}static wrap({value:t,cause:n}){return $T.isInstance(n)&&n.value===t?n:new $T({value:t,cause:n})}};GL=$ne;var kx=zne,KL="AI_UnsupportedFunctionalityError",WL=`vercel.ai.error.${KL}`,Une=Symbol.for(WL),ZL,to=class extends ti{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:KL,message:t}),this[ZL]=!0,this.functionality=e}static isInstance(e){return ti.hasMarker(e,WL)}};ZL=Une;let qne=(e,t=21)=>(n=t)=>{let r="",s=n|0;for(;s--;)r+=e[Math.random()*e.length|0];return r},t6=class extends Error{constructor(t,n){super(t),this.name="ParseError",this.type=n.type,this.field=n.field,this.value=n.value,this.line=n.line}};function xE(e){}function Vne(e){if(typeof e=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=xE,onError:n=xE,onRetry:r=xE,onComment:s}=e;let i="",a=!0,o,l="",c="";function u(b){const w=a?b.replace(/^\xEF\xBB\xBF/,""):b,[x,_]=Hne(`${i}${w}`);for(const E of x)f(E);i=_,a=!1}function f(b){if(b===""){g();return}if(b.startsWith(":")){s&&s(b.slice(b.startsWith(": ")?2:1));return}const w=b.indexOf(":");if(w!==-1){const x=b.slice(0,w),_=b[w+1]===" "?2:1,E=b.slice(w+_);m(x,E,b);return}m(b,"",b)}function m(b,w,x){switch(b){case"event":c=w;break;case"data":l=`${l}${w}
`;break;case"id":o=w.includes("\0")?void 0:w;break;case"retry":/^\d+$/.test(w)?r(parseInt(w,10)):n(new t6(`Invalid \`retry\` value: "${w}"`,{type:"invalid-retry",value:w,line:x}));break;default:n(new t6(`Unknown field "${b.length>20?`${b.slice(0,20)}`:b}"`,{type:"unknown-field",field:b,value:w,line:x}));break}}function g(){l.length>0&&t({id:o,event:c||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),o=void 0,l="",c=""}function v(b={}){i&&b.consume&&f(i),a=!0,o=void 0,l="",c="",i=""}return{feed:u,reset:v}}function Hne(e){const t=[];let n="",r=0;for(;r<e.length;){const s=e.indexOf("\r",r),i=e.indexOf(`
`,r);let a=-1;if(s!==-1&&i!==-1?a=Math.min(s,i):s!==-1?a=s:i!==-1&&(a=i),a===-1){n=e.slice(r);break}else{const o=e.slice(r,a);t.push(o),r=a+1,e[r-1]==="\r"&&e[r]===`
`&&r++}}return[t,n]}class Gne extends TransformStream{constructor({onError:t,onRetry:n,onComment:r}={}){let s;super({start(i){s=Vne({onEvent:a=>{i.enqueue(a)},onError(a){t==="terminate"?i.error(a):typeof t=="function"&&t(a)},onRetry:n,onComment:r})},transform(i){s.feed(i)}})}}var Kne={};function Tx(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function K1(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Wne=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const s=qne(n,t);if(e==null)return s;if(n.includes(r))throw new One({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${s(i)}`},iw=Wne();function Zne(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function _E(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function Yne({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new sw({message:`${r} API key must be a string.`});if(typeof vs>"u")throw new sw({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=Kne[t],e==null)throw new sw({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new sw({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var zT=Symbol.for("vercel.ai.validator");function Xne(e){return{[zT]:!0,validate:e}}function Jne(e){return typeof e=="object"&&e!==null&&zT in e&&e[zT]===!0&&"validate"in e}function Qne(e){return Jne(e)?e:ere(e)}function ere(e){return Xne(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function tre({value:e,schema:t}){const n=YL({value:e,schema:t});if(!n.success)throw kx.wrap({value:e,cause:n.error});return n.value}function YL({value:e,schema:t}){const n=Qne(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:kx.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:kx.wrap({value:e,cause:r})}}}function nre({text:e,schema:t}){try{const n=im.parse(e);return t==null?n:tre({value:n,schema:t})}catch(n){throw Cx.isInstance(n)||kx.isInstance(n)?n:new Cx({text:e,cause:n})}}function XL({text:e,schema:t}){try{const n=im.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=YL({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:Cx.isInstance(n)?n:new Cx({text:e,cause:n})}}}function SE(e){try{return im.parse(e),!0}catch{return!1}}var rre=()=>globalThis.fetch,Ax=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>sre({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),sre=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:a=rre()})=>{try{const o=await a(e,{method:"POST",headers:Zne(t),body:n.content,signal:i}),l=K1(o);if(!o.ok){let c;try{c=await s({response:o,url:e,requestBodyValues:n.values})}catch(u){throw _E(u)||wc.isInstance(u)?u:new wc({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(_E(c)||wc.isInstance(c))?c:new wc({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(_E(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new wc({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}},ire=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{const a=await r.text(),o=K1(r);if(a.trim()==="")return{responseHeaders:o,value:new wc({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=nre({text:a,schema:e});return{responseHeaders:o,value:new wc({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new wc({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},JL=e=>async({response:t})=>{const n=K1(t);if(t.body==null)throw new jne({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new Gne).pipeThrough(new TransformStream({transform({data:r},s){r!=="[DONE]"&&s.enqueue(XL({text:r,schema:e}))}}))}},QL=e=>async({response:t,url:n,requestBodyValues:r})=>{const s=await t.text(),i=XL({text:s,schema:e}),a=K1(t);if(!i.success)throw new wc({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:a,value:i.value,rawValue:i.rawValue}},{btoa:are}=globalThis;function ore(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return are(t)}function lre(e){return e==null?void 0:e.replace(/\/$/,"")}var cre=Object.defineProperty,ure=Object.defineProperties,dre=Object.getOwnPropertyDescriptors,Rx=Object.getOwnPropertySymbols,e9=Object.prototype.hasOwnProperty,t9=Object.prototype.propertyIsEnumerable,n6=(e,t,n)=>t in e?cre(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ka=(e,t)=>{for(var n in t||(t={}))e9.call(t,n)&&n6(e,n,t[n]);if(Rx)for(var n of Rx(t))t9.call(t,n)&&n6(e,n,t[n]);return e},Kw=(e,t)=>ure(e,dre(t)),Nx=(e,t)=>{var n={};for(var r in e)e9.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Rx)for(var r of Rx(e))t.indexOf(r)<0&&t9.call(e,r)&&(n[r]=e[r]);return n};function dl(e){var t,n,r;const s=e==null?void 0:e.anthropic,i=e==null?void 0:e.openrouter;return(r=(n=(t=i==null?void 0:i.cacheControl)!=null?t:i==null?void 0:i.cache_control)!=null?n:s==null?void 0:s.cacheControl)!=null?r:s==null?void 0:s.cache_control}function fre(e){var t,n,r;const s=[];for(const{role:i,content:a,providerMetadata:o}of e)switch(i){case"system":{s.push({role:"system",content:a,cache_control:dl(o)});break}case"user":{if(a.length===1&&((t=a[0])==null?void 0:t.type)==="text"){s.push({role:"user",content:a[0].text,cache_control:(n=dl(o))!=null?n:dl(a[0].providerMetadata)});break}const l=dl(o),c=a.map(u=>{var f,m,g,v;switch(u.type){case"text":return{type:"text",text:u.text,cache_control:(f=dl(u.providerMetadata))!=null?f:l};case"image":return{type:"image_url",image_url:{url:u.image instanceof URL?u.image.toString():`data:${(m=u.mimeType)!=null?m:"image/jpeg"};base64,${ore(u.image)}`},cache_control:(g=dl(u.providerMetadata))!=null?g:l};case"file":return{type:"text",text:u.data instanceof URL?u.data.toString():u.data,cache_control:(v=dl(u.providerMetadata))!=null?v:l};default:{const b=u;throw new Error(`Unsupported content part type: ${b}`)}}});s.push({role:"user",content:c});break}case"assistant":{let l="";const c=[];for(const u of a)switch(u.type){case"text":{l+=u.text;break}case"tool-call":{c.push({id:u.toolCallId,type:"function",function:{name:u.toolName,arguments:JSON.stringify(u.args)}});break}case"reasoning":case"redacted-reasoning":break;default:{const f=u;throw new Error(`Unsupported part: ${f}`)}}s.push({role:"assistant",content:l,tool_calls:c.length>0?c:void 0,cache_control:dl(o)});break}case"tool":{for(const l of a)s.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=dl(o))!=null?r:dl(l.providerMetadata)});break}default:{const l=i;throw new Error(`Unsupported role: ${l}`)}}return s}function r6(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function Ix(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var CR=D.object({error:D.object({message:D.string(),type:D.string(),param:D.any().nullable(),code:D.string().nullable()})}),jx=ire({errorSchema:CR,errorToMessage:e=>e.error.message});function hre(e){return"parameters"in e}var pre=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,frequencyPenalty:i,presencePenalty:a,seed:o,stopSequences:l,responseFormat:c,topK:u,providerMetadata:f}){var m;const g=e.type,v=(m=f==null?void 0:f.openrouter)!=null?m:{},b=ka(ka(ka({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:a,seed:o,stop:l,response_format:c,top_k:u,messages:fre(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),v);switch(g){case"regular":return ka(ka({},b),yre(e));case"object-json":return Kw(ka({},b),{response_format:{type:"json_object"}});case"object-tool":return Kw(ka({},b),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const w=g;throw new to({functionality:`${w} mode`})}}}async doGenerate(e){var t,n,r,s,i,a,o;const l=this.getArgs(e),{responseHeaders:c,value:u}=await Ax({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Tx(this.config.headers(),e.headers),body:l,failedResponseHandler:jx,successfulResponseHandler:QL(mre),abortSignal:e.abortSignal,fetch:this.config.fetch}),f=l,{messages:m}=f,g=Nx(f,["messages"]),v=u.choices[0];if(!v)throw new Error("No choice in response");return{response:{id:u.id,modelId:u.model},text:(t=v.message.content)!=null?t:void 0,reasoning:(n=v.message.reasoning)!=null?n:void 0,toolCalls:(r=v.message.tool_calls)==null?void 0:r.map(b=>{var w;return{toolCallType:"function",toolCallId:(w=b.id)!=null?w:iw(),toolName:b.function.name,args:b.function.arguments}}),finishReason:Ix(v.finish_reason),usage:{promptTokens:(i=(s=u.usage)==null?void 0:s.prompt_tokens)!=null?i:0,completionTokens:(o=(a=u.usage)==null?void 0:a.completion_tokens)!=null?o:0},rawCall:{rawPrompt:m,rawSettings:g},rawResponse:{headers:c},warnings:[],logprobs:r6(v.logprobs)}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Ax({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Tx(this.config.headers(),e.headers),body:Kw(ka({},t),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:jx,successfulResponseHandler:JL(gre),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=t,{messages:i}=s,a=Nx(s,["messages"]),o=[];let l="other",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u;return{stream:r.pipeThrough(new TransformStream({transform(f,m){var g,v,b,w,x,_,E,C,k,R,I,j;if(!f.success){l="error",m.enqueue({type:"error",error:f.error});return}const M=f.value;if("error"in M){l="error",m.enqueue({type:"error",error:M.error});return}M.id&&m.enqueue({type:"response-metadata",id:M.id}),M.model&&m.enqueue({type:"response-metadata",modelId:M.model}),M.usage!=null&&(c={promptTokens:M.usage.prompt_tokens,completionTokens:M.usage.completion_tokens});const L=M.choices[0];if((L==null?void 0:L.finish_reason)!=null&&(l=Ix(L.finish_reason)),(L==null?void 0:L.delta)==null)return;const q=L.delta;q.content!=null&&m.enqueue({type:"text-delta",textDelta:q.content}),q.reasoning!=null&&m.enqueue({type:"reasoning",textDelta:q.reasoning});const P=r6(L==null?void 0:L.logprobs);if(P!=null&&P.length&&(u===void 0&&(u=[]),u.push(...P)),q.tool_calls!=null)for(const V of q.tool_calls){const z=V.index;if(o[z]==null){if(V.type!=="function")throw new wE({data:V,message:"Expected 'function' type."});if(V.id==null)throw new wE({data:V,message:"Expected 'id' to be a string."});if(((g=V.function)==null?void 0:g.name)==null)throw new wE({data:V,message:"Expected 'function.name' to be a string."});o[z]={id:V.id,type:"function",function:{name:V.function.name,arguments:(v=V.function.arguments)!=null?v:""},sent:!1};const K=o[z];if(K==null)throw new Error("Tool call is missing");((b=K.function)==null?void 0:b.name)!=null&&((w=K.function)==null?void 0:w.arguments)!=null&&SE(K.function.arguments)&&(m.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:K.id,toolName:K.function.name,argsTextDelta:K.function.arguments}),m.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(x=K.id)!=null?x:iw(),toolName:K.function.name,args:K.function.arguments}),K.sent=!0);continue}const re=o[z];if(re==null)throw new Error("Tool call is missing");((_=V.function)==null?void 0:_.arguments)!=null&&(re.function.arguments+=(C=(E=V.function)==null?void 0:E.arguments)!=null?C:""),m.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:re.id,toolName:re.function.name,argsTextDelta:(k=V.function.arguments)!=null?k:""}),((R=re.function)==null?void 0:R.name)!=null&&((I=re.function)==null?void 0:I.arguments)!=null&&SE(re.function.arguments)&&(m.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(j=re.id)!=null?j:iw(),toolName:re.function.name,args:re.function.arguments}),re.sent=!0)}},flush(f){var m;if(l==="tool-calls")for(const g of o)g.sent||(f.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(m=g.id)!=null?m:iw(),toolName:g.function.name,args:SE(g.function.arguments)?g.function.arguments:"{}"}),g.sent=!0);f.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},n9=D.object({id:D.string().optional(),model:D.string().optional(),usage:D.object({prompt_tokens:D.number(),completion_tokens:D.number(),total_tokens:D.number()}).nullish()}),mre=n9.extend({choices:D.array(D.object({message:D.object({role:D.literal("assistant"),content:D.string().nullable().optional(),reasoning:D.string().nullable().optional(),tool_calls:D.array(D.object({id:D.string().optional().nullable(),type:D.literal("function"),function:D.object({name:D.string(),arguments:D.string()})})).optional()}),index:D.number(),logprobs:D.object({content:D.array(D.object({token:D.string(),logprob:D.number(),top_logprobs:D.array(D.object({token:D.string(),logprob:D.number()}))})).nullable()}).nullable().optional(),finish_reason:D.string().optional().nullable()}))}),gre=D.union([n9.extend({choices:D.array(D.object({delta:D.object({role:D.enum(["assistant"]).optional(),content:D.string().nullish(),reasoning:D.string().nullish().optional(),tool_calls:D.array(D.object({index:D.number(),id:D.string().nullish(),type:D.literal("function").optional(),function:D.object({name:D.string().nullish(),arguments:D.string().nullish()})})).nullish()}).nullish(),logprobs:D.object({content:D.array(D.object({token:D.string(),logprob:D.number(),top_logprobs:D.array(D.object({token:D.string(),logprob:D.number()}))})).nullable()}).nullish(),finish_reason:D.string().nullable().optional(),index:D.number()}))}),CR]);function yre(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(a=>hre(a)?{type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}}:{type:"function",function:{name:a.name}}),s=e.toolChoice;if(s==null)return{tools:r,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:r,tool_choice:i};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const a=i;throw new Error(`Unsupported tool choice type: ${a}`)}}}function bre({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0]&&e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new Dne({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new to({functionality:"images"});case"file":throw new to({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new to({functionality:"tool-call messages"});case"reasoning":throw new to({functionality:"reasoning messages"});case"redacted-reasoning":throw new to({functionality:"redacted reasoning messages"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new to({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s}}function s6(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,s;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((s=e.top_logprobs[n])!=null?s:{}).map(([i,a])=>({token:i,logprob:a})):[]}})}var vre=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,frequencyPenalty:a,presencePenalty:o,seed:l,responseFormat:c,topK:u,stopSequences:f,providerMetadata:m}){var g,v;const b=e.type,w=(g=m==null?void 0:m.openrouter)!=null?g:{},{prompt:x}=bre({prompt:n,inputFormat:t}),_=ka(ka(ka({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:o,seed:l,stop:f,response_format:c,top_k:u,prompt:x,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),w);switch(b){case"regular":{if((v=e.tools)!=null&&v.length)throw new to({functionality:"tools"});if(e.toolChoice)throw new to({functionality:"toolChoice"});return _}case"object-json":throw new to({functionality:"object-json mode"});case"object-tool":throw new to({functionality:"object-tool mode"});default:{const E=b;throw new to({functionality:`${E} mode`})}}}async doGenerate(e){var t,n,r,s,i;const a=this.getArgs(e),{responseHeaders:o,value:l}=await Ax({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Tx(this.config.headers(),e.headers),body:a,failedResponseHandler:jx,successfulResponseHandler:QL(i6),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=a,{prompt:u}=c,f=Nx(c,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const m=l.choices[0];if(!m)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=m.text)!=null?t:"",reasoning:m.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(i=(s=l.usage)==null?void 0:s.completion_tokens)!=null?i:0},finishReason:Ix(m.finish_reason),logprobs:s6(m.logprobs),rawCall:{rawPrompt:u,rawSettings:f},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Ax({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Tx(this.config.headers(),e.headers),body:Kw(ka({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:jx,successfulResponseHandler:JL(i6),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=t,{prompt:i}=s,a=Nx(s,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:r.pipeThrough(new TransformStream({transform(u,f){if(!u.success){o="error",f.enqueue({type:"error",error:u.error});return}const m=u.value;if("error"in m){o="error",f.enqueue({type:"error",error:m.error});return}m.usage!=null&&(l={promptTokens:m.usage.prompt_tokens,completionTokens:m.usage.completion_tokens});const g=m.choices[0];(g==null?void 0:g.finish_reason)!=null&&(o=Ix(g.finish_reason)),(g==null?void 0:g.text)!=null&&f.enqueue({type:"text-delta",textDelta:g.text});const v=s6(g==null?void 0:g.logprobs);v!=null&&v.length&&(c===void 0&&(c=[]),c.push(...v))},flush(u){u.enqueue({type:"finish",finishReason:o,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},i6=D.union([D.object({id:D.string().optional(),model:D.string().optional(),choices:D.array(D.object({text:D.string(),reasoning:D.string().nullish().optional(),finish_reason:D.string().nullish(),index:D.number(),logprobs:D.object({tokens:D.array(D.string()),token_logprobs:D.array(D.number()),top_logprobs:D.array(D.record(D.string(),D.number())).nullable()}).nullable().optional()})),usage:D.object({prompt_tokens:D.number(),completion_tokens:D.number()}).optional().nullable()}),CR]);function r9(e={}){var t,n,r;const s=(n=lre((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",i=(r=e.compatibility)!=null?r:"compatible",a=()=>ka({Authorization:`Bearer ${Yne({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(f,m={})=>new pre(f,m,{provider:"openrouter.chat",url:({path:g})=>`${s}${g}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),l=(f,m={})=>new vre(f,m,{provider:"openrouter.completion",url:({path:g})=>`${s}${g}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),c=(f,m)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return f==="openai/gpt-3.5-turbo-instruct"?l(f,m):o(f,m)},u=function(f,m){return c(f,m)};return u.languageModel=c,u.chat=o,u.completion=l,u}r9({compatibility:"strict"});var Qd={},EE={},a6;function o6(){return a6||(a6=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(EE)),EE}var l6;function wre(){return l6||(l6=1,function(e){var t=Qd&&Qd.__createBinding||(Object.create?function(c,u,f,m){m===void 0&&(m=f);var g=Object.getOwnPropertyDescriptor(u,f);(!g||("get"in g?!u.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return u[f]}}),Object.defineProperty(c,m,g)}:function(c,u,f,m){m===void 0&&(m=f),c[m]=u[f]}),n=Qd&&Qd.__exportStar||function(c,u){for(var f in c)f!=="default"&&!Object.prototype.hasOwnProperty.call(u,f)&&t(u,c,f)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=o6();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(o6(),e);class s extends Error{}e.PartialJSON=s;class i extends Error{}e.MalformedJSON=i;function a(c,u=r.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return o(c.trim(),u)}e.parseJSON=a;const o=(c,u)=>{const f=c.length;let m=0;const g=k=>{throw new s(`${k} at position ${m}`)},v=k=>{throw new i(`${k} at position ${m}`)},b=()=>(C(),m>=f&&g("Unexpected end of input"),c[m]==='"'?w():c[m]==="{"?x():c[m]==="["?_():c.substring(m,m+4)==="null"||r.Allow.NULL&u&&f-m<4&&"null".startsWith(c.substring(m))?(m+=4,null):c.substring(m,m+4)==="true"||r.Allow.BOOL&u&&f-m<4&&"true".startsWith(c.substring(m))?(m+=4,!0):c.substring(m,m+5)==="false"||r.Allow.BOOL&u&&f-m<5&&"false".startsWith(c.substring(m))?(m+=5,!1):c.substring(m,m+8)==="Infinity"||r.Allow.INFINITY&u&&f-m<8&&"Infinity".startsWith(c.substring(m))?(m+=8,1/0):c.substring(m,m+9)==="-Infinity"||r.Allow._INFINITY&u&&1<f-m&&f-m<9&&"-Infinity".startsWith(c.substring(m))?(m+=9,-1/0):c.substring(m,m+3)==="NaN"||r.Allow.NAN&u&&f-m<3&&"NaN".startsWith(c.substring(m))?(m+=3,NaN):E()),w=()=>{const k=m;let R=!1;for(m++;m<f&&(c[m]!=='"'||R&&c[m-1]==="\\");)R=c[m]==="\\"?!R:!1,m++;if(c.charAt(m)=='"')try{return JSON.parse(c.substring(k,++m-Number(R)))}catch(I){v(String(I))}else if(r.Allow.STR&u)try{return JSON.parse(c.substring(k,m-Number(R))+'"')}catch{return JSON.parse(c.substring(k,c.lastIndexOf("\\"))+'"')}g("Unterminated string literal")},x=()=>{m++,C();const k={};try{for(;c[m]!=="}";){if(C(),m>=f&&r.Allow.OBJ&u)return k;const R=w();C(),m++;try{const I=b();k[R]=I}catch(I){if(r.Allow.OBJ&u)return k;throw I}C(),c[m]===","&&m++}}catch{if(r.Allow.OBJ&u)return k;g("Expected '}' at end of object")}return m++,k},_=()=>{m++;const k=[];try{for(;c[m]!=="]";)k.push(b()),C(),c[m]===","&&m++}catch{if(r.Allow.ARR&u)return k;g("Expected ']' at end of array")}return m++,k},E=()=>{if(m===0){c==="-"&&v("Not sure what '-' is");try{return JSON.parse(c)}catch(R){if(r.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}v(String(R))}}const k=m;for(c[m]==="-"&&m++;c[m]&&",]}".indexOf(c[m])===-1;)m++;m==f&&!(r.Allow.NUM&u)&&g("Unterminated number literal");try{return JSON.parse(c.substring(k,m))}catch{c.substring(k,m)==="-"&&g("Not sure what '-' is");try{return JSON.parse(c.substring(k,c.lastIndexOf("e")))}catch(I){v(String(I))}}},C=()=>{for(;m<f&&` 
\r	`.includes(c[m]);)m++};return b()},l=a;e.parse=l}(Qd)),Qd}var xre=wre();function CE(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new wr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(Hu(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const a of n)switch(a.type){case"text":{s.push(a.text);break}case"tool-call":{i.push({function:{arguments:a.args,name:a.toolName},id:a.toolCallId,type:"function"});break}default:{const o=a;throw new Error(`Unsupported part: ${o}`)}}t.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{t.push(...n.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return t}var _re=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=xre.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[s,i]of r.entries()){const a=(n=JSON.stringify(i==null?void 0:i.parameters))!=null?n:"";if(a==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:ta(),type:"function"});const o=this._toolCalls[s];o.function.arguments=a,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function Sre({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var Ere=D.object({error:D.object({code:D.string().nullable(),message:D.string(),param:D.any().nullable(),type:D.string()})}),UT=$f({errorSchema:Ere,errorToMessage:e=>e.error.message});function Cre({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],s=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const i=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):i.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(s===void 0)return{tools:i,toolWarnings:r};const a=s.type;switch(a){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=a;throw new wr({functionality:`Unsupported tool choice type: ${o}`})}}}function kre(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var Tre=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},Are=e=>async({response:t})=>{const n=am(t);if(t.body===null)throw new TF({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new Tre).pipeThrough(new TransformStream({transform(r,s){s.enqueue(Tf({schema:e,text:r}))}}))}},Rre=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:s,responseFormat:i,seed:a,stopSequences:o,temperature:l,topK:c,topP:u}){const f=n.type,m=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&!this.supportsStructuredOutputs&&m.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const g={format:i==null?void 0:i.type,model:this.modelId,options:kre({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:a,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(f){case"regular":{const{tools:v,toolWarnings:b}=Cre({mode:n});return{args:{...g,messages:CE(s),tools:v},type:f,warnings:[...m,...b]}}case"object-json":return{args:{...g,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:CE(s)},type:f,warnings:m};case"object-tool":return{args:{...g,messages:CE(s),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:f,warnings:m};default:{const v=f;throw new Error(`Unsupported type: ${v}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:s}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:a,value:o}=await Ss({abortSignal:e.abortSignal,body:i,failedResponseHandler:UT,fetch:this.config.fetch,headers:_s(this.config.headers(),e.headers),successfulResponseHandler:da(Nre),url:`${this.config.baseURL}/chat`}),{messages:l,...c}=i,u=(t=o.message.tool_calls)==null?void 0:t.map(f=>{var m;return{args:JSON.stringify(f.function.arguments),toolCallId:(m=f.id)!=null?m:ta(),toolCallType:"function",toolName:f.function.name}});return{finishReason:Sre({finishReason:o.done_reason,hasToolCalls:u!==void 0&&u.length>0}),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},request:{body:JSON.stringify(i)},text:(n=o.message.content)!=null?n:void 0,toolCalls:u,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(e){if(this.settings.simulateStreaming){const g=await this.doGenerate(e),v=new ReadableStream({start(b){if(b.enqueue({type:"response-metadata",...g.response}),g.text&&b.enqueue({textDelta:g.text,type:"text-delta"}),g.toolCalls)for(const w of g.toolCalls)b.enqueue({argsTextDelta:w.args,toolCallId:w.toolCallId,toolCallType:"function",toolName:w.toolName,type:"tool-call-delta"}),b.enqueue({type:"tool-call",...w});b.enqueue({finishReason:g.finishReason,logprobs:g.logprobs,providerMetadata:g.providerMetadata,type:"finish",usage:g.usage}),b.close()}});return{rawCall:g.rawCall,rawResponse:g.rawResponse,stream:v,warnings:g.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:s,value:i}=await Ss({abortSignal:e.abortSignal,body:t,failedResponseHandler:UT,fetch:this.config.fetch,headers:_s(this.config.headers(),e.headers),successfulResponseHandler:Are(Ire),url:`${this.config.baseURL}/chat`}),{messages:a,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,c=new _re({tools:l,type:n});let u="other",f={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:m=!0}=this.settings;return{rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(g){g.enqueue({finishReason:u,type:"finish",usage:f})},async transform(g,v){if(!g.success){v.enqueue({error:g.error,type:"error"});return}const b=g.value;if(b.done){u=c.finish({controller:v}),f={completionTokens:b.eval_count,promptTokens:b.prompt_eval_count||0};return}m&&c.parse({controller:v,delta:b.message.content})||b.message.content!==null&&v.enqueue({textDelta:b.message.content,type:"text-delta"})}})),warnings:r}}},Nre=D.object({created_at:D.string(),done:D.literal(!0),done_reason:D.string().optional().nullable(),eval_count:D.number(),eval_duration:D.number(),load_duration:D.number().optional(),message:D.object({content:D.string(),role:D.string(),tool_calls:D.array(D.object({function:D.object({arguments:D.record(D.any()),name:D.string()}),id:D.string().optional()})).optional().nullable()}),model:D.string(),prompt_eval_count:D.number().optional(),prompt_eval_duration:D.number().optional(),total_duration:D.number()}),Ire=D.discriminatedUnion("done",[D.object({created_at:D.string(),done:D.literal(!1),message:D.object({content:D.string(),role:D.string()}),model:D.string()}),D.object({created_at:D.string(),done:D.literal(!0),eval_count:D.number(),eval_duration:D.number(),load_duration:D.number().optional(),model:D.string(),prompt_eval_count:D.number().optional(),prompt_eval_duration:D.number().optional(),total_duration:D.number()})]),jre=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new z1({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await Ss({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:UT,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:da(Mre),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},Mre=D.object({embeddings:D.array(D.array(D.number())),prompt_eval_count:D.number().nullable()});function s9(e={}){var t;const n=(t=H1(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),s=(o,l={})=>new Rre(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),i=(o,l={})=>new jre(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),a=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(o,l)};return a.chat=s,a.embedding=i,a.languageModel=s,a.textEmbedding=i,a.textEmbeddingModel=i,a}s9();function Hg(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function Ore(e){const t=[];for(const{role:n,content:r,...s}of e){const i=Hg({...s});switch(n){case"system":{t.push({role:"system",content:r,...i});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...Hg(r[0])});break}t.push({role:"user",content:r.map(a=>{var o;const l=Hg(a);switch(a.type){case"text":return{type:"text",text:a.text,...l};case"image":return{type:"image_url",image_url:{url:a.image instanceof URL?a.image.toString():`data:${(o=a.mimeType)!=null?o:"image/jpeg"};base64,${Hu(a.image)}`},...l};case"file":throw new wr({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let a="";const o=[];for(const l of r){const c=Hg(l);switch(l.type){case"text":{a+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}}}t.push({role:"assistant",content:a,tool_calls:o.length>0?o:void 0,...i});break}case"tool":{for(const a of r){const o=Hg(a);t.push({role:"tool",tool_call_id:a.toolCallId,content:JSON.stringify(a.result),...o})}break}default:{const a=n;throw new Error(`Unsupported role: ${a}`)}}}return t}function Mx({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function Ox(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Pre=D.object({error:D.object({message:D.string(),type:D.string().nullish(),param:D.any().nullish(),code:D.union([D.string(),D.number()]).nullish()})}),W1={errorSchema:Pre,errorToMessage:e=>e.error.message};function Dre({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)l.type==="provider-defined"?s.push({type:"unsupported-tool",tool:l}):a.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:{const l=o;throw new wr({functionality:`Unsupported tool choice type: ${l}`})}}}var Fre=class{constructor(e,t,n){this.specificationVersion="v1";var r,s;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:W1;this.chunkSchema=Bre(i.errorSchema),this.failedResponseHandler=$f(i),this.supportsStructuredOutputs=(s=n.supportsStructuredOutputs)!=null?s:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,providerMetadata:l,stopSequences:c,responseFormat:u,seed:f}){var m,g,v,b,w;const x=e.type,_=[];i!=null&&_.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&_.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const E={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs===!0&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,name:(m=u.name)!=null?m:"response",description:u.description}}:{type:"json_object"}:void 0,stop:c,seed:f,...l==null?void 0:l[this.providerOptionsName],reasoning_effort:(b=(g=l==null?void 0:l[this.providerOptionsName])==null?void 0:g.reasoningEffort)!=null?b:(v=l==null?void 0:l["openai-compatible"])==null?void 0:v.reasoningEffort,messages:Ore(t)};switch(x){case"regular":{const{tools:C,tool_choice:k,toolWarnings:R}=Dre({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...E,tools:C,tool_choice:k},warnings:[..._,...R]}}case"object-json":return{args:{...E,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(w=e.name)!=null?w:"response",description:e.description}}:{type:"json_object"}},warnings:_};case"object-tool":return{args:{...E,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:_};default:{const C=x;throw new Error(`Unsupported type: ${C}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c,u,f;const{args:m,warnings:g}=this.getArgs({...e}),v=JSON.stringify(m),{responseHeaders:b,value:w,rawValue:x}=await Ss({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:m,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:da(Lre),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:_,...E}=m,C=w.choices[0],k={[this.providerOptionsName]:{},...(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:x})},R=(r=w.usage)==null?void 0:r.completion_tokens_details,I=(s=w.usage)==null?void 0:s.prompt_tokens_details;return(R==null?void 0:R.reasoning_tokens)!=null&&(k[this.providerOptionsName].reasoningTokens=R==null?void 0:R.reasoning_tokens),(R==null?void 0:R.accepted_prediction_tokens)!=null&&(k[this.providerOptionsName].acceptedPredictionTokens=R==null?void 0:R.accepted_prediction_tokens),(R==null?void 0:R.rejected_prediction_tokens)!=null&&(k[this.providerOptionsName].rejectedPredictionTokens=R==null?void 0:R.rejected_prediction_tokens),(I==null?void 0:I.cached_tokens)!=null&&(k[this.providerOptionsName].cachedPromptTokens=I==null?void 0:I.cached_tokens),{text:(i=C.message.content)!=null?i:void 0,reasoning:(a=C.message.reasoning_content)!=null?a:void 0,toolCalls:(o=C.message.tool_calls)==null?void 0:o.map(j=>{var M;return{toolCallType:"function",toolCallId:(M=j.id)!=null?M:ta(),toolName:j.function.name,args:j.function.arguments}}),finishReason:Ox(C.finish_reason),usage:{promptTokens:(c=(l=w.usage)==null?void 0:l.prompt_tokens)!=null?c:NaN,completionTokens:(f=(u=w.usage)==null?void 0:u.completion_tokens)!=null?f:NaN},providerMetadata:k,rawCall:{rawPrompt:_,rawSettings:E},rawResponse:{headers:b,body:x},response:Mx(w),warnings:g,request:{body:v}}}async doStream(e){var t;if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.reasoning)if(Array.isArray(b.reasoning))for(const _ of b.reasoning)_.type==="text"&&x.enqueue({type:"reasoning",textDelta:_.text});else x.enqueue({type:"reasoning",textDelta:b.reasoning});if(b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const _ of b.toolCalls)x.enqueue({type:"tool-call",..._});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),s={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},i=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:a,value:o}=await Ss({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:s,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:lm(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=n,u=[];let f="unknown",m={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},g=!0,v=this.providerOptionsName;return{stream:o.pipeThrough(new TransformStream({transform(b,w){var x,_,E,C,k,R,I,j,M,L,q,P;if(!b.success){f="error",w.enqueue({type:"error",error:b.error});return}const V=b.value;if(i==null||i.processChunk(b.rawValue),"error"in V){f="error",w.enqueue({type:"error",error:V.error.message});return}if(g&&(g=!1,w.enqueue({type:"response-metadata",...Mx(V)})),V.usage!=null){const{prompt_tokens:K,completion_tokens:ee,prompt_tokens_details:W,completion_tokens_details:se}=V.usage;m.promptTokens=K??void 0,m.completionTokens=ee??void 0,(se==null?void 0:se.reasoning_tokens)!=null&&(m.completionTokensDetails.reasoningTokens=se==null?void 0:se.reasoning_tokens),(se==null?void 0:se.accepted_prediction_tokens)!=null&&(m.completionTokensDetails.acceptedPredictionTokens=se==null?void 0:se.accepted_prediction_tokens),(se==null?void 0:se.rejected_prediction_tokens)!=null&&(m.completionTokensDetails.rejectedPredictionTokens=se==null?void 0:se.rejected_prediction_tokens),(W==null?void 0:W.cached_tokens)!=null&&(m.promptTokensDetails.cachedTokens=W==null?void 0:W.cached_tokens)}const z=V.choices[0];if((z==null?void 0:z.finish_reason)!=null&&(f=Ox(z.finish_reason)),(z==null?void 0:z.delta)==null)return;const re=z.delta;if(re.reasoning_content!=null&&w.enqueue({type:"reasoning",textDelta:re.reasoning_content}),re.content!=null&&w.enqueue({type:"text-delta",textDelta:re.content}),re.tool_calls!=null)for(const K of re.tool_calls){const ee=K.index;if(u[ee]==null){if(K.type!=="function")throw new vp({data:K,message:"Expected 'function' type."});if(K.id==null)throw new vp({data:K,message:"Expected 'id' to be a string."});if(((x=K.function)==null?void 0:x.name)==null)throw new vp({data:K,message:"Expected 'function.name' to be a string."});u[ee]={id:K.id,type:"function",function:{name:K.function.name,arguments:(_=K.function.arguments)!=null?_:""},hasFinished:!1};const se=u[ee];((E=se.function)==null?void 0:E.name)!=null&&((C=se.function)==null?void 0:C.arguments)!=null&&(se.function.arguments.length>0&&w.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:se.id,toolName:se.function.name,argsTextDelta:se.function.arguments}),mx(se.function.arguments)&&(w.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(k=se.id)!=null?k:ta(),toolName:se.function.name,args:se.function.arguments}),se.hasFinished=!0));continue}const W=u[ee];W.hasFinished||(((R=K.function)==null?void 0:R.arguments)!=null&&(W.function.arguments+=(j=(I=K.function)==null?void 0:I.arguments)!=null?j:""),w.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:W.id,toolName:W.function.name,argsTextDelta:(M=K.function.arguments)!=null?M:""}),((L=W.function)==null?void 0:L.name)!=null&&((q=W.function)==null?void 0:q.arguments)!=null&&mx(W.function.arguments)&&(w.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=W.id)!=null?P:ta(),toolName:W.function.name,args:W.function.arguments}),W.hasFinished=!0))}},flush(b){var w,x;const _={[v]:{},...i==null?void 0:i.buildMetadata()};m.completionTokensDetails.reasoningTokens!=null&&(_[v].reasoningTokens=m.completionTokensDetails.reasoningTokens),m.completionTokensDetails.acceptedPredictionTokens!=null&&(_[v].acceptedPredictionTokens=m.completionTokensDetails.acceptedPredictionTokens),m.completionTokensDetails.rejectedPredictionTokens!=null&&(_[v].rejectedPredictionTokens=m.completionTokensDetails.rejectedPredictionTokens),m.promptTokensDetails.cachedTokens!=null&&(_[v].cachedPromptTokens=m.promptTokensDetails.cachedTokens),b.enqueue({type:"finish",finishReason:f,usage:{promptTokens:(w=m.promptTokens)!=null?w:NaN,completionTokens:(x=m.completionTokens)!=null?x:NaN},providerMetadata:_})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(s)}}}},i9=D.object({prompt_tokens:D.number().nullish(),completion_tokens:D.number().nullish(),prompt_tokens_details:D.object({cached_tokens:D.number().nullish()}).nullish(),completion_tokens_details:D.object({reasoning_tokens:D.number().nullish(),accepted_prediction_tokens:D.number().nullish(),rejected_prediction_tokens:D.number().nullish()}).nullish()}).nullish(),Lre=D.object({id:D.string().nullish(),created:D.number().nullish(),model:D.string().nullish(),choices:D.array(D.object({message:D.object({role:D.literal("assistant").nullish(),content:D.string().nullish(),reasoning_content:D.string().nullish(),tool_calls:D.array(D.object({id:D.string().nullish(),type:D.literal("function"),function:D.object({name:D.string(),arguments:D.string()})})).nullish()}),finish_reason:D.string().nullish()})),usage:i9}),Bre=e=>D.union([D.object({id:D.string().nullish(),created:D.number().nullish(),model:D.string().nullish(),choices:D.array(D.object({delta:D.object({role:D.enum(["assistant"]).nullish(),content:D.string().nullish(),reasoning_content:D.string().nullish(),tool_calls:D.array(D.object({index:D.number(),id:D.string().nullish(),type:D.literal("function").nullish(),function:D.object({name:D.string().nullish(),arguments:D.string().nullish()})})).nullish()}).nullish(),finish_reason:D.string().nullish()})),usage:i9}),e]);function $re({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new gc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new wr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new wr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new wr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}var zre=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const s=(r=n.errorStructure)!=null?r:W1;this.chunkSchema=qre(s.errorSchema),this.failedResponseHandler=$f(s)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:f,providerMetadata:m}){var g;const v=e.type,b=[];a!=null&&b.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:w,stopSequences:x}=$re({prompt:n,inputFormat:t}),_=[...x??[],...c??[]],E={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:f,...m==null?void 0:m[this.providerOptionsName],prompt:w,stop:_.length>0?_:void 0};switch(v){case"regular":{if((g=e.tools)!=null&&g.length)throw new wr({functionality:"tools"});if(e.toolChoice)throw new wr({functionality:"toolChoice"});return{args:E,warnings:b}}case"object-json":throw new wr({functionality:"object-json mode"});case"object-tool":throw new wr({functionality:"object-tool mode"});default:{const C=v;throw new Error(`Unsupported type: ${C}`)}}}async doGenerate(e){var t,n,r,s;const{args:i,warnings:a}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:c}=await Ss({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:da(Ure),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...f}=i,m=l.choices[0];return{text:m.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(s=(r=l.usage)==null?void 0:r.completion_tokens)!=null?s:NaN},finishReason:Ox(m.finish_reason),rawCall:{rawPrompt:u,rawSettings:f},rawResponse:{headers:o,body:c},response:Mx(l),warnings:a,request:{body:JSON.stringify(i)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ss({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:_s(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:lm(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u=!0;return{stream:i.pipeThrough(new TransformStream({transform(f,m){if(!f.success){l="error",m.enqueue({type:"error",error:f.error});return}const g=f.value;if("error"in g){l="error",m.enqueue({type:"error",error:g.error});return}u&&(u=!1,m.enqueue({type:"response-metadata",...Mx(g)})),g.usage!=null&&(c={promptTokens:g.usage.prompt_tokens,completionTokens:g.usage.completion_tokens});const v=g.choices[0];(v==null?void 0:v.finish_reason)!=null&&(l=Ox(v.finish_reason)),(v==null?void 0:v.text)!=null&&m.enqueue({type:"text-delta",textDelta:v.text})},flush(f){f.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},Ure=D.object({id:D.string().nullish(),created:D.number().nullish(),model:D.string().nullish(),choices:D.array(D.object({text:D.string(),finish_reason:D.string()})),usage:D.object({prompt_tokens:D.number(),completion_tokens:D.number()}).nullish()}),qre=e=>D.union([D.object({id:D.string().nullish(),created:D.number().nullish(),model:D.string().nullish(),choices:D.array(D.object({text:D.string(),finish_reason:D.string().nullish(),index:D.number()})),usage:D.object({prompt_tokens:D.number(),completion_tokens:D.number()}).nullish()}),e]),Vre=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new z1({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:s,value:i}=await Ss({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:_s(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:$f((r=this.config.errorStructure)!=null?r:W1),successfulResponseHandler:da(Hre),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(a=>a.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:s}}}},Hre=D.object({data:D.array(D.object({embedding:D.array(D.number())})),usage:D.object({prompt_tokens:D.number()}).nullish()}),Gre=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,f,m;const g=[];r!=null&&g.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&g.push({type:"unsupported-setting",setting:"seed"});const v=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:b,responseHeaders:w}=await Ss({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:_s(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(f=i.openai)!=null?f:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:$f((m=this.config.errorStructure)!=null?m:W1),successfulResponseHandler:da(Kre),abortSignal:o,fetch:this.config.fetch});return{images:b.data.map(x=>x.b64_json),warnings:g,response:{timestamp:v,modelId:this.modelId,headers:w}}}},Kre=D.object({data:D.array(D.object({b64_json:D.string()}))});function Wre(e){const t=H1(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),s=f=>({provider:`${n}.${f}`,url:({path:m})=>{const g=new URL(`${t}${m}`);return e.queryParams&&(g.search=new URLSearchParams(e.queryParams).toString()),g.toString()},headers:r,fetch:e.fetch}),i=(f,m={})=>a(f,m),a=(f,m={})=>new Fre(f,m,{...s("chat"),defaultObjectGenerationMode:"tool"}),o=(f,m={})=>new zre(f,m,s("completion")),l=(f,m={})=>new Vre(f,m,s("embedding")),c=(f,m={})=>new Gre(f,m,s("image")),u=(f,m)=>i(f,m);return u.languageModel=i,u.chatModel=a,u.completionModel=o,u.textEmbeddingModel=l,u.imageModel=c,u}const d0=(e,t)=>`${e}:${t}`,jo=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},Pp=e=>e==="openai"||e==="openrouter"||e==="google",Px=e=>e==="ollama"||e==="openai-compatible",xf=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",na=[{value:"openai",label:"OpenAI"},{value:"google",label:"Google Gemini"},{value:"openrouter",label:"OpenRouter"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"}],Zre={openai:[{id:"gpt-4o",name:"GPT-4o"}],google:[{id:"gemini-1.5-flash-latest",name:"Gemini 1.5 Flash"},{id:"gemini-1.5-pro-latest",name:"Gemini 1.5 Pro"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},a9=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function kR(e,t,n){try{switch(e.type){case"openai":return pL({apiKey:n})(t);case"google":return bL({apiKey:n})(t);case"openrouter":return r9({apiKey:n,extraBody:{include_reasoning:!0}})(t);case"ollama":return s9({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return Wre({baseURL:a9(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function o9(e,t,n){const s=gr.getState().getAllAvailableModelDefsForProvider(e.id).find(a=>a.id===t);if(!s){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const i=kR(e,t,n);if(!i){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:d0(e.id,t),name:s.name,providerId:e.id,providerName:e.name,instance:i,metadata:s}}const l9={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]},Gg=new Map,Yre=5*60*1e3,Xre=(e,t)=>{var i,a,o,l,c,u,f,m,g,v,b,w,x,_;const n=e.id||e.name,r=e.name||n,s={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((i=e.architecture)==null?void 0:i.modality)??"text->text",input_modalities:((a=e.architecture)==null?void 0:a.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((c=e.architecture)==null?void 0:c.instruct_type)??null},pricing:{prompt:((u=e.pricing)==null?void 0:u.prompt)??"0",completion:((f=e.pricing)==null?void 0:f.completion)??"0",request:((m=e.pricing)==null?void 0:m.request)??"0",image:((g=e.pricing)==null?void 0:g.image)??"0",web_search:((v=e.pricing)==null?void 0:v.web_search)??"0",internal_reasoning:((b=e.pricing)==null?void 0:b.internal_reasoning)??"0"},top_provider:{context_length:((w=e.top_provider)==null?void 0:w.context_length)??e.context_length??null,max_completion_tokens:((x=e.top_provider)==null?void 0:x.max_completion_tokens)??null,is_moderated:((_=e.top_provider)==null?void 0:_.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??l9[t]??[]};return t==="ollama"?(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(s.context_length=8192),n.includes("gpt-4-32k")&&(s.context_length=32768),n.includes("gpt-4-turbo")&&(s.context_length=128e3),n.includes("gpt-4o")&&(s.context_length=128e3),n.includes("gpt-3.5-turbo")&&(s.context_length=16385),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?s.context_length=1048576:n.includes("gemini")&&(s.context_length=32768),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Google")):t==="openai-compatible"&&(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Compatible")),s};async function Jre(e,t){const n=`${e.id}-${e.baseURL||""}`,r=Gg.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const s=(async()=>{var o,l,c;let i;const a={Accept:"application/json"};t&&(a.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");i="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");i="https://openrouter.ai/api/v1/models",a["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",a["X-Title"]="LiteChat";break;case"ollama":const u=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";i=new URL("/api/tags",u).toString(),delete a.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const f=a9(e.baseURL);i=new URL("models",f.endsWith("/")?f:f+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(u){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,u),Le.error(`Invalid Base URL for ${e.name}: ${u instanceof Error?u.message:String(u)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${i}`);try{const u=await fetch(i,{headers:a});if(!u.ok){let v=`(${u.status} ${u.statusText})`;try{const b=await u.text();v=b||v;try{const w=JSON.parse(b);v=((c=w==null?void 0:w.error)==null?void 0:c.message)||(w==null?void 0:w.message)||v}catch{}}catch(b){console.warn("[ModelFetcher] Failed to read error response body:",b)}throw new Error(`API Error: ${v}`)}const f=await u.json();let m=[];if(e.type==="ollama"?m=f.models||[]:m=f.data||f||[],!Array.isArray(m))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,f),[];const g=m.map(v=>Xre(v,e.type));return g.sort((v,b)=>(v.name||v.id).localeCompare(b.name||b.id)),console.log(`[ModelFetcher] Fetched and mapped ${g.length} models for ${e.name}`),g}catch(u){const f=u instanceof Error?u.message:String(u);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,f),Le.error(`Failed to fetch models for ${e.name}: ${f}`),Gg.delete(n),[]}})();return Gg.set(n,s),setTimeout(()=>{Gg.get(n)===s&&(Gg.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},Yre),s}const Hn={initialDataLoaded:"provider.initial.data.loaded",configsChanged:"provider.configs.changed",apiKeysChanged:"provider.api.keys.changed",selectedModelChanged:"provider.selected.model.changed",globalModelSortOrderChanged:"provider.global.model.sort.order.changed",fetchStatusChanged:"provider.fetch.status.changed",globallyEnabledModelsUpdated:"provider.globally.enabled.models.updated",selectedModelForDetailsChanged:"provider.selected.model.for.details.changed",enableApiKeyManagementChanged:"provider.enable.api.key.management.changed",loadInitialDataRequest:"provider.load.initial.data.request",selectModelRequest:"provider.select.model.request",addApiKeyRequest:"provider.add.api.key.request",deleteApiKeyRequest:"provider.delete.api.key.request",addProviderConfigRequest:"provider.add.config.request",updateProviderConfigRequest:"provider.update.config.request",deleteProviderConfigRequest:"provider.delete.config.request",fetchModelsRequest:"provider.fetch.models.request",setGlobalModelSortOrderRequest:"provider.set.global.model.sort.order.request",setEnableApiKeyManagementRequest:"provider.set.enable.api.key.management.request",setSelectedModelForDetailsRequest:"provider.set.selected.model.for.details.request"},kE="provider:lastModelSelection",c6="provider:globalModelSortOrder",gr=oo(lo((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,globallyEnabledModelDefinitions:[],_updateGloballyEnabledModelDefinitions:()=>{const{dbProviderConfigs:n,globalModelSortOrder:r}=t(),s=t().getAvailableModelListItems(),i=new Map(s.map(u=>[u.id,u])),a=new Set;n.forEach(u=>{u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(f=>{a.add(d0(u.id,f))})});const o=[],l=new Set;r.forEach(u=>{if(a.has(u)){const f=i.get(u);f&&!l.has(u)&&(o.push(f),l.add(u))}});const c=s.filter(u=>a.has(u.id)&&!l.has(u.id)).sort((u,f)=>u.name.localeCompare(f.name));o.push(...c),e({globallyEnabledModelDefinitions:o}),Be.emit(Hn.globallyEnabledModelsUpdated,{models:o})},getGloballyEnabledModelDefinitions:()=>t().globallyEnabledModelDefinitions,createAiModelConfig:(n,r,s)=>{const a=t().getAllAvailableModelDefsForProvider(n.id).find(l=>l.id===r);if(!a){console.warn(`Model definition not found for ${r} in provider ${n.name}`);return}const o=kR(n,r,s);if(!o){console.warn(`Failed to instantiate AI SDK instance for ${r} from provider ${n.name}`);return}return{id:d0(n.id,r),name:a.name,providerId:n.id,providerName:n.name,instance:o,metadata:a}},setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),Rt.saveSetting("enableApiKeyManagement",n),Be.emit(Hn.enableApiKeyManagementChanged,{enabled:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await Rt.loadSetting("enableApiKeyManagement",!0),[r,s,i,a]=await Promise.all([Rt.loadProviderConfigs(),Rt.loadApiKeys(),Rt.loadSetting(c6,[]),Rt.loadSetting(kE,null)]);e({dbProviderConfigs:r,dbApiKeys:s,enableApiKeyManagement:n,globalModelSortOrder:i}),t()._updateGloballyEnabledModelDefinitions();const o=t().globallyEnabledModelDefinitions.map(f=>f.id),l=new Set(o);let c=a;c&&l.has(c)||(c=o[0]??null),e({selectedModelId:c,isLoading:!1}),await Rt.saveSetting(kE,c),Be.emit(Hn.initialDataLoaded,{configs:r,apiKeys:s,selectedModelId:c,globalSortOrder:t().globalModelSortOrder}),t().selectedModelId!==c?t().selectModel(c):Be.emit(Hn.selectedModelChanged,{modelId:c})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),Le.error("Failed to load provider data")}},selectModel:n=>{t().selectedModelId!==n&&(e({selectedModelId:n}),Rt.saveSetting(kE,n),Be.emit(Hn.selectedModelChanged,{modelId:n}))},addApiKey:async(n,r,s)=>{const i=pi(),a=new Date,o={id:i,name:n,value:s,providerId:r,createdAt:a,updatedAt:a};try{return await Rt.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),Le.success(`API Key "${n}" added.`),Be.emit(Hn.apiKeysChanged,{apiKeys:t().dbApiKeys}),i}catch(l){throw console.error("ProviderStore: Error adding API key",l),Le.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var s;const r=((s=t().dbApiKeys.find(i=>i.id===n))==null?void 0:s.name)??"Unknown Key";try{await Rt.deleteApiKey(n),e(i=>{i.dbApiKeys=i.dbApiKeys.filter(a=>a.id!==n),i.dbProviderConfigs=i.dbProviderConfigs.map(a=>a.apiKeyId===n?{...a,apiKeyId:null}:a)}),Le.success(`API Key "${r}" deleted.`),Be.emit(Hn.apiKeysChanged,{apiKeys:t().dbApiKeys}),Be.emit(Hn.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(i){throw console.error("ProviderStore: Error deleting API key",i),Le.error(`Failed to delete API Key: ${i instanceof Error?i.message:String(i)}`),i}},addProviderConfig:async n=>{const r=pi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await Rt.saveProviderConfig(i),e(a=>{a.dbProviderConfigs.push(i)}),t()._updateGloballyEnabledModelDefinitions(),Le.success(`Provider "${n.name}" added.`),Be.emit(Hn.configsChanged,{providerConfigs:t().dbProviderConfigs}),t().fetchModels(r).catch(a=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,a)}),r}catch(a){throw console.error("ProviderStore: Error adding provider config",a),Le.error(`Failed to add Provider: ${a instanceof Error?a.message:String(a)}`),a}},updateProviderConfig:async(n,r)=>{const s=t().dbProviderConfigs.find(a=>a.id===n);if(!s)return;const i={...s,...r,fetchedModels:r.fetchedModels!==void 0?r.fetchedModels:s.fetchedModels,modelsLastFetchedAt:r.modelsLastFetchedAt!==void 0?r.modelsLastFetchedAt:s.modelsLastFetchedAt,updatedAt:new Date};try{await Rt.saveProviderConfig(i),e(a=>{const o=a.dbProviderConfigs.findIndex(l=>l.id===n);o!==-1&&(a.dbProviderConfigs[o]=i)}),t()._updateGloballyEnabledModelDefinitions(),Be.emit(Hn.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(a){throw console.error("ProviderStore: Error updating provider config",a),Le.error(`Failed to update Provider: ${a instanceof Error?a.message:String(a)}`),a}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r)return;const s=r.name;try{await Rt.deleteProviderConfig(n),e(i=>{i.dbProviderConfigs=i.dbProviderConfigs.filter(a=>a.id!==n),delete i.providerFetchStatus[n]}),t()._updateGloballyEnabledModelDefinitions(),Be.emit(Hn.configsChanged,{providerConfigs:t().dbProviderConfigs}),Le.success(`Provider "${s}" deleted.`)}catch(i){throw console.error("ProviderStore: Error deleting provider config",i),Le.error(`Failed to delete Provider: ${i instanceof Error?i.message:String(i)}`),i}},fetchModels:async n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r){Le.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]!=="fetching"){t()._setProviderFetchStatus(n,"fetching");try{const i=r.apiKeyId,a=(s=t().dbApiKeys.find(l=>l.id===i))==null?void 0:s.value,o=await Jre(r,a);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),Le.success(`Models fetched successfully for ${r.name}`)}catch(i){console.error(`Error fetching models for ${r.name}:`,i),t()._setProviderFetchStatus(n,"error")}}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await Rt.saveSetting(c6,r),t()._updateGloballyEnabledModelDefinitions(),Be.emit(Hn.globalModelSortOrderChanged,{ids:r});const s=t().selectedModelId,i=t().globallyEnabledModelDefinitions.map(o=>o.id),a=new Set(i);if(!s||!a.has(s)){const o=i[0]??null;o!==s&&t().selectModel(o)}},_setProviderFetchStatus:(n,r)=>{e(s=>{s.providerFetchStatus[n]=r}),Be.emit(Hn.fetchStatusChanged,{providerId:n,status:r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n}),Be.emit(Hn.selectedModelForDetailsChanged,{modelId:n})},getSelectedModel:()=>{const{selectedModelId:n}=t();if(!n)return;const{providerId:r,modelId:s}=jo(n);if(!r||!s)return;const i=t().dbProviderConfigs.find(o=>o.id===r);if(!i)return;const a=t().dbApiKeys.find(o=>o.id===i.apiKeyId);return t().createAiModelConfig(i,s,a==null?void 0:a.value)},getApiKeyForProvider:n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);return(s=t().dbApiKeys.find(i=>i.id===(r==null?void 0:r.apiKeyId)))==null?void 0:s.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(a=>a.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const s=r.type;return(Zre[s]||[]).map(a=>({id:a.id,name:a.name,context_length:4096,architecture:{modality:"text->text",input_modalities:["text"],output_modalities:["text"]},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:l9[r.type]??[]}))},getAvailableModelListItems:()=>{const{dbProviderConfigs:n}=t(),r=[];return n.forEach(s=>{t().getAllAvailableModelDefsForProvider(s.id).forEach(a=>{var o,l;r.push({id:d0(s.id,a.id),name:a.name,providerId:s.id,providerName:s.name,metadataSummary:{context_length:((o=a.top_provider)==null?void 0:o.context_length)??a.context_length,supported_parameters:a.supported_parameters,input_modalities:(l=a.architecture)==null?void 0:l.input_modalities,pricing:a.pricing,description:a.description}})})}),r},getRegisteredActionHandlers:()=>{const n="providerStore",r=t();return[{eventName:Hn.loadInitialDataRequest,handler:r.loadInitialData,storeId:n},{eventName:Hn.selectModelRequest,handler:s=>r.selectModel(s.modelId),storeId:n},{eventName:Hn.addApiKeyRequest,handler:s=>r.addApiKey(s.name,s.providerId,s.value).then(()=>{}),storeId:n},{eventName:Hn.deleteApiKeyRequest,handler:s=>r.deleteApiKey(s.id),storeId:n},{eventName:Hn.addProviderConfigRequest,handler:s=>r.addProviderConfig(s).then(()=>{}),storeId:n},{eventName:Hn.updateProviderConfigRequest,handler:s=>r.updateProviderConfig(s.id,s.changes),storeId:n},{eventName:Hn.deleteProviderConfigRequest,handler:s=>r.deleteProviderConfig(s.id),storeId:n},{eventName:Hn.fetchModelsRequest,handler:s=>r.fetchModels(s.providerConfigId),storeId:n},{eventName:Hn.setGlobalModelSortOrderRequest,handler:s=>r.setGlobalModelSortOrder(s.ids),storeId:n},{eventName:Hn.setEnableApiKeyManagementRequest,handler:s=>r.setEnableApiKeyManagement(s.enabled),storeId:n},{eventName:Hn.setSelectedModelForDetailsRequest,handler:s=>r.setSelectedModelForDetails(s.modelId),storeId:n}]}}))),Qt={loaded:"settings.loaded",themeChanged:"settings.theme.changed",globalSystemPromptChanged:"settings.global.system.prompt.changed",temperatureChanged:"settings.temperature.changed",maxTokensChanged:"settings.max.tokens.changed",topPChanged:"settings.top.p.changed",topKChanged:"settings.top.k.changed",presencePenaltyChanged:"settings.presence.penalty.changed",frequencyPenaltyChanged:"settings.frequency.penalty.changed",enableAdvancedSettingsChanged:"settings.enable.advanced.settings.changed",enableStreamingMarkdownChanged:"settings.enable.streaming.markdown.changed",enableStreamingCodeBlockParsingChanged:"settings.enable.streaming.code.block.parsing.changed",foldStreamingCodeBlocksChanged:"settings.fold.streaming.code.blocks.changed",foldUserMessagesOnCompletionChanged:"settings.fold.user.messages.on.completion.changed",streamingRenderFpsChanged:"settings.streaming.render.fps.changed",gitUserNameChanged:"settings.git.user.name.changed",gitUserEmailChanged:"settings.git.user.email.changed",toolMaxStepsChanged:"settings.tool.max.steps.changed",prismThemeUrlChanged:"settings.prism.theme.url.changed",autoTitleEnabledChanged:"settings.auto.title.enabled.changed",autoTitleModelIdChanged:"settings.auto.title.model.id.changed",autoTitlePromptMaxLengthChanged:"settings.auto.title.prompt.max.length.changed",autoTitleIncludeFilesChanged:"settings.auto.title.include.files.changed",autoTitleIncludeRulesChanged:"settings.auto.title.include.rules.changed",customFontFamilyChanged:"settings.custom.font.family.changed",customFontSizeChanged:"settings.custom.font.size.changed",chatMaxWidthChanged:"settings.chat.max.width.changed",customThemeColorsChanged:"settings.custom.theme.colors.changed",autoScrollIntervalChanged:"settings.auto.scroll.interval.changed",enableAutoScrollOnStreamChanged:"settings.enable.auto.scroll.on.stream.changed",setThemeRequest:"settings.set.theme.request",setGlobalSystemPromptRequest:"settings.set.global.system.prompt.request",setTemperatureRequest:"settings.set.temperature.request",setMaxTokensRequest:"settings.set.max.tokens.request",setTopPRequest:"settings.set.top.p.request",setTopKRequest:"settings.set.top.k.request",setPresencePenaltyRequest:"settings.set.presence.penalty.request",setFrequencyPenaltyRequest:"settings.set.frequency.penalty.request",setEnableAdvancedSettingsRequest:"settings.set.enable.advanced.settings.request",setEnableStreamingMarkdownRequest:"settings.set.enable.streaming.markdown.request",setEnableStreamingCodeBlockParsingRequest:"settings.set.enable.streaming.code.block.parsing.request",setFoldStreamingCodeBlocksRequest:"settings.set.fold.streaming.code.blocks.request",setFoldUserMessagesOnCompletionRequest:"settings.set.fold.user.messages.on.completion.request",setStreamingRenderFpsRequest:"settings.set.streaming.render.fps.request",setGitUserNameRequest:"settings.set.git.user.name.request",setGitUserEmailRequest:"settings.set.git.user.email.request",setToolMaxStepsRequest:"settings.set.tool.max.steps.request",setPrismThemeUrlRequest:"settings.set.prism.theme.url.request",setAutoTitleEnabledRequest:"settings.set.auto.title.enabled.request",setAutoTitleModelIdRequest:"settings.set.auto.title.model.id.request",setAutoTitlePromptMaxLengthRequest:"settings.set.auto.title.prompt.max.length.request",setAutoTitleIncludeFilesRequest:"settings.set.auto.title.include.files.request",setAutoTitleIncludeRulesRequest:"settings.set.auto.title.include.rules.request",setCustomFontFamilyRequest:"settings.set.custom.font.family.request",setCustomFontSizeRequest:"settings.set.custom.font.size.request",setChatMaxWidthRequest:"settings.set.chat.max.width.request",setCustomThemeColorsRequest:"settings.set.custom.theme.colors.request",setCustomThemeColorRequest:"settings.set.custom.theme.color.request",setAutoScrollIntervalRequest:"settings.set.auto.scroll.interval.request",setEnableAutoScrollOnStreamRequest:"settings.set.enable.auto.scroll.on.stream.request",loadSettingsRequest:"settings.load.settings.request",resetGeneralSettingsRequest:"settings.reset.general.settings.request",resetAssistantSettingsRequest:"settings.reset.assistant.settings.request",resetThemeSettingsRequest:"settings.reset.theme.settings.request"},TE="system",AE="You are a helpful AI assistant.",RE=.7,NE=null,IE=null,jE=null,ME=0,OE=0,u6=!0,PE=!0,DE=!1,FE=!1,LE=!1,BE=15,d6=null,f6=null,$E=5,zE=null,UE=!0,qE=null,VE=768,HE=!1,GE=!1,KE=null,WE=16,ZE="max-w-7xl",YE=null,XE=1e3,JE=!0,ir=oo(lo((e,t)=>({theme:TE,globalSystemPrompt:AE,temperature:RE,maxTokens:NE,topP:IE,topK:jE,presencePenalty:ME,frequencyPenalty:OE,enableAdvancedSettings:u6,enableStreamingMarkdown:PE,enableStreamingCodeBlockParsing:DE,foldStreamingCodeBlocks:FE,foldUserMessagesOnCompletion:LE,streamingRenderFPS:BE,gitUserName:d6,gitUserEmail:f6,toolMaxSteps:$E,prismThemeUrl:zE,autoTitleEnabled:UE,autoTitleModelId:qE,autoTitlePromptMaxLength:VE,autoTitleIncludeFiles:HE,autoTitleIncludeRules:GE,customFontFamily:KE,customFontSize:WE,chatMaxWidth:ZE,customThemeColors:YE,autoScrollInterval:XE,enableAutoScrollOnStream:JE,setTheme:n=>{e({theme:n}),Rt.saveSetting("theme",n),Be.emit(Qt.themeChanged,{theme:n})},setGlobalSystemPrompt:n=>{e({globalSystemPrompt:n}),Rt.saveSetting("globalSystemPrompt",n),Be.emit(Qt.globalSystemPromptChanged,{prompt:n})},setTemperature:n=>{e({temperature:n}),Rt.saveSetting("temperature",n),Be.emit(Qt.temperatureChanged,{value:n})},setMaxTokens:n=>{e({maxTokens:n}),Rt.saveSetting("maxTokens",n),Be.emit(Qt.maxTokensChanged,{value:n})},setTopP:n=>{e({topP:n}),Rt.saveSetting("topP",n),Be.emit(Qt.topPChanged,{value:n})},setTopK:n=>{e({topK:n}),Rt.saveSetting("topK",n),Be.emit(Qt.topKChanged,{value:n})},setPresencePenalty:n=>{e({presencePenalty:n}),Rt.saveSetting("presencePenalty",n),Be.emit(Qt.presencePenaltyChanged,{value:n})},setFrequencyPenalty:n=>{e({frequencyPenalty:n}),Rt.saveSetting("frequencyPenalty",n),Be.emit(Qt.frequencyPenaltyChanged,{value:n})},setEnableAdvancedSettings:n=>{e({enableAdvancedSettings:n}),Rt.saveSetting("enableAdvancedSettings",n),Be.emit(Qt.enableAdvancedSettingsChanged,{enabled:n})},setEnableStreamingMarkdown:n=>{e({enableStreamingMarkdown:n}),Rt.saveSetting("enableStreamingMarkdown",n),Be.emit(Qt.enableStreamingMarkdownChanged,{enabled:n})},setEnableStreamingCodeBlockParsing:n=>{e({enableStreamingCodeBlockParsing:n}),Rt.saveSetting("enableStreamingCodeBlockParsing",n),Be.emit(Qt.enableStreamingCodeBlockParsingChanged,{enabled:n})},setFoldStreamingCodeBlocks:n=>{e({foldStreamingCodeBlocks:n}),Rt.saveSetting("foldStreamingCodeBlocks",n),Be.emit(Qt.foldStreamingCodeBlocksChanged,{fold:n})},setFoldUserMessagesOnCompletion:n=>{e({foldUserMessagesOnCompletion:n}),Rt.saveSetting("foldUserMessagesOnCompletion",n),Be.emit(Qt.foldUserMessagesOnCompletionChanged,{fold:n})},setStreamingRenderFPS:n=>{const r=Math.max(3,Math.min(60,n));e({streamingRenderFPS:r}),Rt.saveSetting("streamingRenderFPS",r),Be.emit(Qt.streamingRenderFpsChanged,{fps:r})},setGitUserName:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserName:r}),Rt.saveSetting("gitUserName",r),Be.emit(Qt.gitUserNameChanged,{name:r})},setGitUserEmail:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserEmail:r}),Rt.saveSetting("gitUserEmail",r),Be.emit(Qt.gitUserEmailChanged,{email:r})},setToolMaxSteps:n=>{const r=Math.max(1,Math.min(20,n));e({toolMaxSteps:r}),Rt.saveSetting("toolMaxSteps",r),Be.emit(Qt.toolMaxStepsChanged,{steps:r})},setPrismThemeUrl:n=>{const r=(n==null?void 0:n.trim())||null;e({prismThemeUrl:r}),Rt.saveSetting("prismThemeUrl",r),Be.emit(Qt.prismThemeUrlChanged,{url:r})},setAutoTitleEnabled:n=>{e({autoTitleEnabled:n}),Rt.saveSetting("autoTitleEnabled",n),Be.emit(Qt.autoTitleEnabledChanged,{enabled:n})},setAutoTitleModelId:n=>{e({autoTitleModelId:n}),Rt.saveSetting("autoTitleModelId",n),Be.emit(Qt.autoTitleModelIdChanged,{modelId:n})},setAutoTitlePromptMaxLength:n=>{const r=Math.max(100,Math.min(4e3,n));e({autoTitlePromptMaxLength:r}),Rt.saveSetting("autoTitlePromptMaxLength",r),Be.emit(Qt.autoTitlePromptMaxLengthChanged,{length:r})},setAutoTitleIncludeFiles:n=>{e({autoTitleIncludeFiles:n}),Rt.saveSetting("autoTitleIncludeFiles",n),Be.emit(Qt.autoTitleIncludeFilesChanged,{include:n})},setAutoTitleIncludeRules:n=>{e({autoTitleIncludeRules:n}),Rt.saveSetting("autoTitleIncludeRules",n),Be.emit(Qt.autoTitleIncludeRulesChanged,{include:n})},setCustomFontFamily:n=>{const r=(n==null?void 0:n.trim())||null;e({customFontFamily:r}),Rt.saveSetting("customFontFamily",r),Be.emit(Qt.customFontFamilyChanged,{fontFamily:r})},setCustomFontSize:n=>{const r=n===null?null:Math.max(10,Math.min(24,n));e({customFontSize:r}),Rt.saveSetting("customFontSize",r),Be.emit(Qt.customFontSizeChanged,{fontSize:r})},setChatMaxWidth:n=>{e({chatMaxWidth:n}),Rt.saveSetting("chatMaxWidth",n),Be.emit(Qt.chatMaxWidthChanged,{maxWidth:n})},setCustomThemeColors:n=>{e({customThemeColors:n}),Rt.saveSetting("customThemeColors",n),Be.emit(Qt.customThemeColorsChanged,{colors:n})},setCustomThemeColor:(n,r)=>{e(i=>{const o={...i.customThemeColors??{}};r===null||r.trim()===""?delete o[n]:o[n]=r.trim(),i.customThemeColors=Object.keys(o).length>0?o:null});const s=t().customThemeColors;Rt.saveSetting("customThemeColors",s),Be.emit(Qt.customThemeColorsChanged,{colors:s})},setAutoScrollInterval:n=>{const r=Math.max(50,n);e({autoScrollInterval:r}),Rt.saveSetting("autoScrollInterval",r),Be.emit(Qt.autoScrollIntervalChanged,{interval:r})},setEnableAutoScrollOnStream:n=>{e({enableAutoScrollOnStream:n}),Rt.saveSetting("enableAutoScrollOnStream",n),Be.emit(Qt.enableAutoScrollOnStreamChanged,{enabled:n})},loadSettings:async()=>{try{const[n,r,s,i,a,o,l,c,u,f,m,g,v,b,w,x,_,E,C,k,R,I,j,M,L,q,P,V,z]=await Promise.all([Rt.loadSetting("theme",TE),Rt.loadSetting("temperature",RE),Rt.loadSetting("maxTokens",NE),Rt.loadSetting("topP",IE),Rt.loadSetting("topK",jE),Rt.loadSetting("presencePenalty",ME),Rt.loadSetting("frequencyPenalty",OE),Rt.loadSetting("globalSystemPrompt",AE),Rt.loadSetting("enableAdvancedSettings",u6),Rt.loadSetting("enableStreamingMarkdown",PE),Rt.loadSetting("enableStreamingCodeBlockParsing",DE),Rt.loadSetting("foldStreamingCodeBlocks",FE),Rt.loadSetting("foldUserMessagesOnCompletion",LE),Rt.loadSetting("streamingRenderFPS",BE),Rt.loadSetting("gitUserName",d6),Rt.loadSetting("gitUserEmail",f6),Rt.loadSetting("toolMaxSteps",$E),Rt.loadSetting("prismThemeUrl",zE),Rt.loadSetting("autoTitleEnabled",UE),Rt.loadSetting("autoTitleModelId",qE),Rt.loadSetting("autoTitlePromptMaxLength",VE),Rt.loadSetting("autoTitleIncludeFiles",HE),Rt.loadSetting("autoTitleIncludeRules",GE),Rt.loadSetting("customFontFamily",KE),Rt.loadSetting("customFontSize",WE),Rt.loadSetting("chatMaxWidth",ZE),Rt.loadSetting("customThemeColors",YE),Rt.loadSetting("autoScrollInterval",XE),Rt.loadSetting("enableAutoScrollOnStream",JE)]),re={theme:n,temperature:r,maxTokens:s,topP:i,topK:a,presencePenalty:o,frequencyPenalty:l,globalSystemPrompt:c,enableAdvancedSettings:u,enableStreamingMarkdown:f,enableStreamingCodeBlockParsing:m,foldStreamingCodeBlocks:g,foldUserMessagesOnCompletion:v,streamingRenderFPS:b,gitUserName:w,gitUserEmail:x,toolMaxSteps:_,prismThemeUrl:E,autoTitleEnabled:C,autoTitleModelId:k,autoTitlePromptMaxLength:R,autoTitleIncludeFiles:I,autoTitleIncludeRules:j,customFontFamily:M,customFontSize:L,chatMaxWidth:q,customThemeColors:P,autoScrollInterval:V,enableAutoScrollOnStream:z};e(re),Be.emit(Qt.loaded,{settings:re})}catch(n){console.error("SettingsStore: Error loading settings",n),Be.emit(Qt.loaded,{settings:t()})}},resetGeneralSettings:async()=>{try{t().setEnableStreamingMarkdown(PE),t().setEnableStreamingCodeBlockParsing(DE),t().setFoldStreamingCodeBlocks(FE),t().setFoldUserMessagesOnCompletion(LE),t().setStreamingRenderFPS(BE),t().setAutoScrollInterval(XE),t().setEnableAutoScrollOnStream(JE),Le.success("Streaming & Display settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting general settings",n),Le.error("Failed to reset general settings.")}},resetAssistantSettings:async()=>{try{t().setGlobalSystemPrompt(AE),t().setTemperature(RE),t().setMaxTokens(NE),t().setTopP(IE),t().setTopK(jE),t().setPresencePenalty(ME),t().setFrequencyPenalty(OE),t().setToolMaxSteps($E),t().setAutoTitleEnabled(UE),t().setAutoTitleModelId(qE),t().setAutoTitlePromptMaxLength(VE),t().setAutoTitleIncludeFiles(HE),t().setAutoTitleIncludeRules(GE),Le.success("Assistant settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting assistant settings",n),Le.error("Failed to reset assistant settings.")}},resetThemeSettings:async()=>{try{t().setTheme(TE),t().setPrismThemeUrl(zE),t().setCustomFontFamily(KE),t().setCustomFontSize(WE),t().setChatMaxWidth(ZE),t().setCustomThemeColors(YE),Le.success("Theme settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting theme settings",n),Le.error("Failed to reset theme settings.")}},getRegisteredActionHandlers:()=>{const n="settingsStore",r=t();return[{eventName:Qt.setThemeRequest,handler:s=>r.setTheme(s.theme),storeId:n},{eventName:Qt.setGlobalSystemPromptRequest,handler:s=>r.setGlobalSystemPrompt(s.prompt),storeId:n},{eventName:Qt.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:Qt.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:Qt.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:Qt.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:Qt.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:Qt.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:Qt.setEnableAdvancedSettingsRequest,handler:s=>r.setEnableAdvancedSettings(s.enabled),storeId:n},{eventName:Qt.setEnableStreamingMarkdownRequest,handler:s=>r.setEnableStreamingMarkdown(s.enabled),storeId:n},{eventName:Qt.setEnableStreamingCodeBlockParsingRequest,handler:s=>r.setEnableStreamingCodeBlockParsing(s.enabled),storeId:n},{eventName:Qt.setFoldStreamingCodeBlocksRequest,handler:s=>r.setFoldStreamingCodeBlocks(s.fold),storeId:n},{eventName:Qt.setFoldUserMessagesOnCompletionRequest,handler:s=>r.setFoldUserMessagesOnCompletion(s.fold),storeId:n},{eventName:Qt.setStreamingRenderFpsRequest,handler:s=>r.setStreamingRenderFPS(s.fps),storeId:n},{eventName:Qt.setGitUserNameRequest,handler:s=>r.setGitUserName(s.name),storeId:n},{eventName:Qt.setGitUserEmailRequest,handler:s=>r.setGitUserEmail(s.email),storeId:n},{eventName:Qt.setToolMaxStepsRequest,handler:s=>r.setToolMaxSteps(s.steps),storeId:n},{eventName:Qt.setPrismThemeUrlRequest,handler:s=>r.setPrismThemeUrl(s.url),storeId:n},{eventName:Qt.setAutoTitleEnabledRequest,handler:s=>r.setAutoTitleEnabled(s.enabled),storeId:n},{eventName:Qt.setAutoTitleModelIdRequest,handler:s=>r.setAutoTitleModelId(s.modelId),storeId:n},{eventName:Qt.setAutoTitlePromptMaxLengthRequest,handler:s=>r.setAutoTitlePromptMaxLength(s.length),storeId:n},{eventName:Qt.setAutoTitleIncludeFilesRequest,handler:s=>r.setAutoTitleIncludeFiles(s.include),storeId:n},{eventName:Qt.setAutoTitleIncludeRulesRequest,handler:s=>r.setAutoTitleIncludeRules(s.include),storeId:n},{eventName:Qt.setCustomFontFamilyRequest,handler:s=>r.setCustomFontFamily(s.fontFamily),storeId:n},{eventName:Qt.setCustomFontSizeRequest,handler:s=>r.setCustomFontSize(s.fontSize),storeId:n},{eventName:Qt.setChatMaxWidthRequest,handler:s=>r.setChatMaxWidth(s.maxWidth),storeId:n},{eventName:Qt.setCustomThemeColorsRequest,handler:s=>r.setCustomThemeColors(s.colors),storeId:n},{eventName:Qt.setCustomThemeColorRequest,handler:s=>r.setCustomThemeColor(s.colorKey,s.value),storeId:n},{eventName:Qt.setAutoScrollIntervalRequest,handler:s=>r.setAutoScrollInterval(s.interval),storeId:n},{eventName:Qt.setEnableAutoScrollOnStreamRequest,handler:s=>r.setEnableAutoScrollOnStream(s.enabled),storeId:n},{eventName:Qt.loadSettingsRequest,handler:()=>r.loadSettings(),storeId:n},{eventName:Qt.resetGeneralSettingsRequest,handler:()=>r.resetGeneralSettings(),storeId:n},{eventName:Qt.resetAssistantSettingsRequest,handler:()=>r.resetAssistantSettings(),storeId:n},{eventName:Qt.resetThemeSettingsRequest,handler:()=>r.resetThemeSettings(),storeId:n}]}})));async function Dx(e,t){const n=co.getState().getMiddlewareForHook,r=n(e);let s=t;for(const i of r)try{const a=await i.callback(s);if(a===!1)return console.log(`Middleware ${i.modId} cancelled action for hook ${e}`),!1;a&&typeof a=="object"&&(s=a)}catch(a){return console.error(`Middleware error in mod ${i.modId} for hook ${e}:`,a),!1}return s}function Qre(){const e=Bn.getState(),t=gr.getState(),n=ir.getState(),{providerId:r}=jo(t.selectedModelId),s={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme,gitUserName:n.gitUserName,gitUserEmail:n.gitUserEmail};return Object.freeze(s)}function ese(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function h6(e){try{const t=e.type||"application/octet-stream",n=I0(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:ese(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),Le.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function p6(e){return e.flatMap(t=>{var s,i,a;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(s=r.metadata)!=null&&s.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(i=t.metadata)!=null&&i.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-call"&&c.toolCallId&&c.toolName&&c.args!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,c)}}),o.length>0&&n.push({role:"assistant",content:o})}if((a=t.metadata)!=null&&a.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-result"&&c.toolCallId&&c.toolName&&c.result!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,c)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const m6=e=>Symbol.iterator in e,g6=e=>"entries"in e,y6=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[s,i]of n)if(!Object.is(i,r.get(s)))return!1;return!0},tse=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let s=n.next(),i=r.next();for(;!s.done&&!i.done;){if(!Object.is(s.value,i.value))return!1;s=n.next(),i=r.next()}return!!s.done&&!!i.done};function nse(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!m6(e)||!m6(t)?y6({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):g6(e)&&g6(t)?y6(e,t):tse(e,t)}function mn(e){const t=dt.useRef(void 0);return n=>{const r=e(n);return nse(t.current,r)?t.current:t.current=r}}var H0=(e=>(e.PROMPT_TURN_FINALIZE="middleware.prompt.turnFinalize",e.INTERACTION_BEFORE_START="middleware.interaction.beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware.interaction.processChunk",e))(H0||{});const Tn={initialized:"prompt.state.initialized",parameterChanged:"prompt.state.parameter.changed",transientParametersReset:"prompt.state.transient.parameters.reset",inputTextStateChanged:"prompt.state.input.text.changed",submitted:"prompt.state.submitted",setModelIdRequest:"prompt.state.set.model.id.request",setTemperatureRequest:"prompt.state.set.temperature.request",setMaxTokensRequest:"prompt.state.set.max.tokens.request",setTopPRequest:"prompt.state.set.top.p.request",setTopKRequest:"prompt.state.set.top.k.request",setPresencePenaltyRequest:"prompt.state.set.presence.penalty.request",setFrequencyPenaltyRequest:"prompt.state.set.frequency.penalty.request",setReasoningEnabledRequest:"prompt.state.set.reasoning.enabled.request",setWebSearchEnabledRequest:"prompt.state.set.web.search.enabled.request",setStructuredOutputJsonRequest:"prompt.state.set.structured.output.json.request",initializePromptStateRequest:"prompt.state.initialize.prompt.state.request",resetTransientParametersRequest:"prompt.state.reset.transient.parameters.request",inputChanged:"prompt.inputChanged"},fl=(e,t)=>{Be.emit(Tn.parameterChanged,{params:{[e]:t}})},Ml=oo(lo((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),fl("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),fl("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),fl("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),fl("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),fl("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),fl("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),fl("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),fl("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),fl("webSearchEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),fl("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),s={};let i=!1;r.modelId!==n.modelId&&(s.modelId=n.modelId,i=!0),r.temperature!==n.temperature&&(s.temperature=n.temperature,i=!0),r.maxTokens!==n.maxTokens&&(s.maxTokens=n.maxTokens,i=!0),r.topP!==n.topP&&(s.topP=n.topP,i=!0),r.topK!==n.topK&&(s.topK=n.topK,i=!0),r.presencePenalty!==n.presencePenalty&&(s.presencePenalty=n.presencePenalty,i=!0),r.frequencyPenalty!==n.frequencyPenalty&&(s.frequencyPenalty=n.frequencyPenalty,i=!0),i&&(e(s),Be.emit(Tn.parameterChanged,{params:s})),Be.emit(Tn.initialized,{state:{...t()}})},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let s=!1;n.temperature!==null&&(r.temperature=null,s=!0),n.maxTokens!==null&&(r.maxTokens=null,s=!0),n.topP!==null&&(r.topP=null,s=!0),n.topK!==null&&(r.topK=null,s=!0),n.presencePenalty!==null&&(r.presencePenalty=null,s=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,s=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,s=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,s=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,s=!0),s&&(e(r),Be.emit(Tn.parameterChanged,{params:r})),Be.emit(Tn.transientParametersReset,void 0)},getRegisteredActionHandlers:()=>{const n="promptStateStore",r=t();return[{eventName:Tn.setModelIdRequest,handler:s=>r.setModelId(s.id),storeId:n},{eventName:Tn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:Tn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:Tn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:Tn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:Tn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:Tn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:Tn.setReasoningEnabledRequest,handler:s=>r.setReasoningEnabled(s.enabled),storeId:n},{eventName:Tn.setWebSearchEnabledRequest,handler:s=>r.setWebSearchEnabled(s.enabled),storeId:n},{eventName:Tn.setStructuredOutputJsonRequest,handler:s=>r.setStructuredOutputJson(s.json),storeId:n},{eventName:Tn.initializePromptStateRequest,handler:s=>r.initializePromptState(s.effectiveSettings),storeId:n},{eventName:Tn.resetTransientParametersRequest,handler:()=>r.resetTransientParameters(),storeId:n}]}}))),rse=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message...",inputAreaRef:s,selectedItemId:i,selectedItemType:a})=>{const[o,l]=T.useState(!1),[c,u]=T.useState(!1),f=co(mn(k=>k.promptControls)),m=Bn(mn(k=>k.status==="streaming")),{attachedFilesMetadata:g,clearAttachedFiles:v}=Vu(mn(k=>({attachedFilesMetadata:k.attachedFilesMetadata,clearAttachedFiles:k.clearAttachedFiles}))),b=Ml(k=>k.modelId);T.useEffect(()=>{a==="conversation"&&i&&requestAnimationFrame(()=>{var k;(k=s.current)==null||k.focus()})},[i,a,s]);const w=T.useMemo(()=>Object.values(f),[f]),x=T.useMemo(()=>w.filter(k=>k.renderer),[w]),_=T.useMemo(()=>w.filter(k=>k.triggerRenderer),[w]),E=T.useCallback(async()=>{var j,M;const R=(((j=s==null?void 0:s.current)==null?void 0:j.getValue())??"").trim(),I=Vu.getState().attachedFilesMetadata;if(!(!R&&I.length===0)&&!(m||o)){l(!0);try{let L={},q={};for(const K of w){if(K.getParameters){const ee=await K.getParameters();ee&&(L={...L,...ee})}if(K.getMetadata){const ee=await K.getMetadata();ee&&(q={...q,...ee})}}I.length>0&&(q.attachedFiles=[...I]),!q.modelId&&b&&(q.modelId=b);const P=w.find(K=>K.id==="core-rules-tags");if(P&&q.activeRuleIds&&q.activeTagIds){const K=[],ee=new Set(q.activeRuleIds);q.activeTagIds.forEach(W=>{P.getRulesForTag(W).forEach(se=>ee.add(se.id))}),ee.forEach(W=>{const se=P.getRuleById(W);se&&K.push({type:se.type,content:se.content,sourceRuleId:se.id})}),q.effectiveRulesContent=K}let V={id:pi(),content:R,parameters:L,metadata:q};Be.emit(Tn.submitted,{turnData:V});const z=await Dx(H0.PROMPT_TURN_FINALIZE,{turnData:V});if(z===!1){console.log("Prompt submission cancelled by middleware."),l(!1);return}const re=z&&typeof z=="object"?z.turnData:V;await t(re),v(),w.forEach(K=>{K.clearOnSubmit&&K.clearOnSubmit()}),(M=s.current)==null||M.clearValue(),u(!1)}catch(L){console.error("Error during prompt submission:",L),Le.error(`Failed to send message: ${L instanceof Error?L.message:String(L)}`)}finally{l(!1)}}},[s,m,o,w,t,v,b]),C=T.useCallback(k=>{u(k.trim().length>0)},[]);return p.jsxs("div",{className:ct("p-2 md:p-4 space-y-2 md:space-y-3",n),children:[x.length>0&&p.jsx(R4,{controls:x,area:"panel",className:"flex flex-wrap gap-1 md:gap-2 items-start mb-1 md:mb-2"}),p.jsxs("div",{className:"flex items-end gap-2",children:[p.jsx(e,{ref:s,onSubmit:E,disabled:m||o,placeholder:r,onValueChange:C,className:"flex-grow"}),p.jsx(Ct,{type:"button",size:"icon",onClick:E,disabled:m||o||!c&&g.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:o?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(QX,{className:"h-4 w-4"})})]})," ",p.jsx(R4,{controls:_,area:"trigger",className:"flex items-center gap-1 flex-wrap flex-shrink-0 mt-1 md:mt-2"})]})};function Ut(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function sse(e,t){const n=T.createContext(t),r=i=>{const{children:a,...o}=i,l=T.useMemo(()=>o,Object.values(o));return p.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function s(i){const a=T.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Ii(e,t=[]){let n=[];function r(i,a){const o=T.createContext(a),l=n.length;n=[...n,a];const c=f=>{var x;const{scope:m,children:g,...v}=f,b=((x=m==null?void 0:m[e])==null?void 0:x[l])||o,w=T.useMemo(()=>v,Object.values(v));return p.jsx(b.Provider,{value:w,children:g})};c.displayName=i+"Provider";function u(f,m){var b;const g=((b=m==null?void 0:m[e])==null?void 0:b[l])||o,v=T.useContext(g);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(a=>T.createContext(a));return function(o){const l=(o==null?void 0:o[e])||i;return T.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return s.scopeName=e,[r,ise(s,...t)]}function ise(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const f=l(i)[`__scope${c}`];return{...o,...f}},{});return T.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}var ase=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],sn=ase.reduce((e,t)=>{const n=zu(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function c9(e,t){e&&ko.flushSync(()=>e.dispatchEvent(t))}function Xs(e){const t=T.useRef(e);return T.useEffect(()=>{t.current=e}),T.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function ose(e,t=globalThis==null?void 0:globalThis.document){const n=Xs(e);T.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var lse="DismissableLayer",qT="dismissableLayer.update",cse="dismissableLayer.pointerDownOutside",use="dismissableLayer.focusOutside",b6,u9=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),cm=T.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=T.useContext(u9),[u,f]=T.useState(null),m=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,g]=T.useState({}),v=Nn(t,I=>f(I)),b=Array.from(c.layers),[w]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(w),_=u?b.indexOf(u):-1,E=c.layersWithOutsidePointerEventsDisabled.size>0,C=_>=x,k=hse(I=>{const j=I.target,M=[...c.branches].some(L=>L.contains(j));!C||M||(s==null||s(I),a==null||a(I),I.defaultPrevented||o==null||o())},m),R=pse(I=>{const j=I.target;[...c.branches].some(L=>L.contains(j))||(i==null||i(I),a==null||a(I),I.defaultPrevented||o==null||o())},m);return ose(I=>{_===c.layers.size-1&&(r==null||r(I),!I.defaultPrevented&&o&&(I.preventDefault(),o()))},m),T.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(b6=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),v6(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=b6)}},[u,m,n,c]),T.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),v6())},[u,c]),T.useEffect(()=>{const I=()=>g({});return document.addEventListener(qT,I),()=>document.removeEventListener(qT,I)},[]),p.jsx(sn.div,{...l,ref:v,style:{pointerEvents:E?C?"auto":"none":void 0,...e.style},onFocusCapture:Ut(e.onFocusCapture,R.onFocusCapture),onBlurCapture:Ut(e.onBlurCapture,R.onBlurCapture),onPointerDownCapture:Ut(e.onPointerDownCapture,k.onPointerDownCapture)})});cm.displayName=lse;var dse="DismissableLayerBranch",fse=T.forwardRef((e,t)=>{const n=T.useContext(u9),r=T.useRef(null),s=Nn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),p.jsx(sn.div,{...e,ref:s})});fse.displayName=dse;function hse(e,t=globalThis==null?void 0:globalThis.document){const n=Xs(e),r=T.useRef(!1),s=T.useRef(()=>{});return T.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){d9(cse,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function pse(e,t=globalThis==null?void 0:globalThis.document){const n=Xs(e),r=T.useRef(!1);return T.useEffect(()=>{const s=i=>{i.target&&!r.current&&d9(use,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function v6(){const e=new CustomEvent(qT);document.dispatchEvent(e)}function d9(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?c9(s,i):s.dispatchEvent(i)}var mi=globalThis!=null&&globalThis.document?T.useLayoutEffect:()=>{},mse=F8[" useId ".trim().toString()]||(()=>{}),gse=0;function Qs(e){const[t,n]=T.useState(mse());return mi(()=>{n(r=>r??String(gse++))},[e]),t?`radix-${t}`:""}const yse=["top","right","bottom","left"],Yu=Math.min,Ta=Math.max,Fx=Math.round,aw=Math.floor,kl=e=>({x:e,y:e}),bse={left:"right",right:"left",bottom:"top",top:"bottom"},vse={start:"end",end:"start"};function VT(e,t,n){return Ta(e,Yu(t,n))}function Ic(e,t){return typeof e=="function"?e(t):e}function jc(e){return e.split("-")[0]}function um(e){return e.split("-")[1]}function TR(e){return e==="x"?"y":"x"}function AR(e){return e==="y"?"height":"width"}function Xu(e){return["top","bottom"].includes(jc(e))?"y":"x"}function RR(e){return TR(Xu(e))}function wse(e,t,n){n===void 0&&(n=!1);const r=um(e),s=RR(e),i=AR(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=Lx(a)),[a,Lx(a)]}function xse(e){const t=Lx(e);return[HT(e),t,HT(t)]}function HT(e){return e.replace(/start|end/g,t=>vse[t])}function _se(e,t,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?i:a;default:return[]}}function Sse(e,t,n,r){const s=um(e);let i=_se(jc(e),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),t&&(i=i.concat(i.map(HT)))),i}function Lx(e){return e.replace(/left|right|bottom|top/g,t=>bse[t])}function Ese(e){return{top:0,right:0,bottom:0,left:0,...e}}function f9(e){return typeof e!="number"?Ese(e):{top:e,right:e,bottom:e,left:e}}function Bx(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function w6(e,t,n){let{reference:r,floating:s}=e;const i=Xu(t),a=RR(t),o=AR(a),l=jc(t),c=i==="y",u=r.x+r.width/2-s.width/2,f=r.y+r.height/2-s.height/2,m=r[o]/2-s[o]/2;let g;switch(l){case"top":g={x:u,y:r.y-s.height};break;case"bottom":g={x:u,y:r.y+r.height};break;case"right":g={x:r.x+r.width,y:f};break;case"left":g={x:r.x-s.width,y:f};break;default:g={x:r.x,y:r.y}}switch(um(t)){case"start":g[a]-=m*(n&&c?-1:1);break;case"end":g[a]+=m*(n&&c?-1:1);break}return g}const Cse=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:f}=w6(c,r,l),m=r,g={},v=0;for(let b=0;b<o.length;b++){const{name:w,fn:x}=o[b],{x:_,y:E,data:C,reset:k}=await x({x:u,y:f,initialPlacement:r,placement:m,strategy:s,middlewareData:g,rects:c,platform:a,elements:{reference:e,floating:t}});u=_??u,f=E??f,g={...g,[w]:{...g[w],...C}},k&&v<=50&&(v++,typeof k=="object"&&(k.placement&&(m=k.placement),k.rects&&(c=k.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):k.rects),{x:u,y:f}=w6(c,m,l)),b=-1)}return{x:u,y:f,placement:m,strategy:s,middlewareData:g}};async function G0(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:m=!1,padding:g=0}=Ic(t,e),v=f9(g),w=o[m?f==="floating"?"reference":"floating":f],x=Bx(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(w)))==null||n?w:w.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),_=f==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,E=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),C=await(i.isElement==null?void 0:i.isElement(E))?await(i.getScale==null?void 0:i.getScale(E))||{x:1,y:1}:{x:1,y:1},k=Bx(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:_,offsetParent:E,strategy:l}):_);return{top:(x.top-k.top+v.top)/C.y,bottom:(k.bottom-x.bottom+v.bottom)/C.y,left:(x.left-k.left+v.left)/C.x,right:(k.right-x.right+v.right)/C.x}}const kse=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=Ic(e,t)||{};if(c==null)return{};const f=f9(u),m={x:n,y:r},g=RR(s),v=AR(g),b=await a.getDimensions(c),w=g==="y",x=w?"top":"left",_=w?"bottom":"right",E=w?"clientHeight":"clientWidth",C=i.reference[v]+i.reference[g]-m[g]-i.floating[v],k=m[g]-i.reference[g],R=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let I=R?R[E]:0;(!I||!await(a.isElement==null?void 0:a.isElement(R)))&&(I=o.floating[E]||i.floating[v]);const j=C/2-k/2,M=I/2-b[v]/2-1,L=Yu(f[x],M),q=Yu(f[_],M),P=L,V=I-b[v]-q,z=I/2-b[v]/2+j,re=VT(P,z,V),K=!l.arrow&&um(s)!=null&&z!==re&&i.reference[v]/2-(z<P?L:q)-b[v]/2<0,ee=K?z<P?z-P:z-V:0;return{[g]:m[g]+ee,data:{[g]:re,centerOffset:z-re-ee,...K&&{alignmentOffset:ee}},reset:K}}}),Tse=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:m,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:b=!0,...w}=Ic(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=jc(s),_=Xu(o),E=jc(o)===o,C=await(l.isRTL==null?void 0:l.isRTL(c.floating)),k=m||(E||!b?[Lx(o)]:xse(o)),R=v!=="none";!m&&R&&k.push(...Sse(o,b,v,C));const I=[o,...k],j=await G0(t,w),M=[];let L=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&M.push(j[x]),f){const z=wse(s,a,C);M.push(j[z[0]],j[z[1]])}if(L=[...L,{placement:s,overflows:M}],!M.every(z=>z<=0)){var q,P;const z=(((q=i.flip)==null?void 0:q.index)||0)+1,re=I[z];if(re)return{data:{index:z,overflows:L},reset:{placement:re}};let K=(P=L.filter(ee=>ee.overflows[0]<=0).sort((ee,W)=>ee.overflows[1]-W.overflows[1])[0])==null?void 0:P.placement;if(!K)switch(g){case"bestFit":{var V;const ee=(V=L.filter(W=>{if(R){const se=Xu(W.placement);return se===_||se==="y"}return!0}).map(W=>[W.placement,W.overflows.filter(se=>se>0).reduce((se,Y)=>se+Y,0)]).sort((W,se)=>W[1]-se[1])[0])==null?void 0:V[0];ee&&(K=ee);break}case"initialPlacement":K=o;break}if(s!==K)return{reset:{placement:K}}}return{}}}};function x6(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function _6(e){return yse.some(t=>e[t]>=0)}const Ase=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=Ic(e,t);switch(r){case"referenceHidden":{const i=await G0(t,{...s,elementContext:"reference"}),a=x6(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:_6(a)}}}case"escaped":{const i=await G0(t,{...s,altBoundary:!0}),a=x6(i,n.floating);return{data:{escapedOffsets:a,escaped:_6(a)}}}default:return{}}}}};async function Rse(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=jc(n),o=um(n),l=Xu(n)==="y",c=["left","top"].includes(a)?-1:1,u=i&&l?-1:1,f=Ic(t,e);let{mainAxis:m,crossAxis:g,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return o&&typeof v=="number"&&(g=o==="end"?v*-1:v),l?{x:g*u,y:m*c}:{x:m*c,y:g*u}}const Nse=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:a,middlewareData:o}=t,l=await Rse(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}}},Ise=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:w=>{let{x,y:_}=w;return{x,y:_}}},...l}=Ic(e,t),c={x:n,y:r},u=await G0(t,l),f=Xu(jc(s)),m=TR(f);let g=c[m],v=c[f];if(i){const w=m==="y"?"top":"left",x=m==="y"?"bottom":"right",_=g+u[w],E=g-u[x];g=VT(_,g,E)}if(a){const w=f==="y"?"top":"left",x=f==="y"?"bottom":"right",_=v+u[w],E=v-u[x];v=VT(_,v,E)}const b=o.fn({...t,[m]:g,[f]:v});return{...b,data:{x:b.x-n,y:b.y-r,enabled:{[m]:i,[f]:a}}}}}},jse=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Ic(e,t),u={x:n,y:r},f=Xu(s),m=TR(f);let g=u[m],v=u[f];const b=Ic(o,t),w=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const E=m==="y"?"height":"width",C=i.reference[m]-i.floating[E]+w.mainAxis,k=i.reference[m]+i.reference[E]-w.mainAxis;g<C?g=C:g>k&&(g=k)}if(c){var x,_;const E=m==="y"?"width":"height",C=["top","left"].includes(jc(s)),k=i.reference[f]-i.floating[E]+(C&&((x=a.offset)==null?void 0:x[f])||0)+(C?0:w.crossAxis),R=i.reference[f]+i.reference[E]+(C?0:((_=a.offset)==null?void 0:_[f])||0)-(C?w.crossAxis:0);v<k?v=k:v>R&&(v=R)}return{[m]:g,[f]:v}}}},Mse=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:a,elements:o}=t,{apply:l=()=>{},...c}=Ic(e,t),u=await G0(t,c),f=jc(s),m=um(s),g=Xu(s)==="y",{width:v,height:b}=i.floating;let w,x;f==="top"||f==="bottom"?(w=f,x=m===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(x=f,w=m==="end"?"top":"bottom");const _=b-u.top-u.bottom,E=v-u.left-u.right,C=Yu(b-u[w],_),k=Yu(v-u[x],E),R=!t.middlewareData.shift;let I=C,j=k;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(j=E),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(I=_),R&&!m){const L=Ta(u.left,0),q=Ta(u.right,0),P=Ta(u.top,0),V=Ta(u.bottom,0);g?j=v-2*(L!==0||q!==0?L+q:Ta(u.left,u.right)):I=b-2*(P!==0||V!==0?P+V:Ta(u.top,u.bottom))}await l({...t,availableWidth:j,availableHeight:I});const M=await a.getDimensions(o.floating);return v!==M.width||b!==M.height?{reset:{rects:!0}}:{}}}};function Z1(){return typeof window<"u"}function dm(e){return h9(e)?(e.nodeName||"").toLowerCase():"#document"}function Na(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ll(e){var t;return(t=(h9(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function h9(e){return Z1()?e instanceof Node||e instanceof Na(e).Node:!1}function Do(e){return Z1()?e instanceof Element||e instanceof Na(e).Element:!1}function Ol(e){return Z1()?e instanceof HTMLElement||e instanceof Na(e).HTMLElement:!1}function S6(e){return!Z1()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Na(e).ShadowRoot}function Ky(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=Fo(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function Ose(e){return["table","td","th"].includes(dm(e))}function Y1(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function NR(e){const t=IR(),n=Do(e)?Fo(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Pse(e){let t=Ju(e);for(;Ol(t)&&!Dp(t);){if(NR(t))return t;if(Y1(t))return null;t=Ju(t)}return null}function IR(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Dp(e){return["html","body","#document"].includes(dm(e))}function Fo(e){return Na(e).getComputedStyle(e)}function X1(e){return Do(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ju(e){if(dm(e)==="html")return e;const t=e.assignedSlot||e.parentNode||S6(e)&&e.host||Ll(e);return S6(t)?t.host:t}function p9(e){const t=Ju(e);return Dp(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ol(t)&&Ky(t)?t:p9(t)}function K0(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=p9(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),a=Na(s);if(i){const o=GT(a);return t.concat(a,a.visualViewport||[],Ky(s)?s:[],o&&n?K0(o):[])}return t.concat(s,K0(s,[],n))}function GT(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function m9(e){const t=Fo(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=Ol(e),i=s?e.offsetWidth:n,a=s?e.offsetHeight:r,o=Fx(n)!==i||Fx(r)!==a;return o&&(n=i,r=a),{width:n,height:r,$:o}}function jR(e){return Do(e)?e:e.contextElement}function xp(e){const t=jR(e);if(!Ol(t))return kl(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=m9(t);let a=(i?Fx(n.width):n.width)/r,o=(i?Fx(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const Dse=kl(0);function g9(e){const t=Na(e);return!IR()||!t.visualViewport?Dse:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Fse(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Na(e)?!1:t}function If(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=jR(e);let a=kl(1);t&&(r?Do(r)&&(a=xp(r)):a=xp(e));const o=Fse(i,n,r)?g9(i):kl(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,u=s.width/a.x,f=s.height/a.y;if(i){const m=Na(i),g=r&&Do(r)?Na(r):r;let v=m,b=GT(v);for(;b&&r&&g!==v;){const w=xp(b),x=b.getBoundingClientRect(),_=Fo(b),E=x.left+(b.clientLeft+parseFloat(_.paddingLeft))*w.x,C=x.top+(b.clientTop+parseFloat(_.paddingTop))*w.y;l*=w.x,c*=w.y,u*=w.x,f*=w.y,l+=E,c+=C,v=Na(b),b=GT(v)}}return Bx({width:u,height:f,x:l,y:c})}function MR(e,t){const n=X1(e).scrollLeft;return t?t.left+n:If(Ll(e)).left+n}function y9(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:MR(e,r)),i=r.top+t.scrollTop;return{x:s,y:i}}function Lse(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",a=Ll(r),o=t?Y1(t.floating):!1;if(r===a||o&&i)return n;let l={scrollLeft:0,scrollTop:0},c=kl(1);const u=kl(0),f=Ol(r);if((f||!f&&!i)&&((dm(r)!=="body"||Ky(a))&&(l=X1(r)),Ol(r))){const g=If(r);c=xp(r),u.x=g.x+r.clientLeft,u.y=g.y+r.clientTop}const m=a&&!f&&!i?y9(a,l,!0):kl(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+m.x,y:n.y*c.y-l.scrollTop*c.y+u.y+m.y}}function Bse(e){return Array.from(e.getClientRects())}function $se(e){const t=Ll(e),n=X1(e),r=e.ownerDocument.body,s=Ta(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=Ta(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+MR(e);const o=-n.scrollTop;return Fo(r).direction==="rtl"&&(a+=Ta(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}function zse(e,t){const n=Na(e),r=Ll(e),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;const c=IR();(!c||c&&t==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}return{width:i,height:a,x:o,y:l}}function Use(e,t){const n=If(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=Ol(e)?xp(e):kl(1),a=e.clientWidth*i.x,o=e.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:a,height:o,x:l,y:c}}function E6(e,t,n){let r;if(t==="viewport")r=zse(e,n);else if(t==="document")r=$se(Ll(e));else if(Do(t))r=Use(t,n);else{const s=g9(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return Bx(r)}function b9(e,t){const n=Ju(e);return n===t||!Do(n)||Dp(n)?!1:Fo(n).position==="fixed"||b9(n,t)}function qse(e,t){const n=t.get(e);if(n)return n;let r=K0(e,[],!1).filter(o=>Do(o)&&dm(o)!=="body"),s=null;const i=Fo(e).position==="fixed";let a=i?Ju(e):e;for(;Do(a)&&!Dp(a);){const o=Fo(a),l=NR(a);!l&&o.position==="fixed"&&(s=null),(i?!l&&!s:!l&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Ky(a)&&!l&&b9(e,a))?r=r.filter(u=>u!==a):s=o,a=Ju(a)}return t.set(e,r),r}function Vse(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const a=[...n==="clippingAncestors"?Y1(t)?[]:qse(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const f=E6(t,u,s);return c.top=Ta(f.top,c.top),c.right=Yu(f.right,c.right),c.bottom=Yu(f.bottom,c.bottom),c.left=Ta(f.left,c.left),c},E6(t,o,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Hse(e){const{width:t,height:n}=m9(e);return{width:t,height:n}}function Gse(e,t,n){const r=Ol(t),s=Ll(t),i=n==="fixed",a=If(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=kl(0);if(r||!r&&!i)if((dm(t)!=="body"||Ky(s))&&(o=X1(t)),r){const m=If(t,!0,i,t);l.x=m.x+t.clientLeft,l.y=m.y+t.clientTop}else s&&(l.x=MR(s));const c=s&&!r&&!i?y9(s,o):kl(0),u=a.left+o.scrollLeft-l.x-c.x,f=a.top+o.scrollTop-l.y-c.y;return{x:u,y:f,width:a.width,height:a.height}}function QE(e){return Fo(e).position==="static"}function C6(e,t){if(!Ol(e)||Fo(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Ll(e)===n&&(n=n.ownerDocument.body),n}function v9(e,t){const n=Na(e);if(Y1(e))return n;if(!Ol(e)){let s=Ju(e);for(;s&&!Dp(s);){if(Do(s)&&!QE(s))return s;s=Ju(s)}return n}let r=C6(e,t);for(;r&&Ose(r)&&QE(r);)r=C6(r,t);return r&&Dp(r)&&QE(r)&&!NR(r)?n:r||Pse(e)||n}const Kse=async function(e){const t=this.getOffsetParent||v9,n=this.getDimensions,r=await n(e.floating);return{reference:Gse(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Wse(e){return Fo(e).direction==="rtl"}const Zse={convertOffsetParentRelativeRectToViewportRelativeRect:Lse,getDocumentElement:Ll,getClippingRect:Vse,getOffsetParent:v9,getElementRects:Kse,getClientRects:Bse,getDimensions:Hse,getScale:xp,isElement:Do,isRTL:Wse};function w9(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Yse(e,t){let n=null,r;const s=Ll(e);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=e.getBoundingClientRect(),{left:u,top:f,width:m,height:g}=c;if(o||t(),!m||!g)return;const v=aw(f),b=aw(s.clientWidth-(u+m)),w=aw(s.clientHeight-(f+g)),x=aw(u),E={rootMargin:-v+"px "+-b+"px "+-w+"px "+-x+"px",threshold:Ta(0,Yu(1,l))||1};let C=!0;function k(R){const I=R[0].intersectionRatio;if(I!==l){if(!C)return a();I?a(!1,I):r=setTimeout(()=>{a(!1,1e-7)},1e3)}I===1&&!w9(c,e.getBoundingClientRect())&&a(),C=!1}try{n=new IntersectionObserver(k,{...E,root:s.ownerDocument})}catch{n=new IntersectionObserver(k,E)}n.observe(e)}return a(!0),i}function Xse(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=jR(e),u=s||i?[...c?K0(c):[],...K0(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const f=c&&o?Yse(c,n):null;let m=-1,g=null;a&&(g=new ResizeObserver(x=>{let[_]=x;_&&_.target===c&&g&&(g.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var E;(E=g)==null||E.observe(t)})),n()}),c&&!l&&g.observe(c),g.observe(t));let v,b=l?If(e):null;l&&w();function w(){const x=If(e);b&&!w9(b,x)&&n(),b=x,v=requestAnimationFrame(w)}return n(),()=>{var x;u.forEach(_=>{s&&_.removeEventListener("scroll",n),i&&_.removeEventListener("resize",n)}),f==null||f(),(x=g)==null||x.disconnect(),g=null,l&&cancelAnimationFrame(v)}}const Jse=Nse,Qse=Ise,eie=Tse,tie=Mse,nie=Ase,k6=kse,rie=jse,sie=(e,t,n)=>{const r=new Map,s={platform:Zse,...n},i={...s.platform,_c:r};return Cse(e,t,{...s,platform:i})};var Ww=typeof document<"u"?T.useLayoutEffect:T.useEffect;function $x(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!$x(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!$x(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function x9(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function T6(e,t){const n=x9(e);return Math.round(t*n)/n}function eC(e){const t=T.useRef(e);return Ww(()=>{t.current=e}),t}function iie(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,f]=T.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[m,g]=T.useState(r);$x(m,r)||g(r);const[v,b]=T.useState(null),[w,x]=T.useState(null),_=T.useCallback(W=>{W!==R.current&&(R.current=W,b(W))},[]),E=T.useCallback(W=>{W!==I.current&&(I.current=W,x(W))},[]),C=i||v,k=a||w,R=T.useRef(null),I=T.useRef(null),j=T.useRef(u),M=l!=null,L=eC(l),q=eC(s),P=eC(c),V=T.useCallback(()=>{if(!R.current||!I.current)return;const W={placement:t,strategy:n,middleware:m};q.current&&(W.platform=q.current),sie(R.current,I.current,W).then(se=>{const Y={...se,isPositioned:P.current!==!1};z.current&&!$x(j.current,Y)&&(j.current=Y,ko.flushSync(()=>{f(Y)}))})},[m,t,n,q,P]);Ww(()=>{c===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,f(W=>({...W,isPositioned:!1})))},[c]);const z=T.useRef(!1);Ww(()=>(z.current=!0,()=>{z.current=!1}),[]),Ww(()=>{if(C&&(R.current=C),k&&(I.current=k),C&&k){if(L.current)return L.current(C,k,V);V()}},[C,k,V,L,M]);const re=T.useMemo(()=>({reference:R,floating:I,setReference:_,setFloating:E}),[_,E]),K=T.useMemo(()=>({reference:C,floating:k}),[C,k]),ee=T.useMemo(()=>{const W={position:n,left:0,top:0};if(!K.floating)return W;const se=T6(K.floating,u.x),Y=T6(K.floating,u.y);return o?{...W,transform:"translate("+se+"px, "+Y+"px)",...x9(K.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:se,top:Y}},[n,o,K.floating,u.x,u.y]);return T.useMemo(()=>({...u,update:V,refs:re,elements:K,floatingStyles:ee}),[u,V,re,K,ee])}const aie=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?k6({element:r.current,padding:s}).fn(n):{}:r?k6({element:r,padding:s}).fn(n):{}}}},oie=(e,t)=>({...Jse(e),options:[e,t]}),lie=(e,t)=>({...Qse(e),options:[e,t]}),cie=(e,t)=>({...rie(e),options:[e,t]}),uie=(e,t)=>({...eie(e),options:[e,t]}),die=(e,t)=>({...tie(e),options:[e,t]}),fie=(e,t)=>({...nie(e),options:[e,t]}),hie=(e,t)=>({...aie(e),options:[e,t]});var pie="Arrow",_9=T.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return p.jsx(sn.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});_9.displayName=pie;var mie=_9;function J1(e){const[t,n]=T.useState(void 0);return mi(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;n({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var OR="Popper",[S9,pd]=Ii(OR),[gie,E9]=S9(OR),C9=e=>{const{__scopePopper:t,children:n}=e,[r,s]=T.useState(null);return p.jsx(gie,{scope:t,anchor:r,onAnchorChange:s,children:n})};C9.displayName=OR;var k9="PopperAnchor",T9=T.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=E9(k9,n),a=T.useRef(null),o=Nn(t,a);return T.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:p.jsx(sn.div,{...s,ref:o})});T9.displayName=k9;var PR="PopperContent",[yie,bie]=S9(PR),A9=T.forwardRef((e,t)=>{var Pe,Ie,Ce,He,it,Ge;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:m=!1,updatePositionStrategy:g="optimized",onPlaced:v,...b}=e,w=E9(PR,n),[x,_]=T.useState(null),E=Nn(t,Re=>_(Re)),[C,k]=T.useState(null),R=J1(C),I=(R==null?void 0:R.width)??0,j=(R==null?void 0:R.height)??0,M=r+(i!=="center"?"-"+i:""),L=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},q=Array.isArray(c)?c:[c],P=q.length>0,V={padding:L,boundary:q.filter(wie),altBoundary:P},{refs:z,floatingStyles:re,placement:K,isPositioned:ee,middlewareData:W}=iie({strategy:"fixed",placement:M,whileElementsMounted:(...Re)=>Xse(...Re,{animationFrame:g==="always"}),elements:{reference:w.anchor},middleware:[oie({mainAxis:s+j,alignmentAxis:a}),l&&lie({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?cie():void 0,...V}),l&&uie({...V}),die({...V,apply:({elements:Re,rects:H,availableWidth:me,availableHeight:Te})=>{const{width:ce,height:oe}=H.reference,ne=Re.floating.style;ne.setProperty("--radix-popper-available-width",`${me}px`),ne.setProperty("--radix-popper-available-height",`${Te}px`),ne.setProperty("--radix-popper-anchor-width",`${ce}px`),ne.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),C&&hie({element:C,padding:o}),xie({arrowWidth:I,arrowHeight:j}),m&&fie({strategy:"referenceHidden",...V})]}),[se,Y]=I9(K),te=Xs(v);mi(()=>{ee&&(te==null||te())},[ee,te]);const Q=(Pe=W.arrow)==null?void 0:Pe.x,ae=(Ie=W.arrow)==null?void 0:Ie.y,xe=((Ce=W.arrow)==null?void 0:Ce.centerOffset)!==0,[ge,Me]=T.useState();return mi(()=>{x&&Me(window.getComputedStyle(x).zIndex)},[x]),p.jsx("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...re,transform:ee?re.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ge,"--radix-popper-transform-origin":[(He=W.transformOrigin)==null?void 0:He.x,(it=W.transformOrigin)==null?void 0:it.y].join(" "),...((Ge=W.hide)==null?void 0:Ge.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:p.jsx(yie,{scope:n,placedSide:se,onArrowChange:k,arrowX:Q,arrowY:ae,shouldHideArrow:xe,children:p.jsx(sn.div,{"data-side":se,"data-align":Y,...b,ref:E,style:{...b.style,animation:ee?void 0:"none"}})})})});A9.displayName=PR;var R9="PopperArrow",vie={top:"bottom",right:"left",bottom:"top",left:"right"},N9=T.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=bie(R9,r),a=vie[i.placedSide];return p.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:p.jsx(mie,{...s,ref:n,style:{...s.style,display:"block"}})})});N9.displayName=R9;function wie(e){return e!==null}var xie=e=>({name:"transformOrigin",options:e,fn(t){var w,x,_;const{placement:n,rects:r,middlewareData:s}=t,a=((w=s.arrow)==null?void 0:w.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=I9(n),f={start:"0%",center:"50%",end:"100%"}[u],m=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,g=(((_=s.arrow)==null?void 0:_.y)??0)+l/2;let v="",b="";return c==="bottom"?(v=a?f:`${m}px`,b=`${-l}px`):c==="top"?(v=a?f:`${m}px`,b=`${r.floating.height+l}px`):c==="right"?(v=`${-l}px`,b=a?f:`${g}px`):c==="left"&&(v=`${r.floating.width+l}px`,b=a?f:`${g}px`),{data:{x:v,y:b}}}});function I9(e){const[t,n="center"]=e.split("-");return[t,n]}var Q1=C9,Wy=T9,e_=A9,t_=N9,_ie="Portal",fm=T.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=T.useState(!1);mi(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?gF.createPortal(p.jsx(sn.div,{...r,ref:t}),a):null});fm.displayName=_ie;function Sie(e,t){return T.useReducer((n,r)=>t[n][r]??n,e)}var si=e=>{const{present:t,children:n}=e,r=Eie(t),s=typeof n=="function"?n({present:r.isPresent}):T.Children.only(n),i=Nn(r.ref,Cie(s));return typeof n=="function"||r.isPresent?T.cloneElement(s,{ref:i}):null};si.displayName="Presence";function Eie(e){const[t,n]=T.useState(),r=T.useRef(null),s=T.useRef(e),i=T.useRef("none"),a=e?"mounted":"unmounted",[o,l]=Sie(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return T.useEffect(()=>{const c=ow(r.current);i.current=o==="mounted"?c:"none"},[o]),mi(()=>{const c=r.current,u=s.current;if(u!==e){const m=i.current,g=ow(c);e?l("MOUNT"):g==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&m!==g?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),mi(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,f=g=>{const b=ow(r.current).includes(g.animationName);if(g.target===t&&b&&(l("ANIMATION_END"),!s.current)){const w=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=w)})}},m=g=>{g.target===t&&(i.current=ow(r.current))};return t.addEventListener("animationstart",m),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",m),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:T.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function ow(e){return(e==null?void 0:e.animationName)||"none"}function Cie(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var kie=F8[" useInsertionEffect ".trim().toString()]||mi;function Lo({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,a]=Tie({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:s;{const u=T.useRef(e!==void 0);T.useEffect(()=>{const f=u.current;f!==o&&console.warn(`${r} is changing from ${f?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=T.useCallback(u=>{var f;if(o){const m=Aie(u)?u(e):u;m!==e&&((f=a.current)==null||f.call(a,m))}else i(u)},[o,e,i,a]);return[l,c]}function Tie({defaultProp:e,onChange:t}){const[n,r]=T.useState(e),s=T.useRef(n),i=T.useRef(t);return kie(()=>{i.current=t},[t]),T.useEffect(()=>{var a;s.current!==n&&((a=i.current)==null||a.call(i,n),s.current=n)},[n,s]),[n,r,i]}function Aie(e){return typeof e=="function"}var j9=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Rie="VisuallyHidden",M9=T.forwardRef((e,t)=>p.jsx(sn.span,{...e,ref:t,style:{...j9,...e.style}}));M9.displayName=Rie;var Nie=M9,[n_,r4e]=Ii("Tooltip",[pd]),r_=pd(),O9="TooltipProvider",Iie=700,KT="tooltip.open",[jie,DR]=n_(O9),P9=e=>{const{__scopeTooltip:t,delayDuration:n=Iie,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,a=T.useRef(!0),o=T.useRef(!1),l=T.useRef(0);return T.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),p.jsx(jie,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:T.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:T.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:T.useCallback(c=>{o.current=c},[]),disableHoverableContent:s,children:i})};P9.displayName=O9;var W0="Tooltip",[Mie,Zy]=n_(W0),D9=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:a,delayDuration:o}=e,l=DR(W0,e.__scopeTooltip),c=r_(t),[u,f]=T.useState(null),m=Qs(),g=T.useRef(0),v=a??l.disableHoverableContent,b=o??l.delayDuration,w=T.useRef(!1),[x,_]=Lo({prop:r,defaultProp:s??!1,onChange:I=>{I?(l.onOpen(),document.dispatchEvent(new CustomEvent(KT))):l.onClose(),i==null||i(I)},caller:W0}),E=T.useMemo(()=>x?w.current?"delayed-open":"instant-open":"closed",[x]),C=T.useCallback(()=>{window.clearTimeout(g.current),g.current=0,w.current=!1,_(!0)},[_]),k=T.useCallback(()=>{window.clearTimeout(g.current),g.current=0,_(!1)},[_]),R=T.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>{w.current=!0,_(!0),g.current=0},b)},[b,_]);return T.useEffect(()=>()=>{g.current&&(window.clearTimeout(g.current),g.current=0)},[]),p.jsx(Q1,{...c,children:p.jsx(Mie,{scope:t,contentId:m,open:x,stateAttribute:E,trigger:u,onTriggerChange:f,onTriggerEnter:T.useCallback(()=>{l.isOpenDelayedRef.current?R():C()},[l.isOpenDelayedRef,R,C]),onTriggerLeave:T.useCallback(()=>{v?k():(window.clearTimeout(g.current),g.current=0)},[k,v]),onOpen:C,onClose:k,disableHoverableContent:v,children:n})})};D9.displayName=W0;var WT="TooltipTrigger",F9=T.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=Zy(WT,n),i=DR(WT,n),a=r_(n),o=T.useRef(null),l=Nn(t,o,s.onTriggerChange),c=T.useRef(!1),u=T.useRef(!1),f=T.useCallback(()=>c.current=!1,[]);return T.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),p.jsx(Wy,{asChild:!0,...a,children:p.jsx(sn.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Ut(e.onPointerMove,m=>{m.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Ut(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Ut(e.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:Ut(e.onFocus,()=>{c.current||s.onOpen()}),onBlur:Ut(e.onBlur,s.onClose),onClick:Ut(e.onClick,s.onClose)})})});F9.displayName=WT;var FR="TooltipPortal",[Oie,Pie]=n_(FR,{forceMount:void 0}),L9=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:s}=e,i=Zy(FR,t);return p.jsx(Oie,{scope:t,forceMount:n,children:p.jsx(si,{present:n||i.open,children:p.jsx(fm,{asChild:!0,container:s,children:r})})})};L9.displayName=FR;var Fp="TooltipContent",B9=T.forwardRef((e,t)=>{const n=Pie(Fp,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,a=Zy(Fp,e.__scopeTooltip);return p.jsx(si,{present:r||a.open,children:a.disableHoverableContent?p.jsx($9,{side:s,...i,ref:t}):p.jsx(Die,{side:s,...i,ref:t})})}),Die=T.forwardRef((e,t)=>{const n=Zy(Fp,e.__scopeTooltip),r=DR(Fp,e.__scopeTooltip),s=T.useRef(null),i=Nn(t,s),[a,o]=T.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:f}=r,m=T.useCallback(()=>{o(null),f(!1)},[f]),g=T.useCallback((v,b)=>{const w=v.currentTarget,x={x:v.clientX,y:v.clientY},_=$ie(x,w.getBoundingClientRect()),E=zie(x,_),C=Uie(b.getBoundingClientRect()),k=Vie([...E,...C]);o(k),f(!0)},[f]);return T.useEffect(()=>()=>m(),[m]),T.useEffect(()=>{if(l&&u){const v=w=>g(w,u),b=w=>g(w,l);return l.addEventListener("pointerleave",v),u.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",v),u.removeEventListener("pointerleave",b)}}},[l,u,g,m]),T.useEffect(()=>{if(a){const v=b=>{const w=b.target,x={x:b.clientX,y:b.clientY},_=(l==null?void 0:l.contains(w))||(u==null?void 0:u.contains(w)),E=!qie(x,a);_?m():E&&(m(),c())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[l,u,a,c,m]),p.jsx($9,{...e,ref:i})}),[Fie,Lie]=n_(W0,{isInside:!1}),Bie=bZ("TooltipContent"),$9=T.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...o}=e,l=Zy(Fp,n),c=r_(n),{onClose:u}=l;return T.useEffect(()=>(document.addEventListener(KT,u),()=>document.removeEventListener(KT,u)),[u]),T.useEffect(()=>{if(l.trigger){const f=m=>{const g=m.target;g!=null&&g.contains(l.trigger)&&u()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[l.trigger,u]),p.jsx(cm,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:f=>f.preventDefault(),onDismiss:u,children:p.jsxs(e_,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[p.jsx(Bie,{children:r}),p.jsx(Fie,{scope:n,isInside:!0,children:p.jsx(Nie,{id:l.contentId,role:"tooltip",children:s||r})})]})})});B9.displayName=Fp;var z9="TooltipArrow",U9=T.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=r_(n);return Lie(z9,n).isInside?null:p.jsx(t_,{...s,...r,ref:t})});U9.displayName=z9;function $ie(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function zie(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function Uie(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function qie(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,f=l.x,m=l.y;u>r!=m>r&&n<(f-c)*(r-u)/(m-u)+c&&(s=!s)}return s}function Vie(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),Hie(t)}function Hie(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var Gie=P9,Kie=D9,Wie=F9,Zie=L9,Yie=B9,Xie=U9;function sr({delayDuration:e=0,...t}){return p.jsx(Gie,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function or({...e}){return p.jsx(sr,{children:p.jsx(Kie,{"data-slot":"tooltip",...e})})}function lr({...e}){return p.jsx(Wie,{"data-slot":"tooltip-trigger",...e})}function cr({className:e,sideOffset:t=0,children:n,...r}){return p.jsx(Zie,{children:p.jsxs(Yie,{"data-slot":"tooltip-content",sideOffset:t,className:ct("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,p.jsx(Xie,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var tC={exports:{}},A6;function Jie(){return A6||(A6=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function _(E){return E instanceof l?new l(E.type,_(E.content),E.alias):Array.isArray(E)?E.map(_):E.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(_){return Object.prototype.toString.call(_).slice(8,-1)},objId:function(_){return _.__id||Object.defineProperty(_,"__id",{value:++i}),_.__id},clone:function _(E,C){C=C||{};var k,R;switch(o.util.type(E)){case"Object":if(R=o.util.objId(E),C[R])return C[R];k={},C[R]=k;for(var I in E)E.hasOwnProperty(I)&&(k[I]=_(E[I],C));return k;case"Array":return R=o.util.objId(E),C[R]?C[R]:(k=[],C[R]=k,E.forEach(function(j,M){k[M]=_(j,C)}),k);default:return E}},getLanguage:function(_){for(;_;){var E=s.exec(_.className);if(E)return E[1].toLowerCase();_=_.parentElement}return"none"},setLanguage:function(_,E){_.className=_.className.replace(RegExp(s,"gi"),""),_.classList.add("language-"+E)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(k){var _=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(k.stack)||[])[1];if(_){var E=document.getElementsByTagName("script");for(var C in E)if(E[C].src==_)return E[C]}return null}},isActive:function(_,E,C){for(var k="no-"+E;_;){var R=_.classList;if(R.contains(E))return!0;if(R.contains(k))return!1;_=_.parentElement}return!!C}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(_,E){var C=o.util.clone(o.languages[_]);for(var k in E)C[k]=E[k];return C},insertBefore:function(_,E,C,k){k=k||o.languages;var R=k[_],I={};for(var j in R)if(R.hasOwnProperty(j)){if(j==E)for(var M in C)C.hasOwnProperty(M)&&(I[M]=C[M]);C.hasOwnProperty(j)||(I[j]=R[j])}var L=k[_];return k[_]=I,o.languages.DFS(o.languages,function(q,P){P===L&&q!=_&&(this[q]=I)}),I},DFS:function _(E,C,k,R){R=R||{};var I=o.util.objId;for(var j in E)if(E.hasOwnProperty(j)){C.call(E,j,E[j],k||j);var M=E[j],L=o.util.type(M);L==="Object"&&!R[I(M)]?(R[I(M)]=!0,_(M,C,null,R)):L==="Array"&&!R[I(M)]&&(R[I(M)]=!0,_(M,C,j,R))}}},plugins:{},highlightAll:function(_,E){o.highlightAllUnder(document,_,E)},highlightAllUnder:function(_,E,C){var k={callback:C,container:_,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",k),k.elements=Array.prototype.slice.apply(k.container.querySelectorAll(k.selector)),o.hooks.run("before-all-elements-highlight",k);for(var R=0,I;I=k.elements[R++];)o.highlightElement(I,E===!0,k.callback)},highlightElement:function(_,E,C){var k=o.util.getLanguage(_),R=o.languages[k];o.util.setLanguage(_,k);var I=_.parentElement;I&&I.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(I,k);var j=_.textContent,M={element:_,language:k,grammar:R,code:j};function L(P){M.highlightedCode=P,o.hooks.run("before-insert",M),M.element.innerHTML=M.highlightedCode,o.hooks.run("after-highlight",M),o.hooks.run("complete",M),C&&C.call(M.element)}if(o.hooks.run("before-sanity-check",M),I=M.element.parentElement,I&&I.nodeName.toLowerCase()==="pre"&&!I.hasAttribute("tabindex")&&I.setAttribute("tabindex","0"),!M.code){o.hooks.run("complete",M),C&&C.call(M.element);return}if(o.hooks.run("before-highlight",M),!M.grammar){L(o.util.encode(M.code));return}if(E&&r.Worker){var q=new Worker(o.filename);q.onmessage=function(P){L(P.data)},q.postMessage(JSON.stringify({language:M.language,code:M.code,immediateClose:!0}))}else L(o.highlight(M.code,M.grammar,M.language))},highlight:function(_,E,C){var k={code:_,grammar:E,language:C};if(o.hooks.run("before-tokenize",k),!k.grammar)throw new Error('The language "'+k.language+'" has no grammar.');return k.tokens=o.tokenize(k.code,k.grammar),o.hooks.run("after-tokenize",k),l.stringify(o.util.encode(k.tokens),k.language)},tokenize:function(_,E){var C=E.rest;if(C){for(var k in C)E[k]=C[k];delete E.rest}var R=new f;return m(R,R.head,_),u(_,R,E,R.head,0),v(R)},hooks:{all:{},add:function(_,E){var C=o.hooks.all;C[_]=C[_]||[],C[_].push(E)},run:function(_,E){var C=o.hooks.all[_];if(!(!C||!C.length))for(var k=0,R;R=C[k++];)R(E)}},Token:l};r.Prism=o;function l(_,E,C,k){this.type=_,this.content=E,this.alias=C,this.length=(k||"").length|0}l.stringify=function _(E,C){if(typeof E=="string")return E;if(Array.isArray(E)){var k="";return E.forEach(function(L){k+=_(L,C)}),k}var R={type:E.type,content:_(E.content,C),tag:"span",classes:["token",E.type],attributes:{},language:C},I=E.alias;I&&(Array.isArray(I)?Array.prototype.push.apply(R.classes,I):R.classes.push(I)),o.hooks.run("wrap",R);var j="";for(var M in R.attributes)j+=" "+M+'="'+(R.attributes[M]||"").replace(/"/g,"&quot;")+'"';return"<"+R.tag+' class="'+R.classes.join(" ")+'"'+j+">"+R.content+"</"+R.tag+">"};function c(_,E,C,k){_.lastIndex=E;var R=_.exec(C);if(R&&k&&R[1]){var I=R[1].length;R.index+=I,R[0]=R[0].slice(I)}return R}function u(_,E,C,k,R,I){for(var j in C)if(!(!C.hasOwnProperty(j)||!C[j])){var M=C[j];M=Array.isArray(M)?M:[M];for(var L=0;L<M.length;++L){if(I&&I.cause==j+","+L)return;var q=M[L],P=q.inside,V=!!q.lookbehind,z=!!q.greedy,re=q.alias;if(z&&!q.pattern.global){var K=q.pattern.toString().match(/[imsuy]*$/)[0];q.pattern=RegExp(q.pattern.source,K+"g")}for(var ee=q.pattern||q,W=k.next,se=R;W!==E.tail&&!(I&&se>=I.reach);se+=W.value.length,W=W.next){var Y=W.value;if(E.length>_.length)return;if(!(Y instanceof l)){var te=1,Q;if(z){if(Q=c(ee,se,_,V),!Q||Q.index>=_.length)break;var Me=Q.index,ae=Q.index+Q[0].length,xe=se;for(xe+=W.value.length;Me>=xe;)W=W.next,xe+=W.value.length;if(xe-=W.value.length,se=xe,W.value instanceof l)continue;for(var ge=W;ge!==E.tail&&(xe<ae||typeof ge.value=="string");ge=ge.next)te++,xe+=ge.value.length;te--,Y=_.slice(se,xe),Q.index-=se}else if(Q=c(ee,0,Y,V),!Q)continue;var Me=Q.index,Pe=Q[0],Ie=Y.slice(0,Me),Ce=Y.slice(Me+Pe.length),He=se+Y.length;I&&He>I.reach&&(I.reach=He);var it=W.prev;Ie&&(it=m(E,it,Ie),se+=Ie.length),g(E,it,te);var Ge=new l(j,P?o.tokenize(Pe,P):Pe,re,Pe);if(W=m(E,it,Ge),Ce&&m(E,W,Ce),te>1){var Re={cause:j+","+L,reach:He};u(_,E,C,W.prev,se,Re),I&&Re.reach>I.reach&&(I.reach=Re.reach)}}}}}}function f(){var _={value:null,prev:null,next:null},E={value:null,prev:_,next:null};_.next=E,this.head=_,this.tail=E,this.length=0}function m(_,E,C){var k=E.next,R={value:C,prev:E,next:k};return E.next=R,k.prev=R,_.length++,R}function g(_,E,C){for(var k=E.next,R=0;R<C&&k!==_.tail;R++)k=k.next;E.next=k,k.prev=E,_.length-=R}function v(_){for(var E=[],C=_.head.next;C!==_.tail;)E.push(C.value),C=C.next;return E}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(_){var E=JSON.parse(_.data),C=E.language,k=E.code,R=E.immediateClose;r.postMessage(o.highlight(k,o.languages[C],C)),R&&r.close()},!1)),o;var b=o.util.currentScript();b&&(o.filename=b.src,b.hasAttribute("data-manual")&&(o.manual=!0));function w(){o.manual||o.highlightAll()}if(!o.manual){var x=document.readyState;x==="loading"||x==="interactive"&&b&&b.defer?document.addEventListener("DOMContentLoaded",w):window.requestAnimationFrame?window.requestAnimationFrame(w):window.setTimeout(w,16)}return o}(t);e.exports&&(e.exports=n),typeof hf<"u"&&(hf.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(s,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,s){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:n.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var i=r.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",s=function(b,w){return" Error "+b+" while fetching file: "+w},i=" Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",f="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function m(b,w,x){var _=new XMLHttpRequest;_.open("GET",b,!0),_.onreadystatechange=function(){_.readyState==4&&(_.status<400&&_.responseText?w(_.responseText):_.status>=400?x(s(_.status,_.statusText)):x(i))},_.send(null)}function g(b){var w=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(b||"");if(w){var x=Number(w[1]),_=w[2],E=w[3];return _?E?[x,Number(E)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(b){b.selector+=", "+f}),n.hooks.add("before-sanity-check",function(b){var w=b.element;if(w.matches(f)){b.code="",w.setAttribute(o,l);var x=w.appendChild(document.createElement("CODE"));x.textContent=r;var _=w.getAttribute("data-src"),E=b.language;if(E==="none"){var C=(/\.(\w+)$/.exec(_)||[,"none"])[1];E=a[C]||C}n.util.setLanguage(x,E),n.util.setLanguage(w,E);var k=n.plugins.autoloader;k&&k.loadLanguages(E),m(_,function(R){w.setAttribute(o,c);var I=g(w.getAttribute("data-range"));if(I){var j=R.split(/\r\n?|\n/g),M=I[0],L=I[1]==null?j.length:I[1];M<0&&(M+=j.length),M=Math.max(0,Math.min(M-1,j.length)),L<0&&(L+=j.length),L=Math.max(0,Math.min(L,j.length)),R=j.slice(M,L).join(`
`),w.hasAttribute("data-start")||w.setAttribute("data-start",String(M+1))}x.textContent=R,n.highlightElement(x)},function(R){w.setAttribute(o,u),x.textContent=R})}}),n.plugins.fileHighlight={highlight:function(w){for(var x=(w||document).querySelectorAll(f),_=0,E;E=x[_++];)n.highlightElement(E)}};var v=!1;n.fileHighlight=function(){v||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),v=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(tC)),tC.exports}var Qie=Jie();const eae=Ni(Qie);var R6={},N6;function tae(){return N6||(N6=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),R6}tae();var I6={},j6;function nae(){return j6||(j6=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),I6}nae();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=r.variable[1].inside,a=0;a<s.length;a++)i[s[a]]=e.languages.bash[s[a]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+i+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+i+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(f){u!==f&&(e.languages.markdown[u].inside.content.inside[f]=e.languages.markdown[f])})}),e.hooks.add("after-tokenize",function(u){if(u.language!=="markdown"&&u.language!=="md")return;function f(m){if(!(!m||typeof m=="string"))for(var g=0,v=m.length;g<v;g++){var b=m[g];if(b.type!=="code"){f(b.content);continue}var w=b.content[1],x=b.content[3];if(w&&x&&w.type==="code-language"&&x.type==="code-block"&&typeof w.content=="string"){var _=w.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");_=(/[a-z][\w-]*/i.exec(_)||[""])[0].toLowerCase();var E="language-"+_;x.alias?typeof x.alias=="string"?x.alias=[x.alias,E]:x.alias.push(E):x.alias=[E]}}}f(u.tokens)}),e.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var f="",m=0,g=u.classes.length;m<g;m++){var v=u.classes[m],b=/language-(.+)/.exec(v);if(b){f=b[1];break}}var w=e.languages[f];if(w)u.content=e.highlight(c(u.content),w,f);else if(f&&f!=="none"&&e.plugins.autoloader){var x="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);u.attributes.id=x,e.plugins.autoloader.loadLanguages(f,function(){var _=document.getElementById(x);_&&(_.innerHTML=e.highlight(_.textContent,e.languages[f],f))})}}});var a=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function c(u){var f=u.replace(a,"");return f=f.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(m,g){if(g=g.toLowerCase(),g[0]==="#"){var v;return g[1]==="x"?v=parseInt(g.slice(2),16):v=Number(g.slice(1)),l(v)}else{var b=o[g];return b||m}}),f}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],s=[];/^\w+$/.test(n)||s.push(/\w+/.exec(n)[0]),n==="diff"&&s.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",s=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),i=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var c=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(c,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+s+"|"+i+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(i),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var M6={},O6;function rae(){return O6||(O6=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),M6}rae();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const sae=({lang:e,code:t,isStreaming:n=!1})=>{const{foldStreamingCodeBlocks:r}=ir(mn(v=>({foldStreamingCodeBlocks:v.foldStreamingCodeBlocks}))),[s,i]=T.useState(n?r:!1),a=T.useRef(null),o=co(mn(v=>Object.values(v.canvasControls))),l=T.useCallback((v,b,w,x,_)=>o.filter(E=>E.type==="codeblock"&&E.targetSlot===v&&E.renderer).map(E=>{if(E.renderer){const C={codeBlockContent:b,codeBlockLang:w,isFolded:x,toggleFold:_,canvasContextType:"codeblock"};return p.jsx(dt.Fragment,{children:E.renderer(C)},E.id)}return null}).filter(Boolean),[o]),c=T.useCallback(()=>{if(a.current&&t)try{a.current.style.whiteSpace!=="pre-wrap"&&(a.current.style.whiteSpace="pre-wrap"),a.current.textContent=t,eae.highlightElement(a.current)}catch(v){console.error("Prism highlight error:",v),a.current.textContent=t}else a.current&&(a.current.textContent="")},[t]);T.useEffect(()=>{s||c()},[t,e,s,c]);const u=()=>{const v=s;i(b=>!b),v&&setTimeout(c,0)},f=e?`language-${e}`:"language-plaintext",m=T.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]),g=l("codeblock-header-actions",t,e,s,u);return p.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[p.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),p.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:g})]}),p.jsx("div",{})]}),!s&&p.jsx("div",{className:"overflow-hidden w-full",children:p.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere",children:p.jsx("code",{ref:a,className:f+" block"})})}),s&&p.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:u,children:p.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:m})})]})},hm=T.memo(sae);var ut;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(ut||(ut={}));const P6={[ut.EPERM]:"Operation not permitted",[ut.ENOENT]:"No such file or directory",[ut.EINTR]:"Interrupted system call",[ut.EIO]:"Input/output error",[ut.ENXIO]:"No such device or address",[ut.EBADF]:"Bad file descriptor",[ut.EAGAIN]:"Resource temporarily unavailable",[ut.ENOMEM]:"Cannot allocate memory",[ut.EACCES]:"Permission denied",[ut.EFAULT]:"Bad address",[ut.ENOTBLK]:"Block device required",[ut.EBUSY]:"Resource busy or locked",[ut.EEXIST]:"File exists",[ut.EXDEV]:"Invalid cross-device link",[ut.ENODEV]:"No such device",[ut.ENOTDIR]:"File is not a directory",[ut.EISDIR]:"File is a directory",[ut.EINVAL]:"Invalid argument",[ut.ENFILE]:"Too many open files in system",[ut.EMFILE]:"Too many open files",[ut.ETXTBSY]:"Text file busy",[ut.EFBIG]:"File is too big",[ut.ENOSPC]:"No space left on disk",[ut.ESPIPE]:"Illegal seek",[ut.EROFS]:"Cannot modify a read-only file system",[ut.EMLINK]:"Too many links",[ut.EPIPE]:"Broken pipe",[ut.EDOM]:"Numerical argument out of domain",[ut.ERANGE]:"Numerical result out of range",[ut.EDEADLK]:"Resource deadlock would occur",[ut.ENAMETOOLONG]:"File name too long",[ut.ENOLCK]:"No locks available",[ut.ENOSYS]:"Function not implemented",[ut.ENOTEMPTY]:"Directory is not empty",[ut.ELOOP]:"Too many levels of symbolic links",[ut.ENOMSG]:"No message of desired type",[ut.EBADE]:"Invalid exchange",[ut.EBADR]:"Invalid request descriptor",[ut.EXFULL]:"Exchange full",[ut.ENOANO]:"No anode",[ut.EBADRQC]:"Invalid request code",[ut.ENOSTR]:"Device not a stream",[ut.ENODATA]:"No data available",[ut.ETIME]:"Timer expired",[ut.ENOSR]:"Out of streams resources",[ut.ENONET]:"Machine is not on the network",[ut.EREMOTE]:"Object is remote",[ut.ENOLINK]:"Link has been severed",[ut.ECOMM]:"Communication error on send",[ut.EPROTO]:"Protocol error",[ut.EBADMSG]:"Bad message",[ut.EOVERFLOW]:"Value too large for defined data type",[ut.EBADFD]:"File descriptor in bad state",[ut.ESTRPIPE]:"Streams pipe error",[ut.ENOTSOCK]:"Socket operation on non-socket",[ut.EDESTADDRREQ]:"Destination address required",[ut.EMSGSIZE]:"Message too long",[ut.EPROTOTYPE]:"Protocol wrong type for socket",[ut.ENOPROTOOPT]:"Protocol not available",[ut.EPROTONOSUPPORT]:"Protocol not supported",[ut.ESOCKTNOSUPPORT]:"Socket type not supported",[ut.ENOTSUP]:"Operation is not supported",[ut.ENETDOWN]:"Network is down",[ut.ENETUNREACH]:"Network is unreachable",[ut.ENETRESET]:"Network dropped connection on reset",[ut.ETIMEDOUT]:"Connection timed out",[ut.ECONNREFUSED]:"Connection refused",[ut.EHOSTDOWN]:"Host is down",[ut.EHOSTUNREACH]:"No route to host",[ut.EALREADY]:"Operation already in progress",[ut.EINPROGRESS]:"Operation now in progress",[ut.ESTALE]:"Stale file handle",[ut.EREMOTEIO]:"Remote I/O error",[ut.EDQUOT]:"Disk quota exceeded"};class Ve extends Error{static fromJSON(t){const n=new Ve(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Ve(ut[t],P6[ut[t]],n,r)}constructor(t,n=P6[t],r,s=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=s,this.code=ut[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var nC={exports:{}},D6;function iae(){return D6||(D6=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,f,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var g=new s(u,f||l,m),v=n?n+c:c;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],g]:l._events[v].push(g):(l._events[v]=g,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,f;if(this._eventsCount===0)return c;for(f in u=this._events)t.call(u,f)&&c.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,g=f.length,v=new Array(g);m<g;m++)v[m]=f[m].fn;return v},o.prototype.listenerCount=function(c){var u=n?n+c:c,f=this._events[u];return f?f.fn?1:f.length:0},o.prototype.emit=function(c,u,f,m,g,v){var b=n?n+c:c;if(!this._events[b])return!1;var w=this._events[b],x=arguments.length,_,E;if(w.fn){switch(w.once&&this.removeListener(c,w.fn,void 0,!0),x){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,u),!0;case 3:return w.fn.call(w.context,u,f),!0;case 4:return w.fn.call(w.context,u,f,m),!0;case 5:return w.fn.call(w.context,u,f,m,g),!0;case 6:return w.fn.call(w.context,u,f,m,g,v),!0}for(E=1,_=new Array(x-1);E<x;E++)_[E-1]=arguments[E];w.fn.apply(w.context,_)}else{var C=w.length,k;for(E=0;E<C;E++)switch(w[E].once&&this.removeListener(c,w[E].fn,void 0,!0),x){case 1:w[E].fn.call(w[E].context);break;case 2:w[E].fn.call(w[E].context,u);break;case 3:w[E].fn.call(w[E].context,u,f);break;case 4:w[E].fn.call(w[E].context,u,f,m);break;default:if(!_)for(k=1,_=new Array(x-1);k<x;k++)_[k-1]=arguments[k];w[E].fn.apply(w[E].context,_)}}return!0},o.prototype.on=function(c,u,f){return i(this,c,u,f,!1)},o.prototype.once=function(c,u,f){return i(this,c,u,f,!0)},o.prototype.removeListener=function(c,u,f,m){var g=n?n+c:c;if(!this._events[g])return this;if(!u)return a(this,g),this;var v=this._events[g];if(v.fn)v.fn===u&&(!m||v.once)&&(!f||v.context===f)&&a(this,g);else{for(var b=0,w=[],x=v.length;b<x;b++)(v[b].fn!==u||m&&!v[b].once||f&&v[b].context!==f)&&w.push(v[b]);w.length?this._events[g]=w.length===1?w[0]:w:a(this,g)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(nC)),nC.exports}var aae=iae();const LR=Ni(aae);var j8;let oae=class extends LR{constructor(n){super();Ne(this,j8,"List");Ne(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,s=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const i=Array.from(this.data);i.splice(n,+s,r),this.data=new Set(i),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...s){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const i=Array.from(this.data),a=i.splice(n,r,...s);return this.data=new Set(i),this.emit("update"),a}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(j8=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function F6(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function Rr(e){throw e}const L6=Intl.NumberFormat("en",{notation:"compact"});L6.format.bind(L6);function zf(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function lae(e){try{return JSON.parse(e),!0}catch{return!1}}function ZT(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function BR(e){return e.at(0).toUpperCase()+e.slice(1)}const cae=new TextEncoder;function uf(e){return cae.encode(e)}const B6=new TextDecoder;function $R(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return B6.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),B6.decode(t)}function Z0(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=Z0(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function uae(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var dae={};let fae="process"in globalThis&&"env"in globalThis.process&&dae.U_DEBUG=="true";function Y0(...e){fae&&console.debug("[U]",...e)}const $6=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],hae=[...$6,...$6.map(e=>BR(e)),"char"],zR=/^(u?int|float)(8|16|32|64|128)$/i;function q9(e){return e=="char"?"uint8":e.toLowerCase()}function UR(e){return zR.test(e.toString())}function YT(e){return e=="char"||zR.test(e.toString().toLowerCase())}function pae(e){if(!YT(e))throw new TypeError("Not a valid primitive type: "+e)}const z6=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function V9(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function mae(e){return e!=null&&typeof e=="object"&&"struct"in e}function s_(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function Mo(e){return typeof e=="function"&&Symbol.metadata in e&&mae(e[Symbol.metadata])}function Yy(e){return e!=null&&typeof e=="object"&&Mo(e.constructor)}function H9(e){if(!Yy(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function qR(e){return Yy(e)||Mo(e)}function G9(e){if(!qR(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function VR(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function Jr(e){if(e==null)return 0;if(Array.isArray(e)){let s=0;for(let i=0;i<e.length;i++)s+=Jr(e[i]);return s}if(typeof e=="string")return pae(e),+q9(e).match(zR)[2]/8;if(VR(e))return e[Symbol.size];G9(e);const t=Mo(e)?e:e.constructor;s_(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(Mo(e))return r;for(const s of n.members.values()){const i=e[s.name];if(Yy(i)&&i.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,Jr(i)):r+=Jr(i);continue}if(typeof s.length!="string")continue;let a=0;for(let o=0;o<e[s.length];o++)a+=Jr(qR(i[o])?i[o]:s.type);n.isUnion?r=Math.max(r,a):r+=a}return r}function gae(e,t){var i;G9(e);const n=Mo(e)?e:e.constructor;s_(n);const{struct:r}=n[Symbol.metadata];if(Mo(e)||!r.isDynamic)return((i=r.members.get(t))==null?void 0:i.staticOffset)??Rr(new Error("Struct does not have member: "+t));let s=0;for(const a of r.members.values()){if(a.name==t)return s;const o=e[a.name];s+=Jr(qR(o)?o:a.type)}throw new Error("Struct does not have member: "+t)}function yae(e,t){return Math.ceil(e/t)*t}function Uf(e={}){return function(n,r){const s=new Map;let i=0,a=!1;for(const{name:o,type:l,length:c}of V9(r)){if(!YT(l)&&!Mo(l))throw new TypeError("Not a valid type: "+l);if(typeof c=="string"){const m=s.get(c);if(!m)throw new Error(`"${c}" is undefined or declared after "${o}"`);if(!UR(m.type))throw new Error(`"${c}" is not a number and cannot be used to count "${o}"`)}let u=`${typeof l=="string"?l:l.name} ${o}`;c!==void 0&&(u+=`[${c}]`),s.set(o,{name:o,staticOffset:e.isUnion?0:i,type:YT(l)?q9(l):l,length:c,decl:u});const f=typeof c=="string"||Mo(l)&&l[Symbol.metadata].struct.isDynamic?0:Jr(l)*(c||1);a||(a=Mo(l)?l[Symbol.metadata].struct.isDynamic:typeof c=="string"),i=e.isUnion?Math.max(i,f):i+f,i=yae(i,e.align||1),Y0("define",n.name+"."+o)}return r.metadata.struct={options:e,members:s,staticSize:i,isDynamic:a,isUnion:e.isUnion??!1},n}}function X0(e,t){return function(n,r){let s=r.name;if(typeof s=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+s.toString()),s=s.toString()),!s)throw new ReferenceError("Invalid name for struct member");return V9(r).push({name:s,type:e,length:t}),n}}function K9(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:Rr(new Error("Array lengths must be natural numbers"))}function ui(e){if(VR(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();H9(e),s_(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=Jr(e),s=new Uint8Array(r),i=new DataView(s.buffer);Y0("serialize",e.constructor.name);let a=0,o=0;for(const l of n.values()){const c=K9(e,l);Y0("	",l.decl);for(let u=0;u<Math.abs(c);u++){let f=c!=-1?e[l.name][u]:e[l.name];if(typeof f=="string"&&(f=f.charCodeAt(0)),a=o,o+=Yy(f)?Jr(f):Jr(l.type),!UR(l.type)){s.set(f?ui(f):new Uint8Array(Jr(l.type)),a);continue}const m=`set${BR(l.type)}`;if(m=="setInt64"){i.setBigInt64(a,BigInt(f),!t.bigEndian);continue}if(m=="setUint64"){i.setBigUint64(a,BigInt(f),!t.bigEndian);continue}if(m=="setInt128"){i.setBigUint64(a+(t.bigEndian?8:0),f&z6,!t.bigEndian),i.setBigInt64(a+(t.bigEndian?0:8),f>>BigInt(64),!t.bigEndian);continue}if(m=="setUint128"){i.setBigUint64(a+(t.bigEndian?8:0),f&z6,!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),f>>BigInt(64),!t.bigEndian);continue}if(m=="setFloat128"){i.setFloat64(a+(t.bigEndian?8:0),Number(f),!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}i[m](a,Number(f),!t.bigEndian)}}return s}function i_(e,t){const n=uae(t);if(VR(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);H9(e),s_(e.constructor);const{options:r,members:s}=e.constructor[Symbol.metadata].struct,i=new DataView(n.buffer,n.byteOffset,n.byteLength);Y0("deserialize",e.constructor.name);let a=0,o=0;for(const l of s.values()){const c=K9(e,l);Y0("	",l.decl);for(let u=0;u<Math.abs(c);u++){let f=c!=-1?e[l.name]:e;const m=c!=-1?u:l.name,g=f[m]===null||f[m]===void 0,v=g&&Mo(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(a=o,!Yy(f[m])&&!v&&(o+=Jr(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,u)+String.fromCharCode(i.getUint8(a))+e[l.name].slice(u+1);continue}if(!UR(l.type)){if(v&&Mo(l.type))f[m]??(f[m]=new l.type);else if(g)continue;i_(f[m],new Uint8Array(n.subarray(a))),o+=Jr(f[m]);continue}c&&c!=-1&&(f||(f=[]));const b=`get${BR(l.type)}`;if(b=="getInt64"){f[m]=i.getBigInt64(a,!r.bigEndian);continue}if(b=="getUint64"){f[m]=i.getBigUint64(a,!r.bigEndian);continue}if(b=="getInt128"){f[m]=i.getBigInt64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getUint128"){f[m]=i.getBigUint64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getFloat128"){f[m]=i.getFloat64(a+(r.bigEndian?8:0),!r.bigEndian);continue}f[m]=i[b](a,!r.bigEndian)}}}function bae(e){function t(n,r){return typeof n=="number"||typeof n=="string"?X0(e,n):X0(e)(n,r)}return t}const Sn=Object.fromEntries(hae.map(e=>[e,bae(e)]));function vae(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const Uo={root:"/",pwd:"/",credentials:vae({uid:0,gid:0}),descriptors:new Map};function W9(e,t){let n="",r=0,s=-1,i=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if(a=="/")break;a="/"}if(a=="/"){if(!(s===o-1||i===1))if(i===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}else if(n.length!==0){n="",r=0,s=o,i=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,i=0}else a==="."&&i!==-1?++i:i=-1}return n}function Mc(...e){var t;let n="";for(const s of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:Uo.pwd])if(s!=null&&s.length&&(n=`${s}/${n}`,s.startsWith("/")))break;const r=n.startsWith("/");return n=W9(n,!r),r?`/${n}`:n.length?n:"/"}function wae(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=W9(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function _r(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?wae(t):"."}function Z9(e,t){if(e===t||(e=Mc.call(this,e),t=Mc.call(this,t),e===t))return"";const n=1,r=e.length,s=r-n,i=1,a=t.length-i,o=s<a?s:a;let l=-1,c=0;for(;c<o;c++){const f=e[n+c];if(f!==t[i+c])break;f==="/"&&(l=c)}if(c===o)if(a>o){if(t[i+c]==="/")return t.slice(i+c+1);if(c===0)return t.slice(i+c)}else s>o&&(e[n+c]==="/"?l=c:c===0&&(l=0));let u="";for(c=n+l+1;c<=r;++c)(c===r||e[c]==="/")&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(i+l)}`}function mr(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let s=e.length-1;s>=1;--s)if(e[s]==="/"){if(!r){n=s;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function Lp(e,t){let n=0,r=-1,s=!0;for(let i=e.length-1;i>=0;--i)if(e[i]==="/"){if(!s){n=i+1;break}}else r===-1&&(s=!1,r=i+1);return r===-1?"":e.slice(n,r)}function gl(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let s=-1,i=0,a=-1,o=!0,l=e.length-1,c=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){i=l+1;break}continue}a===-1&&(o=!1,a=l+1),e[l]==="."?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(a!==-1){const u=i===0&&t?1:i;s===-1||c===0||c===1&&s===a-1&&s===i+1?n.base=n.name=e.slice(u,a):(n.name=e.slice(u,s),n.base=e.slice(u,a),n.ext=e.slice(s,a))}return i>0?n.dir=e.slice(0,i-1):t&&(n.dir="/"),n}var xn;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(xn||(xn={}));xn.EMERG+"",xn.ALERT+"",xn.CRIT+"",xn.ERR+"",xn.WARN+"",xn.NOTICE+"",xn.INFO+"",xn.DEBUG+"";const xae=new oae;function _ae(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};xae.add(n),Nae(n)}function Sae(e,t){var n,r;if(!(e instanceof Ve))return e.toString();const s=e.code+": "+e.message;if(!e.path)return s;const i=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return s+": "+_r(i,e.path)}function md(e){return function(t,n={}){return _ae(e,Sae(t,n)),t}}md(xn.EMERG);const Eae=md(xn.ALERT),a_=md(xn.CRIT),ra=md(xn.ERR),Ei=md(xn.WARN),HR=md(xn.NOTICE),Y9=md(xn.INFO),f0=md(xn.DEBUG);function Cae(e,t){return`\x1B[${t}m${e}\x1B[0m`}function kae(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[Cae(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}xn.EMERG+"",xn.ALERT+"",xn.CRIT+"",xn.ERR+"",xn.WARN+"",xn.NOTICE+"",xn.INFO+"",xn.DEBUG+"",xn.EMERG+"",xn.ALERT+"",xn.CRIT+"",xn.ERR+"",xn.WARN+"",xn.NOTICE+"",xn.INFO+"",xn.DEBUG+"";xn.EMERG+"",xn.ALERT+"",xn.CRIT+"",xn.ERR+"",xn.WARN+"",xn.NOTICE+"",xn.INFO+"",xn.DEBUG+"",xn.EMERG+"",xn.ALERT+"",xn.CRIT+"",xn.ERR+"",xn.WARN+"",xn.NOTICE+"",xn.INFO+"",xn.DEBUG+"";let Tae=e=>[...kae(e),e.message];function Aae(e){const t=Tae(e);return typeof t=="string"?[t]:Array.from(t)}let Rae=console.error;function Nae(e){e.level>Iae||Rae(...Aae(e))}let Iae=xn.ALERT;function GR(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function jae(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function Mae(e,t){if(typeof t!="object"||t===null)throw ra(new Ve(ut.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const s=t==null?void 0:t[n];if(s==null){if(!r.required){f0("Using default for option: "+n);continue}throw ra(new Ve(ut.EINVAL,"Missing required option: "+n))}const i=(c,u=s)=>{var f;return typeof c=="function"?Symbol.hasInstance in c&&c.prototype?s instanceof c:c(s):typeof s===c||((f=s==null?void 0:s.constructor)===null||f===void 0?void 0:f.name)===c};if(Array.isArray(r.type)?r.type.some(c=>i(c)):i(r.type))continue;const a=typeof s=="object"&&"constructor"in s?s.constructor.name:typeof s,o=c=>typeof c=="function"?c.name!="type"?c.name:c.toString():c,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw ra(new Ve(ut.EINVAL,`Incorrect type for "${n}": ${a} (expected ${l})`))}}function X9(e){return e!=null&&typeof e=="object"&&"backend"in e&&GR(e.backend)}const KR=0,Bs=4,fs=2,Zw=1,WR=1,Oae=2,Pae=4,J9=0,Si=1,_c=2,o_=64,l_=128,Dae=256,c_=512,jf=1024,Fae=65536,Lae=262144,Bae=131072,u_=1052672,$ae=4096,zae=32768,Uae=16384,qae=2048,Fr=61440,qf=49152,zc=40960,Oo=32768,Vf=24576,Is=16384,Hf=8192,Gf=4096,Xy=2048,Jy=1024,Vae=512,Hae=448,Q9=256,eB=128,tB=64,Gae=56,nB=32,rB=16,sB=8,Kae=7,iB=4,aB=2,oB=1,Wae=0,Vi=4294967295,lB=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:WR,COPYFILE_FICLONE:Oae,COPYFILE_FICLONE_FORCE:Pae,F_OK:KR,O_APPEND:jf,O_CREAT:o_,O_DIRECT:Uae,O_DIRECTORY:Fae,O_DSYNC:$ae,O_EXCL:l_,O_NOATIME:Lae,O_NOCTTY:Dae,O_NOFOLLOW:Bae,O_NONBLOCK:qae,O_RDONLY:J9,O_RDWR:_c,O_SYMLINK:zae,O_SYNC:u_,O_TRUNC:c_,O_WRONLY:Si,R_OK:Bs,S_IFBLK:Vf,S_IFCHR:Hf,S_IFDIR:Is,S_IFIFO:Gf,S_IFLNK:zc,S_IFMT:Fr,S_IFREG:Oo,S_IFSOCK:qf,S_IRGRP:nB,S_IROTH:iB,S_IRUSR:Q9,S_IRWXG:Gae,S_IRWXO:Kae,S_IRWXU:Hae,S_ISGID:Jy,S_ISUID:Xy,S_ISVTX:Vae,S_IWGRP:rB,S_IWOTH:aB,S_IWUSR:eB,S_IXGRP:sB,S_IXOTH:oB,S_IXUSR:tB,UV_FS_O_FILEMAP:Wae,W_OK:fs,X_OK:Zw,size_max:Vi},Symbol.toStringTag,{value:"Module"})),lw=BigInt(1e3);class cB{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:s,uid:i,gid:a,size:o,mode:l,ino:c,...u}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const f=Date.now();this.atimeMs=this._convert(t??f),this.mtimeMs=this._convert(n??f),this.ctimeMs=this._convert(r??f),this.birthtimeMs=this._convert(s??f),this.uid=this._convert(i??0),this.gid=this._convert(a??0),this.size=this._convert(o??0),this.ino=this._convert(c??0),this.mode=this._convert(l??420&Oo),(this.mode&Fr)==0&&(this.mode=this.mode|this._convert(Oo)),Object.assign(this,u)}isFile(){return(this.mode&Fr)===Oo}isDirectory(){return(this.mode&Fr)===Is}isSymbolicLink(){return(this.mode&Fr)===zc}isSocket(){return(this.mode&Fr)===qf}isBlockDevice(){return(this.mode&Fr)===Vf}isCharacterDevice(){return(this.mode&Fr)===Hf}isFIFO(){return(this.mode&Fr)===Gf}toJSON(){return zf(this,XT)}hasAccess(t,n){return Cr(n,this._isBigint?new Uc(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*lw}get mtimeNs(){return BigInt(this.mtimeMs)*lw}get ctimeNs(){return BigInt(this.ctimeMs)*lw}get birthtimeNs(){return BigInt(this.birthtimeMs)*lw}}function uB(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<Vi?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<Vi?e.gid=n:r=!1,r}class Uc extends cB{constructor(){super(...arguments),this._isBigint=!1}}class Kf extends cB{constructor(){super(...arguments),this._isBigint=!0}}function Zae(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class Yae{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=Vi,this.ffree=Vi}}class Xae{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(Vi),this.ffree=BigInt(Vi)}}var Vr=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),f,m=!1,g=n.length-1;g>=0;g--){var v={};for(var b in r)v[b]=b==="access"?{}:r[b];for(var b in r.access)v.access[b]=r.access[b];v.addInitializer=function(x){if(m)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var w=(0,n[g])(o==="accessor"?{get:u.get,set:u.set}:u[l],v);if(o==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(f=a(w.get))&&(u.get=f),(f=a(w.set))&&(u.set=f),(f=a(w.init))&&s.unshift(f)}else(f=a(w))&&(o==="field"?s.unshift(f):u[l]=f)}c&&Object.defineProperty(c,r.name,u),m=!0},wn=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},ZR=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const _a=0,Jae=1024;let U6=(()=>{var e,t;let n=[Uf()],r,s=[],i,a,o=[],l=[],c,u=[],f=[],m,g=[],v=[],b,w=[],x=[];return i=class{get key(){return this._key}set key(_){this._key=_,this.keySize=_.length}get value(){return this._value.subarray(0,this.valueSize)}set value(_){this._value=_,this.valueSize=_.length}constructor(_,E){this.keySize=wn(this,o,0),this.valueSize=(wn(this,l),wn(this,u,0)),this._key=(wn(this,f),wn(this,g,"")),this._value=(wn(this,v),wn(this,w,new Uint8Array(Jae))),wn(this,x),_&&(this.key=_),E&&(this.value=E)}},ZR(i,"Attribute"),(()=>{const _=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;a=[(e=Sn).uint32.bind(e)],c=[(t=Sn).uint32.bind(t)],m=[Sn.char("keySize")],b=[Sn.uint8("valueSize")],Vr(null,null,a,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:E=>"keySize"in E,get:E=>E.keySize,set:(E,C)=>{E.keySize=C}},metadata:_},o,l),Vr(null,null,c,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:E=>"valueSize"in E,get:E=>E.valueSize,set:(E,C)=>{E.valueSize=C}},metadata:_},u,f),Vr(null,null,m,{kind:"field",name:"_key",static:!1,private:!1,access:{has:E=>"_key"in E,get:E=>E._key,set:(E,C)=>{E._key=C}},metadata:_},g,v),Vr(null,null,b,{kind:"field",name:"_value",static:!1,private:!1,access:{has:E=>"_value"in E,get:E=>E._value,set:(E,C)=>{E._value=C}},metadata:_},w,x),Vr(null,r={value:i},n,{kind:"class",name:i.name,metadata:_},null,s),i=r.value,_&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_}),wn(i,s)})(),i})(),Qu=(()=>{var e;let t=[Uf()],n,r=[],s,i,a=[],o=[],l,c=[],u=[];return s=class{has(f){return this.data.some(m=>m.key==f)}get(f){return this.data.find(m=>m.key==f)}set(f,m){const g=this.get(f);if(g){g.value=m;return}this.data.push(new U6(f,m)),this.size++}remove(f){const m=this.data.findIndex(g=>g.key==f);return m===-1?!1:(this.data.splice(m,1),this.size--,!0)}keys(){return this.data.map(f=>f.key)}values(){return this.data.map(f=>f.value)}entries(){return this.data.map(f=>[f.key,f.value])}constructor(){this.size=wn(this,a,0),this.data=(wn(this,o),wn(this,c,[])),wn(this,u)}},ZR(s,"Attributes"),(()=>{const f=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[(e=Sn).uint32.bind(e)],l=[X0(U6,"size")],Vr(null,null,i,{kind:"field",name:"size",static:!1,private:!1,access:{has:m=>"size"in m,get:m=>m.size,set:(m,g)=>{m.size=g}},metadata:f},a,o),Vr(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:m=>"data"in m,get:m=>m.data,set:(m,g)=>{m.data=g}},metadata:f},c,u),Vr(null,n={value:s},t,{kind:"class",name:s.name,metadata:f},null,r),s=n.value,f&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:f}),wn(s,r)})(),s})();const XT=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],Qae=4;var sa;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})(sa||(sa={}));let Rs=(()=>{var e,t,n,r,s,i,a,o,l,c,u,f,m,g,v,b;let w=[Uf()],x,_=[],E,C,k=[],R=[],I,j=[],M=[],L,q=[],P=[],V,z=[],re=[],K,ee=[],W=[],se,Y=[],te=[],Q,ae=[],xe=[],ge,Me=[],Pe=[],Ie,Ce=[],He=[],it,Ge=[],Re=[],H,me=[],Te=[],ce,oe=[],ne=[],Se,Fe=[],ke=[],Xe,St=[],ht=[],It,Vt=[],Ot=[],Gt,be=[],O=[],Z,fe=[],Oe=[],ve,Ae=[],ue=[];var mt=E=class{constructor(wt){if(this.data=wn(this,k,ZT(0,Vi)),this.__data_old=(wn(this,R),wn(this,j,0)),this.size=(wn(this,M),wn(this,q,0)),this.mode=(wn(this,P),wn(this,z,0)),this.nlink=(wn(this,re),wn(this,ee,1)),this.uid=(wn(this,W),wn(this,Y,0)),this.gid=(wn(this,te),wn(this,ae,0)),this.atimeMs=(wn(this,xe),wn(this,Me,Date.now())),this.birthtimeMs=(wn(this,Pe),wn(this,Ce,Date.now())),this.mtimeMs=(wn(this,He),wn(this,Ge,Date.now())),this.ctimeMs=(wn(this,Re),wn(this,me,Date.now())),this.ino=(wn(this,Te),wn(this,oe,ZT(0,Vi))),this.__ino_old=(wn(this,ne),wn(this,Fe,0)),this.flags=(wn(this,ke),wn(this,St,0)),this.__after_flags=(wn(this,ht),wn(this,Vt,0)),this.version=(wn(this,Ot),wn(this,be,0)),this.__padding=(wn(this,O),wn(this,fe,[])),this.attributes=(wn(this,Oe),wn(this,Ae,new Qu)),wn(this,ue),!!wt){if(!("byteLength"in wt)){Object.assign(this,wt);return}if(wt.byteLength<Jr(mt))throw a_(new Ve(ut.EIO,"Buffer is too small to create an inode"));i_(this,wt)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...zf(this,XT),attributes:this.attributes}}toStats(){return new Uc(this)}update(wt){if(!wt)return!1;let B=!1;for(const ze of XT)wt[ze]!==void 0&&(ze=="ino"||ze=="data"||this[ze]!==wt[ze]&&(ze=="atimeMs"&&this.flags&sa.NoAtime||(this[ze]=wt[ze],B=!0)));return wt.attributes&&(this.attributes=wt.attributes,B=!0),B&&(this.ctimeMs=Date.now()),B}};return ZR(E,"Inode"),(()=>{const wt=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;C=[(e=Sn).uint32.bind(e)],I=[(t=Sn).uint32.bind(t)],L=[(n=Sn).uint32.bind(n)],V=[(r=Sn).uint16.bind(r)],K=[(s=Sn).uint32.bind(s)],se=[(i=Sn).uint32.bind(i)],Q=[(a=Sn).uint32.bind(a)],ge=[(o=Sn).float64.bind(o)],Ie=[(l=Sn).float64.bind(l)],it=[(c=Sn).float64.bind(c)],H=[(u=Sn).float64.bind(u)],ce=[(f=Sn).uint32.bind(f)],Se=[(m=Sn).uint32.bind(m)],Xe=[(g=Sn).uint32.bind(g)],It=[(v=Sn).uint16.bind(v)],Gt=[(b=Sn).uint32.bind(b)],Z=[Sn.uint8(48)],ve=[X0(Qu)],Vr(null,null,C,{kind:"field",name:"data",static:!1,private:!1,access:{has:B=>"data"in B,get:B=>B.data,set:(B,ze)=>{B.data=ze}},metadata:wt},k,R),Vr(null,null,I,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:B=>"__data_old"in B,get:B=>B.__data_old,set:(B,ze)=>{B.__data_old=ze}},metadata:wt},j,M),Vr(null,null,L,{kind:"field",name:"size",static:!1,private:!1,access:{has:B=>"size"in B,get:B=>B.size,set:(B,ze)=>{B.size=ze}},metadata:wt},q,P),Vr(null,null,V,{kind:"field",name:"mode",static:!1,private:!1,access:{has:B=>"mode"in B,get:B=>B.mode,set:(B,ze)=>{B.mode=ze}},metadata:wt},z,re),Vr(null,null,K,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:B=>"nlink"in B,get:B=>B.nlink,set:(B,ze)=>{B.nlink=ze}},metadata:wt},ee,W),Vr(null,null,se,{kind:"field",name:"uid",static:!1,private:!1,access:{has:B=>"uid"in B,get:B=>B.uid,set:(B,ze)=>{B.uid=ze}},metadata:wt},Y,te),Vr(null,null,Q,{kind:"field",name:"gid",static:!1,private:!1,access:{has:B=>"gid"in B,get:B=>B.gid,set:(B,ze)=>{B.gid=ze}},metadata:wt},ae,xe),Vr(null,null,ge,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:B=>"atimeMs"in B,get:B=>B.atimeMs,set:(B,ze)=>{B.atimeMs=ze}},metadata:wt},Me,Pe),Vr(null,null,Ie,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:B=>"birthtimeMs"in B,get:B=>B.birthtimeMs,set:(B,ze)=>{B.birthtimeMs=ze}},metadata:wt},Ce,He),Vr(null,null,it,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:B=>"mtimeMs"in B,get:B=>B.mtimeMs,set:(B,ze)=>{B.mtimeMs=ze}},metadata:wt},Ge,Re),Vr(null,null,H,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:B=>"ctimeMs"in B,get:B=>B.ctimeMs,set:(B,ze)=>{B.ctimeMs=ze}},metadata:wt},me,Te),Vr(null,null,ce,{kind:"field",name:"ino",static:!1,private:!1,access:{has:B=>"ino"in B,get:B=>B.ino,set:(B,ze)=>{B.ino=ze}},metadata:wt},oe,ne),Vr(null,null,Se,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:B=>"__ino_old"in B,get:B=>B.__ino_old,set:(B,ze)=>{B.__ino_old=ze}},metadata:wt},Fe,ke),Vr(null,null,Xe,{kind:"field",name:"flags",static:!1,private:!1,access:{has:B=>"flags"in B,get:B=>B.flags,set:(B,ze)=>{B.flags=ze}},metadata:wt},St,ht),Vr(null,null,It,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:B=>"__after_flags"in B,get:B=>B.__after_flags,set:(B,ze)=>{B.__after_flags=ze}},metadata:wt},Vt,Ot),Vr(null,null,Gt,{kind:"field",name:"version",static:!1,private:!1,access:{has:B=>"version"in B,get:B=>B.version,set:(B,ze)=>{B.version=ze}},metadata:wt},be,O),Vr(null,null,Z,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:B=>"__padding"in B,get:B=>B.__padding,set:(B,ze)=>{B.__padding=ze}},metadata:wt},fe,Oe),Vr(null,null,ve,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:B=>"attributes"in B,get:B=>B.attributes,set:(B,ze)=>{B.attributes=ze}},metadata:wt},Ae,ue),Vr(null,x={value:E},w,{kind:"class",name:E.name,metadata:wt},null,_),mt=E=x.value,wt&&Object.defineProperty(E,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:wt}),wn(E,_)})(),mt=E})();function eoe(e){return(e.mode&Fr)===Oo}function Bo(e){return(e.mode&Fr)===Is}function Bp(e){return(e.mode&Fr)===zc}function toe(e){return(e.mode&Fr)===qf}function J0(e){return(e.mode&Fr)===Vf}function Q0(e){return(e.mode&Fr)===Hf}function noe(e){return(e.mode&Fr)===Gf}function Cr(e,t,n){const r=(e==null?void 0:e.credentials)||Uo.credentials;if(Bp(t)||r.euid===0||r.egid===0)return!0;let s=0;return r.uid===t.uid&&(t.mode&Q9&&(s|=Bs),t.mode&eB&&(s|=fs),t.mode&tB&&(s|=Zw)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&nB&&(s|=Bs),t.mode&rB&&(s|=fs),t.mode&sB&&(s|=Zw)),t.mode&iB&&(s|=Bs),t.mode&aB&&(s|=fs),t.mode&oB&&(s|=Zw),(s&n)===n}const q6=1;class zx extends Map{constructor(){super(...arguments),this.maxSize=Vi}toJSON(){return{version:q6,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*Jr(Rs);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Ve.With("ENOENT",t);if((n.mode&Fr)!=Is)throw Ve.With("ENOTDIR",t);const r={};for(const s of this.keys())mr(s)==t&&s!=t&&(r[Lp(s)]=this.get(s).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&Fr)!=Is)continue;const s={};for(const i of this.keys())mr(i)==n&&i!=n&&(s[Lp(i)]=this.get(i).ino);t.set(n,s)}return t}fromJSON(t){var n;if(t.version!=q6)throw new Ve(ut.EINVAL,"Index version mismatch");this.clear();for(const[r,s]of Object.entries(t.entries))(n=s.data)!==null&&n!==void 0||(s.data=ZT(1,Vi)),r=="/"&&(s.ino=0),this.set(r,new Rs(s));return this}static parse(t){if(!lae(t))throw new Ve(ut.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new zx;return r.fromJSON(n),r}}const rC=4096;let YR=class JT{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===JT.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===JT.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:s}=await this.stat(t),{start:i=0,end:a=s}=n;for(let o=i;o<a;o+=rC){const l=o+rC>a?a-o:rC,c=new Uint8Array(l);await this.read(t,c,o,o+l).catch(r.error.bind(r)),r.enqueue(c)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let s=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(i,a)=>{let o=!1;const l=u=>{o=!0,a.error(u)},{size:c}=await this.stat(t);await this.write(t,i,s).catch(l),!o&&(s+=i.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(c,s)}).catch(l))}})}};function Li(e){return JSON.parse($R(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function Ha(e){return uf(JSON.stringify(e))}function gd(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Ve(ut.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function Ux(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Ve(ut.EINVAL,"Invalid time.")}}function hn(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Ve(ut.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Ve(ut.EINVAL,"Path can not contain null character");if(e.length==0)throw new Ve(ut.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:Mc(e)}function Sc(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:gd("mode"in e?e==null?void 0:e.mode:null,r)}}class roe{constructor(t,n,r,s){Ne(this,"id");Ne(this,"_size");Ne(this,"options");Ne(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),s==null||s.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const s=t-r.offset;r.data.byteLength>s&&(r.data=r.data.subarray(0,s)),r.ranges=r.ranges.filter(i=>i.start<t).map(i=>i.end>t?{start:i.start,end:t}:i)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],s=this.regions[n+1];if(s.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...s.ranges),r.ranges.sort((i,a)=>i.start-a.start),r.ranges=r.ranges.reduce((i,a)=>(!i.length||i.at(-1).end<a.start?i.push(a):i.at(-1).end=Math.max(i.at(-1).end,a.end),i),[]),r.data=Z0(r.data,s.offset+s.data.byteLength),r.data.set(s.data,s.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const s of this.regions){if(s.offset>=n)break;for(const i of s.ranges)if(!(i.end<=t)&&(i.start>=n||(i.start>t&&r.push({start:t,end:Math.min(i.start,n)}),i.end>t&&(t=Math.max(t,i.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const a of i.ranges)if(!(a.end<=t)){if(a.start>=n)break;r.push({start:Math.max(t,a.start),end:Math.min(n,a.end)})}}r.sort((i,a)=>i.start-a.start);const s=[];for(const i of r){const a=s.at(-1);a&&i.start<=a.end?a.end=Math.max(a.end,i.end):s.push(i)}return s}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,s=this.regionAt(n);if(s)return s.data=Z0(s.data,r),s.data.set(t,n),s.ranges.push({start:n,end:r}),s.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const i={data:t,offset:n,ranges:[{start:n,end:r}]},a=this.regions.findIndex(o=>o.offset>n);return a==-1?this.regions.push(i):this.regions.splice(a,0,i),this.collect(),this}}var sC,iC,aC;(sC=Promise.withResolvers)!==null&&sC!==void 0||(Promise.withResolvers=(Ei("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}));(iC=Symbol.dispose)!==null&&iC!==void 0||(Symbol.dispose=(Ei("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(aC=Symbol.asyncDispose)!==null&&aC!==void 0||(Symbol.asyncDispose=(Ei("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class dB{constructor(t){this.store=t}}class soe extends dB{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class QT extends dB{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,s;(r=(s=this.store).cache)!==null&&r!==void 0||(s.cache=new Map);const i=this.store.cache.get(t);return i?(n&&(i.size=n.size),i):n?new roe(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var s;const i=this._cached(t);if(!i)return;r??(r=i.size);const a=i.missing(n,r);for(const{start:l,end:c}of a)this.async(this.get(t,l,c));if(a.length)throw ra(Ve.With("EAGAIN",(s=this.store._fs)===null||s===void 0?void 0:s._path(t)));const o=i.regionAt(n);if(!o){Ei("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class ioe{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const s=await this.raw.get(t,n,r);return this.stash(t),s}getSync(t,n=0,r){const s=this.raw.getSync(t,n,r);return this.stash(t),s}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,s),n)}catch(i){if(!(this.raw instanceof QT))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,s),n)}catch(i){if(!(this.raw instanceof QT))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var Ur=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},qr=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class fB extends YR{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[s,i]of this._ids){const a=Z9(t,s);if(a.startsWith(".."))continue;let o=_r(n,a);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:s,newKey:o,ino:i})}for(const{oldKey:s,newKey:i,ino:a}of r){this._ids.delete(s),this._ids.set(i,a);const o=this._paths.get(a);if(!o){Ei("Missing paths in table for ino "+a);continue}o.delete(s),o.add(i)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,s;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,f0(this.name+": supports features: "+((s=this.store.flags)===null||s===void 0?void 0:s.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ur(n,this.transaction(),!0),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),await r.set(a.ino,ui(a)),s.has(i)&&await r.set(a.data,Ha(s.get(i)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=qr(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ur(n,this.transaction(),!1),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),r.setSync(a.ino,ui(a)),s.has(i)&&r.setSync(a.data,Ha(s.get(i)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{qr(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new zx,s=Ur(n,this.transaction(),!0),i=[["/",0]],a=F6(Ve.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Rs(await s.get(l));if(r.set(o,c),c.mode&Is){const u=Li((t=await s.get(c.data))!==null&&t!==void 0?t:Rr(Ve.With("ENODATA",o)));for(const[f,m]of Object.entries(u))i.push([_r(o,f),m])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=qr(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new zx,s=Ur(n,this.transaction(),!1),i=[["/",0]],a=F6(Ve.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Rs(s.getSync(l));if(r.set(o,c),c.mode&Is){const u=Li((t=s.getSync(c.data))!==null&&t!==void 0?t:Rr(Ve.With("ENODATA",o)));for(const[f,m]of Object.entries(u))i.push([_r(o,f),m])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{qr(n)}}async rename(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ur(a,this.transaction(),!0),l=gl(t),c=gl(n),u=await this.findInode(o,l.dir,"rename"),f=Li((r=await o.get(u.data))!==null&&r!==void 0?r:Rr(Ve.With("ENODATA",l.dir,"rename")));if(!f[l.base])throw Ve.With("ENOENT",t,"rename");const m=f[l.base];if(m!=this._ids.get(t)&&ra(`Ino mismatch while renaming ${t} to ${n}`),delete f[l.base],(c.dir+"/").startsWith(t+"/"))throw new Ve(ut.EBUSY,l.dir);const g=c.dir==l.dir,v=g?u:await this.findInode(o,c.dir,"rename"),b=g?f:Li((s=await o.get(v.data))!==null&&s!==void 0?s:Rr(Ve.With("ENODATA",c.dir,"rename")));if(b[c.base]){const w=new Rs((i=await o.get(b[c.base]))!==null&&i!==void 0?i:Rr(Ve.With("ENOENT",n,"rename")));if(!w.toStats().isFile())throw Ve.With("EPERM",n,"rename");await o.remove(w.data),await o.remove(b[c.base])}b[c.base]=m,await o.set(u.data,Ha(f)),await o.set(v.data,Ha(b)),await o.commit(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{const o=qr(a);o&&await o}}renameSync(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ur(a,this.transaction(),!1),l=gl(t),c=gl(n),u=this.findInodeSync(o,l.dir,"rename"),f=Li((r=o.getSync(u.data))!==null&&r!==void 0?r:Rr(Ve.With("ENODATA",l.dir,"rename")));if(!f[l.base])throw Ve.With("ENOENT",t,"rename");const m=f[l.base];if(m!=this._ids.get(t)&&ra(`Ino mismatch while renaming ${t} to ${n}`),delete f[l.base],(c.dir+"/").startsWith(t+"/"))throw new Ve(ut.EBUSY,l.dir);const g=c.dir===l.dir,v=g?u:this.findInodeSync(o,c.dir,"rename"),b=g?f:Li((s=o.getSync(v.data))!==null&&s!==void 0?s:Rr(Ve.With("ENODATA",c.dir,"rename")));if(b[c.base]){const w=new Rs((i=o.getSync(b[c.base]))!==null&&i!==void 0?i:Rr(Ve.With("ENOENT",n,"rename")));if(!w.toStats().isFile())throw Ve.With("EPERM",n,"rename");o.removeSync(w.data),o.removeSync(b[c.base])}b[c.base]=m,o.setSync(u.data,Ha(f)),o.setSync(v.data,Ha(b)),o.commitSync(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{qr(a)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ur(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=qr(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ur(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{qr(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ur(r,this.transaction(),!0),i=await this.findInode(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ui(i))),await s.commit()}catch(s){r.error=s,r.hasError=!0}finally{const s=qr(r);s&&await s}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ur(r,this.transaction(),!1),i=this.findInodeSync(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ui(i))),s.commitSync()}catch(s){r.error=s,r.hasError=!0}finally{qr(r)}}async createFile(t,n){return n.mode|=Oo,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=Oo,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Ve.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Ve.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=Is,await this.commitNew(t,n,uf("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=Is,this.commitNewSync(t,n,uf("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Ur(r,this.transaction(),!0),i=await this.findInode(s,t,"readdir");return Object.keys(Li((n=await s.get(i.data))!==null&&n!==void 0?n:Rr(Ve.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{const s=qr(r);s&&await s}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Ur(r,this.transaction(),!1),i=this.findInodeSync(s,t,"readdir");return Object.keys(Li((n=s.getSync(i.data))!==null&&n!==void 0?n:Rr(Ve.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{qr(r)}}async sync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Ur(s,this.transaction(),!0),a=await this.findInode(i,t,"sync");n&&await i.set(a.data,n),a.update(r)&&(this._add(a.ino,t),await i.set(a.ino,ui(a))),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=qr(s);i&&await i}}syncSync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Ur(s,this.transaction(),!1),a=this.findInodeSync(i,t,"sync");n&&i.setSync(a.data,n),a.update(r)&&(this._add(a.ino,t),i.setSync(a.ino,ui(a))),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{qr(s)}}async link(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Ur(s,this.transaction(),!0),a=mr(n),o=await this.findInode(i,a,"link"),l=Li((r=await i.get(o.data))!==null&&r!==void 0?r:Rr(Ve.With("ENOENT",a,"link"))),c=await this.findInode(i,t,"link");c.nlink++,l[Lp(n)]=c.ino,this._add(c.ino,n),await i.set(c.ino,ui(c)),await i.set(o.data,Ha(l)),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=qr(s);i&&await i}}linkSync(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Ur(s,this.transaction(),!1),a=mr(n),o=this.findInodeSync(i,a,"link"),l=Li((r=i.getSync(o.data))!==null&&r!==void 0?r:Rr(Ve.With("ENOENT",a,"link"))),c=this.findInodeSync(i,t,"link");c.nlink++,l[Lp(n)]=c.ino,this._add(c.ino,n),i.setSync(c.ino,ui(c)),i.setSync(o.data,Ha(l)),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{qr(s)}}async read(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ur(a,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const c=(i=await o.get(l.data,r,s))!==null&&i!==void 0?i:Rr(Ve.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&ra(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{const o=qr(a);o&&await o}}readSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ur(a,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const c=(i=o.getSync(l.data,r,s))!==null&&i!==void 0?i:Rr(Ve.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&ra(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{qr(a)}}async write(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Ur(i,this.transaction(),!0),o=await this.findInode(a,t,"write");let l=n;a.flag("partial")||(l=Z0((s=await a.get(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await a.set(o.data,l,r),this._add(o.ino,t),await a.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=qr(i);a&&await a}}writeSync(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Ur(i,this.transaction(),!1),o=this.findInodeSync(a,t,"write");let l=n;a.flag("partial")||(l=Z0((s=a.getSync(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),a.setSync(o.data,l,r),this._add(o.ino,t),a.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{qr(i)}}transaction(){return new ioe(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ur(t,this.transaction(),!0);if(await n.get(_a))return;const r=new Rs({ino:_a,data:1,mode:511|Is});await n.set(r.data,uf("{}")),this._add(_a,"/"),await n.set(_a,ui(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=qr(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ur(t,this.transaction(),!1);if(n.getSync(_a))return;const r=new Rs({ino:_a,data:1,mode:511|Is});n.setSync(r.data,uf("{}")),this._add(_a,"/"),n.setSync(_a,ui(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{qr(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){Ei("Attempted to populate tables after initialization");return}f0("Populating tables with existing store metadata");const n=Ur(t,this.transaction(),!0),r=await n.get(_a);if(!r){HR("Store does not have a root inode");const o=new Rs({ino:_a,data:1,mode:511|Is});await n.set(o.data,uf("{}")),this._add(_a,"/"),await n.set(_a,ui(o)),await n.commit();return}if(r.length<Jr(Rs)){a_("Store contains an invalid root inode. Refusing to populate tables");return}const s=new Set;let i=0;const a=[["/",_a]];for(;a.length>0;){i++;const[o,l]=a.shift();this._add(l,o);const c=await n.get(l);if(!c){Ei("Store is missing data for inode: "+l);continue}if(c.length<Jr(Rs)){Ei(`Invalid inode size for ino ${l}: ${c.length}`);continue}const u=new Rs(c);if((u.mode&Is)!=Is||s.has(l))continue;s.add(l);const f=await n.get(u.data);if(!f){Ei("Store is missing directory data: "+u.data);continue}const m=Li(f);for(const[g,v]of Object.entries(m))a.push([_r(o,g),v])}f0(`Added ${i} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=qr(t);n&&await n}}async findInode(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Ve.With("ENOENT",n,r);return new Rs((s=await t.get(i))!==null&&s!==void 0?s:Rr(Ve.With("ENOENT",n,r)))}findInodeSync(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Ve.With("ENOENT",n,r);return new Rs((s=t.getSync(i))!==null&&s!==void 0?s:Rr(Ve.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const s=this._lastID;if(s>Vi)throw ra(new Ve(ut.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(s,t),s}async commitNew(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ve.With("EEXIST",t,s);const o=Ur(a,this.transaction(),!0),{dir:l,base:c}=gl(t),u=await this.findInode(o,l,s),f=Li((i=await o.get(u.data))!==null&&i!==void 0?i:Rr(Ve.With("ENOENT",l,s)));if(f[c])throw Ve.With("EEXIST",t,s);const m=this.allocNew(t,s),g=new Rs({...n,ino:m,data:m+1,size:r.byteLength});return await o.set(g.ino,ui(g)),await o.set(g.data,r),f[c]=g.ino,await o.set(u.data,Ha(f)),await o.commit(),g}catch(o){a.error=o,a.hasError=!0}finally{const o=qr(a);o&&await o}}commitNewSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ve.With("EEXIST",t,s);const o=Ur(a,this.transaction(),!1),{dir:l,base:c}=gl(t),u=this.findInodeSync(o,l,s),f=Li((i=o.getSync(u.data))!==null&&i!==void 0?i:Rr(Ve.With("ENOENT",l,s)));if(f[c])throw Ve.With("EEXIST",t,s);const m=this.allocNew(t,s),g=new Rs({...n,ino:m,data:m+1,size:r.byteLength});return o.setSync(g.ino,ui(g)),o.setSync(g.data,r),f[c]=g.ino,o.setSync(u.data,Ha(f)),o.commitSync(),g}catch(o){a.error=o,a.hasError=!0}finally{qr(a)}}async remove(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Ur(i,this.transaction(),!0),{dir:l,base:c}=gl(t),u=await this.findInode(o,l,a),f=Li((r=await o.get(u.data))!==null&&r!==void 0?r:Rr(Ve.With("ENOENT",l,a)));if(!f[c])throw Ve.With("ENOENT",t,a);const m=f[c],g=new Rs((s=await o.get(m))!==null&&s!==void 0?s:Rr(Ve.With("ENOENT",t,a)));if(delete f[c],!n&&Bo(g))throw Ve.With("EISDIR",t,a);await o.set(u.data,Ha(f)),g.nlink>1?(g.update({nlink:g.nlink-1}),await o.set(g.ino,ui(g))):(await o.remove(g.data),await o.remove(m),this._remove(m)),await o.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=qr(i);a&&await a}}removeSync(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Ur(i,this.transaction(),!1),{dir:l,base:c}=gl(t),u=this.findInodeSync(o,l,a),f=Li((r=o.getSync(u.data))!==null&&r!==void 0?r:Rr(Ve.With("ENOENT",l,a))),m=f[c];if(!m)throw Ve.With("ENOENT",t,a);const g=new Rs((s=o.getSync(m))!==null&&s!==void 0?s:Rr(Ve.With("ENOENT",t,a)));if(delete f[c],!n&&Bo(g))throw Ve.With("EISDIR",t,a);o.setSync(u.data,Ha(f)),g.nlink>1?(g.update({nlink:g.nlink-1}),o.setSync(g.ino,ui(g))):(o.removeSync(g.data),o.removeSync(m),this._remove(m)),o.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{qr(i)}}}class aoe extends soe{async keys(){return this.store.keys()}async get(t){var n,r,s;return await((s=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&s!==void 0?s:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class ooe extends Map{constructor(t=Vi,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new aoe(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const loe={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new fB(new ooe(e,t));return n.checkRootSync(),n}},coe=loe;let $s=!0;class V6 extends LR{get cursor(){return this._cursor}constructor(t,n,r,s=!1){super(),this.input=t,this.output=n,this.terminal=s,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=i=>{if(!(this._paused||this._closed)){this._buffer+=typeof i=="string"?i:i.toString("utf8");for(let a=this._buffer.indexOf(`
`);a>=0;a=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,a);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(a+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;Ga(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;Ga(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);cw(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);cw(this.output,0),Ga(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const s=this.line.slice(0,r+1)+this.line.slice(this._cursor),i=r+1;this._renderLine(s),this._cursor=i,this._cursor=i,Ga(this.output,-s.length,0),Ga(this.output,i,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const s=Math.max(0,Math.min(this.line.length,this._cursor+r));if(s==this._cursor)return;Ga(this.output,r,0),this._cursor=s,this._cursor=s;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(Ga(this.output,-this._cursor,0),Ga(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);cw(this.output,0),Ga(this.output,0,0),this.output.write(this._prompt+r),this.line=r,Ga(this.output,-r.length,0),Ga(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&(cw(this.output,0),Ga(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const s=typeof n=="function"?n:r;if(this._closed||!this.output){s("");return}this.output.write(t),this.once("line",s)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return Ei("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return Ei("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",s=>n({value:s,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function uoe(e,t,n,r){return"input"in e?new V6(e.input,e.output,e.completer,e.terminal):new V6(e,t,n,r)}function cw(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function Ga(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class qx{get position(){return this.flag&jf?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,s,i,a){this.context=t,this.path=n,this.fs=r,this.internalPath=s,this.flag=i,this.inode=a,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&u_||this.inode.flags&sa.Sync)}sync(){if(this.closed)throw Ve.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Ve.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Ve.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ve.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Ve.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Ve.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&Si||this.flag&_c))throw new Ve(ut.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ve.With("EBADF",this.path,"write");if(!(this.flag&Si||this.flag&_c))throw new Ve(ut.EPERM,"File not opened with a writeable mode");if(this.inode.flags&sa.Immutable)throw new Ve(ut.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!Q0(this.inode)&&!J0(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,this.fs.writeSync(this.internalPath,a,s),this._isSync&&this.sync(),a.byteLength}read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ve.With("EBADF",this.path,"read");if(this.flag&Si)throw new Ve(ut.EPERM,"File not opened with a readable mode");this.inode.flags&sa.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!Q0(this.inode)&&!J0(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&this.sync(),i-s}chmod(t){if(this.closed)throw Ve.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>Fr?-61441:Fr)|t,(this._isSync||t>Fr)&&this.sync()}chown(t,n){if(this.closed)throw Ve.With("EBADF",this.path,"chown");this.dirty=!0,uB(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Ve.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Ve.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Ve.With("EBADF",this.path,"streamWrite");if(this.inode.flags&sa.Immutable)throw new Ve(ut.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function Vx(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:Uo.descriptors,s=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(s,e),s}function ji(e,t){var n;const s=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Uo.descriptors).get(t);if(!s)throw new Ve(ut.EBADF);return s}function hB(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Uo.descriptors).delete(t)}const doe=/[rwasx]{1,2}\+?/;function Ec(e){if(typeof e=="number")return e;if(!doe.test(e))throw new Ve(ut.EINVAL,"Invalid flag string: "+e);return foe(e)}function foe(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Ve(ut.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?J9:o_;return e.includes("w")&&(t|=c_),e.includes("a")&&(t|=jf),e.includes("+")?t|=_c:e.includes("r")||(t|=Si),e.includes("s")&&(t|=u_),e.includes("x")&&(t|=l_),t}function pB(e){let t=0;return e&Si||(t|=Bs),(e&Si||e&_c)&&(t|=fs),t}const ey=new Map;XR("/",coe.create({label:"root"}));function XR(e,t){if(e[0]!="/"&&(e="/"+e),e=Mc.call(this,e),ey.has(e))throw ra(new Ve(ut.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,ey.set(e,t),Y9(`Mounted ${t.name} on ${e}`),f0(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function mB(e){if(e[0]!="/"&&(e="/"+e),e=Mc.call(this,e),!ey.has(e)){Ei(e+" is already unmounted");return}ey.delete(e),HR("Unmounted "+e)}function Wn(e,t){const n=(t==null?void 0:t.root)||Uo.root;e=hn(_r(n,e));const r=[...ey].sort((s,i)=>s[0].length>i[0].length?-1:1);for(const[s,i]of r)if(poe(s,e))return e=e.slice(s.length>1?s.length:0),e===""&&(e=n),{fs:i,path:e,mountPoint:s,root:n};throw Eae(new Ve(ut.EIO,"No file system",e))}function oC(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function kr(e,t){typeof e.stack=="string"&&(e.stack=oC(e.stack,t));try{e.message=oC(e.message,t)}catch{}return e.path&&(e.path=oC(e.path,t)),e}function gB(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||Vi),files:(t?BigInt:Number)(n.totalNodes||Vi),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function hoe(e){var t,n,r,s,i,a,o;const l=this!==null&&this!==void 0?this:Uo;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((s=l.credentials)===null||s===void 0?void 0:s.egid)!==0)throw new Ve(ut.EPERM,"Can not chroot() as non-root user");(i=l.root)!==null&&i!==void 0||(l.root="/");const c=_r(l.root,e);for(const u of(o=(a=l.descriptors)===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[]){if(!u.path.startsWith(l.root))throw Ve.With("EBUSY",u.path,"chroot");u.path=u.path.slice(l.root.length)}if(c.length>l.root.length)throw new Ve(ut.EPERM,"Can not chroot() outside of current root");l.root=c}function poe(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class yB extends LR{off(t,n,r,s){return super.off(t,n,r,s)}removeListener(t,n,r,s){return super.removeListener(t,n,r,s)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Ve.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Ve.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Ve.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Ve.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Ve.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class bB extends yB{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?_r(t.root,n):n,goe(this.realpath,this)}close(){super.emit("close"),yoe(this.realpath,this)}[Symbol.dispose](){this.close()}}class moe extends yB{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=ed(this.path);Zae(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=ed(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const Du=new Map;function goe(e,t){const n=hn(e);Du.has(n)||Du.set(n,new Set),Du.get(n).add(t)}function yoe(e,t){const n=hn(e);Du.has(n)&&(Du.get(n).delete(t),Du.get(n).size===0&&Du.delete(n))}function hi(e,t,n){var r;e&&(n=_r((r=e.root)!==null&&r!==void 0?r:"/",n)),n=hn(n);for(let s=n;s!="/";s=mr(s)){const i=Du.get(s);if(i)for(const a of i)a.emit("change",t,Z9.call(a._context,s,n)||Lp(n))}}var Qy=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},eb=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function boe(e,t){e=hn(e),t=hn(t);const n=Wn(e,this),r=Wn(t,this);if(!ed.call(this,mr(e)).hasAccess(fs,this))throw Ve.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),hi(this,"rename",e.toString()),hi(this,"change",t.toString());return}nN.call(this,t,tN(e)),eN.call(this,e),hi(this,"rename",e.toString())}catch(s){throw kr(s,{[n.path]:e,[r.path]:t})}}function JR(e){e=hn(e);try{const{fs:t,path:n}=Wn(yd.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==ut.ENOENT)return!1;throw t}}function ed(e,t){e=hn(e);const{fs:n,path:r}=Wn(yd.call(this,e),this);try{const s=n.statSync(r);if($s&&!Cr(this,s,Bs))throw Ve.With("EACCES",r,"stat");return t!=null&&t.bigint?new Kf(s):new Uc(s)}catch(s){throw kr(s,{[r]:e})}}function QR(e,t){e=hn(e);const{fs:n,path:r}=Wn(e,this);try{const s=n.statSync(r);if($s&&!Cr(this,s,Bs))throw Ve.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Kf(s):new Uc(s)}catch(s){throw kr(s,{[r]:e})}}function voe(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=Qy(n,Wf.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Ve(ut.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{eb(n)}}function eN(e){e=hn(e);const{fs:t,path:n}=Wn(e,this);try{if($s&&!Cr(this,t.statSync(n),fs))throw Ve.With("EACCES",n,"unlink");t.unlinkSync(n),hi(this,"rename",e.toString())}catch(r){throw kr(r,{[n]:e})}}function Wf(e,t){var n;e=hn(e);const r=gd(t.mode,420),s=Ec(t.flag);e=t.preserveSymlinks?e:yd.call(this,e);const{fs:i,path:a}=Wn(e,this);let o;try{o=i.statSync(a)}catch{}if(!o){if(!(s&o_))throw Ve.With("ENOENT",e,"_open");const c=i.statSync(mr(a));if(!Cr(this,c,fs))throw Ve.With("EACCES",mr(e),"_open");if(!Bo(c))throw Ve.With("ENOTDIR",mr(e),"_open");if(!t.allowDirectory&&r&Is)throw Ve.With("EISDIR",e,"_open");if(!Cr(this,c,fs))throw Ve.With("EACCES",mr(a),"_open");const{euid:u,egid:f}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Uo.credentials,m=i.createFileSync(a,{mode:r,uid:c.mode&Xy?c.uid:u,gid:c.mode&Jy?c.gid:f});return new qx(this,e,i,a,s,m)}if(!Cr(this,o,r)||!Cr(this,o,pB(s)))throw Ve.With("EACCES",e,"_open");if(s&l_)throw Ve.With("EEXIST",e,"_open");const l=new qx(this,e,i,a,s,o);if(s&c_&&l.truncate(0),!t.allowDirectory&&o.mode&Is)throw Ve.With("EISDIR",e,"_open");return l}function d_(e,t,n=KR){return Vx(Wf.call(this,e,{flag:t,mode:n}))}function f_(e,t,n){return Vx(Wf.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function vB(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Qy(r,typeof e=="number"?ji(this,e):Wf.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:i}=s.stat(),a=new Uint8Array(i);return s.read(a,0,i,0),a}catch(s){r.error=s,r.hasError=!0}finally{eb(r)}}function tN(e,t={}){const n=Sc(t,null,"r",420);if(Ec(n.flag)&Si)throw new Ve(ut.EINVAL,"Flag passed to readFile must allow for reading");const s=Gr.from(vB.call(this,e,n.flag,!1));return n.encoding?s.toString(n.encoding):s}function nN(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Sc(n,"utf8","w+",420),i=Ec(s.flag);if(!(i&Si||i&_c))throw new Ve(ut.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!s.encoding)throw new Ve(ut.EINVAL,"Encoding not specified");const a=typeof t=="string"?Gr.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Ve(ut.EINVAL,"Data not specified");Qy(r,typeof e=="number"?ji(this,e):Wf.call(this,e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength,0),hi(this,"change",e.toString())}catch(s){r.error=s,r.hasError=!0}finally{eb(r)}}function woe(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Sc(n,"utf8","a+",420),i=Ec(s.flag);if(!(i&jf))throw new Ve(ut.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Ve(ut.EINVAL,"Encoding not specified");const a=typeof t=="string"?Gr.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);Qy(r,Wf.call(this,typeof e=="number"?ji(this,e).path:e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength)}catch(s){r.error=s,r.hasError=!0}finally{eb(r)}}function xoe(e,t){const n=ji(this,e).stat();return t!=null&&t.bigint?new Kf(n):new Uc(n)}function Zf(e){ji(this,e).close(),hB(this,e)}function _oe(e,t=0){if(t||(t=0),t<0)throw new Ve(ut.EINVAL);ji(this,e).truncate(t)}function Soe(e){ji(this,e).sync()}function Eoe(e){ji(this,e).datasync()}function Coe(e,t,n,r,s){let i,a,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const f=typeof r=="string"?r:"utf8";a=0,i=Gr.from(t,f),o=i.byteLength}else i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,l=typeof s=="number"?s:null;const c=ji(this,e);l??(l=c.position);const u=c.write(i,a,o,l);return hi(this,"change",c.path),u}function koe(e,t,n,r,s){const i=ji(this,e),a=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,s=n.position),s=Number(s),isNaN(s)&&(s=i.position),i.read(t,a,r,s)}function rN(e,t,n){ji(this,e).chown(t,n)}function sN(e,t){const n=gd(t,-1);if(n<0)throw new Ve(ut.EINVAL,"Invalid mode.");ji(this,e).chmod(n)}function iN(e,t,n){ji(this,e).utimes(Ux(t),Ux(n))}function wB(e){e=hn(e);const{fs:t,path:n}=Wn(yd.call(this,e),this);try{const r=t.statSync(n);if(!Bo(r))throw Ve.With("ENOTDIR",n,"rmdir");if($s&&!Cr(this,r,fs))throw Ve.With("EACCES",n,"rmdir");t.rmdirSync(n),hi(this,"rename",e.toString())}catch(r){throw kr(r,{[n]:e})}}function aN(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Uo.credentials;t=typeof t=="object"?t:{mode:t};const a=gd(t==null?void 0:t.mode,511);e=yd.call(this,e);const{fs:o,path:l,root:c}=Wn(e,this),u={[l]:e},f=(m,g)=>{if(!Cr(this,g,fs))throw Ve.With("EACCES",mr(m),"mkdir");const v=o.mkdirSync(m,{mode:a,uid:g.mode&Xy?g.uid:s,gid:g.mode&Jy?g.gid:i});return hi(this,"rename",m),v};try{if(!(t!=null&&t.recursive)){f(l,o.statSync(mr(l)));return}const m=[];for(let v=l,b=e;!o.existsSync(v);v=mr(v),b=mr(b))m.unshift(v),u[v]=b;if(!m.length)return;const g=[o.statSync(mr(m[0]))];for(const[v,b]of m.entries())g.push(f(b,g[v]));return c.length==1?m[0]:(r=m[0])===null||r===void 0?void 0:r.slice(c.length)}catch(m){throw kr(m,u)}}function pm(e,t){t=typeof t=="object"?t:{encoding:t},e=hn(e);const{fs:n,path:r}=Wn(yd.call(this,e),this);let s;try{const a=n.statSync(r);if($s&&!Cr(this,a,Bs))throw Ve.With("EACCES",r,"readdir");if(!Bo(a))throw Ve.With("ENOTDIR",r,"readdir");s=n.readdirSync(r)}catch(a){throw kr(a,{[r]:e})}const i=[];for(const a of s){let o;try{o=n.statSync(_r(r,a))}catch{continue}if(t!=null&&t.withFileTypes?i.push(new ty(a,o)):(t==null?void 0:t.encoding)=="buffer"?i.push(Gr.from(a)):i.push(a),!(!Bo(o)||!(t!=null&&t.recursive)))for(const l of pm.call(this,_r(e,a),t))l instanceof ty?(l.path=_r(a,l.path),i.push(l)):Gr.isBuffer(l)?i.push(Gr.from(_r(a,$R(l)))):i.push(_r(a,l))}return i}function Toe(e,t){if(e=hn(e),!ed(mr(e)).hasAccess(Bs,this))throw Ve.With("EACCES",mr(e),"link");if(t=hn(t),!ed(mr(t)).hasAccess(fs,this))throw Ve.With("EACCES",mr(t),"link");const{fs:n,path:r}=Wn(e,this),s=Wn(t,this);if(n!=s.fs)throw Ve.With("EXDEV",t,"link");try{if($s&&!Cr(this,n.statSync(r),Bs))throw Ve.With("EACCES",r,"link");return n.linkSync(r,s.path)}catch(i){throw kr(i,{[r]:e,[s.path]:t})}}function Aoe(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ve(ut.EINVAL,"Invalid type: "+n);t=hn(t);const s=Qy(r,Wf.call(this,t,{flag:"wx",mode:420}),!1);s.write(uf(hn(e,!0))),s.chmod(zc)}catch(s){r.error=s,r.hasError=!0}finally{eb(r)}}function eA(e,t){const n=Gr.from(vB.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function Roe(e,t,n){const r=d_.call(this,e,"r+");rN.call(this,r,t,n),Zf.call(this,r)}function Noe(e,t,n){const r=f_.call(this,e,"r+");rN.call(this,r,t,n),Zf.call(this,r)}function Ioe(e,t){const n=d_.call(this,e,"r+");sN.call(this,n,t),Zf.call(this,n)}function joe(e,t){const n=f_.call(this,e,"r+");sN.call(this,n,t),Zf.call(this,n)}function xB(e,t,n){const r=d_.call(this,e,"r+");iN.call(this,r,t,n),Zf.call(this,r)}function Moe(e,t,n){const r=f_.call(this,e,"r+");iN.call(this,r,t,n),Zf.call(this,r)}function tA(e,t,n){try{const l=Wn(t,e),c=l.fs.statSync(l.path);if(!Bp(c))return{...l,fullPath:t,stats:c};const u=Mc.call(e,mr(t),eA.call(e,t).toString());return tA(e,u)}catch{}const{base:r,dir:s}=gl(t),i=s=="/"?"/":yd.call(e,s),a=_r(i,r),o=Wn(a,e);try{const l=o.fs.statSync(o.path);if(!Bp(l))return{...o,fullPath:a,stats:l};const c=Mc.call(e,i,eA.call(e,a).toString());return tA(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw kr(l,{[o.path]:a})}}function yd(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=hn(e);const{fullPath:s}=tA(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Gr.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function Ooe(e,t=384){if(!Cr(this,ed.call(this,e),t))throw new Ve(ut.EACCES)}function _B(e,t){e=hn(e);let n;try{n=QR.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&Fr){case Is:if(t!=null&&t.recursive)for(const r of pm.call(this,e))_B.call(this,_r(e,r),t);wB.call(this,e);break;case Oo:case zc:case Vf:case Hf:eN.call(this,e);break;case Gf:case qf:default:throw new Ve(ut.EPERM,"File type not supported",e,"rm")}}function Poe(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return aN.call(this,s),n=="buffer"?Gr.from(s):s}function SB(e,t,n){if(e=hn(e),t=hn(t),n&&n&WR&&JR(t))throw new Ve(ut.EEXIST,"Destination file already exists",t,"copyFile");nN.call(this,t,tN(e)),hi(this,"rename",t.toString())}function Doe(e,t,n){const r=ji(this,e);let s=0;for(const i of t)s+=r.read(i,0,i.byteLength,n+s);return s}function Foe(e,t,n){const r=ji(this,e);let s=0;for(const i of t)s+=r.write(new Uint8Array(i.buffer),0,i.byteLength,n+s);return s}function Loe(e,t){return e=hn(e),new oN(e,this)}function EB(e,t,n){e=hn(e),t=hn(t);const r=QR.call(this,e);if(n!=null&&n.errorOnExist&&JR.call(this,t))throw new Ve(ut.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Fr){case Is:if(!(n!=null&&n.recursive))throw new Ve(ut.EISDIR,e+" is a directory (not copied)",e,"cp");aN.call(this,t,{recursive:!0});for(const s of pm.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(_r(e,s.name),_r(t,s.name))||EB.call(this,_r(e,s.name),_r(t,s.name),n);break;case Oo:case zc:SB.call(this,e,t);break;case Vf:case Hf:case Gf:case qf:default:throw new Ve(ut.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&xB.call(this,t,r.atime,r.mtime)}function Boe(e,t){e=hn(e);const{fs:n}=Wn(e,this);return gB(n,t==null?void 0:t.bigint)}function $oe(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t,i=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),a=[];function o(l){const c=pm(l,{withFileTypes:r,encoding:"utf8"});for(const u of c){const f=r?u.path:l+"/"+u;s(r?u:f)||(ed(f).isDirectory()&&i.some(m=>m.source.includes(".*"))&&o(f),i.some(m=>m.test(f.replace(/^\/+/g,"")))&&a.push(r?u.path:f.replace(/^\/+/g,"")))}}return o(n),a}class ty{get name(){return Lp(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return eoe(this.stats)}isDirectory(){return Bo(this.stats)}isBlockDevice(){return J0(this.stats)}isCharacterDevice(){return Q0(this.stats)}isSymbolicLink(){return Bp(this.stats)}isFIFO(){return noe(this.stats)}isSocket(){return toe(this.stats)}}class oN{checkClosed(){if(this.closed)throw new Ve(ut.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await Xf.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=pm.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var lC={exports:{}},cC={exports:{}},uC={},H6;function bd(){return H6||(H6=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=u,n.toByteArray=m,n.fromByteArray=b;for(var r=[],s=[],i=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],s[a.charCodeAt(o)]=o;s[45]=62,s[95]=63;function c(_){var E=_.length;if(E%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var C=_.indexOf("=");C===-1&&(C=E);var k=C===E?0:4-C%4;return[C,k]}function u(_){var E=c(_),C=E[0],k=E[1];return(C+k)*3/4-k}function f(_,E,C){return(E+C)*3/4-C}function m(_){var E,C=c(_),k=C[0],R=C[1],I=new i(f(_,k,R)),j=0,M=R>0?k-4:k,L;for(L=0;L<M;L+=4)E=s[_.charCodeAt(L)]<<18|s[_.charCodeAt(L+1)]<<12|s[_.charCodeAt(L+2)]<<6|s[_.charCodeAt(L+3)],I[j++]=E>>16&255,I[j++]=E>>8&255,I[j++]=E&255;return R===2&&(E=s[_.charCodeAt(L)]<<2|s[_.charCodeAt(L+1)]>>4,I[j++]=E&255),R===1&&(E=s[_.charCodeAt(L)]<<10|s[_.charCodeAt(L+1)]<<4|s[_.charCodeAt(L+2)]>>2,I[j++]=E>>8&255,I[j++]=E&255),I}function g(_){return r[_>>18&63]+r[_>>12&63]+r[_>>6&63]+r[_&63]}function v(_,E,C){for(var k,R=[],I=E;I<C;I+=3)k=(_[I]<<16&16711680)+(_[I+1]<<8&65280)+(_[I+2]&255),R.push(g(k));return R.join("")}function b(_){for(var E,C=_.length,k=C%3,R=[],I=16383,j=0,M=C-k;j<M;j+=I)R.push(v(_,j,j+I>M?M:j+I));return k===1?(E=_[C-1],R.push(r[E>>2]+r[E<<4&63]+"==")):k===2&&(E=(_[C-2]<<8)+_[C-1],R.push(r[E>>10]+r[E>>4&63]+r[E<<2&63]+"=")),R.join("")}var w={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */w.read=function(_,E,C,k,R){var I,j,M=R*8-k-1,L=(1<<M)-1,q=L>>1,P=-7,V=C?R-1:0,z=C?-1:1,re=_[E+V];for(V+=z,I=re&(1<<-P)-1,re>>=-P,P+=M;P>0;I=I*256+_[E+V],V+=z,P-=8);for(j=I&(1<<-P)-1,I>>=-P,P+=k;P>0;j=j*256+_[E+V],V+=z,P-=8);if(I===0)I=1-q;else{if(I===L)return j?NaN:(re?-1:1)*(1/0);j=j+Math.pow(2,k),I=I-q}return(re?-1:1)*j*Math.pow(2,I-k)},w.write=function(_,E,C,k,R,I){var j,M,L,q=I*8-R-1,P=(1<<q)-1,V=P>>1,z=R===23?Math.pow(2,-24)-Math.pow(2,-77):0,re=k?0:I-1,K=k?1:-1,ee=E<0||E===0&&1/E<0?1:0;for(E=Math.abs(E),isNaN(E)||E===1/0?(M=isNaN(E)?1:0,j=P):(j=Math.floor(Math.log(E)/Math.LN2),E*(L=Math.pow(2,-j))<1&&(j--,L*=2),j+V>=1?E+=z/L:E+=z*Math.pow(2,1-V),E*L>=2&&(j++,L/=2),j+V>=P?(M=0,j=P):j+V>=1?(M=(E*L-1)*Math.pow(2,R),j=j+V):(M=E*Math.pow(2,V-1)*Math.pow(2,R),j=0));R>=8;_[C+re]=M&255,re+=K,M/=256,R-=8);for(j=j<<R|M,q+=R;q>0;_[C+re]=j&255,re+=K,j/=256,q-=8);_[C+re-K]|=ee*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(_){const E=n,C=w,k=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;_.Buffer=P,_.SlowBuffer=ae,_.INSPECT_MAX_BYTES=50;const R=2147483647;_.kMaxLength=R;const{Uint8Array:I,ArrayBuffer:j,SharedArrayBuffer:M}=globalThis;P.TYPED_ARRAY_SUPPORT=L(),!P.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function L(){try{const G=new I(1),U={foo:function(){return 42}};return Object.setPrototypeOf(U,I.prototype),Object.setPrototypeOf(G,U),G.foo()===42}catch{return!1}}Object.defineProperty(P.prototype,"parent",{enumerable:!0,get:function(){if(P.isBuffer(this))return this.buffer}}),Object.defineProperty(P.prototype,"offset",{enumerable:!0,get:function(){if(P.isBuffer(this))return this.byteOffset}});function q(G){if(G>R)throw new RangeError('The value "'+G+'" is invalid for option "size"');const U=new I(G);return Object.setPrototypeOf(U,P.prototype),U}function P(G,U,X){if(typeof G=="number"){if(typeof U=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return K(G)}return V(G,U,X)}P.poolSize=8192;function V(G,U,X){if(typeof G=="string")return ee(G,U);if(j.isView(G))return se(G);if(G==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof G);if(ye(G,j)||G&&ye(G.buffer,j)||typeof M<"u"&&(ye(G,M)||G&&ye(G.buffer,M)))return Y(G,U,X);if(typeof G=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const pe=G.valueOf&&G.valueOf();if(pe!=null&&pe!==G)return P.from(pe,U,X);const je=te(G);if(je)return je;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof G[Symbol.toPrimitive]=="function")return P.from(G[Symbol.toPrimitive]("string"),U,X);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof G)}P.from=function(G,U,X){return V(G,U,X)},Object.setPrototypeOf(P.prototype,I.prototype),Object.setPrototypeOf(P,I);function z(G){if(typeof G!="number")throw new TypeError('"size" argument must be of type number');if(G<0)throw new RangeError('The value "'+G+'" is invalid for option "size"')}function re(G,U,X){return z(G),G<=0?q(G):U!==void 0?typeof X=="string"?q(G).fill(U,X):q(G).fill(U):q(G)}P.alloc=function(G,U,X){return re(G,U,X)};function K(G){return z(G),q(G<0?0:Q(G)|0)}P.allocUnsafe=function(G){return K(G)},P.allocUnsafeSlow=function(G){return K(G)};function ee(G,U){if((typeof U!="string"||U==="")&&(U="utf8"),!P.isEncoding(U))throw new TypeError("Unknown encoding: "+U);const X=xe(G,U)|0;let pe=q(X);const je=pe.write(G,U);return je!==X&&(pe=pe.slice(0,je)),pe}function W(G){const U=G.length<0?0:Q(G.length)|0,X=q(U);for(let pe=0;pe<U;pe+=1)X[pe]=G[pe]&255;return X}function se(G){if(ye(G,I)){const U=new I(G);return Y(U.buffer,U.byteOffset,U.byteLength)}return W(G)}function Y(G,U,X){if(U<0||G.byteLength<U)throw new RangeError('"offset" is outside of buffer bounds');if(G.byteLength<U+(X||0))throw new RangeError('"length" is outside of buffer bounds');let pe;return U===void 0&&X===void 0?pe=new I(G):X===void 0?pe=new I(G,U):pe=new I(G,U,X),Object.setPrototypeOf(pe,P.prototype),pe}function te(G){if(P.isBuffer(G)){const U=Q(G.length)|0,X=q(U);return X.length===0||G.copy(X,0,0,U),X}if(G.length!==void 0)return typeof G.length!="number"||we(G.length)?q(0):W(G);if(G.type==="Buffer"&&Array.isArray(G.data))return W(G.data)}function Q(G){if(G>=R)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+R.toString(16)+" bytes");return G|0}function ae(G){return+G!=G&&(G=0),P.alloc(+G)}P.isBuffer=function(U){return U!=null&&U._isBuffer===!0&&U!==P.prototype},P.compare=function(U,X){if(ye(U,I)&&(U=P.from(U,U.offset,U.byteLength)),ye(X,I)&&(X=P.from(X,X.offset,X.byteLength)),!P.isBuffer(U)||!P.isBuffer(X))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(U===X)return 0;let pe=U.length,je=X.length;for(let Ke=0,bt=Math.min(pe,je);Ke<bt;++Ke)if(U[Ke]!==X[Ke]){pe=U[Ke],je=X[Ke];break}return pe<je?-1:je<pe?1:0},P.isEncoding=function(U){switch(String(U).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},P.concat=function(U,X){if(!Array.isArray(U))throw new TypeError('"list" argument must be an Array of Buffers');if(U.length===0)return P.alloc(0);let pe;if(X===void 0)for(X=0,pe=0;pe<U.length;++pe)X+=U[pe].length;const je=P.allocUnsafe(X);let Ke=0;for(pe=0;pe<U.length;++pe){let bt=U[pe];if(ye(bt,I))Ke+bt.length>je.length?(P.isBuffer(bt)||(bt=P.from(bt)),bt.copy(je,Ke)):I.prototype.set.call(je,bt,Ke);else if(P.isBuffer(bt))bt.copy(je,Ke);else throw new TypeError('"list" argument must be an Array of Buffers');Ke+=bt.length}return je};function xe(G,U){if(P.isBuffer(G))return G.length;if(j.isView(G)||ye(G,j))return G.byteLength;if(typeof G!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof G);const X=G.length,pe=arguments.length>2&&arguments[2]===!0;if(!pe&&X===0)return 0;let je=!1;for(;;)switch(U){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":return mt(G).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X*2;case"hex":return X>>>1;case"base64":return ze(G).length;default:if(je)return pe?-1:mt(G).length;U=(""+U).toLowerCase(),je=!0}}P.byteLength=xe;function ge(G,U,X){let pe=!1;if((U===void 0||U<0)&&(U=0),U>this.length||((X===void 0||X>this.length)&&(X=this.length),X<=0)||(X>>>=0,U>>>=0,X<=U))return"";for(G||(G="utf8");;)switch(G){case"hex":return Se(this,U,X);case"utf8":case"utf-8":return me(this,U,X);case"ascii":return oe(this,U,X);case"latin1":case"binary":return ne(this,U,X);case"base64":return H(this,U,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Fe(this,U,X);default:if(pe)throw new TypeError("Unknown encoding: "+G);G=(G+"").toLowerCase(),pe=!0}}P.prototype._isBuffer=!0;function Me(G,U,X){const pe=G[U];G[U]=G[X],G[X]=pe}P.prototype.swap16=function(){const U=this.length;if(U%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let X=0;X<U;X+=2)Me(this,X,X+1);return this},P.prototype.swap32=function(){const U=this.length;if(U%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let X=0;X<U;X+=4)Me(this,X,X+3),Me(this,X+1,X+2);return this},P.prototype.swap64=function(){const U=this.length;if(U%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let X=0;X<U;X+=8)Me(this,X,X+7),Me(this,X+1,X+6),Me(this,X+2,X+5),Me(this,X+3,X+4);return this},P.prototype.toString=function(){const U=this.length;return U===0?"":arguments.length===0?me(this,0,U):ge.apply(this,arguments)},P.prototype.toLocaleString=P.prototype.toString,P.prototype.equals=function(U){if(!P.isBuffer(U))throw new TypeError("Argument must be a Buffer");return this===U?!0:P.compare(this,U)===0},P.prototype.inspect=function(){let U="";const X=_.INSPECT_MAX_BYTES;return U=this.toString("hex",0,X).replace(/(.{2})/g,"$1 ").trim(),this.length>X&&(U+=" ... "),"<Buffer "+U+">"},k&&(P.prototype[k]=P.prototype.inspect),P.prototype.compare=function(U,X,pe,je,Ke){if(ye(U,I)&&(U=P.from(U,U.offset,U.byteLength)),!P.isBuffer(U))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof U);if(X===void 0&&(X=0),pe===void 0&&(pe=U?U.length:0),je===void 0&&(je=0),Ke===void 0&&(Ke=this.length),X<0||pe>U.length||je<0||Ke>this.length)throw new RangeError("out of range index");if(je>=Ke&&X>=pe)return 0;if(je>=Ke)return-1;if(X>=pe)return 1;if(X>>>=0,pe>>>=0,je>>>=0,Ke>>>=0,this===U)return 0;let bt=Ke-je,Kt=pe-X;const yn=Math.min(bt,Kt),Ht=this.slice(je,Ke),Yt=U.slice(X,pe);for(let an=0;an<yn;++an)if(Ht[an]!==Yt[an]){bt=Ht[an],Kt=Yt[an];break}return bt<Kt?-1:Kt<bt?1:0};function Pe(G,U,X,pe,je){if(G.length===0)return-1;if(typeof X=="string"?(pe=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),X=+X,we(X)&&(X=je?0:G.length-1),X<0&&(X=G.length+X),X>=G.length){if(je)return-1;X=G.length-1}else if(X<0)if(je)X=0;else return-1;if(typeof U=="string"&&(U=P.from(U,pe)),P.isBuffer(U))return U.length===0?-1:Ie(G,U,X,pe,je);if(typeof U=="number")return U=U&255,typeof I.prototype.indexOf=="function"?je?I.prototype.indexOf.call(G,U,X):I.prototype.lastIndexOf.call(G,U,X):Ie(G,[U],X,pe,je);throw new TypeError("val must be string, number or Buffer")}function Ie(G,U,X,pe,je){let Ke=1,bt=G.length,Kt=U.length;if(pe!==void 0&&(pe=String(pe).toLowerCase(),pe==="ucs2"||pe==="ucs-2"||pe==="utf16le"||pe==="utf-16le")){if(G.length<2||U.length<2)return-1;Ke=2,bt/=2,Kt/=2,X/=2}function yn(Yt,an){return Ke===1?Yt[an]:Yt.readUInt16BE(an*Ke)}let Ht;if(je){let Yt=-1;for(Ht=X;Ht<bt;Ht++)if(yn(G,Ht)===yn(U,Yt===-1?0:Ht-Yt)){if(Yt===-1&&(Yt=Ht),Ht-Yt+1===Kt)return Yt*Ke}else Yt!==-1&&(Ht-=Ht-Yt),Yt=-1}else for(X+Kt>bt&&(X=bt-Kt),Ht=X;Ht>=0;Ht--){let Yt=!0;for(let an=0;an<Kt;an++)if(yn(G,Ht+an)!==yn(U,an)){Yt=!1;break}if(Yt)return Ht}return-1}P.prototype.includes=function(U,X,pe){return this.indexOf(U,X,pe)!==-1},P.prototype.indexOf=function(U,X,pe){return Pe(this,U,X,pe,!0)},P.prototype.lastIndexOf=function(U,X,pe){return Pe(this,U,X,pe,!1)};function Ce(G,U,X,pe){X=Number(X)||0;const je=G.length-X;pe?(pe=Number(pe),pe>je&&(pe=je)):pe=je;const Ke=U.length;pe>Ke/2&&(pe=Ke/2);let bt;for(bt=0;bt<pe;++bt){const Kt=parseInt(U.substr(bt*2,2),16);if(we(Kt))return bt;G[X+bt]=Kt}return bt}function He(G,U,X,pe){return rt(mt(U,G.length-X),G,X,pe)}function it(G,U,X,pe){return rt(wt(U),G,X,pe)}function Ge(G,U,X,pe){return rt(ze(U),G,X,pe)}function Re(G,U,X,pe){return rt(B(U,G.length-X),G,X,pe)}P.prototype.write=function(U,X,pe,je){if(X===void 0)je="utf8",pe=this.length,X=0;else if(pe===void 0&&typeof X=="string")je=X,pe=this.length,X=0;else if(isFinite(X))X=X>>>0,isFinite(pe)?(pe=pe>>>0,je===void 0&&(je="utf8")):(je=pe,pe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ke=this.length-X;if((pe===void 0||pe>Ke)&&(pe=Ke),U.length>0&&(pe<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");je||(je="utf8");let bt=!1;for(;;)switch(je){case"hex":return Ce(this,U,X,pe);case"utf8":case"utf-8":return He(this,U,X,pe);case"ascii":case"latin1":case"binary":return it(this,U,X,pe);case"base64":return Ge(this,U,X,pe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Re(this,U,X,pe);default:if(bt)throw new TypeError("Unknown encoding: "+je);je=(""+je).toLowerCase(),bt=!0}},P.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function H(G,U,X){return U===0&&X===G.length?E.fromByteArray(G):E.fromByteArray(G.slice(U,X))}function me(G,U,X){X=Math.min(G.length,X);const pe=[];let je=U;for(;je<X;){const Ke=G[je];let bt=null,Kt=Ke>239?4:Ke>223?3:Ke>191?2:1;if(je+Kt<=X){let yn,Ht,Yt,an;switch(Kt){case 1:Ke<128&&(bt=Ke);break;case 2:yn=G[je+1],(yn&192)===128&&(an=(Ke&31)<<6|yn&63,an>127&&(bt=an));break;case 3:yn=G[je+1],Ht=G[je+2],(yn&192)===128&&(Ht&192)===128&&(an=(Ke&15)<<12|(yn&63)<<6|Ht&63,an>2047&&(an<55296||an>57343)&&(bt=an));break;case 4:yn=G[je+1],Ht=G[je+2],Yt=G[je+3],(yn&192)===128&&(Ht&192)===128&&(Yt&192)===128&&(an=(Ke&15)<<18|(yn&63)<<12|(Ht&63)<<6|Yt&63,an>65535&&an<1114112&&(bt=an))}}bt===null?(bt=65533,Kt=1):bt>65535&&(bt-=65536,pe.push(bt>>>10&1023|55296),bt=56320|bt&1023),pe.push(bt),je+=Kt}return ce(pe)}const Te=4096;function ce(G){const U=G.length;if(U<=Te)return String.fromCharCode.apply(String,G);let X="",pe=0;for(;pe<U;)X+=String.fromCharCode.apply(String,G.slice(pe,pe+=Te));return X}function oe(G,U,X){let pe="";X=Math.min(G.length,X);for(let je=U;je<X;++je)pe+=String.fromCharCode(G[je]&127);return pe}function ne(G,U,X){let pe="";X=Math.min(G.length,X);for(let je=U;je<X;++je)pe+=String.fromCharCode(G[je]);return pe}function Se(G,U,X){const pe=G.length;(!U||U<0)&&(U=0),(!X||X<0||X>pe)&&(X=pe);let je="";for(let Ke=U;Ke<X;++Ke)je+=Ue[G[Ke]];return je}function Fe(G,U,X){const pe=G.slice(U,X);let je="";for(let Ke=0;Ke<pe.length-1;Ke+=2)je+=String.fromCharCode(pe[Ke]+pe[Ke+1]*256);return je}P.prototype.slice=function(U,X){const pe=this.length;U=~~U,X=X===void 0?pe:~~X,U<0?(U+=pe,U<0&&(U=0)):U>pe&&(U=pe),X<0?(X+=pe,X<0&&(X=0)):X>pe&&(X=pe),X<U&&(X=U);const je=this.subarray(U,X);return Object.setPrototypeOf(je,P.prototype),je};function ke(G,U,X){if(G%1!==0||G<0)throw new RangeError("offset is not uint");if(G+U>X)throw new RangeError("Trying to access beyond buffer length")}P.prototype.readUintLE=P.prototype.readUIntLE=function(U,X,pe){U=U>>>0,X=X>>>0,pe||ke(U,X,this.length);let je=this[U],Ke=1,bt=0;for(;++bt<X&&(Ke*=256);)je+=this[U+bt]*Ke;return je},P.prototype.readUintBE=P.prototype.readUIntBE=function(U,X,pe){U=U>>>0,X=X>>>0,pe||ke(U,X,this.length);let je=this[U+--X],Ke=1;for(;X>0&&(Ke*=256);)je+=this[U+--X]*Ke;return je},P.prototype.readUint8=P.prototype.readUInt8=function(U,X){return U=U>>>0,X||ke(U,1,this.length),this[U]},P.prototype.readUint16LE=P.prototype.readUInt16LE=function(U,X){return U=U>>>0,X||ke(U,2,this.length),this[U]|this[U+1]<<8},P.prototype.readUint16BE=P.prototype.readUInt16BE=function(U,X){return U=U>>>0,X||ke(U,2,this.length),this[U]<<8|this[U+1]},P.prototype.readUint32LE=P.prototype.readUInt32LE=function(U,X){return U=U>>>0,X||ke(U,4,this.length),(this[U]|this[U+1]<<8|this[U+2]<<16)+this[U+3]*16777216},P.prototype.readUint32BE=P.prototype.readUInt32BE=function(U,X){return U=U>>>0,X||ke(U,4,this.length),this[U]*16777216+(this[U+1]<<16|this[U+2]<<8|this[U+3])},P.prototype.readBigUInt64LE=Et(function(U){U=U>>>0,Oe(U,"offset");const X=this[U],pe=this[U+7];(X===void 0||pe===void 0)&&ve(U,this.length-8);const je=X+this[++U]*2**8+this[++U]*2**16+this[++U]*2**24,Ke=this[++U]+this[++U]*2**8+this[++U]*2**16+pe*2**24;return BigInt(je)+(BigInt(Ke)<<BigInt(32))}),P.prototype.readBigUInt64BE=Et(function(U){U=U>>>0,Oe(U,"offset");const X=this[U],pe=this[U+7];(X===void 0||pe===void 0)&&ve(U,this.length-8);const je=X*2**24+this[++U]*2**16+this[++U]*2**8+this[++U],Ke=this[++U]*2**24+this[++U]*2**16+this[++U]*2**8+pe;return(BigInt(je)<<BigInt(32))+BigInt(Ke)}),P.prototype.readIntLE=function(U,X,pe){U=U>>>0,X=X>>>0,pe||ke(U,X,this.length);let je=this[U],Ke=1,bt=0;for(;++bt<X&&(Ke*=256);)je+=this[U+bt]*Ke;return Ke*=128,je>=Ke&&(je-=Math.pow(2,8*X)),je},P.prototype.readIntBE=function(U,X,pe){U=U>>>0,X=X>>>0,pe||ke(U,X,this.length);let je=X,Ke=1,bt=this[U+--je];for(;je>0&&(Ke*=256);)bt+=this[U+--je]*Ke;return Ke*=128,bt>=Ke&&(bt-=Math.pow(2,8*X)),bt},P.prototype.readInt8=function(U,X){return U=U>>>0,X||ke(U,1,this.length),this[U]&128?(255-this[U]+1)*-1:this[U]},P.prototype.readInt16LE=function(U,X){U=U>>>0,X||ke(U,2,this.length);const pe=this[U]|this[U+1]<<8;return pe&32768?pe|4294901760:pe},P.prototype.readInt16BE=function(U,X){U=U>>>0,X||ke(U,2,this.length);const pe=this[U+1]|this[U]<<8;return pe&32768?pe|4294901760:pe},P.prototype.readInt32LE=function(U,X){return U=U>>>0,X||ke(U,4,this.length),this[U]|this[U+1]<<8|this[U+2]<<16|this[U+3]<<24},P.prototype.readInt32BE=function(U,X){return U=U>>>0,X||ke(U,4,this.length),this[U]<<24|this[U+1]<<16|this[U+2]<<8|this[U+3]},P.prototype.readBigInt64LE=Et(function(U){U=U>>>0,Oe(U,"offset");const X=this[U],pe=this[U+7];(X===void 0||pe===void 0)&&ve(U,this.length-8);const je=this[U+4]+this[U+5]*2**8+this[U+6]*2**16+(pe<<24);return(BigInt(je)<<BigInt(32))+BigInt(X+this[++U]*2**8+this[++U]*2**16+this[++U]*2**24)}),P.prototype.readBigInt64BE=Et(function(U){U=U>>>0,Oe(U,"offset");const X=this[U],pe=this[U+7];(X===void 0||pe===void 0)&&ve(U,this.length-8);const je=(X<<24)+this[++U]*2**16+this[++U]*2**8+this[++U];return(BigInt(je)<<BigInt(32))+BigInt(this[++U]*2**24+this[++U]*2**16+this[++U]*2**8+pe)}),P.prototype.readFloatLE=function(U,X){return U=U>>>0,X||ke(U,4,this.length),C.read(this,U,!0,23,4)},P.prototype.readFloatBE=function(U,X){return U=U>>>0,X||ke(U,4,this.length),C.read(this,U,!1,23,4)},P.prototype.readDoubleLE=function(U,X){return U=U>>>0,X||ke(U,8,this.length),C.read(this,U,!0,52,8)},P.prototype.readDoubleBE=function(U,X){return U=U>>>0,X||ke(U,8,this.length),C.read(this,U,!1,52,8)};function Xe(G,U,X,pe,je,Ke){if(!P.isBuffer(G))throw new TypeError('"buffer" argument must be a Buffer instance');if(U>je||U<Ke)throw new RangeError('"value" argument is out of bounds');if(X+pe>G.length)throw new RangeError("Index out of range")}P.prototype.writeUintLE=P.prototype.writeUIntLE=function(U,X,pe,je){if(U=+U,X=X>>>0,pe=pe>>>0,!je){const Kt=Math.pow(2,8*pe)-1;Xe(this,U,X,pe,Kt,0)}let Ke=1,bt=0;for(this[X]=U&255;++bt<pe&&(Ke*=256);)this[X+bt]=U/Ke&255;return X+pe},P.prototype.writeUintBE=P.prototype.writeUIntBE=function(U,X,pe,je){if(U=+U,X=X>>>0,pe=pe>>>0,!je){const Kt=Math.pow(2,8*pe)-1;Xe(this,U,X,pe,Kt,0)}let Ke=pe-1,bt=1;for(this[X+Ke]=U&255;--Ke>=0&&(bt*=256);)this[X+Ke]=U/bt&255;return X+pe},P.prototype.writeUint8=P.prototype.writeUInt8=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,1,255,0),this[X]=U&255,X+1},P.prototype.writeUint16LE=P.prototype.writeUInt16LE=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,2,65535,0),this[X]=U&255,this[X+1]=U>>>8,X+2},P.prototype.writeUint16BE=P.prototype.writeUInt16BE=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,2,65535,0),this[X]=U>>>8,this[X+1]=U&255,X+2},P.prototype.writeUint32LE=P.prototype.writeUInt32LE=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,4,4294967295,0),this[X+3]=U>>>24,this[X+2]=U>>>16,this[X+1]=U>>>8,this[X]=U&255,X+4},P.prototype.writeUint32BE=P.prototype.writeUInt32BE=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,4,4294967295,0),this[X]=U>>>24,this[X+1]=U>>>16,this[X+2]=U>>>8,this[X+3]=U&255,X+4};function St(G,U,X,pe,je){fe(U,pe,je,G,X,7);let Ke=Number(U&BigInt(4294967295));G[X++]=Ke,Ke=Ke>>8,G[X++]=Ke,Ke=Ke>>8,G[X++]=Ke,Ke=Ke>>8,G[X++]=Ke;let bt=Number(U>>BigInt(32)&BigInt(4294967295));return G[X++]=bt,bt=bt>>8,G[X++]=bt,bt=bt>>8,G[X++]=bt,bt=bt>>8,G[X++]=bt,X}function ht(G,U,X,pe,je){fe(U,pe,je,G,X,7);let Ke=Number(U&BigInt(4294967295));G[X+7]=Ke,Ke=Ke>>8,G[X+6]=Ke,Ke=Ke>>8,G[X+5]=Ke,Ke=Ke>>8,G[X+4]=Ke;let bt=Number(U>>BigInt(32)&BigInt(4294967295));return G[X+3]=bt,bt=bt>>8,G[X+2]=bt,bt=bt>>8,G[X+1]=bt,bt=bt>>8,G[X]=bt,X+8}P.prototype.writeBigUInt64LE=Et(function(U,X=0){return St(this,U,X,BigInt(0),BigInt("0xffffffffffffffff"))}),P.prototype.writeBigUInt64BE=Et(function(U,X=0){return ht(this,U,X,BigInt(0),BigInt("0xffffffffffffffff"))}),P.prototype.writeIntLE=function(U,X,pe,je){if(U=+U,X=X>>>0,!je){const yn=Math.pow(2,8*pe-1);Xe(this,U,X,pe,yn-1,-yn)}let Ke=0,bt=1,Kt=0;for(this[X]=U&255;++Ke<pe&&(bt*=256);)U<0&&Kt===0&&this[X+Ke-1]!==0&&(Kt=1),this[X+Ke]=(U/bt>>0)-Kt&255;return X+pe},P.prototype.writeIntBE=function(U,X,pe,je){if(U=+U,X=X>>>0,!je){const yn=Math.pow(2,8*pe-1);Xe(this,U,X,pe,yn-1,-yn)}let Ke=pe-1,bt=1,Kt=0;for(this[X+Ke]=U&255;--Ke>=0&&(bt*=256);)U<0&&Kt===0&&this[X+Ke+1]!==0&&(Kt=1),this[X+Ke]=(U/bt>>0)-Kt&255;return X+pe},P.prototype.writeInt8=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,1,127,-128),U<0&&(U=255+U+1),this[X]=U&255,X+1},P.prototype.writeInt16LE=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,2,32767,-32768),this[X]=U&255,this[X+1]=U>>>8,X+2},P.prototype.writeInt16BE=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,2,32767,-32768),this[X]=U>>>8,this[X+1]=U&255,X+2},P.prototype.writeInt32LE=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,4,2147483647,-2147483648),this[X]=U&255,this[X+1]=U>>>8,this[X+2]=U>>>16,this[X+3]=U>>>24,X+4},P.prototype.writeInt32BE=function(U,X,pe){return U=+U,X=X>>>0,pe||Xe(this,U,X,4,2147483647,-2147483648),U<0&&(U=4294967295+U+1),this[X]=U>>>24,this[X+1]=U>>>16,this[X+2]=U>>>8,this[X+3]=U&255,X+4},P.prototype.writeBigInt64LE=Et(function(U,X=0){return St(this,U,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),P.prototype.writeBigInt64BE=Et(function(U,X=0){return ht(this,U,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function It(G,U,X,pe,je,Ke){if(X+pe>G.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function Vt(G,U,X,pe,je){return U=+U,X=X>>>0,je||It(G,U,X,4),C.write(G,U,X,pe,23,4),X+4}P.prototype.writeFloatLE=function(U,X,pe){return Vt(this,U,X,!0,pe)},P.prototype.writeFloatBE=function(U,X,pe){return Vt(this,U,X,!1,pe)};function Ot(G,U,X,pe,je){return U=+U,X=X>>>0,je||It(G,U,X,8),C.write(G,U,X,pe,52,8),X+8}P.prototype.writeDoubleLE=function(U,X,pe){return Ot(this,U,X,!0,pe)},P.prototype.writeDoubleBE=function(U,X,pe){return Ot(this,U,X,!1,pe)},P.prototype.copy=function(U,X,pe,je){if(!P.isBuffer(U))throw new TypeError("argument should be a Buffer");if(pe||(pe=0),!je&&je!==0&&(je=this.length),X>=U.length&&(X=U.length),X||(X=0),je>0&&je<pe&&(je=pe),je===pe||U.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(pe<0||pe>=this.length)throw new RangeError("Index out of range");if(je<0)throw new RangeError("sourceEnd out of bounds");je>this.length&&(je=this.length),U.length-X<je-pe&&(je=U.length-X+pe);const Ke=je-pe;return this===U&&typeof I.prototype.copyWithin=="function"?this.copyWithin(X,pe,je):I.prototype.set.call(U,this.subarray(pe,je),X),Ke},P.prototype.fill=function(U,X,pe,je){if(typeof U=="string"){if(typeof X=="string"?(je=X,X=0,pe=this.length):typeof pe=="string"&&(je=pe,pe=this.length),je!==void 0&&typeof je!="string")throw new TypeError("encoding must be a string");if(typeof je=="string"&&!P.isEncoding(je))throw new TypeError("Unknown encoding: "+je);if(U.length===1){const bt=U.charCodeAt(0);(je==="utf8"&&bt<128||je==="latin1")&&(U=bt)}}else typeof U=="number"?U=U&255:typeof U=="boolean"&&(U=Number(U));if(X<0||this.length<X||this.length<pe)throw new RangeError("Out of range index");if(pe<=X)return this;X=X>>>0,pe=pe===void 0?this.length:pe>>>0,U||(U=0);let Ke;if(typeof U=="number")for(Ke=X;Ke<pe;++Ke)this[Ke]=U;else{const bt=P.isBuffer(U)?U:P.from(U,je),Kt=bt.length;if(Kt===0)throw new TypeError('The value "'+U+'" is invalid for argument "value"');for(Ke=0;Ke<pe-X;++Ke)this[Ke+X]=bt[Ke%Kt]}return this};const Gt={};function be(G,U,X){Gt[G]=class extends X{constructor(){super(),Object.defineProperty(this,"message",{value:U.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${G}]`,this.stack,delete this.name}get code(){return G}set code(je){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:je,writable:!0})}toString(){return`${this.name} [${G}]: ${this.message}`}}}be("ERR_BUFFER_OUT_OF_BOUNDS",function(G){return G?`${G} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),be("ERR_INVALID_ARG_TYPE",function(G,U){return`The "${G}" argument must be of type number. Received type ${typeof U}`},TypeError),be("ERR_OUT_OF_RANGE",function(G,U,X){let pe=`The value of "${G}" is out of range.`,je=X;return Number.isInteger(X)&&Math.abs(X)>2**32?je=O(String(X)):typeof X=="bigint"&&(je=String(X),(X>BigInt(2)**BigInt(32)||X<-(BigInt(2)**BigInt(32)))&&(je=O(je)),je+="n"),pe+=` It must be ${U}. Received ${je}`,pe},RangeError);function O(G){let U="",X=G.length;const pe=G[0]==="-"?1:0;for(;X>=pe+4;X-=3)U=`_${G.slice(X-3,X)}${U}`;return`${G.slice(0,X)}${U}`}function Z(G,U,X){Oe(U,"offset"),(G[U]===void 0||G[U+X]===void 0)&&ve(U,G.length-(X+1))}function fe(G,U,X,pe,je,Ke){if(G>X||G<U){const bt=typeof U=="bigint"?"n":"";let Kt;throw U===0||U===BigInt(0)?Kt=`>= 0${bt} and < 2${bt} ** ${(Ke+1)*8}${bt}`:Kt=`>= -(2${bt} ** ${(Ke+1)*8-1}${bt}) and < 2 ** ${(Ke+1)*8-1}${bt}`,new Gt.ERR_OUT_OF_RANGE("value",Kt,G)}Z(pe,je,Ke)}function Oe(G,U){if(typeof G!="number")throw new Gt.ERR_INVALID_ARG_TYPE(U,"number",G)}function ve(G,U,X){throw Math.floor(G)!==G?(Oe(G,X),new Gt.ERR_OUT_OF_RANGE("offset","an integer",G)):U<0?new Gt.ERR_BUFFER_OUT_OF_BOUNDS:new Gt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${U}`,G)}const Ae=/[^+/0-9A-Za-z-_]/g;function ue(G){if(G=G.split("=")[0],G=G.trim().replace(Ae,""),G.length<2)return"";for(;G.length%4!==0;)G=G+"=";return G}function mt(G,U){U=U||1/0;let X;const pe=G.length;let je=null;const Ke=[];for(let bt=0;bt<pe;++bt){if(X=G.charCodeAt(bt),X>55295&&X<57344){if(!je){if(X>56319){(U-=3)>-1&&Ke.push(239,191,189);continue}else if(bt+1===pe){(U-=3)>-1&&Ke.push(239,191,189);continue}je=X;continue}if(X<56320){(U-=3)>-1&&Ke.push(239,191,189),je=X;continue}X=(je-55296<<10|X-56320)+65536}else je&&(U-=3)>-1&&Ke.push(239,191,189);if(je=null,X<128){if((U-=1)<0)break;Ke.push(X)}else if(X<2048){if((U-=2)<0)break;Ke.push(X>>6|192,X&63|128)}else if(X<65536){if((U-=3)<0)break;Ke.push(X>>12|224,X>>6&63|128,X&63|128)}else if(X<1114112){if((U-=4)<0)break;Ke.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw new Error("Invalid code point")}return Ke}function wt(G){const U=[];for(let X=0;X<G.length;++X)U.push(G.charCodeAt(X)&255);return U}function B(G,U){let X,pe,je;const Ke=[];for(let bt=0;bt<G.length&&!((U-=2)<0);++bt)X=G.charCodeAt(bt),pe=X>>8,je=X%256,Ke.push(je),Ke.push(pe);return Ke}function ze(G){return E.toByteArray(ue(G))}function rt(G,U,X,pe){let je;for(je=0;je<pe&&!(je+X>=U.length||je>=G.length);++je)U[je+X]=G[je];return je}function ye(G,U){return G instanceof U||G!=null&&G.constructor!=null&&G.constructor.name!=null&&G.constructor.name===U.name}function we(G){return G!==G}const Ue=function(){const G="0123456789abcdef",U=new Array(256);for(let X=0;X<16;++X){const pe=X*16;for(let je=0;je<16;++je)U[pe+je]=G[X]+G[je]}return U}();function Et(G){return typeof BigInt>"u"?he:G}function he(){throw new Error("BigInt not supported")}})(t);const x=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=x,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(uC)),uC}var dC,G6;function os(){if(G6)return dC;G6=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let s=0;s<n.length;s++)r+=`    ${n[s].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return dC={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},dC}var fC={exports:{}},hC,K6;function CB(){return K6||(K6=1,hC={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const s=t.shift();return r==="f"?s.toFixed(6):r==="j"?JSON.stringify(s):r==="s"&&typeof s=="object"?`${s.constructor!==Object?s.constructor.name:""} {}`.trim():s.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),hC}var pC,W6;function Gi(){if(W6)return pC;W6=1;const{format:e,inspect:t}=CB(),{AggregateError:n}=os(),r=globalThis.AggregateError||n,s=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function c(w,x){if(!w)throw new l.ERR_INTERNAL_ASSERTION(x)}function u(w){let x="",_=w.length;const E=w[0]==="-"?1:0;for(;_>=E+4;_-=3)x=`_${w.slice(_-3,_)}${x}`;return`${w.slice(0,_)}${x}`}function f(w,x,_){if(typeof x=="function")return c(x.length<=_.length,`Code: ${w}; The provided arguments length (${_.length}) does not match the required ones (${x.length}).`),x(..._);const E=(x.match(/%[dfijoOs]/g)||[]).length;return c(E===_.length,`Code: ${w}; The provided arguments length (${_.length}) does not match the required ones (${E}).`),_.length===0?x:e(x,..._)}function m(w,x,_){_||(_=Error);class E extends _{constructor(...k){super(f(w,x,k))}toString(){return`${this.name} [${w}]: ${this.message}`}}Object.defineProperties(E.prototype,{name:{value:_.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${w}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),E.prototype.code=w,E.prototype[s]=!0,l[w]=E}function g(w){const x=o+w.name;return Object.defineProperty(w,"name",{value:x}),w}function v(w,x){if(w&&x&&w!==x){if(Array.isArray(x.errors))return x.errors.push(w),x;const _=new r([x,w],x.message);return _.code=x.code,_}return w||x}class b extends Error{constructor(x="The operation was aborted",_=void 0){if(_!==void 0&&typeof _!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",_);super(x,_),this.code="ABORT_ERR",this.name="AbortError"}}return m("ERR_ASSERTION","%s",Error),m("ERR_INVALID_ARG_TYPE",(w,x,_)=>{c(typeof w=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let E="The ";w.endsWith(" argument")?E+=`${w} `:E+=`"${w}" ${w.includes(".")?"property":"argument"} `,E+="must be ";const C=[],k=[],R=[];for(const j of x)c(typeof j=="string","All expected entries have to be of type string"),i.includes(j)?C.push(j.toLowerCase()):a.test(j)?k.push(j):(c(j!=="object",'The value "object" should be written as "Object"'),R.push(j));if(k.length>0){const j=C.indexOf("object");j!==-1&&(C.splice(C,j,1),k.push("Object"))}if(C.length>0){switch(C.length){case 1:E+=`of type ${C[0]}`;break;case 2:E+=`one of type ${C[0]} or ${C[1]}`;break;default:{const j=C.pop();E+=`one of type ${C.join(", ")}, or ${j}`}}(k.length>0||R.length>0)&&(E+=" or ")}if(k.length>0){switch(k.length){case 1:E+=`an instance of ${k[0]}`;break;case 2:E+=`an instance of ${k[0]} or ${k[1]}`;break;default:{const j=k.pop();E+=`an instance of ${k.join(", ")}, or ${j}`}}R.length>0&&(E+=" or ")}switch(R.length){case 0:break;case 1:R[0].toLowerCase()!==R[0]&&(E+="an "),E+=`${R[0]}`;break;case 2:E+=`one of ${R[0]} or ${R[1]}`;break;default:{const j=R.pop();E+=`one of ${R.join(", ")}, or ${j}`}}if(_==null)E+=`. Received ${_}`;else if(typeof _=="function"&&_.name)E+=`. Received function ${_.name}`;else if(typeof _=="object"){var I;if((I=_.constructor)!==null&&I!==void 0&&I.name)E+=`. Received an instance of ${_.constructor.name}`;else{const j=t(_,{depth:-1});E+=`. Received ${j}`}}else{let j=t(_,{colors:!1});j.length>25&&(j=`${j.slice(0,25)}...`),E+=`. Received type ${typeof _} (${j})`}return E},TypeError),m("ERR_INVALID_ARG_VALUE",(w,x,_="is invalid")=>{let E=t(x);return E.length>128&&(E=E.slice(0,128)+"..."),`The ${w.includes(".")?"property":"argument"} '${w}' ${_}. Received ${E}`},TypeError),m("ERR_INVALID_RETURN_VALUE",(w,x,_)=>{var E;const C=_!=null&&(E=_.constructor)!==null&&E!==void 0&&E.name?`instance of ${_.constructor.name}`:`type ${typeof _}`;return`Expected ${w} to be returned from the "${x}" function but got ${C}.`},TypeError),m("ERR_MISSING_ARGS",(...w)=>{c(w.length>0,"At least one arg needs to be specified");let x;const _=w.length;switch(w=(Array.isArray(w)?w:[w]).map(E=>`"${E}"`).join(" or "),_){case 1:x+=`The ${w[0]} argument`;break;case 2:x+=`The ${w[0]} and ${w[1]} arguments`;break;default:{const E=w.pop();x+=`The ${w.join(", ")}, and ${E} arguments`}break}return`${x} must be specified`},TypeError),m("ERR_OUT_OF_RANGE",(w,x,_)=>{c(x,'Missing "range" argument');let E;if(Number.isInteger(_)&&Math.abs(_)>2**32)E=u(String(_));else if(typeof _=="bigint"){E=String(_);const C=BigInt(2)**BigInt(32);(_>C||_<-C)&&(E=u(E)),E+="n"}else E=t(_);return`The value of "${w}" is out of range. It must be ${x}. Received ${E}`},RangeError),m("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),m("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),m("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),m("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),m("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),m("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),m("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),m("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),m("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),m("ERR_STREAM_WRITE_AFTER_END","write after end",Error),m("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),pC={AbortError:b,aggregateTwoErrors:g(v),hideStackFrames:g,codes:l},pC}var Kg={exports:{}},Z6;function ny(){if(Z6)return Kg.exports;Z6=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Kg.exports=e,Kg.exports.AbortSignal=t,Kg.exports.default=e,Kg.exports}var uw={exports:{}},Y6;function h_(){if(Y6)return uw.exports;Y6=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(k,R,I){return Function.prototype.apply.call(k,R,I)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:n=function(k){return Object.getOwnPropertyNames(k)};function r(C){console&&console.warn&&console.warn(C)}var s=Number.isNaN||function(k){return k!==k};function i(){i.init.call(this)}uw.exports=i,uw.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(C){if(typeof C!="number"||C<0||s(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");a=C}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function l(C){return C._maxListeners===void 0?i.defaultMaxListeners:C._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(k){for(var R=[],I=1;I<arguments.length;I++)R.push(arguments[I]);var j=k==="error",M=this._events;if(M!==void 0)j=j&&M.error===void 0;else if(!j)return!1;if(j){var L;if(R.length>0&&(L=R[0]),L instanceof Error)throw L;var q=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw q.context=L,q}var P=M[k];if(P===void 0)return!1;if(typeof P=="function")t(P,this,R);else for(var V=P.length,z=v(P,V),I=0;I<V;++I)t(z[I],this,R);return!0};function c(C,k,R,I){var j,M,L;if(o(R),M=C._events,M===void 0?(M=C._events=Object.create(null),C._eventsCount=0):(M.newListener!==void 0&&(C.emit("newListener",k,R.listener?R.listener:R),M=C._events),L=M[k]),L===void 0)L=M[k]=R,++C._eventsCount;else if(typeof L=="function"?L=M[k]=I?[R,L]:[L,R]:I?L.unshift(R):L.push(R),j=l(C),j>0&&L.length>j&&!L.warned){L.warned=!0;var q=new Error("Possible EventEmitter memory leak detected. "+L.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");q.name="MaxListenersExceededWarning",q.emitter=C,q.type=k,q.count=L.length,r(q)}return C}i.prototype.addListener=function(k,R){return c(this,k,R,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(k,R){return c(this,k,R,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(C,k,R){var I={fired:!1,wrapFn:void 0,target:C,type:k,listener:R},j=u.bind(I);return j.listener=R,I.wrapFn=j,j}i.prototype.once=function(k,R){return o(R),this.on(k,f(this,k,R)),this},i.prototype.prependOnceListener=function(k,R){return o(R),this.prependListener(k,f(this,k,R)),this},i.prototype.removeListener=function(k,R){var I,j,M,L,q;if(o(R),j=this._events,j===void 0)return this;if(I=j[k],I===void 0)return this;if(I===R||I.listener===R)--this._eventsCount===0?this._events=Object.create(null):(delete j[k],j.removeListener&&this.emit("removeListener",k,I.listener||R));else if(typeof I!="function"){for(M=-1,L=I.length-1;L>=0;L--)if(I[L]===R||I[L].listener===R){q=I[L].listener,M=L;break}if(M<0)return this;M===0?I.shift():b(I,M),I.length===1&&(j[k]=I[0]),j.removeListener!==void 0&&this.emit("removeListener",k,q||R)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(k){var R,I,j;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete I[k]),this;if(arguments.length===0){var M=Object.keys(I),L;for(j=0;j<M.length;++j)L=M[j],L!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=I[k],typeof R=="function")this.removeListener(k,R);else if(R!==void 0)for(j=R.length-1;j>=0;j--)this.removeListener(k,R[j]);return this};function m(C,k,R){var I=C._events;if(I===void 0)return[];var j=I[k];return j===void 0?[]:typeof j=="function"?R?[j.listener||j]:[j]:R?w(j):v(j,j.length)}i.prototype.listeners=function(k){return m(this,k,!0)},i.prototype.rawListeners=function(k){return m(this,k,!1)},i.listenerCount=function(C,k){return typeof C.listenerCount=="function"?C.listenerCount(k):g.call(C,k)},i.prototype.listenerCount=g;function g(C){var k=this._events;if(k!==void 0){var R=k[C];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function v(C,k){for(var R=new Array(k),I=0;I<k;++I)R[I]=C[I];return R}function b(C,k){for(;k+1<C.length;k++)C[k]=C[k+1];C.pop()}function w(C){for(var k=new Array(C.length),R=0;R<k.length;++R)k[R]=C[R].listener||C[R];return k}function x(C,k){return new Promise(function(R,I){function j(L){C.removeListener(k,M),I(L)}function M(){typeof C.removeListener=="function"&&C.removeListener("error",j),R([].slice.call(arguments))}E(C,k,M,{once:!0}),k!=="error"&&_(C,j,{once:!0})})}function _(C,k,R){typeof C.on=="function"&&E(C,"error",k,R)}function E(C,k,R,I){if(typeof C.on=="function")I.once?C.once(k,R):C.on(k,R);else if(typeof C.addEventListener=="function")C.addEventListener(k,function j(M){I.once&&C.removeEventListener(k,j),R(M)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return uw.exports}var X6;function aa(){return X6||(X6=1,function(e){const t=bd(),{format:n,inspect:r}=CB(),{codes:{ERR_INVALID_ARG_TYPE:s}}=Gi(),{kResistStopPropagation:i,AggregateError:a,SymbolDispose:o}=os(),l=globalThis.AbortSignal||ny().AbortSignal,c=globalThis.AbortController||ny().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,f=globalThis.Blob||t.Blob,m=typeof f<"u"?function(w){return w instanceof f}:function(w){return!1},g=(b,w)=>{if(b!==void 0&&(b===null||typeof b!="object"||!("aborted"in b)))throw new s(w,"AbortSignal",b)},v=(b,w)=>{if(typeof b!="function")throw new s(w,"Function",b)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(b){let w=!1;return function(...x){w||(w=!0,b.apply(this,x))}},createDeferredPromise:function(){let b,w;return{promise:new Promise((_,E)=>{b=_,w=E}),resolve:b,reject:w}},promisify(b){return new Promise((w,x)=>{b((_,...E)=>_?x(_):w(...E))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(b){return b instanceof u},isArrayBufferView(b){return ArrayBuffer.isView(b)}},isBlob:m,deprecate(b,w){return b},addAbortListener:h_().addAbortListener||function(w,x){if(w===void 0)throw new s("signal","AbortSignal",w);g(w,"signal"),v(x,"listener");let _;return w.aborted?queueMicrotask(()=>x()):(w.addEventListener("abort",x,{__proto__:null,once:!0,[i]:!0}),_=()=>{w.removeEventListener("abort",x)}),{__proto__:null,[o](){var E;(E=_)===null||E===void 0||E()}}},AbortSignalAny:l.any||function(w){if(w.length===1)return w[0];const x=new c,_=()=>x.abort();return w.forEach(E=>{g(E,"signals"),E.addEventListener("abort",_,{once:!0})}),x.signal.addEventListener("abort",()=>{w.forEach(E=>E.removeEventListener("abort",_))},{once:!0}),x.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(fC)),fC.exports}var dw={},mC,J6;function tb(){if(J6)return mC;J6=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:s,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:f,StringPrototypeToUpperCase:m,StringPrototypeTrim:g}=os(),{hideStackFrames:v,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:w,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:_,ERR_UNKNOWN_SIGNAL:E}}=Gi(),{normalizeEncoding:C}=aa(),{isAsyncFunction:k,isArrayBufferView:R}=aa().types,I={};function j(ne){return ne===(ne|0)}function M(ne){return ne===ne>>>0}const L=/^[0-7]+$/,q="must be a 32-bit unsigned integer or an octal string";function P(ne,Se,Fe){if(typeof ne>"u"&&(ne=Fe),typeof ne=="string"){if(u(L,ne)===null)throw new x(Se,ne,q);ne=l(ne,8)}return re(ne,Se),ne}const V=v((ne,Se,Fe=o,ke=a)=>{if(typeof ne!="number")throw new w(Se,"number",ne);if(!s(ne))throw new _(Se,"an integer",ne);if(ne<Fe||ne>ke)throw new _(Se,`>= ${Fe} && <= ${ke}`,ne)}),z=v((ne,Se,Fe=-2147483648,ke=2147483647)=>{if(typeof ne!="number")throw new w(Se,"number",ne);if(!s(ne))throw new _(Se,"an integer",ne);if(ne<Fe||ne>ke)throw new _(Se,`>= ${Fe} && <= ${ke}`,ne)}),re=v((ne,Se,Fe=!1)=>{if(typeof ne!="number")throw new w(Se,"number",ne);if(!s(ne))throw new _(Se,"an integer",ne);const ke=Fe?1:0,Xe=4294967295;if(ne<ke||ne>Xe)throw new _(Se,`>= ${ke} && <= ${Xe}`,ne)});function K(ne,Se){if(typeof ne!="string")throw new w(Se,"string",ne)}function ee(ne,Se,Fe=void 0,ke){if(typeof ne!="number")throw new w(Se,"number",ne);if(Fe!=null&&ne<Fe||ke!=null&&ne>ke||(Fe!=null||ke!=null)&&i(ne))throw new _(Se,`${Fe!=null?`>= ${Fe}`:""}${Fe!=null&&ke!=null?" && ":""}${ke!=null?`<= ${ke}`:""}`,ne)}const W=v((ne,Se,Fe)=>{if(!t(Fe,ne)){const Xe="must be one of: "+n(r(Fe,St=>typeof St=="string"?`'${St}'`:f(St)),", ");throw new x(Se,ne,Xe)}});function se(ne,Se){if(typeof ne!="boolean")throw new w(Se,"boolean",ne)}function Y(ne,Se,Fe){return ne==null||!c(ne,Se)?Fe:ne[Se]}const te=v((ne,Se,Fe=null)=>{const ke=Y(Fe,"allowArray",!1),Xe=Y(Fe,"allowFunction",!1);if(!Y(Fe,"nullable",!1)&&ne===null||!ke&&e(ne)||typeof ne!="object"&&(!Xe||typeof ne!="function"))throw new w(Se,"Object",ne)}),Q=v((ne,Se)=>{if(ne!=null&&typeof ne!="object"&&typeof ne!="function")throw new w(Se,"a dictionary",ne)}),ae=v((ne,Se,Fe=0)=>{if(!e(ne))throw new w(Se,"Array",ne);if(ne.length<Fe){const ke=`must be longer than ${Fe}`;throw new x(Se,ne,ke)}});function xe(ne,Se){ae(ne,Se);for(let Fe=0;Fe<ne.length;Fe++)K(ne[Fe],`${Se}[${Fe}]`)}function ge(ne,Se){ae(ne,Se);for(let Fe=0;Fe<ne.length;Fe++)se(ne[Fe],`${Se}[${Fe}]`)}function Me(ne,Se){ae(ne,Se);for(let Fe=0;Fe<ne.length;Fe++){const ke=ne[Fe],Xe=`${Se}[${Fe}]`;if(ke==null)throw new w(Xe,"AbortSignal",ke);it(ke,Xe)}}function Pe(ne,Se="signal"){if(K(ne,Se),I[ne]===void 0)throw I[m(ne)]!==void 0?new E(ne+" (signals must use all capital letters)"):new E(ne)}const Ie=v((ne,Se="buffer")=>{if(!R(ne))throw new w(Se,["Buffer","TypedArray","DataView"],ne)});function Ce(ne,Se){const Fe=C(Se),ke=ne.length;if(Fe==="hex"&&ke%2!==0)throw new x("encoding",Se,`is invalid for data of length ${ke}`)}function He(ne,Se="Port",Fe=!0){if(typeof ne!="number"&&typeof ne!="string"||typeof ne=="string"&&g(ne).length===0||+ne!==+ne>>>0||ne>65535||ne===0&&!Fe)throw new b(Se,ne,Fe);return ne|0}const it=v((ne,Se)=>{if(ne!==void 0&&(ne===null||typeof ne!="object"||!("aborted"in ne)))throw new w(Se,"AbortSignal",ne)}),Ge=v((ne,Se)=>{if(typeof ne!="function")throw new w(Se,"Function",ne)}),Re=v((ne,Se)=>{if(typeof ne!="function"||k(ne))throw new w(Se,"Function",ne)}),H=v((ne,Se)=>{if(ne!==void 0)throw new w(Se,"undefined",ne)});function me(ne,Se,Fe){if(!t(Fe,ne))throw new w(Se,`('${n(Fe,"|")}')`,ne)}const Te=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function ce(ne,Se){if(typeof ne>"u"||!u(Te,ne))throw new x(Se,ne,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function oe(ne){if(typeof ne=="string")return ce(ne,"hints"),ne;if(e(ne)){const Se=ne.length;let Fe="";if(Se===0)return Fe;for(let ke=0;ke<Se;ke++){const Xe=ne[ke];ce(Xe,"hints"),Fe+=Xe,ke!==Se-1&&(Fe+=", ")}return Fe}throw new x("hints",ne,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return mC={isInt32:j,isUint32:M,parseFileMode:P,validateArray:ae,validateStringArray:xe,validateBooleanArray:ge,validateAbortSignalArray:Me,validateBoolean:se,validateBuffer:Ie,validateDictionary:Q,validateEncoding:Ce,validateFunction:Ge,validateInt32:z,validateInteger:V,validateNumber:ee,validateObject:te,validateOneOf:W,validatePlainFunction:Re,validatePort:He,validateSignalName:Pe,validateString:K,validateUint32:re,validateUndefined:H,validateUnion:me,validateAbortSignal:it,validateLinkHeaderValue:oe},mC}var fw={exports:{}},gC={},Q6;function Yf(){return Q6||(Q6=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}var n={exports:{}},r=n.exports={},s,i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=a}catch{s=a}try{typeof clearTimeout=="function"?i=clearTimeout:i=o}catch{i=o}})();function l(C){if(s===setTimeout)return setTimeout(C,0);if((s===a||!s)&&setTimeout)return s=setTimeout,setTimeout(C,0);try{return s(C,0)}catch{try{return s.call(null,C,0)}catch{return s.call(this,C,0)}}}function c(C){if(i===clearTimeout)return clearTimeout(C);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(C);try{return i(C)}catch{try{return i.call(null,C)}catch{return i.call(this,C)}}}var u=[],f=!1,m,g=-1;function v(){!f||!m||(f=!1,m.length?u=m.concat(u):g=-1,u.length&&b())}function b(){if(!f){var C=l(v);f=!0;for(var k=u.length;k;){for(m=u,u=[];++g<k;)m&&m[g].run();g=-1,k=u.length}m=null,f=!1,c(C)}}r.nextTick=function(C){var k=new Array(arguments.length-1);if(arguments.length>1)for(var R=1;R<arguments.length;R++)k[R-1]=arguments[R];u.push(new w(C,k)),u.length===1&&!f&&l(b)};function w(C,k){this.fun=C,this.array=k}w.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(C){return[]},r.binding=function(C){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(C){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var _=n.exports;const E=t(_);e.default=E,e.process=E}(gC)),gC}var yC,eO;function qc(){if(eO)return yC;eO=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=os(),r=n("nodejs.stream.destroyed"),s=n("nodejs.stream.errored"),i=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(Y,te=!1){var Q;return!!(Y&&typeof Y.pipe=="function"&&typeof Y.on=="function"&&(!te||typeof Y.pause=="function"&&typeof Y.resume=="function")&&(!Y._writableState||((Q=Y._readableState)===null||Q===void 0?void 0:Q.readable)!==!1)&&(!Y._writableState||Y._readableState))}function f(Y){var te;return!!(Y&&typeof Y.write=="function"&&typeof Y.on=="function"&&(!Y._readableState||((te=Y._writableState)===null||te===void 0?void 0:te.writable)!==!1))}function m(Y){return!!(Y&&typeof Y.pipe=="function"&&Y._readableState&&typeof Y.on=="function"&&typeof Y.write=="function")}function g(Y){return Y&&(Y._readableState||Y._writableState||typeof Y.write=="function"&&typeof Y.on=="function"||typeof Y.pipe=="function"&&typeof Y.on=="function")}function v(Y){return!!(Y&&!g(Y)&&typeof Y.pipeThrough=="function"&&typeof Y.getReader=="function"&&typeof Y.cancel=="function")}function b(Y){return!!(Y&&!g(Y)&&typeof Y.getWriter=="function"&&typeof Y.abort=="function")}function w(Y){return!!(Y&&!g(Y)&&typeof Y.readable=="object"&&typeof Y.writable=="object")}function x(Y){return v(Y)||b(Y)||w(Y)}function _(Y,te){return Y==null?!1:te===!0?typeof Y[e]=="function":te===!1?typeof Y[t]=="function":typeof Y[e]=="function"||typeof Y[t]=="function"}function E(Y){if(!g(Y))return null;const te=Y._writableState,Q=Y._readableState,ae=te||Q;return!!(Y.destroyed||Y[r]||ae!=null&&ae.destroyed)}function C(Y){if(!f(Y))return null;if(Y.writableEnded===!0)return!0;const te=Y._writableState;return te!=null&&te.errored?!1:typeof(te==null?void 0:te.ended)!="boolean"?null:te.ended}function k(Y,te){if(!f(Y))return null;if(Y.writableFinished===!0)return!0;const Q=Y._writableState;return Q!=null&&Q.errored?!1:typeof(Q==null?void 0:Q.finished)!="boolean"?null:!!(Q.finished||te===!1&&Q.ended===!0&&Q.length===0)}function R(Y){if(!u(Y))return null;if(Y.readableEnded===!0)return!0;const te=Y._readableState;return!te||te.errored?!1:typeof(te==null?void 0:te.ended)!="boolean"?null:te.ended}function I(Y,te){if(!u(Y))return null;const Q=Y._readableState;return Q!=null&&Q.errored?!1:typeof(Q==null?void 0:Q.endEmitted)!="boolean"?null:!!(Q.endEmitted||te===!1&&Q.ended===!0&&Q.length===0)}function j(Y){return Y&&Y[i]!=null?Y[i]:typeof(Y==null?void 0:Y.readable)!="boolean"?null:E(Y)?!1:u(Y)&&Y.readable&&!I(Y)}function M(Y){return Y&&Y[a]!=null?Y[a]:typeof(Y==null?void 0:Y.writable)!="boolean"?null:E(Y)?!1:f(Y)&&Y.writable&&!C(Y)}function L(Y,te){return g(Y)?E(Y)?!0:!((te==null?void 0:te.readable)!==!1&&j(Y)||(te==null?void 0:te.writable)!==!1&&M(Y)):null}function q(Y){var te,Q;return g(Y)?Y.writableErrored?Y.writableErrored:(te=(Q=Y._writableState)===null||Q===void 0?void 0:Q.errored)!==null&&te!==void 0?te:null:null}function P(Y){var te,Q;return g(Y)?Y.readableErrored?Y.readableErrored:(te=(Q=Y._readableState)===null||Q===void 0?void 0:Q.errored)!==null&&te!==void 0?te:null:null}function V(Y){if(!g(Y))return null;if(typeof Y.closed=="boolean")return Y.closed;const te=Y._writableState,Q=Y._readableState;return typeof(te==null?void 0:te.closed)=="boolean"||typeof(Q==null?void 0:Q.closed)=="boolean"?(te==null?void 0:te.closed)||(Q==null?void 0:Q.closed):typeof Y._closed=="boolean"&&z(Y)?Y._closed:null}function z(Y){return typeof Y._closed=="boolean"&&typeof Y._defaultKeepAlive=="boolean"&&typeof Y._removedConnection=="boolean"&&typeof Y._removedContLen=="boolean"}function re(Y){return typeof Y._sent100=="boolean"&&z(Y)}function K(Y){var te;return typeof Y._consuming=="boolean"&&typeof Y._dumped=="boolean"&&((te=Y.req)===null||te===void 0?void 0:te.upgradeOrConnect)===void 0}function ee(Y){if(!g(Y))return null;const te=Y._writableState,Q=Y._readableState,ae=te||Q;return!ae&&re(Y)||!!(ae&&ae.autoDestroy&&ae.emitClose&&ae.closed===!1)}function W(Y){var te;return!!(Y&&((te=Y[o])!==null&&te!==void 0?te:Y.readableDidRead||Y.readableAborted))}function se(Y){var te,Q,ae,xe,ge,Me,Pe,Ie,Ce,He;return!!(Y&&((te=(Q=(ae=(xe=(ge=(Me=Y[s])!==null&&Me!==void 0?Me:Y.readableErrored)!==null&&ge!==void 0?ge:Y.writableErrored)!==null&&xe!==void 0?xe:(Pe=Y._readableState)===null||Pe===void 0?void 0:Pe.errorEmitted)!==null&&ae!==void 0?ae:(Ie=Y._writableState)===null||Ie===void 0?void 0:Ie.errorEmitted)!==null&&Q!==void 0?Q:(Ce=Y._readableState)===null||Ce===void 0?void 0:Ce.errored)!==null&&te!==void 0?te:!((He=Y._writableState)===null||He===void 0)&&He.errored))}return yC={isDestroyed:E,kIsDestroyed:r,isDisturbed:W,kIsDisturbed:o,isErrored:se,kIsErrored:s,isReadable:j,kIsReadable:i,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:V,isDuplexNodeStream:m,isFinished:L,isIterable:_,isReadableNodeStream:u,isReadableStream:v,isReadableEnded:R,isReadableFinished:I,isReadableErrored:P,isNodeStream:g,isWebStream:x,isWritable:M,isWritableNodeStream:f,isWritableStream:b,isWritableEnded:C,isWritableFinished:k,isWritableErrored:q,isServerRequest:K,isServerResponse:re,willEmitClose:ee,isTransformStream:w},yC}var tO;function vd(){if(tO)return fw.exports;tO=1;const e=Yf(),{AbortError:t,codes:n}=Gi(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:s}=n,{kEmptyObject:i,once:a}=aa(),{validateAbortSignal:o,validateFunction:l,validateObject:c,validateBoolean:u}=tb(),{Promise:f,PromisePrototypeThen:m,SymbolDispose:g}=os(),{isClosed:v,isReadable:b,isReadableNodeStream:w,isReadableStream:x,isReadableFinished:_,isReadableErrored:E,isWritable:C,isWritableNodeStream:k,isWritableStream:R,isWritableFinished:I,isWritableErrored:j,isNodeStream:M,willEmitClose:L,kIsClosedPromise:q}=qc();let P;function V(W){return W.setHeader&&typeof W.abort=="function"}const z=()=>{};function re(W,se,Y){var te,Q;if(arguments.length===2?(Y=se,se=i):se==null?se=i:c(se,"options"),l(Y,"callback"),o(se.signal,"options.signal"),Y=a(Y),x(W)||R(W))return K(W,se,Y);if(!M(W))throw new r("stream",["ReadableStream","WritableStream","Stream"],W);const ae=(te=se.readable)!==null&&te!==void 0?te:w(W),xe=(Q=se.writable)!==null&&Q!==void 0?Q:k(W),ge=W._writableState,Me=W._readableState,Pe=()=>{W.writable||He()};let Ie=L(W)&&w(W)===ae&&k(W)===xe,Ce=I(W,!1);const He=()=>{Ce=!0,W.destroyed&&(Ie=!1),!(Ie&&(!W.readable||ae))&&(!ae||it)&&Y.call(W)};let it=_(W,!1);const Ge=()=>{it=!0,W.destroyed&&(Ie=!1),!(Ie&&(!W.writable||xe))&&(!xe||Ce)&&Y.call(W)},Re=ne=>{Y.call(W,ne)};let H=v(W);const me=()=>{H=!0;const ne=j(W)||E(W);if(ne&&typeof ne!="boolean")return Y.call(W,ne);if(ae&&!it&&w(W,!0)&&!_(W,!1))return Y.call(W,new s);if(xe&&!Ce&&!I(W,!1))return Y.call(W,new s);Y.call(W)},Te=()=>{H=!0;const ne=j(W)||E(W);if(ne&&typeof ne!="boolean")return Y.call(W,ne);Y.call(W)},ce=()=>{W.req.on("finish",He)};V(W)?(W.on("complete",He),Ie||W.on("abort",me),W.req?ce():W.on("request",ce)):xe&&!ge&&(W.on("end",Pe),W.on("close",Pe)),!Ie&&typeof W.aborted=="boolean"&&W.on("aborted",me),W.on("end",Ge),W.on("finish",He),se.error!==!1&&W.on("error",Re),W.on("close",me),H?e.nextTick(me):ge!=null&&ge.errorEmitted||Me!=null&&Me.errorEmitted?Ie||e.nextTick(Te):(!ae&&(!Ie||b(W))&&(Ce||C(W)===!1)||!xe&&(!Ie||C(W))&&(it||b(W)===!1)||Me&&W.req&&W.aborted)&&e.nextTick(Te);const oe=()=>{Y=z,W.removeListener("aborted",me),W.removeListener("complete",He),W.removeListener("abort",me),W.removeListener("request",ce),W.req&&W.req.removeListener("finish",He),W.removeListener("end",Pe),W.removeListener("close",Pe),W.removeListener("finish",He),W.removeListener("end",Ge),W.removeListener("error",Re),W.removeListener("close",me)};if(se.signal&&!H){const ne=()=>{const Se=Y;oe(),Se.call(W,new t(void 0,{cause:se.signal.reason}))};if(se.signal.aborted)e.nextTick(ne);else{P=P||aa().addAbortListener;const Se=P(se.signal,ne),Fe=Y;Y=a((...ke)=>{Se[g](),Fe.apply(W,ke)})}}return oe}function K(W,se,Y){let te=!1,Q=z;if(se.signal)if(Q=()=>{te=!0,Y.call(W,new t(void 0,{cause:se.signal.reason}))},se.signal.aborted)e.nextTick(Q);else{P=P||aa().addAbortListener;const xe=P(se.signal,Q),ge=Y;Y=a((...Me)=>{xe[g](),ge.apply(W,Me)})}const ae=(...xe)=>{te||e.nextTick(()=>Y.apply(W,xe))};return m(W[q].promise,ae,ae),z}function ee(W,se){var Y;let te=!1;return se===null&&(se=i),(Y=se)!==null&&Y!==void 0&&Y.cleanup&&(u(se.cleanup,"cleanup"),te=se.cleanup),new f((Q,ae)=>{const xe=re(W,se,ge=>{te&&xe(),ge?ae(ge):Q()})})}return fw.exports=re,fw.exports.finished=ee,fw.exports}var bC,nO;function mm(){if(nO)return bC;nO=1;const e=Yf(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=Gi(),{Symbol:s}=os(),{kIsDestroyed:i,isDestroyed:a,isFinished:o,isServerRequest:l}=qc(),c=s("kDestroy"),u=s("kConstruct");function f(L,q,P){L&&(L.stack,q&&!q.errored&&(q.errored=L),P&&!P.errored&&(P.errored=L))}function m(L,q){const P=this._readableState,V=this._writableState,z=V||P;return V!=null&&V.destroyed||P!=null&&P.destroyed?(typeof q=="function"&&q(),this):(f(L,V,P),V&&(V.destroyed=!0),P&&(P.destroyed=!0),z.constructed?g(this,L,q):this.once(c,function(re){g(this,t(re,L),q)}),this)}function g(L,q,P){let V=!1;function z(re){if(V)return;V=!0;const K=L._readableState,ee=L._writableState;f(re,ee,K),ee&&(ee.closed=!0),K&&(K.closed=!0),typeof P=="function"&&P(re),re?e.nextTick(v,L,re):e.nextTick(b,L)}try{L._destroy(q||null,z)}catch(re){z(re)}}function v(L,q){w(L,q),b(L)}function b(L){const q=L._readableState,P=L._writableState;P&&(P.closeEmitted=!0),q&&(q.closeEmitted=!0),(P!=null&&P.emitClose||q!=null&&q.emitClose)&&L.emit("close")}function w(L,q){const P=L._readableState,V=L._writableState;V!=null&&V.errorEmitted||P!=null&&P.errorEmitted||(V&&(V.errorEmitted=!0),P&&(P.errorEmitted=!0),L.emit("error",q))}function x(){const L=this._readableState,q=this._writableState;L&&(L.constructed=!0,L.closed=!1,L.closeEmitted=!1,L.destroyed=!1,L.errored=null,L.errorEmitted=!1,L.reading=!1,L.ended=L.readable===!1,L.endEmitted=L.readable===!1),q&&(q.constructed=!0,q.destroyed=!1,q.closed=!1,q.closeEmitted=!1,q.errored=null,q.errorEmitted=!1,q.finalCalled=!1,q.prefinished=!1,q.ended=q.writable===!1,q.ending=q.writable===!1,q.finished=q.writable===!1)}function _(L,q,P){const V=L._readableState,z=L._writableState;if(z!=null&&z.destroyed||V!=null&&V.destroyed)return this;V!=null&&V.autoDestroy||z!=null&&z.autoDestroy?L.destroy(q):q&&(q.stack,z&&!z.errored&&(z.errored=q),V&&!V.errored&&(V.errored=q),P?e.nextTick(w,L,q):w(L,q))}function E(L,q){if(typeof L._construct!="function")return;const P=L._readableState,V=L._writableState;P&&(P.constructed=!1),V&&(V.constructed=!1),L.once(u,q),!(L.listenerCount(u)>1)&&e.nextTick(C,L)}function C(L){let q=!1;function P(V){if(q){_(L,V??new n);return}q=!0;const z=L._readableState,re=L._writableState,K=re||z;z&&(z.constructed=!0),re&&(re.constructed=!0),K.destroyed?L.emit(c,V):V?_(L,V,!0):e.nextTick(k,L)}try{L._construct(V=>{e.nextTick(P,V)})}catch(V){e.nextTick(P,V)}}function k(L){L.emit(u)}function R(L){return(L==null?void 0:L.setHeader)&&typeof L.abort=="function"}function I(L){L.emit("close")}function j(L,q){L.emit("error",q),e.nextTick(I,L)}function M(L,q){!L||a(L)||(!q&&!o(L)&&(q=new r),l(L)?(L.socket=null,L.destroy(q)):R(L)?L.abort():R(L.req)?L.req.abort():typeof L.destroy=="function"?L.destroy(q):typeof L.close=="function"?L.close():q?e.nextTick(j,L,q):e.nextTick(I,L),L.destroyed||(L[i]=!0))}return bC={construct:E,destroyer:M,destroy:m,undestroy:x,errorOrDestroy:_},bC}var vC,rO;function lN(){if(rO)return vC;rO=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=os(),{EventEmitter:n}=h_();function r(i){n.call(this,i)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(i,a){const o=this;function l(b){i.writable&&i.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function c(){o.readable&&o.resume&&o.resume()}i.on("drain",c),!i._isStdio&&(!a||a.end!==!1)&&(o.on("end",f),o.on("close",m));let u=!1;function f(){u||(u=!0,i.end())}function m(){u||(u=!0,typeof i.destroy=="function"&&i.destroy())}function g(b){v(),n.listenerCount(this,"error")===0&&this.emit("error",b)}s(o,"error",g),s(i,"error",g);function v(){o.removeListener("data",l),i.removeListener("drain",c),o.removeListener("end",f),o.removeListener("close",m),o.removeListener("error",g),i.removeListener("error",g),o.removeListener("end",v),o.removeListener("close",v),i.removeListener("close",v)}return o.on("end",v),o.on("close",v),i.on("close",v),i.emit("pipe",o),i};function s(i,a,o){if(typeof i.prependListener=="function")return i.prependListener(a,o);!i._events||!i._events[a]?i.on(a,o):e(i._events[a])?i._events[a].unshift(o):i._events[a]=[o,i._events[a]]}return vC={Stream:r,prependListener:s},vC}var wC={exports:{}},sO;function p_(){return sO||(sO=1,function(e){const{SymbolDispose:t}=os(),{AbortError:n,codes:r}=Gi(),{isNodeStream:s,isWebStream:i,kControllerErrorFunction:a}=qc(),o=vd(),{ERR_INVALID_ARG_TYPE:l}=r;let c;const u=(f,m)=>{if(typeof f!="object"||!("aborted"in f))throw new l(m,"AbortSignal",f)};e.exports.addAbortSignal=function(m,g){if(u(m,"signal"),!s(g)&&!i(g))throw new l("stream",["ReadableStream","WritableStream","Stream"],g);return e.exports.addAbortSignalNoValidate(m,g)},e.exports.addAbortSignalNoValidate=function(f,m){if(typeof f!="object"||!("aborted"in f))return m;const g=s(m)?()=>{m.destroy(new n(void 0,{cause:f.reason}))}:()=>{m[a](new n(void 0,{cause:f.reason}))};if(f.aborted)g();else{c=c||aa().addAbortListener;const v=c(f,g);o(m,v[t])}return m}}(wC)),wC.exports}var xC,iO;function zoe(){if(iO)return xC;iO=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=os(),{Buffer:s}=bd(),{inspect:i}=aa();return xC=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,c=""+l.data;for(;(l=l.next)!==null;)c+=o+l.data;return c}concat(o){if(this.length===0)return s.alloc(0);const l=s.allocUnsafe(o>>>0);let c=this.head,u=0;for(;c;)n(l,c.data,u),u+=c.data.length,c=c.next;return l}consume(o,l){const c=this.head.data;if(o<c.length){const u=c.slice(0,o);return this.head.data=c.slice(o),u}return o===c.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",c=this.head,u=0;do{const f=c.data;if(o>f.length)l+=f,o-=f.length;else{o===f.length?(l+=f,++u,c.next?this.head=c.next:this.head=this.tail=null):(l+=e(f,0,o),this.head=c,c.data=e(f,o));break}++u}while((c=c.next)!==null);return this.length-=u,l}_getBuffer(o){const l=s.allocUnsafe(o),c=o;let u=this.head,f=0;do{const m=u.data;if(o>m.length)n(l,m,c-o),o-=m.length;else{o===m.length?(n(l,m,c-o),++f,u.next?this.head=u.next:this.head=this.tail=null):(n(l,new r(m.buffer,m.byteOffset,o),c-o),this.head=u,u.data=m.slice(o));break}++f}while((u=u.next)!==null);return this.length-=f,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return i(this,{...l,depth:0,customInspect:!1})}},xC}var _C,aO;function m_(){if(aO)return _C;aO=1;const{MathFloor:e,NumberIsInteger:t}=os(),{validateInteger:n}=tb(),{ERR_INVALID_ARG_VALUE:r}=Gi().codes;let s=16*1024,i=16;function a(u,f,m){return u.highWaterMark!=null?u.highWaterMark:f?u[m]:null}function o(u){return u?i:s}function l(u,f){n(f,"value",0),u?i=f:s=f}function c(u,f,m,g){const v=a(f,g,m);if(v!=null){if(!t(v)||v<0){const b=g?`options.${m}`:"options.highWaterMark";throw new r(b,v)}return e(v)}return o(u.objectMode)}return _C={getHighWaterMark:c,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},_C}var SC={},hw={exports:{}},oO;function cN(){return oO||(oO=1,function(e,t){var n=bd(),r=n.Buffer;function s(a,o){for(var l in a)o[l]=a[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=i);function i(a,o,l){return r(a,o,l)}s(r,i),i.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,l)},i.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=r(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}}(hw,hw.exports)),hw.exports}var lO;function Uoe(){if(lO)return SC;lO=1;var e=cN().Buffer,t=e.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(x){if(!x)return"utf8";for(var _;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(_)return;x=(""+x).toLowerCase(),_=!0}}function r(x){var _=n(x);if(typeof _!="string"&&(e.isEncoding===t||!t(x)))throw new Error("Unknown encoding: "+x);return _||x}SC.StringDecoder=s;function s(x){this.encoding=r(x);var _;switch(this.encoding){case"utf16le":this.text=f,this.end=m,_=4;break;case"utf8":this.fillLast=l,_=4;break;case"base64":this.text=g,this.end=v,_=3;break;default:this.write=b,this.end=w;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(_)}s.prototype.write=function(x){if(x.length===0)return"";var _,E;if(this.lastNeed){if(_=this.fillLast(x),_===void 0)return"";E=this.lastNeed,this.lastNeed=0}else E=0;return E<x.length?_?_+this.text(x,E):this.text(x,E):_||""},s.prototype.end=u,s.prototype.text=c,s.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length};function i(x){return x<=127?0:x>>5===6?2:x>>4===14?3:x>>3===30?4:x>>6===2?-1:-2}function a(x,_,E){var C=_.length-1;if(C<E)return 0;var k=i(_[C]);return k>=0?(k>0&&(x.lastNeed=k-1),k):--C<E||k===-2?0:(k=i(_[C]),k>=0?(k>0&&(x.lastNeed=k-2),k):--C<E||k===-2?0:(k=i(_[C]),k>=0?(k>0&&(k===2?k=0:x.lastNeed=k-3),k):0))}function o(x,_,E){if((_[0]&192)!==128)return x.lastNeed=0,"";if(x.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return x.lastNeed=1,"";if(x.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return x.lastNeed=2,""}}function l(x){var _=this.lastTotal-this.lastNeed,E=o(this,x);if(E!==void 0)return E;if(this.lastNeed<=x.length)return x.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,_,0,x.length),this.lastNeed-=x.length}function c(x,_){var E=a(this,x,_);if(!this.lastNeed)return x.toString("utf8",_);this.lastTotal=E;var C=x.length-(E-this.lastNeed);return x.copy(this.lastChar,0,C),x.toString("utf8",_,C)}function u(x){var _=x&&x.length?this.write(x):"";return this.lastNeed?_+"":_}function f(x,_){if((x.length-_)%2===0){var E=x.toString("utf16le",_);if(E){var C=E.charCodeAt(E.length-1);if(C>=55296&&C<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],E.slice(0,-1)}return E}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",_,x.length-1)}function m(x){var _=x&&x.length?this.write(x):"";if(this.lastNeed){var E=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,E)}return _}function g(x,_){var E=(x.length-_)%3;return E===0?x.toString("base64",_):(this.lastNeed=3-E,this.lastTotal=3,E===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",_,x.length-E))}function v(x){var _=x&&x.length?this.write(x):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function b(x){return x.toString(this.encoding)}function w(x){return x&&x.length?this.write(x):""}return SC}var EC,cO;function kB(){if(cO)return EC;cO=1;const e=Yf(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=os(),{Buffer:s}=bd(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:a}=Gi().codes;function o(l,c,u){let f;if(typeof c=="string"||c instanceof s)return new l({objectMode:!0,...u,read(){this.push(c),this.push(null)}});let m;if(c&&c[n])m=!0,f=c[n]();else if(c&&c[r])m=!1,f=c[r]();else throw new i("iterable",["Iterable"],c);const g=new l({objectMode:!0,highWaterMark:1,...u});let v=!1;g._read=function(){v||(v=!0,w())},g._destroy=function(x,_){t(b(x),()=>e.nextTick(_,x),E=>e.nextTick(_,E||x))};async function b(x){const _=x!=null,E=typeof f.throw=="function";if(_&&E){const{value:C,done:k}=await f.throw(x);if(await C,k)return}if(typeof f.return=="function"){const{value:C}=await f.return();await C}}async function w(){for(;;){try{const{value:x,done:_}=m?await f.next():f.next();if(_)g.push(null);else{const E=x&&typeof x.then=="function"?await x:x;if(E===null)throw v=!1,new a;if(g.push(E))continue;v=!1}}catch(x){g.destroy(x)}break}}return g}return EC=o,EC}var CC,uO;function g_(){if(uO)return CC;uO=1;const e=Yf(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:a,ObjectSetPrototypeOf:o,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:f,Symbol:m}=os();CC=ke,ke.ReadableState=Fe;const{EventEmitter:g}=h_(),{Stream:v,prependListener:b}=lN(),{Buffer:w}=bd(),{addAbortSignal:x}=p_(),_=vd();let E=aa().debuglog("stream",he=>{E=he});const C=zoe(),k=mm(),{getHighWaterMark:R,getDefaultHighWaterMark:I}=m_(),{aggregateTwoErrors:j,codes:{ERR_INVALID_ARG_TYPE:M,ERR_METHOD_NOT_IMPLEMENTED:L,ERR_OUT_OF_RANGE:q,ERR_STREAM_PUSH_AFTER_EOF:P,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:V},AbortError:z}=Gi(),{validateObject:re}=tb(),K=m("kPaused"),{StringDecoder:ee}=Uoe(),W=kB();o(ke.prototype,v.prototype),o(ke,v);const se=()=>{},{errorOrDestroy:Y}=k,te=1,Q=2,ae=4,xe=8,ge=16,Me=32,Pe=64,Ie=128,Ce=256,He=512,it=1024,Ge=2048,Re=4096,H=8192,me=16384,Te=32768,ce=65536,oe=1<<17,ne=1<<18;function Se(he){return{enumerable:!1,get(){return(this.state&he)!==0},set(G){G?this.state|=he:this.state&=~he}}}i(Fe.prototype,{objectMode:Se(te),ended:Se(Q),endEmitted:Se(ae),reading:Se(xe),constructed:Se(ge),sync:Se(Me),needReadable:Se(Pe),emittedReadable:Se(Ie),readableListening:Se(Ce),resumeScheduled:Se(He),errorEmitted:Se(it),emitClose:Se(Ge),autoDestroy:Se(Re),destroyed:Se(H),closed:Se(me),closeEmitted:Se(Te),multiAwaitDrain:Se(ce),readingMore:Se(oe),dataEmitted:Se(ne)});function Fe(he,G,U){typeof U!="boolean"&&(U=G instanceof Oc()),this.state=Ge|Re|ge|Me,he&&he.objectMode&&(this.state|=te),U&&he&&he.readableObjectMode&&(this.state|=te),this.highWaterMark=he?R(this,he,"readableHighWaterMark",U):I(!1),this.buffer=new C,this.length=0,this.pipes=[],this.flowing=null,this[K]=null,he&&he.emitClose===!1&&(this.state&=-2049),he&&he.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=he&&he.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,he&&he.encoding&&(this.decoder=new ee(he.encoding),this.encoding=he.encoding)}function ke(he){if(!(this instanceof ke))return new ke(he);const G=this instanceof Oc();this._readableState=new Fe(he,this,G),he&&(typeof he.read=="function"&&(this._read=he.read),typeof he.destroy=="function"&&(this._destroy=he.destroy),typeof he.construct=="function"&&(this._construct=he.construct),he.signal&&!G&&x(he.signal,this)),v.call(this,he),k.construct(this,()=>{this._readableState.needReadable&&O(this,this._readableState)})}ke.prototype.destroy=k.destroy,ke.prototype._undestroy=k.undestroy,ke.prototype._destroy=function(he,G){G(he)},ke.prototype[g.captureRejectionSymbol]=function(he){this.destroy(he)},ke.prototype[u]=function(){let he;return this.destroyed||(he=this.readableEnded?null:new z,this.destroy(he)),new l((G,U)=>_(this,X=>X&&X!==he?U(X):G(null)))},ke.prototype.push=function(he,G){return Xe(this,he,G,!1)},ke.prototype.unshift=function(he,G){return Xe(this,he,G,!0)};function Xe(he,G,U,X){E("readableAddChunk",G);const pe=he._readableState;let je;if((pe.state&te)===0&&(typeof G=="string"?(U=U||pe.defaultEncoding,pe.encoding!==U&&(X&&pe.encoding?G=w.from(G,U).toString(pe.encoding):(G=w.from(G,U),U=""))):G instanceof w?U="":v._isUint8Array(G)?(G=v._uint8ArrayToBuffer(G),U=""):G!=null&&(je=new M("chunk",["string","Buffer","Uint8Array"],G))),je)Y(he,je);else if(G===null)pe.state&=-9,Ot(he,pe);else if((pe.state&te)!==0||G&&G.length>0)if(X)if((pe.state&ae)!==0)Y(he,new V);else{if(pe.destroyed||pe.errored)return!1;St(he,pe,G,!0)}else if(pe.ended)Y(he,new P);else{if(pe.destroyed||pe.errored)return!1;pe.state&=-9,pe.decoder&&!U?(G=pe.decoder.write(G),pe.objectMode||G.length!==0?St(he,pe,G,!1):O(he,pe)):St(he,pe,G,!1)}else X||(pe.state&=-9,O(he,pe));return!pe.ended&&(pe.length<pe.highWaterMark||pe.length===0)}function St(he,G,U,X){G.flowing&&G.length===0&&!G.sync&&he.listenerCount("data")>0?((G.state&ce)!==0?G.awaitDrainWriters.clear():G.awaitDrainWriters=null,G.dataEmitted=!0,he.emit("data",U)):(G.length+=G.objectMode?1:U.length,X?G.buffer.unshift(U):G.buffer.push(U),(G.state&Pe)!==0&&Gt(he)),O(he,G)}ke.prototype.isPaused=function(){const he=this._readableState;return he[K]===!0||he.flowing===!1},ke.prototype.setEncoding=function(he){const G=new ee(he);this._readableState.decoder=G,this._readableState.encoding=this._readableState.decoder.encoding;const U=this._readableState.buffer;let X="";for(const pe of U)X+=G.write(pe);return U.clear(),X!==""&&U.push(X),this._readableState.length=X.length,this};const ht=1073741824;function It(he){if(he>ht)throw new q("size","<= 1GiB",he);return he--,he|=he>>>1,he|=he>>>2,he|=he>>>4,he|=he>>>8,he|=he>>>16,he++,he}function Vt(he,G){return he<=0||G.length===0&&G.ended?0:(G.state&te)!==0?1:r(he)?G.flowing&&G.length?G.buffer.first().length:G.length:he<=G.length?he:G.ended?G.length:0}ke.prototype.read=function(he){E("read",he),he===void 0?he=NaN:n(he)||(he=s(he,10));const G=this._readableState,U=he;if(he>G.highWaterMark&&(G.highWaterMark=It(he)),he!==0&&(G.state&=-129),he===0&&G.needReadable&&((G.highWaterMark!==0?G.length>=G.highWaterMark:G.length>0)||G.ended))return E("read: emitReadable",G.length,G.ended),G.length===0&&G.ended?rt(this):Gt(this),null;if(he=Vt(he,G),he===0&&G.ended)return G.length===0&&rt(this),null;let X=(G.state&Pe)!==0;if(E("need readable",X),(G.length===0||G.length-he<G.highWaterMark)&&(X=!0,E("length less than watermark",X)),G.ended||G.reading||G.destroyed||G.errored||!G.constructed)X=!1,E("reading, ended or constructing",X);else if(X){E("do read"),G.state|=xe|Me,G.length===0&&(G.state|=Pe);try{this._read(G.highWaterMark)}catch(je){Y(this,je)}G.state&=-33,G.reading||(he=Vt(U,G))}let pe;return he>0?pe=ze(he,G):pe=null,pe===null?(G.needReadable=G.length<=G.highWaterMark,he=0):(G.length-=he,G.multiAwaitDrain?G.awaitDrainWriters.clear():G.awaitDrainWriters=null),G.length===0&&(G.ended||(G.needReadable=!0),U!==he&&G.ended&&rt(this)),pe!==null&&!G.errorEmitted&&!G.closeEmitted&&(G.dataEmitted=!0,this.emit("data",pe)),pe};function Ot(he,G){if(E("onEofChunk"),!G.ended){if(G.decoder){const U=G.decoder.end();U&&U.length&&(G.buffer.push(U),G.length+=G.objectMode?1:U.length)}G.ended=!0,G.sync?Gt(he):(G.needReadable=!1,G.emittedReadable=!0,be(he))}}function Gt(he){const G=he._readableState;E("emitReadable",G.needReadable,G.emittedReadable),G.needReadable=!1,G.emittedReadable||(E("emitReadable",G.flowing),G.emittedReadable=!0,e.nextTick(be,he))}function be(he){const G=he._readableState;E("emitReadable_",G.destroyed,G.length,G.ended),!G.destroyed&&!G.errored&&(G.length||G.ended)&&(he.emit("readable"),G.emittedReadable=!1),G.needReadable=!G.flowing&&!G.ended&&G.length<=G.highWaterMark,mt(he)}function O(he,G){!G.readingMore&&G.constructed&&(G.readingMore=!0,e.nextTick(Z,he,G))}function Z(he,G){for(;!G.reading&&!G.ended&&(G.length<G.highWaterMark||G.flowing&&G.length===0);){const U=G.length;if(E("maybeReadMore read 0"),he.read(0),U===G.length)break}G.readingMore=!1}ke.prototype._read=function(he){throw new L("_read()")},ke.prototype.pipe=function(he,G){const U=this,X=this._readableState;X.pipes.length===1&&(X.multiAwaitDrain||(X.multiAwaitDrain=!0,X.awaitDrainWriters=new c(X.awaitDrainWriters?[X.awaitDrainWriters]:[]))),X.pipes.push(he),E("pipe count=%d opts=%j",X.pipes.length,G);const je=(!G||G.end!==!1)&&he!==e.stdout&&he!==e.stderr?bt:Mr;X.endEmitted?e.nextTick(je):U.once("end",je),he.on("unpipe",Ke);function Ke(Gn,Mi){E("onunpipe"),Gn===U&&Mi&&Mi.hasUnpiped===!1&&(Mi.hasUnpiped=!0,Ht())}function bt(){E("onend"),he.end()}let Kt,yn=!1;function Ht(){E("cleanup"),he.removeListener("close",Qn),he.removeListener("finish",jr),Kt&&he.removeListener("drain",Kt),he.removeListener("error",qn),he.removeListener("unpipe",Ke),U.removeListener("end",bt),U.removeListener("end",Mr),U.removeListener("data",an),yn=!0,Kt&&X.awaitDrainWriters&&(!he._writableState||he._writableState.needDrain)&&Kt()}function Yt(){yn||(X.pipes.length===1&&X.pipes[0]===he?(E("false write response, pause",0),X.awaitDrainWriters=he,X.multiAwaitDrain=!1):X.pipes.length>1&&X.pipes.includes(he)&&(E("false write response, pause",X.awaitDrainWriters.size),X.awaitDrainWriters.add(he)),U.pause()),Kt||(Kt=fe(U,he),he.on("drain",Kt))}U.on("data",an);function an(Gn){E("ondata");const Mi=he.write(Gn);E("dest.write",Mi),Mi===!1&&Yt()}function qn(Gn){if(E("onerror",Gn),Mr(),he.removeListener("error",qn),he.listenerCount("error")===0){const Mi=he._writableState||he._readableState;Mi&&!Mi.errorEmitted?Y(he,Gn):he.emit("error",Gn)}}b(he,"error",qn);function Qn(){he.removeListener("finish",jr),Mr()}he.once("close",Qn);function jr(){E("onfinish"),he.removeListener("close",Qn),Mr()}he.once("finish",jr);function Mr(){E("unpipe"),U.unpipe(he)}return he.emit("pipe",U),he.writableNeedDrain===!0?Yt():X.flowing||(E("pipe resume"),U.resume()),he};function fe(he,G){return function(){const X=he._readableState;X.awaitDrainWriters===G?(E("pipeOnDrain",1),X.awaitDrainWriters=null):X.multiAwaitDrain&&(E("pipeOnDrain",X.awaitDrainWriters.size),X.awaitDrainWriters.delete(G)),(!X.awaitDrainWriters||X.awaitDrainWriters.size===0)&&he.listenerCount("data")&&he.resume()}}ke.prototype.unpipe=function(he){const G=this._readableState,U={hasUnpiped:!1};if(G.pipes.length===0)return this;if(!he){const pe=G.pipes;G.pipes=[],this.pause();for(let je=0;je<pe.length;je++)pe[je].emit("unpipe",this,{hasUnpiped:!1});return this}const X=t(G.pipes,he);return X===-1?this:(G.pipes.splice(X,1),G.pipes.length===0&&this.pause(),he.emit("unpipe",this,U),this)},ke.prototype.on=function(he,G){const U=v.prototype.on.call(this,he,G),X=this._readableState;return he==="data"?(X.readableListening=this.listenerCount("readable")>0,X.flowing!==!1&&this.resume()):he==="readable"&&!X.endEmitted&&!X.readableListening&&(X.readableListening=X.needReadable=!0,X.flowing=!1,X.emittedReadable=!1,E("on readable",X.length,X.reading),X.length?Gt(this):X.reading||e.nextTick(ve,this)),U},ke.prototype.addListener=ke.prototype.on,ke.prototype.removeListener=function(he,G){const U=v.prototype.removeListener.call(this,he,G);return he==="readable"&&e.nextTick(Oe,this),U},ke.prototype.off=ke.prototype.removeListener,ke.prototype.removeAllListeners=function(he){const G=v.prototype.removeAllListeners.apply(this,arguments);return(he==="readable"||he===void 0)&&e.nextTick(Oe,this),G};function Oe(he){const G=he._readableState;G.readableListening=he.listenerCount("readable")>0,G.resumeScheduled&&G[K]===!1?G.flowing=!0:he.listenerCount("data")>0?he.resume():G.readableListening||(G.flowing=null)}function ve(he){E("readable nexttick read 0"),he.read(0)}ke.prototype.resume=function(){const he=this._readableState;return he.flowing||(E("resume"),he.flowing=!he.readableListening,Ae(this,he)),he[K]=!1,this};function Ae(he,G){G.resumeScheduled||(G.resumeScheduled=!0,e.nextTick(ue,he,G))}function ue(he,G){E("resume",G.reading),G.reading||he.read(0),G.resumeScheduled=!1,he.emit("resume"),mt(he),G.flowing&&!G.reading&&he.read(0)}ke.prototype.pause=function(){return E("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(E("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[K]=!0,this};function mt(he){const G=he._readableState;for(E("flow",G.flowing);G.flowing&&he.read()!==null;);}ke.prototype.wrap=function(he){let G=!1;he.on("data",X=>{!this.push(X)&&he.pause&&(G=!0,he.pause())}),he.on("end",()=>{this.push(null)}),he.on("error",X=>{Y(this,X)}),he.on("close",()=>{this.destroy()}),he.on("destroy",()=>{this.destroy()}),this._read=()=>{G&&he.resume&&(G=!1,he.resume())};const U=a(he);for(let X=1;X<U.length;X++){const pe=U[X];this[pe]===void 0&&typeof he[pe]=="function"&&(this[pe]=he[pe].bind(he))}return this},ke.prototype[f]=function(){return wt(this)},ke.prototype.iterator=function(he){return he!==void 0&&re(he,"options"),wt(this,he)};function wt(he,G){typeof he.read!="function"&&(he=ke.wrap(he,{objectMode:!0}));const U=B(he,G);return U.stream=he,U}async function*B(he,G){let U=se;function X(Ke){this===he?(U(),U=se):U=Ke}he.on("readable",X);let pe;const je=_(he,{writable:!1},Ke=>{pe=Ke?j(pe,Ke):null,U(),U=se});try{for(;;){const Ke=he.destroyed?null:he.read();if(Ke!==null)yield Ke;else{if(pe)throw pe;if(pe===null)return;await new l(X)}}}catch(Ke){throw pe=j(pe,Ke),pe}finally{(pe||(G==null?void 0:G.destroyOnReturn)!==!1)&&(pe===void 0||he._readableState.autoDestroy)?k.destroyer(he,null):(he.off("readable",X),je())}}i(ke.prototype,{readable:{__proto__:null,get(){const he=this._readableState;return!!he&&he.readable!==!1&&!he.destroyed&&!he.errorEmitted&&!he.endEmitted},set(he){this._readableState&&(this._readableState.readable=!!he)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(he){this._readableState&&(this._readableState.flowing=he)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(he){this._readableState&&(this._readableState.destroyed=he)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Fe.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[K]!==!1},set(he){this[K]=!!he}}}),ke._fromList=ze;function ze(he,G){if(G.length===0)return null;let U;return G.objectMode?U=G.buffer.shift():!he||he>=G.length?(G.decoder?U=G.buffer.join(""):G.buffer.length===1?U=G.buffer.first():U=G.buffer.concat(G.length),G.buffer.clear()):U=G.buffer.consume(he,G.decoder),U}function rt(he){const G=he._readableState;E("endReadable",G.endEmitted),G.endEmitted||(G.ended=!0,e.nextTick(ye,G,he))}function ye(he,G){if(E("endReadableNT",he.endEmitted,he.length),!he.errored&&!he.closeEmitted&&!he.endEmitted&&he.length===0){if(he.endEmitted=!0,G.emit("end"),G.writable&&G.allowHalfOpen===!1)e.nextTick(we,G);else if(he.autoDestroy){const U=G._writableState;(!U||U.autoDestroy&&(U.finished||U.writable===!1))&&G.destroy()}}}function we(he){he.writable&&!he.writableEnded&&!he.destroyed&&he.end()}ke.from=function(he,G){return W(ke,he,G)};let Ue;function Et(){return Ue===void 0&&(Ue={}),Ue}return ke.fromWeb=function(he,G){return Et().newStreamReadableFromReadableStream(he,G)},ke.toWeb=function(he,G){return Et().newReadableStreamFromStreamReadable(he,G)},ke.wrap=function(he,G){var U,X;return new ke({objectMode:(U=(X=he.readableObjectMode)!==null&&X!==void 0?X:he.objectMode)!==null&&U!==void 0?U:!0,...G,destroy(pe,je){k.destroyer(he,pe),je(pe)}}).wrap(he)},CC}var kC,dO;function uN(){if(dO)return kC;dO=1;const e=Yf(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:c}=os();kC=re,re.WritableState=V;const{EventEmitter:u}=h_(),f=lN().Stream,{Buffer:m}=bd(),g=mm(),{addAbortSignal:v}=p_(),{getHighWaterMark:b,getDefaultHighWaterMark:w}=m_(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:_,ERR_MULTIPLE_CALLBACK:E,ERR_STREAM_CANNOT_PIPE:C,ERR_STREAM_DESTROYED:k,ERR_STREAM_ALREADY_FINISHED:R,ERR_STREAM_NULL_VALUES:I,ERR_STREAM_WRITE_AFTER_END:j,ERR_UNKNOWN_ENCODING:M}=Gi().codes,{errorOrDestroy:L}=g;a(re.prototype,f.prototype),a(re,f);function q(){}const P=l("kOnFinished");function V(Re,H,me){typeof me!="boolean"&&(me=H instanceof Oc()),this.objectMode=!!(Re&&Re.objectMode),me&&(this.objectMode=this.objectMode||!!(Re&&Re.writableObjectMode)),this.highWaterMark=Re?b(this,Re,"writableHighWaterMark",me):w(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Te=!!(Re&&Re.decodeStrings===!1);this.decodeStrings=!Te,this.defaultEncoding=Re&&Re.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=Y.bind(void 0,H),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,z(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!Re||Re.emitClose!==!1,this.autoDestroy=!Re||Re.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[P]=[]}function z(Re){Re.buffered=[],Re.bufferedIndex=0,Re.allBuffers=!0,Re.allNoop=!0}V.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},s(V.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function re(Re){const H=this instanceof Oc();if(!H&&!r(re,this))return new re(Re);this._writableState=new V(Re,this,H),Re&&(typeof Re.write=="function"&&(this._write=Re.write),typeof Re.writev=="function"&&(this._writev=Re.writev),typeof Re.destroy=="function"&&(this._destroy=Re.destroy),typeof Re.final=="function"&&(this._final=Re.final),typeof Re.construct=="function"&&(this._construct=Re.construct),Re.signal&&v(Re.signal,this)),f.call(this,Re),g.construct(this,()=>{const me=this._writableState;me.writing||xe(this,me),Ie(this,me)})}s(re,c,{__proto__:null,value:function(Re){return r(this,Re)?!0:this!==re?!1:Re&&Re._writableState instanceof V}}),re.prototype.pipe=function(){L(this,new C)};function K(Re,H,me,Te){const ce=Re._writableState;if(typeof me=="function")Te=me,me=ce.defaultEncoding;else{if(!me)me=ce.defaultEncoding;else if(me!=="buffer"&&!m.isEncoding(me))throw new M(me);typeof Te!="function"&&(Te=q)}if(H===null)throw new I;if(!ce.objectMode)if(typeof H=="string")ce.decodeStrings!==!1&&(H=m.from(H,me),me="buffer");else if(H instanceof m)me="buffer";else if(f._isUint8Array(H))H=f._uint8ArrayToBuffer(H),me="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],H);let oe;return ce.ending?oe=new j:ce.destroyed&&(oe=new k("write")),oe?(e.nextTick(Te,oe),L(Re,oe,!0),oe):(ce.pendingcb++,ee(Re,ce,H,me,Te))}re.prototype.write=function(Re,H,me){return K(this,Re,H,me)===!0},re.prototype.cork=function(){this._writableState.corked++},re.prototype.uncork=function(){const Re=this._writableState;Re.corked&&(Re.corked--,Re.writing||xe(this,Re))},re.prototype.setDefaultEncoding=function(H){if(typeof H=="string"&&(H=o(H)),!m.isEncoding(H))throw new M(H);return this._writableState.defaultEncoding=H,this};function ee(Re,H,me,Te,ce){const oe=H.objectMode?1:me.length;H.length+=oe;const ne=H.length<H.highWaterMark;return ne||(H.needDrain=!0),H.writing||H.corked||H.errored||!H.constructed?(H.buffered.push({chunk:me,encoding:Te,callback:ce}),H.allBuffers&&Te!=="buffer"&&(H.allBuffers=!1),H.allNoop&&ce!==q&&(H.allNoop=!1)):(H.writelen=oe,H.writecb=ce,H.writing=!0,H.sync=!0,Re._write(me,Te,H.onwrite),H.sync=!1),ne&&!H.errored&&!H.destroyed}function W(Re,H,me,Te,ce,oe,ne){H.writelen=Te,H.writecb=ne,H.writing=!0,H.sync=!0,H.destroyed?H.onwrite(new k("write")):me?Re._writev(ce,H.onwrite):Re._write(ce,oe,H.onwrite),H.sync=!1}function se(Re,H,me,Te){--H.pendingcb,Te(me),ae(H),L(Re,me)}function Y(Re,H){const me=Re._writableState,Te=me.sync,ce=me.writecb;if(typeof ce!="function"){L(Re,new E);return}me.writing=!1,me.writecb=null,me.length-=me.writelen,me.writelen=0,H?(H.stack,me.errored||(me.errored=H),Re._readableState&&!Re._readableState.errored&&(Re._readableState.errored=H),Te?e.nextTick(se,Re,me,H,ce):se(Re,me,H,ce)):(me.buffered.length>me.bufferedIndex&&xe(Re,me),Te?me.afterWriteTickInfo!==null&&me.afterWriteTickInfo.cb===ce?me.afterWriteTickInfo.count++:(me.afterWriteTickInfo={count:1,cb:ce,stream:Re,state:me},e.nextTick(te,me.afterWriteTickInfo)):Q(Re,me,1,ce))}function te({stream:Re,state:H,count:me,cb:Te}){return H.afterWriteTickInfo=null,Q(Re,H,me,Te)}function Q(Re,H,me,Te){for(!H.ending&&!Re.destroyed&&H.length===0&&H.needDrain&&(H.needDrain=!1,Re.emit("drain"));me-- >0;)H.pendingcb--,Te();H.destroyed&&ae(H),Ie(Re,H)}function ae(Re){if(Re.writing)return;for(let ce=Re.bufferedIndex;ce<Re.buffered.length;++ce){var H;const{chunk:oe,callback:ne}=Re.buffered[ce],Se=Re.objectMode?1:oe.length;Re.length-=Se,ne((H=Re.errored)!==null&&H!==void 0?H:new k("write"))}const me=Re[P].splice(0);for(let ce=0;ce<me.length;ce++){var Te;me[ce]((Te=Re.errored)!==null&&Te!==void 0?Te:new k("end"))}z(Re)}function xe(Re,H){if(H.corked||H.bufferProcessing||H.destroyed||!H.constructed)return;const{buffered:me,bufferedIndex:Te,objectMode:ce}=H,oe=me.length-Te;if(!oe)return;let ne=Te;if(H.bufferProcessing=!0,oe>1&&Re._writev){H.pendingcb-=oe-1;const Se=H.allNoop?q:ke=>{for(let Xe=ne;Xe<me.length;++Xe)me[Xe].callback(ke)},Fe=H.allNoop&&ne===0?me:t(me,ne);Fe.allBuffers=H.allBuffers,W(Re,H,!0,H.length,Fe,"",Se),z(H)}else{do{const{chunk:Se,encoding:Fe,callback:ke}=me[ne];me[ne++]=null;const Xe=ce?1:Se.length;W(Re,H,!1,Xe,Se,Fe,ke)}while(ne<me.length&&!H.writing);ne===me.length?z(H):ne>256?(me.splice(0,ne),H.bufferedIndex=0):H.bufferedIndex=ne}H.bufferProcessing=!1}re.prototype._write=function(Re,H,me){if(this._writev)this._writev([{chunk:Re,encoding:H}],me);else throw new _("_write()")},re.prototype._writev=null,re.prototype.end=function(Re,H,me){const Te=this._writableState;typeof Re=="function"?(me=Re,Re=null,H=null):typeof H=="function"&&(me=H,H=null);let ce;if(Re!=null){const oe=K(this,Re,H);oe instanceof n&&(ce=oe)}return Te.corked&&(Te.corked=1,this.uncork()),ce||(!Te.errored&&!Te.ending?(Te.ending=!0,Ie(this,Te,!0),Te.ended=!0):Te.finished?ce=new R("end"):Te.destroyed&&(ce=new k("end"))),typeof me=="function"&&(ce||Te.finished?e.nextTick(me,ce):Te[P].push(me)),this};function ge(Re){return Re.ending&&!Re.destroyed&&Re.constructed&&Re.length===0&&!Re.errored&&Re.buffered.length===0&&!Re.finished&&!Re.writing&&!Re.errorEmitted&&!Re.closeEmitted}function Me(Re,H){let me=!1;function Te(ce){if(me){L(Re,ce??E());return}if(me=!0,H.pendingcb--,ce){const oe=H[P].splice(0);for(let ne=0;ne<oe.length;ne++)oe[ne](ce);L(Re,ce,H.sync)}else ge(H)&&(H.prefinished=!0,Re.emit("prefinish"),H.pendingcb++,e.nextTick(Ce,Re,H))}H.sync=!0,H.pendingcb++;try{Re._final(Te)}catch(ce){Te(ce)}H.sync=!1}function Pe(Re,H){!H.prefinished&&!H.finalCalled&&(typeof Re._final=="function"&&!H.destroyed?(H.finalCalled=!0,Me(Re,H)):(H.prefinished=!0,Re.emit("prefinish")))}function Ie(Re,H,me){ge(H)&&(Pe(Re,H),H.pendingcb===0&&(me?(H.pendingcb++,e.nextTick((Te,ce)=>{ge(ce)?Ce(Te,ce):ce.pendingcb--},Re,H)):ge(H)&&(H.pendingcb++,Ce(Re,H))))}function Ce(Re,H){H.pendingcb--,H.finished=!0;const me=H[P].splice(0);for(let Te=0;Te<me.length;Te++)me[Te]();if(Re.emit("finish"),H.autoDestroy){const Te=Re._readableState;(!Te||Te.autoDestroy&&(Te.endEmitted||Te.readable===!1))&&Re.destroy()}}i(re.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(Re){this._writableState&&(this._writableState.destroyed=Re)}},writable:{__proto__:null,get(){const Re=this._writableState;return!!Re&&Re.writable!==!1&&!Re.destroyed&&!Re.errored&&!Re.ending&&!Re.ended},set(Re){this._writableState&&(this._writableState.writable=!!Re)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const Re=this._writableState;return Re?!Re.destroyed&&!Re.ending&&Re.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const He=g.destroy;re.prototype.destroy=function(Re,H){const me=this._writableState;return!me.destroyed&&(me.bufferedIndex<me.buffered.length||me[P].length)&&e.nextTick(ae,me),He.call(this,Re,H),this},re.prototype._undestroy=g.undestroy,re.prototype._destroy=function(Re,H){H(Re)},re.prototype[u.captureRejectionSymbol]=function(Re){this.destroy(Re)};let it;function Ge(){return it===void 0&&(it={}),it}return re.fromWeb=function(Re,H){return Ge().newStreamWritableFromWritableStream(Re,H)},re.toWeb=function(Re){return Ge().newWritableStreamFromStreamWritable(Re)},kC}var TC,fO;function qoe(){if(fO)return TC;fO=1;const e=Yf(),t=bd(),{isReadable:n,isWritable:r,isIterable:s,isNodeStream:i,isReadableNodeStream:a,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=qc(),f=vd(),{AbortError:m,codes:{ERR_INVALID_ARG_TYPE:g,ERR_INVALID_RETURN_VALUE:v}}=Gi(),{destroyer:b}=mm(),w=Oc(),x=g_(),_=uN(),{createDeferredPromise:E}=aa(),C=kB(),k=globalThis.Blob||t.Blob,R=typeof k<"u"?function(V){return V instanceof k}:function(V){return!1},I=globalThis.AbortController||ny().AbortController,{FunctionPrototypeCall:j}=os();class M extends w{constructor(V){super(V),(V==null?void 0:V.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(V==null?void 0:V.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}TC=function P(V,z){if(l(V))return V;if(a(V))return q({readable:V});if(o(V))return q({writable:V});if(i(V))return q({writable:!1,readable:!1});if(c(V))return q({readable:x.fromWeb(V)});if(u(V))return q({writable:_.fromWeb(V)});if(typeof V=="function"){const{value:K,write:ee,final:W,destroy:se}=L(V);if(s(K))return C(M,K,{objectMode:!0,write:ee,final:W,destroy:se});const Y=K==null?void 0:K.then;if(typeof Y=="function"){let te;const Q=j(Y,K,ae=>{if(ae!=null)throw new v("nully","body",ae)},ae=>{b(te,ae)});return te=new M({objectMode:!0,readable:!1,write:ee,final(ae){W(async()=>{try{await Q,e.nextTick(ae,null)}catch(xe){e.nextTick(ae,xe)}})},destroy:se})}throw new v("Iterable, AsyncIterable or AsyncFunction",z,K)}if(R(V))return P(V.arrayBuffer());if(s(V))return C(M,V,{objectMode:!0,writable:!1});if(c(V==null?void 0:V.readable)&&u(V==null?void 0:V.writable))return M.fromWeb(V);if(typeof(V==null?void 0:V.writable)=="object"||typeof(V==null?void 0:V.readable)=="object"){const K=V!=null&&V.readable?a(V==null?void 0:V.readable)?V==null?void 0:V.readable:P(V.readable):void 0,ee=V!=null&&V.writable?o(V==null?void 0:V.writable)?V==null?void 0:V.writable:P(V.writable):void 0;return q({readable:K,writable:ee})}const re=V==null?void 0:V.then;if(typeof re=="function"){let K;return j(re,V,ee=>{ee!=null&&K.push(ee),K.push(null)},ee=>{b(K,ee)}),K=new M({objectMode:!0,writable:!1,read(){}})}throw new g(z,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],V)};function L(P){let{promise:V,resolve:z}=E();const re=new I,K=re.signal;return{value:P(async function*(){for(;;){const W=V;V=null;const{chunk:se,done:Y,cb:te}=await W;if(e.nextTick(te),Y)return;if(K.aborted)throw new m(void 0,{cause:K.reason});({promise:V,resolve:z}=E()),yield se}}(),{signal:K}),write(W,se,Y){const te=z;z=null,te({chunk:W,done:!1,cb:Y})},final(W){const se=z;z=null,se({done:!0,cb:W})},destroy(W,se){re.abort(),se(W)}}}function q(P){const V=P.readable&&typeof P.readable.read!="function"?x.wrap(P.readable):P.readable,z=P.writable;let re=!!n(V),K=!!r(z),ee,W,se,Y,te;function Q(ae){const xe=Y;Y=null,xe?xe(ae):ae&&te.destroy(ae)}return te=new M({readableObjectMode:!!(V!=null&&V.readableObjectMode),writableObjectMode:!!(z!=null&&z.writableObjectMode),readable:re,writable:K}),K&&(f(z,ae=>{K=!1,ae&&b(V,ae),Q(ae)}),te._write=function(ae,xe,ge){z.write(ae,xe)?ge():ee=ge},te._final=function(ae){z.end(),W=ae},z.on("drain",function(){if(ee){const ae=ee;ee=null,ae()}}),z.on("finish",function(){if(W){const ae=W;W=null,ae()}})),re&&(f(V,ae=>{re=!1,ae&&b(V,ae),Q(ae)}),V.on("readable",function(){if(se){const ae=se;se=null,ae()}}),V.on("end",function(){te.push(null)}),te._read=function(){for(;;){const ae=V.read();if(ae===null){se=te._read;return}if(!te.push(ae))return}}),te._destroy=function(ae,xe){!ae&&Y!==null&&(ae=new m),se=null,ee=null,W=null,Y===null?xe(ae):(Y=xe,b(z,ae),b(V,ae))},te}return TC}var AC,hO;function Oc(){if(hO)return AC;hO=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=os();AC=a;const s=g_(),i=uN();r(a.prototype,s.prototype),r(a,s);{const u=n(i.prototype);for(let f=0;f<u.length;f++){const m=u[f];a.prototype[m]||(a.prototype[m]=i.prototype[m])}}function a(u){if(!(this instanceof a))return new a(u);s.call(this,u),i.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(a.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let o;function l(){return o===void 0&&(o={}),o}a.fromWeb=function(u,f){return l().newStreamDuplexFromReadableWritablePair(u,f)},a.toWeb=function(u){return l().newReadableWritablePairFromDuplex(u)};let c;return a.from=function(u){return c||(c=qoe()),c(u,"body")},AC}var RC,pO;function TB(){if(pO)return RC;pO=1;const{ObjectSetPrototypeOf:e,Symbol:t}=os();RC=a;const{ERR_METHOD_NOT_IMPLEMENTED:n}=Gi().codes,r=Oc(),{getHighWaterMark:s}=m_();e(a.prototype,r.prototype),e(a,r);const i=t("kCallback");function a(c){if(!(this instanceof a))return new a(c);const u=c?s(this,c,"readableHighWaterMark",!0):null;u===0&&(c={...c,highWaterMark:null,readableHighWaterMark:u,writableHighWaterMark:c.writableHighWaterMark||0}),r.call(this,c),this._readableState.sync=!1,this[i]=null,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function o(c){typeof this._flush=="function"&&!this.destroyed?this._flush((u,f)=>{if(u){c?c(u):this.destroy(u);return}f!=null&&this.push(f),this.push(null),c&&c()}):(this.push(null),c&&c())}function l(){this._final!==o&&o.call(this)}return a.prototype._final=o,a.prototype._transform=function(c,u,f){throw new n("_transform()")},a.prototype._write=function(c,u,f){const m=this._readableState,g=this._writableState,v=m.length;this._transform(c,u,(b,w)=>{if(b){f(b);return}w!=null&&this.push(w),g.ended||v===m.length||m.length<m.highWaterMark?f():this[i]=f})},a.prototype._read=function(){if(this[i]){const c=this[i];this[i]=null,c()}},RC}var NC,mO;function AB(){if(mO)return NC;mO=1;const{ObjectSetPrototypeOf:e}=os();NC=n;const t=TB();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,s,i){i(null,r)},NC}var IC,gO;function dN(){if(gO)return IC;gO=1;const e=Yf(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:s}=os(),i=vd(),{once:a}=aa(),o=mm(),l=Oc(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:f,ERR_MISSING_ARGS:m,ERR_STREAM_DESTROYED:g,ERR_STREAM_PREMATURE_CLOSE:v},AbortError:b}=Gi(),{validateFunction:w,validateAbortSignal:x}=tb(),{isIterable:_,isReadable:E,isReadableNodeStream:C,isNodeStream:k,isTransformStream:R,isWebStream:I,isReadableStream:j,isReadableFinished:M}=qc(),L=globalThis.AbortController||ny().AbortController;let q,P,V;function z(ae,xe,ge){let Me=!1;ae.on("close",()=>{Me=!0});const Pe=i(ae,{readable:xe,writable:ge},Ie=>{Me=!Ie});return{destroy:Ie=>{Me||(Me=!0,o.destroyer(ae,Ie||new g("pipe")))},cleanup:Pe}}function re(ae){return w(ae[ae.length-1],"streams[stream.length - 1]"),ae.pop()}function K(ae){if(_(ae))return ae;if(C(ae))return ee(ae);throw new u("val",["Readable","Iterable","AsyncIterable"],ae)}async function*ee(ae){P||(P=g_()),yield*P.prototype[r].call(ae)}async function W(ae,xe,ge,{end:Me}){let Pe,Ie=null;const Ce=Ge=>{if(Ge&&(Pe=Ge),Ie){const Re=Ie;Ie=null,Re()}},He=()=>new n((Ge,Re)=>{Pe?Re(Pe):Ie=()=>{Pe?Re(Pe):Ge()}});xe.on("drain",Ce);const it=i(xe,{readable:!1},Ce);try{xe.writableNeedDrain&&await He();for await(const Ge of ae)xe.write(Ge)||await He();Me&&(xe.end(),await He()),ge()}catch(Ge){ge(Pe!==Ge?c(Pe,Ge):Ge)}finally{it(),xe.off("drain",Ce)}}async function se(ae,xe,ge,{end:Me}){R(xe)&&(xe=xe.writable);const Pe=xe.getWriter();try{for await(const Ie of ae)await Pe.ready,Pe.write(Ie).catch(()=>{});await Pe.ready,Me&&await Pe.close(),ge()}catch(Ie){try{await Pe.abort(Ie),ge(Ie)}catch(Ce){ge(Ce)}}}function Y(...ae){return te(ae,a(re(ae)))}function te(ae,xe,ge){if(ae.length===1&&t(ae[0])&&(ae=ae[0]),ae.length<2)throw new m("streams");const Me=new L,Pe=Me.signal,Ie=ge==null?void 0:ge.signal,Ce=[];x(Ie,"options.signal");function He(){ce(new b)}V=V||aa().addAbortListener;let it;Ie&&(it=V(Ie,He));let Ge,Re;const H=[];let me=0;function Te(ke){ce(ke,--me===0)}function ce(ke,Xe){var St;if(ke&&(!Ge||Ge.code==="ERR_STREAM_PREMATURE_CLOSE")&&(Ge=ke),!(!Ge&&!Xe)){for(;H.length;)H.shift()(Ge);(St=it)===null||St===void 0||St[s](),Me.abort(),Xe&&(Ge||Ce.forEach(ht=>ht()),e.nextTick(xe,Ge,Re))}}let oe;for(let ke=0;ke<ae.length;ke++){const Xe=ae[ke],St=ke<ae.length-1,ht=ke>0,It=St||(ge==null?void 0:ge.end)!==!1,Vt=ke===ae.length-1;if(k(Xe)){let Ot=function(Gt){Gt&&Gt.name!=="AbortError"&&Gt.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Te(Gt)};var Fe=Ot;if(It){const{destroy:Gt,cleanup:be}=z(Xe,St,ht);H.push(Gt),E(Xe)&&Vt&&Ce.push(be)}Xe.on("error",Ot),E(Xe)&&Vt&&Ce.push(()=>{Xe.removeListener("error",Ot)})}if(ke===0)if(typeof Xe=="function"){if(oe=Xe({signal:Pe}),!_(oe))throw new f("Iterable, AsyncIterable or Stream","source",oe)}else _(Xe)||C(Xe)||R(Xe)?oe=Xe:oe=l.from(Xe);else if(typeof Xe=="function"){if(R(oe)){var ne;oe=K((ne=oe)===null||ne===void 0?void 0:ne.readable)}else oe=K(oe);if(oe=Xe(oe,{signal:Pe}),St){if(!_(oe,!0))throw new f("AsyncIterable",`transform[${ke-1}]`,oe)}else{var Se;q||(q=AB());const Ot=new q({objectMode:!0}),Gt=(Se=oe)===null||Se===void 0?void 0:Se.then;if(typeof Gt=="function")me++,Gt.call(oe,Z=>{Re=Z,Z!=null&&Ot.write(Z),It&&Ot.end(),e.nextTick(Te)},Z=>{Ot.destroy(Z),e.nextTick(Te,Z)});else if(_(oe,!0))me++,W(oe,Ot,Te,{end:It});else if(j(oe)||R(oe)){const Z=oe.readable||oe;me++,W(Z,Ot,Te,{end:It})}else throw new f("AsyncIterable or Promise","destination",oe);oe=Ot;const{destroy:be,cleanup:O}=z(oe,!1,!0);H.push(be),Vt&&Ce.push(O)}}else if(k(Xe)){if(C(oe)){me+=2;const Ot=Q(oe,Xe,Te,{end:It});E(Xe)&&Vt&&Ce.push(Ot)}else if(R(oe)||j(oe)){const Ot=oe.readable||oe;me++,W(Ot,Xe,Te,{end:It})}else if(_(oe))me++,W(oe,Xe,Te,{end:It});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=Xe}else if(I(Xe)){if(C(oe))me++,se(K(oe),Xe,Te,{end:It});else if(j(oe)||_(oe))me++,se(oe,Xe,Te,{end:It});else if(R(oe))me++,se(oe.readable,Xe,Te,{end:It});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=Xe}else oe=l.from(Xe)}return(Pe!=null&&Pe.aborted||Ie!=null&&Ie.aborted)&&e.nextTick(He),oe}function Q(ae,xe,ge,{end:Me}){let Pe=!1;if(xe.on("close",()=>{Pe||ge(new v)}),ae.pipe(xe,{end:!1}),Me){let Ce=function(){Pe=!0,xe.end()};var Ie=Ce;M(ae)?e.nextTick(Ce):ae.once("end",Ce)}else ge();return i(ae,{readable:!0,writable:!1},Ce=>{const He=ae._readableState;Ce&&Ce.code==="ERR_STREAM_PREMATURE_CLOSE"&&He&&He.ended&&!He.errored&&!He.errorEmitted?ae.once("end",ge).once("error",ge):ge(Ce)}),i(xe,{readable:!1,writable:!0},ge)}return IC={pipelineImpl:te,pipeline:Y},IC}var jC,yO;function RB(){if(yO)return jC;yO=1;const{pipeline:e}=dN(),t=Oc(),{destroyer:n}=mm(),{isNodeStream:r,isReadable:s,isWritable:i,isWebStream:a,isTransformStream:o,isWritableStream:l,isReadableStream:c}=qc(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:f,ERR_MISSING_ARGS:m}}=Gi(),g=vd();return jC=function(...b){if(b.length===0)throw new m("streams");if(b.length===1)return t.from(b[0]);const w=[...b];if(typeof b[0]=="function"&&(b[0]=t.from(b[0])),typeof b[b.length-1]=="function"){const q=b.length-1;b[q]=t.from(b[q])}for(let q=0;q<b.length;++q)if(!(!r(b[q])&&!a(b[q]))){if(q<b.length-1&&!(s(b[q])||c(b[q])||o(b[q])))throw new f(`streams[${q}]`,w[q],"must be readable");if(q>0&&!(i(b[q])||l(b[q])||o(b[q])))throw new f(`streams[${q}]`,w[q],"must be writable")}let x,_,E,C,k;function R(q){const P=C;C=null,P?P(q):q?k.destroy(q):!L&&!M&&k.destroy()}const I=b[0],j=e(b,R),M=!!(i(I)||l(I)||o(I)),L=!!(s(j)||c(j)||o(j));if(k=new t({writableObjectMode:!!(I!=null&&I.writableObjectMode),readableObjectMode:!!(j!=null&&j.readableObjectMode),writable:M,readable:L}),M){if(r(I))k._write=function(P,V,z){I.write(P,V)?z():x=z},k._final=function(P){I.end(),_=P},I.on("drain",function(){if(x){const P=x;x=null,P()}});else if(a(I)){const V=(o(I)?I.writable:I).getWriter();k._write=async function(z,re,K){try{await V.ready,V.write(z).catch(()=>{}),K()}catch(ee){K(ee)}},k._final=async function(z){try{await V.ready,V.close().catch(()=>{}),_=z}catch(re){z(re)}}}const q=o(j)?j.readable:j;g(q,()=>{if(_){const P=_;_=null,P()}})}if(L){if(r(j))j.on("readable",function(){if(E){const q=E;E=null,q()}}),j.on("end",function(){k.push(null)}),k._read=function(){for(;;){const q=j.read();if(q===null){E=k._read;return}if(!k.push(q))return}};else if(a(j)){const P=(o(j)?j.readable:j).getReader();k._read=async function(){for(;;)try{const{value:V,done:z}=await P.read();if(!k.push(V))return;if(z){k.push(null);return}}catch{return}}}}return k._destroy=function(q,P){!q&&C!==null&&(q=new u),E=null,x=null,_=null,C===null?P(q):(C=P,r(j)&&n(j,q))},k},jC}var bO;function Voe(){if(bO)return dw;bO=1;const e=globalThis.AbortController||ny().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:s},AbortError:i}=Gi(),{validateAbortSignal:a,validateInteger:o,validateObject:l}=tb(),c=os().Symbol("kWeak"),u=os().Symbol("kResistStopPropagation"),{finished:f}=vd(),m=RB(),{addAbortSignalNoValidate:g}=p_(),{isWritable:v,isNodeStream:b}=qc(),{deprecate:w}=aa(),{ArrayPrototypePush:x,Boolean:_,MathFloor:E,Number:C,NumberIsNaN:k,Promise:R,PromiseReject:I,PromiseResolve:j,PromisePrototypeThen:M,Symbol:L}=os(),q=L("kEmpty"),P=L("kEof");function V(Ie,Ce){if(Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),b(Ie)&&!v(Ie))throw new t("stream",Ie,"must be writable");const He=m(this,Ie);return Ce!=null&&Ce.signal&&g(Ce.signal,He),He}function z(Ie,Ce){if(typeof Ie!="function")throw new n("fn",["Function","AsyncFunction"],Ie);Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal");let He=1;(Ce==null?void 0:Ce.concurrency)!=null&&(He=E(Ce.concurrency));let it=He-1;return(Ce==null?void 0:Ce.highWaterMark)!=null&&(it=E(Ce.highWaterMark)),o(He,"options.concurrency",1),o(it,"options.highWaterMark",0),it+=He,(async function*(){const Re=aa().AbortSignalAny([Ce==null?void 0:Ce.signal].filter(_)),H=this,me=[],Te={signal:Re};let ce,oe,ne=!1,Se=0;function Fe(){ne=!0,ke()}function ke(){Se-=1,Xe()}function Xe(){oe&&!ne&&Se<He&&me.length<it&&(oe(),oe=null)}async function St(){try{for await(let ht of H){if(ne)return;if(Re.aborted)throw new i;try{if(ht=Ie(ht,Te),ht===q)continue;ht=j(ht)}catch(It){ht=I(It)}Se+=1,M(ht,ke,Fe),me.push(ht),ce&&(ce(),ce=null),!ne&&(me.length>=it||Se>=He)&&await new R(It=>{oe=It})}me.push(P)}catch(ht){const It=I(ht);M(It,ke,Fe),me.push(It)}finally{ne=!0,ce&&(ce(),ce=null)}}St();try{for(;;){for(;me.length>0;){const ht=await me[0];if(ht===P)return;if(Re.aborted)throw new i;ht!==q&&(yield ht),me.shift(),Xe()}await new R(ht=>{ce=ht})}}finally{ne=!0,oe&&(oe(),oe=null)}}).call(this)}function re(Ie=void 0){return Ie!=null&&l(Ie,"options"),(Ie==null?void 0:Ie.signal)!=null&&a(Ie.signal,"options.signal"),(async function*(){let He=0;for await(const Ge of this){var it;if(Ie!=null&&(it=Ie.signal)!==null&&it!==void 0&&it.aborted)throw new i({cause:Ie.signal.reason});yield[He++,Ge]}}).call(this)}async function K(Ie,Ce=void 0){for await(const He of Y.call(this,Ie,Ce))return!0;return!1}async function ee(Ie,Ce=void 0){if(typeof Ie!="function")throw new n("fn",["Function","AsyncFunction"],Ie);return!await K.call(this,async(...He)=>!await Ie(...He),Ce)}async function W(Ie,Ce){for await(const He of Y.call(this,Ie,Ce))return He}async function se(Ie,Ce){if(typeof Ie!="function")throw new n("fn",["Function","AsyncFunction"],Ie);async function He(it,Ge){return await Ie(it,Ge),q}for await(const it of z.call(this,He,Ce));}function Y(Ie,Ce){if(typeof Ie!="function")throw new n("fn",["Function","AsyncFunction"],Ie);async function He(it,Ge){return await Ie(it,Ge)?it:q}return z.call(this,He,Ce)}class te extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function Q(Ie,Ce,He){var it;if(typeof Ie!="function")throw new n("reducer",["Function","AsyncFunction"],Ie);He!=null&&l(He,"options"),(He==null?void 0:He.signal)!=null&&a(He.signal,"options.signal");let Ge=arguments.length>1;if(He!=null&&(it=He.signal)!==null&&it!==void 0&&it.aborted){const ce=new i(void 0,{cause:He.signal.reason});throw this.once("error",()=>{}),await f(this.destroy(ce)),ce}const Re=new e,H=Re.signal;if(He!=null&&He.signal){const ce={once:!0,[c]:this,[u]:!0};He.signal.addEventListener("abort",()=>Re.abort(),ce)}let me=!1;try{for await(const ce of this){var Te;if(me=!0,He!=null&&(Te=He.signal)!==null&&Te!==void 0&&Te.aborted)throw new i;Ge?Ce=await Ie(Ce,ce,{signal:H}):(Ce=ce,Ge=!0)}if(!me&&!Ge)throw new te}finally{Re.abort()}return Ce}async function ae(Ie){Ie!=null&&l(Ie,"options"),(Ie==null?void 0:Ie.signal)!=null&&a(Ie.signal,"options.signal");const Ce=[];for await(const it of this){var He;if(Ie!=null&&(He=Ie.signal)!==null&&He!==void 0&&He.aborted)throw new i(void 0,{cause:Ie.signal.reason});x(Ce,it)}return Ce}function xe(Ie,Ce){const He=z.call(this,Ie,Ce);return(async function*(){for await(const Ge of He)yield*Ge}).call(this)}function ge(Ie){if(Ie=C(Ie),k(Ie))return 0;if(Ie<0)throw new s("number",">= 0",Ie);return Ie}function Me(Ie,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Ie=ge(Ie),(async function*(){var it;if(Ce!=null&&(it=Ce.signal)!==null&&it!==void 0&&it.aborted)throw new i;for await(const Re of this){var Ge;if(Ce!=null&&(Ge=Ce.signal)!==null&&Ge!==void 0&&Ge.aborted)throw new i;Ie--<=0&&(yield Re)}}).call(this)}function Pe(Ie,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Ie=ge(Ie),(async function*(){var it;if(Ce!=null&&(it=Ce.signal)!==null&&it!==void 0&&it.aborted)throw new i;for await(const Re of this){var Ge;if(Ce!=null&&(Ge=Ce.signal)!==null&&Ge!==void 0&&Ge.aborted)throw new i;if(Ie-- >0&&(yield Re),Ie<=0)return}}).call(this)}return dw.streamReturningOperators={asIndexedPairs:w(re,"readable.asIndexedPairs will be removed in a future version."),drop:Me,filter:Y,flatMap:xe,map:z,take:Pe,compose:V},dw.promiseReturningOperators={every:ee,forEach:se,reduce:Q,toArray:ae,some:K,find:W},dw}var MC,vO;function NB(){if(vO)return MC;vO=1;const{ArrayPrototypePop:e,Promise:t}=os(),{isIterable:n,isNodeStream:r,isWebStream:s}=qc(),{pipelineImpl:i}=dN(),{finished:a}=vd();IB();function o(...l){return new t((c,u)=>{let f,m;const g=l[l.length-1];if(g&&typeof g=="object"&&!r(g)&&!n(g)&&!s(g)){const v=e(l);f=v.signal,m=v.end}i(l,(v,b)=>{v?u(v):c(b)},{signal:f,end:m})})}return MC={finished:a,pipeline:o},MC}var wO;function IB(){if(wO)return cC.exports;wO=1;const{Buffer:e}=bd(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=os(),{promisify:{custom:s}}=aa(),{streamReturningOperators:i,promiseReturningOperators:a}=Voe(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=Gi(),l=RB(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=m_(),{pipeline:f}=dN(),{destroyer:m}=mm(),g=vd(),v=NB(),b=qc(),w=cC.exports=lN().Stream;w.isDestroyed=b.isDestroyed,w.isDisturbed=b.isDisturbed,w.isErrored=b.isErrored,w.isReadable=b.isReadable,w.isWritable=b.isWritable,w.Readable=g_();for(const E of n(i)){let k=function(...R){if(new.target)throw o();return w.Readable.from(r(C,this,R))};var _=k;const C=i[E];t(k,"name",{__proto__:null,value:C.name}),t(k,"length",{__proto__:null,value:C.length}),t(w.Readable.prototype,E,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}for(const E of n(a)){let k=function(...I){if(new.target)throw o();return r(C,this,I)};var _=k;const C=a[E];t(k,"name",{__proto__:null,value:C.name}),t(k,"length",{__proto__:null,value:C.length}),t(w.Readable.prototype,E,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}w.Writable=uN(),w.Duplex=Oc(),w.Transform=TB(),w.PassThrough=AB(),w.pipeline=f;const{addAbortSignal:x}=p_();return w.addAbortSignal=x,w.finished=g,w.destroy=m,w.compose=l,w.setDefaultHighWaterMark=c,w.getDefaultHighWaterMark=u,t(w,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return v}}),t(f,s,{__proto__:null,enumerable:!0,get(){return v.pipeline}}),t(g,s,{__proto__:null,enumerable:!0,get(){return v.finished}}),w.Stream=w,w._isUint8Array=function(C){return C instanceof Uint8Array},w._uint8ArrayToBuffer=function(C){return e.from(C.buffer,C.byteOffset,C.byteLength)},cC.exports}var xO;function Hoe(){return xO||(xO=1,function(e){const t=IB(),n=NB(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(lC)),lC.exports}var jB=Hoe();class fN extends jB.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(s=>{this._path=s.path;const i=s.readableWebStream({start:t.start,end:t.end});this.reader=i.getReader(),this.pending=!1}).catch(s=>{this.destroy(s)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Ve(ut.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ve(ut.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class hN extends jB.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const s=r.writableWebStream({start:t.start});this.writer=s.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(Ei(new Ve(ut.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(Ei(new Ve(ut.ENOTSUP,"Unsupported encoding for stream",this._path)));const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(s),this._bytesWritten+=t.byteLength,r()}catch(i){r(new Ve(ut.EIO,i.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Ve(ut.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ve(ut.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var uo=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},fo=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class Ai{get position(){return this.flag&jf?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=ji(t,n);Object.assign(this,zf(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&u_||this.inode.flags&sa.Sync)}_emitChange(){hi(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Ve.With("EBADF",this.path,"chown");this.dirty=!0,uB(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=gd(t,-1);if(n<0)throw new Ve(ut.EINVAL,"Invalid mode");if(this.closed)throw Ve.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>Fr?-61441:Fr)|n,(this._isSync||n>Fr)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Ve.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Ve.With("EBADF",this.path,"truncate");if(t<0)throw new Ve(ut.EINVAL);if(this.dirty=!0,!(this.flag&Si||this.flag&_c))throw new Ve(ut.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Ve.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=Ux(t),this.inode.mtimeMs=Ux(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=Sc(n,"utf8","a",420);if(!(Ec(r.flag)&jf))throw new Ve(ut.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Ve(ut.EINVAL,"Encoding not specified");const i=typeof t=="string"?Gr.from(t,r.encoding):t;await this._write(i,0,i.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ve.With("EBADF",this.path,"read");if(this.flag&Si)throw new Ve(ut.EPERM,"File not opened with a readable mode");this.inode.flags&sa.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!Q0(this.inode)&&!J0(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&await this.sync(),{bytesRead:i-s,buffer:t}}async read(t,n,r,s){typeof n=="object"&&n!=null&&(s=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(s=t.position,r=t.length,n=t.offset,t=t.buffer);const i=Number.isSafeInteger(s)?s:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,i)}async readFile(t){const n=Sc(t,null,"r",292);if(Ec(n.flag)&Si)throw new Ve(ut.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:s}=await this.stat(),{buffer:i}=await this._read(new Uint8Array(s),0,s,0),a=Gr.from(i);return n.encoding?a.toString(n.encoding):a}readableWebStream(t={}){if(this.closed)throw Ve.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Ve.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&sa.Immutable)throw new Ve(ut.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&Si)throw Ve.With("EBADF",this.path,"readLines");return uoe({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Ve.With("EBADF",this.path,"stat");if(!Cr(this.context,this.inode,Bs))throw Ve.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new Kf(this.inode):new Uc(this.inode)}async _write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ve.With("EBADF",this.path,"write");if(this.inode.flags&sa.Immutable)throw new Ve(ut.EPERM,"File is immutable",this.path,"write");if(!(this.flag&Si||this.flag&_c))throw new Ve(ut.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!Q0(this.inode)&&!J0(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,await this.fs.write(this.internalPath,a,s),this._isSync&&await this.sync(),a.byteLength}async write(t,n,r,s){let i,a,o;typeof n=="object"&&n!=null&&(r=n.length,s=n.position,n=n.offset),typeof t=="string"?(s=typeof n=="number"?n:null,a=0,i=Gr.from(t,typeof r=="string"?r:"utf8"),o=i.length):(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n??0,o=typeof r=="number"?r:i.byteLength,s=typeof s=="number"?s:null),s??(s=this.position);const l=await this._write(i,a,o,s);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=Sc(n,"utf8","w",420),s=Ec(r.flag);if(!(s&Si||s&_c))throw new Ve(ut.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Ve(ut.EINVAL,"Encoding not specified");const i=typeof t=="string"?Gr.from(t,r.encoding):t;await this._write(i,0,i.length,0),this._emitChange()}async close(){if(this.closed)throw Ve.With("EBADF",this.path,"close");await this.sync(),this.dispose(),hB(this.context,this.fd)}dispose(t){if(this.closed)throw Ve.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ve.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.write(s)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.read(s)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&Si)throw Ve.With("EBADF",this.path,"createReadStream");return new fN(t,this)}createWriteStream(t={}){if(this.closed)throw Ve.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&sa.Immutable)throw new Ve(ut.EPERM,"File is immutable",this.path,"createWriteStream");return new hN(t,this)}}async function MB(e,t){e=hn(e),t=hn(t);const n=Wn(e,this),r=Wn(t,this);if(!(await gm.call(this,mr(e))).hasAccess(fs,this))throw Ve.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),hi(this,"rename",e.toString()),hi(this,"change",t.toString());return}await w_.call(this,t,await v_(e)),await b_.call(this,e),hi(this,"rename",e.toString())}catch(s){throw kr(s,{[n.path]:e,[r.path]:t})}}async function nb(e){try{const{fs:t,path:n}=Wn(await wd.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Ve&&t.code=="ENOENT")return!1;throw t}}async function gm(e,t){e=hn(e);const{fs:n,path:r}=Wn(await wd.call(this,e),this);try{const s=await n.stat(r);if($s&&!Cr(this,s,Bs))throw Ve.With("EACCES",r,"stat");return t!=null&&t.bigint?new Kf(s):new Uc(s)}catch(s){throw kr(s,{[r]:e})}}async function y_(e,t){e=hn(e);const{fs:n,path:r}=Wn(e,this);try{const s=await n.stat(r);if($s&&!Cr(this,s,Bs))throw Ve.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Kf(s):new Uc(s)}catch(s){throw kr(s,{[r]:e})}}async function OB(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await uo(n,await ho.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=fo(n);r&&await r}}async function b_(e){e=hn(e);const{fs:t,path:n}=Wn(e,this);try{if($s&&!Cr(this,await t.stat(n),fs))throw Ve.With("EACCES",n,"unlink");await t.unlink(n),hi(this,"rename",e.toString())}catch(r){throw kr(r,{[n]:e})}}async function ym(e,t,n){var r;t=hn(t);const s=gd(n.mode,420),i=Ec(n.flag),{fullPath:a,fs:o,path:l,stats:c}=await Gx(e,t.toString(),n.preserveSymlinks);if(!c){if(!(i&o_))throw Ve.With("ENOENT",a,"_open");const f=await o.stat(mr(l));if(!Cr(e,f,fs))throw Ve.With("EACCES",mr(a),"_open");if(!Bo(f))throw Ve.With("ENOTDIR",mr(a),"_open");const{euid:m,egid:g}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:Uo.credentials,v=await o.createFile(l,{mode:s,uid:f.mode&Xy?f.uid:m,gid:f.mode&Jy?f.gid:g});return new Ai(e,Vx(new qx(e,t,o,l,i,v)))}if(!Cr(e,c,pB(i)))throw Ve.With("EACCES",a,"_open");if(i&l_)throw Ve.With("EEXIST",a,"_open");const u=new Ai(e,Vx(new qx(e,t,o,l,i,c)));return i&c_&&await u.truncate(0),u}async function ho(e,t="r",n=420){return await ym(this,e,{flag:t,mode:n})}async function v_(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=Sc(t,null,"r",292);return await uo(n,typeof e=="object"&&"fd"in e?e:await ho.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=fo(n);r&&await r}}async function w_(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Sc(n,"utf8","w+",420),i=uo(r,e instanceof Ai?e:await ho.call(this,e.toString(),s.flag,s.mode),!0),a=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof a!="string"&&!(a instanceof Uint8Array))throw new Ve(ut.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,i.path,"writeFile");await i.writeFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=fo(r);s&&await s}}async function PB(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Sc(n,"utf8","a",420);if(!(Ec(s.flag)&jf))throw new Ve(ut.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Ve(ut.EINVAL,"Encoding not specified");const a=typeof t=="string"?Gr.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await uo(r,typeof e=="object"&&"fd"in e?e:await ho.call(this,e,s.flag,s.mode),!0).appendFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=fo(r);s&&await s}}async function pN(e){e=await wd.call(this,e);const{fs:t,path:n}=Wn(e,this);try{const r=await t.stat(n);if(!r)throw Ve.With("ENOENT",e,"rmdir");if(!Bo(r))throw Ve.With("ENOTDIR",n,"rmdir");if($s&&!Cr(this,r,fs))throw Ve.With("EACCES",n,"rmdir");await t.rmdir(n),hi(this,"rename",e.toString())}catch(r){throw kr(r,{[n]:e})}}async function x_(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Uo.credentials;t=typeof t=="object"?t:{mode:t};const a=gd(t==null?void 0:t.mode,511);e=await wd.call(this,e);const{fs:o,path:l,root:c}=Wn(e,this),u={[l]:e},f=async(m,g)=>{if(!Cr(this,g,fs))throw Ve.With("EACCES",mr(m),"mkdir");const v=await o.mkdir(m,{mode:a,uid:g.mode&Xy?g.uid:s,gid:g.mode&Jy?g.gid:i});return hi(this,"rename",m),v};try{if(!(t!=null&&t.recursive)){await f(l,await o.stat(mr(l)));return}const m=[];for(let v=l,b=e;!await o.exists(v);v=mr(v),b=mr(b))m.unshift(v),u[v]=b;if(!m.length)return;const g=[await o.stat(mr(m[0]))];for(const[v,b]of m.entries())g.push(await f(b,g[v]));return c.length==1?m[0]:(r=m[0])===null||r===void 0?void 0:r.slice(c.length)}catch(m){throw kr(m,u)}}async function Xf(e,t){t=typeof t=="object"?t:{encoding:t},e=await wd.call(this,e);const{fs:n,path:r}=Wn(e,this),s=await n.stat(r).catch(l=>Rr(kr(l,{[r]:e})));if(!s)throw Ve.With("ENOENT",e,"readdir");if(!Cr(this,s,Bs))throw Ve.With("EACCES",e,"readdir");if(!Bo(s))throw Ve.With("ENOTDIR",e,"readdir");const i=await n.readdir(r).catch(l=>Rr(kr(l,{[r]:e}))),a=[],o=async l=>{let c;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(c=await n.stat(_r(r,l)).catch(u=>{if(u.code!="ENOENT")throw kr(u,{[r]:e})}),!c))&&(t!=null&&t.withFileTypes?a.push(new ty(l,c)):(t==null?void 0:t.encoding)=="buffer"?a.push(Gr.from(l)):a.push(l),!(!(t!=null&&t.recursive)||!Bo(c))))for(const u of await Xf.call(this,_r(e,l),t))u instanceof ty?(u.path=_r(l,u.path),a.push(u)):Gr.isBuffer(u)?a.push(Gr.from(_r(l,$R(u)))):a.push(_r(l,u))};return await Promise.all(i.map(o)),a}async function DB(e,t){e=hn(e),t=hn(t);const{fs:n,path:r}=Wn(e,this),s=Wn(t,this);if(n!=s.fs)throw Ve.With("EXDEV",t,"link");try{if($s&&!Cr(this,await n.stat(mr(r)),Bs))throw Ve.With("EACCES",mr(r),"link");if($s&&!(await gm.call(this,mr(t))).hasAccess(fs,this))throw Ve.With("EACCES",mr(t),"link");if($s&&!Cr(this,await n.stat(r),Bs))throw Ve.With("EACCES",r,"link");return await n.link(r,s.path)}catch(i){throw kr(i,{[s.path]:t,[r]:e})}}async function FB(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ve(ut.EINVAL,"Invalid symlink type: "+n);if(t=hn(t),await nb.call(this,t))throw Ve.With("EEXIST",t,"symlink");const s=uo(r,await ym(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await s.writeFile(hn(e,!0)),await s.chmod(zc)}catch(s){r.error=s,r.hasError=!0}finally{const s=fo(r);s&&await s}}async function Hx(e,t){const n={stack:[],error:void 0,hasError:!1};try{const s=await uo(n,await ym(this,hn(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),i=typeof t=="object"?t==null?void 0:t.encoding:t;return i=="buffer"?s:s.toString(i??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=fo(n);r&&await r}}async function LB(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await uo(r,await ho.call(this,e,"r+"),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=fo(r);s&&await s}}async function BB(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await uo(r,await ym(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=fo(r);s&&await s}}async function $B(e,t){const n={stack:[],error:void 0,hasError:!1};try{await uo(n,await ho.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=fo(n);r&&await r}}async function zB(e,t){const n={stack:[],error:void 0,hasError:!1};try{await uo(n,await ym(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=fo(n);r&&await r}}async function mN(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await uo(r,await ho.call(this,e,"r+"),!0).utimes(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=fo(r);s&&await s}}async function UB(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await uo(r,await ym(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(s){r.error=s,r.hasError=!0}finally{const s=fo(r);s&&await s}}async function Gx(e,t,n){if(n){const l=Wn(t,e),c=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:c}}try{const l=Wn(t,e),c=await l.fs.stat(l.path);if(!Bp(c))return{...l,fullPath:t,stats:c};const u=Mc.call(e,mr(t),(await Hx.call(e,t)).toString());return await Gx(e,u)}catch{}const{base:r,dir:s}=gl(t),i=s=="/"?"/":await wd.call(e,s),a=_r(i,r),o=Wn(a,e);try{const l=await o.fs.stat(o.path);if(!Bp(l))return{...o,fullPath:a,stats:l};const c=Mc.call(e,i,(await Hx.call(e,a)).toString());return await Gx(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw kr(l,{[o.path]:a})}}async function wd(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=hn(e);const{fullPath:s}=await Gx(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Gr.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function Goe(e,t={}){const n=new bB(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let s=!1;n.on("change",(a,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:a,filename:o},done:!1})});function i(){s=!0,n.close();for(const a of r)a({value:null,done:s});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(s)return Promise.resolve({value:null,done:s});const{promise:a,resolve:o}=Promise.withResolvers();return r.push(o),a},return:i,throw:i,async[Symbol.asyncDispose](){await i()},[Symbol.asyncIterator](){return this}}}async function qB(e,t=KR){if(!(await gm.call(this,e)).hasAccess(t,this))throw new Ve(ut.EACCES)}async function gN(e,t){e=hn(e);const n=await y_.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&Fr){case Is:if(t!=null&&t.recursive)for(const r of await Xf.call(this,e))await gN.call(this,_r(e,r),t);await pN.call(this,e);break;case Oo:case zc:case Vf:case Hf:await b_.call(this,e);break;case Gf:case qf:default:throw new Ve(ut.EPERM,"File type not supported",e,"rm")}}async function VB(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await x_.call(this,s),n=="buffer"?Gr.from(s):s}async function yN(e,t,n){if(e=hn(e),t=hn(t),n&&n&WR&&await nb.call(this,t))throw new Ve(ut.EEXIST,"Destination file already exists",t,"copyFile");await w_.call(this,t,await v_.call(this,e)),hi(this,"rename",t.toString())}function HB(e,t){return e=hn(e),Promise.resolve(new oN(e,this))}async function bN(e,t,n){e=hn(e),t=hn(t);const r=await y_.call(this,e);if(n!=null&&n.errorOnExist&&await nb.call(this,t))throw new Ve(ut.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Fr){case Is:{if(!(n!=null&&n.recursive))throw new Ve(ut.EISDIR,e+" is a directory (not copied)",e,"cp");const[s]=await Promise.all([Xf.call(this,e,{withFileTypes:!0}),x_.call(this,t,{recursive:!0})]),i=async a=>{n.filter&&!n.filter(_r(e,a.name),_r(t,a.name))||await bN.call(this,_r(e,a.name),_r(t,a.name),n)};await Promise.all(s.map(i));break}case Oo:case zc:await yN.call(this,e,t);break;case Vf:case Hf:case Gf:case qf:default:throw new Ve(ut.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await mN.call(this,t,r.atime,r.mtime)}async function GB(e,t){e=hn(e);const{fs:n}=Wn(e,this);return Promise.resolve(gB(n,t==null?void 0:t.bigint))}function KB(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t||{},i=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*a(o){const l=await Xf(o,{withFileTypes:r,encoding:"utf8"});for(const c of l){const u=r?c.path:o+"/"+c;s(r?c:u)||((await gm(u)).isDirectory()&&i.some(f=>f.source.includes(".*"))&&(yield*a(u)),i.some(f=>f.test(u.replace(/^\/+/g,"")))&&(yield r?c:u.replace(/^\/+/g,"")))}}return a(n)}const Koe=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:Ai,access:qB,appendFile:PB,chmod:$B,chown:LB,constants:lB,copyFile:yN,cp:bN,exists:nb,glob:KB,lchmod:zB,lchown:BB,link:DB,lstat:y_,lutimes:UB,mkdir:x_,mkdtemp:VB,open:ho,opendir:HB,readFile:v_,readdir:Xf,readlink:Hx,realpath:wd,rename:MB,rm:gN,rmdir:pN,stat:gm,statfs:GB,symlink:FB,truncate:OB,unlink:b_,utimes:mN,watch:Goe,writeFile:w_},Symbol.toStringTag,{value:"Module"})),Dn=()=>{};async function Woe(e){const t=[];for await(const n of e)t.push(n);return t}function Zoe(e,t,n=Dn){MB.call(this,e,t).then(()=>n()).catch(n)}function Yoe(e,t=Dn){nb.call(this,e).then(t).catch(()=>t(!1))}function Xoe(e,t,n=Dn){n=typeof t=="function"?t:n,gm.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function Joe(e,t,n=Dn){n=typeof t=="function"?t:n,y_.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function Qoe(e,t=0,n=Dn){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;OB.call(this,e,r).then(()=>n()).catch(n)}function ele(e,t=Dn){b_.call(this,e).then(()=>t()).catch(t)}function tle(e,t,n,r=Dn){const s=gd(n,420);r=typeof n=="function"?n:r,ho.call(this,e,t,s).then(i=>r(void 0,i.fd)).catch(r)}function nle(e,t,n=Dn){n=typeof t=="function"?t:n,v_.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function rle(e,t,n,r=Dn){r=typeof n=="function"?n:r,w_.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function sle(e,t,n,r=Dn){const s=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,PB.call(this,e,t,s).then(()=>r()).catch(r)}function ile(e,t,n=Dn){n=typeof t=="function"?t:n,new Ai(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new Kf(r):r)).catch(n)}function ale(e,t=Dn){new Ai(this,e).close().then(()=>t()).catch(t)}function ole(e,t,n=Dn){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const s=new Ai(this,e);if(r<0)throw new Ve(ut.EINVAL);s.truncate(r).then(()=>n()).catch(n)}function lle(e,t=Dn){new Ai(this,e).sync().then(()=>t()).catch(t)}function cle(e,t=Dn){new Ai(this,e).datasync().then(()=>t()).catch(t)}function ule(e,t,n,r,s,i=Dn){let a,o,l,c,u;const f=new Ai(this,e);if(typeof t=="string"){switch(u="utf8",typeof n){case"function":i=n;break;case"number":c=n,u=typeof r=="string"?r:"utf8",i=typeof s=="function"?s:i;break;default:i=typeof r=="function"?r:typeof s=="function"?s:i,i(new Ve(ut.EINVAL,"Invalid arguments"));return}a=Gr.from(t),o=0,l=a.length;const m=i;f.write(a,o,l,c).then(({bytesWritten:g})=>m(void 0,g,a.toString(u))).catch(m)}else{a=Gr.from(t.buffer),o=n,l=r,c=typeof s=="number"?s:null;const m=typeof s=="function"?s:i;f.write(a,o,l,c).then(({bytesWritten:g})=>m(void 0,g,a)).catch(m)}}function dle(e,t,n,r,s,i=Dn){new Ai(this,e).read(t,n,r,s).then(({bytesRead:a,buffer:o})=>i(void 0,a,o)).catch(i)}function fle(e,t,n,r=Dn){new Ai(this,e).chown(t,n).then(()=>r()).catch(r)}function hle(e,t,n){new Ai(this,e).chmod(t).then(()=>n()).catch(n)}function ple(e,t,n,r=Dn){new Ai(this,e).utimes(t,n).then(()=>r()).catch(r)}function mle(e,t=Dn){pN.call(this,e).then(()=>t()).catch(t)}function gle(e,t,n=Dn){x_.call(this,e,t).then(()=>n()).catch(n)}function yle(e,t,n=Dn){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};Xf.call(this,e,r).then(s=>n(void 0,s)).catch(n)}function ble(e,t,n=Dn){DB.call(this,e,t).then(()=>n()).catch(n)}function vle(e,t,n,r=Dn){const s=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,FB.call(this,e,t,s).then(()=>r()).catch(r)}function wle(e,t,n=Dn){n=typeof t=="function"?t:n,Hx.call(this,e).then(r=>n(void 0,r)).catch(n)}function xle(e,t,n,r=Dn){LB.call(this,e,t,n).then(()=>r()).catch(r)}function _le(e,t,n,r=Dn){BB.call(this,e,t,n).then(()=>r()).catch(r)}function Sle(e,t,n=Dn){$B.call(this,e,t).then(()=>n()).catch(n)}function Ele(e,t,n=Dn){zB.call(this,e,t).then(()=>n()).catch(n)}function Cle(e,t,n,r=Dn){mN.call(this,e,t,n).then(()=>r()).catch(r)}function kle(e,t,n,r=Dn){UB.call(this,e,t,n).then(()=>r()).catch(r)}function Tle(e,t,n=Dn){n=typeof t=="function"?t:n,wd.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function Ale(e,t,n=Dn){const r=typeof t=="number"?t:Bs;n=typeof t=="function"?t:n,qB.call(this,e,r).then(()=>n()).catch(n)}const cp=new Map;function Rle(e,t,n){const r=hn(e),s=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Ve(ut.EINVAL,"No listener specified",e.toString(),"watchFile");if(cp.has(r)){const a=cp.get(r);a&&a.listeners.add(n);return}const i=new moe(this,r,s);i.on("change",(a,o)=>{const l=cp.get(r);if(l)for(const c of l.listeners)c(a,o)}),cp.set(r,{watcher:i,listeners:new Set})}function Nle(e,t=Dn){const n=hn(e),r=cp.get(n);r&&(t&&t!==Dn?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),cp.delete(n)))}function Ile(e,t,n){const r=new bB(this,hn(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||Dn),r}function jle(e,t){t=typeof t=="object"?t:{encoding:t};const n=ho.call(this,e,"r",t==null?void 0:t.mode);return new fN({...t,autoClose:!0},n)}function Mle(e,t){t=typeof t=="object"?t:{encoding:t};const n=ho.call(this,e,"w",t==null?void 0:t.mode);return new hN(t,n)}function Ole(e,t,n=Dn){n=typeof t=="function"?t:n,gN.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function Ple(e,t,n=Dn){n=typeof t=="function"?t:n,VB.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function Dle(e,t,n,r=Dn){r=typeof n=="function"?n:r,yN.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function Fle(e,t,n,r=Dn){r=typeof n=="function"?n:r,new Ai(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesRead:i})=>r(void 0,i,s)).catch(r)}function Lle(e,t,n,r=Dn){r=typeof n=="function"?n:r,new Ai(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesWritten:i})=>r(void 0,i,s)).catch(r)}function Ble(e,t,n=Dn){n=typeof t=="function"?t:n,HB.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function $le(e,t,n,r=Dn){r=typeof n=="function"?n:r,bN.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function zle(e,t,n=Dn){n=typeof t=="function"?t:n,GB.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function Ule(e,t){const n=await ho.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function qle(e,t,n=Dn){n=typeof t=="function"?t:n;const r=KB.call(this,e,typeof t=="function"?void 0:t);Woe(r).then(s=>{var i;return n(null,(i=s)!==null&&i!==void 0?i:[])}).catch(s=>n(s))}var ef=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),f,m=!1,g=n.length-1;g>=0;g--){var v={};for(var b in r)v[b]=b==="access"?{}:r[b];for(var b in r.access)v.access[b]=r.access[b];v.addInitializer=function(x){if(m)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var w=(0,n[g])(o==="accessor"?{get:u.get,set:u.set}:u[l],v);if(o==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(f=a(w.get))&&(u.get=f),(f=a(w.set))&&(u.set=f),(f=a(w.init))&&s.unshift(f)}else(f=a(w))&&(o==="field"?s.unshift(f):u[l]=f)}c&&Object.defineProperty(c,r.name,u),m=!0},Sa=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},Vle=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},Kx;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})(Kx||(Kx={}));let WB=(()=>{var e,t,n,r,s;let i=[Uf()],a,o=[],l,c,u=[],f=[],m,g=[],v=[],b,w=[],x=[],_,E=[],C=[],k,R=[],I=[],j,M=[],L=[];return l=class{constructor(q=Rr(new Ve(ut.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=Sa(this,u,0),this.extsize=(Sa(this,f),Sa(this,g,0)),this.nextents=(Sa(this,v),Sa(this,w,0)),this.projid=(Sa(this,x),Sa(this,E,0)),this.cowextsize=(Sa(this,C),Sa(this,R,0)),this.pad=(Sa(this,I),Sa(this,M,[])),Sa(this,L),this.extsize=q.size,this.nextents=1,this.projid=q.uid,this.cowextsize=q.size;for(const P of Object.keys(sa))q.flags&sa[P]&&P in Kx&&(this.xflags|=Kx[P])}},Vle(l,"fsxattr"),(()=>{const q=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;c=[(e=Sn).uint32.bind(e)],m=[(t=Sn).uint32.bind(t)],b=[(n=Sn).uint32.bind(n)],_=[(r=Sn).uint32.bind(r)],k=[(s=Sn).uint32.bind(s)],j=[Sn.char(8)],ef(null,null,c,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:P=>"xflags"in P,get:P=>P.xflags,set:(P,V)=>{P.xflags=V}},metadata:q},u,f),ef(null,null,m,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:P=>"extsize"in P,get:P=>P.extsize,set:(P,V)=>{P.extsize=V}},metadata:q},g,v),ef(null,null,b,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:P=>"nextents"in P,get:P=>P.nextents,set:(P,V)=>{P.nextents=V}},metadata:q},w,x),ef(null,null,_,{kind:"field",name:"projid",static:!1,private:!1,access:{has:P=>"projid"in P,get:P=>P.projid,set:(P,V)=>{P.projid=V}},metadata:q},E,C),ef(null,null,k,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:P=>"cowextsize"in P,get:P=>P.cowextsize,set:(P,V)=>{P.cowextsize=V}},metadata:q},R,I),ef(null,null,j,{kind:"field",name:"pad",static:!1,private:!1,access:{has:P=>"pad"in P,get:P=>P.pad,set:(P,V)=>{P.pad=V}},metadata:q},M,L),ef(null,a={value:l},i,{kind:"class",name:l.name,metadata:q},null,o),l=a.value,q&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:q}),Sa(l,o)})(),l})();var Xr;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})(Xr||(Xr={}));var Ao;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(Ao||(Ao={}));async function Hle(e,t,...n){e=hn(e);const{fs:r,path:s}=Wn(e,this);try{const i=new Rs(await r.stat(s));switch(t){case Xr.GetFlags:case Ao.GetFlags:return i.flags;case Xr.SetFlags:case Ao.SetFlags:i.flags=n[0],await r.touch(s,i);return;case Xr.GetVersion:case Ao.GetVersion:return i.version;case Xr.SetVersion:case Ao.SetVersion:i.version=n[0],await r.touch(s,i);return;case Xr.Fiemap:break;case Xr.GetXattr:return new WB(i);case Xr.SetXattr:break;case Xr.GetLabel:return r.label;case Xr.SetLabel:r.label=n[0];return;case Xr.GetUUID:return r.uuid;case Xr.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw kr(i,{[s]:e})}throw new Ve(ut.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function Gle(e,t,...n){e=hn(e);const{fs:r,path:s}=Wn(e,this);try{const i=new Rs(r.statSync(s));switch(t){case Xr.GetFlags:case Ao.GetFlags:return i.flags;case Xr.SetFlags:case Ao.SetFlags:i.flags=n[0],r.touchSync(s,i);return;case Xr.GetVersion:case Ao.GetVersion:return i.version;case Xr.SetVersion:case Ao.SetVersion:i.version=n[0],r.touchSync(s,i);return;case Xr.Fiemap:break;case Xr.GetXattr:return new WB(i);case Xr.SetXattr:break;case Xr.GetLabel:return r.label;case Xr.SetLabel:r.label=n[0];return;case Xr.GetUUID:return r.uuid;case Xr.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw kr(i,{[s]:e})}throw new Ve(ut.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const Kle=[];function bm(e,t,n,r){if(!t.startsWith("user.")&&!Kle.includes(t))throw new Ve(ut.EPERM,"Only attributes in the user namespace are supported",n,r)}async function Wle(e,t,n={}){var r;e=hn(e);const{fs:s,path:i}=Wn(e,this);bm(this,t,e,"xattr.get");try{const a=await s.stat(i);if($s&&!Cr(this,a,Bs))throw Ve.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new Qu);const o=a.attributes.get(t);if(!o)throw Ve.With("ENODATA",i,"xattr.get");const l=Gr.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw kr(a,{[i]:e})}}function Zle(e,t,n={}){var r;e=hn(e),bm(this,t,e,"xattr.get");const{fs:s,path:i}=Wn(e,this);try{const a=s.statSync(i);if($s&&!Cr(this,a,Bs))throw Ve.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new Qu);const o=a.attributes.get(t);if(!o)throw Ve.With("ENODATA",i,"xattr.get");const l=Gr.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw kr(a,{[i]:e})}}async function Yle(e,t,n,r={}){var s;e=hn(e);const{fs:i,path:a}=Wn(e,this);bm(this,t,e,"xattr.set");try{const o=await i.stat(a);if($s&&!Cr(this,o,fs))throw Ve.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new Qu);const l=o.attributes.get(t);if(r.create&&l)throw Ve.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Ve.With("ENODATA",a,"xattr.set");o.attributes.set(t,Gr.from(n)),await i.touch(a,zf(o,"attributes"))}catch(o){throw kr(o,{[a]:e})}}function Xle(e,t,n,r={}){var s;e=hn(e);const{fs:i,path:a}=Wn(e,this);bm(this,t,e,"xattr.set");try{const o=i.statSync(a);if($s&&!Cr(this,o,fs))throw Ve.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new Qu);const l=o.attributes.get(t);if(r.create&&l)throw Ve.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Ve.With("ENODATA",a,"xattr.set");o.attributes.set(t,Gr.from(n)),i.touchSync(a,zf(o,"attributes"))}catch(o){throw kr(o,{[a]:e})}}async function Jle(e,t){var n;e=hn(e);const{fs:r,path:s}=Wn(e,this);bm(this,t,e,"xattr.remove");try{const i=await r.stat(s);if($s&&!Cr(this,i,fs))throw Ve.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new Qu),!i.attributes.get(t))throw Ve.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),await r.touch(s,zf(i,"attributes"))}catch(i){throw kr(i,{[s]:e})}}function Qle(e,t){var n;e=hn(e);const{fs:r,path:s}=Wn(e,this);bm(this,t,e,"xattr.remove");try{const i=r.statSync(s);if($s&&!Cr(this,i,fs))throw Ve.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new Qu),!i.attributes.get(t))throw Ve.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),r.touchSync(s,zf(i,"attributes"))}catch(i){throw kr(i,{[s]:e})}}async function ece(e){e=hn(e);const{fs:t,path:n}=Wn(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw kr(r,{[n]:e})}}function tce(e){e=hn(e);const{fs:t,path:n}=Wn(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw kr(r,{[n]:e})}}const nce=Object.freeze(Object.defineProperty({__proto__:null,get:Wle,getSync:Zle,list:ece,listSync:tce,remove:Jle,removeSync:Qle,set:Yle,setSync:Xle},Symbol.toStringTag,{value:"Module"})),ii=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:Xae,Dir:oN,Dirent:ty,get IOC(){return Xr},get IOC32(){return Ao},ReadStream:fN,Stats:Uc,StatsFs:Yae,WriteStream:hN,access:Ale,accessSync:Ooe,appendFile:sle,appendFileSync:woe,chmod:Sle,chmodSync:Ioe,chown:xle,chownSync:Roe,chroot:hoe,close:ale,closeSync:Zf,constants:lB,copyFile:Dle,copyFileSync:SB,cp:$le,cpSync:EB,createReadStream:jle,createWriteStream:Mle,exists:Yoe,existsSync:JR,fchmod:hle,fchmodSync:sN,fchown:fle,fchownSync:rN,fdatasync:cle,fdatasyncSync:Eoe,fstat:ile,fstatSync:xoe,fsync:lle,fsyncSync:Soe,ftruncate:ole,ftruncateSync:_oe,futimes:ple,futimesSync:iN,glob:qle,globSync:$oe,ioctl:Hle,ioctlSync:Gle,lchmod:Ele,lchmodSync:joe,lchown:_le,lchownSync:Noe,link:ble,linkSync:Toe,lopenSync:f_,lstat:Joe,lstatSync:QR,lutimes:kle,lutimesSync:Moe,mkdir:gle,mkdirSync:aN,mkdtemp:Ple,mkdtempSync:Poe,mount:XR,open:tle,openAsBlob:Ule,openSync:d_,opendir:Ble,opendirSync:Loe,promises:Koe,read:dle,readFile:nle,readFileSync:tN,readSync:koe,readdir:yle,readdirSync:pm,readlink:wle,readlinkSync:eA,readv:Fle,readvSync:Doe,realpath:Tle,realpathSync:yd,rename:Zoe,renameSync:boe,rm:Ole,rmSync:_B,rmdir:mle,rmdirSync:wB,stat:Xoe,statSync:ed,statfs:zle,statfsSync:Boe,symlink:vle,symlinkSync:Aoe,truncate:Qoe,truncateSync:voe,umount:mB,unlink:ele,unlinkSync:eN,unwatchFile:Nle,utimes:Cle,utimesSync:xB,watch:Ile,watchFile:Rle,write:ule,writeFile:rle,writeFileSync:nN,writeSync:Coe,writev:Lle,writevSync:Foe,xattr:nce},Symbol.toStringTag,{value:"Module"}));function _O(e){return X9(e)||GR(e)||e instanceof YR}async function ZB(e,t=0){if(typeof e!="object"||e==null)throw ra(new Ve(ut.EINVAL,"Invalid options on mount configuration"));if(!_O(e))throw ra(new Ve(ut.EINVAL,"Invalid mount configuration"));if(e instanceof YR)return await e.ready(),e;GR(e)&&(e={backend:e});for(const[s,i]of Object.entries(e))if(s!="backend"&&_O(i)){if(Y9("Resolving nested mount configuration: "+s),t>10)throw ra(new Ve(ut.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[s]=await ZB(i,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw ra(new Ve(ut.EPERM,"Backend not available: "+n.name));Mae(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function rce(e){if(!X9(e))throw new TypeError("Invalid single mount point configuration");const t=await ZB(e);mB("/"),XR("/",t)}const sce=["delete"];Math.max(...sce.map(e=>e.length));jae("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const YB=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;YB[e]=t}function ice(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^YB[(t^e[n])&255];return(t^4294967295)>>>0}var Yr=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),f,m=!1,g=n.length-1;g>=0;g--){var v={};for(var b in r)v[b]=b==="access"?{}:r[b];for(var b in r.access)v.access[b]=r.access[b];v.addInitializer=function(x){if(m)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var w=(0,n[g])(o==="accessor"?{get:u.get,set:u.set}:u[l],v);if(o==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(f=a(w.get))&&(u.get=f),(f=a(w.set))&&(u.set=f),(f=a(w.init))&&s.unshift(f)}else(f=a(w))&&(o==="field"?s.unshift(f):u[l]=f)}c&&Object.defineProperty(c,r.name,u),m=!0},Rn=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},vN=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let SO=(()=>{var e,t,n,r;let s=[Uf()],i,a=[],o,l,c=[],u=[],f,m=[],g=[],v,b=[],w=[],x,_=[],E=[];return o=class{constructor(){this.id=Rn(this,c,0),this.offset_=(Rn(this,u),Rn(this,m,0)),this.offset=(Rn(this,g),Rn(this,b,0)),this.size=(Rn(this,w),Rn(this,_,0)),Rn(this,E)}},vN(o,"MetadataEntry"),(()=>{const C=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=Sn).uint32.bind(e)],f=[(t=Sn).uint32.bind(t)],v=[(n=Sn).uint32.bind(n)],x=[(r=Sn).uint32.bind(r)],Yr(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:k=>"id"in k,get:k=>k.id,set:(k,R)=>{k.id=R}},metadata:C},c,u),Yr(null,null,f,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:k=>"offset_"in k,get:k=>k.offset_,set:(k,R)=>{k.offset_=R}},metadata:C},m,g),Yr(null,null,v,{kind:"field",name:"offset",static:!1,private:!1,access:{has:k=>"offset"in k,get:k=>k.offset,set:(k,R)=>{k.offset=R}},metadata:C},b,w),Yr(null,null,x,{kind:"field",name:"size",static:!1,private:!1,access:{has:k=>"size"in k,get:k=>k.size,set:(k,R)=>{k.size=R}},metadata:C},_,E),Yr(null,i={value:o},s,{kind:"class",name:o.name,metadata:C},null,a),o=i.value,C&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:C}),Rn(o,a)})(),o})();const EO=255;let tf=(()=>{var e,t,n,r;let s=[Uf()],i,a=[],o,l,c=[],u=[],f,m=[],g=[],v,b=[],w=[],x,_=[],E=[],C,k=[],R=[];var I=o=class{constructor(j=Rr(new Ve(ut.EINVAL,"Metadata block must be initialized with a superblock")),M=0){if(this.superblock=j,this.offset=M,this.checksum=Rn(this,c,0),this.timestamp=(Rn(this,u),Rn(this,m,Date.now())),this.previous_offset_=(Rn(this,g),Rn(this,b,0)),this.previous_offset=(Rn(this,w),Rn(this,_,0)),this._previous=Rn(this,E),this.entries=Rn(this,k,Array.from({length:EO},()=>new SO)),Rn(this,R),this.superblock=j,this.offset=M,!!M&&(i_(this,j.store._buffer.subarray(M,M+Jr(I))),!XB(this)))throw a_(new Ve(ut.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+M.toString(16)))}get previous(){var j;if(this.previous_offset)return(j=this._previous)!==null&&j!==void 0||(this._previous=new I(this.superblock,this.previous_offset)),this._previous}};return vN(o,"MetadataBlock"),(()=>{const j=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=Sn).uint32.bind(e)],f=[(t=Sn).uint32.bind(t)],v=[(n=Sn).uint32.bind(n)],x=[(r=Sn).uint32.bind(r)],C=[X0(SO,EO)],Yr(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:M=>"checksum"in M,get:M=>M.checksum,set:(M,L)=>{M.checksum=L}},metadata:j},c,u),Yr(null,null,f,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:M=>"timestamp"in M,get:M=>M.timestamp,set:(M,L)=>{M.timestamp=L}},metadata:j},m,g),Yr(null,null,v,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:M=>"previous_offset_"in M,get:M=>M.previous_offset_,set:(M,L)=>{M.previous_offset_=L}},metadata:j},b,w),Yr(null,null,x,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:M=>"previous_offset"in M,get:M=>M.previous_offset,set:(M,L)=>{M.previous_offset=L}},metadata:j},_,E),Yr(null,null,C,{kind:"field",name:"entries",static:!1,private:!1,access:{has:M=>"entries"in M,get:M=>M.entries,set:(M,L)=>{M.entries=L}},metadata:j},k,R),Yr(null,i={value:o},s,{kind:"class",name:o.name,metadata:j},null,a),I=o=i.value,j&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:j}),Rn(o,a)})(),I=o})();const CO=2049864546;(()=>{var e,t,n,r,s,i,a,o,l,c,u;let f=[Uf()],m,g=[],v,b,w=[],x=[],_,E=[],C=[],k,R=[],I=[],j,M=[],L=[],q,P=[],V=[],z,re=[],K=[],ee,W=[],se=[],Y,te=[],Q=[],ae,xe=[],ge=[],Me,Pe=[],Ie=[],Ce,He=[],it=[],Ge,Re=[],H=[],me,Te=[],ce=[];var oe=v=class{constructor(ne=Rr(new Ve(ut.EINVAL,"Super block must be initialized with a store"))){if(this.store=ne,this.checksum=Rn(this,w,0),this.magic=(Rn(this,x),Rn(this,E,CO)),this.version=(Rn(this,C),Rn(this,R,1)),this.inode_format=(Rn(this,I),Rn(this,M,Qae)),this.flags=(Rn(this,L),Rn(this,P,0)),this.used_bytes=(Rn(this,V),Rn(this,re,BigInt(0))),this.total_bytes=(Rn(this,K),Rn(this,W,BigInt(0))),this.uuid=(Rn(this,se),Rn(this,te,BigInt(0))),this.metadata_block_size=(Rn(this,Q),Rn(this,xe,Jr(tf))),this.metadata_offset_=(Rn(this,ge),Rn(this,Pe,0)),this.metadata_offset=(Rn(this,Ie),Rn(this,He,0)),this.metadata=Rn(this,it),this.label=Rn(this,Re,""),this._padding=(Rn(this,H),Rn(this,Te,new Array(132).fill(0))),Rn(this,ce),this.store=ne,ne._view.getUint32(gae(oe,"magic"),!0)!=CO){Ei("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new tf(this),this.metadata.offset=Jr(oe),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(Jr(oe)+Jr(tf)),this.total_bytes=BigInt(ne._buffer.byteLength),ne._write(this),ne._write(this.metadata);return}if(i_(this,ne._buffer.subarray(0,Jr(oe))),!XB(this))throw a_(new Ve(ut.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new tf(this,this.metadata_offset)}rotateMetadata(){const ne=new tf(this);return ne.offset=Number(this.used_bytes),ne.previous_offset=this.metadata_offset,this.metadata=ne,this.metadata_offset=ne.offset,this.store._write(ne),this.used_bytes+=BigInt(Jr(tf)),this.store._write(this),ne}isUnused(ne,Se){if(!Se)return!0;if(ne+Se>this.total_bytes||ne<Jr(oe))return!1;for(let Fe=this.metadata;Fe;Fe=Fe.previous){if(ne<Fe.offset+Jr(tf)&&ne+Se>Fe.offset)return!1;for(const ke of Fe.entries)if(ke.offset&&(ne>=ke.offset&&ne<ke.offset+ke.size||ne+Se>ke.offset&&ne+Se<=ke.offset+ke.size||ne<=ke.offset&&ne+Se>=ke.offset+ke.size))return!1}return!0}};return vN(v,"SuperBlock"),(()=>{const ne=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;b=[(e=Sn).uint32.bind(e)],_=[(t=Sn).uint32.bind(t)],k=[(n=Sn).uint16.bind(n)],j=[(r=Sn).uint16.bind(r)],q=[(s=Sn).uint32.bind(s)],z=[(i=Sn).uint64.bind(i)],ee=[(a=Sn).uint64.bind(a)],Y=[(o=Sn).uint128.bind(o)],ae=[(l=Sn).uint32.bind(l)],Me=[(c=Sn).uint32.bind(c)],Ce=[(u=Sn).uint32.bind(u)],Ge=[Sn.char(64)],me=[Sn.char(132)],Yr(null,null,b,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:Se=>"checksum"in Se,get:Se=>Se.checksum,set:(Se,Fe)=>{Se.checksum=Fe}},metadata:ne},w,x),Yr(null,null,_,{kind:"field",name:"magic",static:!1,private:!1,access:{has:Se=>"magic"in Se,get:Se=>Se.magic,set:(Se,Fe)=>{Se.magic=Fe}},metadata:ne},E,C),Yr(null,null,k,{kind:"field",name:"version",static:!1,private:!1,access:{has:Se=>"version"in Se,get:Se=>Se.version,set:(Se,Fe)=>{Se.version=Fe}},metadata:ne},R,I),Yr(null,null,j,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:Se=>"inode_format"in Se,get:Se=>Se.inode_format,set:(Se,Fe)=>{Se.inode_format=Fe}},metadata:ne},M,L),Yr(null,null,q,{kind:"field",name:"flags",static:!1,private:!1,access:{has:Se=>"flags"in Se,get:Se=>Se.flags,set:(Se,Fe)=>{Se.flags=Fe}},metadata:ne},P,V),Yr(null,null,z,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:Se=>"used_bytes"in Se,get:Se=>Se.used_bytes,set:(Se,Fe)=>{Se.used_bytes=Fe}},metadata:ne},re,K),Yr(null,null,ee,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:Se=>"total_bytes"in Se,get:Se=>Se.total_bytes,set:(Se,Fe)=>{Se.total_bytes=Fe}},metadata:ne},W,se),Yr(null,null,Y,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:Se=>"uuid"in Se,get:Se=>Se.uuid,set:(Se,Fe)=>{Se.uuid=Fe}},metadata:ne},te,Q),Yr(null,null,ae,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:Se=>"metadata_block_size"in Se,get:Se=>Se.metadata_block_size,set:(Se,Fe)=>{Se.metadata_block_size=Fe}},metadata:ne},xe,ge),Yr(null,null,Me,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:Se=>"metadata_offset_"in Se,get:Se=>Se.metadata_offset_,set:(Se,Fe)=>{Se.metadata_offset_=Fe}},metadata:ne},Pe,Ie),Yr(null,null,Ce,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:Se=>"metadata_offset"in Se,get:Se=>Se.metadata_offset,set:(Se,Fe)=>{Se.metadata_offset=Fe}},metadata:ne},He,it),Yr(null,null,Ge,{kind:"field",name:"label",static:!1,private:!1,access:{has:Se=>"label"in Se,get:Se=>Se.label,set:(Se,Fe)=>{Se.label=Fe}},metadata:ne},Re,H),Yr(null,null,me,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:Se=>"_padding"in Se,get:Se=>Se._padding,set:(Se,Fe)=>{Se._padding=Fe}},metadata:ne},Te,ce),Yr(null,m={value:v},f,{kind:"class",name:v.name,metadata:ne},null,g),oe=v=m.value,ne&&Object.defineProperty(v,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:ne}),Rn(v,g)})(),oe=v})();function XB(e){const t=ui(e),n=ice(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=ii;function ace(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function nA(e,t,n){if(e instanceof Ve)return e;const r=e instanceof DOMException?ut[ace(e)]:ut.EIO,s=new Ve(r,e.message,t,n);return s.stack=e.stack,s.cause=e.cause,s}function up(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(nA(e.error))}})}class oce extends QT{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await up(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await up(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await up(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),up(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(nA(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(nA(this.tx.error)),this.tx.abort(),t}}async function lce(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(Ei("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await up(n)}class cce{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new oce(t,this)}}const uce={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await up(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await lce(e.storeName||"zenfs",e.idbFactory),n=new cce(t),r=new fB(n);if(e!=null&&e.disableAsyncCache)return HR("Async preloading disabled for IndexedDB"),r;const s=n.transaction();for(const i of await s.keys())await s.get(i);return r}},dce=uce,en={vfsKeyChanged:"vfs.key.changed",nodesUpdated:"vfs.nodes.updated",selectionChanged:"vfs.selection.changed",loadingStateChanged:"vfs.loading.state.changed",fsInstanceChanged:"vfs.instance.changed",vfsEnabledChanged:"vfs.enabled.changed",fileWritten:"vfs.sdk.fileWritten",fileRead:"vfs.sdk.fileRead",fileDeleted:"vfs.sdk.fileDeleted",setVfsKeyRequest:"vfs.set.vfs.key.request",initializeVFSRequest:"vfs.initialize.vfs.request",fetchNodesRequest:"vfs.fetch.nodes.request",setCurrentPathRequest:"vfs.set.current.path.request",createDirectoryRequest:"vfs.create.directory.request",uploadFilesRequest:"vfs.upload.files.request",deleteNodesRequest:"vfs.delete.nodes.request",renameNodeRequest:"vfs.rename.node.request",downloadFileRequest:"vfs.download.file.request",selectFileRequest:"vfs.select.file.request",deselectFileRequest:"vfs.deselect.file.request",clearSelectionRequest:"vfs.clear.selection.request",setEnableVfsRequest:"vfs.set.enable.vfs.request"};function pw(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var OC={exports:{}},kO;function fce(){return kO||(kO=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,s,i){function a(c,u){if(!s[c]){if(!r[c]){var f=typeof pw=="function"&&pw;if(!u&&f)return f(c,!0);if(o)return o(c,!0);var m=new Error("Cannot find module '"+c+"'");throw m.code="MODULE_NOT_FOUND",m}var g=s[c]={exports:{}};r[c][0].call(g.exports,function(v){var b=r[c][1][v];return a(b||v)},g,g.exports,n,r,s,i)}return s[c].exports}for(var o=typeof pw=="function"&&pw,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(n,r,s){var i=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,f,m,g,v,b,w=[],x=0,_=l.length,E=_,C=i.getTypeOf(l)!=="string";x<l.length;)E=_-x,f=C?(c=l[x++],u=x<_?l[x++]:0,x<_?l[x++]:0):(c=l.charCodeAt(x++),u=x<_?l.charCodeAt(x++):0,x<_?l.charCodeAt(x++):0),m=c>>2,g=(3&c)<<4|u>>4,v=1<E?(15&u)<<2|f>>6:64,b=2<E?63&f:64,w.push(o.charAt(m)+o.charAt(g)+o.charAt(v)+o.charAt(b));return w.join("")},s.decode=function(l){var c,u,f,m,g,v,b=0,w=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var _,E=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&E--,l.charAt(l.length-2)===o.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=a.uint8array?new Uint8Array(0|E):new Array(0|E);b<l.length;)c=o.indexOf(l.charAt(b++))<<2|(m=o.indexOf(l.charAt(b++)))>>4,u=(15&m)<<4|(g=o.indexOf(l.charAt(b++)))>>2,f=(3&g)<<6|(v=o.indexOf(l.charAt(b++))),_[w++]=c,g!==64&&(_[w++]=u),v!==64&&(_[w++]=f);return _}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,f,m,g,v){this.compressedSize=u,this.uncompressedSize=f,this.crc32=m,this.compression=g,this.compressedContent=v}c.prototype={getContentWorker:function(){var u=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,f,m){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(m)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(c,u,f,m){var g=a,v=m+f;c^=-1;for(var b=m;b<v;b++)c=c>>>8^g[255&(c^u[b])];return-1^c}(0|l,o,o.length,0):function(c,u,f,m){var g=a,v=m+f;c^=-1;for(var b=m;b<v;b++)c=c>>>8^g[255&(c^u.charCodeAt(b))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),c=i?"uint8array":"array";function u(f,m){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=m,this.meta={}}s.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,f.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(m){f.push({data:m,meta:f.meta})}},s.compressWorker=function(f){return new u("Deflate",f)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(g,v){var b,w="";for(b=0;b<v;b++)w+=String.fromCharCode(255&g),g>>>=8;return w}function a(g,v,b,w,x,_){var E,C,k=g.file,R=g.compression,I=_!==c.utf8encode,j=o.transformTo("string",_(k.name)),M=o.transformTo("string",c.utf8encode(k.name)),L=k.comment,q=o.transformTo("string",_(L)),P=o.transformTo("string",c.utf8encode(L)),V=M.length!==k.name.length,z=P.length!==L.length,re="",K="",ee="",W=k.dir,se=k.date,Y={crc32:0,compressedSize:0,uncompressedSize:0};v&&!b||(Y.crc32=g.crc32,Y.compressedSize=g.compressedSize,Y.uncompressedSize=g.uncompressedSize);var te=0;v&&(te|=8),I||!V&&!z||(te|=2048);var Q=0,ae=0;W&&(Q|=16),x==="UNIX"?(ae=798,Q|=function(ge,Me){var Pe=ge;return ge||(Pe=Me?16893:33204),(65535&Pe)<<16}(k.unixPermissions,W)):(ae=20,Q|=function(ge){return 63&(ge||0)}(k.dosPermissions)),E=se.getUTCHours(),E<<=6,E|=se.getUTCMinutes(),E<<=5,E|=se.getUTCSeconds()/2,C=se.getUTCFullYear()-1980,C<<=4,C|=se.getUTCMonth()+1,C<<=5,C|=se.getUTCDate(),V&&(K=i(1,1)+i(u(j),4)+M,re+="up"+i(K.length,2)+K),z&&(ee=i(1,1)+i(u(q),4)+P,re+="uc"+i(ee.length,2)+ee);var xe="";return xe+=`
\0`,xe+=i(te,2),xe+=R.magic,xe+=i(E,2),xe+=i(C,2),xe+=i(Y.crc32,4),xe+=i(Y.compressedSize,4),xe+=i(Y.uncompressedSize,4),xe+=i(j.length,2),xe+=i(re.length,2),{fileRecord:f.LOCAL_FILE_HEADER+xe+j+re,dirRecord:f.CENTRAL_FILE_HEADER+i(ae,2)+xe+i(q.length,2)+"\0\0\0\0"+i(Q,4)+i(w,4)+j+re+q}}var o=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),f=n("../signature");function m(g,v,b,w){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=b,this.encodeFileName=w,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(m,l),m.prototype.push=function(g){var v=g.meta.percent||0,b=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,l.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:b?(v+100*(b-w-1))/b:100}}))},m.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var v=this.streamFiles&&!g.file.dir;if(v){var b=a(g,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(g){this.accumulate=!1;var v=this.streamFiles&&!g.file.dir,b=a(g,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),v)this.push({data:function(w){return f.DATA_DESCRIPTOR+i(w.crc32,4)+i(w.compressedSize,4)+i(w.uncompressedSize,4)}(g),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var g=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var b=this.bytesWritten-g,w=function(x,_,E,C,k){var R=o.transformTo("string",k(C));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(x,2)+i(x,2)+i(_,4)+i(E,4)+i(R.length,2)+R}(this.dirRecords.length,b,g,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(g){this._sources.push(g);var v=this;return g.on("data",function(b){v.processChunk(b)}),g.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),g.on("error",function(b){v.error(b)}),this},m.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(g){var v=this._sources;if(!l.prototype.error.call(this,g))return!1;for(var b=0;b<v.length;b++)try{v[b].error(g)}catch{}return!0},m.prototype.lock=function(){l.prototype.lock.call(this);for(var g=this._sources,v=0;v<g.length;v++)g[v].lock()},r.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),a=n("./ZipFileWorker");s.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),f=0;try{o.forEach(function(m,g){f++;var v=function(_,E){var C=_||E,k=i[C];if(!k)throw new Error(C+" is not a valid compression method !");return k}(g.options.compression,l.compression),b=g.options.compressionOptions||l.compressionOptions||{},w=g.dir,x=g.date;g._compressWorker(v,b).withStreamInfo("file",{name:m,dir:w,date:x,comment:g.comment||"",unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(m){u.error(m)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,o){return new i().loadAsync(a,o)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),a=n("./external"),o=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function f(m){return new a.Promise(function(g,v){var b=m.decompressed.getContentWorker().pipe(new c);b.on("error",function(w){v(w)}).on("end",function(){b.streamInfo.crc32!==m.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}r.exports=function(m,g){var v=this;return g=i.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(m)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",m,!0,g.optimizedBinaryString,g.base64).then(function(b){var w=new l(g);return w.load(b),w}).then(function(b){var w=[a.Promise.resolve(b)],x=b.files;if(g.checkCRC32)for(var _=0;_<x.length;_++)w.push(f(x[_]));return a.Promise.all(w)}).then(function(b){for(var w=b.shift(),x=w.files,_=0;_<x.length;_++){var E=x[_],C=E.fileNameStr,k=i.resolve(E.fileNameStr);v.file(k,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:g.createFolders}),E.dir||(v.file(k).unsafeOriginalName=C)}return w.zipComment.length&&(v.comment=w.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),a=n("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function a(o,l,c){i.call(this,l),this._helper=o;var u=this;o.on("data",function(f,m){u.push(f)||u._helper.pause(),c&&c(m)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof Xt<"u",newBufferFrom:function(i,a){if(Xt.from&&Xt.from!==Uint8Array.from)return Xt.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Xt(i,a)},allocBuffer:function(i){if(Xt.alloc)return Xt.alloc(i);var a=new Xt(i);return a.fill(0),a},isBuffer:function(i){return Xt.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(k,R,I){var j,M=o.getTypeOf(R),L=o.extend(I||{},u);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&16384&L.unixPermissions&&(L.dir=!0),L.dosPermissions&&16&L.dosPermissions&&(L.dir=!0),L.dir&&(k=x(k)),L.createFolders&&(j=w(k))&&_.call(this,j,!0);var q=M==="string"&&L.binary===!1&&L.base64===!1;I&&I.binary!==void 0||(L.binary=!q),(R instanceof f&&R.uncompressedSize===0||L.dir||!R||R.length===0)&&(L.base64=!1,L.binary=!0,R="",L.compression="STORE",M="string");var P=null;P=R instanceof f||R instanceof l?R:v.isNode&&v.isStream(R)?new b(k,R):o.prepareContent(k,R,L.binary,L.optimizedBinaryString,L.base64);var V=new m(k,P,L);this.files[k]=V}var a=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),f=n("./compressedObject"),m=n("./zipObject"),g=n("./generate"),v=n("./nodejsUtils"),b=n("./nodejs/NodejsStreamInputAdapter"),w=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var R=k.lastIndexOf("/");return 0<R?k.substring(0,R):""},x=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},_=function(k,R){return R=R!==void 0?R:u.createFolders,k=x(k),this.files[k]||i.call(this,k,null,{dir:!0,createFolders:R}),this.files[k]};function E(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var R,I,j;for(R in this.files)j=this.files[R],(I=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&k(I,j)},filter:function(k){var R=[];return this.forEach(function(I,j){k(I,j)&&R.push(j)}),R},file:function(k,R,I){if(arguments.length!==1)return k=this.root+k,i.call(this,k,R,I),this;if(E(k)){var j=k;return this.filter(function(L,q){return!q.dir&&j.test(L)})}var M=this.files[this.root+k];return M&&!M.dir?M:null},folder:function(k){if(!k)return this;if(E(k))return this.filter(function(M,L){return L.dir&&k.test(M)});var R=this.root+k,I=_.call(this,R),j=this.clone();return j.root=I.name,j},remove:function(k){k=this.root+k;var R=this.files[k];if(R||(k.slice(-1)!=="/"&&(k+="/"),R=this.files[k]),R&&!R.dir)delete this.files[k];else for(var I=this.filter(function(M,L){return L.name.slice(0,k.length)===k}),j=0;j<I.length;j++)delete this.files[I[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var R,I={};try{if((I=o.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");o.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var j=I.comment||this.comment||"";R=g.generateWorker(this,I,j)}catch(M){(R=new l("error")).error(M)}return new c(R,I.type||"string",I.mimeType)},generateAsync:function(k,R){return this.generateInternalStream(k).accumulate(R)},generateNodeStream:function(k,R){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(R)}};r.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),f=o.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===l&&this.data[m+1]===c&&this.data[m+2]===u&&this.data[m+3]===f)return m-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),f=o.charCodeAt(3),m=this.readData(4);return l===m[0]&&c===m[1]&&u===m[2]&&f===m[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),a=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(f){var m=i.getTypeOf(f);return i.checkSupport(m),m!=="string"||a.uint8array?m==="nodebuffer"?new c(f):a.uint8array?new u(i.transformTo("uint8array",f)):new o(i.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),a=n("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),a=n("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),f=null;if(c.nodestream)try{f=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(v,b){return new u.Promise(function(w,x){var _=[],E=v._internalType,C=v._outputType,k=v._mimeType;v.on("data",function(R,I){_.push(R),b&&b(I)}).on("error",function(R){_=[],x(R)}).on("end",function(){try{var R=function(I,j,M){switch(I){case"blob":return i.newBlob(i.transformTo("arraybuffer",j),M);case"base64":return l.encode(j);default:return i.transformTo(I,j)}}(C,function(I,j){var M,L=0,q=null,P=0;for(M=0;M<j.length;M++)P+=j[M].length;switch(I){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(q=new Uint8Array(P),M=0;M<j.length;M++)q.set(j[M],L),L+=j[M].length;return q;case"nodebuffer":return Xt.concat(j);default:throw new Error("concat : unsupported type '"+I+"'")}}(E,_),k);w(R)}catch(I){x(I)}_=[]}).resume()})}function g(v,b,w){var x=b;switch(b){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=b,this._mimeType=w,i.checkSupport(x),this._worker=v.pipe(new a(x)),v.lock()}catch(_){this._worker=new o("error"),this._worker.error(_)}}g.prototype={accumulate:function(v){return m(this,v)},on:function(v,b){var w=this;return v==="data"?this._worker.on(v,function(x){b.call(w,x.data,x.meta)}):this._worker.on(v,function(){i.delay(b,arguments,w)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},v)}},r.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Xt<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function m(){l.call(this,"utf-8 encode")}s.utf8encode=function(g){return a.nodebuffer?o.newBufferFrom(g,"utf-8"):function(v){var b,w,x,_,E,C=v.length,k=0;for(_=0;_<C;_++)(64512&(w=v.charCodeAt(_)))==55296&&_+1<C&&(64512&(x=v.charCodeAt(_+1)))==56320&&(w=65536+(w-55296<<10)+(x-56320),_++),k+=w<128?1:w<2048?2:w<65536?3:4;for(b=a.uint8array?new Uint8Array(k):new Array(k),_=E=0;E<k;_++)(64512&(w=v.charCodeAt(_)))==55296&&_+1<C&&(64512&(x=v.charCodeAt(_+1)))==56320&&(w=65536+(w-55296<<10)+(x-56320),_++),w<128?b[E++]=w:(w<2048?b[E++]=192|w>>>6:(w<65536?b[E++]=224|w>>>12:(b[E++]=240|w>>>18,b[E++]=128|w>>>12&63),b[E++]=128|w>>>6&63),b[E++]=128|63&w);return b}(g)},s.utf8decode=function(g){return a.nodebuffer?i.transformTo("nodebuffer",g).toString("utf-8"):function(v){var b,w,x,_,E=v.length,C=new Array(2*E);for(b=w=0;b<E;)if((x=v[b++])<128)C[w++]=x;else if(4<(_=c[x]))C[w++]=65533,b+=_-1;else{for(x&=_===2?31:_===3?15:7;1<_&&b<E;)x=x<<6|63&v[b++],_--;1<_?C[w++]=65533:x<65536?C[w++]=x:(x-=65536,C[w++]=55296|x>>10&1023,C[w++]=56320|1023&x)}return C.length!==w&&(C.subarray?C=C.subarray(0,w):C.length=w),i.applyFromCharCode(C)}(g=i.transformTo(a.uint8array?"uint8array":"array",g))},i.inherits(f,l),f.prototype.processChunk=function(g){var v=i.transformTo(a.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=v;(v=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),v.set(b,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var w=function(_,E){var C;for((E=E||_.length)>_.length&&(E=_.length),C=E-1;0<=C&&(192&_[C])==128;)C--;return C<0||C===0?E:C+c[_[C]]>E?C:E}(v),x=v;w!==v.length&&(a.uint8array?(x=v.subarray(0,w),this.leftOver=v.subarray(w,v.length)):(x=v.slice(0,w),this.leftOver=v.slice(w,v.length))),this.push({data:s.utf8decode(x),meta:g.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=f,i.inherits(m,l),m.prototype.processChunk=function(g){this.push({data:s.utf8encode(g.data),meta:g.meta})},s.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function c(b){return b}function u(b,w){for(var x=0;x<b.length;++x)w[x]=255&b.charCodeAt(x);return w}n("setimmediate"),s.newBlob=function(b,w){s.checkSupport("blob");try{return new Blob([b],{type:w})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(b),x.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(b,w,x){var _=[],E=0,C=b.length;if(C<=x)return String.fromCharCode.apply(null,b);for(;E<C;)w==="array"||w==="nodebuffer"?_.push(String.fromCharCode.apply(null,b.slice(E,Math.min(E+x,C)))):_.push(String.fromCharCode.apply(null,b.subarray(E,Math.min(E+x,C)))),E+=x;return _.join("")},stringifyByChar:function(b){for(var w="",x=0;x<b.length;x++)w+=String.fromCharCode(b[x]);return w},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function m(b){var w=65536,x=s.getTypeOf(b),_=!0;if(x==="uint8array"?_=f.applyCanBeUsed.uint8array:x==="nodebuffer"&&(_=f.applyCanBeUsed.nodebuffer),_)for(;1<w;)try{return f.stringifyByChunk(b,x,w)}catch{w=Math.floor(w/2)}return f.stringifyByChar(b)}function g(b,w){for(var x=0;x<b.length;x++)w[x]=b[x];return w}s.applyFromCharCode=m;var v={};v.string={string:c,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return v.string.uint8array(b).buffer},uint8array:function(b){return u(b,new Uint8Array(b.length))},nodebuffer:function(b){return u(b,o.allocBuffer(b.length))}},v.array={string:m,array:c,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(b)}},v.arraybuffer={string:function(b){return m(new Uint8Array(b))},array:function(b){return g(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(new Uint8Array(b))}},v.uint8array={string:m,array:function(b){return g(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return o.newBufferFrom(b)}},v.nodebuffer={string:m,array:function(b){return g(b,new Array(b.length))},arraybuffer:function(b){return v.nodebuffer.uint8array(b).buffer},uint8array:function(b){return g(b,new Uint8Array(b.length))},nodebuffer:c},s.transformTo=function(b,w){if(w=w||"",!b)return w;s.checkSupport(b);var x=s.getTypeOf(w);return v[x][b](w)},s.resolve=function(b){for(var w=b.split("/"),x=[],_=0;_<w.length;_++){var E=w[_];E==="."||E===""&&_!==0&&_!==w.length-1||(E===".."?x.pop():x.push(E))}return x.join("/")},s.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(b)?"nodebuffer":i.uint8array&&b instanceof Uint8Array?"uint8array":i.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(b){if(!i[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(b){var w,x,_="";for(x=0;x<(b||"").length;x++)_+="\\x"+((w=b.charCodeAt(x))<16?"0":"")+w.toString(16).toUpperCase();return _},s.delay=function(b,w,x){setImmediate(function(){b.apply(x||null,w||[])})},s.inherits=function(b,w){function x(){}x.prototype=w.prototype,b.prototype=new x},s.extend=function(){var b,w,x={};for(b=0;b<arguments.length;b++)for(w in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],w)&&x[w]===void 0&&(x[w]=arguments[b][w]);return x},s.prepareContent=function(b,w,x,_,E){return l.Promise.resolve(w).then(function(C){return i.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new l.Promise(function(k,R){var I=new FileReader;I.onload=function(j){k(j.target.result)},I.onerror=function(j){R(j.target.error)},I.readAsArrayBuffer(C)}):C}).then(function(C){var k=s.getTypeOf(C);return k?(k==="arraybuffer"?C=s.transformTo("uint8array",C):k==="string"&&(E?C=a.decode(C):x&&_!==!0&&(C=function(R){return u(R,i.uint8array?new Uint8Array(R.length):new Array(R.length))}(C))),C):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(m)+", expected "+a.pretty(f)+")")}},isSignature:function(f,m){var g=this.reader.index;this.reader.setIndex(f);var v=this.reader.readString(4)===m;return this.reader.setIndex(g),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),m=c.uint8array?"uint8array":"array",g=a.transformTo(m,f);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,m,g,v=this.zip64EndOfCentralSize-44;0<v;)f=this.reader.readInt(2),m=this.reader.readInt(4),g=this.reader.readData(m),this.zip64ExtensibleData[f]={id:f,length:m,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,m;for(f=0;f<this.files.length;f++)m=this.files[f],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var m=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);var v=m-g;if(0<v)this.isSignature(m,o.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(f){this.reader=i(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),f=n("./support");function m(g,v){this.options=g,this.loadOptions=v}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(g){var v,b;if(g.skip(22),this.fileNameLength=g.readInt(2),b=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(w){for(var x in u)if(Object.prototype.hasOwnProperty.call(u,x)&&u[x].magic===w)return u[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,v,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var v=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(v),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),g==0&&(this.dosPermissions=63&this.externalFileAttributes),g==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var v,b,w,x=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<x;)v=g.readInt(2),b=g.readInt(2),w=g.readData(b),this.extraFields[v]={id:v,length:b,value:w};g.setIndex(x)},handleUTF8:function(){var g=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var b=a.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var x=a.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var v=i(g.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:c.utf8decode(v.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var v=i(g.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:c.utf8decode(v.readData(g.length-5))}return null}},r.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(v,b,w){this.name=v,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=b,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");i.prototype={internalStream:function(v){var b=null,w="string";try{if(!v)throw new Error("No output type specified.");var x=(w=v.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),b=this._decompressWorker();var _=!this._dataBinary;_&&!x&&(b=b.pipe(new l.Utf8EncodeWorker)),!_&&x&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(E){(b=new u("error")).error(E)}return new a(b,w,"")},async:function(v,b){return this.internalStream(v).accumulate(b)},nodeStream:function(v,b){return this.internalStream(v||"nodebuffer").toNodejsStream(b)},_compressWorker:function(v,b){if(this._data instanceof c&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(w,v,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<f.length;g++)i.prototype[f[g]]=m;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var a,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(v),f=i.document.createTextNode("");u.observe(f,{characterData:!0}),a=function(){f.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var b=i.document.createElement("script");b.onreadystatechange=function(){v(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:function(){setTimeout(v,0)};else{var m=new i.MessageChannel;m.port1.onmessage=v,a=function(){m.port2.postMessage(0)}}var g=[];function v(){var b,w;o=!0;for(var x=g.length;x;){for(w=g,g=[],b=-1;++b<x;)w[b]();x=g.length}o=!1}r.exports=function(b){g.push(b)!==1||o||a()}}).call(this,typeof hf<"u"?hf:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function f(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,x!==a&&b(this,x)}function m(x,_,E){this.promise=x,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function g(x,_,E){i(function(){var C;try{C=_(E)}catch(k){return o.reject(x,k)}C===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,C)})}function v(x){var _=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof _=="function")return function(){_.apply(x,arguments)}}function b(x,_){var E=!1;function C(I){E||(E=!0,o.reject(x,I))}function k(I){E||(E=!0,o.resolve(x,I))}var R=w(function(){_(k,C)});R.status==="error"&&C(R.value)}function w(x,_){var E={};try{E.value=x(_),E.status="success"}catch(C){E.status="error",E.value=C}return E}(r.exports=f).prototype.finally=function(x){if(typeof x!="function")return this;var _=this.constructor;return this.then(function(E){return _.resolve(x()).then(function(){return E})},function(E){return _.resolve(x()).then(function(){throw E})})},f.prototype.catch=function(x){return this.then(null,x)},f.prototype.then=function(x,_){if(typeof x!="function"&&this.state===c||typeof _!="function"&&this.state===l)return this;var E=new this.constructor(a);return this.state!==u?g(E,this.state===c?x:_,this.outcome):this.queue.push(new m(E,x,_)),E},m.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},m.prototype.otherCallFulfilled=function(x){g(this.promise,this.onFulfilled,x)},m.prototype.callRejected=function(x){o.reject(this.promise,x)},m.prototype.otherCallRejected=function(x){g(this.promise,this.onRejected,x)},o.resolve=function(x,_){var E=w(v,_);if(E.status==="error")return o.reject(x,E.value);var C=E.value;if(C)b(x,C);else{x.state=c,x.outcome=_;for(var k=-1,R=x.queue.length;++k<R;)x.queue[k].callFulfilled(_)}return x},o.reject=function(x,_){x.state=l,x.outcome=_;for(var E=-1,C=x.queue.length;++E<C;)x.queue[E].callRejected(_);return x},f.resolve=function(x){return x instanceof this?x:o.resolve(new this(a),x)},f.reject=function(x){var _=new this(a);return o.reject(_,x)},f.all=function(x){var _=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=x.length,C=!1;if(!E)return this.resolve([]);for(var k=new Array(E),R=0,I=-1,j=new this(a);++I<E;)M(x[I],I);return j;function M(L,q){_.resolve(L).then(function(P){k[q]=P,++R!==E||C||(C=!0,o.resolve(j,k))},function(P){C||(C=!0,o.reject(j,P))})}},f.race=function(x){var _=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=x.length,C=!1;if(!E)return this.resolve([]);for(var k=-1,R=new this(a);++k<E;)I=x[k],_.resolve(I).then(function(j){C||(C=!0,o.resolve(R,j))},function(j){C||(C=!0,o.reject(R,j))});var I;return R}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,f=0,m=-1,g=0,v=8;function b(x){if(!(this instanceof b))return new b(x);this.options=a.assign({level:m,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},x||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var E=i.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(E!==f)throw new Error(l[E]);if(_.header&&i.deflateSetHeader(this.strm,_.header),_.dictionary){var C;if(C=typeof _.dictionary=="string"?o.string2buf(_.dictionary):u.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(E=i.deflateSetDictionary(this.strm,C))!==f)throw new Error(l[E]);this._dict_set=!0}}function w(x,_){var E=new b(_);if(E.push(x,!0),E.err)throw E.msg||l[E.err];return E.result}b.prototype.push=function(x,_){var E,C,k=this.strm,R=this.options.chunkSize;if(this.ended)return!1;C=_===~~_?_:_===!0?4:0,typeof x=="string"?k.input=o.string2buf(x):u.call(x)==="[object ArrayBuffer]"?k.input=new Uint8Array(x):k.input=x,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new a.Buf8(R),k.next_out=0,k.avail_out=R),(E=i.deflate(k,C))!==1&&E!==f)return this.onEnd(E),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(k.output,k.next_out))):this.onData(a.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&E!==1);return C===4?(E=i.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===f):C!==2||(this.onEnd(f),!(k.avail_out=0))},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},s.Deflate=b,s.deflate=w,s.deflateRaw=function(x,_){return(_=_||{}).raw=!0,w(x,_)},s.gzip=function(x,_){return(_=_||{}).gzip=!0,w(x,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),f=n("./zlib/gzheader"),m=Object.prototype.toString;function g(b){if(!(this instanceof g))return new g(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||b&&b.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&(15&w.windowBits)==0&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=i.inflateInit2(this.strm,w.windowBits);if(x!==l.Z_OK)throw new Error(c[x]);this.header=new f,i.inflateGetHeader(this.strm,this.header)}function v(b,w){var x=new g(w);if(x.push(b,!0),x.err)throw x.msg||c[x.err];return x.result}g.prototype.push=function(b,w){var x,_,E,C,k,R,I=this.strm,j=this.options.chunkSize,M=this.options.dictionary,L=!1;if(this.ended)return!1;_=w===~~w?w:w===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?I.input=o.binstring2buf(b):m.call(b)==="[object ArrayBuffer]"?I.input=new Uint8Array(b):I.input=b,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new a.Buf8(j),I.next_out=0,I.avail_out=j),(x=i.inflate(I,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&M&&(R=typeof M=="string"?o.string2buf(M):m.call(M)==="[object ArrayBuffer]"?new Uint8Array(M):M,x=i.inflateSetDictionary(this.strm,R)),x===l.Z_BUF_ERROR&&L===!0&&(x=l.Z_OK,L=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&x!==l.Z_STREAM_END&&(I.avail_in!==0||_!==l.Z_FINISH&&_!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=o.utf8border(I.output,I.next_out),C=I.next_out-E,k=o.buf2string(I.output,E),I.next_out=C,I.avail_out=j-C,C&&a.arraySet(I.output,I.output,E,C,0),this.onData(k)):this.onData(a.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(L=!0)}while((0<I.avail_in||I.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(_=l.Z_FINISH),_===l.Z_FINISH?(x=i.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):_!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(I.avail_out=0))},g.prototype.onData=function(b){this.chunks.push(b)},g.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},s.Inflate=g,s.inflate=v,s.inflateRaw=function(b,w){return(w=w||{}).raw=!0,v(b,w)},s.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(l[f]=u[f])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,f,m){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+f),m);else for(var g=0;g<f;g++)l[m+g]=c[u+g]},flattenChunks:function(l){var c,u,f,m,g,v;for(c=f=0,u=l.length;c<u;c++)f+=l[c].length;for(v=new Uint8Array(f),c=m=0,u=l.length;c<u;c++)g=l[c],v.set(g,m),m+=g.length;return v}},o={arraySet:function(l,c,u,f,m){for(var g=0;g<f;g++)l[m+g]=c[u+g]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(f,m){if(m<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(f,m));for(var g="",v=0;v<m;v++)g+=String.fromCharCode(f[v]);return g}l[254]=l[254]=1,s.string2buf=function(f){var m,g,v,b,w,x=f.length,_=0;for(b=0;b<x;b++)(64512&(g=f.charCodeAt(b)))==55296&&b+1<x&&(64512&(v=f.charCodeAt(b+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),b++),_+=g<128?1:g<2048?2:g<65536?3:4;for(m=new i.Buf8(_),b=w=0;w<_;b++)(64512&(g=f.charCodeAt(b)))==55296&&b+1<x&&(64512&(v=f.charCodeAt(b+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),b++),g<128?m[w++]=g:(g<2048?m[w++]=192|g>>>6:(g<65536?m[w++]=224|g>>>12:(m[w++]=240|g>>>18,m[w++]=128|g>>>12&63),m[w++]=128|g>>>6&63),m[w++]=128|63&g);return m},s.buf2binstring=function(f){return u(f,f.length)},s.binstring2buf=function(f){for(var m=new i.Buf8(f.length),g=0,v=m.length;g<v;g++)m[g]=f.charCodeAt(g);return m},s.buf2string=function(f,m){var g,v,b,w,x=m||f.length,_=new Array(2*x);for(g=v=0;g<x;)if((b=f[g++])<128)_[v++]=b;else if(4<(w=l[b]))_[v++]=65533,g+=w-1;else{for(b&=w===2?31:w===3?15:7;1<w&&g<x;)b=b<<6|63&f[g++],w--;1<w?_[v++]=65533:b<65536?_[v++]=b:(b-=65536,_[v++]=55296|b>>10&1023,_[v++]=56320|1023&b)}return u(_,v)},s.utf8border=function(f,m){var g;for((m=m||f.length)>f.length&&(m=f.length),g=m-1;0<=g&&(192&f[g])==128;)g--;return g<0||g===0?m:g+l[f[g]]>m?g:m}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,a,o,l){for(var c=65535&i|0,u=i>>>16&65535|0,f=0;o!==0;){for(o-=f=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--f;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=i,f=c+l;a^=-1;for(var m=c;m<f;m++)a=a>>>8^u[255&(a^o[m])];return-1^a}},{}],46:[function(n,r,s){var i,a=n("../utils/common"),o=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),f=0,m=4,g=0,v=-2,b=-1,w=4,x=2,_=8,E=9,C=286,k=30,R=19,I=2*C+1,j=15,M=3,L=258,q=L+M+1,P=42,V=113,z=1,re=2,K=3,ee=4;function W(H,me){return H.msg=u[me],me}function se(H){return(H<<1)-(4<H?9:0)}function Y(H){for(var me=H.length;0<=--me;)H[me]=0}function te(H){var me=H.state,Te=me.pending;Te>H.avail_out&&(Te=H.avail_out),Te!==0&&(a.arraySet(H.output,me.pending_buf,me.pending_out,Te,H.next_out),H.next_out+=Te,me.pending_out+=Te,H.total_out+=Te,H.avail_out-=Te,me.pending-=Te,me.pending===0&&(me.pending_out=0))}function Q(H,me){o._tr_flush_block(H,0<=H.block_start?H.block_start:-1,H.strstart-H.block_start,me),H.block_start=H.strstart,te(H.strm)}function ae(H,me){H.pending_buf[H.pending++]=me}function xe(H,me){H.pending_buf[H.pending++]=me>>>8&255,H.pending_buf[H.pending++]=255&me}function ge(H,me){var Te,ce,oe=H.max_chain_length,ne=H.strstart,Se=H.prev_length,Fe=H.nice_match,ke=H.strstart>H.w_size-q?H.strstart-(H.w_size-q):0,Xe=H.window,St=H.w_mask,ht=H.prev,It=H.strstart+L,Vt=Xe[ne+Se-1],Ot=Xe[ne+Se];H.prev_length>=H.good_match&&(oe>>=2),Fe>H.lookahead&&(Fe=H.lookahead);do if(Xe[(Te=me)+Se]===Ot&&Xe[Te+Se-1]===Vt&&Xe[Te]===Xe[ne]&&Xe[++Te]===Xe[ne+1]){ne+=2,Te++;do;while(Xe[++ne]===Xe[++Te]&&Xe[++ne]===Xe[++Te]&&Xe[++ne]===Xe[++Te]&&Xe[++ne]===Xe[++Te]&&Xe[++ne]===Xe[++Te]&&Xe[++ne]===Xe[++Te]&&Xe[++ne]===Xe[++Te]&&Xe[++ne]===Xe[++Te]&&ne<It);if(ce=L-(It-ne),ne=It-L,Se<ce){if(H.match_start=me,Fe<=(Se=ce))break;Vt=Xe[ne+Se-1],Ot=Xe[ne+Se]}}while((me=ht[me&St])>ke&&--oe!=0);return Se<=H.lookahead?Se:H.lookahead}function Me(H){var me,Te,ce,oe,ne,Se,Fe,ke,Xe,St,ht=H.w_size;do{if(oe=H.window_size-H.lookahead-H.strstart,H.strstart>=ht+(ht-q)){for(a.arraySet(H.window,H.window,ht,ht,0),H.match_start-=ht,H.strstart-=ht,H.block_start-=ht,me=Te=H.hash_size;ce=H.head[--me],H.head[me]=ht<=ce?ce-ht:0,--Te;);for(me=Te=ht;ce=H.prev[--me],H.prev[me]=ht<=ce?ce-ht:0,--Te;);oe+=ht}if(H.strm.avail_in===0)break;if(Se=H.strm,Fe=H.window,ke=H.strstart+H.lookahead,Xe=oe,St=void 0,St=Se.avail_in,Xe<St&&(St=Xe),Te=St===0?0:(Se.avail_in-=St,a.arraySet(Fe,Se.input,Se.next_in,St,ke),Se.state.wrap===1?Se.adler=l(Se.adler,Fe,St,ke):Se.state.wrap===2&&(Se.adler=c(Se.adler,Fe,St,ke)),Se.next_in+=St,Se.total_in+=St,St),H.lookahead+=Te,H.lookahead+H.insert>=M)for(ne=H.strstart-H.insert,H.ins_h=H.window[ne],H.ins_h=(H.ins_h<<H.hash_shift^H.window[ne+1])&H.hash_mask;H.insert&&(H.ins_h=(H.ins_h<<H.hash_shift^H.window[ne+M-1])&H.hash_mask,H.prev[ne&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=ne,ne++,H.insert--,!(H.lookahead+H.insert<M)););}while(H.lookahead<q&&H.strm.avail_in!==0)}function Pe(H,me){for(var Te,ce;;){if(H.lookahead<q){if(Me(H),H.lookahead<q&&me===f)return z;if(H.lookahead===0)break}if(Te=0,H.lookahead>=M&&(H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+M-1])&H.hash_mask,Te=H.prev[H.strstart&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=H.strstart),Te!==0&&H.strstart-Te<=H.w_size-q&&(H.match_length=ge(H,Te)),H.match_length>=M)if(ce=o._tr_tally(H,H.strstart-H.match_start,H.match_length-M),H.lookahead-=H.match_length,H.match_length<=H.max_lazy_match&&H.lookahead>=M){for(H.match_length--;H.strstart++,H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+M-1])&H.hash_mask,Te=H.prev[H.strstart&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=H.strstart,--H.match_length!=0;);H.strstart++}else H.strstart+=H.match_length,H.match_length=0,H.ins_h=H.window[H.strstart],H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+1])&H.hash_mask;else ce=o._tr_tally(H,0,H.window[H.strstart]),H.lookahead--,H.strstart++;if(ce&&(Q(H,!1),H.strm.avail_out===0))return z}return H.insert=H.strstart<M-1?H.strstart:M-1,me===m?(Q(H,!0),H.strm.avail_out===0?K:ee):H.last_lit&&(Q(H,!1),H.strm.avail_out===0)?z:re}function Ie(H,me){for(var Te,ce,oe;;){if(H.lookahead<q){if(Me(H),H.lookahead<q&&me===f)return z;if(H.lookahead===0)break}if(Te=0,H.lookahead>=M&&(H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+M-1])&H.hash_mask,Te=H.prev[H.strstart&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=H.strstart),H.prev_length=H.match_length,H.prev_match=H.match_start,H.match_length=M-1,Te!==0&&H.prev_length<H.max_lazy_match&&H.strstart-Te<=H.w_size-q&&(H.match_length=ge(H,Te),H.match_length<=5&&(H.strategy===1||H.match_length===M&&4096<H.strstart-H.match_start)&&(H.match_length=M-1)),H.prev_length>=M&&H.match_length<=H.prev_length){for(oe=H.strstart+H.lookahead-M,ce=o._tr_tally(H,H.strstart-1-H.prev_match,H.prev_length-M),H.lookahead-=H.prev_length-1,H.prev_length-=2;++H.strstart<=oe&&(H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+M-1])&H.hash_mask,Te=H.prev[H.strstart&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=H.strstart),--H.prev_length!=0;);if(H.match_available=0,H.match_length=M-1,H.strstart++,ce&&(Q(H,!1),H.strm.avail_out===0))return z}else if(H.match_available){if((ce=o._tr_tally(H,0,H.window[H.strstart-1]))&&Q(H,!1),H.strstart++,H.lookahead--,H.strm.avail_out===0)return z}else H.match_available=1,H.strstart++,H.lookahead--}return H.match_available&&(ce=o._tr_tally(H,0,H.window[H.strstart-1]),H.match_available=0),H.insert=H.strstart<M-1?H.strstart:M-1,me===m?(Q(H,!0),H.strm.avail_out===0?K:ee):H.last_lit&&(Q(H,!1),H.strm.avail_out===0)?z:re}function Ce(H,me,Te,ce,oe){this.good_length=H,this.max_lazy=me,this.nice_length=Te,this.max_chain=ce,this.func=oe}function He(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*I),this.dyn_dtree=new a.Buf16(2*(2*k+1)),this.bl_tree=new a.Buf16(2*(2*R+1)),Y(this.dyn_ltree),Y(this.dyn_dtree),Y(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(j+1),this.heap=new a.Buf16(2*C+1),Y(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*C+1),Y(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function it(H){var me;return H&&H.state?(H.total_in=H.total_out=0,H.data_type=x,(me=H.state).pending=0,me.pending_out=0,me.wrap<0&&(me.wrap=-me.wrap),me.status=me.wrap?P:V,H.adler=me.wrap===2?0:1,me.last_flush=f,o._tr_init(me),g):W(H,v)}function Ge(H){var me=it(H);return me===g&&function(Te){Te.window_size=2*Te.w_size,Y(Te.head),Te.max_lazy_match=i[Te.level].max_lazy,Te.good_match=i[Te.level].good_length,Te.nice_match=i[Te.level].nice_length,Te.max_chain_length=i[Te.level].max_chain,Te.strstart=0,Te.block_start=0,Te.lookahead=0,Te.insert=0,Te.match_length=Te.prev_length=M-1,Te.match_available=0,Te.ins_h=0}(H.state),me}function Re(H,me,Te,ce,oe,ne){if(!H)return v;var Se=1;if(me===b&&(me=6),ce<0?(Se=0,ce=-ce):15<ce&&(Se=2,ce-=16),oe<1||E<oe||Te!==_||ce<8||15<ce||me<0||9<me||ne<0||w<ne)return W(H,v);ce===8&&(ce=9);var Fe=new He;return(H.state=Fe).strm=H,Fe.wrap=Se,Fe.gzhead=null,Fe.w_bits=ce,Fe.w_size=1<<Fe.w_bits,Fe.w_mask=Fe.w_size-1,Fe.hash_bits=oe+7,Fe.hash_size=1<<Fe.hash_bits,Fe.hash_mask=Fe.hash_size-1,Fe.hash_shift=~~((Fe.hash_bits+M-1)/M),Fe.window=new a.Buf8(2*Fe.w_size),Fe.head=new a.Buf16(Fe.hash_size),Fe.prev=new a.Buf16(Fe.w_size),Fe.lit_bufsize=1<<oe+6,Fe.pending_buf_size=4*Fe.lit_bufsize,Fe.pending_buf=new a.Buf8(Fe.pending_buf_size),Fe.d_buf=1*Fe.lit_bufsize,Fe.l_buf=3*Fe.lit_bufsize,Fe.level=me,Fe.strategy=ne,Fe.method=Te,Ge(H)}i=[new Ce(0,0,0,0,function(H,me){var Te=65535;for(Te>H.pending_buf_size-5&&(Te=H.pending_buf_size-5);;){if(H.lookahead<=1){if(Me(H),H.lookahead===0&&me===f)return z;if(H.lookahead===0)break}H.strstart+=H.lookahead,H.lookahead=0;var ce=H.block_start+Te;if((H.strstart===0||H.strstart>=ce)&&(H.lookahead=H.strstart-ce,H.strstart=ce,Q(H,!1),H.strm.avail_out===0)||H.strstart-H.block_start>=H.w_size-q&&(Q(H,!1),H.strm.avail_out===0))return z}return H.insert=0,me===m?(Q(H,!0),H.strm.avail_out===0?K:ee):(H.strstart>H.block_start&&(Q(H,!1),H.strm.avail_out),z)}),new Ce(4,4,8,4,Pe),new Ce(4,5,16,8,Pe),new Ce(4,6,32,32,Pe),new Ce(4,4,16,16,Ie),new Ce(8,16,32,32,Ie),new Ce(8,16,128,128,Ie),new Ce(8,32,128,256,Ie),new Ce(32,128,258,1024,Ie),new Ce(32,258,258,4096,Ie)],s.deflateInit=function(H,me){return Re(H,me,_,15,8,0)},s.deflateInit2=Re,s.deflateReset=Ge,s.deflateResetKeep=it,s.deflateSetHeader=function(H,me){return H&&H.state?H.state.wrap!==2?v:(H.state.gzhead=me,g):v},s.deflate=function(H,me){var Te,ce,oe,ne;if(!H||!H.state||5<me||me<0)return H?W(H,v):v;if(ce=H.state,!H.output||!H.input&&H.avail_in!==0||ce.status===666&&me!==m)return W(H,H.avail_out===0?-5:v);if(ce.strm=H,Te=ce.last_flush,ce.last_flush=me,ce.status===P)if(ce.wrap===2)H.adler=0,ae(ce,31),ae(ce,139),ae(ce,8),ce.gzhead?(ae(ce,(ce.gzhead.text?1:0)+(ce.gzhead.hcrc?2:0)+(ce.gzhead.extra?4:0)+(ce.gzhead.name?8:0)+(ce.gzhead.comment?16:0)),ae(ce,255&ce.gzhead.time),ae(ce,ce.gzhead.time>>8&255),ae(ce,ce.gzhead.time>>16&255),ae(ce,ce.gzhead.time>>24&255),ae(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),ae(ce,255&ce.gzhead.os),ce.gzhead.extra&&ce.gzhead.extra.length&&(ae(ce,255&ce.gzhead.extra.length),ae(ce,ce.gzhead.extra.length>>8&255)),ce.gzhead.hcrc&&(H.adler=c(H.adler,ce.pending_buf,ce.pending,0)),ce.gzindex=0,ce.status=69):(ae(ce,0),ae(ce,0),ae(ce,0),ae(ce,0),ae(ce,0),ae(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),ae(ce,3),ce.status=V);else{var Se=_+(ce.w_bits-8<<4)<<8;Se|=(2<=ce.strategy||ce.level<2?0:ce.level<6?1:ce.level===6?2:3)<<6,ce.strstart!==0&&(Se|=32),Se+=31-Se%31,ce.status=V,xe(ce,Se),ce.strstart!==0&&(xe(ce,H.adler>>>16),xe(ce,65535&H.adler)),H.adler=1}if(ce.status===69)if(ce.gzhead.extra){for(oe=ce.pending;ce.gzindex<(65535&ce.gzhead.extra.length)&&(ce.pending!==ce.pending_buf_size||(ce.gzhead.hcrc&&ce.pending>oe&&(H.adler=c(H.adler,ce.pending_buf,ce.pending-oe,oe)),te(H),oe=ce.pending,ce.pending!==ce.pending_buf_size));)ae(ce,255&ce.gzhead.extra[ce.gzindex]),ce.gzindex++;ce.gzhead.hcrc&&ce.pending>oe&&(H.adler=c(H.adler,ce.pending_buf,ce.pending-oe,oe)),ce.gzindex===ce.gzhead.extra.length&&(ce.gzindex=0,ce.status=73)}else ce.status=73;if(ce.status===73)if(ce.gzhead.name){oe=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>oe&&(H.adler=c(H.adler,ce.pending_buf,ce.pending-oe,oe)),te(H),oe=ce.pending,ce.pending===ce.pending_buf_size)){ne=1;break}ne=ce.gzindex<ce.gzhead.name.length?255&ce.gzhead.name.charCodeAt(ce.gzindex++):0,ae(ce,ne)}while(ne!==0);ce.gzhead.hcrc&&ce.pending>oe&&(H.adler=c(H.adler,ce.pending_buf,ce.pending-oe,oe)),ne===0&&(ce.gzindex=0,ce.status=91)}else ce.status=91;if(ce.status===91)if(ce.gzhead.comment){oe=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>oe&&(H.adler=c(H.adler,ce.pending_buf,ce.pending-oe,oe)),te(H),oe=ce.pending,ce.pending===ce.pending_buf_size)){ne=1;break}ne=ce.gzindex<ce.gzhead.comment.length?255&ce.gzhead.comment.charCodeAt(ce.gzindex++):0,ae(ce,ne)}while(ne!==0);ce.gzhead.hcrc&&ce.pending>oe&&(H.adler=c(H.adler,ce.pending_buf,ce.pending-oe,oe)),ne===0&&(ce.status=103)}else ce.status=103;if(ce.status===103&&(ce.gzhead.hcrc?(ce.pending+2>ce.pending_buf_size&&te(H),ce.pending+2<=ce.pending_buf_size&&(ae(ce,255&H.adler),ae(ce,H.adler>>8&255),H.adler=0,ce.status=V)):ce.status=V),ce.pending!==0){if(te(H),H.avail_out===0)return ce.last_flush=-1,g}else if(H.avail_in===0&&se(me)<=se(Te)&&me!==m)return W(H,-5);if(ce.status===666&&H.avail_in!==0)return W(H,-5);if(H.avail_in!==0||ce.lookahead!==0||me!==f&&ce.status!==666){var Fe=ce.strategy===2?function(ke,Xe){for(var St;;){if(ke.lookahead===0&&(Me(ke),ke.lookahead===0)){if(Xe===f)return z;break}if(ke.match_length=0,St=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++,St&&(Q(ke,!1),ke.strm.avail_out===0))return z}return ke.insert=0,Xe===m?(Q(ke,!0),ke.strm.avail_out===0?K:ee):ke.last_lit&&(Q(ke,!1),ke.strm.avail_out===0)?z:re}(ce,me):ce.strategy===3?function(ke,Xe){for(var St,ht,It,Vt,Ot=ke.window;;){if(ke.lookahead<=L){if(Me(ke),ke.lookahead<=L&&Xe===f)return z;if(ke.lookahead===0)break}if(ke.match_length=0,ke.lookahead>=M&&0<ke.strstart&&(ht=Ot[It=ke.strstart-1])===Ot[++It]&&ht===Ot[++It]&&ht===Ot[++It]){Vt=ke.strstart+L;do;while(ht===Ot[++It]&&ht===Ot[++It]&&ht===Ot[++It]&&ht===Ot[++It]&&ht===Ot[++It]&&ht===Ot[++It]&&ht===Ot[++It]&&ht===Ot[++It]&&It<Vt);ke.match_length=L-(Vt-It),ke.match_length>ke.lookahead&&(ke.match_length=ke.lookahead)}if(ke.match_length>=M?(St=o._tr_tally(ke,1,ke.match_length-M),ke.lookahead-=ke.match_length,ke.strstart+=ke.match_length,ke.match_length=0):(St=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++),St&&(Q(ke,!1),ke.strm.avail_out===0))return z}return ke.insert=0,Xe===m?(Q(ke,!0),ke.strm.avail_out===0?K:ee):ke.last_lit&&(Q(ke,!1),ke.strm.avail_out===0)?z:re}(ce,me):i[ce.level].func(ce,me);if(Fe!==K&&Fe!==ee||(ce.status=666),Fe===z||Fe===K)return H.avail_out===0&&(ce.last_flush=-1),g;if(Fe===re&&(me===1?o._tr_align(ce):me!==5&&(o._tr_stored_block(ce,0,0,!1),me===3&&(Y(ce.head),ce.lookahead===0&&(ce.strstart=0,ce.block_start=0,ce.insert=0))),te(H),H.avail_out===0))return ce.last_flush=-1,g}return me!==m?g:ce.wrap<=0?1:(ce.wrap===2?(ae(ce,255&H.adler),ae(ce,H.adler>>8&255),ae(ce,H.adler>>16&255),ae(ce,H.adler>>24&255),ae(ce,255&H.total_in),ae(ce,H.total_in>>8&255),ae(ce,H.total_in>>16&255),ae(ce,H.total_in>>24&255)):(xe(ce,H.adler>>>16),xe(ce,65535&H.adler)),te(H),0<ce.wrap&&(ce.wrap=-ce.wrap),ce.pending!==0?g:1)},s.deflateEnd=function(H){var me;return H&&H.state?(me=H.state.status)!==P&&me!==69&&me!==73&&me!==91&&me!==103&&me!==V&&me!==666?W(H,v):(H.state=null,me===V?W(H,-3):g):v},s.deflateSetDictionary=function(H,me){var Te,ce,oe,ne,Se,Fe,ke,Xe,St=me.length;if(!H||!H.state||(ne=(Te=H.state).wrap)===2||ne===1&&Te.status!==P||Te.lookahead)return v;for(ne===1&&(H.adler=l(H.adler,me,St,0)),Te.wrap=0,St>=Te.w_size&&(ne===0&&(Y(Te.head),Te.strstart=0,Te.block_start=0,Te.insert=0),Xe=new a.Buf8(Te.w_size),a.arraySet(Xe,me,St-Te.w_size,Te.w_size,0),me=Xe,St=Te.w_size),Se=H.avail_in,Fe=H.next_in,ke=H.input,H.avail_in=St,H.next_in=0,H.input=me,Me(Te);Te.lookahead>=M;){for(ce=Te.strstart,oe=Te.lookahead-(M-1);Te.ins_h=(Te.ins_h<<Te.hash_shift^Te.window[ce+M-1])&Te.hash_mask,Te.prev[ce&Te.w_mask]=Te.head[Te.ins_h],Te.head[Te.ins_h]=ce,ce++,--oe;);Te.strstart=ce,Te.lookahead=M-1,Me(Te)}return Te.strstart+=Te.lookahead,Te.block_start=Te.strstart,Te.insert=Te.lookahead,Te.lookahead=0,Te.match_length=Te.prev_length=M-1,Te.match_available=0,H.next_in=Fe,H.input=ke,H.avail_in=Se,Te.wrap=ne,g},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,a){var o,l,c,u,f,m,g,v,b,w,x,_,E,C,k,R,I,j,M,L,q,P,V,z,re;o=i.state,l=i.next_in,z=i.input,c=l+(i.avail_in-5),u=i.next_out,re=i.output,f=u-(a-i.avail_out),m=u+(i.avail_out-257),g=o.dmax,v=o.wsize,b=o.whave,w=o.wnext,x=o.window,_=o.hold,E=o.bits,C=o.lencode,k=o.distcode,R=(1<<o.lenbits)-1,I=(1<<o.distbits)-1;e:do{E<15&&(_+=z[l++]<<E,E+=8,_+=z[l++]<<E,E+=8),j=C[_&R];t:for(;;){if(_>>>=M=j>>>24,E-=M,(M=j>>>16&255)===0)re[u++]=65535&j;else{if(!(16&M)){if((64&M)==0){j=C[(65535&j)+(_&(1<<M)-1)];continue t}if(32&M){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}L=65535&j,(M&=15)&&(E<M&&(_+=z[l++]<<E,E+=8),L+=_&(1<<M)-1,_>>>=M,E-=M),E<15&&(_+=z[l++]<<E,E+=8,_+=z[l++]<<E,E+=8),j=k[_&I];n:for(;;){if(_>>>=M=j>>>24,E-=M,!(16&(M=j>>>16&255))){if((64&M)==0){j=k[(65535&j)+(_&(1<<M)-1)];continue n}i.msg="invalid distance code",o.mode=30;break e}if(q=65535&j,E<(M&=15)&&(_+=z[l++]<<E,(E+=8)<M&&(_+=z[l++]<<E,E+=8)),g<(q+=_&(1<<M)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(_>>>=M,E-=M,(M=u-f)<q){if(b<(M=q-M)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(V=x,(P=0)===w){if(P+=v-M,M<L){for(L-=M;re[u++]=x[P++],--M;);P=u-q,V=re}}else if(w<M){if(P+=v+w-M,(M-=w)<L){for(L-=M;re[u++]=x[P++],--M;);if(P=0,w<L){for(L-=M=w;re[u++]=x[P++],--M;);P=u-q,V=re}}}else if(P+=w-M,M<L){for(L-=M;re[u++]=x[P++],--M;);P=u-q,V=re}for(;2<L;)re[u++]=V[P++],re[u++]=V[P++],re[u++]=V[P++],L-=3;L&&(re[u++]=V[P++],1<L&&(re[u++]=V[P++]))}else{for(P=u-q;re[u++]=re[P++],re[u++]=re[P++],re[u++]=re[P++],2<(L-=3););L&&(re[u++]=re[P++],1<L&&(re[u++]=re[P++]))}break}}break}}while(l<c&&u<m);l-=L=E>>3,_&=(1<<(E-=L<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<m?m-u+257:257-(u-m),o.hold=_,o.bits=E}},{}],49:[function(n,r,s){var i=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,f=2,m=0,g=-2,v=1,b=852,w=592;function x(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(P){var V;return P&&P.state?(V=P.state,P.total_in=P.total_out=V.total=0,P.msg="",V.wrap&&(P.adler=1&V.wrap),V.mode=v,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new i.Buf32(b),V.distcode=V.distdyn=new i.Buf32(w),V.sane=1,V.back=-1,m):g}function C(P){var V;return P&&P.state?((V=P.state).wsize=0,V.whave=0,V.wnext=0,E(P)):g}function k(P,V){var z,re;return P&&P.state?(re=P.state,V<0?(z=0,V=-V):(z=1+(V>>4),V<48&&(V&=15)),V&&(V<8||15<V)?g:(re.window!==null&&re.wbits!==V&&(re.window=null),re.wrap=z,re.wbits=V,C(P))):g}function R(P,V){var z,re;return P?(re=new _,(P.state=re).window=null,(z=k(P,V))!==m&&(P.state=null),z):g}var I,j,M=!0;function L(P){if(M){var V;for(I=new i.Buf32(512),j=new i.Buf32(32),V=0;V<144;)P.lens[V++]=8;for(;V<256;)P.lens[V++]=9;for(;V<280;)P.lens[V++]=7;for(;V<288;)P.lens[V++]=8;for(c(u,P.lens,0,288,I,0,P.work,{bits:9}),V=0;V<32;)P.lens[V++]=5;c(f,P.lens,0,32,j,0,P.work,{bits:5}),M=!1}P.lencode=I,P.lenbits=9,P.distcode=j,P.distbits=5}function q(P,V,z,re){var K,ee=P.state;return ee.window===null&&(ee.wsize=1<<ee.wbits,ee.wnext=0,ee.whave=0,ee.window=new i.Buf8(ee.wsize)),re>=ee.wsize?(i.arraySet(ee.window,V,z-ee.wsize,ee.wsize,0),ee.wnext=0,ee.whave=ee.wsize):(re<(K=ee.wsize-ee.wnext)&&(K=re),i.arraySet(ee.window,V,z-re,K,ee.wnext),(re-=K)?(i.arraySet(ee.window,V,z-re,re,0),ee.wnext=re,ee.whave=ee.wsize):(ee.wnext+=K,ee.wnext===ee.wsize&&(ee.wnext=0),ee.whave<ee.wsize&&(ee.whave+=K))),0}s.inflateReset=C,s.inflateReset2=k,s.inflateResetKeep=E,s.inflateInit=function(P){return R(P,15)},s.inflateInit2=R,s.inflate=function(P,V){var z,re,K,ee,W,se,Y,te,Q,ae,xe,ge,Me,Pe,Ie,Ce,He,it,Ge,Re,H,me,Te,ce,oe=0,ne=new i.Buf8(4),Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return g;(z=P.state).mode===12&&(z.mode=13),W=P.next_out,K=P.output,Y=P.avail_out,ee=P.next_in,re=P.input,se=P.avail_in,te=z.hold,Q=z.bits,ae=se,xe=Y,me=m;e:for(;;)switch(z.mode){case v:if(z.wrap===0){z.mode=13;break}for(;Q<16;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if(2&z.wrap&&te===35615){ne[z.check=0]=255&te,ne[1]=te>>>8&255,z.check=o(z.check,ne,2,0),Q=te=0,z.mode=2;break}if(z.flags=0,z.head&&(z.head.done=!1),!(1&z.wrap)||(((255&te)<<8)+(te>>8))%31){P.msg="incorrect header check",z.mode=30;break}if((15&te)!=8){P.msg="unknown compression method",z.mode=30;break}if(Q-=4,H=8+(15&(te>>>=4)),z.wbits===0)z.wbits=H;else if(H>z.wbits){P.msg="invalid window size",z.mode=30;break}z.dmax=1<<H,P.adler=z.check=1,z.mode=512&te?10:12,Q=te=0;break;case 2:for(;Q<16;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if(z.flags=te,(255&z.flags)!=8){P.msg="unknown compression method",z.mode=30;break}if(57344&z.flags){P.msg="unknown header flags set",z.mode=30;break}z.head&&(z.head.text=te>>8&1),512&z.flags&&(ne[0]=255&te,ne[1]=te>>>8&255,z.check=o(z.check,ne,2,0)),Q=te=0,z.mode=3;case 3:for(;Q<32;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}z.head&&(z.head.time=te),512&z.flags&&(ne[0]=255&te,ne[1]=te>>>8&255,ne[2]=te>>>16&255,ne[3]=te>>>24&255,z.check=o(z.check,ne,4,0)),Q=te=0,z.mode=4;case 4:for(;Q<16;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}z.head&&(z.head.xflags=255&te,z.head.os=te>>8),512&z.flags&&(ne[0]=255&te,ne[1]=te>>>8&255,z.check=o(z.check,ne,2,0)),Q=te=0,z.mode=5;case 5:if(1024&z.flags){for(;Q<16;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}z.length=te,z.head&&(z.head.extra_len=te),512&z.flags&&(ne[0]=255&te,ne[1]=te>>>8&255,z.check=o(z.check,ne,2,0)),Q=te=0}else z.head&&(z.head.extra=null);z.mode=6;case 6:if(1024&z.flags&&(se<(ge=z.length)&&(ge=se),ge&&(z.head&&(H=z.head.extra_len-z.length,z.head.extra||(z.head.extra=new Array(z.head.extra_len)),i.arraySet(z.head.extra,re,ee,ge,H)),512&z.flags&&(z.check=o(z.check,re,ge,ee)),se-=ge,ee+=ge,z.length-=ge),z.length))break e;z.length=0,z.mode=7;case 7:if(2048&z.flags){if(se===0)break e;for(ge=0;H=re[ee+ge++],z.head&&H&&z.length<65536&&(z.head.name+=String.fromCharCode(H)),H&&ge<se;);if(512&z.flags&&(z.check=o(z.check,re,ge,ee)),se-=ge,ee+=ge,H)break e}else z.head&&(z.head.name=null);z.length=0,z.mode=8;case 8:if(4096&z.flags){if(se===0)break e;for(ge=0;H=re[ee+ge++],z.head&&H&&z.length<65536&&(z.head.comment+=String.fromCharCode(H)),H&&ge<se;);if(512&z.flags&&(z.check=o(z.check,re,ge,ee)),se-=ge,ee+=ge,H)break e}else z.head&&(z.head.comment=null);z.mode=9;case 9:if(512&z.flags){for(;Q<16;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if(te!==(65535&z.check)){P.msg="header crc mismatch",z.mode=30;break}Q=te=0}z.head&&(z.head.hcrc=z.flags>>9&1,z.head.done=!0),P.adler=z.check=0,z.mode=12;break;case 10:for(;Q<32;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}P.adler=z.check=x(te),Q=te=0,z.mode=11;case 11:if(z.havedict===0)return P.next_out=W,P.avail_out=Y,P.next_in=ee,P.avail_in=se,z.hold=te,z.bits=Q,2;P.adler=z.check=1,z.mode=12;case 12:if(V===5||V===6)break e;case 13:if(z.last){te>>>=7&Q,Q-=7&Q,z.mode=27;break}for(;Q<3;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}switch(z.last=1&te,Q-=1,3&(te>>>=1)){case 0:z.mode=14;break;case 1:if(L(z),z.mode=20,V!==6)break;te>>>=2,Q-=2;break e;case 2:z.mode=17;break;case 3:P.msg="invalid block type",z.mode=30}te>>>=2,Q-=2;break;case 14:for(te>>>=7&Q,Q-=7&Q;Q<32;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if((65535&te)!=(te>>>16^65535)){P.msg="invalid stored block lengths",z.mode=30;break}if(z.length=65535&te,Q=te=0,z.mode=15,V===6)break e;case 15:z.mode=16;case 16:if(ge=z.length){if(se<ge&&(ge=se),Y<ge&&(ge=Y),ge===0)break e;i.arraySet(K,re,ee,ge,W),se-=ge,ee+=ge,Y-=ge,W+=ge,z.length-=ge;break}z.mode=12;break;case 17:for(;Q<14;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if(z.nlen=257+(31&te),te>>>=5,Q-=5,z.ndist=1+(31&te),te>>>=5,Q-=5,z.ncode=4+(15&te),te>>>=4,Q-=4,286<z.nlen||30<z.ndist){P.msg="too many length or distance symbols",z.mode=30;break}z.have=0,z.mode=18;case 18:for(;z.have<z.ncode;){for(;Q<3;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}z.lens[Se[z.have++]]=7&te,te>>>=3,Q-=3}for(;z.have<19;)z.lens[Se[z.have++]]=0;if(z.lencode=z.lendyn,z.lenbits=7,Te={bits:z.lenbits},me=c(0,z.lens,0,19,z.lencode,0,z.work,Te),z.lenbits=Te.bits,me){P.msg="invalid code lengths set",z.mode=30;break}z.have=0,z.mode=19;case 19:for(;z.have<z.nlen+z.ndist;){for(;Ce=(oe=z.lencode[te&(1<<z.lenbits)-1])>>>16&255,He=65535&oe,!((Ie=oe>>>24)<=Q);){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if(He<16)te>>>=Ie,Q-=Ie,z.lens[z.have++]=He;else{if(He===16){for(ce=Ie+2;Q<ce;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if(te>>>=Ie,Q-=Ie,z.have===0){P.msg="invalid bit length repeat",z.mode=30;break}H=z.lens[z.have-1],ge=3+(3&te),te>>>=2,Q-=2}else if(He===17){for(ce=Ie+3;Q<ce;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}Q-=Ie,H=0,ge=3+(7&(te>>>=Ie)),te>>>=3,Q-=3}else{for(ce=Ie+7;Q<ce;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}Q-=Ie,H=0,ge=11+(127&(te>>>=Ie)),te>>>=7,Q-=7}if(z.have+ge>z.nlen+z.ndist){P.msg="invalid bit length repeat",z.mode=30;break}for(;ge--;)z.lens[z.have++]=H}}if(z.mode===30)break;if(z.lens[256]===0){P.msg="invalid code -- missing end-of-block",z.mode=30;break}if(z.lenbits=9,Te={bits:z.lenbits},me=c(u,z.lens,0,z.nlen,z.lencode,0,z.work,Te),z.lenbits=Te.bits,me){P.msg="invalid literal/lengths set",z.mode=30;break}if(z.distbits=6,z.distcode=z.distdyn,Te={bits:z.distbits},me=c(f,z.lens,z.nlen,z.ndist,z.distcode,0,z.work,Te),z.distbits=Te.bits,me){P.msg="invalid distances set",z.mode=30;break}if(z.mode=20,V===6)break e;case 20:z.mode=21;case 21:if(6<=se&&258<=Y){P.next_out=W,P.avail_out=Y,P.next_in=ee,P.avail_in=se,z.hold=te,z.bits=Q,l(P,xe),W=P.next_out,K=P.output,Y=P.avail_out,ee=P.next_in,re=P.input,se=P.avail_in,te=z.hold,Q=z.bits,z.mode===12&&(z.back=-1);break}for(z.back=0;Ce=(oe=z.lencode[te&(1<<z.lenbits)-1])>>>16&255,He=65535&oe,!((Ie=oe>>>24)<=Q);){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if(Ce&&(240&Ce)==0){for(it=Ie,Ge=Ce,Re=He;Ce=(oe=z.lencode[Re+((te&(1<<it+Ge)-1)>>it)])>>>16&255,He=65535&oe,!(it+(Ie=oe>>>24)<=Q);){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}te>>>=it,Q-=it,z.back+=it}if(te>>>=Ie,Q-=Ie,z.back+=Ie,z.length=He,Ce===0){z.mode=26;break}if(32&Ce){z.back=-1,z.mode=12;break}if(64&Ce){P.msg="invalid literal/length code",z.mode=30;break}z.extra=15&Ce,z.mode=22;case 22:if(z.extra){for(ce=z.extra;Q<ce;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}z.length+=te&(1<<z.extra)-1,te>>>=z.extra,Q-=z.extra,z.back+=z.extra}z.was=z.length,z.mode=23;case 23:for(;Ce=(oe=z.distcode[te&(1<<z.distbits)-1])>>>16&255,He=65535&oe,!((Ie=oe>>>24)<=Q);){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if((240&Ce)==0){for(it=Ie,Ge=Ce,Re=He;Ce=(oe=z.distcode[Re+((te&(1<<it+Ge)-1)>>it)])>>>16&255,He=65535&oe,!(it+(Ie=oe>>>24)<=Q);){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}te>>>=it,Q-=it,z.back+=it}if(te>>>=Ie,Q-=Ie,z.back+=Ie,64&Ce){P.msg="invalid distance code",z.mode=30;break}z.offset=He,z.extra=15&Ce,z.mode=24;case 24:if(z.extra){for(ce=z.extra;Q<ce;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}z.offset+=te&(1<<z.extra)-1,te>>>=z.extra,Q-=z.extra,z.back+=z.extra}if(z.offset>z.dmax){P.msg="invalid distance too far back",z.mode=30;break}z.mode=25;case 25:if(Y===0)break e;if(ge=xe-Y,z.offset>ge){if((ge=z.offset-ge)>z.whave&&z.sane){P.msg="invalid distance too far back",z.mode=30;break}Me=ge>z.wnext?(ge-=z.wnext,z.wsize-ge):z.wnext-ge,ge>z.length&&(ge=z.length),Pe=z.window}else Pe=K,Me=W-z.offset,ge=z.length;for(Y<ge&&(ge=Y),Y-=ge,z.length-=ge;K[W++]=Pe[Me++],--ge;);z.length===0&&(z.mode=21);break;case 26:if(Y===0)break e;K[W++]=z.length,Y--,z.mode=21;break;case 27:if(z.wrap){for(;Q<32;){if(se===0)break e;se--,te|=re[ee++]<<Q,Q+=8}if(xe-=Y,P.total_out+=xe,z.total+=xe,xe&&(P.adler=z.check=z.flags?o(z.check,K,xe,W-xe):a(z.check,K,xe,W-xe)),xe=Y,(z.flags?te:x(te))!==z.check){P.msg="incorrect data check",z.mode=30;break}Q=te=0}z.mode=28;case 28:if(z.wrap&&z.flags){for(;Q<32;){if(se===0)break e;se--,te+=re[ee++]<<Q,Q+=8}if(te!==(4294967295&z.total)){P.msg="incorrect length check",z.mode=30;break}Q=te=0}z.mode=29;case 29:me=1;break e;case 30:me=-3;break e;case 31:return-4;case 32:default:return g}return P.next_out=W,P.avail_out=Y,P.next_in=ee,P.avail_in=se,z.hold=te,z.bits=Q,(z.wsize||xe!==P.avail_out&&z.mode<30&&(z.mode<27||V!==4))&&q(P,P.output,P.next_out,xe-P.avail_out)?(z.mode=31,-4):(ae-=P.avail_in,xe-=P.avail_out,P.total_in+=ae,P.total_out+=xe,z.total+=xe,z.wrap&&xe&&(P.adler=z.check=z.flags?o(z.check,K,xe,P.next_out-xe):a(z.check,K,xe,P.next_out-xe)),P.data_type=z.bits+(z.last?64:0)+(z.mode===12?128:0)+(z.mode===20||z.mode===15?256:0),(ae==0&&xe===0||V===4)&&me===m&&(me=-5),me)},s.inflateEnd=function(P){if(!P||!P.state)return g;var V=P.state;return V.window&&(V.window=null),P.state=null,m},s.inflateGetHeader=function(P,V){var z;return P&&P.state?(2&(z=P.state).wrap)==0?g:((z.head=V).done=!1,m):g},s.inflateSetDictionary=function(P,V){var z,re=V.length;return P&&P.state?(z=P.state).wrap!==0&&z.mode!==11?g:z.mode===11&&a(1,V,re,0)!==z.check?-3:q(P,V,re,re)?(z.mode=31,-4):(z.havedict=1,m):g},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,f,m,g,v,b,w,x){var _,E,C,k,R,I,j,M,L,q=x.bits,P=0,V=0,z=0,re=0,K=0,ee=0,W=0,se=0,Y=0,te=0,Q=null,ae=0,xe=new i.Buf16(16),ge=new i.Buf16(16),Me=null,Pe=0;for(P=0;P<=15;P++)xe[P]=0;for(V=0;V<g;V++)xe[f[m+V]]++;for(K=q,re=15;1<=re&&xe[re]===0;re--);if(re<K&&(K=re),re===0)return v[b++]=20971520,v[b++]=20971520,x.bits=1,0;for(z=1;z<re&&xe[z]===0;z++);for(K<z&&(K=z),P=se=1;P<=15;P++)if(se<<=1,(se-=xe[P])<0)return-1;if(0<se&&(u===0||re!==1))return-1;for(ge[1]=0,P=1;P<15;P++)ge[P+1]=ge[P]+xe[P];for(V=0;V<g;V++)f[m+V]!==0&&(w[ge[f[m+V]]++]=V);if(I=u===0?(Q=Me=w,19):u===1?(Q=a,ae-=257,Me=o,Pe-=257,256):(Q=l,Me=c,-1),P=z,R=b,W=V=te=0,C=-1,k=(Y=1<<(ee=K))-1,u===1&&852<Y||u===2&&592<Y)return 1;for(;;){for(j=P-W,L=w[V]<I?(M=0,w[V]):w[V]>I?(M=Me[Pe+w[V]],Q[ae+w[V]]):(M=96,0),_=1<<P-W,z=E=1<<ee;v[R+(te>>W)+(E-=_)]=j<<24|M<<16|L|0,E!==0;);for(_=1<<P-1;te&_;)_>>=1;if(_!==0?(te&=_-1,te+=_):te=0,V++,--xe[P]==0){if(P===re)break;P=f[m+w[V]]}if(K<P&&(te&k)!==C){for(W===0&&(W=K),R+=z,se=1<<(ee=P-W);ee+W<re&&!((se-=xe[ee+W])<=0);)ee++,se<<=1;if(Y+=1<<ee,u===1&&852<Y||u===2&&592<Y)return 1;v[C=te&k]=K<<24|ee<<16|R-b|0}}return te!==0&&(v[R+te]=P-W<<24|64<<16|0),x.bits=K,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),a=0,o=1;function l(oe){for(var ne=oe.length;0<=--ne;)oe[ne]=0}var c=0,u=29,f=256,m=f+1+u,g=30,v=19,b=2*m+1,w=15,x=16,_=7,E=256,C=16,k=17,R=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=new Array(2*(m+2));l(q);var P=new Array(2*g);l(P);var V=new Array(512);l(V);var z=new Array(256);l(z);var re=new Array(u);l(re);var K,ee,W,se=new Array(g);function Y(oe,ne,Se,Fe,ke){this.static_tree=oe,this.extra_bits=ne,this.extra_base=Se,this.elems=Fe,this.max_length=ke,this.has_stree=oe&&oe.length}function te(oe,ne){this.dyn_tree=oe,this.max_code=0,this.stat_desc=ne}function Q(oe){return oe<256?V[oe]:V[256+(oe>>>7)]}function ae(oe,ne){oe.pending_buf[oe.pending++]=255&ne,oe.pending_buf[oe.pending++]=ne>>>8&255}function xe(oe,ne,Se){oe.bi_valid>x-Se?(oe.bi_buf|=ne<<oe.bi_valid&65535,ae(oe,oe.bi_buf),oe.bi_buf=ne>>x-oe.bi_valid,oe.bi_valid+=Se-x):(oe.bi_buf|=ne<<oe.bi_valid&65535,oe.bi_valid+=Se)}function ge(oe,ne,Se){xe(oe,Se[2*ne],Se[2*ne+1])}function Me(oe,ne){for(var Se=0;Se|=1&oe,oe>>>=1,Se<<=1,0<--ne;);return Se>>>1}function Pe(oe,ne,Se){var Fe,ke,Xe=new Array(w+1),St=0;for(Fe=1;Fe<=w;Fe++)Xe[Fe]=St=St+Se[Fe-1]<<1;for(ke=0;ke<=ne;ke++){var ht=oe[2*ke+1];ht!==0&&(oe[2*ke]=Me(Xe[ht]++,ht))}}function Ie(oe){var ne;for(ne=0;ne<m;ne++)oe.dyn_ltree[2*ne]=0;for(ne=0;ne<g;ne++)oe.dyn_dtree[2*ne]=0;for(ne=0;ne<v;ne++)oe.bl_tree[2*ne]=0;oe.dyn_ltree[2*E]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function Ce(oe){8<oe.bi_valid?ae(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function He(oe,ne,Se,Fe){var ke=2*ne,Xe=2*Se;return oe[ke]<oe[Xe]||oe[ke]===oe[Xe]&&Fe[ne]<=Fe[Se]}function it(oe,ne,Se){for(var Fe=oe.heap[Se],ke=Se<<1;ke<=oe.heap_len&&(ke<oe.heap_len&&He(ne,oe.heap[ke+1],oe.heap[ke],oe.depth)&&ke++,!He(ne,Fe,oe.heap[ke],oe.depth));)oe.heap[Se]=oe.heap[ke],Se=ke,ke<<=1;oe.heap[Se]=Fe}function Ge(oe,ne,Se){var Fe,ke,Xe,St,ht=0;if(oe.last_lit!==0)for(;Fe=oe.pending_buf[oe.d_buf+2*ht]<<8|oe.pending_buf[oe.d_buf+2*ht+1],ke=oe.pending_buf[oe.l_buf+ht],ht++,Fe===0?ge(oe,ke,ne):(ge(oe,(Xe=z[ke])+f+1,ne),(St=I[Xe])!==0&&xe(oe,ke-=re[Xe],St),ge(oe,Xe=Q(--Fe),Se),(St=j[Xe])!==0&&xe(oe,Fe-=se[Xe],St)),ht<oe.last_lit;);ge(oe,E,ne)}function Re(oe,ne){var Se,Fe,ke,Xe=ne.dyn_tree,St=ne.stat_desc.static_tree,ht=ne.stat_desc.has_stree,It=ne.stat_desc.elems,Vt=-1;for(oe.heap_len=0,oe.heap_max=b,Se=0;Se<It;Se++)Xe[2*Se]!==0?(oe.heap[++oe.heap_len]=Vt=Se,oe.depth[Se]=0):Xe[2*Se+1]=0;for(;oe.heap_len<2;)Xe[2*(ke=oe.heap[++oe.heap_len]=Vt<2?++Vt:0)]=1,oe.depth[ke]=0,oe.opt_len--,ht&&(oe.static_len-=St[2*ke+1]);for(ne.max_code=Vt,Se=oe.heap_len>>1;1<=Se;Se--)it(oe,Xe,Se);for(ke=It;Se=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],it(oe,Xe,1),Fe=oe.heap[1],oe.heap[--oe.heap_max]=Se,oe.heap[--oe.heap_max]=Fe,Xe[2*ke]=Xe[2*Se]+Xe[2*Fe],oe.depth[ke]=(oe.depth[Se]>=oe.depth[Fe]?oe.depth[Se]:oe.depth[Fe])+1,Xe[2*Se+1]=Xe[2*Fe+1]=ke,oe.heap[1]=ke++,it(oe,Xe,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(Ot,Gt){var be,O,Z,fe,Oe,ve,Ae=Gt.dyn_tree,ue=Gt.max_code,mt=Gt.stat_desc.static_tree,wt=Gt.stat_desc.has_stree,B=Gt.stat_desc.extra_bits,ze=Gt.stat_desc.extra_base,rt=Gt.stat_desc.max_length,ye=0;for(fe=0;fe<=w;fe++)Ot.bl_count[fe]=0;for(Ae[2*Ot.heap[Ot.heap_max]+1]=0,be=Ot.heap_max+1;be<b;be++)rt<(fe=Ae[2*Ae[2*(O=Ot.heap[be])+1]+1]+1)&&(fe=rt,ye++),Ae[2*O+1]=fe,ue<O||(Ot.bl_count[fe]++,Oe=0,ze<=O&&(Oe=B[O-ze]),ve=Ae[2*O],Ot.opt_len+=ve*(fe+Oe),wt&&(Ot.static_len+=ve*(mt[2*O+1]+Oe)));if(ye!==0){do{for(fe=rt-1;Ot.bl_count[fe]===0;)fe--;Ot.bl_count[fe]--,Ot.bl_count[fe+1]+=2,Ot.bl_count[rt]--,ye-=2}while(0<ye);for(fe=rt;fe!==0;fe--)for(O=Ot.bl_count[fe];O!==0;)ue<(Z=Ot.heap[--be])||(Ae[2*Z+1]!==fe&&(Ot.opt_len+=(fe-Ae[2*Z+1])*Ae[2*Z],Ae[2*Z+1]=fe),O--)}}(oe,ne),Pe(Xe,Vt,oe.bl_count)}function H(oe,ne,Se){var Fe,ke,Xe=-1,St=ne[1],ht=0,It=7,Vt=4;for(St===0&&(It=138,Vt=3),ne[2*(Se+1)+1]=65535,Fe=0;Fe<=Se;Fe++)ke=St,St=ne[2*(Fe+1)+1],++ht<It&&ke===St||(ht<Vt?oe.bl_tree[2*ke]+=ht:ke!==0?(ke!==Xe&&oe.bl_tree[2*ke]++,oe.bl_tree[2*C]++):ht<=10?oe.bl_tree[2*k]++:oe.bl_tree[2*R]++,Xe=ke,Vt=(ht=0)===St?(It=138,3):ke===St?(It=6,3):(It=7,4))}function me(oe,ne,Se){var Fe,ke,Xe=-1,St=ne[1],ht=0,It=7,Vt=4;for(St===0&&(It=138,Vt=3),Fe=0;Fe<=Se;Fe++)if(ke=St,St=ne[2*(Fe+1)+1],!(++ht<It&&ke===St)){if(ht<Vt)for(;ge(oe,ke,oe.bl_tree),--ht!=0;);else ke!==0?(ke!==Xe&&(ge(oe,ke,oe.bl_tree),ht--),ge(oe,C,oe.bl_tree),xe(oe,ht-3,2)):ht<=10?(ge(oe,k,oe.bl_tree),xe(oe,ht-3,3)):(ge(oe,R,oe.bl_tree),xe(oe,ht-11,7));Xe=ke,Vt=(ht=0)===St?(It=138,3):ke===St?(It=6,3):(It=7,4)}}l(se);var Te=!1;function ce(oe,ne,Se,Fe){xe(oe,(c<<1)+(Fe?1:0),3),function(ke,Xe,St,ht){Ce(ke),ae(ke,St),ae(ke,~St),i.arraySet(ke.pending_buf,ke.window,Xe,St,ke.pending),ke.pending+=St}(oe,ne,Se)}s._tr_init=function(oe){Te||(function(){var ne,Se,Fe,ke,Xe,St=new Array(w+1);for(ke=Fe=0;ke<u-1;ke++)for(re[ke]=Fe,ne=0;ne<1<<I[ke];ne++)z[Fe++]=ke;for(z[Fe-1]=ke,ke=Xe=0;ke<16;ke++)for(se[ke]=Xe,ne=0;ne<1<<j[ke];ne++)V[Xe++]=ke;for(Xe>>=7;ke<g;ke++)for(se[ke]=Xe<<7,ne=0;ne<1<<j[ke]-7;ne++)V[256+Xe++]=ke;for(Se=0;Se<=w;Se++)St[Se]=0;for(ne=0;ne<=143;)q[2*ne+1]=8,ne++,St[8]++;for(;ne<=255;)q[2*ne+1]=9,ne++,St[9]++;for(;ne<=279;)q[2*ne+1]=7,ne++,St[7]++;for(;ne<=287;)q[2*ne+1]=8,ne++,St[8]++;for(Pe(q,m+1,St),ne=0;ne<g;ne++)P[2*ne+1]=5,P[2*ne]=Me(ne,5);K=new Y(q,I,f+1,m,w),ee=new Y(P,j,0,g,w),W=new Y(new Array(0),M,0,v,_)}(),Te=!0),oe.l_desc=new te(oe.dyn_ltree,K),oe.d_desc=new te(oe.dyn_dtree,ee),oe.bl_desc=new te(oe.bl_tree,W),oe.bi_buf=0,oe.bi_valid=0,Ie(oe)},s._tr_stored_block=ce,s._tr_flush_block=function(oe,ne,Se,Fe){var ke,Xe,St=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(ht){var It,Vt=4093624447;for(It=0;It<=31;It++,Vt>>>=1)if(1&Vt&&ht.dyn_ltree[2*It]!==0)return a;if(ht.dyn_ltree[18]!==0||ht.dyn_ltree[20]!==0||ht.dyn_ltree[26]!==0)return o;for(It=32;It<f;It++)if(ht.dyn_ltree[2*It]!==0)return o;return a}(oe)),Re(oe,oe.l_desc),Re(oe,oe.d_desc),St=function(ht){var It;for(H(ht,ht.dyn_ltree,ht.l_desc.max_code),H(ht,ht.dyn_dtree,ht.d_desc.max_code),Re(ht,ht.bl_desc),It=v-1;3<=It&&ht.bl_tree[2*L[It]+1]===0;It--);return ht.opt_len+=3*(It+1)+5+5+4,It}(oe),ke=oe.opt_len+3+7>>>3,(Xe=oe.static_len+3+7>>>3)<=ke&&(ke=Xe)):ke=Xe=Se+5,Se+4<=ke&&ne!==-1?ce(oe,ne,Se,Fe):oe.strategy===4||Xe===ke?(xe(oe,2+(Fe?1:0),3),Ge(oe,q,P)):(xe(oe,4+(Fe?1:0),3),function(ht,It,Vt,Ot){var Gt;for(xe(ht,It-257,5),xe(ht,Vt-1,5),xe(ht,Ot-4,4),Gt=0;Gt<Ot;Gt++)xe(ht,ht.bl_tree[2*L[Gt]+1],3);me(ht,ht.dyn_ltree,It-1),me(ht,ht.dyn_dtree,Vt-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,St+1),Ge(oe,oe.dyn_ltree,oe.dyn_dtree)),Ie(oe),Fe&&Ce(oe)},s._tr_tally=function(oe,ne,Se){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=ne>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&ne,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Se,oe.last_lit++,ne===0?oe.dyn_ltree[2*Se]++:(oe.matches++,ne--,oe.dyn_ltree[2*(z[Se]+f+1)]++,oe.dyn_dtree[2*Q(ne)]++),oe.last_lit===oe.lit_bufsize-1},s._tr_align=function(oe){xe(oe,2,3),ge(oe,E,q),function(ne){ne.bi_valid===16?(ae(ne,ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0):8<=ne.bi_valid&&(ne.pending_buf[ne.pending++]=255&ne.bi_buf,ne.bi_buf>>=8,ne.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(a,o){if(!a.setImmediate){var l,c,u,f,m=1,g={},v=!1,b=a.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(a);w=w&&w.setTimeout?w:a,l={}.toString.call(a.process)==="[object process]"?function(C){vs.nextTick(function(){_(C)})}:function(){if(a.postMessage&&!a.importScripts){var C=!0,k=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=k,C}}()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",E,!1):a.attachEvent("onmessage",E),function(C){a.postMessage(f+C,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(C){_(C.data)},function(C){u.port2.postMessage(C)}):b&&"onreadystatechange"in b.createElement("script")?(c=b.documentElement,function(C){var k=b.createElement("script");k.onreadystatechange=function(){_(C),k.onreadystatechange=null,c.removeChild(k),k=null},c.appendChild(k)}):function(C){setTimeout(_,0,C)},w.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var k=new Array(arguments.length-1),R=0;R<k.length;R++)k[R]=arguments[R+1];var I={callback:C,args:k};return g[m]=I,l(m),m++},w.clearImmediate=x}function x(C){delete g[C]}function _(C){if(v)setTimeout(_,0,C);else{var k=g[C];if(k){v=!0;try{(function(R){var I=R.callback,j=R.args;switch(j.length){case 0:I();break;case 1:I(j[0]);break;case 2:I(j[0],j[1]);break;case 3:I(j[0],j[1],j[2]);break;default:I.apply(o,j)}})(k)}finally{x(C),v=!1}}}}function E(C){C.source===a&&typeof C.data=="string"&&C.data.indexOf(f)===0&&_(+C.data.slice(f.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof hf<"u"?hf:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(OC)),OC.exports}var hce=fce();const JB=Ni(hce),ry=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+s[i]},ar=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},Pl=(...e)=>ar(e.map(t=>t.trim()).filter(Boolean).join("/")),__=e=>{const t=ar(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},ws=e=>{const t=ar(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},rA=(e,t)=>ar(e==="/"?`/${t}`:`${e}/${t}`);var PC,TO;function pce(){if(TO)return PC;TO=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof vs>"u"||typeof vs.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,a=null,o=null;typeof r!="function"&&(s=r,r=null,o=new this.Promise(function(E,C){i=E,a=C})),s=s||{};var l=!1,c=null,u=null,f=null,m=this,g=function(E,C,k){u&&(clearTimeout(u),u=null),f&&(clearTimeout(f),f=null),E&&(m.queues[t]&&m.queues[t].length===0&&delete m.queues[t],m.domainReentrant&&delete m.domains[t]),l||(o?C?a(C):i(k):typeof r=="function"&&r(C,k),l=!0),E&&m.queues[t]&&m.queues[t].length>0&&m.queues[t].shift()()},v=function(E){if(l)return g(E);c&&(clearTimeout(c),c=null),m.domainReentrant&&E&&(m.domains[t]=vs.domain);var C=s.maxExecutionTime||m.maxExecutionTime;if(C&&(f=setTimeout(function(){m.queues[t]&&g(E,new Error("Maximum execution time is exceeded "+t))},C)),n.length===1){var k=!1;try{n(function(R,I){k||(k=!0,g(E,R,I))})}catch(R){k||(k=!0,g(E,R))}}else m._promiseTry(function(){return n()}).then(function(R){g(E,void 0,R)},function(R){g(E,R)})};m.domainReentrant&&vs.domain&&(v=vs.domain.bind(v));var b=s.maxPending||m.maxPending;if(!m.queues[t])m.queues[t]=[],v(!0);else if(m.domainReentrant&&vs.domain&&vs.domain===m.domains[t])v(!1);else if(m.queues[t].length>=b)g(!1,new Error("Too many pending tasks in queue "+t));else{var w=function(){v(!0)};s.skipQueue?m.queues[t].unshift(w):m.queues[t].push(w);var x=s.timeout||m.timeout;x&&(c=setTimeout(function(){c=null,g(!1,new Error("async-lock timed out in queue "+t))},x))}var _=s.maxOccupationTime||m.maxOccupationTime;if(_&&(u=setTimeout(function(){m.queues[t]&&g(!1,new Error("Maximum occupation time is exceeded in queue "+t))},_)),o)return o},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,a=function(l,c){return function(u){i.acquire(l,c,u,s)}},o=t.reduceRight(function(l,c){return a(c,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,c){o.length===1?o(function(u,f){u?c(u):l(f)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},PC=e,PC}var DC,AO;function mce(){return AO||(AO=1,DC=pce()),DC}var gce=mce();const sy=Ni(gce);var mw={exports:{}},RO;function yce(){return RO||(RO=1,typeof Object.create=="function"?mw.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:mw.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),mw.exports}var FC,NO;function bce(){if(NO)return FC;NO=1;var e=cN().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var s=this._block,i=this._blockSize,a=n.length,o=this._len,l=0;l<a;){for(var c=o%i,u=Math.min(a-l,i-c),f=0;f<u;f++)s[c+f]=n[l+f];o+=u,l+=u,o%i===0&&this._update(s)}return this._len+=a,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var s=this._len*8;if(s<=4294967295)this._block.writeUInt32BE(s,this._blockSize-4);else{var i=(s&4294967295)>>>0,a=(s-i)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},FC=t,FC}var LC,IO;function vce(){if(IO)return LC;IO=1;var e=yce(),t=bce(),n=cN().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function i(){this.init(),this._w=s,t.call(this,64,56)}e(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function a(u){return u<<1|u>>>31}function o(u){return u<<5|u>>>27}function l(u){return u<<30|u>>>2}function c(u,f,m,g){return u===0?f&m|~f&g:u===2?f&m|f&g|m&g:f^m^g}return i.prototype._update=function(u){for(var f=this._w,m=this._a|0,g=this._b|0,v=this._c|0,b=this._d|0,w=this._e|0,x=0;x<16;++x)f[x]=u.readInt32BE(x*4);for(;x<80;++x)f[x]=a(f[x-3]^f[x-8]^f[x-14]^f[x-16]);for(var _=0;_<80;++_){var E=~~(_/20),C=o(m)+c(E,g,v,b)+w+f[_]+r[E]|0;w=b,b=v,v=l(g),g=m,m=C}this._a=m+this._a|0,this._b=g+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0},i.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},LC=i,LC}var wce=vce();const QB=Ni(wce);var BC,jO;function xce(){if(jO)return BC;jO=1;function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(s))}function t(s,i){for(var a="",o=0,l=-1,c=0,u,f=0;f<=s.length;++f){if(f<s.length)u=s.charCodeAt(f);else{if(u===47)break;u=47}if(u===47){if(!(l===f-1||c===1))if(l!==f-1&&c===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var m=a.lastIndexOf("/");if(m!==a.length-1){m===-1?(a="",o=0):(a=a.slice(0,m),o=a.length-1-a.lastIndexOf("/")),l=f,c=0;continue}}else if(a.length===2||a.length===1){a="",o=0,l=f,c=0;continue}}i&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+s.slice(l+1,f):a=s.slice(l+1,f),o=f-l-1;l=f,c=0}else u===46&&c!==-1?++c:c=-1}return a}function n(s,i){var a=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return a?a===i.root?a+o:a+s+o:o}var r={resolve:function(){for(var i="",a=!1,o,l=arguments.length-1;l>=-1&&!a;l--){var c;l>=0?c=arguments[l]:(o===void 0&&(o=vs.cwd()),c=o),e(c),c.length!==0&&(i=c+"/"+i,a=c.charCodeAt(0)===47)}return i=t(i,!a),a?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(e(i),i.length===0)return".";var a=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!a),i.length===0&&!a&&(i="."),i.length>0&&o&&(i+="/"),a?"/"+i:i},isAbsolute:function(i){return e(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,a=0;a<arguments.length;++a){var o=arguments[a];e(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":r.normalize(i)},relative:function(i,a){if(e(i),e(a),i===a||(i=r.resolve(i),a=r.resolve(a),i===a))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var l=i.length,c=l-o,u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var f=a.length,m=f-u,g=c<m?c:m,v=-1,b=0;b<=g;++b){if(b===g){if(m>g){if(a.charCodeAt(u+b)===47)return a.slice(u+b+1);if(b===0)return a.slice(u+b)}else c>g&&(i.charCodeAt(o+b)===47?v=b:b===0&&(v=0));break}var w=i.charCodeAt(o+b),x=a.charCodeAt(u+b);if(w!==x)break;w===47&&(v=b)}var _="";for(b=o+v+1;b<=l;++b)(b===l||i.charCodeAt(b)===47)&&(_.length===0?_+="..":_+="/..");return _.length>0?_+a.slice(u+v):(u+=v,a.charCodeAt(u)===47&&++u,a.slice(u))},_makeLong:function(i){return i},dirname:function(i){if(e(i),i.length===0)return".";for(var a=i.charCodeAt(0),o=a===47,l=-1,c=!0,u=i.length-1;u>=1;--u)if(a=i.charCodeAt(u),a===47){if(!c){l=u;break}}else c=!1;return l===-1?o?"/":".":o&&l===1?"//":i.slice(0,l)},basename:function(i,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(i);var o=0,l=-1,c=!0,u;if(a!==void 0&&a.length>0&&a.length<=i.length){if(a.length===i.length&&a===i)return"";var f=a.length-1,m=-1;for(u=i.length-1;u>=0;--u){var g=i.charCodeAt(u);if(g===47){if(!c){o=u+1;break}}else m===-1&&(c=!1,m=u+1),f>=0&&(g===a.charCodeAt(f)?--f===-1&&(l=u):(f=-1,l=m))}return o===l?l=m:l===-1&&(l=i.length),i.slice(o,l)}else{for(u=i.length-1;u>=0;--u)if(i.charCodeAt(u)===47){if(!c){o=u+1;break}}else l===-1&&(c=!1,l=u+1);return l===-1?"":i.slice(o,l)}},extname:function(i){e(i);for(var a=-1,o=0,l=-1,c=!0,u=0,f=i.length-1;f>=0;--f){var m=i.charCodeAt(f);if(m===47){if(!c){o=f+1;break}continue}l===-1&&(c=!1,l=f+1),m===46?a===-1?a=f:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?"":i.slice(a,l)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return n("/",i)},parse:function(i){e(i);var a={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return a;var o=i.charCodeAt(0),l=o===47,c;l?(a.root="/",c=1):c=0;for(var u=-1,f=0,m=-1,g=!0,v=i.length-1,b=0;v>=c;--v){if(o=i.charCodeAt(v),o===47){if(!g){f=v+1;break}continue}m===-1&&(g=!1,m=v+1),o===46?u===-1?u=v:b!==1&&(b=1):u!==-1&&(b=-1)}return u===-1||m===-1||b===0||b===1&&u===m-1&&u===f+1?m!==-1&&(f===0&&l?a.base=a.name=i.slice(1,m):a.base=a.name=i.slice(f,m)):(f===0&&l?(a.name=i.slice(1,u),a.base=i.slice(1,m)):(a.name=i.slice(f,u),a.base=i.slice(f,m)),a.ext=i.slice(u,m)),f>0?a.dir=i.slice(0,f-1):l&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,BC=r,BC}var Mt=xce(),$C={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var MO;function _ce(){return MO||(MO=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var j=0,M=new Array(256),L=0;L!=256;++L)j=L,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,M[L]=j;return typeof Int32Array<"u"?new Int32Array(M):M}var r=n();function s(j){var M=0,L=0,q=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)P[q]=j[q];for(q=0;q!=256;++q)for(L=j[q],M=256+q;M<4096;M+=256)L=P[M]=L>>>8^j[L&255];var V=[];for(q=1;q!=16;++q)V[q-1]=typeof Int32Array<"u"?P.subarray(q*256,q*256+256):P.slice(q*256,q*256+256);return V}var i=s(r),a=i[0],o=i[1],l=i[2],c=i[3],u=i[4],f=i[5],m=i[6],g=i[7],v=i[8],b=i[9],w=i[10],x=i[11],_=i[12],E=i[13],C=i[14];function k(j,M){for(var L=M^-1,q=0,P=j.length;q<P;)L=L>>>8^r[(L^j.charCodeAt(q++))&255];return~L}function R(j,M){for(var L=M^-1,q=j.length-15,P=0;P<q;)L=C[j[P++]^L&255]^E[j[P++]^L>>8&255]^_[j[P++]^L>>16&255]^x[j[P++]^L>>>24]^w[j[P++]]^b[j[P++]]^v[j[P++]]^g[j[P++]]^m[j[P++]]^f[j[P++]]^u[j[P++]]^c[j[P++]]^l[j[P++]]^o[j[P++]]^a[j[P++]]^r[j[P++]];for(q+=15;P<q;)L=L>>>8^r[(L^j[P++])&255];return~L}function I(j,M){for(var L=M^-1,q=0,P=j.length,V=0,z=0;q<P;)V=j.charCodeAt(q++),V<128?L=L>>>8^r[(L^V)&255]:V<2048?(L=L>>>8^r[(L^(192|V>>6&31))&255],L=L>>>8^r[(L^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,z=j.charCodeAt(q++)&1023,L=L>>>8^r[(L^(240|V>>8&7))&255],L=L>>>8^r[(L^(128|V>>2&63))&255],L=L>>>8^r[(L^(128|z>>6&15|(V&3)<<4))&255],L=L>>>8^r[(L^(128|z&63))&255]):(L=L>>>8^r[(L^(224|V>>12&15))&255],L=L>>>8^r[(L^(128|V>>6&63))&255],L=L>>>8^r[(L^(128|V&63))&255]);return~L}t.table=r,t.bstr=k,t.buf=R,t.str=I})}($C)),$C}var Sce=_ce();const Ece=Ni(Sce);var zC={},OO;function xd(){return OO||(OO=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(i,a){return Object.prototype.hasOwnProperty.call(i,a)}e.assign=function(i){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(i[l]=o[l])}}return i},e.shrinkBuf=function(i,a){return i.length===a?i:i.subarray?i.subarray(0,a):(i.length=a,i)};var r={arraySet:function(i,a,o,l,c){if(a.subarray&&i.subarray){i.set(a.subarray(o,o+l),c);return}for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){var a,o,l,c,u,f;for(l=0,a=0,o=i.length;a<o;a++)l+=i[a].length;for(f=new Uint8Array(l),c=0,a=0,o=i.length;a<o;a++)u=i[a],f.set(u,c),c+=u.length;return f}},s={arraySet:function(i,a,o,l,c){for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){return[].concat.apply([],i)}};e.setTyped=function(i){i?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)}(zC)),zC}var Wh={},wo={},nf={},PO;function Cce(){if(PO)return nf;PO=1;var e=xd(),t=4,n=0,r=1,s=2;function i(O){for(var Z=O.length;--Z>=0;)O[Z]=0}var a=0,o=1,l=2,c=3,u=258,f=29,m=256,g=m+1+f,v=30,b=19,w=2*g+1,x=15,_=16,E=7,C=256,k=16,R=17,I=18,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],M=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,V=new Array((g+2)*2);i(V);var z=new Array(v*2);i(z);var re=new Array(P);i(re);var K=new Array(u-c+1);i(K);var ee=new Array(f);i(ee);var W=new Array(v);i(W);function se(O,Z,fe,Oe,ve){this.static_tree=O,this.extra_bits=Z,this.extra_base=fe,this.elems=Oe,this.max_length=ve,this.has_stree=O&&O.length}var Y,te,Q;function ae(O,Z){this.dyn_tree=O,this.max_code=0,this.stat_desc=Z}function xe(O){return O<256?re[O]:re[256+(O>>>7)]}function ge(O,Z){O.pending_buf[O.pending++]=Z&255,O.pending_buf[O.pending++]=Z>>>8&255}function Me(O,Z,fe){O.bi_valid>_-fe?(O.bi_buf|=Z<<O.bi_valid&65535,ge(O,O.bi_buf),O.bi_buf=Z>>_-O.bi_valid,O.bi_valid+=fe-_):(O.bi_buf|=Z<<O.bi_valid&65535,O.bi_valid+=fe)}function Pe(O,Z,fe){Me(O,fe[Z*2],fe[Z*2+1])}function Ie(O,Z){var fe=0;do fe|=O&1,O>>>=1,fe<<=1;while(--Z>0);return fe>>>1}function Ce(O){O.bi_valid===16?(ge(O,O.bi_buf),O.bi_buf=0,O.bi_valid=0):O.bi_valid>=8&&(O.pending_buf[O.pending++]=O.bi_buf&255,O.bi_buf>>=8,O.bi_valid-=8)}function He(O,Z){var fe=Z.dyn_tree,Oe=Z.max_code,ve=Z.stat_desc.static_tree,Ae=Z.stat_desc.has_stree,ue=Z.stat_desc.extra_bits,mt=Z.stat_desc.extra_base,wt=Z.stat_desc.max_length,B,ze,rt,ye,we,Ue,Et=0;for(ye=0;ye<=x;ye++)O.bl_count[ye]=0;for(fe[O.heap[O.heap_max]*2+1]=0,B=O.heap_max+1;B<w;B++)ze=O.heap[B],ye=fe[fe[ze*2+1]*2+1]+1,ye>wt&&(ye=wt,Et++),fe[ze*2+1]=ye,!(ze>Oe)&&(O.bl_count[ye]++,we=0,ze>=mt&&(we=ue[ze-mt]),Ue=fe[ze*2],O.opt_len+=Ue*(ye+we),Ae&&(O.static_len+=Ue*(ve[ze*2+1]+we)));if(Et!==0){do{for(ye=wt-1;O.bl_count[ye]===0;)ye--;O.bl_count[ye]--,O.bl_count[ye+1]+=2,O.bl_count[wt]--,Et-=2}while(Et>0);for(ye=wt;ye!==0;ye--)for(ze=O.bl_count[ye];ze!==0;)rt=O.heap[--B],!(rt>Oe)&&(fe[rt*2+1]!==ye&&(O.opt_len+=(ye-fe[rt*2+1])*fe[rt*2],fe[rt*2+1]=ye),ze--)}}function it(O,Z,fe){var Oe=new Array(x+1),ve=0,Ae,ue;for(Ae=1;Ae<=x;Ae++)Oe[Ae]=ve=ve+fe[Ae-1]<<1;for(ue=0;ue<=Z;ue++){var mt=O[ue*2+1];mt!==0&&(O[ue*2]=Ie(Oe[mt]++,mt))}}function Ge(){var O,Z,fe,Oe,ve,Ae=new Array(x+1);for(fe=0,Oe=0;Oe<f-1;Oe++)for(ee[Oe]=fe,O=0;O<1<<j[Oe];O++)K[fe++]=Oe;for(K[fe-1]=Oe,ve=0,Oe=0;Oe<16;Oe++)for(W[Oe]=ve,O=0;O<1<<M[Oe];O++)re[ve++]=Oe;for(ve>>=7;Oe<v;Oe++)for(W[Oe]=ve<<7,O=0;O<1<<M[Oe]-7;O++)re[256+ve++]=Oe;for(Z=0;Z<=x;Z++)Ae[Z]=0;for(O=0;O<=143;)V[O*2+1]=8,O++,Ae[8]++;for(;O<=255;)V[O*2+1]=9,O++,Ae[9]++;for(;O<=279;)V[O*2+1]=7,O++,Ae[7]++;for(;O<=287;)V[O*2+1]=8,O++,Ae[8]++;for(it(V,g+1,Ae),O=0;O<v;O++)z[O*2+1]=5,z[O*2]=Ie(O,5);Y=new se(V,j,m+1,g,x),te=new se(z,M,0,v,x),Q=new se(new Array(0),L,0,b,E)}function Re(O){var Z;for(Z=0;Z<g;Z++)O.dyn_ltree[Z*2]=0;for(Z=0;Z<v;Z++)O.dyn_dtree[Z*2]=0;for(Z=0;Z<b;Z++)O.bl_tree[Z*2]=0;O.dyn_ltree[C*2]=1,O.opt_len=O.static_len=0,O.last_lit=O.matches=0}function H(O){O.bi_valid>8?ge(O,O.bi_buf):O.bi_valid>0&&(O.pending_buf[O.pending++]=O.bi_buf),O.bi_buf=0,O.bi_valid=0}function me(O,Z,fe,Oe){H(O),ge(O,fe),ge(O,~fe),e.arraySet(O.pending_buf,O.window,Z,fe,O.pending),O.pending+=fe}function Te(O,Z,fe,Oe){var ve=Z*2,Ae=fe*2;return O[ve]<O[Ae]||O[ve]===O[Ae]&&Oe[Z]<=Oe[fe]}function ce(O,Z,fe){for(var Oe=O.heap[fe],ve=fe<<1;ve<=O.heap_len&&(ve<O.heap_len&&Te(Z,O.heap[ve+1],O.heap[ve],O.depth)&&ve++,!Te(Z,Oe,O.heap[ve],O.depth));)O.heap[fe]=O.heap[ve],fe=ve,ve<<=1;O.heap[fe]=Oe}function oe(O,Z,fe){var Oe,ve,Ae=0,ue,mt;if(O.last_lit!==0)do Oe=O.pending_buf[O.d_buf+Ae*2]<<8|O.pending_buf[O.d_buf+Ae*2+1],ve=O.pending_buf[O.l_buf+Ae],Ae++,Oe===0?Pe(O,ve,Z):(ue=K[ve],Pe(O,ue+m+1,Z),mt=j[ue],mt!==0&&(ve-=ee[ue],Me(O,ve,mt)),Oe--,ue=xe(Oe),Pe(O,ue,fe),mt=M[ue],mt!==0&&(Oe-=W[ue],Me(O,Oe,mt)));while(Ae<O.last_lit);Pe(O,C,Z)}function ne(O,Z){var fe=Z.dyn_tree,Oe=Z.stat_desc.static_tree,ve=Z.stat_desc.has_stree,Ae=Z.stat_desc.elems,ue,mt,wt=-1,B;for(O.heap_len=0,O.heap_max=w,ue=0;ue<Ae;ue++)fe[ue*2]!==0?(O.heap[++O.heap_len]=wt=ue,O.depth[ue]=0):fe[ue*2+1]=0;for(;O.heap_len<2;)B=O.heap[++O.heap_len]=wt<2?++wt:0,fe[B*2]=1,O.depth[B]=0,O.opt_len--,ve&&(O.static_len-=Oe[B*2+1]);for(Z.max_code=wt,ue=O.heap_len>>1;ue>=1;ue--)ce(O,fe,ue);B=Ae;do ue=O.heap[1],O.heap[1]=O.heap[O.heap_len--],ce(O,fe,1),mt=O.heap[1],O.heap[--O.heap_max]=ue,O.heap[--O.heap_max]=mt,fe[B*2]=fe[ue*2]+fe[mt*2],O.depth[B]=(O.depth[ue]>=O.depth[mt]?O.depth[ue]:O.depth[mt])+1,fe[ue*2+1]=fe[mt*2+1]=B,O.heap[1]=B++,ce(O,fe,1);while(O.heap_len>=2);O.heap[--O.heap_max]=O.heap[1],He(O,Z),it(fe,wt,O.bl_count)}function Se(O,Z,fe){var Oe,ve=-1,Ae,ue=Z[0*2+1],mt=0,wt=7,B=4;for(ue===0&&(wt=138,B=3),Z[(fe+1)*2+1]=65535,Oe=0;Oe<=fe;Oe++)Ae=ue,ue=Z[(Oe+1)*2+1],!(++mt<wt&&Ae===ue)&&(mt<B?O.bl_tree[Ae*2]+=mt:Ae!==0?(Ae!==ve&&O.bl_tree[Ae*2]++,O.bl_tree[k*2]++):mt<=10?O.bl_tree[R*2]++:O.bl_tree[I*2]++,mt=0,ve=Ae,ue===0?(wt=138,B=3):Ae===ue?(wt=6,B=3):(wt=7,B=4))}function Fe(O,Z,fe){var Oe,ve=-1,Ae,ue=Z[0*2+1],mt=0,wt=7,B=4;for(ue===0&&(wt=138,B=3),Oe=0;Oe<=fe;Oe++)if(Ae=ue,ue=Z[(Oe+1)*2+1],!(++mt<wt&&Ae===ue)){if(mt<B)do Pe(O,Ae,O.bl_tree);while(--mt!==0);else Ae!==0?(Ae!==ve&&(Pe(O,Ae,O.bl_tree),mt--),Pe(O,k,O.bl_tree),Me(O,mt-3,2)):mt<=10?(Pe(O,R,O.bl_tree),Me(O,mt-3,3)):(Pe(O,I,O.bl_tree),Me(O,mt-11,7));mt=0,ve=Ae,ue===0?(wt=138,B=3):Ae===ue?(wt=6,B=3):(wt=7,B=4)}}function ke(O){var Z;for(Se(O,O.dyn_ltree,O.l_desc.max_code),Se(O,O.dyn_dtree,O.d_desc.max_code),ne(O,O.bl_desc),Z=b-1;Z>=3&&O.bl_tree[q[Z]*2+1]===0;Z--);return O.opt_len+=3*(Z+1)+5+5+4,Z}function Xe(O,Z,fe,Oe){var ve;for(Me(O,Z-257,5),Me(O,fe-1,5),Me(O,Oe-4,4),ve=0;ve<Oe;ve++)Me(O,O.bl_tree[q[ve]*2+1],3);Fe(O,O.dyn_ltree,Z-1),Fe(O,O.dyn_dtree,fe-1)}function St(O){var Z=4093624447,fe;for(fe=0;fe<=31;fe++,Z>>>=1)if(Z&1&&O.dyn_ltree[fe*2]!==0)return n;if(O.dyn_ltree[9*2]!==0||O.dyn_ltree[10*2]!==0||O.dyn_ltree[13*2]!==0)return r;for(fe=32;fe<m;fe++)if(O.dyn_ltree[fe*2]!==0)return r;return n}var ht=!1;function It(O){ht||(Ge(),ht=!0),O.l_desc=new ae(O.dyn_ltree,Y),O.d_desc=new ae(O.dyn_dtree,te),O.bl_desc=new ae(O.bl_tree,Q),O.bi_buf=0,O.bi_valid=0,Re(O)}function Vt(O,Z,fe,Oe){Me(O,(a<<1)+(Oe?1:0),3),me(O,Z,fe)}function Ot(O){Me(O,o<<1,3),Pe(O,C,V),Ce(O)}function Gt(O,Z,fe,Oe){var ve,Ae,ue=0;O.level>0?(O.strm.data_type===s&&(O.strm.data_type=St(O)),ne(O,O.l_desc),ne(O,O.d_desc),ue=ke(O),ve=O.opt_len+3+7>>>3,Ae=O.static_len+3+7>>>3,Ae<=ve&&(ve=Ae)):ve=Ae=fe+5,fe+4<=ve&&Z!==-1?Vt(O,Z,fe,Oe):O.strategy===t||Ae===ve?(Me(O,(o<<1)+(Oe?1:0),3),oe(O,V,z)):(Me(O,(l<<1)+(Oe?1:0),3),Xe(O,O.l_desc.max_code+1,O.d_desc.max_code+1,ue+1),oe(O,O.dyn_ltree,O.dyn_dtree)),Re(O),Oe&&H(O)}function be(O,Z,fe){return O.pending_buf[O.d_buf+O.last_lit*2]=Z>>>8&255,O.pending_buf[O.d_buf+O.last_lit*2+1]=Z&255,O.pending_buf[O.l_buf+O.last_lit]=fe&255,O.last_lit++,Z===0?O.dyn_ltree[fe*2]++:(O.matches++,Z--,O.dyn_ltree[(K[fe]+m+1)*2]++,O.dyn_dtree[xe(Z)*2]++),O.last_lit===O.lit_bufsize-1}return nf._tr_init=It,nf._tr_stored_block=Vt,nf._tr_flush_block=Gt,nf._tr_tally=be,nf._tr_align=Ot,nf}var UC,DO;function e$(){if(DO)return UC;DO=1;function e(t,n,r,s){for(var i=t&65535|0,a=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+n[s++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}return UC=e,UC}var qC,FO;function t$(){if(FO)return qC;FO=1;function e(){for(var r,s=[],i=0;i<256;i++){r=i;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;s[i]=r}return s}var t=e();function n(r,s,i,a){var o=t,l=a+i;r^=-1;for(var c=a;c<l;c++)r=r>>>8^o[(r^s[c])&255];return r^-1}return qC=n,qC}var VC,LO;function wN(){return LO||(LO=1,VC={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),VC}var BO;function kce(){if(BO)return wo;BO=1;var e=xd(),t=Cce(),n=e$(),r=t$(),s=wN(),i=0,a=1,o=3,l=4,c=5,u=0,f=1,m=-2,g=-3,v=-5,b=-1,w=1,x=2,_=3,E=4,C=0,k=2,R=8,I=9,j=15,M=8,L=29,q=256,P=q+1+L,V=30,z=19,re=2*P+1,K=15,ee=3,W=258,se=W+ee+1,Y=32,te=42,Q=69,ae=73,xe=91,ge=103,Me=113,Pe=666,Ie=1,Ce=2,He=3,it=4,Ge=3;function Re(B,ze){return B.msg=s[ze],ze}function H(B){return(B<<1)-(B>4?9:0)}function me(B){for(var ze=B.length;--ze>=0;)B[ze]=0}function Te(B){var ze=B.state,rt=ze.pending;rt>B.avail_out&&(rt=B.avail_out),rt!==0&&(e.arraySet(B.output,ze.pending_buf,ze.pending_out,rt,B.next_out),B.next_out+=rt,ze.pending_out+=rt,B.total_out+=rt,B.avail_out-=rt,ze.pending-=rt,ze.pending===0&&(ze.pending_out=0))}function ce(B,ze){t._tr_flush_block(B,B.block_start>=0?B.block_start:-1,B.strstart-B.block_start,ze),B.block_start=B.strstart,Te(B.strm)}function oe(B,ze){B.pending_buf[B.pending++]=ze}function ne(B,ze){B.pending_buf[B.pending++]=ze>>>8&255,B.pending_buf[B.pending++]=ze&255}function Se(B,ze,rt,ye){var we=B.avail_in;return we>ye&&(we=ye),we===0?0:(B.avail_in-=we,e.arraySet(ze,B.input,B.next_in,we,rt),B.state.wrap===1?B.adler=n(B.adler,ze,we,rt):B.state.wrap===2&&(B.adler=r(B.adler,ze,we,rt)),B.next_in+=we,B.total_in+=we,we)}function Fe(B,ze){var rt=B.max_chain_length,ye=B.strstart,we,Ue,Et=B.prev_length,he=B.nice_match,G=B.strstart>B.w_size-se?B.strstart-(B.w_size-se):0,U=B.window,X=B.w_mask,pe=B.prev,je=B.strstart+W,Ke=U[ye+Et-1],bt=U[ye+Et];B.prev_length>=B.good_match&&(rt>>=2),he>B.lookahead&&(he=B.lookahead);do if(we=ze,!(U[we+Et]!==bt||U[we+Et-1]!==Ke||U[we]!==U[ye]||U[++we]!==U[ye+1])){ye+=2,we++;do;while(U[++ye]===U[++we]&&U[++ye]===U[++we]&&U[++ye]===U[++we]&&U[++ye]===U[++we]&&U[++ye]===U[++we]&&U[++ye]===U[++we]&&U[++ye]===U[++we]&&U[++ye]===U[++we]&&ye<je);if(Ue=W-(je-ye),ye=je-W,Ue>Et){if(B.match_start=ze,Et=Ue,Ue>=he)break;Ke=U[ye+Et-1],bt=U[ye+Et]}}while((ze=pe[ze&X])>G&&--rt!==0);return Et<=B.lookahead?Et:B.lookahead}function ke(B){var ze=B.w_size,rt,ye,we,Ue,Et;do{if(Ue=B.window_size-B.lookahead-B.strstart,B.strstart>=ze+(ze-se)){e.arraySet(B.window,B.window,ze,ze,0),B.match_start-=ze,B.strstart-=ze,B.block_start-=ze,ye=B.hash_size,rt=ye;do we=B.head[--rt],B.head[rt]=we>=ze?we-ze:0;while(--ye);ye=ze,rt=ye;do we=B.prev[--rt],B.prev[rt]=we>=ze?we-ze:0;while(--ye);Ue+=ze}if(B.strm.avail_in===0)break;if(ye=Se(B.strm,B.window,B.strstart+B.lookahead,Ue),B.lookahead+=ye,B.lookahead+B.insert>=ee)for(Et=B.strstart-B.insert,B.ins_h=B.window[Et],B.ins_h=(B.ins_h<<B.hash_shift^B.window[Et+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[Et+ee-1])&B.hash_mask,B.prev[Et&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=Et,Et++,B.insert--,!(B.lookahead+B.insert<ee)););}while(B.lookahead<se&&B.strm.avail_in!==0)}function Xe(B,ze){var rt=65535;for(rt>B.pending_buf_size-5&&(rt=B.pending_buf_size-5);;){if(B.lookahead<=1){if(ke(B),B.lookahead===0&&ze===i)return Ie;if(B.lookahead===0)break}B.strstart+=B.lookahead,B.lookahead=0;var ye=B.block_start+rt;if((B.strstart===0||B.strstart>=ye)&&(B.lookahead=B.strstart-ye,B.strstart=ye,ce(B,!1),B.strm.avail_out===0)||B.strstart-B.block_start>=B.w_size-se&&(ce(B,!1),B.strm.avail_out===0))return Ie}return B.insert=0,ze===l?(ce(B,!0),B.strm.avail_out===0?He:it):(B.strstart>B.block_start&&(ce(B,!1),B.strm.avail_out===0),Ie)}function St(B,ze){for(var rt,ye;;){if(B.lookahead<se){if(ke(B),B.lookahead<se&&ze===i)return Ie;if(B.lookahead===0)break}if(rt=0,B.lookahead>=ee&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+ee-1])&B.hash_mask,rt=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),rt!==0&&B.strstart-rt<=B.w_size-se&&(B.match_length=Fe(B,rt)),B.match_length>=ee)if(ye=t._tr_tally(B,B.strstart-B.match_start,B.match_length-ee),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=ee){B.match_length--;do B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+ee-1])&B.hash_mask,rt=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart;while(--B.match_length!==0);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else ye=t._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(ye&&(ce(B,!1),B.strm.avail_out===0))return Ie}return B.insert=B.strstart<ee-1?B.strstart:ee-1,ze===l?(ce(B,!0),B.strm.avail_out===0?He:it):B.last_lit&&(ce(B,!1),B.strm.avail_out===0)?Ie:Ce}function ht(B,ze){for(var rt,ye,we;;){if(B.lookahead<se){if(ke(B),B.lookahead<se&&ze===i)return Ie;if(B.lookahead===0)break}if(rt=0,B.lookahead>=ee&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+ee-1])&B.hash_mask,rt=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=ee-1,rt!==0&&B.prev_length<B.max_lazy_match&&B.strstart-rt<=B.w_size-se&&(B.match_length=Fe(B,rt),B.match_length<=5&&(B.strategy===w||B.match_length===ee&&B.strstart-B.match_start>4096)&&(B.match_length=ee-1)),B.prev_length>=ee&&B.match_length<=B.prev_length){we=B.strstart+B.lookahead-ee,ye=t._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-ee),B.lookahead-=B.prev_length-1,B.prev_length-=2;do++B.strstart<=we&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+ee-1])&B.hash_mask,rt=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart);while(--B.prev_length!==0);if(B.match_available=0,B.match_length=ee-1,B.strstart++,ye&&(ce(B,!1),B.strm.avail_out===0))return Ie}else if(B.match_available){if(ye=t._tr_tally(B,0,B.window[B.strstart-1]),ye&&ce(B,!1),B.strstart++,B.lookahead--,B.strm.avail_out===0)return Ie}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(ye=t._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<ee-1?B.strstart:ee-1,ze===l?(ce(B,!0),B.strm.avail_out===0?He:it):B.last_lit&&(ce(B,!1),B.strm.avail_out===0)?Ie:Ce}function It(B,ze){for(var rt,ye,we,Ue,Et=B.window;;){if(B.lookahead<=W){if(ke(B),B.lookahead<=W&&ze===i)return Ie;if(B.lookahead===0)break}if(B.match_length=0,B.lookahead>=ee&&B.strstart>0&&(we=B.strstart-1,ye=Et[we],ye===Et[++we]&&ye===Et[++we]&&ye===Et[++we])){Ue=B.strstart+W;do;while(ye===Et[++we]&&ye===Et[++we]&&ye===Et[++we]&&ye===Et[++we]&&ye===Et[++we]&&ye===Et[++we]&&ye===Et[++we]&&ye===Et[++we]&&we<Ue);B.match_length=W-(Ue-we),B.match_length>B.lookahead&&(B.match_length=B.lookahead)}if(B.match_length>=ee?(rt=t._tr_tally(B,1,B.match_length-ee),B.lookahead-=B.match_length,B.strstart+=B.match_length,B.match_length=0):(rt=t._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++),rt&&(ce(B,!1),B.strm.avail_out===0))return Ie}return B.insert=0,ze===l?(ce(B,!0),B.strm.avail_out===0?He:it):B.last_lit&&(ce(B,!1),B.strm.avail_out===0)?Ie:Ce}function Vt(B,ze){for(var rt;;){if(B.lookahead===0&&(ke(B),B.lookahead===0)){if(ze===i)return Ie;break}if(B.match_length=0,rt=t._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++,rt&&(ce(B,!1),B.strm.avail_out===0))return Ie}return B.insert=0,ze===l?(ce(B,!0),B.strm.avail_out===0?He:it):B.last_lit&&(ce(B,!1),B.strm.avail_out===0)?Ie:Ce}function Ot(B,ze,rt,ye,we){this.good_length=B,this.max_lazy=ze,this.nice_length=rt,this.max_chain=ye,this.func=we}var Gt;Gt=[new Ot(0,0,0,0,Xe),new Ot(4,4,8,4,St),new Ot(4,5,16,8,St),new Ot(4,6,32,32,St),new Ot(4,4,16,16,ht),new Ot(8,16,32,32,ht),new Ot(8,16,128,128,ht),new Ot(8,32,128,256,ht),new Ot(32,128,258,1024,ht),new Ot(32,258,258,4096,ht)];function be(B){B.window_size=2*B.w_size,me(B.head),B.max_lazy_match=Gt[B.level].max_lazy,B.good_match=Gt[B.level].good_length,B.nice_match=Gt[B.level].nice_length,B.max_chain_length=Gt[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=ee-1,B.match_available=0,B.ins_h=0}function O(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(re*2),this.dyn_dtree=new e.Buf16((2*V+1)*2),this.bl_tree=new e.Buf16((2*z+1)*2),me(this.dyn_ltree),me(this.dyn_dtree),me(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(K+1),this.heap=new e.Buf16(2*P+1),me(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*P+1),me(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Z(B){var ze;return!B||!B.state?Re(B,m):(B.total_in=B.total_out=0,B.data_type=k,ze=B.state,ze.pending=0,ze.pending_out=0,ze.wrap<0&&(ze.wrap=-ze.wrap),ze.status=ze.wrap?te:Me,B.adler=ze.wrap===2?0:1,ze.last_flush=i,t._tr_init(ze),u)}function fe(B){var ze=Z(B);return ze===u&&be(B.state),ze}function Oe(B,ze){return!B||!B.state||B.state.wrap!==2?m:(B.state.gzhead=ze,u)}function ve(B,ze,rt,ye,we,Ue){if(!B)return m;var Et=1;if(ze===b&&(ze=6),ye<0?(Et=0,ye=-ye):ye>15&&(Et=2,ye-=16),we<1||we>I||rt!==R||ye<8||ye>15||ze<0||ze>9||Ue<0||Ue>E)return Re(B,m);ye===8&&(ye=9);var he=new O;return B.state=he,he.strm=B,he.wrap=Et,he.gzhead=null,he.w_bits=ye,he.w_size=1<<he.w_bits,he.w_mask=he.w_size-1,he.hash_bits=we+7,he.hash_size=1<<he.hash_bits,he.hash_mask=he.hash_size-1,he.hash_shift=~~((he.hash_bits+ee-1)/ee),he.window=new e.Buf8(he.w_size*2),he.head=new e.Buf16(he.hash_size),he.prev=new e.Buf16(he.w_size),he.lit_bufsize=1<<we+6,he.pending_buf_size=he.lit_bufsize*4,he.pending_buf=new e.Buf8(he.pending_buf_size),he.d_buf=1*he.lit_bufsize,he.l_buf=3*he.lit_bufsize,he.level=ze,he.strategy=Ue,he.method=rt,fe(B)}function Ae(B,ze){return ve(B,ze,R,j,M,C)}function ue(B,ze){var rt,ye,we,Ue;if(!B||!B.state||ze>c||ze<0)return B?Re(B,m):m;if(ye=B.state,!B.output||!B.input&&B.avail_in!==0||ye.status===Pe&&ze!==l)return Re(B,B.avail_out===0?v:m);if(ye.strm=B,rt=ye.last_flush,ye.last_flush=ze,ye.status===te)if(ye.wrap===2)B.adler=0,oe(ye,31),oe(ye,139),oe(ye,8),ye.gzhead?(oe(ye,(ye.gzhead.text?1:0)+(ye.gzhead.hcrc?2:0)+(ye.gzhead.extra?4:0)+(ye.gzhead.name?8:0)+(ye.gzhead.comment?16:0)),oe(ye,ye.gzhead.time&255),oe(ye,ye.gzhead.time>>8&255),oe(ye,ye.gzhead.time>>16&255),oe(ye,ye.gzhead.time>>24&255),oe(ye,ye.level===9?2:ye.strategy>=x||ye.level<2?4:0),oe(ye,ye.gzhead.os&255),ye.gzhead.extra&&ye.gzhead.extra.length&&(oe(ye,ye.gzhead.extra.length&255),oe(ye,ye.gzhead.extra.length>>8&255)),ye.gzhead.hcrc&&(B.adler=r(B.adler,ye.pending_buf,ye.pending,0)),ye.gzindex=0,ye.status=Q):(oe(ye,0),oe(ye,0),oe(ye,0),oe(ye,0),oe(ye,0),oe(ye,ye.level===9?2:ye.strategy>=x||ye.level<2?4:0),oe(ye,Ge),ye.status=Me);else{var Et=R+(ye.w_bits-8<<4)<<8,he=-1;ye.strategy>=x||ye.level<2?he=0:ye.level<6?he=1:ye.level===6?he=2:he=3,Et|=he<<6,ye.strstart!==0&&(Et|=Y),Et+=31-Et%31,ye.status=Me,ne(ye,Et),ye.strstart!==0&&(ne(ye,B.adler>>>16),ne(ye,B.adler&65535)),B.adler=1}if(ye.status===Q)if(ye.gzhead.extra){for(we=ye.pending;ye.gzindex<(ye.gzhead.extra.length&65535)&&!(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>we&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-we,we)),Te(B),we=ye.pending,ye.pending===ye.pending_buf_size));)oe(ye,ye.gzhead.extra[ye.gzindex]&255),ye.gzindex++;ye.gzhead.hcrc&&ye.pending>we&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-we,we)),ye.gzindex===ye.gzhead.extra.length&&(ye.gzindex=0,ye.status=ae)}else ye.status=ae;if(ye.status===ae)if(ye.gzhead.name){we=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>we&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-we,we)),Te(B),we=ye.pending,ye.pending===ye.pending_buf_size)){Ue=1;break}ye.gzindex<ye.gzhead.name.length?Ue=ye.gzhead.name.charCodeAt(ye.gzindex++)&255:Ue=0,oe(ye,Ue)}while(Ue!==0);ye.gzhead.hcrc&&ye.pending>we&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-we,we)),Ue===0&&(ye.gzindex=0,ye.status=xe)}else ye.status=xe;if(ye.status===xe)if(ye.gzhead.comment){we=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>we&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-we,we)),Te(B),we=ye.pending,ye.pending===ye.pending_buf_size)){Ue=1;break}ye.gzindex<ye.gzhead.comment.length?Ue=ye.gzhead.comment.charCodeAt(ye.gzindex++)&255:Ue=0,oe(ye,Ue)}while(Ue!==0);ye.gzhead.hcrc&&ye.pending>we&&(B.adler=r(B.adler,ye.pending_buf,ye.pending-we,we)),Ue===0&&(ye.status=ge)}else ye.status=ge;if(ye.status===ge&&(ye.gzhead.hcrc?(ye.pending+2>ye.pending_buf_size&&Te(B),ye.pending+2<=ye.pending_buf_size&&(oe(ye,B.adler&255),oe(ye,B.adler>>8&255),B.adler=0,ye.status=Me)):ye.status=Me),ye.pending!==0){if(Te(B),B.avail_out===0)return ye.last_flush=-1,u}else if(B.avail_in===0&&H(ze)<=H(rt)&&ze!==l)return Re(B,v);if(ye.status===Pe&&B.avail_in!==0)return Re(B,v);if(B.avail_in!==0||ye.lookahead!==0||ze!==i&&ye.status!==Pe){var G=ye.strategy===x?Vt(ye,ze):ye.strategy===_?It(ye,ze):Gt[ye.level].func(ye,ze);if((G===He||G===it)&&(ye.status=Pe),G===Ie||G===He)return B.avail_out===0&&(ye.last_flush=-1),u;if(G===Ce&&(ze===a?t._tr_align(ye):ze!==c&&(t._tr_stored_block(ye,0,0,!1),ze===o&&(me(ye.head),ye.lookahead===0&&(ye.strstart=0,ye.block_start=0,ye.insert=0))),Te(B),B.avail_out===0))return ye.last_flush=-1,u}return ze!==l?u:ye.wrap<=0?f:(ye.wrap===2?(oe(ye,B.adler&255),oe(ye,B.adler>>8&255),oe(ye,B.adler>>16&255),oe(ye,B.adler>>24&255),oe(ye,B.total_in&255),oe(ye,B.total_in>>8&255),oe(ye,B.total_in>>16&255),oe(ye,B.total_in>>24&255)):(ne(ye,B.adler>>>16),ne(ye,B.adler&65535)),Te(B),ye.wrap>0&&(ye.wrap=-ye.wrap),ye.pending!==0?u:f)}function mt(B){var ze;return!B||!B.state?m:(ze=B.state.status,ze!==te&&ze!==Q&&ze!==ae&&ze!==xe&&ze!==ge&&ze!==Me&&ze!==Pe?Re(B,m):(B.state=null,ze===Me?Re(B,g):u))}function wt(B,ze){var rt=ze.length,ye,we,Ue,Et,he,G,U,X;if(!B||!B.state||(ye=B.state,Et=ye.wrap,Et===2||Et===1&&ye.status!==te||ye.lookahead))return m;for(Et===1&&(B.adler=n(B.adler,ze,rt,0)),ye.wrap=0,rt>=ye.w_size&&(Et===0&&(me(ye.head),ye.strstart=0,ye.block_start=0,ye.insert=0),X=new e.Buf8(ye.w_size),e.arraySet(X,ze,rt-ye.w_size,ye.w_size,0),ze=X,rt=ye.w_size),he=B.avail_in,G=B.next_in,U=B.input,B.avail_in=rt,B.next_in=0,B.input=ze,ke(ye);ye.lookahead>=ee;){we=ye.strstart,Ue=ye.lookahead-(ee-1);do ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[we+ee-1])&ye.hash_mask,ye.prev[we&ye.w_mask]=ye.head[ye.ins_h],ye.head[ye.ins_h]=we,we++;while(--Ue);ye.strstart=we,ye.lookahead=ee-1,ke(ye)}return ye.strstart+=ye.lookahead,ye.block_start=ye.strstart,ye.insert=ye.lookahead,ye.lookahead=0,ye.match_length=ye.prev_length=ee-1,ye.match_available=0,B.next_in=G,B.input=U,B.avail_in=he,ye.wrap=Et,u}return wo.deflateInit=Ae,wo.deflateInit2=ve,wo.deflateReset=fe,wo.deflateResetKeep=Z,wo.deflateSetHeader=Oe,wo.deflate=ue,wo.deflateEnd=mt,wo.deflateSetDictionary=wt,wo.deflateInfo="pako deflate (from Nodeca project)",wo}var rf={},$O;function n$(){if($O)return rf;$O=1;var e=xd(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),s=0;s<256;s++)r[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;r[254]=r[254]=1,rf.string2buf=function(a){var o,l,c,u,f,m=a.length,g=0;for(u=0;u<m;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<m&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),g+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(g),f=0,u=0;f<g;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<m&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),l<128?o[f++]=l:l<2048?(o[f++]=192|l>>>6,o[f++]=128|l&63):l<65536?(o[f++]=224|l>>>12,o[f++]=128|l>>>6&63,o[f++]=128|l&63):(o[f++]=240|l>>>18,o[f++]=128|l>>>12&63,o[f++]=128|l>>>6&63,o[f++]=128|l&63);return o};function i(a,o){if(o<65534&&(a.subarray&&n||!a.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(a,o));for(var l="",c=0;c<o;c++)l+=String.fromCharCode(a[c]);return l}return rf.buf2binstring=function(a){return i(a,a.length)},rf.binstring2buf=function(a){for(var o=new e.Buf8(a.length),l=0,c=o.length;l<c;l++)o[l]=a.charCodeAt(l);return o},rf.buf2string=function(a,o){var l,c,u,f,m=o||a.length,g=new Array(m*2);for(c=0,l=0;l<m;){if(u=a[l++],u<128){g[c++]=u;continue}if(f=r[u],f>4){g[c++]=65533,l+=f-1;continue}for(u&=f===2?31:f===3?15:7;f>1&&l<m;)u=u<<6|a[l++]&63,f--;if(f>1){g[c++]=65533;continue}u<65536?g[c++]=u:(u-=65536,g[c++]=55296|u>>10&1023,g[c++]=56320|u&1023)}return i(g,c)},rf.utf8border=function(a,o){var l;for(o=o||a.length,o>a.length&&(o=a.length),l=o-1;l>=0&&(a[l]&192)===128;)l--;return l<0||l===0?o:l+r[a[l]]>o?l:o},rf}var HC,zO;function r$(){if(zO)return HC;zO=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return HC=e,HC}var UO;function Tce(){if(UO)return Wh;UO=1;var e=kce(),t=xd(),n=n$(),r=wN(),s=r$(),i=Object.prototype.toString,a=0,o=4,l=0,c=1,u=2,f=-1,m=0,g=8;function v(_){if(!(this instanceof v))return new v(_);this.options=t.assign({level:f,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},_||{});var E=this.options;E.raw&&E.windowBits>0?E.windowBits=-E.windowBits:E.gzip&&E.windowBits>0&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var C=e.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(C!==l)throw new Error(r[C]);if(E.header&&e.deflateSetHeader(this.strm,E.header),E.dictionary){var k;if(typeof E.dictionary=="string"?k=n.string2buf(E.dictionary):i.call(E.dictionary)==="[object ArrayBuffer]"?k=new Uint8Array(E.dictionary):k=E.dictionary,C=e.deflateSetDictionary(this.strm,k),C!==l)throw new Error(r[C]);this._dict_set=!0}}v.prototype.push=function(_,E){var C=this.strm,k=this.options.chunkSize,R,I;if(this.ended)return!1;I=E===~~E?E:E===!0?o:a,typeof _=="string"?C.input=n.string2buf(_):i.call(_)==="[object ArrayBuffer]"?C.input=new Uint8Array(_):C.input=_,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new t.Buf8(k),C.next_out=0,C.avail_out=k),R=e.deflate(C,I),R!==c&&R!==l)return this.onEnd(R),this.ended=!0,!1;(C.avail_out===0||C.avail_in===0&&(I===o||I===u))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(C.output,C.next_out))):this.onData(t.shrinkBuf(C.output,C.next_out)))}while((C.avail_in>0||C.avail_out===0)&&R!==c);return I===o?(R=e.deflateEnd(this.strm),this.onEnd(R),this.ended=!0,R===l):(I===u&&(this.onEnd(l),C.avail_out=0),!0)},v.prototype.onData=function(_){this.chunks.push(_)},v.prototype.onEnd=function(_){_===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function b(_,E){var C=new v(E);if(C.push(_,!0),C.err)throw C.msg||r[C.err];return C.result}function w(_,E){return E=E||{},E.raw=!0,b(_,E)}function x(_,E){return E=E||{},E.gzip=!0,b(_,E)}return Wh.Deflate=v,Wh.deflate=b,Wh.deflateRaw=w,Wh.gzip=x,Wh}var Zh={},Ka={},GC,qO;function Ace(){if(qO)return GC;qO=1;var e=30,t=12;return GC=function(r,s){var i,a,o,l,c,u,f,m,g,v,b,w,x,_,E,C,k,R,I,j,M,L,q,P,V;i=r.state,a=r.next_in,P=r.input,o=a+(r.avail_in-5),l=r.next_out,V=r.output,c=l-(s-r.avail_out),u=l+(r.avail_out-257),f=i.dmax,m=i.wsize,g=i.whave,v=i.wnext,b=i.window,w=i.hold,x=i.bits,_=i.lencode,E=i.distcode,C=(1<<i.lenbits)-1,k=(1<<i.distbits)-1;e:do{x<15&&(w+=P[a++]<<x,x+=8,w+=P[a++]<<x,x+=8),R=_[w&C];t:for(;;){if(I=R>>>24,w>>>=I,x-=I,I=R>>>16&255,I===0)V[l++]=R&65535;else if(I&16){j=R&65535,I&=15,I&&(x<I&&(w+=P[a++]<<x,x+=8),j+=w&(1<<I)-1,w>>>=I,x-=I),x<15&&(w+=P[a++]<<x,x+=8,w+=P[a++]<<x,x+=8),R=E[w&k];n:for(;;){if(I=R>>>24,w>>>=I,x-=I,I=R>>>16&255,I&16){if(M=R&65535,I&=15,x<I&&(w+=P[a++]<<x,x+=8,x<I&&(w+=P[a++]<<x,x+=8)),M+=w&(1<<I)-1,M>f){r.msg="invalid distance too far back",i.mode=e;break e}if(w>>>=I,x-=I,I=l-c,M>I){if(I=M-I,I>g&&i.sane){r.msg="invalid distance too far back",i.mode=e;break e}if(L=0,q=b,v===0){if(L+=m-I,I<j){j-=I;do V[l++]=b[L++];while(--I);L=l-M,q=V}}else if(v<I){if(L+=m+v-I,I-=v,I<j){j-=I;do V[l++]=b[L++];while(--I);if(L=0,v<j){I=v,j-=I;do V[l++]=b[L++];while(--I);L=l-M,q=V}}}else if(L+=v-I,I<j){j-=I;do V[l++]=b[L++];while(--I);L=l-M,q=V}for(;j>2;)V[l++]=q[L++],V[l++]=q[L++],V[l++]=q[L++],j-=3;j&&(V[l++]=q[L++],j>1&&(V[l++]=q[L++]))}else{L=l-M;do V[l++]=V[L++],V[l++]=V[L++],V[l++]=V[L++],j-=3;while(j>2);j&&(V[l++]=V[L++],j>1&&(V[l++]=V[L++]))}}else if((I&64)===0){R=E[(R&65535)+(w&(1<<I)-1)];continue n}else{r.msg="invalid distance code",i.mode=e;break e}break}}else if((I&64)===0){R=_[(R&65535)+(w&(1<<I)-1)];continue t}else if(I&32){i.mode=t;break e}else{r.msg="invalid literal/length code",i.mode=e;break e}break}}while(a<o&&l<u);j=x>>3,a-=j,x-=j<<3,w&=(1<<x)-1,r.next_in=a,r.next_out=l,r.avail_in=a<o?5+(o-a):5-(a-o),r.avail_out=l<u?257+(u-l):257-(l-u),i.hold=w,i.bits=x},GC}var KC,VO;function Rce(){if(VO)return KC;VO=1;var e=xd(),t=15,n=852,r=592,s=0,i=1,a=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return KC=function(m,g,v,b,w,x,_,E){var C=E.bits,k=0,R=0,I=0,j=0,M=0,L=0,q=0,P=0,V=0,z=0,re,K,ee,W,se,Y=null,te=0,Q,ae=new e.Buf16(t+1),xe=new e.Buf16(t+1),ge=null,Me=0,Pe,Ie,Ce;for(k=0;k<=t;k++)ae[k]=0;for(R=0;R<b;R++)ae[g[v+R]]++;for(M=C,j=t;j>=1&&ae[j]===0;j--);if(M>j&&(M=j),j===0)return w[x++]=1<<24|64<<16|0,w[x++]=1<<24|64<<16|0,E.bits=1,0;for(I=1;I<j&&ae[I]===0;I++);for(M<I&&(M=I),P=1,k=1;k<=t;k++)if(P<<=1,P-=ae[k],P<0)return-1;if(P>0&&(m===s||j!==1))return-1;for(xe[1]=0,k=1;k<t;k++)xe[k+1]=xe[k]+ae[k];for(R=0;R<b;R++)g[v+R]!==0&&(_[xe[g[v+R]]++]=R);if(m===s?(Y=ge=_,Q=19):m===i?(Y=o,te-=257,ge=l,Me-=257,Q=256):(Y=c,ge=u,Q=-1),z=0,R=0,k=I,se=x,L=M,q=0,ee=-1,V=1<<M,W=V-1,m===i&&V>n||m===a&&V>r)return 1;for(;;){Pe=k-q,_[R]<Q?(Ie=0,Ce=_[R]):_[R]>Q?(Ie=ge[Me+_[R]],Ce=Y[te+_[R]]):(Ie=96,Ce=0),re=1<<k-q,K=1<<L,I=K;do K-=re,w[se+(z>>q)+K]=Pe<<24|Ie<<16|Ce|0;while(K!==0);for(re=1<<k-1;z&re;)re>>=1;if(re!==0?(z&=re-1,z+=re):z=0,R++,--ae[k]===0){if(k===j)break;k=g[v+_[R]]}if(k>M&&(z&W)!==ee){for(q===0&&(q=M),se+=I,L=k-q,P=1<<L;L+q<j&&(P-=ae[L+q],!(P<=0));)L++,P<<=1;if(V+=1<<L,m===i&&V>n||m===a&&V>r)return 1;ee=z&W,w[ee]=M<<24|L<<16|se-x|0}}return z!==0&&(w[se+z]=k-q<<24|64<<16|0),E.bits=M,0},KC}var HO;function Nce(){if(HO)return Ka;HO=1;var e=xd(),t=e$(),n=t$(),r=Ace(),s=Rce(),i=0,a=1,o=2,l=4,c=5,u=6,f=0,m=1,g=2,v=-2,b=-3,w=-4,x=-5,_=8,E=1,C=2,k=3,R=4,I=5,j=6,M=7,L=8,q=9,P=10,V=11,z=12,re=13,K=14,ee=15,W=16,se=17,Y=18,te=19,Q=20,ae=21,xe=22,ge=23,Me=24,Pe=25,Ie=26,Ce=27,He=28,it=29,Ge=30,Re=31,H=32,me=852,Te=592,ce=15,oe=ce;function ne(ve){return(ve>>>24&255)+(ve>>>8&65280)+((ve&65280)<<8)+((ve&255)<<24)}function Se(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Fe(ve){var Ae;return!ve||!ve.state?v:(Ae=ve.state,ve.total_in=ve.total_out=Ae.total=0,ve.msg="",Ae.wrap&&(ve.adler=Ae.wrap&1),Ae.mode=E,Ae.last=0,Ae.havedict=0,Ae.dmax=32768,Ae.head=null,Ae.hold=0,Ae.bits=0,Ae.lencode=Ae.lendyn=new e.Buf32(me),Ae.distcode=Ae.distdyn=new e.Buf32(Te),Ae.sane=1,Ae.back=-1,f)}function ke(ve){var Ae;return!ve||!ve.state?v:(Ae=ve.state,Ae.wsize=0,Ae.whave=0,Ae.wnext=0,Fe(ve))}function Xe(ve,Ae){var ue,mt;return!ve||!ve.state||(mt=ve.state,Ae<0?(ue=0,Ae=-Ae):(ue=(Ae>>4)+1,Ae<48&&(Ae&=15)),Ae&&(Ae<8||Ae>15))?v:(mt.window!==null&&mt.wbits!==Ae&&(mt.window=null),mt.wrap=ue,mt.wbits=Ae,ke(ve))}function St(ve,Ae){var ue,mt;return ve?(mt=new Se,ve.state=mt,mt.window=null,ue=Xe(ve,Ae),ue!==f&&(ve.state=null),ue):v}function ht(ve){return St(ve,oe)}var It=!0,Vt,Ot;function Gt(ve){if(It){var Ae;for(Vt=new e.Buf32(512),Ot=new e.Buf32(32),Ae=0;Ae<144;)ve.lens[Ae++]=8;for(;Ae<256;)ve.lens[Ae++]=9;for(;Ae<280;)ve.lens[Ae++]=7;for(;Ae<288;)ve.lens[Ae++]=8;for(s(a,ve.lens,0,288,Vt,0,ve.work,{bits:9}),Ae=0;Ae<32;)ve.lens[Ae++]=5;s(o,ve.lens,0,32,Ot,0,ve.work,{bits:5}),It=!1}ve.lencode=Vt,ve.lenbits=9,ve.distcode=Ot,ve.distbits=5}function be(ve,Ae,ue,mt){var wt,B=ve.state;return B.window===null&&(B.wsize=1<<B.wbits,B.wnext=0,B.whave=0,B.window=new e.Buf8(B.wsize)),mt>=B.wsize?(e.arraySet(B.window,Ae,ue-B.wsize,B.wsize,0),B.wnext=0,B.whave=B.wsize):(wt=B.wsize-B.wnext,wt>mt&&(wt=mt),e.arraySet(B.window,Ae,ue-mt,wt,B.wnext),mt-=wt,mt?(e.arraySet(B.window,Ae,ue-mt,mt,0),B.wnext=mt,B.whave=B.wsize):(B.wnext+=wt,B.wnext===B.wsize&&(B.wnext=0),B.whave<B.wsize&&(B.whave+=wt))),0}function O(ve,Ae){var ue,mt,wt,B,ze,rt,ye,we,Ue,Et,he,G,U,X,pe=0,je,Ke,bt,Kt,yn,Ht,Yt,an,qn=new e.Buf8(4),Qn,jr,Mr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ve||!ve.state||!ve.output||!ve.input&&ve.avail_in!==0)return v;ue=ve.state,ue.mode===z&&(ue.mode=re),ze=ve.next_out,wt=ve.output,ye=ve.avail_out,B=ve.next_in,mt=ve.input,rt=ve.avail_in,we=ue.hold,Ue=ue.bits,Et=rt,he=ye,an=f;e:for(;;)switch(ue.mode){case E:if(ue.wrap===0){ue.mode=re;break}for(;Ue<16;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if(ue.wrap&2&&we===35615){ue.check=0,qn[0]=we&255,qn[1]=we>>>8&255,ue.check=n(ue.check,qn,2,0),we=0,Ue=0,ue.mode=C;break}if(ue.flags=0,ue.head&&(ue.head.done=!1),!(ue.wrap&1)||(((we&255)<<8)+(we>>8))%31){ve.msg="incorrect header check",ue.mode=Ge;break}if((we&15)!==_){ve.msg="unknown compression method",ue.mode=Ge;break}if(we>>>=4,Ue-=4,Yt=(we&15)+8,ue.wbits===0)ue.wbits=Yt;else if(Yt>ue.wbits){ve.msg="invalid window size",ue.mode=Ge;break}ue.dmax=1<<Yt,ve.adler=ue.check=1,ue.mode=we&512?P:z,we=0,Ue=0;break;case C:for(;Ue<16;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if(ue.flags=we,(ue.flags&255)!==_){ve.msg="unknown compression method",ue.mode=Ge;break}if(ue.flags&57344){ve.msg="unknown header flags set",ue.mode=Ge;break}ue.head&&(ue.head.text=we>>8&1),ue.flags&512&&(qn[0]=we&255,qn[1]=we>>>8&255,ue.check=n(ue.check,qn,2,0)),we=0,Ue=0,ue.mode=k;case k:for(;Ue<32;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}ue.head&&(ue.head.time=we),ue.flags&512&&(qn[0]=we&255,qn[1]=we>>>8&255,qn[2]=we>>>16&255,qn[3]=we>>>24&255,ue.check=n(ue.check,qn,4,0)),we=0,Ue=0,ue.mode=R;case R:for(;Ue<16;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}ue.head&&(ue.head.xflags=we&255,ue.head.os=we>>8),ue.flags&512&&(qn[0]=we&255,qn[1]=we>>>8&255,ue.check=n(ue.check,qn,2,0)),we=0,Ue=0,ue.mode=I;case I:if(ue.flags&1024){for(;Ue<16;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}ue.length=we,ue.head&&(ue.head.extra_len=we),ue.flags&512&&(qn[0]=we&255,qn[1]=we>>>8&255,ue.check=n(ue.check,qn,2,0)),we=0,Ue=0}else ue.head&&(ue.head.extra=null);ue.mode=j;case j:if(ue.flags&1024&&(G=ue.length,G>rt&&(G=rt),G&&(ue.head&&(Yt=ue.head.extra_len-ue.length,ue.head.extra||(ue.head.extra=new Array(ue.head.extra_len)),e.arraySet(ue.head.extra,mt,B,G,Yt)),ue.flags&512&&(ue.check=n(ue.check,mt,G,B)),rt-=G,B+=G,ue.length-=G),ue.length))break e;ue.length=0,ue.mode=M;case M:if(ue.flags&2048){if(rt===0)break e;G=0;do Yt=mt[B+G++],ue.head&&Yt&&ue.length<65536&&(ue.head.name+=String.fromCharCode(Yt));while(Yt&&G<rt);if(ue.flags&512&&(ue.check=n(ue.check,mt,G,B)),rt-=G,B+=G,Yt)break e}else ue.head&&(ue.head.name=null);ue.length=0,ue.mode=L;case L:if(ue.flags&4096){if(rt===0)break e;G=0;do Yt=mt[B+G++],ue.head&&Yt&&ue.length<65536&&(ue.head.comment+=String.fromCharCode(Yt));while(Yt&&G<rt);if(ue.flags&512&&(ue.check=n(ue.check,mt,G,B)),rt-=G,B+=G,Yt)break e}else ue.head&&(ue.head.comment=null);ue.mode=q;case q:if(ue.flags&512){for(;Ue<16;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if(we!==(ue.check&65535)){ve.msg="header crc mismatch",ue.mode=Ge;break}we=0,Ue=0}ue.head&&(ue.head.hcrc=ue.flags>>9&1,ue.head.done=!0),ve.adler=ue.check=0,ue.mode=z;break;case P:for(;Ue<32;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}ve.adler=ue.check=ne(we),we=0,Ue=0,ue.mode=V;case V:if(ue.havedict===0)return ve.next_out=ze,ve.avail_out=ye,ve.next_in=B,ve.avail_in=rt,ue.hold=we,ue.bits=Ue,g;ve.adler=ue.check=1,ue.mode=z;case z:if(Ae===c||Ae===u)break e;case re:if(ue.last){we>>>=Ue&7,Ue-=Ue&7,ue.mode=Ce;break}for(;Ue<3;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}switch(ue.last=we&1,we>>>=1,Ue-=1,we&3){case 0:ue.mode=K;break;case 1:if(Gt(ue),ue.mode=Q,Ae===u){we>>>=2,Ue-=2;break e}break;case 2:ue.mode=se;break;case 3:ve.msg="invalid block type",ue.mode=Ge}we>>>=2,Ue-=2;break;case K:for(we>>>=Ue&7,Ue-=Ue&7;Ue<32;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if((we&65535)!==(we>>>16^65535)){ve.msg="invalid stored block lengths",ue.mode=Ge;break}if(ue.length=we&65535,we=0,Ue=0,ue.mode=ee,Ae===u)break e;case ee:ue.mode=W;case W:if(G=ue.length,G){if(G>rt&&(G=rt),G>ye&&(G=ye),G===0)break e;e.arraySet(wt,mt,B,G,ze),rt-=G,B+=G,ye-=G,ze+=G,ue.length-=G;break}ue.mode=z;break;case se:for(;Ue<14;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if(ue.nlen=(we&31)+257,we>>>=5,Ue-=5,ue.ndist=(we&31)+1,we>>>=5,Ue-=5,ue.ncode=(we&15)+4,we>>>=4,Ue-=4,ue.nlen>286||ue.ndist>30){ve.msg="too many length or distance symbols",ue.mode=Ge;break}ue.have=0,ue.mode=Y;case Y:for(;ue.have<ue.ncode;){for(;Ue<3;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}ue.lens[Mr[ue.have++]]=we&7,we>>>=3,Ue-=3}for(;ue.have<19;)ue.lens[Mr[ue.have++]]=0;if(ue.lencode=ue.lendyn,ue.lenbits=7,Qn={bits:ue.lenbits},an=s(i,ue.lens,0,19,ue.lencode,0,ue.work,Qn),ue.lenbits=Qn.bits,an){ve.msg="invalid code lengths set",ue.mode=Ge;break}ue.have=0,ue.mode=te;case te:for(;ue.have<ue.nlen+ue.ndist;){for(;pe=ue.lencode[we&(1<<ue.lenbits)-1],je=pe>>>24,Ke=pe>>>16&255,bt=pe&65535,!(je<=Ue);){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if(bt<16)we>>>=je,Ue-=je,ue.lens[ue.have++]=bt;else{if(bt===16){for(jr=je+2;Ue<jr;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if(we>>>=je,Ue-=je,ue.have===0){ve.msg="invalid bit length repeat",ue.mode=Ge;break}Yt=ue.lens[ue.have-1],G=3+(we&3),we>>>=2,Ue-=2}else if(bt===17){for(jr=je+3;Ue<jr;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}we>>>=je,Ue-=je,Yt=0,G=3+(we&7),we>>>=3,Ue-=3}else{for(jr=je+7;Ue<jr;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}we>>>=je,Ue-=je,Yt=0,G=11+(we&127),we>>>=7,Ue-=7}if(ue.have+G>ue.nlen+ue.ndist){ve.msg="invalid bit length repeat",ue.mode=Ge;break}for(;G--;)ue.lens[ue.have++]=Yt}}if(ue.mode===Ge)break;if(ue.lens[256]===0){ve.msg="invalid code -- missing end-of-block",ue.mode=Ge;break}if(ue.lenbits=9,Qn={bits:ue.lenbits},an=s(a,ue.lens,0,ue.nlen,ue.lencode,0,ue.work,Qn),ue.lenbits=Qn.bits,an){ve.msg="invalid literal/lengths set",ue.mode=Ge;break}if(ue.distbits=6,ue.distcode=ue.distdyn,Qn={bits:ue.distbits},an=s(o,ue.lens,ue.nlen,ue.ndist,ue.distcode,0,ue.work,Qn),ue.distbits=Qn.bits,an){ve.msg="invalid distances set",ue.mode=Ge;break}if(ue.mode=Q,Ae===u)break e;case Q:ue.mode=ae;case ae:if(rt>=6&&ye>=258){ve.next_out=ze,ve.avail_out=ye,ve.next_in=B,ve.avail_in=rt,ue.hold=we,ue.bits=Ue,r(ve,he),ze=ve.next_out,wt=ve.output,ye=ve.avail_out,B=ve.next_in,mt=ve.input,rt=ve.avail_in,we=ue.hold,Ue=ue.bits,ue.mode===z&&(ue.back=-1);break}for(ue.back=0;pe=ue.lencode[we&(1<<ue.lenbits)-1],je=pe>>>24,Ke=pe>>>16&255,bt=pe&65535,!(je<=Ue);){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if(Ke&&(Ke&240)===0){for(Kt=je,yn=Ke,Ht=bt;pe=ue.lencode[Ht+((we&(1<<Kt+yn)-1)>>Kt)],je=pe>>>24,Ke=pe>>>16&255,bt=pe&65535,!(Kt+je<=Ue);){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}we>>>=Kt,Ue-=Kt,ue.back+=Kt}if(we>>>=je,Ue-=je,ue.back+=je,ue.length=bt,Ke===0){ue.mode=Ie;break}if(Ke&32){ue.back=-1,ue.mode=z;break}if(Ke&64){ve.msg="invalid literal/length code",ue.mode=Ge;break}ue.extra=Ke&15,ue.mode=xe;case xe:if(ue.extra){for(jr=ue.extra;Ue<jr;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}ue.length+=we&(1<<ue.extra)-1,we>>>=ue.extra,Ue-=ue.extra,ue.back+=ue.extra}ue.was=ue.length,ue.mode=ge;case ge:for(;pe=ue.distcode[we&(1<<ue.distbits)-1],je=pe>>>24,Ke=pe>>>16&255,bt=pe&65535,!(je<=Ue);){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if((Ke&240)===0){for(Kt=je,yn=Ke,Ht=bt;pe=ue.distcode[Ht+((we&(1<<Kt+yn)-1)>>Kt)],je=pe>>>24,Ke=pe>>>16&255,bt=pe&65535,!(Kt+je<=Ue);){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}we>>>=Kt,Ue-=Kt,ue.back+=Kt}if(we>>>=je,Ue-=je,ue.back+=je,Ke&64){ve.msg="invalid distance code",ue.mode=Ge;break}ue.offset=bt,ue.extra=Ke&15,ue.mode=Me;case Me:if(ue.extra){for(jr=ue.extra;Ue<jr;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}ue.offset+=we&(1<<ue.extra)-1,we>>>=ue.extra,Ue-=ue.extra,ue.back+=ue.extra}if(ue.offset>ue.dmax){ve.msg="invalid distance too far back",ue.mode=Ge;break}ue.mode=Pe;case Pe:if(ye===0)break e;if(G=he-ye,ue.offset>G){if(G=ue.offset-G,G>ue.whave&&ue.sane){ve.msg="invalid distance too far back",ue.mode=Ge;break}G>ue.wnext?(G-=ue.wnext,U=ue.wsize-G):U=ue.wnext-G,G>ue.length&&(G=ue.length),X=ue.window}else X=wt,U=ze-ue.offset,G=ue.length;G>ye&&(G=ye),ye-=G,ue.length-=G;do wt[ze++]=X[U++];while(--G);ue.length===0&&(ue.mode=ae);break;case Ie:if(ye===0)break e;wt[ze++]=ue.length,ye--,ue.mode=ae;break;case Ce:if(ue.wrap){for(;Ue<32;){if(rt===0)break e;rt--,we|=mt[B++]<<Ue,Ue+=8}if(he-=ye,ve.total_out+=he,ue.total+=he,he&&(ve.adler=ue.check=ue.flags?n(ue.check,wt,he,ze-he):t(ue.check,wt,he,ze-he)),he=ye,(ue.flags?we:ne(we))!==ue.check){ve.msg="incorrect data check",ue.mode=Ge;break}we=0,Ue=0}ue.mode=He;case He:if(ue.wrap&&ue.flags){for(;Ue<32;){if(rt===0)break e;rt--,we+=mt[B++]<<Ue,Ue+=8}if(we!==(ue.total&4294967295)){ve.msg="incorrect length check",ue.mode=Ge;break}we=0,Ue=0}ue.mode=it;case it:an=m;break e;case Ge:an=b;break e;case Re:return w;case H:default:return v}return ve.next_out=ze,ve.avail_out=ye,ve.next_in=B,ve.avail_in=rt,ue.hold=we,ue.bits=Ue,(ue.wsize||he!==ve.avail_out&&ue.mode<Ge&&(ue.mode<Ce||Ae!==l))&&be(ve,ve.output,ve.next_out,he-ve.avail_out),Et-=ve.avail_in,he-=ve.avail_out,ve.total_in+=Et,ve.total_out+=he,ue.total+=he,ue.wrap&&he&&(ve.adler=ue.check=ue.flags?n(ue.check,wt,he,ve.next_out-he):t(ue.check,wt,he,ve.next_out-he)),ve.data_type=ue.bits+(ue.last?64:0)+(ue.mode===z?128:0)+(ue.mode===Q||ue.mode===ee?256:0),(Et===0&&he===0||Ae===l)&&an===f&&(an=x),an}function Z(ve){if(!ve||!ve.state)return v;var Ae=ve.state;return Ae.window&&(Ae.window=null),ve.state=null,f}function fe(ve,Ae){var ue;return!ve||!ve.state||(ue=ve.state,(ue.wrap&2)===0)?v:(ue.head=Ae,Ae.done=!1,f)}function Oe(ve,Ae){var ue=Ae.length,mt,wt,B;return!ve||!ve.state||(mt=ve.state,mt.wrap!==0&&mt.mode!==V)?v:mt.mode===V&&(wt=1,wt=t(wt,Ae,ue,0),wt!==mt.check)?b:(B=be(ve,Ae,ue,ue),B?(mt.mode=Re,w):(mt.havedict=1,f))}return Ka.inflateReset=ke,Ka.inflateReset2=Xe,Ka.inflateResetKeep=Fe,Ka.inflateInit=ht,Ka.inflateInit2=St,Ka.inflate=O,Ka.inflateEnd=Z,Ka.inflateGetHeader=fe,Ka.inflateSetDictionary=Oe,Ka.inflateInfo="pako inflate (from Nodeca project)",Ka}var WC,GO;function s$(){return GO||(GO=1,WC={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),WC}var ZC,KO;function Ice(){if(KO)return ZC;KO=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return ZC=e,ZC}var WO;function jce(){if(WO)return Zh;WO=1;var e=Nce(),t=xd(),n=n$(),r=s$(),s=wN(),i=r$(),a=Ice(),o=Object.prototype.toString;function l(f){if(!(this instanceof l))return new l(f);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},f||{});var m=this.options;m.raw&&m.windowBits>=0&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),m.windowBits>=0&&m.windowBits<16&&!(f&&f.windowBits)&&(m.windowBits+=32),m.windowBits>15&&m.windowBits<48&&(m.windowBits&15)===0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var g=e.inflateInit2(this.strm,m.windowBits);if(g!==r.Z_OK)throw new Error(s[g]);if(this.header=new a,e.inflateGetHeader(this.strm,this.header),m.dictionary&&(typeof m.dictionary=="string"?m.dictionary=n.string2buf(m.dictionary):o.call(m.dictionary)==="[object ArrayBuffer]"&&(m.dictionary=new Uint8Array(m.dictionary)),m.raw&&(g=e.inflateSetDictionary(this.strm,m.dictionary),g!==r.Z_OK)))throw new Error(s[g])}l.prototype.push=function(f,m){var g=this.strm,v=this.options.chunkSize,b=this.options.dictionary,w,x,_,E,C,k=!1;if(this.ended)return!1;x=m===~~m?m:m===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof f=="string"?g.input=n.binstring2buf(f):o.call(f)==="[object ArrayBuffer]"?g.input=new Uint8Array(f):g.input=f,g.next_in=0,g.avail_in=g.input.length;do{if(g.avail_out===0&&(g.output=new t.Buf8(v),g.next_out=0,g.avail_out=v),w=e.inflate(g,r.Z_NO_FLUSH),w===r.Z_NEED_DICT&&b&&(w=e.inflateSetDictionary(this.strm,b)),w===r.Z_BUF_ERROR&&k===!0&&(w=r.Z_OK,k=!1),w!==r.Z_STREAM_END&&w!==r.Z_OK)return this.onEnd(w),this.ended=!0,!1;g.next_out&&(g.avail_out===0||w===r.Z_STREAM_END||g.avail_in===0&&(x===r.Z_FINISH||x===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(_=n.utf8border(g.output,g.next_out),E=g.next_out-_,C=n.buf2string(g.output,_),g.next_out=E,g.avail_out=v-E,E&&t.arraySet(g.output,g.output,_,E,0),this.onData(C)):this.onData(t.shrinkBuf(g.output,g.next_out))),g.avail_in===0&&g.avail_out===0&&(k=!0)}while((g.avail_in>0||g.avail_out===0)&&w!==r.Z_STREAM_END);return w===r.Z_STREAM_END&&(x=r.Z_FINISH),x===r.Z_FINISH?(w=e.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===r.Z_OK):(x===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),g.avail_out=0),!0)},l.prototype.onData=function(f){this.chunks.push(f)},l.prototype.onEnd=function(f){f===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg};function c(f,m){var g=new l(m);if(g.push(f,!0),g.err)throw g.msg||s[g.err];return g.result}function u(f,m){return m=m||{},m.raw=!0,c(f,m)}return Zh.Inflate=l,Zh.inflate=c,Zh.inflateRaw=u,Zh.ungzip=c,Zh}var YC,ZO;function Mce(){if(ZO)return YC;ZO=1;var e=xd().assign,t=Tce(),n=jce(),r=s$(),s={};return e(s,t,n,r),YC=s,YC}var Oce=Mce();const xN=Ni(Oce);var XC,YO;function Pce(){if(YO)return XC;YO=1;const e=(t,n)=>function(...r){const s=n.promiseModule;return new s((i,a)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?a(o):(o.shift(),i(o)):i(o)}):n.errorFirst?r.push((o,l)=>{o?a(o):i(l)}):r.push(i),t.apply(this,r)})};return XC=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const s=a=>{const o=l=>typeof l=="string"?a===l:l.test(a);return n.include?n.include.some(o):!n.exclude.some(o)};let i;r==="function"?i=function(...a){return n.excludeMain?t(...a):e(t,n).apply(this,a)}:i=Object.create(Object.getPrototypeOf(t));for(const a in t){const o=t[a];i[a]=typeof o=="function"&&s(a)?e(o,n):o}return i},XC}var Dce=Pce();const JC=Ni(Dce);var QC,XO;function Fce(){if(XO)return QC;XO=1;var e={};function t(ee){return Array.isArray(ee)?ee:[ee]}const n="",r=" ",s="\\",i=/^\s+$/,a=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,c=/\r?\n/g,u=/^\.*\/|^\.+$/,f="/";let m="node-ignore";typeof Symbol<"u"&&(m=Symbol.for("node-ignore"));const g=m,v=(ee,W,se)=>Object.defineProperty(ee,W,{value:se}),b=/([0-z])-([0-z])/g,w=()=>!1,x=ee=>ee.replace(b,(W,se,Y)=>se.charCodeAt(0)<=Y.charCodeAt(0)?W:n),_=ee=>{const{length:W}=ee;return ee.slice(0,W-W%2)},E=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(ee,W,se)=>W+(se.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(ee,W)=>{const{length:se}=W;return W.slice(0,se-se%2)+r}],[/[\\$.|*+(){^]/g,ee=>`\\${ee}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(ee,W,se)=>W+6<se.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(ee,W,se)=>{const Y=se.replace(/\\\*/g,"[^\\/]*");return W+Y}],[/\\\\\\(?=[$.|*+(){^])/g,()=>s],[/\\\\/g,()=>s],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(ee,W,se,Y,te)=>W===s?`\\[${se}${_(Y)}${te}`:te==="]"&&Y.length%2===0?`[${x(se)}${Y}]`:"[]"],[/(?:[^*])$/,ee=>/\/$/.test(ee)?`${ee}$`:`${ee}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(ee,W)=>`${W?`${W}[^/]+`:"[^/]*"}(?=$|\\/$)`]],C=Object.create(null),k=(ee,W)=>{let se=C[ee];return se||(se=E.reduce((Y,[te,Q])=>Y.replace(te,Q.bind(ee)),ee),C[ee]=se),W?new RegExp(se,"i"):new RegExp(se)},R=ee=>typeof ee=="string",I=ee=>ee&&R(ee)&&!i.test(ee)&&!a.test(ee)&&ee.indexOf("#")!==0,j=ee=>ee.split(c);class M{constructor(W,se,Y,te){this.origin=W,this.pattern=se,this.negative=Y,this.regex=te}}const L=(ee,W)=>{const se=ee;let Y=!1;ee.indexOf("!")===0&&(Y=!0,ee=ee.substr(1)),ee=ee.replace(o,"!").replace(l,"#");const te=k(ee,W);return new M(se,ee,Y,te)},q=(ee,W)=>{throw new W(ee)},P=(ee,W,se)=>R(ee)?ee?P.isNotRelative(ee)?se(`path should be a \`path.relative()\`d string, but got "${W}"`,RangeError):!0:se("path must not be empty",TypeError):se(`path must be a string, but got \`${W}\``,TypeError),V=ee=>u.test(ee);P.isNotRelative=V,P.convert=ee=>ee;class z{constructor({ignorecase:W=!0,ignoreCase:se=W,allowRelativePaths:Y=!1}={}){v(this,g,!0),this._rules=[],this._ignoreCase=se,this._allowRelativePaths=Y,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(W){if(W&&W[g]){this._rules=this._rules.concat(W._rules),this._added=!0;return}if(I(W)){const se=L(W,this._ignoreCase);this._added=!0,this._rules.push(se)}}add(W){return this._added=!1,t(R(W)?j(W):W).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(W){return this.add(W)}_testOne(W,se){let Y=!1,te=!1;return this._rules.forEach(Q=>{const{negative:ae}=Q;if(te===ae&&Y!==te||ae&&!Y&&!te&&!se)return;Q.regex.test(W)&&(Y=!ae,te=ae)}),{ignored:Y,unignored:te}}_test(W,se,Y,te){const Q=W&&P.convert(W);return P(Q,W,this._allowRelativePaths?w:q),this._t(Q,se,Y,te)}_t(W,se,Y,te){if(W in se)return se[W];if(te||(te=W.split(f)),te.pop(),!te.length)return se[W]=this._testOne(W,Y);const Q=this._t(te.join(f)+f,se,Y,te);return se[W]=Q.ignored?Q:this._testOne(W,Y)}ignores(W){return this._test(W,this._ignoreCache,!1).ignored}createFilter(){return W=>!this.ignores(W)}filter(W){return t(W).filter(this.createFilter())}test(W){return this._test(W,this._testCache,!0)}}const re=ee=>new z(ee),K=ee=>P(ee&&P.convert(ee),ee,w);if(re.isPathValid=K,re.default=re,QC=re,typeof vs<"u"&&(e&&e.IGNORE_TEST_WIN32||vs.platform==="win32")){const ee=se=>/^\\\\\?\\/.test(se)||/["<>|\u0000-\u001F]+/u.test(se)?se:se.replace(/\\/g,"/");P.convert=ee;const W=/^[a-z]:\//i;P.isNotRelative=se=>W.test(se)||V(se)}return QC}var Lce=Fce();const Bce=Ni(Lce);var ek,JO;function $ce(){if(JO)return ek;JO=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,s,i){return s=s instanceof RegExp?s:new RegExp(e(s),"g"),r.replace(s,i)}var n={clean:function(s){if(typeof s!="string")throw new Error("Expected a string, received: "+s);return s=t(s,"./","/"),s=t(s,"..","."),s=t(s," ","-"),s=t(s,/^[~^:?*\\\-]/g,""),s=t(s,/[~^:?*\\]/g,"-"),s=t(s,/[~^:?*\\\-]$/g,""),s=t(s,"@{","-"),s=t(s,/\.$/g,""),s=t(s,/\/$/g,""),s=t(s,/\.lock$/g,""),s}};return ek=n,ek}var zce=$ce();const Sl=Ni(zce);var tk,QO;function Uce(){return QO||(QO=1,tk=function(e,t){var n=e,r=t,s=n.length,i=r.length,a=!1,o=null,l=s+1,c=[],u=[],f=[],m="",g=-1,v=0,b=1,w,x,_=function(){s>=i&&(w=n,x=s,n=r,r=w,s=i,i=x,a=!0,l=s+1)},E=function(I,j,M){return{x:I,y:j,k:M}},C=function(I,j){return{elem:I,t:j}},k=function(I,j,M){var L,q,P;for(j>M?L=c[I-1+l]:L=c[I+1+l],P=Math.max(j,M),q=P-I;q<s&&P<i&&n[q]===r[P];)++q,++P;return c[I+l]=u.length,u[u.length]=new E(q,P,L),P},R=function(I){var j,M,L;for(j=M=0,L=I.length-1;L>=0;--L)for(;j<I[L].x||M<I[L].y;)I[L].y-I[L].x>M-j?(a?f[f.length]=new C(r[M],g):f[f.length]=new C(r[M],b),++M):I[L].y-I[L].x<M-j?(a?f[f.length]=new C(n[j],b):f[f.length]=new C(n[j],g),++j):(f[f.length]=new C(n[j],v),m+=n[j],++j,++M)};return _(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return m},getses:function(){return f},compose:function(){var I,j,M,L,q,P,V,z;for(I=i-s,j=s+i+3,M={},V=0;V<j;++V)M[V]=-1,c[V]=-1;L=-1;do{for(++L,z=-L;z<=I-1;++z)M[z+l]=k(z,M[z-1+l]+1,M[z+1+l]);for(z=I+L;z>=I+1;--z)M[z+l]=k(z,M[z-1+l]+1,M[z+1+l]);M[I+l]=k(I,M[I-1+l]+1,M[I+1+l])}while(M[I+l]!==i);for(o=I+2*L,q=c[I+l],P=[];q!==-1;)P[P.length]=new E(u[q].x,u[q].y,null),q=u[q].k;R(P)}}}),tk}var nk,eP;function qce(){if(eP)return nk;eP=1;var e=Uce();function t(i,a){var o=new e(i,a);o.compose();for(var l=o.getses(),c,u,f=i.length-1,m=a.length-1,g=l.length-1;g>=0;--g)l[g].t===o.SES_COMMON?(u?(u.chain={file1index:f,file2index:m,chain:null},u=u.chain):(c={file1index:f,file2index:m,chain:null},u=c),f--,m--):l[g].t===o.SES_DELETE?f--:l[g].t===o.SES_ADD&&m--;var v={file1index:-1,file2index:-1,chain:null};return u?(u.chain=v,c):v}function n(i,a){for(var o=[],l=i.length,c=a.length,u=t(i,a);u!==null;u=u.chain){var f=l-u.file1index-1,m=c-u.file2index-1;l=u.file1index,c=u.file2index,(f||m)&&o.push({file1:[l+1,f],file2:[c+1,m]})}return o.reverse(),o}function r(i,a,o){var l,c=n(a,i),u=n(a,o),f=[];function m(W,se){f.push([W.file1[0],se,W.file1[1],W.file2[0],W.file2[1]])}for(l=0;l<c.length;l++)m(c[l],0);for(l=0;l<u.length;l++)m(u[l],2);f.sort(function(W,se){return W[0]-se[0]});var g=[],v=0;function b(W){W>v&&(g.push([1,v,W-v]),v=W)}for(var w=0;w<f.length;w++){for(var x=w,_=f[w],E=_[0],C=E+_[2];w<f.length-1;){var k=f[w+1],R=k[0];if(R>C)break;C=Math.max(C,R+k[2]),w++}if(b(E),x==w)_[4]>0&&g.push([_[1],_[3],_[4]]);else{var I={0:[i.length,-1,a.length,-1],2:[o.length,-1,a.length,-1]};for(l=x;l<=w;l++){_=f[l];var j=_[1],M=I[j],L=_[0],q=L+_[2],P=_[3],V=P+_[4];M[0]=Math.min(P,M[0]),M[1]=Math.max(V,M[1]),M[2]=Math.min(L,M[2]),M[3]=Math.max(q,M[3])}var z=I[0][0]+(E-I[0][2]),re=I[0][1]+(C-I[0][3]),K=I[2][0]+(E-I[2][2]),ee=I[2][1]+(C-I[2][3]);g.push([-1,z,re-z,E,C-E,K,ee-K])}v=C}return b(a.length),g}function s(i,a,o){var l=[],c=[i,a,o],u=r(i,a,o),f=[];function m(){f.length&&l.push({ok:f}),f=[]}function g(_){for(var E=0;E<_.length;E++)f.push(_[E])}function v(_){if(_[2]!=_[6])return!0;for(var E=_[1],C=_[5],k=0;k<_[2];k++)if(i[k+E]!=o[k+C])return!0;return!1}for(var b=0;b<u.length;b++){var w=u[b],x=w[0];x==-1?v(w)?(m(),l.push({conflict:{a:i.slice(w[1],w[1]+w[2]),aIndex:w[1],o:a.slice(w[3],w[3]+w[4]),oIndex:w[3],b:o.slice(w[5],w[5]+w[6]),bIndex:w[5]}})):g(c[0].slice(w[1],w[1]+w[2])):g(c[x].slice(w[1],w[1]+w[2]))}return m(),l}return nk=s,nk}var Vce=qce();const Hce=Ni(Vce);class yr extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new yr(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class rb extends yr{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=rb.code,this.data={filepaths:t}}}rb.code="UnmergedPathsError";class $n extends yr{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=$n.code,this.data={message:t}}}$n.code="InternalError";class vm extends yr{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=vm.code,this.data={filepath:t}}}vm.code="UnsafeFilepathError";class xl{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const s=this.buffer.write(t,this._start,n,r);return this._start+=n,s}copy(t,n,r){const s=t.copy(this.buffer,this._start,n,r);return this._start+=s,s}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function S_(e,t){return-(e<t)||+(e>t)}function i$(e,t){return S_(e.path,t.path)}function a$(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const hl=2**32;function tP(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const s=Math.floor(n/1e3),i=(n-s*1e3)*1e6;return[s,i]}function $p(e){const[t,n]=tP(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,s]=tP(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%hl,ctimeNanoseconds:n%hl,mtimeSeconds:r%hl,mtimeNanoseconds:s%hl,dev:e.dev%hl,ino:e.ino%hl,mode:a$(e.mode%hl),uid:e.uid%hl,gid:e.gid%hl,size:e.size>-1?e.size%hl:0}}function Gce(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let rk=null;async function Pc(e){return rk===null&&(rk=await Wce()),rk?o$(e):Kce(e)}function Kce(e){return new QB().update(e).digest("hex")}async function o$(e){const t=await crypto.subtle.digest("SHA-1",e);return Gce(t)}async function Wce(){try{if(await o$(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function Zce(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function Yce(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(Xt.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class df{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(Xt.isBuffer(t))return df.fromBuffer(t);if(t===null)return new df(null);throw new $n("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new $n("Index file is empty (.git/index)");const n=new df,r=new xl(t),s=r.toString("utf8",4);if(s!=="DIRC")throw new $n(`Invalid dircache magic file number: ${s}`);const i=await Pc(t.slice(0,-20)),a=t.slice(-20).toString("hex");if(a!==i)throw new $n(`Invalid checksum in GitIndex buffer: expected ${a} but saw ${i}`);const o=r.readUInt32BE();if(o!==2)throw new $n(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let c=0;for(;!r.eof()&&c<l;){const u={};u.ctimeSeconds=r.readUInt32BE(),u.ctimeNanoseconds=r.readUInt32BE(),u.mtimeSeconds=r.readUInt32BE(),u.mtimeNanoseconds=r.readUInt32BE(),u.dev=r.readUInt32BE(),u.ino=r.readUInt32BE(),u.mode=r.readUInt32BE(),u.uid=r.readUInt32BE(),u.gid=r.readUInt32BE(),u.size=r.readUInt32BE(),u.oid=r.slice(20).toString("hex");const f=r.readUInt16BE();u.flags=Zce(f);const m=t.indexOf(0,r.tell()+1)-r.tell();if(m<1)throw new $n(`Got a path length of: ${m}`);if(u.path=r.toString("utf8",m),u.path.includes("..\\")||u.path.includes("../"))throw new vm(u.path);let g=8-(r.tell()-12)%8;for(g===0&&(g=8);g--;){const v=r.readUInt8();if(v!==0)throw new $n(`Expected 1-8 null characters but got '${v}' after ${u.path}`);if(r.eof())throw new $n("Unexpected end of file")}u.stages=[],n._addEntry(u),c++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(i$)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:s=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=$p(n);const i=Xt.from(t),a={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:s,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(a),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=Xt.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,s=Xt.alloc(r),i=new xl(s),a=$p(t);return i.writeUInt32BE(a.ctimeSeconds),i.writeUInt32BE(a.ctimeNanoseconds),i.writeUInt32BE(a.mtimeSeconds),i.writeUInt32BE(a.mtimeNanoseconds),i.writeUInt32BE(a.dev),i.writeUInt32BE(a.ino),i.writeUInt32BE(a.mode),i.writeUInt32BE(a.uid),i.writeUInt32BE(a.gid),i.writeUInt32BE(a.size),i.write(t.oid,20,"hex"),i.writeUInt16BE(Yce(t)),i.write(t.path,n.length,"utf8"),s}async toObject(){const t=Xt.alloc(12),n=new xl(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(df._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(df._entryToBuffer(l));r=await Promise.all(r);const s=Xt.concat(r),i=Xt.concat([t,s]),a=await Pc(i);return Xt.concat([i,Xt.from(a,"hex")])}}function Wx(e,t,n=!0,r=!0){const s=$p(e),i=$p(t);return n&&s.mode!==i.mode||s.mtimeSeconds!==i.mtimeSeconds||s.ctimeSeconds!==i.ctimeSeconds||s.uid!==i.uid||s.gid!==i.gid||r&&s.ino!==i.ino||s.size!==i.size}let sk=null;const ik=Symbol("IndexCache");function Xce(){return{map:new Map,stats:new Map}}async function Jce(e,t,n){const[r,s]=await Promise.all([e.lstat(t),e.read(t)]),i=await df.from(s);n.map.set(t,i),n.stats.set(t,r)}async function Qce(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const s=await e.lstat(t);return s===null?!1:Wx(r,s)}class ei{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:s=!0},i){r[ik]||(r[ik]=Xce());const a=`${n}/index`;sk===null&&(sk=new sy({maxPending:1/0}));let o,l=[];return await sk.acquire(a,async()=>{const c=r[ik];await Qce(t,a,c)&&await Jce(t,a,c);const u=c.map.get(a);if(l=u.unmergedPaths,l.length&&!s)throw new rb(l);if(o=await i(u),u._dirty){const f=await u.toObject();await t.write(a,f),c.stats.set(a,await t.lstat(a)),u._dirty=!1}}),o}}function Zx(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function zp(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function l$(e){const t=new Map,n=function(s){if(!t.has(s)){const i={type:"tree",fullpath:s,basename:Zx(s),metadata:{},children:[]};t.set(s,i),i.parent=n(zp(s)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return t.get(s)},r=function(s,i){if(!t.has(s)){const a={type:"blob",fullpath:s,basename:Zx(s),metadata:i,parent:n(zp(s)),children:[]};a.parent&&a.parent.children.push(a),t.set(s,a)}return t.get(s)};n(".");for(const s of e)r(s.path,s);return t}function eue(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new $n(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class tue{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=ei.acquire({fs:t,gitdir:n,cache:r},async function(i){return l$(i.entries)});const s=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,s=(await this.treePromise).get(n);if(!s||s.type==="blob")return null;if(s.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const i=s.children.map(a=>a.fullpath);return i.sort(S_),i}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const s=r.type==="tree"?{}:$p(r.metadata);t._type=r.type==="tree"?"tree":eue(s.mode),t._mode=s.mode,r.type==="tree"?t._stat=void 0:t._stat=s}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const E_=Symbol("GitWalkSymbol");function wm(){const e=Object.create(null);return Object.defineProperty(e,E_,{value:function({fs:t,gitdir:n,cache:r}){return new tue({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class Br extends yr{constructor(t){super(`Could not find ${t}.`),this.code=this.name=Br.code,this.data={what:t}}}Br.code="NotFoundError";class Ki extends yr{constructor(t,n,r,s){super(`Object ${t} ${s?`at ${s}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=Ki.code,this.data={oid:t,actual:n,expected:r,filepath:s}}}Ki.code="ObjectTypeError";class td extends yr{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=td.code,this.data={value:t}}}td.code="InvalidOidError";class sb extends yr{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=sb.code,this.data={remote:t}}}sb.code="NoRefspecError";class Yx{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const s=r.indexOf(" ");if(r.startsWith("^")){const i=r.slice(1);return this.refs.set(n+"^{}",i),{line:r,ref:n,peeled:i}}else{const i=r.slice(0,s);return n=r.slice(s+1),this.refs.set(n,i),{line:r,ref:n,oid:i}}})}return this}static from(t){return new Yx(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class Xx{constructor({remotePath:t,localPath:n,force:r,matchPrefix:s}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:s})}static from(t){const[n,r,s,i,a]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=s==="*";if(l!==(a==="*"))throw new $n("Invalid refspec");return new Xx({remotePath:r,localPath:i,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class _N{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(Xx.from(r));return new _N(n)}add(t){const n=Xx.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const s of t){const i=r.translate(s);i&&n.push([s,i])}return n}translateOne(t){let n=null;for(const r of this.rules){const s=r.translate(t);s&&(n=s)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function nue(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),s=-(n<r)||+(n>r);return s===0?e.endsWith("^{}")?1:-1:s}const rue=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},Wg=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},nP={core:{filemode:Wg,bare:Wg,logallrefupdates:Wg,symlinks:Wg,ignorecase:Wg,bigFileThreshold:rue}},sue=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,iue=/^[A-Za-z0-9-.]+$/,aue=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,oue=/^[A-Za-z][A-Za-z-]*$/,lue=/^(.*?)( *[#;].*)$/,cue=e=>{const t=sue.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},uue=e=>{const t=aue.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),s=due(r),i=fue(s);return[n,i]}return null},due=e=>{const t=lue.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return rP(n)&&rP(r)?`${n}${r}`:n},rP=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,fue=e=>e.split("").reduce((t,n,r,s)=>{const i=n==='"'&&s[r-1]!=="\\",a=n==="\\"&&s[r+1]==='"';return i||a?t:t+n},""),sP=e=>e!=null?e.toLowerCase():null,sA=(e,t,n)=>[sP(e),t,sP(n)].filter(r=>r!=null).join("."),iP=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),s=t.length?t.join("."):void 0;return{section:n,subsection:s,name:r,path:sA(n,s,r),sectionPath:sA(n,s,null),isSection:!!n}},hue=(e,t)=>e.reduce((n,r,s)=>t(r)?s:n,-1);class SN{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(s=>{let i=null,a=null;const o=s.trim(),l=cue(o),c=l!=null;if(c)[n,r]=l;else{const f=uue(o);f!=null&&([i,a]=f)}const u=sA(n,r,i);return{line:s,isSection:c,section:n,subsection:r,name:i,value:a,path:u}}):[]}static from(t){return new SN(t)}async get(t,n=!1){const r=iP(t).path,s=this.parsedConfig.filter(i=>i.path===r).map(({section:i,name:a,value:o})=>{const l=nP[i]&&nP[i][a];return l?l(o):o});return n?s:s.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:s,subsection:i,name:a,path:o,sectionPath:l,isSection:c}=iP(t),u=hue(this.parsedConfig,f=>f.path===o);if(n==null)u!==-1&&this.parsedConfig.splice(u,1);else if(u!==-1){const f=this.parsedConfig[u],m=Object.assign({},f,{name:a,value:n,modified:!0});r?this.parsedConfig.splice(u+1,0,m):this.parsedConfig[u]=m}else{const f=this.parsedConfig.findIndex(g=>g.path===l),m={section:s,subsection:i,name:a,value:n,modified:!0,path:o};if(iue.test(s)&&oue.test(a))if(f>=0)this.parsedConfig.splice(f+1,0,m);else{const g={isSection:c,section:s,subsection:i,modified:!0,path:l};this.parsedConfig.push(g,m)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:s,value:i,modified:a=!1})=>a?s!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${s} = "${i}"`:`	${s} = ${i}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class Ms{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return SN.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const gw=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],pue=["config","description","index","shallow","commondir"];let ak;async function Au(e,t){return ak===void 0&&(ak=new sy),ak.acquire(e,t)}class Lt{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:s,symrefs:i,tags:a,refspecs:o=void 0,prune:l=!1,pruneTags:c=!1}){for(const w of s.values())if(!w.match(/[0-9a-f]{40}/))throw new td(w);const u=await Ms.get({fs:t,gitdir:n});if(!o){if(o=await u.getall(`remote.${r}.fetch`),o.length===0)throw new sb(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const f=_N.from(o),m=new Map;if(c){const w=await Lt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await Lt.deleteRefs({fs:t,gitdir:n,refs:w.map(x=>`refs/tags/${x}`)})}if(a){for(const w of s.keys())if(w.startsWith("refs/tags")&&!w.endsWith("^{}")&&!await Lt.exists({fs:t,gitdir:n,ref:w})){const x=s.get(w);m.set(w,x)}}const g=f.translate([...s.keys()]);for(const[w,x]of g){const _=s.get(w);m.set(x,_)}const v=f.translate([...i.keys()]);for(const[w,x]of v){const _=i.get(w),E=f.translateOne(_);E&&m.set(x,`ref: ${E}`)}const b=[];if(l){for(const w of f.localNamespaces()){const x=(await Lt.listRefs({fs:t,gitdir:n,filepath:w})).map(_=>`${w}/${_}`);for(const _ of x)m.has(_)||b.push(_)}b.length>0&&await Lt.deleteRefs({fs:t,gitdir:n,refs:b})}for(const[w,x]of m)await Au(w,async()=>t.write(Mt.join(n,w),`${x.trim()}
`,"utf8"));return{pruned:b}}static async writeRef({fs:t,gitdir:n,ref:r,value:s}){if(!s.match(/[0-9a-f]{40}/))throw new td(s);await Au(r,async()=>t.write(Mt.join(n,r),`${s.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:s}){await Au(r,async()=>t.write(Mt.join(n,r),`ref: ${s.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return Lt.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm(Mt.join(n,o))));let s=await Au("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const i=Yx.from(s),a=i.refs.size;for(const o of r)i.refs.has(o)&&i.delete(o);i.refs.size<a&&(s=i.toString(),await Au("packed-refs",async()=>t.write(`${n}/packed-refs`,s,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:s=void 0}){if(s!==void 0&&(s--,s===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),Lt.resolve({fs:t,gitdir:n,ref:r,depth:s});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await Lt.packedRefs({fs:t,gitdir:n}),a=gw(r).filter(o=>!pue.includes(o));for(const o of a){const l=await Au(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||i.get(o));if(l)return Lt.resolve({fs:t,gitdir:n,ref:l.trim(),depth:s})}throw new Br(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await Lt.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const s=await Lt.packedRefs({fs:t,gitdir:n}),i=gw(r);for(const a of i)if(await Au(a,async()=>t.exists(`${n}/${a}`))||s.has(a))return a;throw new Br(r)}static async expandAgainstMap({ref:t,map:n}){const r=gw(t);for(const s of r)if(await n.has(s))return s;throw new Br(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:s}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),Lt.resolveAgainstMap({ref:t,fullref:n,depth:r,map:s});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const i=gw(t);for(const a of i){const o=s.get(a);if(o)return Lt.resolveAgainstMap({ref:o.trim(),fullref:a,depth:r,map:s})}throw new Br(t)}static async packedRefs({fs:t,gitdir:n}){const r=await Au("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return Yx.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const s=Lt.packedRefs({fs:t,gitdir:n});let i=null;try{i=await t.readdirDeep(`${n}/${r}`),i=i.map(a=>a.replace(`${n}/${r}/`,""))}catch{i=[]}for(let a of(await s).keys())a.startsWith(r)&&(a=a.replace(r+"/",""),i.includes(a)||i.push(a));return i.sort(nue),i}static async listBranches({fs:t,gitdir:n,remote:r}){return r?Lt.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):Lt.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await Lt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(s=>!s.endsWith("^{}"))}}function mue(e,t){return S_(aP(e),aP(t))}function aP(e){return e.mode==="040000"?e.path+"/":e.path}function c$(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new $n(`Unexpected GitTree entry mode: ${e}`)}function gue(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new $n(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const s=e.indexOf(0,n);if(s===-1)throw new $n(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let i=e.slice(n,r).toString("utf8");i==="40000"&&(i="040000");const a=c$(i),o=e.slice(r+1,s).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new vm(o);const l=e.slice(s+1,s+21).toString("hex");n=s+21,t.push({mode:i,path:o,oid:l,type:a})}return t}function yue(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new $n(`Could not understand file mode: ${e}`)}function bue(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=yue(e.mode),e.type||(e.type=c$(e.mode)),e}class ca{constructor(t){if(Xt.isBuffer(t))this._entries=gue(t);else if(Array.isArray(t))this._entries=t.map(bue);else throw new $n("invalid type passed to GitTree constructor");this._entries.sort(i$)}static from(t){return new ca(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(mue),Xt.concat(t.map(n=>{const r=Xt.from(n.mode.replace(/^0/,"")),s=Xt.from(" "),i=Xt.from(n.path,"utf8"),a=Xt.from([0]),o=Xt.from(n.oid,"hex");return Xt.concat([r,s,i,a,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class xm{static wrap({type:t,object:n}){return Xt.concat([Xt.from(`${t} ${n.byteLength.toString()}\0`),Xt.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),s=t.slice(0,n).toString("utf8"),i=t.slice(n+1,r).toString("utf8"),a=t.length-(r+1);if(parseInt(i)!==a)throw new $n(`Length mismatch: expected ${i} bytes but got ${a} instead.`);return{type:s,object:Xt.from(t.slice(r+1))}}}async function u$({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,s=await e.read(`${t}/${r}`);return s?{object:s,format:"deflated",source:r}:null}function vue(e,t){const n=new xl(e),r=oP(n);if(r!==t.byteLength)throw new $n(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const s=oP(n);let i;const a=cP(n,t);if(a.byteLength===s)i=a;else{i=Xt.alloc(s);const o=new xl(i);for(o.copy(a);!n.eof();)o.copy(cP(n,t));const l=o.tell();if(s!==l)throw new $n(`applyDelta expected target buffer to be ${s} bytes but the resulting buffer was ${l} bytes`)}return i}function oP(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function lP(e,t,n){let r=0,s=0;for(;n--;)t&1&&(r|=e.readUInt8()<<s),t>>=1,s+=8;return r}function cP(e,t){const n=e.readUInt8(),r=128,s=15,i=112;if(n&r){const a=lP(e,n&s,4);let o=lP(e,(n&i)>>4,3);return o===0&&(o=65536),t.slice(a,a+o)}else return e.slice(n)}function wue(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function d$(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:wue(e)}class f${constructor(t){if(typeof Xt>"u")throw new Error("Missing Buffer dependency");this.stream=d$(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?Xt.alloc(0):(n&&(n=Xt.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>xue(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=Xt.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function xue(e){return e.reduce((t,n)=>t+n.length,0)}async function _ue(e,t){const n=new f$(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new $n(`Invalid PACK header '${r}'`);let s=await n.read(4);if(s=s.readUInt32BE(0),s!==2)throw new $n(`Invalid packfile version: ${s}`);let i=await n.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!n.eof()&&i--;){const a=n.tell(),{type:o,length:l,ofs:c,reference:u}=await Sue(n),f=new xN.Inflate;for(;!f.result;){const m=await n.chunk();if(!m)break;if(f.push(m,!1),f.err)throw new $n(`Pako error: ${f.msg}`);if(f.result){if(f.result.length!==l)throw new $n("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(m.length-f.strm.avail_in);const g=n.tell();await t({data:f.result,type:o,num:i,offset:a,end:g,reference:u,ofs:c})}}}}async function Sue(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let a=4;do t=await e.byte(),r|=(t&127)<<a,a+=7;while(t&128)}let s,i;if(n===6){let a=0;s=0;const o=[];do t=await e.byte(),s|=(t&127)<<a,a+=7,o.push(t);while(t&128);i=Xt.from(o)}return n===7&&(i=await e.read(20)),{type:n,length:r,ofs:s,reference:i}}async function h$(e){return xN.inflate(e)}function Eue(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const s=n&127;t.push(s),r=n&128}while(r);return t.reduce((s,i)=>s+1<<7|i,-1)}function Cue(e,t){let n=t,r=4,s=null;do s=e.readUInt8(),n|=(s&127)<<r,r+=7;while(s&128);return n}class Up{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new xl(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const i=r.readUInt32BE();if(i!==2)throw new $n(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new $n("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const a=r.readUInt32BE(),o=[];for(let u=0;u<a;u++){const f=r.slice(20).toString("hex");o[u]=f}r.seek(r.tell()+4*a);const l=new Map;for(let u=0;u<a;u++)l.set(o[u],r.readUInt32BE());const c=r.slice(20).toString("hex");return new Up({hashes:o,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const s={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},a=t.slice(-20).toString("hex"),o=[],l={},c=new Map;let u=null,f=null;await _ue([t],async({data:w,type:x,reference:_,offset:E,num:C})=>{u===null&&(u=C);const k=Math.floor((u-C)*100/u);k!==f&&r&&await r({phase:"Receiving objects",loaded:u-C,total:u}),f=k,x=s[x],["commit","tree","blob","tag"].includes(x)?i[E]={type:x,offset:E}:x==="ofs-delta"?i[E]={type:x,offset:E}:x==="ref-delta"&&(i[E]={type:x,offset:E})});const m=Object.keys(i).map(Number);for(const[w,x]of m.entries()){const _=w+1===m.length?t.byteLength-20:m[w+1],E=i[x],C=Ece.buf(t.slice(x,_))>>>0;E.end=_,E.crc=C}const g=new Up({pack:Promise.resolve(t),packfileSha:a,crcs:l,hashes:o,offsets:c,getExternalRefDelta:n});f=null;let v=0;const b=[0,0,0,0,0,0,0,0,0,0,0,0];for(let w in i){w=Number(w);const x=Math.floor(v*100/u);x!==f&&r&&await r({phase:"Resolving deltas",loaded:v,total:u}),v++,f=x;const _=i[w];if(!_.oid)try{g.readDepth=0,g.externalReadDepth=0;const{type:E,object:C}=await g.readSlice({start:w});b[g.readDepth]+=1;const k=await Pc(xm.wrap({type:E,object:C}));_.oid=k,o.push(k),c.set(k,w),l[k]=_.crc}catch{continue}}return o.sort(),g}async toBuffer(){const t=[],n=(c,u)=>{t.push(Xt.from(c,u))};n("ff744f63","hex"),n("00000002","hex");const r=new xl(Xt.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const f of this.hashes)parseInt(f.slice(0,2),16)<=c&&u++;r.writeUInt32BE(u)}t.push(r.buffer);for(const c of this.hashes)n(c,"hex");const s=new xl(Xt.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.crcs[c]);t.push(s.buffer);const i=new xl(Xt.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.offsets.get(c));t.push(i.buffer),n(this.packfileSha,"hex");const a=Xt.concat(t),o=await Pc(a),l=Xt.alloc(20);return l.write(o,"hex"),Xt.concat([a,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new $n(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new $n("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),s=new xl(r),i=s.readUInt8(),a=i&112;let o=n[a];if(o===void 0)throw new $n("Unrecognized type: 0b"+a.toString(2));const l=i&15;let c=l;i&128&&(c=Cue(s,l));let f=null,m=null;if(o==="ofs_delta"){const v=Eue(s),b=t-v;({object:f,type:o}=await this.readSlice({start:b}))}if(o==="ref_delta"){const v=s.slice(20).toString("hex");({object:f,type:o}=await this.read({oid:v}))}const g=r.slice(s.tell());if(m=Xt.from(await h$(g)),m.byteLength!==c)throw new $n(`Packfile told us object would have length ${c} but it had length ${m.byteLength}`);return f&&(m=Xt.from(vue(m,f))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:m}),{type:o,format:"content",object:m}}}const yw=Symbol("PackfileCache");async function kue({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:s}){const i=await e.read(t);return Up.fromIdx({idx:i,getExternalRefDelta:n})}function EN({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}){t[yw]||(t[yw]=new Map);let a=t[yw].get(n);return a||(a=kue({fs:e,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}),t[yw].set(n,a)),a}async function Tue({fs:e,cache:t,gitdir:n,oid:r,format:s="content",getExternalRefDelta:i}){let a=await e.readdir(Mt.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await EN({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(c.error)throw new $n(c.error);if(c.offsets.has(r)){if(!c.pack){const f=l.replace(/idx$/,"pack");c.pack=e.read(f)}const u=await c.read({oid:r,getExternalRefDelta:i});return u.format="content",u.source=`objects/pack/${o.replace(/idx$/,"pack")}`,u}}return null}async function ns({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=u=>ns({fs:e,cache:t,gitdir:n,oid:u});let a;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(a={format:"wrapped",object:Xt.from("tree 0\0")}),a||(a=await u$({fs:e,gitdir:n,oid:r})),!a){if(a=await Tue({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}),!a)throw new Br(r);return a}if(s==="deflated"||(a.format==="deflated"&&(a.object=Xt.from(await h$(a.object)),a.format="wrapped"),s==="wrapped"))return a;const o=await Pc(a.object);if(o!==r)throw new $n(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:c}=xm.unwrap(a.object);if(a.type=c,a.object=l,a.format="content",s==="content")return a;throw new $n(`invalid requested format "${s}"`)}class qo extends yr{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=qo.code,this.data={noun:t,where:n,canForce:r}}}qo.code="AlreadyExistsError";class ib extends yr{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=ib.code,this.data={nouns:t,short:n,matches:r}}}ib.code="AmbiguousError";class ab extends yr{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=ab.code,this.data={filepaths:t}}}ab.code="CheckoutConflictError";class ob extends yr{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=ob.code,this.data={ref:t,oid:n}}}ob.code="CommitNotFetchedError";class lb extends yr{constructor(){super("Empty response from git server."),this.code=this.name=lb.code,this.data={}}}lb.code="EmptyServerResponseError";class cb extends yr{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=cb.code,this.data={}}}cb.code="FastForwardError";class ub extends yr{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=ub.code,this.data={prettyDetails:t,result:n}}}ub.code="GitPushError";class qp extends yr{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=qp.code,this.data={statusCode:t,statusMessage:n,response:r}}}qp.code="HttpError";class nd extends yr{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=nd.code,this.data={reason:t}}}nd.code="InvalidFilepathError";class $o extends yr{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=$o.code,this.data={ref:t,suggestion:n}}}$o.code="InvalidRefNameError";class db extends yr{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=db.code,this.data={depth:t}}}db.code="MaxDepthError";class _m extends yr{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=_m.code,this.data={}}}_m.code="MergeNotSupportedError";class Sm extends yr{constructor(t,n,r,s){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=Sm.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:s}}}Sm.code="MergeConflictError";class Ri extends yr{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=Ri.code,this.data={role:t}}}Ri.code="MissingNameError";class oa extends yr{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=oa.code,this.data={parameter:t}}}oa.code="MissingParameterError";class fb extends yr{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=fb.code,this.data={errors:t},this.errors=t}}fb.code="MultipleGitError";class Jf extends yr{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=Jf.code,this.data={expected:t,actual:n}}}Jf.code="ParseError";class Vp extends yr{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=Vp.code,this.data={reason:t}}}Vp.code="PushRejectedError";class Fu extends yr{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=Fu.code,this.data={capability:t,parameter:n}}}Fu.code="RemoteCapabilityError";class hb extends yr{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=hb.code,this.data={preview:t,response:n}}}hb.code="SmartHttpError";class pb extends yr{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=pb.code,this.data={url:t,transport:n,suggestion:r}}}pb.code="UnknownTransportError";class mb extends yr{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=mb.code,this.data={url:t}}}mb.code="UrlParseError";class Em extends yr{constructor(){super("The operation was canceled."),this.code=this.name=Em.code,this.data={}}}Em.code="UserCanceledError";class gb extends yr{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=gb.code,this.data={filepath:t}}}gb.code="IndexResetError";class yb extends yr{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=yb.code,this.data={ref:t}}}yb.code="NoCommitError";var Aue=Object.freeze({__proto__:null,AlreadyExistsError:qo,AmbiguousError:ib,CheckoutConflictError:ab,CommitNotFetchedError:ob,EmptyServerResponseError:lb,FastForwardError:cb,GitPushError:ub,HttpError:qp,InternalError:$n,InvalidFilepathError:nd,InvalidOidError:td,InvalidRefNameError:$o,MaxDepthError:db,MergeNotSupportedError:_m,MergeConflictError:Sm,MissingNameError:Ri,MissingParameterError:oa,MultipleGitError:fb,NoRefspecError:sb,NotFoundError:Br,ObjectTypeError:Ki,ParseError:Jf,PushRejectedError:Vp,RemoteCapabilityError:Fu,SmartHttpError:hb,UnknownTransportError:pb,UnsafeFilepathError:vm,UrlParseError:mb,UserCanceledError:Em,UnmergedPathsError:rb,IndexResetError:gb,NoCommitError:yb});function iA({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=Rue(r),`${e} <${t}> ${n} ${r}`}function Rue(e){const t=Nue(Iue(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),s=String(e);return r.length<2&&(r="0"+r),s.length<2&&(s="0"+s),(t===-1?"-":"+")+r+s}function Nue(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function Iue(e){return e===0?e:-e}function vc(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function Jx(e){const[,t,n,r,s]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:jue(s)}}function jue(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),Mue(r)}function Mue(e){return e===0?e:-e}class zi{constructor(t){if(typeof t=="string")this._tag=t;else if(Xt.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=zi.render(t);else throw new $n("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new zi(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${iA(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.tagger&&(r.tagger=Jx(r.tagger)),r.committer&&(r.committer=Jx(r.committer)),r}withoutSignature(){const t=vc(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return vc(t)}payload(){return this.withoutSignature()+`
`}toObject(){return Xt.from(this._tag,"utf8")}static async sign(t,n,r){const s=t.payload();let{signature:i}=await n({payload:s,secretKey:r});i=vc(i);const a=s+i;return zi.from(a)}}function ok(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function Oue(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class es{constructor(t){if(typeof t=="string")this._commit=t;else if(Xt.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=es.render(t);else throw new $n("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=es.justHeaders(t),s=es.justMessage(t),i=vc(r+`
gpgsig`+ok(n)+`
`+s);return new es(i)}static from(t){return new es(t)}toObject(){return Xt.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return es.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return vc(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=es.justHeaders(this._commit).split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={parent:[]};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.author&&(r.author=Jx(r.author)),r.committer&&(r.committer=Jx(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new $n("commit 'parent' property should be an array");for(const i of t.parent)n+=`parent ${i}
`}const r=t.author;n+=`author ${iA(r)}
`;const s=t.committer||t.author;return n+=`committer ${iA(s)}
`,t.gpgsig&&(n+="gpgsig"+ok(t.gpgsig)),n}static render(t){return es.renderHeaders(t)+`
`+vc(t.message)}render(){return this._commit}withoutSignature(){const t=vc(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return vc(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return Oue(t)}static async sign(t,n,r){const s=t.withoutSignature(),i=es.justMessage(t._commit);let{signature:a}=await n({payload:s,secretKey:r});a=vc(a);const l=es.justHeaders(t._commit)+`
gpgsig`+ok(a)+`
`+i;return es.from(l)}}async function Hp({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:ca.from([]),oid:r};const{type:s,object:i}=await ns({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=zi.from(i).parse().object,Hp({fs:e,cache:t,gitdir:n,oid:r});if(s==="commit")return r=es.from(i).parse().tree,Hp({fs:e,cache:t,gitdir:n,oid:r});if(s!=="tree")throw new Ki(r,s,"tree");return{tree:ca.from(i),oid:r}}class Pue{constructor({fs:t,gitdir:n,ref:r,cache:s}){this.fs=t,this.cache=s,this.gitdir=n,this.mapPromise=(async()=>{const a=new Map;let o;try{o=await Lt.resolve({fs:t,gitdir:n,ref:r})}catch(c){c instanceof Br&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await Hp({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",a.set(".",l),a})();const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:s,gitdir:i}=this,a=await this.mapPromise,o=a.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:c,object:u}=await ns({fs:r,cache:s,gitdir:i,oid:l});if(c!==o.type)throw new Ki(l,c,o.type);const f=ca.from(u);for(const m of f)a.set(Mt.join(n,m.path),m);return f.entries().map(m=>Mt.join(n,m.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=a$(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:s,gitdir:i}=this,o=n.get(t._fullpath).oid,{type:l,object:c}=await ns({fs:r,cache:s,gitdir:i,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(c)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function so({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,E_,{value:function({fs:n,gitdir:r,cache:s}){return new Pue({fs:n,gitdir:r,ref:e,cache:s})}}),Object.freeze(t),t}class Due{constructor({fs:t,dir:n,gitdir:r,cache:s}){this.fs=t,this.cache=s,this.dir=n,this.gitdir=r,this.config=null;const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:s}=this,i=await r.readdir(Mt.join(s,n));return i===null?null:i.map(a=>Mt.join(n,a))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let s=await n.lstat(`${r}/${t._fullpath}`);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let i=s.isDirectory()?"tree":"blob";i==="blob"&&!s.isFile()&&!s.isSymbolicLink()&&(i="special"),t._type=i,s=$p(s),t._mode=s.mode,s.size===-1&&t._actualSize&&(s.size=t._actualSize),t._stat=s}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:s}=this;if(await t.type()==="tree")t._content=void 0;else{const a=await(await this._getGitConfig(n,s)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:a});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:s,cache:i}=this;let a;await ei.acquire({fs:r,gitdir:s,cache:i},async function(o){const l=o.entriesMap.get(t._fullpath),c=await t.stat(),f=await(await n._getGitConfig(r,s)).get("core.filemode"),m=typeof vs<"u"?vs.platform!=="win32":!0;if(!l||Wx(c,l,f,m)){const g=await t.content();g===void 0?a=void 0:(a=await Pc(xm.wrap({type:"blob",object:g})),l&&a===l.oid&&(!f||c.mode===l.mode)&&Wx(c,l,f,m)&&o.insert({filepath:t._fullpath,stats:c,oid:a}))}else a=l.oid}),t._oid=a}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await Ms.get({fs:t,gitdir:n}),this.config)}}function bb(){const e=Object.create(null);return Object.defineProperty(e,E_,{value:function({fs:t,dir:n,gitdir:r,cache:s}){return new Due({fs:t,dir:n,gitdir:r,cache:s})}}),Object.freeze(e),e}function Fue(e,t){const n=t-e;return Array.from({length:n},(r,s)=>e+s)}const p$=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class Lue{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*Bue(e){const t=new Lue;let n;const r=[],s=e.length;for(let i=0;i<s;i++)r[i]=e[i].next().value,r[i]!==void 0&&t.consider(r[i]);if(t.value!==null)for(;;){const i=[];n=t.value,t.reset();for(let a=0;a<s;a++)r[a]!==void 0&&r[a]===n?(i[a]=r[a],r[a]=e[a].next().value):i[a]=null,r[a]!==void 0&&t.consider(r[a]);if(yield i,t.value===null)return}}async function rd({fs:e,cache:t,dir:n,gitdir:r,trees:s,map:i=async(l,c)=>c,reduce:a=async(l,c)=>{const u=p$(c);return l!==void 0&&u.unshift(l),u},iterate:o=(l,c)=>Promise.all([...c].map(l))}){const l=s.map(g=>g[E_]({fs:e,dir:n,gitdir:r,cache:t})),c=new Array(l.length).fill("."),u=Fue(0,l.length),f=async g=>{u.map(w=>{const x=g[w];g[w]=x&&new l[w].ConstructEntry(x)});const b=(await Promise.all(u.map(w=>{const x=g[w];return x?l[w].readdir(x):[]}))).map(w=>(w===null?[]:w)[Symbol.iterator]());return{entries:g,children:Bue(b)}},m=async g=>{const{entries:v,children:b}=await f(g),w=v.find(_=>_&&_._fullpath)._fullpath,x=await i(w,v);if(x!==null){let _=await o(m,b);return _=_.filter(E=>E!==void 0),a(x,_)}};return m(c)}async function aA(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const s=Mt.join(t,r);return e.lstat(s).then(i=>{if(i)return i.isDirectory()?aA(e,s):e.rm(s)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function $ue(e){return zue(e)&&uP(e.then)&&uP(e.catch)}function zue(e){return e&&typeof e=="object"}function uP(e){return typeof e=="function"}function dP(e){return $ue((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const fP=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function hP(e,t){if(dP(t))for(const n of fP)e[`_${n}`]=t[n].bind(t);else for(const n of fP)e[`_${n}`]=JC(t[n].bind(t));dP(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=aA.bind(null,e):t.rm?e._rm=JC(t.rm.bind(t)):t.rmdir.length>2?e._rm=JC(t.rmdir.bind(t)):e._rm=aA.bind(null,e)}class un{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?hP(this,t.promises):hP(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=Xt.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(zp(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const s=zp(t);if(s==="."||s==="/"||s===t)throw r;await this.mkdir(s),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(S_),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async s=>{const i=t+"/"+s;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((s,i)=>s.concat(i),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return Xt.isBuffer(r)?r:Xt.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function tt(e,t){if(t===void 0)throw new oa(e)}async function Qx(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function Uue({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),commit:r="HEAD",cache:s={}}){try{tt("fs",e),tt("dir",t),tt("gitdir",n);const i=new un(e),a=[so({ref:r}),bb(),wm()];let o=[];await ei.acquire({fs:i,gitdir:n,cache:s},async function(c){o=c.unmergedPaths});const l=await rd({fs:i,cache:s,dir:t,gitdir:n,trees:a,map:async function(c,[u,f,m]){const g=!await Qx(f,m),v=o.includes(c),b=!await Qx(m,u);if(g||v)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(b)return!1;throw new gb(c)}});await ei.acquire({fs:i,gitdir:n,cache:s},async function(c){for(const u of l)if(u!==!1){if(!u){await i.rmdir(`${t}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const f=new TextDecoder().decode(u.content);await i.write(`${t}/${u.path}`,f,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class Cm{static async isIgnored({fs:t,dir:n,gitdir:r=Mt.join(n,".git"),filepath:s}){if(Zx(s)===".git")return!0;if(s===".")return!1;let i="";const a=Mt.join(r,"info","exclude");await t.exists(a)&&(i=await t.read(a,"utf8"));const o=[{gitignore:Mt.join(n,".gitignore"),filepath:s}],l=s.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const f=l.slice(0,u).join("/"),m=l.slice(u).join("/");o.push({gitignore:Mt.join(n,f,".gitignore"),filepath:m})}let c=!1;for(const u of o){let f;try{f=await t.read(u.gitignore,"utf8")}catch(v){if(v.code==="NOENT")continue}const m=Bce().add(i);m.add(f);const g=zp(u.filepath);if(g!=="."&&m.ignores(g))return!0;c?c=!m.test(u.filepath).unignored:c=m.test(u.filepath).ignored}return c}}async function que({fs:e,gitdir:t,object:n,format:r,oid:s}){const i=`objects/${s.slice(0,2)}/${s.slice(2)}`,a=`${t}/${i}`;await e.exists(a)||await e.write(a,n)}let lk=null;async function m$(e){return lk===null&&(lk=Hue()),lk?Vue(e):xN.deflate(e)}async function Vue(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function Hue(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function fa({fs:e,gitdir:t,type:n,object:r,format:s="content",oid:i=void 0,dryRun:a=!1}){return s!=="deflated"&&(s!=="wrapped"&&(r=xm.wrap({type:n,object:r})),i=await Pc(r),r=Xt.from(await m$(r))),a||await que({fs:e,gitdir:t,object:r,format:"deflated",oid:i}),i}function g$(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function Gue({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),filepath:r,cache:s={},force:i=!1,parallel:a=!0}){try{tt("fs",e),tt("dir",t),tt("gitdir",n),tt("filepath",r);const o=new un(e);await ei.acquire({fs:o,gitdir:n,cache:s},async l=>{const u=await(await Ms.get({fs:o,gitdir:n})).get("core.autocrlf");return oA({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:i,parallel:a,autocrlf:u})})}catch(o){throw o.caller="git.add",o}}async function oA({dir:e,gitdir:t,fs:n,filepath:r,index:s,force:i,parallel:a,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async m=>{if(!i&&await Cm.isIgnored({fs:n,dir:e,gitdir:t,filepath:m}))return;const g=await n.lstat(Mt.join(e,m));if(!g)throw new Br(m);if(g.isDirectory()){const v=await n.readdir(Mt.join(e,m));if(a){const b=v.map(w=>oA({dir:e,gitdir:t,fs:n,filepath:[Mt.join(m,w)],index:s,force:i,parallel:a,autocrlf:o}));await Promise.all(b)}else for(const b of v)await oA({dir:e,gitdir:t,fs:n,filepath:[Mt.join(m,b)],index:s,force:i,parallel:a,autocrlf:o})}else{const v=g.isSymbolicLink()?await n.readlink(Mt.join(e,m)).then(g$):await n.read(Mt.join(e,m),{autocrlf:o});if(v===null)throw new Br(m);const b=await fa({fs:n,gitdir:t,type:"blob",object:v});s.insert({filepath:m,stats:g,oid:b})}}),c=await Promise.allSettled(l),u=c.filter(m=>m.status==="rejected").map(m=>m.reason);if(u.length>1)throw new fb(u);if(u.length===1)throw u[0];return c.filter(m=>m.status==="fulfilled"&&m.value).map(m=>m.value)}async function iy({fs:e,gitdir:t,path:n}){return(await Ms.get({fs:e,gitdir:t})).get(n)}function y$(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const s=n[r];s!==void 0&&(e[r]=s)}return e}async function sd({fs:e,gitdir:t,author:n,commit:r}){const s=Math.floor(Date.now()/1e3),i={name:await iy({fs:e,gitdir:t,path:"user.name"}),email:await iy({fs:e,gitdir:t,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},a=y$({},i,r?r.author:void 0,n);if(a.name!==void 0)return a}async function Gp({fs:e,gitdir:t,author:n,committer:r,commit:s}){const i=Math.floor(Date.now()/1e3),a={name:await iy({fs:e,gitdir:t,path:"user.name"}),email:await iy({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},o=y$({},a,s?s.committer:void 0,n,r);if(o.name!==void 0)return o}async function b$({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await ns({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=zi.from(i).parse().object,b$({fs:e,cache:t,gitdir:n,oid:r});if(s!=="commit")throw new Ki(r,s,"commit");return{commit:es.from(i),oid:r}}async function Kp({fs:e,cache:t,gitdir:n,oid:r}){const{commit:s,oid:i}=await b$({fs:e,cache:t,gitdir:n,oid:r});return{oid:i,commit:s.parse(),payload:s.withoutSignature()}}async function C_({fs:e,cache:t,onSign:n,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:f,parent:m,tree:g}){let v=!1;f||(f=await Lt.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let b,w;try{b=await Lt.resolve({fs:e,gitdir:r,ref:f}),w=await Kp({fs:e,gitdir:r,oid:b,cache:{}})}catch{v=!0}if(l&&v)throw new yb(f);const x=l?await sd({fs:e,gitdir:r,author:i,commit:w.commit}):await sd({fs:e,gitdir:r,author:i});if(!x)throw new Ri("author");const _=l?await Gp({fs:e,gitdir:r,author:x,committer:a,commit:w.commit}):await Gp({fs:e,gitdir:r,author:x,committer:a});if(!_)throw new Ri("committer");return ei.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(E){const k=l$(E.entries).get(".");if(g||(g=await v$({fs:e,gitdir:r,inode:k,dryRun:c})),m?m=await Promise.all(m.map(j=>Lt.resolve({fs:e,gitdir:r,ref:j}))):l?m=w.commit.parent:m=b?[b]:[],!s)if(l)s=w.commit.message;else throw new oa("message");let R=es.from({tree:g,parent:m,author:x,committer:_,message:s});o&&(R=await es.sign(R,n,o));const I=await fa({fs:e,gitdir:r,type:"commit",object:R.toObject(),dryRun:c});return!u&&!c&&await Lt.writeRef({fs:e,gitdir:r,ref:f,value:I}),I})}async function v$({fs:e,gitdir:t,inode:n,dryRun:r}){const s=n.children;for(const l of s)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await v$({fs:e,gitdir:t,inode:l,dryRun:r}));const i=s.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),a=ca.from(i);return await fa({fs:e,gitdir:t,type:"tree",object:a.toObject(),dryRun:r})}async function vb({fs:e,cache:t,gitdir:n,oid:r,filepath:s}){if(s.startsWith("/"))throw new nd("leading-slash");if(s.endsWith("/"))throw new nd("trailing-slash");const i=r,a=await Hp({fs:e,cache:t,gitdir:n,oid:r}),o=a.tree;if(s==="")r=a.oid;else{const l=s.split("/");r=await w$({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:i,filepath:s})}return r}async function w$({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a}){const o=s.shift();for(const l of r)if(l.path===o){if(s.length===0)return l.oid;{const{type:c,object:u}=await ns({fs:e,cache:t,gitdir:n,oid:l.oid});if(c!=="tree")throw new Ki(i,c,"tree",a);return r=ca.from(u),w$({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a})}}throw new Br(`file or directory found at "${i}:${a}"`)}async function km({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){s!==void 0&&(r=await vb({fs:e,cache:t,gitdir:n,oid:r,filepath:s}));const{tree:i,oid:a}=await Hp({fs:e,cache:t,gitdir:n,oid:r});return{oid:a,tree:i.entries()}}async function wb({fs:e,gitdir:t,tree:n}){const r=ca.from(n).toObject();return await fa({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function Kue({fs:e,cache:t,onSign:n,gitdir:r,ref:s,oid:i,note:a,force:o,author:l,committer:c,signingKey:u}){let f;try{f=await Lt.resolve({gitdir:r,fs:e,ref:s})}catch(x){if(!(x instanceof Br))throw x}let g=(await km({fs:e,cache:t,gitdir:r,oid:f||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)g=g.filter(x=>x.path!==i);else for(const x of g)if(x.path===i)throw new qo("note",i);typeof a=="string"&&(a=Xt.from(a,"utf8"));const v=await fa({fs:e,gitdir:r,type:"blob",object:a,format:"content"});g.push({mode:"100644",path:i,oid:v,type:"blob"});const b=await wb({fs:e,gitdir:r,tree:g});return await C_({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:b,parent:f&&[f],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function Wue({fs:e,onSign:t,dir:n,gitdir:r=Mt.join(n,".git"),ref:s="refs/notes/commits",oid:i,note:a,force:o,author:l,committer:c,signingKey:u,cache:f={}}){try{tt("fs",e),tt("gitdir",r),tt("oid",i),tt("note",a),u&&tt("onSign",t);const m=new un(e),g=await sd({fs:m,gitdir:r,author:l});if(!g)throw new Ri("author");const v=await Gp({fs:m,gitdir:r,author:g,committer:c});if(!v)throw new Ri("committer");return await Kue({fs:new un(m),cache:f,onSign:t,gitdir:r,ref:s,oid:i,note:a,force:o,author:g,committer:v,signingKey:u})}catch(m){throw m.caller="git.addNote",m}}async function x$({fs:e,gitdir:t,remote:n,url:r,force:s}){if(n!==Sl.clean(n))throw new $o(n,Sl.clean(n));const i=await Ms.get({fs:e,gitdir:t});if(!s&&(await i.getSubsections("remote")).includes(n)&&r!==await i.get(`remote.${n}.url`))throw new qo("remote",n);await i.set(`remote.${n}.url`,r),await i.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await Ms.save({fs:e,gitdir:t,config:i})}async function Zue({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),remote:r,url:s,force:i=!1}){try{return tt("fs",e),tt("gitdir",n),tt("remote",r),tt("url",s),await x$({fs:new un(e),gitdir:n,remote:r,url:s,force:i})}catch(a){throw a.caller="git.addRemote",a}}async function Yue({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1}){if(s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`,!u&&await Lt.exists({fs:e,gitdir:r,ref:s}))throw new qo("tag",s);const f=await Lt.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:m}=await ns({fs:e,cache:t,gitdir:r,oid:f});let g=zi.from({object:f,type:m,tag:s.replace("refs/tags/",""),tagger:i,message:a,gpgsig:o});c&&(g=await zi.sign(g,n,c));const v=await fa({fs:e,gitdir:r,type:"tag",object:g.toObject()});await Lt.writeRef({fs:e,gitdir:r,ref:s,value:v})}async function Xue({fs:e,onSign:t,dir:n,gitdir:r=Mt.join(n,".git"),ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1,cache:f={}}){try{tt("fs",e),tt("gitdir",r),tt("ref",s),c&&tt("onSign",t);const m=new un(e),g=await sd({fs:m,gitdir:r,author:i});if(!g)throw new Ri("tagger");return await Yue({fs:m,cache:f,onSign:t,gitdir:r,ref:s,tagger:g,message:a,gpgsig:o,object:l,signingKey:c,force:u})}catch(m){throw m.caller="git.annotatedTag",m}}async function Jue({fs:e,gitdir:t,ref:n,object:r,checkout:s=!1,force:i=!1}){if(n!==Sl.clean(n))throw new $o(n,Sl.clean(n));const a=`refs/heads/${n}`;if(!i&&await Lt.exists({fs:e,gitdir:t,ref:a}))throw new qo("branch",n,!1);let o;try{o=await Lt.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await Lt.writeRef({fs:e,gitdir:t,ref:a,value:o}),s&&await Lt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function Que({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r,object:s,checkout:i=!1,force:a=!1}){try{return tt("fs",e),tt("gitdir",n),tt("ref",r),await Jue({fs:new un(e),gitdir:n,ref:r,object:s,checkout:i,force:a})}catch(o){throw o.caller="git.branch",o}}const _$=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function CN({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:s,gitdir:i,remote:a,ref:o,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:f,force:m,track:g=!0}){let v;if(r)try{v=await Lt.resolve({fs:e,gitdir:i,ref:"HEAD"})}catch{v="0000000000000000000000000000000000000000"}let b;try{b=await Lt.resolve({fs:e,gitdir:i,ref:o})}catch(w){if(o==="HEAD")throw w;const x=`${a}/${o}`;if(b=await Lt.resolve({fs:e,gitdir:i,ref:x}),g){const _=await Ms.get({fs:e,gitdir:i});await _.set(`branch.${o}.remote`,a),await _.set(`branch.${o}.merge`,`refs/heads/${o}`),await Ms.save({fs:e,gitdir:i,config:_})}await Lt.writeRef({fs:e,gitdir:i,ref:`refs/heads/${o}`,value:b})}if(!c){let w;try{w=await ede({fs:e,cache:t,onProgress:n,dir:s,gitdir:i,ref:o,force:m,filepaths:l})}catch(k){throw k instanceof Br&&k.data.what===b?new ob(o,b):k}const x=w.filter(([k])=>k==="conflict").map(([k,R])=>R);if(x.length>0)throw new ab(x);const _=w.filter(([k])=>k==="error").map(([k,R])=>R);if(_.length>0)throw new $n(_.join(", "));if(f){r&&await r({previousHead:v,newHead:b,type:l!=null&&l.length>0?"file":"branch"});return}let E=0;const C=w.length;await ei.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(w.filter(([R])=>R==="delete"||R==="delete-index").map(async function([R,I]){const j=`${s}/${I}`;R==="delete"&&await e.rm(j),k.delete({filepath:I}),n&&await n({phase:"Updating workdir",loaded:++E,total:C})}))}),await ei.acquire({fs:e,gitdir:i,cache:t},async function(k){for(const[R,I]of w)if(R==="rmdir"||R==="rmdir-index"){const j=`${s}/${I}`;try{R==="rmdir-index"&&k.delete({filepath:I}),await e.rmdir(j),n&&await n({phase:"Updating workdir",loaded:++E,total:C})}catch(M){if(M.code==="ENOTEMPTY")console.log(`Did not delete ${I} because directory is not empty`);else throw M}}}),await Promise.all(w.filter(([k])=>k==="mkdir"||k==="mkdir-index").map(async function([k,R]){const I=`${s}/${R}`;await e.mkdir(I),n&&await n({phase:"Updating workdir",loaded:++E,total:C})})),await ei.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(w.filter(([R])=>R==="create"||R==="create-index"||R==="update"||R==="mkdir-index").map(async function([R,I,j,M,L]){const q=`${s}/${I}`;try{if(R!=="create-index"&&R!=="mkdir-index"){const{object:V}=await ns({fs:e,cache:t,gitdir:i,oid:j});if(L&&await e.rm(q),M===33188)await e.write(q,V);else if(M===33261)await e.write(q,V,{mode:511});else if(M===40960)await e.writelink(q,V);else throw new $n(`Invalid mode 0o${M.toString(8)} detected in blob ${j}`)}const P=await e.lstat(q);M===33261&&(P.mode=493),R==="mkdir-index"&&(P.mode=57344),k.insert({filepath:I,stats:P,oid:j}),n&&await n({phase:"Updating workdir",loaded:++E,total:C})}catch(P){console.log(P)}}))}),r&&await r({previousHead:v,newHead:b,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const w=await Lt.expand({fs:e,gitdir:i,ref:o});w.startsWith("refs/heads")?await Lt.writeSymbolicRef({fs:e,gitdir:i,ref:"HEAD",value:w}):await Lt.writeRef({fs:e,gitdir:i,ref:"HEAD",value:b})}}async function ede({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,ref:i,force:a,filepaths:o}){let l=0;return rd({fs:e,cache:t,dir:r,gitdir:s,trees:[so({ref:i}),bb(),wm()],map:async function(c,[u,f,m]){if(c===".")return;if(o&&!o.some(v=>_$(c,v)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!m,!!u,!!f].map(Number).join("")){case"000":return;case"001":return a&&o&&o.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await f.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await f.oid()?a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await f.mode()]:["conflict",c]:await u.mode()!==await f.mode()?a?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await m.type()){case"tree":return["rmdir",c];case"blob":return await m.oid()!==await f.oid()?a?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await m.type()}`]}case"110":case"111":switch(`${await m.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await m.oid()===await u.oid()&&await m.mode()===await u.mode()&&!a)return;if(f){if(await f.oid()!==await m.oid()&&await f.oid()!==await u.oid())return a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await f.mode()]:["conflict",c]}else if(a)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await m.mode()];return await u.mode()!==await m.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await m.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await m.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=p$(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function S$({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:s=Mt.join(r,".git"),remote:i="origin",ref:a,filepaths:o,noCheckout:l=!1,noUpdateHead:c=a===void 0,dryRun:u=!1,force:f=!1,track:m=!0,cache:g={}}){try{tt("fs",e),tt("dir",r),tt("gitdir",s);const v=a||"HEAD";return await CN({fs:new un(e),cache:g,onProgress:t,onPostCheckout:n,dir:r,gitdir:s,remote:i,ref:v,filepaths:o,noCheckout:l,noUpdateHead:c,dryRun:u,force:f,track:m})}catch(v){throw v.caller="git.checkout",v}}const tde=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function mf(e){const t=tde.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function _d({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const s=await Lt.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await Lt.resolve({fs:e,gitdir:t,ref:s})}catch{return}if(s.startsWith("refs/"))return n?s:mf(s)}function nde(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function E$({username:e="",password:t=""}){return`Basic ${Xt.from(`${e}:${t}`).toString("base64")}`}async function xb(e,t){const n=d$(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function e1(e){let t=0;const n=[];await xb(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function pP(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function lA(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class bs{static flush(){return Xt.from("0000","utf8")}static delim(){return Xt.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=Xt.from(t));const n=t.length+4,r=lA(4,n);return Xt.concat([Xt.from(r,"utf8"),t])}static streamReader(t){const n=new f$(t);return async function(){try{let s=await n.read(4);if(s==null)return!0;if(s=parseInt(s.toString("utf8"),16),s===0||s===1)return null;const i=await n.read(s-4);return i??!0}catch(s){return t.error=s,!0}}}}async function mP(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const s=n.slice(0,r),i=n.slice(r+1);t[s]=i}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function gP(e,{service:t}){const n=new Set,r=new Map,s=new Map,i=bs.streamReader(e);let a=await i();for(;a===null;)a=await i();if(a===!0)throw new lb;if(a.includes("version 2"))return mP(i);if(a.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new Jf(`# service=${t}\\n`,a.toString("utf8"));let o=await i();for(;o===null;)o=await i();if(o===!0)return{capabilities:n,refs:r,symrefs:s};if(o=o.toString("utf8"),o.includes("version 2"))return mP(i);const[l,c]=ck(o,"\0","\\x00");if(c.split(" ").map(u=>n.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,f]=ck(l," "," ");for(r.set(f,u);;){const m=await i();if(m===!0)break;if(m!==null){const[g,v]=ck(m.toString("utf8")," "," ");r.set(v,g)}}}for(const u of n)if(u.startsWith("symref=")){const f=u.match(/symref=([^:]+):(.*)/);f.length===3&&s.set(f[1],f[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:s}}function ck(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new Jf(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const yP=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,bP=(e,t)=>{(t.username||t.password)&&(e.Authorization=E$(t)),t.headers&&Object.assign(e,t.headers)},uk=async e=>{try{const t=Xt.from(await e1(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class t1{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:s,onAuthFailure:i,corsProxy:a,service:o,url:l,headers:c,protocolVersion:u}){let{url:f,auth:m}=pP(l);const g=a?yP(a,f):f;(m.username||m.password)&&(c.Authorization=E$(m)),u===2&&(c["Git-Protocol"]="version=2");let v,b,w=!1;do if(v=await t.request({onProgress:n,method:"GET",url:`${g}/info/refs?service=${o}`,headers:c}),b=!1,v.statusCode===401||v.statusCode===203){const x=w?i:r;if(x){if(m=await x(f,{...m,headers:{...c}}),m&&m.cancel)throw new Em;m&&(bP(c,m),w=!0,b=!0)}}else v.statusCode===200&&w&&s&&await s(f,m);while(b);if(v.statusCode!==200){const{response:x}=await uk(v);throw new qp(v.statusCode,v.statusMessage,x)}if(v.headers["content-type"]===`application/x-${o}-advertisement`){const x=await gP(v.body,{service:o});return x.auth=m,x}else{const{preview:x,response:_,data:E}=await uk(v);try{const C=await gP([E],{service:o});return C.auth=m,C}catch{throw new hb(x,_)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:s,url:i,auth:a,body:o,headers:l}){const c=pP(i);c&&(i=c.url),r&&(i=yP(r,i)),l["content-type"]=`application/x-${s}-request`,l.accept=`application/x-${s}-result`,bP(l,a);const u=await t.request({onProgress:n,method:"POST",url:`${i}/${s}`,body:o,headers:l});if(u.statusCode!==200){const{response:f}=uk(u);throw new qp(u.statusCode,u.statusMessage,f)}return u}}function rde({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class k_{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",t1),n.set("https",t1);const r=rde({url:t});if(!r)throw new mb(t);if(n.has(r.transport))return n.get(r.transport);throw new pb(t,r.transport,r.transport==="ssh"?nde(t):void 0)}}let sf=null;class ay{static async read({fs:t,gitdir:n}){sf===null&&(sf=new sy);const r=Mt.join(n,"shallow"),s=new Set;return await sf.acquire(r,async function(){const i=await t.read(r,{encoding:"utf8"});if(i===null||i.trim()==="")return s;i.trim().split(`
`).map(a=>s.add(a))}),s}static async write({fs:t,gitdir:n,oids:r}){sf===null&&(sf=new sy);const s=Mt.join(n,"shallow");if(r.size>0){const i=[...r].join(`
`)+`
`;await sf.acquire(s,async function(){await t.write(s,i,{encoding:"utf8"})})}else await sf.acquire(s,async function(){await t.rm(s)})}}async function sde({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function ide({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){let i=await e.readdir(Mt.join(n,"objects/pack"));i=i.filter(a=>a.endsWith(".idx"));for(const a of i){const o=`${n}/objects/pack/${a}`,l=await EN({fs:e,cache:t,filename:o,getExternalRefDelta:s});if(l.error)throw new $n(l.error);if(l.offsets.has(r))return!0}return!1}async function vP({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=o=>ns({fs:e,cache:t,gitdir:n,oid:o});let a=await sde({fs:e,gitdir:n,oid:r});return a||(a=await ide({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i})),a}function ade(e){const s="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===s}function C$(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const s=r.split("=",1)[0];return n.includes(s)})}const T_={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class Yw{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function ode(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function k$(e){const t=new Yw;let n="";return(async()=>(await xb(e,r=>{for(r=r.toString("utf8"),n+=r;;){const s=ode(n);if(s===-1)break;t.write(n.slice(0,s)),n=n.slice(s)}}),n.length>0&&t.write(n),t.end()))(),t}class T${static demux(t){const n=bs.streamReader(t),r=new Yw,s=new Yw,i=new Yw,a=async function(){const o=await n();if(o===null)return a();if(o===!0){r.end(),i.end(),t.error?s.destroy(t.error):s.end();return}switch(o[0]){case 1:{s.write(o.slice(1));break}case 2:{i.write(o.slice(1));break}case 3:{const l=o.slice(1);i.write(l),r.end(),i.end(),s.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}a()};return a(),{packetlines:r,packfile:s,progress:i}}}async function lde(e){const{packetlines:t,packfile:n,progress:r}=T$.demux(e),s=[],i=[],a=[];let o=!1,l=!1;return new Promise((c,u)=>{xb(t,f=>{const m=f.toString("utf8").trim();if(m.startsWith("shallow")){const g=m.slice(-41).trim();g.length!==40&&u(new td(g)),s.push(g)}else if(m.startsWith("unshallow")){const g=m.slice(-41).trim();g.length!==40&&u(new td(g)),i.push(g)}else if(m.startsWith("ACK")){const[,g,v]=m.split(" ");a.push({oid:g,status:v}),v||(l=!0)}else m.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))})})}function cde({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:s=null,since:i=null,exclude:a=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const c of t)o.push(bs.encode(`want ${c}${l}
`)),l="";for(const c of r)o.push(bs.encode(`shallow ${c}
`));s!==null&&o.push(bs.encode(`deepen ${s}
`)),i!==null&&o.push(bs.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const c of a)o.push(bs.encode(`deepen-not ${c}
`));o.push(bs.flush());for(const c of n)o.push(bs.encode(`have ${c}
`));return o.push(bs.encode(`done
`)),o}async function kN({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:l,ref:c,remoteRef:u,remote:f,url:m,corsProxy:g,depth:v=null,since:b=null,exclude:w=[],relative:x=!1,tags:_=!1,singleBranch:E=!1,headers:C={},prune:k=!1,pruneTags:R=!1}){const I=c||await _d({fs:e,gitdir:l,test:!0}),j=await Ms.get({fs:e,gitdir:l}),M=f||I&&await j.get(`branch.${I}.remote`)||"origin",L=m||await j.get(`remote.${M}.url`);if(typeof L>"u")throw new oa("remote OR url");const q=u||I&&await j.get(`branch.${I}.merge`)||c||"HEAD";g===void 0&&(g=await j.get("http.corsProxy"));const P=k_.getRemoteHelperFor({url:L}),V=await P.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:g,service:"git-upload-pack",url:L,headers:C,protocolVersion:1}),z=V.auth,re=V.refs;if(re.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(v!==null&&!V.capabilities.has("shallow"))throw new Fu("shallow","depth");if(b!==null&&!V.capabilities.has("deepen-since"))throw new Fu("deepen-since","since");if(w.length>0&&!V.capabilities.has("deepen-not"))throw new Fu("deepen-not","exclude");if(x===!0&&!V.capabilities.has("deepen-relative"))throw new Fu("deepen-relative","relative");const{oid:K,fullref:ee}=Lt.resolveAgainstMap({ref:q,map:re});for(const Ge of re.keys())Ge===ee||Ge==="HEAD"||Ge.startsWith("refs/heads/")||_&&Ge.startsWith("refs/tags/")||re.delete(Ge);const W=C$([...V.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${T_.agent}`]);x&&W.push("deepen-relative");const se=E?[K]:re.values(),Y=E?[I]:await Lt.listRefs({fs:e,gitdir:l,filepath:"refs"});let te=[];for(let Ge of Y)try{Ge=await Lt.expand({fs:e,gitdir:l,ref:Ge});const Re=await Lt.resolve({fs:e,gitdir:l,ref:Ge});await vP({fs:e,cache:t,gitdir:l,oid:Re})&&te.push(Re)}catch{}te=[...new Set(te)];const Q=await ay.read({fs:e,gitdir:l}),ae=V.capabilities.has("shallow")?[...Q]:[],xe=cde({capabilities:W,wants:se,haves:te,shallows:ae,depth:v,since:b,exclude:w}),ge=Xt.from(await e1(xe)),Me=await P.connect({http:n,onProgress:r,corsProxy:g,service:"git-upload-pack",url:L,auth:z,body:[ge],headers:C}),Pe=await lde(Me.body);Me.headers&&(Pe.headers=Me.headers);for(const Ge of Pe.shallows)if(!Q.has(Ge))try{const{object:Re}=await ns({fs:e,cache:t,gitdir:l,oid:Ge}),H=new es(Re),me=await Promise.all(H.headers().parent.map(ce=>vP({fs:e,cache:t,gitdir:l,oid:ce})));me.length===0||me.every(ce=>ce)||Q.add(Ge)}catch{Q.add(Ge)}for(const Ge of Pe.unshallows)Q.delete(Ge);if(await ay.write({fs:e,gitdir:l,oids:Q}),E){const Ge=new Map([[ee,K]]),Re=new Map;let H=10,me=ee;for(;H--;){const oe=V.symrefs.get(me);if(oe===void 0)break;Re.set(me,oe),me=oe}const Te=re.get(me);Te&&Ge.set(me,Te);const{pruned:ce}=await Lt.updateRemoteRefs({fs:e,gitdir:l,remote:M,refs:Ge,symrefs:Re,tags:_,prune:k});k&&(Pe.pruned=ce)}else{const{pruned:Ge}=await Lt.updateRemoteRefs({fs:e,gitdir:l,remote:M,refs:re,symrefs:V.symrefs,tags:_,prune:k,pruneTags:R});k&&(Pe.pruned=Ge)}if(Pe.HEAD=V.symrefs.get("HEAD"),Pe.HEAD===void 0){const{oid:Ge}=Lt.resolveAgainstMap({ref:"HEAD",map:re});for(const[Re,H]of re.entries())if(Re!=="HEAD"&&H===Ge){Pe.HEAD=Re;break}}const Ie=ee.startsWith("refs/tags")?"tag":"branch";if(Pe.FETCH_HEAD={oid:K,description:`${Ie} '${mf(ee)}' of ${L}`},r||s){const Ge=k$(Pe.progress);xb(Ge,async Re=>{if(s&&await s(Re),r){const H=Re.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);H&&await r({phase:H[1].trim(),loaded:parseInt(H[2],10),total:parseInt(H[3],10)})}})}const Ce=Xt.from(await e1(Pe.packfile));if(Me.body.error)throw Me.body.error;const He=Ce.slice(-20).toString("hex"),it={defaultBranch:Pe.HEAD,fetchHead:Pe.FETCH_HEAD.oid,fetchHeadDescription:Pe.FETCH_HEAD.description};if(Pe.headers&&(it.headers=Pe.headers),k&&(it.pruned=Pe.pruned),He!==""&&!ade(Ce)){it.packfile=`objects/pack/pack-${He}.pack`;const Ge=Mt.join(l,it.packfile);await e.write(Ge,Ce);const Re=me=>ns({fs:e,cache:t,gitdir:l,oid:me}),H=await Up.fromPack({pack:Ce,getExternalRefDelta:Re,onProgress:r});await e.write(Ge.replace(/\.pack$/,".idx"),await H.toBuffer())}return it}async function A$({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:Mt.join(n,".git"),defaultBranch:s="master"}){if(await e.exists(r+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(a=>r+"/"+a);for(const a of i)await e.mkdir(a);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${s}
`)}async function ude({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPostCheckout:l,dir:c,gitdir:u,url:f,corsProxy:m,ref:g,remote:v,depth:b,since:w,exclude:x,relative:_,singleBranch:E,noCheckout:C,noTags:k,headers:R}){try{if(await A$({fs:e,gitdir:u}),await x$({fs:e,gitdir:u,remote:v,url:f,force:!1}),m){const M=await Ms.get({fs:e,gitdir:u});await M.set("http.corsProxy",m),await Ms.save({fs:e,gitdir:u,config:M})}const{defaultBranch:I,fetchHead:j}=await kN({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:u,ref:g,remote:v,corsProxy:m,depth:b,since:w,exclude:x,relative:_,singleBranch:E,headers:R,tags:!k});if(j===null)return;g=g||I,g=g.replace("refs/heads/",""),await CN({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:c,gitdir:u,ref:g,remote:v,noCheckout:C})}catch(I){throw await e.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),I}}async function dde({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c=Mt.join(l,".git"),url:u,corsProxy:f=void 0,ref:m=void 0,remote:g="origin",depth:v=void 0,since:b=void 0,exclude:w=[],relative:x=!1,singleBranch:_=!1,noCheckout:E=!1,noTags:C=!1,headers:k={},cache:R={}}){try{return tt("fs",e),tt("http",t),tt("gitdir",c),E||tt("dir",l),tt("url",u),await ude({fs:new un(e),cache:R,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c,url:u,corsProxy:f,ref:m,remote:g,depth:v,since:b,exclude:w,relative:x,singleBranch:_,noCheckout:E,noTags:C,headers:k})}catch(I){throw I.caller="git.clone",I}}async function fde({fs:e,onSign:t,dir:n,gitdir:r=Mt.join(n,".git"),message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:f,parent:m,tree:g,cache:v={}}){try{tt("fs",e),l||tt("message",s),o&&tt("onSign",t);const b=new un(e);return await C_({fs:b,cache:v,onSign:t,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l,dryRun:c,noUpdateBranch:u,ref:f,parent:m,tree:g})}catch(b){throw b.caller="git.commit",b}}async function hde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),fullname:r=!1,test:s=!1}){try{return tt("fs",e),tt("gitdir",n),await _d({fs:new un(e),gitdir:n,fullname:r,test:s})}catch(i){throw i.caller="git.currentBranch",i}}async function pde({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await Lt.exists({fs:e,gitdir:t,ref:n}))throw new Br(n);const s=await Lt.expand({fs:e,gitdir:t,ref:n}),i=await _d({fs:e,gitdir:t,fullname:!0});if(s===i){const l=await Lt.resolve({fs:e,gitdir:t,ref:s});await Lt.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await Lt.deleteRef({fs:e,gitdir:t,ref:s});const a=mf(n),o=await Ms.get({fs:e,gitdir:t});await o.deleteSection("branch",a),await Ms.save({fs:e,gitdir:t,config:o})}async function mde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r}){try{return tt("fs",e),tt("ref",r),await pde({fs:new un(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteBranch",s}}async function gde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r}){try{tt("fs",e),tt("ref",r),await Lt.deleteRef({fs:new un(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteRef",s}}async function yde({fs:e,gitdir:t,remote:n}){const r=await Ms.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await Ms.save({fs:e,gitdir:t,config:r})}async function bde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),remote:r}){try{return tt("fs",e),tt("remote",r),await yde({fs:new un(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.deleteRemote",s}}async function vde({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await Lt.deleteRef({fs:e,gitdir:t,ref:n})}async function wde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r}){try{return tt("fs",e),tt("ref",r),await vde({fs:new un(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteTag",s}}async function xde({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(i=>`${r}${i}`).filter(i=>i.startsWith(n))}async function _de({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){const i=[];let a=await e.readdir(Mt.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await EN({fs:e,cache:t,filename:l,getExternalRefDelta:s});if(c.error)throw new $n(c.error);for(const u of c.offsets.keys())u.startsWith(r)&&i.push(u)}return i}async function Sde({fs:e,cache:t,gitdir:n,oid:r}){const s=o=>ns({fs:e,cache:t,gitdir:n,oid:o}),i=await xde({fs:e,gitdir:n,oid:r}),a=await _de({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s});for(const o of a)i.indexOf(o)===-1&&i.push(o);if(i.length===1)return i[0];throw i.length>1?new ib("oids",r,i):new Br(`an object matching "${r}"`)}async function Ede({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),oid:r,cache:s={}}){try{return tt("fs",e),tt("gitdir",n),tt("oid",r),await Sde({fs:new un(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.expandOid",i}}async function Cde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r}){try{return tt("fs",e),tt("gitdir",n),tt("ref",r),await Lt.expand({fs:new un(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.expandRef",s}}async function TN({fs:e,cache:t,gitdir:n,oids:r}){const s={},i=r.length;let a=r.map((o,l)=>({index:l,oid:o}));for(;a.length;){const o=new Set;for(const{oid:c,index:u}of a)s[c]||(s[c]=new Set),s[c].add(u),s[c].size===i&&o.add(c);if(o.size>0)return[...o];const l=new Map;for(const{oid:c,index:u}of a)try{const{object:f}=await ns({fs:e,cache:t,gitdir:n,oid:c}),m=es.from(f),{parent:g}=m.parseHeaders();for(const v of g)(!s[v]||!s[v].has(u))&&l.set(v+":"+u,{oid:v,index:u})}catch{}a=Array.from(l.values())}return[]}const dk=/^.*(\r?\n|$)/gm;function kde({branches:e,contents:t}){const n=e[1],r=e[2],s=t[0],i=t[1],a=t[2],o=i.match(dk),l=s.match(dk),c=a.match(dk),u=Hce(o,l,c),f=7;let m="",g=!0;for(const v of u)v.ok&&(m+=v.ok.join("")),v.conflict&&(g=!1,m+=`${"<".repeat(f)} ${n}
`,m+=v.conflict.a.join(""),m+=`${"=".repeat(f)}
`,m+=v.conflict.b.join(""),m+=`${">".repeat(f)} ${r}
`);return{cleanMerge:g,mergedText:m}}async function Tde({fs:e,cache:t,dir:n,gitdir:r=Mt.join(n,".git"),index:s,ourOid:i,baseOid:a,theirOid:o,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:f=!1,abortOnConflict:m=!0,mergeDriver:g}){const v=so({ref:i}),b=so({ref:a}),w=so({ref:o}),x=[],_=[],E=[],C=[],k=await rd({fs:e,cache:t,dir:n,gitdir:r,trees:[v,b,w],map:async function(R,[I,j,M]){const L=Zx(R),q=await Qx(I,j),P=await Qx(M,j);switch(`${q}-${P}`){case"false-false":return{mode:await j.mode(),path:L,oid:await j.oid(),type:await j.type()};case"false-true":return M?{mode:await M.mode(),path:L,oid:await M.oid(),type:await M.type()}:void 0;case"true-false":return I?{mode:await I.mode(),path:L,oid:await I.oid(),type:await I.type()}:void 0;case"true-true":{if(I&&j&&M&&await I.type()==="blob"&&await j.type()==="blob"&&await M.type()==="blob")return Ade({fs:e,gitdir:r,path:L,ours:I,base:j,theirs:M,ourName:l,baseName:c,theirName:u,mergeDriver:g}).then(async V=>{if(V.cleanMerge)m||s.insert({filepath:R,oid:V.mergeResult.oid,stage:0});else if(x.push(R),_.push(R),!m){const z=await j.oid(),re=await I.oid(),K=await M.oid();s.delete({filepath:R}),s.insert({filepath:R,oid:z,stage:1}),s.insert({filepath:R,oid:re,stage:2}),s.insert({filepath:R,oid:K,stage:3})}return V.mergeResult});if(j&&!I&&M&&await j.type()==="blob"&&await M.type()==="blob"){if(x.push(R),E.push(R),!m){const V=await j.oid(),z=await M.oid();s.delete({filepath:R}),s.insert({filepath:R,oid:V,stage:1}),s.insert({filepath:R,oid:z,stage:3})}return{mode:await M.mode(),oid:await M.oid(),type:"blob",path:L}}if(j&&I&&!M&&await j.type()==="blob"&&await I.type()==="blob"){if(x.push(R),C.push(R),!m){const V=await j.oid(),z=await I.oid();s.delete({filepath:R}),s.insert({filepath:R,oid:V,stage:1}),s.insert({filepath:R,oid:z,stage:2})}return{mode:await I.mode(),oid:await I.oid(),type:"blob",path:L}}if(j&&!I&&!M&&await j.type()==="blob")return;throw new _m}}},reduce:x.length!==0&&(!n||m)?void 0:async(R,I)=>{const j=I.filter(Boolean);if(R&&!(R&&R.type==="tree"&&j.length===0)){if(j.length>0){const L=new ca(j).toObject(),q=await fa({fs:e,gitdir:r,type:"tree",object:L,dryRun:f});R.oid=q}return R}}});return x.length!==0?(n&&!m&&await rd({fs:e,cache:t,dir:n,gitdir:r,trees:[so({ref:k.oid})],map:async function(R,[I]){const j=`${n}/${R}`;if(await I.type()==="blob"){const M=await I.mode(),L=new TextDecoder().decode(await I.content());await e.write(j,L,{mode:M})}return!0}}),new Sm(x,_,E,C)):k.oid}async function Ade({fs:e,gitdir:t,path:n,ours:r,base:s,theirs:i,ourName:a,theirName:o,baseName:l,dryRun:c,mergeDriver:u=kde}){const f="blob",m=await s.mode()===await r.mode()?await i.mode():await r.mode();if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:m,path:n,oid:await r.oid(),type:f}};if(await r.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:m,path:n,oid:await i.oid(),type:f}};if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:m,path:n,oid:await r.oid(),type:f}};const g=Xt.from(await r.content()).toString("utf8"),v=Xt.from(await s.content()).toString("utf8"),b=Xt.from(await i.content()).toString("utf8"),{mergedText:w,cleanMerge:x}=await u({branches:[l,a,o],contents:[v,g,b],path:n}),_=await fa({fs:e,gitdir:t,type:"blob",object:Xt.from(w,"utf8"),dryRun:c});return{cleanMerge:x,mergeResult:{mode:m,path:n,oid:_,type:f}}}async function R$({fs:e,cache:t,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:f,author:m,committer:g,signingKey:v,onSign:b,mergeDriver:w}){s===void 0&&(s=await _d({fs:e,gitdir:r,fullname:!0})),s=await Lt.expand({fs:e,gitdir:r,ref:s}),i=await Lt.expand({fs:e,gitdir:r,ref:i});const x=await Lt.resolve({fs:e,gitdir:r,ref:s}),_=await Lt.resolve({fs:e,gitdir:r,ref:i}),E=await TN({fs:e,cache:t,gitdir:r,oids:[x,_]});if(E.length!==1)throw new _m;const C=E[0];if(C===_)return{oid:x,alreadyMerged:!0};if(a&&C===x)return!l&&!c&&await Lt.writeRef({fs:e,gitdir:r,ref:s,value:_}),{oid:_,fastForward:!0};{if(o)throw new cb;const k=await ei.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async I=>Tde({fs:e,cache:t,dir:n,gitdir:r,index:I,ourOid:x,theirOid:_,baseOid:C,ourName:mf(s),baseName:"base",theirName:mf(i),dryRun:l,abortOnConflict:u,mergeDriver:w}));if(k instanceof Sm)throw k;return f||(f=`Merge branch '${mf(i)}' into ${mf(s)}`),{oid:await C_({fs:e,cache:t,gitdir:r,message:f,ref:s,tree:k,parent:[x,_],author:m,committer:g,signingKey:v,onSign:b,dryRun:l,noUpdateBranch:c}),tree:k,mergeCommit:!0}}}async function N$({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,dir:l,gitdir:c,ref:u,url:f,remote:m,remoteRef:g,prune:v,pruneTags:b,fastForward:w,fastForwardOnly:x,corsProxy:_,singleBranch:E,headers:C,author:k,committer:R,signingKey:I}){try{if(!u){const L=await _d({fs:e,gitdir:c});if(!L)throw new oa("ref");u=L}const{fetchHead:j,fetchHeadDescription:M}=await kN({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:c,corsProxy:_,ref:u,url:f,remote:m,remoteRef:g,singleBranch:E,headers:C,prune:v,pruneTags:b});await R$({fs:e,cache:t,gitdir:c,ours:u,theirs:j,fastForward:w,fastForwardOnly:x,message:`Merge ${M}`,author:k,committer:R,signingKey:I,dryRun:!1,noUpdateBranch:!1}),await CN({fs:e,cache:t,onProgress:r,dir:l,gitdir:c,ref:u,remote:m,noCheckout:!1})}catch(j){throw j.caller="git.pull",j}}async function Rde({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=Mt.join(o,".git"),ref:c,url:u,remote:f,remoteRef:m,corsProxy:g,singleBranch:v,headers:b={},cache:w={}}){try{tt("fs",e),tt("http",t),tt("gitdir",l);const x={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await N$({fs:new un(e),cache:w,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:f,remoteRef:m,fastForwardOnly:!0,corsProxy:g,singleBranch:v,headers:b,author:x,committer:x})}catch(x){throw x.caller="git.fastForward",x}}async function Nde({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=Mt.join(o,".git"),ref:c,remote:u,remoteRef:f,url:m,corsProxy:g,depth:v=null,since:b=null,exclude:w=[],relative:x=!1,tags:_=!1,singleBranch:E=!1,headers:C={},prune:k=!1,pruneTags:R=!1,cache:I={}}){try{return tt("fs",e),tt("http",t),tt("gitdir",l),await kN({fs:new un(e),cache:I,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,gitdir:l,ref:c,remote:u,remoteRef:f,url:m,corsProxy:g,depth:v,since:b,exclude:w,relative:x,tags:_,singleBranch:E,headers:C,prune:k,pruneTags:R})}catch(j){throw j.caller="git.fetch",j}}async function Ide({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),oids:r,cache:s={}}){try{return tt("fs",e),tt("gitdir",n),tt("oids",r),await TN({fs:new un(e),cache:s,gitdir:n,oids:r})}catch(i){throw i.caller="git.findMergeBase",i}}async function I$({fs:e,filepath:t}){if(await e.exists(Mt.join(t,".git")))return t;{const n=zp(t);if(n===t)throw new Br(`git root for ${t}`);return I$({fs:e,filepath:n})}}async function jde({fs:e,filepath:t}){try{return tt("fs",e),tt("filepath",t),await I$({fs:new un(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function Mde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),path:r}){try{return tt("fs",e),tt("gitdir",n),tt("path",r),await iy({fs:new un(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfig",s}}async function Ode({fs:e,gitdir:t,path:n}){return(await Ms.get({fs:e,gitdir:t})).getall(n)}async function Pde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),path:r}){try{return tt("fs",e),tt("gitdir",n),tt("path",r),await Ode({fs:new un(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfigAll",s}}async function Dde({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1}){try{tt("http",e),tt("url",i);const c=await k_.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[f,m]of c.refs){const g=f.split("/"),v=g.pop();let b=u;for(const w of g)b[w]=b[w]||{},b=b[w];b[v]=m}for(const[f,m]of c.symrefs){const g=f.split("/"),v=g.pop();let b=u;for(const w of g)b[w]=b[w]||{},b=b[w];b[v]=m}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function j$(e,t,n,r){const s=[];for(const[i,a]of e.refs){if(t&&!i.startsWith(t))continue;if(i.endsWith("^{}")){if(r){const l=i.replace("^{}",""),c=s[s.length-1],u=c.ref===l?c:s.find(f=>f.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=a}continue}const o={ref:i,oid:a};n&&e.symrefs.has(i)&&(o.target=e.symrefs.get(i)),s.push(o)}return s}async function Fde({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2}){try{tt("http",e),tt("url",i);const u=await k_.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const f={};for(const m of u.capabilities){const[g,v]=m.split("=");v?f[g]=v:f[g]=!0}return{protocolVersion:1,capabilities:f,refs:j$(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function Lde({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=xm.wrap({type:e,object:t})),r=await Pc(t)),{oid:r,object:t}}async function Bde({object:e}){try{tt("object",e),typeof e=="string"?e=Xt.from(e,"utf8"):e=Xt.from(e);const t="blob",{oid:n,object:r}=await Lde({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function $de({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,filepath:i}){try{i=Mt.join(r,i);const a=await e.read(i),o=c=>ns({fs:e,cache:t,gitdir:s,oid:c}),l=await Up.fromPack({pack:a,getExternalRefDelta:o,onProgress:n});return await e.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(a){throw a.caller="git.indexPack",a}}async function zde({fs:e,onProgress:t,dir:n,gitdir:r=Mt.join(n,".git"),filepath:s,cache:i={}}){try{return tt("fs",e),tt("dir",n),tt("gitdir",n),tt("filepath",s),await $de({fs:new un(e),cache:i,onProgress:t,dir:n,gitdir:r,filepath:s})}catch(a){throw a.caller="git.indexPack",a}}async function Ude({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:Mt.join(n,".git"),defaultBranch:s="master"}){try{return tt("fs",e),tt("gitdir",r),t||tt("dir",n),await A$({fs:new un(e),bare:t,dir:n,gitdir:r,defaultBranch:s})}catch(i){throw i.caller="git.init",i}}async function M$({fs:e,cache:t,gitdir:n,oid:r,ancestor:s,depth:i}){const a=await ay.read({fs:e,gitdir:n});if(!r)throw new oa("oid");if(!s)throw new oa("ancestor");if(r===s)return!1;const o=[r],l=new Set;let c=0;for(;o.length;){if(c++===i)throw new db(i);const u=o.shift(),{type:f,object:m}=await ns({fs:e,cache:t,gitdir:n,oid:u});if(f!=="commit")throw new Ki(u,f,"commit");const g=es.from(m).parse();for(const v of g.parent)if(v===s)return!0;if(!a.has(u))for(const v of g.parent)l.has(v)||(o.push(v),l.add(v))}return!1}async function qde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),oid:r,ancestor:s,depth:i=-1,cache:a={}}){try{return tt("fs",e),tt("gitdir",n),tt("oid",r),tt("ancestor",s),await M$({fs:new un(e),cache:a,gitdir:n,oid:r,ancestor:s,depth:i})}catch(o){throw o.caller="git.isDescendent",o}}async function Vde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),filepath:r}){try{return tt("fs",e),tt("dir",t),tt("gitdir",n),tt("filepath",r),Cm.isIgnored({fs:new un(e),dir:t,gitdir:n,filepath:r})}catch(s){throw s.caller="git.isIgnored",s}}async function Hde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),remote:r}){try{return tt("fs",e),tt("gitdir",n),Lt.listBranches({fs:new un(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.listBranches",s}}async function Gde({fs:e,gitdir:t,ref:n,cache:r}){if(n){const s=await Lt.resolve({gitdir:t,fs:e,ref:n}),i=[];return await O$({fs:e,cache:r,gitdir:t,oid:s,filenames:i,prefix:""}),i}else return ei.acquire({fs:e,gitdir:t,cache:r},async function(s){return s.entries.map(i=>i.path)})}async function O$({fs:e,cache:t,gitdir:n,oid:r,filenames:s,prefix:i}){const{tree:a}=await km({fs:e,cache:t,gitdir:n,oid:r});for(const o of a)o.type==="tree"?await O$({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:s,prefix:Mt.join(i,o.path)}):s.push(Mt.join(i,o.path))}async function Kde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r,cache:s={}}){try{return tt("fs",e),tt("gitdir",n),await Gde({fs:new un(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listFiles",i}}async function Wde({fs:e,cache:t,gitdir:n,ref:r}){let s;try{s=await Lt.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof Br)return[]}return(await km({fs:e,cache:t,gitdir:n,oid:s})).tree.map(o=>({target:o.path,note:o.oid}))}async function Zde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r="refs/notes/commits",cache:s={}}){try{return tt("fs",e),tt("gitdir",n),tt("ref",r),await Wde({fs:new un(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listNotes",i}}async function Yde({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),filepath:r}){try{return tt("fs",e),tt("gitdir",n),Lt.listRefs({fs:new un(e),gitdir:n,filepath:r})}catch(s){throw s.caller="git.listRefs",s}}async function Xde({fs:e,gitdir:t}){const n=await Ms.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async i=>{const a=await n.get(`remote.${i}.url`);return{remote:i,url:a}}))}async function Jde({fs:e,dir:t,gitdir:n=Mt.join(t,".git")}){try{return tt("fs",e),tt("gitdir",n),await Xde({fs:new un(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function Qde(e){const t=bs.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[s,i,...a]=r.split(" "),o={ref:i,oid:s};for(const l of a){const[c,u]=l.split(":");c==="symref-target"?o.target=u:c==="peeled"&&(o.peeled=u)}n.push(o)}return n}async function efe({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(bs.encode(`command=ls-refs
`)),r.push(bs.encode(`agent=${T_.agent}
`)),(n||t||e)&&r.push(bs.delim()),n&&r.push(bs.encode("peel")),t&&r.push(bs.encode("symrefs")),e&&r.push(bs.encode(`ref-prefix ${e}`)),r.push(bs.flush()),r}async function tfe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:f}){try{tt("http",e),tt("url",i);const m=await t1.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(m.protocolVersion===1)return j$(m,c,u,f);const g=await efe({prefix:c,symrefs:u,peelTags:f}),v=await t1.connect({http:e,auth:m.auth,headers:a,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,body:g});return Qde(v.body)}catch(m){throw m.caller="git.listServerRefs",m}}async function nfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git")}){try{return tt("fs",e),tt("gitdir",n),Lt.listTags({fs:new un(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function rfe(e,t){return e.committer.timestamp-t.committer.timestamp}const sfe="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function wP({fs:e,cache:t,gitdir:n,oid:r,fileId:s}){if(s===sfe)return;const i=r;let a;const o=await Hp({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return s===o.oid?a=o.path:(a=await P$({fs:e,cache:t,gitdir:n,tree:l,fileId:s,oid:i}),Array.isArray(a)&&(a.length===0?a=void 0:a.length===1&&(a=a[0]))),a}async function P$({fs:e,cache:t,gitdir:n,tree:r,fileId:s,oid:i,filepaths:a=[],parentPath:o=""}){const l=r.entries().map(function(c){let u;return c.oid===s?(u=Mt.join(o,c.path),a.push(u)):c.type==="tree"&&(u=ns({fs:e,cache:t,gitdir:n,oid:c.oid}).then(function({object:f}){return P$({fs:e,cache:t,gitdir:n,tree:ca.from(f),fileId:s,oid:i,filepaths:a,parentPath:Mt.join(o,c.path)})})),u});return await Promise.all(l),a}async function ife({fs:e,cache:t,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l}){const c=typeof a>"u"?void 0:Math.floor(a.valueOf()/1e3),u=[],f=await ay.read({fs:e,gitdir:n}),m=await Lt.resolve({fs:e,gitdir:n,ref:s}),g=[await Kp({fs:e,cache:t,gitdir:n,oid:m})];let v,b,w;function x(_){w&&r&&u.push(_)}for(;g.length>0;){const _=g.pop();if(c!==void 0&&_.commit.committer.timestamp<=c)break;if(r){let E;try{E=await vb({fs:e,cache:t,gitdir:n,oid:_.commit.tree,filepath:r}),b&&v!==E&&u.push(b),v=E,b=_,w=!0}catch(C){if(C instanceof Br){let k=l&&v;if(k&&(k=await wP({fs:e,cache:t,gitdir:n,oid:_.commit.tree,fileId:v}),k))if(Array.isArray(k)){if(b){const R=await wP({fs:e,cache:t,gitdir:n,oid:b.commit.tree,fileId:v});if(Array.isArray(R))if(k=k.filter(I=>R.indexOf(I)===-1),k.length===1)k=k[0],r=k,b&&u.push(b);else{k=!1,b&&u.push(b);break}}}else r=k,b&&u.push(b);if(!k){if(w&&v&&(u.push(b),!o))break;if(!o&&!l)throw C}b=_,w=!1}else throw C}}else u.push(_);if(i!==void 0&&u.length===i){x(_);break}if(!f.has(_.oid))for(const E of _.commit.parent){const C=await Kp({fs:e,cache:t,gitdir:n,oid:E});g.map(k=>k.oid).includes(C.oid)||g.push(C)}g.length===0&&x(_),g.sort((E,C)=>rfe(E.commit,C.commit))}return u}async function afe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),filepath:r,ref:s="HEAD",depth:i,since:a,force:o,follow:l,cache:c={}}){try{return tt("fs",e),tt("gitdir",n),tt("ref",s),await ife({fs:new un(e),cache:c,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l})}catch(u){throw u.caller="git.log",u}}async function ofe({fs:e,onSign:t,dir:n,gitdir:r=Mt.join(n,".git"),ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:f,author:m,committer:g,signingKey:v,cache:b={},mergeDriver:w}){try{tt("fs",e),v&&tt("onSign",t);const x=new un(e),_=await sd({fs:x,gitdir:r,author:m});if(!_&&(!o||!a))throw new Ri("author");const E=await Gp({fs:x,gitdir:r,author:_,committer:g});if(!E&&(!o||!a))throw new Ri("committer");return await R$({fs:x,cache:b,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a,fastForwardOnly:o,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:f,author:_,committer:E,signingKey:v,onSign:t,mergeDriver:w})}catch(x){throw x.caller="git.merge",x}}const lfe={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function D$({fs:e,cache:t,dir:n,gitdir:r=Mt.join(n,".git"),oids:s}){const i=new QB,a=[];function o(u,f){const m=Xt.from(u,f);a.push(m),i.update(m)}async function l({stype:u,object:f}){const m=lfe[u];let g=f.length,v=g>15?128:0;const b=g&15;g=g>>>4;let w=(v|m|b).toString(16);for(o(w,"hex");v;)v=g>127?128:0,w=v|g&127,o(lA(2,w),"hex"),g=g>>>7;o(Xt.from(await m$(f)))}o("PACK"),o("00000002","hex"),o(lA(8,s.length),"hex");for(const u of s){const{type:f,object:m}=await ns({fs:e,cache:t,gitdir:r,oid:u});await l({object:m,stype:f})}const c=i.digest();return a.push(c),a}async function cfe({fs:e,cache:t,gitdir:n,oids:r,write:s}){const i=await D$({fs:e,cache:t,gitdir:n,oids:r}),a=Xt.from(await e1(i)),l=`pack-${a.slice(-20).toString("hex")}.pack`;return s?(await e.write(Mt.join(n,`objects/pack/${l}`),a),{filename:l}):{filename:l,packfile:new Uint8Array(a)}}async function ufe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),oids:r,write:s=!1,cache:i={}}){try{return tt("fs",e),tt("gitdir",n),tt("oids",r),await cfe({fs:new un(e),cache:i,gitdir:n,oids:r,write:s})}catch(a){throw a.caller="git.packObjects",a}}async function dfe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=Mt.join(o,".git"),ref:c,url:u,remote:f,remoteRef:m,prune:g=!1,pruneTags:v=!1,fastForward:b=!0,fastForwardOnly:w=!1,corsProxy:x,singleBranch:_,headers:E={},author:C,committer:k,signingKey:R,cache:I={}}){try{tt("fs",e),tt("gitdir",l);const j=new un(e),M=await sd({fs:j,gitdir:l,author:C});if(!M)throw new Ri("author");const L=await Gp({fs:j,gitdir:l,author:M,committer:k});if(!L)throw new Ri("committer");return await N$({fs:j,cache:I,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:f,remoteRef:m,fastForward:b,fastForwardOnly:w,corsProxy:x,singleBranch:_,headers:E,author:M,committer:L,signingKey:R,prune:g,pruneTags:v})}catch(j){throw j.caller="git.pull",j}}async function ffe({fs:e,cache:t,dir:n,gitdir:r=Mt.join(n,".git"),start:s,finish:i}){const a=await ay.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const f of s)o.add(await Lt.resolve({fs:e,gitdir:r,ref:f}));for(const f of i)try{const m=await Lt.resolve({fs:e,gitdir:r,ref:f});l.add(m)}catch{}const c=new Set;async function u(f){c.add(f);const{type:m,object:g}=await ns({fs:e,cache:t,gitdir:r,oid:f});if(m==="tag"){const b=zi.from(g).headers().object;return u(b)}if(m!=="commit")throw new Ki(f,m,"commit");if(!a.has(f)){const b=es.from(g).headers().parent;for(f of b)!l.has(f)&&!c.has(f)&&await u(f)}}for(const f of o)await u(f);return c}async function fk({fs:e,cache:t,dir:n,gitdir:r=Mt.join(n,".git"),oids:s}){const i=new Set;async function a(o){if(i.has(o))return;i.add(o);const{type:l,object:c}=await ns({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const f=zi.from(c).headers().object;await a(f)}else if(l==="commit"){const f=es.from(c).headers().tree;await a(f)}else if(l==="tree"){const u=ca.from(c);for(const f of u)f.type==="blob"&&i.add(f.oid),f.type==="tree"&&await a(f.oid)}}for(const o of s)await a(o);return i}async function hfe(e){const t={};let n="";const r=bs.streamReader(e);let s=await r();for(;s!==!0;)s!==null&&(n+=s.toString("utf8")+`
`),s=await r();const i=n.toString("utf8").split(`
`);if(s=i.shift(),!s.startsWith("unpack "))throw new Jf('unpack ok" or "unpack [error message]',s);t.ok=s==="unpack ok",t.ok||(t.error=s.slice(7)),t.refs={};for(const a of i){if(a.trim()==="")continue;const o=a.slice(0,2),l=a.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),f=l.slice(c+1);t.refs[u]={ok:o==="ok",error:f}}return t}async function pfe({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const s of t)n.push(bs.encode(`${s.oldoid} ${s.oid} ${s.fullRef}${r}
`)),r="";return n.push(bs.flush()),n}async function mfe({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPrePush:l,gitdir:c,ref:u,remoteRef:f,remote:m,url:g,force:v=!1,delete:b=!1,corsProxy:w,headers:x={}}){const _=u||await _d({fs:e,gitdir:c});if(typeof _>"u")throw new oa("ref");const E=await Ms.get({fs:e,gitdir:c});m=m||await E.get(`branch.${_}.pushRemote`)||await E.get("remote.pushDefault")||await E.get(`branch.${_}.remote`)||"origin";const C=g||await E.get(`remote.${m}.pushurl`)||await E.get(`remote.${m}.url`);if(typeof C>"u")throw new oa("remote OR url");const k=f||await E.get(`branch.${_}.merge`);if(typeof C>"u")throw new oa("remoteRef");w===void 0&&(w=await E.get("http.corsProxy"));const R=await Lt.expand({fs:e,gitdir:c,ref:_}),I=b?"0000000000000000000000000000000000000000":await Lt.resolve({fs:e,gitdir:c,ref:R}),j=k_.getRemoteHelperFor({url:C}),M=await j.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:w,service:"git-receive-pack",url:C,headers:x,protocolVersion:1}),L=M.auth;let q;if(!k)q=R;else try{q=await Lt.expandAgainstMap({ref:k,map:M.refs})}catch(Q){if(Q instanceof Br)q=k.startsWith("refs/")?k:`refs/heads/${k}`;else throw Q}const P=M.refs.get(q)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:m,url:C,localRef:{ref:b?"(delete)":R,oid:I},remoteRef:{ref:q,oid:P}}))throw new Em;const V=!M.capabilities.has("no-thin");let z=new Set;if(!b){const Q=[...M.refs.values()];let ae=new Set;if(P!=="0000000000000000000000000000000000000000"){const xe=await TN({fs:e,cache:t,gitdir:c,oids:[I,P]});for(const ge of xe)Q.push(ge);V&&(ae=await fk({fs:e,cache:t,gitdir:c,oids:xe}))}if(!Q.includes(I)){const xe=await ffe({fs:e,cache:t,gitdir:c,start:[I],finish:Q});z=await fk({fs:e,cache:t,gitdir:c,oids:xe})}if(V){try{const xe=await Lt.resolve({fs:e,gitdir:c,ref:`refs/remotes/${m}/HEAD`,depth:2}),{oid:ge}=await Lt.resolveAgainstMap({ref:xe.replace(`refs/remotes/${m}/`,""),fullref:xe,map:M.refs}),Me=[ge];for(const Pe of await fk({fs:e,cache:t,gitdir:c,oids:Me}))ae.add(Pe)}catch{}for(const xe of ae)z.delete(xe)}if(I===P&&(v=!0),!v){if(R.startsWith("refs/tags")&&P!=="0000000000000000000000000000000000000000")throw new Vp("tag-exists");if(I!=="0000000000000000000000000000000000000000"&&P!=="0000000000000000000000000000000000000000"&&!await M$({fs:e,cache:t,gitdir:c,oid:I,ancestor:P,depth:-1}))throw new Vp("not-fast-forward")}}const re=C$([...M.capabilities],["report-status","side-band-64k",`agent=${T_.agent}`]),K=await pfe({capabilities:re,triplets:[{oldoid:P,oid:I,fullRef:q}]}),ee=b?[]:await D$({fs:e,cache:t,gitdir:c,oids:[...z]}),W=await j.connect({http:n,onProgress:r,corsProxy:w,service:"git-receive-pack",url:C,auth:L,headers:x,body:[...K,...ee]}),{packfile:se,progress:Y}=await T$.demux(W.body);if(s){const Q=k$(Y);xb(Q,async ae=>{await s(ae)})}const te=await hfe(se);if(W.headers&&(te.headers=W.headers),m&&te.ok&&te.refs[q].ok&&!R.startsWith("refs/tags")){const Q=`refs/remotes/${m}/${q.replace("refs/heads","")}`;b?await Lt.deleteRef({fs:e,gitdir:c,ref:Q}):await Lt.writeRef({fs:e,gitdir:c,ref:Q,value:I})}if(te.ok&&Object.values(te.refs).every(Q=>Q.ok))return te;{const Q=Object.entries(te.refs).filter(([ae,xe])=>!xe.ok).map(([ae,xe])=>`
  - ${ae}: ${xe.error}`).join("");throw new ub(Q,te)}}async function gfe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,dir:l,gitdir:c=Mt.join(l,".git"),ref:u,remoteRef:f,remote:m="origin",url:g,force:v=!1,delete:b=!1,corsProxy:w,headers:x={},cache:_={}}){try{return tt("fs",e),tt("http",t),tt("gitdir",c),await mfe({fs:new un(e),cache:_,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,gitdir:c,ref:u,remoteRef:f,remote:m,url:g,force:v,delete:b,corsProxy:w,headers:x})}catch(E){throw E.caller="git.push",E}}async function F$({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await ns({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=zi.from(i).parse().object,F$({fs:e,cache:t,gitdir:n,oid:r});if(s!=="blob")throw new Ki(r,s,"blob");return{oid:r,blob:new Uint8Array(i)}}async function L$({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){return s!==void 0&&(r=await vb({fs:e,cache:t,gitdir:n,oid:r,filepath:s})),await F$({fs:e,cache:t,gitdir:n,oid:r})}async function yfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),oid:r,filepath:s,cache:i={}}){try{return tt("fs",e),tt("gitdir",n),tt("oid",r),await L$({fs:new un(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readBlob",a}}async function B$({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),oid:r,cache:s={}}){try{return tt("fs",e),tt("gitdir",n),tt("oid",r),await Kp({fs:new un(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readCommit",i}}async function bfe({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:s}){const i=await Lt.resolve({gitdir:n,fs:e,ref:r}),{blob:a}=await L$({fs:e,cache:t,gitdir:n,oid:i,filepath:s});return a}async function vfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r="refs/notes/commits",oid:s,cache:i={}}){try{return tt("fs",e),tt("gitdir",n),tt("ref",r),tt("oid",s),await bfe({fs:new un(e),cache:i,gitdir:n,ref:r,oid:s})}catch(a){throw a.caller="git.readNote",a}}async function wfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),oid:r,format:s="parsed",filepath:i=void 0,encoding:a=void 0,cache:o={}}){try{tt("fs",e),tt("gitdir",n),tt("oid",r);const l=new un(e);i!==void 0&&(r=await vb({fs:l,cache:o,gitdir:n,oid:r,filepath:i}));const u=await ns({fs:l,cache:o,gitdir:n,oid:r,format:s==="parsed"?"content":s});if(u.oid=r,s==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=es.from(u.object).parse();break;case"tree":u.object=ca.from(u.object).entries();break;case"blob":a?u.object=u.object.toString(a):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=zi.from(u.object).parse();break;default:throw new Ki(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function xfe({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await ns({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(s!=="tag")throw new Ki(r,s,"tag");const a=zi.from(i);return{oid:r,tag:a.parse(),payload:a.payload()}}async function _fe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),oid:r,cache:s={}}){try{return tt("fs",e),tt("gitdir",n),tt("oid",r),await xfe({fs:new un(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readTag",i}}async function Sfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),oid:r,filepath:s=void 0,cache:i={}}){try{return tt("fs",e),tt("gitdir",n),tt("oid",r),await km({fs:new un(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readTree",a}}async function Efe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),filepath:r,cache:s={}}){try{tt("fs",e),tt("gitdir",n),tt("filepath",r),await ei.acquire({fs:new un(e),gitdir:n,cache:s},async function(i){i.delete({filepath:r})})}catch(i){throw i.caller="git.remove",i}}async function Cfe({fs:e,cache:t,onSign:n,gitdir:r,ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l}){let c;try{c=await Lt.resolve({gitdir:r,fs:e,ref:s})}catch(v){if(!(v instanceof Br))throw v}let f=(await km({fs:e,gitdir:r,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;f=f.filter(v=>v.path!==i);const m=await wb({fs:e,gitdir:r,tree:f});return await C_({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:m,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:a,committer:o,signingKey:l})}async function kfe({fs:e,onSign:t,dir:n,gitdir:r=Mt.join(n,".git"),ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l,cache:c={}}){try{tt("fs",e),tt("gitdir",r),tt("oid",i);const u=new un(e),f=await sd({fs:u,gitdir:r,author:a});if(!f)throw new Ri("author");const m=await Gp({fs:u,gitdir:r,author:f,committer:o});if(!m)throw new Ri("committer");return await Cfe({fs:u,cache:c,onSign:t,gitdir:r,ref:s,oid:i,author:f,committer:m,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function Tfe({fs:e,gitdir:t,oldref:n,ref:r,checkout:s=!1}){if(r!==Sl.clean(r))throw new $o(r,Sl.clean(r));if(n!==Sl.clean(n))throw new $o(n,Sl.clean(n));const i=`refs/heads/${n}`,a=`refs/heads/${r}`;if(await Lt.exists({fs:e,gitdir:t,ref:a}))throw new qo("branch",r,!1);const l=await Lt.resolve({fs:e,gitdir:t,ref:i,depth:1});await Lt.writeRef({fs:e,gitdir:t,ref:a,value:l}),await Lt.deleteRef({fs:e,gitdir:t,ref:i});const u=await _d({fs:e,gitdir:t,fullname:!0})===i;(s||u)&&await Lt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function Afe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r,oldref:s,checkout:i=!1}){try{return tt("fs",e),tt("gitdir",n),tt("ref",r),tt("oldref",s),await Tfe({fs:new un(e),gitdir:n,ref:r,oldref:s,checkout:i})}catch(a){throw a.caller="git.renameBranch",a}}async function $$({gitdir:e,type:t,object:n}){return Pc(xm.wrap({type:t,object:n}))}async function Rfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),filepath:r,ref:s,cache:i={}}){try{tt("fs",e),tt("gitdir",n),tt("filepath",r);const a=new un(e);let o,l;try{o=await Lt.resolve({fs:a,gitdir:n,ref:s||"HEAD"})}catch(f){if(s)throw f}if(o)try{o=await vb({fs:a,cache:i,gitdir:n,oid:o,filepath:r})}catch{o=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=t&&await a.read(Mt.join(t,r));u&&(l=await $$({gitdir:n,type:"blob",object:u}),o===l&&(c=await a.lstat(Mt.join(t,r)))),await ei.acquire({fs:a,gitdir:n,cache:i},async function(f){f.delete({filepath:r}),o&&f.insert({filepath:r,stats:c,oid:o})})}catch(a){throw a.caller="git.reset",a}}async function Nfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r,depth:s}){try{return tt("fs",e),tt("gitdir",n),tt("ref",r),await Lt.resolve({fs:new un(e),gitdir:n,ref:r,depth:s})}catch(i){throw i.caller="git.resolveRef",i}}async function Ife({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),path:r,value:s,append:i=!1}){try{tt("fs",e),tt("gitdir",n),tt("path",r);const a=new un(e),o=await Ms.get({fs:a,gitdir:n});i?await o.append(r,s):await o.set(r,s),await Ms.save({fs:a,gitdir:n,config:o})}catch(a){throw a.caller="git.setConfig",a}}async function z$({fs:e,gitdir:t,commit:n}){const r=es.from(n).toObject();return await fa({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class n1{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const s=t.name.replace(/\s/g,""),i="0000000000000000000000000000000000000000",a=Math.floor(Date.now()/1e3),o=n1.timezoneOffsetForRefLogEntry;return`${i} ${n} ${s} ${t.email} ${a} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(i=>i).reverse().map((i,a)=>n?`stash@{${a}}: ${i.split("	")[1]}`:i)}}const jfe={stage:wm,workdir:bb};let hk;async function Wp(e,t){return hk===void 0&&(hk=new sy),hk.acquire(e,t)}async function Mfe(e,t,n,r,s=null){const i=Mt.join(n,r),a=await e.lstat(i);if(!a)throw new Br(i);if(a.isDirectory())throw new $n(`${i}: file expected, but found directory`);const o=s?await u$({fs:e,gitdir:t,oid:s}):void 0;let l=o?s:void 0;return o||await Wp({fs:e,gitdir:t,currentFilepath:i},async()=>{const c=a.isSymbolicLink()?await e.readlink(i).then(g$):await e.read(i);if(c===null)throw new Br(i);l=await fa({fs:e,gitdir:t,type:"blob",object:c})}),l}async function Ofe({fs:e,dir:t,gitdir:n,entries:r}){async function s(i){if(i.type==="tree"){if(!i.oid){const a=await Promise.all(i.children.map(s));i.oid=await wb({fs:e,gitdir:n,tree:a}),i.mode=16384}}else i.type==="blob"&&(i.oid=await Mfe(e,n,t,i.path,i.oid),i.mode=33188);return i.path=i.path.split("/").pop(),i}return Promise.all(r.map(s))}async function xP({fs:e,dir:t,gitdir:n,treePair:r}){const s=r[1]==="stage",i=r.map(g=>typeof g=="string"?jfe[g]():g),a=[],u=await rd({fs:e,cache:{},dir:t,gitdir:n,trees:i,map:async(g,[v,b])=>{if(!(g==="."||await Cm.isIgnored({fs:e,dir:t,gitdir:n,filepath:g}))&&b)return(!v||await v.oid()!==await b.oid()&&await b.oid()!==void 0)&&a.push([v,b]),{mode:await b.mode(),path:g,oid:await b.oid(),type:await b.type()}},reduce:async(g,v)=>(v=v.filter(Boolean),g?(g.children=v,g):v.length>0?v:void 0),iterate:async(g,v)=>{const b=[];for(const w of v){const[x,_]=w;s?_&&(await e.exists(`${t}/${_.toString()}`)?b.push(w):a.push([null,_])):x&&(_?b.push(w):a.push([x,null]))}return b.length?Promise.all(b.map(g)):[]}});if(a.length===0||u.length===0)return null;const m=(await Ofe({fs:e,dir:t,gitdir:n,entries:u})).filter(Boolean).map(g=>({mode:g.mode,path:g.path,oid:g.oid,type:g.type}));return wb({fs:e,gitdir:n,tree:m})}async function Pfe({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:s,wasStaged:i}){const a=[],o=[],l=await rd({fs:e,cache:{},dir:t,gitdir:n,trees:[so({ref:s}),so({ref:r})],map:async(c,[u,f])=>{if(c==="."||await Cm.isIgnored({fs:e,dir:t,gitdir:n,filepath:c}))return;const m=f?await f.type():await u.type();if(m!=="tree"&&m!=="blob")return;if(!f&&u){const v=m==="tree"?"rmdir":"rm";return m==="tree"&&a.push(c),m==="blob"&&i&&o.push({filepath:c,oid:await u.oid()}),{method:v,filepath:c}}const g=await f.oid();if(!u||await u.oid()!==g)return m==="tree"?{method:"mkdir",filepath:c}:(i&&o.push({filepath:c,oid:g,stats:await e.lstat(Mt.join(t,c))}),{method:"write",filepath:c,oid:g})}});await Wp({fs:e,gitdir:n,dirRemoved:a,ops:l},async()=>{for(const c of l){const u=Mt.join(t,c.filepath);switch(c.method){case"rmdir":await e.rmdir(u);break;case"mkdir":await e.mkdir(u);break;case"rm":await e.rm(u);break;case"write":if(!a.some(f=>u.startsWith(f))){const{object:f}=await ns({fs:e,cache:{},gitdir:n,oid:c.oid});await e.exists(u)&&await e.rm(u),await e.write(u,f)}break}}}),await ei.acquire({fs:e,gitdir:n,cache:{}},async c=>{o.forEach(({filepath:u,stats:f,oid:m})=>{c.insert({filepath:u,stats:f,oid:m})})})}class Cc{constructor({fs:t,dir:n,gitdir:r=Mt.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return Mt.join(this.gitdir,Cc.refStash)}get refLogsStashPath(){return Mt.join(this.gitdir,Cc.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await sd({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new Ri("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return z$({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new $o(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?Kp({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return Lt.writeRef({fs:this.fs,gitdir:this.gitdir,ref:Cc.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),s=n1.createStashReflogEntry(r,t,n),i=this.refLogsStashPath;await Wp({filepath:i,entry:s},async()=>{const a=await this.fs.exists(i)?await this.fs.read(i,"utf8"):"";await this.fs.write(i,a+s,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return n1.getStashReflogEntry(r,t)}}async function Dfe({fs:e,dir:t,gitdir:n,message:r=""}){const s=new Cc({fs:e,dir:t,gitdir:n});await s.getAuthor();const i=await _d({fs:e,gitdir:n,fullname:!1}),a=await Lt.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await B$({fs:e,dir:t,gitdir:n,oid:a})).commit.message,c=[a];let u=null,f=so({ref:"HEAD"});const m=await xP({fs:e,dir:t,gitdir:n,treePair:[so({ref:"HEAD"}),"stage"]});if(m){const w=await s.writeStashCommit({message:`stash-Index: WIP on ${i} - ${new Date().toISOString()}`,tree:m,parent:c});c.push(w),u=m,f=wm()}const g=await xP({fs:e,dir:t,gitdir:n,treePair:[f,"workdir"]});if(g){const w=await s.writeStashCommit({message:`stash-WorkDir: WIP on ${i} - ${new Date().toISOString()}`,tree:g,parent:[c[c.length-1]]});c.push(w),u=g}if(!u||!m&&!g)throw new Br("changes, nothing to stash");const v=(r.trim()||`WIP on ${i}`)+`: ${a.substring(0,7)} ${l}`,b=await s.writeStashCommit({message:v,tree:u,parent:c});return await s.writeStashRef(b),await s.writeStashReflogEntry({stashCommit:b,message:v}),await S$({fs:e,dir:t,gitdir:n,ref:i,track:!1,force:!0}),b}async function U$({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=await new Cc({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:a=null}=i.commit?i.commit:{};if(!(!a||!Array.isArray(a)))for(let o=0;o<a.length-1;o++){const c=(await Kp({fs:e,cache:{},gitdir:n,oid:a[o+1]})).commit.message.startsWith("stash-Index");await Pfe({fs:e,dir:t,gitdir:n,stashCommit:a[o+1],parentCommit:a[o],wasStaged:c})}}async function q$({fs:e,dir:t,gitdir:n,refIdx:r=0}){const s=new Cc({fs:e,dir:t,gitdir:n});if(!(await s.readStashCommit(r)).commit)return;const a=s.refStashPath;await Wp(a,async()=>{await e.exists(a)&&await e.rm(a)});const o=await s.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=s.refLogsStashPath;await Wp({reflogEntries:o,stashReflogPath:l,stashMgr:s},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const c=o[o.length-1].split(" ")[1];await s.writeStashRef(c)}else await e.rm(l)})}async function Ffe({fs:e,dir:t,gitdir:n}){return new Cc({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function Lfe({fs:e,dir:t,gitdir:n}){const r=new Cc({fs:e,dir:t,gitdir:n}),s=[r.refStashPath,r.refLogsStashPath];await Wp(s,async()=>{await Promise.all(s.map(async i=>{if(await e.exists(i))return e.rm(i)}))})}async function Bfe({fs:e,dir:t,gitdir:n,refIdx:r=0}){await U$({fs:e,dir:t,gitdir:n,refIdx:r}),await q$({fs:e,dir:t,gitdir:n,refIdx:r})}async function $fe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),op:r="push",message:s="",refIdx:i=0}){tt("fs",e),tt("dir",t),tt("gitdir",n),tt("op",r);const a={push:Dfe,apply:U$,drop:q$,list:Ffe,clear:Lfe,pop:Bfe},o=["apply","drop","pop"];try{const l=new un(e);["refs","logs","logs/refs"].map(f=>Mt.join(n,f)).forEach(async f=>{await l.exists(f)||await l.mkdir(f)});const u=a[r];if(u){if(o.includes(r)&&i<0)throw new $o(`stash@${i}`,"number that is in range of [0, num of stash pushed]");return await u({fs:l,dir:t,gitdir:n,message:s,refIdx:i})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function zfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),filepath:r,cache:s={}}){try{tt("fs",e),tt("gitdir",n),tt("filepath",r);const i=new un(e);if(await Cm.isIgnored({fs:i,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await Ufe({fs:i,cache:s,gitdir:n}),l=await V$({fs:i,cache:s,gitdir:n,tree:o,path:r}),c=await ei.acquire({fs:i,gitdir:n,cache:s},async function(b){for(const w of b)if(w.path===r)return w;return null}),u=await i.lstat(Mt.join(t,r)),f=l!==null,m=c!==null,g=u!==null,v=async()=>{if(m&&!Wx(c,u))return c.oid;{const b=await i.read(Mt.join(t,r)),w=await $$({gitdir:n,type:"blob",object:b});return m&&c.oid===w&&u.size!==-1&&ei.acquire({fs:i,gitdir:n,cache:s},async function(x){x.insert({filepath:r,stats:u,oid:w})}),w}};if(!f&&!g&&!m)return"absent";if(!f&&!g&&m)return"*absent";if(!f&&g&&!m)return"*added";if(!f&&g&&m)return await v()===c.oid?"added":"*added";if(f&&!g&&!m)return"deleted";if(f&&!g&&m)return l===c.oid,"*deleted";if(f&&g&&!m)return await v()===l?"*undeleted":"*undeletemodified";if(f&&g&&m){const b=await v();return b===l?b===c.oid?"unmodified":"*unmodified":b===c.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function V$({fs:e,cache:t,gitdir:n,tree:r,path:s}){typeof s=="string"&&(s=s.split("/"));const i=s.shift();for(const a of r)if(a.path===i){if(s.length===0)return a.oid;const{type:o,object:l}=await ns({fs:e,cache:t,gitdir:n,oid:a.oid});if(o==="tree"){const c=ca.from(l);return V$({fs:e,cache:t,gitdir:n,tree:c,path:s})}if(o==="blob")throw new Ki(a.oid,o,"blob",s.join("/"))}return null}async function Ufe({fs:e,cache:t,gitdir:n}){let r;try{r=await Lt.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(i){if(i instanceof Br)return[]}const{tree:s}=await km({fs:e,cache:t,gitdir:n,oid:r});return s}async function qfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r="HEAD",filepaths:s=["."],filter:i,cache:a={},ignored:o=!1}){try{tt("fs",e),tt("gitdir",n),tt("ref",r);const l=new un(e);return await rd({fs:l,cache:a,dir:t,gitdir:n,trees:[so({ref:r}),bb(),wm()],map:async function(c,[u,f,m]){if(!u&&!m&&f&&!o&&await Cm.isIgnored({fs:l,dir:t,filepath:c})||!s.some(R=>_$(c,R)))return null;if(i&&!i(c))return;const[g,v,b]=await Promise.all([u&&u.type(),f&&f.type(),m&&m.type()]),w=[g,v,b].includes("blob");if((g==="tree"||g==="special")&&!w)return;if(g==="commit")return null;if((v==="tree"||v==="special")&&!w)return;if(b==="commit")return null;if((b==="tree"||b==="special")&&!w)return;const x=g==="blob"?await u.oid():void 0,_=b==="blob"?await m.oid():void 0;let E;g!=="blob"&&v==="blob"&&b!=="blob"?E="42":v==="blob"&&(E=await f.oid());const C=[void 0,x,E,_],k=C.map(R=>C.indexOf(R));return k.shift(),[c,...k]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function Vfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r,object:s,force:i=!1}){try{tt("fs",e),tt("gitdir",n),tt("ref",r);const a=new un(e);if(r===void 0)throw new oa("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await Lt.resolve({fs:a,gitdir:n,ref:s||"HEAD"});if(!i&&await Lt.exists({fs:a,gitdir:n,ref:r}))throw new qo("tag",r);await Lt.writeRef({fs:a,gitdir:n,ref:r,value:o})}catch(a){throw a.caller="git.tag",a}}async function Hfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),cache:r={},filepath:s,oid:i,mode:a,add:o,remove:l,force:c}){try{tt("fs",e),tt("gitdir",n),tt("filepath",s);const u=new un(e);if(l)return await ei.acquire({fs:u,gitdir:n,cache:r},async function(m){if(!c){const g=await u.lstat(Mt.join(t,s));if(g){if(g.isDirectory())throw new nd("directory");return}}m.has({filepath:s})&&m.delete({filepath:s})});let f;if(!i){if(f=await u.lstat(Mt.join(t,s)),!f)throw new Br(`file at "${s}" on disk and "remove" not set`);if(f.isDirectory())throw new nd("directory")}return await ei.acquire({fs:u,gitdir:n,cache:r},async function(m){if(!o&&!m.has({filepath:s}))throw new Br(`file at "${s}" in index and "add" not set`);let g;if(i)g={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:a,uid:0,gid:0,size:0};else{g=f;const v=g.isSymbolicLink()?await u.readlink(Mt.join(t,s)):await u.read(Mt.join(t,s));i=await fa({fs:u,gitdir:n,type:"blob",format:"content",object:v})}return m.insert({filepath:s,oid:i,stats:g}),i})}catch(u){throw u.caller="git.updateIndex",u}}function Gfe(){try{return T_.version}catch(e){throw e.caller="git.version",e}}async function Kfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),trees:r,map:s,reduce:i,iterate:a,cache:o={}}){try{return tt("fs",e),tt("gitdir",n),tt("trees",r),await rd({fs:new un(e),cache:o,dir:t,gitdir:n,trees:r,map:s,reduce:i,iterate:a})}catch(l){throw l.caller="git.walk",l}}async function Wfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),blob:r}){try{return tt("fs",e),tt("gitdir",n),tt("blob",r),await fa({fs:new un(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(s){throw s.caller="git.writeBlob",s}}async function Zfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),commit:r}){try{return tt("fs",e),tt("gitdir",n),tt("commit",r),await z$({fs:new un(e),gitdir:n,commit:r})}catch(s){throw s.caller="git.writeCommit",s}}async function Yfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),type:r,object:s,format:i="parsed",oid:a,encoding:o=void 0}){try{const l=new un(e);if(i==="parsed"){switch(r){case"commit":s=es.from(s).toObject();break;case"tree":s=ca.from(s).toObject();break;case"blob":s=Xt.from(s,o);break;case"tag":s=zi.from(s).toObject();break;default:throw new Ki(a||"",r,"blob|commit|tag|tree")}i="content"}return a=await fa({fs:l,gitdir:n,type:r,object:s,oid:a,format:i}),a}catch(l){throw l.caller="git.writeObject",l}}async function Xfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),ref:r,value:s,force:i=!1,symbolic:a=!1}){try{tt("fs",e),tt("gitdir",n),tt("ref",r),tt("value",s);const o=new un(e);if(r!==Sl.clean(r))throw new $o(r,Sl.clean(r));if(!i&&await Lt.exists({fs:o,gitdir:n,ref:r}))throw new qo("ref",r);a?await Lt.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:s}):(s=await Lt.resolve({fs:o,gitdir:n,ref:s}),await Lt.writeRef({fs:o,gitdir:n,ref:r,value:s}))}catch(o){throw o.caller="git.writeRef",o}}async function Jfe({fs:e,gitdir:t,tag:n}){const r=zi.from(n).toObject();return await fa({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function Qfe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),tag:r}){try{return tt("fs",e),tt("gitdir",n),tt("tag",r),await Jfe({fs:new un(e),gitdir:n,tag:r})}catch(s){throw s.caller="git.writeTag",s}}async function ehe({fs:e,dir:t,gitdir:n=Mt.join(t,".git"),tree:r}){try{return tt("fs",e),tt("gitdir",n),tt("tree",r),await wb({fs:new un(e),gitdir:n,tree:r})}catch(s){throw s.caller="git.writeTree",s}}var Ls={Errors:Aue,STAGE:wm,TREE:so,WORKDIR:bb,add:Gue,abortMerge:Uue,addNote:Wue,addRemote:Zue,annotatedTag:Xue,branch:Que,checkout:S$,clone:dde,commit:fde,getConfig:Mde,getConfigAll:Pde,setConfig:Ife,currentBranch:hde,deleteBranch:mde,deleteRef:gde,deleteRemote:bde,deleteTag:wde,expandOid:Ede,expandRef:Cde,fastForward:Rde,fetch:Nde,findMergeBase:Ide,findRoot:jde,getRemoteInfo:Dde,getRemoteInfo2:Fde,hashBlob:Bde,indexPack:zde,init:Ude,isDescendent:qde,isIgnored:Vde,listBranches:Hde,listFiles:Kde,listNotes:Zde,listRefs:Yde,listRemotes:Jde,listServerRefs:tfe,listTags:nfe,log:afe,merge:ofe,packObjects:ufe,pull:dfe,push:gfe,readBlob:yfe,readCommit:B$,readNote:vfe,readObject:wfe,readTag:_fe,readTree:Sfe,remove:Efe,removeNote:kfe,renameBranch:Afe,resetIndex:Rfe,updateIndex:Hfe,resolveRef:Nfe,status:zfe,statusMatrix:qfe,tag:Vfe,version:Gfe,walk:Kfe,writeBlob:Wfe,writeCommit:Zfe,writeObject:Yfe,writeRef:Xfe,writeTag:Qfe,writeTree:ehe,stash:$fe};function the(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function nhe(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:the(e)}async function rhe(e,t){const n=nhe(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function she(e){let t=0;const n=[];await rhe(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function ihe(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function ahe({onProgress:e,url:t,method:n="GET",headers:r={},body:s}){s&&(s=await she(s));const i=await fetch(t,{method:n,headers:r,body:s}),a=i.body&&i.body.getReader?ihe(i.body):[new Uint8Array(await i.arrayBuffer())];r={};for(const[o,l]of i.headers.entries())r[o]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:a,headers:r}}var oy={request:ahe};const ly="https://cors.isomorphic-git.org",Zp=new Map,H$=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=ir.getState();if(!n||!r)return Le.error("Git user name and email must be configured in Settings before committing."),!1;try{const s=await Ls.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),i=await Ls.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return s!==n&&await Ls.setConfig({fs:t,dir:e,path:"user.name",value:n}),i!==r&&await Ls.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(s){return console.error("[VFS Git Op] Error checking/setting Git config:",s),Le.error(`Failed to configure Git user: ${s instanceof Error?s.message:String(s)}`),!1}},cy=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=Zp.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const s=window.prompt(`Enter username for ${e}`);if(!s)return Le.error("Authentication cancelled: Username not provided."),null;const i=window.prompt(`Enter password or token for ${s}@${e}`);return i?(Zp.set(n,{username:s,password:i}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:s,password:i,authScheme:"Basic"}):(Le.error("Authentication cancelled: Password/token not provided."),null)},uy=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),Zp.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),Zp.delete(n)),null},dy=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!Zp.has(n)&&t.username&&t.password&&(Zp.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},_p=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let s="";if(r)try{const i=JSON.parse(r);s=i.message||i.error||JSON.stringify(i)}catch{s=r}return`HTTP ${t} ${n}${s?`: ${s}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},ohe=async(e,t)=>{const n=ii,r=ar(e),s=Pl(r,".git");try{return(await n.promises.stat(s)).isDirectory()}catch(i){return i instanceof Error&&i.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,i),!1}},G$=async(e,t,n,r,s)=>{var o;const i=(s==null?void 0:s.fsInstance)??ii,a=ar(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${a}`);try{let l=!1;try{await i.promises.stat(Pl(a,".git")),l=!0}catch(m){if(m.code!=="ENOENT")throw m}if(l)throw console.warn(`[VFS Git Op] Clone target ${a} already contains a .git directory.`),new Error(`Repository already cloned at ${a}.`);const c=__(a);if(c!=="/")try{await i.promises.mkdir(c,{recursive:!0})}catch(m){if(m.code!=="EEXIST")throw m}let u=n;if(!u)try{if(u=(o=(await Ls.getRemoteInfo({http:oy,url:t,corsProxy:ly,onAuth:g=>cy(g,r),onAuthFailure:uy,onAuthSuccess:dy})).HEAD)==null?void 0:o.replace("refs/heads/",""),!u)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${u}`)}catch(m){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",m),new Error(`Failed to determine default branch: ${_p(m)}`)}await Ls.clone({fs:i,http:oy,dir:a,corsProxy:ly,url:t,ref:u,singleBranch:!0,depth:10,onAuth:m=>cy(m,r),onAuthFailure:uy,onAuthSuccess:dy,onProgress:m=>{m.phase==="counting objects"&&m.total?console.log(`Clone progress: ${m.phase} ${m.loaded}/${m.total}`):m.phase==="receiving objects"&&m.total?console.log(`Clone progress: ${m.phase} ${m.loaded}/${m.total}`):console.log(`Clone progress: ${m.phase}`)}}),await i.promises.stat(Pl(a,".git"));const f=await Ls.currentBranch({fs:i,dir:a,fullname:!1}).catch(()=>null);f!==u&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${f}, expected ${u}. Checking out...`),await Ls.checkout({fs:i,dir:a,ref:u})),Le.success(`Repository cloned successfully into ${a} (branch: ${u}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const c=_p(l);if(l instanceof Error&&l.message.includes("already cloned")||Le.error(`Git clone failed: ${c}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${a}`),await i.promises.rm(a,{recursive:!0,force:!0})}catch(u){console.warn("[VFS Git Op] Failed cleanup after clone error:",u)}throw l}},K$=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ii,r=ar(e);try{await Ls.init({fs:n,dir:r}),Le.success(`Initialized empty Git repository in "${ws(r)}"`)}catch(s){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,s),Le.error(`Git init failed: ${s instanceof Error?s.message:String(s)}`),s}},AN=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ii,s=ar(e);try{if(!await H$(s,r))throw new Error("Git user configuration is missing or invalid.");if(await Ls.add({fs:r,dir:s,filepath:"."}),!(await Ls.statusMatrix({fs:r,dir:s})).some(([,,c])=>c!==0)){Le.info("No changes detected to commit.");return}const l=await Ls.commit({fs:r,dir:s,message:t,author:{name:ir.getState().gitUserName,email:ir.getState().gitUserEmail}});Le.success(`Changes committed: ${l.substring(0,7)}`)}catch(i){throw console.error(`[VFS Git Op] Git commit failed for ${s}:`,i),Le.error(`Git commit failed: ${i instanceof Error?i.message:String(i)}`),i}},A_=async(e,t,n,r)=>{const s=(r==null?void 0:r.fsInstance)??ii,i=ar(e);try{if(!await H$(i,s))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${i}`);const o=await Ls.currentBranch({fs:s,dir:i,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await Ls.checkout({fs:s,dir:i,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await Ls.fetch({fs:s,http:oy,dir:i,corsProxy:ly,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:c=>cy(c,n),onAuthFailure:uy,onAuthSuccess:dy}),await Ls.branch({fs:s,dir:i,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(c){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,c),new Error(`Failed to switch to or create local branch "${t}": ${_p(c)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${_p(l)}`)}}await Ls.pull({fs:s,http:oy,dir:i,ref:t,singleBranch:!0,author:{name:ir.getState().gitUserName,email:ir.getState().gitUserEmail},corsProxy:ly,onAuth:l=>cy(l,n),onAuthFailure:uy,onAuthSuccess:dy}),Le.success(`Pulled changes successfully for "${ws(i)}"`),console.log(`[VFS Git Op] Pull successful for ${i}`)}catch(a){if(console.error(`[VFS Git Op] Git pull failed for ${i}:`,a),a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")?Le.info(`Branch "${t}" is already up-to-date.`):Le.error(`Git pull failed: ${_p(a)}`),!(a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")))throw a}},RN=async(e,t,n,r)=>{var a,o;const s=(r==null?void 0:r.fsInstance)??ii,i=ar(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${i}`);const l=await Ls.push({fs:s,http:oy,dir:i,corsProxy:ly,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:c=>cy(c,n),onAuthFailure:uy,onAuthSuccess:dy});if(l!=null&&l.ok)Le.success(`Pushed changes successfully for "${ws(i)}"`);else if((a=l==null?void 0:l.error)!=null&&a.includes("up-to-date"))Le.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(Le.error(`Push rejected for "${ws(i)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${i}:`,l),l instanceof Error&&l.message.includes("rejected")||Le.error(`Git push failed: ${_p(l)}`),l}},W$=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ii,r=ar(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const s=await Ls.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",s);const i=s.map(([a,o,l,c])=>{let u="";return c===2&&(u+="INDEX_Modified "),c===3&&(u+="INDEX_Added "),o===0&&l===2?u+="WT_New":o===1&&l===2?u+="WT_Modified":o===1&&l===0?u+="WT_Deleted":o===1&&l===1&&c===0&&(u="Unmodified"),(!u||u==="INDEX_Unmodified ")&&(u=`h:${o} w:${l} s:${c}`),`${a}: ${u.trim()}`}).filter(a=>!a.endsWith("Unmodified")).join(`
`);Le.info(`Git Status for "${ws(r)}":
${i||"No changes"}`,{duration:15e3})}catch(s){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,s),Le.error(`Git status failed: ${s instanceof Error?s.message:String(s)}`),s}},Mf=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ii,r=ar(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(s){if(s instanceof Error&&s.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,s),Le.error(`Error creating directory "${ws(r)}": ${s instanceof Error?s.message:String(s)}`),s}},lhe=async e=>{try{const t={backend:dce,name:`litechat_vfs_${e}`};return await rce(t),ii}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),Le.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},NN=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ii,r=ar(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await Mf(r,{fsInstance:n}),[];throw l}const i=(await n.promises.readdir(r)).map(async l=>{const c=Pl(r,l);try{const u=await n.promises.stat(c);return{name:l,path:c,isDirectory:u.isDirectory(),size:u.size,lastModified:u.mtime}}catch(u){return console.error(`[VFS Op] Failed to stat ${c}:`,u),null}});return(await Promise.all(i)).filter(l=>l!==null)}catch(s){throw console.error(`[VFS Op] Failed to list directory ${r}:`,s),Le.error(`Error listing files: ${s instanceof Error?s.message:String(s)}`),s}},Sd=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ii,r=ar(e);try{const s=await n.promises.readFile(r);return Be.emit(en.fileRead,{path:r}),s}catch(s){throw console.error(`[VFS Op] Failed to read file ${r}:`,s),Le.error(`Error reading file "${ws(r)}": ${s instanceof Error?s.message:String(s)}`),s}},R_=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ii,s=ar(e),i=__(s);try{i!=="/"&&await Mf(i,{fsInstance:r}),await r.promises.writeFile(s,t),Be.emit(en.fileWritten,{path:s})}catch(a){throw a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${s}:`,a),Le.error(`Error writing file "${ws(s)}": ${a instanceof Error?a.message:String(a)}`)),a}},IN=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??ii,s=ar(e);if(s==="/")throw Le.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(s)).isDirectory()?(await r.promises.rm(s,{recursive:t}),Be.emit(en.fileDeleted,{path:s})):(await r.promises.unlink(s),Be.emit(en.fileDeleted,{path:s})),Le.success(`"${ws(s)}" deleted.`)}catch(i){if(i instanceof Error&&i.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${s}`);return}throw console.error(`[VFS Op] Failed to delete ${s}:`,i),Le.error(`Error deleting "${ws(s)}": ${i instanceof Error?i.message:String(i)}`),i}},Z$=async(e,t)=>{await Mf(e,t)},che=async(e,t,n)=>{try{const r=await Sd(e,n),s=new Blob([r]),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i;const o=ar(e);a.download=t||ws(o),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||Le.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},Y$=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ii,s=ar(t);let i=0,a=0;const o=Array.from(e);try{await Mf(s,{fsInstance:r});for(const l of o){const c=Pl(s,l.name);try{const u=await l.arrayBuffer();await R_(c,new Uint8Array(u),{fsInstance:r}),i++}catch(u){a++,console.error(`[VFS Op] Failed to upload ${l.name}:`,u)}}}catch(l){a=o.length,console.error(`[VFS Op] Failed to prepare target directory ${s} for upload:`,l)}finally{a>0&&i>0?Le.warning(`Upload complete with issues. ${i} succeeded, ${a} failed.`):a===0&&i>0&&Le.success(`Successfully uploaded ${i} file(s) to ${s==="/"?"root":ws(s)}.`)}},uhe=async(e,t,n)=>{const r=ii;if(!e.name.toLowerCase().endsWith(".zip")){Le.error("Please select a valid ZIP file.");return}const s=ar(t);let i;try{await Mf(s,{fsInstance:r}),i=await JB.loadAsync(e);const a=Object.values(i.files),o=await Promise.allSettled(a.map(async f=>{const m=Pl(s,f.name);if(f.dir)await Mf(m,{fsInstance:r});else{const g=await f.async("uint8array");await R_(m,g,{fsInstance:r})}return{name:f.name,isDir:f.dir}}));let l=0,c=0,u=0;o.forEach(f=>{f.status==="fulfilled"&&f.value?f.value.isDir?c++:l++:f.status==="rejected"&&(u++,console.error("[VFS Op] ZIP Extraction item failed:",f.reason))}),u>0?Le.warning(`Finished extracting "${e.name}". ${l+c} items succeeded, ${u} failed.`):Le.success(`Successfully extracted ${l} files and ${c} folders from "${e.name}" to ${s==="/"?"root":ws(s)}.`)}catch(a){a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,a),Le.error(`ZIP extraction failed: ${a instanceof Error?a.message:String(a)}`))}},_P=async(e,t="/",n)=>{const r=ii,s=new JB,i=ar(t),a=ws(i)||"root";try{try{if(!(await r.promises.stat(i)).isDirectory()){Le.error(`Cannot export: "${a}" is not a directory.`);return}}catch(m){m instanceof Error&&m.code==="ENOENT"?Le.error(`Cannot export: Path "${a}" not found.`):Le.error(`Cannot export: Error accessing path "${a}". ${m instanceof Error?m.message:String(m)}`);return}const o=async(m,g)=>{const v=await NN(m,{fsInstance:r});for(const b of v)if(b.isDirectory){if(b.name===".git")continue;const w=g.folder(b.name);if(w)await o(b.path,w);else throw new Error(`Failed to create subfolder ${b.name} in zip.`)}else{const w=await Sd(b.path,{fsInstance:r});g.file(b.name,w)}};await o(i,s);const l=await s.generateAsync({type:"blob"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c;const f=`vfs_${a}_export.zip`;u.download=e||f,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),Le.success(`"${a}" exported as ${u.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||Le.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},X$=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ii,s=ar(e),i=ar(t);if(s==="/"||i==="/")throw Le.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(s!==i)try{const a=__(i);a!=="/"&&await Mf(a,{fsInstance:r}),await r.promises.rename(s,i),Le.success(`Renamed "${ws(s)}" to "${ws(i)}"`)}catch(a){throw a instanceof Error&&a.code==="ENOENT"?a.message.includes("Error creating directory")||Le.error(`Rename failed: Original item "${ws(s)}" not found.`):a instanceof Error&&a.code==="EEXIST"?Le.error(`Rename failed: An item named "${ws(i)}" already exists.`):a instanceof Error&&a.message.includes("Error creating directory")||Le.error(`Rename failed: ${a instanceof Error?a.message:String(a)}`),console.error(`[VFS Op] Failed to rename ${s} to ${i}:`,a),a}},dhe=1024*5,fhe=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const s=new Uint8Array(r),i=new Blob([s],{type:t});return URL.createObjectURL(i)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},SP=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const s=new Uint8Array(r);t=new Blob([s],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},J$=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,s]=T.useState(null),[i,a]=T.useState(null),[o,l]=T.useState(!1),[c,u]=T.useState(!1),[f,m]=T.useState(!0),g=e.type||"application/octet-stream",v=I0(e.name,g),b=g.startsWith("image/"),w=g.startsWith("audio/"),x=g.startsWith("video/"),_=e.source==="vfs";T.useEffect(()=>{let M=null;return a(null),e.source==="direct"&&!v&&e.contentBase64?(M=fhe(e.contentBase64,g),M||a("Failed to decode file content for preview."),s(M)):s(null),e.source==="direct"&&v&&e.contentText&&e.contentText.length>dhe?a(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&v&&e.contentText===void 0&&a("Text content missing from metadata."),()=>{M&&(URL.revokeObjectURL(M),s(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,g,v]);const E=async()=>{if(e.source==="vfs"){Le.info("File is already in VFS.");return}const M=SP(e);if(!M){Le.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await Y$([M],"/"),Le.success(`"${e.name}" added to VFS root.`)}catch(L){console.error("Failed to add file to VFS:",L),Le.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},C=async()=>{u(!0);try{let M;if(e.source==="vfs"&&e.path){const P=await Sd(e.path);M=new Blob([P],{type:g})}else{const P=SP(e);if(!P)throw new Error("Could not reconstruct file data.");M=P}const L=URL.createObjectURL(M),q=document.createElement("a");q.href=L,q.download=e.name,document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(L)}catch(M){console.error("Failed to download file:",M),Le.error(`Download failed: ${M instanceof Error?M.message:String(M)}`)}finally{u(!1)}},k=()=>m(M=>!M),R=()=>_?p.jsx(pR,{className:"h-5 w-5 text-cyan-500"}):v?p.jsx(tX,{className:"h-5 w-5 text-blue-500"}):b?p.jsx(Ef,{className:"h-5 w-5 text-purple-500"}):w?p.jsx(PX,{className:"h-5 w-5 text-green-500"}):x?p.jsx(kJ,{className:"h-5 w-5 text-orange-500"}):p.jsx(QY,{className:"h-5 w-5 text-muted-foreground"}),I=()=>_?p.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):i?p.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[p.jsx(Ac,{className:"h-4 w-4"}),p.jsx("span",{children:i})]}):v&&e.contentText!==void 0?p.jsx(hm,{lang:g==="text/markdown"?"markdown":"text",code:e.contentText}):b&&r?p.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):w&&r?p.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):x&&r?p.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):p.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),j=T.useMemo(()=>{let M="File";return _?M="VFS File":v?M="Text":b?M="Image":w?M="Audio":x&&(M="Video"),`${M} (${ry(e.size)})`},[_,v,b,w,x,e.size]);return p.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[p.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[p.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[R(),p.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),p.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",ry(e.size),")"]}),_&&e.path&&p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),p.jsx(cr,{children:p.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),p.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:C,disabled:c,"aria-label":"Download file",children:c?p.jsx(Pn,{className:"h-3.5 w-3.5 animate-spin"}):p.jsx(vf,{className:"h-3.5 w-3.5"})})}),p.jsx(cr,{children:"Download File"})]})}),p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:k,"aria-label":f?"Unfold preview":"Fold preview",children:p.jsx(M1,{className:"h-3.5 w-3.5"})})}),p.jsx(cr,{side:"top",children:f?"Unfold":"Fold"})]})}),!n&&t&&p.jsxs(p.Fragment,{children:[e.source==="direct"&&p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:E,disabled:o,"aria-label":"Add to VFS",children:o?p.jsx(Pn,{className:"h-3.5 w-3.5 animate-spin"}):p.jsx(rF,{className:"h-3.5 w-3.5"})})}),p.jsx(cr,{children:"Add to VFS"})]})}),p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:p.jsx(la,{className:"h-3.5 w-3.5"})})}),p.jsx(cr,{children:"Remove from Prompt"})]})})]})]})]}),f?p.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:k,children:j}):p.jsx("div",{className:ct("p-2 max-h-80 overflow-y-auto"),children:I()})]})},Q$=6048e5,hhe=864e5,bw=43200,EP=1440,CP=Symbol.for("constructDateFrom");function Dc(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&CP in e?e[CP](t):e instanceof Date?new e.constructor(t):new Date(t)}function ni(e,t){return Dc(t||e,e)}let phe={};function _b(){return phe}function fy(e,t){var o,l,c,u;const n=_b(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=ni(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?7:0)+i-r;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function r1(e,t){return fy(e,{...t,weekStartsOn:1})}function ez(e,t){const n=ni(e,t==null?void 0:t.in),r=n.getFullYear(),s=Dc(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=r1(s),a=Dc(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=r1(a);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function s1(e){const t=ni(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function N_(e,...t){const n=Dc.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function kP(e,t){const n=ni(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function mhe(e,t,n){const[r,s]=N_(n==null?void 0:n.in,e,t),i=kP(r),a=kP(s),o=+i-s1(i),l=+a-s1(a);return Math.round((o-l)/hhe)}function ghe(e,t){const n=ez(e,t),r=Dc(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),r1(r)}function Xw(e,t){const n=+ni(e)-+ni(t);return n<0?-1:n>0?1:n}function yhe(e){return Dc(e,Date.now())}function bhe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function vhe(e){return!(!bhe(e)&&typeof e!="number"||isNaN(+ni(e)))}function whe(e,t,n){const[r,s]=N_(n==null?void 0:n.in,e,t),i=r.getFullYear()-s.getFullYear(),a=r.getMonth()-s.getMonth();return i*12+a}function xhe(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function _he(e,t){return+ni(e)-+ni(t)}function She(e,t){const n=ni(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function Ehe(e,t){const n=ni(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function Che(e,t){const n=ni(e,t==null?void 0:t.in);return+She(n,t)==+Ehe(n,t)}function khe(e,t,n){const[r,s,i]=N_(n==null?void 0:n.in,e,e,t),a=Xw(s,i),o=Math.abs(whe(s,i));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=Xw(s,i)===-a;Che(r)&&o===1&&Xw(r,i)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function The(e,t,n){const r=_he(e,t)/1e3;return xhe(n==null?void 0:n.roundingMethod)(r)}function Ahe(e,t){const n=ni(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const Rhe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Nhe=(e,t,n)=>{let r;const s=Rhe[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function pk(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const Ihe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},jhe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Mhe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ohe={date:pk({formats:Ihe,defaultWidth:"full"}),time:pk({formats:jhe,defaultWidth:"full"}),dateTime:pk({formats:Mhe,defaultWidth:"full"})},Phe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Dhe=(e,t,n,r)=>Phe[e];function Zg(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const Fhe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Lhe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Bhe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},$he={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},zhe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Uhe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},qhe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Vhe={ordinalNumber:qhe,era:Zg({values:Fhe,defaultWidth:"wide"}),quarter:Zg({values:Lhe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Zg({values:Bhe,defaultWidth:"wide"}),day:Zg({values:$he,defaultWidth:"wide"}),dayPeriod:Zg({values:zhe,defaultWidth:"wide",formattingValues:Uhe,defaultFormattingWidth:"wide"})};function Yg(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?Ghe(o,f=>f.test(a)):Hhe(o,f=>f.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function Hhe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function Ghe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Khe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const Whe=/^(\d+)(th|st|nd|rd)?/i,Zhe=/\d+/i,Yhe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Xhe={any:[/^b/i,/^(a|c)/i]},Jhe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Qhe={any:[/1/i,/2/i,/3/i,/4/i]},epe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},tpe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},npe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},rpe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},spe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ipe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ape={ordinalNumber:Khe({matchPattern:Whe,parsePattern:Zhe,valueCallback:e=>parseInt(e,10)}),era:Yg({matchPatterns:Yhe,defaultMatchWidth:"wide",parsePatterns:Xhe,defaultParseWidth:"any"}),quarter:Yg({matchPatterns:Jhe,defaultMatchWidth:"wide",parsePatterns:Qhe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Yg({matchPatterns:epe,defaultMatchWidth:"wide",parsePatterns:tpe,defaultParseWidth:"any"}),day:Yg({matchPatterns:npe,defaultMatchWidth:"wide",parsePatterns:rpe,defaultParseWidth:"any"}),dayPeriod:Yg({matchPatterns:spe,defaultMatchWidth:"any",parsePatterns:ipe,defaultParseWidth:"any"})},tz={code:"en-US",formatDistance:Nhe,formatLong:Ohe,formatRelative:Dhe,localize:Vhe,match:ape,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ope(e,t){const n=ni(e,t==null?void 0:t.in);return mhe(n,Ahe(n))+1}function lpe(e,t){const n=ni(e,t==null?void 0:t.in),r=+r1(n)-+ghe(n);return Math.round(r/Q$)+1}function nz(e,t){var u,f,m,g;const n=ni(e,t==null?void 0:t.in),r=n.getFullYear(),s=_b(),i=(t==null?void 0:t.firstWeekContainsDate)??((f=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((g=(m=s.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??1,a=Dc((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,i),a.setHours(0,0,0,0);const o=fy(a,t),l=Dc((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=fy(l,t);return+n>=+o?r+1:+n>=+c?r:r-1}function cpe(e,t){var o,l,c,u;const n=_b(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=nz(e,t),i=Dc((t==null?void 0:t.in)||e,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),fy(i,t)}function upe(e,t){const n=ni(e,t==null?void 0:t.in),r=+fy(n,t)-+cpe(n,t);return Math.round(r/Q$)+1}function Nr(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Ru={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Nr(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Nr(n+1,2)},d(e,t){return Nr(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Nr(e.getHours()%12||12,t.length)},H(e,t){return Nr(e.getHours(),t.length)},m(e,t){return Nr(e.getMinutes(),t.length)},s(e,t){return Nr(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return Nr(s,t.length)}},Yh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},TP={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Ru.y(e,t)},Y:function(e,t,n,r){const s=nz(e,r),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return Nr(a,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):Nr(i,t.length)},R:function(e,t){const n=ez(e);return Nr(n,t.length)},u:function(e,t){const n=e.getFullYear();return Nr(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Nr(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Nr(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Ru.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Nr(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=upe(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):Nr(s,t.length)},I:function(e,t,n){const r=lpe(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):Nr(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Ru.d(e,t)},D:function(e,t,n){const r=ope(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Nr(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Nr(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Nr(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return Nr(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=Yh.noon:r===0?s=Yh.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=Yh.evening:r>=12?s=Yh.afternoon:r>=4?s=Yh.morning:s=Yh.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Ru.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Ru.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Nr(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):Nr(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ru.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Ru.s(e,t)},S:function(e,t){return Ru.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return RP(r);case"XXXX":case"XX":return of(r);case"XXXXX":case"XXX":default:return of(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return RP(r);case"xxxx":case"xx":return of(r);case"xxxxx":case"xxx":default:return of(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+AP(r,":");case"OOOO":default:return"GMT"+of(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+AP(r,":");case"zzzz":default:return"GMT"+of(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return Nr(r,t.length)},T:function(e,t,n){return Nr(+e,t.length)}};function AP(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+t+Nr(i,2)}function RP(e,t){return e%60===0?(e>0?"-":"+")+Nr(Math.abs(e)/60,2):of(e,t)}function of(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Nr(Math.trunc(r/60),2),i=Nr(r%60,2);return n+s+t+i}const NP=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},rz=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},dpe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return NP(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",NP(r,t)).replace("{{time}}",rz(s,t))},fpe={p:rz,P:dpe},hpe=/^D+$/,ppe=/^Y+$/,mpe=["D","DD","YY","YYYY"];function gpe(e){return hpe.test(e)}function ype(e){return ppe.test(e)}function bpe(e,t,n){const r=vpe(e,t,n);if(console.warn(r),mpe.includes(e))throw new RangeError(r)}function vpe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const wpe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,xpe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,_pe=/^'([^]*?)'?$/,Spe=/''/g,Epe=/[a-zA-Z]/;function cA(e,t,n){var u,f,m,g;const r=_b(),s=r.locale??tz,i=r.firstWeekContainsDate??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,a=r.weekStartsOn??((g=(m=r.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??0,o=ni(e,n==null?void 0:n.in);if(!vhe(o))throw new RangeError("Invalid time value");let l=t.match(xpe).map(v=>{const b=v[0];if(b==="p"||b==="P"){const w=fpe[b];return w(v,s.formatLong)}return v}).join("").match(wpe).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const b=v[0];if(b==="'")return{isToken:!1,value:Cpe(v)};if(TP[b])return{isToken:!0,value:v};if(b.match(Epe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:v}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return l.map(v=>{if(!v.isToken)return v.value;const b=v.value;(ype(b)||gpe(b))&&bpe(b,t,String(e));const w=TP[b[0]];return w(o,b,s.localize,c)}).join("")}function Cpe(e){const t=e.match(_pe);return t?t[1].replace(Spe,"'"):e}function kpe(e,t,n){const r=_b(),s=(n==null?void 0:n.locale)??r.locale??tz,i=2520,a=Xw(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[l,c]=N_(n==null?void 0:n.in,...a>0?[t,e]:[e,t]),u=The(c,l),f=(s1(c)-s1(l))/1e3,m=Math.round((u-f)/60);let g;if(m<2)return n!=null&&n.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,o):u<10?s.formatDistance("lessThanXSeconds",10,o):u<20?s.formatDistance("lessThanXSeconds",20,o):u<40?s.formatDistance("halfAMinute",0,o):u<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):m===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",m,o);if(m<45)return s.formatDistance("xMinutes",m,o);if(m<90)return s.formatDistance("aboutXHours",1,o);if(m<EP){const v=Math.round(m/60);return s.formatDistance("aboutXHours",v,o)}else{if(m<i)return s.formatDistance("xDays",1,o);if(m<bw){const v=Math.round(m/EP);return s.formatDistance("xDays",v,o)}else if(m<bw*2)return g=Math.round(m/bw),s.formatDistance("aboutXMonths",g,o)}if(g=khe(c,l),g<12){const v=Math.round(m/bw);return s.formatDistance("xMonths",v,o)}else{const v=g%12,b=Math.trunc(g/12);return v<3?s.formatDistance("aboutXYears",b,o):v<9?s.formatDistance("overXYears",b,o):s.formatDistance("almostXYears",b+1,o)}}function sz(e,t){return kpe(e,yhe(e),t)}const gn=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:s,disabled:i,variant:a="ghost",size:o="icon",className:l,"aria-label":c,...u})=>{const f=typeof t=="function";return p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:a,size:o,onClick:s,disabled:i,className:ct("h-6 w-6",l),"aria-label":c??e,...u,children:f?p.jsx(t,{className:ct("h-3.5 w-3.5",n)}):t})}),p.jsx(cr,{side:r,children:p.jsx("p",{children:e})})]})})},IP={};function Tpe(e){let t=IP[e];if(t)return t;t=IP[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function Yp(e,t){typeof t!="string"&&(t=Yp.defaultChars);const n=Tpe(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let s="";for(let i=0,a=r.length;i<a;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){s+=n[o];continue}if((o&224)===192&&i+3<a){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const c=o<<6&1984|l&63;c<128?s+="":s+=String.fromCharCode(c),i+=3;continue}}if((o&240)===224&&i+6<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(c&192)===128){const u=o<<12&61440|l<<6&4032|c&63;u<2048||u>=55296&&u<=57343?s+="":s+=String.fromCharCode(u),i+=6;continue}}if((o&248)===240&&i+9<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16),u=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(c&192)===128&&(u&192)===128){let f=o<<18&1835008|l<<12&258048|c<<6&4032|u&63;f<65536||f>1114111?s+="":(f-=65536,s+=String.fromCharCode(55296+(f>>10),56320+(f&1023))),i+=9;continue}}s+=""}return s})}Yp.defaultChars=";/?:@&=+$,#";Yp.componentChars="";const jP={};function Ape(e){let t=jP[e];if(t)return t;t=jP[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function Sb(e,t,n){typeof t!="string"&&(n=t,t=Sb.defaultChars),typeof n>"u"&&(n=!0);const r=Ape(t);let s="";for(let i=0,a=e.length;i<a;i++){const o=e.charCodeAt(i);if(n&&o===37&&i+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3))){s+=e.slice(i,i+3),i+=2;continue}if(o<128){s+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<a){const l=e.charCodeAt(i+1);if(l>=56320&&l<=57343){s+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}s+="%EF%BF%BD";continue}s+=encodeURIComponent(e[i])}return s}Sb.defaultChars=";/?:@&=+$,-_.!~*'()#";Sb.componentChars="-_.!~*'()";function jN(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function i1(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const Rpe=/^([a-z0-9.+-]+:)/i,Npe=/:[0-9]*$/,Ipe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,jpe=["<",">",'"',"`"," ","\r",`
`,"	"],Mpe=["{","}","|","\\","^","`"].concat(jpe),Ope=["'"].concat(Mpe),MP=["%","/","?",";","#"].concat(Ope),OP=["/","?","#"],Ppe=255,PP=/^[+a-z0-9A-Z_-]{0,63}$/,Dpe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,DP={javascript:!0,"javascript:":!0},FP={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function MN(e,t){if(e&&e instanceof i1)return e;const n=new i1;return n.parse(e,t),n}i1.prototype.parse=function(e,t){let n,r,s,i=e;if(i=i.trim(),!t&&e.split("#").length===1){const c=Ipe.exec(i);if(c)return this.pathname=c[1],c[2]&&(this.search=c[2]),this}let a=Rpe.exec(i);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,i=i.substr(a.length)),(t||a||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=i.substr(0,2)==="//",s&&!(a&&DP[a])&&(i=i.substr(2),this.slashes=!0)),!DP[a]&&(s||a&&!FP[a])){let c=-1;for(let v=0;v<OP.length;v++)r=i.indexOf(OP[v]),r!==-1&&(c===-1||r<c)&&(c=r);let u,f;c===-1?f=i.lastIndexOf("@"):f=i.lastIndexOf("@",c),f!==-1&&(u=i.slice(0,f),i=i.slice(f+1),this.auth=u),c=-1;for(let v=0;v<MP.length;v++)r=i.indexOf(MP[v]),r!==-1&&(c===-1||r<c)&&(c=r);c===-1&&(c=i.length),i[c-1]===":"&&c--;const m=i.slice(0,c);i=i.slice(c),this.parseHost(m),this.hostname=this.hostname||"";const g=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!g){const v=this.hostname.split(/\./);for(let b=0,w=v.length;b<w;b++){const x=v[b];if(x&&!x.match(PP)){let _="";for(let E=0,C=x.length;E<C;E++)x.charCodeAt(E)>127?_+="x":_+=x[E];if(!_.match(PP)){const E=v.slice(0,b),C=v.slice(b+1),k=x.match(Dpe);k&&(E.push(k[1]),C.unshift(k[2])),C.length&&(i=C.join(".")+i),this.hostname=E.join(".");break}}}}this.hostname.length>Ppe&&(this.hostname=""),g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),FP[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};i1.prototype.parseHost=function(e){let t=Npe.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const Fpe=Object.freeze(Object.defineProperty({__proto__:null,decode:Yp,encode:Sb,format:jN,parse:MN},Symbol.toStringTag,{value:"Module"})),iz=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,az=/[\0-\x1F\x7F-\x9F]/,Lpe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,ON=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,oz=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,lz=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Bpe=Object.freeze(Object.defineProperty({__proto__:null,Any:iz,Cc:az,Cf:Lpe,P:ON,S:oz,Z:lz},Symbol.toStringTag,{value:"Module"})),$pe=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),zpe=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var mk;const Upe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),qpe=(mk=String.fromCodePoint)!==null&&mk!==void 0?mk:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function Vpe(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=Upe.get(e))!==null&&t!==void 0?t:e}var Js;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(Js||(Js={}));const Hpe=32;var Lu;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(Lu||(Lu={}));function uA(e){return e>=Js.ZERO&&e<=Js.NINE}function Gpe(e){return e>=Js.UPPER_A&&e<=Js.UPPER_F||e>=Js.LOWER_A&&e<=Js.LOWER_F}function Kpe(e){return e>=Js.UPPER_A&&e<=Js.UPPER_Z||e>=Js.LOWER_A&&e<=Js.LOWER_Z||uA(e)}function Wpe(e){return e===Js.EQUALS||Kpe(e)}var Ws;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(Ws||(Ws={}));var Pu;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(Pu||(Pu={}));class Zpe{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=Ws.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Pu.Strict}startEntity(t){this.decodeMode=t,this.state=Ws.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case Ws.EntityStart:return t.charCodeAt(n)===Js.NUM?(this.state=Ws.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=Ws.NamedEntity,this.stateNamedEntity(t,n));case Ws.NumericStart:return this.stateNumericStart(t,n);case Ws.NumericDecimal:return this.stateNumericDecimal(t,n);case Ws.NumericHex:return this.stateNumericHex(t,n);case Ws.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|Hpe)===Js.LOWER_X?(this.state=Ws.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=Ws.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(n,i),s),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(uA(s)||Gpe(s))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(uA(s))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Js.SEMI)this.consumed+=1;else if(this.decodeMode===Pu.Strict)return 0;return this.emitCodePoint(Vpe(this.result),this.consumed),this.errors&&(t!==Js.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&Lu.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const a=t.charCodeAt(n);if(this.treeIndex=Ype(r,s,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return this.result===0||this.decodeMode===Pu.Attribute&&(i===0||Wpe(a))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&Lu.VALUE_LENGTH)>>14,i!==0){if(a===Js.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==Pu.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,s=(r[n]&Lu.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[t]&~Lu.VALUE_LENGTH:s[t+1],r),n===3&&this.emitCodePoint(s[t+2],r),r}end(){var t;switch(this.state){case Ws.NamedEntity:return this.result!==0&&(this.decodeMode!==Pu.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Ws.NumericDecimal:return this.emitNumericEntity(0,2);case Ws.NumericHex:return this.emitNumericEntity(0,3);case Ws.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Ws.EntityStart:return 0}}}function cz(e){let t="";const n=new Zpe(e,r=>t+=qpe(r));return function(s,i){let a=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(a,o),n.startEntity(i);const c=n.write(s,o+1);if(c<0){a=o+n.end();break}a=o+c,o=c===0?a+1:a}const l=t+s.slice(a);return t="",l}}function Ype(e,t,n,r){const s=(t&Lu.BRANCH_LENGTH)>>7,i=t&Lu.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=s?-1:e[n+l]-1}let a=n,o=a+s-1;for(;a<=o;){const l=a+o>>>1,c=e[l];if(c<r)a=l+1;else if(c>r)o=l-1;else return e[l+s]}return-1}const Xpe=cz($pe);cz(zpe);function uz(e,t=Pu.Legacy){return Xpe(e,t)}function Jpe(e){return Object.prototype.toString.call(e)}function PN(e){return Jpe(e)==="[object String]"}const Qpe=Object.prototype.hasOwnProperty;function eme(e,t){return Qpe.call(e,t)}function I_(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function dz(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function DN(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function a1(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const fz=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,tme=/&([a-z#][a-z0-9]{1,31});/gi,nme=new RegExp(fz.source+"|"+tme.source,"gi"),rme=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function sme(e,t){if(t.charCodeAt(0)===35&&rme.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return DN(r)?a1(r):e}const n=uz(e);return n!==e?n:e}function ime(e){return e.indexOf("\\")<0?e:e.replace(fz,"$1")}function Xp(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(nme,function(t,n,r){return n||sme(t,r)})}const ame=/[&<>"]/,ome=/[&<>"]/g,lme={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function cme(e){return lme[e]}function id(e){return ame.test(e)?e.replace(ome,cme):e}const ume=/[.?*+^$[\]\\(){}|-]/g;function dme(e){return e.replace(ume,"\\$&")}function Kr(e){switch(e){case 9:case 32:return!0}return!1}function hy(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function py(e){return ON.test(e)||oz.test(e)}function my(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function j_(e){return e=e.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(e=e.replace(//g,"")),e.toLowerCase().toUpperCase()}const fme={mdurl:Fpe,ucmicro:Bpe},hme=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:dz,assign:I_,escapeHtml:id,escapeRE:dme,fromCodePoint:a1,has:eme,isMdAsciiPunct:my,isPunctChar:py,isSpace:Kr,isString:PN,isValidEntityCode:DN,isWhiteSpace:hy,lib:fme,normalizeReference:j_,unescapeAll:Xp,unescapeMd:ime},Symbol.toStringTag,{value:"Module"}));function pme(e,t,n){let r,s,i,a;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(i=e.src.charCodeAt(e.pos),i===93&&(r--,r===0)){s=!0;break}if(a=e.pos,e.md.inline.skipToken(e),i===91){if(a===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return s&&(c=e.pos),e.pos=l,c}function mme(e,t,n){let r,s=t;const i={ok:!1,pos:0,str:""};if(e.charCodeAt(s)===60){for(s++;s<n;){if(r=e.charCodeAt(s),r===10||r===60)return i;if(r===62)return i.pos=s+1,i.str=Xp(e.slice(t+1,s)),i.ok=!0,i;if(r===92&&s+1<n){s+=2;continue}s++}return i}let a=0;for(;s<n&&(r=e.charCodeAt(s),!(r===32||r<32||r===127));){if(r===92&&s+1<n){if(e.charCodeAt(s+1)===32)break;s+=2;continue}if(r===40&&(a++,a>32))return i;if(r===41){if(a===0)break;a--}s++}return t===s||a!==0||(i.str=Xp(e.slice(t,s)),i.pos=s,i.ok=!0),i}function gme(e,t,n,r){let s,i=t;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(i>=n)return a;let o=e.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return a;t++,i++,o===40&&(o=41),a.marker=o}for(;i<n;){if(s=e.charCodeAt(i),s===a.marker)return a.pos=i+1,a.str+=Xp(e.slice(t,i)),a.ok=!0,a;if(s===40&&a.marker===41)return a;s===92&&i+1<n&&i++,i++}return a.can_continue=!0,a.str+=Xp(e.slice(t,i)),a}const yme=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:mme,parseLinkLabel:pme,parseLinkTitle:gme},Symbol.toStringTag,{value:"Module"})),Bl={};Bl.code_inline=function(e,t,n,r,s){const i=e[t];return"<code"+s.renderAttrs(i)+">"+id(i.content)+"</code>"};Bl.code_block=function(e,t,n,r,s){const i=e[t];return"<pre"+s.renderAttrs(i)+"><code>"+id(e[t].content)+`</code></pre>
`};Bl.fence=function(e,t,n,r,s){const i=e[t],a=i.info?Xp(i.info).trim():"";let o="",l="";if(a){const u=a.split(/(\s+)/g);o=u[0],l=u.slice(2).join("")}let c;if(n.highlight?c=n.highlight(i.content,o,l)||id(i.content):c=id(i.content),c.indexOf("<pre")===0)return c+`
`;if(a){const u=i.attrIndex("class"),f=i.attrs?i.attrs.slice():[];u<0?f.push(["class",n.langPrefix+o]):(f[u]=f[u].slice(),f[u][1]+=" "+n.langPrefix+o);const m={attrs:f};return`<pre><code${s.renderAttrs(m)}>${c}</code></pre>
`}return`<pre><code${s.renderAttrs(i)}>${c}</code></pre>
`};Bl.image=function(e,t,n,r,s){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=s.renderInlineAsText(i.children,n,r),s.renderToken(e,t,n)};Bl.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};Bl.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Bl.text=function(e,t){return id(e[t].content)};Bl.html_block=function(e,t){return e[t].content};Bl.html_inline=function(e,t){return e[t].content};function Tm(){this.rules=I_({},Bl)}Tm.prototype.renderAttrs=function(t){let n,r,s;if(!t.attrs)return"";for(s="",n=0,r=t.attrs.length;n<r;n++)s+=" "+id(t.attrs[n][0])+'="'+id(t.attrs[n][1])+'"';return s};Tm.prototype.renderToken=function(t,n,r){const s=t[n];let i="";if(s.hidden)return"";s.block&&s.nesting!==-1&&n&&t[n-1].hidden&&(i+=`
`),i+=(s.nesting===-1?"</":"<")+s.tag,i+=this.renderAttrs(s),s.nesting===0&&r.xhtmlOut&&(i+=" /");let a=!1;if(s.block&&(a=!0,s.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===s.tag)&&(a=!1)}return i+=a?`>
`:">",i};Tm.prototype.renderInline=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r};Tm.prototype.renderInlineAsText=function(e,t,n){let r="";for(let s=0,i=e.length;s<i;s++)switch(e[s].type){case"text":r+=e[s].content;break;case"image":r+=this.renderInlineAsText(e[s].children,t,n);break;case"html_inline":case"html_block":r+=e[s].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};Tm.prototype.render=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;o==="inline"?r+=this.renderInline(e[i].children,t,n):typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r};function ua(){this.__rules__=[],this.__cache__=null}ua.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};ua.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};ua.prototype.at=function(e,t,n){const r=this.__find__(e),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=s.alt||[],this.__cache__=null};ua.prototype.before=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};ua.prototype.after=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};ua.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};ua.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!0,n.push(r)},this),this.__cache__=null,n};ua.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};ua.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!1,n.push(r)},this),this.__cache__=null,n};ua.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function Vo(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Vo.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,s=n.length;r<s;r++)if(n[r][0]===t)return r;return-1};Vo.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};Vo.prototype.attrSet=function(t,n){const r=this.attrIndex(t),s=[t,n];r<0?this.attrPush(s):this.attrs[r]=s};Vo.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};Vo.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function hz(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}hz.prototype.Token=Vo;const bme=/\r\n?|\n/g,vme=/\0/g;function wme(e){let t;t=e.src.replace(bme,`
`),t=t.replace(vme,""),e.src=t}function xme(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function _me(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const s=t[n];s.type==="inline"&&e.md.inline.parse(s.content,e.md,e.env,s.children)}}function Sme(e){return/^<a[>\s]/i.test(e)}function Eme(e){return/^<\/a\s*>/i.test(e)}function Cme(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let s=t[n].children,i=0;for(let a=s.length-1;a>=0;a--){const o=s[a];if(o.type==="link_close"){for(a--;s[a].level!==o.level&&s[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(Sme(o.content)&&i>0&&i--,Eme(o.content)&&i++),!(i>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let c=e.md.linkify.match(l);const u=[];let f=o.level,m=0;c.length>0&&c[0].index===0&&a>0&&s[a-1].type==="text_special"&&(c=c.slice(1));for(let g=0;g<c.length;g++){const v=c[g].url,b=e.md.normalizeLink(v);if(!e.md.validateLink(b))continue;let w=c[g].text;c[g].schema?c[g].schema==="mailto:"&&!/^mailto:/i.test(w)?w=e.md.normalizeLinkText("mailto:"+w).replace(/^mailto:/,""):w=e.md.normalizeLinkText(w):w=e.md.normalizeLinkText("http://"+w).replace(/^http:\/\//,"");const x=c[g].index;if(x>m){const k=new e.Token("text","",0);k.content=l.slice(m,x),k.level=f,u.push(k)}const _=new e.Token("link_open","a",1);_.attrs=[["href",b]],_.level=f++,_.markup="linkify",_.info="auto",u.push(_);const E=new e.Token("text","",0);E.content=w,E.level=f,u.push(E);const C=new e.Token("link_close","a",-1);C.level=--f,C.markup="linkify",C.info="auto",u.push(C),m=c[g].lastIndex}if(m<l.length){const g=new e.Token("text","",0);g.content=l.slice(m),g.level=f,u.push(g)}t[n].children=s=dz(s,a,u)}}}}const pz=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,kme=/\((c|tm|r)\)/i,Tme=/\((c|tm|r)\)/ig,Ame={c:"",r:"",tm:""};function Rme(e,t){return Ame[t.toLowerCase()]}function Nme(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(Tme,Rme)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function Ime(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&pz.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function jme(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(kme.test(e.tokens[t].content)&&Nme(e.tokens[t].children),pz.test(e.tokens[t].content)&&Ime(e.tokens[t].children))}const Mme=/['"]/,LP=/['"]/g,BP="";function vw(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function Ome(e,t){let n;const r=[];for(let s=0;s<e.length;s++){const i=e[s],a=e[s].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,c=o.length;e:for(;l<c;){LP.lastIndex=l;const u=LP.exec(o);if(!u)break;let f=!0,m=!0;l=u.index+1;const g=u[0]==="'";let v=32;if(u.index-1>=0)v=o.charCodeAt(u.index-1);else for(n=s-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){v=e[n].content.charCodeAt(e[n].content.length-1);break}let b=32;if(l<c)b=o.charCodeAt(l);else for(n=s+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){b=e[n].content.charCodeAt(0);break}const w=my(v)||py(String.fromCharCode(v)),x=my(b)||py(String.fromCharCode(b)),_=hy(v),E=hy(b);if(E?f=!1:x&&(_||w||(f=!1)),_?m=!1:w&&(E||x||(m=!1)),b===34&&u[0]==='"'&&v>=48&&v<=57&&(m=f=!1),f&&m&&(f=w,m=x),!f&&!m){g&&(i.content=vw(i.content,u.index,BP));continue}if(m)for(n=r.length-1;n>=0;n--){let C=r[n];if(r[n].level<a)break;if(C.single===g&&r[n].level===a){C=r[n];let k,R;g?(k=t.md.options.quotes[2],R=t.md.options.quotes[3]):(k=t.md.options.quotes[0],R=t.md.options.quotes[1]),i.content=vw(i.content,u.index,R),e[C.token].content=vw(e[C.token].content,C.pos,k),l+=R.length-1,C.token===s&&(l+=k.length-1),o=i.content,c=o.length,r.length=n;continue e}}f?r.push({token:s,pos:u.index,single:g,level:a}):m&&g&&(i.content=vw(i.content,u.index,BP))}}}function Pme(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!Mme.test(e.tokens[t].content)||Ome(e.tokens[t].children,e)}function Dme(e){let t,n;const r=e.tokens,s=r.length;for(let i=0;i<s;i++){if(r[i].type!=="inline")continue;const a=r[i].children,o=a.length;for(t=0;t<o;t++)a[t].type==="text_special"&&(a[t].type="text");for(t=n=0;t<o;t++)a[t].type==="text"&&t+1<o&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}}const gk=[["normalize",wme],["block",xme],["inline",_me],["linkify",Cme],["replacements",jme],["smartquotes",Pme],["text_join",Dme]];function FN(){this.ruler=new ua;for(let e=0;e<gk.length;e++)this.ruler.push(gk[e][0],gk[e][1])}FN.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};FN.prototype.State=hz;function $l(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const s=this.src;for(let i=0,a=0,o=0,l=0,c=s.length,u=!1;a<c;a++){const f=s.charCodeAt(a);if(!u)if(Kr(f)){o++,f===9?l+=4-l%4:l++;continue}else u=!0;(f===10||a===c-1)&&(f!==10&&a++,this.bMarks.push(i),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),u=!1,o=0,l=0,i=a+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}$l.prototype.push=function(e,t,n){const r=new Vo(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};$l.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};$l.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};$l.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Kr(r))break}return t};$l.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Kr(this.src.charCodeAt(--t)))return t+1;return t};$l.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};$l.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};$l.prototype.getLines=function(t,n,r,s){if(t>=n)return"";const i=new Array(n-t);for(let a=0,o=t;o<n;o++,a++){let l=0;const c=this.bMarks[o];let u=c,f;for(o+1<n||s?f=this.eMarks[o]+1:f=this.eMarks[o];u<f&&l<r;){const m=this.src.charCodeAt(u);if(Kr(m))m===9?l+=4-(l+this.bsCount[o])%4:l++;else if(u-c<this.tShift[o])l++;else break;u++}l>r?i[a]=new Array(l-r+1).join(" ")+this.src.slice(u,f):i[a]=this.src.slice(u,f)}return i.join("")};$l.prototype.Token=Vo;const Fme=65536;function yk(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function $P(e){const t=[],n=e.length;let r=0,s=e.charCodeAt(r),i=!1,a=0,o="";for(;r<n;)s===124&&(i?(o+=e.substring(a,r-1),a=r):(t.push(o+e.substring(a,r)),o="",a=r+1)),i=s===92,r++,s=e.charCodeAt(r);return t.push(o+e.substring(a)),t}function Lme(e,t,n,r){if(t+2>n)return!1;let s=t+1;if(e.sCount[s]<e.blkIndent||e.sCount[s]-e.blkIndent>=4)return!1;let i=e.bMarks[s]+e.tShift[s];if(i>=e.eMarks[s])return!1;const a=e.src.charCodeAt(i++);if(a!==124&&a!==45&&a!==58||i>=e.eMarks[s])return!1;const o=e.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!Kr(o)||a===45&&Kr(o))return!1;for(;i<e.eMarks[s];){const C=e.src.charCodeAt(i);if(C!==124&&C!==45&&C!==58&&!Kr(C))return!1;i++}let l=yk(e,t+1),c=l.split("|");const u=[];for(let C=0;C<c.length;C++){const k=c[C].trim();if(!k){if(C===0||C===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(k))return!1;k.charCodeAt(k.length-1)===58?u.push(k.charCodeAt(0)===58?"center":"right"):k.charCodeAt(0)===58?u.push("left"):u.push("")}if(l=yk(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;c=$P(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop();const f=c.length;if(f===0||f!==u.length)return!1;if(r)return!0;const m=e.parentType;e.parentType="table";const g=e.md.block.ruler.getRules("blockquote"),v=e.push("table_open","table",1),b=[t,0];v.map=b;const w=e.push("thead_open","thead",1);w.map=[t,t+1];const x=e.push("tr_open","tr",1);x.map=[t,t+1];for(let C=0;C<c.length;C++){const k=e.push("th_open","th",1);u[C]&&(k.attrs=[["style","text-align:"+u[C]]]);const R=e.push("inline","",0);R.content=c[C].trim(),R.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let _,E=0;for(s=t+2;s<n&&!(e.sCount[s]<e.blkIndent);s++){let C=!1;for(let R=0,I=g.length;R<I;R++)if(g[R](e,s,n,!0)){C=!0;break}if(C||(l=yk(e,s).trim(),!l)||e.sCount[s]-e.blkIndent>=4||(c=$P(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop(),E+=f-c.length,E>Fme))break;if(s===t+2){const R=e.push("tbody_open","tbody",1);R.map=_=[t+2,0]}const k=e.push("tr_open","tr",1);k.map=[s,s+1];for(let R=0;R<f;R++){const I=e.push("td_open","td",1);u[R]&&(I.attrs=[["style","text-align:"+u[R]]]);const j=e.push("inline","",0);j.content=c[R]?c[R].trim():"",j.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return _&&(e.push("tbody_close","tbody",-1),_[1]=s),e.push("table_close","table",-1),b[1]=s,e.parentType=m,e.line=s,!0}function Bme(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,s=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,s=r;continue}break}e.line=s;const i=e.push("code_block","code",0);return i.content=e.getLines(t,s,4+e.blkIndent,!1)+`
`,i.map=[t,e.line],!0}function $me(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||s+3>i)return!1;const a=e.src.charCodeAt(s);if(a!==126&&a!==96)return!1;let o=s;s=e.skipChars(s,a);let l=s-o;if(l<3)return!1;const c=e.src.slice(o,s),u=e.src.slice(s,i);if(a===96&&u.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let f=t,m=!1;for(;f++,!(f>=n||(s=o=e.bMarks[f]+e.tShift[f],i=e.eMarks[f],s<i&&e.sCount[f]<e.blkIndent));)if(e.src.charCodeAt(s)===a&&!(e.sCount[f]-e.blkIndent>=4)&&(s=e.skipChars(s,a),!(s-o<l)&&(s=e.skipSpaces(s),!(s<i)))){m=!0;break}l=e.sCount[t],e.line=f+(m?1:0);const g=e.push("fence","code",0);return g.info=u,g.content=e.getLines(t+1,f,l,!0),g.markup=c,g.map=[t,e.line],!0}function zme(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const a=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==62)return!1;if(r)return!0;const o=[],l=[],c=[],u=[],f=e.md.block.ruler.getRules("blockquote"),m=e.parentType;e.parentType="blockquote";let g=!1,v;for(v=t;v<n;v++){const E=e.sCount[v]<e.blkIndent;if(s=e.bMarks[v]+e.tShift[v],i=e.eMarks[v],s>=i)break;if(e.src.charCodeAt(s++)===62&&!E){let k=e.sCount[v]+1,R,I;e.src.charCodeAt(s)===32?(s++,k++,I=!1,R=!0):e.src.charCodeAt(s)===9?(R=!0,(e.bsCount[v]+k)%4===3?(s++,k++,I=!1):I=!0):R=!1;let j=k;for(o.push(e.bMarks[v]),e.bMarks[v]=s;s<i;){const M=e.src.charCodeAt(s);if(Kr(M))M===9?j+=4-(j+e.bsCount[v]+(I?1:0))%4:j++;else break;s++}g=s>=i,l.push(e.bsCount[v]),e.bsCount[v]=e.sCount[v]+1+(R?1:0),c.push(e.sCount[v]),e.sCount[v]=j-k,u.push(e.tShift[v]),e.tShift[v]=s-e.bMarks[v];continue}if(g)break;let C=!1;for(let k=0,R=f.length;k<R;k++)if(f[k](e,v,n,!0)){C=!0;break}if(C){e.lineMax=v,e.blkIndent!==0&&(o.push(e.bMarks[v]),l.push(e.bsCount[v]),u.push(e.tShift[v]),c.push(e.sCount[v]),e.sCount[v]-=e.blkIndent);break}o.push(e.bMarks[v]),l.push(e.bsCount[v]),u.push(e.tShift[v]),c.push(e.sCount[v]),e.sCount[v]=-1}const b=e.blkIndent;e.blkIndent=0;const w=e.push("blockquote_open","blockquote",1);w.markup=">";const x=[t,0];w.map=x,e.md.block.tokenize(e,t,v);const _=e.push("blockquote_close","blockquote",-1);_.markup=">",e.lineMax=a,e.parentType=m,x[1]=e.line;for(let E=0;E<u.length;E++)e.bMarks[E+t]=o[E],e.tShift[E+t]=u[E],e.sCount[E+t]=c[E],e.bsCount[E+t]=l[E];return e.blkIndent=b,!0}function Ume(e,t,n,r){const s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(i++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;i<s;){const c=e.src.charCodeAt(i++);if(c!==a&&!Kr(c))return!1;c===a&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function zP(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(r++);if(s!==42&&s!==45&&s!==43)return-1;if(r<n){const i=e.src.charCodeAt(r);if(!Kr(i))return-1}return r}function UP(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let s=n;if(s+1>=r)return-1;let i=e.src.charCodeAt(s++);if(i<48||i>57)return-1;for(;;){if(s>=r)return-1;if(i=e.src.charCodeAt(s++),i>=48&&i<=57){if(s-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return s<r&&(i=e.src.charCodeAt(s),!Kr(i))?-1:s}function qme(e,t){const n=e.level+2;for(let r=t+2,s=e.tokens.length-2;r<s;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function Vme(e,t,n,r){let s,i,a,o,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(u=!0);let f,m,g;if((g=UP(e,l))>=0){if(f=!0,a=e.bMarks[l]+e.tShift[l],m=Number(e.src.slice(a,g-1)),u&&m!==1)return!1}else if((g=zP(e,l))>=0)f=!1;else return!1;if(u&&e.skipSpaces(g)>=e.eMarks[l])return!1;if(r)return!0;const v=e.src.charCodeAt(g-1),b=e.tokens.length;f?(o=e.push("ordered_list_open","ol",1),m!==1&&(o.attrs=[["start",m]])):o=e.push("bullet_list_open","ul",1);const w=[l,0];o.map=w,o.markup=String.fromCharCode(v);let x=!1;const _=e.md.block.ruler.getRules("list"),E=e.parentType;for(e.parentType="list";l<n;){i=g,s=e.eMarks[l];const C=e.sCount[l]+g-(e.bMarks[l]+e.tShift[l]);let k=C;for(;i<s;){const re=e.src.charCodeAt(i);if(re===9)k+=4-(k+e.bsCount[l])%4;else if(re===32)k++;else break;i++}const R=i;let I;R>=s?I=1:I=k-C,I>4&&(I=1);const j=C+I;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(v);const M=[l,0];o.map=M,f&&(o.info=e.src.slice(a,g-1));const L=e.tight,q=e.tShift[l],P=e.sCount[l],V=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=j,e.tight=!0,e.tShift[l]=R-e.bMarks[l],e.sCount[l]=k,R>=s&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||x)&&(c=!1),x=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=V,e.tShift[l]=q,e.sCount[l]=P,e.tight=L,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(v),l=e.line,M[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let z=!1;for(let re=0,K=_.length;re<K;re++)if(_[re](e,l,n,!0)){z=!0;break}if(z)break;if(f){if(g=UP(e,l),g<0)break;a=e.bMarks[l]+e.tShift[l]}else if(g=zP(e,l),g<0)break;if(v!==e.src.charCodeAt(g-1))break}return f?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(v),w[1]=l,e.line=l,e.parentType=E,c&&qme(e,b),!0}function Hme(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==91)return!1;function o(_){const E=e.lineMax;if(_>=E||e.isEmpty(_))return null;let C=!1;if(e.sCount[_]-e.blkIndent>3&&(C=!0),e.sCount[_]<0&&(C=!0),!C){const I=e.md.block.ruler.getRules("reference"),j=e.parentType;e.parentType="reference";let M=!1;for(let L=0,q=I.length;L<q;L++)if(I[L](e,_,E,!0)){M=!0;break}if(e.parentType=j,M)return null}const k=e.bMarks[_]+e.tShift[_],R=e.eMarks[_];return e.src.slice(k,R+1)}let l=e.src.slice(s,i+1);i=l.length;let c=-1;for(s=1;s<i;s++){const _=l.charCodeAt(s);if(_===91)return!1;if(_===93){c=s;break}else if(_===10){const E=o(a);E!==null&&(l+=E,i=l.length,a++)}else if(_===92&&(s++,s<i&&l.charCodeAt(s)===10)){const E=o(a);E!==null&&(l+=E,i=l.length,a++)}}if(c<0||l.charCodeAt(c+1)!==58)return!1;for(s=c+2;s<i;s++){const _=l.charCodeAt(s);if(_===10){const E=o(a);E!==null&&(l+=E,i=l.length,a++)}else if(!Kr(_))break}const u=e.md.helpers.parseLinkDestination(l,s,i);if(!u.ok)return!1;const f=e.md.normalizeLink(u.str);if(!e.md.validateLink(f))return!1;s=u.pos;const m=s,g=a,v=s;for(;s<i;s++){const _=l.charCodeAt(s);if(_===10){const E=o(a);E!==null&&(l+=E,i=l.length,a++)}else if(!Kr(_))break}let b=e.md.helpers.parseLinkTitle(l,s,i);for(;b.can_continue;){const _=o(a);if(_===null)break;l+=_,s=i,i=l.length,a++,b=e.md.helpers.parseLinkTitle(l,s,i,b)}let w;for(s<i&&v!==s&&b.ok?(w=b.str,s=b.pos):(w="",s=m,a=g);s<i;){const _=l.charCodeAt(s);if(!Kr(_))break;s++}if(s<i&&l.charCodeAt(s)!==10&&w)for(w="",s=m,a=g;s<i;){const _=l.charCodeAt(s);if(!Kr(_))break;s++}if(s<i&&l.charCodeAt(s)!==10)return!1;const x=j_(l.slice(1,c));return x?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[x]>"u"&&(e.env.references[x]={title:w,href:f}),e.line=a),!0):!1}const Gme=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Kme="[a-zA-Z_:][a-zA-Z0-9:._-]*",Wme="[^\"'=<>`\\x00-\\x20]+",Zme="'[^']*'",Yme='"[^"]*"',Xme="(?:"+Wme+"|"+Zme+"|"+Yme+")",Jme="(?:\\s+"+Kme+"(?:\\s*=\\s*"+Xme+")?)",mz="<[A-Za-z][A-Za-z0-9\\-]*"+Jme+"*\\s*\\/?>",gz="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",Qme="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",ege="<[?][\\s\\S]*?[?]>",tge="<![A-Za-z][^>]*>",nge="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",rge=new RegExp("^(?:"+mz+"|"+gz+"|"+Qme+"|"+ege+"|"+tge+"|"+nge+")"),sge=new RegExp("^(?:"+mz+"|"+gz+")"),Xh=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+Gme.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(sge.source+"\\s*$"),/^$/,!1]];function ige(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(s)!==60)return!1;let a=e.src.slice(s,i),o=0;for(;o<Xh.length&&!Xh[o][0].test(a);o++);if(o===Xh.length)return!1;if(r)return Xh[o][2];let l=t+1;if(!Xh[o][1].test(a)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(s=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],a=e.src.slice(s,i),Xh[o][1].test(a)){a.length!==0&&l++;break}}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0}function age(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let a=e.src.charCodeAt(s);if(a!==35||s>=i)return!1;let o=1;for(a=e.src.charCodeAt(++s);a===35&&s<i&&o<=6;)o++,a=e.src.charCodeAt(++s);if(o>6||s<i&&!Kr(a))return!1;if(r)return!0;i=e.skipSpacesBack(i,s);const l=e.skipCharsBack(i,35,s);l>s&&Kr(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const c=e.push("heading_open","h"+String(o),1);c.markup="########".slice(0,o),c.map=[t,e.line];const u=e.push("inline","",0);u.content=e.src.slice(s,i).trim(),u.map=[t,e.line],u.children=[];const f=e.push("heading_close","h"+String(o),-1);return f.markup="########".slice(0,o),!0}function oge(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const s=e.parentType;e.parentType="paragraph";let i=0,a,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let g=e.bMarks[o]+e.tShift[o];const v=e.eMarks[o];if(g<v&&(a=e.src.charCodeAt(g),(a===45||a===61)&&(g=e.skipChars(g,a),g=e.skipSpaces(g),g>=v))){i=a===61?1:2;break}}if(e.sCount[o]<0)continue;let m=!1;for(let g=0,v=r.length;g<v;g++)if(r[g](e,o,n,!0)){m=!0;break}if(m)break}if(!i)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const c=e.push("heading_open","h"+String(i),1);c.markup=String.fromCharCode(a),c.map=[t,e.line];const u=e.push("inline","",0);u.content=l,u.map=[t,e.line-1],u.children=[];const f=e.push("heading_close","h"+String(i),-1);return f.markup=String.fromCharCode(a),e.parentType=s,!0}function lge(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),s=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3||e.sCount[i]<0)continue;let c=!1;for(let u=0,f=r.length;u<f;u++)if(r[u](e,i,n,!0)){c=!0;break}if(c)break}const a=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=a,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=s,!0}const ww=[["table",Lme,["paragraph","reference"]],["code",Bme],["fence",$me,["paragraph","reference","blockquote","list"]],["blockquote",zme,["paragraph","reference","blockquote","list"]],["hr",Ume,["paragraph","reference","blockquote","list"]],["list",Vme,["paragraph","reference","blockquote"]],["reference",Hme],["html_block",ige,["paragraph","reference","blockquote"]],["heading",age,["paragraph","reference","blockquote"]],["lheading",oge],["paragraph",lge]];function M_(){this.ruler=new ua;for(let e=0;e<ww.length;e++)this.ruler.push(ww[e][0],ww[e][1],{alt:(ww[e][2]||[]).slice()})}M_.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),s=r.length,i=e.md.options.maxNesting;let a=t,o=!1;for(;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n||e.sCount[a]<e.blkIndent));){if(e.level>=i){e.line=n;break}const l=e.line;let c=!1;for(let u=0;u<s;u++)if(c=r[u](e,a,n,!1),c){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!c)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),a=e.line,a<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}};M_.prototype.parse=function(e,t,n,r){if(!e)return;const s=new this.State(e,t,n,r);this.tokenize(s,s.line,s.lineMax)};M_.prototype.State=$l;function Eb(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}Eb.prototype.pushPending=function(){const e=new Vo("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};Eb.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new Vo(e,t,n);let s=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(s),r};Eb.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),s=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const a=i-e,o=i<n?this.src.charCodeAt(i):32,l=my(s)||py(String.fromCharCode(s)),c=my(o)||py(String.fromCharCode(o)),u=hy(s),f=hy(o),m=!f&&(!c||u||l),g=!u&&(!l||f||c);return{can_open:m&&(t||!g||l),can_close:g&&(t||!m||c),length:a}};Eb.prototype.Token=Vo;function cge(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function uge(e,t){let n=e.pos;for(;n<e.posMax&&!cge(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const dge=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function fge(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const s=e.pending.match(dge);if(!s)return!1;const i=s[1],a=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!a)return!1;let o=a.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);const c=e.push("link_open","a",1);c.attrs=[["href",l]],c.markup="linkify",c.info="auto";const u=e.push("text","",0);u.content=e.md.normalizeLinkText(o);const f=e.push("link_close","a",-1);f.markup="linkify",f.info="auto"}return e.pos+=o.length-i.length,!0}function hge(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,s=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&e.pending.charCodeAt(i-1)===32;)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<s&&Kr(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const LN=[];for(let e=0;e<256;e++)LN.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){LN[e.charCodeAt(0)]=1});function pge(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let s=e.src.charCodeAt(n);if(s===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(s=e.src.charCodeAt(n),!!Kr(s));)n++;return e.pos=n,!0}let i=e.src[n];if(s>=55296&&s<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=e.src[n+1],n++)}const a="\\"+i;if(!t){const o=e.push("text_special","",0);s<256&&LN[s]!==0?o.content=i:o.content=a,o.markup=a,o.info="escape"}return e.pos=n+1,!0}function mge(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const s=n;n++;const i=e.posMax;for(;n<i&&e.src.charCodeAt(n)===96;)n++;const a=e.src.slice(s,n),o=a.length;if(e.backticksScanned&&(e.backticks[o]||0)<=s)return t||(e.pending+=a),e.pos+=o,!0;let l=n,c;for(;(c=e.src.indexOf("`",l))!==-1;){for(l=c+1;l<i&&e.src.charCodeAt(l)===96;)l++;const u=l-c;if(u===o){if(!t){const f=e.push("code_inline","code",0);f.markup=a,f.content=e.src.slice(n,c).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[u]=c}return e.backticksScanned=!0,t||(e.pending+=a),e.pos+=o,!0}function gge(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const s=e.scanDelims(e.pos,!0);let i=s.length;const a=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=e.push("text","",0),o.content=a,i--);for(let l=0;l<i;l+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close});return e.pos+=s.length,!0}function qP(e,t){let n;const r=[],s=t.length;for(let i=0;i<s;i++){const a=t[i];if(a.marker!==126||a.end===-1)continue;const o=t[a.end];n=e.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let a=i+1;for(;a<e.tokens.length&&e.tokens[a].type==="s_close";)a++;a--,i!==a&&(n=e.tokens[a],e.tokens[a]=e.tokens[i],e.tokens[i]=n)}}function yge(e){const t=e.tokens_meta,n=e.tokens_meta.length;qP(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&qP(e,t[r].delimiters)}const yz={tokenize:gge,postProcess:yge};function bge(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const s=e.scanDelims(e.pos,r===42);for(let i=0;i<s.length;i++){const a=e.push("text","",0);a.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:s.length,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close})}return e.pos+=s.length,!0}function VP(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s.marker!==95&&s.marker!==42||s.end===-1)continue;const i=t[s.end],a=r>0&&t[r-1].end===s.end+1&&t[r-1].marker===s.marker&&t[r-1].token===s.token-1&&t[s.end+1].token===i.token+1,o=String.fromCharCode(s.marker),l=e.tokens[s.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const c=e.tokens[i.token];c.type=a?"strong_close":"em_close",c.tag=a?"strong":"em",c.nesting=-1,c.markup=a?o+o:o,c.content="",a&&(e.tokens[t[r-1].token].content="",e.tokens[t[s.end+1].token].content="",r--)}}function vge(e){const t=e.tokens_meta,n=e.tokens_meta.length;VP(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&VP(e,t[r].delimiters)}const bz={tokenize:bge,postProcess:vge};function wge(e,t){let n,r,s,i,a="",o="",l=e.pos,c=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const u=e.pos,f=e.posMax,m=e.pos+1,g=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(g<0)return!1;let v=g+1;if(v<f&&e.src.charCodeAt(v)===40){for(c=!1,v++;v<f&&(n=e.src.charCodeAt(v),!(!Kr(n)&&n!==10));v++);if(v>=f)return!1;if(l=v,s=e.md.helpers.parseLinkDestination(e.src,v,e.posMax),s.ok){for(a=e.md.normalizeLink(s.str),e.md.validateLink(a)?v=s.pos:a="",l=v;v<f&&(n=e.src.charCodeAt(v),!(!Kr(n)&&n!==10));v++);if(s=e.md.helpers.parseLinkTitle(e.src,v,e.posMax),v<f&&l!==v&&s.ok)for(o=s.str,v=s.pos;v<f&&(n=e.src.charCodeAt(v),!(!Kr(n)&&n!==10));v++);}(v>=f||e.src.charCodeAt(v)!==41)&&(c=!0),v++}if(c){if(typeof e.env.references>"u")return!1;if(v<f&&e.src.charCodeAt(v)===91?(l=v+1,v=e.md.helpers.parseLinkLabel(e,v),v>=0?r=e.src.slice(l,v++):v=g+1):v=g+1,r||(r=e.src.slice(m,g)),i=e.env.references[j_(r)],!i)return e.pos=u,!1;a=i.href,o=i.title}if(!t){e.pos=m,e.posMax=g;const b=e.push("link_open","a",1),w=[["href",a]];b.attrs=w,o&&w.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=v,e.posMax=f,!0}function xge(e,t){let n,r,s,i,a,o,l,c,u="";const f=e.pos,m=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const g=e.pos+2,v=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(v<0)return!1;if(i=v+1,i<m&&e.src.charCodeAt(i)===40){for(i++;i<m&&(n=e.src.charCodeAt(i),!(!Kr(n)&&n!==10));i++);if(i>=m)return!1;for(c=i,o=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),o.ok&&(u=e.md.normalizeLink(o.str),e.md.validateLink(u)?i=o.pos:u=""),c=i;i<m&&(n=e.src.charCodeAt(i),!(!Kr(n)&&n!==10));i++);if(o=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<m&&c!==i&&o.ok)for(l=o.str,i=o.pos;i<m&&(n=e.src.charCodeAt(i),!(!Kr(n)&&n!==10));i++);else l="";if(i>=m||e.src.charCodeAt(i)!==41)return e.pos=f,!1;i++}else{if(typeof e.env.references>"u")return!1;if(i<m&&e.src.charCodeAt(i)===91?(c=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?s=e.src.slice(c,i++):i=v+1):i=v+1,s||(s=e.src.slice(g,v)),a=e.env.references[j_(s)],!a)return e.pos=f,!1;u=a.href,l=a.title}if(!t){r=e.src.slice(g,v);const b=[];e.md.inline.parse(r,e.md,e.env,b);const w=e.push("image","img",0),x=[["src",u],["alt",""]];w.attrs=x,w.children=b,w.content=r,l&&x.push(["title",l])}return e.pos=i,e.posMax=m,!0}const _ge=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,Sge=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function Ege(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,s=e.posMax;for(;;){if(++n>=s)return!1;const a=e.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const i=e.src.slice(r+1,n);if(Sge.test(i)){const a=e.md.normalizeLink(i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}if(_ge.test(i)){const a=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}return!1}function Cge(e){return/^<a[>\s]/i.test(e)}function kge(e){return/^<\/a\s*>/i.test(e)}function Tge(e){const t=e|32;return t>=97&&t<=122}function Age(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const s=e.src.charCodeAt(r+1);if(s!==33&&s!==63&&s!==47&&!Tge(s))return!1;const i=e.src.slice(r).match(rge);if(!i)return!1;if(!t){const a=e.push("html_inline","",0);a.content=i[0],Cge(a.content)&&e.linkLevel++,kge(a.content)&&e.linkLevel--}return e.pos+=i[0].length,!0}const Rge=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,Nge=/^&([a-z][a-z0-9]{1,31});/i;function Ige(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const i=e.src.slice(n).match(Rge);if(i){if(!t){const a=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=e.push("text_special","",0);o.content=DN(a)?a1(a):a1(65533),o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}else{const i=e.src.slice(n).match(Nge);if(i){const a=uz(i[0]);if(a!==i[0]){if(!t){const o=e.push("text_special","",0);o.content=a,o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}}return!1}function HP(e){const t={},n=e.length;if(!n)return;let r=0,s=-2;const i=[];for(let a=0;a<n;a++){const o=e[a];if(i.push(0),(e[r].marker!==o.marker||s!==o.token-1)&&(r=a),s=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let c=r-i[r]-1,u=c;for(;c>l;c-=i[c]+1){const f=e[c];if(f.marker===o.marker&&f.open&&f.end<0){let m=!1;if((f.close||o.open)&&(f.length+o.length)%3===0&&(f.length%3!==0||o.length%3!==0)&&(m=!0),!m){const g=c>0&&!e[c-1].open?i[c-1]+1:0;i[a]=a-c+g,i[c]=g,o.open=!1,f.end=a,f.close=!1,u=-1,s=-2;break}}}u!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=u)}}function jge(e){const t=e.tokens_meta,n=e.tokens_meta.length;HP(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&HP(t[r].delimiters)}function Mge(e){let t,n,r=0;const s=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)s[t].nesting<0&&r--,s[t].level=r,s[t].nesting>0&&r++,s[t].type==="text"&&t+1<i&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}const bk=[["text",uge],["linkify",fge],["newline",hge],["escape",pge],["backticks",mge],["strikethrough",yz.tokenize],["emphasis",bz.tokenize],["link",wge],["image",xge],["autolink",Ege],["html_inline",Age],["entity",Ige]],vk=[["balance_pairs",jge],["strikethrough",yz.postProcess],["emphasis",bz.postProcess],["fragments_join",Mge]];function Cb(){this.ruler=new ua;for(let e=0;e<bk.length;e++)this.ruler.push(bk[e][0],bk[e][1]);this.ruler2=new ua;for(let e=0;e<vk.length;e++)this.ruler2.push(vk[e][0],vk[e][1])}Cb.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,s=e.md.options.maxNesting,i=e.cache;if(typeof i[t]<"u"){e.pos=i[t];return}let a=!1;if(e.level<s){for(let o=0;o<r;o++)if(e.level++,a=n[o](e,!0),e.level--,a){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;a||e.pos++,i[t]=e.pos};Cb.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,s=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let a=!1;if(e.level<s){for(let o=0;o<n;o++)if(a=t[o](e,!1),a){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};Cb.prototype.parse=function(e,t,n,r){const s=new this.State(e,t,n,r);this.tokenize(s);const i=this.ruler2.getRules(""),a=i.length;for(let o=0;o<a;o++)i[o](s)};Cb.prototype.State=Eb;function Oge(e){const t={};e=e||{},t.src_Any=iz.source,t.src_Cc=az.source,t.src_Z=lz.source,t.src_P=ON.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function dA(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function O_(e){return Object.prototype.toString.call(e)}function Pge(e){return O_(e)==="[object String]"}function Dge(e){return O_(e)==="[object Object]"}function Fge(e){return O_(e)==="[object RegExp]"}function GP(e){return O_(e)==="[object Function]"}function Lge(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const vz={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function Bge(e){return Object.keys(e||{}).reduce(function(t,n){return t||vz.hasOwnProperty(n)},!1)}const $ge={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},zge="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Uge="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function qge(e){e.__index__=-1,e.__text_cache__=""}function Vge(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function KP(){return function(e,t){t.normalize(e)}}function o1(e){const t=e.re=Oge(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(zge),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const s=[];e.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const c={validate:null,link:null};if(e.__compiled__[o]=c,Dge(l)){Fge(l.validate)?c.validate=Vge(l.validate):GP(l.validate)?c.validate=l.validate:i(o,l),GP(l.normalize)?c.normalize=l.normalize:l.normalize?i(o,l):c.normalize=KP();return}if(Pge(l)){s.push(o);return}i(o,l)}),s.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:KP()};const a=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(Lge).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),qge(e)}function Hge(e,t){const n=e.__index__,r=e.__last_index__,s=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=s,this.text=s,this.url=s}function fA(e,t){const n=new Hge(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function ja(e,t){if(!(this instanceof ja))return new ja(e,t);t||Bge(e)&&(t=e,e={}),this.__opts__=dA({},vz,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=dA({},$ge,e),this.__compiled__={},this.__tlds__=Uge,this.__tlds_replaced__=!1,this.re={},o1(this)}ja.prototype.add=function(t,n){return this.__schemas__[t]=n,o1(this),this};ja.prototype.set=function(t){return this.__opts__=dA(this.__opts__,t),this};ja.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,s,i,a,o,l,c,u;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(i=this.testSchemaAt(t,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(c=t.search(this.re.host_fuzzy_test),c>=0&&(this.__index__<0||c<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=t.indexOf("@"),u>=0&&(s=t.match(this.re.email_fuzzy))!==null&&(a=s.index+s[1].length,o=s.index+s[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};ja.prototype.pretest=function(t){return this.re.pretest.test(t)};ja.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};ja.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(fA(this,r)),r=this.__last_index__);let s=r?t.slice(r):t;for(;this.test(s);)n.push(fA(this,r)),s=s.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};ja.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,fA(this,0)):null};ja.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,s,i){return r!==i[s-1]}).reverse(),o1(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,o1(this),this)};ja.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};ja.prototype.onCompile=function(){};const Sp=2147483647,El=36,BN=1,gy=26,Gge=38,Kge=700,wz=72,xz=128,_z="-",Wge=/^xn--/,Zge=/[^\0-\x7F]/,Yge=/[\x2E\u3002\uFF0E\uFF61]/g,Xge={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},wk=El-BN,Cl=Math.floor,xk=String.fromCharCode;function Mu(e){throw new RangeError(Xge[e])}function Jge(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function Sz(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(Yge,".");const s=e.split("."),i=Jge(s,t).join(".");return r+i}function Ez(e){const t=[];let n=0;const r=e.length;for(;n<r;){const s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){const i=e.charCodeAt(n++);(i&64512)==56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),n--)}else t.push(s)}return t}const Qge=e=>String.fromCodePoint(...e),e0e=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:El},WP=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},Cz=function(e,t,n){let r=0;for(e=n?Cl(e/Kge):e>>1,e+=Cl(e/t);e>wk*gy>>1;r+=El)e=Cl(e/wk);return Cl(r+(wk+1)*e/(e+Gge))},kz=function(e){const t=[],n=e.length;let r=0,s=xz,i=wz,a=e.lastIndexOf(_z);a<0&&(a=0);for(let o=0;o<a;++o)e.charCodeAt(o)>=128&&Mu("not-basic"),t.push(e.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=r;for(let u=1,f=El;;f+=El){o>=n&&Mu("invalid-input");const m=e0e(e.charCodeAt(o++));m>=El&&Mu("invalid-input"),m>Cl((Sp-r)/u)&&Mu("overflow"),r+=m*u;const g=f<=i?BN:f>=i+gy?gy:f-i;if(m<g)break;const v=El-g;u>Cl(Sp/v)&&Mu("overflow"),u*=v}const c=t.length+1;i=Cz(r-l,c,l==0),Cl(r/c)>Sp-s&&Mu("overflow"),s+=Cl(r/c),r%=c,t.splice(r++,0,s)}return String.fromCodePoint(...t)},Tz=function(e){const t=[];e=Ez(e);const n=e.length;let r=xz,s=0,i=wz;for(const l of e)l<128&&t.push(xk(l));const a=t.length;let o=a;for(a&&t.push(_z);o<n;){let l=Sp;for(const u of e)u>=r&&u<l&&(l=u);const c=o+1;l-r>Cl((Sp-s)/c)&&Mu("overflow"),s+=(l-r)*c,r=l;for(const u of e)if(u<r&&++s>Sp&&Mu("overflow"),u===r){let f=s;for(let m=El;;m+=El){const g=m<=i?BN:m>=i+gy?gy:m-i;if(f<g)break;const v=f-g,b=El-g;t.push(xk(WP(g+v%b,0))),f=Cl(v/b)}t.push(xk(WP(f,0))),i=Cz(s,c,o===a),s=0,++o}++s,++r}return t.join("")},t0e=function(e){return Sz(e,function(t){return Wge.test(t)?kz(t.slice(4).toLowerCase()):t})},n0e=function(e){return Sz(e,function(t){return Zge.test(t)?"xn--"+Tz(t):t})},Az={version:"2.3.1",ucs2:{decode:Ez,encode:Qge},decode:kz,encode:Tz,toASCII:n0e,toUnicode:t0e},r0e={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},s0e={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},i0e={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},a0e={default:r0e,zero:s0e,commonmark:i0e},o0e=/^(vbscript|javascript|file|data):/,l0e=/^data:image\/(gif|png|jpeg|webp);/;function c0e(e){const t=e.trim().toLowerCase();return o0e.test(t)?l0e.test(t):!0}const Rz=["http:","https:","mailto:"];function u0e(e){const t=MN(e,!0);if(t.hostname&&(!t.protocol||Rz.indexOf(t.protocol)>=0))try{t.hostname=Az.toASCII(t.hostname)}catch{}return Sb(jN(t))}function d0e(e){const t=MN(e,!0);if(t.hostname&&(!t.protocol||Rz.indexOf(t.protocol)>=0))try{t.hostname=Az.toUnicode(t.hostname)}catch{}return Yp(jN(t),Yp.defaultChars+"%")}function Ma(e,t){if(!(this instanceof Ma))return new Ma(e,t);t||PN(e)||(t=e||{},e="default"),this.inline=new Cb,this.block=new M_,this.core=new FN,this.renderer=new Tm,this.linkify=new ja,this.validateLink=c0e,this.normalizeLink=u0e,this.normalizeLinkText=d0e,this.utils=hme,this.helpers=I_({},yme),this.options={},this.configure(e),t&&this.set(t)}Ma.prototype.set=function(e){return I_(this.options,e),this};Ma.prototype.configure=function(e){const t=this;if(PN(e)){const n=e;if(e=a0e[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};Ma.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};Ma.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};Ma.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};Ma.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};Ma.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};Ma.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};Ma.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const _k=new Ma({html:!1,linkify:!0,breaks:!0});function $N(e){return T.useMemo(()=>{var n;if(!e)return[];try{const r=_k.parse(e,{}),s=[];let i="",a=0;for(;a<r.length;){const o=r[a];if(o.type==="fence"){i&&(s.push(i),i="");const l=((n=o.info)==null?void 0:n.split(" ")[0])||void 0;s.push({type:"code",lang:l,code:o.content}),a++}else{const l=[];for(;a<r.length&&r[a].type!=="fence";)l.push(r[a]),a++;l.length>0&&(i+=_k.renderer.render(l,_k.options,{}))}}return i&&s.push(i),s}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const f0e=({markdownContent:e})=>{const t=$N(e);return e!=null&&e.trim()?p.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>{if(typeof n=="string")return p.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`);if(n.type==="code"){const s=n;return p.jsx(hm,{lang:s.lang,code:s.code},`code-${r}`)}return null})}):null},P_=dt.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0})=>{var b,w;const s=ir(x=>x.foldUserMessagesOnCompletion),[i,a]=T.useState(r&&s),[o,l]=T.useState(!1);T.useEffect(()=>{r&&s&&a(!0)},[r,s]);const c=t?sz(new Date(t),{addSuffix:!0}):"Sending...",u=((b=e.metadata)==null?void 0:b.attachedFiles)&&e.metadata.attachedFiles.length>0,f=e.content&&e.content.trim().length>0,m=T.useCallback(()=>a(x=>!x),[]),g=T.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),l(!0),Le.success("User prompt copied!"),setTimeout(()=>l(!1),1500)}catch(x){Le.error("Failed to copy prompt."),console.error("Clipboard copy failed:",x)}},[e.content]),v=T.useMemo(()=>{var _;let x="";return f&&(x+=`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`),f&&u&&(x+=" + "),u&&(x+=`${(_=e.metadata.attachedFiles)==null?void 0:_.length} file(s)`),x||"[Empty Prompt]"},[f,u,e.content,e.metadata]);return p.jsxs("div",{className:ct("user-prompt relative group/user overflow-wrap-anywhere",n),children:[p.jsxs("div",{className:ct("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t"),children:[p.jsxs("div",{className:"flex items-center gap-1 mb-1 sm:mb-0",children:[p.jsx(SJ,{className:"h-4 w-4 text-primary flex-shrink-0"}),p.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),p.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[f&&p.jsx(gn,{tooltipText:"Copy Prompt",onClick:g,"aria-label":"Copy user prompt",icon:o?p.jsx(Ui,{className:"text-green-500"}):p.jsx(P1,{}),className:"h-5 w-5"}),(f||u)&&p.jsx(gn,{tooltipText:i?"Unfold":"Fold",onClick:m,"aria-label":i?"Unfold prompt":"Fold prompt",icon:i?p.jsx(Fl,{}):p.jsx(fd,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),p.jsx("div",{className:"flex items-center flex-shrink-0 self-end sm:self-start",children:p.jsx("span",{className:"text-xs text-muted-foreground",children:c})})]}),!i&&p.jsxs(p.Fragment,{children:[u&&p.jsx("div",{className:"mb-2 space-y-1",children:(w=e.metadata.attachedFiles)==null?void 0:w.map(x=>p.jsx(J$,{fileMeta:x,isReadOnly:!0},x.id))}),p.jsx(f0e,{markdownContent:e.content})]}),i&&p.jsx("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:m,children:v})]})});P_.displayName="UserPromptDisplay";const h0e=(e,t,n,r,s)=>{if(typeof e=="string")return e.trim()?p.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null;if(e.type==="code"){const i=e,a=i.lang?`language-${i.lang}`:"language-plaintext";return n?p.jsx(hm,{lang:i.lang,code:i.code,isStreaming:r},`code-${t}`):p.jsxs("pre",{className:"code-block-container my-4 border border-border rounded-lg overflow-x-auto",children:[p.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border-b border-border bg-muted/50",children:p.jsx("div",{className:"text-sm font-medium",children:i.lang?i.lang.toUpperCase():"CODE"})}),p.jsx("code",{className:ct(a,"block p-4 font-mono text-sm leading-relaxed"),children:i.code})]},`pre-${t}`)}return null},p0e=({interactionId:e,markdownContent:t,isStreaming:n=!1,className:r})=>{const{enableStreamingMarkdown:s,enableStreamingCodeBlockParsing:i}=ir(mn(g=>({enableStreamingMarkdown:g.enableStreamingMarkdown,enableStreamingCodeBlockParsing:g.enableStreamingCodeBlockParsing}))),a=$N(s?t:null),o=co(mn(g=>Object.values(g.canvasControls))),l=T.useCallback((g,v)=>o.filter(b=>b.type==="tool-call-step"&&b.targetSlot===g&&b.renderer).map(b=>b.renderer?p.jsx(dt.Fragment,{children:b.renderer(v)},b.id):null).filter(Boolean),[o]),{toolCallStrings:c,toolResultStrings:u}=Bn(mn(g=>{var b,w;const v=g.interactions.find(x=>x.id===e);return{toolCallStrings:(b=v==null?void 0:v.metadata)==null?void 0:b.toolCalls,toolResultStrings:(w=v==null?void 0:v.metadata)==null?void 0:w.toolResults}})),f=T.useMemo(()=>{if(!c)return[];try{const g=c.map(b=>JSON.parse(b)),v=(u==null?void 0:u.map(b=>JSON.parse(b)))??[];return g.map(b=>{const w=v.find(x=>x.toolCallId===b.toolCallId);return{call:b,result:w}})}catch(g){return console.error("[StreamingContentView] Error parsing tool call/result strings:",g),[]}},[c,u]),m=T.useMemo(()=>s?a.map((g,v)=>h0e(g,v,i,n&&v===a.length-1)).filter(Boolean):[],[s,a,i,n,e]);return!s&&!t&&f.length===0?n?p.jsx("div",{className:ct("text-muted-foreground italic",r),children:"Generating response..."}):null:p.jsxs("div",{className:ct("streaming-content-view overflow-wrap-anywhere",r),children:[f.map(({call:g,result:v},b)=>{const w={interactionId:e,toolCall:g,toolResult:v,canvasContextType:"tool-call-step"};return p.jsx(dt.Fragment,{children:l("tool-call-content",w)},`tool-step-${g.toolCallId||b}`)}),s?m:t?p.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:new Ma().render(t)}}):null]})},m0e=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":s="Stop Generation"})=>p.jsx(gn,{tooltipText:"Stop",onClick:e,"aria-label":s,icon:p.jsx(fJ,{}),variant:r,size:n,className:t}),g0e=Symbol("Let zodToJsonSchema decide on which parser to use"),ZP={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},y0e=e=>typeof e=="string"?{...ZP,name:e}:{...ZP,...e},b0e=e=>{const t=y0e(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function Nz(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Ir(e,t,n,r,s){e[t]=n,Nz(e,t,r,s)}function v0e(){return{}}function w0e(e,t){var r,s,i;const n={type:"array"};return(r=e.type)!=null&&r._def&&((i=(s=e.type)==null?void 0:s._def)==null?void 0:i.typeName)!==zt.ZodAny&&(n.items=Sr(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Ir(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Ir(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Ir(n,"minItems",e.exactLength.value,e.exactLength.message,t),Ir(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function x0e(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Ir(n,"minimum",r.value,r.message,t):Ir(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ir(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ir(n,"maximum",r.value,r.message,t):Ir(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ir(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ir(n,"multipleOf",r.value,r.message,t);break}return n}function _0e(){return{type:"boolean"}}function Iz(e,t){return Sr(e.type._def,t)}const S0e=(e,t)=>Sr(e.innerType._def,t);function jz(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>jz(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return E0e(e,t)}}const E0e=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Ir(n,"minimum",r.value,r.message,t);break;case"max":Ir(n,"maximum",r.value,r.message,t);break}return n};function C0e(e,t){return{...Sr(e.innerType._def,t),default:e.defaultValue()}}function k0e(e,t){return t.effectStrategy==="input"?Sr(e.schema._def,t):{}}function T0e(e){return{type:"string",enum:Array.from(e.values)}}const A0e=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function R0e(e,t){const n=[Sr(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),Sr(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(i=>!!i);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(A0e(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...l}=i;a=l}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function N0e(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let Sk;const xo={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Sk===void 0&&(Sk=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Sk),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Mz(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":Ir(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":Ir(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":_o(n,"email",r.message,t);break;case"format:idn-email":_o(n,"idn-email",r.message,t);break;case"pattern:zod":Bi(n,xo.email,r.message,t);break}break;case"url":_o(n,"uri",r.message,t);break;case"uuid":_o(n,"uuid",r.message,t);break;case"regex":Bi(n,r.regex,r.message,t);break;case"cuid":Bi(n,xo.cuid,r.message,t);break;case"cuid2":Bi(n,xo.cuid2,r.message,t);break;case"startsWith":Bi(n,RegExp(`^${Ek(r.value,t)}`),r.message,t);break;case"endsWith":Bi(n,RegExp(`${Ek(r.value,t)}$`),r.message,t);break;case"datetime":_o(n,"date-time",r.message,t);break;case"date":_o(n,"date",r.message,t);break;case"time":_o(n,"time",r.message,t);break;case"duration":_o(n,"duration",r.message,t);break;case"length":Ir(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),Ir(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{Bi(n,RegExp(Ek(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&_o(n,"ipv4",r.message,t),r.version!=="v4"&&_o(n,"ipv6",r.message,t);break}case"base64url":Bi(n,xo.base64url,r.message,t);break;case"jwt":Bi(n,xo.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&Bi(n,xo.ipv4Cidr,r.message,t),r.version!=="v4"&&Bi(n,xo.ipv6Cidr,r.message,t);break}case"emoji":Bi(n,xo.emoji(),r.message,t);break;case"ulid":{Bi(n,xo.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{_o(n,"binary",r.message,t);break}case"contentEncoding:base64":{Ir(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{Bi(n,xo.base64,r.message,t);break}}break}case"nanoid":Bi(n,xo.nanoid,r.message,t)}return n}function Ek(e,t){return t.patternStrategy==="escape"?j0e(e):e}const I0e=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function j0e(e){let t="";for(let n=0;n<e.length;n++)I0e.has(e[n])||(t+="\\"),t+=e[n];return t}function _o(e,t,n,r){var s;e.format||(s=e.anyOf)!=null&&s.some(i=>i.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ir(e,"format",t,n,r)}function Bi(e,t,n,r){var s;e.pattern||(s=e.allOf)!=null&&s.some(i=>i.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:YP(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ir(e,"pattern",YP(t,r),n,r)}function YP(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let s="",i=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(i){s+=r[c],i=!1;continue}if(n.i){if(a){if(r[c].match(/[a-z]/)){o?(s+=r[c],s+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(s+=r[c],o=!0):s+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){s+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(n.m){if(r[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[c]==="."){s+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}s+=r[c],r[c]==="\\"?i=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function Oz(e,t){var r,s,i,a,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===zt.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((c,u)=>({...c,[u]:Sr(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:Sr(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((s=e.keyType)==null?void 0:s._def.typeName)===zt.ZodString&&((i=e.keyType._def.checks)!=null&&i.length)){const{type:c,...u}=Mz(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((a=e.keyType)==null?void 0:a._def.typeName)===zt.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===zt.ZodBranded&&e.keyType._def.type._def.typeName===zt.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=Iz(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function M0e(e,t){if(t.mapStrategy==="record")return Oz(e,t);const n=Sr(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=Sr(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function O0e(e){const t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function P0e(){return{not:{}}}function D0e(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const l1={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function F0e(e,t){if(t.target==="openApi3")return XP(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in l1&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=l1[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return XP(e,t)}const XP=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>Sr(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function L0e(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:l1[e.innerType._def.typeName],nullable:!0}:{type:[l1[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=Sr(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=Sr(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function B0e(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",Nz(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Ir(n,"minimum",r.value,r.message,t):Ir(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ir(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ir(n,"maximum",r.value,r.message,t):Ir(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ir(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ir(n,"multipleOf",r.value,r.message,t);break}return n}function $0e(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},s=[],i=e.shape();for(const o in i){let l=i[o];if(l===void 0||l._def===void 0)continue;let c=U0e(l);c&&n&&(l instanceof Io&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=Sr(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||s.push(o))}s.length&&(r.required=s);const a=z0e(e,t);return a!==void 0&&(r.additionalProperties=a),r}function z0e(e,t){if(e.catchall._def.typeName!=="ZodNever")return Sr(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function U0e(e){try{return e.isOptional()}catch{return!0}}const q0e=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return Sr(e.innerType._def,t);const n=Sr(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},V0e=(e,t)=>{if(t.pipeStrategy==="input")return Sr(e.in._def,t);if(t.pipeStrategy==="output")return Sr(e.out._def,t);const n=Sr(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=Sr(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function H0e(e,t){return Sr(e.type._def,t)}function G0e(e,t){const r={type:"array",uniqueItems:!0,items:Sr(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Ir(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Ir(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function K0e(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>Sr(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:Sr(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>Sr(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function W0e(){return{not:{}}}function Z0e(){return{}}const Y0e=(e,t)=>Sr(e.innerType._def,t),X0e=(e,t,n)=>{switch(t){case zt.ZodString:return Mz(e,n);case zt.ZodNumber:return B0e(e,n);case zt.ZodObject:return $0e(e,n);case zt.ZodBigInt:return x0e(e,n);case zt.ZodBoolean:return _0e();case zt.ZodDate:return jz(e,n);case zt.ZodUndefined:return W0e();case zt.ZodNull:return D0e(n);case zt.ZodArray:return w0e(e,n);case zt.ZodUnion:case zt.ZodDiscriminatedUnion:return F0e(e,n);case zt.ZodIntersection:return R0e(e,n);case zt.ZodTuple:return K0e(e,n);case zt.ZodRecord:return Oz(e,n);case zt.ZodLiteral:return N0e(e,n);case zt.ZodEnum:return T0e(e);case zt.ZodNativeEnum:return O0e(e);case zt.ZodNullable:return L0e(e,n);case zt.ZodOptional:return q0e(e,n);case zt.ZodMap:return M0e(e,n);case zt.ZodSet:return G0e(e,n);case zt.ZodLazy:return()=>e.getter()._def;case zt.ZodPromise:return H0e(e,n);case zt.ZodNaN:case zt.ZodNever:return P0e();case zt.ZodEffects:return k0e(e,n);case zt.ZodAny:return v0e();case zt.ZodUnknown:return Z0e();case zt.ZodDefault:return C0e(e,n);case zt.ZodBranded:return Iz(e,n);case zt.ZodReadonly:return Y0e(e,n);case zt.ZodCatch:return S0e(e,n);case zt.ZodPipeline:return V0e(e,n);case zt.ZodFunction:case zt.ZodVoid:case zt.ZodSymbol:return;default:return(r=>{})()}};function Sr(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==g0e)return l}if(r&&!n){const l=J0e(r,t);if(l!==void 0)return l}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const i=X0e(e,e.typeName,t),a=typeof i=="function"?Sr(i(),t):i;if(a&&eye(e,t,a),t.postProcess){const l=t.postProcess(a,e,t);return s.jsonSchema=a,l}return s.jsonSchema=a,a}const J0e=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Q0e(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Q0e=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},eye=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),tye=(e,t)=>{const n=b0e(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[c,u])=>({...l,[c]:Sr(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,s=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,i=Sr(e._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1)??{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(i.title=a);const o=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var yy={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},by={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},vy={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},wy={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},xy={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},nye=[yy,by,vy,wy,xy];yy.code+"",by.code+"",vy.code+"",wy.code+"",xy.code+"";yy.name+"",yy.code,by.name+"",by.code,vy.name+"",vy.code,wy.name+"",wy.code,xy.name+"",xy.code;nye.map(e=>e.code);function rye(e){const t=["ROOT"];let n=-1,r=null;function s(l,c,u){switch(l){case'"':{n=c,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=c,r=c,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=c,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=c,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=c,t.pop();break}}}function a(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}}}for(let l=0;l<e.length;l++){const c=e[l];switch(t[t.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{n=l,t.pop();break}default:{n=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const f=e.substring(r,l+1);!"false".startsWith(f)&&!"true".startsWith(f)&&!"null".startsWith(f)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?o+="true".slice(u.length):"false".startsWith(u)?o+="false".slice(u.length):"null".startsWith(u)&&(o+="null".slice(u.length))}}return o}function sye(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=Tf({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=Tf({text:rye(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var iye={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},aye={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},oye={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},lye={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},cye={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},uye={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},dye={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},fye={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},hye={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},pye={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},mye={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},gye={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},yye={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},bye={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},vye={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},wye={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},D_=[iye,aye,oye,lye,cye,uye,dye,fye,hye,pye,mye,gye,yye,bye,vye,wye];Object.fromEntries(D_.map(e=>[e.code,e]));Object.fromEntries(D_.map(e=>[e.name,e.code]));D_.map(e=>e.code);function xi(e,t){const n=D_.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function xye(e,t){var n;const r=(n=void 0)!=null?n:!1;return _ye(tye(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:s=>{const i=e.safeParse(s);return i.success?{success:!0,value:i.data}:{success:!1,error:i.error}}})}var hA=Symbol.for("vercel.ai.schema");function _ye(e,{validate:t}={}){return{[hA]:!0,_type:void 0,[px]:!0,jsonSchema:e,validate:t}}function Sye(e){return typeof e=="object"&&e!==null&&hA in e&&e[hA]===!0&&"jsonSchema"in e&&"validate"in e}function F_(e){return Sye(e)?e:xye(e)}const JP=globalThis||void 0||self;var Eye=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof JP=="object"?JP:{},gf="1.9.0",QP=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function Cye(e){var t=new Set([e]),n=new Set,r=e.match(QP);if(!r)return function(){return!1};var s={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(s.prerelease!=null)return function(l){return l===e};function i(o){return n.add(o),!1}function a(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var c=l.match(QP);if(!c)return i(l);var u={major:+c[1],minor:+c[2],patch:+c[3],prerelease:c[4]};return u.prerelease!=null||s.major!==u.major?i(l):s.major===0?s.minor===u.minor&&s.patch<=u.patch?a(l):i(l):s.minor<=u.minor?a(l):i(l)}}var kye=Cye(gf),Tye=gf.split(".")[0],_y=Symbol.for("opentelemetry.js.api."+Tye),Sy=Eye;function zN(e,t,n,r){var s;r===void 0&&(r=!1);var i=Sy[_y]=(s=Sy[_y])!==null&&s!==void 0?s:{version:gf};if(!r&&i[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}if(i.version!==gf){var a=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+gf);return n.error(a.stack||a.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+gf+"."),!0}function Ey(e){var t,n,r=(t=Sy[_y])===null||t===void 0?void 0:t.version;if(!(!r||!kye(r)))return(n=Sy[_y])===null||n===void 0?void 0:n[e]}function UN(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+gf+".");var n=Sy[_y];n&&delete n[e]}var Aye=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Rye=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Nye=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Xg("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Xg("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Xg("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Xg("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Xg("verbose",this._namespace,t)},e}();function Xg(e,t,n){var r=Ey("diag");if(r)return n.unshift(t),r[e].apply(r,Rye([],Aye(n),!1))}var Ca;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(Ca||(Ca={}));function Iye(e,t){e<Ca.NONE?e=Ca.NONE:e>Ca.ALL&&(e=Ca.ALL),t=t||{};function n(r,s){var i=t[r];return typeof i=="function"&&e>=s?i.bind(t):function(){}}return{error:n("error",Ca.ERROR),warn:n("warn",Ca.WARN),info:n("info",Ca.INFO),debug:n("debug",Ca.DEBUG),verbose:n("verbose",Ca.VERBOSE)}}var jye=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Mye=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Oye="diag",c1=function(){function e(){function t(s){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=Ey("diag");if(o)return o[s].apply(o,Mye([],jye(i),!1))}}var n=this,r=function(s,i){var a,o,l;if(i===void 0&&(i={logLevel:Ca.INFO}),s===n){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((a=c.stack)!==null&&a!==void 0?a:c.message),!1}typeof i=="number"&&(i={logLevel:i});var u=Ey("diag"),f=Iye((o=i.logLevel)!==null&&o!==void 0?o:Ca.INFO,s);if(u&&!i.suppressOverrideMessage){var m=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+m),f.warn("Current logger will overwrite one already registered from "+m)}return zN("diag",f,n,!0)};n.setLogger=r,n.disable=function(){UN(Oye,n)},n.createComponentLogger=function(s){return new Nye(s)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function Pye(e){return Symbol.for(e)}var Dye=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,s){var i=new e(n._currentContext);return i._currentContext.set(r,s),i},n.deleteValue=function(r){var s=new e(n._currentContext);return s._currentContext.delete(r),s}}return e}(),Fye=new Dye,Lye=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Bye=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},$ye=function(){function e(){}return e.prototype.active=function(){return Fye},e.prototype.with=function(t,n,r){for(var s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return n.call.apply(n,Bye([r],Lye(s),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),zye=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Uye=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Ck="context",qye=new $ye,Pz=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return zN(Ck,t,c1.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var s,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return(s=this._getContextManager()).with.apply(s,Uye([t,n,r],zye(i),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return Ey(Ck)||qye},e.prototype.disable=function(){this._getContextManager().disable(),UN(Ck,c1.instance())},e}(),pA;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(pA||(pA={}));var Dz="0000000000000000",Fz="00000000000000000000000000000000",Vye={traceId:Fz,spanId:Dz,traceFlags:pA.NONE},h0=function(){function e(t){t===void 0&&(t=Vye),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),qN=Pye("OpenTelemetry Context Key SPAN");function VN(e){return e.getValue(qN)||void 0}function Hye(){return VN(Pz.getInstance().active())}function HN(e,t){return e.setValue(qN,t)}function Gye(e){return e.deleteValue(qN)}function Kye(e,t){return HN(e,new h0(t))}function Lz(e){var t;return(t=VN(e))===null||t===void 0?void 0:t.spanContext()}var Wye=/^([0-9a-f]{32})$/i,Zye=/^[0-9a-f]{16}$/i;function Yye(e){return Wye.test(e)&&e!==Fz}function Xye(e){return Zye.test(e)&&e!==Dz}function Bz(e){return Yye(e.traceId)&&Xye(e.spanId)}function Jye(e){return new h0(e)}var kk=Pz.getInstance(),$z=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=kk.active());var s=!!(n!=null&&n.root);if(s)return new h0;var i=r&&Lz(r);return Qye(i)&&Bz(i)?new h0(i):new h0},e.prototype.startActiveSpan=function(t,n,r,s){var i,a,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(i=n,o=r):(i=n,a=r,o=s);var l=a??kk.active(),c=this.startSpan(t,i,l),u=HN(l,c);return kk.with(u,o,void 0,c)}},e}();function Qye(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var ebe=new $z,tbe=function(){function e(t,n,r,s){this._provider=t,this.name=n,this.version=r,this.options=s}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,s){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):ebe},e}(),nbe=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new $z},e}(),rbe=new nbe,eD=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var s;return(s=this.getDelegateTracer(t,n,r))!==null&&s!==void 0?s:new tbe(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:rbe},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var s;return(s=this._delegate)===null||s===void 0?void 0:s.getTracer(t,n,r)},e}(),u1;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(u1||(u1={}));var Tk="trace",sbe=function(){function e(){this._proxyTracerProvider=new eD,this.wrapSpanContext=Jye,this.isSpanContextValid=Bz,this.deleteSpan=Gye,this.getSpan=VN,this.getActiveSpan=Hye,this.getSpanContext=Lz,this.setSpan=HN,this.setSpanContext=Kye}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=zN(Tk,this._proxyTracerProvider,c1.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return Ey(Tk)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){UN(Tk,c1.instance()),this._proxyTracerProvider=new eD},e}(),ibe=sbe.getInstance(),abe=Object.defineProperty,GN=(e,t)=>{for(var n in t)abe(e,n,{get:t[n],enumerable:!0})};function d1(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function tD(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[s,i]of Object.entries(e))r[s]=i;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function nD({response:e,status:t,statusText:n,headers:r,stream:s}){e.writeHead(t??200,n,r);const i=s.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await i.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var zz="AI_InvalidArgumentError",Uz=`vercel.ai.error.${zz}`,obe=Symbol.for(Uz),qz,Co=class extends In{constructor({parameter:e,value:t,message:n}){super({name:zz,message:`Invalid argument for parameter ${e}: ${n}`}),this[qz]=!0,this.parameter=e,this.value=t}static isInstance(e){return In.hasMarker(e,Uz)}};qz=obe;var Vz="AI_RetryError",Hz=`vercel.ai.error.${Vz}`,lbe=Symbol.for(Hz),Gz,rD=class extends In{constructor({message:e,reason:t,errors:n}){super({name:Vz,message:e}),this[Gz]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return In.hasMarker(e,Hz)}};Gz=lbe;var cbe=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>Kz(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function Kz(e,{maxRetries:t,delayInMs:n,backoffFactor:r},s=[]){try{return await e()}catch(i){if(Gw(i)||t===0)throw i;const a=tee(i),o=[...s,i],l=o.length;if(l>t)throw new rD({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(i instanceof Error&&ro.isInstance(i)&&i.isRetryable===!0&&l<=t)return await JQ(n),Kz(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?i:new rD({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function ube({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new Co({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new Co({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:cbe({maxRetries:t})}}function mA({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function dbe({model:e,settings:t,telemetry:n,headers:r}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((i,[a,o])=>(i[`ai.settings.${a}`]=o,i),{}),...Object.entries((s=n==null?void 0:n.metadata)!=null?s:{}).reduce((i,[a,o])=>(i[`ai.telemetry.metadata.${a}`]=o,i),{}),...Object.entries(r??{}).reduce((i,[a,o])=>(o!==void 0&&(i[`ai.request.headers.${a}`]=o),i),{})}}var fbe={startSpan(){return xw},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(xw);if(typeof n=="function")return n(xw);if(typeof r=="function")return r(xw)}},xw={spanContext(){return hbe},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},hbe={traceId:"",spanId:"",traceFlags:0};function pbe({isEnabled:e=!1,tracer:t}={}){return e?t||ibe.getTracer("ai"):fbe}function gA({name:e,tracer:t,attributes:n,fn:r,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:n},async i=>{try{const a=await r(i);return s&&i.end(),a}catch(a){try{a instanceof Error?(i.recordException({name:a.name,message:a.message,stack:a.stack}),i.setStatus({code:u1.ERROR,message:a.message})):i.setStatus({code:u1.ERROR})}finally{i.end()}throw a}})}function dp({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,s])=>{if(s===void 0)return n;if(typeof s=="object"&&"input"in s&&typeof s.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const i=s.input();return i===void 0?n:{...n,[r]:i}}if(typeof s=="object"&&"output"in s&&typeof s.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const i=s.output();return i===void 0?n:{...n,[r]:i}}return{...n,[r]:s}},{})}var mbe=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=Hu(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=V1(this.base64Data)),this.uint8ArrayData}},gbe=class extends mbe{constructor(e){super(e),this.type="file"}},ybe=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],bbe=e=>{const t=typeof e=="string"?V1(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function vbe(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?bbe(e):e}function wbe({data:e,signatures:t}){const n=vbe(e);for(const r of t)if(typeof n=="string"?n.startsWith(r.base64Prefix):n.length>=r.bytesPrefix.length&&r.bytesPrefix.every((s,i)=>n[i]===s))return r.mimeType}var Wz="AI_NoObjectGeneratedError",Zz=`vercel.ai.error.${Wz}`,xbe=Symbol.for(Zz),Yz,sD=class extends In{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:s,finishReason:i}){super({name:Wz,message:e,cause:t}),this[Yz]=!0,this.text=n,this.response=r,this.usage=s,this.finishReason=i}static isInstance(e){return In.hasMarker(e,Zz)}};Yz=xbe;var Xz="AI_DownloadError",Jz=`vercel.ai.error.${Xz}`,_be=Symbol.for(Jz),Qz,Ak=class extends In{constructor({url:e,statusCode:t,statusText:n,cause:r,message:s=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:Xz,message:s,cause:r}),this[Qz]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return In.hasMarker(e,Jz)}};Qz=_be;async function Sbe({url:e}){var t;const n=e.toString();try{const r=await fetch(n);if(!r.ok)throw new Ak({url:n,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw Ak.isInstance(r)?r:new Ak({url:n,cause:r})}}var e7="AI_InvalidDataContentError",t7=`vercel.ai.error.${e7}`,Ebe=Symbol.for(t7),n7,iD=class extends In{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:e7,message:n,cause:t}),this[n7]=!0,this.content=e}static isInstance(e){return In.hasMarker(e,t7)}};n7=Ebe;var r7=D.union([D.string(),D.instanceof(Uint8Array),D.instanceof(ArrayBuffer),D.custom(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function s7(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Hu(new Uint8Array(e)):Hu(e)}function f1(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return V1(e)}catch(t){throw new iD({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new iD({content:e})}function Cbe(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var i7="AI_InvalidMessageRoleError",a7=`vercel.ai.error.${i7}`,kbe=Symbol.for(a7),o7,Tbe=class extends In{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:i7,message:t}),this[o7]=!0,this.role=e}static isInstance(e){return In.hasMarker(e,a7)}};o7=kbe;function Abe(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function Rbe({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=Sbe}){const s=await Ibe(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(i=>Nbe(i,s))]}function Nbe(e,t){var n,r,s,i,a,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(c=>jbe(c,t)).filter(c=>c.type!=="text"||c.text!==""),providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(c=>c.type!=="text"||c.text!=="").map(c=>{var u;const f=(u=c.providerOptions)!=null?u:c.experimental_providerMetadata;switch(c.type){case"file":return{type:"file",data:c.data instanceof URL?c.data:s7(c.data),filename:c.filename,mimeType:c.mimeType,providerMetadata:f};case"reasoning":return{type:"reasoning",text:c.text,signature:c.signature,providerMetadata:f};case"redacted-reasoning":return{type:"redacted-reasoning",data:c.data,providerMetadata:f};case"text":return{type:"text",text:c.text,providerMetadata:f};case"tool-call":return{type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,args:c.args,providerMetadata:f}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(c=>{var u;return{type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,result:c.result,content:c.experimental_content,isError:c.isError,providerMetadata:(u=c.providerOptions)!=null?u:c.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const c=l;throw new Tbe({role:c})}}}async function Ibe(e,t,n,r){const s=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&n===!0)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!r(a)),i=await Promise.all(s.map(async a=>({url:a,data:await t({url:a})})));return Object.fromEntries(i.map(({url:a,data:o})=>[a.toString(),o]))}function jbe(e,t){var n,r,s,i;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let a=e.mimeType,o,l,c;const u=e.type;switch(u){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:f,base64Content:m}=Abe(l.toString());if(f==null||m==null)throw new Error(`Invalid data URL format in part ${u}`);a=f,c=f1(m)}else{const f=t[l.toString()];f?(c=f.data,a??(a=f.mimeType)):c=l}else c=f1(l);switch(u){case"image":return c instanceof Uint8Array&&(a=(r=wbe({data:c,signatures:ybe}))!=null?r:a),{type:"image",image:c,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"file":{if(a==null)throw new Error("Mime type is missing for file part");return{type:"file",data:c instanceof Uint8Array?s7(c):c,filename:e.filename,mimeType:a,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}}}}function Mbe({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new Co({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new Co({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new Co({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new Co({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new Co({parameter:"topK",value:r,message:"topK must be a number"});if(s!=null&&typeof s!="number")throw new Co({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(i!=null&&typeof i!="number")throw new Co({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new Co({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a!=null&&a.length>0?a:void 0,seed:o}}function aD(e){var t,n,r;const s=[];for(const i of e){let a;try{a=new URL(i.url)}catch{throw new Error(`Invalid URL: ${i.url}`)}switch(a.protocol){case"http:":case"https:":{if((t=i.contentType)!=null&&t.startsWith("image/"))s.push({type:"image",image:a});else{if(!i.contentType)throw new Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:a,mimeType:i.contentType})}break}case"data:":{let o,l,c;try{[o,l]=i.url.split(","),c=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${i.url}`)}if(c==null||l==null)throw new Error(`Invalid data URL format: ${i.url}`);if((n=i.contentType)!=null&&n.startsWith("image/"))s.push({type:"image",image:f1(l)});else if((r=i.contentType)!=null&&r.startsWith("text/"))s.push({type:"text",text:Cbe(f1(l))});else{if(!i.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:l,mimeType:i.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return s}var l7="AI_MessageConversionError",c7=`vercel.ai.error.${l7}`,Obe=Symbol.for(c7),u7,Rk=class extends In{constructor({originalMessage:e,message:t}){super({name:l7,message:t}),this[u7]=!0,this.originalMessage=e}static isInstance(e){return In.hasMarker(e,c7)}};u7=Obe;function Pbe(e,t){var n,r;const s=(n=t==null?void 0:t.tools)!=null?n:{},i=[];for(let a=0;a<e.length;a++){const o=e[a],l=a===e.length-1,{role:c,content:u,experimental_attachments:f}=o;switch(c){case"system":{i.push({role:"system",content:u});break}case"user":{if(o.parts==null)i.push({role:"user",content:f?[{type:"text",text:u},...aD(f)]:u});else{const m=o.parts.filter(g=>g.type==="text").map(g=>({type:"text",text:g.text}));i.push({role:"user",content:f?[...m,...aD(f)]:m})}break}case"assistant":{if(o.parts!=null){let v=function(){const _=[];for(const C of x)switch(C.type){case"file":case"text":{_.push(C);break}case"reasoning":{for(const k of C.details)switch(k.type){case"text":_.push({type:"reasoning",text:k.text,signature:k.signature});break;case"redacted":_.push({type:"redacted-reasoning",data:k.data});break}break}case"tool-invocation":_.push({type:"tool-call",toolCallId:C.toolInvocation.toolCallId,toolName:C.toolInvocation.toolName,args:C.toolInvocation.args});break;default:{const k=C;throw new Error(`Unsupported part: ${k}`)}}i.push({role:"assistant",content:_});const E=x.filter(C=>C.type==="tool-invocation").map(C=>C.toolInvocation);E.length>0&&i.push({role:"tool",content:E.map(C=>{if(!("result"in C))throw new Rk({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(C)});const{toolCallId:k,toolName:R,result:I}=C,j=s[R];return(j==null?void 0:j.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:k,toolName:R,result:j.experimental_toToolResultContent(I),experimental_content:j.experimental_toToolResultContent(I)}:{type:"tool-result",toolCallId:k,toolName:R,result:I}})}),x=[],w=!1,b++},b=0,w=!1,x=[];for(const _ of o.parts)switch(_.type){case"text":{w&&v(),x.push(_);break}case"file":case"reasoning":{x.push(_);break}case"tool-invocation":{((r=_.toolInvocation.step)!=null?r:0)!==b&&v(),x.push(_),w=!0;break}}v();break}const m=o.toolInvocations;if(m==null||m.length===0){i.push({role:"assistant",content:u});break}const g=m.reduce((v,b)=>{var w;return Math.max(v,(w=b.step)!=null?w:0)},0);for(let v=0;v<=g;v++){const b=m.filter(w=>{var x;return((x=w.step)!=null?x:0)===v});b.length!==0&&(i.push({role:"assistant",content:[...l&&u&&v===0?[{type:"text",text:u}]:[],...b.map(({toolCallId:w,toolName:x,args:_})=>({type:"tool-call",toolCallId:w,toolName:x,args:_}))]}),i.push({role:"tool",content:b.map(w=>{if(!("result"in w))throw new Rk({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(w)});const{toolCallId:x,toolName:_,result:E}=w,C=s[_];return(C==null?void 0:C.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:x,toolName:_,result:C.experimental_toToolResultContent(E),experimental_content:C.experimental_toToolResultContent(E)}:{type:"tool-result",toolCallId:x,toolName:_,result:E}})}))}u&&!l&&i.push({role:"assistant",content:u});break}case"data":break;default:{const m=c;throw new Rk({originalMessage:o,message:`Unsupported role: ${m}`})}}}return i}function Dbe(e){if(!Array.isArray(e))return"other";if(e.length===0)return"messages";const t=e.map(Fbe);return t.some(n=>n==="has-ui-specific-parts")?"ui-messages":t.every(n=>n==="has-core-specific-parts"||n==="message")?"messages":"other"}function Fbe(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}var yA=D.lazy(()=>D.union([D.null(),D.string(),D.number(),D.boolean(),D.record(D.string(),yA),D.array(yA)])),hs=D.record(D.string(),D.record(D.string(),yA)),Lbe=D.array(D.union([D.object({type:D.literal("text"),text:D.string()}),D.object({type:D.literal("image"),data:D.string(),mimeType:D.string().optional()})])),d7=D.object({type:D.literal("text"),text:D.string(),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),Bbe=D.object({type:D.literal("image"),image:D.union([r7,D.instanceof(URL)]),mimeType:D.string().optional(),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),f7=D.object({type:D.literal("file"),data:D.union([r7,D.instanceof(URL)]),filename:D.string().optional(),mimeType:D.string(),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),$be=D.object({type:D.literal("reasoning"),text:D.string(),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),zbe=D.object({type:D.literal("redacted-reasoning"),data:D.string(),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),Ube=D.object({type:D.literal("tool-call"),toolCallId:D.string(),toolName:D.string(),args:D.unknown(),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),qbe=D.object({type:D.literal("tool-result"),toolCallId:D.string(),toolName:D.string(),result:D.unknown(),content:Lbe.optional(),isError:D.boolean().optional(),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),Vbe=D.object({role:D.literal("system"),content:D.string(),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),Hbe=D.object({role:D.literal("user"),content:D.union([D.string(),D.array(D.union([d7,Bbe,f7]))]),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),Gbe=D.object({role:D.literal("assistant"),content:D.union([D.string(),D.array(D.union([d7,f7,$be,zbe,Ube]))]),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),Kbe=D.object({role:D.literal("tool"),content:D.array(qbe),providerOptions:hs.optional(),experimental_providerMetadata:hs.optional()}),Wbe=D.union([Vbe,Hbe,Gbe,Kbe]);function Zbe({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new gc({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new gc({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new gc({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new gc({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const n=Dbe(e.messages);if(n==="other")throw new gc({prompt:e,message:"messages must be an array of CoreMessage or UIMessage"});const r=n==="ui-messages"?Pbe(e.messages,{tools:t}):e.messages;if(r.length===0)throw new gc({prompt:e,message:"messages must not be empty"});const s=om({value:r,schema:D.array(Wbe)});if(!s.success)throw new gc({prompt:e,message:"messages must be an array of CoreMessage or UIMessage",cause:s.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function Ybe({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function Xbe(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var Jbe="JSON schema:",Qbe="You MUST answer with a JSON object that matches the JSON schema above.",eve="You MUST answer with JSON.";function tve({prompt:e,schema:t,schemaPrefix:n=t!=null?Jbe:void 0,schemaSuffix:r=t!=null?Qbe:eve}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(s=>s!=null).join(`
`)}function Nk(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:s}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:s}}}},t}Bf({prefix:"aiobj",size:24});var Qi=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function oD(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}function nve(){let e=[],t=null,n=!1,r=oD();const s=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=oD(),await r.promise,s();try{const{value:i,done:a}=await e[0].read();a?(e.shift(),e.length>0?await s():n&&(t==null||t.close())):t==null||t.enqueue(i)}catch(i){t==null||t.error(i),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(i){t=i},pull:s,async cancel(){for(const i of e)await i.cancel();e=[],n=!0}}),addStream:i=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(i.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(i=>i.cancel()),e=[],t==null||t.close()}}}function rve(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}Bf({prefix:"aiobj",size:24});var h7="AI_NoOutputSpecifiedError",p7=`vercel.ai.error.${h7}`,sve=Symbol.for(p7),m7,ive=class extends In{constructor({message:e="No output specified."}={}){super({name:h7,message:e}),this[m7]=!0}static isInstance(e){return In.hasMarker(e,p7)}};m7=sve;var g7="AI_ToolExecutionError",y7=`vercel.ai.error.${g7}`,ave=Symbol.for(y7),b7,ove=class extends In{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:s=`Error executing tool ${t}: ${Hy(r)}`}){super({name:g7,message:s,cause:r}),this[b7]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return In.hasMarker(e,y7)}};b7=ave;function lve(e){return e!=null&&Object.keys(e).length>0}function cve({tools:e,toolChoice:t,activeTools:n}){return lve(e)?{tools:(n!=null?Object.entries(e).filter(([s])=>n.includes(s)):Object.entries(e)).map(([s,i])=>{const a=i.type;switch(a){case void 0:case"function":return{type:"function",name:s,description:i.description,parameters:F_(i.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:s,id:i.id,args:i.args};default:{const o=a;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var uve=/^([\s\S]*?)(\s+)(\S*)$/;function dve(e){const t=e.match(uve);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var v7="AI_InvalidToolArgumentsError",w7=`vercel.ai.error.${v7}`,fve=Symbol.for(w7),x7,_7=class extends In{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${Hy(n)}`}){super({name:v7,message:r,cause:n}),this[x7]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return In.hasMarker(e,w7)}};x7=fve;var S7="AI_NoSuchToolError",E7=`vercel.ai.error.${S7}`,hve=Symbol.for(E7),C7,bA=class extends In{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:S7,message:n}),this[C7]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return In.hasMarker(e,E7)}};C7=hve;var k7="AI_ToolCallRepairError",T7=`vercel.ai.error.${k7}`,pve=Symbol.for(T7),A7,mve=class extends In{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${Hy(e)}`}){super({name:k7,message:n,cause:e}),this[A7]=!0,this.originalError=t}static isInstance(e){return In.hasMarker(e,T7)}};A7=pve;async function gve({toolCall:e,tools:t,repairToolCall:n,system:r,messages:s}){if(t==null)throw new bA({toolName:e.toolName});try{return await lD({toolCall:e,tools:t})}catch(i){if(n==null||!(bA.isInstance(i)||_7.isInstance(i)))throw i;let a=null;try{a=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>F_(t[o].parameters).jsonSchema,system:r,messages:s,error:i})}catch(o){throw new mve({cause:o,originalError:i})}if(a==null)throw i;return await lD({toolCall:a,tools:t})}}async function lD({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new bA({toolName:e.toolName,availableTools:Object.keys(t)});const s=F_(r.parameters),i=e.args.trim()===""?om({value:{},schema:s}):Tf({text:e.args,schema:s});if(i.success===!1)throw new _7({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function yve(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function cD({text:e="",files:t,reasoning:n,tools:r,toolCalls:s,toolResults:i,messageId:a,generateMessageId:o}){const l=[],c=[];return n.length>0&&c.push(...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&c.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&c.push({type:"text",text:e}),s.length>0&&c.push(...s),c.length>0&&l.push({role:"assistant",content:c,id:a}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(u=>{const f=r[u.toolName];return(f==null?void 0:f.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:f.experimental_toToolResultContent(u.result),experimental_content:f.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}Bf({prefix:"aitxt",size:24});Bf({prefix:"msg",size:24});var bve={};GN(bve,{object:()=>_ve,text:()=>xve});var R7="AI_InvalidStreamPartError",N7=`vercel.ai.error.${R7}`,vve=Symbol.for(N7),I7,wve=class extends In{constructor({chunk:e,message:t}){super({name:R7,message:t}),this[I7]=!0,this.chunk=e}static isInstance(e){return In.hasMarker(e,N7)}};I7=vve;var xve=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),_ve=({schema:e})=>{const t=F_(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:tve({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=sye(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const s=r.state;throw new Error(`Unsupported parse state: ${s}`)}}},parseOutput({text:n},r){const s=Tf({text:n});if(!s.success)throw new sD({message:"No object generated: could not parse the response.",cause:s.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});const i=om({value:s.value,schema:t});if(!i.success)throw new sD({message:"No object generated: response did not match schema.",cause:i.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});return i.value}}};function Sve(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function Eve({stream:e,onError:t}){const n=e.getReader();try{for(;;){const{done:r}=await n.read();if(r)break}}catch(r){t==null||t(r)}finally{n.releaseLock()}}function KN(e,t){const n=e.getReader(),r=t.getReader();let s,i,a=!1,o=!1;async function l(u){try{s==null&&(s=n.read());const f=await s;s=void 0,f.done?u.close():u.enqueue(f.value)}catch(f){u.error(f)}}async function c(u){try{i==null&&(i=r.read());const f=await i;i=void 0,f.done?u.close():u.enqueue(f.value)}catch(f){u.error(f)}}return new ReadableStream({async pull(u){try{if(a){await c(u);return}if(o){await l(u);return}s==null&&(s=n.read()),i==null&&(i=r.read());const{result:f,reader:m}=await Promise.race([s.then(g=>({result:g,reader:n})),i.then(g=>({result:g,reader:r}))]);f.done||u.enqueue(f.value),m===n?(s=void 0,f.done&&(await c(u),a=!0)):(i=void 0,f.done&&(o=!0,await l(u)))}catch(f){u.error(f)}},cancel(){n.cancel(),r.cancel()}})}function Cve({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:s,system:i,messages:a,abortSignal:o,repairToolCall:l}){let c=null;const u=new ReadableStream({start(x){c=x}}),f={},m=new Set;let g=!1,v;function b(){g&&m.size===0&&(v!=null&&c.enqueue(v),c.close())}const w=new TransformStream({async transform(x,_){const E=x.type;switch(E){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{_.enqueue(x);break}case"file":{_.enqueue(new gbe({data:x.data,mimeType:x.mimeType}));break}case"tool-call-delta":{n&&(f[x.toolCallId]||(_.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),f[x.toolCallId]=!0),_.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case"tool-call":{try{const C=await gve({toolCall:x,tools:e,repairToolCall:l,system:i,messages:a});_.enqueue(C);const k=e[C.toolName];if(k.execute!=null){const R=ta();m.add(R),gA({name:"ai.toolCall",attributes:dp({telemetry:s,attributes:{...mA({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":C.toolName,"ai.toolCall.id":C.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(C.args)}}}),tracer:r,fn:async I=>k.execute(C.args,{toolCallId:C.toolCallId,messages:a,abortSignal:o}).then(j=>{c.enqueue({...C,type:"tool-result",result:j}),m.delete(R),b();try{I.setAttributes(dp({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(j)}}}))}catch{}},j=>{c.enqueue({type:"error",error:new ove({toolCallId:C.toolCallId,toolName:C.toolName,toolArgs:C.args,cause:j})}),m.delete(R),b()})})}}catch(C){c.enqueue({type:"error",error:C})}break}case"finish":{v={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:Ybe(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{const C=E;throw new Error(`Unhandled chunk type: ${C}`)}}},flush(){g=!0,b()}});return new ReadableStream({async start(x){return Promise.all([t.pipeThrough(w).pipeTo(new WritableStream({write(_){x.enqueue(_)},close(){}})),u.pipeTo(new WritableStream({write(_){x.enqueue(_)},close(){x.close()}}))])}})}var kve=Bf({prefix:"aitxt",size:24}),Tve=Bf({prefix:"msg",size:24});function Ave({model:e,tools:t,toolChoice:n,system:r,prompt:s,messages:i,maxRetries:a,abortSignal:o,headers:l,maxSteps:c=1,experimental_generateMessageId:u=Tve,experimental_output:f,experimental_continueSteps:m=!1,experimental_telemetry:g,experimental_providerMetadata:v,providerOptions:b=v,experimental_toolCallStreaming:w=!1,toolCallStreaming:x=w,experimental_activeTools:_,experimental_repairToolCall:E,experimental_transform:C,onChunk:k,onError:R,onFinish:I,onStepFinish:j,_internal:{now:M=rve,generateId:L=kve,currentDate:q=()=>new Date}={},...P}){return new Nve({model:e,telemetry:g,headers:l,settings:P,maxRetries:a,abortSignal:o,system:r,prompt:s,messages:i,tools:t,toolChoice:n,toolCallStreaming:x,transforms:Sve(C),activeTools:_,repairToolCall:E,maxSteps:c,output:f,continueSteps:m,providerOptions:b,onChunk:k,onError:R,onFinish:I,onStepFinish:j,now:M,currentDate:q,generateId:L,generateMessageId:u})}function Rve(e){if(!e)return new TransformStream({transform(i,a){a.enqueue({part:i,partialOutput:void 0})}});let t="",n="",r="";function s({controller:i,partialOutput:a=void 0}){i.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:a}),n=""}return new TransformStream({transform(i,a){if(i.type==="step-finish"&&s({controller:a}),i.type!=="text-delta"){a.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(s({controller:a,partialOutput:o.partial}),r=l)}},flush(i){n.length>0&&s({controller:i})}})}var Nve=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:s,abortSignal:i,system:a,prompt:o,messages:l,tools:c,toolChoice:u,toolCallStreaming:f,transforms:m,activeTools:g,repairToolCall:v,maxSteps:b,output:w,continueSteps:x,providerOptions:_,now:E,currentDate:C,generateId:k,generateMessageId:R,onChunk:I,onError:j,onFinish:M,onStepFinish:L}){this.warningsPromise=new Qi,this.usagePromise=new Qi,this.finishReasonPromise=new Qi,this.providerMetadataPromise=new Qi,this.textPromise=new Qi,this.reasoningPromise=new Qi,this.reasoningDetailsPromise=new Qi,this.sourcesPromise=new Qi,this.filesPromise=new Qi,this.toolCallsPromise=new Qi,this.toolResultsPromise=new Qi,this.requestPromise=new Qi,this.responsePromise=new Qi,this.stepsPromise=new Qi;var q;if(b<1)throw new Co({parameter:"maxSteps",value:b,message:"maxSteps must be at least 1"});this.output=w;let P="",V="",z="",re=[],K=[],ee,W=[];const se=[],Y={id:k(),timestamp:C(),modelId:e.modelId,messages:[]};let te=[],Q=[],ae,xe,ge="initial";const Me=[];let Pe;const Ie=new TransformStream({async transform(ce,oe){oe.enqueue(ce);const{part:ne}=ce;if((ne.type==="text-delta"||ne.type==="reasoning"||ne.type==="source"||ne.type==="tool-call"||ne.type==="tool-result"||ne.type==="tool-call-streaming-start"||ne.type==="tool-call-delta")&&await(I==null?void 0:I({chunk:ne})),ne.type==="error"&&await(j==null?void 0:j({error:ne.error})),ne.type==="text-delta"&&(P+=ne.textDelta,V+=ne.textDelta,z+=ne.textDelta),ne.type==="reasoning"&&(ee==null?(ee={type:"text",text:ne.textDelta},re.push(ee)):ee.text+=ne.textDelta),ne.type==="reasoning-signature"){if(ee==null)throw new In({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});ee.signature=ne.signature,ee=void 0}if(ne.type==="redacted-reasoning"&&re.push({type:"redacted",data:ne.data}),ne.type==="file"&&K.push(ne),ne.type==="source"&&(se.push(ne.source),W.push(ne.source)),ne.type==="tool-call"&&te.push(ne),ne.type==="tool-result"&&Q.push(ne),ne.type==="step-finish"){const Se=cD({text:V,files:K,reasoning:re,tools:c??{},toolCalls:te,toolResults:Q,messageId:ne.messageId,generateMessageId:R}),Fe=Me.length;let ke="done";Fe+1<b&&(x&&ne.finishReason==="length"&&te.length===0?ke="continue":te.length>0&&Q.length===te.length&&(ke="tool-result"));const Xe={stepType:ge,text:P,reasoning:yve(re),reasoningDetails:re,files:K,sources:W,toolCalls:te,toolResults:Q,finishReason:ne.finishReason,usage:ne.usage,warnings:ne.warnings,logprobs:ne.logprobs,request:ne.request,response:{...ne.response,messages:[...Y.messages,...Se]},providerMetadata:ne.experimental_providerMetadata,experimental_providerMetadata:ne.experimental_providerMetadata,isContinued:ne.isContinued};await(L==null?void 0:L(Xe)),Me.push(Xe),te=[],Q=[],P="",W=[],re=[],K=[],ee=void 0,ke!=="done"&&(ge=ke),ke!=="continue"&&(Y.messages.push(...Se),V="")}ne.type==="finish"&&(Y.id=ne.response.id,Y.timestamp=ne.response.timestamp,Y.modelId=ne.response.modelId,Y.headers=ne.response.headers,xe=ne.usage,ae=ne.finishReason)},async flush(ce){var oe;try{if(Me.length===0)return;const ne=Me[Me.length-1];Te.warningsPromise.resolve(ne.warnings),Te.requestPromise.resolve(ne.request),Te.responsePromise.resolve(ne.response),Te.toolCallsPromise.resolve(ne.toolCalls),Te.toolResultsPromise.resolve(ne.toolResults),Te.providerMetadataPromise.resolve(ne.experimental_providerMetadata),Te.reasoningPromise.resolve(ne.reasoning),Te.reasoningDetailsPromise.resolve(ne.reasoningDetails);const Se=ae??"unknown",Fe=xe??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Te.finishReasonPromise.resolve(Se),Te.usagePromise.resolve(Fe),Te.textPromise.resolve(z),Te.sourcesPromise.resolve(se),Te.filesPromise.resolve(ne.files),Te.stepsPromise.resolve(Me),await(M==null?void 0:M({finishReason:Se,logprobs:void 0,usage:Fe,text:z,reasoning:ne.reasoning,reasoningDetails:ne.reasoningDetails,files:ne.files,sources:ne.sources,toolCalls:ne.toolCalls,toolResults:ne.toolResults,request:(oe=ne.request)!=null?oe:{},response:ne.response,warnings:ne.warnings,providerMetadata:ne.providerMetadata,experimental_providerMetadata:ne.experimental_providerMetadata,steps:Me})),Pe.setAttributes(dp({telemetry:t,attributes:{"ai.response.finishReason":Se,"ai.response.text":{output:()=>z},"ai.response.toolCalls":{output:()=>{var ke;return(ke=ne.toolCalls)!=null&&ke.length?JSON.stringify(ne.toolCalls):void 0}},"ai.usage.promptTokens":Fe.promptTokens,"ai.usage.completionTokens":Fe.completionTokens}}))}catch(ne){ce.error(ne)}finally{Pe.end()}}}),Ce=nve();this.addStream=Ce.addStream,this.closeStream=Ce.close;let He=Ce.stream;for(const ce of m)He=He.pipeThrough(ce({tools:c,stopStream(){Ce.terminate()}}));this.baseStream=He.pipeThrough(Rve(w)).pipeThrough(Ie);const{maxRetries:it,retry:Ge}=ube({maxRetries:s}),Re=pbe(t),H=dbe({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:it}}),me=Zbe({prompt:{system:(q=w==null?void 0:w.injectIntoSystemPrompt({system:a,model:e}))!=null?q:a,prompt:o,messages:l},tools:c}),Te=this;gA({name:"ai.streamText",attributes:dp({telemetry:t,attributes:{...mA({operationId:"ai.streamText",telemetry:t}),...H,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:o,messages:l})},"ai.settings.maxSteps":b}}),tracer:Re,endWhenDone:!1,fn:async ce=>{Pe=ce;async function oe({currentStep:ne,responseMessages:Se,usage:Fe,stepType:ke,previousStepText:Xe,hasLeadingWhitespace:St,messageId:ht}){var It;const Vt=Se.length===0?me.type:"messages",Ot=[...me.messages,...Se],Gt=await Rbe({prompt:{type:Vt,system:me.system,messages:Ot},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(It=e.supportsUrl)==null?void 0:It.bind(e)}),be={type:"regular",...cve({tools:c,toolChoice:u,activeTools:g})},{result:{stream:O,warnings:Z,rawResponse:fe,request:Oe},doStreamSpan:ve,startTimestampMs:Ae}=await Ge(()=>gA({name:"ai.streamText.doStream",attributes:dp({telemetry:t,attributes:{...mA({operationId:"ai.streamText.doStream",telemetry:t}),...H,"ai.prompt.format":{input:()=>Vt},"ai.prompt.messages":{input:()=>JSON.stringify(Gt)},"ai.prompt.tools":{input:()=>{var Ht;return(Ht=be.tools)==null?void 0:Ht.map(Yt=>JSON.stringify(Yt))}},"ai.prompt.toolChoice":{input:()=>be.toolChoice!=null?JSON.stringify(be.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:Re,endWhenDone:!1,fn:async Ht=>({startTimestampMs:E(),doStreamSpan:Ht,result:await e.doStream({mode:be,...Mbe(r),inputFormat:Vt,responseFormat:w==null?void 0:w.responseFormat({model:e}),prompt:Gt,providerMetadata:_,abortSignal:i,headers:n})})})),ue=Cve({tools:c,generatorStream:O,toolCallStreaming:f,tracer:Re,telemetry:t,system:a,messages:Ot,repairToolCall:v,abortSignal:i}),mt=Oe??{},wt=[],B=[],ze=[],rt=[];let ye,we="unknown",Ue={promptTokens:0,completionTokens:0,totalTokens:0},Et,he=!0,G="",U=ke==="continue"?Xe:"",X,pe={id:k(),timestamp:C(),modelId:e.modelId},je="",Ke=!1,bt=!0,Kt=!1;async function yn({controller:Ht,chunk:Yt}){Ht.enqueue(Yt),G+=Yt.textDelta,U+=Yt.textDelta,Ke=!0,Kt=Yt.textDelta.trimEnd()!==Yt.textDelta}Te.addStream(ue.pipeThrough(new TransformStream({async transform(Ht,Yt){var an,qn,Qn;if(he){const Mr=E()-Ae;he=!1,ve.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":Mr}),ve.setAttributes({"ai.response.msToFirstChunk":Mr}),Yt.enqueue({type:"step-start",messageId:ht,request:mt,warnings:Z??[]})}if(Ht.type==="text-delta"&&Ht.textDelta.length===0)return;const jr=Ht.type;switch(jr){case"text-delta":{if(x){const Mr=bt&&St?Ht.textDelta.trimStart():Ht.textDelta;if(Mr.length===0)break;bt=!1,je+=Mr;const Gn=dve(je);Gn!=null&&(je=Gn.suffix,await yn({controller:Yt,chunk:{type:"text-delta",textDelta:Gn.prefix+Gn.whitespace}}))}else await yn({controller:Yt,chunk:Ht});break}case"reasoning":{Yt.enqueue(Ht),ye==null?(ye={type:"text",text:Ht.textDelta},ze.push(ye)):ye.text+=Ht.textDelta;break}case"reasoning-signature":{if(Yt.enqueue(Ht),ye==null)throw new wve({chunk:Ht,message:"reasoning-signature without reasoning"});ye.signature=Ht.signature,ye=void 0;break}case"redacted-reasoning":{Yt.enqueue(Ht),ze.push({type:"redacted",data:Ht.data});break}case"tool-call":{Yt.enqueue(Ht),wt.push(Ht);break}case"tool-result":{Yt.enqueue(Ht),B.push(Ht);break}case"response-metadata":{pe={id:(an=Ht.id)!=null?an:pe.id,timestamp:(qn=Ht.timestamp)!=null?qn:pe.timestamp,modelId:(Qn=Ht.modelId)!=null?Qn:pe.modelId};break}case"finish":{Ue=Ht.usage,we=Ht.finishReason,Et=Ht.experimental_providerMetadata,X=Ht.logprobs;const Mr=E()-Ae;ve.addEvent("ai.stream.finish"),ve.setAttributes({"ai.response.msToFinish":Mr,"ai.response.avgCompletionTokensPerSecond":1e3*Ue.completionTokens/Mr});break}case"file":{rt.push(Ht),Yt.enqueue(Ht);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{Yt.enqueue(Ht);break}case"error":{Yt.enqueue(Ht),we="error";break}default:{const Mr=jr;throw new Error(`Unknown chunk type: ${Mr}`)}}},async flush(Ht){const Yt=wt.length>0?JSON.stringify(wt):void 0;let an="done";ne+1<b&&(x&&we==="length"&&wt.length===0?an="continue":wt.length>0&&B.length===wt.length&&(an="tool-result")),x&&je.length>0&&(an!=="continue"||ke==="continue"&&!Ke)&&(await yn({controller:Ht,chunk:{type:"text-delta",textDelta:je}}),je="");try{ve.setAttributes(dp({telemetry:t,attributes:{"ai.response.finishReason":we,"ai.response.text":{output:()=>G},"ai.response.toolCalls":{output:()=>Yt},"ai.response.id":pe.id,"ai.response.model":pe.modelId,"ai.response.timestamp":pe.timestamp.toISOString(),"ai.usage.promptTokens":Ue.promptTokens,"ai.usage.completionTokens":Ue.completionTokens,"gen_ai.response.finish_reasons":[we],"gen_ai.response.id":pe.id,"gen_ai.response.model":pe.modelId,"gen_ai.usage.input_tokens":Ue.promptTokens,"gen_ai.usage.output_tokens":Ue.completionTokens}}))}catch{}finally{ve.end()}Ht.enqueue({type:"step-finish",finishReason:we,usage:Ue,providerMetadata:Et,experimental_providerMetadata:Et,logprobs:X,request:mt,response:{...pe,headers:fe==null?void 0:fe.headers},warnings:Z,isContinued:an==="continue",messageId:ht});const qn=Xbe(Fe,Ue);if(an==="done")Ht.enqueue({type:"finish",finishReason:we,usage:qn,providerMetadata:Et,experimental_providerMetadata:Et,logprobs:X,response:{...pe,headers:fe==null?void 0:fe.headers}}),Te.closeStream();else{if(ke==="continue"){const Qn=Se[Se.length-1];typeof Qn.content=="string"?Qn.content+=G:Qn.content.push({text:G,type:"text"})}else Se.push(...cD({text:G,files:rt,reasoning:ze,tools:c??{},toolCalls:wt,toolResults:B,messageId:ht,generateMessageId:R}));await oe({currentStep:ne+1,responseMessages:Se,usage:qn,stepType:an,previousStepText:U,hasLeadingWhitespace:Kt,messageId:an==="continue"?ht:R()})}}})))}await oe({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:R()})}}).catch(ce=>{Te.addStream(new ReadableStream({start(oe){oe.enqueue({type:"error",error:ce}),oe.close()}})),Te.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return Nk(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return Nk(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await Eve({stream:this.fullStream,onError:e==null?void 0:e.onError})}catch(n){(t=e==null?void 0:e.onError)==null||t.call(e,n)}}get experimental_partialOutputStream(){if(this.output==null)throw new ive;return Nk(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:s=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,a)=>{const o=i.type;switch(o){case"text-delta":{a.enqueue(xi("text",i.textDelta));break}case"reasoning":{n&&a.enqueue(xi("reasoning",i.textDelta));break}case"redacted-reasoning":{n&&a.enqueue(xi("redacted_reasoning",{data:i.data}));break}case"reasoning-signature":{n&&a.enqueue(xi("reasoning_signature",{signature:i.signature}));break}case"file":{a.enqueue(xi("file",{mimeType:i.mimeType,data:i.base64}));break}case"source":{r&&a.enqueue(xi("source",i.source));break}case"tool-call-streaming-start":{a.enqueue(xi("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break}case"tool-call-delta":{a.enqueue(xi("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break}case"tool-call":{a.enqueue(xi("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break}case"tool-result":{a.enqueue(xi("tool_result",{toolCallId:i.toolCallId,result:i.result}));break}case"error":{a.enqueue(xi("error",e(i.error)));break}case"step-start":{a.enqueue(xi("start_step",{messageId:i.messageId}));break}case"step-finish":{a.enqueue(xi("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break}case"finish":{s&&a.enqueue(xi("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c}={}){nD({response:e,status:t,statusText:n,headers:tD(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c})})}pipeTextStreamToResponse(e,t){nD({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:tD(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?KN(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:d1(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:d1(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}},Ive=D.object({name:D.string(),version:D.string()}).passthrough(),WN=D.object({_meta:D.optional(D.object({}).passthrough())}).passthrough(),Cy=WN,jve=D.object({method:D.string(),params:D.optional(WN)}),Mve=D.object({experimental:D.optional(D.object({}).passthrough()),logging:D.optional(D.object({}).passthrough()),prompts:D.optional(D.object({listChanged:D.optional(D.boolean())}).passthrough()),resources:D.optional(D.object({subscribe:D.optional(D.boolean()),listChanged:D.optional(D.boolean())}).passthrough()),tools:D.optional(D.object({listChanged:D.optional(D.boolean())}).passthrough())}).passthrough();Cy.extend({protocolVersion:D.string(),capabilities:Mve,serverInfo:Ive,instructions:D.optional(D.string())});var Ove=Cy.extend({nextCursor:D.optional(D.string())}),Pve=D.object({name:D.string(),description:D.optional(D.string()),inputSchema:D.object({type:D.literal("object"),properties:D.optional(D.object({}).passthrough())}).passthrough()}).passthrough();Ove.extend({tools:D.array(Pve)});var Dve=D.object({type:D.literal("text"),text:D.string()}).passthrough(),Fve=D.object({type:D.literal("image"),data:D.string().base64(),mimeType:D.string()}).passthrough(),j7=D.object({uri:D.string(),mimeType:D.optional(D.string())}).passthrough(),Lve=j7.extend({text:D.string()}),Bve=j7.extend({blob:D.string().base64()}),$ve=D.object({type:D.literal("resource"),resource:D.union([Lve,Bve])}).passthrough();Cy.extend({content:D.array(D.union([Dve,Fve,$ve])),isError:D.boolean().default(!1).optional()}).or(Cy.extend({toolResult:D.unknown()}));var L_="2.0",zve=D.object({jsonrpc:D.literal(L_),id:D.union([D.string(),D.number().int()])}).merge(jve).strict(),Uve=D.object({jsonrpc:D.literal(L_),id:D.union([D.string(),D.number().int()]),result:Cy}).strict(),qve=D.object({jsonrpc:D.literal(L_),id:D.union([D.string(),D.number().int()]),error:D.object({code:D.number().int(),message:D.string(),data:D.optional(D.unknown())})}).strict(),Vve=D.object({jsonrpc:D.literal(L_)}).merge(D.object({method:D.string(),params:D.optional(WN)})).strict();D.union([zve,Vve,Uve,qve]);var Hve={};GN(Hve,{mergeIntoDataStream:()=>Wve,toDataStream:()=>Gve,toDataStreamResponse:()=>Kve});function M7(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,s){s.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function ZN(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var s;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&uD((s=n.data)==null?void 0:s.chunk,r);return}uD(n,r)}})).pipeThrough(M7(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(xi("text",n))}}))}function Gve(e,t){return ZN(e,t).pipeThrough(new TextEncoderStream)}function Kve(e,t){var n;const r=ZN(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),s=t==null?void 0:t.data,i=t==null?void 0:t.init,a=s?KN(s.stream,r):r;return new Response(a,{status:(n=i==null?void 0:i.status)!=null?n:200,statusText:i==null?void 0:i.statusText,headers:d1(i==null?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Wve(e,t){t.dataStream.merge(ZN(e,t.callbacks))}function uD(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var Zve={};GN(Zve,{mergeIntoDataStream:()=>Jve,toDataStream:()=>Yve,toDataStreamResponse:()=>Xve});function YN(e,t){const n=Qve();return XQ(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,s){s.enqueue(n(r.delta))}})).pipeThrough(M7(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,s)=>{s.enqueue(xi("text",r))}}))}function Yve(e,t){return YN(e,t).pipeThrough(new TextEncoderStream)}function Xve(e,t={}){var n;const{init:r,data:s,callbacks:i}=t,a=YN(e,i).pipeThrough(new TextEncoderStream),o=s?KN(s.stream,a):a;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:d1(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Jve(e,t){t.dataStream.merge(YN(e,t.callbacks))}function Qve(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class ewe{static async executeInteraction(t,n,r){let s,i=!1,a=null,o,l,c;try{s=await Ave(n);for await(const u of s.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(u.type){case"text-delta":r.onChunk(u.textDelta);break;case"reasoning":r.onReasoningChunk(u.textDelta);break;case"tool-call":r.onToolCall(u);break;case"tool-result":r.onToolResult(u);break;case"finish":i=!0,a=u.finishReason,o=u.usage,l=u.providerMetadata;break;case"error":r.onError(new Error(`AI Stream Error Part: ${u.error instanceof Error?u.error.message:u.error}`));return;default:console.warn(`[AIService] Received unexpected stream part type: ${u.type}`,u);break}}s!=null&&s.reasoning?(c=await s.reasoning,console.log(`[AIService] Extracted final reasoning for ${t}`)):console.log(`[AIService] No final reasoning found in stream result for ${t}.`),!n.abortSignal.aborted&&i?r.onFinish({finishReason:a,usage:o,providerMetadata:l,reasoning:c}):!n.abortSignal.aborted&&!i&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(u){console.error(`[AIService] Error during streamText call for ${t}:`,u),u instanceof Error&&u.name==="AbortError"||r.onError(u instanceof Error?u:new Error(String(u)))}finally{console.log(`[AIService] Stream processing finished for ${t}.`)}}}const twe=".litechat/conversations",O7="/synced_repos";async function nwe(e,t,n){n(t.id,"syncing");const r=ar(`${O7}/${t.id}`),s={username:t.username,password:t.password},i=t.branch||"main";try{let a=!1;try{await e.promises.stat(Pl(r,".git")),a=!0}catch(o){if(o.code==="ENOENT")a=!1;else throw o}a?(Le.info(`Pulling latest changes for "${t.name}"...`),await A_(r,i,s,{fsInstance:e}),Le.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(Le.info(`Cloning repository "${t.name}"...`),await G$(r,t.remoteUrl,i,s,{fsInstance:e}),Le.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(a){console.error(`Failed to initialize/sync repository ${t.name}:`,a),n(t.id,"error")}}async function rwe(e,t,n,r,s,i,a){var f,m;r(t.id,"syncing");const o=ar(`${O7}/${n.id}`),l=Pl(o,twe,`${t.id}.json`),c={username:n.username,password:n.password},u=n.branch||"main";try{try{await e.promises.stat(Pl(o,".git"))}catch(x){if(x.code==="ENOENT"){Le.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw x}Le.info(`Pulling latest changes for "${n.name}"...`),await A_(o,u,c,{fsInstance:e});let g=null,v=null;try{const x=await Sd(l,{fsInstance:e}),_=new TextDecoder().decode(x);g=JSON.parse(_),v=(f=g==null?void 0:g.conversation)!=null&&f.updatedAt?new Date(g.conversation.updatedAt).getTime():null,isNaN(v??NaN)&&(v=null)}catch(x){x.code==="ENOENT"?console.log(`Conversation file ${l} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${x.message}`),Le.warning(`Could not read remote version of conversation: ${x.message}`))}const b=t.updatedAt.getTime(),w=((m=t.lastSyncedAt)==null?void 0:m.getTime())??0;if(!g||b>(v??0)||b>w&&b>=(v??0)){Le.info("Local changes detected. Pushing to remote...");const x=await Rt.loadInteractionsForConversation(t.id),{lastSyncedAt:_,...E}=t,C=JSON.stringify({conversation:E,interactions:x},null,2);await R_(l,C,{fsInstance:e}),await AN(o,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await RN(o,u,c,{fsInstance:e}),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),Le.success("Conversation synced successfully (pushed).")}else if(v&&v>b){Le.info("Remote changes detected. Updating local conversation...");const x={...g.conversation,createdAt:new Date(g.conversation.createdAt),updatedAt:new Date(g.conversation.updatedAt),lastSyncedAt:new Date};await Rt.saveConversation(x),await Rt.deleteInteractionsForConversation(t.id);const _=g.interactions.map(E=>Rt.saveInteraction({...E,conversationId:t.id,startedAt:E.startedAt?new Date(E.startedAt):null,endedAt:E.endedAt?new Date(E.endedAt):null}));await Promise.all(_),i()===t.id&&a()==="conversation"&&await Bn.getState().loadInteractions(t.id),r(t.id,"idle"),Le.success("Conversation synced successfully (pulled).")}else Le.info("Conversation already up-to-date."),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(g){console.error(`Sync failed for conversation ${t.id}:`,g),r(t.id,"error",g.message)}}const fi={loaded:"project.loaded",added:"project.added",updated:"project.updated",deleted:"project.deleted",loadingStateChanged:"project.loading.state.changed",loadProjectsRequest:"project.load.projects.request",addProjectRequest:"project.add.project.request",updateProjectRequest:"project.update.project.request",deleteProjectRequest:"project.delete.project.request"},Mn={conversationsLoaded:"conversation.conversations.loaded",selectedItemChanged:"conversation.selected.item.changed",conversationAdded:"conversation.added",conversationUpdated:"conversation.updated",conversationDeleted:"conversation.deleted",conversationSyncStatusChanged:"conversation.sync.status.changed",syncReposLoaded:"conversation.sync.repos.loaded",syncRepoChanged:"conversation.sync.repo.changed",syncRepoInitStatusChanged:"conversation.sync.repo.init.status.changed",loadingStateChanged:"conversation.loading.state.changed",loadConversationsRequest:"conversation.load.conversations.request",addConversationRequest:"conversation.add.conversation.request",updateConversationRequest:"conversation.update.conversation.request",deleteConversationRequest:"conversation.delete.conversation.request",selectItemRequest:"conversation.select.item.request",importConversationRequest:"conversation.import.conversation.request",exportConversationRequest:"conversation.export.conversation.request",exportProjectRequest:"conversation.export.project.request",exportAllConversationsRequest:"conversation.export.all.conversations.request",loadSyncReposRequest:"conversation.load.sync.repos.request",addSyncRepoRequest:"conversation.add.sync.repo.request",updateSyncRepoRequest:"conversation.update.sync.repo.request",deleteSyncRepoRequest:"conversation.delete.sync.repo.request",linkConversationToRepoRequest:"conversation.link.conversation.to.repo.request",syncConversationRequest:"conversation.sync.conversation.request",initializeOrSyncRepoRequest:"conversation.initialize.or.sync.repo.request",updateCurrentConversationToolSettingsRequest:"conversation.update.current.conversation.tool.settings.request"},Oa=oo(lo((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await Rt.loadProjects();e({projects:n,isLoading:!1}),Be.emit(fi.loaded,{projects:n})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1}),Be.emit(fi.loadingStateChanged,{isLoading:!1,error:"Failed to load projects"})}},addProject:async n=>{var l;const r=pi(),s=new Date,i=n.parentId?((l=t().getProjectById(n.parentId))==null?void 0:l.path)??"/":"/",a=ar(`${i}/${n.name.replace(/\s+/g,"-").toLowerCase()}-${r.substring(0,4)}`),o={id:r,path:a,createdAt:s,updatedAt:s,name:n.name,parentId:n.parentId??null,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,defaultTagIds:n.defaultTagIds??null,defaultRuleIds:n.defaultRuleIds??null,metadata:n.metadata??{}};try{return await Rt.saveProject(o),e(c=>{c.projects.unshift(o),c.projects.sort((u,f)=>f.updatedAt.getTime()-u.updatedAt.getTime())}),Be.emit(fi.added,{project:o}),r}catch(c){throw console.error("ProjectStore: Error adding project",c),e({error:"Failed to save new project"}),c}},updateProject:async(n,r)=>{var a;const s=t().getProjectById(n);if(!s){console.warn(`ProjectStore: Project ${n} not found for update.`);return}const i={...s,...r,updatedAt:new Date};if(r.name&&r.name!==s.name){const o=s.parentId?((a=t().getProjectById(s.parentId))==null?void 0:a.path)??"/":"/";i.path=ar(`${o}/${r.name.replace(/\s+/g,"-").toLowerCase()}-${n.substring(0,4)}`)}try{await Rt.saveProject(i),e(o=>{const l=o.projects.findIndex(c=>c.id===n);l!==-1&&(o.projects[l]=i,o.projects.sort((c,u)=>u.updatedAt.getTime()-c.updatedAt.getTime()))}),Be.emit(fi.updated,{projectId:n,updates:i})}catch(o){throw console.error("ProjectStore: Error updating project",o),e({error:"Failed to save project update"}),o}},deleteProject:async n=>{const r=t().projects.find(a=>a.id===n);if(!r)return;const s=new Set,i=a=>{s.add(a),t().projects.filter(o=>o.parentId===a).forEach(o=>i(o.id))};i(n);try{await Rt.deleteProject(n),e(a=>({projects:a.projects.filter(o=>!s.has(o.id))})),Be.emit(Mn.loadConversationsRequest,void 0),Be.emit(fi.deleted,{projectId:n}),Le.success(`Project "${r.name}" and its contents deleted.`)}catch(a){throw console.error("ProjectStore: Error deleting project",a),e({error:"Failed to delete project"}),a}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getTopLevelProjectId:n=>{if(!n)return null;let r=t().getProjectById(n);if(!r)return null;for(;r.parentId;){const s=t().getProjectById(r.parentId);if(!s)break;r=s}return r.id},getEffectiveProjectSettings:n=>{const r=ir.getState(),s=gr.getState().selectedModelId,i={systemPrompt:r.globalSystemPrompt,modelId:s,temperature:r.temperature,maxTokens:r.maxTokens,topP:r.topP,topK:r.topK,presencePenalty:r.presencePenalty,frequencyPenalty:r.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null};if(!n)return i;const a=t().getProjectById(n);if(!a)return i;const o=a.parentId?t().getEffectiveProjectSettings(a.parentId):i;return{systemPrompt:a.systemPrompt!==null&&a.systemPrompt!==void 0?a.systemPrompt:o.systemPrompt,modelId:a.modelId!==null&&a.modelId!==void 0?a.modelId:o.modelId,temperature:a.temperature!==null&&a.temperature!==void 0?a.temperature:o.temperature,maxTokens:a.maxTokens!==null&&a.maxTokens!==void 0?a.maxTokens:o.maxTokens,topP:a.topP!==null&&a.topP!==void 0?a.topP:o.topP,topK:a.topK!==null&&a.topK!==void 0?a.topK:o.topK,presencePenalty:a.presencePenalty!==null&&a.presencePenalty!==void 0?a.presencePenalty:o.presencePenalty,frequencyPenalty:a.frequencyPenalty!==null&&a.frequencyPenalty!==void 0?a.frequencyPenalty:o.frequencyPenalty,defaultTagIds:a.defaultTagIds!==null&&a.defaultTagIds!==void 0?a.defaultTagIds:o.defaultTagIds,defaultRuleIds:a.defaultRuleIds!==null&&a.defaultRuleIds!==void 0?a.defaultRuleIds:o.defaultRuleIds}},getRegisteredActionHandlers:()=>{const n="projectStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:fi.loadProjectsRequest,handler:r.loadProjects,storeId:n},{eventName:fi.addProjectRequest,handler:s(r.addProject),storeId:n},{eventName:fi.updateProjectRequest,handler:i=>r.updateProject(i.id,i.updates),storeId:n},{eventName:fi.deleteProjectRequest,handler:i=>r.deleteProject(i.id),storeId:n}]}}))),_w=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},swe=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${cA(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${cA(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,s)=>r.index-s.index).forEach(r=>{var s,i,a,o,l,c,u,f;((s=r.prompt)!=null&&s.content||(o=(a=(i=r.prompt)==null?void 0:i.metadata)==null?void 0:a.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(m=>{n+=`- ${m.name} (${m.type}, ${ry(m.size)}) ${m.source==="vfs"?`(VFS: ${m.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(c=r.metadata)!=null&&c.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((u=r.metadata)!=null&&u.promptTokens||(f=r.metadata)!=null&&f.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class fp{static async importConversation(t,n,r){try{const s=await t.text(),i=JSON.parse(s);if(!i||typeof i!="object"||!i.conversation||!Array.isArray(i.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const a=i.conversation,o=i.interactions;if(!a.id||!a.title||!a.createdAt||!a.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:a.title||"Imported Chat",metadata:a.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),c=o.map(u=>Rt.saveInteraction({...u,conversationId:l,id:pi()}));await Promise.all(c),await r(l,"conversation"),Le.success("Conversation imported successfully.")}catch(s){throw console.error("ImportExportService: Error importing conversation",s),Le.error(`Import failed: ${s instanceof Error?s.message:String(s)}`),s}}static async exportConversation(t,n){try{const r=br.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const s=await Rt.loadInteractionsForConversation(t);let i,a;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const c=JSON.stringify({conversation:r,interactions:s},null,2);i=new Blob([c],{type:"application/json"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=swe(r,s);i=new Blob([l],{type:"text/markdown"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");_w(i,a),Le.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),Le.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=Oa.getState(),{conversations:s}=br.getState(),i=r(t);if(!i)throw new Error("Project not found.");const a=async m=>{const g=n.find(x=>x.id===m);if(!g)throw new Error(`Project ${m} not found in state.`);const v=n.filter(x=>x.parentId===m),b=s.filter(x=>x.projectId===m),w=[];for(const x of v)w.push(await a(x.id));for(const x of b){const _=await Rt.loadInteractionsForConversation(x.id);w.push({conversation:x,interactions:_})}return{project:g,children:w}},o=await a(t),l=JSON.stringify(o,null,2),c=new Blob([l],{type:"application/json"}),f=`litechat_project_${i.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;_w(c,f),Le.success(`Project "${i.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),Le.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=br.getState().conversations,n=[];for(const a of t){const o=await Rt.loadInteractionsForConversation(a.id);n.push({conversation:a,interactions:o})}const r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;_w(s,i),Le.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),Le.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportFullConfiguration(t){try{const n=await Rt.getAllDataForExport(t),r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_full_export_${new Date().toISOString().split("T")[0]}.json`;_w(s,i),Le.success("Full configuration exported successfully.")}catch(n){throw console.error("ImportExportService: Error exporting full configuration",n),Le.error(`Full export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importFullConfiguration(t,n){try{const r=await t.text(),s=JSON.parse(r);if(!s||typeof s!="object"||!s.version)throw new Error("Invalid import file format. Missing version or basic structure.");await Rt.importAllData(s,n),Le.success("Configuration imported successfully. Reloading application..."),setTimeout(()=>window.location.reload(),1500)}catch(r){throw console.error("ImportExportService: Error importing full configuration",r),Le.error(`Full import failed: ${r instanceof Error?r.message:String(r)}`),r}}}const Nu="sync_repos",r0={repoChanged:"sync.repo.changed",repoInitStatusChanged:"sync.repo.init.status.changed"},xs=oo(lo((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)}),Be.emit(en.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n}),Be.emit(en.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&Le.error(`VFS Error: ${n}`)}),Be.emit(en.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_addNodes:n=>{e(r=>{const s={};n.forEach(i=>{r.nodes[i.id]=i;const a=i.parentId??r.rootId??"";s[a]||(s[a]=r.childrenMap[a]?[...r.childrenMap[a]]:[]),s[a].includes(i.id)||s[a].push(i.id)});for(const i in s)(!r.childrenMap[i]||JSON.stringify(r.childrenMap[i].sort())!==JSON.stringify(s[i].sort()))&&(r.childrenMap[i]=s[i])}),Be.emit(en.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_updateNode:(n,r)=>{e(s=>{s.nodes[n]&&Object.assign(s.nodes[n],r)}),Be.emit(en.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_removeNodes:n=>{e(r=>{n.forEach(s=>{const i=r.nodes[s];if(i){const a=i.parentId??r.rootId??"";if(r.childrenMap[a]&&(r.childrenMap[a]=r.childrenMap[a].filter(o=>o!==s)),delete r.nodes[s],r.selectedFileIds.delete(s),i.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===s).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[s]}}})}),Be.emit(en.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap}),Be.emit(en.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},_setFsInstance:n=>{e({fs:n}),Be.emit(en.fsInstanceChanged,{fsInstance:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),Be.emit(en.vfsEnabledChanged,{enabled:n}),n?!t().vfsKey&&!t().configuredVfsKey&&console.log("[VfsStore] VFS globally enabled, waiting for vfsKey to be set."):(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),Be.emit(en.vfsKeyChanged,{vfsKey:null,configuredVfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),Be.emit(en.vfsKeyChanged,{vfsKey:t().vfsKey,configuredVfsKey:n})},setVfsKey:n=>{if(n!==null){const r=t().vfsKey,s=t().configuredVfsKey;if(n===r){console.log(`[VfsStore] setVfsKey: Key ${n} is already desired.`),n&&n!==s&&!t().initializingKey&&(console.log(`[VfsStore] setVfsKey: Re-triggering initialization for desired key ${n} as it's not configured.`),t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,i)}));return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${s}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),Be.emit(en.vfsKeyChanged,{vfsKey:n,configuredVfsKey:null}),n!==null?t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,i)}):console.log("[VfsStore] setVfsKey: Desired key is null. State cleared.")}},initializeVFS:async(n,r)=>{console.log("[VfsStore DEBUG] initializeVFS called with:",{vfsKeyParam:typeof n=="object"?JSON.parse(JSON.stringify(n)):n,optionsParam:typeof r=="object"?JSON.parse(JSON.stringify(r)):r});let s,i;if(typeof n=="object"&&n!==null&&"vfsKey"in n)console.warn("[VfsStore] initializeVFS called with a single object payload. Correcting. Input:",JSON.parse(JSON.stringify(n))),s=String(n.vfsKey),i=n.options;else if(typeof n=="string")s=n,i=r;else{const m=`[VfsStore] initializeVFS called with invalid vfsKey type. Type: ${typeof n}, Value: "${String(n)}". Aborting.`;throw console.error(m,n),new Error("VFS key must be a string and cannot be empty.")}if(!s||s.trim()===""){const m=`[VfsStore] initializeVFS: Derived vfsKey is empty or invalid. Original param: ${String(n)}, Derived key: "${s}". Aborting.`;throw console.error(m,{originalVfsKeyParam:n,originalOptionsParam:r}),new Error("VFS key cannot be empty after processing.")}const a=(i==null?void 0:i.force)===!0;if(console.log(`[VfsStore DEBUG] initializeVFS derived: vfsKey="${s}", isForced=${a}`),!a){if(t().vfsKey!==s){const m=`UI Initialization aborted for "${s}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${m}`),new Error(m)}if(t().initializingKey===s){const m=`UI Initialization skipped for "${s}". Already actively initializing this exact key.`;throw console.warn(`[VfsStore] ${m}`),new Error(m)}if(t().initializingKey!==null&&t().initializingKey!==s){const m=`UI Initialization skipped for "${s}". Already initializing a different key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${m}`),new Error(m)}if(t().configuredVfsKey===s&&t().fs)return console.log(`[VfsStore] UI Initialization skipped for key "${s}" (already configured).`),e({loading:!1}),t().fs}const{_setLoading:o,_setError:l,_addNodes:c,_setFsInstance:u,_setConfiguredVfsKey:f}=t();console.log(`[VfsStore] Initializing VFS with key: ${s} (Forced: ${a})`),e({initializingKey:s}),a||(o(!0),l(null));try{console.log(`[VfsStore DEBUG] About to call VfsOps.initializeFsOp with key: "${s}"`);const m=await lhe(s);if(console.log(`[VfsStore DEBUG] VfsOps.initializeFsOp returned. Instance valid: ${!!m}`),!m)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==s){const b=`UI Initialization for key "${s}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${b}`),e({initializingKey:null,loading:!1}),new Error(b)}if(a)return console.log(`[VfsStore] Forced initialization complete for key: ${s}. Returning instance.`),e({initializingKey:null}),m;u(m),f(s),console.log(`[VfsStore] UI VFS instance configured for key: ${s}`);const g="vfs-root";let v=t().nodes[g];try{await m.promises.stat("/"),console.log("[VfsStore] Root directory '/' exists.")}catch(b){if(b.code==="ENOENT")console.log("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw b}if(!v||v.path!=="/"){const b=Date.now();v={id:g,parentId:null,name:"",path:"/",type:"folder",createdAt:b,lastModified:b},c([v]),console.log("[VfsStore] Root node added/updated in state.")}return e(b=>{b.rootId=v.id,b.currentParentId=v.id}),console.log(`[VfsStore] Set rootId and currentParentId to: ${v.id}`),await t().fetchNodes(v.id),m}catch(m){const g=`Failed to initialize VFS (${s}): ${m instanceof Error?m.message:String(m)}`;throw console.error(`[VfsStore DEBUG] Error in initializeVFS catch block: ${g}`,m),t().initializingKey===s&&(l(g),a||(u(null),f(null))),new Error(g)}finally{console.log(`[VfsStore DEBUG] initializeVFS finally block for key: "${s}". InitializingKey: ${t().initializingKey}`),t().initializingKey===s&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:s,_addNodes:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u,initializingKey:f}=t();if(!a||c!==u||f){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!a}, Match: ${c===u}, Init: ${f}`);return}r(!0);try{const m=n?o[n]:o[l||""],g=m?m.path:"/";console.log(`[VfsStore] Fetching nodes for path: ${g} (Key: ${c})`);const v=await NN(g,{fsInstance:a});console.log(`[VfsStore] Fetched ${v.length} entries for ${g}`);const b=n??l??"",w=new Set(v.map(k=>k.path)),E=(t().childrenMap[b]||[]).map(k=>t().nodes[k]).filter(Boolean).filter(k=>!w.has(k.path)).map(k=>k.id);E.length>0&&(console.log(`[VfsStore] Removing ${E.length} nodes.`),t()._removeNodes(E));const C=v.map(k=>{const R=Object.values(t().nodes).find(j=>j.path===k.path),I=Date.now();return{id:(R==null?void 0:R.id)||pi(),parentId:n,name:k.name,path:k.path,type:k.isDirectory?"folder":"file",size:k.size,createdAt:(R==null?void 0:R.createdAt)??I,lastModified:k.lastModified.getTime(),mimeType:k.isDirectory?void 0:k.mimeType}});C.length>0&&(console.log(`[VfsStore] Adding/Updating ${C.length} nodes.`),i(C)),e(k=>{const R=C.map(I=>I.id);(!k.childrenMap[b]||JSON.stringify(k.childrenMap[b].sort())!==JSON.stringify(R.sort()))&&(k.childrenMap[b]=R,console.log(`[VfsStore] Updated childrenMap for parent: ${b}`))})}catch(m){console.error("Failed to fetch VFS nodes:",m),s("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=ar(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const s=t().rootId;return s?t().nodes[s]:void 0}return Object.values(t().nodes).find(s=>s.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:s,rootId:i,fs:a}=t();if(!a||t().vfsKey!==t().configuredVfsKey)return;const o=ar(n),l=r(o);l&&l.type==="folder"?(e(c=>{c.currentParentId=l.id}),t().childrenMap[l.id]||await s(l.id)):o==="/"&&i?(e(c=>{c.currentParentId=i}),t().childrenMap[i]||await s(i)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,_addNodes:c,configuredVfsKey:u,vfsKey:f}=t();if(!a||u!==f){i("Filesystem not ready.");return}if(!r.trim()){i("Directory name cannot be empty.");return}s(!0);try{const m=n?o[n]:o[l||""],g=m?m.path:"/",v=rA(g,r.trim());try{throw await a.promises.stat(v),new Error(`"${r.trim()}" already exists.`)}catch(_){if(_.code!=="ENOENT")throw _}await Z$(v,{fsInstance:a});const b=Date.now(),x={id:pi(),parentId:n,name:r.trim(),path:v,type:"folder",createdAt:b,lastModified:b};c([x])}catch(m){console.error("Failed to create directory:",m),i(m.message||"Failed to create directory.")}finally{s(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u}=t();if(!a||c!==u){i("Filesystem not ready.");return}s(!0);try{const f=n?o[n]:o[l||""],m=f?f.path:"/";await Y$(Array.from(r),m,{fsInstance:a}),await t().fetchNodes(n)}catch(f){console.error("Failed to upload files:",f),i("Failed to upload one or more files.")}finally{s(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:s,_removeNodes:i,fs:a,configuredVfsKey:o,vfsKey:l}=t();if(!a||o!==l){s("Filesystem not ready.");return}r(!0);try{const c=n.map(u=>t().nodes[u]).filter(Boolean);for(const u of c)await IN(u.path,u.type==="folder",{fsInstance:a});i(n)}catch(c){console.error("Failed to delete nodes:",c),s("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:s,_setError:i,_updateNode:a,nodes:o,fs:l,rootId:c,configuredVfsKey:u,vfsKey:f}=t();if(!l||u!==f){i("Filesystem not ready.");return}if(!r.trim()){i("Name cannot be empty.");return}const m=o[n];if(!m){i("Item not found.");return}if(m.name!==r.trim()){s(!0);try{const g=m.parentId?o[m.parentId]:o[c||""],v=g?g.path:"/",b=rA(v,r.trim());try{throw await l.promises.stat(b),new Error(`"${r.trim()}" already exists.`)}catch(x){if(x.code!=="ENOENT")throw x}await X$(m.path,b,{fsInstance:l});const w={name:r.trim(),path:b,lastModified:Date.now()};a(n,w)}catch(g){console.error("Failed to rename item:",g),i(g.message||"Failed to rename item.")}finally{s(!1)}}},downloadFile:async n=>{const{nodes:r,fs:s,_setError:i,configuredVfsKey:a,vfsKey:o}=t();if(!s||a!==o)return i("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return i("File not found."),null;try{const c=await Sd(l.path,{fsInstance:s}),u=l.mimeType||"application/octet-stream",f=new Blob([c],{type:u});return{name:l.name,blob:f}}catch(c){return console.error("Failed to download file:",c),i("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{r.selectedFileIds.add(n)}),Be.emit(en.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)}),Be.emit(en.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()}),Be.emit(en.selectionChanged,{selectedFileIds:[]})},getRegisteredActionHandlers:()=>{const n="vfsStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:en.setVfsKeyRequest,handler:i=>r.setVfsKey(i.key),storeId:n},{eventName:en.initializeVFSRequest,handler:async i=>{await r.initializeVFS(i.vfsKey,i.options)},storeId:n},{eventName:en.fetchNodesRequest,handler:i=>r.fetchNodes(i.parentId),storeId:n},{eventName:en.setCurrentPathRequest,handler:i=>r.setCurrentPath(i.path),storeId:n},{eventName:en.createDirectoryRequest,handler:i=>r.createDirectory(i.parentId,i.name),storeId:n},{eventName:en.uploadFilesRequest,handler:i=>r.uploadFiles(i.parentId,i.files),storeId:n},{eventName:en.deleteNodesRequest,handler:i=>r.deleteNodes(i.ids),storeId:n},{eventName:en.renameNodeRequest,handler:i=>r.renameNode(i.id,i.newName),storeId:n},{eventName:en.downloadFileRequest,handler:s(r.downloadFile),storeId:n},{eventName:en.selectFileRequest,handler:i=>r.selectFile(i.fileId),storeId:n},{eventName:en.deselectFileRequest,handler:i=>r.deselectFile(i.fileId),storeId:n},{eventName:en.clearSelectionRequest,handler:r.clearSelection,storeId:n},{eventName:en.setEnableVfsRequest,handler:i=>r._setEnableVfs(i.enabled),storeId:n}]}}))),iwe="/synced_repos",br=oo(lo((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>(console.log("[ConversationStore] Ensuring Sync VFS is ready..."),new Promise((n,r)=>{const s=()=>{Be.off(en.fsInstanceChanged,i),Be.off(en.loadingStateChanged,a)},i=l=>{xs.getState().configuredVfsKey===Nu&&l.fsInstance&&(console.log(`[ConversationStore] Sync VFS ready via fsInstanceChanged for key ${Nu}.`),s(),n(l.fsInstance))},a=l=>{const c=xs.getState();c.configuredVfsKey===Nu&&(l.error?(console.error(`[ConversationStore] Sync VFS initialization error for key ${Nu}: ${l.error}`),s(),r(new Error(l.error))):!l.isLoading&&!l.operationLoading&&c.fs&&(console.log(`[ConversationStore] Sync VFS ready via loadingStateChanged for key ${Nu}.`),s(),n(c.fs)))};Be.on(en.fsInstanceChanged,i),Be.on(en.loadingStateChanged,a);const o=xs.getState();if(o.configuredVfsKey===Nu&&o.fs&&!o.loading&&!o.operationLoading&&!o.error){console.log(`[ConversationStore] Sync VFS already ready for key ${Nu}.`),s(),n(o.fs);return}Be.emit(en.initializeVFSRequest,{vfsKey:Nu,options:{force:!0}})})),loadConversations:async()=>{e({isLoading:!0,error:null});try{const[n,r]=await Promise.all([Rt.loadConversations(),Rt.loadSyncRepos()]),s={};n.forEach(i=>{if(i.syncRepoId){const a=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,o=i.updatedAt instanceof Date?i.updatedAt.getTime():null;a?o&&o>a?s[i.id]="needs-sync":s[i.id]="idle":s[i.id]="needs-sync"}else s[i.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:s,repoInitializationStatus:{},isLoading:!1}),Be.emit(Mn.conversationsLoaded,{conversations:n}),Be.emit(Mn.syncReposLoaded,{repos:r})}catch(n){console.error("ConversationStore: Error loading conversations",n),e({error:"Failed load conversations",isLoading:!1}),Be.emit(Mn.loadingStateChanged,{isLoading:!1,error:"Failed load conversations"})}},addConversation:async n=>{const r=pi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};let a=!1;try{const o=JSON.stringify(i);return await Rt.saveConversation(JSON.parse(o)),a=!0,e(l=>{l.conversations.some(c=>c.id===i.id)||(l.conversations.unshift(i),l.conversationSyncStatus[r]=i.syncRepoId?"needs-sync":"idle")}),Be.emit(Mn.conversationAdded,{conversation:i}),r}catch(o){throw console.error("ConversationStore: Error adding conversation",o),a&&e(l=>({error:"Failed to save new conversation to state",conversations:l.conversations.filter(c=>c.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(l.conversationSyncStatus).filter(([c])=>c!==r))})),o}},updateConversation:async(n,r)=>{const s=t().getConversationById(n);if(!s){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=a.conversations[o].metadata??{},c=r.metadata??{},u={...l,...c};Object.assign(a.conversations[o],{...r,metadata:u,updatedAt:new Date});const f=["title","metadata","projectId"].some(v=>v in r),m=a.conversations[o].lastSyncedAt instanceof Date?a.conversations[o].lastSyncedAt.getTime():null,g=a.conversations[o].updatedAt.getTime();"syncRepoId"in r?a.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":f&&a.conversations[o].syncRepoId&&a.conversationSyncStatus[n]==="idle"&&(!m||g>m)&&(a.conversationSyncStatus[n]="needs-sync")}});const i=t().getConversationById(n);if(i)try{const a=JSON.parse(JSON.stringify(i));await Rt.saveConversation(a),Be.emit(Mn.conversationUpdated,{conversationId:n,updates:r})}catch(a){throw console.error("ConversationStore: Error updating conversation",a),e(o=>{const l=o.conversations.findIndex(c=>c.id===n);if(l!==-1){o.conversations[l]=s;const c=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,u=s.updatedAt.getTime();o.conversationSyncStatus[n]=s.syncRepoId&&c&&u<=c?"idle":s.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),a}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){a.conversations[o]=s;const l=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,c=s.updatedAt.getTime();a.conversationSyncStatus[n]=s.syncRepoId&&l&&c<=l?"idle":s.syncRepoId?"needs-sync":"idle"}a.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,s=t().selectedItemType,i=t().conversations.find(a=>a.id===n);if(i){e(a=>({conversations:a.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&s==="conversation"?null:r,selectedItemType:r===n&&s==="conversation"?null:s,conversationSyncStatus:Object.fromEntries(Object.entries(a.conversationSyncStatus).filter(([o])=>o!==n))}));try{await Rt.deleteConversation(n),await Rt.deleteInteractionsForConversation(n),Be.emit(Mn.conversationDeleted,{conversationId:n}),r===n&&s==="conversation"&&(Be.emit(On.setCurrentConversationIdRequest,{id:null}),Be.emit(Mn.selectedItemChanged,{itemId:null,itemType:null}))}catch(a){throw console.error("ConversationStore: Error deleting conversation",a),e(o=>{if(i){o.conversations.push(i);const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,c=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&l&&c<=l?"idle":i.syncRepoId?"needs-sync":"idle"}r===n&&s==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),a}}},selectItem:async(n,r)=>{const s=t().selectedItemId,i=t().selectedItemType;if(s===n&&i===r)return;console.log(`ConversationStore: Selecting item. ID: ${n}, Type: ${r}. Previous: ${s} (${i})`);const a=r==="conversation"?n:null;a&&(Be.emit(On.setCurrentConversationIdRequest,{id:a}),Be.emit(On.loadInteractionsRequest,{conversationId:a})),e({selectedItemId:n,selectedItemType:r}),Be.emit(Mn.selectedItemChanged,{itemId:n,itemType:r})},importConversation:async n=>{await fp.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await fp.exportConversation(n,r)},exportProject:async n=>{await fp.exportProject(n)},exportAllConversations:async()=>{await fp.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await Rt.loadSyncRepos();e({syncRepos:n,isLoading:!1}),Be.emit(Mn.syncReposLoaded,{repos:n})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1}),Be.emit(Mn.loadingStateChanged,{isLoading:!1,error:"Failed load sync repositories"})}}},addSyncRepo:async n=>{const r=pi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(a=>{a.syncRepos.push(i)});try{const a=t().syncRepos.find(o=>o.id===r);if(a){const o=JSON.parse(JSON.stringify(a));await Rt.saveSyncRepo(o),Be.emit(r0.repoChanged,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");return Le.success(`Sync repository "${i.name}" added.`),r}catch(a){throw console.error("ConversationStore: Error adding sync repo",a),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),a}},updateSyncRepo:async(n,r)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(a.syncRepos[o],{...r,branch:r.branch||a.syncRepos[o].branch||"main",updatedAt:new Date})});const i=t().syncRepos.find(a=>a.id===n);if(i)try{const a=JSON.parse(JSON.stringify(i));await Rt.saveSyncRepo(a),Be.emit(r0.repoChanged,{repoId:n,action:"updated"}),Le.success(`Sync repository "${i.name}" updated.`)}catch(a){throw console.error("ConversationStore: Error updating sync repo",a),e(o=>{const l=o.syncRepos.findIndex(c=>c.id===n);l!==-1&&(o.syncRepos[l]=s),o.error="Failed to save sync repository update"}),a}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&(a.syncRepos[o]=s),a.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(a=>a.id===n);if(!r)return;const s=ar(`${iwe}/${n}`);let i;try{i=await t()._ensureSyncVfsReady()}catch{return}e(a=>({syncRepos:a.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(a.repoInitializationStatus).filter(([o])=>o!==n))}));try{await Rt.deleteSyncRepo(n),Be.emit(r0.repoChanged,{repoId:n,action:"deleted"}),Le.success(`Sync repository "${r.name}" deleted.`);try{console.log(`[ConversationStore] Deleting VFS directory: ${s}`),await IN(s,!0,{fsInstance:i}),Le.info(`Removed local sync folder for "${r.name}".`)}catch(a){console.error(`[ConversationStore] Failed to delete VFS directory ${s}:`,a),a.code!=="ENOENT"&&Le.warning(`Failed to remove local sync folder: ${a.message}`)}}catch(a){throw console.error("ConversationStore: Error deleting sync repo",a),e(o=>{r&&o.syncRepos.push(r),o.error="Failed to delete sync repository"}),a}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),Le.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,s=null)=>{e(i=>{i.conversationSyncStatus[n]=r,r==="error"&&s&&console.error(`Sync error for ${n}: ${s}`)}),Be.emit(Mn.conversationSyncStatusChanged,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(s=>{s.repoInitializationStatus[n]=r}),Be.emit(r0.repoInitStatusChanged,{repoId:n,status:r})},initializeOrSyncRepo:async n=>{const r=t().syncRepos.find(i=>i.id===n);if(!r){Le.error("Sync repsitory configuration not found.");return}let s;try{s=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await nwe(s,r,t()._setRepoInitializationStatus)},syncConversation:async n=>{const r=t().getConversationById(n);if(!r){Le.error("Conversation not found for syncing.");return}if(!r.syncRepoId){Le.info("Conversation not linked to a sync repository.");return}const s=t().syncRepos.find(o=>o.id===r.syncRepoId);if(!s){Le.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let i;try{i=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await rwe(i,r,s,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType);const a=t().getConversationById(n);a&&e(o=>{const l=o.conversations.findIndex(c=>c.id===n);l!==-1&&(o.conversations[l]=a)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:s,updateConversation:i}=t();if(s!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const a=t().getConversationById(r);if(!a){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=a.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!a.metadata)&&await i(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(s=>{s.conversations=s.conversations.map(i=>i.projectId&&r.has(i.projectId)?{...i,projectId:null}:i)})},getRegisteredActionHandlers:()=>{const n="conversationStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Mn.loadConversationsRequest,handler:r.loadConversations,storeId:n},{eventName:Mn.addConversationRequest,handler:s(r.addConversation),storeId:n},{eventName:Mn.updateConversationRequest,handler:i=>r.updateConversation(i.id,i.updates),storeId:n},{eventName:Mn.deleteConversationRequest,handler:i=>r.deleteConversation(i.id),storeId:n},{eventName:Mn.selectItemRequest,handler:i=>r.selectItem(i.id,i.type),storeId:n},{eventName:Mn.importConversationRequest,handler:i=>r.importConversation(i.file),storeId:n},{eventName:Mn.exportConversationRequest,handler:i=>r.exportConversation(i.conversationId,i.format),storeId:n},{eventName:Mn.exportProjectRequest,handler:i=>r.exportProject(i.projectId),storeId:n},{eventName:Mn.exportAllConversationsRequest,handler:r.exportAllConversations,storeId:n},{eventName:Mn.loadSyncReposRequest,handler:r.loadSyncRepos,storeId:n},{eventName:Mn.addSyncRepoRequest,handler:s(r.addSyncRepo),storeId:n},{eventName:Mn.updateSyncRepoRequest,handler:i=>r.updateSyncRepo(i.id,i.updates),storeId:n},{eventName:Mn.deleteSyncRepoRequest,handler:i=>r.deleteSyncRepo(i.id),storeId:n},{eventName:Mn.linkConversationToRepoRequest,handler:i=>r.linkConversationToRepo(i.conversationId,i.repoId),storeId:n},{eventName:Mn.syncConversationRequest,handler:i=>r.syncConversation(i.conversationId),storeId:n},{eventName:Mn.initializeOrSyncRepoRequest,handler:i=>r.initializeOrSyncRepo(i.repoId),storeId:n},{eventName:Mn.updateCurrentConversationToolSettingsRequest,handler:i=>r.updateCurrentConversationToolSettings(i),storeId:n}]}}))),Ep={copyInteractionResponseRequest:"canvas.interaction.copy.response.request",regenerateInteractionRequest:"canvas.interaction.regenerate.request",copyCodeBlockRequest:"canvas.codeblock.copy.request"},XN={async submitPrompt(e){var L,q,P,V,z,re;console.log("[ConversationService] submitPrompt called",e);const t=Bn.getState(),n=Oa.getState(),r=Ml.getState(),s=br.getState(),i=ir.getState(),a=t.currentConversationId;if(!a){Le.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=s.getConversationById(a),l=(o==null?void 0:o.projectId)??null,c=n.getEffectiveProjectSettings(l),f=t.interactions.filter(K=>K.conversationId===a).length===0&&i.autoTitleEnabled&&((L=e.metadata)==null?void 0:L.autoTitleEnabledForTurn)===!0&&i.autoTitleModelId,g=t.interactions.filter(K=>K.parentId===null&&K.status==="COMPLETED").sort((K,ee)=>K.index-ee.index).map(K=>{var ee;if(K.type==="message.assistant_regen"&&((ee=K.metadata)!=null&&ee.regeneratedFromId)){const W=t.interactions.find(se=>se.id===K.metadata.regeneratedFromId);if(W&&W.prompt&&W.type==="message.user_assistant")return{...K,prompt:W.prompt,type:"message.user_assistant"}}return K.type==="message.user_assistant"&&K.prompt?K:null}).filter(Boolean),v=p6(g);let b=e.content;const w=[],x=((q=e.metadata)==null?void 0:q.effectiveRulesContent)??[],_=x.filter(K=>K.type==="system").map(K=>K.content),E=x.filter(K=>K.type==="before").map(K=>K.content),C=x.filter(K=>K.type==="after").map(K=>K.content);E.length>0&&(b=`${E.join(`
`)}

${b}`),C.length>0&&(b=`${b}

    ${C.join(`
`)}`),b&&w.push({type:"text",text:b});const k=((P=e.metadata)==null?void 0:P.attachedFiles)??[];if(k.length>0){const K=await this._processFilesForPrompt(k,a);w.unshift(...K)}w.length>0?v.push({role:"user",content:w}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");let I=((V=e.metadata)==null?void 0:V.turnSystemPrompt)??c.systemPrompt??void 0;_.length>0&&(I=`${I?`${I}

        `:""}${_.join(`
`)}`);const j={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys(j).forEach(K=>{(j[K]===null||j[K]===void 0)&&delete j[K]});const M={system:I,messages:v,parameters:j,metadata:{...(({turnSystemPrompt:K,activeTagIds:ee,activeRuleIds:W,effectiveRulesContent:se,autoTitleEnabledForTurn:Y,...te})=>({...te,effectivelyAppliedTagIds:ee,effectivelyAppliedRuleIds:W}))(e.metadata??{}),modelId:r.modelId??void 0,attachedFiles:(z=e.metadata.attachedFiles)==null?void 0:z.map(({contentBase64:K,contentText:ee,...W})=>W)}};try{const K=p0.startInteraction(M,a,e);if(f){console.log("[ConversationService] Triggering asynchronous title generation.");const ee=(((re=e.metadata)==null?void 0:re.effectiveRulesContent)??[]).map(W=>({id:W.sourceRuleId||pi(),name:W.sourceRuleId?`Rule ${W.sourceRuleId.substring(0,4)}`:"Context Rule",content:W.content,type:W.type,createdAt:new Date,updatedAt:new Date}));this.generateConversationTitle(a,e,ee).catch(W=>{console.error("[ConversationService] Background title generation failed:",W)})}await K}catch(K){throw console.error("[ConversationService] Error starting interaction:",K),Le.error(`Failed to start interaction: ${K instanceof Error?K.message:String(K)}`),K}},async generateConversationTitle(e,t,n){var o,l;const r=ir.getState();if(!r.autoTitleModelId){console.warn("[ConversationService] Auto-title generation skipped: No model selected in settings.");return}let s=t.content;if(s.length>r.autoTitlePromptMaxLength&&(s=s.substring(0,r.autoTitlePromptMaxLength)+"..."),r.autoTitleIncludeFiles&&((l=(o=t.metadata)==null?void 0:o.attachedFiles)!=null&&l.length)){const c=t.metadata.attachedFiles.map(u=>u.name).join(", ");s+=`

[Attached files: ${c}]`}if(r.autoTitleIncludeRules&&n.length>0){const c=n.map(u=>u.name).join(", ");s+=`

[Active rules: ${c}]`}const i={system:"Generate a concise, descriptive title (max 8-10 words) for the following user prompt. Output ONLY the title text, nothing else.",messages:[{role:"user",content:s}],parameters:{temperature:.5,max_tokens:20},metadata:{modelId:r.autoTitleModelId,isTitleGeneration:!0},tools:void 0,toolChoice:"none"},a={id:pi(),content:`[Generate title based on: ${t.content.substring(0,50)}...]`,parameters:i.parameters,metadata:{...i.metadata,originalTurnId:t.id}};try{await p0.startInteraction(i,e,a,"conversation.title_generation")}catch(c){console.error("[ConversationService] Error starting title generation interaction:",c)}},async regenerateInteraction(e){var P,V,z,re;console.log(`[ConversationService] regenerateInteraction called for ID: ${e}`);const t=Bn.getState(),n=Oa.getState(),r=Ml.getState(),s=br.getState(),i=t.interactions.find(K=>K.id===e);if(console.log("[ConversationService] Target interaction for regen:",JSON.parse(JSON.stringify(i))),!i||!i.prompt){Le.error("Cannot regenerate: Original interaction data missing.");return}const a=null,o=i.index,l=i.prompt,c=i.conversationId,u=s.getConversationById(c),f=(u==null?void 0:u.projectId)??null,m=n.getEffectiveProjectSettings(f),g=i.index,v=t.interactions.filter(K=>K.conversationId===c&&K.index<g&&K.status==="COMPLETED"&&K.type==="message.user_assistant"&&K.parentId===null).sort((K,ee)=>K.index-ee.index),b=p6(v);let w=l.content;const x=[],_=((P=l.metadata)==null?void 0:P.effectiveRulesContent)??[],E=_.filter(K=>K.type==="system").map(K=>K.content),C=_.filter(K=>K.type==="before").map(K=>K.content),k=_.filter(K=>K.type==="after").map(K=>K.content);C.length>0&&(w=`${C.join(`
`)}

${w}`),k.length>0&&(w=`${w}

    ${k.join(`
`)}`),w&&x.push({type:"text",text:w});const R=((V=l.metadata)==null?void 0:V.attachedFiles)??[];if(R.length>0){const K=await this._processFilesForPrompt(R,c);x.unshift(...K)}x.length>0?b.push({role:"user",content:x}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");let j=((z=l.metadata)==null?void 0:z.turnSystemPrompt)??m.systemPrompt??void 0;E.length>0&&(j=`${j?`${j}

        `:""}${E.join(`
`)}`);const M={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...l.parameters??{}};Object.keys(M).forEach(K=>{(M[K]===null||M[K]===void 0)&&delete M[K]});const L={system:j,messages:b,parameters:M,metadata:{...(({turnSystemPrompt:K,activeTagIds:ee,activeRuleIds:W,effectiveRulesContent:se,autoTitleEnabledForTurn:Y,...te})=>({...te,effectivelyAppliedTagIds:ee,effectivelyAppliedRuleIds:W}))(l.metadata??{}),modelId:r.modelId??void 0,regeneratedFromId:e,attachedFiles:R.map(({contentBase64:K,contentText:ee,...W})=>W)}};let q=null;try{if(q=await p0.startInteraction(L,c,l,"message.assistant_regen"),!q)throw new Error("Failed to create new interaction for regeneration.");const K={};let ee=!1;q.index!==o&&(K.index=o,ee=!0),q.parentId!==a&&(K.parentId=a,ee=!0);let W=q;ee&&(t._updateInteractionInState(q.id,K),W={...q,...K},await Rt.saveInteraction(W)),console.log("[ConversationService] New active interaction state after potential updates:",JSON.parse(JSON.stringify(W)));const se=[];let Y=i;for(;Y;){se.push(Y);const Q=(re=Y.metadata)==null?void 0:re.regeneratedFromId;Q?Y=t.interactions.find(ae=>ae.id===Q):Y=null}const te=se.sort((Q,ae)=>{var Me,Pe;const xe=((Me=Q.startedAt)==null?void 0:Me.getTime())??0,ge=((Pe=ae.startedAt)==null?void 0:Pe.getTime())??0;return xe-ge});for(let Q=0;Q<te.length;Q++){const ae=te[Q],xe={parentId:W.id,index:Q};console.log(`[ConversationService] Updating old version ${ae.id} to be child of ${W.id} with childIndex ${Q}`,JSON.parse(JSON.stringify(xe))),t._updateInteractionInState(ae.id,xe),await Rt.saveInteraction({...ae,...xe})}}catch(K){throw console.error("[ConversationService] Error during regeneration process:",K),Le.error(`Failed to regenerate response: ${K instanceof Error?K.message:String(K)}`),K}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(i=>i.source==="vfs");let s;if(r.length>0){const i=br.getState().getConversationById(t),a=(i==null?void 0:i.projectId)??"orphan";try{s=await this._ensureVfsReady(a)}catch{Le.error(`Filesystem unavailable for key ${a}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),s=void 0}}for(const i of e){let a=null;try{if(i.source==="direct")a=h6(i);else if(i.source==="vfs"&&s&&i.path){console.log(`[ConversationService] Fetching VFS file: ${i.path}`);const o=await Sd(i.path,{fsInstance:s});a=h6({...i,contentBytes:o})}else if(i.source==="vfs"&&!s)continue;a&&n.push(a)}catch(o){console.error(`[ConversationService] Error processing file ${i.name}:`,o),n.push({type:"text",text:`[Error processing file: ${i.name}]`})}}return n},async _ensureVfsReady(e){return console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`),new Promise((t,n)=>{const r=o=>{xs.getState().configuredVfsKey===e&&(i(),t(o.fsInstance))},s=o=>{if(xs.getState().configuredVfsKey===e&&!o.isLoading&&!o.operationLoading)if(o.error)i(),n(new Error(o.error));else{const l=xs.getState().fs;l&&(i(),t(l))}},i=()=>{Be.off(en.fsInstanceChanged,r),Be.off(en.loadingStateChanged,s)};Be.on(en.fsInstanceChanged,r),Be.on(en.loadingStateChanged,s);const a=xs.getState();if(a.configuredVfsKey===e&&a.fs&&!a.loading&&!a.operationLoading&&!a.error){i(),t(a.fs);return}if(a.configuredVfsKey===e&&a.error&&!a.loading&&!a.operationLoading){i(),n(new Error(a.error));return}Be.emit(en.initializeVFSRequest,{vfsKey:e,options:{force:!0}})})}},p0={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,_pendingRegenerations:new Set,initializeCanvasEventHandlers(){Be.on(Ep.copyInteractionResponseRequest,async e=>{const{interactionId:t}=e,n=Bn.getState().interactions.find(s=>s.id===t);if(!n){Le.error(`Copy failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Copy request for unknown interaction ${t}`);return}const r=n.response??"";if(typeof r!="string"||r.trim()===""){Le.info("No response content to copy.");return}try{await navigator.clipboard.writeText(r),Le.success("Response copied!")}catch(s){Le.error("Failed to copy response."),console.error("[InteractionService] Error copying response:",s)}}),Be.on(Ep.regenerateInteractionRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received regenerateInteractionRequest for ${t}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const n=Bn.getState().interactions.find(o=>o.id===t);if(!n){Le.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const r=Bn.getState();if(r.status==="streaming"){Le.info("Cannot regenerate while another response is streaming.");return}const i=r.interactions.filter(o=>o.conversationId===n.conversationId&&o.type==="message.user_assistant").sort((o,l)=>o.index-l.index),a=i.length>0?i[i.length-1]:null;if((a==null?void 0:a.id)!==t){Le.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t),console.log(`[InteractionService] Starting ConversationService.regenerateInteraction for ${t}`),await XN.regenerateInteraction(t),console.log(`[InteractionService] Finished ConversationService.regenerateInteraction for ${t}`)}catch(o){Le.error(`Failed to regenerate response: ${String(o)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,o)}finally{this._pendingRegenerations.delete(t)}}),Be.on(Ep.copyCodeBlockRequest,async e=>{const{content:t,interactionId:n,codeBlockId:r,language:s}=e;if(!t||t.trim()===""){Le.info("No code to copy.");return}try{await navigator.clipboard.writeText(t),Le.success(`Code block ${s?`(${s}) `:""}copied!`),console.log(`[InteractionService] Code block copied. InteractionID: ${n}, CodeBlockID: ${r}, Language: ${s}`)}catch(i){Le.error("Failed to copy code block."),console.error("[InteractionService] Error copying code block:",i)}})},async startInteraction(e,t,n,r="message.user_assistant"){var M,L,q,P,V,z,re,K,ee,W;console.log(`[InteractionService] startInteraction called (Type: ${r})`,e,t,n);const s=await Dx(H0.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(s===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const i=s&&typeof s=="object"?s.prompt:e,a=pi(),o=new AbortController;this._activeControllers.set(a,o),this._streamingToolData.set(a,{calls:[],results:[]}),this._firstChunkTimestamps.delete(a),this._interactionStartTimes.delete(a);const l=Bn.getState(),u=l.interactions.filter(se=>se.conversationId===t),f=r==="conversation.title_generation"?-1:u.reduce((se,Y)=>Math.max(se,Y.index),-1)+1,m=null,g=performance.now();this._interactionStartTimes.set(a,g);const v={id:a,conversationId:t,type:r,prompt:{...n},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...i.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0,timeToFirstToken:void 0,generationTime:void 0,isTitleGeneration:r==="conversation.title_generation"},index:f,parentId:m};r!=="conversation.title_generation"?(l._addInteractionToState(v),l._addStreamingId(a)):(l._addInteractionToState(v),l._addStreamingId(a),console.log(`[InteractionService] Added title generation interaction ${a} to state.`)),Rt.saveInteraction({...v}).catch(se=>{console.error(`[InteractionService] Failed initial persistence for ${a}`,se)}),Be.emit(On.started,{interactionId:a,conversationId:t,type:v.type});const b=(M=i.metadata)==null?void 0:M.modelId;if(!b)return this._finalizeInteraction(a,"ERROR",new Error("No model ID specified in prompt metadata."),r),null;const{providerId:w,modelId:x}=jo(b);if(!w||!x)return this._finalizeInteraction(a,"ERROR",new Error(`Invalid combined model ID format: ${b}`),r),null;const _=gr.getState().dbProviderConfigs.find(se=>se.id===w);if(!_)return this._finalizeInteraction(a,"ERROR",new Error(`Provider configuration not found for ID: ${w}`),r),null;const E=gr.getState().getApiKeyForProvider(w),C=kR(_,x,E);if(!C)return this._finalizeInteraction(a,"ERROR",new Error(`Failed to instantiate model instance ${b} from provider ${_.name}`),r),null;console.log(`[InteractionService] Using model instance for ${b}`);const k=r!=="conversation.title_generation"?(((L=i.metadata)==null?void 0:L.enabledTools)??[]).reduce((se,Y)=>{const Q=co.getState().getRegisteredTools()[Y];if(Q!=null&&Q.implementation){const ae={...Q.definition};ae.execute=async xe=>{const ge=Bn.getState().currentConversationId,Me=ge?br.getState().getConversationById(ge):null;let Pe;Me&&Me.projectId?typeof Me.projectId=="string"?Pe=Me.projectId:(console.warn(`[InteractionService] conversation.projectId for conversation ${ge} is not a string (type: ${typeof Me.projectId}). Defaulting VFS key to "orphan". Value:`,Me.projectId),Pe="orphan"):Pe="orphan";let Ie;try{if(Be.emit(en.initializeVFSRequest,{vfsKey:Pe,options:{force:!0}}),await new Promise(Ce=>setTimeout(Ce,100)),Ie=xs.getState().fs,xs.getState().configuredVfsKey!==Pe||!Ie)throw new Error(`Filesystem for key "${Pe}" not ready after request.`)}catch(Ce){return{_isError:!0,error:`Filesystem error: ${Ce.message}`}}try{const Ce=Qre(),He=Q.definition.parameters.parse(xe),it=Q.implementation,Ge={...Ce,fsInstance:Ie};return await it(He,Ge)}catch(Ce){const He=Ce instanceof Error?Ce.message:String(Ce);return Ce instanceof D.ZodError?{_isError:!0,error:`Invalid arguments: ${Ce.errors.map(it=>`${it.path.join(".")} (${it.message})`).join(", ")}`}:{_isError:!0,error:He}}},se[Y]=ae}return se},{}):void 0,R=((q=i.parameters)==null?void 0:q.maxSteps)??ir.getState().toolMaxSteps,I={model:C,messages:i.messages,abortSignal:o.signal,system:i.system,temperature:(P=i.parameters)==null?void 0:P.temperature,maxTokens:(V=i.parameters)==null?void 0:V.max_tokens,topP:(z=i.parameters)==null?void 0:z.top_p,topK:(re=i.parameters)==null?void 0:re.top_k,presencePenalty:(K=i.parameters)==null?void 0:K.presence_penalty,frequencyPenalty:(ee=i.parameters)==null?void 0:ee.frequency_penalty,maxSteps:R,...k&&Object.keys(k).length>0&&{tools:k},...((W=i.parameters)==null?void 0:W.providerOptions)&&{providerOptions:i.parameters.providerOptions},toolChoice:i.toolChoice},j={onChunk:se=>this._handleChunk(a,se),onReasoningChunk:se=>this._handleReasoningChunk(a,se),onToolCall:se=>this._handleToolCall(a,se),onToolResult:se=>this._handleToolResult(a,se),onFinish:se=>this._handleFinish(a,se,r),onError:se=>this._handleError(a,se,r)};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${a}`),ewe.executeInteraction(a,I,j).catch(se=>{console.error(`[InteractionService] Error during AIService.executeInteraction for ${a}:`,se);const Y=Bn.getState().interactions.find(te=>te.id===a);Y&&Y.status==="STREAMING"&&this._finalizeInteraction(a,"ERROR",se instanceof Error?se:new Error(String(se)),r)}),v},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);if(t&&!t.signal.aborted)t.abort(),Le.info("Interaction cancelled.");else{console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`);const n=Bn.getState(),r=n.interactions.find(s=>s.id===e);n.streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"),(r==null?void 0:r.type)??"message.user_assistant"))}},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await Dx(H0.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const s=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;Bn.getState().appendInteractionResponseChunk(e,s),Be.emit(On.streamChunk,{interactionId:e,chunk:s})}},_handleReasoningChunk(e,t){Bn.getState().appendReasoningChunk(e,t)},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),Bn.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),Bn.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},_handleFinish(e,t,n){console.log(`[InteractionService] Finishing interaction ${e} (Type: ${n}). Reason: ${t.finishReason}`),this._finalizeInteraction(e,"COMPLETED",void 0,n,t)},_handleError(e,t,n){console.error(`[InteractionService] Handling error for interaction ${e} (Type: ${n}):`,t);const r=t.name==="AbortError";this._finalizeInteraction(e,r?"CANCELLED":"ERROR",r?void 0:t,n)},_finalizeInteraction(e,t,n,r="message.user_assistant",s){var k;const i=Bn.getState(),a=i.interactions.find(R=>R.id===e);if(!a||a.status!=="STREAMING"&&r!=="conversation.title_generation"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const o=i.activeStreamBuffers[e]??"",l=i.activeReasoningBuffers[e]??"",c=this._streamingToolData.get(e)||{calls:[],results:[]},u=(a==null?void 0:a.metadata)||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${o.length}, Reasoning Length: ${l.length}`);const f=performance.now(),m=this._interactionStartTimes.get(e),g=this._firstChunkTimestamps.get(e),v=m?Math.round(f-m):void 0,b=m&&g?Math.round(g-m):void 0,w=(s==null?void 0:s.reasoning)??l,x={status:t,endedAt:new Date,response:o||null,metadata:{...u,...(s==null?void 0:s.usage)&&{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens,totalTokens:s.usage.totalTokens},...(s==null?void 0:s.providerMetadata)&&{providerMetadata:s.providerMetadata},toolCalls:c.calls,toolResults:c.results,reasoning:w||void 0,timeToFirstToken:b,generationTime:v,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};if(r==="conversation.title_generation"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const R=x.response.trim().replace(/^"|"$/g,"");R&&a&&(console.log(`[InteractionService] Updating conversation ${a.conversationId} title to: "${R}"`),Be.emit(Mn.updateConversationRequest,{id:a.conversationId,updates:{title:R}}))}i._updateInteractionInState(e,x),i._removeStreamingId(e);const _=Bn.getState().interactions.find(R=>R.id===e);_?(console.log(`[InteractionService] Persisting final state for ${e}. Response length: ${((k=_.response)==null?void 0:k.length)??0}`),Rt.saveInteraction({..._}).catch(R=>{console.error(`[InteractionService] Failed final persistence for ${e}`,R)})):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let E=[],C=[];try{E=c.calls.map(R=>JSON.parse(R)),C=c.results.map(R=>JSON.parse(R))}catch(R){console.error("[InteractionService] Failed to parse tool strings for event emitter:",R)}Be.emit(On.completed,{interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:E,toolResults:C}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e),console.log(`[InteractionService] Finalized interaction ${e} with status ${t}.`)}},h1=dt.memo(({interactionId:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var z;const{interaction:s,interactionStatus:i}=Bn(mn(re=>{const K=re.interactions.find(ee=>ee.id===e);return{interaction:K,interactionStatus:K==null?void 0:K.status}})),a=ir(re=>re.streamingRenderFPS),[o,l]=T.useState(""),[c,u]=T.useState(""),[f,m]=T.useState(!0),[g,v]=T.useState(!1),b=T.useRef(null),w=T.useRef(0),x=T.useRef(null);T.useEffect(()=>{const re=1e3/a;let K=!0;const ee=W=>{if(!K)return;if(Bn.getState().streamingInteractionIds.includes(e)){if(W-w.current>=re){const Y=Bn.getState().activeStreamBuffers[e]??"",te=Bn.getState().activeReasoningBuffers[e]??"";l(Y),u(te),w.current=W}b.current=requestAnimationFrame(ee)}else{const Y=Bn.getState().activeStreamBuffers[e]??"",te=Bn.getState().activeReasoningBuffers[e]??"";l(Y),u(te),b.current=null}};return b.current=requestAnimationFrame(ee),()=>{K=!1,b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[e,a]),T.useEffect(()=>{if(i&&i!=="STREAMING"){const re=Bn.getState().activeStreamBuffers[e]??"",K=Bn.getState().activeReasoningBuffers[e]??"";l(re),u(K),b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[i,e]);const{dbProviderConfigs:_,getAllAvailableModelDefsForProvider:E}=gr(mn(re=>({dbProviderConfigs:re.dbProviderConfigs,getAllAvailableModelDefsForProvider:re.getAllAvailableModelDefsForProvider}))),C=T.useMemo(()=>{var Q;const re=(Q=s==null?void 0:s.metadata)==null?void 0:Q.modelId;if(!re)return"Loading Model...";const{providerId:K,modelId:ee}=jo(re);if(!K||!ee)return re;const W=_.find(ae=>ae.id===K),se=(W==null?void 0:W.name)??K,te=E(K).find(ae=>ae.id===ee);return`${(te==null?void 0:te.name)??ee} (${se})`},[(z=s==null?void 0:s.metadata)==null?void 0:z.modelId,_,E]),k=T.useCallback(()=>m(re=>!re),[]),R=T.useCallback(()=>{v(!1)},[]),I=T.useCallback(()=>{v(!0)},[]),j=T.useCallback(()=>{g?R():I()},[g,R,I]);if(!s)return r?p.jsxs("div",{className:ct("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[p.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),p.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),p.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),p.jsxs("div",{className:"space-y-2 mt-2",children:[p.jsx("div",{className:"h-4 bg-muted rounded w-full"}),p.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),p.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]})]}):p.jsxs("div",{className:ct("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),p.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),p.jsxs("div",{className:"space-y-2 mt-2",children:[p.jsx("div",{className:"h-4 bg-muted rounded w-full"}),p.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),p.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]});const M=()=>{p0.abortInteraction(e)},L=n==null?void 0:n("header-actions",s,{isFolded:g,toggleFold:j}),q=n==null?void 0:n("actions",s),P=n==null?void 0:n("content",s),V=n==null?void 0:n("menu",s);return p.jsxs("div",{ref:x,className:ct("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors",i==="ERROR"?"border-destructive/50 bg-destructive/5":i==="STREAMING"?"border-primary/30":"border-border",t),children:[r&&s.prompt&&p.jsx(P_,{turnData:s.prompt,timestamp:s.startedAt,isAssistantComplete:!1}),p.jsxs("div",{className:ct("relative group/assistant",r&&s.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[V,p.jsxs("div",{className:ct("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[p.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[p.jsx(tF,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),p.jsx("div",{className:"flex flex-col min-w-0",children:p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",C,")"]}),p.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:L})]})})]}),p.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:p.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:"Streaming..."})})]}),!g&&p.jsxs(p.Fragment,{children:[P,c&&p.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[p.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:k,children:[p.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[p.jsx(dd,{className:"h-3.5 w-3.5"})," Reasoning (Streaming)"]}),p.jsx("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:p.jsx(gn,{tooltipText:f?"Show Reasoning":"Hide Reasoning",onClick:re=>{re.stopPropagation(),k()},"aria-label":f?"Show reasoning":"Hide reasoning",icon:f?p.jsx(Fl,{}):p.jsx(fd,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})})]}),!f&&p.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:c})]}),p.jsx(p0e,{interactionId:e,markdownContent:o,isStreaming:!0})]}),g&&p.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:j,children:[c?"[Reasoning] ":"",o&&typeof o=="string"?`"${o.substring(0,80)}${o.length>80?"...":""}"`:"[Streaming...]"]})]}),p.jsxs("div",{className:ct("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:[q,p.jsx(m0e,{onStop:M,"aria-label":"Stop Generation"})]})]})});h1.displayName="StreamingInteractionCard";const dD=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,awe=({displayModelName:e,timeAgo:t,promptTokens:n,completionTokens:r,timeToFirstToken:s,generationTime:i,headerActionsSlot:a})=>{const o=n!==void 0&&r!==void 0?n+r:void 0;return p.jsxs("div",{className:ct("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[p.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[p.jsx(tF,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),p.jsxs("div",{className:"flex flex-col min-w-0",children:[p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",e,")"]}),p.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:a})]}),p.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[o!==void 0&&p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsxs(lr,{className:"flex items-center gap-0.5 cursor-default",children:[p.jsx(LY,{className:"h-3 w-3"}),p.jsx("span",{children:o.toLocaleString()})]}),p.jsxs(cr,{side:"bottom",children:["Tokens: ",n??"?"," (Prompt) +"," ",r??"?"," (Completion) = ",o]})]})}),s!==void 0&&p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsxs(lr,{className:"flex items-center gap-0.5 cursor-default",children:[p.jsx(NJ,{className:"h-3 w-3"}),p.jsx("span",{children:dD(s)})]}),p.jsx(cr,{side:"bottom",children:"Time to First Token"})]})}),i!==void 0&&p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsxs(lr,{className:"flex items-center gap-0.5 cursor-default",children:[p.jsx(jY,{className:"h-3 w-3"}),p.jsx("span",{children:dD(i)})]}),p.jsx(cr,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),p.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:p.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:t})})]})},owe=({markdownContent:e})=>{const t=$N(e);return e!=null&&e.trim()?p.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>{if(typeof n=="string")return p.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`);if(n.type==="code"){const s=n;return p.jsx(hm,{lang:s.lang,code:s.code},`code-${r}`)}return null})}):null},lwe=({interactionId:e,response:t,toolCalls:n,toolResults:r,reasoning:s,isError:i,errorMessage:a,isFolded:o,toggleFold:l})=>{const[c,u]=T.useState(!0),[f,m]=T.useState(!1),g=co(mn(k=>Object.values(k.canvasControls))),v=T.useCallback((k,R)=>g.filter(I=>I.type==="tool-call-step"&&I.targetSlot===k&&I.renderer).map(I=>I.renderer?p.jsx(dt.Fragment,{children:I.renderer(R)},I.id):null).filter(Boolean),[g]),b=T.useMemo(()=>{if(!n)return[];const k=n.map(I=>JSON.parse(I)),R=(r==null?void 0:r.map(I=>JSON.parse(I)))??[];return k.map(I=>{const j=R.find(M=>M.toolCallId===I.toolCallId);return{call:I,result:j}})},[n,r]),w=T.useCallback(()=>u(k=>!k),[]),x=T.useCallback(async()=>{if(s)try{await navigator.clipboard.writeText(s),m(!0),Le.success("Reasoning copied!"),setTimeout(()=>m(!1),1500)}catch(k){Le.error("Failed to copy reasoning."),console.error("Clipboard copy failed for reasoning:",k)}},[s]),_=!!s,E=t&&(typeof t!="string"||t.trim().length>0),C=b&&b.length>0;return o?p.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:l,children:[_?"[Reasoning] ":"",C?`[${b==null?void 0:b.length} Tool Call(s)] `:"",E&&typeof t=="string"?`"${t.substring(0,80)}${t.length>80?"...":""}"`:C||_?"":"[No text response]"]}):p.jsxs(p.Fragment,{children:[i&&a&&p.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[p.jsx("p",{className:"font-semibold",children:"Error:"}),p.jsx("p",{children:a})]}),_&&p.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[p.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:w,children:[p.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[p.jsx(dd,{className:"h-3.5 w-3.5"})," Reasoning"]}),p.jsxs("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:[p.jsx(gn,{tooltipText:"Copy Reasoning",onClick:k=>{k.stopPropagation(),x()},"aria-label":"Copy reasoning",icon:f?p.jsx(Ui,{className:"text-green-500"}):p.jsx(P1,{}),className:"h-5 w-5 text-muted-foreground"}),p.jsx(gn,{tooltipText:c?"Show Reasoning":"Hide Reasoning",onClick:k=>{k.stopPropagation(),w()},"aria-label":c?"Show reasoning":"Hide reasoning",icon:c?p.jsx(Fl,{}):p.jsx(fd,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]})]}),!c&&p.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:s})]}),b.map(({call:k,result:R},I)=>{const j={interactionId:e,toolCall:k,toolResult:R,canvasContextType:"tool-call-step"};return p.jsx(dt.Fragment,{children:v("tool-call-content",j)},`tool-step-${k.toolCallId||I}`)}),E&&typeof t=="string"&&p.jsx(owe,{markdownContent:t,interactionId:e}),!E&&!C&&!_&&!i&&p.jsx("div",{className:"text-xs text-muted-foreground italic p-1",children:"[No text response]"})]})},vA=dt.memo(({interaction:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var L,q,P,V,z,re,K,ee,W,se,Y,te;const[s,i]=T.useState(!1),a=T.useRef(null),o=T.useCallback(()=>{i(!1)},[]),l=T.useCallback(()=>{i(!0)},[]),c=T.useCallback(()=>{s?o():l()},[s,o,l]),{dbProviderConfigs:u,getAllAvailableModelDefsForProvider:f}=gr(mn(Q=>({dbProviderConfigs:Q.dbProviderConfigs,getAllAvailableModelDefsForProvider:Q.getAllAvailableModelDefsForProvider}))),m=e.endedAt?sz(new Date(e.endedAt),{addSuffix:!0}):"Processing...",g=T.useMemo(()=>{var Ce;const Q=(Ce=e.metadata)==null?void 0:Ce.modelId;if(!Q)return"Unknown Model";const{providerId:ae,modelId:xe}=jo(Q);if(!ae||!xe)return Q;const ge=u.find(He=>He.id===ae),Me=(ge==null?void 0:ge.name)??ae,Ie=f(ae).find(He=>He.id===xe);return`${(Ie==null?void 0:Ie.name)??xe} (${Me})`},[(L=e.metadata)==null?void 0:L.modelId,u,f]),v=e.status==="COMPLETED",b=v||e.status==="ERROR",w=e.status==="ERROR",x=e.response&&(typeof e.response!="string"||e.response.trim().length>0),_=((q=e.metadata)==null?void 0:q.toolCalls)&&e.metadata.toolCalls.length>0,E=((P=e.metadata)==null?void 0:P.toolResults)&&e.metadata.toolResults.length>0,C=!!((V=e.metadata)!=null&&V.reasoning),k=x||_||E||C,R=n==null?void 0:n("header-actions",e,{isFolded:s,toggleFold:c}),I=n==null?void 0:n("actions",e),j=n==null?void 0:n("content",e),M=n==null?void 0:n("menu",e);return p.jsxs("div",{ref:a,className:ct("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors hover:bg-muted/50","overflow-wrap-anywhere",w?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&p.jsx(P_,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:v}),p.jsxs("div",{className:ct("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[M,p.jsx(awe,{displayModelName:g,timeAgo:m,isFolded:s,toggleFold:c,canFold:k,promptTokens:(z=e.metadata)==null?void 0:z.promptTokens,completionTokens:(re=e.metadata)==null?void 0:re.completionTokens,timeToFirstToken:(K=e.metadata)==null?void 0:K.timeToFirstToken,generationTime:(ee=e.metadata)==null?void 0:ee.generationTime,headerActionsSlot:R&&R.length>0?p.jsx(p.Fragment,{children:R}):void 0}),j,p.jsx(lwe,{interactionId:e.id,response:e.response,toolCalls:(W=e.metadata)==null?void 0:W.toolCalls,toolResults:(se=e.metadata)==null?void 0:se.toolResults,reasoning:(Y=e.metadata)==null?void 0:Y.reasoning,isError:w,errorMessage:(te=e.metadata)==null?void 0:te.error,isFolded:s,toggleFold:c})]}),b&&I&&I.length>0&&p.jsx("div",{className:ct("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:I})]})});vA.displayName="InteractionCard";const cwe=({interactionGroup:e,renderSlot:t,activeStreamingInteractionId:n})=>{const[r,s]=T.useState(0);if(!e||e.length===0)return null;if(e.length===1){const a=e[0];return p.jsxs("div",{className:"tab-content pt-0",children:[" ",a.id===n&&a.status==="STREAMING"?p.jsx(h1,{interactionId:a.id,renderSlot:t,showPrompt:!1},a.id):p.jsx(vA,{interaction:a,renderSlot:t,showPrompt:!1},a.id)]})}const i=e[r];return p.jsxs("div",{className:"response-tabs-container flex flex-col",children:[p.jsxs("div",{className:"tabs-header flex border-b mb-1",children:[" ",e.map((a,o)=>p.jsxs(Ct,{variant:"ghost",size:"sm",onClick:()=>s(o),className:`mr-0.5 rounded-b-none flex items-center px-2 py-1 text-xs font-medium hover:bg-muted/50 focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 transition-colors duration-150 ease-in-out               ${r===o?"border-b-2 border-primary text-primary":"border-b-2 border-transparent text-muted-foreground hover:text-foreground"}`,children:[o===0?p.jsx(cJ,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):p.jsx(xX,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}),o+1," "]},a.id))]}),p.jsxs("div",{className:"tab-content pt-1",children:[" ",i&&(i.id===n&&i.status==="STREAMING"?p.jsx(h1,{interactionId:i.id,renderSlot:t,showPrompt:!1},i.id):p.jsx(vA,{interaction:i,renderSlot:t,showPrompt:!1},i.id))]})]})};var uwe=T.createContext(void 0);function Am(e){const t=T.useContext(uwe);return e||t||"ltr"}function ky(e,[t,n]){return Math.min(n,Math.max(t,e))}function dwe(e,t){return T.useReducer((n,r)=>t[n][r]??n,e)}var JN="ScrollArea",[P7,u4e]=Ii(JN),[fwe,po]=P7(JN),D7=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...a}=e,[o,l]=T.useState(null),[c,u]=T.useState(null),[f,m]=T.useState(null),[g,v]=T.useState(null),[b,w]=T.useState(null),[x,_]=T.useState(0),[E,C]=T.useState(0),[k,R]=T.useState(!1),[I,j]=T.useState(!1),M=Nn(t,q=>l(q)),L=Am(s);return p.jsx(fwe,{scope:n,type:r,dir:L,scrollHideDelay:i,scrollArea:o,viewport:c,onViewportChange:u,content:f,onContentChange:m,scrollbarX:g,onScrollbarXChange:v,scrollbarXEnabled:k,onScrollbarXEnabledChange:R,scrollbarY:b,onScrollbarYChange:w,scrollbarYEnabled:I,onScrollbarYEnabledChange:j,onCornerWidthChange:_,onCornerHeightChange:C,children:p.jsx(sn.div,{dir:L,...a,ref:M,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":E+"px",...e.style}})})});D7.displayName=JN;var F7="ScrollAreaViewport",L7=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,a=po(F7,n),o=T.useRef(null),l=Nn(t,o,a.onViewportChange);return p.jsxs(p.Fragment,{children:[p.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),p.jsx(sn.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:p.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});L7.displayName=F7;var zl="ScrollAreaScrollbar",B7=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=po(zl,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,o=e.orientation==="horizontal";return T.useEffect(()=>(o?i(!0):a(!0),()=>{o?i(!1):a(!1)}),[o,i,a]),s.type==="hover"?p.jsx(hwe,{...r,ref:t,forceMount:n}):s.type==="scroll"?p.jsx(pwe,{...r,ref:t,forceMount:n}):s.type==="auto"?p.jsx($7,{...r,ref:t,forceMount:n}):s.type==="always"?p.jsx(QN,{...r,ref:t}):null});B7.displayName=zl;var hwe=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=po(zl,e.__scopeScrollArea),[i,a]=T.useState(!1);return T.useEffect(()=>{const o=s.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),p.jsx(si,{present:n||i,children:p.jsx($7,{"data-state":i?"visible":"hidden",...r,ref:t})})}),pwe=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=po(zl,e.__scopeScrollArea),i=e.orientation==="horizontal",a=$_(()=>l("SCROLL_END"),100),[o,l]=dwe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return T.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,s.scrollHideDelay,l]),T.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let f=c[u];const m=()=>{const g=c[u];f!==g&&(l("SCROLL"),a()),f=g};return c.addEventListener("scroll",m),()=>c.removeEventListener("scroll",m)}},[s.viewport,i,l,a]),p.jsx(si,{present:n||o!=="hidden",children:p.jsx(QN,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Ut(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Ut(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),$7=T.forwardRef((e,t)=>{const n=po(zl,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,a]=T.useState(!1),o=e.orientation==="horizontal",l=$_(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(o?c:u)}},10);return Jp(n.viewport,l),Jp(n.content,l),p.jsx(si,{present:r||i,children:p.jsx(QN,{"data-state":i?"visible":"hidden",...s,ref:t})})}),QN=T.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=po(zl,e.__scopeScrollArea),i=T.useRef(null),a=T.useRef(0),[o,l]=T.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=H7(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:m=>i.current=m,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:m=>a.current=m};function f(m,g){return wwe(m,a.current,o,g)}return n==="horizontal"?p.jsx(mwe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const m=s.viewport.scrollLeft,g=fD(m,o,s.dir);i.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:m=>{s.viewport&&(s.viewport.scrollLeft=m)},onDragScroll:m=>{s.viewport&&(s.viewport.scrollLeft=f(m,s.dir))}}):n==="vertical"?p.jsx(gwe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const m=s.viewport.scrollTop,g=fD(m,o);i.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:m=>{s.viewport&&(s.viewport.scrollTop=m)},onDragScroll:m=>{s.viewport&&(s.viewport.scrollTop=f(m))}}):null}),mwe=T.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=po(zl,e.__scopeScrollArea),[a,o]=T.useState(),l=T.useRef(null),c=Nn(t,l,i.onScrollbarXChange);return T.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),p.jsx(U7,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":B_(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,f)=>{if(i.viewport){const m=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(m),K7(m,f)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:m1(a.paddingLeft),paddingEnd:m1(a.paddingRight)}})}})}),gwe=T.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=po(zl,e.__scopeScrollArea),[a,o]=T.useState(),l=T.useRef(null),c=Nn(t,l,i.onScrollbarYChange);return T.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),p.jsx(U7,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":B_(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,f)=>{if(i.viewport){const m=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(m),K7(m,f)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:m1(a.paddingTop),paddingEnd:m1(a.paddingBottom)}})}})}),[ywe,z7]=P7(zl),U7=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:f,...m}=e,g=po(zl,n),[v,b]=T.useState(null),w=Nn(t,M=>b(M)),x=T.useRef(null),_=T.useRef(""),E=g.viewport,C=r.content-r.viewport,k=Xs(u),R=Xs(l),I=$_(f,10);function j(M){if(x.current){const L=M.clientX-x.current.left,q=M.clientY-x.current.top;c({x:L,y:q})}}return T.useEffect(()=>{const M=L=>{const q=L.target;(v==null?void 0:v.contains(q))&&k(L,C)};return document.addEventListener("wheel",M,{passive:!1}),()=>document.removeEventListener("wheel",M,{passive:!1})},[E,v,C,k]),T.useEffect(R,[r,R]),Jp(v,I),Jp(g.content,I),p.jsx(ywe,{scope:n,scrollbar:v,hasThumb:s,onThumbChange:Xs(i),onThumbPointerUp:Xs(a),onThumbPositionChange:R,onThumbPointerDown:Xs(o),children:p.jsx(sn.div,{...m,ref:w,style:{position:"absolute",...m.style},onPointerDown:Ut(e.onPointerDown,M=>{M.button===0&&(M.target.setPointerCapture(M.pointerId),x.current=v.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),j(M))}),onPointerMove:Ut(e.onPointerMove,j),onPointerUp:Ut(e.onPointerUp,M=>{const L=M.target;L.hasPointerCapture(M.pointerId)&&L.releasePointerCapture(M.pointerId),document.body.style.webkitUserSelect=_.current,g.viewport&&(g.viewport.style.scrollBehavior=""),x.current=null})})})}),p1="ScrollAreaThumb",q7=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=z7(p1,e.__scopeScrollArea);return p.jsx(si,{present:n||s.hasThumb,children:p.jsx(bwe,{ref:t,...r})})}),bwe=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=po(p1,n),a=z7(p1,n),{onThumbPositionChange:o}=a,l=Nn(t,f=>a.onThumbChange(f)),c=T.useRef(void 0),u=$_(()=>{c.current&&(c.current(),c.current=void 0)},100);return T.useEffect(()=>{const f=i.viewport;if(f){const m=()=>{if(u(),!c.current){const g=xwe(f,o);c.current=g,o()}};return o(),f.addEventListener("scroll",m),()=>f.removeEventListener("scroll",m)}},[i.viewport,u,o]),p.jsx(sn.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Ut(e.onPointerDownCapture,f=>{const g=f.target.getBoundingClientRect(),v=f.clientX-g.left,b=f.clientY-g.top;a.onThumbPointerDown({x:v,y:b})}),onPointerUp:Ut(e.onPointerUp,a.onThumbPointerUp)})});q7.displayName=p1;var eI="ScrollAreaCorner",V7=T.forwardRef((e,t)=>{const n=po(eI,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?p.jsx(vwe,{...e,ref:t}):null});V7.displayName=eI;var vwe=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=po(eI,n),[i,a]=T.useState(0),[o,l]=T.useState(0),c=!!(i&&o);return Jp(s.scrollbarX,()=>{var f;const u=((f=s.scrollbarX)==null?void 0:f.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),Jp(s.scrollbarY,()=>{var f;const u=((f=s.scrollbarY)==null?void 0:f.offsetWidth)||0;s.onCornerWidthChange(u),a(u)}),c?p.jsx(sn.div,{...r,ref:t,style:{width:i,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function m1(e){return e?parseInt(e,10):0}function H7(e,t){const n=e/t;return isNaN(n)?0:n}function B_(e){const t=H7(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function wwe(e,t,n,r="ltr"){const s=B_(n),i=s/2,a=t||i,o=s-a,l=n.scrollbar.paddingStart+a,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,f=r==="ltr"?[0,u]:[u*-1,0];return G7([l,c],f)(e)}function fD(e,t,n="ltr"){const r=B_(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,a=t.content-t.viewport,o=i-r,l=n==="ltr"?[0,a]:[a*-1,0],c=ky(e,l);return G7([0,a],[0,o])(c)}function G7(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function K7(e,t){return e>0&&e<t}var xwe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},a=n.left!==i.left,o=n.top!==i.top;(a||o)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function $_(e,t){const n=Xs(e),r=T.useRef(0);return T.useEffect(()=>()=>window.clearTimeout(r.current),[]),T.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Jp(e,t){const n=Xs(t);mi(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var _we=D7,Swe=L7,Ewe=V7;function Hi({className:e,children:t,...n}){return p.jsxs(_we,{"data-slot":"scroll-area",className:ct("relative",e),...n,children:[p.jsx(Swe,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),p.jsx(Cwe,{}),p.jsx(Ewe,{})]})}function Cwe({className:e,orientation:t="vertical",...n}){return p.jsx(B7,{"data-slot":"scroll-area-scrollbar",orientation:t,className:ct("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:p.jsx(q7,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function dr({className:e,...t}){return p.jsx("div",{"data-slot":"skeleton",className:ct("bg-accent animate-pulse rounded-md",e),...t})}const kwe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[p.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:p.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),p.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[p.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),p.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),p.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[p.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),p.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),p.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:p.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})};function W7({className:e,...t}){return p.jsx("div",{"data-slot":"card",className:ct("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function Z7({className:e,...t}){return p.jsx("div",{"data-slot":"card-header",className:ct("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function Y7({className:e,...t}){return p.jsx("div",{"data-slot":"card-title",className:ct("leading-none font-semibold",e),...t})}function Twe({className:e,...t}){return p.jsx("div",{"data-slot":"card-description",className:ct("text-muted-foreground text-sm",e),...t})}function X7({className:e,...t}){return p.jsx("div",{"data-slot":"card-content",className:ct("px-6",e),...t})}const Xn={sidebarVisibilityChanged:"ui.sidebar.visibility.changed",chatControlPanelVisibilityChanged:"ui.chat.control.panel.visibility.changed",promptControlPanelVisibilityChanged:"ui.prompt.control.panel.visibility.changed",globalLoadingChanged:"ui.global.loading.changed",globalErrorChanged:"ui.global.error.changed",focusInputFlagChanged:"ui.focus.input.flag.changed",modalStateChanged:"ui.modal.state.changed",toggleSidebarRequest:"ui.toggle.sidebar.request",toggleChatControlPanelRequest:"ui.toggle.chat.control.panel.request",togglePromptControlPanelRequest:"ui.toggle.prompt.control.panel.request",setGlobalLoadingRequest:"ui.set.global.loading.request",setGlobalErrorRequest:"ui.set.global.error.request",setFocusInputFlagRequest:"ui.set.focus.input.flag.request",openModalRequest:"ui.modal.open.request",closeModalRequest:"ui.modal.close.request",contextChanged:"ui.legacy.contextChanged"},Awe=({title:e,description:t,icon:n,onClick:r})=>p.jsxs(W7,{className:"hover:border-primary/50 hover:bg-muted/30 transition-all cursor-pointer group",onClick:r,children:[p.jsxs(Z7,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[p.jsxs(Y7,{className:"text-sm font-medium flex items-center gap-2",children:[n," ",e]}),p.jsx(dY,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]}),p.jsx(X7,{children:p.jsx("p",{className:"text-xs text-muted-foreground",children:t})})]}),J7=()=>{const e=(r,s)=>{Be.emit(Xn.openModalRequest,{modalId:"settingsModal",initialTab:r,initialSubTab:s})},t=()=>{Be.emit(Xn.openModalRequest,{modalId:"core-vfs-modal-panel"})},n=[{title:"Configure Theme",description:"Customize colors, fonts, and code block appearance.",icon:p.jsx(FX,{className:"h-4 w-4 text-purple-500"}),onClick:()=>e("theme")},{title:"Manage Rules & Tags",description:"Define reusable prompt snippets and organize them.",icon:p.jsx(ET,{className:"h-4 w-4 text-blue-500"}),onClick:()=>e("rules-tags")},{title:"Add Files",description:"Upload or manage files in the virtual filesystem.",icon:p.jsx(pR,{className:"h-4 w-4 text-cyan-500"}),onClick:t},{title:"Add Provider",description:"Connect to AI services like OpenAI, Ollama, etc.",icon:p.jsx(ox,{className:"h-4 w-4 text-green-500"}),onClick:()=>e("providers","providers-config")},{title:"Add API Key",description:"Store API keys securely in your browser.",icon:p.jsx(k0,{className:"h-4 w-4 text-amber-500"}),onClick:()=>e("providers","api-keys")}];return p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl w-full pt-4",children:n.map(r=>p.jsx(Awe,{title:r.title,description:r.description,icon:r.icon,onClick:r.onClick},r.title))})},hD=()=>p.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[p.jsx(kwe,{className:"h-16 w-16 text-muted-foreground mb-4"}),p.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),p.jsx("p",{className:"text-muted-foreground max-w-md mb-8",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat. You can also explore these setup options:"}),p.jsx(J7,{})]}),tI=T.createContext({});function nI(e){const t=T.useRef(null);return t.current===null&&(t.current=e()),t.current}const rI=typeof window<"u",Q7=rI?T.useLayoutEffect:T.useEffect,z_=T.createContext(null),sI=T.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class Rwe extends T.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=r instanceof HTMLElement&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Nwe({children:e,isPresent:t,anchorX:n}){const r=T.useId(),s=T.useRef(null),i=T.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=T.useContext(sI);return T.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:u,right:f}=i.current;if(t||!s.current||!o||!l)return;const m=n==="left"?`left: ${u}`:`right: ${f}`;s.current.dataset.motionPopId=r;const g=document.createElement("style");return a&&(g.nonce=a),document.head.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${m}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(g)&&document.head.removeChild(g)}},[t]),p.jsx(Rwe,{isPresent:t,childRef:s,sizeRef:i,children:T.cloneElement(e,{ref:s})})}const Iwe=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o})=>{const l=nI(jwe),c=T.useId();let u=!0,f=T.useMemo(()=>(u=!1,{id:c,initial:t,isPresent:n,custom:s,onExitComplete:m=>{l.set(m,!0);for(const g of l.values())if(!g)return;r&&r()},register:m=>(l.set(m,!1),()=>l.delete(m))}),[n,l,r]);return i&&u&&(f={...f}),T.useMemo(()=>{l.forEach((m,g)=>l.set(g,!1))},[n]),T.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(e=p.jsx(Nwe,{isPresent:n,anchorX:o,children:e})),p.jsx(z_.Provider,{value:f,children:e})};function jwe(){return new Map}function eU(e=!0){const t=T.useContext(z_);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,i=T.useId();T.useEffect(()=>{if(e)return s(i)},[e]);const a=T.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const Sw=e=>e.key||"";function pD(e){const t=[];return T.Children.forEach(e,n=>{T.isValidElement(n)&&t.push(n)}),t}const Mwe=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=eU(a),u=T.useMemo(()=>pD(e),[e]),f=a&&!l?[]:u.map(Sw),m=T.useRef(!0),g=T.useRef(u),v=nI(()=>new Map),[b,w]=T.useState(u),[x,_]=T.useState(u);Q7(()=>{m.current=!1,g.current=u;for(let k=0;k<x.length;k++){const R=Sw(x[k]);f.includes(R)?v.delete(R):v.get(R)!==!0&&v.set(R,!1)}},[x,f.length,f.join("-")]);const E=[];if(u!==b){let k=[...u];for(let R=0;R<x.length;R++){const I=x[R],j=Sw(I);f.includes(j)||(k.splice(R,0,I),E.push(I))}return i==="wait"&&E.length&&(k=E),_(pD(k)),w(u),null}const{forceRender:C}=T.useContext(tI);return p.jsx(p.Fragment,{children:x.map(k=>{const R=Sw(k),I=a&&!l?!1:u===x||f.includes(R),j=()=>{if(v.has(R))v.set(R,!0);else return;let M=!0;v.forEach(L=>{L||(M=!1)}),M&&(C==null||C(),_(g.current),a&&(c==null||c()),r&&r())};return p.jsx(Iwe,{isPresent:I,initial:!m.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,onExitComplete:I?void 0:j,anchorX:o,children:k},R)})})},Ew=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],mD={value:null};function Owe(e,t){let n=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(f){a.has(f)&&(u.schedule(f),e()),l++,f(o)}const u={schedule:(f,m=!1,g=!1)=>{const b=g&&s?n:r;return m&&a.add(f),b.has(f)||b.add(f),f},cancel:f=>{r.delete(f),a.delete(f)},process:f=>{if(o=f,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),t&&mD.value&&mD.value.frameloop[t].push(l),l=0,n.clear(),s=!1,i&&(i=!1,u.process(f))}};return u}const Fc={},Pwe=40;function tU(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=Ew.reduce((E,C)=>(E[C]=Owe(i,t?C:void 0),E),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:f,preRender:m,render:g,postRender:v}=a,b=()=>{const E=Fc.useManualTiming?s.timestamp:performance.now();n=!1,Fc.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(E-s.timestamp,Pwe),1)),s.timestamp=E,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),f.process(s),m.process(s),g.process(s),v.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(b))},w=()=>{n=!0,r=!0,s.isProcessing||e(b)};return{schedule:Ew.reduce((E,C)=>{const k=a[C];return E[C]=(R,I=!1,j=!1)=>(n||w(),k.schedule(R,I,j)),E},{}),cancel:E=>{for(let C=0;C<Ew.length;C++)a[Ew[C]].cancel(E)},state:s,steps:a}}const io=e=>e,{schedule:ls,cancel:ad,state:di,steps:Ik}=tU(typeof requestAnimationFrame<"u"?requestAnimationFrame:io,!0),nU=T.createContext({strict:!1}),gD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Qp={};for(const e in gD)Qp[e]={isEnabled:t=>gD[e].some(n=>!!t[n])};function Dwe(e){for(const t in e)Qp[t]={...Qp[t],...e[t]}}const Fwe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function g1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Fwe.has(e)}let rU=e=>!g1(e);function Lwe(e){e&&(rU=t=>t.startsWith("on")?!g1(t):e(t))}try{Lwe(require("@emotion/is-prop-valid").default)}catch{}function Bwe(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(rU(s)||n===!0&&g1(s)||!t&&!g1(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}function $we(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const U_=T.createContext({});function q_(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Ty(e){return typeof e=="string"||Array.isArray(e)}const iI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],aI=["initial",...iI];function V_(e){return q_(e.animate)||aI.some(t=>Ty(e[t]))}function sU(e){return!!(V_(e)||e.variants)}function zwe(e,t){if(V_(e)){const{initial:n,animate:r}=e;return{initial:n===!1||Ty(n)?n:void 0,animate:Ty(r)?r:void 0}}return e.inherit!==!1?t:{}}function Uwe(e){const{initial:t,animate:n}=zwe(e,T.useContext(U_));return T.useMemo(()=>({initial:t,animate:n}),[yD(t),yD(n)])}function yD(e){return Array.isArray(e)?e.join(" "):e}const qwe=Symbol.for("motionComponentSymbol");function hp(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Vwe(e,t,n){return T.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):hp(n)&&(n.current=r))},[t])}const oI=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Hwe="framerAppearId",iU="data-"+oI(Hwe),aU=T.createContext({}),{schedule:lI}=tU(queueMicrotask,!1);function Gwe(e,t,n,r,s){var b,w;const{visualElement:i}=T.useContext(U_),a=T.useContext(nU),o=T.useContext(z_),l=T.useContext(sI).reducedMotion,c=T.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,f=T.useContext(aU);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&Kwe(c.current,n,s,f);const m=T.useRef(!1);T.useInsertionEffect(()=>{u&&m.current&&u.update(n,o)});const g=n[iU],v=T.useRef(!!g&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,g))&&((w=window.MotionHasOptimisedAnimation)==null?void 0:w.call(window,g)));return Q7(()=>{u&&(m.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),lI.render(u.render),v.current&&u.animationState&&u.animationState.animateChanges())}),T.useEffect(()=>{u&&(!v.current&&u.animationState&&u.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)==null||x.call(window,g)}),v.current=!1))}),u}function Kwe(e,t,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:oU(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&hp(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function oU(e){if(e)return e.options.allowProjection!==!1?e.projection:oU(e.parent)}let cI=()=>{};function Wwe({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:s}){e&&Dwe(e);function i(o,l){let c;const u={...T.useContext(sI),...o,layoutId:Zwe(o)},{isStatic:f}=u,m=Uwe(o),g=r(o,f);if(!f&&rI){Ywe();const v=Xwe(u);c=v.MeasureLayout,m.visualElement=Gwe(s,g,u,t,v.ProjectionNode)}return p.jsxs(U_.Provider,{value:m,children:[c&&m.visualElement?p.jsx(c,{visualElement:m.visualElement,...u}):null,n(s,o,Vwe(g,m.visualElement,l),g,f,m.visualElement)]})}i.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const a=T.forwardRef(i);return a[qwe]=s,a}function Zwe({layoutId:e}){const t=T.useContext(tI).id;return t&&e!==void 0?t+"-"+e:e}function Ywe(e,t){T.useContext(nU).strict}function Xwe(e){const{drag:t,layout:n}=Qp;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const lU=e=>t=>typeof t=="string"&&t.startsWith(e),uI=lU("--"),Jwe=lU("var(--"),dI=e=>Jwe(e)?Qwe.test(e.split("/*")[0].trim()):!1,Qwe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Ay={};function exe(e){for(const t in e)Ay[t]=e[t],uI(t)&&(Ay[t].isCSSVariable=!0)}const Rm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Nm=new Set(Rm);function cU(e,{layout:t,layoutId:n}){return Nm.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Ay[e]||e==="opacity")}const Ci=e=>!!(e&&e.getVelocity),uU=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Lc=(e,t,n)=>n>t?t:n<e?e:n,Im={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ry={...Im,transform:e=>Lc(0,1,e)},Cw={...Im,default:1},bD={...Im,transform:Math.round},kb=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Iu=kb("deg"),Tl=kb("%"),kn=kb("px"),txe=kb("vh"),nxe=kb("vw"),vD={...Tl,parse:e=>Tl.parse(e)/100,transform:e=>Tl.transform(e*100)},rxe={rotate:Iu,rotateX:Iu,rotateY:Iu,rotateZ:Iu,scale:Cw,scaleX:Cw,scaleY:Cw,scaleZ:Cw,skew:Iu,skewX:Iu,skewY:Iu,distance:kn,translateX:kn,translateY:kn,translateZ:kn,x:kn,y:kn,z:kn,perspective:kn,transformPerspective:kn,opacity:Ry,originX:vD,originY:vD,originZ:kn},fI={borderWidth:kn,borderTopWidth:kn,borderRightWidth:kn,borderBottomWidth:kn,borderLeftWidth:kn,borderRadius:kn,radius:kn,borderTopLeftRadius:kn,borderTopRightRadius:kn,borderBottomRightRadius:kn,borderBottomLeftRadius:kn,width:kn,maxWidth:kn,height:kn,maxHeight:kn,top:kn,right:kn,bottom:kn,left:kn,padding:kn,paddingTop:kn,paddingRight:kn,paddingBottom:kn,paddingLeft:kn,margin:kn,marginTop:kn,marginRight:kn,marginBottom:kn,marginLeft:kn,backgroundPositionX:kn,backgroundPositionY:kn,...rxe,zIndex:bD,fillOpacity:Ry,strokeOpacity:Ry,numOctaves:bD},sxe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ixe=Rm.length;function axe(e,t,n){let r="",s=!0;for(let i=0;i<ixe;i++){const a=Rm[i],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=uU(o,fI[a]);if(!l){s=!1;const u=sxe[a]||a;r+=`${u}(${c}) `}n&&(t[a]=c)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function hI(e,t,n){const{style:r,vars:s,transformOrigin:i}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(Nm.has(l)){a=!0;continue}else if(uI(l)){s[l]=c;continue}else{const u=uU(c,fI[l]);l.startsWith("origin")?(o=!0,i[l]=u):r[l]=u}}if(t.transform||(a||n?r.transform=axe(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const pI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function dU(e,t,n){for(const r in t)!Ci(t[r])&&!cU(r,n)&&(e[r]=t[r])}function oxe({transformTemplate:e},t){return T.useMemo(()=>{const n=pI();return hI(n,t,e),Object.assign({},n.vars,n.style)},[t])}function lxe(e,t){const n=e.style||{},r={};return dU(r,n,e),Object.assign(r,oxe(e,t)),r}function cxe(e,t){const n={},r=lxe(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const uxe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function mI(e){return typeof e!="string"||e.includes("-")?!1:!!(uxe.indexOf(e)>-1||/[A-Z]/u.test(e))}const dxe={offset:"stroke-dashoffset",array:"stroke-dasharray"},fxe={offset:"strokeDashoffset",array:"strokeDasharray"};function hxe(e,t,n=1,r=0,s=!0){e.pathLength=1;const i=s?dxe:fxe;e[i.offset]=kn.transform(-r);const a=kn.transform(t),o=kn.transform(n);e[i.array]=`${a} ${o}`}function fU(e,{attrX:t,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(hI(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:m}=e;f.transform&&(m.transform=f.transform,delete f.transform),(m.transform||f.transformOrigin)&&(m.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),m.transform&&(m.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete f.transformBox),t!==void 0&&(f.x=t),n!==void 0&&(f.y=n),r!==void 0&&(f.scale=r),s!==void 0&&hxe(f,s,i,a,!1)}const hU=()=>({...pI(),attrs:{}}),pU=e=>typeof e=="string"&&e.toLowerCase()==="svg";function pxe(e,t,n,r){const s=T.useMemo(()=>{const i=hU();return fU(i,t,pU(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};dU(i,e.style,e),s.style={...i,...s.style}}return s}function mxe(e=!1){return(n,r,s,{latestValues:i},a)=>{const l=(mI(n)?pxe:cxe)(r,i,a,n),c=Bwe(r,typeof n=="string",e),u=n!==T.Fragment?{...c,...l,ref:s}:{},{children:f}=r,m=T.useMemo(()=>Ci(f)?f.get():f,[f]);return T.createElement(n,{...u,children:m})}}function wD(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function gI(e,t,n,r){if(typeof t=="function"){const[s,i]=wD(r);t=t(n!==void 0?n:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=wD(r);t=t(n!==void 0?n:e.custom,s,i)}return t}function Jw(e){return Ci(e)?e.get():e}function gxe({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,s){return{latestValues:yxe(n,r,s,e),renderState:t()}}const mU=e=>(t,n)=>{const r=T.useContext(U_),s=T.useContext(z_),i=()=>gxe(e,t,r,s);return n?i():nI(i)};function yxe(e,t,n,r){const s={},i=r(e,{});for(const m in i)s[m]=Jw(i[m]);let{initial:a,animate:o}=e;const l=V_(e),c=sU(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||a===!1;const f=u?o:a;if(f&&typeof f!="boolean"&&!q_(f)){const m=Array.isArray(f)?f:[f];for(let g=0;g<m.length;g++){const v=gI(e,m[g]);if(v){const{transitionEnd:b,transition:w,...x}=v;for(const _ in x){let E=x[_];if(Array.isArray(E)){const C=u?E.length-1:0;E=E[C]}E!==null&&(s[_]=E)}for(const _ in b)s[_]=b[_]}}}return s}function yI(e,t,n){var i;const{style:r}=e,s={};for(const a in r)(Ci(r[a])||t.style&&Ci(t.style[a])||cU(a,e)||((i=n==null?void 0:n.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=r[a]);return s}const bxe={useVisualState:mU({scrapeMotionValuesFromProps:yI,createRenderState:pI})};function gU(e,t,n){const r=yI(e,t,n);for(const s in e)if(Ci(e[s])||Ci(t[s])){const i=Rm.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=e[s]}return r}const vxe={useVisualState:mU({scrapeMotionValuesFromProps:gU,createRenderState:hU})};function wxe(e,t){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...mI(r)?vxe:bxe,preloadedFeatures:e,useRender:mxe(s),createVisualElement:t,Component:r};return Wwe(a)}}function Ny(e,t,n){const r=e.getProps();return gI(r,t,n!==void 0?n:r.custom,e)}const wA=e=>Array.isArray(e);let Qw;function xxe(){Qw=void 0}const ia={now:()=>(Qw===void 0&&ia.set(di.isProcessing||Fc.useManualTiming?di.timestamp:performance.now()),Qw),set:e=>{Qw=e,queueMicrotask(xxe)}};function bI(e,t){e.indexOf(t)===-1&&e.push(t)}function vI(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class wI{constructor(){this.subscriptions=[]}add(t){return bI(this.subscriptions,t),()=>vI(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function yU(e,t){return t?e*(1e3/t):0}const xD=30,_xe=e=>!isNaN(parseFloat(e));class Sxe{constructor(t,n={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{var a,o;const i=ia.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),s&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=ia.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=_xe(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new wI);const r=this.events[t].add(n);return t==="change"?()=>{r(),ls.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ia.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>xD)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,xD);return yU(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Iy(e,t){return new Sxe(e,t)}function Exe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Iy(n))}function Cxe(e){return wA(e)?e[e.length-1]||0:e}function kxe(e,t){const n=Ny(e,t);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const o=Cxe(i[a]);Exe(e,a,o)}}function Txe(e){return!!(Ci(e)&&e.add)}function xA(e,t){const n=e.getValue("willChange");if(Txe(n))return n.add(t);if(!n&&Fc.WillChange){const r=new Fc.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function bU(e){return e.props[iU]}const Axe=e=>e!==null;function Rxe(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(Axe),i=t&&n!=="loop"&&t%2===1?0:s.length-1;return s[i]}const Nxe={type:"spring",stiffness:500,damping:25,restSpeed:10},Ixe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),jxe={type:"keyframes",duration:.8},Mxe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Oxe=(e,{keyframes:t})=>t.length>2?jxe:Nm.has(e)?e.startsWith("scale")?Ixe(t[1]):Nxe:Mxe;function Pxe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function xI(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const Al=e=>e*1e3,Rl=e=>e/1e3,m0=e=>Math.round(e*1e5)/1e5,_I=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Dxe(e){return e==null}const Fxe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,SI=(e,t)=>n=>!!(typeof n=="string"&&Fxe.test(n)&&n.startsWith(e)||t&&!Dxe(n)&&Object.prototype.hasOwnProperty.call(n,t)),vU=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,o]=r.match(_I);return{[e]:parseFloat(s),[t]:parseFloat(i),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Lxe=e=>Lc(0,255,e),jk={...Im,transform:e=>Math.round(Lxe(e))},yf={test:SI("rgb","red"),parse:vU("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+jk.transform(e)+", "+jk.transform(t)+", "+jk.transform(n)+", "+m0(Ry.transform(r))+")"};function Bxe(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const _A={test:SI("#"),parse:Bxe,transform:yf.transform},pp={test:SI("hsl","hue"),parse:vU("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Tl.transform(m0(t))+", "+Tl.transform(m0(n))+", "+m0(Ry.transform(r))+")"},_i={test:e=>yf.test(e)||_A.test(e)||pp.test(e),parse:e=>yf.test(e)?yf.parse(e):pp.test(e)?pp.parse(e):_A.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?yf.transform(e):pp.transform(e)},$xe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function zxe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(_I))==null?void 0:t.length)||0)+(((n=e.match($xe))==null?void 0:n.length)||0)>0}const wU="number",xU="color",Uxe="var",qxe="var(",_D="${}",Vxe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function jy(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const o=t.replace(Vxe,l=>(_i.test(l)?(r.color.push(i),s.push(xU),n.push(_i.parse(l))):l.startsWith(qxe)?(r.var.push(i),s.push(Uxe),n.push(l)):(r.number.push(i),s.push(wU),n.push(parseFloat(l))),++i,_D)).split(_D);return{values:n,split:o,indexes:r,types:s}}function _U(e){return jy(e).values}function SU(e){const{split:t,types:n}=jy(e),r=t.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],s[a]!==void 0){const o=n[a];o===wU?i+=m0(s[a]):o===xU?i+=_i.transform(s[a]):i+=s[a]}return i}}const Hxe=e=>typeof e=="number"?0:e;function Gxe(e){const t=_U(e);return SU(e)(t.map(Hxe))}const od={test:zxe,parse:_U,createTransformer:SU,getAnimatableNone:Gxe};function Mk(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function Kxe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,i=0,a=0;if(!t)s=i=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;s=Mk(l,o,e+1/3),i=Mk(l,o,e),a=Mk(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function y1(e,t){return n=>n>0?t:e}const as=(e,t,n)=>e+(t-e)*n,Ok=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},Wxe=[_A,yf,pp],Zxe=e=>Wxe.find(t=>t.test(e));function SD(e){const t=Zxe(e);if(!t)return!1;let n=t.parse(e);return t===pp&&(n=Kxe(n)),n}const ED=(e,t)=>{const n=SD(e),r=SD(t);if(!n||!r)return y1(e,t);const s={...n};return i=>(s.red=Ok(n.red,r.red,i),s.green=Ok(n.green,r.green,i),s.blue=Ok(n.blue,r.blue,i),s.alpha=as(n.alpha,r.alpha,i),yf.transform(s))},SA=new Set(["none","hidden"]);function Yxe(e,t){return SA.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}const Xxe=(e,t)=>n=>t(e(n)),Tb=(...e)=>e.reduce(Xxe);function Jxe(e,t){return n=>as(e,t,n)}function EI(e){return typeof e=="number"?Jxe:typeof e=="string"?dI(e)?y1:_i.test(e)?ED:t1e:Array.isArray(e)?EU:typeof e=="object"?_i.test(e)?ED:Qxe:y1}function EU(e,t){const n=[...e],r=n.length,s=e.map((i,a)=>EI(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function Qxe(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=EI(e[s])(e[s],t[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function e1e(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],a=e.indexes[i][r[i]],o=e.values[a]??0;n[s]=o,r[i]++}return n}const t1e=(e,t)=>{const n=od.createTransformer(t),r=jy(e),s=jy(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?SA.has(e)&&!s.values.length||SA.has(t)&&!r.values.length?Yxe(e,t):Tb(EU(e1e(r,s),s.values),n):y1(e,t)};function CU(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?as(e,t,n):EI(e)(e,t)}const n1e=e=>{const t=({timestamp:n})=>e(n);return{start:()=>ls.update(t,!0),stop:()=>ad(t),now:()=>di.isProcessing?di.timestamp:ia.now()}},kU=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let i=0;i<s;i++)r+=e(i/(s-1))+", ";return`linear(${r.substring(0,r.length-2)})`},b1=2e4;function CI(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<b1;)t+=n,r=e.next(t);return t>=b1?1/0:t}function r1e(e,t=100,n){const r=n({...e,keyframes:[0,t]}),s=Math.min(CI(r),b1);return{type:"keyframes",ease:i=>r.next(s*i).value/t,duration:Rl(s)}}const s1e=5;function TU(e,t,n){const r=Math.max(t-s1e,0);return yU(n-e(r),t-r)}const ds={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},CD=.001;function i1e({duration:e=ds.duration,bounce:t=ds.bounce,velocity:n=ds.velocity,mass:r=ds.mass}){let s,i,a=1-t;a=Lc(ds.minDamping,ds.maxDamping,a),e=Lc(ds.minDuration,ds.maxDuration,Rl(e)),a<1?(s=c=>{const u=c*a,f=u*e,m=u-n,g=EA(c,a),v=Math.exp(-f);return CD-m/g*v},i=c=>{const f=c*a*e,m=f*n+n,g=Math.pow(a,2)*Math.pow(c,2)*e,v=Math.exp(-f),b=EA(Math.pow(c,2),a);return(-s(c)+CD>0?-1:1)*((m-g)*v)/b}):(s=c=>{const u=Math.exp(-c*e),f=(c-n)*e+1;return-.001+u*f},i=c=>{const u=Math.exp(-c*e),f=(n-c)*(e*e);return u*f});const o=5/e,l=o1e(s,i,o);if(e=Al(e),isNaN(l))return{stiffness:ds.stiffness,damping:ds.damping,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:e}}}const a1e=12;function o1e(e,t,n){let r=n;for(let s=1;s<a1e;s++)r=r-e(r)/t(r);return r}function EA(e,t){return e*Math.sqrt(1-t*t)}const l1e=["duration","bounce"],c1e=["stiffness","damping","mass"];function kD(e,t){return t.some(n=>e[n]!==void 0)}function u1e(e){let t={velocity:ds.velocity,stiffness:ds.stiffness,damping:ds.damping,mass:ds.mass,isResolvedFromDuration:!1,...e};if(!kD(e,c1e)&&kD(e,l1e))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*Lc(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:ds.mass,stiffness:s,damping:i}}else{const n=i1e(e);t={...t,...n,mass:ds.mass},t.isResolvedFromDuration=!0}return t}function v1(e=ds.visualDuration,t=ds.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:f,velocity:m,isResolvedFromDuration:g}=u1e({...n,velocity:-Rl(n.velocity||0)}),v=m||0,b=c/(2*Math.sqrt(l*u)),w=a-i,x=Rl(Math.sqrt(l/u)),_=Math.abs(w)<5;r||(r=_?ds.restSpeed.granular:ds.restSpeed.default),s||(s=_?ds.restDelta.granular:ds.restDelta.default);let E;if(b<1){const k=EA(x,b);E=R=>{const I=Math.exp(-b*x*R);return a-I*((v+b*x*w)/k*Math.sin(k*R)+w*Math.cos(k*R))}}else if(b===1)E=k=>a-Math.exp(-x*k)*(w+(v+x*w)*k);else{const k=x*Math.sqrt(b*b-1);E=R=>{const I=Math.exp(-b*x*R),j=Math.min(k*R,300);return a-I*((v+b*x*w)*Math.sinh(j)+k*w*Math.cosh(j))/k}}const C={calculatedDuration:g&&f||null,next:k=>{const R=E(k);if(g)o.done=k>=f;else{let I=k===0?v:0;b<1&&(I=k===0?Al(v):TU(E,k,R));const j=Math.abs(I)<=r,M=Math.abs(a-R)<=s;o.done=j&&M}return o.value=o.done?a:R,o},toString:()=>{const k=Math.min(CI(C),b1),R=kU(I=>C.next(k*I).value,k,30);return k+"ms "+R},toTransition:()=>{}};return C}v1.applyToOptions=e=>{const t=r1e(e,100,v1);return e.ease=t.ease,e.duration=Al(t.duration),e.type="keyframes",e};function CA({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const f=e[0],m={done:!1,value:f},g=j=>o!==void 0&&j<o||l!==void 0&&j>l,v=j=>o===void 0?l:l===void 0||Math.abs(o-j)<Math.abs(l-j)?o:l;let b=n*t;const w=f+b,x=a===void 0?w:a(w);x!==w&&(b=x-f);const _=j=>-b*Math.exp(-j/r),E=j=>x+_(j),C=j=>{const M=_(j),L=E(j);m.done=Math.abs(M)<=c,m.value=m.done?x:L};let k,R;const I=j=>{g(m.value)&&(k=j,R=v1({keyframes:[m.value,v(m.value)],velocity:TU(E,j,m.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return I(0),{calculatedDuration:null,next:j=>{let M=!1;return!R&&k===void 0&&(M=!0,C(j),I(j)),k!==void 0&&j>=k?R.next(j-k):(!M&&C(j),m)}}}const My=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};function d1e(e,t,n){const r=[],s=n||Fc.mix||CU,i=e.length-1;for(let a=0;a<i;a++){let o=s(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||io:t;o=Tb(l,o)}r.push(o)}return r}function f1e(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const i=e.length;if(cI(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=d1e(t,r,s),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let f=0;if(l>1)for(;f<e.length-2&&!(u<e[f+1]);f++);const m=My(e[f],e[f+1],u);return o[f](m)};return n?u=>c(Lc(e[0],e[i-1],u)):c}function h1e(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=My(0,t,r);e.push(as(n,1,s))}}function p1e(e){const t=[0];return h1e(t,e.length-1),t}function m1e(e,t){return e.map(n=>n*t)}const AU=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,g1e=1e-7,y1e=12;function b1e(e,t,n,r,s){let i,a,o=0;do a=t+(n-t)/2,i=AU(a,r,s)-e,i>0?n=a:t=a;while(Math.abs(i)>g1e&&++o<y1e);return a}function Ab(e,t,n,r){if(e===t&&n===r)return io;const s=i=>b1e(i,0,1,e,n);return i=>i===0||i===1?i:AU(s(i),t,r)}const v1e=Ab(.42,0,1,1),w1e=Ab(0,0,.58,1),RU=Ab(.42,0,.58,1),x1e=e=>Array.isArray(e)&&typeof e[0]!="number",NU=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,IU=e=>t=>1-e(1-t),jU=Ab(.33,1.53,.69,.99),kI=IU(jU),MU=NU(kI),OU=e=>(e*=2)<1?.5*kI(e):.5*(2-Math.pow(2,-10*(e-1))),TI=e=>1-Math.sin(Math.acos(e)),PU=IU(TI),DU=NU(TI),FU=e=>Array.isArray(e)&&typeof e[0]=="number",_1e={linear:io,easeIn:v1e,easeInOut:RU,easeOut:w1e,circIn:TI,circInOut:DU,circOut:PU,backIn:kI,backInOut:MU,backOut:jU,anticipate:OU},S1e=e=>typeof e=="string",TD=e=>{if(FU(e)){cI(e.length===4);const[t,n,r,s]=e;return Ab(t,n,r,s)}else if(S1e(e))return _1e[e];return e};function E1e(e,t){return e.map(()=>t||RU).splice(0,e.length-1)}function g0({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=x1e(r)?r.map(TD):TD(r),i={done:!1,value:t[0]},a=m1e(n&&n.length===t.length?n:p1e(t),e),o=f1e(a,t,{ease:Array.isArray(s)?s:E1e(t,s)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}const C1e=e=>e!==null;function AI(e,{repeat:t,repeatType:n="loop"},r,s=1){const i=e.filter(C1e),o=s<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const k1e={decay:CA,inertia:CA,tween:g0,keyframes:g0,spring:v1};function LU(e){typeof e.type=="string"&&(e.type=k1e[e.type])}class RI{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const T1e=e=>e/100;class BU extends RI{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;if(n&&n.updatedAt!==ia.now()&&this.tick(ia.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:r}=this.options;r&&r()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;LU(t);const{type:n=g0,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=t;let{keyframes:o}=t;const l=n||g0;l!==g0&&typeof o[0]!="number"&&(this.mixKeyframes=Tb(T1e,CU(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=CI(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:f,repeatType:m,repeatDelay:g,type:v,onUpdate:b,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-c*(this.playbackSpeed>=0?1:-1),_=this.playbackSpeed>=0?x<0:x>s;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let E=this.currentTime,C=r;if(f){const j=Math.min(this.currentTime,s)/o;let M=Math.floor(j),L=j%1;!L&&j>=1&&(L=1),L===1&&M--,M=Math.min(M,f+1),!!(M%2)&&(m==="reverse"?(L=1-L,g&&(L-=g/o)):m==="mirror"&&(C=a)),E=Lc(0,1,L)*o}const k=_?{done:!1,value:u[0]}:C.next(E);i&&(k.value=i(k.value));let{done:R}=k;!_&&l!==null&&(R=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&R);return I&&v!==CA&&(k.value=AI(u,this.options,w,this.speed)),b&&b(k.value),I&&this.finish(),k}then(t,n){return this.finished.then(t,n)}get duration(){return Rl(this.calculatedDuration)}get time(){return Rl(this.currentTime)}set time(t){t=Al(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(ia.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Rl(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=n1e,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ia.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function A1e(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const bf=e=>e*180/Math.PI,kA=e=>{const t=bf(Math.atan2(e[1],e[0]));return TA(t)},R1e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:kA,rotateZ:kA,skewX:e=>bf(Math.atan(e[1])),skewY:e=>bf(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},TA=e=>(e=e%360,e<0&&(e+=360),e),AD=kA,RD=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),ND=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),N1e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:RD,scaleY:ND,scale:e=>(RD(e)+ND(e))/2,rotateX:e=>TA(bf(Math.atan2(e[6],e[5]))),rotateY:e=>TA(bf(Math.atan2(-e[2],e[0]))),rotateZ:AD,rotate:AD,skewX:e=>bf(Math.atan(e[4])),skewY:e=>bf(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function ID(e){return e.includes("scale")?1:0}function AA(e,t){if(!e||e==="none")return ID(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=N1e,s=n;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=R1e,s=o}if(!s)return ID(t);const i=r[t],a=s[1].split(",").map(j1e);return typeof i=="function"?i(a):a[i]}const I1e=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return AA(n,t)};function j1e(e){return parseFloat(e.trim())}const jD=e=>e===Im||e===kn,M1e=new Set(["x","y","z"]),O1e=Rm.filter(e=>!M1e.has(e));function P1e(e){const t=[];return O1e.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const _f={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>AA(t,"x"),y:(e,{transform:t})=>AA(t,"y")};_f.translateX=_f.x;_f.translateY=_f.y;const Sf=new Set;let RA=!1,NA=!1,IA=!1;function $U(){if(NA){const e=Array.from(Sf).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=P1e(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{var o;(o=r.getValue(i))==null||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}NA=!1,RA=!1,Sf.forEach(e=>e.complete(IA)),Sf.clear()}function zU(){Sf.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(NA=!0)})}function D1e(){IA=!0,zU(),$U(),IA=!1}class NI{constructor(t,n,r,s,i,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Sf.add(this),RA||(RA=!0,ls.read(zU),ls.resolveKeyframes($U))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const o=r.readValue(n,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),s&&i===void 0&&s.set(t[0])}A1e(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Sf.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Sf.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const F1e=e=>e.startsWith("--");function L1e(e,t,n){F1e(t)?e.style.setProperty(t,n):e.style[t]=n}function II(e){let t;return()=>(t===void 0&&(t=e()),t)}const B1e=II(()=>window.ScrollTimeline!==void 0),$1e={};function z1e(e,t){const n=II(e);return()=>$1e[t]??n()}const UU=z1e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),s0=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,MD={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:s0([0,.65,.55,1]),circOut:s0([.55,0,1,.45]),backIn:s0([.31,.01,.66,-.59]),backOut:s0([.33,1.53,.69,.99])};function qU(e,t){if(e)return typeof e=="function"?UU()?kU(e,t):"ease-out":FU(e)?s0(e):Array.isArray(e)?e.map(n=>qU(n,t)||MD.easeOut):MD[e]}function U1e(e,t,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:n};l&&(u.offset=l);const f=qU(o,s);Array.isArray(f)&&(u.easing=f);const m={delay:r,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(m.pseudoElement=c),e.animate(u,m)}function VU(e){return typeof e=="function"&&"applyToOptions"in e}function q1e({type:e,...t}){return VU(e)&&UU()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class V1e extends RI{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,cI(typeof t.type!="string");const c=q1e(t);this.animation=U1e(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=AI(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):L1e(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Rl(Number(t))}get time(){return Rl(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Al(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&B1e()?(this.animation.timeline=t,io):n(this)}}const HU={anticipate:OU,backInOut:MU,circInOut:DU};function H1e(e){return e in HU}function G1e(e){typeof e.ease=="string"&&H1e(e.ease)&&(e.ease=HU[e.ease])}const OD=10;class K1e extends V1e{constructor(t){G1e(t),LU(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const o=new BU({...a,autoplay:!1}),l=Al(this.finishedTime??this.time);n.setWithVelocity(o.sample(l-OD).value,o.sample(l).value,OD),o.stop()}}const PD=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(od.test(e)||e==="0")&&!e.startsWith("url("));function W1e(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function Z1e(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=PD(s,t),o=PD(i,t);return!a||!o?!1:W1e(e)||(n==="spring"||VU(n))&&r}const Y1e=new Set(["opacity","clipPath","filter","transform"]),X1e=II(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function J1e(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:s,damping:i,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return X1e()&&n&&Y1e.has(n)&&(n!=="transform"||!l)&&!o&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const Q1e=40;class e_e extends RI{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...f}){var v;super(),this.stop=()=>{var b,w;this._animation?(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)):(w=this.keyframeResolver)==null||w.cancel()},this.createdAt=ia.now();const m={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...f},g=(u==null?void 0:u.KeyframeResolver)||NI;this.keyframeResolver=new g(o,(b,w,x)=>this.onKeyframesResolved(b,w,m,!x),l,c,u),(v=this.keyframeResolver)==null||v.scheduleResolve()}onKeyframesResolved(t,n,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=ia.now(),Z1e(t,i,a,o)||((Fc.instantAnimations||!l)&&(u==null||u(AI(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const m={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>Q1e?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},g=!c&&J1e(m)?new K1e({...m,element:m.motionValue.owner.current}):new BU(m);g.finished.then(()=>this.notifyFinished()).catch(io),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||D1e(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const jI=(e,t,n,r={},s,i)=>a=>{const o=xI(r,e)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Al(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:m=>{t.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:s};Pxe(o)||Object.assign(u,Oxe(e,u)),u.duration&&(u.duration=Al(u.duration)),u.repeatDelay&&(u.repeatDelay=Al(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let f=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(f=!0)),(Fc.instantAnimations||Fc.skipAnimations)&&(f=!0,u.duration=0,u.delay=0),u.allowFlatten=!o.type&&!o.ease,f&&!i&&t.get()!==void 0){const m=Rxe(u.keyframes,o);if(m!==void 0){ls.update(()=>{u.onUpdate(m),u.onComplete()});return}}return new e_e(u)},GU=new Set(["width","height","top","left","right","bottom",...Rm]);function t_e({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function KU(e,t,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(i=r);const l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(const u in o){const f=e.getValue(u,e.latestValues[u]??null),m=o[u];if(m===void 0||c&&t_e(c,u))continue;const g={delay:n,...xI(i||{},u)},v=f.get();if(v!==void 0&&!f.isAnimating&&!Array.isArray(m)&&m===v&&!g.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const x=bU(e);if(x){const _=window.MotionHandoffAnimation(x,u,ls);_!==null&&(g.startTime=_,b=!0)}}xA(e,u),f.start(jI(u,f,m,e.shouldReduceMotion&&GU.has(u)?{type:!1}:g,e,b));const w=f.animation;w&&l.push(w)}return a&&Promise.all(l).then(()=>{ls.update(()=>{a&&kxe(e,a)})}),l}function jA(e,t,n={}){var l;const r=Ny(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(KU(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:f,staggerDirection:m}=s;return n_e(e,t,u+c,f,m,n)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(n.delay)])}function n_e(e,t,n=0,r=0,s=1,i){const a=[],o=(e.variantChildren.size-1)*r,l=s===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(r_e).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(jA(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function r_e(e,t){return e.sortNodePosition(t)}function s_e(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(i=>jA(e,i,n));r=Promise.all(s)}else if(typeof t=="string")r=jA(e,t,n);else{const s=typeof t=="function"?Ny(e,t,n.custom):t;r=Promise.all(KU(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function WU(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const i_e=aI.length;function ZU(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?ZU(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<i_e;n++){const r=aI[n],s=e.props[r];(Ty(s)||s===!1)&&(t[r]=s)}return t}const a_e=[...iI].reverse(),o_e=iI.length;function l_e(e){return t=>Promise.all(t.map(({animation:n,options:r})=>s_e(e,n,r)))}function c_e(e){let t=l_e(e),n=DD(),r=!0;const s=l=>(c,u)=>{var m;const f=Ny(e,u,l==="exit"?(m=e.presenceContext)==null?void 0:m.custom:void 0);if(f){const{transition:g,transitionEnd:v,...b}=f;c={...c,...b,...v}}return c};function i(l){t=l(e)}function a(l){const{props:c}=e,u=ZU(e.parent)||{},f=[],m=new Set;let g={},v=1/0;for(let w=0;w<o_e;w++){const x=a_e[w],_=n[x],E=c[x]!==void 0?c[x]:u[x],C=Ty(E),k=x===l?_.isActive:null;k===!1&&(v=w);let R=E===u[x]&&E!==c[x]&&C;if(R&&r&&e.manuallyAnimateOnMount&&(R=!1),_.protectedKeys={...g},!_.isActive&&k===null||!E&&!_.prevProp||q_(E)||typeof E=="boolean")continue;const I=u_e(_.prevProp,E);let j=I||x===l&&_.isActive&&!R&&C||w>v&&C,M=!1;const L=Array.isArray(E)?E:[E];let q=L.reduce(s(x),{});k===!1&&(q={});const{prevResolvedValues:P={}}=_,V={...P,...q},z=ee=>{j=!0,m.has(ee)&&(M=!0,m.delete(ee)),_.needsAnimating[ee]=!0;const W=e.getValue(ee);W&&(W.liveStyle=!1)};for(const ee in V){const W=q[ee],se=P[ee];if(g.hasOwnProperty(ee))continue;let Y=!1;wA(W)&&wA(se)?Y=!WU(W,se):Y=W!==se,Y?W!=null?z(ee):m.add(ee):W!==void 0&&m.has(ee)?z(ee):_.protectedKeys[ee]=!0}_.prevProp=E,_.prevResolvedValues=q,_.isActive&&(g={...g,...q}),r&&e.blockInitialAnimation&&(j=!1),j&&(!(R&&I)||M)&&f.push(...L.map(ee=>({animation:ee,options:{type:x}})))}if(m.size){const w={};if(typeof c.initial!="boolean"){const x=Ny(e,Array.isArray(c.initial)?c.initial[0]:c.initial);x&&x.transition&&(w.transition=x.transition)}m.forEach(x=>{const _=e.getBaseTarget(x),E=e.getValue(x);E&&(E.liveStyle=!0),w[x]=_??null}),f.push({animation:w})}let b=!!f.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(b=!1),r=!1,b?t(f):Promise.resolve()}function o(l,c){var f;if(n[l].isActive===c)return Promise.resolve();(f=e.variantChildren)==null||f.forEach(m=>{var g;return(g=m.animationState)==null?void 0:g.setActive(l,c)}),n[l].isActive=c;const u=a(l);for(const m in n)n[m].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>n,reset:()=>{n=DD(),r=!0}}}function u_e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!WU(t,e):!1}function af(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function DD(){return{animate:af(!0),whileInView:af(),whileHover:af(),whileTap:af(),whileDrag:af(),whileFocus:af(),exit:af()}}class Ed{constructor(t){this.isMounted=!1,this.node=t}update(){}}class d_e extends Ed{constructor(t){super(t),t.animationState||(t.animationState=c_e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();q_(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let f_e=0;class h_e extends Ed{constructor(){super(...arguments),this.id=f_e++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const p_e={animation:{Feature:d_e},exit:{Feature:h_e}};function Oy(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const MI=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function Rb(e){return{point:{x:e.pageX,y:e.pageY}}}const m_e=e=>t=>MI(t)&&e(t,Rb(t));function y0(e,t,n,r){return Oy(e,t,m_e(n),r)}function YU({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function g_e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function y_e(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const XU=1e-4,b_e=1-XU,v_e=1+XU,JU=.01,w_e=0-JU,x_e=0+JU;function $i(e){return e.max-e.min}function __e(e,t,n){return Math.abs(e-t)<=n}function FD(e,t,n,r=.5){e.origin=r,e.originPoint=as(t.min,t.max,e.origin),e.scale=$i(n)/$i(t),e.translate=as(n.min,n.max,e.origin)-e.originPoint,(e.scale>=b_e&&e.scale<=v_e||isNaN(e.scale))&&(e.scale=1),(e.translate>=w_e&&e.translate<=x_e||isNaN(e.translate))&&(e.translate=0)}function b0(e,t,n,r){FD(e.x,t.x,n.x,r?r.originX:void 0),FD(e.y,t.y,n.y,r?r.originY:void 0)}function LD(e,t,n){e.min=n.min+t.min,e.max=e.min+$i(t)}function S_e(e,t,n){LD(e.x,t.x,n.x),LD(e.y,t.y,n.y)}function BD(e,t,n){e.min=t.min-n.min,e.max=e.min+$i(t)}function v0(e,t,n){BD(e.x,t.x,n.x),BD(e.y,t.y,n.y)}const $D=()=>({translate:0,scale:1,origin:0,originPoint:0}),mp=()=>({x:$D(),y:$D()}),zD=()=>({min:0,max:0}),ys=()=>({x:zD(),y:zD()});function Ya(e){return[e("x"),e("y")]}function Pk(e){return e===void 0||e===1}function MA({scale:e,scaleX:t,scaleY:n}){return!Pk(e)||!Pk(t)||!Pk(n)}function lf(e){return MA(e)||QU(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function QU(e){return UD(e.x)||UD(e.y)}function UD(e){return e&&e!=="0%"}function w1(e,t,n){const r=e-n,s=t*r;return n+s}function qD(e,t,n,r,s){return s!==void 0&&(e=w1(e,s,r)),w1(e,n,r)+t}function OA(e,t=0,n=1,r,s){e.min=qD(e.min,t,n,r,s),e.max=qD(e.max,t,n,r,s)}function eq(e,{x:t,y:n}){OA(e.x,t.translate,t.scale,t.originPoint),OA(e.y,n.translate,n.scale,n.originPoint)}const VD=.999999999999,HD=1.0000000000001;function E_e(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let i,a;for(let o=0;o<s;o++){i=n[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&yp(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,eq(e,a)),r&&lf(i.latestValues)&&yp(e,i.latestValues))}t.x<HD&&t.x>VD&&(t.x=1),t.y<HD&&t.y>VD&&(t.y=1)}function gp(e,t){e.min=e.min+t,e.max=e.max+t}function GD(e,t,n,r,s=.5){const i=as(e.min,e.max,s);OA(e,t,n,i,r)}function yp(e,t){GD(e.x,t.x,t.scaleX,t.scale,t.originX),GD(e.y,t.y,t.scaleY,t.scale,t.originY)}function tq(e,t){return YU(y_e(e.getBoundingClientRect(),t))}function C_e(e,t,n){const r=tq(e,n),{scroll:s}=t;return s&&(gp(r.x,s.offset.x),gp(r.y,s.offset.y)),r}const nq=({current:e})=>e?e.ownerDocument.defaultView:null,KD=(e,t)=>Math.abs(e-t);function k_e(e,t){const n=KD(e.x,t.x),r=KD(e.y,t.y);return Math.sqrt(n**2+r**2)}class rq{constructor(t,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=Fk(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,g=k_e(f.offset,{x:0,y:0})>=3;if(!m&&!g)return;const{point:v}=f,{timestamp:b}=di;this.history.push({...v,timestamp:b});const{onStart:w,onMove:x}=this.handlers;m||(w&&w(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=Dk(m,this.transformPagePoint),ls.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:g,onSessionEnd:v,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=Fk(f.type==="pointercancel"?this.lastMoveEventInfo:Dk(m,this.transformPagePoint),this.history);this.startEvent&&g&&g(f,w),v&&v(f,w)},!MI(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=Rb(t),o=Dk(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=di;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,Fk(o,this.history)),this.removeListeners=Tb(y0(this.contextWindow,"pointermove",this.handlePointerMove),y0(this.contextWindow,"pointerup",this.handlePointerUp),y0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),ad(this.updatePoint)}}function Dk(e,t){return t?{point:t(e.point)}:e}function WD(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Fk({point:e},t){return{point:e,delta:WD(e,sq(t)),offset:WD(e,T_e(t)),velocity:A_e(t,.1)}}function T_e(e){return e[0]}function sq(e){return e[e.length-1]}function A_e(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=sq(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>Al(t)));)n--;if(!r)return{x:0,y:0};const i=Rl(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function R_e(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?as(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?as(n,e,r.max):Math.min(e,n)),e}function ZD(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function N_e(e,{top:t,left:n,bottom:r,right:s}){return{x:ZD(e.x,n,s),y:ZD(e.y,t,r)}}function YD(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function I_e(e,t){return{x:YD(e.x,t.x),y:YD(e.y,t.y)}}function j_e(e,t){let n=.5;const r=$i(e),s=$i(t);return s>r?n=My(t.min,t.max-r,e.min):r>s&&(n=My(e.min,e.max-s,t.min)),Lc(0,1,n)}function M_e(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const PA=.35;function O_e(e=PA){return e===!1?e=0:e===!0&&(e=PA),{x:XD(e,"left","right"),y:XD(e,"top","bottom")}}function XD(e,t,n){return{min:JD(e,t),max:JD(e,n)}}function JD(e,t){return typeof e=="number"?e:e[t]||0}const So={x:!1,y:!1};function iq(){return So.x||So.y}function P_e(e){return e==="x"||e==="y"?So[e]?null:(So[e]=!0,()=>{So[e]=!1}):So.x||So.y?null:(So.x=So.y=!0,()=>{So.x=So.y=!1})}const D_e=new WeakMap;class F_e{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ys(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Rb(u).point)},i=(u,f)=>{const{drag:m,dragPropagation:g,onDragStart:v}=this.getProps();if(m&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=P_e(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ya(w=>{let x=this.getAxisMotionValue(w).get()||0;if(Tl.test(x)){const{projection:_}=this.visualElement;if(_&&_.layout){const E=_.layout.layoutBox[w];E&&(x=$i(E)*(parseFloat(x)/100))}}this.originPoint[w]=x}),v&&ls.postRender(()=>v(u,f)),xA(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,f)=>{const{dragPropagation:m,dragDirectionLock:g,onDirectionLock:v,onDrag:b}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=f;if(g&&this.currentDirection===null){this.currentDirection=L_e(w),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,w),this.updateAxis("y",f.point,w),this.visualElement.render(),b&&b(u,f)},o=(u,f)=>this.stop(u,f),l=()=>Ya(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)==null?void 0:f.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new rq(t,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:nq(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&ls.postRender(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!kw(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=R_e(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&hp(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=N_e(r.layoutBox,t):this.constraints=!1,this.elastic=O_e(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ya(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=M_e(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!hp(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=C_e(r,s.root,this.visualElement.getTransformPagePoint());let a=I_e(s.layout.layoutBox,i);if(n){const o=n(g_e(a));this.hasMutatedConstraints=!!o,o&&(a=YU(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ya(u=>{if(!kw(u,n,this.currentDirection))return;let f=l&&l[u]||{};a&&(f={min:0,max:0});const m=s?200:1e6,g=s?40:1e7,v={type:"inertia",velocity:r?t[u]:0,bounceStiffness:m,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(u,v)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return xA(this.visualElement,t),r.start(jI(t,r,0,n,this.visualElement,!1))}stopAnimation(){Ya(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ya(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Ya(n=>{const{drag:r}=this.getProps();if(!kw(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[n];i.set(t[n]-as(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!hp(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Ya(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=j_e({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ya(a=>{if(!kw(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(as(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;D_e.set(this.visualElement,this);const t=this.visualElement.current,n=y0(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();hp(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ls.read(r);const a=Oy(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ya(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=l[u].translate,f.set(f.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=PA,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function kw(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function L_e(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class B_e extends Ed{constructor(t){super(t),this.removeGroupControls=io,this.removeListeners=io,this.controls=new F_e(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||io}unmount(){this.removeGroupControls(),this.removeListeners()}}const QD=e=>(t,n)=>{e&&ls.postRender(()=>e(t,n))};class $_e extends Ed{constructor(){super(...arguments),this.removePointerDownListener=io}onPointerDown(t){this.session=new rq(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:nq(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:QD(t),onStart:QD(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&ls.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=y0(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ex={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function e5(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Jg={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(kn.test(e))e=parseFloat(e);else return e;const n=e5(e,t.target.x),r=e5(e,t.target.y);return`${n}% ${r}%`}},z_e={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=od.parse(e);if(s.length>5)return r;const i=od.createTransformer(e),a=typeof s[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;s[0+a]/=o,s[1+a]/=l;const c=as(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};class U_e extends T.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=t;exe(q_e),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),ex.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,s||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ls.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),lI.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function aq(e){const[t,n]=eU(),r=T.useContext(tI);return p.jsx(U_e,{...e,layoutGroup:r,switchLayoutGroup:T.useContext(aU),isPresent:t,safeToRemove:n})}const q_e={borderRadius:{...Jg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Jg,borderTopRightRadius:Jg,borderBottomLeftRadius:Jg,borderBottomRightRadius:Jg,boxShadow:z_e};function V_e(e,t,n){const r=Ci(e)?e:Iy(e);return r.start(jI("",r,t,n)),r.animation}function H_e(e){return e instanceof SVGElement&&e.tagName!=="svg"}const G_e=(e,t)=>e.depth-t.depth;class K_e{constructor(){this.children=[],this.isDirty=!1}add(t){bI(this.children,t),this.isDirty=!0}remove(t){vI(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(G_e),this.isDirty=!1,this.children.forEach(t)}}function W_e(e,t){const n=ia.now(),r=({timestamp:s})=>{const i=s-n;i>=t&&(ad(r),e(i-t))};return ls.setup(r,!0),()=>ad(r)}const oq=["TopLeft","TopRight","BottomLeft","BottomRight"],Z_e=oq.length,t5=e=>typeof e=="string"?parseFloat(e):e,n5=e=>typeof e=="number"||kn.test(e);function Y_e(e,t,n,r,s,i){s?(e.opacity=as(0,n.opacity??1,X_e(r)),e.opacityExit=as(t.opacity??1,0,J_e(r))):i&&(e.opacity=as(t.opacity??1,n.opacity??1,r));for(let a=0;a<Z_e;a++){const o=`border${oq[a]}Radius`;let l=r5(t,o),c=r5(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||n5(l)===n5(c)?(e[o]=Math.max(as(t5(l),t5(c),r),0),(Tl.test(c)||Tl.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=as(t.rotate||0,n.rotate||0,r))}function r5(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const X_e=lq(0,.5,PU),J_e=lq(.5,.95,io);function lq(e,t,n){return r=>r<e?0:r>t?1:n(My(e,t,r))}function s5(e,t){e.min=t.min,e.max=t.max}function Wa(e,t){s5(e.x,t.x),s5(e.y,t.y)}function i5(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function a5(e,t,n,r,s){return e-=t,e=w1(e,1/n,r),s!==void 0&&(e=w1(e,1/s,r)),e}function Q_e(e,t=0,n=1,r=.5,s,i=e,a=e){if(Tl.test(t)&&(t=parseFloat(t),t=as(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=as(i.min,i.max,r);e===i&&(o-=t),e.min=a5(e.min,t,n,o,s),e.max=a5(e.max,t,n,o,s)}function o5(e,t,[n,r,s],i,a){Q_e(e,t[n],t[r],t[s],t.scale,i,a)}const eSe=["x","scaleX","originX"],tSe=["y","scaleY","originY"];function l5(e,t,n,r){o5(e.x,t,eSe,n?n.x:void 0,r?r.x:void 0),o5(e.y,t,tSe,n?n.y:void 0,r?r.y:void 0)}function c5(e){return e.translate===0&&e.scale===1}function cq(e){return c5(e.x)&&c5(e.y)}function u5(e,t){return e.min===t.min&&e.max===t.max}function nSe(e,t){return u5(e.x,t.x)&&u5(e.y,t.y)}function d5(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function uq(e,t){return d5(e.x,t.x)&&d5(e.y,t.y)}function f5(e){return $i(e.x)/$i(e.y)}function h5(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class rSe{constructor(){this.members=[]}add(t){bI(this.members,t),t.scheduleRender()}remove(t){if(vI(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function sSe(e,t,n){let r="";const s=e.x.translate/t.x,i=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:f,rotateY:m,skewX:g,skewY:v}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),f&&(r+=`rotateX(${f}deg) `),m&&(r+=`rotateY(${m}deg) `),g&&(r+=`skewX(${g}deg) `),v&&(r+=`skewY(${v}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const Lk=["","X","Y","Z"],iSe={visibility:"hidden"},p5=1e3;let aSe=0;function Bk(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function dq(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=bU(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",ls,!(s||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&dq(r)}function fq({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},o=t==null?void 0:t()){this.id=aSe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(cSe),this.nodes.forEach(pSe),this.nodes.forEach(mSe),this.nodes.forEach(uSe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new K_e)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new wI),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=H_e(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u;const f=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=W_e(f,250),ex.hasAnimatedSinceResize&&(ex.hasAnimatedSinceResize=!1,this.nodes.forEach(g5))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:f,hasRelativeLayoutChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||c.getDefaultTransition()||wSe,{onLayoutAnimationStart:b,onLayoutAnimationComplete:w}=c.getProps(),x=!this.targetLayout||!uq(this.targetLayout,g),_=!f&&m;if(this.options.layoutRoot||this.resumeFrom||_||f&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,_);const E={...xI(v,"layout"),onPlay:b,onComplete:w};(c.shouldReduceMotion||this.options.layoutRoot)&&(E.delay=0,E.type=!1),this.startAnimation(E)}else f||g5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ad(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(gSe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&dq(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(m5);return}this.isUpdating||this.nodes.forEach(fSe),this.isUpdating=!1,this.nodes.forEach(hSe),this.nodes.forEach(oSe),this.nodes.forEach(lSe),this.clearAllSnapshots();const o=ia.now();di.delta=Lc(0,1e3/60,o-di.timestamp),di.timestamp=o,di.isProcessing=!0,Ik.update.process(di),Ik.preRender.process(di),Ik.render.process(di),di.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,lI.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(dSe),this.sharedNodes.forEach(ySe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ls.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ls.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!$i(this.snapshot.measuredBox.x)&&!$i(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ys(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!cq(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||lf(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),xSe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return ys();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(_Se))){const{scroll:u}=this.root;u&&(gp(o.x,u.offset.x),gp(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=ys();if(Wa(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:f,options:m}=u;u!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&Wa(o,a),gp(o.x,f.offset.x),gp(o.y,f.offset.y))}return o}applyTransform(a,o=!1){const l=ys();Wa(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&yp(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),lf(u.latestValues)&&yp(l,u.latestValues)}return lf(this.latestValues)&&yp(l,this.latestValues),l}removeTransform(a){const o=ys();Wa(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!lf(c.latestValues))continue;MA(c.latestValues)&&c.updateSnapshot();const u=ys(),f=c.measurePageBox();Wa(u,f),l5(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return lf(this.latestValues)&&l5(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==di.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var m;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:f}=this.options;if(!(!this.layout||!(u||f))){if(this.resolvedRelativeTargetAt=di.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ys(),this.relativeTargetOrigin=ys(),v0(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),Wa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ys(),this.targetWithTransforms=ys()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),S_e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Wa(this.target,this.layout.layoutBox),eq(this.target,this.targetDelta)):Wa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ys(),this.relativeTargetOrigin=ys(),v0(this.relativeTargetOrigin,this.target,g.target),Wa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||MA(this.parent.latestValues)||QU(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var v;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===di.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Wa(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;E_e(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ys());const{target:g}=a;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(i5(this.prevProjectionDelta.x,this.projectionDelta.x),i5(this.prevProjectionDelta.y,this.projectionDelta.y)),b0(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==m||!h5(this.projectionDelta.x,this.prevProjectionDelta.x)||!h5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=mp(),this.projectionDelta=mp(),this.projectionDeltaWithTransform=mp()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},f=mp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=ys(),g=l?l.source:void 0,v=this.layout?this.layout.source:void 0,b=g!==v,w=this.getStack(),x=!w||w.members.length<=1,_=!!(b&&!x&&this.options.crossfade===!0&&!this.path.some(vSe));this.animationProgress=0;let E;this.mixTargetDelta=C=>{const k=C/1e3;y5(f.x,a.x,k),y5(f.y,a.y,k),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(v0(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),bSe(this.relativeTarget,this.relativeTargetOrigin,m,k),E&&nSe(this.relativeTarget,E)&&(this.isProjectionDirty=!1),E||(E=ys()),Wa(E,this.relativeTarget)),b&&(this.animationValues=u,Y_e(u,c,this.latestValues,k,_,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ad(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ls.update(()=>{ex.hasAnimatedSinceResize=!0,this.currentAnimation=V_e(0,p5,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(p5),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&hq(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||ys();const f=$i(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const m=$i(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}Wa(o,l),yp(o,u),b0(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new rSe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&Bk("z",a,c,this.animationValues);for(let u=0;u<Lk.length;u++)Bk(`rotate${Lk[u]}`,a,c,this.animationValues),Bk(`skew${Lk[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return iSe;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=Jw(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=Jw(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!lf(this.latestValues)&&(g.transform=l?l({},""):"none",this.hasProjected=!1),g}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=sSe(this.projectionDeltaWithTransform,this.treeScale,u),l&&(o.transform=l(u,o.transform));const{x:f,y:m}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const g in Ay){if(u[g]===void 0)continue;const{correct:v,applyTo:b,isCSSVariable:w}=Ay[g],x=o.transform==="none"?u[g]:v(u[g],c);if(b){const _=b.length;for(let E=0;E<_;E++)o[b[E]]=x}else w?this.options.visualElement.renderState.vars[g]=x:o[g]=x}return this.options.layoutId&&(o.pointerEvents=c===this?Jw(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(m5),this.root.sharedNodes.clear()}}}function oSe(e){e.updateLayout()}function lSe(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;i==="size"?Ya(f=>{const m=a?t.measuredBox[f]:t.layoutBox[f],g=$i(m);m.min=r[f].min,m.max=m.min+g}):hq(i,t.layoutBox,r)&&Ya(f=>{const m=a?t.measuredBox[f]:t.layoutBox[f],g=$i(r[f]);m.max=m.min+g,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+g)});const o=mp();b0(o,r,t.layoutBox);const l=mp();a?b0(l,e.applyTransform(s,!0),t.measuredBox):b0(l,r,t.layoutBox);const c=!cq(o);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:g}=f;if(m&&g){const v=ys();v0(v,t.layoutBox,m.layoutBox);const b=ys();v0(b,r,g.layoutBox),uq(v,b)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=v,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function cSe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function uSe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function dSe(e){e.clearSnapshot()}function m5(e){e.clearMeasurements()}function fSe(e){e.isLayoutDirty=!1}function hSe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function g5(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function pSe(e){e.resolveTargetDelta()}function mSe(e){e.calcProjection()}function gSe(e){e.resetSkewAndRotation()}function ySe(e){e.removeLeadSnapshot()}function y5(e,t,n){e.translate=as(t.translate,0,n),e.scale=as(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function b5(e,t,n,r){e.min=as(t.min,n.min,r),e.max=as(t.max,n.max,r)}function bSe(e,t,n,r){b5(e.x,t.x,n.x,r),b5(e.y,t.y,n.y,r)}function vSe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const wSe={duration:.45,ease:[.4,0,.1,1]},v5=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),w5=v5("applewebkit/")&&!v5("chrome/")?Math.round:io;function x5(e){e.min=w5(e.min),e.max=w5(e.max)}function xSe(e){x5(e.x),x5(e.y)}function hq(e,t,n){return e==="position"||e==="preserve-aspect"&&!__e(f5(t),f5(n),.2)}function _Se(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const SSe=fq({attachResizeListener:(e,t)=>Oy(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),$k={current:void 0},pq=fq({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!$k.current){const e=new SSe({});e.mount(window),e.setOptions({layoutScroll:!0}),$k.current=e}return $k.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),ESe={pan:{Feature:$_e},drag:{Feature:B_e,ProjectionNode:pq,MeasureLayout:aq}};function CSe(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=(n==null?void 0:n[e])??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function mq(e,t){const n=CSe(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function _5(e){return!(e.pointerType==="touch"||iq())}function kSe(e,t,n={}){const[r,s,i]=mq(e,n),a=o=>{if(!_5(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=f=>{_5(f)&&(c(f),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}function S5(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&ls.postRender(()=>i(t,Rb(t)))}class TSe extends Ed{mount(){const{current:t}=this.node;t&&(this.unmount=kSe(t,(n,r)=>(S5(this.node,r,"Start"),s=>S5(this.node,s,"End"))))}unmount(){}}class ASe extends Ed{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Tb(Oy(this.node.current,"focus",()=>this.onFocus()),Oy(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const gq=(e,t)=>t?e===t?!0:gq(e,t.parentElement):!1,RSe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function NSe(e){return RSe.has(e.tagName)||e.tabIndex!==-1}const i0=new WeakSet;function E5(e){return t=>{t.key==="Enter"&&e(t)}}function zk(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const ISe=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=E5(()=>{if(i0.has(n))return;zk(n,"down");const s=E5(()=>{zk(n,"up")}),i=()=>zk(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function C5(e){return MI(e)&&!iq()}function jSe(e,t,n={}){const[r,s,i]=mq(e,n),a=o=>{const l=o.currentTarget;if(!C5(o)||i0.has(l))return;i0.add(l);const c=t(l,o),u=(g,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),!(!C5(g)||!i0.has(l))&&(i0.delete(l),typeof c=="function"&&c(g,{success:v}))},f=g=>{u(g,l===window||l===document||n.useGlobalTarget||gq(l,g.target))},m=g=>{u(g,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",m,s)};return r.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),o instanceof HTMLElement&&(o.addEventListener("focus",c=>ISe(c,s)),!NSe(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function k5(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&ls.postRender(()=>i(t,Rb(t)))}class MSe extends Ed{mount(){const{current:t}=this.node;t&&(this.unmount=jSe(t,(n,r)=>(k5(this.node,r,"Start"),(s,{success:i})=>k5(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const DA=new WeakMap,Uk=new WeakMap,OSe=e=>{const t=DA.get(e.target);t&&t(e)},PSe=e=>{e.forEach(OSe)};function DSe({root:e,...t}){const n=e||document;Uk.has(n)||Uk.set(n,{});const r=Uk.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(PSe,{root:e,...t})),r[s]}function FSe(e,t,n){const r=DSe(t);return DA.set(e,n),r.observe(e),()=>{DA.delete(e),r.unobserve(e)}}const LSe={some:0,all:1};class BSe extends Ed{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:LSe[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),m=c?u:f;m&&m(l)};return FSe(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some($Se(t,n))&&this.startObserver()}unmount(){}}function $Se({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const zSe={inView:{Feature:BSe},tap:{Feature:MSe},focus:{Feature:ASe},hover:{Feature:TSe}},USe={layout:{ProjectionNode:pq,MeasureLayout:aq}},FA={current:null},yq={current:!1};function qSe(){if(yq.current=!0,!!rI)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>FA.current=e.matches;e.addListener(t),t()}else FA.current=!1}const VSe=new WeakMap;function HSe(e,t,n){for(const r in t){const s=t[r],i=n[r];if(Ci(s))e.addValue(r,s);else if(Ci(i))e.addValue(r,Iy(s,{owner:e}));else if(i!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,Iy(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const bq=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),vq=e=>/^0[^.\s]+$/u.test(e),GSe={test:e=>e==="auto",parse:e=>e},wq=e=>t=>t.test(e),xq=[Im,kn,Tl,Iu,nxe,txe,GSe],T5=e=>xq.find(wq(e)),KSe=[...xq,_i,od],WSe=e=>KSe.find(wq(e)),ZSe=new Set(["brightness","contrast","saturate","opacity"]);function YSe(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(_I)||[];if(!r)return e;const s=n.replace(r,"");let i=ZSe.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+s+")"}const XSe=/\b([a-z-]*)\(.*?\)/gu,LA={...od,getAnimatableNone:e=>{const t=e.match(XSe);return t?t.map(YSe).join(" "):e}},JSe={...fI,color:_i,backgroundColor:_i,outlineColor:_i,fill:_i,stroke:_i,borderColor:_i,borderTopColor:_i,borderRightColor:_i,borderBottomColor:_i,borderLeftColor:_i,filter:LA,WebkitFilter:LA},_q=e=>JSe[e];function Sq(e,t){let n=_q(e);return n!==LA&&(n=od),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const A5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class QSe{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=NI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ia.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,ls.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=V_(n),this.isVariantNode=sU(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in f){const g=f[m];l[m]!==void 0&&Ci(g)&&g.set(l[m],!1)}}mount(t){this.current=t,VSe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),yq.current||qSe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:FA.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),ad(this.notifyUpdate),ad(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=Nm.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ls.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Qp){const n=Qp[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ys()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<A5.length;r++){const s=A5[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=t[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=HSe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=Iy(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(bq(r)||vq(r))?r=parseFloat(r):!WSe(r)&&od.test(n)&&(r=Sq(t,n)),this.setBaseTarget(t,Ci(r)?r.get():r)),Ci(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=gI(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Ci(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new wI),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}const e2e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function t2e(e){const t=e2e.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function Eq(e,t,n=1){const[r,s]=t2e(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return bq(a)?parseFloat(a):a}return dI(s)?Eq(s,t,n+1):s}function n2e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||vq(e):!0}const r2e=new Set(["auto","none","0"]);function s2e(e,t,n){let r=0,s;for(;r<e.length&&!s;){const i=e[r];typeof i=="string"&&!r2e.has(i)&&jy(i).values.length&&(s=e[r]),r++}if(s&&n)for(const i of t)e[i]=Sq(n,s)}class i2e extends NI{constructor(t,n,r,s,i){super(t,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),dI(c))){const u=Eq(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!GU.has(r)||t.length!==2)return;const[s,i]=t,a=T5(s),o=T5(i);if(a!==o)if(jD(a)&&jD(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else _f[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||n2e(t[s]))&&r.push(s);r.length&&s2e(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=_f[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=_f[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class Cq extends QSe{constructor(){super(...arguments),this.KeyframeResolver=i2e}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Ci(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function kq(e,{style:t,vars:n},r,s){Object.assign(e.style,t,s&&s.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}function a2e(e){return window.getComputedStyle(e)}class o2e extends Cq{constructor(){super(...arguments),this.type="html",this.renderInstance=kq}readValueFromInstance(t,n){if(Nm.has(n))return I1e(t,n);{const r=a2e(t),s=(uI(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return tq(t,n)}build(t,n,r){hI(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return yI(t,n,r)}}const Tq=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function l2e(e,t,n,r){kq(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(Tq.has(s)?s:oI(s),t.attrs[s])}class c2e extends Cq{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ys}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Nm.has(n)){const r=_q(n);return r&&r.default||0}return n=Tq.has(n)?n:oI(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return gU(t,n,r)}build(t,n,r){fU(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,s){l2e(t,n,r,s)}mount(t){this.isSVGTag=pU(t.tagName),super.mount(t)}}const u2e=(e,t)=>mI(e)?new c2e(t):new o2e(t,{allowProjection:e!==T.Fragment}),d2e=wxe({...p_e,...zSe,...ESe,...USe},u2e),vl=$we(d2e),Cp=new WeakMap,tx=new WeakMap,x1={current:[]};let qk=!1,w0=0;const a0=new Set,Tw=new Map;function Aq(e){const t=Array.from(e).sort((n,r)=>n instanceof kc&&n.options.deps.includes(r)?1:r instanceof kc&&r.options.deps.includes(n)?-1:0);for(const n of t){if(x1.current.includes(n))continue;x1.current.push(n),n.recompute();const r=tx.get(n);if(r)for(const s of r){const i=Cp.get(s);i&&Aq(i)}}}function f2e(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function h2e(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function Rq(e){if(w0>0&&!Tw.has(e)&&Tw.set(e,e.prevState),a0.add(e),!(w0>0)&&!qk)try{for(qk=!0;a0.size>0;){const t=Array.from(a0);a0.clear();for(const n of t){const r=Tw.get(n)??n.prevState;n.prevState=r,f2e(n)}for(const n of t){const r=Cp.get(n);r&&(x1.current.push(n),Aq(r))}for(const n of t){const r=Cp.get(n);if(r)for(const s of r)h2e(s)}}}finally{qk=!1,x1.current=[],Tw.clear()}}function ml(e){w0++;try{e()}finally{if(w0--,w0===0){const t=Array.from(a0)[0];t&&Rq(t)}}}class BA{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const a=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),a==null||a()}},this.setState=r=>{var s,i,a;this.prevState=this.state,this.state=(s=this.options)!=null&&s.updateFn?this.options.updateFn(this.prevState)(r):r(this.prevState),(a=(i=this.options)==null?void 0:i.onUpdate)==null||a.call(i),Rq(this)},this.prevState=t,this.state=t,this.options=n}}class kc{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const s of this.options.deps)n.push(s.prevState),r.push(s.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:s,currDepVals:i,prevVal:a}=this.getDepVals();this.state=this.options.fn({prevDepVals:s,currDepVals:i,prevVal:a}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof kc&&i.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:s}=this.getDepVals();for(let i=0;i<s.length;i++)if(s[i]!==r[i]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,s;this.listeners.add(n);const i=(s=(r=this.options).onSubscribe)==null?void 0:s.call(r,n,this);return()=>{this.listeners.delete(n),i==null||i()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof kc)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof BA){let r=Cp.get(n);r||(r=new Set,Cp.set(n,r)),r.add(this);let s=tx.get(this);s||(s=new Set,tx.set(this,s)),s.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof kc)this.unregisterFromGraph(n.options.deps);else if(n instanceof BA){const r=Cp.get(n);r&&r.delete(this);const s=tx.get(this);s&&s.delete(n)}}}function H_(e,t){return typeof e=="function"?e(t):e}function nx(e,t){return OI(t).reduce((r,s)=>{if(r===null)return null;if(typeof r<"u")return r[s]},e)}function Vk(e,t,n){const r=OI(t);function s(i){if(!r.length)return H_(n,i);const a=r.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(i))return typeof i=="object"?(i===null&&(i={}),{...i,[a]:s(i[a])}):{[a]:s()};if(Array.isArray(i)&&typeof a=="number"){const o=i.slice(0,a);return[...o.length?o:new Array(a),s(i[a]),...i.slice(a+1)]}return[...new Array(a),s()]}return s(e)}function p2e(e,t){const n=OI(t);function r(s){if(!s)return;if(n.length===1){const a=n[0];if(Array.isArray(s)&&typeof a=="number")return s.filter((c,u)=>u!==a);const{[a]:o,...l}=s;return l}const i=n.shift();if(typeof i=="string"&&typeof s=="object")return{...s,[i]:r(s[i])};if(typeof i=="number"&&Array.isArray(s)){if(i>=s.length)return s;const a=s.slice(0,i);return[...a.length?a:new Array(i),r(s[i]),...s.slice(i+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return r(e)}const m2e=/^(\d*)$/gm,g2e=/\.(\d*)\./gm,y2e=/^(\d*)\./gm,b2e=/\.(\d*$)/gm,v2e=/\.{2,}/gm,$A="__int__",Aw=`${$A}$1`;function OI(e){if(Array.isArray(e))return[...e];if(typeof e!="string")throw new Error("Path must be a string.");return e.replace(/\[/g,".").replace(/\]/g,"").replace(m2e,Aw).replace(g2e,`.${Aw}.`).replace(y2e,`${Aw}.`).replace(b2e,`.${Aw}`).replace(v2e,".").split(".").map(t=>t.indexOf($A)===0?parseInt(t.substring($A.length),10):t)}function w2e(e){return!(Array.isArray(e)&&e.length===0)}function zA(e,t){const{asyncDebounceMs:n}=t,{onChangeAsync:r,onBlurAsync:s,onSubmitAsync:i,onBlurAsyncDebounceMs:a,onChangeAsyncDebounceMs:o}=t.validators||{},l=n??0,c={cause:"change",validate:r,debounceMs:o??l},u={cause:"blur",validate:s,debounceMs:a??l},f={cause:"submit",validate:i,debounceMs:0},m=g=>({...g,debounceMs:0});switch(e){case"submit":return[m(c),m(u),f];case"blur":return[u];case"change":return[c];case"server":default:return[]}}function UA(e,t){const{onChange:n,onBlur:r,onSubmit:s,onMount:i}=t.validators||{},a={cause:"change",validate:n},o={cause:"blur",validate:r},l={cause:"submit",validate:s},c={cause:"mount",validate:i},u={cause:"server",validate:()=>{}};switch(e){case"mount":return[c];case"submit":return[a,o,l,u];case"server":return[u];case"blur":return[o,u];case"change":default:return[a,u]}}const qA=e=>!!e&&typeof e=="object"&&"fields"in e;function ip(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,i]of e)if(!t.has(s)||!Object.is(i,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!ip(e[s],t[s]))return!1;return!0}const R5=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},N5=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function x2e(e){const t=new Map;for(const n of e){const r=[...n.path??[]].map(s=>{const i=typeof s=="object"?s.key:s;return typeof i=="number"?`[${i}]`:i}).join(".").replace(/\.\[/g,"[");t.set(r,(t.get(r)??[]).concat(n))}return Object.fromEntries(t)}const I5=e=>{const t=x2e(e);return{form:t,fields:t}},kp={validate({value:e,validationSource:t},n){const r=n["~standard"].validate(e);if(r instanceof Promise)throw new Error("async function passed to sync validator");if(r.issues)return t==="field"?r.issues:I5(r.issues)},async validateAsync({value:e,validationSource:t},n){const r=await n["~standard"].validate(e);if(r.issues)return t==="field"?r.issues:I5(r.issues)}},Nq=e=>!!e&&"~standard"in e,_1={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function Rw(e){function t(f,m,g,v){const b=r(f,m,g,v);({insert:()=>o(b,f,m),remove:()=>l(b),swap:()=>v!==void 0&&u(b,f,m,v),move:()=>v!==void 0&&c(b,f,m,v)})[g]()}function n(f,m){return`${f}[${m}]`}function r(f,m,g,v){const b=[n(f,m)];if(g==="swap")b.push(n(f,v));else if(g==="move"){const[w,x]=[Math.min(m,v),Math.max(m,v)];for(let _=w;_<=x;_++)b.push(n(f,_))}else{const w=e.getFieldValue(f),x=Array.isArray(w)?w.length:0;for(let _=m+1;_<x;_++)b.push(n(f,_))}return Object.keys(e.fieldInfo).filter(w=>b.some(x=>w.startsWith(x)))}function s(f,m){return f.replace(/\[(\d+)\]/,(g,v)=>{const b=parseInt(v,10);return`[${m==="up"?b+1:Math.max(0,b-1)}]`})}function i(f,m){(m==="up"?f:[...f].reverse()).forEach(v=>{const b=s(v.toString(),m),w=e.getFieldMeta(b);w?e.setFieldMeta(v,w):e.setFieldMeta(v,a())})}const a=()=>_1,o=(f,m,g)=>{i(f,"down"),f.forEach(v=>{v.toString().startsWith(n(m,g))&&e.setFieldMeta(v,a())})},l=f=>{i(f,"up")},c=(f,m,g,v)=>{const b=new Map(Object.keys(e.fieldInfo).filter(w=>w.startsWith(n(m,g))).map(w=>[w,e.getFieldMeta(w)]));i(f,g<v?"up":"down"),Object.keys(e.fieldInfo).filter(w=>w.startsWith(n(m,v))).forEach(w=>{const x=w.replace(n(m,v),n(m,g)),_=b.get(x);_&&e.setFieldMeta(w,_)})},u=(f,m,g,v)=>{f.forEach(b=>{if(!b.toString().startsWith(n(m,g)))return;const w=b.toString().replace(n(m,g),n(m,v)),[x,_]=[e.getFieldMeta(b),e.getFieldMeta(w)];x&&e.setFieldMeta(w,x),_&&e.setFieldMeta(b,_)})};return{handleArrayFieldMetaShift:t}}function Hk(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class _2e{constructor(t){var n;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var r,s;const i=this.fieldMetaDerived.mount(),a=this.store.mount(),o=()=>{i(),a()};(s=(r=this.options.listeners)==null?void 0:r.onMount)==null||s.call(r,{formApi:this});const{onMount:l}=this.options.validators||{};return l&&this.validateSync("mount"),o},this.update=r=>{var s,i;if(!r)return;const a=this.options;this.options=r;const o=!!((i=(s=r.transform)==null?void 0:s.deps)!=null&&i.some((u,f)=>u!==this.prevTransformArray[f])),l=r.defaultValues&&!ip(r.defaultValues,a.defaultValues)&&!this.state.isTouched,c=!ip(r.defaultState,a.defaultState)&&!this.state.isTouched;!l&&!c&&!o||ml(()=>{this.baseStore.setState(()=>Hk(Object.assign({},this.state,c?r.defaultState:{},l?{values:r.defaultValues}:{},o?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(r,s)=>{const{fieldMeta:i}=this.state,a=this.resetFieldMeta(i);r&&!(s!=null&&s.keepDefaultValues)&&(this.options={...this.options,defaultValues:r}),this.baseStore.setState(()=>{var o;return Hk({...this.options.defaultState,values:r??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async r=>{const s=[];return ml(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;s.push(Promise.resolve().then(()=>o.validate(r,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(s)).flat()},this.validateArrayFieldsStartingFrom=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${r}[${s}]`];for(let m=s+1;m<=(o??0);m++)l.push(`${r}[${m}]`);const c=Object.keys(this.fieldInfo).filter(m=>l.some(g=>m.startsWith(g))),u=[];return ml(()=>{c.forEach(m=>{u.push(Promise.resolve().then(()=>this.validateField(m,i)))})}),(await Promise.all(u)).flat()},this.validateField=(r,s)=>{var i;const a=(i=this.fieldInfo[r])==null?void 0:i.instance;return a?(a.state.meta.isTouched||a.setMeta(o=>({...o,isTouched:!0})),a.validate(s)):[]},this.validateSync=r=>{const s=UA(r,this.options);let i=!1;const a={};return ml(()=>{var o,l;for(const u of s){if(!u.validate)continue;const f=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:m,fieldErrors:g}=rx(f),v=Nw(u.cause);for(const b of Object.keys(this.state.fieldMeta)){const w=this.getFieldMeta(b);if(!w)continue;const{errorMap:x,errorSourceMap:_}=w,E=g==null?void 0:g[b],{newErrorValue:C,newSource:k}=R5({newFormValidatorError:E,isPreviousErrorFromFormValidator:(_==null?void 0:_[v])==="form",previousErrorValue:x==null?void 0:x[v]});k==="form"&&(a[b]={...a[b],[v]:E}),(x==null?void 0:x[v])!==C&&this.setFieldMeta(b,R=>({...R,errorMap:{...R.errorMap,[v]:C},errorSourceMap:{...R.errorSourceMap,[v]:k}}))}((o=this.state.errorMap)==null?void 0:o[v])!==m&&this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[v]:m}})),(m||g)&&(i=!0)}const c=Nw("submit");(l=this.state.errorMap)!=null&&l[c]&&r!=="submit"&&!i&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[c]:void 0}}))}),{hasErrored:i,fieldsErrorMap:a}},this.validateAsync=async r=>{const s=zA(r,this.options);this.state.isFormValidating||this.baseStore.setState(c=>({...c,isFormValidating:!0}));const i=[];let a;for(const c of s){if(!c.validate)continue;const u=Nw(c.cause),f=this.state.validationMetaMap[u];f==null||f.lastAbortController.abort();const m=new AbortController;this.state.validationMetaMap[u]={lastAbortController:m},i.push(new Promise(async g=>{let v;try{v=await new Promise((_,E)=>{setTimeout(async()=>{if(m.signal.aborted)return _(void 0);try{_(await this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:m.signal},type:"validateAsync"}))}catch(C){E(C)}},c.debounceMs)})}catch(_){v=_}const{formError:b,fieldErrors:w}=rx(v);w&&(a=a?{...a,...w}:w);const x=Nw(c.cause);for(const _ of Object.keys(this.state.fieldMeta)){const E=this.getFieldMeta(_);if(!E)continue;const{errorMap:C,errorSourceMap:k}=E,R=a==null?void 0:a[_],{newErrorValue:I,newSource:j}=R5({newFormValidatorError:R,isPreviousErrorFromFormValidator:(k==null?void 0:k[x])==="form",previousErrorValue:C==null?void 0:C[x]});(C==null?void 0:C[x])!==I&&this.setFieldMeta(_,M=>({...M,errorMap:{...M.errorMap,[x]:I},errorSourceMap:{...M.errorSourceMap,[x]:j}}))}this.baseStore.setState(_=>({..._,errorMap:{..._.errorMap,[x]:b}})),g(a?{fieldErrors:a,errorMapKey:x}:void 0)}))}let o=[];const l={};if(i.length){o=await Promise.all(i);for(const c of o)if(c!=null&&c.fieldErrors){const{errorMapKey:u}=c;for(const[f,m]of Object.entries(c.fieldErrors)){const v={...l[f]||{},[u]:m};l[f]=v}}}return this.baseStore.setState(c=>({...c,isFormValidating:!1})),l},this.validate=r=>{const{hasErrored:s,fieldsErrorMap:i}=this.validateSync(r);return s&&!this.options.asyncAlways?i:this.validateAsync(r)},this.getFieldValue=r=>nx(this.state.values,r),this.getFieldMeta=r=>this.state.fieldMeta[r],this.getFieldInfo=r=>{var s;return(s=this.fieldInfo)[r]||(s[r]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(r,s)=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[r]:H_(s,i.fieldMetaBase[r])}}))},this.resetFieldMeta=r=>Object.keys(r).reduce((s,i)=>{const a=i;return s[a]=_1,s},{}),this.setFieldValue=(r,s,i)=>{const a=(i==null?void 0:i.dontUpdateMeta)??!1;ml(()=>{a||this.setFieldMeta(r,o=>({...o,isTouched:!0,isDirty:!0,errorMap:{...o==null?void 0:o.errorMap,onMount:void 0}})),this.baseStore.setState(o=>({...o,values:Vk(o.values,r,s)}))})},this.deleteField=r=>{const i=[...Object.keys(this.fieldInfo).filter(a=>{const o=r.toString();return a!==o&&a.startsWith(o)}),r];this.baseStore.setState(a=>{const o={...a};return i.forEach(l=>{o.values=p2e(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(r,s,i)=>{this.setFieldValue(r,a=>[...Array.isArray(a)?a:[],s],i),this.validateField(r,"change")},this.insertFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>[...o.slice(0,s),i,...o.slice(s)],a),await this.validateField(r,"change"),Rw(this).handleArrayFieldMetaShift(r,s,"insert"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.replaceFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>o.map((l,c)=>c===s?i:l),a),await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.removeFieldValue=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(r,l=>l.filter((c,u)=>u!==s),i),Rw(this).handleArrayFieldMetaShift(r,s,"remove"),o!==null){const l=`${r}[${o}]`;this.deleteField(l)}await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.swapFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=o[s],c=o[i];return Vk(Vk(o,`${s}`,c),`${i}`,l)},a),Rw(this).handleArrayFieldMetaShift(r,s,"swap",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.moveFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>(o.splice(i,0,o.splice(s,1)[0]),o),a),Rw(this).handleArrayFieldMetaShift(r,s,"move",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.resetField=r=>{this.baseStore.setState(s=>({...s,fieldMetaBase:{...s.fieldMetaBase,[r]:_1},values:{...s.values,[r]:this.options.defaultValues&&this.options.defaultValues[r]}}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((r,[s,i])=>(Object.keys(i).length&&i.errors.length&&(r[s]={errors:i.errors,errorMap:i.errorMap}),r),{})}),this.parseValuesWithSchema=r=>kp.validate({value:this.state.values,validationSource:"form"},r),this.parseValuesWithSchemaAsync=r=>kp.validateAsync({value:this.state.values,validationSource:"form"},r),this.baseStore=new BA(Hk({...t==null?void 0:t.defaultState,values:(t==null?void 0:t.defaultValues)??((n=t==null?void 0:t.defaultState)==null?void 0:n.values)})),this.fieldMetaDerived=new kc({deps:[this.baseStore],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l;const c=i,u=r==null?void 0:r[0],f=s[0];let m=0;const g={};for(const v of Object.keys(f.fieldMetaBase)){const b=f.fieldMetaBase[v],w=u==null?void 0:u.fieldMetaBase[v],x=c==null?void 0:c[v],_=nx(f.values,v);let E=x==null?void 0:x.errors;if(!w||b.errorMap!==w.errorMap){E=Object.values(b.errorMap??{}).filter(j=>j!==void 0);const I=(a=this.getFieldInfo(v))==null?void 0:a.instance;I&&!I.options.disableErrorFlat&&(E=E==null?void 0:E.flat(1))}const C=!w2e(E??[]),k=!b.isDirty,R=ip(_,nx(this.options.defaultValues,v))||ip(_,(l=(o=this.getFieldInfo(v))==null?void 0:o.instance)==null?void 0:l.options.defaultValue);if(x&&x.isPristine===k&&x.isValid===C&&x.isDefaultValue===R&&x.errors===E&&b===w){g[v]=x,m++;continue}g[v]={...b,errors:E,isPristine:k,isValid:C,isDefaultValue:R}}return Object.keys(f.fieldMetaBase).length&&c&&m===Object.keys(f.fieldMetaBase).length?c:g}}),this.store=new kc({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l,c;const u=i,f=r==null?void 0:r[0],m=s[0],g=s[1],v=Object.values(g).filter(Boolean),b=v.some(W=>W.isValidating),w=v.every(W=>W.isValid),x=v.some(W=>W.isTouched),_=v.some(W=>W.isBlurred),E=v.every(W=>W.isDefaultValue),C=x&&((a=m.errorMap)==null?void 0:a.onMount),k=v.some(W=>W.isDirty),R=!k,I=!!((o=m.errorMap)!=null&&o.onMount||v.some(W=>{var se;return(se=W==null?void 0:W.errorMap)==null?void 0:se.onMount})),j=!!b;let M=(u==null?void 0:u.errors)??[];(!f||m.errorMap!==f.errorMap)&&(M=Object.values(m.errorMap).reduce((W,se)=>se===void 0?W:se&&qA(se)?(W.push(se.form),W):(W.push(se),W),[]));const L=M.length===0,q=w&&L,P=this.options.canSubmitWhenInvalid??!1,V=m.submissionAttempts===0&&!x&&!I||!j&&!m.isSubmitting&&q||P;let z=m.errorMap;if(C&&(M=M.filter(W=>W!==m.errorMap.onMount),z=Object.assign(z,{onMount:void 0})),u&&f&&u.errorMap===z&&u.fieldMeta===this.fieldMetaDerived.state&&u.errors===M&&u.isFieldsValidating===b&&u.isFieldsValid===w&&u.isFormValid===L&&u.isValid===q&&u.canSubmit===V&&u.isTouched===x&&u.isBlurred===_&&u.isPristine===R&&u.isDefaultValue===E&&u.isDirty===k&&ip(f,m))return u;let re={...m,errorMap:z,fieldMeta:this.fieldMetaDerived.state,errors:M,isFieldsValidating:b,isFieldsValid:w,isFormValid:L,isValid:q,canSubmit:V,isTouched:x,isBlurred:_,isPristine:R,isDefaultValue:E,isDirty:k};const K=((l=this.options.transform)==null?void 0:l.deps)??[];if(K.length!==this.prevTransformArray.length||K.some((W,se)=>W!==this.prevTransformArray[se])){const W=Object.assign({},this,{state:re});(c=this.options.transform)==null||c.fn(W),re=W.state,this.prevTransformArray=K}return re}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(t||{})}get state(){return this.store.state}runValidator(t){return Nq(t.validate)?kp[t.type](t.value,t.validate):t.validate(t.value)}async handleSubmit(t){var n,r,s,i,a,o,l,c;if(this.baseStore.setState(f=>({...f,isSubmitted:!1,submissionAttempts:f.submissionAttempts+1,isSubmitSuccessful:!1})),ml(()=>{Object.values(this.fieldInfo).forEach(f=>{f.instance&&(f.instance.state.meta.isTouched||f.instance.setMeta(m=>({...m,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(f=>({...f,isSubmitting:!0}));const u=()=>{this.baseStore.setState(f=>({...f,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){u(),(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){u(),(i=(s=this.options).onSubmitInvalid)==null||i.call(s,{value:this.state.values,formApi:this});return}ml(()=>{Object.values(this.fieldInfo).forEach(f=>{var m,g,v;(v=(g=(m=f.instance)==null?void 0:m.options.listeners)==null?void 0:g.onSubmit)==null||v.call(g,{value:f.instance.state.value,fieldApi:f.instance})})}),(o=(a=this.options.listeners)==null?void 0:a.onSubmit)==null||o.call(a,{formApi:this});try{await((c=(l=this.options).onSubmit)==null?void 0:c.call(l,{value:this.state.values,formApi:this,meta:t??this.options.onSubmitMeta})),ml(()=>{this.baseStore.setState(f=>({...f,isSubmitted:!0,isSubmitSuccessful:!0})),u()})}catch(f){throw this.baseStore.setState(m=>({...m,isSubmitSuccessful:!1})),u(),f}}setErrorMap(t){ml(()=>{Object.entries(t).forEach(([n,r])=>{const s=n;if(qA(r)){const{formError:i,fieldErrors:a}=rx(r);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,c=>({...c,errorMap:{...c.errorMap,[s]:a==null?void 0:a[o]},errorSourceMap:{...c.errorSourceMap,[s]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[s]:i}}))}else this.baseStore.setState(i=>({...i,errorMap:{...i.errorMap,[s]:r}}))})})}}function rx(e){if(e){if(qA(e)){const t=rx(e.form).formError,n=e.fields;return{formError:t,fieldErrors:n}}return{formError:e}}return{formError:void 0}}function Nw(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class S2e{constructor(t){this.options={},this.mount=()=>{var n,r;const s=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const i=this.getInfo();i.instance=this,this.update(this.options);const{onMount:a}=this.options.validators||{};if(a){const o=this.runValidator({validate:a,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(r=(n=this.options.listeners)==null?void 0:n.onMount)==null||r.call(n,{value:this.state.value,fieldApi:this}),s},this.update=n=>{this.options=n;const r=this.name!==n.name;if(this.name=n.name,this.state.value===void 0){const s=nx(n.form.options.defaultValues,n.name),i=n.defaultValue??s;r?this.setValue(a=>a||i,{dontUpdateMeta:!0}):i!==void 0&&this.setValue(i,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(n,r)=>{this.form.setFieldValue(this.name,n,r),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=n=>this.form.setFieldMeta(this.name,n),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(n,r)=>{this.form.pushFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.insertValue=(n,r,s)=>{this.form.insertFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.replaceValue=(n,r,s)=>{this.form.replaceFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.removeValue=(n,r)=>{this.form.removeFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.swapValues=(n,r,s)=>{this.form.swapFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.moveValue=(n,r,s)=>{this.form.moveFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.getLinkedFields=n=>{const r=Object.values(this.form.fieldInfo),s=[];for(const i of r){if(!i.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=i.instance.options.validators||{};n==="change"&&(a!=null&&a.includes(this.name))&&s.push(i.instance),n==="blur"&&(o!=null&&o.includes(this.name))&&s.push(i.instance)}return s},this.validateSync=(n,r)=>{var s;const i=UA(n,this.options),o=this.getLinkedFields(n).reduce((u,f)=>{const m=UA(n,f.options);return m.forEach(g=>{g.field=f}),u.concat(m)},[]);let l=!1;ml(()=>{const u=(f,m)=>{var g;const v=Iw(m.cause),b=m.validate?j5(f.runValidator({validate:m.validate,value:{value:f.store.state.value,validationSource:"field",fieldApi:f},type:"validate"})):void 0,w=r[v],{newErrorValue:x,newSource:_}=N5({formLevelError:w,fieldLevelError:b});((g=f.state.meta.errorMap)==null?void 0:g[v])!==x&&f.setMeta(E=>({...E,errorMap:{...E.errorMap,[v]:x},errorSourceMap:{...E.errorSourceMap,[v]:_}})),x&&(l=!0)};for(const f of i)u(this,f);for(const f of o)f.validate&&u(f.field,f)});const c=Iw("submit");return(s=this.state.meta.errorMap)!=null&&s[c]&&n!=="submit"&&!l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[c]:void 0},errorSourceMap:{...u.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(n,r)=>{const s=zA(n,this.options),i=await r,a=this.getLinkedFields(n),o=a.reduce((m,g)=>{const v=zA(n,g.options);return v.forEach(b=>{b.field=g}),m.concat(v)},[]);this.state.meta.isValidating||this.setMeta(m=>({...m,isValidating:!0}));for(const m of a)m.setMeta(g=>({...g,isValidating:!0}));const l=[],c=[],u=(m,g,v)=>{const b=Iw(g.cause),w=m.getInfo().validationMetaMap[b];w==null||w.lastAbortController.abort();const x=new AbortController;this.getInfo().validationMetaMap[b]={lastAbortController:x},v.push(new Promise(async _=>{var E;let C;try{C=await new Promise((M,L)=>{this.timeoutIds.validations[g.cause]&&clearTimeout(this.timeoutIds.validations[g.cause]),this.timeoutIds.validations[g.cause]=setTimeout(async()=>{if(x.signal.aborted)return M(void 0);try{M(await this.runValidator({validate:g.validate,value:{value:m.store.state.value,fieldApi:m,signal:x.signal,validationSource:"field"},type:"validateAsync"}))}catch(q){L(q)}},g.debounceMs)})}catch(M){C=M}if(x.signal.aborted)return _(void 0);const k=j5(C),R=(E=i[this.name])==null?void 0:E[b],{newErrorValue:I,newSource:j}=N5({formLevelError:R,fieldLevelError:k});m.setMeta(M=>({...M,errorMap:{...M==null?void 0:M.errorMap,[b]:I},errorSourceMap:{...M.errorSourceMap,[b]:j}})),_(I)}))};for(const m of s)m.validate&&u(this,m,l);for(const m of o)m.validate&&u(m.field,m,c);let f=[];(l.length||c.length)&&(f=await Promise.all(l),await Promise.all(c)),this.setMeta(m=>({...m,isValidating:!1}));for(const m of a)m.setMeta(g=>({...g,isValidating:!1}));return f.filter(Boolean)},this.validate=(n,r)=>{var s;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=r!=null&&r.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(n),{hasErrored:a}=this.validateSync(n,i[this.name]??{});if(a&&!this.options.asyncAlways)return(s=this.getInfo().validationMetaMap[Iw(n)])==null||s.lastAbortController.abort(),this.state.meta.errors;const o=r!=null&&r.skipFormValidation?Promise.resolve({}):this.form.validateAsync(n);return this.validateAsync(n,o)},this.handleChange=n=>{this.setValue(n)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(r=>({...r,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(r=>({...r,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=n=>kp.validate({value:this.state.value,validationSource:"field"},n),this.parseValueWithSchemaAsync=n=>kp.validateAsync({value:this.state.value,validationSource:"field"},n),this.form=t.form,this.name=t.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new kc({deps:[this.form.store],fn:()=>{const n=this.form.getFieldValue(this.name),r=this.form.getFieldMeta(this.name)??{..._1,...t.defaultMeta};return{value:n,meta:r}}}),this.options=t}get state(){return this.store.state}runValidator(t){return Nq(t.validate)?kp[t.type](t.value,t.validate):t.validate(t.value)}setErrorMap(t){this.setMeta(n=>({...n,errorMap:{...n.errorMap,...t}}))}triggerOnBlurListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onBlurDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onBlurDebounceMs;l&&l>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onBlur)==null||a.call(i,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onChangeDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onChangeDebounceMs;l&&l>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onChange)==null||a.call(i,{value:this.state.value,fieldApi:this})}}function j5(e){if(e)return e}function Iw(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var Gk={exports:{}},Kk={},Wk={exports:{}},Zk={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M5;function E2e(){if(M5)return Zk;M5=1;var e=qy();function t(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function o(f,m){var g=m(),v=r({inst:{value:g,getSnapshot:m}}),b=v[0].inst,w=v[1];return i(function(){b.value=g,b.getSnapshot=m,l(b)&&w({inst:b})},[f,g,m]),s(function(){return l(b)&&w({inst:b}),f(function(){l(b)&&w({inst:b})})},[f]),a(g),g}function l(f){var m=f.getSnapshot;f=f.value;try{var g=m();return!n(f,g)}catch{return!0}}function c(f,m){return m()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return Zk.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,Zk}var O5;function C2e(){return O5||(O5=1,Wk.exports=E2e()),Wk.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P5;function k2e(){if(P5)return Kk;P5=1;var e=qy(),t=C2e();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,o=e.useMemo,l=e.useDebugValue;return Kk.useSyncExternalStoreWithSelector=function(c,u,f,m,g){var v=i(null);if(v.current===null){var b={hasValue:!1,value:null};v.current=b}else b=v.current;v=o(function(){function x(R){if(!_){if(_=!0,E=R,R=m(R),g!==void 0&&b.hasValue){var I=b.value;if(g(I,R))return C=I}return C=R}if(I=C,r(E,R))return I;var j=m(R);return g!==void 0&&g(I,j)?(E=R,I):(E=R,C=j)}var _=!1,E,C,k=f===void 0?null:f;return[function(){return x(u())},k===null?void 0:function(){return x(k())}]},[u,f,m,g]);var w=s(c,v[0],v[1]);return a(function(){b.hasValue=!0,b.value=w},[w]),l(w),w},Kk}var D5;function T2e(){return D5||(D5=1,Gk.exports=k2e()),Gk.exports}var A2e=T2e();function PI(e,t=n=>n){return A2e.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,R2e)}function R2e(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!t.has(r)||!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const S1=typeof window<"u"?T.useLayoutEffect:T.useEffect;function N2e(e){const[t]=T.useState(()=>{const r=new S2e({...e,form:e.form,name:e.name});return r.Field=Iq,r});return S1(t.mount,[t]),S1(()=>{t.update(e)}),PI(t.store,e.mode==="array"?n=>[n.meta,Object.keys(n.value??[]).length]:void 0),t}const Iq=({children:e,...t})=>{const n=N2e(t),r=T.useMemo(()=>H_(e,n),[e,n,n.state.value,n.state.meta]);return p.jsx(p.Fragment,{children:r})};function I2e({form:e,selector:t,children:n}){const r=PI(e.store,t);return H_(n,r)}function ri(e){const[t]=T.useState(()=>{const n=new _2e(e),r=n;return r.Field=function(i){return p.jsx(Iq,{...i,form:n})},r.Subscribe=s=>p.jsx(I2e,{form:n,selector:s.selector,children:s.children}),r});return S1(t.mount,[]),PI(t.store,n=>n.isSubmitting),S1(()=>{t.update(e)}),t}function zn({className:e,type:t,...n}){return p.jsx("input",{type:t,"data-slot":"input",className:ct("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}function G_(e){const t=e+"CollectionProvider",[n,r]=Ii(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:w,children:x}=b,_=dt.useRef(null),E=dt.useRef(new Map).current;return p.jsx(s,{scope:w,itemMap:E,collectionRef:_,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=zu(o),c=dt.forwardRef((b,w)=>{const{scope:x,children:_}=b,E=i(o,x),C=Nn(w,E.collectionRef);return p.jsx(l,{ref:C,children:_})});c.displayName=o;const u=e+"CollectionItemSlot",f="data-radix-collection-item",m=zu(u),g=dt.forwardRef((b,w)=>{const{scope:x,children:_,...E}=b,C=dt.useRef(null),k=Nn(w,C),R=i(u,x);return dt.useEffect(()=>(R.itemMap.set(C,{ref:C,...E}),()=>void R.itemMap.delete(C))),p.jsx(m,{[f]:"",ref:k,children:_})});g.displayName=u;function v(b){const w=i(e+"CollectionConsumer",b);return dt.useCallback(()=>{const _=w.collectionRef.current;if(!_)return[];const E=Array.from(_.querySelectorAll(`[${f}]`));return Array.from(w.itemMap.values()).sort((R,I)=>E.indexOf(R.ref.current)-E.indexOf(I.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:a,Slot:c,ItemSlot:g},v,r]}var Yk=0;function K_(){T.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??F5()),document.body.insertAdjacentElement("beforeend",e[1]??F5()),Yk++,()=>{Yk===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Yk--}},[])}function F5(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Xk="focusScope.autoFocusOnMount",Jk="focusScope.autoFocusOnUnmount",L5={bubbles:!1,cancelable:!0},j2e="FocusScope",Nb=T.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=T.useState(null),c=Xs(s),u=Xs(i),f=T.useRef(null),m=Nn(t,b=>l(b)),g=T.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;T.useEffect(()=>{if(r){let b=function(E){if(g.paused||!o)return;const C=E.target;o.contains(C)?f.current=C:ju(f.current,{select:!0})},w=function(E){if(g.paused||!o)return;const C=E.relatedTarget;C!==null&&(o.contains(C)||ju(f.current,{select:!0}))},x=function(E){if(document.activeElement===document.body)for(const k of E)k.removedNodes.length>0&&ju(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",w);const _=new MutationObserver(x);return o&&_.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",w),_.disconnect()}}},[r,o,g.paused]),T.useEffect(()=>{if(o){$5.add(g);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(Xk,L5);o.addEventListener(Xk,c),o.dispatchEvent(x),x.defaultPrevented||(M2e(L2e(jq(o)),{select:!0}),document.activeElement===b&&ju(o))}return()=>{o.removeEventListener(Xk,c),setTimeout(()=>{const x=new CustomEvent(Jk,L5);o.addEventListener(Jk,u),o.dispatchEvent(x),x.defaultPrevented||ju(b??document.body,{select:!0}),o.removeEventListener(Jk,u),$5.remove(g)},0)}}},[o,c,u,g]);const v=T.useCallback(b=>{if(!n&&!r||g.paused)return;const w=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(w&&x){const _=b.currentTarget,[E,C]=O2e(_);E&&C?!b.shiftKey&&x===C?(b.preventDefault(),n&&ju(E,{select:!0})):b.shiftKey&&x===E&&(b.preventDefault(),n&&ju(C,{select:!0})):x===_&&b.preventDefault()}},[n,r,g.paused]);return p.jsx(sn.div,{tabIndex:-1,...a,ref:m,onKeyDown:v})});Nb.displayName=j2e;function M2e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(ju(r,{select:t}),document.activeElement!==n)return}function O2e(e){const t=jq(e),n=B5(t,e),r=B5(t.reverse(),e);return[n,r]}function jq(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function B5(e,t){for(const n of e)if(!P2e(n,{upTo:t}))return n}function P2e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function D2e(e){return e instanceof HTMLInputElement&&"select"in e}function ju(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&D2e(e)&&t&&e.select()}}var $5=F2e();function F2e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=z5(e,t),e.unshift(t)},remove(t){var n;e=z5(e,t),(n=e[0])==null||n.resume()}}}function z5(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function L2e(e){return e.filter(t=>t.tagName!=="A")}function W_(e){const t=T.useRef({value:e,previous:e});return T.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var B2e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Jh=new WeakMap,jw=new WeakMap,Mw={},Qk=0,Mq=function(e){return e&&(e.host||Mq(e.parentNode))},$2e=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=Mq(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},z2e=function(e,t,n,r){var s=$2e(t,Array.isArray(e)?e:[e]);Mw[n]||(Mw[n]=new WeakMap);var i=Mw[n],a=[],o=new Set,l=new Set(s),c=function(f){!f||o.has(f)||(o.add(f),c(f.parentNode))};s.forEach(c);var u=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(m){if(o.has(m))u(m);else try{var g=m.getAttribute(r),v=g!==null&&g!=="false",b=(Jh.get(m)||0)+1,w=(i.get(m)||0)+1;Jh.set(m,b),i.set(m,w),a.push(m),b===1&&v&&jw.set(m,!0),w===1&&m.setAttribute(n,"true"),v||m.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",m,x)}})};return u(t),o.clear(),Qk++,function(){a.forEach(function(f){var m=Jh.get(f)-1,g=i.get(f)-1;Jh.set(f,m),i.set(f,g),m||(jw.has(f)||f.removeAttribute(r),jw.delete(f)),g||f.removeAttribute(n)}),Qk--,Qk||(Jh=new WeakMap,Jh=new WeakMap,jw=new WeakMap,Mw={})}},Z_=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=B2e(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),z2e(r,s,n,"aria-hidden")):function(){return null}},_l=function(){return _l=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},_l.apply(this,arguments)};function Oq(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function U2e(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var sx="right-scroll-bar-position",ix="width-before-scroll-bar",q2e="with-scroll-bars-hidden",V2e="--removed-body-scroll-bar-size";function eT(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function H2e(e,t){var n=T.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var G2e=typeof window<"u"?T.useLayoutEffect:T.useEffect,U5=new WeakMap;function K2e(e,t){var n=H2e(null,function(r){return e.forEach(function(s){return eT(s,r)})});return G2e(function(){var r=U5.get(n);if(r){var s=new Set(r),i=new Set(e),a=n.current;s.forEach(function(o){i.has(o)||eT(o,null)}),i.forEach(function(o){s.has(o)||eT(o,a)})}U5.set(n,e)},[e]),n}function W2e(e){return e}function Z2e(e,t){t===void 0&&(t=W2e);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var l=function(){var u=a;a=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return s}function Y2e(e){e===void 0&&(e={});var t=Z2e(null);return t.options=_l({async:!0,ssr:!1},e),t}var Pq=function(e){var t=e.sideCar,n=Oq(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return T.createElement(r,_l({},n))};Pq.isSideCarExport=!0;function X2e(e,t){return e.useMedium(t),Pq}var Dq=Y2e(),tT=function(){},Y_=T.forwardRef(function(e,t){var n=T.useRef(null),r=T.useState({onScrollCapture:tT,onWheelCapture:tT,onTouchMoveCapture:tT}),s=r[0],i=r[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,f=e.shards,m=e.sideCar,g=e.noIsolation,v=e.inert,b=e.allowPinchZoom,w=e.as,x=w===void 0?"div":w,_=e.gapMode,E=Oq(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=m,k=K2e([n,t]),R=_l(_l({},E),s);return T.createElement(T.Fragment,null,u&&T.createElement(C,{sideCar:Dq,removeScrollBar:c,shards:f,noIsolation:g,inert:v,setCallbacks:i,allowPinchZoom:!!b,lockRef:n,gapMode:_}),a?T.cloneElement(T.Children.only(o),_l(_l({},R),{ref:k})):T.createElement(x,_l({},R,{className:l,ref:k}),o))});Y_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Y_.classNames={fullWidth:ix,zeroRight:sx};var J2e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Q2e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=J2e();return t&&e.setAttribute("nonce",t),e}function eEe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function tEe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var nEe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Q2e())&&(eEe(t,n),tEe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},rEe=function(){var e=nEe();return function(t,n){T.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Fq=function(){var e=rEe(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},sEe={left:0,top:0,right:0,gap:0},nT=function(e){return parseInt(e||"",10)||0},iEe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[nT(n),nT(r),nT(s)]},aEe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return sEe;var t=iEe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},oEe=Fq(),Tp="data-scroll-locked",lEe=function(e,t,n,r){var s=e.left,i=e.top,a=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(q2e,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(Tp,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(sx,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(ix,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(sx," .").concat(sx,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(ix," .").concat(ix,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Tp,`] {
    `).concat(V2e,": ").concat(o,`px;
  }
`)},q5=function(){var e=parseInt(document.body.getAttribute(Tp)||"0",10);return isFinite(e)?e:0},cEe=function(){T.useEffect(function(){return document.body.setAttribute(Tp,(q5()+1).toString()),function(){var e=q5()-1;e<=0?document.body.removeAttribute(Tp):document.body.setAttribute(Tp,e.toString())}},[])},uEe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;cEe();var i=T.useMemo(function(){return aEe(s)},[s]);return T.createElement(oEe,{styles:lEe(i,!t,s,n?"":"!important")})},VA=!1;if(typeof window<"u")try{var Ow=Object.defineProperty({},"passive",{get:function(){return VA=!0,!0}});window.addEventListener("test",Ow,Ow),window.removeEventListener("test",Ow,Ow)}catch{VA=!1}var Qh=VA?{passive:!1}:!1,dEe=function(e){return e.tagName==="TEXTAREA"},Lq=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!dEe(e)&&n[t]==="visible")},fEe=function(e){return Lq(e,"overflowY")},hEe=function(e){return Lq(e,"overflowX")},V5=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Bq(e,r);if(s){var i=$q(e,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},pEe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},mEe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Bq=function(e,t){return e==="v"?fEe(t):hEe(t)},$q=function(e,t){return e==="v"?pEe(t):mEe(t)},gEe=function(e,t){return e==="h"&&t==="rtl"?-1:1},yEe=function(e,t,n,r,s){var i=gEe(e,window.getComputedStyle(t).direction),a=i*r,o=n.target,l=t.contains(o),c=!1,u=a>0,f=0,m=0;do{var g=$q(e,o),v=g[0],b=g[1],w=g[2],x=b-w-i*v;(v||x)&&Bq(e,o)&&(f+=x,m+=v),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(f)<1||!u&&Math.abs(m)<1)&&(c=!0),c},Pw=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},H5=function(e){return[e.deltaX,e.deltaY]},G5=function(e){return e&&"current"in e?e.current:e},bEe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},vEe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},wEe=0,ep=[];function xEe(e){var t=T.useRef([]),n=T.useRef([0,0]),r=T.useRef(),s=T.useState(wEe++)[0],i=T.useState(Fq)[0],a=T.useRef(e);T.useEffect(function(){a.current=e},[e]),T.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var b=U2e([e.lockRef.current],(e.shards||[]).map(G5),!0).filter(Boolean);return b.forEach(function(w){return w.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=T.useCallback(function(b,w){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var x=Pw(b),_=n.current,E="deltaX"in b?b.deltaX:_[0]-x[0],C="deltaY"in b?b.deltaY:_[1]-x[1],k,R=b.target,I=Math.abs(E)>Math.abs(C)?"h":"v";if("touches"in b&&I==="h"&&R.type==="range")return!1;var j=V5(I,R);if(!j)return!0;if(j?k=I:(k=I==="v"?"h":"v",j=V5(I,R)),!j)return!1;if(!r.current&&"changedTouches"in b&&(E||C)&&(r.current=k),!k)return!0;var M=r.current||k;return yEe(M,w,b,M==="h"?E:C)},[]),l=T.useCallback(function(b){var w=b;if(!(!ep.length||ep[ep.length-1]!==i)){var x="deltaY"in w?H5(w):Pw(w),_=t.current.filter(function(k){return k.name===w.type&&(k.target===w.target||w.target===k.shadowParent)&&bEe(k.delta,x)})[0];if(_&&_.should){w.cancelable&&w.preventDefault();return}if(!_){var E=(a.current.shards||[]).map(G5).filter(Boolean).filter(function(k){return k.contains(w.target)}),C=E.length>0?o(w,E[0]):!a.current.noIsolation;C&&w.cancelable&&w.preventDefault()}}},[]),c=T.useCallback(function(b,w,x,_){var E={name:b,delta:w,target:x,should:_,shadowParent:_Ee(x)};t.current.push(E),setTimeout(function(){t.current=t.current.filter(function(C){return C!==E})},1)},[]),u=T.useCallback(function(b){n.current=Pw(b),r.current=void 0},[]),f=T.useCallback(function(b){c(b.type,H5(b),b.target,o(b,e.lockRef.current))},[]),m=T.useCallback(function(b){c(b.type,Pw(b),b.target,o(b,e.lockRef.current))},[]);T.useEffect(function(){return ep.push(i),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:m}),document.addEventListener("wheel",l,Qh),document.addEventListener("touchmove",l,Qh),document.addEventListener("touchstart",u,Qh),function(){ep=ep.filter(function(b){return b!==i}),document.removeEventListener("wheel",l,Qh),document.removeEventListener("touchmove",l,Qh),document.removeEventListener("touchstart",u,Qh)}},[]);var g=e.removeScrollBar,v=e.inert;return T.createElement(T.Fragment,null,v?T.createElement(i,{styles:vEe(s)}):null,g?T.createElement(uEe,{gapMode:e.gapMode}):null)}function _Ee(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const SEe=X2e(Dq,xEe);var Ib=T.forwardRef(function(e,t){return T.createElement(Y_,_l({},e,{ref:t,sideCar:SEe}))});Ib.classNames=Y_.classNames;var EEe=[" ","Enter","ArrowUp","ArrowDown"],CEe=[" ","Enter"],Of="Select",[X_,J_,kEe]=G_(Of),[jm,f4e]=Ii(Of,[kEe,pd]),Q_=pd(),[TEe,Cd]=jm(Of),[AEe,REe]=jm(Of),zq=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:f,disabled:m,required:g,form:v}=e,b=Q_(t),[w,x]=T.useState(null),[_,E]=T.useState(null),[C,k]=T.useState(!1),R=Am(c),[I,j]=Lo({prop:r,defaultProp:s??!1,onChange:i,caller:Of}),[M,L]=Lo({prop:a,defaultProp:o,onChange:l,caller:Of}),q=T.useRef(null),P=w?v||!!w.closest("form"):!0,[V,z]=T.useState(new Set),re=Array.from(V).map(K=>K.props.value).join(";");return p.jsx(Q1,{...b,children:p.jsxs(TEe,{required:g,scope:t,trigger:w,onTriggerChange:x,valueNode:_,onValueNodeChange:E,valueNodeHasChildren:C,onValueNodeHasChildrenChange:k,contentId:Qs(),value:M,onValueChange:L,open:I,onOpenChange:j,dir:R,triggerPointerDownPosRef:q,disabled:m,children:[p.jsx(X_.Provider,{scope:t,children:p.jsx(AEe,{scope:e.__scopeSelect,onNativeOptionAdd:T.useCallback(K=>{z(ee=>new Set(ee).add(K))},[]),onNativeOptionRemove:T.useCallback(K=>{z(ee=>{const W=new Set(ee);return W.delete(K),W})},[]),children:n})}),P?p.jsxs(cV,{"aria-hidden":!0,required:g,tabIndex:-1,name:u,autoComplete:f,value:M,onChange:K=>L(K.target.value),disabled:m,form:v,children:[M===void 0?p.jsx("option",{value:""}):null,Array.from(V)]},re):null]})})};zq.displayName=Of;var Uq="SelectTrigger",qq=T.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=Q_(n),a=Cd(Uq,n),o=a.disabled||r,l=Nn(t,a.onTriggerChange),c=J_(n),u=T.useRef("touch"),[f,m,g]=dV(b=>{const w=c().filter(E=>!E.disabled),x=w.find(E=>E.value===a.value),_=fV(w,b,x);_!==void 0&&a.onValueChange(_.value)}),v=b=>{o||(a.onOpenChange(!0),g()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return p.jsx(Wy,{asChild:!0,...i,children:p.jsx(sn.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":uV(a.value)?"":void 0,...s,ref:l,onClick:Ut(s.onClick,b=>{b.currentTarget.focus(),u.current!=="mouse"&&v(b)}),onPointerDown:Ut(s.onPointerDown,b=>{u.current=b.pointerType;const w=b.target;w.hasPointerCapture(b.pointerId)&&w.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(v(b),b.preventDefault())}),onKeyDown:Ut(s.onKeyDown,b=>{const w=f.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&m(b.key),!(w&&b.key===" ")&&EEe.includes(b.key)&&(v(),b.preventDefault())})})})});qq.displayName=Uq;var Vq="SelectValue",Hq=T.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:a="",...o}=e,l=Cd(Vq,n),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,f=Nn(t,l.onValueNodeChange);return mi(()=>{c(u)},[c,u]),p.jsx(sn.span,{...o,ref:f,style:{pointerEvents:"none"},children:uV(l.value)?p.jsx(p.Fragment,{children:a}):i})});Hq.displayName=Vq;var NEe="SelectIcon",Gq=T.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return p.jsx(sn.span,{"aria-hidden":!0,...s,ref:t,children:r||""})});Gq.displayName=NEe;var IEe="SelectPortal",Kq=e=>p.jsx(fm,{asChild:!0,...e});Kq.displayName=IEe;var Pf="SelectContent",Wq=T.forwardRef((e,t)=>{const n=Cd(Pf,e.__scopeSelect),[r,s]=T.useState();if(mi(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?ko.createPortal(p.jsx(Zq,{scope:e.__scopeSelect,children:p.jsx(X_.Slot,{scope:e.__scopeSelect,children:p.jsx("div",{children:e.children})})}),i):null}return p.jsx(Yq,{...e,ref:t})});Wq.displayName=Pf;var Eo=10,[Zq,kd]=jm(Pf),jEe="SelectContentImpl",MEe=zu("SelectContent.RemoveScroll"),Yq=T.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:g,sticky:v,hideWhenDetached:b,avoidCollisions:w,...x}=e,_=Cd(Pf,n),[E,C]=T.useState(null),[k,R]=T.useState(null),I=Nn(t,Pe=>C(Pe)),[j,M]=T.useState(null),[L,q]=T.useState(null),P=J_(n),[V,z]=T.useState(!1),re=T.useRef(!1);T.useEffect(()=>{if(E)return Z_(E)},[E]),K_();const K=T.useCallback(Pe=>{const[Ie,...Ce]=P().map(Ge=>Ge.ref.current),[He]=Ce.slice(-1),it=document.activeElement;for(const Ge of Pe)if(Ge===it||(Ge==null||Ge.scrollIntoView({block:"nearest"}),Ge===Ie&&k&&(k.scrollTop=0),Ge===He&&k&&(k.scrollTop=k.scrollHeight),Ge==null||Ge.focus(),document.activeElement!==it))return},[P,k]),ee=T.useCallback(()=>K([j,E]),[K,j,E]);T.useEffect(()=>{V&&ee()},[V,ee]);const{onOpenChange:W,triggerPointerDownPosRef:se}=_;T.useEffect(()=>{if(E){let Pe={x:0,y:0};const Ie=He=>{var it,Ge;Pe={x:Math.abs(Math.round(He.pageX)-(((it=se.current)==null?void 0:it.x)??0)),y:Math.abs(Math.round(He.pageY)-(((Ge=se.current)==null?void 0:Ge.y)??0))}},Ce=He=>{Pe.x<=10&&Pe.y<=10?He.preventDefault():E.contains(He.target)||W(!1),document.removeEventListener("pointermove",Ie),se.current=null};return se.current!==null&&(document.addEventListener("pointermove",Ie),document.addEventListener("pointerup",Ce,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Ie),document.removeEventListener("pointerup",Ce,{capture:!0})}}},[E,W,se]),T.useEffect(()=>{const Pe=()=>W(!1);return window.addEventListener("blur",Pe),window.addEventListener("resize",Pe),()=>{window.removeEventListener("blur",Pe),window.removeEventListener("resize",Pe)}},[W]);const[Y,te]=dV(Pe=>{const Ie=P().filter(it=>!it.disabled),Ce=Ie.find(it=>it.ref.current===document.activeElement),He=fV(Ie,Pe,Ce);He&&setTimeout(()=>He.ref.current.focus())}),Q=T.useCallback((Pe,Ie,Ce)=>{const He=!re.current&&!Ce;(_.value!==void 0&&_.value===Ie||He)&&(M(Pe),He&&(re.current=!0))},[_.value]),ae=T.useCallback(()=>E==null?void 0:E.focus(),[E]),xe=T.useCallback((Pe,Ie,Ce)=>{const He=!re.current&&!Ce;(_.value!==void 0&&_.value===Ie||He)&&q(Pe)},[_.value]),ge=r==="popper"?HA:Xq,Me=ge===HA?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:g,sticky:v,hideWhenDetached:b,avoidCollisions:w}:{};return p.jsx(Zq,{scope:n,content:E,viewport:k,onViewportChange:R,itemRefCallback:Q,selectedItem:j,onItemLeave:ae,itemTextRefCallback:xe,focusSelectedItem:ee,selectedItemText:L,position:r,isPositioned:V,searchRef:Y,children:p.jsx(Ib,{as:MEe,allowPinchZoom:!0,children:p.jsx(Nb,{asChild:!0,trapped:_.open,onMountAutoFocus:Pe=>{Pe.preventDefault()},onUnmountAutoFocus:Ut(s,Pe=>{var Ie;(Ie=_.trigger)==null||Ie.focus({preventScroll:!0}),Pe.preventDefault()}),children:p.jsx(cm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:Pe=>Pe.preventDefault(),onDismiss:()=>_.onOpenChange(!1),children:p.jsx(ge,{role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:Pe=>Pe.preventDefault(),...x,...Me,onPlaced:()=>z(!0),ref:I,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Ut(x.onKeyDown,Pe=>{const Ie=Pe.ctrlKey||Pe.altKey||Pe.metaKey;if(Pe.key==="Tab"&&Pe.preventDefault(),!Ie&&Pe.key.length===1&&te(Pe.key),["ArrowUp","ArrowDown","Home","End"].includes(Pe.key)){let He=P().filter(it=>!it.disabled).map(it=>it.ref.current);if(["ArrowUp","End"].includes(Pe.key)&&(He=He.slice().reverse()),["ArrowUp","ArrowDown"].includes(Pe.key)){const it=Pe.target,Ge=He.indexOf(it);He=He.slice(Ge+1)}setTimeout(()=>K(He)),Pe.preventDefault()}})})})})})})});Yq.displayName=jEe;var OEe="SelectItemAlignedPosition",Xq=T.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=Cd(Pf,n),a=kd(Pf,n),[o,l]=T.useState(null),[c,u]=T.useState(null),f=Nn(t,I=>u(I)),m=J_(n),g=T.useRef(!1),v=T.useRef(!0),{viewport:b,selectedItem:w,selectedItemText:x,focusSelectedItem:_}=a,E=T.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&b&&w&&x){const I=i.trigger.getBoundingClientRect(),j=c.getBoundingClientRect(),M=i.valueNode.getBoundingClientRect(),L=x.getBoundingClientRect();if(i.dir!=="rtl"){const it=L.left-j.left,Ge=M.left-it,Re=I.left-Ge,H=I.width+Re,me=Math.max(H,j.width),Te=window.innerWidth-Eo,ce=ky(Ge,[Eo,Math.max(Eo,Te-me)]);o.style.minWidth=H+"px",o.style.left=ce+"px"}else{const it=j.right-L.right,Ge=window.innerWidth-M.right-it,Re=window.innerWidth-I.right-Ge,H=I.width+Re,me=Math.max(H,j.width),Te=window.innerWidth-Eo,ce=ky(Ge,[Eo,Math.max(Eo,Te-me)]);o.style.minWidth=H+"px",o.style.right=ce+"px"}const q=m(),P=window.innerHeight-Eo*2,V=b.scrollHeight,z=window.getComputedStyle(c),re=parseInt(z.borderTopWidth,10),K=parseInt(z.paddingTop,10),ee=parseInt(z.borderBottomWidth,10),W=parseInt(z.paddingBottom,10),se=re+K+V+W+ee,Y=Math.min(w.offsetHeight*5,se),te=window.getComputedStyle(b),Q=parseInt(te.paddingTop,10),ae=parseInt(te.paddingBottom,10),xe=I.top+I.height/2-Eo,ge=P-xe,Me=w.offsetHeight/2,Pe=w.offsetTop+Me,Ie=re+K+Pe,Ce=se-Ie;if(Ie<=xe){const it=q.length>0&&w===q[q.length-1].ref.current;o.style.bottom="0px";const Ge=c.clientHeight-b.offsetTop-b.offsetHeight,Re=Math.max(ge,Me+(it?ae:0)+Ge+ee),H=Ie+Re;o.style.height=H+"px"}else{const it=q.length>0&&w===q[0].ref.current;o.style.top="0px";const Re=Math.max(xe,re+b.offsetTop+(it?Q:0)+Me)+Ce;o.style.height=Re+"px",b.scrollTop=Ie-xe+b.offsetTop}o.style.margin=`${Eo}px 0`,o.style.minHeight=Y+"px",o.style.maxHeight=P+"px",r==null||r(),requestAnimationFrame(()=>g.current=!0)}},[m,i.trigger,i.valueNode,o,c,b,w,x,i.dir,r]);mi(()=>E(),[E]);const[C,k]=T.useState();mi(()=>{c&&k(window.getComputedStyle(c).zIndex)},[c]);const R=T.useCallback(I=>{I&&v.current===!0&&(E(),_==null||_(),v.current=!1)},[E,_]);return p.jsx(DEe,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:g,onScrollButtonChange:R,children:p.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C},children:p.jsx(sn.div,{...s,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Xq.displayName=OEe;var PEe="SelectPopperPosition",HA=T.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Eo,...i}=e,a=Q_(n);return p.jsx(e_,{...a,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});HA.displayName=PEe;var[DEe,DI]=jm(Pf,{}),GA="SelectViewport",Jq=T.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=kd(GA,n),a=DI(GA,n),o=Nn(t,i.onViewportChange),l=T.useRef(0);return p.jsxs(p.Fragment,{children:[p.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),p.jsx(X_.Slot,{scope:n,children:p.jsx(sn.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Ut(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:m}=a;if(m!=null&&m.current&&f){const g=Math.abs(l.current-u.scrollTop);if(g>0){const v=window.innerHeight-Eo*2,b=parseFloat(f.style.minHeight),w=parseFloat(f.style.height),x=Math.max(b,w);if(x<v){const _=x+g,E=Math.min(v,_),C=_-E;f.style.height=E+"px",f.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,f.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});Jq.displayName=GA;var Qq="SelectGroup",[FEe,LEe]=jm(Qq),BEe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=Qs();return p.jsx(FEe,{scope:n,id:s,children:p.jsx(sn.div,{role:"group","aria-labelledby":s,...r,ref:t})})});BEe.displayName=Qq;var eV="SelectLabel",$Ee=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=LEe(eV,n);return p.jsx(sn.div,{id:s.id,...r,ref:t})});$Ee.displayName=eV;var E1="SelectItem",[zEe,tV]=jm(E1),nV=T.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...a}=e,o=Cd(E1,n),l=kd(E1,n),c=o.value===r,[u,f]=T.useState(i??""),[m,g]=T.useState(!1),v=Nn(t,_=>{var E;return(E=l.itemRefCallback)==null?void 0:E.call(l,_,r,s)}),b=Qs(),w=T.useRef("touch"),x=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return p.jsx(zEe,{scope:n,value:r,disabled:s,textId:b,isSelected:c,onItemTextChange:T.useCallback(_=>{f(E=>E||((_==null?void 0:_.textContent)??"").trim())},[]),children:p.jsx(X_.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:p.jsx(sn.div,{role:"option","aria-labelledby":b,"data-highlighted":m?"":void 0,"aria-selected":c&&m,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:v,onFocus:Ut(a.onFocus,()=>g(!0)),onBlur:Ut(a.onBlur,()=>g(!1)),onClick:Ut(a.onClick,()=>{w.current!=="mouse"&&x()}),onPointerUp:Ut(a.onPointerUp,()=>{w.current==="mouse"&&x()}),onPointerDown:Ut(a.onPointerDown,_=>{w.current=_.pointerType}),onPointerMove:Ut(a.onPointerMove,_=>{var E;w.current=_.pointerType,s?(E=l.onItemLeave)==null||E.call(l):w.current==="mouse"&&_.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ut(a.onPointerLeave,_=>{var E;_.currentTarget===document.activeElement&&((E=l.onItemLeave)==null||E.call(l))}),onKeyDown:Ut(a.onKeyDown,_=>{var C;((C=l.searchRef)==null?void 0:C.current)!==""&&_.key===" "||(CEe.includes(_.key)&&x(),_.key===" "&&_.preventDefault())})})})})});nV.displayName=E1;var o0="SelectItemText",rV=T.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,a=Cd(o0,n),o=kd(o0,n),l=tV(o0,n),c=REe(o0,n),[u,f]=T.useState(null),m=Nn(t,x=>f(x),l.onItemTextChange,x=>{var _;return(_=o.itemTextRefCallback)==null?void 0:_.call(o,x,l.value,l.disabled)}),g=u==null?void 0:u.textContent,v=T.useMemo(()=>p.jsx("option",{value:l.value,disabled:l.disabled,children:g},l.value),[l.disabled,l.value,g]),{onNativeOptionAdd:b,onNativeOptionRemove:w}=c;return mi(()=>(b(v),()=>w(v)),[b,w,v]),p.jsxs(p.Fragment,{children:[p.jsx(sn.span,{id:l.textId,...i,ref:m}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?ko.createPortal(i.children,a.valueNode):null]})});rV.displayName=o0;var sV="SelectItemIndicator",iV=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return tV(sV,n).isSelected?p.jsx(sn.span,{"aria-hidden":!0,...r,ref:t}):null});iV.displayName=sV;var KA="SelectScrollUpButton",aV=T.forwardRef((e,t)=>{const n=kd(KA,e.__scopeSelect),r=DI(KA,e.__scopeSelect),[s,i]=T.useState(!1),a=Nn(t,r.onScrollButtonChange);return mi(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;i(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?p.jsx(lV,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});aV.displayName=KA;var WA="SelectScrollDownButton",oV=T.forwardRef((e,t)=>{const n=kd(WA,e.__scopeSelect),r=DI(WA,e.__scopeSelect),[s,i]=T.useState(!1),a=Nn(t,r.onScrollButtonChange);return mi(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?p.jsx(lV,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});oV.displayName=WA;var lV=T.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=kd("SelectScrollButton",n),a=T.useRef(null),o=J_(n),l=T.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return T.useEffect(()=>()=>l(),[l]),mi(()=>{var u;const c=o().find(f=>f.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),p.jsx(sn.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Ut(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Ut(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Ut(s.onPointerLeave,()=>{l()})})}),UEe="SelectSeparator",qEe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return p.jsx(sn.div,{"aria-hidden":!0,...r,ref:t})});qEe.displayName=UEe;var ZA="SelectArrow",VEe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=Q_(n),i=Cd(ZA,n),a=kd(ZA,n);return i.open&&a.position==="popper"?p.jsx(t_,{...s,...r,ref:t}):null});VEe.displayName=ZA;var HEe="SelectBubbleInput",cV=T.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=T.useRef(null),i=Nn(r,s),a=W_(t);return T.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const f=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(f)}},[a,t]),p.jsx(sn.select,{...n,style:{...j9,...n.style},ref:i,defaultValue:t})});cV.displayName=HEe;function uV(e){return e===""||e===void 0}function dV(e){const t=Xs(e),n=T.useRef(""),r=T.useRef(0),s=T.useCallback(a=>{const o=n.current+a;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),i=T.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return T.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function fV(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=GEe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function GEe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var KEe=zq,WEe=qq,ZEe=Hq,YEe=Gq,XEe=Kq,JEe=Wq,QEe=Jq,eCe=nV,tCe=rV,nCe=iV,rCe=aV,sCe=oV;function jb({...e}){return p.jsx(KEe,{"data-slot":"select",...e})}function Mb({...e}){return p.jsx(ZEe,{"data-slot":"select-value",...e})}function Ob({className:e,size:t="default",children:n,...r}){return p.jsxs(WEe,{"data-slot":"select-trigger","data-size":t,className:ct("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,p.jsx(YEe,{asChild:!0,children:p.jsx(Fl,{className:"size-4 opacity-50"})})]})}function Pb({className:e,children:t,position:n="popper",...r}){return p.jsx(XEe,{children:p.jsxs(JEe,{"data-slot":"select-content",className:ct("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[p.jsx(iCe,{}),p.jsx(QEe,{className:ct("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),p.jsx(aCe,{})]})})}function ld({className:e,children:t,...n}){return p.jsxs(eCe,{"data-slot":"select-item",className:ct("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[p.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:p.jsx(nCe,{children:p.jsx(Ui,{className:"size-4"})})}),p.jsx(tCe,{children:t})]})}function iCe({className:e,...t}){return p.jsx(rCe,{"data-slot":"select-scroll-up-button",className:ct("flex cursor-default items-center justify-center py-1",e),...t,children:p.jsx(fd,{className:"size-4"})})}function aCe({className:e,...t}){return p.jsx(sCe,{"data-slot":"select-scroll-down-button",className:ct("flex cursor-default items-center justify-center py-1",e),...t,children:p.jsx(Fl,{className:"size-4"})})}var oCe="Label",hV=T.forwardRef((e,t)=>p.jsx(sn.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));hV.displayName=oCe;var lCe=hV;function Jt({className:e,...t}){return p.jsx(lCe,{"data-slot":"label",className:ct("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const js=({field:e,className:t})=>e.state.meta.isTouched&&e.state.meta.errors.length>0?p.jsx("em",{className:`text-xs text-destructive mt-1 block ${t||""}`,children:e.state.meta.errors.map(r=>typeof r=="string"?r:typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"?r.message:(console.warn("[GlobalFieldMetaMessages] Encountered an unexpected error structure:",r),"Validation error")).join(", ")}):null,cCe=na.map(e=>e.value),Dw=D.object({keyName:D.string().min(1,"Key Name is required."),providerType:D.enum(cCe,{errorMap:()=>({message:"Provider Type is required."})}),keyValue:D.string().min(1,"API Key Value is required.")}),pV=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:s,disabled:i=!1,className:a})=>{const o=T.useRef(null),l=ri({defaultValues:{keyName:t,providerType:e,keyValue:n},validators:{onChangeAsync:Dw,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{await r(u.keyName,u.providerType,u.keyValue)}});T.useEffect(()=>{l.reset({keyName:t,providerType:e,keyValue:n})},[t,n,e,l]);const c=(u,f)=>{var b,w;if(!u)return;const m=(b=na.find(x=>x.value===u))==null?void 0:b.label,g=l.getFieldValue("providerType"),v=(w=na.find(x=>x.value===g))==null?void 0:w.label;m&&(!(f!=null&&f.trim())||f===v)&&l.setFieldValue("keyName",m),requestAnimationFrame(()=>{var x;(x=o.current)==null||x.focus()})};return p.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:ct("space-y-6",a),children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsx(l.Field,{name:"providerType",validators:{onChange:Dw.shape.providerType},children:u=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:u.name,children:"Provider Type"}),p.jsxs(jb,{value:u.state.value??"",onValueChange:f=>{const m=f;u.handleChange(m),u.handleBlur(),c(m,l.getFieldValue("keyName"))},disabled:i||l.state.isSubmitting,children:[p.jsx(Ob,{id:u.name,children:p.jsx(Mb,{placeholder:"Select Provider Type"})}),p.jsx(Pb,{children:na.map(f=>p.jsx(ld,{value:f.value,children:f.label},f.value))})]}),p.jsx(js,{field:u})]})}),p.jsx(l.Field,{name:"keyName",validators:{onChange:Dw.shape.keyName},children:u=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:u.name,children:"Key Name"}),p.jsx(zn,{id:u.name,value:u.state.value??"",onChange:f=>u.handleChange(f.target.value),onBlur:u.handleBlur,placeholder:"e.g., My OpenAI Key",disabled:i||l.state.isSubmitting}),p.jsx(js,{field:u})]})}),p.jsx(l.Field,{name:"keyValue",validators:{onChange:Dw.shape.keyValue},children:u=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:u.name,children:"API Key Value"}),p.jsx(zn,{ref:o,id:u.name,type:"password",value:u.state.value??"",onChange:f=>u.handleChange(f.target.value),onBlur:u.handleBlur,placeholder:"Enter your API key",disabled:i||l.state.isSubmitting,autoComplete:"new-password"}),p.jsx(js,{field:u})]})})]}),p.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[p.jsxs(Ct,{variant:"ghost",size:"sm",onClick:s,disabled:i||l.state.isSubmitting,type:"button",children:[p.jsx(la,{className:"h-4 w-4 mr-1"})," Cancel"]}),p.jsx(l.Subscribe,{selector:u=>[u.canSubmit,u.isSubmitting,u.isValidating,u.isValid],children:([u,f,m,g])=>p.jsxs(Ct,{type:"submit",size:"sm",disabled:i||!u||f||m||!g,children:[(f||m)&&p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}),p.jsx(hd,{className:"h-4 w-4 mr-1"}),f||m?"Saving...":"Save API Key"]})})]})]})},uCe=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:s,disabled:i=!1})=>{var c;const a=u=>{r(u==="none"?null:u)},o=(c=s.find(u=>u.id===n))==null?void 0:c.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return p.jsxs(jb,{value:n??"none",onValueChange:a,disabled:i||s.length===0,children:[p.jsx(Ob,{className:ct("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:p.jsx(Mb,{asChild:!0,children:p.jsxs("div",{className:"flex items-center overflow-hidden",children:[p.jsx(k0,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),p.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&p.jsxs("span",{className:"mr-1",children:[t,":"]}),s.length===0?p.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),p.jsxs(Pb,{className:"bg-popover border-border text-popover-foreground",children:[p.jsx(ld,{value:"none",children:p.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(u=>p.jsx(ld,{value:u.id,children:u.name||`Key ID: ${u.id.substring(0,6)}...`},u.id))]})]})};function Py({form:e,name:t,label:n,type:r="text",placeholder:s,disabled:i,wrapperClassName:a,className:o,...l}){return p.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="string"||typeof c.state.value=="number"?String(c.state.value):"";return p.jsxs("div",{className:ct("space-y-1.5",a),children:[p.jsx(Jt,{htmlFor:c.name,className:"text-sm",children:n}),p.jsx(zn,{id:c.name,name:c.name,type:r,value:u,onBlur:c.handleBlur,onChange:f=>c.handleChange(f.target.value),placeholder:s,disabled:i??c.form.state.isSubmitting,className:ct(o,c.state.meta.errors.length?"border-destructive":""),...l}),p.jsx(js,{field:c})]})}})}function x0({form:e,name:t,label:n,options:r,placeholder:s,disabled:i,wrapperClassName:a,triggerClassName:o,contentClassName:l,...c}){return console.log("SelectField",t),p.jsx(e.Field,{name:t,children:u=>{const f=u.state.value!==null&&u.state.value!==void 0?String(u.state.value):"";return p.jsxs("div",{className:ct("space-y-1.5",a),children:[p.jsx(Jt,{htmlFor:u.name,className:"text-sm",children:n}),p.jsxs(jb,{value:f,onValueChange:m=>u.handleChange(m),disabled:i??u.form.state.isSubmitting,...c,children:[p.jsx(Ob,{id:u.name,onBlur:u.handleBlur,className:ct(o,u.state.meta.errors.length?"border-destructive":""),children:p.jsx(Mb,{placeholder:s})}),p.jsx(Pb,{className:l,children:r.map(m=>p.jsx(ld,{value:String(m.value),disabled:m.disabled,children:m.label},m.value))})]}),p.jsx(js,{field:u})]})}})}var eS="Switch",[dCe,h4e]=Ii(eS),[fCe,hCe]=dCe(eS),mV=T.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...f}=e,[m,g]=T.useState(null),v=Nn(t,E=>g(E)),b=T.useRef(!1),w=m?u||!!m.closest("form"):!0,[x,_]=Lo({prop:s,defaultProp:i??!1,onChange:c,caller:eS});return p.jsxs(fCe,{scope:n,checked:x,disabled:o,children:[p.jsx(sn.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":vV(x),"data-disabled":o?"":void 0,disabled:o,value:l,...f,ref:v,onClick:Ut(e.onClick,E=>{_(C=>!C),w&&(b.current=E.isPropagationStopped(),b.current||E.stopPropagation())})}),w&&p.jsx(bV,{control:m,bubbles:!b.current,name:r,value:l,checked:x,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});mV.displayName=eS;var gV="SwitchThumb",yV=T.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=hCe(gV,n);return p.jsx(sn.span,{"data-state":vV(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});yV.displayName=gV;var pCe="SwitchBubbleInput",bV=T.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=T.useRef(null),o=Nn(a,i),l=W_(n),c=J1(t);return T.useEffect(()=>{const u=a.current;if(!u)return;const f=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(f,"checked").set;if(l!==n&&g){const v=new Event("click",{bubbles:r});g.call(u,n),u.dispatchEvent(v)}},[l,n,r]),p.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});bV.displayName=pCe;function vV(e){return e?"checked":"unchecked"}var mCe=mV,gCe=yV;function Bu({className:e,...t}){return p.jsx(mCe,{"data-slot":"switch",className:ct("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:p.jsx(gCe,{"data-slot":"switch-thumb",className:ct("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function ff({form:e,name:t,label:n,description:r,disabled:s,wrapperClassName:i,className:a,labelClassName:o,...l}){return p.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="boolean"?c.state.value:!1;return p.jsxs("div",{className:ct("space-y-1.5",i),children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx(Jt,{htmlFor:c.name,className:ct("text-sm font-medium leading-none cursor-pointer",o),children:n}),p.jsx(Bu,{id:c.name,name:c.name,checked:u,onCheckedChange:f=>c.handleChange(f),onBlur:c.handleBlur,disabled:s??c.form.state.isSubmitting,className:ct(a,c.state.meta.errors.length?"border-destructive":""),...l})]}),r&&p.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:r}),p.jsx(js,{field:c})]})}})}const yCe=na.map(e=>e.value),bCe=D.object({name:D.string().min(1,"Provider Name is required."),type:D.enum(yCe,{errorMap:()=>({message:"Provider Type is required."})}),isEnabled:D.boolean(),apiKeyId:D.string().nullable(),baseURL:D.string().url().nullable().or(D.literal("")),autoFetchModels:D.boolean()}).refine(e=>Px(e.type)?!(!e.baseURL||e.baseURL.trim()===""):!0,{message:"Base URL is required and must be a valid URL for this provider type.",path:["baseURL"]}).refine(e=>Pp(e.type)?!!e.apiKeyId:!0,{message:"API Key is required for this provider type.",path:["apiKeyId"]}),vCe=na.map(e=>({value:e.value,label:e.label})),wV=({initialData:e,onSubmit:t,onChange:n,onCancel:r,apiKeys:s,isSavingExt:i=!1,disabled:a=!1,className:o})=>{var w;const l=ri({defaultValues:{name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||((w=na[0])==null?void 0:w.value),isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??!1},validators:{onChangeAsync:bCe,onChangeAsyncDebounceMs:500},onSubmit:async({value:x})=>{const _={...x,baseURL:(x.baseURL===null||typeof x.baseURL=="string"&&x.baseURL.trim()==="")&&!Px(x.type)?null:x.baseURL};await t(_)}}),c=T.useRef(l.state.values);T.useEffect(()=>{const x=l.store.subscribe(()=>{const _=l.state.values,E=c.current;if(n&&E)for(const C in _){const k=C;_[k]!==E[k]&&n(k,_[k])}c.current={..._}});return l.state.values!==c.current&&(c.current=l.state.values),x},[l,n]),T.useEffect(()=>{var E,C;const x=(e==null?void 0:e.type)||((E=na[0])==null?void 0:E.value),_={name:(e==null?void 0:e.name)||((C=na.find(k=>k.value===x))==null?void 0:C.label)||"",type:x,isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??xf(x)};l.reset(_),c.current=_},[e]);const u=l.state.values.type,f=Pp(u??null),m=Px(u??null),g=xf(u??null),v=T.useCallback(x=>{var E,C;if(!x)return;const _=l.state.values.type;if(x!==_){l.setFieldValue("apiKeyId",null),l.setFieldValue("baseURL",null),l.setFieldValue("autoFetchModels",xf(x));const k=(E=na.find(j=>j.value===x))==null?void 0:E.label,R=(C=na.find(j=>j.value===_))==null?void 0:C.label,I=l.state.values.name;k&&(!(I!=null&&I.trim())||I===R)&&l.setFieldValue("name",k)}},[l]);T.useEffect(()=>{const x=l.state.values.type;x!==void 0&&v(x)},[l.state.values.type,v]);const b=(s||[]).filter(x=>!u||x.providerId===u);return p.jsxs("form",{onSubmit:x=>{x.preventDefault(),x.stopPropagation(),l.handleSubmit()},className:ct("space-y-4 border rounded-md p-4 bg-card shadow-sm",o),children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3",children:[p.jsx(x0,{form:l,name:"type",label:"Provider Type",options:vCe,disabled:a||i,placeholder:"Select Type",wrapperClassName:"md:col-span-1"}),p.jsx(Py,{form:l,name:"name",label:"Provider Name",placeholder:"e.g., My Ollama",disabled:a||i,"aria-label":"Provider Name",wrapperClassName:"md:col-span-1"}),f&&p.jsx(l.Field,{name:"apiKeyId",children:x=>p.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[p.jsx(Jt,{htmlFor:`${x.name}-trigger`,children:"API Key"})," ",p.jsx(uCe,{selectedKeyId:x.state.value??null,onKeySelected:_=>{x.handleChange(_),x.handleBlur()},apiKeys:b,disabled:a||i||!u}),p.jsx(js,{field:x})]})}),m&&p.jsx(Py,{form:l,name:"baseURL",label:"Base URL",placeholder:"e.g., http://localhost:11434",type:"url",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),g&&p.jsx(ff,{form:l,name:"autoFetchModels",label:"Auto-Fetch Models",description:"Automatically fetch and update the list of available models from this provider.",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),p.jsx(ff,{form:l,name:"isEnabled",label:"Enable Provider",description:"Allow this provider to be used for generating responses.",disabled:a||i,wrapperClassName:"md:col-span-2"})]}),p.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[p.jsxs(Ct,{variant:"ghost",size:"sm",onClick:r,disabled:a||i,type:"button",children:[p.jsx(la,{className:"h-4 w-4 mr-1"})," Cancel"]}),p.jsx(l.Subscribe,{selector:x=>[x.canSubmit,x.isSubmitting,x.isValidating,x.isValid],children:([x,_,E,C])=>p.jsxs(Ct,{type:"submit",size:"sm",disabled:a||i||!x||_||!C||E,children:[(i||_||E)&&p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}),p.jsx(hd,{className:"h-4 w-4 mr-1"})," ",i||_||E?"Saving...":e!=null&&e.name?"Save Changes":"Add Provider"]})})]})]})},xV=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:s="",initialApiKeyId:i=null})=>{const[a,o]=T.useState(!1),[l,c]=T.useState({name:s,type:r,isEnabled:!0,apiKeyId:i,baseURL:null,autoFetchModels:xf(r)});T.useEffect(()=>{c(m=>({...m,name:s||m.name||"",type:r||m.type||null,apiKeyId:i||m.apiKeyId||null,autoFetchModels:!1}))},[s,r,i]);const u=T.useCallback((m,g)=>new Promise(v=>{c(b=>{var _,E;const w={...b,[m]:g},x=b.name||"";if(m==="type"){const C=g,k=(_=na.find(I=>I.value===b.type))==null?void 0:_.label;w.apiKeyId=null,w.baseURL=null,w.autoFetchModels=C?xf(C):!1;const R=(E=na.find(I=>I.value===C))==null?void 0:E.label;if(R&&(!x.trim()||x===k)&&(w.name=R),C&&Pp(C)){const I=(e||[]).filter(j=>j.providerId===C);I.length>0&&(w.apiKeyId=I[0].id)}}return w}),v(void 0)}),[e]),f=T.useCallback(async()=>{var m,g;if(!((m=l.name)!=null&&m.trim())||!l.type){Le.error("Provider Name and Type are required.");return}o(!0);try{const v=l.type,b=l.autoFetchModels??xf(v),w={name:l.name.trim(),type:v,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((g=l.baseURL)==null?void 0:g.trim())||null,enabledModels:null,autoFetchModels:b,fetchedModels:null,modelsLastFetchedAt:null};await t(w),n()}catch(v){console.error("Failed to add provider (from form component):",v)}finally{o(!1)}},[l,t,n]);return p.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[p.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),p.jsx(wV,{initialData:l,onSubmit:f,onCancel:n,onChange:u,apiKeys:e,disabled:a})]})},cf=dt.forwardRef(({className:e,href:t,children:n,...r},s)=>p.jsx("a",{ref:s,href:t,target:"_blank",rel:"noopener noreferrer",className:ct("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));cf.displayName="Lnk";const wCe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[p.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:p.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),p.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[p.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),p.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),p.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[p.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),p.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),p.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:p.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})},xCe=uR("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Ap({className:e,variant:t,asChild:n=!1,...r}){const s=n?B8:"span";return p.jsx(s,{"data-slot":"badge",className:ct(xCe({variant:t}),e),...r})}const _Ce=()=>{const[e,t]=T.useState(!1);T.useEffect(()=>{t(!0)},[]);const n={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},r={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{duration:.5}}},s=[{word:"LiteChat",color:"bg-gradient-to-tr from-lime-500 via-amber-400 to-red-600 bg-clip-text text-transparent"},{word:"library",color:"text-emerald-500"},{word:"browser",color:"text-violet-500"},{word:"local",color:"text-amber-500"},{word:"remote",color:"text-sky-500"},{word:"providers",color:"text-purple-500"},{word:" AI ",color:"bg-gradient-to-b from-amber-300 to-rose-700 bg-clip-text text-transparent"},{word:"Open Source",color:"bg-gradient-to-r from-lime-500 to-yellow-500 bg-clip-text text-transparent"}],i=o=>{let l=[o];return s.forEach(({word:c,color:u})=>{l=l.reduce((f,m)=>typeof m!="string"?(f.push(m),f):(m.split(new RegExp(`(${c})`,"gi")).forEach((v,b)=>{v.toLowerCase()===c.toLowerCase()?f.push(p.jsx("span",{className:`${u} font-medium`,children:v},`${v}-${b}`)):f.push(v)}),f),[])}),l=l.reduce((c,u,f)=>{if(typeof u!="string")return c.push(u),c;const m=/(\([^)]*\))/g;return u.split(m).forEach((v,b)=>{m.test(v)?c.push(p.jsx("span",{className:"text-sm text-muted",children:v},`paren-${f}-${b}`)):c.push(v)}),c},[]),l},a=["Oh, hey?! Hi there!! How are you doing!?","Nice of you to pop by to checkout LiteChat!","What'd you mean you don't know what LiteChat is? Oh Boy hey, you in for a treat!","To start with, it's an(other) AI chat app (yes...shocker, right ?) and it's Open Source ! ","But, it is also an extensible library, so you can go on and create your own, AI chat app! With your own functionnalities !","(are AI chat apps the new JS frameworks?)","And cause I might be a wee bit on the reluctant side when it comes to parting with my coins, it doesn't require no servers! It all stays in your browser.","(that means I couldn't snoop on what you do here, even if I wanted to!)","While able to run LLM both local (did I tell you I ain't liking throwing coins out?) and from remote providers","(but sometimes you have to :(..)","To cap things off, there is no fancy/crazy tech involved, I just glued bricks together with AI","(kids call it vibing apparently ^^)","Enough of this interminable babble! Go setup your future chat to prompt your brains out!"];return p.jsxs(vl.div,{className:"text-center max-w-4xl mx-auto space-y-3 my-6",initial:"hidden",animate:e?"show":"hidden",variants:n,children:[p.jsx("div",{className:"flex justify-center mb-4",children:p.jsxs(Ap,{variant:"outline",className:"px-3 py-1 bg-black/5 dark:bg-white/10 backdrop-blur-sm border-none",children:[p.jsx(uF,{className:"w-4 h-4 mr-2 text-yellow-500"}),p.jsx("span",{className:"text-sm",children:"Welcome to your future AI chat"})]})}),a.map((o,l)=>p.jsx(vl.p,{className:`text-sm md:text-base ${l===0?"font-medium":""} leading-relaxed`,variants:r,children:i(o)},l)),p.jsxs(vl.div,{variants:r,className:"pt-2",children:[p.jsx(Ap,{className:"bg-gradient-to-r from-violet-600 to-primary border-none",children:"No server required!"}),p.jsx(Ap,{className:"ml-2 bg-gradient-to-r from-amber-500 to-emerald-500 border-none",children:"100% in-browser"})]})]})};var FI="Progress",LI=100,[SCe,p4e]=Ii(FI),[ECe,CCe]=SCe(FI),_V=T.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=kCe,...a}=e;(s||s===0)&&!K5(s)&&console.error(TCe(`${s}`,"Progress"));const o=K5(s)?s:LI;r!==null&&!W5(r,o)&&console.error(ACe(`${r}`,"Progress"));const l=W5(r,o)?r:null,c=C1(l)?i(l,o):void 0;return p.jsx(ECe,{scope:n,value:l,max:o,children:p.jsx(sn.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":C1(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":CV(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});_V.displayName=FI;var SV="ProgressIndicator",EV=T.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=CCe(SV,n);return p.jsx(sn.div,{"data-state":CV(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});EV.displayName=SV;function kCe(e,t){return`${Math.round(e/t*100)}%`}function CV(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function C1(e){return typeof e=="number"}function K5(e){return C1(e)&&!isNaN(e)&&e>0}function W5(e,t){return C1(e)&&!isNaN(e)&&e<=t&&e>=0}function TCe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${LI}\`.`}function ACe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${LI} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var kV=_V,RCe=EV;const YA=T.forwardRef(({className:e,value:t,...n},r)=>p.jsx(kV,{ref:r,className:ct("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:p.jsx(RCe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));YA.displayName=kV.displayName;var tS="Popover",[TV,m4e]=Ii(tS,[pd]),Db=pd(),[NCe,Td]=TV(tS),AV=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=e,o=Db(t),l=T.useRef(null),[c,u]=T.useState(!1),[f,m]=Lo({prop:r,defaultProp:s??!1,onChange:i,caller:tS});return p.jsx(Q1,{...o,children:p.jsx(NCe,{scope:t,contentId:Qs(),triggerRef:l,open:f,onOpenChange:m,onOpenToggle:T.useCallback(()=>m(g=>!g),[m]),hasCustomAnchor:c,onCustomAnchorAdd:T.useCallback(()=>u(!0),[]),onCustomAnchorRemove:T.useCallback(()=>u(!1),[]),modal:a,children:n})})};AV.displayName=tS;var RV="PopoverAnchor",ICe=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Td(RV,n),i=Db(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=s;return T.useEffect(()=>(a(),()=>o()),[a,o]),p.jsx(Wy,{...i,...r,ref:t})});ICe.displayName=RV;var NV="PopoverTrigger",IV=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Td(NV,n),i=Db(n),a=Nn(t,s.triggerRef),o=p.jsx(sn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":DV(s.open),...r,ref:a,onClick:Ut(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:p.jsx(Wy,{asChild:!0,...i,children:o})});IV.displayName=NV;var BI="PopoverPortal",[jCe,MCe]=TV(BI,{forceMount:void 0}),jV=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=Td(BI,t);return p.jsx(jCe,{scope:t,forceMount:n,children:p.jsx(si,{present:n||i.open,children:p.jsx(fm,{asChild:!0,container:s,children:r})})})};jV.displayName=BI;var em="PopoverContent",MV=T.forwardRef((e,t)=>{const n=MCe(em,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=Td(em,e.__scopePopover);return p.jsx(si,{present:r||i.open,children:i.modal?p.jsx(PCe,{...s,ref:t}):p.jsx(DCe,{...s,ref:t})})});MV.displayName=em;var OCe=zu("PopoverContent.RemoveScroll"),PCe=T.forwardRef((e,t)=>{const n=Td(em,e.__scopePopover),r=T.useRef(null),s=Nn(t,r),i=T.useRef(!1);return T.useEffect(()=>{const a=r.current;if(a)return Z_(a)},[]),p.jsx(Ib,{as:OCe,allowPinchZoom:!0,children:p.jsx(OV,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ut(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),i.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Ut(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Ut(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),DCe=T.forwardRef((e,t)=>{const n=Td(em,e.__scopePopover),r=T.useRef(!1),s=T.useRef(!1);return p.jsx(OV,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),OV=T.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...f}=e,m=Td(em,n),g=Db(n);return K_(),p.jsx(Nb,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:p.jsx(cm,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>m.onOpenChange(!1),children:p.jsx(e_,{"data-state":DV(m.open),role:"dialog",id:m.contentId,...g,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),PV="PopoverClose",FCe=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Td(PV,n);return p.jsx(sn.button,{type:"button",...r,ref:t,onClick:Ut(e.onClick,()=>s.onOpenChange(!1))})});FCe.displayName=PV;var LCe="PopoverArrow",BCe=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Db(n);return p.jsx(t_,{...s,...r,ref:t})});BCe.displayName=LCe;function DV(e){return e?"open":"closed"}var $Ce=AV,zCe=IV,UCe=jV,qCe=MV;function Ho({...e}){return p.jsx($Ce,{"data-slot":"popover",...e})}function Go({...e}){return p.jsx(zCe,{"data-slot":"popover-trigger",...e})}function Ko({className:e,align:t="center",sideOffset:n=4,...r}){return p.jsx(UCe,{children:p.jsx(qCe,{"data-slot":"popover-content",align:t,sideOffset:n,className:ct("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}function tp(e,t,n){let r=n.initialDeps??[],s;function i(){var a,o,l,c;let u;n.key&&((a=n.debug)!=null&&a.call(n))&&(u=Date.now());const f=e();if(!(f.length!==r.length||f.some((v,b)=>r[b]!==v)))return s;r=f;let g;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(g=Date.now()),s=t(...f),n.key&&((l=n.debug)!=null&&l.call(n))){const v=Math.round((Date.now()-u)*100)/100,b=Math.round((Date.now()-g)*100)/100,w=b/16,x=(_,E)=>{for(_=String(_);_.length<E;)_=" "+_;return _};console.info(`%c ${x(b,5)} /${x(v,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*w,120))}deg 100% 31%);`,n==null?void 0:n.key)}return(c=n==null?void 0:n.onChange)==null||c.call(n,s),s}return i.updateDeps=a=>{r=a},i}function rT(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const VCe=(e,t)=>Math.abs(e-t)<=1,HCe=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},Z5=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},GCe=e=>e,KCe=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},WCe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=a=>{const{width:o,height:l}=a;t({width:Math.round(o),height:Math.round(l)})};if(s(Z5(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){s({width:c.inlineSize,height:c.blockSize});return}}s(Z5(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},Y5={passive:!0},X5=typeof window>"u"?!0:"onscrollend"in window,ZCe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&X5?()=>{}:HCe(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),a=u=>()=>{const{horizontal:f,isRtl:m}=e.options;s=f?n.scrollLeft*(m&&-1||1):n.scrollTop,i(),t(s,u)},o=a(!0),l=a(!1);l(),n.addEventListener("scroll",o,Y5);const c=e.options.useScrollendEvent&&X5;return c&&n.addEventListener("scrollend",l,Y5),()=>{n.removeEventListener("scroll",o),c&&n.removeEventListener("scrollend",l)}},YCe=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},XCe=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const a=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:a,behavior:n})};class JCe{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const a=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:GCe,rangeExtractor:KCe,onChange:()=>{},measureElement:YCe,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=tp(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let a=r-1;a>=0;a--){const o=n[a];if(s.has(o.lane))continue;const l=i.get(o.lane);if(l==null||o.end>l.end?i.set(o.lane,o):o.end<l.end&&s.set(o.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=tp(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,s,i,a)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a}),{key:!1}),this.getMeasurements=tp(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<n;u++){const f=i(u),m=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),g=m?m.end+this.options.gap:r+s,v=o.get(f),b=typeof v=="number"?v:this.options.estimateSize(u),w=g+b,x=m?m.lane:u%this.options.lanes;c[u]={index:u,start:g,size:b,end:w,key:f,lane:x}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=tp(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?QCe({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=tp(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,a)=>i===null||a===null?[]:n({startIndex:i,endIndex:a,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const a=i.key,o=this.elementsCache.get(a);o!==n&&(o&&this.observer.unobserve(o),this.observer.observe(n),this.elementsCache.set(a,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,a=r-i;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,a,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=tp(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,a=n.length;i<a;i++){const o=n[i],l=r[o];s.push(l)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return rT(r[FV(0,r.length-1,s=>rT(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=n>=a+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const o=this.getTotalSize()-i;return Math.max(Math.min(o,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(s.end>=a+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const i=this.getOffsetForIndex(n,r);if(!i)return;const[a,o]=i;this._scrollToOffset(a,{adjustments:void 0,behavior:s}),s!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=rT(this.getOffsetForIndex(n,o)),u=this.getScrollOffset();VCe(c,u)||this.scrollToIndex(n,{align:o,behavior:s})}else this.scrollToIndex(n,{align:o,behavior:s})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&i.some(o=>o===null);){const o=r[a];i[o.lane]===null&&(i[o.lane]=o.end),a--}s=Math.max(...i.filter(o=>o!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const FV=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function QCe({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=l=>e[l].start;if(e.length<=r)return{startIndex:0,endIndex:s};let a=FV(0,s,i,n),o=a;if(r===1)for(;o<s&&e[o].end<n+t;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<s&&l.some(u=>u<n+t);){const u=e[o];l[u.lane]=u.end,o++}const c=Array(r).fill(n+t);for(;a>=0&&c.some(u=>u>=n);){const u=e[a];c[u.lane]=u.start,a--}a=Math.max(0,a-a%r),o=Math.min(s,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const J5=typeof document<"u"?T.useLayoutEffect:T.useEffect;function eke(e){const t=T.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var a;i?ko.flushSync(t):t(),(a=e.onChange)==null||a.call(e,s,i)}},[r]=T.useState(()=>new JCe(n));return r.setOptions(n),J5(()=>r._didMount(),[]),J5(()=>r._willUpdate()),r}function $I(e){return eke({observeElementRect:WCe,observeElementOffset:ZCe,scrollToFn:XCe,...e})}const Q5=e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?null:t/1e6},zI=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:s=!1,disabled:i=!1,listHeightClass:a="h-[26rem]",onModelClick:o})=>{const[l,c]=T.useState(null),u=T.useCallback(re=>{if(re){const K=re.querySelector("[data-radix-scroll-area-viewport]");if(K)c(K);else{const ee=new MutationObserver(()=>{const W=re.querySelector("[data-radix-scroll-area-viewport]");W&&(c(W),ee.disconnect())});return ee.observe(re,{childList:!0,subtree:!0}),()=>ee.disconnect()}}else c(null)},[]),[f,m]=T.useState(""),[g,v]=T.useState(!1),[b,w]=T.useState("all"),[x,_]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),[E,C]=T.useState(""),[k,R]=T.useState(""),[I,j]=T.useState(""),[M,L]=T.useState(""),q=T.useMemo(()=>{let re=[...t];if(b==="enabled"?re=re.filter(ge=>n.has(ge.id)):b==="disabled"&&(re=re.filter(ge=>!n.has(ge.id))),f.trim()){const ge=f.toLowerCase();re=re.filter(Me=>Me.name.toLowerCase().includes(ge)||Me.id.toLowerCase().includes(ge))}const K=Object.entries(x).filter(([,ge])=>ge).map(([ge])=>ge);K.length>0&&(re=re.filter(ge=>{var Ie;const Me=new Set(ge.supported_parameters??[]),Pe=new Set(((Ie=ge.architecture)==null?void 0:Ie.input_modalities)??[]);return K.every(Ce=>{switch(Ce){case"reasoning":return Me.has("reasoning");case"webSearch":return Me.has("web_search")||Me.has("web_search_options");case"tools":return Me.has("tools");case"multimodal":return Array.from(Pe).some(He=>He!=="text");default:return!0}})}));const ee=parseFloat(E),W=parseFloat(k),se=parseFloat(I),Y=parseFloat(M),te=!isNaN(ee),Q=!isNaN(W),ae=!isNaN(se),xe=!isNaN(Y);return(te||Q||ae||xe)&&(re=re.filter(ge=>{var me,Te;const Me=Q5((me=ge.pricing)==null?void 0:me.prompt),Pe=Q5((Te=ge.pricing)==null?void 0:Te.completion),Ie=te?ee/1e6:-1/0,Ce=Q?W/1e6:1/0,He=ae?se/1e6:-1/0,it=xe?Y/1e6:1/0,Ge=Me!==null&&Me>=Ie&&Me<=Ce,Re=Pe!==null&&Pe>=He&&Pe<=it;let H=!0;return(te||Q)&&H&&(H=Ge),(ae||xe)&&H&&(H=Re),H})),re},[t,f,b,n,x,E,k,I,M]),P=$I({count:q.length,getScrollElement:()=>l,estimateSize:()=>40,overscan:10}),V=re=>{_(K=>({...K,[re]:!K[re]}))},z=(b!=="all"?1:0)+Object.values(x).filter(Boolean).length+(E||k||I||M?1:0);return s?p.jsxs("div",{className:ct("space-y-2",a),children:[p.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),p.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),p.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):t.length===0?p.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):p.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[p.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[p.jsxs("div",{className:"relative flex-grow",children:[p.jsx(ki,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),p.jsx(zn,{value:f,onChange:re=>m(re.target.value),placeholder:"Filter models by name...",className:"pl-8 h-9 w-full text-xs",type:"text",disabled:i})]}),p.jsxs(Ho,{open:g,onOpenChange:v,children:[p.jsx(Go,{asChild:!0,children:p.jsxs(Ct,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:i,children:[p.jsx(fR,{className:"h-4 w-4 mr-1"}),"Filters",z>0&&p.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:z})]})}),p.jsxs(Ko,{className:"w-72 p-4 space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx(Jt,{className:"text-xs font-semibold",children:"Status"}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx(Ct,{variant:b==="all"?"secondary":"outline",size:"sm",onClick:()=>w("all"),children:"All"}),p.jsxs(Ct,{variant:b==="enabled"?"secondary":"outline",size:"sm",onClick:()=>w("enabled"),children:[p.jsx(Ui,{className:"h-3 w-3 mr-1"})," Enabled"]}),p.jsxs(Ct,{variant:b==="disabled"?"secondary":"outline",size:"sm",onClick:()=>w("disabled"),children:[p.jsx(mY,{className:"h-3 w-3 mr-1"})," Disabled"]})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(Jt,{className:"text-xs font-semibold",children:"Capabilities"}),p.jsxs("div",{className:"flex flex-wrap gap-1",children:[p.jsx(gn,{tooltipText:"Reasoning","aria-label":"Reasoning",icon:p.jsx(dd,{}),onClick:()=>V("reasoning"),variant:x.reasoning?"secondary":"outline",className:ct(x.reasoning&&"text-primary")}),p.jsx(gn,{tooltipText:"Web Search","aria-label":"Web Search",icon:p.jsx(ki,{}),onClick:()=>V("webSearch"),variant:x.webSearch?"secondary":"outline",className:ct(x.webSearch&&"text-primary")}),p.jsx(gn,{tooltipText:"Tools","aria-label":"Tools",icon:p.jsx(Cf,{}),onClick:()=>V("tools"),variant:x.tools?"secondary":"outline",className:ct(x.tools&&"text-primary")}),p.jsx(gn,{tooltipText:"Multimodal","aria-label":"Multimodal",icon:p.jsx(Ef,{}),onClick:()=>V("multimodal"),variant:x.multimodal?"secondary":"outline",className:ct(x.multimodal&&"text-primary")})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsxs(Jt,{className:"text-xs font-semibold flex items-center gap-1",children:[p.jsx(UY,{className:"h-3 w-3"})," Price Range ($ / 1M Tokens)"]}),p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsx(zn,{type:"number",min:"0",step:"0.01",placeholder:"Min Input",value:E,onChange:re=>C(re.target.value),className:"h-8 text-xs"}),p.jsx(zn,{type:"number",min:"0",step:"0.01",placeholder:"Max Input",value:k,onChange:re=>R(re.target.value),className:"h-8 text-xs"}),p.jsx(zn,{type:"number",min:"0",step:"0.01",placeholder:"Min Output",value:I,onChange:re=>j(re.target.value),className:"h-8 text-xs"}),p.jsx(zn,{type:"number",min:"0",step:"0.01",placeholder:"Max Output",value:M,onChange:re=>L(re.target.value),className:"h-8 text-xs"})]})]})]})]})]}),p.jsxs(Hi,{className:ct("w-full rounded-md border border-border p-1 bg-background/50 flex-grow",a),ref:u,children:[l&&p.jsx("div",{style:{height:`${P.getTotalSize()}px`,width:"100%",position:"relative"},children:q.length===0&&!s?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match the current filters."}):P.getVirtualItems().map(re=>{const K=q[re.index];return K?p.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${re.size}px`,transform:`translateY(${re.start}px)`},className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[p.jsx(Bu,{id:`enable-model-${e}-${K.id}`,checked:n.has(K.id),onCheckedChange:ee=>r(K.id,ee),disabled:i,"aria-label":`Enable model ${K.name||K.id}`,className:"flex-shrink-0",onClick:ee=>ee.stopPropagation()}),p.jsx(Jt,{htmlFor:`enable-model-${e}-${K.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate pl-2",title:K.name||K.id,onClick:o?()=>o(K.id):void 0,children:K.name||K.id})]},K.id):null})}),!l&&!s&&p.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},tke=({stepNumber:e,title:t,description:n,isComplete:r,isActive:s,openOnComplete:i=!1,contentClassName:a="",icon:o,children:l})=>{const[c,u]=T.useState(!1);return T.useEffect(()=>{u(s||r&&i)},[s,r,i]),p.jsxs(W7,{className:`border border-border/40 bg-card/50 backdrop-blur-sm shadow-lg ${r?"border-l-4 border-l-green-500/70":s?"border-l-4 border-l-primary/70":""}`,children:[p.jsx(Z7,{className:"pb-2",children:p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r?"bg-green-500/20 text-green-500":s?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:r?p.jsx(O1,{className:"h-5 w-5"}):p.jsx("div",{className:"flex items-center justify-center",children:o})}),p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(!c),children:[p.jsxs(Y7,{className:"text-base",children:[p.jsxs("span",{className:"opacity-60 mr-2",children:[e,"."]}),t]}),p.jsx("button",{className:`p-1 rounded-full transition-all ${c?"rotate-90":""} hover:bg-muted/60`,children:p.jsx(nF,{className:"h-4 w-4"})})]}),!c&&p.jsx(Twe,{className:"text-xs mt-1",children:typeof n=="string"?n.substring(0,60)+(n.length>60?"...":""):"Click to expand"})]})]})}),p.jsx(Mwe,{children:c&&p.jsx(vl.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:p.jsxs(X7,{className:"pt-2",children:[typeof n=="string"?p.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n}):p.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:n}),p.jsx("div",{className:a,children:l})]})})})]})},nke=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:s,getAllAvailableModelDefsForProvider:i,isLoading:a,enableApiKeyManagement:o}=gr(mn(ae=>({apiKeys:ae.dbApiKeys,addApiKey:ae.addApiKey,providers:ae.dbProviderConfigs,addProviderConfig:ae.addProviderConfig,updateProviderConfig:ae.updateProviderConfig,getAllAvailableModelDefsForProvider:ae.getAllAvailableModelDefsForProvider,isLoading:ae.isLoading,enableApiKeyManagement:ae.enableApiKeyManagement}))),{addConversation:l,selectItem:c}=br(mn(ae=>({addConversation:ae.addConversation,selectItem:ae.selectItem}))),[u,f]=T.useState(!1),[m,g]=T.useState(!1),[v,b]=T.useState(!1),[w,x]=T.useState(!1),[_,E]=T.useState(!1),C=T.useMemo(()=>!o||e.length>0,[o,e]),k=T.useMemo(()=>n.length>0,[n]),R=T.useMemo(()=>n.some(ae=>ae.isEnabled&&ae.enabledModels&&ae.enabledModels.length>0),[n]),I=T.useMemo(()=>{const ae=[...n].sort((xe,ge)=>ge.createdAt.getTime()-xe.createdAt.getTime());return ae.length>0?ae[0]:null},[n]),j=T.useMemo(()=>I?i(I.id):[],[I,i]),M=T.useMemo(()=>new Set((I==null?void 0:I.enabledModels)??[]),[I]),{initialProviderTypeForForm:L,initialProviderNameForForm:q,initialApiKeyIdForForm:P}=T.useMemo(()=>{var ae;if(k)return{type:void 0,name:void 0,keyId:void 0};if(e.length>0){const ge=[...e].sort((Me,Pe)=>Pe.createdAt.getTime()-Me.createdAt.getTime()).find(Me=>Pp(Me.providerId));if(ge){const Me=ge.providerId,Pe=((ae=na.find(Ie=>Ie.value===Me))==null?void 0:ae.label)||Me;return{initialProviderTypeForForm:Me,initialProviderNameForForm:Pe,initialApiKeyIdForForm:ge.id}}}return{initialProviderTypeForForm:void 0,initialProviderNameForForm:void 0,initialApiKeyIdForForm:void 0}},[e,k]),V=T.useCallback(async(ae,xe,ge)=>{f(!0);try{await t(ae,xe,ge),Le.success("API key added successfully!")}finally{f(!1)}},[t]),z=T.useCallback(async ae=>{g(!0);try{const xe={...ae,apiKeyId:ae.apiKeyId??(Pp(ae.type)?P??null:null)},ge=await r(xe);return Le.success("Provider added successfully!"),ge}finally{g(!1)}},[r,P]),re=T.useCallback(async(ae,xe)=>{if(!I)return;x(!0);const ge=new Set(I.enabledModels??[]);xe?ge.add(ae):ge.delete(ae);const Me=Array.from(ge);try{await s(I.id,{enabledModels:Me}),Le.success(xe?"Model enabled successfully!":"Model disabled successfully!")}catch(Pe){Le.error("Failed to update model status."),console.error("Failed to save model toggle:",Pe)}finally{x(!1)}},[I,s]),K=T.useCallback(async()=>{b(!0),E(!0);try{await new Promise(xe=>setTimeout(xe,800));const ae=await l({title:"New Chat"});await c(ae,"conversation"),Le.success("Welcome to your first chat!")}catch(ae){Le.error("Failed to start your first chat."),console.error("Failed to start first chat:",ae),b(!1),E(!1)}},[l,c]),ee=()=>{Be.emit(Xn.openModalRequest,{modalId:"settingsModal",initialTab:"providers"})},W=[C,k,R].filter(Boolean).length,se=o?3:2,Y=W/se*100,te=[...o?[{id:"api-key",title:"Add API Key",description:p.jsxs("div",{className:"space-y-2",children:[p.jsxs("p",{children:["To use providers like"," ",p.jsx(cf,{href:"https://platform.openai.com/api-keys",className:"text-blue-500 hover:text-blue-700 transition-colors",children:"OpenAI"}),","," ",p.jsx(cf,{href:"https://aistudio.google.com/app/apikey",className:"text-green-600 hover:text-green-700 transition-colors",children:"Google"}),","," ",p.jsx(cf,{href:"https://console.anthropic.com/settings/keys",className:"text-purple-500 hover:text-purple-700 transition-colors",children:"Anthropic (Claude)"}),", or"," ",p.jsx(cf,{href:"https://openrouter.ai/keys",className:"text-orange-500 hover:text-orange-700 transition-colors",children:"OpenRouter"})," ","or any OpenAI API compatible provider, add an API key. Keys are stored securely in your browser."]}),p.jsxs("p",{children:['If you want truly local AI, "no internet required", you can setup'," ",p.jsx(cf,{href:"https://www.ollama.com/",className:"text-teal-500 hover:text-teal-700 transition-colors",children:"Ollama"})," ","or,"," ",p.jsx(cf,{href:"https://lmstudio.ai/",className:"text-indigo-500 hover:text-indigo-700 transition-colors",children:"LMStudio"})," ","(or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys so see you in step 2."]})]}),isComplete:C,content:p.jsx(pV,{onSave:V,onCancel:()=>{},disabled:u,className:"border-none shadow-none p-0",initialProviderType:L}),icon:p.jsx(k0,{className:"h-4 w-4"})}]:[],{id:"add-provider",title:"Add AI Provider",description:p.jsxs("div",{className:"space-y-2",children:[p.jsx("p",{children:"Connect to an AI provider you configured the key for..."}),p.jsx("p",{children:"This might look redundant, but it allows you to have multiple keys for the same provider (personal, professional, etc.)"})]}),isComplete:k,content:p.jsx(xV,{apiKeys:e,onAddProvider:z,onCancel:()=>{},initialType:L,initialName:q,initialApiKeyId:P}),icon:p.jsx(ox,{className:"h-4 w-4"})},{id:"enable-models",title:"Enable Models",description:p.jsxs("div",{className:"space-y-2",children:[p.jsxs("p",{children:["Enable models for the provider you just added (",p.jsx("span",{className:"font-medium text-primary",children:(I==null?void 0:I.name)||"..."}),")."]}),p.jsx("p",{children:"Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."}),p.jsx("p",{children:"And just like before, you can choose to activate a model for a certain combination of key/provider!"})]}),isComplete:R,content:I?p.jsx("div",{className:"bg-card/40 rounded-lg p-3 border border-border/30 shadow-inner",children:p.jsx(zI,{providerId:I.id,allAvailableModels:j,enabledModelIds:M,onToggleModel:re,isLoading:a||w,listHeightClass:"h-[26rem]"})}):p.jsxs("p",{className:"text-sm text-muted-foreground italic flex items-center",children:[p.jsx(Ac,{className:"h-4 w-4 mr-2 text-amber-500"}),"Add a provider in Step ",o?"2":"1"," first."]}),icon:p.jsx(dd,{className:"h-4 w-4"})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:p.jsxs("div",{children:[_&&p.jsx(vl.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-4",children:p.jsx(YA,{value:v?void 0:100,className:"h-2"})}),p.jsxs(Ct,{onClick:K,disabled:v||!R,className:"w-full bg-gradient-to-r from-indigo-500 to-primary hover:opacity-90 transition-all",children:[p.jsx(IX,{className:"mr-2 h-4 w-4"}),v?"Launching...":"Start First Chat"]}),p.jsx(J7,{})]}),contentClassName:"p-4",icon:p.jsx(WX,{className:"h-4 w-4"})}],Q=te.findIndex(ae=>!ae.isComplete);return a?p.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-4xl mx-auto w-full",children:p.jsxs(vl.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:[p.jsx(dr,{className:"h-12 w-1/2 mx-auto mb-6"}),p.jsx(dr,{className:"h-8 w-3/4 mx-auto mb-2"}),p.jsx(dr,{className:"h-4 w-1/2 mx-auto mb-8"}),p.jsx(dr,{className:"h-20 w-full mb-6"}),p.jsx(dr,{className:"h-20 w-full mb-6"}),p.jsx(dr,{className:"h-20 w-full"})]})}):p.jsx("div",{className:"flex h-full flex-col items-center justify-start p-4 bg-gradient-to-b from-background to-background/80",children:p.jsxs("div",{className:"w-full max-w-4xl space-y-6 pt-8",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx(vl.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:p.jsxs("div",{className:"relative mx-auto w-16 h-16 mb-4",children:[p.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl"}),p.jsx("div",{className:"relative bg-gradient-to-br from-primary to-indigo-600 p-3 rounded-full",children:p.jsx(wCe,{className:"h-10 w-10 text-white"})})]})}),p.jsx("h2",{className:"text-3xl font-bold mb-3 bg-gradient-to-r from-primary to-indigo-500 bg-clip-text text-transparent",children:"Welcome to LiteChat"}),p.jsx(_Ce,{})]}),p.jsxs(vl.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[p.jsx(sr,{children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsxs("div",{className:"mt-6 bg-card/40 backdrop-blur-sm border border-border/30 rounded-xl p-3 w-3/4 mx-auto",children:[p.jsx(YA,{value:Y,className:"h-1.5"}),p.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Setup Progress: ",Math.round(Y),"%"]})]})}),p.jsx(cr,{children:p.jsxs("p",{children:["Steps completed: ",W," of ",se]})})]})}),te.map((ae,xe)=>{const ge=xe===Q;return p.jsx(vl.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:xe*.1,duration:.3},children:p.jsx(tke,{stepNumber:xe+1,title:ae.title,description:ae.description,isComplete:ae.id!=="start-chat"&&ae.isComplete,isActive:ge,openOnComplete:ae.id==="enable-models",contentClassName:ae.id==="add-provider"||ae.id==="api-key"?"p-0 border-none shadow-none bg-transparent":ae.contentClassName,icon:ae.icon,children:ae.content})},ae.id)})]}),!a&&!k&&Q===-1&&p.jsxs(vl.div,{className:"text-center mt-6 p-4 bg-red-500/10 rounded-lg border border-red-500/30",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[p.jsx(Ac,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),p.jsx("p",{className:"text-sm mb-3",children:"Configuration issue detected. Please review provider settings."}),p.jsx(Ct,{variant:"outline",size:"sm",onClick:ee,className:"border-red-500/50 hover:bg-red-500/20 transition-colors",children:"Open Provider Settings"})]})]})})},Fw=["conversation.title_generation"],rke=({conversationId:e,interactions:t,status:n,className:r})=>{const s=T.useRef(null),i=T.useRef(null),[a,o]=T.useState(!1),l=T.useRef(null),c=Bn(V=>V.streamingInteractionIds),{chatMaxWidth:u,autoScrollInterval:f,enableAutoScrollOnStream:m}=ir(mn(V=>({chatMaxWidth:V.chatMaxWidth,autoScrollInterval:V.autoScrollInterval,enableAutoScrollOnStream:V.enableAutoScrollOnStream}))),g=T.useMemo(()=>V=>({isLoading:V.isLoading}),[]),v=T.useMemo(()=>V=>({conversationCount:V.conversations.length,isConversationLoading:V.isLoading}),[]),{isLoading:b}=gr(mn(g)),{conversationCount:w,isConversationLoading:x}=br(mn(v)),{projectCount:_,isProjectLoading:E}=Oa(mn(V=>({projectCount:V.projects.length,isProjectLoading:V.isLoading}))),C=T.useMemo(()=>b||x||E?!1:w===0&&_===0,[w,_,b,x,E]),k=T.useMemo(()=>t.filter(re=>re.parentId===null&&!Fw.includes(re.type)).sort((re,K)=>re.index-K.index).map(re=>{const K=t.filter(ee=>ee.parentId===re.id&&!Fw.includes(ee.type)).sort((ee,W)=>ee.index-W.index);return[re,...K]}),[t]),R=co(mn(V=>Object.values(V.canvasControls))),I=T.useCallback((V,z,re,K)=>R.filter(W=>{const se=W.type===V,Y=W.targetSlot===z,te=!!W.renderer;return se&&Y&&te}).map(W=>{if(W.renderer){const Y={...{interaction:re,interactionId:re==null?void 0:re.id,responseContent:typeof(re==null?void 0:re.response)=="string"?re.response:void 0,canvasContextType:V},...K};return p.jsx(dt.Fragment,{children:W.renderer(Y)},W.id)}return null}).filter(Boolean),[R]),j=(V="smooth")=>{i.current&&i.current.scrollTo({top:i.current.scrollHeight,behavior:V})};T.useEffect(()=>{if(i.current){const{scrollHeight:V,clientHeight:z,scrollTop:re}=i.current;(V-z<=re+150||n!=="streaming")&&requestAnimationFrame(()=>{j(n==="streaming"?"smooth":"auto")})}},[k.length,n]),T.useEffect(()=>(n==="streaming"&&m?(l.current&&clearInterval(l.current),l.current=setInterval(()=>{j("smooth")},f)):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[n,f,m]),T.useEffect(()=>{const V=i.current;if(!V)return;const z=()=>{if(!i.current)return;const{scrollHeight:re,clientHeight:K,scrollTop:ee}=i.current,W=ee<re-K-K*.5;o(W)};return V.addEventListener("scroll",z,{passive:!0}),z(),()=>{i.current&&i.current.removeEventListener("scroll",z)}},[]),T.useEffect(()=>{s.current&&(i.current=s.current.querySelector("[data-radix-scroll-area-viewport]"))},[]);const M=T.useMemo(()=>{const V=[];return[...t].sort((K,ee)=>{var W,se;return K.index!==ee.index?K.index-ee.index:K.parentId===null&&ee.parentId!==null?-1:K.parentId!==null&&ee.parentId===null?1:K.parentId!==null&&ee.parentId!==null&&K.parentId===ee.parentId?K.index-ee.index:(((W=K.startedAt)==null?void 0:W.getTime())??0)-(((se=ee.startedAt)==null?void 0:se.getTime())??0)}).filter(K=>K.parentId===null&&!Fw.includes(K.type)).forEach(K=>{var Y,te;let ee=null;if(K.type==="message.user_assistant"&&K.prompt)ee=K.prompt;else if(K.type==="message.assistant_regen"&&((Y=K.metadata)!=null&&Y.regeneratedFromId)){let Q,ae=K;const xe=new Set;for(;ae&&!xe.has(ae.id);){if(xe.add(ae.id),ae.type==="message.user_assistant"&&ae.prompt){Q=ae;break}if((te=ae.metadata)!=null&&te.regeneratedFromId)ae=t.find(ge=>ge.id===ae.metadata.regeneratedFromId);else break}Q?ee=Q.prompt:K.prompt?ee=K.prompt:console.warn(`[ChatCanvas] Could not reliably find user prompt for active interaction ${K.id} of type ${K.type}. Displaying turn without prompt.`)}if(ee)V.push(p.jsx(P_,{turnData:ee,timestamp:K.startedAt,isAssistantComplete:K.status==="COMPLETED"||K.status==="ERROR"},`prompt-${K.id}`));else if(K.type!=="message.user_assistant"&&K.type!=="message.assistant_regen"){console.log("[ChatCanvas] Skipping active interaction on spine due to no user prompt and non-standard type:",K.id,K.type);return}const W=t.filter(Q=>Q.parentId===K.id&&!Fw.includes(Q.type)).sort((Q,ae)=>Q.index-ae.index),se=[K,...W];se.length>0&&V.push(p.jsx(cwe,{interactionGroup:se,renderSlot:(Q,ae,xe)=>I("interaction",Q,ae,xe),activeStreamingInteractionId:c.find(Q=>se.some(ae=>ae.id===Q))},`tabs-${K.id}`))}),V},[t,I,c]),L=T.useMemo(()=>c.filter(V=>!t.some(z=>z.id===V)).map(V=>p.jsx(h1,{interactionId:V,renderSlot:(z,re,K)=>I("interaction",z,re,K)},`${V}-streaming-new`)),[c,t,I]),q=()=>b||x||E?p.jsxs("div",{className:"space-y-4 p-2 md:p-4",children:[p.jsx(dr,{className:"h-24 w-full"}),p.jsx(dr,{className:"h-32 w-full"}),p.jsx(dr,{className:"h-20 w-full"})]}):e?k.length===0&&n!=="streaming"&&c.length===0?p.jsx(hD,{}):p.jsxs("div",{className:"space-y-4 p-2 md:p-4 break-words",children:[M,L]}):p.jsx(hD,{}),P=u||"max-w-7xl";return p.jsx("div",{className:ct("flex-grow relative",r),children:C?p.jsx(Hi,{className:"h-full w-full",children:p.jsx("div",{className:ct("chat-canvas-container mx-auto",P),children:p.jsx(nke,{})})}):p.jsxs(p.Fragment,{children:[p.jsx(Hi,{className:"h-full w-full",ref:s,children:p.jsx("div",{className:ct("chat-canvas-container mx-auto",P),children:q()})}),a&&p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>j(),"aria-label":"Scroll to bottom",children:p.jsx(eF,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"left",children:"Scroll to Bottom"})]})})]})})},ske=dt.memo(rke),np=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const s=e.filter(i=>(i.panel??"main")===t&&(i.show?i.show():!0));return s.length===0?null:p.jsx("div",{className:ct(r),children:s.map(i=>{const a=n==="icon"?i.iconRenderer:i.renderer;return p.jsx(dt.Fragment,{children:a?a():null},i.id)})})},Dy=oo(lo((e,t)=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,toggleChatControlPanel:(n,r)=>{const s=t().isChatControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isChatControlPanelOpen[n]=i}),Be.emit(Xn.chatControlPanelVisibilityChanged,{panelId:n,isOpen:i}))},togglePromptControlPanel:(n,r)=>{const s=t().isPromptControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isPromptControlPanelOpen[n]=i}),Be.emit(Xn.promptControlPanelVisibilityChanged,{controlId:n,isOpen:i}))},toggleSidebar:n=>{const r=t().isSidebarCollapsed,s=n??!r;r!==s&&(e({isSidebarCollapsed:s}),Be.emit(Xn.sidebarVisibilityChanged,{isCollapsed:s}))},setGlobalLoading:n=>{t().globalLoading!==n&&(e({globalLoading:n}),Be.emit(Xn.globalLoadingChanged,{loading:n}))},setGlobalError:n=>{t().globalError!==n&&(e({globalError:n}),Be.emit(Xn.globalErrorChanged,{error:n}))},setFocusInputFlag:n=>{t().focusInputOnNextRender!==n&&(e({focusInputOnNextRender:n}),Be.emit(Xn.focusInputFlagChanged,{focus:n}))},getRegisteredActionHandlers:()=>{const n="uiStateStore",r=t();return[{eventName:Xn.toggleSidebarRequest,handler:s=>r.toggleSidebar(s==null?void 0:s.isCollapsed),storeId:n},{eventName:Xn.toggleChatControlPanelRequest,handler:s=>r.toggleChatControlPanel(s.panelId,s.isOpen),storeId:n},{eventName:Xn.togglePromptControlPanelRequest,handler:s=>r.togglePromptControlPanel(s.controlId,s.isOpen),storeId:n},{eventName:Xn.setGlobalLoadingRequest,handler:s=>r.setGlobalLoading(s.loading),storeId:n},{eventName:Xn.setGlobalErrorRequest,handler:s=>r.setGlobalError(s.error),storeId:n},{eventName:Xn.setFocusInputFlagRequest,handler:s=>r.setFocusInputFlag(s.focus),storeId:n}]}})));var ike=(e,t,n,r,s,i,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(g){(Array.isArray(e)?e:[e]).forEach(v=>{let b=v==="class",w=b&&i?s.map(x=>i[x]||x):s;b?(l.classList.remove(...w),l.classList.add(i&&i[g]?i[g]:g)):l.setAttribute(v,g)}),f(g)}function f(g){o&&c.includes(g)&&(l.style.colorScheme=g)}function m(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let g=localStorage.getItem(t)||n,v=a&&g==="system"?m():g;u(v)}catch{}},ake=T.createContext(void 0),oke={setTheme:e=>{},themes:[]},lke=()=>{var e;return(e=T.useContext(ake))!=null?e:oke};T.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,t,i,e,o,a,r,s]).slice(1,-1);return T.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${ike.toString()})(${u})`}})});const cke=({...e})=>{const{theme:t="system"}=lke();return p.jsx(EQ,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function Ad({className:e,...t}){return p.jsx("textarea",{"data-slot":"textarea",className:ct("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const LV=T.memo(T.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:s,onValueChange:i,...a},o)=>{const l=T.useRef(null),[c,u]=T.useState(e);T.useImperativeHandle(o,()=>({getValue:()=>c,setValue:g=>{u(g),i&&i(g),Be.emit(Tn.inputChanged,{value:g}),requestAnimationFrame(()=>{const v=l.current;v&&(v.style.height="auto",v.style.height=`${v.scrollHeight}px`,v.style.overflowY=v.scrollHeight>250?"auto":"hidden")})},focus:()=>{var g;return(g=l.current)==null?void 0:g.focus()},clearValue:()=>{u(""),i&&i(""),Be.emit(Tn.inputChanged,{value:""}),requestAnimationFrame(()=>{const g=l.current;g&&(g.style.height="auto",g.style.height=`${g.scrollHeight}px`,g.style.overflowY="hidden")})}}));const f=g=>{var v;if(g.key==="Enter"&&!g.shiftKey&&!n){g.preventDefault();const b=Vu.getState().attachedFilesMetadata.length>0;(c.trim().length>0||b)&&(t(),(v=o==null?void 0:o.current)==null||v.clearValue())}},m=g=>{const v=g.target.value;u(v),i&&i(v),Be.emit(Tn.inputChanged,{value:v})};return T.useEffect(()=>{const g=l.current;if(g){g.style.height="auto";const v=g.scrollHeight,b=250;g.style.height=`${Math.min(v,b)}px`,g.style.overflowY=v>b?"auto":"hidden"}},[c]),T.useEffect(()=>{e!==c&&(u(e),i&&i(e))},[e,i]),p.jsx(Ad,{ref:l,value:c,onChange:m,onKeyDown:f,disabled:n,placeholder:r,rows:1,className:ct("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",s),"aria-label":"Chat input",...a})}));LV.displayName="InputArea";const Ns={dbModsLoaded:"mod.db.mods.loaded",loadedInstancesChanged:"mod.loaded.instances.changed",settingsTabsChanged:"mod.settings.tabs.changed",loadingStateChanged:"mod.loading.state.changed",modLoaded:"mod.sdk.loaded",modError:"mod.sdk.error",loadDbModsRequest:"mod.load.db.mods.request",addDbModRequest:"mod.add.db.mod.request",updateDbModRequest:"mod.update.db.mod.request",deleteDbModRequest:"mod.delete.db.mod.request"},cd=oo(lo((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await Rt.loadMods();e({dbMods:n,isLoading:!1}),Be.emit(Ns.dbModsLoaded,{dbMods:n})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),Be.emit(Ns.loadingStateChanged,{isLoading:!1,error:r}),Le.error(r)}},addDbMod:async n=>{const r=pi(),s={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(i=>{i.dbMods.push(s),i.dbMods.sort((a,o)=>a.loadOrder-o.loadOrder)});try{return await Rt.saveMod(s),Le.success(`Mod "${s.name}" added.`),Be.emit(Ns.dbModsLoaded,{dbMods:t().dbMods}),r}catch(i){const a="Failed to save new mod";throw console.error("ModStore: Error adding mod",i),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=a}),Be.emit(Ns.loadingStateChanged,{isLoading:t().isLoading,error:a}),Le.error(a),i}},updateDbMod:async(n,r)=>{let s,i=-1;e(o=>{i=o.dbMods.findIndex(l=>l.id===n),i!==-1?(s={...o.dbMods[i]},o.dbMods[i]={...o.dbMods[i],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const a=i!==-1?t().dbMods[i]:void 0;if(a)try{await Rt.saveMod(a),Le.success(`Mod "${a.name}" updated.`),Be.emit(Ns.dbModsLoaded,{dbMods:t().dbMods})}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(c=>{const u=c.dbMods.findIndex(f=>f.id===n);u!==-1&&s&&(c.dbMods[u]=s,c.dbMods.sort((f,m)=>f.loadOrder-m.loadOrder)),c.error=l}),Be.emit(Ns.loadingStateChanged,{isLoading:t().isLoading,error:l}),Le.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(i=>i.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const s=r.name;e(i=>({dbMods:i.dbMods.filter(a=>a.id!==n)}));try{await Rt.deleteMod(n),Le.success(`Mod "${s}" deleted.`),Be.emit(Ns.dbModsLoaded,{dbMods:t().dbMods})}catch(i){const a="Failed to delete mod";throw console.error("ModStore: Error deleting mod",i),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder),o.error=a}),Be.emit(Ns.loadingStateChanged,{isLoading:t().isLoading,error:a}),Le.error(a),i}},setLoadedMods:n=>{e({loadedMods:n}),Be.emit(Ns.loadedInstancesChanged,{loadedMods:n})},_addSettingsTab:n=>{e(r=>{if(!r.modSettingsTabs.some(s=>s.id===n.id))r.modSettingsTabs.push(n),r.modSettingsTabs.sort((s,i)=>(s.order??999)-(i.order??999));else{console.warn(`ModStore: Settings tab with ID "${n.id}" already registered. Overwriting.`);const s=r.modSettingsTabs.findIndex(i=>i.id===n.id);r.modSettingsTabs[s]=n,r.modSettingsTabs.sort((i,a)=>(i.order??999)-(a.order??999))}}),Be.emit(Ns.settingsTabsChanged,{tabs:t().modSettingsTabs})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(s=>s.id!==n)}),Be.emit(Ns.settingsTabsChanged,{tabs:t().modSettingsTabs})},getRegisteredActionHandlers:()=>{const n="modStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Ns.loadDbModsRequest,handler:r.loadDbMods,storeId:n},{eventName:Ns.addDbModRequest,handler:s(r.addDbMod),storeId:n},{eventName:Ns.updateDbModRequest,handler:i=>r.updateDbMod(i.id,i.changes),storeId:n},{eventName:Ns.deleteDbModRequest,handler:i=>r.deleteDbMod(i.id),storeId:n}]}}))),Rd={loaded:"app.loaded",errorBoundaryTriggered:"app.error.boundary.triggered",initializationPhaseCompleted:"app.initialization.phase.completed"};function XA(e){const t=e.id,n=e.name;return{modId:t,modName:n,registerPromptControl:s=>(Be.emit(rr.registerPromptControlRequest,{control:s}),()=>Be.emit(rr.unregisterPromptControlRequest,{id:s.id})),registerChatControl:s=>{const i={...s,status:s.status??(()=>"ready")};return Be.emit(rr.registerChatControlRequest,{control:i}),()=>Be.emit(rr.unregisterChatControlRequest,{id:s.id})},registerCanvasControl:s=>(Be.emit(rr.registerCanvasControlRequest,{control:s}),()=>Be.emit(rr.unregisterCanvasControlRequest,{id:s.id})),registerTool:(s,i,a)=>(console.log(`[${n}] Registering tool: ${s}`),Be.emit(rr.registerToolRequest,{modId:t,toolName:s,definition:i,implementation:a}),()=>Be.emit(rr.unregisterToolRequest,{toolName:s})),on:(s,i)=>(Be.on(s,i),()=>Be.off(s,i)),emit:(s,i)=>{Be.emit(s,i)},addMiddleware:(s,i)=>(Be.emit(rr.registerMiddlewareRequest,{hookName:s,modId:t,callback:i}),()=>Be.emit(rr.unregisterMiddlewareRequest,{hookName:s,modId:t,callback:i})),registerSettingsTab:s=>(cd.getState()._addSettingsTab(s),()=>cd.getState()._removeSettingsTab(s.id)),getContextSnapshot:()=>{const s=Bn.getState(),i=br.getState(),a=ir.getState(),o=gr.getState(),{providerId:l}=jo(o.selectedModelId),c=i.selectedItemType==="conversation"?i.selectedItemId:null;return Object.freeze({selectedConversationId:c,interactions:Object.freeze(s.currentConversationId===c?s.interactions.map(u=>Object.freeze({...u})):[]),isStreaming:s.status==="streaming",selectedProviderId:l,selectedModelId:o.selectedModelId,activeSystemPrompt:a.globalSystemPrompt,temperature:a.temperature,maxTokens:a.maxTokens,theme:a.theme,gitUserName:a.gitUserName,gitUserEmail:a.gitUserEmail})},showToast:(s,i)=>{Le[s](`[Mod: ${n}] ${i}`)},log:(s,...i)=>{console[s](`[Mod: ${n}]`,...i)},registerModalProvider:(s,i)=>(Be.emit(rr.registerModalProviderRequest,{modalId:s,provider:i}),()=>Be.emit(rr.unregisterModalProviderRequest,{modalId:s})),getVfsInstance:async s=>xs.getState().initializeVFS(s,{force:!0})}}async function uke(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let s=r.scriptContent,i=null,a=null;try{if(i=XA(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const c=await fetch(r.sourceUrl);if(!c.ok)throw new Error(`Failed to fetch mod script: ${c.status} ${c.statusText}`);s=await c.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(c){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,c),c}}if(!s)throw new Error("Mod script content is empty.");new Function("modApi",s)(i),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){a=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),Le.error(`Error loading mod "${r.name}": ${a instanceof Error?a.message:a}`)}i||(i=XA(r));const o={id:r.id,name:r.name,api:i,error:a};return Be.emit(o.error?Ns.modError:Ns.modLoaded,{id:r.id,name:r.name,error:o.error??"unknown error"}),o}));return Be.emit(Rd.loaded,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}const Fn={dataLoaded:"rules.data.loaded",ruleSaved:"rules.rule.saved",ruleDeleted:"rules.rule.deleted",tagSaved:"rules.tag.saved",tagDeleted:"rules.tag.deleted",linkSaved:"rules.link.saved",linkDeleted:"rules.link.deleted",loadingStateChanged:"rules.loading.state.changed",loadRulesAndTagsRequest:"rules.load.rules.and.tags.request",addRuleRequest:"rules.add.rule.request",updateRuleRequest:"rules.update.rule.request",deleteRuleRequest:"rules.delete.rule.request",addTagRequest:"rules.add.tag.request",updateTagRequest:"rules.update.tag.request",deleteTagRequest:"rules.delete.tag.request",linkTagToRuleRequest:"rules.link.tag.to.rule.request",unlinkTagFromRuleRequest:"rules.unlink.tag.from.rule.request"};function dke(e){const t=new Map(e.map(a=>[a.id,a])),n=new Set,r=new Set,s=[];function i(a){if(n.has(a.id))return!0;if(r.has(a.id))return console.error(`[Init] Circular dependency detected involving module: ${a.id}`),Le.error("Initialization Error: Circular dependency in controls."),!1;r.add(a.id);for(const o of a.dependencies??[]){const l=t.get(o);if(!l)return console.error(`[Init] Missing dependency "${o}" for module "${a.id}"`),Le.error(`Initialization Error: Missing dependency "${o}" for "${a.id}".`),r.delete(a.id),!1;if(!i(l))return r.delete(a.id),!1}return r.delete(a.id),n.add(a.id),s.push(a),!0}for(const a of e)if(!n.has(a.id)&&!i(a))return null;return s}async function fke(e,t){console.log("[Init] Core Data: Requesting loads..."),t.emit(Qt.loadSettingsRequest,void 0),t.emit(Hn.loadInitialDataRequest,void 0),t.emit(Fn.loadRulesAndTagsRequest,void 0),t.emit(Mn.loadConversationsRequest,void 0),t.emit(fi.loadProjectsRequest,void 0),await new Promise(n=>{let r=!1,s=!1,i=!1,a=!1,o=!1;const l=()=>{r&&s&&i&&a&&o&&n()},c=t.on(Qt.loaded,()=>{r=!0,c(),l()}),u=t.on(Hn.initialDataLoaded,()=>{s=!0,u(),l()}),f=t.on(Fn.dataLoaded,()=>{i=!0,f(),l()}),m=t.on(Mn.conversationsLoaded,()=>{a=!0,m(),l()}),g=t.on(fi.loaded,()=>{o=!0,g(),l()})}),Be.emit(Rd.initializationPhaseCompleted,{phase:"coreData"}),console.log("[Init] Core Data: Loaded (or load requested).")}async function hke(e,t){console.log("[Init] Control Modules: Instantiation & Dependency Resolution START");const n=e.map(s=>new s),r=dke(n);if(!r)throw console.error("[Init] Control Modules: Dependency resolution FAILED."),new Error("Failed to resolve control module dependency order.");console.log(`[Init] Control Modules: Dependency order resolved (${r.length} modules):`,r.map(s=>s.id)),console.log("[Init] Control Modules: Instantiation & Dependency Resolution COMPLETE"),console.log("[Init] Control Modules: Initialization START");for(const s of r)try{await s.initialize(t)}catch(i){console.error(`[Init] Error initializing module "${s.id}":`,i),Le.error(`Module Init Error (${s.id}): ${i instanceof Error?i.message:String(i)}`)}return Be.emit(Rd.initializationPhaseCompleted,{phase:"controlModulesInit"}),console.log("[Init] Control Modules: Initialization COMPLETE."),r}function pke(e,t){console.log("[Init] Control Modules: Registration START");for(const n of e)try{n.register(t)}catch(r){console.error(`[Init] Error registering module "${n.id}":`,r),Le.error(`Module Registration Error (${n.id}): ${r instanceof Error?r.message:String(r)}`)}Be.emit(Rd.initializationPhaseCompleted,{phase:"controlModulesRegister"}),console.log("[Init] Control Modules: Registration COMPLETE.")}async function mke(e,t){console.log("[Init] External Mods: Loading DB records..."),t.emit(Ns.loadDbModsRequest,void 0),await new Promise(s=>{const i=t.on(Ns.dbModsLoaded,()=>{i(),s()})});const n=cd.getState().dbMods;console.log(`[Init] External Mods: Processing ${n.length} mods...`);const r=await uke(n);cd.getState().setLoadedMods(r),Be.emit(Rd.initializationPhaseCompleted,{phase:"externalMods"}),console.log(`[Init] External Mods: ${r.length} mods processed.`)}function gke(e,t){var a;console.log("[Init] Core UI States: Initializing...");const n=e.selectedItemId,r=e.selectedItemType,s=r==="project"?n:r==="conversation"?((a=e.getConversationById(n))==null?void 0:a.projectId)??null:null,i=e.getEffectiveProjectSettings(s);t.emit(Tn.initializePromptStateRequest,{effectiveSettings:i}),Be.emit(Rd.initializationPhaseCompleted,{phase:"uiStateSync"}),console.log("[Init] Core UI States: Initial prompt state synchronization requested.")}async function yke(e,t){console.log("[Init] LiteChat Full Initialization START"),p0.initializeCanvasEventHandlers();const n={requestLoadSettings:()=>t.emit(Qt.loadSettingsRequest,void 0),requestLoadProviderData:()=>t.emit(Hn.loadInitialDataRequest,void 0),requestLoadRulesAndTags:()=>t.emit(Fn.loadRulesAndTagsRequest,void 0),requestLoadConversations:()=>t.emit(Mn.loadConversationsRequest,void 0),requestLoadProjects:()=>t.emit(fi.loadProjectsRequest,void 0),requestLoadDbMods:()=>t.emit(Ns.loadDbModsRequest,void 0),setLoadedMods:cd.getState().setLoadedMods,getConversationById:br.getState().getConversationById,getEffectiveProjectSettings:Oa.getState().getEffectiveProjectSettings,initializePromptState:Ml.getState().initializePromptState,selectedItemId:br.getState().selectedItemId,selectedItemType:br.getState().selectedItemType};let r=[];try{await fke(n,t),r=await hke(e,t),pke(r,t),await mke(n,t),gke(n,t),Be.emit(Rd.initializationPhaseCompleted,{phase:"all"}),console.log("LiteChat: Full initialization sequence COMPLETE.")}catch(s){throw console.error("LiteChat: Full initialization sequence FAILED:",s),Le.error(`Initialization sequence failed: ${s instanceof Error?s.message:String(s)}`),Dy.getState().setGlobalError("Initialization sequence failed."),s}return r}const bke=oo(lo((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,s]=await Promise.all([Rt.loadRules(),Rt.loadTags(),Rt.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:s,isLoading:!1}),Be.emit(Fn.dataLoaded,{rules:n,tags:r,links:s})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),Le.error("Failed to load rules and tags."),Be.emit(Fn.loadingStateChanged,{isLoading:!1,error:"Failed load rules/tags"})}},addRule:async n=>{const r=pi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.rules.push(i),a.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{await Rt.saveRule(i),Le.success(`Rule "${i.name}" added.`),Be.emit(Fn.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Be.emit(Fn.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding rule",a),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),Le.error("Failed to save new rule."),a}},updateRule:async(n,r)=>{const s=t().rules.find(a=>a.id===n);if(!s)throw Le.error("Rule not found for update."),new Error("Rule not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.rules.findIndex(l=>l.id===n);o!==-1&&(a.rules[o]=i,a.rules.sort((l,c)=>l.name.localeCompare(c.name)))});try{await Rt.saveRule(i),Le.success(`Rule "${i.name}" updated.`),Be.emit(Fn.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(Fn.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating rule",a),e(o=>{const l=o.rules.findIndex(c=>c.id===n);l!==-1&&(o.rules[l]=s,o.rules.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save rule update"}),Le.error("Failed to save rule update."),a}},deleteRule:async n=>{const r=t().rules.find(a=>a.id===n);if(!r)throw Le.error("Rule not found for deletion."),new Error("Rule not found");const s=[...t().tagRuleLinks.filter(a=>a.ruleId===n)],i={...r};e(a=>{a.rules=a.rules.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.ruleId!==n)});try{await Rt.deleteRule(n),Le.success(`Rule "${r.name}" deleted.`),Be.emit(Fn.ruleDeleted,{ruleId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(Fn.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting rule",a),e(o=>{o.rules.find(l=>l.id===i.id)||(o.rules.push(i),o.rules.sort((l,c)=>l.name.localeCompare(c.name))),s.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete rule"}),Le.error("Failed to delete rule."),a}},addTag:async n=>{const r=pi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.tags.push(i),a.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{await Rt.saveTag(i),Le.success(`Tag "${i.name}" added.`),Be.emit(Fn.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Be.emit(Fn.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding tag",a),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),Le.error("Failed to save new tag."),a}},updateTag:async(n,r)=>{const s=t().tags.find(a=>a.id===n);if(!s)throw Le.error("Tag not found for update."),new Error("Tag not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.tags.findIndex(l=>l.id===n);o!==-1&&(a.tags[o]=i,a.tags.sort((l,c)=>l.name.localeCompare(c.name)))});try{await Rt.saveTag(i),Le.success(`Tag "${i.name}" updated.`),Be.emit(Fn.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(Fn.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating tag",a),e(o=>{const l=o.tags.findIndex(c=>c.id===n);l!==-1&&(o.tags[l]=s,o.tags.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save tag update"}),Le.error("Failed to save tag update."),a}},deleteTag:async n=>{const r=t().tags.find(a=>a.id===n);if(!r)throw Le.error("Tag not found for deletion."),new Error("Tag not found");const s={...r},i=[...t().tagRuleLinks.filter(a=>a.tagId===n)];e(a=>{a.tags=a.tags.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.tagId!==n)});try{await Rt.deleteTag(n),Le.success(`Tag "${r.name}" deleted.`),Be.emit(Fn.tagDeleted,{tagId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(Fn.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting tag",a),e(o=>{o.tags.find(l=>l.id===s.id)||(o.tags.push(s),o.tags.sort((l,c)=>l.name.localeCompare(c.name))),i.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete tag"}),Le.error("Failed to delete tag."),a}},linkTagToRule:async(n,r)=>{const s=`${n}-${r}`;if(t().tagRuleLinks.some(a=>a.id===s)){Le.info("Link already exists.");return}const i={id:s,tagId:n,ruleId:r};e(a=>{a.tagRuleLinks.push(i)});try{await Rt.saveTagRuleLink(i),Le.success("Tag linked to rule."),Fn.linkSaved&&Be.emit(Fn.linkSaved,{link:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(Fn.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error linking tag to rule",a),e(o=>{o.tagRuleLinks=o.tagRuleLinks.filter(l=>l.id!==s),o.error="Failed to link tag to rule"}),Le.error("Failed to link tag to rule."),a}},unlinkTagFromRule:async(n,r)=>{const s=`${n}-${r}`,i=t().tagRuleLinks.find(a=>a.id===s);i||Le.info("Link not found for unlinking."),e(a=>{a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.id!==s)});try{await Rt.deleteTagRuleLink(s),Le.success("Tag unlinked from rule."),Fn.linkDeleted&&Be.emit(Fn.linkDeleted,{linkId:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(Fn.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error unlinking tag from rule",a),i&&e(o=>{o.tagRuleLinks.some(l=>l.id===i.id)||o.tagRuleLinks.push(i),o.error="Failed to unlink tag from rule"}),Le.error("Failed to unlink tag from rule."),a}},getRulesForTag:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.tagId===n).map(i=>i.ruleId));return r.rules.filter(i=>s.has(i.id))},getTagsForRule:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.ruleId===n).map(i=>i.tagId));return r.tags.filter(i=>s.has(i.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(s=>r.has(s.id))},getRegisteredActionHandlers:()=>{const n="rulesStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Fn.loadRulesAndTagsRequest,handler:r.loadRulesAndTags,storeId:n},{eventName:Fn.addRuleRequest,handler:s(r.addRule),storeId:n},{eventName:Fn.updateRuleRequest,handler:i=>r.updateRule(i.id,i.updates),storeId:n},{eventName:Fn.deleteRuleRequest,handler:i=>r.deleteRule(i.id),storeId:n},{eventName:Fn.addTagRequest,handler:s(r.addTag),storeId:n},{eventName:Fn.updateTagRequest,handler:i=>r.updateTag(i.id,i.updates),storeId:n},{eventName:Fn.deleteTagRequest,handler:i=>r.deleteTag(i.id),storeId:n},{eventName:Fn.linkTagToRuleRequest,handler:i=>r.linkTagToRule(i.tagId,i.ruleId),storeId:n},{eventName:Fn.unlinkTagFromRuleRequest,handler:i=>r.unlinkTagFromRule(i.tagId,i.ruleId),storeId:n}]}}))),vke=[ir,gr,bke,br,Oa,Bn,Vu,Ml,cd,Dy,xs,co];class BV{static initialize(){if(this.isInitialized){console.warn("[Coordinator] Already initialized. Skipping re-initialization.");return}console.log("[Coordinator] Initializing dynamic event listeners for action requests...");const t=[];vke.forEach(n=>{const r=n.getState();if(r&&typeof r.getRegisteredActionHandlers=="function")try{const s=r.getRegisteredActionHandlers();Array.isArray(s)?t.push(...s):console.warn(`[Coordinator] getRegisteredActionHandlers for store did not return an array. Store ID: ${r.id||"Unknown"}`)}catch(s){console.error("[Coordinator] Error calling getRegisteredActionHandlers for a store:",s)}}),t.length===0?console.warn("[Coordinator] No action handlers were registered by any store."):t.forEach(n=>{n&&n.eventName&&typeof n.handler=="function"?Be.on(n.eventName,n.handler):console.error("[Coordinator] Invalid action handler structure encountered:",n)}),this.isInitialized=!0,console.log(`[Coordinator] Dynamic event listeners initialized. Total handlers: ${t.length}.`)}}Ne(BV,"isInitialized",!1);const wke=()=>{const[e,t]=T.useState({}),n=co(r=>r.modalProviders);return T.useEffect(()=>{const r=i=>{t(a=>({...a,[i.modalId]:{...i,isOpen:!0}})),Be.emit(Xn.modalStateChanged,{...i,isOpen:!0})},s=i=>{t(a=>{const o={...a};return o[i.modalId]&&(o[i.modalId].isOpen=!1),o}),Be.emit(Xn.modalStateChanged,{modalId:i.modalId,isOpen:!1})};return Be.on(Xn.openModalRequest,r),Be.on(Xn.closeModalRequest,s),()=>{Be.off(Xn.openModalRequest,r),Be.off(Xn.closeModalRequest,s)}},[]),p.jsx(p.Fragment,{children:Object.entries(e).map(([r,s])=>{if(!s.isOpen)return null;const i=n[r];if(!i)return console.warn(`[ModalManager] No provider for modalId: ${r}`),null;const a={isOpen:!0,onClose:()=>Be.emit(Xn.closeModalRequest,{modalId:r}),modalProps:s.modalProps,targetId:s.targetId,initialTab:s.initialTab,initialSubTab:s.initialSubTab};return p.jsx(i,{...a},r)})})};let e8=[],t8=null,pc=!1;const xke=({controls:e=[]})=>{const[t,n]=T.useState(!0),[r,s]=T.useState(!1),i=T.useRef(null),a=T.useRef(null),{selectedItemId:o,selectedItemType:l,getConversationById:c}=br(mn(M=>({selectedItemId:M.selectedItemId,selectedItemType:M.selectedItemType,getConversationById:M.getConversationById}))),{getEffectiveProjectSettings:u}=Oa(mn(M=>({getEffectiveProjectSettings:M.getEffectiveProjectSettings}))),{interactions:f,status:m}=Bn(mn(M=>({interactions:M.interactions,status:M.status}))),{globalError:g,isSidebarCollapsed:v,isChatControlPanelOpen:b}=Dy(mn(M=>({globalError:M.globalError,isSidebarCollapsed:M.isSidebarCollapsed,isChatControlPanelOpen:M.isChatControlPanelOpen}))),w=co(mn(M=>Object.values(M.chatControls))),x=T.useMemo(()=>w.filter(M=>(M.panel??"main")==="sidebar"&&(M.show?M.show():!0)),[w]),_=T.useMemo(()=>w.filter(M=>M.panel==="sidebar-footer"&&(M.show?M.show():!0)),[w]),E=T.useMemo(()=>w.filter(M=>M.panel==="header"&&(M.show?M.show():!0)),[w]),C=T.useCallback(()=>{s(M=>!M)},[]);T.useEffect(()=>{r&&s(!1)},[o,l,r]),T.useEffect(()=>{a.current||(a.current=XA({id:"core-litechat-app",name:"LiteChat App Core"}));const M=a.current;BV.initialize(),t8||(t8=(async()=>{if(pc){n(!1);return}n(!0);try{e8=await yke(e,M),pc=!0}catch(q){console.error("[LiteChat] App: Top-level initialization error:",q),pc=!1}finally{n(!1)}})().then(()=>e8))},[e]);const k=T.useRef({itemId:null,itemType:null,effectiveSettingsString:""});T.useEffect(()=>{if(t||!pc||!a.current)return;const M=a.current,L={itemId:o,itemType:l};let q=null;if(l==="project")q=o;else if(l==="conversation"&&o){const z=c(o);q=(z==null?void 0:z.projectId)??null}const P=u(q),V=JSON.stringify(P);(L.itemId!==k.current.itemId||L.itemType!==k.current.itemType||V!==k.current.effectiveSettingsString)&&(M.emit(Tn.initializePromptStateRequest,{effectiveSettings:P}),M.emit(Xn.contextChanged,{selectedItemId:o,selectedItemType:l}),k.current={...L,effectiveSettingsString:V})},[o,l,c,u,t,pc]),T.useEffect(()=>{if(t||!pc||!a.current)return;const M=a.current,L=()=>{let re=null;if(l==="project")re=o;else if(l==="conversation"&&o){const ee=c(o);re=(ee==null?void 0:ee.projectId)??null}const K=u(re);M.emit(Tn.initializePromptStateRequest,{effectiveSettings:K})},q=M.on(Qt.loaded,L),P=M.on(fi.updated,L),V=M.on(Qt.globalSystemPromptChanged,L),z=M.on(Qt.temperatureChanged,L);return()=>{q(),P(),V(),z()}},[o,l,c,u,t,pc]),T.useEffect(()=>{if(t||!pc||!a.current)return;const M=a.current;let L=null;if(b["core-vfs-modal-panel"]||l==="project")if(l==="project")L=o;else if(l==="conversation"){const V=c(o);L=(V==null?void 0:V.projectId)??"orphan"}else L="orphan";else if(l==="conversation"){const V=c(o);L=(V==null?void 0:V.projectId)??"orphan"}let P=null;typeof L=="string"?P=L:L===null?P=null:(console.warn(`[LiteChatVFS] Calculated VFS key was not a string or null. Type: ${typeof L}, Value:`,L,"Defaulting to 'orphan'."),P="orphan"),xs.getState().vfsKey!==P&&M.emit(en.setVfsKeyRequest,{key:P})},[o,l,c,t,pc,b]);const R=async M=>{const L=br.getState(),q=await L.addConversation(M);return console.log("New conversation ID:",q),await L.selectItem(q,"conversation"),console.log("conv selected:",q),q},I=T.useCallback(async M=>{var V;if(!a.current){Le.error("Application core not ready. Please try again.");return}const L=br.getState();let q=L.selectedItemType==="conversation"?L.selectedItemId:null;const P=L.selectedItemType==="project"?L.selectedItemId:L.selectedItemType==="conversation"?((V=L.getConversationById(L.selectedItemId))==null?void 0:V.projectId)??null:null;if(!q)try{q=await R({title:"New Chat",projectId:P}),console.log("New conversation ID 2:",q)}catch(z){console.error("[LiteChat] App: Failed to create new conversation",z),Le.error("Failed to start new chat.");return}try{const z=Ml.getState(),re={...M,metadata:{...M.metadata,modelId:z.modelId}};await XN.submitPrompt(re)}catch(z){console.error("[LiteChat] App: Error submitting prompt:",z),Le.error("Failed to send message.")}},[]),j=l==="conversation"?o:null;return t?p.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:p.jsxs("div",{className:"flex flex-col items-center gap-4",children:[p.jsx(Pn,{className:"h-12 w-12 animate-spin text-primary"}),p.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):p.jsxs(p.Fragment,{children:[p.jsx(wke,{}),p.jsxs("div",{className:"flex h-full w-full border border-border rounded-lg overflow-hidden bg-background text-foreground",children:[p.jsxs("div",{className:ct("hidden md:flex flex-col border-r border-border bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",v?"w-16":"w-64"),children:[p.jsxs("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:[p.jsx("div",{className:ct(v?"hidden":"block"),children:p.jsx(np,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"})}),p.jsx("div",{className:ct(v?"block":"hidden"),children:p.jsx(np,{controls:x,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),p.jsx("div",{className:ct("flex-shrink-0 border-t border-border p-2",v?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:p.jsx(np,{controls:_,panelId:"sidebar-footer",renderMode:v?"icon":"full",className:ct("flex",v?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),r&&p.jsxs("div",{className:"md:hidden fixed inset-0 z-50 flex",children:[p.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm animate-fadeIn",onClick:C}),p.jsxs("div",{className:"relative w-4/5 max-w-xs bg-card border-r border-border h-full flex flex-col animate-slideInFromLeft",children:[p.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[p.jsx("h2",{className:"font-semibold",children:"LiteChat Menu"}),p.jsx("button",{onClick:C,className:"p-1 rounded-md hover:bg-muted","aria-label":"Close menu",children:p.jsx(la,{className:"h-5 w-5"})})]}),p.jsx("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:p.jsx(np,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"})}),p.jsx("div",{className:"flex-shrink-0 border-t border-border p-4",children:p.jsx(np,{controls:_,panelId:"sidebar-footer",renderMode:"full",className:"flex items-center justify-between"})})]})]}),p.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[p.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-border bg-card flex-shrink-0",children:[p.jsx("button",{className:"md:hidden p-2 rounded-md hover:bg-muted",onClick:C,"aria-label":"Open menu",children:p.jsx(RX,{className:"h-5 w-5"})}),p.jsx(np,{controls:E,panelId:"header",className:"flex items-center justify-end gap-1 flex-grow"})]}),p.jsx(ske,{conversationId:j,interactions:f,status:m,className:"flex-grow overflow-y-hidden"}),g&&p.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",g]}),p.jsx(rse,{InputAreaRenderer:LV,onSubmit:I,className:"border-t border-border bg-card flex-shrink-0",inputAreaRef:i,selectedItemId:o,selectedItemType:l})]})]}),p.jsx(cke,{richColors:!0,position:"bottom-right",closeButton:!0})]})},_ke="prism-theme-link",Ske="prism-default-light-theme-link",Eke="prism-default-dark-theme-link",Cke="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css",kke="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css",sT=e=>{let t=document.getElementById(e);return t||(t=document.createElement("link"),t.id=e,t.rel="stylesheet",document.head.appendChild(t)),t},Tke=()=>{const{prismThemeUrl:e,theme:t}=ir(mn(s=>({prismThemeUrl:s.prismThemeUrl,theme:s.theme}))),n=T.useMemo(()=>typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),r=T.useMemo(()=>{const s=t==="system"?n:t;return s==="dark"||s==="TijuDark"?"dark":"light"},[t,n]);return T.useEffect(()=>{if(typeof window>"u")return;const s=sT(Ske),i=sT(Eke),a=sT(_ke);return s.disabled=!0,i.disabled=!0,a.disabled=!0,s.href=Cke,i.href=kke,e?(a.href=e,a.disabled=!1):(console.log(r),r==="dark"?i.disabled=!1:s.disabled=!1),()=>{}},[e,r]),null},iT=e=>e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),aT=["background","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","border","input","ring","chart1","chart2","chart3","chart4","chart5","sidebar","sidebarForeground","sidebarPrimary","sidebarPrimaryForeground","sidebarAccent","sidebarAccentForeground","sidebarBorder","sidebarRing"],Ake=()=>{const{theme:e,customFontFamily:t,customFontSize:n,customThemeColors:r}=ir(mn(s=>({theme:s.theme,customFontFamily:s.customFontFamily,customFontSize:s.customFontSize,customThemeColors:s.customThemeColors})));return T.useEffect(()=>{const s=document.body,i=document.documentElement;s.classList.remove("light","dark","TijuLight","TijuDark","custom"),aT.forEach(a=>{i.style.removeProperty(`--${iT(a)}`)}),i.style.removeProperty("--custom-font-family"),i.style.removeProperty("--custom-font-size"),e==="light"?s.classList.add("light"):e==="dark"?s.classList.add("dark"):e==="TijuLight"?s.classList.add("TijuLight"):e==="TijuDark"?s.classList.add("TijuDark"):e==="custom"?(s.classList.add("custom"),t?i.style.setProperty("--custom-font-family",t):i.style.removeProperty("--custom-font-family"),n?i.style.setProperty("--custom-font-size",`${n}px`):i.style.removeProperty("--custom-font-size"),r&&Object.entries(r).forEach(([a,o])=>{if(o&&aT.includes(a)){const l=`--${iT(a)}`;i.style.setProperty(l,o)}else if(aT.includes(a)){const l=`--${iT(a)}`;i.style.removeProperty(l)}})):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.add("light")},[e,t,n,r]),null},Rke=e=>{const{size:t=24,color:n="currentColor",...r}=e;return p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[p.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:p.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),p.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[p.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),p.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),p.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[p.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),p.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),p.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:p.jsx("path",{d:`M2147 1750 c-26 15 -48 65 -41 94
             15 61 181 167 304 196
             30 7 100 12 155 12
             81 -1 115 -6 178 -27
             135 -45 247 -133 249 -194
             2 -60 -48 -103 -104 -88
             -13 3 -50 25 -83 50
             -85 64 -172 90 -280 84
             -92 -6 -165 -35 -259 -103
             -49 -35 -86 -43 -119 -24z`})})]})},n8="0.1.0-dev",r8="https://github.com/DimitriGilbert/LiteChat",s8=({textToCopy:e,label:t,className:n})=>{const[r,s]=T.useState(!1),i=async()=>{try{await navigator.clipboard.writeText(e),s(!0),Le.success(`${t} copied to clipboard!`),setTimeout(()=>s(!1),2e3)}catch(a){Le.error(`Failed to copy ${t.toLowerCase()}.`),console.error(`Clipboard copy failed for ${t}:`,a)}};return p.jsxs(Ct,{variant:"outline",onClick:i,className:n,children:[r?p.jsx(Ui,{className:"mr-2 h-4 w-4 text-green-500"}):p.jsx($Y,{className:"mr-2 h-4 w-4"}),r?"Copied!":`Copy ${t}`]})};class Nke extends T.Component{constructor(){super(...arguments);Ne(this,"state",{hasError:!1,error:null,errorInfo:null});Ne(this,"handleReportOnGitHub",async()=>{const n=this.generateErrorReport(!0);try{await navigator.clipboard.writeText(n),Le.success("Error report copied to clipboard. Paste it into the GitHub issue body.");const r=`${r8}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(r,"_blank","noopener,noreferrer")}catch(r){Le.error("Failed to copy error report. Please copy manually."),console.error("Clipboard copy failed for GitHub report:",r);const s=`${r8}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(s,"_blank","noopener,noreferrer")}})}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,r){console.error("Uncaught error:",n,r),this.setState({errorInfo:r})}getGitHubIssueTitle(){var i;const{error:n,errorInfo:r}=this.state;let s="Crash Report: ";if(r!=null&&r.componentStack){const a=(i=r.componentStack.trim().split(/\s+at\s+/)[1])==null?void 0:i.split(" ")[0];a&&(s+=`Error in <${a}> - `)}return s+=(n==null?void 0:n.message.substring(0,70))??"Unknown Error",n&&n.message.length>70&&(s+="..."),s}generateErrorReport(n=!1){const{error:r,errorInfo:s}=this.state,i=`
`,a=n?"```":"";let o=`## LiteChat Error Report${i}${i}`;return o+=`**Version:** ${n8}${i}`,o+=`**Timestamp:** ${new Date().toISOString()}${i}`,o+=`**User Agent:** ${typeof navigator<"u"?navigator.userAgent:"N/A"}${i}${i}`,r?o+=`**Error Message:**${i}${a}${i}${r.message}${i}${a}${i}${i}`:o+=`**Error Message:** Unknown Error${i}${i}`,s!=null&&s.componentStack&&(o+=`**Component Stack:**${i}${a}text${i}${s.componentStack.trim()}${i}${a}${i}${i}`),r!=null&&r.stack&&(o+=`**Error Stack Trace:**${i}${a}text${i}${r.stack.trim()}${i}${a}${i}${i}`),o+=`**Steps to Reproduce (Please Describe):**${i}1. ...${i}2. ...${i}${i}`,o+=`**Expected Behavior:**${i}...${i}${i}`,o+=`**Actual Behavior:**${i}...${i}`,o}generateAIPrompt(){var i,a;const{error:n,errorInfo:r}=this.state;return`I encountered an error in a React application (LiteChat v${n8}). Please help me debug it.

Error Message:
\`\`\`
${(n==null?void 0:n.message)??"Unknown Error"}
\`\`\`

Component Stack (if available):
\`\`\`
${((i=r==null?void 0:r.componentStack)==null?void 0:i.trim())??"Not available"}
\`\`\`

Error Stack Trace (if available):
\`\`\`
${((a=n==null?void 0:n.stack)==null?void 0:a.trim())??"Not available"}
\`\`\`

Based on this information, what are the likely causes and potential solutions? Focus on React-specific issues if the component stack is present.`}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:p.jsx("div",{role:"alert",className:"flex flex-col items-center justify-center h-screen w-screen p-4 bg-background text-foreground",children:p.jsxs("div",{className:"max-w-2xl w-full border border-destructive bg-destructive/10 rounded-lg p-6 text-center shadow-lg",children:[p.jsx(Rke,{className:"h-24 w-24 text-destructive mx-auto mb-4"}),p.jsx("h1",{className:"text-2xl font-semibold text-destructive mb-2",children:"Oops! Something went wrong."}),p.jsx("p",{className:"text-destructive/90 mb-4",children:"LiteChat encountered an unexpected error. Please try refreshing the page. If the problem persists, consider reporting the issue. Copy the details and paste them into the GitHub issue."}),p.jsx("pre",{className:"text-left text-xs bg-destructive/10 border border-destructive/30 rounded p-3 max-h-32 overflow-auto mb-4 font-mono text-destructive/80",children:((n=this.state.error)==null?void 0:n.message)??"Unknown Error"}),p.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[p.jsx(Ct,{variant:"destructive",onClick:()=>window.location.reload(),children:"Refresh Page"}),p.jsx(s8,{textToCopy:this.generateErrorReport(),label:"Details"}),p.jsx(s8,{textToCopy:this.generateAIPrompt(),label:"AI Debug Prompt"}),p.jsxs(Ct,{variant:"outline",onClick:this.handleReportOnGitHub,children:[p.jsx(sF,{className:"mr-2 h-4 w-4"})," Report on GitHub"]})]})]})}):this.props.children}}const $V=(e,t)=>{if(!t)return null;let n=qu,r="text-muted-foreground/70",s=`Linked to ${t}`;switch(e){case"syncing":n=Pn,r="animate-spin text-blue-500",s=`Syncing with ${t}...`;break;case"error":n=Ac,r="text-destructive",s=`Sync error with ${t}`;break;case"needs-sync":n=bR,r="text-orange-500",s=`Needs sync with ${t}`;break;case"idle":n=O1,r="text-green-500",s=`Synced with ${t}`;break;default:n=qu,r="text-muted-foreground/70",s=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(n,{className:ct("h-3 w-3 ml-1 flex-shrink-0",r)})}),p.jsx(cr,{side:"right",children:s})]})})},zV=T.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:s,onSelectItem:i,onDeleteConversation:a,onDeleteProject:o,onExportConversation:l,onExportProject:c,expandedProjects:u,toggleProjectExpansion:f,editingItemId:m,editingItemType:g,handleStartEditing:v,handleSaveEdit:b,handleCancelEdit:w,isSavingEdit:x,originalNameToCompare:_})=>{const E=e.id===n,C=e.itemType==="project",k=e.id===m&&e.itemType===g,[R,I]=T.useState(C?e.name:e.title),j=T.useRef(null);T.useEffect(()=>{if(k){const ge=C?e.name:e.title;I(ge),requestAnimationFrame(()=>{var Me,Pe;(Me=j.current)==null||Me.focus(),(Pe=j.current)==null||Pe.select()})}},[k,e,C]),T.useEffect(()=>{if(!k){const ge=C?e.name:e.title;R!==ge&&I(ge)}},[C?e.name:e.title,k,R,C]);const M=C&&u.has(e.id),L=C,q=!C&&e.syncRepoId?r[e.id]:void 0,P=!C&&e.syncRepoId?s.get(e.syncRepoId):void 0,V=!C&&P?$V(q,P):null,z=ge=>{ge.stopPropagation(),Be.emit(Xn.openModalRequest,{modalId:"projectSettingsModal",targetId:e.id})},re=()=>{k||(C&&f(e.id),i(e.id,e.itemType))},K=ge=>{ge.stopPropagation(),C?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,ge):a(e.id,ge)},ee=ge=>{ge.stopPropagation(),v(e)},W=()=>{I(_),w(e.itemType==="project"&&_==="New Project")},se=async()=>{if(x)return;const ge=R.trim();await b(e.id,e.itemType,ge)},Y=()=>{var Pe;if(x)return;const ge=R.trim(),Me=e.itemType==="project"&&_==="New Project";if(!ge){_!=="New Project"?(Le.error("Name cannot be empty."),I(_),(Pe=j.current)==null||Pe.focus()):W();return}ge!==_||Me?se():W()},te=ge=>{ge.key==="Enter"?(ge.preventDefault(),se()):ge.key==="Escape"&&(ge.preventDefault(),W())},Q=C?e.name:e.title,ae=x?Pn:Ui,xe=x?"h-3 w-3 animate-spin":"h-3 w-3";return p.jsxs("li",{className:ct("relative flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!k&&"hover:bg-muted/50 hover:text-primary/80",E&&!k?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",k&&"bg-muted ring-1 ring-primary",!k&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:re,title:k?"":Q,children:[p.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[L&&p.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:ge=>{ge.stopPropagation(),f(e.id)},children:M?p.jsx(Fl,{className:"h-3 w-3 text-muted-foreground"}):p.jsx(nF,{className:"h-3 w-3 text-muted-foreground"})}),!L&&p.jsx("span",{className:"w-3 flex-shrink-0"}),C?p.jsx(Uu,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):p.jsx(_T,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),k?p.jsx(zn,{ref:j,value:R,onChange:ge=>I(ge.target.value),onKeyDown:te,onBlur:Y,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:ge=>ge.stopPropagation(),disabled:x}):p.jsx("span",{className:"truncate min-w-0 flex-1",children:Q}),V]}),p.jsx("div",{className:ct("items-center flex-shrink-0 ml-1",k?"flex":"hidden group-hover:flex transition-all duration-150"),onClick:ge=>ge.stopPropagation(),children:k?p.jsxs(p.Fragment,{children:[p.jsx(gn,{tooltipText:"Save (Enter)",onClick:ge=>{ge.stopPropagation(),se()},disabled:x||!R.trim(),"aria-label":"Save changes",icon:p.jsx(ae,{}),iconClassName:xe,className:"h-5 w-5 text-green-500 hover:text-green-600"}),p.jsx(gn,{tooltipText:"Cancel (Esc)",onClick:ge=>{ge.stopPropagation(),W()},disabled:x,"aria-label":"Cancel edit",icon:p.jsx(la,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):p.jsxs(p.Fragment,{children:[C&&p.jsx(gn,{tooltipText:"Project Settings",onClick:z,"aria-label":`Settings for ${Q}`,icon:p.jsx(DY,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),p.jsx(gn,{tooltipText:"Edit",onClick:ee,"aria-label":`Edit ${Q}`,icon:p.jsx(Vy,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),C?p.jsx(gn,{tooltipText:"Export Project (JSON)",onClick:ge=>c(e.id,ge),"aria-label":`Export project ${Q}`,icon:p.jsx(XY,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):p.jsxs("div",{className:"relative group/export",children:[p.jsx(gn,{tooltipText:"Export Conversation","aria-label":`Export ${Q}`,icon:p.jsx(vf,{}),className:"h-5 w-5 text-muted-foreground group-hover/export:text-foreground"}),p.jsxs("div",{className:`absolute right-0 top-full mt-1 hidden group-hover/export:flex
                                 bg-popover border border-border rounded-md shadow-lg p-0.5 z-10 gap-0.5`,onClick:ge=>ge.stopPropagation(),children:[p.jsx(Ct,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ge=>l(e.id,"json",ge),children:"JSON"}),p.jsx(Ct,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ge=>l(e.id,"md",ge),children:"MD"})]})]}),p.jsx(gn,{tooltipText:"Delete",onClick:K,"aria-label":`Delete ${Q}`,icon:p.jsx(Aa,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]})});zV.displayName="ConversationItemRenderer";function Ike({updateProject:e,updateConversation:t,deleteProject:n}){const[r,s]=T.useState(null),[i,a]=T.useState(null),[o,l]=T.useState(""),[c,u]=T.useState(!1),f=T.useCallback(v=>{s(v.id),a(v.itemType);const b=v.itemType==="project"?v.name:v.title;l(b),u(!1)},[]),m=T.useCallback(v=>{const b=r,w=v??(i==="project"&&o==="New Project");s(null),a(null),l(""),u(!1),w&&b&&n(b).catch(x=>{console.error("Failed to delete new project on cancel:",x),Le.error("Failed to clean up cancelled new project.")})},[r,i,o,n]),g=T.useCallback(async(v,b,w)=>{if(v!==r||b!==i||c)return;const x=w==null?void 0:w.trim();if(!x){Le.error("Name cannot be empty.");return}if(x===o&&!(b==="project"&&o==="New Project")){m();return}u(!0);try{b==="project"?await e(v,{name:x}):await t(v,{title:x}),Le.success("Item renamed successfully."),s(null),a(null),l("")}catch(E){console.error("Failed to save item name:",E),Le.error(`Failed to rename item: ${E instanceof Error?E.message:String(E)}`)}finally{u(!1)}},[r,i,c,e,t,m,o]);return{editingItemId:r,editingItemType:i,isSavingEdit:c,handleStartEditing:f,handleSaveEdit:g,handleCancelEdit:m,originalNameToCompare:o}}const UV=(e,t,n,r,s,i,a,o,l)=>{if(!n)return!0;const c=`${t}-${e}`;if(l[c]!==void 0)return l[c];let u=!1;{const f=i.get(e);if(f)if(f.name.toLowerCase().includes(n))u=!0;else{const m=o.get(e)||[],g=a.get(e)||[];for(const v of g)if(v.title.toLowerCase().includes(n)){u=!0;break}if(!u){for(const v of m)if(UV(v.id,"project",n,r,s,i,a,o,l)){u=!0;break}}}}return l[c]=u,u},jke=({module:e})=>{const t=T.useRef(null),n=T.useRef(null),[r,s]=T.useState(!1),[,i]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>i({})),e.isLoading&&!br.getState().isLoading&&!Oa.getState().isLoading&&e.setIsLoading(!1),()=>e.setNotifyCallback(null)),[e]),T.useEffect(()=>{const me=t.current;if(me){const Te=me.querySelector("[data-radix-scroll-area-viewport]");if(Te&&n.current!==Te?(n.current=Te,r||s(!0),i({})):!Te&&n.current&&(n.current=null,s(!1)),!n.current){const ce=new MutationObserver(()=>{const oe=me.querySelector("[data-radix-scroll-area-viewport]");oe&&n.current!==oe&&(n.current=oe,s(!0),i({}),ce.disconnect())});return ce.observe(me,{childList:!0,subtree:!0}),()=>ce.disconnect()}}},[t.current,r]);const{selectedItemId:a,selectedItemType:o,conversations:l,syncRepos:c,conversationSyncStatus:u,selectItem:f,addConversation:m,updateConversation:g,deleteConversation:v,exportConversation:b,exportProject:w,getConversationById:x}=br(mn(me=>({selectedItemId:me.selectedItemId,selectedItemType:me.selectedItemType,conversations:me.conversations,syncRepos:me.syncRepos,conversationSyncStatus:me.conversationSyncStatus,selectItem:me.selectItem,addConversation:me.addConversation,updateConversation:me.updateConversation,deleteConversation:me.deleteConversation,exportConversation:me.exportConversation,exportProject:me.exportProject,getConversationById:me.getConversationById}))),{projects:_,addProject:E,updateProject:C,deleteProject:k,getProjectById:R}=Oa(mn(me=>({projects:me.projects,addProject:me.addProject,updateProject:me.updateProject,deleteProject:me.deleteProject,getProjectById:me.getProjectById}))),I=e.isLoading,[j,M]=dt.useState(new Set),[L,q]=T.useState(""),P=Ike({updateProject:C,updateConversation:g,deleteProject:k}),{editingItemId:V,editingItemType:z,isSavingEdit:re,handleStartEditing:K,handleSaveEdit:ee,handleCancelEdit:W,originalNameToCompare:se}=P,Y=T.useCallback(me=>{M(Te=>{const ce=new Set(Te);return ce.has(me)?ce.delete(me):ce.add(me),ce})},[]),te=T.useCallback(()=>{if(o==="project")return a;if(o==="conversation"&&a){const me=x(a);return(me==null?void 0:me.projectId)??null}return null},[a,o,x]),Q=T.useCallback(async()=>{if(!V)try{const me=te(),Te=await m({title:"New Chat",projectId:me});f(Te,"conversation")}catch(me){console.error("Failed to create new chat:",me),Le.error("Failed to create new chat.")}},[V,te,m,f]),ae=T.useCallback(async()=>{if(!V)try{const me=te(),Te=await E({name:"New Project",parentId:me});f(Te,"project"),me&&M(ce=>new Set(ce).add(me)),setTimeout(()=>{const ce=R(Te);ce&&K({...ce,itemType:"project"})},50)}catch(me){console.error("Failed to create new project:",me)}},[V,te,E,f,R,K]),xe=T.useCallback((me,Te)=>{me===V&&Te===z||(V&&(me!==V||Te!==z)&&W(),(me!==a||Te!==o)&&f(me,Te))},[V,z,a,o,W,f]),ge=T.useCallback((me,Te)=>{Te.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&v(me).catch(ce=>{console.error("Failed to delete conversation:",ce),Le.error("Failed to delete conversation.")})},[v]),Me=T.useCallback((me,Te)=>{Te.stopPropagation(),k(me).catch(ce=>{console.error("Failed to delete project:",ce),Le.error("Failed to delete project.")})},[k]),Pe=T.useCallback(async(me,Te,ce)=>{ce.stopPropagation();try{await b(me,Te)}catch(oe){console.error(`Failed to export conversation as ${Te}:`,oe)}},[b]),Ie=T.useCallback(async(me,Te)=>{Te.stopPropagation();try{await w(me)}catch(ce){console.error("Failed to export project:",ce)}},[w]),Ce=T.useMemo(()=>new Map((c||[]).map(me=>[me.id,me.name])),[c]),{projectsById:He,conversationsByProjectId:it,projectsByParentId:Ge}=T.useMemo(()=>{const me=new Map(_.map(oe=>[oe.id,oe])),Te=new Map;l.forEach(oe=>{const ne=oe.projectId??null;Te.has(ne)||Te.set(ne,[]),Te.get(ne).push(oe)});const ce=new Map;return _.forEach(oe=>{const ne=oe.parentId??null;ce.has(ne)||ce.set(ne,[]),ce.get(ne).push(oe)}),{projectsById:me,conversationsByProjectId:Te,projectsByParentId:ce}},[_,l]),Re=T.useMemo(()=>{const me=[],Te=L.toLowerCase(),ce={};function oe(ne,Se){const Fe=(Ge.get(ne)||[]).filter(St=>UV(St.id,"project",Te,_,l,He,it,Ge,ce)),ke=(it.get(ne)||[]).filter(St=>St.title.toLowerCase().includes(Te)),Xe=[...Fe,...ke];Xe.sort((St,ht)=>new Date(ht.updatedAt).getTime()-new Date(St.updatedAt).getTime()),Xe.forEach(St=>{"path"in St?(me.push({id:`project-${St.id}`,originalId:St.id,type:"project",level:Se,data:St,updatedAt:St.updatedAt}),j.has(St.id)&&oe(St.id,Se+1)):me.push({id:`conversation-${St.id}`,originalId:St.id,type:"conversation",level:Se,data:St,updatedAt:St.updatedAt})})}return oe(null,0),me},[_,l,L,j,He,it,Ge]),H=$I({count:Re.length,getScrollElement:()=>n.current,estimateSize:()=>30,overscan:10});return p.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[p.jsx("h3",{className:"text-sm font-semibold",children:"Workspace"}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{size:"sm",variant:"ghost",onClick:ae,"aria-label":"New Project",disabled:I||!!V,className:"h-7 w-7 p-0",children:p.jsx(oF,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"bottom",children:"New Project"})]})}),p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{size:"sm",variant:"ghost",onClick:Q,"aria-label":"New Chat",disabled:I||!!V,className:"h-7 w-7 p-0",children:p.jsx(sm,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"bottom",children:"New Chat"})]})})]})]}),p.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[p.jsx(ki,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),p.jsx(zn,{type:"search",placeholder:"Filter...",value:L,onChange:me=>q(me.target.value),className:"h-8 text-xs pl-8",disabled:I})]}),p.jsxs(Hi,{className:"flex-grow",ref:t,children:[I&&Re.length===0?p.jsxs("div",{className:"space-y-1 p-1",children:[p.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),p.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),p.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):!I&&Re.length===0?p.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:L.trim()!==""?"No items match your filter.":"Workspace is empty."}):r&&p.jsx("div",{style:{height:`${H.getTotalSize()}px`,width:"100%",position:"relative"},children:H.getVirtualItems().map(me=>{const Te=Re[me.index];if(!Te)return null;const ce={...Te.data,itemType:Te.type};return p.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${me.size}px`,transform:`translateY(${me.start}px)`},className:"px-1",children:p.jsx(zV,{item:ce,level:Te.level,selectedItemId:a,conversationSyncStatus:u,repoNameMap:Ce,onSelectItem:()=>xe(Te.originalId,Te.type),onDeleteConversation:ge,onDeleteProject:Me,onExportConversation:Pe,onExportProject:Ie,expandedProjects:j,toggleProjectExpansion:Y,editingItemId:V,editingItemType:z,handleStartEditing:K,handleSaveEdit:ee,handleCancelEdit:W,isSavingEdit:re,originalNameToCompare:se})},Te.id)})}),!r&&!I&&p.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},Mke=({module:e})=>{const{selectedItemType:t}=br(mn(r=>({selectedItemType:r.selectedItemType})));return e.isLoading?p.jsx(Pn,{className:"h-5 w-5 animate-spin text-muted-foreground"}):t==="project"?p.jsx(Uu,{className:"h-5 w-5 text-primary"}):t==="conversation"?p.jsx(C4,{className:"h-5 w-5 text-primary"}):p.jsx(C4,{className:"h-5 w-5 text-muted-foreground"})};class Oke{constructor(){Ne(this,"id","core-conversation-list");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"isLoading",!0);Ne(this,"conversationsLoading",!0);Ne(this,"projectsLoading",!0);Ne(this,"notifyComponentUpdate",null);Ne(this,"setIsLoading",t=>{var n;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.conversationsLoading=br.getState().isLoading,this.projectsLoading=Oa.getState().isLoading,this.updateCombinedLoadingState(),t.emit(Mn.loadConversationsRequest,void 0),t.emit(fi.loadProjectsRequest,void 0);const n=t.on(Mn.conversationsLoaded,()=>{this.conversationsLoading=!1,this.updateCombinedLoadingState()}),r=t.on(fi.loaded,()=>{this.projectsLoading=!1,this.updateCombinedLoadingState()}),s=t.on(Mn.loadingStateChanged,a=>{a.isLoading!==this.conversationsLoading&&(this.conversationsLoading=a.isLoading,this.updateCombinedLoadingState())}),i=t.on(fi.loadingStateChanged,a=>{a.isLoading!==this.projectsLoading&&(this.projectsLoading=a.isLoading,this.updateCombinedLoadingState())});this.eventUnsubscribers.push(n,r,s,i)}updateCombinedLoadingState(){var n;const t=this.conversationsLoading||this.projectsLoading;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Module "${this.id}" already registered. Skipping.`);return}this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar",status:()=>this.isLoading?"loading":"ready",renderer:()=>dt.createElement(jke,{module:this}),iconRenderer:()=>dt.createElement(Mke,{module:this}),show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const i8=({module:e})=>{const t=(n,r)=>{e.openSettingsModal(n,r)};return p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",onClick:()=>t(),className:"h-8 w-8","aria-label":"Open Settings",children:p.jsx(ST,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"top",children:"Settings"})]})})};var nS="Dialog",[qV,g4e]=Ii(nS),[Pke,Wo]=qV(nS),VV=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,o=T.useRef(null),l=T.useRef(null),[c,u]=Lo({prop:r,defaultProp:s??!1,onChange:i,caller:nS});return p.jsx(Pke,{scope:t,triggerRef:o,contentRef:l,contentId:Qs(),titleId:Qs(),descriptionId:Qs(),open:c,onOpenChange:u,onOpenToggle:T.useCallback(()=>u(f=>!f),[u]),modal:a,children:n})};VV.displayName=nS;var HV="DialogTrigger",Dke=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wo(HV,n),i=Nn(t,s.triggerRef);return p.jsx(sn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":VI(s.open),...r,ref:i,onClick:Ut(e.onClick,s.onOpenToggle)})});Dke.displayName=HV;var UI="DialogPortal",[Fke,GV]=qV(UI,{forceMount:void 0}),KV=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=Wo(UI,t);return p.jsx(Fke,{scope:t,forceMount:n,children:T.Children.map(r,a=>p.jsx(si,{present:n||i.open,children:p.jsx(fm,{asChild:!0,container:s,children:a})}))})};KV.displayName=UI;var k1="DialogOverlay",WV=T.forwardRef((e,t)=>{const n=GV(k1,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Wo(k1,e.__scopeDialog);return i.modal?p.jsx(si,{present:r||i.open,children:p.jsx(Bke,{...s,ref:t})}):null});WV.displayName=k1;var Lke=zu("DialogOverlay.RemoveScroll"),Bke=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wo(k1,n);return p.jsx(Ib,{as:Lke,allowPinchZoom:!0,shards:[s.contentRef],children:p.jsx(sn.div,{"data-state":VI(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Df="DialogContent",ZV=T.forwardRef((e,t)=>{const n=GV(Df,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Wo(Df,e.__scopeDialog);return p.jsx(si,{present:r||i.open,children:i.modal?p.jsx($ke,{...s,ref:t}):p.jsx(zke,{...s,ref:t})})});ZV.displayName=Df;var $ke=T.forwardRef((e,t)=>{const n=Wo(Df,e.__scopeDialog),r=T.useRef(null),s=Nn(t,n.contentRef,r);return T.useEffect(()=>{const i=r.current;if(i)return Z_(i)},[]),p.jsx(YV,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ut(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Ut(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&i.preventDefault()}),onFocusOutside:Ut(e.onFocusOutside,i=>i.preventDefault())})}),zke=T.forwardRef((e,t)=>{const n=Wo(Df,e.__scopeDialog),r=T.useRef(!1),s=T.useRef(!1);return p.jsx(YV,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),YV=T.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,o=Wo(Df,n),l=T.useRef(null),c=Nn(t,l);return K_(),p.jsxs(p.Fragment,{children:[p.jsx(Nb,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:p.jsx(cm,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":VI(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),p.jsxs(p.Fragment,{children:[p.jsx(Uke,{titleId:o.titleId}),p.jsx(Vke,{contentRef:l,descriptionId:o.descriptionId})]})]})}),qI="DialogTitle",XV=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wo(qI,n);return p.jsx(sn.h2,{id:s.titleId,...r,ref:t})});XV.displayName=qI;var JV="DialogDescription",QV=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wo(JV,n);return p.jsx(sn.p,{id:s.descriptionId,...r,ref:t})});QV.displayName=JV;var eH="DialogClose",tH=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wo(eH,n);return p.jsx(sn.button,{type:"button",...r,ref:t,onClick:Ut(e.onClick,()=>s.onOpenChange(!1))})});tH.displayName=eH;function VI(e){return e?"open":"closed"}var nH="DialogTitleWarning",[y4e,rH]=sse(nH,{contentName:Df,titleName:qI,docsSlug:"dialog"}),Uke=({titleId:e})=>{const t=rH(nH),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return T.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},qke="DialogDescriptionWarning",Vke=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${rH(qke).contentName}}.`;return T.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},sH=VV,iH=KV,aH=WV,oH=ZV,Hke=XV,Gke=QV,lH=tH;function rS({...e}){return p.jsx(sH,{"data-slot":"dialog",...e})}function Kke({...e}){return p.jsx(iH,{"data-slot":"dialog-portal",...e})}function Wke({...e}){return p.jsx(lH,{"data-slot":"dialog-close",...e})}function Zke({className:e,...t}){return p.jsx(aH,{"data-slot":"dialog-overlay",className:ct("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function sS({className:e,children:t,...n}){return p.jsxs(Kke,{"data-slot":"dialog-portal",children:[p.jsx(Zke,{}),p.jsxs(oH,{"data-slot":"dialog-content",className:ct("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,p.jsxs(lH,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[p.jsx(la,{}),p.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function iS({className:e,...t}){return p.jsx("div",{"data-slot":"dialog-header",className:ct("flex flex-col gap-2 text-center sm:text-left",e),...t})}function aS({className:e,...t}){return p.jsx("div",{"data-slot":"dialog-footer",className:ct("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function oS({className:e,...t}){return p.jsx(Hke,{"data-slot":"dialog-title",className:ct("text-lg leading-none font-semibold",e),...t})}function lS({className:e,...t}){return p.jsx(Gke,{"data-slot":"dialog-description",className:ct("text-muted-foreground text-sm",e),...t})}var oT="rovingFocusGroup.onEntryFocus",Yke={bubbles:!1,cancelable:!0},Fb="RovingFocusGroup",[JA,cH,Xke]=G_(Fb),[Jke,cS]=Ii(Fb,[Xke]),[Qke,eTe]=Jke(Fb),uH=T.forwardRef((e,t)=>p.jsx(JA.Provider,{scope:e.__scopeRovingFocusGroup,children:p.jsx(JA.Slot,{scope:e.__scopeRovingFocusGroup,children:p.jsx(tTe,{...e,ref:t})})}));uH.displayName=Fb;var tTe=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...f}=e,m=T.useRef(null),g=Nn(t,m),v=Am(i),[b,w]=Lo({prop:a,defaultProp:o??null,onChange:l,caller:Fb}),[x,_]=T.useState(!1),E=Xs(c),C=cH(n),k=T.useRef(!1),[R,I]=T.useState(0);return T.useEffect(()=>{const j=m.current;if(j)return j.addEventListener(oT,E),()=>j.removeEventListener(oT,E)},[E]),p.jsx(Qke,{scope:n,orientation:r,dir:v,loop:s,currentTabStopId:b,onItemFocus:T.useCallback(j=>w(j),[w]),onItemShiftTab:T.useCallback(()=>_(!0),[]),onFocusableItemAdd:T.useCallback(()=>I(j=>j+1),[]),onFocusableItemRemove:T.useCallback(()=>I(j=>j-1),[]),children:p.jsx(sn.div,{tabIndex:x||R===0?-1:0,"data-orientation":r,...f,ref:g,style:{outline:"none",...e.style},onMouseDown:Ut(e.onMouseDown,()=>{k.current=!0}),onFocus:Ut(e.onFocus,j=>{const M=!k.current;if(j.target===j.currentTarget&&M&&!x){const L=new CustomEvent(oT,Yke);if(j.currentTarget.dispatchEvent(L),!L.defaultPrevented){const q=C().filter(K=>K.focusable),P=q.find(K=>K.active),V=q.find(K=>K.id===b),re=[P,V,...q].filter(Boolean).map(K=>K.ref.current);hH(re,u)}}k.current=!1}),onBlur:Ut(e.onBlur,()=>_(!1))})})}),dH="RovingFocusGroupItem",fH=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:a,...o}=e,l=Qs(),c=i||l,u=eTe(dH,n),f=u.currentTabStopId===c,m=cH(n),{onFocusableItemAdd:g,onFocusableItemRemove:v,currentTabStopId:b}=u;return T.useEffect(()=>{if(r)return g(),()=>v()},[r,g,v]),p.jsx(JA.ItemSlot,{scope:n,id:c,focusable:r,active:s,children:p.jsx(sn.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Ut(e.onMouseDown,w=>{r?u.onItemFocus(c):w.preventDefault()}),onFocus:Ut(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Ut(e.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){u.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const x=sTe(w,u.orientation,u.dir);if(x!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let E=m().filter(C=>C.focusable).map(C=>C.ref.current);if(x==="last")E.reverse();else if(x==="prev"||x==="next"){x==="prev"&&E.reverse();const C=E.indexOf(w.currentTarget);E=u.loop?iTe(E,C+1):E.slice(C+1)}setTimeout(()=>hH(E))}}),children:typeof a=="function"?a({isCurrentTabStop:f,hasTabStop:b!=null}):a})})});fH.displayName=dH;var nTe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function rTe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function sTe(e,t,n){const r=rTe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return nTe[r]}function hH(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function iTe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var pH=uH,mH=fH,uS="Tabs",[aTe,b4e]=Ii(uS,[cS]),gH=cS(),[oTe,HI]=aTe(uS),yH=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=Am(o),[f,m]=Lo({prop:r,onChange:s,defaultProp:i??"",caller:uS});return p.jsx(oTe,{scope:n,baseId:Qs(),value:f,onValueChange:m,orientation:a,dir:u,activationMode:l,children:p.jsx(sn.div,{dir:u,"data-orientation":a,...c,ref:t})})});yH.displayName=uS;var bH="TabsList",vH=T.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=HI(bH,n),a=gH(n);return p.jsx(pH,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:p.jsx(sn.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});vH.displayName=bH;var wH="TabsTrigger",xH=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,a=HI(wH,n),o=gH(n),l=EH(a.baseId,r),c=CH(a.baseId,r),u=r===a.value;return p.jsx(mH,{asChild:!0,...o,focusable:!s,active:u,children:p.jsx(sn.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:t,onMouseDown:Ut(e.onMouseDown,f=>{!s&&f.button===0&&f.ctrlKey===!1?a.onValueChange(r):f.preventDefault()}),onKeyDown:Ut(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&a.onValueChange(r)}),onFocus:Ut(e.onFocus,()=>{const f=a.activationMode!=="manual";!u&&!s&&f&&a.onValueChange(r)})})})});xH.displayName=wH;var _H="TabsContent",SH=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...a}=e,o=HI(_H,n),l=EH(o.baseId,r),c=CH(o.baseId,r),u=r===o.value,f=T.useRef(u);return T.useEffect(()=>{const m=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(m)},[]),p.jsx(si,{present:s||u,children:({present:m})=>p.jsx(sn.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!m,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:m&&i})})});SH.displayName=_H;function EH(e,t){return`${e}-trigger-${t}`}function CH(e,t){return`${e}-content-${t}`}var lTe=yH,cTe=vH,uTe=xH,dTe=SH;function fTe({className:e,...t}){return p.jsx(lTe,{"data-slot":"tabs",className:ct("flex flex-col gap-2",e),...t})}function hTe({className:e,...t}){return p.jsx(cTe,{"data-slot":"tabs-list",className:ct("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function pTe({className:e,...t}){return p.jsx(uTe,{"data-slot":"tabs-trigger",className:ct("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function mTe({className:e,...t}){return p.jsx(dTe,{"data-slot":"tabs-content",className:ct("flex-1 outline-none",e),...t})}const Vc=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:s,listClassName:i,contentContainerClassName:a,scrollable:o})=>{var g;const[l,c]=T.useState(n??t??((g=e[0])==null?void 0:g.value));T.useEffect(()=>{n!==void 0&&n!==l&&c(n)},[n,l]);const u=v=>{console.log("handleValueChange",v),c(v),r&&r(v)},f=ct("px-3 py-1.5 text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),m=({children:v})=>{const b=ct("flex-grow overflow-y-auto pb-6 pr-2 -mr-2",a);return o?p.jsx(Hi,{className:b,children:v}):p.jsx("div",{className:b,children:v})};return p.jsxs(fTe,{value:l,onValueChange:u,defaultValue:t,className:ct("flex flex-col h-full",s),children:[p.jsx(hTe,{className:ct("flex-shrink-0 sticky top-0 bg-background z-10 mb-4 flex-wrap h-auto justify-start border-b gap-1 p-1 -mx-6 px-6",i),children:e.map(v=>p.jsx(pTe,{value:v.value,disabled:v.disabled,className:f,children:v.label},v.value))}),p.jsx(m,{children:e.map(v=>p.jsx(mTe,{value:v.value,className:"data-[state=inactive]:hidden h-full",children:v.content},v.value))})]})},kH=T.memo(({isOpen:e,onClose:t,initialTab:n})=>{const{modSettingsTabs:r}=cd(mn(u=>({modSettingsTabs:u.modSettingsTabs||[]}))),s=T.useMemo(()=>[...r.map(m=>{const g=m.component;return{value:m.id,label:m.title,content:p.jsx(g,{}),order:m.order??999}})].sort((m,g)=>(m.order??999)-(g.order??999)),[r]),i=T.useCallback(()=>s.length>0?s[0].value:"general",[s]),[a,o]=T.useState(i());T.useEffect(()=>{if(e){let u=i();n&&s.some(f=>f.value===n)?u=n:n&&(console.warn(`[SettingsModal] Initial tab "${n}" not found. Defaulting to "${u}".`),Le.error(`Settings tab "${n}" not found. Opening default tab.`)),o(u)}},[e,n,s,i]);const l=u=>{u||t()},c=u=>{o(u)};return p.jsx(rS,{open:e,onOpenChange:l,children:p.jsxs(sS,{className:ct("w-[95vw] h-[90vh] flex flex-col p-0","sm:w-[90vw] sm:h-[85vh]","md:w-[85vw] md:max-w-[1200px] md:h-[80vh]","lg:w-[75vw]","min-h-[500px] max-h-[95vh]"),children:[p.jsxs(iS,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[p.jsx(oS,{children:"Settings"}),p.jsx(lS,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),s.length>0?p.jsx(Vc,{tabs:s,initialValue:a,onValueChange:c,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"flex-grow overflow-y-auto pb-4 md:pb-6 pr-1 md:pr-2 -mr-1 md:-mr-2",scrollable:!0},a):p.jsx("div",{className:"flex-grow flex items-center justify-center text-muted-foreground p-4",children:"No settings tabs available or still loading. Check console for module registration errors."}),p.jsx(aS,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:p.jsx(Ct,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});kH.displayName="SettingsModalComponent";const gTe=kH;class yTe{constructor(){Ne(this,"id","core-settings-trigger");Ne(this,"modalId","settingsModal");Ne(this,"unregisterChatControlCallback",null);Ne(this,"unregisterModalProviderCallback",null);Ne(this,"modApiRef",null);Ne(this,"openSettingsModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Xn.openModalRequest,{modalId:this.modalId,initialTab:t||"general",initialSubTab:n})});Ne(this,"closeSettingsModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Xn.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterChatControlCallback&&this.unregisterModalProviderCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterChatControlCallback||(this.unregisterChatControlCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:()=>dt.createElement(i8,{module:this}),iconRenderer:()=>dt.createElement(i8,{module:this}),show:()=>!0})),this.unregisterModalProviderCallback||(this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>dt.createElement(gTe,{isOpen:n.isOpen,onClose:n.onClose,initialTab:n.initialTab,initialSubTab:n.initialSubTab})))}destroy(){this.unregisterChatControlCallback&&(this.unregisterChatControlCallback(),this.unregisterChatControlCallback=null),this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const bTe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsSidebarCollapsed();return p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",onClick:()=>e.toggleSidebar(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?p.jsx(zX,{className:"h-4 w-4"}):p.jsx(BX,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};class vTe{constructor(){Ne(this,"id","core-sidebar-toggle");Ne(this,"unregisterCallback",null);Ne(this,"notifyComponentUpdate",null);Ne(this,"modApiRef",null);Ne(this,"getIsSidebarCollapsed",()=>Dy.getState().isSidebarCollapsed);Ne(this,"toggleSidebar",t=>{var s,i;const n=Dy.getState().isSidebarCollapsed,r=t??!n;n!==r&&((s=this.modApiRef)==null||s.emit(Xn.toggleSidebarRequest,{isCollapsed:r}),(i=this.notifyComponentUpdate)==null||i.call(this))});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>dt.createElement(bTe,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}function tm({form:e,name:t,label:n,placeholder:r,disabled:s,wrapperClassName:i,allowNull:a=!1,min:o,max:l,step:c,className:u,onBlurInput:f,...m}){return p.jsx(e.Field,{name:t,children:g=>{const v=x=>{const _=x.target.value;if(_===""&&a)g.handleChange(null);else{const E=parseFloat(_);isNaN(E)?_===""&&!a&&g.handleChange(_):g.handleChange(E)}},b=typeof g.state.value=="number"?g.state.value.toString():(g.state.value===null&&a,""),w=x=>{g.handleBlur(),f&&f(x)};return p.jsxs("div",{className:ct("space-y-1.5",i),children:[" ",p.jsx(Jt,{htmlFor:g.name,className:"text-sm",children:n}),p.jsx(zn,{id:g.name,name:g.name,type:"number",value:b,onBlur:w,onChange:v,placeholder:r,disabled:s??g.form.state.isSubmitting,min:o,max:l,step:c,className:ct(u,g.state.meta.errors.length?"border-destructive":""),...m}),p.jsx(js,{field:g})]})}})}var TH=["PageUp","PageDown"],AH=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],RH={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Mm="Slider",[QA,wTe,xTe]=G_(Mm),[NH,v4e]=Ii(Mm,[xTe]),[_Te,dS]=NH(Mm),IH=T.forwardRef((e,t)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:f=()=>{},onValueCommit:m=()=>{},inverted:g=!1,form:v,...b}=e,w=T.useRef(new Set),x=T.useRef(0),E=a==="horizontal"?STe:ETe,[C=[],k]=Lo({prop:u,defaultProp:c,onChange:q=>{var V;(V=[...w.current][x.current])==null||V.focus(),f(q)}}),R=T.useRef(C);function I(q){const P=RTe(C,q);L(q,P)}function j(q){L(q,x.current)}function M(){const q=R.current[x.current];C[x.current]!==q&&m(C)}function L(q,P,{commit:V}={commit:!1}){const z=MTe(i),re=OTe(Math.round((q-r)/i)*i+r,z),K=ky(re,[r,s]);k((ee=[])=>{const W=TTe(ee,K,P);if(jTe(W,l*i)){x.current=W.indexOf(K);const se=String(W)!==String(ee);return se&&V&&m(W),se?W:ee}else return ee})}return p.jsx(_Te,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:s,valueIndexToChangeRef:x,thumbs:w.current,values:C,orientation:a,form:v,children:p.jsx(QA.Provider,{scope:e.__scopeSlider,children:p.jsx(QA.Slot,{scope:e.__scopeSlider,children:p.jsx(E,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:t,onPointerDown:Ut(b.onPointerDown,()=>{o||(R.current=C)}),min:r,max:s,inverted:g,onSlideStart:o?void 0:I,onSlideMove:o?void 0:j,onSlideEnd:o?void 0:M,onHomeKeyDown:()=>!o&&L(r,0,{commit:!0}),onEndKeyDown:()=>!o&&L(s,C.length-1,{commit:!0}),onStepKeyDown:({event:q,direction:P})=>{if(!o){const re=TH.includes(q.key)||q.shiftKey&&AH.includes(q.key)?10:1,K=x.current,ee=C[K],W=i*re*P;L(ee+W,K,{commit:!0})}}})})})})});IH.displayName=Mm;var[jH,MH]=NH(Mm,{startEdge:"left",endEdge:"right",size:"width",direction:1}),STe=T.forwardRef((e,t)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=e,[f,m]=T.useState(null),g=Nn(t,E=>m(E)),v=T.useRef(void 0),b=Am(s),w=b==="ltr",x=w&&!i||!w&&i;function _(E){const C=v.current||f.getBoundingClientRect(),k=[0,C.width],I=GI(k,x?[n,r]:[r,n]);return v.current=C,I(E-C.left)}return p.jsx(jH,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:p.jsx(OH,{dir:b,"data-orientation":"horizontal",...u,ref:g,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:E=>{const C=_(E.clientX);a==null||a(C)},onSlideMove:E=>{const C=_(E.clientX);o==null||o(C)},onSlideEnd:()=>{v.current=void 0,l==null||l()},onStepKeyDown:E=>{const k=RH[x?"from-left":"from-right"].includes(E.key);c==null||c({event:E,direction:k?-1:1})}})})}),ETe=T.forwardRef((e,t)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,u=T.useRef(null),f=Nn(t,u),m=T.useRef(void 0),g=!s;function v(b){const w=m.current||u.current.getBoundingClientRect(),x=[0,w.height],E=GI(x,g?[r,n]:[n,r]);return m.current=w,E(b-w.top)}return p.jsx(jH,{scope:e.__scopeSlider,startEdge:g?"bottom":"top",endEdge:g?"top":"bottom",size:"height",direction:g?1:-1,children:p.jsx(OH,{"data-orientation":"vertical",...c,ref:f,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const w=v(b.clientY);i==null||i(w)},onSlideMove:b=>{const w=v(b.clientY);a==null||a(w)},onSlideEnd:()=>{m.current=void 0,o==null||o()},onStepKeyDown:b=>{const x=RH[g?"from-bottom":"from-top"].includes(b.key);l==null||l({event:b,direction:x?-1:1})}})})}),OH=T.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,u=dS(Mm,n);return p.jsx(sn.span,{...c,ref:t,onKeyDown:Ut(e.onKeyDown,f=>{f.key==="Home"?(a(f),f.preventDefault()):f.key==="End"?(o(f),f.preventDefault()):TH.concat(AH).includes(f.key)&&(l(f),f.preventDefault())}),onPointerDown:Ut(e.onPointerDown,f=>{const m=f.target;m.setPointerCapture(f.pointerId),f.preventDefault(),u.thumbs.has(m)?m.focus():r(f)}),onPointerMove:Ut(e.onPointerMove,f=>{f.target.hasPointerCapture(f.pointerId)&&s(f)}),onPointerUp:Ut(e.onPointerUp,f=>{const m=f.target;m.hasPointerCapture(f.pointerId)&&(m.releasePointerCapture(f.pointerId),i(f))})})}),PH="SliderTrack",DH=T.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=dS(PH,n);return p.jsx(sn.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});DH.displayName=PH;var eR="SliderRange",FH=T.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=dS(eR,n),i=MH(eR,n),a=T.useRef(null),o=Nn(t,a),l=s.values.length,c=s.values.map(m=>$H(m,s.min,s.max)),u=l>1?Math.min(...c):0,f=100-Math.max(...c);return p.jsx(sn.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:o,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:f+"%"}})});FH.displayName=eR;var tR="SliderThumb",LH=T.forwardRef((e,t)=>{const n=wTe(e.__scopeSlider),[r,s]=T.useState(null),i=Nn(t,o=>s(o)),a=T.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return p.jsx(CTe,{...e,ref:i,index:a})}),CTe=T.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:s,...i}=e,a=dS(tR,n),o=MH(tR,n),[l,c]=T.useState(null),u=Nn(t,_=>c(_)),f=l?a.form||!!l.closest("form"):!0,m=J1(l),g=a.values[r],v=g===void 0?0:$H(g,a.min,a.max),b=ATe(r,a.values.length),w=m==null?void 0:m[o.size],x=w?NTe(w,v,o.direction):0;return T.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),p.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${v}% + ${x}px)`},children:[p.jsx(QA.ItemSlot,{scope:e.__scopeSlider,children:p.jsx(sn.span,{role:"slider","aria-label":e["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":g,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:u,style:g===void 0?{display:"none"}:e.style,onFocus:Ut(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),f&&p.jsx(BH,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:g},r)]})});LH.displayName=tR;var kTe="RadioBubbleInput",BH=T.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const s=T.useRef(null),i=Nn(s,r),a=W_(t);return T.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const f=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(f)}},[a,t]),p.jsx(sn.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});BH.displayName=kTe;function TTe(e=[],t,n){const r=[...e];return r[n]=t,r.sort((s,i)=>s-i)}function $H(e,t,n){const i=100/(n-t)*(e-t);return ky(i,[0,100])}function ATe(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function RTe(e,t){if(e.length===1)return 0;const n=e.map(s=>Math.abs(s-t)),r=Math.min(...n);return n.indexOf(r)}function NTe(e,t,n){const r=e/2,i=GI([0,50],[0,r]);return(r-i(t)*n)*n}function ITe(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function jTe(e,t){if(t>0){const n=ITe(e);return Math.min(...n)>=t}return!0}function GI(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function MTe(e){return(String(e).split(".")[1]||"").length}function OTe(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var PTe=IH,DTe=DH,FTe=FH,LTe=LH;function l0({className:e,defaultValue:t,value:n,min:r=0,max:s=100,...i}){const a=T.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,s],[n,t,r,s]);return p.jsxs(PTe,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:s,className:ct("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[p.jsx(DTe,{"data-slot":"slider-track",className:ct("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:p.jsx(FTe,{"data-slot":"slider-range",className:ct("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(o,l)=>p.jsx(LTe,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}function Ro({form:e,name:t,label:n,valueLabelPrefix:r="",valueLabelSuffix:s="",valueDisplayPrecision:i=2,showRawValue:a=!1,disabled:o,wrapperClassName:l,className:c,min:u,max:f,step:m,...g}){return p.jsx(e.Field,{name:t,children:v=>{const b=typeof v.state.value=="number"?v.state.value:u??0,w=b.toFixed(i);return p.jsxs("div",{className:ct("space-y-1.5",l),children:[p.jsxs(Jt,{htmlFor:v.name,className:"text-sm",children:[n," (",r,w,s,")",a&&p.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",v.state.value,")"]})]}),p.jsx(l0,{id:v.name,name:v.name,value:[b],onValueChange:x=>v.handleChange(x[0]),onBlur:v.handleBlur,disabled:o??v.form.state.isSubmitting,min:u,max:f,step:m,className:ct(c,v.state.meta.errors.length?"border-destructive":""),...g}),p.jsx(js,{field:v})]})}})}const BTe=D.object({temperature:D.number().min(0).max(1),topP:D.number().min(0).max(1),maxTokens:D.number().min(1).nullable(),topK:D.number().min(1).nullable(),presencePenalty:D.number().min(-2).max(2),frequencyPenalty:D.number().min(-2).max(2)}),$Te=({module:e,className:t})=>{const n=ri({defaultValues:{temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0},validators:{onChangeAsync:BTe,onChangeAsyncDebounceMs:500}});T.useEffect(()=>{n.reset({temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0})},[e.temperature,e.defaultTemperature,e.topP,e.defaultTopP,e.maxTokens,e.defaultMaxTokens,e.topK,e.defaultTopK,e.presencePenalty,e.defaultPresencePenalty,e.frequencyPenalty,e.defaultFrequencyPenalty]);const[,r]=dt.useState({});T.useEffect(()=>{const u=()=>r({});return e.setNotifyCallback(u),()=>e.setNotifyCallback(null)},[e]);const s=T.useCallback((u,f,m)=>{var g;((g=n.getFieldMeta(u))==null?void 0:g.errors.length)===0&&f(m)},[n,e]),i=T.useCallback((u,f)=>{var m;if(((m=n.getFieldMeta(u))==null?void 0:m.errors.length)===0){const g=n.getFieldValue(u);f(g)}},[n,e]),a=T.useCallback((u,f,m)=>{n.setFieldValue(u,m),f(null)},[n,e]),o=e.supportedParams,l=e.defaultTemperature!==void 0||e.defaultTopP!==void 0||e.defaultMaxTokens!==void 0||e.defaultTopK!==void 0||e.defaultPresencePenalty!==void 0||e.defaultFrequencyPenalty!==void 0,c=(u,f,m,g,v="N/A")=>{var b;return!l||g===void 0?null:p.jsxs(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a(u,m,g??null),disabled:f===null,children:["Use Default (",((b=g==null?void 0:g.toFixed)==null?void 0:b.call(g,2))??v,")"]})};return p.jsxs("div",{className:ct("space-y-4 p-4",t),children:[o.has("temperature")&&p.jsxs("div",{className:"space-y-0.5",children:[" ",p.jsx(Ro,{form:n,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("temperature",e.setTemperature,u[0]),wrapperClassName:"text-xs"}),c("temperature",e.temperature,e.setTemperature,e.defaultTemperature,"0.70")]}),o.has("top_p")&&p.jsxs("div",{className:"space-y-0.5",children:[p.jsx(Ro,{form:n,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("topP",e.setTopP,u[0]),wrapperClassName:"text-xs"}),c("topP",e.topP,e.setTopP,e.defaultTopP,"1.00")]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[" ",o.has("max_tokens")&&p.jsxs("div",{className:"space-y-0.5",children:[p.jsx(tm,{form:n,name:"maxTokens",label:"Max Tokens",placeholder:`Default: ${e.defaultMaxTokens??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("maxTokens",e.setMaxTokens),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("maxTokens",e.maxTokens,e.setMaxTokens,e.defaultMaxTokens,"None")]}),o.has("top_k")&&p.jsxs("div",{className:"space-y-0.5",children:[p.jsx(tm,{form:n,name:"topK",label:"Top K",placeholder:`Default: ${e.defaultTopK??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("topK",e.setTopK),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("topK",e.topK,e.setTopK,e.defaultTopK,"None")]})]}),o.has("presence_penalty")&&p.jsxs("div",{className:"space-y-0.5",children:[p.jsx(Ro,{form:n,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("presencePenalty",e.setPresencePenalty,u[0]),wrapperClassName:"text-xs"}),c("presencePenalty",e.presencePenalty,e.setPresencePenalty,e.defaultPresencePenalty,"0.00")]}),o.has("frequency_penalty")&&p.jsxs("div",{className:"space-y-0.5",children:[p.jsx(Ro,{form:n,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("frequencyPenalty",e.setFrequencyPenalty,u[0]),wrapperClassName:"text-xs"}),c("frequencyPenalty",e.frequencyPenalty,e.setFrequencyPenalty,e.defaultFrequencyPenalty,"0.00")]})]})},zTe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsStreaming();return e.getIsVisible()?p.jsxs(Ho,{children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Go,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:p.jsx(sJ,{className:"h-4 w-4"})})})}),p.jsx(cr,{side:"top",children:"Advanced Parameters"})]})}),p.jsx(Ko,{className:"w-auto p-0",align:"start",children:p.jsx($Te,{module:e})})]}):null};class UTe{constructor(){Ne(this,"id","core-parameters");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"temperature",null);Ne(this,"topP",null);Ne(this,"maxTokens",null);Ne(this,"topK",null);Ne(this,"presencePenalty",null);Ne(this,"frequencyPenalty",null);Ne(this,"defaultTemperature",null);Ne(this,"defaultTopP",null);Ne(this,"defaultMaxTokens",null);Ne(this,"defaultTopK",null);Ne(this,"defaultPresencePenalty",null);Ne(this,"defaultFrequencyPenalty",null);Ne(this,"isStreaming",!1);Ne(this,"isVisible",!0);Ne(this,"supportedParams",new Set);Ne(this,"notifyComponentUpdate",null);Ne(this,"getIsStreaming",()=>this.isStreaming);Ne(this,"getIsVisible",()=>this.isVisible);Ne(this,"setTemperature",t=>{var n,r;this.temperature=t,(n=this.modApiRef)==null||n.emit(Tn.setTemperatureRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});Ne(this,"setTopP",t=>{var n,r;this.topP=t,(n=this.modApiRef)==null||n.emit(Tn.setTopPRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});Ne(this,"setMaxTokens",t=>{var n,r;this.maxTokens=t,(n=this.modApiRef)==null||n.emit(Tn.setMaxTokensRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});Ne(this,"setTopK",t=>{var n,r;this.topK=t,(n=this.modApiRef)==null||n.emit(Tn.setTopKRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});Ne(this,"setPresencePenalty",t=>{var n,r;this.presencePenalty=t,(n=this.modApiRef)==null||n.emit(Tn.setPresencePenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});Ne(this,"setFrequencyPenalty",t=>{var n,r;this.frequencyPenalty=t,(n=this.modApiRef)==null||n.emit(Tn.setFrequencyPenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState(),this.updateSupportedParams();const n=t.on(On.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Hn.selectedModelChanged,()=>{var a;this.updateSupportedParams(),this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Qt.enableAdvancedSettingsChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(Tn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;let c=!1;"temperature"in l&&this.temperature!==l.temperature&&(this.temperature=l.temperature??null,c=!0),"topP"in l&&this.topP!==l.topP&&(this.topP=l.topP??null,c=!0),"maxTokens"in l&&this.maxTokens!==l.maxTokens&&(this.maxTokens=l.maxTokens??null,c=!0),"topK"in l&&this.topK!==l.topK&&(this.topK=l.topK??null,c=!0),"presencePenalty"in l&&this.presencePenalty!==l.presencePenalty&&(this.presencePenalty=l.presencePenalty??null,c=!0),"frequencyPenalty"in l&&this.frequencyPenalty!==l.frequencyPenalty&&(this.frequencyPenalty=l.frequencyPenalty??null,c=!0),c&&((o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s,i)}loadInitialState(){const t=ir.getState(),n=Ml.getState();this.isStreaming=Bn.getState().status==="streaming",this.temperature=n.temperature,this.topP=n.topP,this.maxTokens=n.maxTokens,this.topK=n.topK,this.presencePenalty=n.presencePenalty,this.frequencyPenalty=n.frequencyPenalty,this.defaultTemperature=t.temperature,this.defaultTopP=t.topP,this.defaultMaxTokens=t.maxTokens,this.defaultTopK=t.topK,this.defaultPresencePenalty=t.presencePenalty,this.defaultFrequencyPenalty=t.frequencyPenalty,this.updateVisibility()}updateSupportedParams(){var o;const t=gr.getState();if(!t.selectedModelId){this.supportedParams=new Set;return}const{providerId:n,modelId:r}=jo(t.selectedModelId);if(!n||!r){this.supportedParams=new Set;return}const s=t.dbProviderConfigs.find(l=>l.id===n);if(!s){this.supportedParams=new Set;return}const i=t.dbApiKeys.find(l=>l.id===s.apiKeyId),a=o9(s,r,i==null?void 0:i.value);this.supportedParams=new Set(((o=a==null?void 0:a.metadata)==null?void 0:o.supported_parameters)??[])}updateVisibility(){const r=ir.getState().enableAdvancedSettings&&["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"].some(s=>this.supportedParams.has(s));this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>dt.createElement(zTe,{module:this}),getParameters:()=>{const n={},r=(s,i)=>{i!==null&&(n[s]=i)};return r("temperature",this.temperature),r("top_p",this.topP),r("max_tokens",this.maxTokens),r("top_k",this.topK),r("presence_penalty",this.presencePenalty),r("frequency_penalty",this.frequencyPenalty),Object.keys(n).length>0?n:void 0}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const qTe=({module:e})=>{const t=T.useRef(null),[,n]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>n({})),()=>e.setNotifyCallback(null)),[e]);const r=e.getIsStreaming(),s=e.getModelSupportsNonText(),i=T.useCallback(async l=>{const c=l.target.files;if(c){for(const u of Array.from(c))try{let f={};const m=e.isLikelyTextFile(u.name,u.type),g=u.type.startsWith("image/");if(m)f.contentText=await u.text();else if(g&&s){const v=new FileReader,b=new Promise((x,_)=>{v.onload=()=>x(v.result),v.onerror=E=>_(E)});v.readAsDataURL(u);const w=await b;w&&w.includes(",")&&(f.contentBase64=w.split(",")[1])}e.onFileAdd({source:"direct",name:u.name,type:u.type||"application/octet-stream",size:u.size,...f})}catch(f){console.error(`Error processing file ${u.name}:`,f),Le.error(`Failed to process file "${u.name}": ${f instanceof Error?f.message:String(f)}`)}l.target&&(l.target.value="")}},[e,s]),a=()=>{var l;(l=t.current)==null||l.click()},o=s?"Attach Files (Text, Images, etc.)":"Attach Text Files";return p.jsxs(p.Fragment,{children:[p.jsx("input",{type:"file",ref:t,onChange:i,multiple:!0,className:"hidden",disabled:r}),p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{type:"button",variant:"ghost",size:"icon",onClick:a,disabled:r,className:"h-8 w-8","aria-label":o,children:p.jsx(gR,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"top",children:o})]})})]})},VTe=({module:e})=>{const[,t]=T.useState({}),n=e.getAttachedFiles(),r=e.getIsStreaming();return T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),n.length===0?null:p.jsx("div",{className:ct("max-h-40 overflow-y-auto pr-1","flex flex-wrap gap-1"),children:n.map(s=>p.jsx(J$,{fileMeta:s,onRemove:e.onFileRemove,isReadOnly:r},s.id))})},zH=20,HTe=zH*1024*1024;class GTe{constructor(){Ne(this,"id","core-file-attachment");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"isStreaming",!1);Ne(this,"modelSupportsNonText",!0);Ne(this,"attachedFiles",[]);Ne(this,"notifyComponentUpdate",null);Ne(this,"getIsStreaming",()=>this.isStreaming);Ne(this,"getModelSupportsNonText",()=>this.modelSupportsNonText);Ne(this,"getAttachedFiles",()=>this.attachedFiles);Ne(this,"isLikelyTextFile",(t,n)=>I0(t,n));Ne(this,"onFileAdd",t=>{var r;if(t.size>HTe){Le.error(`File "${t.name}" exceeds the ${zH}MB limit.`);return}if(!I0(t.name,t.type)&&!this.modelSupportsNonText){Le.warning(`File "${t.name}" (${t.type}) cannot be uploaded. The current model only supports text input.`);return}(r=this.modApiRef)==null||r.emit(eo.addAttachedFileRequest,t)});Ne(this,"onFileRemove",t=>{var n;(n=this.modApiRef)==null||n.emit(eo.removeAttachedFileRequest,{attachmentId:t})});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.isStreaming=Bn.getState().status==="streaming",this.attachedFiles=Vu.getState().attachedFilesMetadata,this.updateModelSupport(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(On.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Hn.selectedModelChanged,()=>{var a;this.updateModelSupport(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(eo.attachedFilesChanged,a=>{var o;typeof a=="object"&&a&&"files"in a&&JSON.stringify(this.attachedFiles)!==JSON.stringify(a.files)&&(this.attachedFiles=a.files,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s)}updateModelSupport(){var i,a;const{getSelectedModel:t}=gr.getState(),n=t(),r=(a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.input_modalities,s=!r||r.some(o=>o!=="text");this.modelSupportsNonText!==s&&(this.modelSupportsNonText=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>dt.createElement(qTe,{module:this}),renderer:()=>dt.createElement(VTe,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const KTe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>{if(e&&typeof e.setNotifyTriggerUpdate=="function")return e.setNotifyTriggerUpdate(()=>t({})),()=>{e&&typeof e.setNotifyTriggerUpdate=="function"&&e.setNotifyTriggerUpdate(null)}},[e]);const n=e&&typeof e.getIsVfsModalOpen=="function"?e.getIsVfsModalOpen():!1,r=e&&typeof e.getSelectedFileIdsCount=="function"?e.getSelectedFileIdsCount():0,s=e&&typeof e.getEnableVfs=="function"?e.getEnableVfs():!1,i=Vu.getState().addAttachedFile,a=()=>{const o=xs.getState().selectedFileIds;if(o.size===0){Le.info("No files selected in VFS to attach.");return}let l=0;const c=e.getVfsNodes();o.forEach(u=>{const f=c[u];f&&f.type==="file"&&(i({source:"vfs",name:f.name,type:f.mimeType||"application/octet-stream",size:f.size,path:f.path}),l++)}),l>0?(Le.success(`Attached ${l} file(s) from VFS to the next prompt.`),typeof e.clearVfsSelection=="function"&&e.clearVfsSelection(),e.toggleVfsModal):Le.warning("No valid files were selected to attach.")};return s?p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",className:ct("h-8 w-8",n&&"bg-muted text-primary"),onClick:()=>e&&typeof e.toggleVfsModal=="function"&&e.toggleVfsModal(),"aria-label":"Toggle Virtual File System",children:p.jsx(pR,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"top",children:"Virtual Filesystem"})]})}),r>0&&p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsxs(Ct,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:a,"aria-label":`Attach ${r} selected VFS file(s)`,children:[p.jsx(gR,{className:"h-4 w-4 mr-1"}),"Attach (",r,")"]})}),p.jsx(cr,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null};function Qf({className:e,...t}){return p.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:p.jsx("table",{"data-slot":"table",className:ct("w-full caption-bottom text-sm",e),...t})})}function Om({className:e,...t}){return p.jsx("thead",{"data-slot":"table-header",className:ct("[&_tr]:border-b",e),...t})}function eh({className:e,...t}){return p.jsx("tbody",{"data-slot":"table-body",className:ct("[&_tr:last-child]:border-0",e),...t})}function ts({className:e,...t}){return p.jsx("tr",{"data-slot":"table-row",className:ct("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function Lr({className:e,...t}){return p.jsx("th",{"data-slot":"table-head",className:ct("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function Ln({className:e,...t}){return p.jsx("td",{"data-slot":"table-cell",className:ct("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function WTe({className:e,...t}){return p.jsx("caption",{"data-slot":"table-caption",className:ct("text-muted-foreground mt-4 text-sm",e),...t})}const UH=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:s,isOperationLoading:i,isMobile:a=!1})=>{const o=l=>{l.key==="Enter"?n():l.key==="Escape"&&r()};return a?p.jsxs("div",{className:"flex items-center gap-2 p-1",children:[p.jsx(Uu,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),p.jsx(zn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary flex-grow",placeholder:"New folder name",disabled:i}),p.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Ui,{className:"h-4 w-4"})}),p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:p.jsx(la,{className:"h-4 w-4"})})]})]}):p.jsxs(ts,{className:"bg-muted/30",children:[p.jsx(Ln,{className:"px-2 py-1"}),p.jsx(Ln,{className:"px-2 py-1",children:p.jsx(Uu,{className:"h-5 w-5 text-yellow-400"})}),p.jsx(Ln,{className:"py-1 px-2",colSpan:3,children:p.jsx(zn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:i})}),p.jsx(Ln,{className:"text-right pr-4 py-1",children:p.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Ui,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"top",children:"Create (Enter)"})]})}),p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:p.jsx(la,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};var fS="Checkbox",[ZTe,w4e]=Ii(fS),[YTe,XTe]=ZTe(fS),qH=T.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...f}=e,[m,g]=T.useState(null),v=Nn(t,C=>g(C)),b=T.useRef(!1),w=m?u||!!m.closest("form"):!0,[x,_]=Lo({prop:s,defaultProp:i??!1,onChange:c,caller:fS}),E=T.useRef(x);return T.useEffect(()=>{const C=m==null?void 0:m.form;if(C){const k=()=>_(E.current);return C.addEventListener("reset",k),()=>C.removeEventListener("reset",k)}},[m,_]),p.jsxs(YTe,{scope:n,state:x,disabled:o,children:[p.jsx(sn.button,{type:"button",role:"checkbox","aria-checked":$u(x)?"mixed":x,"aria-required":a,"data-state":KH(x),"data-disabled":o?"":void 0,disabled:o,value:l,...f,ref:v,onKeyDown:Ut(e.onKeyDown,C=>{C.key==="Enter"&&C.preventDefault()}),onClick:Ut(e.onClick,C=>{_(k=>$u(k)?!0:!k),w&&(b.current=C.isPropagationStopped(),b.current||C.stopPropagation())})}),w&&p.jsx(GH,{control:m,bubbles:!b.current,name:r,value:l,checked:x,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"},defaultChecked:$u(i)?!1:i})]})});qH.displayName=fS;var VH="CheckboxIndicator",HH=T.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=XTe(VH,n);return p.jsx(si,{present:r||$u(i.state)||i.state===!0,children:p.jsx(sn.span,{"data-state":KH(i.state),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});HH.displayName=VH;var JTe="CheckboxBubbleInput",GH=T.forwardRef(({__scopeCheckbox:e,control:t,checked:n,bubbles:r=!0,defaultChecked:s,...i},a)=>{const o=T.useRef(null),l=Nn(o,a),c=W_(n),u=J1(t);T.useEffect(()=>{const m=o.current;if(!m)return;const g=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(g,"checked").set;if(c!==n&&b){const w=new Event("click",{bubbles:r});m.indeterminate=$u(n),b.call(m,$u(n)?!1:n),m.dispatchEvent(w)}},[c,n,r]);const f=T.useRef($u(n)?!1:n);return p.jsx(sn.input,{type:"checkbox","aria-hidden":!0,defaultChecked:s??f.current,...i,tabIndex:-1,ref:l,style:{...i.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});GH.displayName=JTe;function $u(e){return e==="indeterminate"}function KH(e){return $u(e)?"indeterminate":e?"checked":"unchecked"}var QTe=qH,eAe=HH;function Bc({className:e,...t}){return p.jsx(QTe,{"data-slot":"checkbox",className:ct("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:p.jsx(eAe,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:p.jsx(Ui,{className:"size-3.5"})})})}var nR=["Enter"," "],tAe=["ArrowDown","PageUp","Home"],WH=["ArrowUp","PageDown","End"],nAe=[...tAe,...WH],rAe={ltr:[...nR,"ArrowRight"],rtl:[...nR,"ArrowLeft"]},sAe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Lb="Menu",[Fy,iAe,aAe]=G_(Lb),[th,hS]=Ii(Lb,[aAe,pd,cS]),pS=pd(),ZH=cS(),[oAe,nh]=th(Lb),[lAe,Bb]=th(Lb),YH=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=e,o=pS(t),[l,c]=T.useState(null),u=T.useRef(!1),f=Xs(i),m=Am(s);return T.useEffect(()=>{const g=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",g,{capture:!0}),()=>{document.removeEventListener("keydown",g,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),p.jsx(Q1,{...o,children:p.jsx(oAe,{scope:t,open:n,onOpenChange:f,content:l,onContentChange:c,children:p.jsx(lAe,{scope:t,onClose:T.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:m,modal:a,children:r})})})};YH.displayName=Lb;var cAe="MenuAnchor",KI=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=pS(n);return p.jsx(Wy,{...s,...r,ref:t})});KI.displayName=cAe;var WI="MenuPortal",[uAe,XH]=th(WI,{forceMount:void 0}),JH=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=nh(WI,t);return p.jsx(uAe,{scope:t,forceMount:n,children:p.jsx(si,{present:n||i.open,children:p.jsx(fm,{asChild:!0,container:s,children:r})})})};JH.displayName=WI;var ao="MenuContent",[dAe,ZI]=th(ao),QH=T.forwardRef((e,t)=>{const n=XH(ao,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=nh(ao,e.__scopeMenu),a=Bb(ao,e.__scopeMenu);return p.jsx(Fy.Provider,{scope:e.__scopeMenu,children:p.jsx(si,{present:r||i.open,children:p.jsx(Fy.Slot,{scope:e.__scopeMenu,children:a.modal?p.jsx(fAe,{...s,ref:t}):p.jsx(hAe,{...s,ref:t})})})})}),fAe=T.forwardRef((e,t)=>{const n=nh(ao,e.__scopeMenu),r=T.useRef(null),s=Nn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return Z_(i)},[]),p.jsx(YI,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Ut(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),hAe=T.forwardRef((e,t)=>{const n=nh(ao,e.__scopeMenu);return p.jsx(YI,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),pAe=zu("MenuContent.ScrollLock"),YI=T.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:g,disableOutsideScroll:v,...b}=e,w=nh(ao,n),x=Bb(ao,n),_=pS(n),E=ZH(n),C=iAe(n),[k,R]=T.useState(null),I=T.useRef(null),j=Nn(t,I,w.onContentChange),M=T.useRef(0),L=T.useRef(""),q=T.useRef(0),P=T.useRef(null),V=T.useRef("right"),z=T.useRef(0),re=v?Ib:T.Fragment,K=v?{as:pAe,allowPinchZoom:!0}:void 0,ee=se=>{var Pe,Ie;const Y=L.current+se,te=C().filter(Ce=>!Ce.disabled),Q=document.activeElement,ae=(Pe=te.find(Ce=>Ce.ref.current===Q))==null?void 0:Pe.textValue,xe=te.map(Ce=>Ce.textValue),ge=kAe(xe,Y,ae),Me=(Ie=te.find(Ce=>Ce.textValue===ge))==null?void 0:Ie.ref.current;(function Ce(He){L.current=He,window.clearTimeout(M.current),He!==""&&(M.current=window.setTimeout(()=>Ce(""),1e3))})(Y),Me&&setTimeout(()=>Me.focus())};T.useEffect(()=>()=>window.clearTimeout(M.current),[]),K_();const W=T.useCallback(se=>{var te,Q;return V.current===((te=P.current)==null?void 0:te.side)&&AAe(se,(Q=P.current)==null?void 0:Q.area)},[]);return p.jsx(dAe,{scope:n,searchRef:L,onItemEnter:T.useCallback(se=>{W(se)&&se.preventDefault()},[W]),onItemLeave:T.useCallback(se=>{var Y;W(se)||((Y=I.current)==null||Y.focus(),R(null))},[W]),onTriggerLeave:T.useCallback(se=>{W(se)&&se.preventDefault()},[W]),pointerGraceTimerRef:q,onPointerGraceIntentChange:T.useCallback(se=>{P.current=se},[]),children:p.jsx(re,{...K,children:p.jsx(Nb,{asChild:!0,trapped:s,onMountAutoFocus:Ut(i,se=>{var Y;se.preventDefault(),(Y=I.current)==null||Y.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:p.jsx(cm,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:g,children:p.jsx(pH,{asChild:!0,...E,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:k,onCurrentTabStopIdChange:R,onEntryFocus:Ut(l,se=>{x.isUsingKeyboardRef.current||se.preventDefault()}),preventScrollOnEntryFocus:!0,children:p.jsx(e_,{role:"menu","aria-orientation":"vertical","data-state":mG(w.open),"data-radix-menu-content":"",dir:x.dir,..._,...b,ref:j,style:{outline:"none",...b.style},onKeyDown:Ut(b.onKeyDown,se=>{const te=se.target.closest("[data-radix-menu-content]")===se.currentTarget,Q=se.ctrlKey||se.altKey||se.metaKey,ae=se.key.length===1;te&&(se.key==="Tab"&&se.preventDefault(),!Q&&ae&&ee(se.key));const xe=I.current;if(se.target!==xe||!nAe.includes(se.key))return;se.preventDefault();const Me=C().filter(Pe=>!Pe.disabled).map(Pe=>Pe.ref.current);WH.includes(se.key)&&Me.reverse(),EAe(Me)}),onBlur:Ut(e.onBlur,se=>{se.currentTarget.contains(se.target)||(window.clearTimeout(M.current),L.current="")}),onPointerMove:Ut(e.onPointerMove,Ly(se=>{const Y=se.target,te=z.current!==se.clientX;if(se.currentTarget.contains(Y)&&te){const Q=se.clientX>z.current?"right":"left";V.current=Q,z.current=se.clientX}}))})})})})})})});QH.displayName=ao;var mAe="MenuGroup",XI=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return p.jsx(sn.div,{role:"group",...r,ref:t})});XI.displayName=mAe;var gAe="MenuLabel",eG=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return p.jsx(sn.div,{...r,ref:t})});eG.displayName=gAe;var T1="MenuItem",a8="menu.itemSelect",mS=T.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=T.useRef(null),a=Bb(T1,e.__scopeMenu),o=ZI(T1,e.__scopeMenu),l=Nn(t,i),c=T.useRef(!1),u=()=>{const f=i.current;if(!n&&f){const m=new CustomEvent(a8,{bubbles:!0,cancelable:!0});f.addEventListener(a8,g=>r==null?void 0:r(g),{once:!0}),c9(f,m),m.defaultPrevented?c.current=!1:a.onClose()}};return p.jsx(tG,{...s,ref:l,disabled:n,onClick:Ut(e.onClick,u),onPointerDown:f=>{var m;(m=e.onPointerDown)==null||m.call(e,f),c.current=!0},onPointerUp:Ut(e.onPointerUp,f=>{var m;c.current||(m=f.currentTarget)==null||m.click()}),onKeyDown:Ut(e.onKeyDown,f=>{const m=o.searchRef.current!=="";n||m&&f.key===" "||nR.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});mS.displayName=T1;var tG=T.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,a=ZI(T1,n),o=ZH(n),l=T.useRef(null),c=Nn(t,l),[u,f]=T.useState(!1),[m,g]=T.useState("");return T.useEffect(()=>{const v=l.current;v&&g((v.textContent??"").trim())},[i.children]),p.jsx(Fy.ItemSlot,{scope:n,disabled:r,textValue:s??m,children:p.jsx(mH,{asChild:!0,...o,focusable:!r,children:p.jsx(sn.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:Ut(e.onPointerMove,Ly(v=>{r?a.onItemLeave(v):(a.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ut(e.onPointerLeave,Ly(v=>a.onItemLeave(v))),onFocus:Ut(e.onFocus,()=>f(!0)),onBlur:Ut(e.onBlur,()=>f(!1))})})})}),yAe="MenuCheckboxItem",nG=T.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return p.jsx(oG,{scope:e.__scopeMenu,checked:n,children:p.jsx(mS,{role:"menuitemcheckbox","aria-checked":A1(n)?"mixed":n,...s,ref:t,"data-state":QI(n),onSelect:Ut(s.onSelect,()=>r==null?void 0:r(A1(n)?!0:!n),{checkForDefaultPrevented:!1})})})});nG.displayName=yAe;var rG="MenuRadioGroup",[bAe,vAe]=th(rG,{value:void 0,onValueChange:()=>{}}),sG=T.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=Xs(r);return p.jsx(bAe,{scope:e.__scopeMenu,value:n,onValueChange:i,children:p.jsx(XI,{...s,ref:t})})});sG.displayName=rG;var iG="MenuRadioItem",aG=T.forwardRef((e,t)=>{const{value:n,...r}=e,s=vAe(iG,e.__scopeMenu),i=n===s.value;return p.jsx(oG,{scope:e.__scopeMenu,checked:i,children:p.jsx(mS,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":QI(i),onSelect:Ut(r.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,n)},{checkForDefaultPrevented:!1})})})});aG.displayName=iG;var JI="MenuItemIndicator",[oG,wAe]=th(JI,{checked:!1}),lG=T.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=wAe(JI,n);return p.jsx(si,{present:r||A1(i.checked)||i.checked===!0,children:p.jsx(sn.span,{...s,ref:t,"data-state":QI(i.checked)})})});lG.displayName=JI;var xAe="MenuSeparator",cG=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return p.jsx(sn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});cG.displayName=xAe;var _Ae="MenuArrow",uG=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=pS(n);return p.jsx(t_,{...s,...r,ref:t})});uG.displayName=_Ae;var SAe="MenuSub",[x4e,dG]=th(SAe),c0="MenuSubTrigger",fG=T.forwardRef((e,t)=>{const n=nh(c0,e.__scopeMenu),r=Bb(c0,e.__scopeMenu),s=dG(c0,e.__scopeMenu),i=ZI(c0,e.__scopeMenu),a=T.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},u=T.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return T.useEffect(()=>u,[u]),T.useEffect(()=>{const f=o.current;return()=>{window.clearTimeout(f),l(null)}},[o,l]),p.jsx(KI,{asChild:!0,...c,children:p.jsx(tG,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":mG(n.open),...e,ref:Tc(t,s.onTriggerChange),onClick:f=>{var m;(m=e.onClick)==null||m.call(e,f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Ut(e.onPointerMove,Ly(f=>{i.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Ut(e.onPointerLeave,Ly(f=>{var g,v;u();const m=(g=n.content)==null?void 0:g.getBoundingClientRect();if(m){const b=(v=n.content)==null?void 0:v.dataset.side,w=b==="right",x=w?-5:5,_=m[w?"left":"right"],E=m[w?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+x,y:f.clientY},{x:_,y:m.top},{x:E,y:m.top},{x:E,y:m.bottom},{x:_,y:m.bottom}],side:b}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Ut(e.onKeyDown,f=>{var g;const m=i.searchRef.current!=="";e.disabled||m&&f.key===" "||rAe[r.dir].includes(f.key)&&(n.onOpenChange(!0),(g=n.content)==null||g.focus(),f.preventDefault())})})})});fG.displayName=c0;var hG="MenuSubContent",pG=T.forwardRef((e,t)=>{const n=XH(ao,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=nh(ao,e.__scopeMenu),a=Bb(ao,e.__scopeMenu),o=dG(hG,e.__scopeMenu),l=T.useRef(null),c=Nn(t,l);return p.jsx(Fy.Provider,{scope:e.__scopeMenu,children:p.jsx(si,{present:r||i.open,children:p.jsx(Fy.Slot,{scope:e.__scopeMenu,children:p.jsx(YI,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var f;a.isUsingKeyboardRef.current&&((f=l.current)==null||f.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Ut(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Ut(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:Ut(e.onKeyDown,u=>{var g;const f=u.currentTarget.contains(u.target),m=sAe[a.dir].includes(u.key);f&&m&&(i.onOpenChange(!1),(g=o.trigger)==null||g.focus(),u.preventDefault())})})})})})});pG.displayName=hG;function mG(e){return e?"open":"closed"}function A1(e){return e==="indeterminate"}function QI(e){return A1(e)?"indeterminate":e?"checked":"unchecked"}function EAe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function CAe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function kAe(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=CAe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function TAe(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,f=l.x,m=l.y;u>r!=m>r&&n<(f-c)*(r-u)/(m-u)+c&&(s=!s)}return s}function AAe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return TAe(n,t)}function Ly(e){return t=>t.pointerType==="mouse"?e(t):void 0}var gG=YH,yG=KI,bG=JH,vG=QH,wG=XI,xG=eG,_G=mS,SG=nG,EG=sG,CG=aG,kG=lG,TG=cG,AG=uG,RG=fG,NG=pG,e3="ContextMenu",[RAe,_4e]=Ii(e3,[hS]),Wi=hS(),[NAe,IG]=RAe(e3),jG=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:s,modal:i=!0}=e,[a,o]=T.useState(!1),l=Wi(t),c=Xs(r),u=T.useCallback(f=>{o(f),c(f)},[c]);return p.jsx(NAe,{scope:t,open:a,onOpenChange:u,modal:i,children:p.jsx(gG,{...l,dir:s,open:a,onOpenChange:u,modal:i,children:n})})};jG.displayName=e3;var MG="ContextMenuTrigger",OG=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=e,i=IG(MG,n),a=Wi(n),o=T.useRef({x:0,y:0}),l=T.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),c=T.useRef(0),u=T.useCallback(()=>window.clearTimeout(c.current),[]),f=m=>{o.current={x:m.clientX,y:m.clientY},i.onOpenChange(!0)};return T.useEffect(()=>u,[u]),T.useEffect(()=>void(r&&u()),[r,u]),p.jsxs(p.Fragment,{children:[p.jsx(yG,{...a,virtualRef:l}),p.jsx(sn.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...s,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Ut(e.onContextMenu,m=>{u(),f(m),m.preventDefault()}),onPointerDown:r?e.onPointerDown:Ut(e.onPointerDown,Lw(m=>{u(),c.current=window.setTimeout(()=>f(m),700)})),onPointerMove:r?e.onPointerMove:Ut(e.onPointerMove,Lw(u)),onPointerCancel:r?e.onPointerCancel:Ut(e.onPointerCancel,Lw(u)),onPointerUp:r?e.onPointerUp:Ut(e.onPointerUp,Lw(u))})]})});OG.displayName=MG;var IAe="ContextMenuPortal",PG=e=>{const{__scopeContextMenu:t,...n}=e,r=Wi(t);return p.jsx(bG,{...r,...n})};PG.displayName=IAe;var DG="ContextMenuContent",FG=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=IG(DG,n),i=Wi(n),a=T.useRef(!1);return p.jsx(vG,{...i,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&a.current&&o.preventDefault(),a.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!s.modal&&(a.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});FG.displayName=DG;var jAe="ContextMenuGroup",MAe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(wG,{...s,...r,ref:t})});MAe.displayName=jAe;var OAe="ContextMenuLabel",PAe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(xG,{...s,...r,ref:t})});PAe.displayName=OAe;var DAe="ContextMenuItem",LG=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(_G,{...s,...r,ref:t})});LG.displayName=DAe;var FAe="ContextMenuCheckboxItem",LAe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(SG,{...s,...r,ref:t})});LAe.displayName=FAe;var BAe="ContextMenuRadioGroup",$Ae=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(EG,{...s,...r,ref:t})});$Ae.displayName=BAe;var zAe="ContextMenuRadioItem",UAe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(CG,{...s,...r,ref:t})});UAe.displayName=zAe;var qAe="ContextMenuItemIndicator",VAe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(kG,{...s,...r,ref:t})});VAe.displayName=qAe;var HAe="ContextMenuSeparator",BG=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(TG,{...s,...r,ref:t})});BG.displayName=HAe;var GAe="ContextMenuArrow",KAe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(AG,{...s,...r,ref:t})});KAe.displayName=GAe;var WAe="ContextMenuSubTrigger",ZAe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(RG,{...s,...r,ref:t})});ZAe.displayName=WAe;var YAe="ContextMenuSubContent",XAe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Wi(n);return p.jsx(NG,{...s,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});XAe.displayName=YAe;function Lw(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var JAe=jG,QAe=OG,eRe=PG,tRe=FG,nRe=LG,rRe=BG;function o8({...e}){return p.jsx(JAe,{"data-slot":"context-menu",...e})}function l8({...e}){return p.jsx(QAe,{"data-slot":"context-menu-trigger",...e})}function c8({className:e,...t}){return p.jsx(eRe,{children:p.jsx(tRe,{"data-slot":"context-menu-content",className:ct("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function Ea({className:e,inset:t,variant:n="default",...r}){return p.jsx(nRe,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:ct("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function u8({className:e,...t}){return p.jsx(rRe,{"data-slot":"context-menu-separator",className:ct("bg-border -mx-1 my-1 h-px",e),...t})}const sRe=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:s,isOperationLoading:i,creatingFolder:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:f,handleDownload:m,handleDelete:g,setNewName:v,renameInputRef:b,handleGitInit:w,handleGitPull:x,handleGitCommit:_,handleGitPush:E,handleGitStatus:C})=>{const k=e.type==="folder",R=q=>{q.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||i||(k?o(e):l(!n,e.id))},I=q=>{q.key==="Enter"?f():q.key==="Escape"&&u()},j=k?r?aF:Uu:iF,M=k?r?"text-green-400":"text-yellow-400":"text-blue-400",L=p.jsxs(ts,{className:ct("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",i&&"opacity-70 cursor-not-allowed",!k&&"cursor-pointer"),onClick:R,onDoubleClick:()=>!i&&!t&&o(e),children:[p.jsx(Ln,{className:"px-2 py-1",children:p.jsx(Bc,{checked:n,onCheckedChange:q=>l(!!q,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:i||k})}),p.jsx(Ln,{className:"px-2 py-1",children:p.jsx(j,{className:ct("h-5 w-5",M)})}),p.jsx(Ln,{className:"py-1 px-2",children:t?p.jsx(zn,{ref:b,value:s,onChange:q=>v(q.target.value),onBlur:f,onKeyDown:I,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:q=>q.stopPropagation(),disabled:i}):p.jsx("span",{className:ct("truncate",k&&"cursor-pointer hover:underline"),title:e.name,onClick:q=>{k&&(q.stopPropagation(),o(e))},children:e.name})}),p.jsx(Ln,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?ry(e.size):""}),p.jsx(Ln,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),p.jsx(Ln,{className:"text-right pr-4 py-1",children:p.jsx("div",{className:ct("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",i&&"opacity-30"),children:t?p.jsxs(p.Fragment,{children:[p.jsx(gn,{tooltipText:"Save (Enter)",onClick:q=>{q.stopPropagation(),f()},"aria-label":"Save name",disabled:i||!s.trim(),icon:i?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Ui,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),p.jsx(gn,{tooltipText:"Cancel (Esc)",onClick:q=>{q.stopPropagation(),u()},"aria-label":"Cancel edit",disabled:i,icon:p.jsx(la,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):p.jsxs(p.Fragment,{children:[p.jsx(gn,{tooltipText:"Rename",onClick:q=>{q.stopPropagation(),c(e)},"aria-label":"Rename",disabled:i||a,icon:p.jsx(Vw,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),p.jsx(gn,{tooltipText:k?"Download folder (.zip)":"Download file",onClick:q=>{q.stopPropagation(),m(e)},"aria-label":k?"Download folder as ZIP":"Download file",disabled:i,icon:p.jsx(vf,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),p.jsx(gn,{tooltipText:"Delete",onClick:q=>{q.stopPropagation(),g(e)},"aria-label":`Delete ${k?"folder":"file"}`,disabled:i,icon:p.jsx(Aa,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return k?p.jsxs(o8,{children:[p.jsx(l8,{disabled:t||i,asChild:!0,children:L}),p.jsxs(c8,{children:[p.jsx(Ea,{onSelect:()=>o(e),disabled:t||i,children:"Open Folder"}),p.jsx(u8,{}),r?p.jsxs(p.Fragment,{children:[p.jsxs(Ea,{onSelect:()=>x(e.path),disabled:i,children:[p.jsx(cF,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),p.jsxs(Ea,{onSelect:()=>_(e.path),disabled:i,children:[p.jsx(lF,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),p.jsxs(Ea,{onSelect:()=>E(e.path),disabled:i,children:[p.jsx(hR,{className:"mr-2 h-4 w-4"}),"Git Push"]}),p.jsxs(Ea,{onSelect:()=>C(e.path),disabled:i,children:[p.jsx(mR,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):p.jsxs(Ea,{onSelect:()=>w(e.path),disabled:i,children:[p.jsx(qu,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),p.jsx(u8,{}),p.jsxs(Ea,{onSelect:()=>c(e),disabled:i,children:[p.jsx(Vw,{className:"mr-2 h-4 w-4"}),"Rename"]}),p.jsxs(Ea,{onSelect:()=>m(e),disabled:i,children:[p.jsx(vf,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),p.jsxs(Ea,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>g(e),disabled:i,children:[p.jsx(Aa,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):p.jsxs(o8,{children:[p.jsx(l8,{disabled:t||i,asChild:!0,children:L}),p.jsxs(c8,{children:[p.jsxs(Ea,{onSelect:()=>l(!n,e.id),disabled:i,children:[n?"Deselect":"Select"," File"]}),p.jsxs(Ea,{onSelect:()=>c(e),disabled:i,children:[p.jsx(Vw,{className:"mr-2 h-4 w-4"}),"Rename"]}),p.jsxs(Ea,{onSelect:()=>m(e),disabled:i,children:[p.jsx(vf,{className:"mr-2 h-4 w-4"}),"Download File"]}),p.jsxs(Ea,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>g(e),disabled:i,children:[p.jsx(Aa,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},iRe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:f,cancelCreatingFolder:m,handleCreateFolder:g,handleDownload:v,handleDelete:b,setNewName:w,setNewFolderName:x,renameInputRef:_,newFolderInputRef:E,gitRepoStatus:C,handleGitInit:k,handleGitPull:R,handleGitCommit:I,handleGitPush:j,handleGitStatus:M})=>{const L=T.useMemo(()=>e,[e]);return a&&e.length===0&&!r?p.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):p.jsx("div",{className:"relative h-full",children:p.jsxs(Qf,{className:"w-full text-sm",children:[p.jsx(Om,{className:"sticky top-0 bg-card z-10",children:p.jsxs(ts,{className:"hover:bg-card",children:[p.jsx(Lr,{className:"w-[40px] px-2"}),p.jsx(Lr,{className:"w-[40px] px-2"}),p.jsx(Lr,{children:"Name"}),p.jsx(Lr,{className:"w-[100px] text-right",children:"Size"}),p.jsx(Lr,{className:"w-[150px] text-right",children:"Modified"}),p.jsx(Lr,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),p.jsxs(eh,{children:[r&&p.jsx(UH,{newFolderName:s,setNewFolderName:x,handleCreateFolder:g,cancelCreatingFolder:m,newFolderInputRef:E,isOperationLoading:a}),L.map(q=>{const P=t===q.path,V=i.has(q.id),z=C[q.path]??!1;return p.jsx(sRe,{entry:q,isEditingThis:P,isChecked:V,isGitRepo:z,newName:P?n:"",isOperationLoading:a,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:f,handleDownload:v,handleDelete:b,setNewName:w,renameInputRef:_,handleGitInit:k,handleGitPull:R,handleGitCommit:I,handleGitPush:j,handleGitStatus:M},q.id)}),e.length===0&&!r&&!a&&p.jsx(ts,{children:p.jsx(Ln,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},aRe=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:s,creatingFolder:i,handleNavigateHome:a,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:c,handleUploadClick:u,handleFolderUploadClick:f,handleArchiveUploadClick:m,handleDownloadAll:g,handleCloneClick:v,fileInputRef:b,folderInputRef:w,archiveInputRef:x,handleFileChange:_,handleArchiveChange:E})=>p.jsxs(p.Fragment,{children:[p.jsx("input",{type:"file",ref:b,onChange:_,className:"hidden",multiple:!0,disabled:t}),p.jsx("input",{type:"file",ref:w,onChange:_,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),p.jsx("input",{type:"file",ref:x,onChange:E,className:"hidden",accept:".zip",disabled:t}),p.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[p.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[p.jsx(Ct,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),a()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:p.jsx(SX,{className:"h-4 w-4"})}),p.jsx(Ct,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:p.jsx(cX,{className:"h-4 w-4"})}),p.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[150px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),p.jsx("div",{className:"flex-grow"}),p.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap justify-end",children:[" ",p.jsx(Ct,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(D1,{className:"h-4 w-4"})}),p.jsxs(Ct,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),c()},disabled:t||i||!!s,className:"h-8",title:"Create New Folder",type:"button",children:[n&&i?p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}):p.jsx(oF,{className:"h-4 w-4 mr-1"}),p.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),p.jsxs(Ct,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),u()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}):p.jsx(rF,{className:"h-4 w-4 mr-1"}),p.jsx("span",{className:"hidden sm:inline",children:"Files"})," "]}),p.jsxs(Ct,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),f()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}):p.jsx(Uu,{className:"h-4 w-4 mr-1"}),p.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),p.jsxs(Ct,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),m()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}):p.jsx(KY,{className:"h-4 w-4 mr-1"}),p.jsx("span",{className:"hidden sm:inline",children:"ZIP"})," "]}),p.jsxs(Ct,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),v()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}):p.jsx(qu,{className:"h-4 w-4 mr-1"}),p.jsx("span",{className:"hidden sm:inline",children:"Clone"})," "]}),p.jsxs(Ct,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),g()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}):p.jsx(lY,{className:"h-4 w-4 mr-1"}),p.jsx("span",{className:"hidden sm:inline",children:"Export"})," "]})]})]})]}),$G=({isOpen:e,onOpenChange:t,title:n,description:r,children:s,submitLabel:i="Submit",onSubmit:a,isSubmitting:o,submitDisabled:l=!1,className:c,contentClassName:u})=>{const f=async m=>{m==null||m.preventDefault(),!(o||l)&&await a()};return p.jsx(rS,{open:e,onOpenChange:t,children:p.jsxs(sS,{className:ct(c),children:[p.jsxs(iS,{children:[p.jsx(oS,{children:n}),r&&p.jsx(lS,{children:r})]}),p.jsx("div",{className:ct("py-4",u),children:s}),p.jsxs(aS,{children:[p.jsx(Wke,{asChild:!0,children:p.jsx(Ct,{variant:"outline",disabled:o,children:"Cancel"})}),p.jsxs(Ct,{onClick:f,disabled:o||l,children:[o&&p.jsx(Pn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":i]})]})]})})},oRe=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:s,setCloneBranch:i,isCloning:a,onSubmitClone:o,currentPath:l})=>p.jsx($G,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:p.jsxs(p.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",p.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:a,submitDisabled:!n.trim(),children:p.jsxs("div",{className:"grid gap-4",children:[p.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[p.jsx(Jt,{htmlFor:"clone-url",className:"text-right",children:"URL"}),p.jsx(zn,{id:"clone-url",value:n,onChange:c=>r(c.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:a})]}),p.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[p.jsx(Jt,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),p.jsx(zn,{id:"clone-branch",value:s,onChange:c=>i(c.target.value),className:"col-span-3",placeholder:"main (default)",disabled:a})]})]})}),lRe=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:s,isCommitting:i,onSubmitCommit:a})=>p.jsx($G,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:p.jsxs(p.Fragment,{children:["Enter a commit message for the changes in ",p.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:a,isSubmitting:i,submitDisabled:!r.trim(),children:p.jsx("div",{className:"grid gap-4",children:p.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[p.jsx(Jt,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),p.jsx(zn,{id:"commit-msg",value:r,onChange:o=>s(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:i})]})})});var gS="DropdownMenu",[cRe,S4e]=Ii(gS,[hS]),Zi=hS(),[uRe,zG]=cRe(gS),UG=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=Zi(t),c=T.useRef(null),[u,f]=Lo({prop:s,defaultProp:i??!1,onChange:a,caller:gS});return p.jsx(uRe,{scope:t,triggerId:Qs(),triggerRef:c,contentId:Qs(),open:u,onOpenChange:f,onOpenToggle:T.useCallback(()=>f(m=>!m),[f]),modal:o,children:p.jsx(gG,{...l,open:u,onOpenChange:f,dir:r,modal:o,children:n})})};UG.displayName=gS;var qG="DropdownMenuTrigger",VG=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=zG(qG,n),a=Zi(n);return p.jsx(yG,{asChild:!0,...a,children:p.jsx(sn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:Tc(t,i.triggerRef),onPointerDown:Ut(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Ut(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});VG.displayName=qG;var dRe="DropdownMenuPortal",HG=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Zi(t);return p.jsx(bG,{...r,...n})};HG.displayName=dRe;var GG="DropdownMenuContent",KG=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zG(GG,n),i=Zi(n),a=T.useRef(!1);return p.jsx(vG,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:Ut(e.onCloseAutoFocus,o=>{var l;a.current||(l=s.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Ut(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});KG.displayName=GG;var fRe="DropdownMenuGroup",hRe=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(wG,{...s,...r,ref:t})});hRe.displayName=fRe;var pRe="DropdownMenuLabel",mRe=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(xG,{...s,...r,ref:t})});mRe.displayName=pRe;var gRe="DropdownMenuItem",WG=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(_G,{...s,...r,ref:t})});WG.displayName=gRe;var yRe="DropdownMenuCheckboxItem",bRe=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(SG,{...s,...r,ref:t})});bRe.displayName=yRe;var vRe="DropdownMenuRadioGroup",wRe=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(EG,{...s,...r,ref:t})});wRe.displayName=vRe;var xRe="DropdownMenuRadioItem",_Re=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(CG,{...s,...r,ref:t})});_Re.displayName=xRe;var SRe="DropdownMenuItemIndicator",ERe=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(kG,{...s,...r,ref:t})});ERe.displayName=SRe;var CRe="DropdownMenuSeparator",ZG=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(TG,{...s,...r,ref:t})});ZG.displayName=CRe;var kRe="DropdownMenuArrow",TRe=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(AG,{...s,...r,ref:t})});TRe.displayName=kRe;var ARe="DropdownMenuSubTrigger",RRe=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(RG,{...s,...r,ref:t})});RRe.displayName=ARe;var NRe="DropdownMenuSubContent",IRe=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Zi(n);return p.jsx(NG,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});IRe.displayName=NRe;var jRe=UG,MRe=VG,ORe=HG,PRe=KG,DRe=WG,FRe=ZG;function LRe({...e}){return p.jsx(jRe,{"data-slot":"dropdown-menu",...e})}function BRe({...e}){return p.jsx(MRe,{"data-slot":"dropdown-menu-trigger",...e})}function $Re({className:e,sideOffset:t=4,...n}){return p.jsx(ORe,{children:p.jsx(PRe,{"data-slot":"dropdown-menu-content",sideOffset:t,className:ct("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function pl({className:e,inset:t,variant:n="default",...r}){return p.jsx(DRe,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:ct("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function d8({className:e,...t}){return p.jsx(FRe,{"data-slot":"dropdown-menu-separator",className:ct("bg-border -mx-1 my-1 h-px",e),...t})}const zRe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:f,cancelCreatingFolder:m,handleCreateFolder:g,handleDownload:v,handleDelete:b,setNewName:w,setNewFolderName:x,renameInputRef:_,newFolderInputRef:E,gitRepoStatus:C,handleGitInit:k,handleGitPull:R,handleGitCommit:I,handleGitPush:j,handleGitStatus:M})=>{const L=q=>{q.key==="Enter"?f():q.key==="Escape"&&u()};return a&&e.length===0&&!r?p.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground p-4",children:"Loading..."}):p.jsxs("div",{className:"p-2 space-y-1",children:[r&&p.jsx("div",{className:"border rounded-md p-2 bg-muted/30",children:p.jsx(UH,{newFolderName:s,setNewFolderName:x,handleCreateFolder:g,cancelCreatingFolder:m,newFolderInputRef:E,isOperationLoading:a,isMobile:!0})}),e.map(q=>{const P=t===q.path,V=i.has(q.id),z=C[q.path]??!1,re=q.type==="folder",K=re?z?aF:Uu:iF,ee=re?z?"text-green-400":"text-yellow-400":"text-blue-400";return p.jsxs("div",{className:ct("flex items-center justify-between p-2 border rounded-md",P&&"bg-muted ring-1 ring-primary",a&&"opacity-70 cursor-not-allowed",!P&&"hover:bg-muted/50",!P&&"cursor-pointer"),onClick:()=>{P||a||(re?o(q):l(!V,q.id))},children:[p.jsxs("div",{className:"flex items-center gap-2 flex-grow min-w-0",children:[!re&&p.jsx(Bc,{checked:V,onCheckedChange:W=>l(!!W,q.id),"aria-label":`Select ${q.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground flex-shrink-0",disabled:a,onClick:W=>W.stopPropagation()}),re&&p.jsx("div",{className:"w-6 flex-shrink-0"}),p.jsx(K,{className:ct("h-5 w-5 flex-shrink-0",ee)}),p.jsxs("div",{className:"flex flex-col min-w-0 flex-grow",children:[P?p.jsx(zn,{ref:_,value:n,onChange:W=>w(W.target.value),onBlur:f,onKeyDown:L,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:W=>W.stopPropagation(),disabled:a}):p.jsx("span",{className:"text-sm font-medium truncate",title:q.name,children:q.name}),p.jsx("span",{className:"text-xs text-muted-foreground",children:q.type==="file"&&q.size!==void 0?ry(q.size):q.type==="folder"?z?"Git Repository":"Folder":""})]})]}),p.jsx("div",{className:"flex items-center flex-shrink-0 ml-2",children:P?p.jsxs(p.Fragment,{children:[p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-600",onClick:W=>{W.stopPropagation(),f()},disabled:a||!n.trim(),"aria-label":"Save name",children:a?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Ui,{className:"h-4 w-4"})}),p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:W=>{W.stopPropagation(),u()},disabled:a,"aria-label":"Cancel edit",children:p.jsx(la,{className:"h-4 w-4"})})]}):p.jsxs(LRe,{children:[p.jsx(BRe,{asChild:!0,children:p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:W=>W.stopPropagation(),disabled:a,"aria-label":"More actions",children:p.jsx(HY,{className:"h-4 w-4"})})}),p.jsxs($Re,{align:"end",onClick:W=>W.stopPropagation(),children:[re&&p.jsx(pl,{onSelect:()=>o(q),children:"Open Folder"}),!re&&p.jsxs(pl,{onSelect:()=>l(!V,q.id),children:[V?"Deselect":"Select"," File"]}),p.jsxs(pl,{onSelect:()=>c(q),children:[p.jsx(Vw,{className:"mr-2 h-4 w-4"})," Rename"]}),p.jsxs(pl,{onSelect:()=>v(q),children:[p.jsx(vf,{className:"mr-2 h-4 w-4"})," Download"," ",re?"as ZIP":""]}),re&&p.jsx(d8,{}),re&&z&&p.jsxs(p.Fragment,{children:[p.jsxs(pl,{onSelect:()=>R(q.path),children:[p.jsx(cF,{className:"mr-2 h-4 w-4"})," Git Pull"]}),p.jsxs(pl,{onSelect:()=>I(q.path),children:[p.jsx(lF,{className:"mr-2 h-4 w-4"})," Git Commit..."]}),p.jsxs(pl,{onSelect:()=>j(q.path),children:[p.jsx(hR,{className:"mr-2 h-4 w-4"})," Git Push"]}),p.jsxs(pl,{onSelect:()=>M(q.path),children:[p.jsx(mR,{className:"mr-2 h-4 w-4"})," Git Status"]})]}),re&&!z&&p.jsxs(pl,{onSelect:()=>k(q.path),children:[p.jsx(qu,{className:"mr-2 h-4 w-4"})," Initialize Git Repo"]}),p.jsx(d8,{}),p.jsxs(pl,{className:"text-red-600 focus:text-red-600",onSelect:()=>b(q),children:[p.jsx(Aa,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},q.id)}),e.length===0&&!r&&!a&&p.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Folder is empty"})]})},t3=T.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:s,error:i,rootId:a,selectedFileIds:o,vfsKey:l,configuredVfsKey:c,initializingKey:u}=xs(mn(we=>({nodes:we.nodes,childrenMap:we.childrenMap,currentParentId:we.currentParentId,selectedFileIds:we.selectedFileIds,loading:we.loading,operationLoading:we.operationLoading,error:we.error,rootId:we.rootId,vfsKey:we.vfsKey,configuredVfsKey:we.configuredVfsKey,initializingKey:we.initializingKey}))),[f,m]=T.useState(""),[g,v]=T.useState(null),[b,w]=T.useState(!1),[x,_]=T.useState(""),[E,C]=T.useState({}),[k,R]=T.useState(!1),[I,j]=T.useState(""),[M,L]=T.useState(""),[q,P]=T.useState(!1),[V,z]=T.useState(!1),[re,K]=T.useState(null),[ee,W]=T.useState(""),[se,Y]=T.useState(!1),[te,Q]=T.useState({}),ae=T.useRef(null),xe=T.useRef(null),ge=T.useRef(null),Me=T.useRef(null),Pe=T.useRef(null),Ie=n?e[n]:null,Ce=Ie?Ie.path:"/",it=(t[n||a||""]||[]).map(we=>e[we]).filter(we=>!!we).sort((we,Ue)=>we.type==="folder"&&Ue.type==="file"?-1:we.type==="file"&&Ue.type==="folder"?1:we.name.localeCompare(Ue.name)),Ge=T.useMemo(()=>it.filter(we=>we.type==="folder").map(we=>we.path),[it]),Re=r||u!==null||l!==c,H=s||q||se||Object.values(te).some(Boolean);T.useEffect(()=>{n!==null&&!t[n]&&!Re&&c===l?Be.emit(en.fetchNodesRequest,{parentId:n}):n===null&&a&&!t[a]&&!Re&&c===l&&Be.emit(en.fetchNodesRequest,{parentId:a})},[n,t,a,Re,c,l]),T.useEffect(()=>{var we,Ue;g&&((we=Me.current)==null||we.focus(),(Ue=Me.current)==null||Ue.select())},[g]),T.useEffect(()=>{var we;b&&((we=Pe.current)==null||we.focus())},[b]),T.useEffect(()=>{(async()=>{if(Re||Ge.length===0)return;const Ue={};let Et=!1;for(const he of Ge)try{const G=await ohe(he);E[he]!==G&&(Ue[he]=G,Et=!0)}catch(G){console.error(`Error checking git status for ${he}:`,G),E[he]!==!1&&(Ue[he]=!1,Et=!0)}Et&&C(he=>({...he,...Ue}))})()},[Ge,Re,E]);const me=T.useCallback(async(we,Ue,Et)=>{if(!(H||Re)){Et!==!1&&Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Be.emit(we,Ue)}catch(he){console.error("[FileManager Operation Error]:",he),Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:s,error:he instanceof Error?he.message:String(he)})}finally{Et!==!1&&Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[H,Re,r,s,i]),Te=T.useCallback(we=>{H||Re||g||we.type==="folder"&&me(en.setCurrentPathRequest,{path:we.path},!1)},[H,Re,g,me]),ce=T.useCallback(()=>{if(H||Re||Ce==="/")return;const we=__(Ce);me(en.setCurrentPathRequest,{path:we},!1)},[H,Re,Ce,me]),oe=T.useCallback(()=>{H||Re||Ce==="/"||me(en.setCurrentPathRequest,{path:"/"},!1)},[H,Re,Ce,me]),ne=T.useCallback(()=>{Re||me(en.fetchNodesRequest,{parentId:n},!1)},[me,n,Re]),Se=T.useCallback((we,Ue)=>{const Et=e[Ue];Et&&Et.type==="file"?we?Be.emit(en.selectFileRequest,{fileId:Ue}):Be.emit(en.deselectFileRequest,{fileId:Ue}):Et&&Et.type==="folder"&&Le.info("Folders cannot be attached to the prompt.")},[e]),Fe=T.useCallback(we=>{H||Re||b||(v(we.path),m(we.name),w(!1))},[H,Re,b]),ke=T.useCallback(()=>{v(null),m("")},[]),Xe=T.useCallback(async()=>{if(!g||!f.trim()){ke();return}const we=Object.values(e).find(Ue=>Ue.path===g);we&&we.name!==f.trim()&&await me(en.renameNodeRequest,{id:we.id,newName:f.trim()}),ke()},[g,f,e,ke,me]),St=T.useCallback(()=>{H||Re||g||(w(!0),_(""),v(null))},[H,Re,g]),ht=T.useCallback(()=>{w(!1),_("")},[]),It=T.useCallback(async()=>{if(!x.trim()){ht();return}await me(en.createDirectoryRequest,{parentId:n,name:x.trim()}),ht()},[x,n,ht,me]),Vt=()=>{var we;return(we=ae.current)==null?void 0:we.click()},Ot=()=>{var we;return(we=xe.current)==null?void 0:we.click()},Gt=()=>{var we;return(we=ge.current)==null?void 0:we.click()},be=T.useCallback(async we=>{const Ue=we.target.files;Ue&&Ue.length>0&&(await me(en.uploadFilesRequest,{parentId:n,files:Ue}),we.target&&(we.target.value=""))},[n,me]),O=T.useCallback(async we=>{var Et;const Ue=(Et=we.target.files)==null?void 0:Et[0];if(Ue){Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{await uhe(Ue,Ce),Be.emit(en.fetchNodesRequest,{parentId:n})}catch(he){console.error("Archive upload error:",he)}finally{Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i}),we.target&&(we.target.value="")}}},[Ce,n,r,i]),Z=T.useCallback(async we=>{window.confirm(`Delete ${we.type} "${we.name}"?${we.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await me(en.deleteNodesRequest,{ids:[we.id]})},[me]),fe=T.useCallback(async we=>{Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{we.type==="file"?await che(we.path):await _P(`${we.name}.zip`,we.path)}catch(Ue){console.error("Download error:",Ue)}finally{Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}},[r,i]),Oe=T.useCallback(async()=>{if(it.length!==0){Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{const we=ws(Ce)||"root";await _P(`${we}_export.zip`,Ce)}catch(we){console.error("Download all error:",we)}finally{Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[Ce,it.length,r,i]),ve=T.useCallback(async(we,Ue)=>{if(!(te[we]||Re||s)){Q(Et=>({...Et,[we]:!0})),Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await Ue()}catch(Et){console.error(`[FileManager Git Op Error @ ${we}]:`,Et)}finally{Q(Et=>({...Et,[we]:!1}))}}},[te,Re,s,r]),Ae=T.useCallback(we=>{ve(we,async()=>{await K$(we),C(Ue=>({...Ue,[we]:!0}))})},[ve]),ue=T.useCallback(we=>{Le.info("Pulling default branch (auth not implemented yet)..."),ve(we,()=>A_(we,"main"))},[ve]),mt=T.useCallback(we=>{K(we),W(""),z(!0)},[]),wt=T.useCallback(we=>{Le.info("Pushing default branch (auth not implemented yet)..."),ve(we,()=>RN(we,"main"))},[ve]),B=T.useCallback(we=>{ve(we,()=>W$(we))},[ve]),ze=T.useCallback(()=>{j(""),L(""),R(!0)},[]),rt=T.useCallback(async()=>{if(!I.trim()){Le.error("Repository URL cannot be empty.");return}P(!0),Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{const we=ws(I.trim().replace(/\.git$/,""))||"cloned_repo",Ue=rA(Ce,we);await G$(Ue,I.trim(),M.trim()||void 0),R(!1),Be.emit(en.fetchNodesRequest,{parentId:n})}catch{}finally{P(!1)}},[I,M,Ce,n,r,s]),ye=T.useCallback(async()=>{if(!re||!ee.trim()){Le.error("Commit message cannot be empty.");return}Y(!0),Be.emit(en.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await AN(re,ee.trim()),z(!1)}catch{}finally{Y(!1)}},[re,ee,r,s]);return Re?p.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[p.jsx(Pn,{className:"h-8 w-8 animate-spin mb-2"}),p.jsx("p",{children:u?`Initializing filesystem: ${u}`:"Loading filesystem..."}),i&&p.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",i]})]}):i&&!Re?p.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[p.jsxs("p",{children:["Error loading filesystem: ",i]}),p.jsx(Ct,{variant:"outline",size:"sm",onClick:()=>Be.emit(en.initializeVFSRequest,{vfsKey:l||"default_fallback_key"}),className:"mt-2",children:"Retry"})]}):p.jsxs("div",{className:ct("flex h-full flex-col bg-card text-card-foreground"),children:[p.jsx(aRe,{currentPath:Ce,isAnyLoading:H||Re,isOperationLoading:s,entries:it,editingPath:g,creatingFolder:b,handleNavigateHome:oe,handleNavigateUp:ce,handleRefresh:ne,startCreatingFolder:St,handleUploadClick:Vt,handleFolderUploadClick:Ot,handleArchiveUploadClick:Gt,handleDownloadAll:Oe,handleCloneClick:ze,fileInputRef:ae,folderInputRef:xe,archiveInputRef:ge,handleFileChange:be,handleArchiveChange:O}),p.jsx("div",{className:"flex-grow overflow-auto hidden md:block",children:p.jsx(iRe,{entries:it,editingPath:g,newName:f,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:H,handleNavigate:Te,handleCheckboxChange:Se,startEditing:Fe,cancelEditing:ke,handleRename:Xe,cancelCreatingFolder:ht,handleCreateFolder:It,handleDownload:fe,handleDelete:Z,setNewName:m,setNewFolderName:_,renameInputRef:Me,newFolderInputRef:Pe,gitRepoStatus:E,handleGitInit:Ae,handleGitPull:ue,handleGitCommit:mt,handleGitPush:wt,handleGitStatus:B})}),p.jsx("div",{className:"flex-grow overflow-auto block md:hidden",children:p.jsx(zRe,{entries:it,editingPath:g,newName:f,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:H,handleNavigate:Te,handleCheckboxChange:Se,startEditing:Fe,cancelEditing:ke,handleRename:Xe,cancelCreatingFolder:ht,handleCreateFolder:It,handleDownload:fe,handleDelete:Z,setNewName:m,setNewFolderName:_,renameInputRef:Me,newFolderInputRef:Pe,gitRepoStatus:E,handleGitInit:Ae,handleGitPull:ue,handleGitCommit:mt,handleGitPush:wt,handleGitStatus:B})}),p.jsx(oRe,{isOpen:k,onOpenChange:R,cloneRepoUrl:I,setCloneRepoUrl:j,cloneBranch:M,setCloneBranch:L,isCloning:q,onSubmitClone:rt,currentPath:Ce}),p.jsx(lRe,{isOpen:V,onOpenChange:z,commitPath:re,commitMessage:ee,setCommitMessage:W,isCommitting:se,onSubmitCommit:ye})]})});t3.displayName="FileManager";const URe=({vfsKey:e,selectedItemType:t})=>e==="orphan"?p.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[p.jsx(A4,{className:"h-4 w-4"}),p.jsxs("span",{children:[p.jsx("b",{children:"Shared VFS:"})," All chats ",p.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?p.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[p.jsx(A4,{className:"h-4 w-4"}),p.jsxs("span",{children:[p.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?p.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[p.jsx(Uu,{className:"h-4 w-4"}),p.jsxs("span",{children:[p.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null,qRe=({module:e,isOpen:t,onClose:n})=>{const[r,s]=T.useState(e.getSelectedFileIdsCount()),[i,a]=T.useState(null);T.useEffect(()=>{const u=m=>{s(m.selectedFileIds.length)},f=m=>{a(m.itemType)};return Be.on(en.selectionChanged,u),Be.on(Mn.selectedItemChanged,f),()=>{Be.off(en.selectionChanged,u),Be.off(Mn.selectedItemChanged,f)}},[]);const o=xs.getState().vfsKey,l=()=>{const u=xs.getState().selectedFileIds,f=e.getVfsNodes();if(u.size===0){Le.info("No files selected in VFS to attach.");return}let m=0;u.forEach(g=>{const v=f[g];v&&v.type==="file"&&(Be.emit(eo.addAttachedFileRequest,{source:"vfs",name:v.name,type:v.mimeType||"application/octet-stream",size:v.size,path:v.path}),m++)}),m>0?(Le.success(`Attached ${m} file(s) from VFS to the next prompt.`),e.clearVfsSelection(),n()):Le.warning("No valid files were selected to attach.")},c=()=>{e.clearVfsSelection(),n()};return p.jsx(rS,{open:t,onOpenChange:u=>!u&&c(),children:p.jsxs(sS,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[p.jsxs(iS,{className:"p-4 pb-2 border-b flex-shrink-0",children:[p.jsx(oS,{children:"Virtual Filesystem"}),p.jsx(lS,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),p.jsx(URe,{vfsKey:o,selectedItemType:i})]}),p.jsx("div",{className:"flex-grow overflow-hidden",children:p.jsx(t3,{})}),p.jsxs(aS,{className:"p-4 pt-2 border-t flex-shrink-0",children:[p.jsx(Ct,{variant:"outline",onClick:c,children:"Close"}),p.jsxs(Ct,{onClick:l,disabled:r===0,children:[p.jsx(gR,{className:"h-4 w-4 mr-2"}),"Attach Selected (",r,")"]})]})]})})};class VRe{constructor(){Ne(this,"id","core-vfs");Ne(this,"modalId","core-vfs-modal-panel");Ne(this,"unregisterCallbacks",[]);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"notifyTriggerUpdate",null);Ne(this,"isModalOpenByManager",!1);Ne(this,"getEnableVfs",()=>xs.getState().enableVfs);Ne(this,"getIsVfsModalOpen",()=>this.isModalOpenByManager);Ne(this,"getSelectedFileIdsCount",()=>xs.getState().selectedFileIds.size);Ne(this,"toggleVfsModal",()=>{var t,n;this.isModalOpenByManager?(t=this.modApiRef)==null||t.emit(Xn.closeModalRequest,{modalId:this.modalId}):(n=this.modApiRef)==null||n.emit(Xn.openModalRequest,{modalId:this.modalId})});Ne(this,"clearVfsSelection",()=>{var t;(t=this.modApiRef)==null||t.emit(en.clearSelectionRequest,void 0)});Ne(this,"getVfsNodes",()=>xs.getState().nodes);Ne(this,"setNotifyTriggerUpdate",t=>{this.notifyTriggerUpdate=t})}async initialize(t){this.modApiRef=t,this.updateVfsKeyBasedOnContext();const n=t.on(Xn.contextChanged,()=>{var s;this.updateVfsKeyBasedOnContext(),(s=this.notifyTriggerUpdate)==null||s.call(this)}),r=t.on(Xn.modalStateChanged,s=>{var i;if(s.modalId===this.modalId){const a=s.isOpen;this.isModalOpenByManager!==a&&(this.isModalOpenByManager=a,(i=this.notifyTriggerUpdate)==null||i.call(this),a&&this.updateVfsKeyBasedOnContext())}});this.eventUnsubscribers.push(n,r)}updateVfsKeyBasedOnContext(){var i;const{selectedItemId:t,selectedItemType:n}=br.getState(),r=xs.getState().vfsKey;let s=null;if(this.isModalOpenByManager)if(n==="project")s=t;else if(n==="conversation"){const a=br.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";else if(n==="project")s=t;else if(n==="conversation"){const a=br.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";r!==s&&(console.log(`[${this.id}] Updating VFS key from "${r}" to "${s}"`),(i=this.modApiRef)==null||i.emit(en.setVfsKeyRequest,{key:s}))}register(t){if(this.modApiRef=t,this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=t.registerPromptControl({id:"core-vfs-prompt-trigger",triggerRenderer:()=>dt.createElement(KTe,{module:this})});this.unregisterCallbacks.push(n);const r=t.registerModalProvider(this.modalId,s=>dt.createElement(qRe,{module:this,...s}));this.unregisterCallbacks.push(r)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.notifyTriggerUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const HRe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.selectedItemId,r=e.selectedItemType,s=e.syncRepos,i=e.conversationSyncStatus,a=e.isStreaming,[o,l]=T.useState(null),[c,u]=T.useState("idle"),[f,m]=T.useState(!1),[g,v]=T.useState(!1);T.useEffect(()=>{if(r==="conversation"&&n){const R=e.getConversationById(n);l((R==null?void 0:R.syncRepoId)??null),u(i[n]??"idle")}else l(null),u("idle")},[n,r,i,e]);const b=dt.useMemo(()=>new Map(s.map(R=>[R.id,R.name])),[s]),w=o?b.get(o):void 0,x=T.useCallback(async R=>{if(!n||r!=="conversation")return;m(!0);const I=R==="none"?null:R;await e.linkConversationToRepo(n,I),m(!1)},[n,r,e]),_=T.useCallback(async()=>{!n||!o||(v(!0),await e.syncConversation(n),v(!1))},[n,o,e]),E=$V(c,w),C=!o||g||f||a||c==="syncing";return r==="conversation"&&s.length>0?p.jsxs(Ho,{children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Go,{asChild:!0,children:p.jsx(Ct,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:a||f||g,"aria-label":"Configure Git Sync",children:c==="syncing"||g||f?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(qu,{className:"h-4 w-4"})})})}),p.jsx(cr,{side:"top",children:o?`Sync Status: ${c}`:"Link to Sync Repo"})]})}),p.jsxs(Ko,{className:"w-64 p-4 space-y-3",align:"start",children:[p.jsx(Jt,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),p.jsxs(jb,{value:o??"none",onValueChange:x,disabled:f||g||a,children:[p.jsx(Ob,{id:"sync-repo-select",className:"w-full h-9",children:p.jsx(Mb,{placeholder:"Select repository..."})}),p.jsxs(Pb,{children:[p.jsx(ld,{value:"none",children:p.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(R=>p.jsx(ld,{value:R.id,children:R.name},R.id))]})]}),p.jsxs("div",{className:"flex items-center justify-between pt-2",children:[p.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",E||"Not Linked"]}),p.jsxs(Ct,{size:"sm",variant:"outline",onClick:_,disabled:C,className:"h-8",children:[g||c==="syncing"?p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}):p.jsx(hR,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]}):null},u0=({title:e,description:t,children:n,className:r,titleClassName:s,descriptionClassName:i,contentClassName:a})=>p.jsxs("div",{className:ct("space-y-3",r),children:[p.jsxs("div",{children:[p.jsx("h3",{className:ct("text-lg font-medium",s),children:e}),t&&p.jsx("p",{className:ct("text-sm text-muted-foreground",i),children:t})]}),p.jsx("div",{className:ct(a),children:n})]}),GRe=D.object({gitUserName:D.string().min(1,"User name cannot be empty."),gitUserEmail:D.string().email("Invalid email address.")});function f8({field:e}){return p.jsx(p.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?p.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.map(t=>typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"?t.message:(console.warn("FieldMetaMessages encountered an unexpected error object:",t),"Invalid input")).join(", ")}):null})}const KRe=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=ir(mn(i=>({gitUserName:i.gitUserName,setGitUserName:i.setGitUserName,gitUserEmail:i.gitUserEmail,setGitUserEmail:i.setGitUserEmail}))),s=ri({defaultValues:{gitUserName:e??"",gitUserEmail:n??""},validators:{onChange:GRe},onSubmit:async({value:i})=>{try{t(i.gitUserName),r(i.gitUserEmail),Le.success("Git user configuration updated!")}catch(a){Le.error("Failed to update Git configuration."),console.error("Error submitting Git config form:",a)}}});return T.useEffect(()=>{s.reset({gitUserName:e??"",gitUserEmail:n??""})},[e,n,s]),p.jsx("div",{className:"space-y-6 p-1",children:p.jsx(u0,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-4 shadow-sm bg-card",children:p.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4",children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsx(s.Field,{name:"gitUserName",children:i=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:i.name,children:"Git User Name"}),p.jsx(zn,{id:i.name,value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"Your Name",className:i.state.meta.errors.length?"border-destructive":""}),p.jsx(f8,{field:i})]})}),p.jsx(s.Field,{name:"gitUserEmail",children:i=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:i.name,children:"Git User Email"}),p.jsx(zn,{id:i.name,type:"email",value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"your.email@example.com",className:i.state.meta.errors.length?"border-destructive":""}),p.jsx(f8,{field:i})]})})]}),p.jsx("div",{className:"flex justify-end pt-2",children:p.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>p.jsx(Ct,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Git Config"})})})]})})})},WRe=dt.memo(KRe),ZRe=uR("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function YG({className:e,variant:t,...n}){return p.jsx("div",{"data-slot":"alert",role:"alert",className:ct(ZRe({variant:t}),e),...n})}function XG({className:e,...t}){return p.jsx("div",{"data-slot":"alert-title",className:ct("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function JG({className:e,...t}){return p.jsx("div",{"data-slot":"alert-description",className:ct("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}const YRe=D.object({name:D.string().min(1,"Repository Name is required."),remoteUrl:D.string().min(1,"Remote URL is required.").url("Invalid URL format (e.g., https://github.com/user/repo.git)"),branch:D.string().min(1,"Branch name is required (e.g., main)."),username:D.string().nullable().optional(),password:D.string().nullable().optional()}),Bw={name:"",remoteUrl:"",branch:"main",username:null,password:null},XRe=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,deleteSyncRepo:r,initializeOrSyncRepo:s,repoInitializationStatus:i,isLoading:a}=br(mn(C=>({syncRepos:C.syncRepos,addSyncRepo:C.addSyncRepo,updateSyncRepo:C.updateSyncRepo,deleteSyncRepo:C.deleteSyncRepo,initializeOrSyncRepo:C.initializeOrSyncRepo,repoInitializationStatus:C.repoInitializationStatus,isLoading:C.isLoading}))),[o,l]=T.useState(!1),[c,u]=T.useState(null),[f,m]=T.useState({}),g=ri({defaultValues:Bw,validators:{onChangeAsync:YRe,onChangeAsyncDebounceMs:500},onSubmit:async({value:C})=>{var k,R,I,j;if(!((k=C.name)!=null&&k.trim())||!((R=C.remoteUrl)!=null&&R.trim())){Le.error("Repository Name and Remote URL are required.");return}try{const M={name:C.name.trim(),remoteUrl:C.remoteUrl.trim(),branch:((I=C.branch)==null?void 0:I.trim())||"main",username:((j=C.username)==null?void 0:j.trim())||null,password:C.password||null};c?await n(c,M):await t(M),v()}catch(M){console.error("Failed to save sync repo:",M)}}}),v=T.useCallback(()=>{g.reset(Bw),l(!1),u(null)},[g]);T.useEffect(()=>{if(c){const C=e.find(k=>k.id===c);C?(g.reset({name:C.name,remoteUrl:C.remoteUrl,branch:C.branch||"main",username:C.username??null,password:C.password??null}),l(!1)):v()}else o||g.reset(Bw)},[c,e,g,o,v]);const b=C=>{u(C.id),l(!1)},w=T.useCallback(async(C,k)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${k}"? This will unlink it from any conversations and remove the local copy.`)){m(R=>({...R,[C]:!0}));try{await r(C),c===C&&v()}catch(R){console.error("Failed to delete sync repo:",R)}finally{m(R=>({...R,[C]:!1}))}}},[r,c,v]),x=T.useCallback(async C=>{await s(C)},[s]),_=()=>{u(null),g.reset(Bw),l(!0)},E=()=>p.jsxs("form",{onSubmit:C=>{C.preventDefault(),C.stopPropagation(),g.handleSubmit()},className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[p.jsx("h4",{className:"font-semibold text-card-foreground",children:c?"Edit Sync Repository":"Add New Sync Repository"}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[p.jsx(g.Field,{name:"name",children:C=>p.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[p.jsx(Jt,{htmlFor:C.name,children:"Name"}),p.jsx(zn,{id:C.name,value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"e.g., My Backup",disabled:g.state.isSubmitting}),p.jsx(js,{field:C})]})}),p.jsx(g.Field,{name:"remoteUrl",children:C=>p.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[p.jsx(Jt,{htmlFor:C.name,children:"Remote URL (HTTPS)"}),p.jsx(zn,{id:C.name,type:"url",value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"https://github.com/user/repo.git",disabled:g.state.isSubmitting}),p.jsx(js,{field:C})]})}),p.jsx(g.Field,{name:"branch",children:C=>p.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[p.jsx(Jt,{htmlFor:C.name,children:"Branch"}),p.jsx(zn,{id:C.name,value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"main",disabled:g.state.isSubmitting}),p.jsx(js,{field:C})]})})]}),p.jsxs("div",{className:"pt-2",children:[p.jsx(Jt,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),p.jsxs(YG,{variant:"destructive",className:"mt-2 mb-3",children:[p.jsx(bR,{className:"h-4 w-4"}),p.jsx(XG,{children:"Security Warning"}),p.jsx(JG,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsx(g.Field,{name:"username",children:C=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:C.name,children:"Username"}),p.jsx(zn,{id:C.name,value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"Git Username (Optional)",disabled:g.state.isSubmitting,autoComplete:"off"}),p.jsx(js,{field:C})]})}),p.jsx(g.Field,{name:"password",children:C=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:C.name,children:"Password / Token"}),p.jsx(zn,{id:C.name,type:"password",value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"Password or PAT (Optional)",disabled:g.state.isSubmitting,autoComplete:"new-password"}),p.jsx(js,{field:C})]})})]})]}),p.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[p.jsxs(Ct,{variant:"ghost",size:"sm",onClick:v,disabled:g.state.isSubmitting,type:"button",children:[p.jsx(la,{className:"h-4 w-4 mr-1"})," Cancel"]}),p.jsx(g.Subscribe,{selector:C=>[C.canSubmit,C.isSubmitting,C.isValidating,C.isValid],children:([C,k,R,I])=>p.jsxs(Ct,{variant:"secondary",size:"sm",type:"submit",disabled:k||!C||!I||R,children:[(k||R)&&p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}),p.jsx(hd,{className:"h-4 w-4 mr-1"})," ",k||R?"Saving...":"Save Repository"]})})]})]});return p.jsxs("div",{className:"space-y-6 p-1",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),p.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."})]}),!o&&!c&&p.jsxs(Ct,{onClick:_,variant:"outline",className:"w-full mb-4",disabled:a,children:[p.jsx(sm,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||c)&&E(),p.jsxs("div",{children:[p.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),a&&!o&&!c?p.jsxs("div",{className:"space-y-2",children:[p.jsx(dr,{className:"h-10 w-full"}),p.jsx(dr,{className:"h-10 w-full"}),p.jsx(dr,{className:"h-10 w-full"})]}):e.length===0&&!o&&!c?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):p.jsx("div",{className:"border rounded-md overflow-x-auto",children:p.jsxs(Qf,{children:[p.jsx(Om,{children:p.jsxs(ts,{children:[p.jsx(Lr,{children:"Name"}),p.jsx(Lr,{className:"hidden md:table-cell",children:"Remote URL"}),p.jsx(Lr,{className:"hidden lg:table-cell",children:"Branch"}),p.jsx(Lr,{className:"hidden lg:table-cell",children:"Auth"}),p.jsx(Lr,{className:"text-right",children:"Actions"})]})}),p.jsx(eh,{children:e.map(C=>{const k=f[C.id],R=c===C.id,I=!!C.username||!!C.password,j=i[C.id]||"idle",M=j==="syncing",L=k||g.state.isSubmitting||!!c||M;let q=null,P="Initialize/Sync Repository";return j==="syncing"?(q=p.jsx(Pn,{className:"h-4 w-4 animate-spin mr-1"}),P="Initializing/Syncing..."):j==="idle"?(q=p.jsx(O1,{className:"h-4 w-4 text-green-500 mr-1"}),P="Sync Successful / Ready"):j==="error"?(q=p.jsx(Ac,{className:"h-4 w-4 text-destructive mr-1"}),P="Sync Failed"):q=p.jsx(D1,{className:"h-4 w-4 mr-1"}),p.jsxs(ts,{className:ct(R?"bg-muted/50":"",L&&!R?"opacity-70":""),children:[p.jsx(Ln,{className:"font-medium truncate max-w-[100px] sm:max-w-xs",children:C.name}),p.jsx(Ln,{className:"text-xs truncate max-w-[100px] sm:max-w-xs hidden md:table-cell",children:C.remoteUrl}),p.jsx(Ln,{className:"hidden lg:table-cell",children:C.branch||"main"}),p.jsx(Ln,{className:"text-xs hidden lg:table-cell",children:I?"Configured":"None"}),p.jsxs(Ln,{className:"text-right space-x-1",children:[p.jsx(gn,{tooltipText:P,onClick:()=>x(C.id),"aria-label":`Initialize or Sync repo ${C.name}`,disabled:L,icon:q,variant:"outline",className:"h-8 w-8"}),p.jsx(gn,{tooltipText:"Edit",onClick:()=>b(C),"aria-label":`Edit repo ${C.name}`,disabled:L,icon:p.jsx(Vy,{}),className:"h-8 w-8"}),p.jsx(gn,{tooltipText:"Delete",onClick:()=>w(C.id,C.name),"aria-label":`Delete repo ${C.name}`,disabled:L,icon:k?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Aa,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},C.id)})})]})})]})]})},JRe=dt.memo(XRe),QRe=()=>{const e=T.useMemo(()=>[{value:"config",label:"User Config",content:p.jsx(WRe,{})},{value:"sync",label:"Sync Repositories",content:p.jsx(JRe,{})}],[]);return p.jsx(Vc,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},eNe=dt.memo(QRe);class tNe{constructor(){Ne(this,"id","core-git-sync");Ne(this,"unregisterPromptControlCallback",null);Ne(this,"unregisterSettingsTabCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"selectedItemId",null);Ne(this,"selectedItemType",null);Ne(this,"syncRepos",[]);Ne(this,"conversationSyncStatus",{});Ne(this,"isStreaming",!1);Ne(this,"notifyComponentUpdate",null);Ne(this,"linkConversationToRepo",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Mn.linkConversationToRepoRequest,{conversationId:t,repoId:n})});Ne(this,"syncConversation",t=>{var n;(n=this.modApiRef)==null||n.emit(Mn.syncConversationRequest,{conversationId:t})});Ne(this,"getConversationById",t=>br.getState().getConversationById(t));Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(Xn.contextChanged,o=>{var l;this.selectedItemId=o.selectedItemId,this.selectedItemType=o.selectedItemType,(l=this.notifyComponentUpdate)==null||l.call(this)}),r=t.on(r0.repoChanged,()=>{var o;this.syncRepos=br.getState().syncRepos,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on(Mn.conversationSyncStatusChanged,o=>{var l;typeof o=="object"&&o&&"conversationId"in o&&"status"in o&&(this.conversationSyncStatus={...this.conversationSyncStatus,[o.conversationId]:o.status},(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(On.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),a=t.on(Mn.conversationUpdated,o=>{var l;typeof o=="object"&&o&&"conversationId"in o&&"updates"in o&&o.conversationId===this.selectedItemId&&o.updates.syncRepoId!==void 0&&(this.loadInitialState(),(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,s,i,a)}loadInitialState(){const t=br.getState();this.selectedItemId=t.selectedItemId,this.selectedItemType=t.selectedItemType,this.syncRepos=t.syncRepos,this.conversationSyncStatus=t.conversationSyncStatus,this.isStreaming=Bn.getState().status==="streaming"}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>dt.createElement(HRe,{module:this})})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"git",title:"Git",component:eNe,order:60}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const nNe=D.object({path:D.string().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),rNe=D.object({path:D.string().describe("The path of the file to read within the VFS."),encoding:D.enum(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),sNe=D.object({path:D.string().describe("The path where the file should be written."),content:D.string().describe("The content to write to the file."),encoding:D.enum(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),iNe=D.object({path:D.string().describe("The path of the file or directory to delete."),recursive:D.boolean().optional().default(!1).describe("Whether to delete directories recursively.")}),aNe=D.object({path:D.string().describe("The path of the directory to create (including parents).")}),oNe=D.object({oldPath:D.string().describe("The current path of the item to rename."),newName:D.string().describe("The new name for the item.")});class lNe{constructor(){Ne(this,"id","core-vfs-tools");Ne(this,"unregisterCallbacks",[])}async initialize(t){console.log(`[${this.id}] Initialized.`)}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}console.log(`[${this.id}] Registering Core VFS Tools...`);const n={description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:nNe};this.unregisterCallbacks.push(t.registerTool("vfsListFiles",n,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const f=ar(l||"/");try{const m=await NN(f,{fsInstance:u});return{success:!0,path:f,entries:m.map(g=>({name:g.name,type:g.isDirectory?"folder":"file",size:g.size,lastModified:g.lastModified.toISOString()}))}}catch(m){return{success:!1,path:f,error:m.message}}}));const r={description:"Read the content of a file from the VFS.",parameters:rNe};this.unregisterCallbacks.push(t.registerTool("vfsReadFile",r,async({path:l,encoding:c},u)=>{const f=u==null?void 0:u.fsInstance;if(!f)return{success:!1,error:"Filesystem instance not available in context."};const m=ar(l);try{const g=await Sd(m,{fsInstance:f});let v;return c==="base64"?v=btoa(String.fromCharCode(...g)):v=new TextDecoder().decode(g),{success:!0,path:m,content:v,encoding:c}}catch(g){return{success:!1,path:m,error:g.message}}}));const s={description:"Write content to a file in the VFS.",parameters:sNe};this.unregisterCallbacks.push(t.registerTool("vfsWriteFile",s,async({path:l,content:c,encoding:u},f)=>{const m=f==null?void 0:f.fsInstance;if(!m)return{success:!1,error:"Filesystem instance not available in context."};const g=ar(l);try{let v;if(u==="base64"){const b=atob(c),w=b.length,x=new Uint8Array(w);for(let _=0;_<w;_++)x[_]=b.charCodeAt(_);v=x}else v=c;return await R_(g,v,{fsInstance:m}),{success:!0,path:g}}catch(v){return{success:!1,path:g,error:v.message}}}));const i={description:"Delete a file or directory from the VFS.",parameters:iNe};this.unregisterCallbacks.push(t.registerTool("vfsDelete",i,async({path:l,recursive:c},u)=>{const f=u==null?void 0:u.fsInstance;if(!f)return{success:!1,error:"Filesystem instance not available in context."};const m=ar(l);try{return await IN(m,c,{fsInstance:f}),{success:!0,path:m}}catch(g){return{success:!1,path:m,error:g.message}}}));const a={description:"Create a directory (including parents) in the VFS.",parameters:aNe};this.unregisterCallbacks.push(t.registerTool("vfsCreateDirectory",a,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const f=ar(l);try{return await Z$(f,{fsInstance:u}),{success:!0,path:f}}catch(m){return{success:!1,path:f,error:m.message}}}));const o={description:"Rename a file or directory in the VFS.",parameters:oNe};this.unregisterCallbacks.push(t.registerTool("vfsRename",o,async({oldPath:l,newName:c},u)=>{const f=u==null?void 0:u.fsInstance;if(!f)return{success:!1,error:"Filesystem instance not available in context."};const m=ar(l),g=ar(m.substring(0,m.lastIndexOf("/"))||"/"),v=Pl(g,c);try{return await X$(m,v,{fsInstance:f}),{success:!0,oldPath:m,newPath:v}}catch(b){return{success:!1,oldPath:m,newName:c,error:b.message}}})),console.log(`[${this.id}] Core VFS Tools Registered.`)}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const cNe=D.object({path:D.string().describe("The directory path within the VFS to initialize as a Git repository.")}),uNe=D.object({path:D.string().describe("The directory path of the Git repository within the VFS to commit."),message:D.string().describe("The commit message.")}),dNe=D.object({path:D.string().describe("The directory path of the Git repository within the VFS to pull from."),branch:D.string().optional().describe("The branch name to pull.")}),fNe=D.object({path:D.string().describe("The directory path of the Git repository within the VFS to push."),branch:D.string().optional().describe("The branch name to push.")}),hNe=D.object({path:D.string().describe("The directory path of the Git repository within the VFS to check status.")});class pNe{constructor(){Ne(this,"id","core-git-tools");Ne(this,"unregisterCallbacks",[])}async initialize(t){}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={description:"Initialize an empty Git repository in a VFS directory.",parameters:cNe};this.unregisterCallbacks.push(t.registerTool("gitInit",n,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await K$(o,{fsInstance:c}),{success:!0,message:`Repository initialized at ${o}`}}catch(u){return{success:!1,error:u.message}}}));const r={description:"Stage all changes and commit them in a VFS Git repository.",parameters:uNe};this.unregisterCallbacks.push(t.registerTool("gitCommit",r,async({path:o,message:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const f=ir.getState();if(!f.gitUserName||!f.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await AN(o,l,{fsInstance:u}),{success:!0,message:`Changes committed in ${o}`}}catch(m){return{success:!1,error:m.message}}}));const s={description:"Pull changes from the remote repository for the specified branch.",parameters:dNe};this.unregisterCallbacks.push(t.registerTool("gitPull",s,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await A_(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${o}`}}catch(f){return{success:!1,error:f.message}}}));const i={description:"Push committed changes from the local branch to the remote repository.",parameters:fNe};this.unregisterCallbacks.push(t.registerTool("gitPush",i,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await RN(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${o}`}}catch(f){return{success:!1,error:f.message}}}));const a={description:"Get the Git status for a VFS repository.",parameters:hNe};this.unregisterCallbacks.push(t.registerTool("gitStatus",a,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await W$(o,{fsInstance:c}),{success:!0,message:`Status checked for ${o}`}}catch(u){return{success:!1,error:u.message}}}))}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const mNe=({module:e,popoverMaxSteps:t,setPopoverMaxSteps:n,className:r})=>{const s=e.getEnabledTools(),i=e.getSelectedItemId(),a=e.getSelectedItemType(),o=e.getGlobalDefaultMaxSteps(),l=co(_=>_.tools),[c,u]=T.useState(""),f=T.useMemo(()=>Object.entries(l).map(([_,{definition:E,modId:C}])=>({name:_,description:E.description??"No description provided.",modId:C})).sort((_,E)=>_.name.localeCompare(E.name)),[l]),m=T.useMemo(()=>{const _=c.trim().toLowerCase();return _?f.filter(E=>E.name.toLowerCase().includes(_)||E.description.toLowerCase().includes(_)||E.modId.toLowerCase().includes(_)):f},[f,c]),g=T.useCallback((_,E)=>{e.setEnabledTools(C=>{const k=new Set(C);return E?k.add(_):k.delete(_),k})},[e]),v=T.useCallback(_=>{e.setEnabledTools(()=>_?new Set(f.map(E=>E.name)):new Set)},[f,e]),b=_=>{const E=_.target.value;if(E===""){n(null);return}const C=parseInt(E,10);if(isNaN(C))n(null);else{const k=Math.max(1,Math.min(20,C));n(k)}},w=t===null?"":String(t),x=a!=="conversation"||!i;return p.jsxs("div",{className:ct("p-4 h-[28rem] max-w-2xl space-y-3",r),children:[p.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),p.jsxs("div",{className:"relative",children:[p.jsx(ki,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),p.jsx(zn,{type:"search",placeholder:"Filter tools...",value:c,onChange:_=>u(_.target.value),className:"pl-8 h-9",disabled:x})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs(Jt,{className:"text-xs text-muted-foreground",children:[m.length," tools shown (",s.size," enabled)"]}),p.jsxs("div",{className:"space-x-2",children:[p.jsx(Ct,{variant:"outline",size:"sm",onClick:()=>v(!0),disabled:x||f.length===0,children:"Enable All"}),p.jsx(Ct,{variant:"outline",size:"sm",onClick:()=>v(!1),disabled:x||f.length===0||s.size===0,children:"Disable All"})]})]}),p.jsx(Hi,{className:"h-56 border rounded-md p-2 bg-background/50",children:x?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Select a conversation to manage tools."}):f.length===0?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):m.length===0?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):p.jsx("div",{className:"space-y-1",children:m.map(_=>p.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[p.jsx(Bu,{id:`tool-switch-${_.name}`,checked:s.has(_.name),onCheckedChange:E=>g(_.name,E),className:"flex-shrink-0",disabled:x}),p.jsxs(Jt,{htmlFor:`tool-switch-${_.name}`,className:ct("text-sm font-normal flex-grow pl-2 space-y-0.5",x?"cursor-not-allowed":"cursor-pointer"),title:`${_.name} (from ${_.modId})`,children:[p.jsx("span",{className:"block font-medium",children:_.name}),p.jsx("span",{className:"block text-xs text-muted-foreground break-words",children:_.description})]})]},_.name))})}),p.jsxs("div",{className:"pt-2",children:[p.jsx(Jt,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),p.jsx(zn,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:w,onChange:b,className:"w-20 h-8 text-xs mt-1",placeholder:String(o??5),disabled:x}),p.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})},gNe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=T.useState(!1),[s,i]=T.useState(e.getMaxStepsOverride()),a=e.getEnabledTools(),o=e.getMaxStepsOverride(),l=e.getIsStreaming(),c=e.getIsVisible();T.useEffect(()=>{i(e.getMaxStepsOverride())},[e.getMaxStepsOverride()]);const u=g=>{r(g),!g&&s!==e.getMaxStepsOverride()&&e.setMaxStepsOverride(s)},f=a.size>0||o!==null,m=l;return c?p.jsxs(Ho,{open:n,onOpenChange:u,children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Go,{asChild:!0,children:p.jsx(Ct,{variant:f?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:m,"aria-label":"Configure Tools",children:p.jsx(Cf,{className:"h-4 w-4"})})})}),p.jsx(cr,{side:"top",children:`Tools (${a.size} enabled)`})]})}),p.jsx(Ko,{className:"w-auto p-0",align:"start",children:p.jsx(mNe,{module:e,popoverMaxSteps:s,setPopoverMaxSteps:i})})]}):null};class yNe{constructor(){Ne(this,"id","core-tool-selector");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"transientEnabledTools",new Set);Ne(this,"transientMaxStepsOverride",null);Ne(this,"isStreaming",!1);Ne(this,"isVisible",!0);Ne(this,"selectedItemId",null);Ne(this,"selectedItemType",null);Ne(this,"allToolsCount",0);Ne(this,"globalDefaultMaxSteps",5);Ne(this,"notifyComponentUpdate",null);Ne(this,"getEnabledTools",()=>this.transientEnabledTools);Ne(this,"getMaxStepsOverride",()=>this.transientMaxStepsOverride);Ne(this,"getIsStreaming",()=>this.isStreaming);Ne(this,"getIsVisible",()=>this.isVisible);Ne(this,"getSelectedItemId",()=>this.selectedItemId);Ne(this,"getSelectedItemType",()=>this.selectedItemType);Ne(this,"getAllToolsCount",()=>this.allToolsCount);Ne(this,"getGlobalDefaultMaxSteps",()=>this.globalDefaultMaxSteps);Ne(this,"setEnabledTools",t=>{var n;this.transientEnabledTools=t(this.transientEnabledTools),(n=this.notifyComponentUpdate)==null||n.call(this)});Ne(this,"setMaxStepsOverride",t=>{var n;this.transientMaxStepsOverride=t,(n=this.notifyComponentUpdate)==null||n.call(this)});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var o;this.loadInitialState(),this.updateVisibility(),(o=this.notifyComponentUpdate)==null||o.call(this);const n=t.on(On.statusChanged,l=>{var c;typeof l=="object"&&l&&"status"in l&&this.isStreaming!==(l.status==="streaming")&&(this.isStreaming=l.status==="streaming",(c=this.notifyComponentUpdate)==null||c.call(this))}),r=t.on(Hn.selectedModelChanged,()=>{var l;this.updateVisibility(),(l=this.notifyComponentUpdate)==null||l.call(this)}),s=t.on(Xn.contextChanged,l=>{var c;this.selectedItemId=l.selectedItemId,this.selectedItemType=l.selectedItemType,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this)}),i=t.on(Qt.toolMaxStepsChanged,l=>{var c;typeof l=="object"&&l&&"steps"in l&&(this.globalDefaultMaxSteps=l.steps,(c=this.notifyComponentUpdate)==null||c.call(this))}),a=t.on(rr.toolsChanged,l=>{var c;if(l&&typeof l.tools=="object"){const u=Object.keys(l.tools).length;this.allToolsCount!==u&&(this.allToolsCount=u,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this))}});this.eventUnsubscribers.push(n,r,s,i,a)}loadInitialState(){this.isStreaming=Bn.getState().status==="streaming",this.selectedItemId=br.getState().selectedItemId,this.selectedItemType=br.getState().selectedItemType,this.allToolsCount=Object.keys(co.getState().tools).length,this.globalDefaultMaxSteps=ir.getState().toolMaxSteps}updateVisibility(){var a,o;const{getSelectedModel:t}=gr.getState(),n=t(),r=this.allToolsCount>0,s=((o=(a=n==null?void 0:n.metadata)==null?void 0:a.supported_parameters)==null?void 0:o.includes("tools"))??!1,i=r&&s;this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>dt.createElement(gNe,{module:this}),getMetadata:()=>{if(this.transientEnabledTools.size>0||this.transientMaxStepsOverride!==null)return{enabledTools:Array.from(this.transientEnabledTools),...this.transientMaxStepsOverride!==null&&{maxSteps:this.transientMaxStepsOverride}}},clearOnSubmit:()=>{var r;let n=!1;this.transientEnabledTools.size>0&&(this.transientEnabledTools=new Set,n=!0),this.transientMaxStepsOverride!==null&&(this.transientMaxStepsOverride=null,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}var h8=1,bNe=.9,vNe=.8,wNe=.17,lT=.1,cT=.999,xNe=.9999,_Ne=.99,SNe=/[\\\/_+.#"@\[\(\{&]/,ENe=/[\\\/_+.#"@\[\(\{&]/g,CNe=/[\s-]/,QG=/[\s-]/g;function rR(e,t,n,r,s,i,a){if(i===t.length)return s===e.length?h8:_Ne;var o=`${s},${i}`;if(a[o]!==void 0)return a[o];for(var l=r.charAt(i),c=n.indexOf(l,s),u=0,f,m,g,v;c>=0;)f=rR(e,t,n,r,c+1,i+1,a),f>u&&(c===s?f*=h8:SNe.test(e.charAt(c-1))?(f*=vNe,g=e.slice(s,c-1).match(ENe),g&&s>0&&(f*=Math.pow(cT,g.length))):CNe.test(e.charAt(c-1))?(f*=bNe,v=e.slice(s,c-1).match(QG),v&&s>0&&(f*=Math.pow(cT,v.length))):(f*=wNe,s>0&&(f*=Math.pow(cT,c-s))),e.charAt(c)!==t.charAt(i)&&(f*=xNe)),(f<lT&&n.charAt(c-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(c-1)!==r.charAt(i))&&(m=rR(e,t,n,r,c+1,i+2,a),m*lT>f&&(f=m*lT)),f>u&&(u=f),c=n.indexOf(l,c+1);return a[o]=u,u}function p8(e){return e.toLowerCase().replace(QG," ")}function kNe(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,rR(e,t,p8(e),p8(t),0,0,{})}var Qg='[cmdk-group=""]',uT='[cmdk-group-items=""]',TNe='[cmdk-group-heading=""]',eK='[cmdk-item=""]',m8=`${eK}:not([aria-disabled="true"])`,sR="cmdk-item-select",ap="data-value",ANe=(e,t,n)=>kNe(e,t,n),tK=T.createContext(void 0),$b=()=>T.useContext(tK),nK=T.createContext(void 0),n3=()=>T.useContext(nK),rK=T.createContext(void 0),sK=T.forwardRef((e,t)=>{let n=op(()=>{var Q,ae;return{search:"",value:(ae=(Q=e.value)!=null?Q:e.defaultValue)!=null?ae:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=op(()=>new Set),s=op(()=>new Map),i=op(()=>new Map),a=op(()=>new Set),o=iK(e),{label:l,children:c,value:u,onValueChange:f,filter:m,shouldFilter:g,loop:v,disablePointerSelection:b=!1,vimBindings:w=!0,...x}=e,_=Qs(),E=Qs(),C=Qs(),k=T.useRef(null),R=BNe();Ff(()=>{if(u!==void 0){let Q=u.trim();n.current.value=Q,I.emit()}},[u]),Ff(()=>{R(6,V)},[]);let I=T.useMemo(()=>({subscribe:Q=>(a.current.add(Q),()=>a.current.delete(Q)),snapshot:()=>n.current,setState:(Q,ae,xe)=>{var ge,Me,Pe,Ie;if(!Object.is(n.current[Q],ae)){if(n.current[Q]=ae,Q==="search")P(),L(),R(1,q);else if(Q==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Ce=document.getElementById(C);Ce?Ce.focus():(ge=document.getElementById(_))==null||ge.focus()}if(R(7,()=>{var Ce;n.current.selectedItemId=(Ce=z())==null?void 0:Ce.id,I.emit()}),xe||R(5,V),((Me=o.current)==null?void 0:Me.value)!==void 0){let Ce=ae??"";(Ie=(Pe=o.current).onValueChange)==null||Ie.call(Pe,Ce);return}}I.emit()}},emit:()=>{a.current.forEach(Q=>Q())}}),[]),j=T.useMemo(()=>({value:(Q,ae,xe)=>{var ge;ae!==((ge=i.current.get(Q))==null?void 0:ge.value)&&(i.current.set(Q,{value:ae,keywords:xe}),n.current.filtered.items.set(Q,M(ae,xe)),R(2,()=>{L(),I.emit()}))},item:(Q,ae)=>(r.current.add(Q),ae&&(s.current.has(ae)?s.current.get(ae).add(Q):s.current.set(ae,new Set([Q]))),R(3,()=>{P(),L(),n.current.value||q(),I.emit()}),()=>{i.current.delete(Q),r.current.delete(Q),n.current.filtered.items.delete(Q);let xe=z();R(4,()=>{P(),(xe==null?void 0:xe.getAttribute("id"))===Q&&q(),I.emit()})}),group:Q=>(s.current.has(Q)||s.current.set(Q,new Set),()=>{i.current.delete(Q),s.current.delete(Q)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:_,inputId:C,labelId:E,listInnerRef:k}),[]);function M(Q,ae){var xe,ge;let Me=(ge=(xe=o.current)==null?void 0:xe.filter)!=null?ge:ANe;return Q?Me(Q,n.current.search,ae):0}function L(){if(!n.current.search||o.current.shouldFilter===!1)return;let Q=n.current.filtered.items,ae=[];n.current.filtered.groups.forEach(ge=>{let Me=s.current.get(ge),Pe=0;Me.forEach(Ie=>{let Ce=Q.get(Ie);Pe=Math.max(Ce,Pe)}),ae.push([ge,Pe])});let xe=k.current;re().sort((ge,Me)=>{var Pe,Ie;let Ce=ge.getAttribute("id"),He=Me.getAttribute("id");return((Pe=Q.get(He))!=null?Pe:0)-((Ie=Q.get(Ce))!=null?Ie:0)}).forEach(ge=>{let Me=ge.closest(uT);Me?Me.appendChild(ge.parentElement===Me?ge:ge.closest(`${uT} > *`)):xe.appendChild(ge.parentElement===xe?ge:ge.closest(`${uT} > *`))}),ae.sort((ge,Me)=>Me[1]-ge[1]).forEach(ge=>{var Me;let Pe=(Me=k.current)==null?void 0:Me.querySelector(`${Qg}[${ap}="${encodeURIComponent(ge[0])}"]`);Pe==null||Pe.parentElement.appendChild(Pe)})}function q(){let Q=re().find(xe=>xe.getAttribute("aria-disabled")!=="true"),ae=Q==null?void 0:Q.getAttribute(ap);I.setState("value",ae||void 0)}function P(){var Q,ae,xe,ge;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let Me=0;for(let Pe of r.current){let Ie=(ae=(Q=i.current.get(Pe))==null?void 0:Q.value)!=null?ae:"",Ce=(ge=(xe=i.current.get(Pe))==null?void 0:xe.keywords)!=null?ge:[],He=M(Ie,Ce);n.current.filtered.items.set(Pe,He),He>0&&Me++}for(let[Pe,Ie]of s.current)for(let Ce of Ie)if(n.current.filtered.items.get(Ce)>0){n.current.filtered.groups.add(Pe);break}n.current.filtered.count=Me}function V(){var Q,ae,xe;let ge=z();ge&&(((Q=ge.parentElement)==null?void 0:Q.firstChild)===ge&&((xe=(ae=ge.closest(Qg))==null?void 0:ae.querySelector(TNe))==null||xe.scrollIntoView({block:"nearest"})),ge.scrollIntoView({block:"nearest"}))}function z(){var Q;return(Q=k.current)==null?void 0:Q.querySelector(`${eK}[aria-selected="true"]`)}function re(){var Q;return Array.from(((Q=k.current)==null?void 0:Q.querySelectorAll(m8))||[])}function K(Q){let ae=re()[Q];ae&&I.setState("value",ae.getAttribute(ap))}function ee(Q){var ae;let xe=z(),ge=re(),Me=ge.findIndex(Ie=>Ie===xe),Pe=ge[Me+Q];(ae=o.current)!=null&&ae.loop&&(Pe=Me+Q<0?ge[ge.length-1]:Me+Q===ge.length?ge[0]:ge[Me+Q]),Pe&&I.setState("value",Pe.getAttribute(ap))}function W(Q){let ae=z(),xe=ae==null?void 0:ae.closest(Qg),ge;for(;xe&&!ge;)xe=Q>0?FNe(xe,Qg):LNe(xe,Qg),ge=xe==null?void 0:xe.querySelector(m8);ge?I.setState("value",ge.getAttribute(ap)):ee(Q)}let se=()=>K(re().length-1),Y=Q=>{Q.preventDefault(),Q.metaKey?se():Q.altKey?W(1):ee(1)},te=Q=>{Q.preventDefault(),Q.metaKey?K(0):Q.altKey?W(-1):ee(-1)};return T.createElement(sn.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:Q=>{var ae;(ae=x.onKeyDown)==null||ae.call(x,Q);let xe=Q.nativeEvent.isComposing||Q.keyCode===229;if(!(Q.defaultPrevented||xe))switch(Q.key){case"n":case"j":{w&&Q.ctrlKey&&Y(Q);break}case"ArrowDown":{Y(Q);break}case"p":case"k":{w&&Q.ctrlKey&&te(Q);break}case"ArrowUp":{te(Q);break}case"Home":{Q.preventDefault(),K(0);break}case"End":{Q.preventDefault(),se();break}case"Enter":{Q.preventDefault();let ge=z();if(ge){let Me=new Event(sR);ge.dispatchEvent(Me)}}}}},T.createElement("label",{"cmdk-label":"",htmlFor:j.inputId,id:j.labelId,style:zNe},l),yS(e,Q=>T.createElement(nK.Provider,{value:I},T.createElement(tK.Provider,{value:j},Q))))}),RNe=T.forwardRef((e,t)=>{var n,r;let s=Qs(),i=T.useRef(null),a=T.useContext(rK),o=$b(),l=iK(e),c=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:a==null?void 0:a.forceMount;Ff(()=>{if(!c)return o.item(s,a==null?void 0:a.id)},[c]);let u=aK(s,i,[e.value,e.children,i],e.keywords),f=n3(),m=ud(R=>R.value&&R.value===u.current),g=ud(R=>c||o.filter()===!1?!0:R.search?R.filtered.items.get(s)>0:!0);T.useEffect(()=>{let R=i.current;if(!(!R||e.disabled))return R.addEventListener(sR,v),()=>R.removeEventListener(sR,v)},[g,e.onSelect,e.disabled]);function v(){var R,I;b(),(I=(R=l.current).onSelect)==null||I.call(R,u.current)}function b(){f.setState("value",u.current,!0)}if(!g)return null;let{disabled:w,value:x,onSelect:_,forceMount:E,keywords:C,...k}=e;return T.createElement(sn.div,{ref:Tc(i,t),...k,id:s,"cmdk-item":"",role:"option","aria-disabled":!!w,"aria-selected":!!m,"data-disabled":!!w,"data-selected":!!m,onPointerMove:w||o.getDisablePointerSelection()?void 0:b,onClick:w?void 0:v},e.children)}),NNe=T.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...i}=e,a=Qs(),o=T.useRef(null),l=T.useRef(null),c=Qs(),u=$b(),f=ud(g=>s||u.filter()===!1?!0:g.search?g.filtered.groups.has(a):!0);Ff(()=>u.group(a),[]),aK(a,o,[e.value,e.heading,l]);let m=T.useMemo(()=>({id:a,forceMount:s}),[s]);return T.createElement(sn.div,{ref:Tc(o,t),...i,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},n&&T.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},n),yS(e,g=>T.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?c:void 0},T.createElement(rK.Provider,{value:m},g))))}),INe=T.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=T.useRef(null),i=ud(a=>!a.search);return!n&&!i?null:T.createElement(sn.div,{ref:Tc(s,t),...r,"cmdk-separator":"",role:"separator"})}),jNe=T.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,i=n3(),a=ud(c=>c.search),o=ud(c=>c.selectedItemId),l=$b();return T.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),T.createElement(sn.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:s?e.value:a,onChange:c=>{s||i.setState("search",c.target.value),n==null||n(c.target.value)}})}),MNe=T.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,i=T.useRef(null),a=T.useRef(null),o=ud(c=>c.selectedItemId),l=$b();return T.useEffect(()=>{if(a.current&&i.current){let c=a.current,u=i.current,f,m=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let g=c.offsetHeight;u.style.setProperty("--cmdk-list-height",g.toFixed(1)+"px")})});return m.observe(c),()=>{cancelAnimationFrame(f),m.unobserve(c)}}},[]),T.createElement(sn.div,{ref:Tc(i,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},yS(e,c=>T.createElement("div",{ref:Tc(a,l.listInnerRef),"cmdk-list-sizer":""},c)))}),ONe=T.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:i,container:a,...o}=e;return T.createElement(sH,{open:n,onOpenChange:r},T.createElement(iH,{container:a},T.createElement(aH,{"cmdk-overlay":"",className:s}),T.createElement(oH,{"aria-label":e.label,"cmdk-dialog":"",className:i},T.createElement(sK,{ref:t,...o}))))}),PNe=T.forwardRef((e,t)=>ud(n=>n.filtered.count===0)?T.createElement(sn.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),DNe=T.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...i}=e;return T.createElement(sn.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},yS(e,a=>T.createElement("div",{"aria-hidden":!0},a)))}),Pm=Object.assign(sK,{List:MNe,Item:RNe,Input:jNe,Group:NNe,Separator:INe,Dialog:ONe,Empty:PNe,Loading:DNe});function FNe(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function LNe(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function iK(e){let t=T.useRef(e);return Ff(()=>{t.current=e}),t}var Ff=typeof window>"u"?T.useEffect:T.useLayoutEffect;function op(e){let t=T.useRef();return t.current===void 0&&(t.current=e()),t}function ud(e){let t=n3(),n=()=>e(t.snapshot());return T.useSyncExternalStore(t.subscribe,n,n)}function aK(e,t,n,r=[]){let s=T.useRef(),i=$b();return Ff(()=>{var a;let o=(()=>{var c;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():s.current}})(),l=r.map(c=>c.trim());i.value(e,o,l),(a=t.current)==null||a.setAttribute(ap,o),s.current=o}),s}var BNe=()=>{let[e,t]=T.useState(),n=op(()=>new Map);return Ff(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function $Ne(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function yS({asChild:e,children:t},n){return e&&T.isValidElement(t)?T.cloneElement($Ne(t),{ref:t.ref},n(t.props.children)):n(t)}var zNe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function oK({className:e,...t}){return p.jsx(Pm,{"data-slot":"command",className:ct("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function lK({className:e,...t}){return p.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[p.jsx(ki,{className:"size-4 shrink-0 opacity-50"}),p.jsx(Pm.Input,{"data-slot":"command-input",className:ct("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function cK({className:e,...t}){return p.jsx(Pm.List,{"data-slot":"command-list",className:ct("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function uK({...e}){return p.jsx(Pm.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function dK({className:e,...t}){return p.jsx(Pm.Group,{"data-slot":"command-group",className:ct("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function fK({className:e,...t}){return p.jsx(Pm.Item,{"data-slot":"command-item",className:ct("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const hK=({models:e,value:t,onChange:n,className:r,disabled:s,isLoading:i})=>{const[a,o]=T.useState(!1),[l,c]=T.useState(""),[u,f]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),m=T.useMemo(()=>{let _=e;if(l.trim()){const C=l.toLowerCase();_=e.filter(k=>k.name.toLowerCase().includes(C)||k.providerName.toLowerCase().includes(C)||k.id.toLowerCase().includes(C))}const E=Object.entries(u).filter(([,C])=>C).map(([C])=>C);return E.length===0?_:_.filter(C=>{var I,j;const k=new Set(((I=C.metadataSummary)==null?void 0:I.supported_parameters)??[]),R=new Set(((j=C.metadataSummary)==null?void 0:j.input_modalities)??[]);return E.every(M=>{switch(M){case"reasoning":return k.has("reasoning");case"webSearch":return k.has("web_search")||k.has("web_search_options");case"tools":return k.has("tools");case"multimodal":return Array.from(R).some(L=>L!=="text");default:return!0}})})},[e,l,u]),g=T.useMemo(()=>e.find(_=>_.id===t),[e,t]),v=T.useCallback(_=>{const E=_===t?null:_;n==null||n(E),o(!1),c("")},[t,n]),b=_=>{f(E=>({...E,[_]:!E[_]}))};if(i)return p.jsx(dr,{className:ct("h-9 w-[250px]",r)});const x=Object.values(u).filter(Boolean).length;return p.jsxs(Ho,{open:a,onOpenChange:o,children:[p.jsx(Go,{asChild:!0,children:p.jsxs(Ct,{variant:"outline",role:"combobox","aria-expanded":a,disabled:s||e.length===0,className:ct("w-auto justify-between h-9 text-sm font-normal relative",r),children:[p.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:g?`${g.name} (${g.providerName})`:"Select Model..."}),p.jsx(M1,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),x>0&&p.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),p.jsx(Ko,{className:"w-[--radix-popover-trigger-width] p-0",style:{maxHeight:"min(40vh, 400px)",overflow:"hidden"},children:p.jsxs(oK,{shouldFilter:!1,children:[p.jsxs("div",{className:"flex items-center border-b px-3",children:[p.jsx(ki,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),p.jsx(lK,{placeholder:"Search model...",value:l,onValueChange:c,className:"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"}),p.jsxs("div",{className:"flex items-center gap-0.5 ml-auto pl-2",children:[p.jsx(Ct,{variant:u.reasoning?"secondary":"ghost",size:"sm",className:ct("h-7 w-7 p-0",u.reasoning&&"text-primary"),onClick:()=>b("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:p.jsx(_4,{className:"h-4 w-4"})}),p.jsx(Ct,{variant:u.webSearch?"secondary":"ghost",size:"sm",className:ct("h-7 w-7 p-0",u.webSearch&&"text-primary"),onClick:()=>b("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:p.jsx(E4,{className:"h-4 w-4"})}),p.jsx(Ct,{variant:u.tools?"secondary":"ghost",size:"sm",className:ct("h-7 w-7 p-0",u.tools&&"text-primary"),onClick:()=>b("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:p.jsx(Cf,{className:"h-4 w-4"})}),p.jsx(Ct,{variant:u.multimodal?"secondary":"ghost",size:"sm",className:ct("h-7 w-7 p-0",u.multimodal&&"text-primary"),onClick:()=>b("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:p.jsx(Ef,{className:"h-4 w-4"})})]})]}),p.jsxs(cK,{className:"max-h-[calc(min(40vh,400px)-70px)] overflow-y-auto",children:[p.jsx(uK,{children:x>0?"No models match all active filters.":e.length===0?"No models available.":"No model found."}),p.jsx(dK,{children:m.map(_=>{var E,C,k,R,I,j,M,L,q,P;return p.jsx(fK,{value:_.id,onSelect:v,className:"flex items-center",children:p.jsxs("div",{className:"flex-1 truncate flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-sm font-medium",children:_.name}),p.jsx("div",{className:"text-xs text-muted-foreground",children:_.providerName})]}),p.jsxs("div",{className:"flex gap-1 ml-2",children:[((C=(E=_.metadataSummary)==null?void 0:E.supported_parameters)==null?void 0:C.includes("reasoning"))&&p.jsx(_4,{className:"h-3.5 w-3.5 text-purple-500"}),(((R=(k=_.metadataSummary)==null?void 0:k.supported_parameters)==null?void 0:R.includes("web_search"))||((j=(I=_.metadataSummary)==null?void 0:I.supported_parameters)==null?void 0:j.includes("web_search_options")))&&p.jsx(E4,{className:"h-3.5 w-3.5 text-blue-500"}),((L=(M=_.metadataSummary)==null?void 0:M.supported_parameters)==null?void 0:L.includes("tools"))&&p.jsx(Cf,{className:"h-3.5 w-3.5 text-orange-500"}),((P=(q=_.metadataSummary)==null?void 0:q.input_modalities)==null?void 0:P.some(V=>V!=="text"))&&p.jsx(Ef,{className:"h-3.5 w-3.5 text-green-500"})]})]})},_.id)})})]})]})})]})},dT=D.object({systemPrompt:D.string().nullable(),modelId:D.string().nullable()}),UNe=({initialSystemPrompt:e,initialModelId:t,onSave:n,effectiveSystemPrompt:r,effectiveModelId:s,isParentSaving:i=!1})=>{var u;const{getAvailableModelListItems:a}=gr(mn(f=>({getAvailableModelListItems:f.getAvailableModelListItems}))),o=a(),l=((u=o.find(f=>f.id===s))==null?void 0:u.name)||s,c=ri({defaultValues:{systemPrompt:e??null,modelId:t??null},validators:{onChangeAsync:dT,onChangeAsyncDebounceMs:500},onSubmit:async({value:f})=>{await n({systemPrompt:f.systemPrompt,modelId:f.modelId})}});return T.useEffect(()=>{c.reset({systemPrompt:e??null,modelId:t??null})},[e,t,c]),p.jsxs("form",{onSubmit:f=>{f.preventDefault(),f.stopPropagation(),c.handleSubmit()},className:"space-y-6",children:[p.jsx(c.Field,{name:"systemPrompt",validators:{onChange:dT.shape.systemPrompt},children:f=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:`${f.name}-textarea`,children:"System Prompt (Overrides Parent/Global)"}),p.jsx(Ad,{id:`${f.name}-textarea`,placeholder:`Inherited: ${(r==null?void 0:r.substring(0,100))||"Default"}${r&&r.length>100?"...":""}`,value:f.state.value??"",onChange:m=>f.handleChange(m.target.value),onBlur:f.handleBlur,rows:6,disabled:c.state.isSubmitting||i,className:"mt-1"}),p.jsx(js,{field:f}),p.jsx(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("systemPrompt",null),disabled:c.state.isSubmitting||i||f.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),p.jsx(c.Field,{name:"modelId",validators:{onChange:dT.shape.modelId},children:f=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{children:"Default Model (Overrides Parent/Global)"}),p.jsx(hK,{models:o,value:f.state.value,onChange:m=>{f.handleChange(m),f.handleBlur()},disabled:c.state.isSubmitting||i,className:"w-full mt-1"}),p.jsx(js,{field:f}),p.jsxs(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("modelId",null),disabled:c.state.isSubmitting||i||f.state.value===null,type:"button",children:["Use Inherited/Default (",l||"Global Default",")"]})]})}),p.jsx("div",{className:"flex justify-end pt-2",children:p.jsx(c.Subscribe,{selector:f=>[f.canSubmit,f.isSubmitting,f.isValidating,f.isValid],children:([f,m,g,v])=>p.jsxs(Ct,{type:"submit",size:"sm",disabled:i||!f||m||g||!v,children:[(m||g)&&p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}),p.jsx(hd,{className:"h-4 w-4 mr-1"}),m||g?"Saving...":"Save Prompt Settings"]})})})]})};function rp({field:e}){return e.state.meta.isTouched&&e.state.meta.errors.length>0?p.jsx("em",{className:"text-xs text-destructive pt-1 block",children:e.state.meta.errors.join(", ")}):null}const qNe=({form:e,isSaving:t,effectiveTemperature:n,effectiveMaxTokens:r,effectiveTopP:s,effectiveTopK:i,effectivePresencePenalty:a,effectiveFrequencyPenalty:o})=>p.jsxs("div",{className:"space-y-4",children:[p.jsx(e.Field,{name:"temperature",children:l=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsxs(Jt,{htmlFor:l.name,className:"text-xs",children:["Temperature (",(l.state.value??n??.7).toFixed(2),")"]}),p.jsx(l0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??n??.7],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),p.jsxs(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(n==null?void 0:n.toFixed(2))??"N/A",")"]}),p.jsx(rp,{field:l})]})}),p.jsx(e.Field,{name:"topP",children:l=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsxs(Jt,{htmlFor:l.name,className:"text-xs",children:["Top P (",(l.state.value??s??1).toFixed(2),")"]}),p.jsx(l0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??s??1],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),p.jsxs(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(s==null?void 0:s.toFixed(2))??"N/A",")"]}),p.jsx(rp,{field:l})]})}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[p.jsx(e.Field,{name:"maxTokens",children:l=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:l.name,className:"text-xs",children:"Max Tokens"}),p.jsx(zn,{id:l.name,type:"number",placeholder:`Inherited: ${r??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),p.jsx(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),p.jsx(rp,{field:l})]})}),p.jsx(e.Field,{name:"topK",children:l=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:l.name,className:"text-xs",children:"Top K"}),p.jsx(zn,{id:l.name,type:"number",placeholder:`Inherited: ${i??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),p.jsx(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),p.jsx(rp,{field:l})]})})]}),p.jsx(e.Field,{name:"presencePenalty",children:l=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsxs(Jt,{htmlFor:l.name,className:"text-xs",children:["Presence Penalty (",(l.state.value??a??0).toFixed(2),")"]}),p.jsx(l0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??a??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),p.jsxs(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(a==null?void 0:a.toFixed(2))??"N/A",")"]}),p.jsx(rp,{field:l})]})}),p.jsx(e.Field,{name:"frequencyPenalty",children:l=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsxs(Jt,{htmlFor:l.name,className:"text-xs",children:["Frequency Penalty (",(l.state.value??o??0).toFixed(2),")"]}),p.jsx(l0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??o??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),p.jsxs(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(o==null?void 0:o.toFixed(2))??"N/A",")"]}),p.jsx(rp,{field:l})]})})]}),g8=D.object({syncRepoId:D.string().nullable()}),VNe=({initialSyncRepoId:e,onSave:t,effectiveSyncRepoId:n,syncRepos:r,isParentSaving:s=!1})=>{var o;const i=((o=r.find(l=>l.id===n))==null?void 0:o.name)??"None",a=ri({defaultValues:{syncRepoId:e??null},validators:{onChangeAsync:g8,onChangeAsyncDebounceMs:500},onSubmit:async({value:l})=>{await t(l)}});return T.useEffect(()=>{a.reset({syncRepoId:e??null})},[e,a]),p.jsxs("form",{onSubmit:l=>{l.preventDefault(),l.stopPropagation(),a.handleSubmit()},className:"space-y-6",children:[p.jsx(a.Field,{name:"syncRepoId",validators:{onChange:g8.shape.syncRepoId},children:l=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:l.name,children:"Sync Repository (Overrides Parent/Global)"}),p.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),p.jsxs(jb,{value:l.state.value??"none",onValueChange:c=>{l.handleChange(c==="none"?null:c),l.handleBlur()},disabled:a.state.isSubmitting||s||r.length===0,children:[p.jsx(Ob,{id:l.name,children:p.jsx(Mb,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${i}`})}),p.jsxs(Pb,{children:[p.jsx(ld,{value:"none",children:p.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",i,")"]})}),r.map(c=>p.jsx(ld,{value:c.id,children:c.name},c.id))]})]}),p.jsx(js,{field:l}),p.jsx(Ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a.setFieldValue("syncRepoId",null),disabled:a.state.isSubmitting||s||l.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),p.jsx("div",{className:"flex justify-end pt-2",children:p.jsx(a.Subscribe,{selector:l=>[l.canSubmit,l.isSubmitting,l.isValidating,l.isValid],children:([l,c,u,f])=>p.jsxs(Ct,{type:"submit",size:"sm",disabled:s||!l||c||u||!f||r.length===0,children:[(c||u)&&p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}),p.jsx(hd,{className:"h-4 w-4 mr-1"}),c||u?"Saving...":"Save Sync Settings"]})})})]})},HNe=({projectId:e})=>{const t=T.useMemo(()=>[{value:"manage",label:"Manage Files",content:p.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?p.jsx(t3,{}):p.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings",content:p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx(Jt,{children:"Project Filesystem Info"}),p.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),p.jsxs("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2 break-all",children:[" ",p.jsxs("p",{children:[p.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",p.jsx("code",{className:"text-xs",children:e||"N/A"})]})]})]}),p.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[p.jsx(Jt,{className:"text-destructive",children:"Danger Zone"}),p.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."})]})]})}],[e]);return p.jsx(Vc,{tabs:t,defaultValue:"manage",className:"h-full flex flex-col",listClassName:ct("bg-muted/50 rounded-md","flex-wrap justify-start h-auto","p-1 gap-1"),contentContainerClassName:"mt-3 flex-grow flex flex-col overflow-y-auto"})},GNe=({allRules:e,selectedRuleIds:t,onSelectionChange:n,disabled:r=!1})=>{const[s,i]=T.useState(""),a=T.useMemo(()=>{const o=s.toLowerCase();return o?e.filter(l=>l.name.toLowerCase().includes(o)||l.content.toLowerCase().includes(o)||l.type.toLowerCase().includes(o)):e},[e,s]);return p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"relative",children:[p.jsx(ki,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),p.jsx(zn,{type:"search",placeholder:"Filter rules...",value:s,onChange:o=>i(o.target.value),className:"pl-8 h-9",disabled:r})]}),p.jsx(Hi,{className:"h-48 border rounded-md p-2 bg-background/50",children:a.length===0?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No rules defined globally.":"No rules match filter."}):p.jsx("div",{className:"space-y-1",children:a.map(o=>p.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:p.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[p.jsx(Bc,{id:`project-default-rule-${o.id}`,checked:t.has(o.id),onCheckedChange:l=>n(o.id,!!l),className:"mt-0.5",disabled:r}),p.jsxs(Jt,{htmlFor:`project-default-rule-${o.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[p.jsx("span",{className:"block font-medium",children:o.name}),p.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",o.type]}),p.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",o.content]})]})]})},o.id))})})]})},KNe=({defaultRuleIds:e,setDefaultRuleIds:t,isSaving:n,allRules:r})=>{const s=T.useMemo(()=>new Set(e??[]),[e]),i=T.useCallback((a,o)=>{const l=new Set(s);o?l.add(a):l.delete(a);const c=Array.from(l);t(c.length>0?c:null)},[s,t]);return p.jsxs("div",{className:"space-y-4",children:[p.jsx(Jt,{children:"Default Rules for this Project"}),p.jsx("p",{className:"text-xs text-muted-foreground",children:"Select rules that will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),p.jsx(GNe,{allRules:r,selectedRuleIds:s,onSelectionChange:i,disabled:n})]})},WNe=({allTags:e,selectedTagIds:t,onSelectionChange:n,disabled:r=!1,getRulesForTag:s})=>{const[i,a]=T.useState(""),o=T.useMemo(()=>{const l=i.toLowerCase();return l?e.filter(c=>{var u;return c.name.toLowerCase().includes(l)||((u=c.description)==null?void 0:u.toLowerCase().includes(l))}):e},[e,i]);return p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"relative",children:[p.jsx(ki,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),p.jsx(zn,{type:"search",placeholder:"Filter tags...",value:i,onChange:l=>a(l.target.value),className:"pl-8 h-9",disabled:r})]}),p.jsx(Hi,{className:"h-48 border rounded-md p-2 bg-background/50",children:o.length===0?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No tags defined globally.":"No tags match filter."}):p.jsx("div",{className:"space-y-1",children:o.map(l=>{const c=s(l.id);return p.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:p.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[p.jsx(Bc,{id:`project-default-tag-${l.id}`,checked:t.has(l.id),onCheckedChange:u=>n(l.id,!!u),className:"mt-0.5",disabled:r}),p.jsxs(Jt,{htmlFor:`project-default-tag-${l.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[p.jsx("span",{className:"block font-medium",children:l.name}),l.description&&p.jsx("span",{className:"block text-xs text-muted-foreground",children:l.description}),c.length>0&&p.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",c.map(u=>u.name).join(", ")]})]})]})},l.id)})})})]})},ZNe=({defaultTagIds:e,setDefaultTagIds:t,isSaving:n,allTags:r,getRulesForTag:s})=>{const i=T.useMemo(()=>new Set(e??[]),[e]),a=T.useCallback((o,l)=>{const c=new Set(i);l?c.add(o):c.delete(o);const u=Array.from(c);t(u.length>0?u:null)},[i,t]);return p.jsxs("div",{className:"space-y-4",children:[p.jsx(Jt,{children:"Default Tags for this Project"}),p.jsx("p",{className:"text-xs text-muted-foreground",children:"Select tags whose rules will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),p.jsx(WNe,{allTags:r,selectedTagIds:i,onSelectionChange:a,disabled:n,getRulesForTag:s})]})},YNe=D.object({temperature:D.number().min(0).max(1),topP:D.number().min(0).max(1),maxTokens:D.number().min(1).nullable(),topK:D.number().min(1).nullable(),presencePenalty:D.number().min(-2).max(2),frequencyPenalty:D.number().min(-2).max(2)}),XNe=({isOpen:e,onClose:t,projectId:n,module:r})=>{const{getProjectById:s,updateProject:i}=Oa(mn(K=>({getProjectById:K.getProjectById,updateProject:K.updateProject}))),a=Oa(K=>K.getEffectiveProjectSettings),o=br(K=>K.syncRepos),l=ir(mn(K=>({globalSystemPrompt:K.globalSystemPrompt,temperature:K.temperature,maxTokens:K.maxTokens,topP:K.topP,topK:K.topK,presencePenalty:K.presencePenalty,frequencyPenalty:K.frequencyPenalty}))),c=gr(K=>K.selectedModelId),u=xs(K=>K.setVfsKey),[f,m]=T.useState(null),[g,v]=T.useState(null),[b,w]=T.useState(null),[x,_]=T.useState(null),[E,C]=T.useState(null),[k,R]=T.useState(!1),[I,j]=T.useState("prompt"),{project:M,effectiveSettings:L}=T.useMemo(()=>{const K=n?s(n):null,ee=n?a(n):null;return{project:K,effectiveSettings:ee}},[n,s,a]),q=ri({defaultValues:{temperature:(M==null?void 0:M.temperature)??.7,topP:(M==null?void 0:M.topP)??1,maxTokens:(M==null?void 0:M.maxTokens)??null,topK:(M==null?void 0:M.topK)??null,presencePenalty:(M==null?void 0:M.presencePenalty)??0,frequencyPenalty:(M==null?void 0:M.presencePenalty)??0},validators:{onChangeAsync:YNe,onChangeAsyncDebounceMs:500}}),P=T.useCallback(K=>{var W;if(!K)return null;const ee=s(K);return ee?((W=ee.metadata)==null?void 0:W.syncRepoId)!==void 0?ee.metadata.syncRepoId:P(ee.parentId):null},[s]),V=n?P(n):null;T.useEffect(()=>{var K;e&&n&&M&&L?(u(n),m(M.systemPrompt??null),v(M.modelId??null),w(((K=M.metadata)==null?void 0:K.syncRepoId)??null),_(M.defaultTagIds??null),C(M.defaultRuleIds??null),q.reset({temperature:M.temperature??.7,topP:M.topP??1,maxTokens:M.maxTokens??null,topK:M.topK??null,presencePenalty:M.presencePenalty??0,frequencyPenalty:M.frequencyPenalty??0}),j("prompt")):e||(u(null),m(null),v(null),w(null),_(null),C(null),q.reset({temperature:.7,topP:1,maxTokens:null,topK:null,presencePenalty:0,frequencyPenalty:0}))},[e,n,M,L,u,q]);const z=async()=>{if(!(!n||!M)){R(!0);try{const K=M.parentId?a(M.parentId):{systemPrompt:l.globalSystemPrompt,modelId:c,temperature:l.temperature,maxTokens:l.maxTokens,topP:l.topP,topK:l.topK,presencePenalty:l.presencePenalty,frequencyPenalty:l.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null},ee=M.parentId?P(M.parentId):null,W={},se={...M.metadata??{}},Y=q.state.values;f!==K.systemPrompt?W.systemPrompt=f:W.systemPrompt=void 0,g!==K.modelId?W.modelId=g:W.modelId=void 0,Y.temperature!==K.temperature?W.temperature=Y.temperature:W.temperature=void 0,Y.maxTokens!==K.maxTokens?W.maxTokens=Y.maxTokens:W.maxTokens=void 0,Y.topP!==K.topP?W.topP=Y.topP:W.topP=void 0,Y.topK!==K.topK?W.topK=Y.topK:W.topK=void 0,Y.presencePenalty!==K.presencePenalty?W.presencePenalty=Y.presencePenalty:W.presencePenalty=void 0,Y.frequencyPenalty!==K.frequencyPenalty?W.frequencyPenalty=Y.frequencyPenalty:W.frequencyPenalty=void 0,b!==ee?se.syncRepoId=b:delete se.syncRepoId,JSON.stringify(x)!==JSON.stringify(K.defaultTagIds)?W.defaultTagIds=x:W.defaultTagIds=void 0,JSON.stringify(E)!==JSON.stringify(K.defaultRuleIds)?W.defaultRuleIds=E:W.defaultRuleIds=void 0,W.metadata=se,await i(n,W),Le.success(`Project "${M.name}" settings updated.`),t()}catch(K){Le.error("Failed to save project settings."),console.error("Failed to save project settings:",K)}finally{R(!1)}}},re=T.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:p.jsx(UNe,{initialSystemPrompt:f,initialModelId:g,onSave:({systemPrompt:K,modelId:ee})=>{m(K),v(ee)},effectiveSystemPrompt:(L==null?void 0:L.systemPrompt)??l.globalSystemPrompt,effectiveModelId:(L==null?void 0:L.modelId)??c,isParentSaving:k})},{value:"params",label:"Parameters",content:p.jsx(qNe,{form:q,effectiveTemperature:(L==null?void 0:L.temperature)??l.temperature,effectiveMaxTokens:(L==null?void 0:L.maxTokens)??l.maxTokens,effectiveTopP:(L==null?void 0:L.topP)??l.topP??1,effectiveTopK:(L==null?void 0:L.topK)??l.topK,effectivePresencePenalty:(L==null?void 0:L.presencePenalty)??l.presencePenalty??0,effectiveFrequencyPenalty:(L==null?void 0:L.frequencyPenalty)??l.frequencyPenalty??0,isSaving:k})},{value:"rules-tags",label:"Rules & Tags",content:p.jsxs("div",{className:"space-y-6",children:[p.jsx(KNe,{defaultRuleIds:E,setDefaultRuleIds:C,isSaving:k,allRules:r.getAllRules()}),p.jsx(ZNe,{defaultTagIds:x,setDefaultTagIds:_,isSaving:k,allTags:r.getAllTags(),getRulesForTag:r.getRulesForTag})]})},{value:"sync",label:"Sync",content:p.jsx(VNe,{initialSyncRepoId:b,onSave:({syncRepoId:K})=>{w(K)},effectiveSyncRepoId:V,syncRepos:o,isParentSaving:k})},{value:"vfs",label:"Filesystem",content:p.jsx(HNe,{projectId:n,projectName:(M==null?void 0:M.name)??null,isSaving:k})}],[f,g,b,x,E,q,L,l,c,k,V,o,n,M==null?void 0:M.name,r]);return p.jsx(rS,{open:e,onOpenChange:t,children:p.jsxs(sS,{className:ct("w-[95vw] h-[85vh] flex flex-col p-0","sm:w-[90vw] sm:max-w-[800px]","md:h-[75vh]","min-h-[500px] max-h-[90vh]"),children:[p.jsxs(iS,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[p.jsxs(oS,{children:["Project Settings: ",M==null?void 0:M.name]}),p.jsx(lS,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),p.jsx(Vc,{tabs:re,initialValue:I,onValueChange:j,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"pb-4 md:pb-6 pr-1 md:pr-2 -mr-1 md:-mr-2",scrollable:!0}),p.jsxs(aS,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:[p.jsx(Ct,{variant:"outline",onClick:t,disabled:k,children:"Cancel"}),p.jsxs(Ct,{onClick:z,disabled:k,children:[k&&p.jsx(Pn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};class JNe{constructor(){Ne(this,"id","core-project-settings");Ne(this,"modalId","projectSettingsModal");Ne(this,"unregisterModalProviderCallback",null);Ne(this,"modApiRef",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"allRules",[]);Ne(this,"allTags",[]);Ne(this,"tagRuleLinks",[]);Ne(this,"getAllRules",()=>this.allRules);Ne(this,"getAllTags",()=>this.allTags);Ne(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});Ne(this,"openModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Xn.openModalRequest,{modalId:this.modalId,targetId:t,initialTab:n})});Ne(this,"closeModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Xn.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t;const n=t.on(Fn.dataLoaded,r=>{r&&(this.allRules=r.rules||[],this.allTags=r.tags||[],this.tagRuleLinks=(r.links||[]).map(s=>({tagId:s.tagId,ruleId:s.ruleId})))});this.eventUnsubscribers.push(n),t.emit(Fn.loadRulesAndTagsRequest,void 0),console.log(`[${this.id}] Initialized.`)}register(t){if(this.modApiRef=t,this.unregisterModalProviderCallback){console.warn(`[${this.id}] Modal provider already registered. Skipping.`);return}this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>dt.createElement(XNe,{isOpen:n.isOpen,onClose:n.onClose,projectId:n.targetId||null,module:this})),console.log(`[${this.id}] Modal provider registered for ${this.modalId}.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const r3=dt.memo(({module:e,value:t,onChange:n,className:r,disabled:s})=>{const[,i]=T.useState({});T.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=!!e,o=a?e.selectedModelId:t,l=a?e.isStreaming:s,c=a?e.isLoadingProviders:!1,u=a?e.globallyEnabledModels:gr(m=>m.getGloballyEnabledModelDefinitions()),f=T.useCallback(m=>{a&&e?e.handleSelectionChange(m):n&&n(m)},[a,e,n]);return p.jsx(hK,{models:u,value:o,onChange:f,className:r,disabled:l,isLoading:c})});r3.displayName="GlobalModelSelector";class QNe{constructor(){Ne(this,"id","core-global-model-selector");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"selectedModelId",null);Ne(this,"isStreaming",!1);Ne(this,"isLoadingProviders",!0);Ne(this,"globallyEnabledModels",[]);Ne(this,"notifyComponentUpdate",null);Ne(this,"handleSelectionChange",t=>{var n,r;(n=this.modApiRef)==null||n.emit(Hn.selectModelRequest,{modelId:t}),(r=this.modApiRef)==null||r.emit(Tn.setModelIdRequest,{id:t})});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t;const n=gr.getState();this.isLoadingProviders=n.isLoading,this.selectedModelId=n.selectedModelId,this.isStreaming=Bn.getState().status==="streaming",this.isLoadingProviders||(this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions());const r=t.on(On.statusChanged,o=>{var l;if(typeof o=="object"&&o&&"status"in o){const c=o.status==="streaming";this.isStreaming!==c&&(this.isStreaming=c,(l=this.notifyComponentUpdate)==null||l.call(this))}}),s=t.on(Hn.selectedModelChanged,o=>{var l,c;typeof o=="object"&&o&&"modelId"in o&&this.selectedModelId!==o.modelId&&(this.selectedModelId=o.modelId,(l=this.modApiRef)==null||l.emit(Tn.setModelIdRequest,{id:o.modelId}),(c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(Hn.globallyEnabledModelsUpdated,o=>{var f,m;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=gr.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0);const u=gr.getState().selectedModelId;this.selectedModelId!==u&&(this.selectedModelId=u,(f=this.modApiRef)==null||f.emit(Tn.setModelIdRequest,{id:this.selectedModelId}),l=!0),l&&((m=this.notifyComponentUpdate)==null||m.call(this))}),a=t.on(Hn.initialDataLoaded,()=>{var u,f;const o=gr.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0),this.selectedModelId!==o.selectedModelId&&(this.selectedModelId=o.selectedModelId,(u=this.modApiRef)==null||u.emit(Tn.setModelIdRequest,{id:this.selectedModelId}),l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((f=this.notifyComponentUpdate)==null||f.call(this))});this.eventUnsubscribers.push(r,s,i,a)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingProviders?"loading":"ready",triggerRenderer:()=>dt.createElement(r3,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const eIe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=T.useState(!1),[s,i]=T.useState(e.getTurnSystemPrompt()),a=e.getEffectiveSystemPrompt(),o=e.getIsStreaming(),l=e.getTurnSystemPrompt();T.useEffect(()=>{n&&i(e.getTurnSystemPrompt())},[n,e]),T.useEffect(()=>{const g=e.getTurnSystemPrompt();s!==g&&i(g)},[e.getTurnSystemPrompt(),s]);const c=T.useCallback(()=>{e.setTurnSystemPrompt(s.trim()),r(!1)},[s,e]),u=T.useCallback(()=>{i(""),e.setTurnSystemPrompt(""),r(!1)},[e]),f=g=>{g&&i(e.getTurnSystemPrompt()),r(g)},m=l.trim().length>0;return p.jsxs(Ho,{open:n,onOpenChange:f,children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Go,{asChild:!0,children:p.jsx(Ct,{variant:m?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:o,"aria-label":"Set System Prompt for Next Turn",children:p.jsx(yJ,{className:"h-4 w-4"})})})}),p.jsx(cr,{side:"top",children:m?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),p.jsxs(Ko,{className:"w-80 p-4 space-y-3",align:"start",children:[p.jsx(Jt,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),p.jsx(Ad,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:s,onChange:g=>i(g.target.value),rows:5,className:"text-sm"}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx(Ct,{variant:"outline",size:"sm",onClick:u,disabled:!s.trim(),children:"Clear Override"}),p.jsx(Ct,{size:"sm",onClick:c,children:"Set for Next Turn"})]})]})]})};class tIe{constructor(){Ne(this,"id","core-system-prompt");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"turnSystemPromptValue","");Ne(this,"effectiveSystemPrompt",null);Ne(this,"isStreaming",!1);Ne(this,"notifyComponentUpdate",null);Ne(this,"getTurnSystemPrompt",()=>this.turnSystemPromptValue);Ne(this,"getEffectiveSystemPrompt",()=>this.effectiveSystemPrompt);Ne(this,"getIsStreaming",()=>this.isStreaming);Ne(this,"setTurnSystemPrompt",t=>{var n;this.turnSystemPromptValue!==t&&(this.turnSystemPromptValue=t,(n=this.notifyComponentUpdate)==null||n.call(this))});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=Bn.getState().status==="streaming",this.updateEffectivePrompt();const n=t.on(On.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Xn.contextChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(fi.updated,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(Qt.globalSystemPromptChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r,s,i)}updateEffectivePrompt(){var a;const t=br.getState(),n=Oa.getState(),r=ir.getState(),s=t.selectedItemType==="project"?t.selectedItemId:t.selectedItemType==="conversation"?((a=t.getConversationById(t.selectedItemId))==null?void 0:a.projectId)??null:null,i=n.getEffectiveProjectSettings(s).systemPrompt??r.globalSystemPrompt;this.effectiveSystemPrompt!==i&&(this.effectiveSystemPrompt=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>dt.createElement(eIe,{module:this}),getMetadata:()=>{const n=this.turnSystemPromptValue.trim();return n?{turnSystemPrompt:n}:void 0},clearOnSubmit:()=>{var n;this.turnSystemPromptValue!==""&&(this.turnSystemPromptValue="",(n=this.notifyComponentUpdate)==null||n.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const nIe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getStructuredOutputJson(),[r,s]=T.useState(!1),[i,a]=T.useState(n??""),[o,l]=T.useState(""),[c,u]=T.useState([]),f=T.useCallback(()=>{try{JSON.parse(i),e.setStructuredOutputJson(i.trim()||null),s(!1),Le.success("Structured output applied for next turn.")}catch{Le.error("Invalid JSON format.")}},[i,e]),m=T.useCallback(()=>{a(""),e.setStructuredOutputJson(null),s(!1),Le.info("Structured output cleared.")},[e]),g=T.useCallback(()=>{if(!o.trim()){Le.error("Please provide a name to save to the library.");return}try{JSON.parse(i);const _={id:Date.now().toString(),name:o.trim(),json:i};u(E=>[...E,_]),l(""),Le.success(`"${_.name}" saved to library.`)}catch{Le.error("Cannot save invalid JSON to library.")}},[i,o]),v=T.useCallback(_=>{a(_.json),e.setStructuredOutputJson(_.json),s(!1),Le.success(`Loaded "${_.name}" from library.`)},[e]),b=T.useCallback(_=>{u(E=>E.filter(C=>C.id!==_)),Le.info("Item removed from library.")},[]);T.useEffect(()=>{r&&a(e.getStructuredOutputJson()??"")},[r,e]);const w=[{value:"entry",label:"Entry",content:p.jsxs("div",{className:"space-y-3 p-1",children:[p.jsx(Jt,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),p.jsx(Ad,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:i,onChange:_=>a(_.target.value),rows:8,className:"font-mono text-xs"}),p.jsxs("div",{className:"flex justify-between items-end gap-2",children:[p.jsxs("div",{className:"flex-grow space-y-1",children:[p.jsx(Jt,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),p.jsx(zn,{id:"structured-output-name",value:o,onChange:_=>l(_.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),p.jsxs(Ct,{size:"sm",variant:"outline",onClick:g,disabled:!o.trim()||!i.trim(),className:"h-8",children:[p.jsx(hd,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),p.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[p.jsx(Ct,{variant:"outline",size:"sm",onClick:m,disabled:!n,children:"Clear Applied Schema"}),p.jsx(Ct,{size:"sm",onClick:f,disabled:!i,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:p.jsx("div",{className:"space-y-2 p-1",children:c.length===0?p.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):c.map(_=>p.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[p.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:_.name}),p.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[p.jsx(Ct,{size:"sm",variant:"outline",onClick:()=>v(_),className:"h-7 px-2 text-xs",children:"Use"}),p.jsx(Ct,{size:"icon",variant:"ghost",onClick:()=>b(_.id),className:"h-7 w-7 text-destructive",children:p.jsx(Aa,{className:"h-3.5 w-3.5"})})]})]},_.id))})}],x=!!n;return p.jsxs(Ho,{open:r,onOpenChange:s,children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Go,{asChild:!0,children:p.jsx(Ct,{variant:x?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:p.jsx(sF,{className:"h-4 w-4"})})})}),p.jsx(cr,{side:"top",children:x?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),p.jsx(Ko,{className:"w-[450px] p-0",align:"start",children:p.jsx(Vc,{tabs:w,defaultValue:"entry"})})]})},rIe=({module:e})=>{const[,t]=T.useState({});return T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),e.getIsVisible()?p.jsx(nIe,{module:e}):null};class sIe{constructor(){Ne(this,"id","core-structured-output");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"structuredOutputJson",null);Ne(this,"isVisible",!0);Ne(this,"notifyComponentUpdate",null);Ne(this,"getStructuredOutputJson",()=>this.structuredOutputJson);Ne(this,"getIsVisible",()=>this.isVisible);Ne(this,"setStructuredOutputJson",t=>{var n,r;this.structuredOutputJson=t,(n=this.modApiRef)==null||n.emit(Tn.setStructuredOutputJsonRequest,{json:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.structuredOutputJson=Ml.getState().structuredOutputJson,this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(Hn.selectedModelChanged,()=>{var i;this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(Tn.parameterChanged,i=>{var a;if(typeof i=="object"&&i&&"params"in i){const o=i.params;"structuredOutputJson"in o&&this.structuredOutputJson!==(o.structuredOutputJson??null)&&(this.structuredOutputJson=o.structuredOutputJson??null,(a=this.notifyComponentUpdate)==null||a.call(this))}});this.eventUnsubscribers.push(n,r)}updateVisibility(){var i;const{getSelectedModel:t}=gr.getState(),n=t(),r=(i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters,s=Array.isArray(r)&&r.includes("structured_output");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>dt.createElement(rIe,{module:this}),getParameters:()=>{if(this.structuredOutputJson)try{return{structured_output:JSON.parse(this.structuredOutputJson)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Tn.setStructuredOutputJsonRequest,{json:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const iIe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.contextLength,r=e.getEstimatedInputTokens(),s=e.getTotalEstimatedTokens(),i=e.getContextPercentage(),a=e.historyTokens,o=e.selectedModelId,l=T.useMemo(()=>i>85?"text-red-600 dark:text-red-500":i>70?"text-orange-500 dark:text-orange-400":i>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[i]);if(!(o!==null&&n>0))return null;const u=`Context: ~${s.toLocaleString()} / ${n.toLocaleString()} tokens (${i}%) [History: ${a}, Input: ${r}]`;return p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:p.jsx(RY,{className:ct("h-3 w-3 fill-current",l)})})}),p.jsx(cr,{side:"top",children:u})]})})},pK=4,aIe=e=>{let t=0;return e.forEach(n=>{var r,s,i,a;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(a=(i=(s=n.prompt)==null?void 0:s.metadata)==null?void 0:i.attachedFiles)==null||a.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/pK)};class oIe{constructor(){Ne(this,"id","core-usage-display");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"currentInputText","");Ne(this,"historyTokens",0);Ne(this,"attachedFiles",[]);Ne(this,"selectedModelId",null);Ne(this,"contextLength",0);Ne(this,"notifyComponentUpdate",null);Ne(this,"getEstimatedInputTokens",()=>{const t=new TextEncoder().encode(this.currentInputText).length,n=this.attachedFiles.reduce((r,s)=>r+s.size,0);return Math.ceil((t+n)/pK)});Ne(this,"getTotalEstimatedTokens",()=>this.historyTokens+this.getEstimatedInputTokens());Ne(this,"getContextPercentage",()=>this.contextLength?Math.min(100,Math.round(this.getTotalEstimatedTokens()/this.contextLength*100)):0);Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.loadInitialState(),this.updateContextLength();const n=t.on(Tn.inputChanged,o=>{var l;typeof o=="object"&&o&&"value"in o&&(this.currentInputText=o.value,(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(eo.attachedFilesChanged,o=>{var l;typeof o=="object"&&o&&"files"in o&&(this.attachedFiles=o.files,(l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(Hn.selectedModelChanged,o=>{var l;typeof o=="object"&&o&&"modelId"in o&&(this.selectedModelId=o.modelId,this.updateContextLength(),(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(On.completed,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)}),a=t.on(Xn.contextChanged,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)});this.eventUnsubscribers.push(n,r,s,i,a),console.log(`[${this.id}] Initialized.`)}loadInitialState(){const t=Vu.getState(),n=gr.getState();this.attachedFiles=t.attachedFilesMetadata,this.selectedModelId=n.selectedModelId,this.updateHistoryTokens()}updateHistoryTokens(){const t=Bn.getState();if(t.currentConversationId){const n=t.interactions.filter(r=>r.status==="COMPLETED");this.historyTokens=aIe(n)}else this.historyTokens=0}updateContextLength(){var c;if(!this.selectedModelId){this.contextLength=0;return}const{dbProviderConfigs:t,dbApiKeys:n}=gr.getState(),{providerId:r,modelId:s}=jo(this.selectedModelId);if(!r||!s){this.contextLength=0;return}const i=t.find(u=>u.id===r);if(!i){this.contextLength=0;return}const a=n.find(u=>u.id===i.apiKeyId),o=o9(i,s,a==null?void 0:a.value),l=o==null?void 0:o.metadata;this.contextLength=((c=l==null?void 0:l.top_provider)==null?void 0:c.context_length)??(l==null?void 0:l.context_length)??0}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>dt.createElement(iIe,{module:this})}),console.log(`[${this.id}] Registered.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const lIe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getReasoningEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=T.useCallback(()=>{const o=i?null:!0;e.setReasoningEnabled(o)},[i,e]);return s?p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:p.jsx(dd,{className:ct("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),p.jsx(cr,{side:"top",children:i?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};class cIe{constructor(){Ne(this,"id","core-reasoning");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"reasoningEnabled",null);Ne(this,"isStreaming",!1);Ne(this,"isVisible",!0);Ne(this,"notifyComponentUpdate",null);Ne(this,"getReasoningEnabled",()=>this.reasoningEnabled);Ne(this,"getIsStreaming",()=>this.isStreaming);Ne(this,"getIsVisible",()=>this.isVisible);Ne(this,"setReasoningEnabled",t=>{var n,r;this.reasoningEnabled=t,(n=this.modApiRef)==null||n.emit(Tn.setReasoningEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.reasoningEnabled=Ml.getState().reasoningEnabled,this.isStreaming=Bn.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(On.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Hn.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Tn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"reasoningEnabled"in l&&this.reasoningEnabled!==l.reasoningEnabled&&(this.reasoningEnabled=l.reasoningEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var s,i;const{getSelectedModel:t}=gr.getState(),n=t(),r=((i=(s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters)==null?void 0:i.includes("reasoning"))??!1;this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>dt.createElement(lIe,{module:this}),getMetadata:()=>this.reasoningEnabled===!0?{reasoningEnabled:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Tn.setReasoningEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const uIe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getWebSearchEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=T.useCallback(()=>{const o=i?null:!0;e.setWebSearchEnabled(o)},[i,e]);return s?p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:p.jsx(ki,{className:ct("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),p.jsx(cr,{side:"top",children:i?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};class dIe{constructor(){Ne(this,"id","core-web-search");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"webSearchEnabled",null);Ne(this,"isStreaming",!1);Ne(this,"isVisible",!0);Ne(this,"notifyComponentUpdate",null);Ne(this,"getWebSearchEnabled",()=>this.webSearchEnabled);Ne(this,"getIsStreaming",()=>this.isStreaming);Ne(this,"getIsVisible",()=>this.isVisible);Ne(this,"setWebSearchEnabled",t=>{var n,r;this.webSearchEnabled=t,(n=this.modApiRef)==null||n.emit(Tn.setWebSearchEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.webSearchEnabled=Ml.getState().webSearchEnabled,this.isStreaming=Bn.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(On.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Hn.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Tn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"webSearchEnabled"in l&&this.webSearchEnabled!==l.webSearchEnabled&&(this.webSearchEnabled=l.webSearchEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var i;const{getSelectedModel:t}=gr.getState(),n=t(),r=((i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters)??[],s=r.includes("web_search")||r.includes("web_search_options");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>dt.createElement(uIe,{module:this}),getParameters:()=>this.webSearchEnabled===!0?{web_search:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Tn.setWebSearchEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const fIe=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r,allRules:s,allTags:i,getRulesForTag:a})=>{const[o,l]=T.useState(""),[c,u]=T.useState(""),f=T.useMemo(()=>{const _=o.toLowerCase();return _?i.filter(E=>{var C;return E.name.toLowerCase().includes(_)||((C=E.description)==null?void 0:C.toLowerCase().includes(_))}):i},[i,o]),m=T.useMemo(()=>{const _=c.toLowerCase();return _?s.filter(E=>E.name.toLowerCase().includes(_)||E.content.toLowerCase().includes(_)||E.type.toLowerCase().includes(_)):s},[s,c]),g=T.useCallback((_,E)=>{n(_,E)},[n]),v=T.useCallback((_,E)=>{r(_,E)},[r]),b=()=>p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"relative",children:[p.jsx(ki,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),p.jsx(zn,{type:"search",placeholder:"Filter tags...",value:o,onChange:_=>l(_.target.value),className:"pl-8 h-9"})]}),p.jsx(Hi,{className:"h-64 border rounded-md p-2 bg-background/50",children:f.length===0?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No tags defined.":"No tags match filter."}):p.jsx("div",{className:"space-y-1",children:f.map(_=>{const E=a(_.id);return p.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:p.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[p.jsx(Bc,{id:`tag-activate-${_.id}`,checked:e.has(_.id),onCheckedChange:C=>g(_.id,!!C),className:"mt-0.5"}),p.jsxs(Jt,{htmlFor:`tag-activate-${_.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[p.jsx("span",{className:"block font-medium",children:_.name}),_.description&&p.jsx("span",{className:"block text-xs text-muted-foreground",children:_.description}),E.length>0&&p.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",E.map(C=>C.name).join(", ")]})]})]})},_.id)})})})]}),w=()=>p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"relative",children:[p.jsx(ki,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),p.jsx(zn,{type:"search",placeholder:"Filter rules...",value:c,onChange:_=>u(_.target.value),className:"pl-8 h-9"})]}),p.jsx(Hi,{className:"h-64 border rounded-md p-2 bg-background/50",children:m.length===0?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:s.length===0?"No rules defined.":"No rules match filter."}):p.jsx("div",{className:"space-y-1",children:m.map(_=>p.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:p.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[p.jsx(Bc,{id:`rule-activate-${_.id}`,checked:t.has(_.id),onCheckedChange:E=>v(_.id,!!E),className:"mt-0.5"}),p.jsxs(Jt,{htmlFor:`rule-activate-${_.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[p.jsx("span",{className:"block font-medium",children:_.name}),p.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",_.type]}),p.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",_.content]})]})]})},_.id))})})]}),x=[{value:"tags",label:"Activate Tags",content:b()},{value:"rules",label:"Activate Rules",content:w()}];return p.jsx("div",{className:"p-0 h-[28rem] max-w-lg",children:p.jsx(Vc,{tabs:x,defaultValue:"tags"})})},hIe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=T.useState(!1),s=e.getActiveTagIds(),i=e.getActiveRuleIds(),a=e.getIsStreaming(),o=e.getHasRulesOrTags(),l=e.getAllRules(),c=e.getAllTags(),u=e.getRulesForTag,f=T.useCallback((w,x)=>{e.setActiveTagIds(_=>{const E=new Set(_);return x?E.add(w):E.delete(w),E})},[e]),m=T.useCallback((w,x)=>{e.setActiveRuleIds(_=>{const E=new Set(_);return x?E.add(w):E.delete(w),E})},[e]),g=()=>{o?r(w=>!w):e.handleTriggerClick()&&r(!1)},v=s.size>0||i.size>0,b=a;return p.jsxs(Ho,{open:n,onOpenChange:r,children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:o?p.jsx(Go,{asChild:!0,children:p.jsx(Ct,{variant:v?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Configure Rules & Tags for Next Turn",onClick:g,children:p.jsx(T4,{className:"h-4 w-4"})})}):p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Add Rules & Tags (Opens Settings)",onClick:g,children:p.jsx(T4,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"top",children:o?v?`Rules/Tags Active (${s.size} tags, ${i.size} rules)`:"Activate Rules/Tags (Next Turn)":"Add Rules/Tags (Opens Settings)"})]})}),o&&p.jsx(Ko,{className:"w-auto p-0",align:"start",children:p.jsx(fIe,{activeTagIds:s,activeRuleIds:i,onToggleTag:f,onToggleRule:m,allRules:l,allTags:c,getRulesForTag:u})})]})};function pIe({form:e,name:t,label:n,description:r,placeholder:s,disabled:i,wrapperClassName:a,className:o,rows:l,...c}){return p.jsx(e.Field,{name:t,children:u=>{const f=typeof u.state.value=="string"||typeof u.state.value=="number"?String(u.state.value):"";return p.jsxs("div",{className:ct("space-y-1.5",a),children:[p.jsx(Jt,{htmlFor:u.name,className:"text-sm",children:n}),r&&p.jsx("p",{className:"text-xs text-muted-foreground",children:r}),p.jsx(Ad,{id:u.name,name:u.name,value:f,onBlur:u.handleBlur,onChange:m=>u.handleChange(m.target.value),placeholder:s,disabled:i??u.form.state.isSubmitting,rows:l,className:ct(o,u.state.meta.errors.length?"border-destructive":""),...c}),p.jsx(js,{field:u})]})}})}const mIe=D.object({name:D.string().min(1,"Rule Name is required."),content:D.string().min(1,"Rule Content is required."),type:D.enum(["system","before","after"],{errorMap:()=>({message:"Rule Type is required."})})}),gIe=[{value:"system",label:"System Prompt"},{value:"before",label:"Before User Prompt"},{value:"after",label:"After User Prompt"}],yIe=({initialData:e,isSavingExt:t,onSave:n,onCancel:r})=>{const s=ri({defaultValues:{name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"},validators:{onChangeAsync:mIe,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{await n({name:i.name.trim(),content:i.content.trim(),type:i.type})}});return T.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"})},[e,s]),p.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[p.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsx(Py,{form:s,name:"name",label:"Rule Name",placeholder:"e.g., Always respond in JSON",required:!0,disabled:t,wrapperClassName:"md:col-span-2"}),p.jsx(x0,{form:s,name:"type",label:"Rule Type",options:gIe,placeholder:"Select Type",disabled:t})]}),p.jsx(pIe,{form:s,name:"content",label:"Rule Content",placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"}),p.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[p.jsxs(Ct,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[p.jsx(la,{className:"h-4 w-4 mr-1"})," Cancel"]}),p.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>p.jsxs(Ct,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||!l||o,children:[(t||a||o)&&p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}),p.jsx(hd,{className:"h-4 w-4 mr-1"})," ",t||a||o?"Saving...":"Save Rule"]})})]})]})},bIe=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:s})=>{const i=a=>{window.confirm(`Are you sure you want to delete the rule "${a.name}"? This will also remove it from any tags.`)&&s(a.id,a.name)};return p.jsx("div",{className:"border rounded-md overflow-hidden",children:p.jsxs(Qf,{children:[p.jsx(Om,{children:p.jsxs(ts,{children:[p.jsx(Lr,{children:"Name"}),p.jsx(Lr,{children:"Type"}),p.jsx(Lr,{children:"Content Preview"}),p.jsx(Lr,{className:"text-right",children:"Actions"})]})}),p.jsx(eh,{children:t?p.jsxs(p.Fragment,{children:[p.jsx(ts,{children:p.jsx(Ln,{colSpan:4,children:p.jsx(dr,{className:"h-10 w-full"})})}),p.jsx(ts,{children:p.jsx(Ln,{colSpan:4,children:p.jsx(dr,{className:"h-10 w-full"})})})]}):e.length===0?p.jsx(ts,{children:p.jsx(Ln,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(a=>{const o=n[a.id];return p.jsxs(ts,{children:[p.jsx(Ln,{className:"font-medium",children:a.name}),p.jsx(Ln,{className:"capitalize",children:a.type}),p.jsx(Ln,{className:"text-xs text-muted-foreground truncate max-w-xs",children:a.content}),p.jsxs(Ln,{className:"text-right space-x-1",children:[p.jsx(gn,{tooltipText:"Edit Rule",onClick:()=>r(a),disabled:o,icon:p.jsx(Vy,{}),className:"h-8 w-8","aria-label":`Edit rule ${a.name}`}),p.jsx(gn,{tooltipText:"Delete Rule",onClick:()=>i(a),disabled:o,icon:o?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Aa,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${a.name}`})]})]},a.id)})})]})})},vIe=({module:e})=>{const[,t]=T.useState(Date.now()),n=e.getAllRules(),r=e.getIsLoadingRules(),[s,i]=T.useState(!1),[a,o]=T.useState(null),[l,c]=T.useState(!1),[u,f]=T.useState({});T.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const m=()=>{o(null),i(!0)},g=x=>{o(x),i(!0)},v=T.useCallback(()=>{i(!1),o(null),c(!1)},[]),b=T.useCallback(async x=>{c(!0);try{a?e.updateRule(a.id,x):e.addRule(x),v()}catch{}finally{c(!1)}},[e,a,v]),w=T.useCallback(async x=>{f(_=>({..._,[x]:!0}));try{e.deleteRule(x),(a==null?void 0:a.id)===x&&v()}catch{}finally{f(_=>({..._,[x]:!1}))}},[e,a,v]);return p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),p.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!s&&p.jsxs(Ct,{onClick:m,variant:"outline",className:"w-full",disabled:r,children:[p.jsx(sm,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),s&&p.jsx(yIe,{initialData:a??void 0,isSavingExt:l,onSave:b,onCancel:v}),p.jsxs("div",{className:"pt-4",children:[p.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),p.jsx(bIe,{rules:n,isLoading:r,isDeleting:u,onEdit:g,onDelete:w})]})]})},fT=D.object({name:D.string().min(1,"Tag Name is required."),description:D.string().nullable()}),wIe=({initialData:e,isParentSaving:t=!1,onSave:n,onCancel:r})=>{const s=ri({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null},validators:{onChangeAsync:fT,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{var a;await n({name:i.name.trim(),description:((a=i.description)==null?void 0:a.trim())||null})}});return T.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null})},[e,s]),p.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[p.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),p.jsx(s.Field,{name:"name",validators:{onChange:fT.shape.name},children:i=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:i.name,children:"Tag Name"}),p.jsx(zn,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"e.g., Code Generation, Summarization",disabled:s.state.isSubmitting||t}),p.jsx(js,{field:i})]})}),p.jsx(s.Field,{name:"description",validators:{onChange:fT.shape.description},children:i=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:i.name,children:"Description (Optional)"}),p.jsx(Ad,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"Describe when to use this tag...",rows:2,disabled:s.state.isSubmitting||t}),p.jsx(js,{field:i})]})}),p.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[p.jsxs(Ct,{variant:"ghost",size:"sm",onClick:r,disabled:s.state.isSubmitting||t,type:"button",children:[p.jsx(la,{className:"h-4 w-4 mr-1"})," Cancel"]}),p.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>p.jsxs(Ct,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||o||!l,children:[(a||o)&&p.jsx(Pn,{className:"h-4 w-4 mr-1 animate-spin"}),p.jsx(hd,{className:"h-4 w-4 mr-1"})," ",a||o?"Saving...":"Save Tag"]})})]})]})},xIe=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:s,onDelete:i})=>{const a=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&i(o.id,o.name)};return p.jsx("div",{className:"border rounded-md overflow-hidden",children:p.jsxs(Qf,{children:[p.jsx(Om,{children:p.jsxs(ts,{children:[p.jsx(Lr,{children:"Name"}),p.jsx(Lr,{children:"Description"}),p.jsx(Lr,{children:"Linked Rules"}),p.jsx(Lr,{className:"text-right",children:"Actions"})]})}),p.jsx(eh,{children:n?p.jsxs(p.Fragment,{children:[p.jsx(ts,{children:p.jsx(Ln,{colSpan:4,children:p.jsx(dr,{className:"h-10 w-full"})})}),p.jsx(ts,{children:p.jsx(Ln,{colSpan:4,children:p.jsx(dr,{className:"h-10 w-full"})})})]}):e.length===0?p.jsx(ts,{children:p.jsx(Ln,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],c=t.get(o.id)||[];return p.jsxs(ts,{children:[p.jsx(Ln,{className:"font-medium",children:o.name}),p.jsx(Ln,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),p.jsx(Ln,{className:"text-xs",children:c.length>0?c.map(u=>u.name).join(", "):"None"}),p.jsxs(Ln,{className:"text-right space-x-1",children:[p.jsx(gn,{tooltipText:"Edit Tag & Rules",onClick:()=>s(o),disabled:l,icon:p.jsx(Vy,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),p.jsx(gn,{tooltipText:"Delete Tag",onClick:()=>a(o),disabled:l,icon:l?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Aa,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})},_Ie=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:s=!1})=>{const[i,a]=T.useState(!1),[o,l]=T.useState(""),c=T.useMemo(()=>[...t].sort((v,b)=>v.name.localeCompare(b.name)),[t]),u=T.useMemo(()=>{const v=o.toLowerCase();return v?c.filter(b=>b.name.toLowerCase().includes(v)||b.content.toLowerCase().includes(v)||b.type.toLowerCase().includes(v)):c},[c,o]),f=T.useCallback(v=>{const b=n.has(v);r(e.id,v,!b),l("")},[n,r,e.id]),m=T.useCallback((v,b)=>{b.stopPropagation(),r(e.id,v,!1)},[r,e.id]),g=T.useMemo(()=>c.filter(v=>n.has(v.id)),[c,n]);return p.jsxs("div",{className:"space-y-3",children:[p.jsxs(Jt,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),p.jsxs(Ho,{open:i,onOpenChange:a,children:[p.jsx(Go,{asChild:!0,children:p.jsxs(Ct,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between h-9",disabled:s||t.length===0,children:[p.jsx("span",{className:"truncate",children:g.length>0?`${g.length} rule(s) selected`:"Select rules..."}),p.jsx(M1,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),p.jsx(Ko,{className:"w-[--radix-popover-trigger-width] p-0",children:p.jsxs(oK,{shouldFilter:!1,children:[p.jsx(lK,{placeholder:"Search rules...",value:o,onValueChange:l}),p.jsxs(cK,{children:[p.jsx(uK,{children:t.length===0?"No rules defined.":"No rules found."}),p.jsx(dK,{children:u.map(v=>{const b=n.has(v.id);return p.jsxs(fK,{value:v.id,onSelect:()=>f(v.id),className:"cursor-pointer",children:[p.jsx(Ui,{className:ct("mr-2 h-4 w-4",b?"opacity-100":"opacity-0")}),p.jsx("span",{className:"truncate",children:v.name}),p.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",v.type,")"]})]},v.id)})})]})]})})]}),g.length>0&&p.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:g.map(v=>p.jsxs(Ap,{variant:"secondary",className:"flex items-center gap-1",children:[p.jsx("span",{className:"truncate",children:v.name}),p.jsx(Ct,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:b=>m(v.id,b),disabled:s,"aria-label":`Unlink rule ${v.name}`,children:p.jsx(la,{className:"h-3 w-3"})})]},v.id))})]})};var SIe="Separator",y8="horizontal",EIe=["horizontal","vertical"],mK=T.forwardRef((e,t)=>{const{decorative:n,orientation:r=y8,...s}=e,i=CIe(r)?r:y8,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return p.jsx(sn.div,{"data-orientation":i,...o,...s,ref:t})});mK.displayName=SIe;function CIe(e){return EIe.includes(e)}var kIe=mK;function Lf({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return p.jsx(kIe,{"data-slot":"separator-root",decorative:n,orientation:t,className:ct("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const TIe=({module:e})=>{const[,t]=T.useState(Date.now()),n=e.getAllTags(),r=e.getAllRules(),s=e.getTagRuleLinks(),i=e.getRulesForTag,a=e.getIsLoadingRules(),[o,l]=T.useState(!1),[c,u]=T.useState(null),[f,m]=T.useState(!1),[g,v]=T.useState({});T.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const b=()=>{u(null),l(!0)},w=I=>{u(I),l(!0)},x=T.useCallback(()=>{l(!1),u(null),m(!1)},[]),_=T.useCallback(async I=>{m(!0);try{c?e.updateTag(c.id,I):e.addTag(I),c||x()}catch{}finally{m(!1)}},[e,c,x]),E=T.useCallback(async I=>{v(j=>({...j,[I]:!0}));try{e.deleteTag(I),(c==null?void 0:c.id)===I&&x()}catch{}finally{v(j=>({...j,[I]:!1}))}},[e,c,x]),C=T.useCallback(async(I,j,M)=>{try{M?e.linkTagToRule(I,j):e.unlinkTagFromRule(I,j)}catch{}},[e]),k=T.useMemo(()=>{const I=new Map;return n.forEach(j=>{I.set(j.id,i(j.id))}),I},[n,i]),R=T.useMemo(()=>c?new Set(s.filter(I=>I.tagId===c.id).map(I=>I.ruleId)):new Set,[c,s]);return p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),p.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!o&&p.jsxs(Ct,{onClick:b,variant:"outline",className:"w-full",disabled:a,children:[p.jsx(sm,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),o&&p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsx(wIe,{initialData:c??void 0,isParentSaving:f,onSave:_,onCancel:x}),c&&p.jsx(_Ie,{tag:c,allRules:r,linkedRuleIds:R,onLinkChange:C,disabled:f})]}),p.jsx(Lf,{}),p.jsxs("div",{className:"pt-4",children:[p.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),p.jsx(xIe,{tags:n,rulesByTagId:k,isLoading:a,isDeleting:g,onEdit:w,onDelete:E})]})]})},AIe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifySettingsCallback(()=>t({})),()=>e.setNotifySettingsCallback(null)),[e]);const n=T.useMemo(()=>[{value:"rules",label:"Rules",content:p.jsx(vIe,{module:e})},{value:"tags",label:"Tags",content:p.jsx(TIe,{module:e})}],[e]);return p.jsx(Vc,{tabs:n,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})};class RIe{constructor(){Ne(this,"id","core-rules-tags");Ne(this,"unregisterPromptControlCallback",null);Ne(this,"unregisterSettingsTabCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"modApiRef",null);Ne(this,"allRules",[]);Ne(this,"allTags",[]);Ne(this,"tagRuleLinks",[]);Ne(this,"transientActiveTagIds",new Set);Ne(this,"transientActiveRuleIds",new Set);Ne(this,"isStreaming",!1);Ne(this,"hasRulesOrTags",!1);Ne(this,"isLoadingRules",!0);Ne(this,"notifyComponentUpdate",null);Ne(this,"notifySettingsComponentUpdate",null);Ne(this,"getAllRules",()=>this.allRules);Ne(this,"getAllTags",()=>this.allTags);Ne(this,"getTagRuleLinks",()=>this.tagRuleLinks);Ne(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});Ne(this,"getRuleById",t=>this.allRules.find(n=>n.id===t));Ne(this,"getTagById",t=>this.allTags.find(n=>n.id===t));Ne(this,"getRulesByIds",t=>{const n=new Set(t);return this.allRules.filter(r=>n.has(r.id))});Ne(this,"addRule",t=>{var n;(n=this.modApiRef)==null||n.emit(Fn.addRuleRequest,t)});Ne(this,"updateRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Fn.updateRuleRequest,{id:t,updates:n})});Ne(this,"deleteRule",t=>{var n;(n=this.modApiRef)==null||n.emit(Fn.deleteRuleRequest,{id:t})});Ne(this,"addTag",t=>{var n;(n=this.modApiRef)==null||n.emit(Fn.addTagRequest,t)});Ne(this,"updateTag",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Fn.updateTagRequest,{id:t,updates:n})});Ne(this,"deleteTag",t=>{var n;(n=this.modApiRef)==null||n.emit(Fn.deleteTagRequest,{id:t})});Ne(this,"linkTagToRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Fn.linkTagToRuleRequest,{tagId:t,ruleId:n})});Ne(this,"unlinkTagFromRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Fn.unlinkTagFromRuleRequest,{tagId:t,ruleId:n})});Ne(this,"handleTriggerClick",()=>!this.hasRulesOrTags&&this.modApiRef?(this.modApiRef.emit(Xn.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"}),!0):!1);Ne(this,"getIsStreaming",()=>this.isStreaming);Ne(this,"getHasRulesOrTags",()=>this.hasRulesOrTags);Ne(this,"getIsLoadingRules",()=>this.isLoadingRules);Ne(this,"getActiveTagIds",()=>this.transientActiveTagIds);Ne(this,"getActiveRuleIds",()=>this.transientActiveRuleIds);Ne(this,"setActiveTagIds",t=>{var n;this.transientActiveTagIds=t(this.transientActiveTagIds),(n=this.notifyComponentUpdate)==null||n.call(this)});Ne(this,"setActiveRuleIds",t=>{var n;this.transientActiveRuleIds=t(this.transientActiveRuleIds),(n=this.notifyComponentUpdate)==null||n.call(this)});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});Ne(this,"setNotifySettingsCallback",t=>{this.notifySettingsComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=t.getContextSnapshot().isStreaming,t.emit(Fn.loadRulesAndTagsRequest,void 0);const n=t.on(On.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))}),r=t.on(Fn.dataLoaded,s=>{var i,a;s&&(this.allRules=s.rules||[],this.allTags=s.tags||[],this.tagRuleLinks=(s.links||[]).map(o=>({tagId:o.tagId,ruleId:o.ruleId}))),this.updateHasRulesOrTags(),this.isLoadingRules=!1,(i=this.notifyComponentUpdate)==null||i.call(this),(a=this.notifySettingsComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r)}updateHasRulesOrTags(){const t=this.allRules.length>0||this.allTags.length>0;this.hasRulesOrTags!==t&&(this.hasRulesOrTags=t)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingRules?"loading":"ready",triggerRenderer:()=>dt.createElement(hIe,{module:this}),getMetadata:()=>{const n=Array.from(this.transientActiveTagIds),r=Array.from(this.transientActiveRuleIds),s=[],i=new Set(r);if(n.forEach(a=>{this.getRulesForTag(a).forEach(o=>i.add(o.id))}),i.forEach(a=>{const o=this.getRuleById(a);o&&s.push({type:o.type,content:o.content,sourceRuleId:o.id})}),n.length>0||r.length>0||s.length>0)return{activeTagIds:n,activeRuleIds:r,effectiveRulesContent:s}},clearOnSubmit:()=>{var r;let n=!1;this.transientActiveTagIds.size>0&&(this.transientActiveTagIds=new Set,n=!0),this.transientActiveRuleIds.size>0&&(this.transientActiveRuleIds=new Set,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"rules-tags",title:"Rules & Tags",component:()=>dt.createElement(AIe,{module:this}),order:50}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.notifySettingsComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const NIe=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getTurnEnabled(),r=e.getIsStreaming(),s=e.getGlobalAutoTitleEnabled()&&e.getIsFirstInteraction(),i=T.useCallback(()=>{const a=!n;e.setTurnEnabled(a)},[n,e]);return s?p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx(Ct,{variant:n?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:i,disabled:r,"aria-label":n?"Disable Auto-Title for this Chat":"Enable Auto-Title for this Chat",children:p.jsx(uF,{className:ct("h-4 w-4",n?"text-primary":"text-muted-foreground")})})}),p.jsx(cr,{side:"top",children:n?"Auto-Title Enabled (Click to Disable)":"Auto-Title Disabled (Click to Enable)"})]})}):null};class IIe{constructor(){Ne(this,"id","core-auto-title");Ne(this,"unregisterCallback",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"turnAutoTitleEnabled",!1);Ne(this,"isStreaming",!1);Ne(this,"isFirstInteraction",!1);Ne(this,"globalAutoTitleEnabled",!0);Ne(this,"notifyComponentUpdate",null);Ne(this,"getTurnEnabled",()=>this.turnAutoTitleEnabled);Ne(this,"getIsStreaming",()=>this.isStreaming);Ne(this,"getIsFirstInteraction",()=>this.isFirstInteraction);Ne(this,"getGlobalAutoTitleEnabled",()=>this.globalAutoTitleEnabled);Ne(this,"setTurnEnabled",t=>{var n;this.turnAutoTitleEnabled!==t&&(this.turnAutoTitleEnabled=t,(n=this.notifyComponentUpdate)==null||n.call(this))});Ne(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var a;this.turnAutoTitleEnabled=!1,this.isStreaming=Bn.getState().status==="streaming",this.globalAutoTitleEnabled=ir.getState().autoTitleEnabled,this.checkFirstInteraction(),(a=this.notifyComponentUpdate)==null||a.call(this);const n=t.on(On.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&this.isStreaming!==(o.status==="streaming")&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Xn.contextChanged,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(On.completed,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(Qt.autoTitleEnabledChanged,o=>{var l;typeof o=="object"&&o&&"enabled"in o&&this.globalAutoTitleEnabled!==o.enabled&&(this.globalAutoTitleEnabled=o.enabled,(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,s,i)}checkFirstInteraction(){const t=Bn.getState(),n=t.currentConversationId===null||t.interactions.filter(r=>r.conversationId===t.currentConversationId).length===0;this.isFirstInteraction!==n&&(this.isFirstInteraction=n,!n&&this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>dt.createElement(NIe,{module:this});this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:n,getMetadata:()=>this.turnAutoTitleEnabled?{autoTitleEnabledForTurn:!0}:void 0,clearOnSubmit:()=>{var r;this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1,(r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}function jIe(){const e=new URLSearchParams(window.location.search),t=e.get("q")??void 0,n=e.get("m")??void 0,r=e.getAll("vfs").filter(Boolean),s=e.get("s")??"1";return{query:t,modelId:n,vfsFiles:r.length>0?r:void 0,submit:s}}class MIe{constructor(){Ne(this,"id","core-url-parameters");Ne(this,"modApiRef",null)}async initialize(t){this.modApiRef=t,console.log(`[${this.id}] Initializing...`),t.on(Rd.initializationPhaseCompleted,n=>{n.phase==="all"&&this.processUrlParameters().catch(r=>{console.error(`[${this.id}] Error processing URL parameters:`,r),Le.error("Failed to process URL parameters.")})}),console.log(`[${this.id}] Initialized, awaiting full app load.`)}register(t){}destroy(){this.modApiRef=null}async processUrlParameters(){var r,s;if(!this.modApiRef){console.warn(`[${this.id}] ModAPI not available, cannot process URL parameters.`);return}const t=this.modApiRef,n=jIe();if(!(!n.query&&!n.modelId&&!((r=n.vfsFiles)!=null&&r.length))){Le.info("Processing parameters from URL...");try{const i=await new Promise((a,o)=>{const l=t.on(Mn.conversationAdded,c=>{c.conversation.title.startsWith("From URL:")&&(l(),a(c.conversation.id))});setTimeout(()=>{l(),o(new Error("Timeout waiting for conversation creation event."))},5e3),t.emit(Mn.addConversationRequest,{title:n.query?`From URL: ${n.query.substring(0,30)}...`:"From URL Parameters"})});if(t.emit(Mn.selectItemRequest,{id:i,type:"conversation"}),n.modelId){const a=gr.getState().getAvailableModelListItems();let o=null;const l=n.modelId.toLowerCase();if(n.modelId.includes(":")){const c=a.find(u=>u.id===n.modelId);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase()===l);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase().startsWith(l));c&&(o=c.id)}if(!o){const c=a.find(u=>{const f=u.id.toLowerCase().split("/");return f.length>1&&f[1].startsWith(l)});c&&(o=c.id)}if(o){t.emit(Tn.setModelIdRequest,{id:o}),t.emit(Hn.selectModelRequest,{modelId:o});const c=a.find(u=>u.id===o);Le.success(`Model set to: ${c==null?void 0:c.name} (${c==null?void 0:c.providerName})`)}else Le.warning(`Model matching "${n.modelId}" not found or not enabled. Using default.`)}if(n.vfsFiles&&n.vfsFiles.length>0){const a="orphan";let o;try{if(o=await t.getVfsInstance(a),!o)throw new Error("Failed to get VFS instance via ModAPI.")}catch(l){Le.error(`Failed to initialize VFS for URL files: ${l instanceof Error?l.message:String(l)}`)}if(o)for(const l of n.vfsFiles)try{const c=await Sd(l,{fsInstance:o}),u=await o.promises.stat(l),f=ws(l),m="application/octet-stream",g=I0(f,m);let v={};if(g)v.contentText=new TextDecoder().decode(c);else{let b="";const w=c.byteLength;for(let x=0;x<w;x++)b+=String.fromCharCode(c[x]);v.contentBase64=window.btoa(b)}t.emit(eo.addAttachedFileRequest,{source:"vfs",name:f,type:m,size:u.size,path:l,...v}),Le.success(`Attached VFS file: ${f}`)}catch(c){c.code==="ENOENT"?Le.warning(`VFS file not found: ${l}`):Le.warning(`Failed to attach VFS file "${l}": ${c.message}`),console.error(`Error processing VFS file ${l}:`,c)}}if(n.query)if(n.submit==="0")t.emit(Tn.inputChanged,{value:n.query}),Le.info("Query from URL loaded into input area."),window.history.replaceState({},document.title,window.location.pathname);else{let a={},o={};const l=Vu.getState().attachedFilesMetadata;l.length>0&&(o.attachedFiles=[...l]);let c={id:pi(),content:n.query,parameters:a,metadata:o};t.emit(Tn.submitted,{turnData:c});const u=await Dx(H0.PROMPT_TURN_FINALIZE,{turnData:c});if(u===!1){Le.warning("Prompt submission from URL cancelled by middleware.");return}const f=u&&typeof u=="object"?u.turnData:c;await XN.submitPrompt(f),window.history.replaceState({},document.title,window.location.pathname)}else(n.modelId||(s=n.vfsFiles)!=null&&s.length)&&(Le.info("Model and/or VFS files from URL applied. Type your message."),window.history.replaceState({},document.title,window.location.pathname))}catch(i){Le.error(`Failed to process URL parameters: ${i instanceof Error?i.message:String(i)}`),console.error("Error processing URL parameters:",i)}}}}const OIe=D.object({enableStreamingMarkdown:D.boolean(),enableStreamingCodeBlockParsing:D.boolean(),foldStreamingCodeBlocks:D.boolean(),foldUserMessagesOnCompletion:D.boolean(),enableAutoScrollOnStream:D.boolean(),streamingRenderFPS:D.number().min(3,"Min 3 FPS").max(60,"Max 60 FPS"),autoScrollInterval:D.number().min(50,"Min 50ms").max(5e3,"Max 5000ms")}),PIe=()=>{const e=ir(mn(s=>({setEnableStreamingMarkdown:s.setEnableStreamingMarkdown,setEnableStreamingCodeBlockParsing:s.setEnableStreamingCodeBlockParsing,setFoldStreamingCodeBlocks:s.setFoldStreamingCodeBlocks,setFoldUserMessagesOnCompletion:s.setFoldUserMessagesOnCompletion,setStreamingRenderFPS:s.setStreamingRenderFPS,setAutoScrollInterval:s.setAutoScrollInterval,setEnableAutoScrollOnStream:s.setEnableAutoScrollOnStream,resetGeneralSettings:s.resetGeneralSettings}))),t=ir(mn(s=>({enableStreamingMarkdown:s.enableStreamingMarkdown,enableStreamingCodeBlockParsing:s.enableStreamingCodeBlockParsing,foldStreamingCodeBlocks:s.foldStreamingCodeBlocks,foldUserMessagesOnCompletion:s.foldUserMessagesOnCompletion,streamingRenderFPS:s.streamingRenderFPS,autoScrollInterval:s.autoScrollInterval,enableAutoScrollOnStream:s.enableAutoScrollOnStream}))),n=ri({defaultValues:{enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!1,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3},validators:{onChangeAsync:OIe,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{e.setEnableStreamingMarkdown(s.enableStreamingMarkdown),e.setEnableStreamingCodeBlockParsing(s.enableStreamingCodeBlockParsing),e.setFoldStreamingCodeBlocks(s.foldStreamingCodeBlocks),e.setFoldUserMessagesOnCompletion(s.foldUserMessagesOnCompletion),e.setEnableAutoScrollOnStream(s.enableAutoScrollOnStream),e.setStreamingRenderFPS(s.streamingRenderFPS),e.setAutoScrollInterval(s.autoScrollInterval)}});T.useEffect(()=>{n.reset({enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!1,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3})},[t.enableStreamingMarkdown,t.enableStreamingCodeBlockParsing,t.foldStreamingCodeBlocks,t.foldUserMessagesOnCompletion,t.enableAutoScrollOnStream,t.streamingRenderFPS,t.autoScrollInterval,n]);const r=()=>{window.confirm("Are you sure you want to reset Streaming & Display settings to their defaults?")&&e.resetGeneralSettings()};return p.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"p-1 space-y-6",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),p.jsx(ff,{form:n,name:"enableStreamingMarkdown",label:"Parse Markdown While Streaming",description:"Render Markdown formatting as the response arrives (may impact performance slightly)."}),p.jsx(ff,{form:n,name:"enableStreamingCodeBlockParsing",label:"Use Full Code Blocks While Streaming",description:"Use the syntax-highlighting component for code blocks during streaming."}),p.jsx(ff,{form:n,name:"foldStreamingCodeBlocks",label:"Fold Code Blocks by Default During Streaming",description:"Automatically collapse code blocks as they stream in. Useful for long code outputs."}),p.jsx(ff,{form:n,name:"foldUserMessagesOnCompletion",label:"Fold User Messages After Response",description:"Automatically collapse the user's prompt message once the assistant finishes responding."}),p.jsx(ff,{form:n,name:"enableAutoScrollOnStream",label:"Auto-Scroll While Streaming",description:"Automatically scroll to the bottom as new content arrives."}),p.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[p.jsx(Ro,{form:n,name:"streamingRenderFPS",label:"Streaming Update Rate",min:3,max:60,step:1,valueLabelSuffix:" FPS"}),p.jsx(tm,{form:n,name:"streamingRenderFPS",label:"FPS Input",min:3,max:60,step:1,className:"w-24 h-8 text-xs ml-auto","aria-label":"Streaming Render FPS Value"}),p.jsx("p",{className:ct("text-sm text-muted-foreground"),children:"Controls how frequently the UI updates during streaming (3-60 FPS)."})]}),p.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[p.jsx(Ro,{form:n,name:"autoScrollInterval",label:"Auto-Scroll Interval",min:50,max:5e3,step:50,valueLabelSuffix:" ms",disabled:!n.state.values.enableAutoScrollOnStream}),p.jsx(tm,{form:n,name:"autoScrollInterval",label:"Interval Input (ms)",min:50,max:5e3,step:50,className:"w-24 h-8 text-xs ml-auto",disabled:!n.state.values.enableAutoScrollOnStream,"aria-label":"Auto Scroll Interval Value"}),p.jsx("p",{className:ct("text-sm text-muted-foreground"),children:"How often to scroll to the bottom during streaming (50-5000 ms)."})]})]}),p.jsx(Lf,{}),p.jsx("div",{className:"flex items-center justify-between pt-4",children:p.jsx(n.Subscribe,{children:s=>{const i=s.canSubmit,a=s.isSubmitting,o=s.isValidating,l=s.isValid;return p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx(Ct,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Changes"}),p.jsxs(Ct,{variant:"outline",size:"sm",onClick:r,type:"button",children:[p.jsx(yR,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})]})}})})]})},DIe=dt.memo(PIe);class FIe{constructor(){Ne(this,"id","core-settings-general");Ne(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"general",title:"General",component:DIe,order:10})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const LIe=({label:e,colorKey:t,value:n,onChange:r})=>{const[s,i]=T.useState(n??"");T.useEffect(()=>{i(n??"")},[n]);const a=()=>{r(t,s.trim()||null)},o=l=>{i(l.target.value)};return p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Jt,{htmlFor:`color-${t}`,className:"text-xs w-28 shrink-0",children:e}),p.jsx(zn,{id:`color-${t}`,type:"text",value:s,onChange:o,onBlur:a,className:"h-8 text-xs flex-grow",placeholder:"e.g., #ffffff or oklch(0.5 0.2 180)"}),p.jsx(zn,{type:"color",value:s!=null&&s.startsWith("#")?s:"#000000",onChange:l=>{i(l.target.value),r(t,l.target.value)},className:"h-8 w-10 p-1 border-none cursor-pointer bg-transparent","aria-label":`Pick ${e} color`})]})},BIe=[{label:"Default Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css"},{label:"A11y Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css"},{label:"Atom Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css"},{label:"Atelier Sulphurpool Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-base16-ateliersulphurpool.light.min.css"},{label:"CB",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-cb.min.css"},{label:"Coldark Cold",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-cold.min.css"},{label:"Coldark Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-dark.min.css"},{label:"Coy (No Shadow)",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coy-without-shadows.min.css"},{label:"Darcula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-darcula.min.css"},{label:"Dracula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"},{label:"Duotone Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-dark.min.css"},{label:"Duotone Earth",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-earth.min.css"},{label:"Duotone Forest",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-forest.min.css"},{label:"Duotone Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-light.min.css"},{label:"Duotone Sea",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-sea.min.css"},{label:"Duotone Space",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-space.min.css"},{label:"GH Colors",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css"},{label:"Gruvbox Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-dark.min.css"},{label:"Gruvbox Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-light.min.css"},{label:"Holi",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-holi-theme.min.css"},{label:"Hopscotch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-hopscotch.min.css"},{label:"Lucario",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css"},{label:"Material Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css"},{label:"Material Oceanic",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-oceanic.min.css"},{label:"Night Owl",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-night-owl.min.css"},{label:"Nord",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-nord.min.css"},{label:"One Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-dark.min.css"},{label:"One Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-light.min.css"},{label:"Pojoaque",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-pojoaque.min.css"},{label:"Shades of Purple",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-shades-of-purple.min.css"},{label:"Solarized Dark Atom",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-solarized-dark-atom.min.css"},{label:"Synthwave '84",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-synthwave84.min.css"},{label:"VS",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css"},{label:"VSC Dark Plus",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css"},{label:"Xonokai",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"},{label:"Z-Touch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-z-touch.min.css"}],$Ie=D.enum(["system","light","dark","TijuLight","TijuDark","custom"]),zIe=D.object({theme:$Ie,prismThemeUrl:D.string(),customFontFamily:D.string(),customFontSize:D.number().min(12).max(20),chatMaxWidth:D.string(),customThemeColors:D.record(D.string(),D.string().nullable())}),UIe=()=>{const e=ir(mn(a=>({setTheme:a.setTheme,setPrismThemeUrl:a.setPrismThemeUrl,setCustomFontFamily:a.setCustomFontFamily,setCustomFontSize:a.setCustomFontSize,setChatMaxWidth:a.setChatMaxWidth,setCustomThemeColor:a.setCustomThemeColor,resetThemeSettings:a.resetThemeSettings}))),t=ir(mn(a=>({theme:a.theme,prismThemeUrl:a.prismThemeUrl,customFontFamily:a.customFontFamily,customFontSize:a.customFontSize,chatMaxWidth:a.chatMaxWidth,_rawCustomThemeColors:a.customThemeColors}))),n=ri({defaultValues:{theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}},onSubmit:async({value:a})=>{e.setTheme(a.theme),e.setPrismThemeUrl(a.prismThemeUrl||null),e.setCustomFontFamily(a.customFontFamily),e.setCustomFontSize(a.customFontSize),e.setChatMaxWidth(a.chatMaxWidth),a.customThemeColors&&Object.entries(a.customThemeColors).forEach(([o,l])=>{e.setCustomThemeColor(o,l)})},validators:{onChangeAsync:zIe,onChangeAsyncDebounceMs:300}});T.useEffect(()=>{n.reset({theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}})},[t.theme,t.prismThemeUrl,t.customFontFamily,t.customFontSize,t.chatMaxWidth,t._rawCustomThemeColors]);const r=()=>{window.confirm("Are you sure you want to reset all Theme settings to their defaults?")&&e.resetThemeSettings()},s=[{value:"max-w-3xl",label:"Very Small"},{value:"max-w-4xl",label:"Small"},{value:"max-w-5xl",label:"Medium"},{value:"max-w-6xl",label:"Large"},{value:"max-w-7xl",label:"Very Large"},{value:"max-w-full",label:"Full Width"}],i=[{key:"background",label:"Background"},{key:"foreground",label:"Foreground"},{key:"card",label:"Card BG"},{key:"cardForeground",label:"Card FG"},{key:"popover",label:"Popover BG"},{key:"popoverForeground",label:"Popover FG"},{key:"primary",label:"Primary"},{key:"primaryForeground",label:"Primary FG"},{key:"secondary",label:"Secondary"},{key:"secondaryForeground",label:"Secondary FG"},{key:"muted",label:"Muted BG"},{key:"mutedForeground",label:"Muted FG"},{key:"accent",label:"Accent"},{key:"accentForeground",label:"Accent FG"},{key:"destructive",label:"Destructive"},{key:"destructiveForeground",label:"Destructive FG"},{key:"border",label:"Border"},{key:"input",label:"Input BG"},{key:"ring",label:"Ring (Focus)"},{key:"sidebar",label:"Sidebar BG"},{key:"sidebarForeground",label:"Sidebar FG"},{key:"sidebarPrimary",label:"Sidebar Primary"},{key:"sidebarPrimaryForeground",label:"Sidebar Primary FG"},{key:"sidebarAccent",label:"Sidebar Accent"},{key:"sidebarAccentForeground",label:"Sidebar Accent FG"},{key:"sidebarBorder",label:"Sidebar Border"},{key:"sidebarRing",label:"Sidebar Ring"},{key:"chart1",label:"Chart 1"},{key:"chart2",label:"Chart 2"},{key:"chart3",label:"Chart 3"},{key:"chart4",label:"Chart 4"},{key:"chart5",label:"Chart 5"}];return p.jsxs("div",{className:"space-y-6 p-1",children:[p.jsx(u0,{title:"Base Theme",description:"Select the overall look and feel.",contentClassName:"rounded-lg border p-4 shadow-sm bg-card",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx(Jt,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),p.jsx(x0,{form:n,name:"theme",label:"Theme",options:[{value:"light",label:"Default Light"},{value:"dark",label:"Default Dark"},{value:"system",label:"System"},{value:"TijuLight",label:"Tiju Light"},{value:"TijuDark",label:"Tiju Dark"},{value:"custom",label:"User Custom"}],triggerClassName:"w-[180px]"})]})}),p.jsxs(u0,{title:"Font & Layout",description:"Customize typography and content width.",contentClassName:"rounded-lg border p-4 shadow-sm bg-card space-y-4",children:[p.jsxs("div",{children:[p.jsx(Py,{form:n,name:"customFontFamily",label:"Custom Font Family",placeholder:"e.g., 'Inter', sans-serif (Leave blank for default)",className:"mt-1"}),p.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies only when 'User Custom' theme is selected. Ensure the font is available (system or web font)."})]}),p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Ro,{form:n,name:"customFontSize",label:`Base Font Size (${n.getFieldValue("customFontSize")}px)`,min:12,max:20,step:1,className:"mt-1"}),p.jsx("p",{className:"text-xs text-muted-foreground",children:"Applies only when 'User Custom' theme is selected. Affects base text size (Default: 16px)."})]}),p.jsxs("div",{children:[p.jsx(x0,{form:n,name:"chatMaxWidth",label:"Chat Content Max Width",options:s,triggerClassName:"w-full mt-1"}),p.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Controls the maximum width of the main chat message area."})]})]}),p.jsxs(u0,{title:"Code Block Theme",description:"Customize syntax highlighting appearance.",contentClassName:"rounded-lg border p-4 shadow-sm bg-card space-y-3",children:[p.jsx(x0,{form:n,name:"prismThemeUrl",label:"Code Block Theme",options:BIe,triggerClassName:"w-full"}),p.jsx(Py,{form:n,name:"prismThemeUrl",label:"Or paste custom theme URL here...",placeholder:"Or paste custom theme URL here...",type:"url",className:"mt-1"}),p.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a preset theme or paste a URL to a PrismJS CSS file. Leave blank or select 'Default' to use themes matching light/dark mode."})]}),n.getFieldValue("theme")==="custom"&&p.jsx(u0,{title:"Custom Theme Colors",description:"Define custom colors. Use valid CSS color values (hex, rgb, oklch, etc.). Leave blank to use default light/dark theme colors.",contentClassName:"rounded-lg border p-4 shadow-sm bg-card",children:p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",children:i.map(({key:a,label:o})=>{var l;return p.jsx(LIe,{label:o,colorKey:a,value:(l=n.getFieldValue("customThemeColors"))==null?void 0:l[a],onChange:(c,u)=>n.setFieldValue(`customThemeColors.${c}`,u===null?"":u)},a)})})}),p.jsx(Lf,{}),p.jsx("div",{className:"flex justify-end pt-4",children:p.jsxs(Ct,{variant:"outline",size:"sm",onClick:r,children:[p.jsx(yR,{className:"mr-2 h-4 w-4"}),"Reset Theme Settings"]})})]})},qIe=dt.memo(UIe);class VIe{constructor(){Ne(this,"id","core-settings-theme");Ne(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"theme",title:"Theme",component:qIe,order:20})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const HIe=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:s,onUpdate:i,fetchStatus:a,isDeleting:o,allAvailableModelsForView:l})=>{var j,M;const[c,u]=T.useState(!0),f=Pp(e.type),m=Px(e.type),g=xf(e.type),v=a==="fetching"||o,b=o||a==="fetching",w=o||a==="fetching",x=T.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),_=e.apiKeyId?t.some(L=>L.id===e.apiKeyId):!1,E=f&&!_,C=T.useCallback(async(L,q)=>{const P=new Set(e.enabledModels??[]);q?P.add(L):P.delete(L);const V=Array.from(P);try{await i(e.id,{enabledModels:V})}catch(z){Le.error("Failed to update model status."),console.error("Failed to save model toggle:",z)}},[e.enabledModels,e.id,i]),k=()=>u(L=>!L),R=((j=e.enabledModels)==null?void 0:j.length)??0,I=l.length;return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{children:p.jsx("span",{className:ct("h-2.5 w-2.5 rounded-full flex-shrink-0 block",a==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),p.jsx(cr,{side:"top",children:a==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),p.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),p.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),E&&p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{children:p.jsx(Ac,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),p.jsx(cr,{side:"top",children:p.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),p.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[p.jsx(gn,{tooltipText:"Edit",onClick:n,disabled:b,"aria-label":"Edit provider",icon:p.jsx(Vy,{}),className:"h-8 w-8"}),p.jsx(gn,{tooltipText:"Delete",onClick:r,disabled:w,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Aa,{})})]})]}),p.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[f&&p.jsxs("div",{children:["API Key:"," ",e.apiKeyId?_?p.jsx("span",{className:"text-green-400",children:((M=t.find(L=>L.id===e.apiKeyId))==null?void 0:M.name)||"Linked (Unnamed Key)"}):p.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):p.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),m&&p.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),p.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?p.jsx("span",{className:"text-green-400",children:"Enabled"}):p.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&p.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),g&&p.jsx("div",{className:"pt-1",children:p.jsxs(Ct,{variant:"outline",size:"sm",onClick:s,disabled:v,className:"text-xs h-7 px-2",children:[a==="fetching"&&p.jsx(Pn,{className:"h-3 w-3 mr-1 animate-spin"}),a==="success"&&p.jsx(Ui,{className:"h-3 w-3 mr-1 text-green-500"}),a==="error"&&p.jsx(Ac,{className:"h-3 w-3 mr-1 text-destructive"}),a==="idle"&&p.jsx(D1,{className:"h-3 w-3 mr-1"}),a==="fetching"?"Fetching...":a==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),p.jsxs("div",{className:"space-y-1 pt-2",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",R," / ",I," enabled)"]}),p.jsx(gn,{tooltipText:c?"Show Models":"Hide Models",onClick:k,"aria-label":c?"Show model list":"Hide model list",icon:c?p.jsx(Fl,{}):p.jsx(fd,{}),className:"h-6 w-6"})]}),!c&&p.jsx(zI,{providerId:e.id,allAvailableModels:l,enabledModelIds:x,onToggleModel:C,isLoading:a==="fetching",disabled:o,listHeightClass:"h-[26rem]"})]})]})},GIe=dt.memo(HIe),KIe=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:s,onCancel:i,onSave:a,onChange:o})=>{const l=T.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),c=T.useCallback((f,m)=>{const g=new Set(t.enabledModels??[]);m?g.add(f):g.delete(f);const v=Array.from(g);o("enabledModels",v)},[t.enabledModels,o]),u=T.useCallback((f,m)=>new Promise(g=>{o(f,m),g(void 0)}),[o]);return p.jsx("div",{className:"space-y-4",children:p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"space-y-3",children:[p.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),p.jsx(wV,{initialData:t,onChange:u,onSubmit:a,onCancel:i,apiKeys:n,disabled:s})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),p.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),p.jsx(zI,{providerId:e,allAvailableModels:r,enabledModelIds:l,onToggleModel:c,disabled:s,listHeightClass:"h-[calc(100%-8rem)]"})]})]})})},WIe=dt.memo(KIe),ZIe=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:s,fetchStatus:i,onSelectModelForDetails:a})=>{const[o,l]=T.useState(!1),[c,u]=T.useState(!1),[f,m]=T.useState(!1),[g,v]=T.useState({name:"placeholder"}),b=gr(M=>M.getAllAvailableModelDefsForProvider),[w,x]=T.useState([]),_=T.useMemo(()=>[...b(e.id)].sort((L,q)=>(L.name||L.id).localeCompare(q.name||q.id)),[e.id,b]);T.useEffect(()=>{if(o){const M=b(e.id);x([...M].sort((L,q)=>(L.name||L.id).localeCompare(q.name||q.id))),v({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else x([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,b]);const E=()=>l(!0),C=()=>{l(!1),v({}),u(!1)},k=T.useCallback(async()=>{u(!0);try{const M=g.enabledModels&&g.enabledModels.length>0?g.enabledModels:null,L={name:g.name,type:g.type,isEnabled:g.isEnabled,apiKeyId:g.apiKeyId,baseURL:g.baseURL,autoFetchModels:g.autoFetchModels,enabledModels:M};Object.keys(L).forEach(q=>{L[q]===void 0&&delete L[q]}),await n(e.id,L),l(!1),v({}),Le.success(`Provider "${L.name||e.name}" updated.`)}catch(M){console.error("Failed to save provider update:",M),Le.error("Failed to save provider configuration.")}finally{u(!1)}},[g,n,e.id,e.name]),R=T.useCallback((M,L)=>{v(q=>({...q,[M]:L}))},[]),I=T.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){m(!0);try{await r(e.id)}catch(M){console.error("Failed to delete provider:",M),m(!1)}}},[r,e.id,e.name]),j=T.useCallback(async()=>{if(await s(e.id),o){const M=b(e.id);x([...M].sort((L,q)=>(L.name||L.id).localeCompare(q.name||q.id)))}},[s,e.id,o,b]);return p.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?p.jsx(WIe,{providerId:e.id,editData:g,apiKeys:t,allAvailableModels:w,isSaving:c,onCancel:C,onSave:k,onChange:R}):p.jsx(GIe,{provider:e,apiKeys:t,onEdit:E,onDelete:I,onFetchModels:j,onUpdate:n,fetchStatus:i,isDeleting:f,onSelectModelForDetails:a,allAvailableModelsForView:_})})},YIe=dt.memo(ZIe);function XIe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return T.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const bS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Dm(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function s3(e){return"nodeType"in e}function ha(e){var t,n;return e?Dm(e)?e:s3(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function i3(e){const{Document:t}=ha(e);return e instanceof t}function zb(e){return Dm(e)?!1:e instanceof ha(e).HTMLElement}function gK(e){return e instanceof ha(e).SVGElement}function Fm(e){return e?Dm(e)?e.document:s3(e)?i3(e)?e:zb(e)||gK(e)?e.ownerDocument:document:document:document}const Dl=bS?T.useLayoutEffect:T.useEffect;function a3(e){const t=T.useRef(e);return Dl(()=>{t.current=e}),T.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function JIe(){const e=T.useRef(null),t=T.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=T.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function By(e,t){t===void 0&&(t=[e]);const n=T.useRef(e);return Dl(()=>{n.current!==e&&(n.current=e)},t),n}function Ub(e,t){const n=T.useRef();return T.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function R1(e){const t=a3(e),n=T.useRef(null),r=T.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function iR(e){const t=T.useRef();return T.useEffect(()=>{t.current=e},[e]),t.current}let hT={};function qb(e,t){return T.useMemo(()=>{if(t)return t;const n=hT[e]==null?0:hT[e]+1;return hT[e]=n,e+"-"+n},[e,t])}function yK(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=i[l];u!=null&&(i[l]=u+e*c)}return i},{...t})}}const Rp=yK(1),$y=yK(-1);function QIe(e){return"clientX"in e&&"clientY"in e}function o3(e){if(!e)return!1;const{KeyboardEvent:t}=ha(e.target);return t&&e instanceof t}function e3e(e){if(!e)return!1;const{TouchEvent:t}=ha(e.target);return t&&e instanceof t}function aR(e){if(e3e(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return QIe(e)?{x:e.clientX,y:e.clientY}:null}const zy=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[zy.Translate.toString(e),zy.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),b8="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function t3e(e){return e.matches(b8)?e:e.querySelector(b8)}const n3e={display:"none"};function r3e(e){let{id:t,value:n}=e;return dt.createElement("div",{id:t,style:n3e},n)}function s3e(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return dt.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function i3e(){const[e,t]=T.useState("");return{announce:T.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const bK=T.createContext(null);function a3e(e){const t=T.useContext(bK);T.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function o3e(){const[e]=T.useState(()=>new Set),t=T.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[T.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[e]),t]}const l3e={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},c3e={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function u3e(e){let{announcements:t=c3e,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=l3e}=e;const{announce:i,announcement:a}=i3e(),o=qb("DndLiveRegion"),[l,c]=T.useState(!1);if(T.useEffect(()=>{c(!0)},[]),a3e(T.useMemo(()=>({onDragStart(f){let{active:m}=f;i(t.onDragStart({active:m}))},onDragMove(f){let{active:m,over:g}=f;t.onDragMove&&i(t.onDragMove({active:m,over:g}))},onDragOver(f){let{active:m,over:g}=f;i(t.onDragOver({active:m,over:g}))},onDragEnd(f){let{active:m,over:g}=f;i(t.onDragEnd({active:m,over:g}))},onDragCancel(f){let{active:m,over:g}=f;i(t.onDragCancel({active:m,over:g}))}}),[i,t])),!l)return null;const u=dt.createElement(dt.Fragment,null,dt.createElement(r3e,{id:r,value:s.draggable}),dt.createElement(s3e,{id:o,announcement:a}));return n?ko.createPortal(u,n):u}var Fs;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Fs||(Fs={}));function N1(){}function v8(e,t){return T.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function d3e(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return T.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const zo=Object.freeze({x:0,y:0});function vK(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function wK(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function f3e(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function w8(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function xK(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function x8(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const h3e=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=x8(t,t.left,t.top),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=vK(x8(l),s);i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(wK)},p3e=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=w8(t),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=w8(l),u=s.reduce((m,g,v)=>m+vK(c[v],g),0),f=Number((u/4).toFixed(4));i.push({id:o,data:{droppableContainer:a,value:f}})}}return i.sort(wK)};function m3e(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,o=i-n;if(r<s&&n<i){const l=t.width*t.height,c=e.width*e.height,u=a*o,f=u/(l+c-u);return Number(f.toFixed(4))}return 0}const g3e=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,o=n.get(a);if(o){const l=m3e(o,t);l>0&&s.push({id:a,data:{droppableContainer:i,value:l}})}}return s.sort(f3e)};function y3e(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function _K(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:zo}function b3e(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const v3e=b3e(1);function w3e(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function x3e(e,t,n){const r=w3e(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:o}=r,l=e.left-a-(1-s)*parseFloat(n),c=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,f=i?e.height/i:e.height;return{width:u,height:f,top:c,right:l+u,bottom:c+f,left:l}}const _3e={ignoreTransform:!1};function Lm(e,t){t===void 0&&(t=_3e);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=ha(e).getComputedStyle(e);c&&(n=x3e(n,c,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:l}=n;return{top:r,left:s,width:i,height:a,bottom:o,right:l}}function _8(e){return Lm(e,{ignoreTransform:!0})}function S3e(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function E3e(e,t){return t===void 0&&(t=ha(e).getComputedStyle(e)),t.position==="fixed"}function C3e(e,t){t===void 0&&(t=ha(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function vS(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(i3(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!zb(s)||gK(s)||n.includes(s))return n;const i=ha(e).getComputedStyle(s);return s!==e&&C3e(s,i)&&n.push(s),E3e(s,i)?n:r(s.parentNode)}return e?r(e):n}function SK(e){const[t]=vS(e,1);return t??null}function pT(e){return!bS||!e?null:Dm(e)?e:s3(e)?i3(e)||e===Fm(e).scrollingElement?window:zb(e)?e:null:null}function EK(e){return Dm(e)?e.scrollX:e.scrollLeft}function CK(e){return Dm(e)?e.scrollY:e.scrollTop}function oR(e){return{x:EK(e),y:CK(e)}}var Ys;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Ys||(Ys={}));function kK(e){return!bS||!e?!1:e===document.scrollingElement}function TK(e){const t={x:0,y:0},n=kK(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const k3e={x:.2,y:.2};function T3e(e,t,n,r,s){let{top:i,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),s===void 0&&(s=k3e);const{isTop:c,isBottom:u,isLeft:f,isRight:m}=TK(e),g={x:0,y:0},v={x:0,y:0},b={height:t.height*s.y,width:t.width*s.x};return!c&&i<=t.top+b.height?(g.y=Ys.Backward,v.y=r*Math.abs((t.top+b.height-i)/b.height)):!u&&l>=t.bottom-b.height&&(g.y=Ys.Forward,v.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!m&&o>=t.right-b.width?(g.x=Ys.Forward,v.x=r*Math.abs((t.right-b.width-o)/b.width)):!f&&a<=t.left+b.width&&(g.x=Ys.Backward,v.x=r*Math.abs((t.left+b.width-a)/b.width)),{direction:g,speed:v}}function A3e(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function AK(e){return e.reduce((t,n)=>Rp(t,oR(n)),zo)}function R3e(e){return e.reduce((t,n)=>t+EK(n),0)}function N3e(e){return e.reduce((t,n)=>t+CK(n),0)}function I3e(e,t){if(t===void 0&&(t=Lm),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);SK(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const j3e=[["x",["left","right"],R3e],["y",["top","bottom"],N3e]];class l3{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=vS(n),s=AK(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,o]of j3e)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=s[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class _0{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function M3e(e){const{EventTarget:t}=ha(e);return e instanceof t?e:Fm(e)}function mT(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Qa;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Qa||(Qa={}));function S8(e){e.preventDefault()}function O3e(e){e.stopPropagation()}var ur;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(ur||(ur={}));const RK={start:[ur.Space,ur.Enter],cancel:[ur.Esc],end:[ur.Space,ur.Enter,ur.Tab]},P3e=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case ur.Right:return{...n,x:n.x+25};case ur.Left:return{...n,x:n.x-25};case ur.Down:return{...n,y:n.y+25};case ur.Up:return{...n,y:n.y-25}}};class c3{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new _0(Fm(n)),this.windowListeners=new _0(ha(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Qa.Resize,this.handleCancel),this.windowListeners.add(Qa.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Qa.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&I3e(r),n(zo)}handleKeyDown(t){if(o3(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=RK,coordinateGetter:a=P3e,scrollBehavior:o="smooth"}=s,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:zo;this.referenceCoordinates||(this.referenceCoordinates=u);const f=a(t,{active:n,context:r.current,currentCoordinates:u});if(f){const m=$y(f,u),g={x:0,y:0},{scrollableAncestors:v}=r.current;for(const b of v){const w=t.code,{isTop:x,isRight:_,isLeft:E,isBottom:C,maxScroll:k,minScroll:R}=TK(b),I=A3e(b),j={x:Math.min(w===ur.Right?I.right-I.width/2:I.right,Math.max(w===ur.Right?I.left:I.left+I.width/2,f.x)),y:Math.min(w===ur.Down?I.bottom-I.height/2:I.bottom,Math.max(w===ur.Down?I.top:I.top+I.height/2,f.y))},M=w===ur.Right&&!_||w===ur.Left&&!E,L=w===ur.Down&&!C||w===ur.Up&&!x;if(M&&j.x!==f.x){const q=b.scrollLeft+m.x,P=w===ur.Right&&q<=k.x||w===ur.Left&&q>=R.x;if(P&&!m.y){b.scrollTo({left:q,behavior:o});return}P?g.x=b.scrollLeft-q:g.x=w===ur.Right?b.scrollLeft-k.x:b.scrollLeft-R.x,g.x&&b.scrollBy({left:-g.x,behavior:o});break}else if(L&&j.y!==f.y){const q=b.scrollTop+m.y,P=w===ur.Down&&q<=k.y||w===ur.Up&&q>=R.y;if(P&&!m.x){b.scrollTo({top:q,behavior:o});return}P?g.y=b.scrollTop-q:g.y=w===ur.Down?b.scrollTop-k.y:b.scrollTop-R.y,g.y&&b.scrollBy({top:-g.y,behavior:o});break}}this.handleMove(t,Rp($y(f,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}c3.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=RK,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function E8(e){return!!(e&&"distance"in e)}function C8(e){return!!(e&&"delay"in e)}class u3{constructor(t,n,r){var s;r===void 0&&(r=M3e(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=Fm(a),this.documentListeners=new _0(this.document),this.listeners=new _0(r),this.windowListeners=new _0(ha(a)),this.initialCoordinates=(s=aR(i))!=null?s:zo,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Qa.Resize,this.handleCancel),this.windowListeners.add(Qa.DragStart,S8),this.windowListeners.add(Qa.VisibilityChange,this.handleCancel),this.windowListeners.add(Qa.ContextMenu,S8),this.documentListeners.add(Qa.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(C8(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(E8(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Qa.Click,O3e,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Qa.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const l=(n=aR(t))!=null?n:zo,c=$y(s,l);if(!r&&o){if(E8(o)){if(o.tolerance!=null&&mT(c,o.tolerance))return this.handleCancel();if(mT(c,o.distance))return this.handleStart()}if(C8(o)&&mT(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===ur.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const D3e={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class d3 extends u3{constructor(t){const{event:n}=t,r=Fm(n.target);super(t,D3e,r)}}d3.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const F3e={move:{name:"mousemove"},end:{name:"mouseup"}};var lR;(function(e){e[e.RightClick=2]="RightClick"})(lR||(lR={}));class L3e extends u3{constructor(t){super(t,F3e,Fm(t.event.target))}}L3e.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===lR.RightClick?!1:(r==null||r({event:n}),!0)}}];const gT={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class B3e extends u3{constructor(t){super(t,gT)}static setup(){return window.addEventListener(gT.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(gT.move.name,t)};function t(){}}}B3e.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var S0;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(S0||(S0={}));var I1;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(I1||(I1={}));function $3e(e){let{acceleration:t,activator:n=S0.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=I1.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:f,threshold:m}=e;const g=U3e({delta:f,disabled:!i}),[v,b]=JIe(),w=T.useRef({x:0,y:0}),x=T.useRef({x:0,y:0}),_=T.useMemo(()=>{switch(n){case S0.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case S0.DraggableRect:return s}},[n,s,l]),E=T.useRef(null),C=T.useCallback(()=>{const R=E.current;if(!R)return;const I=w.current.x*x.current.x,j=w.current.y*x.current.y;R.scrollBy(I,j)},[]),k=T.useMemo(()=>o===I1.TreeOrder?[...c].reverse():c,[o,c]);T.useEffect(()=>{if(!i||!c.length||!_){b();return}for(const R of k){if((r==null?void 0:r(R))===!1)continue;const I=c.indexOf(R),j=u[I];if(!j)continue;const{direction:M,speed:L}=T3e(R,j,_,t,m);for(const q of["x","y"])g[q][M[q]]||(L[q]=0,M[q]=0);if(L.x>0||L.y>0){b(),E.current=R,v(C,a),w.current=L,x.current=M;return}}w.current={x:0,y:0},x.current={x:0,y:0},b()},[t,C,r,b,i,a,JSON.stringify(_),JSON.stringify(g),v,c,k,u,JSON.stringify(m)])}const z3e={x:{[Ys.Backward]:!1,[Ys.Forward]:!1},y:{[Ys.Backward]:!1,[Ys.Forward]:!1}};function U3e(e){let{delta:t,disabled:n}=e;const r=iR(t);return Ub(s=>{if(n||!r||!s)return z3e;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[Ys.Backward]:s.x[Ys.Backward]||i.x===-1,[Ys.Forward]:s.x[Ys.Forward]||i.x===1},y:{[Ys.Backward]:s.y[Ys.Backward]||i.y===-1,[Ys.Forward]:s.y[Ys.Forward]||i.y===1}}},[n,t,r])}function q3e(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ub(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function V3e(e,t){return T.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var Uy;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Uy||(Uy={}));var cR;(function(e){e.Optimized="optimized"})(cR||(cR={}));const k8=new Map;function H3e(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=T.useState(null),{frequency:o,measure:l,strategy:c}=s,u=T.useRef(e),f=w(),m=By(f),g=T.useCallback(function(x){x===void 0&&(x=[]),!m.current&&a(_=>_===null?x:_.concat(x.filter(E=>!_.includes(E))))},[m]),v=T.useRef(null),b=Ub(x=>{if(f&&!n)return k8;if(!x||x===k8||u.current!==e||i!=null){const _=new Map;for(let E of e){if(!E)continue;if(i&&i.length>0&&!i.includes(E.id)&&E.rect.current){_.set(E.id,E.rect.current);continue}const C=E.node.current,k=C?new l3(l(C),C):null;E.rect.current=k,k&&_.set(E.id,k)}return _}return x},[e,i,n,f,l]);return T.useEffect(()=>{u.current=e},[e]),T.useEffect(()=>{f||g()},[n,f]),T.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),T.useEffect(()=>{f||typeof o!="number"||v.current!==null||(v.current=setTimeout(()=>{g(),v.current=null},o))},[o,f,g,...r]),{droppableRects:b,measureDroppableContainers:g,measuringScheduled:i!=null};function w(){switch(c){case Uy.Always:return!1;case Uy.BeforeDragging:return n;default:return!n}}}function NK(e,t){return Ub(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function G3e(e,t){return NK(e,t)}function K3e(e){let{callback:t,disabled:n}=e;const r=a3(t),s=T.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return T.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function wS(e){let{callback:t,disabled:n}=e;const r=a3(t),s=T.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return T.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function W3e(e){return new l3(Lm(e),e)}function T8(e,t,n){t===void 0&&(t=W3e);const[r,s]=T.useState(null);function i(){s(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=t(e);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=K3e({callback(l){if(e)for(const c of l){const{type:u,target:f}=c;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){i();break}}}}),o=wS({callback:i});return Dl(()=>{i(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function Z3e(e){const t=NK(e);return _K(e,t)}const A8=[];function Y3e(e){const t=T.useRef(e),n=Ub(r=>e?r&&r!==A8&&e&&t.current&&e.parentNode===t.current.parentNode?r:vS(e):A8,[e]);return T.useEffect(()=>{t.current=e},[e]),n}function X3e(e){const[t,n]=T.useState(null),r=T.useRef(e),s=T.useCallback(i=>{const a=pT(i.target);a&&n(o=>o?(o.set(a,oR(a)),new Map(o)):null)},[]);return T.useEffect(()=>{const i=r.current;if(e!==i){a(i);const o=e.map(l=>{const c=pT(l);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,oR(c)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(i)};function a(o){o.forEach(l=>{const c=pT(l);c==null||c.removeEventListener("scroll",s)})}},[s,e]),T.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>Rp(i,a),zo):AK(e):zo,[e,t])}function R8(e,t){t===void 0&&(t=[]);const n=T.useRef(null);return T.useEffect(()=>{n.current=null},t),T.useEffect(()=>{const r=e!==zo;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?$y(e,n.current):zo}function J3e(e){T.useEffect(()=>{if(!bS)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Q3e(e,t){return T.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function IK(e){return T.useMemo(()=>e?S3e(e):null,[e])}const N8=[];function eje(e,t){t===void 0&&(t=Lm);const[n]=e,r=IK(n?ha(n):null),[s,i]=T.useState(N8);function a(){i(()=>e.length?e.map(l=>kK(l)?r:new l3(t(l),l)):N8)}const o=wS({callback:a});return Dl(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),s}function tje(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return zb(t)?t:e}function nje(e){let{measure:t}=e;const[n,r]=T.useState(null),s=T.useCallback(c=>{for(const{target:u}of c)if(zb(u)){r(f=>{const m=t(u);return f?{...f,width:m.width,height:m.height}:m});break}},[t]),i=wS({callback:s}),a=T.useCallback(c=>{const u=tje(c);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[o,l]=R1(a);return T.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const rje=[{sensor:d3,options:{}},{sensor:c3,options:{}}],sje={current:{}},ax={draggable:{measure:_8},droppable:{measure:_8,strategy:Uy.WhileDragging,frequency:cR.Optimized},dragOverlay:{measure:Lm}};class E0 extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const ije={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new E0,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:N1},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ax,measureDroppableContainers:N1,windowRect:null,measuringScheduled:!1},aje={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:N1,draggableNodes:new Map,over:null,measureDroppableContainers:N1},xS=T.createContext(aje),jK=T.createContext(ije);function oje(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new E0}}}function lje(e,t){switch(t.type){case Fs.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Fs.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Fs.DragEnd:case Fs.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Fs.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new E0(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case Fs.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new E0(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case Fs.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new E0(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function cje(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=T.useContext(xS),i=iR(r),a=iR(n==null?void 0:n.id);return T.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!o3(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const f=t3e(u);if(f){f.focus();break}}})}},[r,t,s,a,i]),null}function uje(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function dje(e){return T.useMemo(()=>({draggable:{...ax.draggable,...e==null?void 0:e.draggable},droppable:{...ax.droppable,...e==null?void 0:e.droppable},dragOverlay:{...ax.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function fje(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=T.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Dl(()=>{if(!a&&!o||!t){i.current=!1;return}if(i.current||!r)return;const c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;const u=n(c),f=_K(u,r);if(a||(f.x=0),o||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const m=SK(c);m&&m.scrollBy({top:f.y,left:f.x})}},[t,a,o,r,n])}const MK=T.createContext({...zo,scaleX:1,scaleY:1});var Ou;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ou||(Ou={}));const hje=T.memo(function(t){var n,r,s,i;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=rje,collisionDetection:f=g3e,measuring:m,modifiers:g,...v}=t;const b=T.useReducer(lje,void 0,oje),[w,x]=b,[_,E]=o3e(),[C,k]=T.useState(Ou.Uninitialized),R=C===Ou.Initialized,{draggable:{active:I,nodes:j,translate:M},droppable:{containers:L}}=w,q=I!=null?j.get(I):null,P=T.useRef({initial:null,translated:null}),V=T.useMemo(()=>{var rt;return I!=null?{id:I,data:(rt=q==null?void 0:q.data)!=null?rt:sje,rect:P}:null},[I,q]),z=T.useRef(null),[re,K]=T.useState(null),[ee,W]=T.useState(null),se=By(v,Object.values(v)),Y=qb("DndDescribedBy",a),te=T.useMemo(()=>L.getEnabled(),[L]),Q=dje(m),{droppableRects:ae,measureDroppableContainers:xe,measuringScheduled:ge}=H3e(te,{dragging:R,dependencies:[M.x,M.y],config:Q.droppable}),Me=q3e(j,I),Pe=T.useMemo(()=>ee?aR(ee):null,[ee]),Ie=ze(),Ce=G3e(Me,Q.draggable.measure);fje({activeNode:I!=null?j.get(I):null,config:Ie.layoutShiftCompensation,initialRect:Ce,measure:Q.draggable.measure});const He=T8(Me,Q.draggable.measure,Ce),it=T8(Me?Me.parentElement:null),Ge=T.useRef({activatorEvent:null,active:null,activeNode:Me,collisionRect:null,collisions:null,droppableRects:ae,draggableNodes:j,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Re=L.getNodeFor((n=Ge.current.over)==null?void 0:n.id),H=nje({measure:Q.dragOverlay.measure}),me=(r=H.nodeRef.current)!=null?r:Me,Te=R?(s=H.rect)!=null?s:He:null,ce=!!(H.nodeRef.current&&H.rect),oe=Z3e(ce?null:He),ne=IK(me?ha(me):null),Se=Y3e(R?Re??Me:null),Fe=eje(Se),ke=uje(g,{transform:{x:M.x-oe.x,y:M.y-oe.y,scaleX:1,scaleY:1},activatorEvent:ee,active:V,activeNodeRect:He,containerNodeRect:it,draggingNodeRect:Te,over:Ge.current.over,overlayNodeRect:H.rect,scrollableAncestors:Se,scrollableAncestorRects:Fe,windowRect:ne}),Xe=Pe?Rp(Pe,M):null,St=X3e(Se),ht=R8(St),It=R8(St,[He]),Vt=Rp(ke,ht),Ot=Te?v3e(Te,ke):null,Gt=V&&Ot?f({active:V,collisionRect:Ot,droppableRects:ae,droppableContainers:te,pointerCoordinates:Xe}):null,be=xK(Gt,"id"),[O,Z]=T.useState(null),fe=ce?ke:Rp(ke,It),Oe=y3e(fe,(i=O==null?void 0:O.rect)!=null?i:null,He),ve=T.useRef(null),Ae=T.useCallback((rt,ye)=>{let{sensor:we,options:Ue}=ye;if(z.current==null)return;const Et=j.get(z.current);if(!Et)return;const he=rt.nativeEvent,G=new we({active:z.current,activeNode:Et,event:he,options:Ue,context:Ge,onAbort(X){if(!j.get(X))return;const{onDragAbort:je}=se.current,Ke={id:X};je==null||je(Ke),_({type:"onDragAbort",event:Ke})},onPending(X,pe,je,Ke){if(!j.get(X))return;const{onDragPending:Kt}=se.current,yn={id:X,constraint:pe,initialCoordinates:je,offset:Ke};Kt==null||Kt(yn),_({type:"onDragPending",event:yn})},onStart(X){const pe=z.current;if(pe==null)return;const je=j.get(pe);if(!je)return;const{onDragStart:Ke}=se.current,bt={activatorEvent:he,active:{id:pe,data:je.data,rect:P}};ko.unstable_batchedUpdates(()=>{Ke==null||Ke(bt),k(Ou.Initializing),x({type:Fs.DragStart,initialCoordinates:X,active:pe}),_({type:"onDragStart",event:bt}),K(ve.current),W(he)})},onMove(X){x({type:Fs.DragMove,coordinates:X})},onEnd:U(Fs.DragEnd),onCancel:U(Fs.DragCancel)});ve.current=G;function U(X){return async function(){const{active:je,collisions:Ke,over:bt,scrollAdjustedTranslate:Kt}=Ge.current;let yn=null;if(je&&Kt){const{cancelDrop:Ht}=se.current;yn={activatorEvent:he,active:je,collisions:Ke,delta:Kt,over:bt},X===Fs.DragEnd&&typeof Ht=="function"&&await Promise.resolve(Ht(yn))&&(X=Fs.DragCancel)}z.current=null,ko.unstable_batchedUpdates(()=>{x({type:X}),k(Ou.Uninitialized),Z(null),K(null),W(null),ve.current=null;const Ht=X===Fs.DragEnd?"onDragEnd":"onDragCancel";if(yn){const Yt=se.current[Ht];Yt==null||Yt(yn),_({type:Ht,event:yn})}})}}},[j]),ue=T.useCallback((rt,ye)=>(we,Ue)=>{const Et=we.nativeEvent,he=j.get(Ue);if(z.current!==null||!he||Et.dndKit||Et.defaultPrevented)return;const G={active:he};rt(we,ye.options,G)===!0&&(Et.dndKit={capturedBy:ye.sensor},z.current=Ue,Ae(we,ye))},[j,Ae]),mt=V3e(u,ue);J3e(u),Dl(()=>{He&&C===Ou.Initializing&&k(Ou.Initialized)},[He,C]),T.useEffect(()=>{const{onDragMove:rt}=se.current,{active:ye,activatorEvent:we,collisions:Ue,over:Et}=Ge.current;if(!ye||!we)return;const he={active:ye,activatorEvent:we,collisions:Ue,delta:{x:Vt.x,y:Vt.y},over:Et};ko.unstable_batchedUpdates(()=>{rt==null||rt(he),_({type:"onDragMove",event:he})})},[Vt.x,Vt.y]),T.useEffect(()=>{const{active:rt,activatorEvent:ye,collisions:we,droppableContainers:Ue,scrollAdjustedTranslate:Et}=Ge.current;if(!rt||z.current==null||!ye||!Et)return;const{onDragOver:he}=se.current,G=Ue.get(be),U=G&&G.rect.current?{id:G.id,rect:G.rect.current,data:G.data,disabled:G.disabled}:null,X={active:rt,activatorEvent:ye,collisions:we,delta:{x:Et.x,y:Et.y},over:U};ko.unstable_batchedUpdates(()=>{Z(U),he==null||he(X),_({type:"onDragOver",event:X})})},[be]),Dl(()=>{Ge.current={activatorEvent:ee,active:V,activeNode:Me,collisionRect:Ot,collisions:Gt,droppableRects:ae,draggableNodes:j,draggingNode:me,draggingNodeRect:Te,droppableContainers:L,over:O,scrollableAncestors:Se,scrollAdjustedTranslate:Vt},P.current={initial:Te,translated:Ot}},[V,Me,Gt,Ot,j,me,Te,ae,L,O,Se,Vt]),$3e({...Ie,delta:M,draggingRect:Ot,pointerCoordinates:Xe,scrollableAncestors:Se,scrollableAncestorRects:Fe});const wt=T.useMemo(()=>({active:V,activeNode:Me,activeNodeRect:He,activatorEvent:ee,collisions:Gt,containerNodeRect:it,dragOverlay:H,draggableNodes:j,droppableContainers:L,droppableRects:ae,over:O,measureDroppableContainers:xe,scrollableAncestors:Se,scrollableAncestorRects:Fe,measuringConfiguration:Q,measuringScheduled:ge,windowRect:ne}),[V,Me,He,ee,Gt,it,H,j,L,ae,O,xe,Se,Fe,Q,ge,ne]),B=T.useMemo(()=>({activatorEvent:ee,activators:mt,active:V,activeNodeRect:He,ariaDescribedById:{draggable:Y},dispatch:x,draggableNodes:j,over:O,measureDroppableContainers:xe}),[ee,mt,V,He,x,Y,j,O,xe]);return dt.createElement(bK.Provider,{value:E},dt.createElement(xS.Provider,{value:B},dt.createElement(jK.Provider,{value:wt},dt.createElement(MK.Provider,{value:Oe},c)),dt.createElement(cje,{disabled:(o==null?void 0:o.restoreFocus)===!1})),dt.createElement(u3e,{...o,hiddenTextDescribedById:Y}));function ze(){const rt=(re==null?void 0:re.autoScrollEnabled)===!1,ye=typeof l=="object"?l.enabled===!1:l===!1,we=R&&!rt&&!ye;return typeof l=="object"?{...l,enabled:we}:{enabled:we}}}),pje=T.createContext(null),I8="button",mje="Draggable";function gje(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=qb(mje),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:f,over:m}=T.useContext(xS),{role:g=I8,roleDescription:v="draggable",tabIndex:b=0}=s??{},w=(l==null?void 0:l.id)===t,x=T.useContext(w?MK:pje),[_,E]=R1(),[C,k]=R1(),R=Q3e(a,t),I=By(n);Dl(()=>(f.set(t,{id:t,key:i,node:_,activatorNode:C,data:I}),()=>{const M=f.get(t);M&&M.key===i&&f.delete(t)}),[f,t]);const j=T.useMemo(()=>({role:g,tabIndex:b,"aria-disabled":r,"aria-pressed":w&&g===I8?!0:void 0,"aria-roledescription":v,"aria-describedby":u.draggable}),[r,g,b,w,v,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:j,isDragging:w,listeners:r?void 0:R,node:_,over:m,setNodeRef:E,setActivatorNodeRef:k,transform:x}}function yje(){return T.useContext(jK)}const bje="Droppable",vje={timeout:25};function wje(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=qb(bje),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=T.useContext(xS),u=T.useRef({disabled:n}),f=T.useRef(!1),m=T.useRef(null),g=T.useRef(null),{disabled:v,updateMeasurementsFor:b,timeout:w}={...vje,...s},x=By(b??r),_=T.useCallback(()=>{if(!f.current){f.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{c(Array.isArray(x.current)?x.current:[x.current]),g.current=null},w)},[w]),E=wS({callback:_,disabled:v||!a}),C=T.useCallback((j,M)=>{E&&(M&&(E.unobserve(M),f.current=!1),j&&E.observe(j))},[E]),[k,R]=R1(C),I=By(t);return T.useEffect(()=>{!E||!k.current||(E.disconnect(),f.current=!1,E.observe(k.current))},[k,E]),T.useEffect(()=>(o({type:Fs.RegisterDroppable,element:{id:r,key:i,disabled:n,node:k,rect:m,data:I}}),()=>o({type:Fs.UnregisterDroppable,key:i,id:r})),[r]),T.useEffect(()=>{n!==u.current.disabled&&(o({type:Fs.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,o]),{active:a,rect:m,isOver:(l==null?void 0:l.id)===r,node:k,over:l,setNodeRef:R}}function C0(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function xje(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function $w(e){return e!==null&&e>=0}function _je(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Sje(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const OK=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=C0(t,r,n),a=t[s],o=i[s];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},zw={scaleX:1,scaleY:1},Eje=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(s===n){const c=i[a];return c?{x:0,y:n<a?c.top+c.height-(o.top+o.height):c.top-o.top,...zw}:null}const l=Cje(i,s,n);return s>n&&s<=a?{x:0,y:-o.height-l,...zw}:s<n&&s>=a?{x:0,y:o.height+l,...zw}:{x:0,y:0,...zw}};function Cje(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const PK="Sortable",DK=dt.createContext({activeIndex:-1,containerId:PK,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:OK,disabled:{draggable:!1,droppable:!1}});function kje(e){let{children:t,id:n,items:r,strategy:s=OK,disabled:i=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:c,measureDroppableContainers:u}=yje(),f=qb(PK,n),m=o.rect!==null,g=T.useMemo(()=>r.map(R=>typeof R=="object"&&"id"in R?R.id:R),[r]),v=a!=null,b=a?g.indexOf(a.id):-1,w=c?g.indexOf(c.id):-1,x=T.useRef(g),_=!_je(g,x.current),E=w!==-1&&b===-1||_,C=Sje(i);Dl(()=>{_&&v&&u(g)},[_,g,v,u]),T.useEffect(()=>{x.current=g},[g]);const k=T.useMemo(()=>({activeIndex:b,containerId:f,disabled:C,disableTransforms:E,items:g,overIndex:w,useDragOverlay:m,sortedRects:xje(g,l),strategy:s}),[b,f,C.draggable,C.droppable,E,g,w,l,m,s]);return dt.createElement(DK.Provider,{value:k},t)}const Tje=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return C0(n,r,s).indexOf(t)},Aje=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!c||!r||o!==i&&s===a?!1:n?!0:a!==s&&t===l},Rje={duration:200,easing:"ease"},FK="transform",Nje=zy.Transition.toString({property:FK,duration:0,easing:"linear"}),Ije={roleDescription:"sortable"};function jje(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=T.useState(null),o=T.useRef(n);return Dl(()=>{if(!t&&n!==o.current&&r.current){const l=s.current;if(l){const c=Lm(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,s]),T.useEffect(()=>{i&&a(null)},[i]),i}function Mje(e){let{animateLayoutChanges:t=Aje,attributes:n,disabled:r,data:s,getNewIndex:i=Tje,id:a,strategy:o,resizeObserverConfig:l,transition:c=Rje}=e;const{items:u,containerId:f,activeIndex:m,disabled:g,disableTransforms:v,sortedRects:b,overIndex:w,useDragOverlay:x,strategy:_}=T.useContext(DK),E=Oje(r,g),C=u.indexOf(a),k=T.useMemo(()=>({sortable:{containerId:f,index:C,items:u},...s}),[f,s,C,u]),R=T.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:I,node:j,isOver:M,setNodeRef:L}=wje({id:a,data:k,disabled:E.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...l}}),{active:q,activatorEvent:P,activeNodeRect:V,attributes:z,setNodeRef:re,listeners:K,isDragging:ee,over:W,setActivatorNodeRef:se,transform:Y}=gje({id:a,data:k,attributes:{...Ije,...n},disabled:E.draggable}),te=XIe(L,re),Q=!!q,ae=Q&&!v&&$w(m)&&$w(w),xe=!x&&ee,ge=xe&&ae?Y:null,Pe=ae?ge??(o??_)({rects:b,activeNodeRect:V,activeIndex:m,overIndex:w,index:C}):null,Ie=$w(m)&&$w(w)?i({id:a,items:u,activeIndex:m,overIndex:w}):C,Ce=q==null?void 0:q.id,He=T.useRef({activeId:Ce,items:u,newIndex:Ie,containerId:f}),it=u!==He.current.items,Ge=t({active:q,containerId:f,isDragging:ee,isSorting:Q,id:a,index:C,items:u,newIndex:He.current.newIndex,previousItems:He.current.items,previousContainerId:He.current.containerId,transition:c,wasDragging:He.current.activeId!=null}),Re=jje({disabled:!Ge,index:C,node:j,rect:I});return T.useEffect(()=>{Q&&He.current.newIndex!==Ie&&(He.current.newIndex=Ie),f!==He.current.containerId&&(He.current.containerId=f),u!==He.current.items&&(He.current.items=u)},[Q,Ie,f,u]),T.useEffect(()=>{if(Ce===He.current.activeId)return;if(Ce!=null&&He.current.activeId==null){He.current.activeId=Ce;return}const me=setTimeout(()=>{He.current.activeId=Ce},50);return()=>clearTimeout(me)},[Ce]),{active:q,activeIndex:m,attributes:z,data:k,rect:I,index:C,newIndex:Ie,items:u,isOver:M,isSorting:Q,isDragging:ee,listeners:K,node:j,overIndex:w,over:W,setNodeRef:te,setActivatorNodeRef:se,setDroppableNodeRef:L,setDraggableNodeRef:re,transform:Re??Pe,transition:H()};function H(){if(Re||it&&He.current.newIndex===C)return Nje;if(!(xe&&!o3(P)||!c)&&(Q||Ge))return zy.Transition.toString({...c,property:FK})}}function Oje(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function j1(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Pje=[ur.Down,ur.Right,ur.Up,ur.Left],Dje=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:o}}=t;if(Pje.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];i.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const m=s.get(f.id);if(m)switch(e.code){case ur.Down:r.top<m.top&&l.push(f);break;case ur.Up:r.top>m.top&&l.push(f);break;case ur.Left:r.left>m.left&&l.push(f);break;case ur.Right:r.left<m.left&&l.push(f);break}});const c=p3e({collisionRect:r,droppableRects:s,droppableContainers:l});let u=xK(c,"id");if(u===(a==null?void 0:a.id)&&c.length>1&&(u=c[1].id),u!=null){const f=i.get(n.id),m=i.get(u),g=m?s.get(m.id):null,v=m==null?void 0:m.node.current;if(v&&g&&f&&m){const w=vS(v).some((R,I)=>o[I]!==R),x=LK(f,m),_=Fje(f,m),E=w||!x?{x:0,y:0}:{x:_?r.width-g.width:0,y:_?r.height-g.height:0},C={x:g.left,y:g.top};return E.x&&E.y?C:$y(C,E)}}}};function LK(e,t){return!j1(e)||!j1(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Fje(e,t){return!j1(e)||!j1(t)||!LK(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Lje=({id:e,modelDetails:t,buttonsDisabled:n,onMoveToTop:r,onMoveUp:s,onMoveDown:i,isFirst:a,isLast:o})=>{var k,R,I;const{attributes:l,listeners:c,setNodeRef:u,transform:f,transition:m,isDragging:g}=Mje({id:e,disabled:!1}),v={transform:zy.Transform.toString(f),transition:m,zIndex:g?10:void 0},b=new Set(((k=t.metadataSummary)==null?void 0:k.supported_parameters)??[]),w=new Set(((R=t.metadataSummary)==null?void 0:R.input_modalities)??[]),x=b.has("reasoning"),_=b.has("web_search")||b.has("web_search_options"),E=b.has("tools"),C=Array.from(w).some(j=>j!=="text");return p.jsxs("div",{ref:u,style:v,className:ct("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",g&&"shadow-lg border-primary bg-card","cursor-grab active:cursor-grabbing"),"aria-label":`Drag to reorder model ${t.name}`,children:[p.jsx("button",{...l,...c,type:"button",className:ct("p-1 flex-shrink-0","hover:text-foreground"),"aria-hidden":"true",tabIndex:-1,children:p.jsx(bX,{className:"h-5 w-5 text-muted-foreground"})}),p.jsxs("div",{className:"flex-grow min-w-0",children:[p.jsxs(Jt,{className:ct("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:[t.name," ",p.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.providerName,")"]})]}),p.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[x&&p.jsx(dd,{className:"h-3 w-3 text-blue-500"}),_&&p.jsx(ki,{className:"h-3 w-3 text-green-500"}),E&&p.jsx(Cf,{className:"h-3 w-3 text-orange-500"}),C&&p.jsx(Ef,{className:"h-3 w-3 text-purple-500"})]})]}),p.jsxs("div",{className:"flex items-center gap-0.5 ml-auto flex-shrink-0",children:[((I=t.metadataSummary)==null?void 0:I.description)&&p.jsx(sr,{delayDuration:100,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx("span",{className:"p-1 text-muted-foreground hover:text-foreground cursor-default","aria-label":"Model information",children:p.jsx(mR,{className:"h-4 w-4"})})}),p.jsx(cr,{side:"top",align:"end",className:"max-w-xs break-words",children:p.jsx("p",{children:t.metadataSummary.description})})]})}),p.jsx(gn,{tooltipText:"Move to Top",onClick:()=>r(e),disabled:a||n,icon:p.jsx(CY,{}),className:"h-6 w-6"}),p.jsx(gn,{tooltipText:"Move Up",onClick:()=>s(e),disabled:a||n,icon:p.jsx(hY,{}),className:"h-6 w-6"}),p.jsx(gn,{tooltipText:"Move Down",onClick:()=>i(e),disabled:o||n,icon:p.jsx(eF,{}),className:"h-6 w-6"})]})]})},Bje=({setGlobalModelSortOrderFromModule:e})=>{const{dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAvailableModelListItems:s}=gr(mn(M=>({dbProviderConfigs:M.dbProviderConfigs,globalModelSortOrder:M.globalModelSortOrder,isLoading:M.isLoading,getAvailableModelListItems:M.getAvailableModelListItems}))),[i,a]=T.useState(""),[o,l]=T.useState(!1),[c,u]=T.useState(()=>new Set(t.map(M=>M.id))),[f,m]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1});T.useEffect(()=>{u(new Set(t.map(M=>M.id)))},[t]);const g=T.useMemo(()=>{const M=s(),L=new Map(M.map(re=>[re.id,re])),q=new Set;t.forEach(re=>{re.isEnabled&&re.enabledModels&&re.enabledModels.forEach(K=>{q.add(d0(re.id,K))})});const P=M.filter(re=>q.has(re.id)),V=[],z=new Set;return n.forEach(re=>{if(q.has(re)){const K=L.get(re);K&&!z.has(re)&&(V.push(K),z.add(re))}}),P.forEach(re=>{z.has(re.id)||V.push(re)}),V},[t,n,s]),v=T.useMemo(()=>{let M=g;if(c.size!==t.length&&(M=M.filter(q=>c.has(q.providerId))),i.trim()){const q=i.toLowerCase();M=M.filter(P=>P.name.toLowerCase().includes(q)||P.providerName.toLowerCase().includes(q)||P.id.toLowerCase().includes(q))}const L=Object.entries(f).filter(([,q])=>q).map(([q])=>q);return L.length>0&&(M=M.filter(q=>{var z,re;const P=new Set(((z=q.metadataSummary)==null?void 0:z.supported_parameters)??[]),V=new Set(((re=q.metadataSummary)==null?void 0:re.input_modalities)??[]);return L.every(K=>{switch(K){case"reasoning":return P.has("reasoning");case"webSearch":return P.has("web_search")||P.has("web_search_options");case"tools":return P.has("tools");case"multimodal":return Array.from(V).some(ee=>ee!=="text");default:return!0}})})),M},[g,i,c,t.length,f]),b=i.trim().length>0||c.size!==t.length||Object.values(f).some(Boolean),w=T.useMemo(()=>v.map(M=>M.id),[v]),x=T.useCallback(M=>{const{active:L,over:q}=M;if(q&&L.id!==q.id){const P=g.map(ee=>ee.id),V=L.id,z=q.id,re=P.indexOf(V),K=P.indexOf(z);if(re!==-1&&K!==-1){const ee=C0(P,re,K);e(ee)}else console.warn("DND: Could not find dragged items in the full model order. This might happen if the underlying list changed during drag or items are filtered out.")}},[g,e]),_=T.useCallback((M,L)=>{if(b)return;const q=g.map(z=>z.id),P=q.indexOf(M);if(P===-1)return;let V;if(L==="top"){if(P===0)return;const z=q.splice(P,1)[0];q.unshift(z),V=q}else if(L==="up"){if(P===0)return;V=C0(q,P,P-1)}else{if(P===q.length-1)return;V=C0(q,P,P+1)}e(V)},[g,e,b]),E=d3e(v8(d3),v8(c3,{coordinateGetter:Dje})),C=T.useCallback((M,L)=>{u(q=>{const P=new Set(q);return L?P.add(M):P.delete(M),P})},[]),k=M=>{m(L=>({...L,[M]:!L[M]}))},R=c.size!==t.length?1:0,I=Object.values(f).filter(Boolean).length,j=R+I;return r?p.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[p.jsx(dr,{className:"h-8 w-1/3"}),p.jsx(dr,{className:"h-6 w-1/2"}),p.jsx(dr,{className:"h-64 w-full"})]}):p.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[p.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),p.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models to define their display order. Filtering affects the view below. Move buttons (up/down/top) are disabled when filters are active."}),p.jsx(Lf,{}),p.jsxs("div",{className:"space-y-3",children:[p.jsx(Jt,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("div",{className:"relative flex-grow",children:[p.jsx(ki,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),p.jsx(zn,{type:"search",placeholder:"Filter models by name or provider...",value:i,onChange:M=>a(M.target.value),className:"pl-8 w-full h-9",disabled:r})]}),p.jsxs(Ho,{open:o,onOpenChange:l,children:[p.jsx(Go,{asChild:!0,children:p.jsxs(Ct,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:r||t.length===0,children:[p.jsx(fR,{className:"h-4 w-4 mr-1"}),"Filters",j>0&&p.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:j})]})}),p.jsx(Ko,{className:"w-64 p-0",children:p.jsxs("div",{className:"p-2 space-y-3",children:[p.jsxs("div",{children:[p.jsx(Jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),p.jsx(Hi,{className:"h-32 border rounded-md p-1",children:t.map(M=>p.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[p.jsx(Bc,{id:`organizer-provider-filter-${M.id}`,checked:c.has(M.id),onCheckedChange:L=>C(M.id,!!L)}),p.jsxs(Jt,{htmlFor:`organizer-provider-filter-${M.id}`,className:"text-sm font-normal cursor-pointer",children:[M.name," (",M.type,")"]})]},M.id))})]}),p.jsxs("div",{children:[p.jsx(Jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Capabilities"}),p.jsxs("div",{className:"flex flex-wrap gap-1 p-1 border rounded-md",children:[p.jsx(gn,{tooltipText:"Reasoning",icon:p.jsx(dd,{}),onClick:()=>k("reasoning"),variant:f.reasoning?"secondary":"outline",className:ct("h-7 w-auto px-2 text-xs",f.reasoning&&"text-primary"),children:"Reasoning"}),p.jsx(gn,{tooltipText:"Web Search",icon:p.jsx(ki,{}),onClick:()=>k("webSearch"),variant:f.webSearch?"secondary":"outline",className:ct("h-7 w-auto px-2 text-xs",f.webSearch&&"text-primary"),children:"Web"}),p.jsx(gn,{tooltipText:"Tools",icon:p.jsx(Cf,{}),onClick:()=>k("tools"),variant:f.tools?"secondary":"outline",className:ct("h-7 w-auto px-2 text-xs",f.tools&&"text-primary"),children:"Tools"}),p.jsx(gn,{tooltipText:"Multimodal",icon:p.jsx(Ef,{}),onClick:()=>k("multimodal"),variant:f.multimodal?"secondary":"outline",className:ct("h-7 w-auto px-2 text-xs",f.multimodal&&"text-primary"),children:"Multimodal"})]})]})]})})]})]}),p.jsx(Hi,{className:"h-[calc(20*2.75rem+2px)] w-full rounded-md border border-border p-3 bg-background/50",children:v.length>0?p.jsx(hje,{sensors:E,collisionDetection:h3e,onDragEnd:x,children:p.jsx(kje,{items:w,strategy:Eje,children:v.map(M=>p.jsx(Lje,{id:M.id,modelDetails:M,onMoveToTop:()=>_(M.id,"top"),onMoveUp:()=>_(M.id,"up"),onMoveDown:()=>_(M.id,"down"),isFirst:g.findIndex(L=>L.id===M.id)===0,isLast:g.findIndex(L=>L.id===M.id)===g.length-1,buttonsDisabled:b},M.id))})}):p.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:b?"No models match your filters.":"No models enabled globally. Enable models within provider configurations."})})]})]})},Uw=e=>{if(!e)return"N/A";const t=parseFloat(e);return isNaN(t)?"N/A":`$${(t/1e3).toFixed(4)} / 1K tokens`},Za=(e,t,n=!1,r="secondary")=>t==null||String(t).trim()===""?null:p.jsxs(ts,{children:[p.jsx(Ln,{className:"font-medium text-xs w-1/3 py-1.5 px-3",children:e}),p.jsx(Ln,{className:"text-xs py-1.5 px-3 break-all",children:n?p.jsx(Ap,{variant:r,className:"text-xs",children:String(t)}):Array.isArray(t)?p.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((s,i)=>p.jsx(Ap,{variant:"outline",className:"text-xs",children:String(s)},i))}):String(t)})]}),$je=({modelId:e})=>{var g,v,b,w,x,_,E,C,k,R,I,j;const{createAiModelConfig:t,dbProviderConfigs:n,dbApiKeys:r,updateProviderConfig:s,isLoading:i}=gr(mn(M=>({createAiModelConfig:M.createAiModelConfig,dbProviderConfigs:M.dbProviderConfigs,dbApiKeys:M.dbApiKeys,updateProviderConfig:M.updateProviderConfig,isLoading:M.isLoading}))),a=T.useMemo(()=>{if(!e)return;const{providerId:M,modelId:L}=jo(e);if(!M||!L)return;const q=n.find(V=>V.id===M);if(!q)return;const P=r.find(V=>V.id===q.apiKeyId);return t(q,L,P==null?void 0:P.value)},[e,n,r,t]),o=a==null?void 0:a.metadata,l=T.useCallback(async()=>{if(!a||!e)return;const{providerId:M,modelId:L}=jo(e);if(!M||!L)return;const q=n.find(re=>re.id===M);if(!q){Le.error("Provider configuration not found.");return}const P=new Set(q.enabledModels??[]),V=P.has(L);V?P.delete(L):P.add(L);const z=Array.from(P);try{await s(q.id,{enabledModels:z}),Le.success(`Model "${a.name}" ${V?"disabled":"enabled"}.`)}catch{Le.error("Failed to update model status.")}},[a,e,n,s]);if(i)return p.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[p.jsx(dr,{className:"h-8 w-3/4 flex-shrink-0"}),p.jsx(dr,{className:"h-4 w-1/2 flex-shrink-0"}),p.jsxs("div",{className:"flex-grow space-y-2",children:[p.jsx(dr,{className:"h-10 w-full"}),p.jsx(dr,{className:"h-10 w-full"}),p.jsx(dr,{className:"h-10 w-full"}),p.jsx(dr,{className:"h-10 w-full"})]})]});if(!e)return p.jsxs("div",{className:"p-4 text-center text-muted-foreground h-full flex flex-col items-center justify-center",children:[p.jsx(Ac,{className:"mx-auto h-10 w-10 mb-2 text-amber-500"}),p.jsx("p",{className:"text-sm",children:'No model selected. Click a model in the "Configuration" or "Browse Models" tab to view its details.'})]});if(!a||!o)return p.jsxs("div",{className:"p-4 text-center text-destructive h-full flex flex-col items-center justify-center",children:[p.jsx(Ac,{className:"mx-auto h-10 w-10 mb-2"}),p.jsxs("p",{className:"text-sm",children:["Details not available for model: ",e,". It might be misconfigured or no longer available."]})]});const{providerId:c,modelId:u}=jo(e),f=n.find(M=>M.id===c),m=u!=null&&(f==null?void 0:f.isEnabled)&&((g=f==null?void 0:f.enabledModels)==null?void 0:g.includes(u))===!0;return p.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[p.jsxs("div",{className:"flex items-center justify-between flex-shrink-0",children:[p.jsxs("h4",{className:"text-lg font-semibold text-card-foreground truncate",children:[a.name,p.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.providerName,")"]})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx(Jt,{htmlFor:`enable-details-${u}`,className:"text-xs",children:m?"Enabled":"Disabled"}),p.jsx(Bu,{id:`enable-details-${u}`,checked:m,onCheckedChange:l,disabled:!(f!=null&&f.isEnabled),"aria-label":`Enable model ${a.name}`})]})]}),o.description&&p.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:o.description}),p.jsx(Hi,{className:"flex-grow border rounded-md bg-background/30",children:p.jsxs(Qf,{children:[p.jsxs(WTe,{className:"py-2 text-xs",children:["Model ID: ",o.id]}),p.jsxs(eh,{children:[Za("Context Length",((v=o.top_provider)==null?void 0:v.context_length)??o.context_length),Za("Max Completion Tokens",(b=o.top_provider)==null?void 0:b.max_completion_tokens),Za("Input Modalities",(w=o.architecture)==null?void 0:w.input_modalities),Za("Output Modalities",(x=o.architecture)==null?void 0:x.output_modalities),Za("Tokenizer",(_=o.architecture)==null?void 0:_.tokenizer,!0),Za("Instruct Type",(E=o.architecture)==null?void 0:E.instruct_type,!0),Za("Pricing (Prompt)",Uw((C=o.pricing)==null?void 0:C.prompt)),Za("Pricing (Completion)",Uw((k=o.pricing)==null?void 0:k.completion)),Za("Pricing (Image)",Uw((R=o.pricing)==null?void 0:R.image)),Za("Pricing (Request)",Uw((I=o.pricing)==null?void 0:I.request)),Za("Supported Parameters",o.supported_parameters),Za("Moderated",(j=o.top_provider)!=null&&j.is_moderated?p.jsx(O1,{className:"h-4 w-4 text-green-500"}):"No")]})]})})]})},zje=()=>{const{apiKeys:e,addApiKey:t,deleteApiKey:n,isLoading:r}=gr(mn(m=>({apiKeys:m.dbApiKeys,addApiKey:m.addApiKey,deleteApiKey:m.deleteApiKey,isLoading:m.isLoading}))),[s,i]=T.useState(!1),[a,o]=T.useState(!1),[l,c]=T.useState({}),u=T.useCallback(async(m,g,v)=>{o(!0);try{await t(m,g,v),i(!1)}catch(b){console.error("Failed to add API key (from component):",b)}finally{o(!1)}},[t]),f=T.useCallback(async(m,g)=>{if(window.confirm(`Are you sure you want to delete the API key "${g}"? This will unlink it from any providers using it.`)){c(v=>({...v,[m]:!0}));try{await n(m)}catch(v){console.error("Failed to delete API key (from component):",v)}finally{c(v=>({...v,[m]:!1}))}}},[n]);return p.jsxs("div",{className:"space-y-6 p-1",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),p.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!s&&p.jsxs(Ct,{onClick:()=>i(!0),variant:"outline",className:"w-full mb-4",disabled:r,children:[p.jsx(sm,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),s&&p.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[p.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),p.jsx(pV,{onSave:u,onCancel:()=>i(!1),disabled:a})]}),p.jsxs("div",{children:[p.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),r&&!s?p.jsxs("div",{className:"space-y-2",children:[p.jsx(dr,{className:"h-10 w-full"}),p.jsx(dr,{className:"h-10 w-full"})]}):(e||[]).length===0&&!s?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):p.jsx("div",{className:"border rounded-md overflow-hidden",children:p.jsxs(Qf,{children:[p.jsx(Om,{children:p.jsxs(ts,{children:[p.jsx(Lr,{children:"Name"}),p.jsx(Lr,{children:"Provider Type"}),p.jsx(Lr,{children:"Created"}),p.jsx(Lr,{className:"text-right",children:"Actions"})]})}),p.jsx(eh,{children:(e||[]).map(m=>{const g=l[m.id];return p.jsxs(ts,{className:g?"opacity-50":"",children:[p.jsx(Ln,{className:"font-medium",children:m.name||"Unnamed Key"}),p.jsx(Ln,{children:m.providerId||"Unknown"}),p.jsx(Ln,{className:"text-xs text-muted-foreground",children:cA(new Date(m.createdAt),"PPp")}),p.jsx(Ln,{className:"text-right",children:p.jsx(gn,{tooltipText:"Delete Key",onClick:()=>f(m.id,m.name||"Unnamed Key"),disabled:g,"aria-label":`Delete key ${m.name||"Unnamed Key"}`,icon:g?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Aa,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})})]},m.id)})})]})})]})]})},Uje=dt.memo(zje),qje=({onSelectModelForDetails:e})=>{const[t,n]=T.useState(null),[r,s]=T.useState(null),i=T.useCallback(L=>{if(L){n(L);const q=L.querySelector("[data-radix-scroll-area-viewport]");if(q)s(q);else{const P=new MutationObserver(()=>{const V=L.querySelector("[data-radix-scroll-area-viewport]");V&&(s(V),P.disconnect())});return P.observe(L,{childList:!0,subtree:!0}),()=>P.disconnect()}}else n(null),s(null)},[]),{getAvailableModelListItems:a,isLoading:o,dbProviderConfigs:l}=gr(mn(L=>({getAvailableModelListItems:L.getAvailableModelListItems,isLoading:L.isLoading,dbProviderConfigs:L.dbProviderConfigs}))),[c,u]=T.useState(""),[f,m]=T.useState(!1),[g,v]=T.useState(()=>new Set(l.map(L=>L.id))),[b,w]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),x=T.useMemo(()=>a(),[a]);T.useEffect(()=>{v(new Set(l.map(L=>L.id)))},[l]);const _=T.useMemo(()=>{let L=x;if(g.size!==l.length&&(L=L.filter(P=>g.has(P.providerId))),c.trim()){const P=c.toLowerCase();L=L.filter(V=>V.name.toLowerCase().includes(P)||V.providerName.toLowerCase().includes(P)||V.id.toLowerCase().includes(P))}const q=Object.entries(b).filter(([,P])=>P).map(([P])=>P);return q.length>0&&(L=L.filter(P=>{var re,K;const V=new Set(((re=P.metadataSummary)==null?void 0:re.supported_parameters)??[]),z=new Set(((K=P.metadataSummary)==null?void 0:K.input_modalities)??[]);return q.every(ee=>{switch(ee){case"reasoning":return V.has("reasoning");case"webSearch":return V.has("web_search")||V.has("web_search_options");case"tools":return V.has("tools");case"multimodal":return Array.from(z).some(W=>W!=="text");default:return!0}})})),L.sort((P,V)=>{const z=P.providerName.localeCompare(V.providerName);return z!==0?z:P.name.localeCompare(V.name)})},[x,c,g,l.length,b]),E=$I({count:_.length,getScrollElement:()=>r,estimateSize:()=>48,overscan:10}),C=T.useCallback((L,q)=>{v(P=>{const V=new Set(P);return q?V.add(L):V.delete(L),V})},[]),k=L=>{w(q=>({...q,[L]:!q[L]}))},R=L=>{e(L)},I=g.size!==l.length?1:0,j=Object.values(b).filter(Boolean).length,M=I+j;return o?p.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[p.jsx(dr,{className:"h-9 w-full flex-shrink-0"}),p.jsx(dr,{className:"h-full w-full flex-grow"})]}):p.jsxs("div",{className:"space-y-3 h-full flex flex-col",children:[p.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[p.jsxs("div",{className:"relative flex-grow",children:[p.jsx(ki,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),p.jsx(zn,{type:"search",placeholder:"Filter models by name or provider...",value:c,onChange:L=>u(L.target.value),className:"pl-8 w-full h-9",disabled:o})]}),p.jsxs(Ho,{open:f,onOpenChange:m,children:[p.jsx(Go,{asChild:!0,children:p.jsxs(Ct,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:o||l.length===0,children:[p.jsx(fR,{className:"h-4 w-4 mr-1"}),"Filters",M>0&&p.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:M})]})}),p.jsx(Ko,{className:"w-64 p-0",children:p.jsxs("div",{className:"p-2 space-y-3",children:[p.jsxs("div",{children:[p.jsx(Jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),p.jsx(Hi,{className:"h-32 border rounded-md p-1",children:l.map(L=>p.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[p.jsx(Bc,{id:`model-browser-provider-filter-${L.id}`,checked:g.has(L.id),onCheckedChange:q=>C(L.id,!!q)}),p.jsxs(Jt,{htmlFor:`model-browser-provider-filter-${L.id}`,className:"text-sm font-normal cursor-pointer",children:[L.name," (",L.type,")"]})]},L.id))})]}),p.jsxs("div",{children:[p.jsx(Jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Capabilities"}),p.jsxs("div",{className:"flex flex-wrap gap-1 p-1 border rounded-md",children:[p.jsx(gn,{tooltipText:"Reasoning",icon:p.jsx(dd,{}),onClick:()=>k("reasoning"),variant:b.reasoning?"secondary":"outline",className:ct("h-7 w-auto px-2 text-xs",b.reasoning&&"text-primary"),children:"Reasoning"}),p.jsx(gn,{tooltipText:"Web Search",icon:p.jsx(ki,{}),onClick:()=>k("webSearch"),variant:b.webSearch?"secondary":"outline",className:ct("h-7 w-auto px-2 text-xs",b.webSearch&&"text-primary"),children:"Web"}),p.jsx(gn,{tooltipText:"Tools",icon:p.jsx(Cf,{}),onClick:()=>k("tools"),variant:b.tools?"secondary":"outline",className:ct("h-7 w-auto px-2 text-xs",b.tools&&"text-primary"),children:"Tools"}),p.jsx(gn,{tooltipText:"Multimodal",icon:p.jsx(Ef,{}),onClick:()=>k("multimodal"),variant:b.multimodal?"secondary":"outline",className:ct("h-7 w-auto px-2 text-xs",b.multimodal&&"text-primary"),children:"Multimodal"})]})]})]})})]})]}),p.jsxs(Hi,{className:"flex-grow border rounded-md bg-background/50 h-[calc(15*2.5rem+2px)]",ref:i,children:[r&&p.jsx("div",{style:{height:`${E.getTotalSize()}px`,width:"100%",position:"relative"},children:_.length===0&&!o?p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match your filters."}):E.getVirtualItems().map(L=>{var P;const q=_[L.index];return q?p.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${L.size}px`,transform:`translateY(${L.start}px)`},className:"p-1",children:p.jsx(sr,{delayDuration:300,children:p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsxs("button",{className:"w-full text-left p-1.5 rounded hover:bg-muted/50 flex flex-col",onClick:()=>R(q.id),children:[p.jsx("span",{className:"text-sm font-medium truncate",children:q.name}),p.jsx("span",{className:"text-xs text-muted-foreground truncate",children:q.providerName})]})}),((P=q.metadataSummary)==null?void 0:P.description)&&p.jsx(cr,{side:"bottom",align:"start",className:"max-w-xs",children:p.jsx("p",{children:q.metadataSummary.description})})]})})},q.id):null})}),!r&&!o&&p.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},Vje=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:s,providerFetchStatus:i,dbProviderConfigs:a,apiKeys:o,isLoading:l}=gr(mn(b=>({addDbProviderConfig:b.addProviderConfig,updateDbProviderConfig:b.updateProviderConfig,deleteDbProviderConfig:b.deleteProviderConfig,fetchModels:b.fetchModels,providerFetchStatus:b.providerFetchStatus,dbProviderConfigs:b.dbProviderConfigs,apiKeys:b.dbApiKeys,isLoading:b.isLoading}))),[c,u]=T.useState(!1),f=()=>u(!0),m=T.useCallback(()=>u(!1),[]),g=T.useCallback(async b=>{await s(b)},[s]),v=T.useMemo(()=>a||[],[a]);return p.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),p.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),p.jsx("div",{className:"flex-shrink-0",children:c?p.jsx(xV,{apiKeys:o||[],onAddProvider:t,onCancel:m}):p.jsxs(Ct,{onClick:f,variant:"outline",className:"w-full",disabled:l,children:[p.jsx(sm,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),p.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:p.jsxs("div",{className:"space-y-2",children:[l&&!c?p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[p.jsx(dr,{className:"h-24 w-full"}),p.jsx(dr,{className:"h-24 w-full"}),p.jsx(dr,{className:"h-24 w-full"})]}):p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:v.map(b=>p.jsx(YIe,{provider:b,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:g,fetchStatus:i[b.id]||"idle",onSelectModelForDetails:e},b.id))}),!l&&v.length===0&&!c&&p.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},Hje=({setGlobalModelSortOrderFromModule:e})=>{const{selectedModelForDetails:t,setSelectedModelForDetails:n}=gr(mn(o=>({selectedModelForDetails:o._selectedModelForDetails,setSelectedModelForDetails:o.setSelectedModelForDetails}))),[r,s]=T.useState("providers-config"),i=T.useCallback(o=>{n(o),o&&s("providers-details-current")},[n,s]),a=T.useMemo(()=>[{value:"providers-config",label:"Configuration",content:p.jsx(Vje,{onSelectModelForDetails:i})},{value:"providers-order",label:"Model Order",content:p.jsx(Bje,{setGlobalModelSortOrderFromModule:e})},{value:"api-keys",label:"API Keys",content:p.jsx(Uje,{})},{value:"providers-details-current",label:"Selected Model",content:p.jsx($je,{modelId:t})},{value:"providers-browse-all",label:"Browse Models",content:p.jsx(qje,{onSelectModelForDetails:i})}],[t,i,e]);return p.jsx(Vc,{tabs:a,initialValue:r,onValueChange:s,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},Gje=dt.memo(Hje);class Kje{constructor(){Ne(this,"id","core-provider-settings");Ne(this,"modApiRef",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"setGlobalModelSortOrderFromModule",t=>{var n;(n=this.modApiRef)==null||n.emit(Hn.setGlobalModelSortOrderRequest,{ids:t})})}async initialize(t){this.modApiRef=t}register(t){this.modApiRef=t,t.registerSettingsTab({id:"providers",title:"Providers & Models",order:20,component:()=>dt.createElement(Gje,{setGlobalModelSortOrderFromModule:this.setGlobalModelSortOrderFromModule})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.modApiRef=null}}const Wje=D.object({globalSystemPrompt:D.string()});function Zje({field:e}){return p.jsx(p.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?p.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const Yje=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t}=ir(mn(r=>({globalSystemPrompt:r.globalSystemPrompt,setGlobalSystemPrompt:r.setGlobalSystemPrompt}))),n=ri({defaultValues:{globalSystemPrompt:e??""},validators:{onChangeAsync:Wje,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.globalSystemPrompt),Le.success("Global system prompt updated!")}catch(s){Le.error("Failed to update prompt. Please try again."),console.error("Error submitting assistant prompt form:",s)}}});return T.useEffect(()=>{n.state.values.globalSystemPrompt!==(e??"")&&n.reset({globalSystemPrompt:e??""})},[e,n]),p.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-4",children:[p.jsx("div",{children:p.jsx(n.Field,{name:"globalSystemPrompt",children:r=>p.jsxs(p.Fragment,{children:[p.jsx(Jt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Global System Prompt"}),p.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),p.jsx(Ad,{id:r.name,placeholder:"Enter default system instructions for the assistant...",value:r.state.value,onBlur:r.handleBlur,onChange:s=>r.handleChange(s.target.value),rows:6,className:r.state.meta.errors.length?"border-destructive":""}),p.jsx(Zje,{field:r})]})})}),p.jsx("div",{className:"flex justify-end pt-2",children:p.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>p.jsx(Ct,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Prompt"})})})]})},Xje=D.object({temperature:D.number().min(0).max(1),topP:D.number().min(0).max(1),maxTokens:D.number().min(1).nullable(),topK:D.number().min(1).nullable(),presencePenalty:D.number().min(-2).max(2),frequencyPenalty:D.number().min(-2).max(2)}),Jje=()=>{const e=ir(mn(n=>({temperature:n.temperature,setTemperature:n.setTemperature,topP:n.topP,setTopP:n.setTopP,maxTokens:n.maxTokens,setMaxTokens:n.setMaxTokens,topK:n.topK,setTopK:n.setTopK,presencePenalty:n.presencePenalty,setPresencePenalty:n.setPresencePenalty,frequencyPenalty:n.frequencyPenalty,setFrequencyPenalty:n.setFrequencyPenalty}))),t=ri({defaultValues:{temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0},validators:{onChangeAsync:Xje,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setTemperature(n.temperature),e.setTopP(n.topP),e.setMaxTokens(n.maxTokens??null),e.setTopK(n.topK??null),e.setPresencePenalty(n.presencePenalty),e.setFrequencyPenalty(n.frequencyPenalty),Le.success("Assistant parameters updated!")}catch(r){Le.error("Failed to update parameters."),console.error("Error submitting parameters form:",r)}}});return T.useEffect(()=>{t.reset({temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0})},[e.temperature,e.topP,e.maxTokens,e.topK,e.presencePenalty,e.frequencyPenalty,t]),p.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-6",children:[p.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),p.jsx(Ro,{form:t,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),p.jsx(Ro,{form:t,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[p.jsx(tm,{form:t,name:"maxTokens",label:"Max Tokens",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"}),p.jsx(tm,{form:t,name:"topK",label:"Top K",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"})]}),p.jsx(Ro,{form:t,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),p.jsx(Ro,{form:t,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),p.jsxs("div",{className:"flex justify-end space-x-2",children:[p.jsx(Ct,{type:"button",variant:"ghost",onClick:()=>t.reset(),disabled:!t.state.isDirty,children:"Reset"}),p.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting],children:([n,r])=>p.jsx(Ct,{type:"submit",disabled:!n||r,children:r?"Saving...":"Save Changes"})})]})]})},Qje=D.object({toolMaxSteps:D.number({required_error:"Max steps is required",invalid_type_error:"Max steps must be a number"}).min(1,"Must be at least 1").max(20,"Cannot exceed 20")});function eMe({field:e}){return p.jsx(p.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?p.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const tMe=()=>{const{toolMaxSteps:e,setToolMaxSteps:t}=ir(mn(r=>({toolMaxSteps:r.toolMaxSteps,setToolMaxSteps:r.setToolMaxSteps}))),n=ri({defaultValues:{toolMaxSteps:e??5},validators:{onChangeAsync:Qje,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.toolMaxSteps),Le.success("Tool settings updated!")}catch(s){Le.error("Failed to update tool settings."),console.error("Error submitting tool settings form:",s)}}});return T.useEffect(()=>{n.state.values.toolMaxSteps!==(e??5)&&n.reset({toolMaxSteps:e??5})},[e,n]),p.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-4",children:[p.jsx(n.Field,{name:"toolMaxSteps",children:r=>p.jsxs("div",{children:[p.jsx(Jt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),p.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),p.jsx(zn,{id:r.name,type:"number",min:1,max:20,step:1,value:r.state.value,onBlur:r.handleBlur,onChange:s=>{const i=s.target.valueAsNumber;isNaN(i)?s.target.value===""&&r.handleChange(void 0):r.handleChange(i)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),p.jsx(eMe,{field:r})]})}),p.jsx("div",{className:"flex justify-end pt-2",children:p.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>p.jsx(Ct,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Tool Settings"})})})]})},nMe=D.object({autoTitleEnabled:D.boolean(),autoTitleModelId:D.string().nullable(),autoTitlePromptMaxLength:D.number().min(100).max(4e3),autoTitleIncludeFiles:D.boolean(),autoTitleIncludeRules:D.boolean()});function e0({field:e}){return p.jsx(p.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?p.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const rMe=()=>{const e=ir(mn(r=>({autoTitleEnabled:r.autoTitleEnabled,setAutoTitleEnabled:r.setAutoTitleEnabled,autoTitleModelId:r.autoTitleModelId,setAutoTitleModelId:r.setAutoTitleModelId,autoTitlePromptMaxLength:r.autoTitlePromptMaxLength,setAutoTitlePromptMaxLength:r.setAutoTitlePromptMaxLength,autoTitleIncludeFiles:r.autoTitleIncludeFiles,setAutoTitleIncludeFiles:r.setAutoTitleIncludeFiles,autoTitleIncludeRules:r.autoTitleIncludeRules,setAutoTitleIncludeRules:r.setAutoTitleIncludeRules}))),t=ri({defaultValues:{autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1},validators:{onChangeAsync:nMe,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{e.setAutoTitleEnabled(r.autoTitleEnabled),e.setAutoTitleModelId(r.autoTitleModelId??null),e.setAutoTitlePromptMaxLength(r.autoTitlePromptMaxLength),e.setAutoTitleIncludeFiles(r.autoTitleIncludeFiles),e.setAutoTitleIncludeRules(r.autoTitleIncludeRules),Le.success("Auto-title settings updated!")}catch(s){Le.error("Failed to update auto-title settings."),console.error("Error submitting auto-title settings form:",s)}}});T.useEffect(()=>{t.reset({autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1})},[e.autoTitleEnabled,e.autoTitleModelId,e.autoTitlePromptMaxLength,e.autoTitleIncludeFiles,e.autoTitleIncludeRules,t]);const n=t.state.values.autoTitleEnabled;return p.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),t.handleSubmit()},className:"space-y-4",children:[p.jsx(t.Field,{name:"autoTitleEnabled",children:r=>p.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[p.jsx(Bu,{id:r.name,checked:r.state.value,onCheckedChange:r.handleChange,onBlur:r.handleBlur,"aria-labelledby":`${r.name}-label`}),p.jsx(Jt,{id:`${r.name}-label`,htmlFor:r.name,children:"Enable Auto-Title for New Chats"}),p.jsx(e0,{field:r})]})}),n&&p.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-muted ml-2",children:[p.jsx(t.Field,{name:"autoTitleModelId",children:r=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:r.name,children:"Model for Title Generation"}),p.jsx(r3,{value:r.state.value,onChange:r.handleChange,className:`w-full ${r.state.meta.errors.length?"border-destructive":""}`}),p.jsx("p",{className:"text-xs text-muted-foreground",children:"Select a fast and capable model for generating concise titles."}),p.jsx(e0,{field:r})]})}),p.jsx(t.Field,{name:"autoTitlePromptMaxLength",children:r=>p.jsxs("div",{className:"space-y-1.5",children:[p.jsx(Jt,{htmlFor:r.name,children:"Max Prompt Length for Title Generation (Chars)"}),p.jsx(zn,{id:r.name,type:"number",min:100,max:4e3,step:10,value:r.state.value,onBlur:r.handleBlur,onChange:s=>{const i=s.target.valueAsNumber;isNaN(i)?s.target.value===""&&r.handleChange(void 0):r.handleChange(i)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),p.jsx("p",{className:"text-xs text-muted-foreground",children:"Limits the initial prompt length sent for title generation (100-4000)."}),p.jsx(e0,{field:r})]})}),p.jsx(t.Field,{name:"autoTitleIncludeFiles",children:r=>p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx(Bu,{id:r.name,checked:r.state.value,onCheckedChange:r.handleChange,onBlur:r.handleBlur,"aria-labelledby":`${r.name}-label`}),p.jsx(Jt,{id:`${r.name}-label`,htmlFor:r.name,children:"Include file names/types in title prompt"}),p.jsx(e0,{field:r})]})}),p.jsx(t.Field,{name:"autoTitleIncludeRules",children:r=>p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx(Bu,{id:r.name,checked:r.state.value,onCheckedChange:r.handleChange,onBlur:r.handleBlur,"aria-labelledby":`${r.name}-label`}),p.jsx(Jt,{id:`${r.name}-label`,htmlFor:r.name,children:"Include active rules in title prompt"}),p.jsx(e0,{field:r})]})})]}),p.jsx("div",{className:"flex justify-end pt-2",children:p.jsx(t.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>p.jsx(Ct,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Title Settings"})})})]})},sMe=()=>{const{resetAssistantSettings:e}=ir(mn(r=>({resetAssistantSettings:r.resetAssistantSettings}))),t=()=>{window.confirm("Are you sure you want to reset all Assistant settings (Prompt, Parameters, Tools, Auto-Title) to their defaults?")&&e()},n=T.useMemo(()=>[{value:"prompt",label:"System Prompt",content:p.jsx(Yje,{})},{value:"parameters",label:"Parameters",content:p.jsx(Jje,{})},{value:"tools",label:"Tools",content:p.jsx(tMe,{})},{value:"titles",label:"Auto-Titles",content:p.jsx(rMe,{})}],[]);return p.jsxs("div",{className:"space-y-6 p-1 h-full flex flex-col",children:[p.jsx(Vc,{tabs:n,defaultValue:"prompt",className:"flex-grow",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4 flex-grow overflow-y-auto",scrollable:!0}),p.jsx(Lf,{className:"mt-auto"}),p.jsx("div",{className:"flex justify-end pt-4 flex-shrink-0",children:p.jsxs(Ct,{variant:"outline",size:"sm",onClick:t,children:[p.jsx(yR,{className:"mr-2 h-4 w-4"}),"Reset All Assistant Settings"]})})]})},iMe=dt.memo(sMe);class aMe{constructor(){Ne(this,"id","core-settings-assistant");Ne(this,"unregisterCallback",null);Ne(this,"modApiRef",null);Ne(this,"eventUnsubscribers",[]);Ne(this,"isVisible",!1)}async initialize(t){this.modApiRef=t,this.isVisible=ir.getState().enableAdvancedSettings;const n=t.on(Qt.enableAdvancedSettingsChanged,r=>{typeof r=="object"&&r&&"enabled"in r&&this.isVisible!==r.enabled&&(this.isVisible=r.enabled,this.reregisterTab())});this.eventUnsubscribers.push(n)}reregisterTab(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef&&this.register(this.modApiRef)}register(t){this.modApiRef=t,this.isVisible?this.unregisterCallback||(this.unregisterCallback=t.registerSettingsTab({id:"assistant",title:"Assistant",component:iMe,order:40})):this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const oMe=D.object({importSettings:D.boolean(),importApiKeys:D.boolean(),importProviderConfigs:D.boolean(),importProjects:D.boolean(),importConversations:D.boolean(),importRulesAndTags:D.boolean(),importMods:D.boolean(),importSyncRepos:D.boolean()}),lMe=D.object({importSettings:D.boolean(),importApiKeys:D.boolean(),importProviderConfigs:D.boolean(),importProjects:D.boolean(),importConversations:D.boolean(),importRulesAndTags:D.boolean(),importMods:D.boolean(),importSyncRepos:D.boolean()}),cMe=()=>{const{importConversation:e,exportAllConversations:t}=br(mn(j=>({importConversation:j.importConversation,exportAllConversations:j.exportAllConversations}))),n=T.useRef(null),r=T.useRef(null),[s,i]=T.useState(!1),[a,o]=T.useState(!1),[l,c]=T.useState(!1),[u,f]=T.useState(!1),[m,g]=T.useState(!1),v=ri({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0},validators:{onChange:oMe}}),b=ri({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0},validators:{onChange:lMe}}),w=()=>{var j;(j=n.current)==null||j.click()},x=()=>{var j;(j=r.current)==null||j.click()},_=T.useCallback(async j=>{var L;const M=(L=j.target.files)==null?void 0:L[0];if(M){i(!0);try{await e(M)}catch(q){console.error("Import failed (from component):",q)}finally{n.current&&(n.current.value=""),i(!1)}}},[e]),E=T.useCallback(async j=>{var L;const M=(L=j.target.files)==null?void 0:L[0];if(M){if(!window.confirm("Importing this file will OVERWRITE existing data for the selected categories. Are you sure you want to proceed?")){r.current&&(r.current.value="");return}g(!0);try{await fp.importFullConfiguration(M,v.state.values)}catch(q){console.error("Full import failed (from component):",q)}finally{r.current&&(r.current.value=""),g(!1)}}},[v]),C=T.useCallback(async()=>{o(!0);try{await t()}catch(j){console.error("Export all failed (from component):",j)}finally{o(!1)}},[t]),k=T.useCallback(async()=>{f(!0);try{await fp.exportFullConfiguration(b.state.values)}catch(j){console.error("Full export failed (from component):",j)}finally{f(!1)}},[b]),R=T.useCallback(async()=>{if(window.confirm(` ARE YOU ABSOLUTELY SURE? 

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){c(!0);try{await Rt.clearAllData(),Le.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(j){const M="Failed to clear all data";console.error(M,j),Le.error(`${M}: ${j instanceof Error?j.message:String(j)}`),c(!1)}}},[]),I=(j,M,L,q,P,V)=>{const z=`${V}-${M}-checkbox`;return p.jsx(j.Field,{name:M,children:re=>p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx(Bc,{id:z,checked:re.state.value,onCheckedChange:K=>re.handleChange(!!K),disabled:P}),p.jsxs(Jt,{htmlFor:z,className:"text-sm font-normal flex items-center gap-1.5",children:[p.jsx(q,{className:"h-4 w-4 text-muted-foreground"})," ",L]})]})},M)};return p.jsxs("div",{className:"space-y-6 p-1",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-medium mb-2",children:"Single Conversation"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{className:"border p-4 rounded-md space-y-2",children:[p.jsx(Jt,{className:"font-semibold",children:"Import Conversation"}),p.jsx("p",{className:"text-xs text-muted-foreground",children:"Import a previously exported single conversation (.json file)."}),p.jsx("input",{type:"file",ref:n,onChange:_,accept:".json",className:"hidden",id:"import-file-input",disabled:s}),p.jsxs(Ct,{onClick:w,variant:"outline",size:"sm",disabled:s,children:[s?p.jsx(Pn,{className:"mr-2 h-4 w-4 animate-spin"}):p.jsx(xJ,{className:"mr-2 h-4 w-4"}),s?"Importing...":"Select File..."]})]}),p.jsxs("div",{className:"border p-4 rounded-md space-y-2",children:[p.jsx(Jt,{className:"font-semibold",children:"Export All Conversations"}),p.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all conversations and messages into a single JSON file."}),p.jsxs(Ct,{onClick:C,variant:"outline",size:"sm",disabled:a,children:[a?p.jsx(Pn,{className:"mr-2 h-4 w-4 animate-spin"}):p.jsx(vf,{className:"mr-2 h-4 w-4"}),a?"Exporting...":"Export All Chats"]})]})]})]}),p.jsx(Lf,{}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-medium mb-2",children:"Full Configuration"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{className:"border p-4 rounded-md space-y-3",children:[p.jsx(Jt,{className:"font-semibold",children:"Import Full Configuration"}),p.jsxs("p",{className:"text-xs text-muted-foreground",children:["Import a full configuration backup (.json). Select which data types to import below."," ",p.jsx("strong",{className:"text-destructive",children:"This will overwrite existing data for selected types."})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[I(v,"importSettings","Settings",ST,m,"import"),I(v,"importApiKeys","API Keys",k0,m,"import"),I(v,"importProviderConfigs","Providers",ox,m,"import"),I(v,"importProjects","Projects",S4,m,"import"),I(v,"importConversations","Conversations",_T,m,"import"),I(v,"importRulesAndTags","Rules & Tags",ET,m,"import"),I(v,"importMods","Mods",k4,m,"import"),I(v,"importSyncRepos","Sync Repos",qu,m,"import")]}),p.jsx("input",{type:"file",ref:r,onChange:E,accept:".json",className:"hidden",id:"full-import-file-input",disabled:m}),p.jsxs(Ct,{onClick:x,variant:"outline",size:"sm",disabled:m,className:"mt-2",children:[m?p.jsx(Pn,{className:"mr-2 h-4 w-4 animate-spin"}):p.jsx(rX,{className:"mr-2 h-4 w-4"}),m?"Importing...":"Select Full Backup File..."]})]}),p.jsxs("div",{className:"border p-4 rounded-md space-y-3",children:[p.jsx(Jt,{className:"font-semibold",children:"Export Full Configuration"}),p.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all settings, providers, keys, projects, conversations, rules, tags, mods, etc., into a single backup file. Select which data types to include."}),p.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[I(b,"importSettings","Settings",ST,u,"export"),I(b,"importApiKeys","API Keys",k0,u,"export"),I(b,"importProviderConfigs","Providers",ox,u,"export"),I(b,"importProjects","Projects",S4,u,"export"),I(b,"importConversations","Conversations",_T,u,"export"),I(b,"importRulesAndTags","Rules & Tags",ET,u,"export"),I(b,"importMods","Mods",k4,u,"export"),I(b,"importSyncRepos","Sync Repos",qu,u,"export")]}),p.jsxs(Ct,{onClick:k,variant:"outline",size:"sm",disabled:u,className:"mt-2",children:[u?p.jsx(Pn,{className:"mr-2 h-4 w-4 animate-spin"}):p.jsx(ZY,{className:"mr-2 h-4 w-4"}),u?"Exporting...":"Export Full Backup"]})]})]})]}),p.jsx(Lf,{}),p.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[p.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),p.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),p.jsxs(Ct,{onClick:R,variant:"destructive",disabled:l,children:[l?p.jsx(Pn,{className:"mr-2 h-4 w-4 animate-spin"}):p.jsx(Aa,{className:"mr-2 h-4 w-4"}),l?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},uMe=dt.memo(cMe);class dMe{constructor(){Ne(this,"id","core-settings-data");Ne(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"data",title:"Data",component:uMe,order:70})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const fMe=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:s,isLoading:i}=cd(mn(R=>({loadedMods:R.loadedMods,addDbMod:R.addDbMod,updateDbMod:R.updateDbMod,deleteDbMod:R.deleteDbMod,dbMods:R.dbMods,isLoading:R.isLoading}))),[a,o]=T.useState(""),[l,c]=T.useState(""),[u,f]=T.useState(""),[m,g]=T.useState(!1),[v,b]=T.useState({}),[w,x]=T.useState({}),_=T.useCallback(async()=>{if(!a.trim()){Le.error("Mod name cannot be empty.");return}if(!l.trim()&&!u.trim()){Le.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&u.trim()){Le.error("Provide either a Mod URL or Script Content, not both.");return}g(!0);try{const R={name:a.trim(),sourceUrl:l.trim()||null,scriptContent:u.trim()||null,enabled:!0,loadOrder:((s==null?void 0:s.length)??1)*10};await t(R),o(""),c(""),f(""),Le.info("Mod added. Reload required for changes to take effect.")}catch(R){console.error("Failed to add mod (from component):",R)}finally{g(!1)}},[a,l,u,t,s==null?void 0:s.length]),E=T.useCallback(async R=>{b(I=>({...I,[R.id]:!0}));try{await n(R.id,{enabled:!R.enabled}),Le.info(`Mod "${R.name}" ${R.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(I){console.error("Failed to update mod (from component):",I)}finally{b(I=>({...I,[R.id]:!1}))}},[n]),C=T.useCallback(async R=>{if(window.confirm(`Are you sure you want to delete the mod "${R.name}"? This cannot be undone.`)){x(I=>({...I,[R.id]:!0}));try{await r(R.id),Le.info("Mod deleted. Reload required for changes to take effect.")}catch(I){console.error("Failed to delete mod (from component):",I)}finally{x(I=>({...I,[R.id]:!1}))}}},[r]),k=T.useCallback(R=>{const I=e.find(M=>M.id===R);if(I)if(I.error){const M=I.error instanceof Error?I.error.message:String(I.error);return{status:"Error",error:I.error,tooltip:M}}else return{status:"Loaded"};const j=(s||[]).find(M=>M.id===R);return j?j.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,s]);return p.jsxs("div",{className:"space-y-6 p-1",children:[p.jsxs(YG,{variant:"destructive",className:"border-destructive/50",children:[p.jsx(bR,{className:"h-4 w-4"}),p.jsx(XG,{children:"Security Warning"}),p.jsx(JG,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),p.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[p.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(Jt,{htmlFor:"mod-name",children:"Mod Name"}),p.jsx(zn,{id:"mod-name",value:a,onChange:R=>o(R.target.value),placeholder:"My Awesome Mod",disabled:m})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(Jt,{htmlFor:"mod-url",children:"Source URL (Optional)"}),p.jsx(zn,{id:"mod-url",type:"url",value:l,onChange:R=>c(R.target.value),placeholder:"https://example.com/my-mod.js",disabled:m||!!u.trim()})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx(Jt,{htmlFor:"mod-script",children:"Script Content (Optional)"}),p.jsx(Ad,{id:"mod-script",value:u,onChange:R=>f(R.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:m||!!l.trim()})]}),p.jsxs(Ct,{onClick:_,disabled:m,children:[m&&p.jsx(Pn,{className:"mr-2 h-4 w-4 animate-spin"}),m?"Adding...":"Add Mod"]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),p.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),p.jsx("div",{className:"rounded-md border",children:p.jsx(sr,{delayDuration:100,children:p.jsxs(Qf,{children:[p.jsx(Om,{children:p.jsxs(ts,{children:[p.jsx(Lr,{children:"Name"}),p.jsx(Lr,{children:"Source"}),p.jsx(Lr,{children:"Status"}),p.jsx(Lr,{className:"text-center",children:"Enabled"}),p.jsx(Lr,{className:"text-right",children:"Actions"})]})}),p.jsx(eh,{children:i?p.jsxs(p.Fragment,{children:[p.jsx(ts,{children:p.jsx(Ln,{colSpan:5,children:p.jsx(dr,{className:"h-10 w-full"})})}),p.jsx(ts,{children:p.jsx(Ln,{colSpan:5,children:p.jsx(dr,{className:"h-10 w-full"})})})]}):(s||[]).length===0?p.jsx(ts,{children:p.jsx(Ln,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(s||[]).map(R=>{const{status:I,error:j,tooltip:M}=k(R.id),L=R.sourceUrl?new URL(R.sourceUrl).hostname:"Direct Script",q=v[R.id],P=w[R.id],V=q||P,z=I==="Error";return p.jsxs(ts,{children:[p.jsx(Ln,{className:"font-medium",children:R.name}),p.jsx(Ln,{className:"text-muted-foreground",children:L}),p.jsxs(Ln,{children:[p.jsxs(or,{children:[p.jsx(lr,{asChild:!0,children:p.jsx("span",{className:z?"text-destructive font-semibold cursor-help":"",children:I})}),M&&p.jsx(cr,{className:"max-w-xs break-words",children:p.jsx("p",{children:M})})]}),z&&j&&p.jsx("p",{className:"text-xs text-destructive truncate",children:j instanceof Error?j.message:String(j)})]}),p.jsxs(Ln,{className:"text-center",children:[p.jsx(Bu,{checked:R.enabled??!1,onCheckedChange:()=>E(R),disabled:V,"aria-label":`Enable ${R.name}`}),q&&p.jsx(Pn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),p.jsx(Ln,{className:"text-right",children:p.jsx(Ct,{variant:"ghost",size:"icon",onClick:()=>C(R),disabled:V,"aria-label":`Delete ${R.name}`,className:"text-destructive hover:text-destructive/80",children:P?p.jsx(Pn,{className:"h-4 w-4 animate-spin"}):p.jsx(Aa,{className:"h-4 w-4"})})})]},R.id)})})]})})})]})]})},hMe=dt.memo(fMe);class pMe{constructor(){Ne(this,"id","core-settings-mods");Ne(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"mods",title:"Mods",component:hMe,order:80})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const mMe=({interactionId:e,contentToCopy:t,disabled:n})=>{const[r]=T.useState(!1),s=T.useCallback(async i=>{if(i.stopPropagation(),n||!t){Le.info("No content to copy or action disabled.");return}Be.emit(Ep.copyInteractionResponseRequest,{interactionId:e})},[e,t,n]);return p.jsx(gn,{tooltipText:"Copy",onClick:s,"aria-label":"Copy content",disabled:n||!t,icon:r?p.jsx(Ui,{className:"text-green-500"}):p.jsx(P1,{}),className:"h-5 w-5"})};class gMe{constructor(){Ne(this,"id","core-canvas-copy-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>n.interactionId?dt.createElement(mMe,{interactionId:n.interactionId,contentToCopy:n.responseContent??"",disabled:!n.responseContent||n.responseContent.trim()===""}):(console.warn("CopyActionControlModule: interactionId is missing in context for an interaction control."),null)})}destroy(t){}}const yMe=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){Le.info("Regeneration is currently disabled.");return}Be.emit(Ep.regenerateInteractionRequest,{interactionId:e})};return p.jsx(gn,{tooltipText:"Regenerate",onClick:n,"aria-label":"Regenerate Response",disabled:t,icon:p.jsx(D1,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class bMe{constructor(){Ne(this,"id","core-canvas-regenerate-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=Bn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.type==="message.user_assistant");a.sort((u,f)=>u.index-f.index);const o=a.length>0?a[a.length-1]:null,c=(o==null?void 0:o.id)===r.id&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return dt.createElement(yMe,{interactionId:r.id,disabled:!c})}})}destroy(t){}}const vMe=({interactionId:e,currentRating:t})=>{const n=s=>{const i=s===t?null:s;Be.emit(On.rateInteractionRequest,{interactionId:e,rating:i})},r=Array.from({length:11},(s,i)=>i-5);return p.jsx("div",{className:"flex items-center gap-1",children:r.map(s=>{let i="";s===-5?i="Terrible":s===-4?i="Very Bad":s===-3?i="Bad":s===-2?i="Poor":s===-1?i="Below Average":s===0?i="Neutral":s===1?i="Above Average":s===2?i="Good":s===3?i="Very Good":s===4?i="Excellent":s===5&&(i="Perfect");let a="text-muted-foreground",o="hover:text-foreground",l="";s<0?(o="hover:text-red-500",t===s&&(a="text-red-500",l="fill-red-500")):s===0?(o="hover:text-gray-500",t===s&&(a="text-gray-500",l="fill-gray-500")):(o="hover:text-green-500",t===s&&(a="text-green-500",l="fill-green-500"));const c=t===s?"bg-muted":"";return p.jsx(gn,{tooltipText:i,onClick:()=>n(s),"aria-label":`Rate response as ${i}`,icon:p.jsx(pJ,{className:ct(l,t===s?"fill-current":"fill-none")}),variant:"ghost",className:ct("h-4 w-4 md:h-5 md:w-5 p-0",a,o,c)},s)})})};class wMe{constructor(){Ne(this,"id","core-canvas-rating-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>!n.interactionId||!n.interaction?null:dt.createElement(vMe,{interactionId:n.interactionId,currentRating:n.interaction.rating})})}destroy(t){}}const xMe=({context:e})=>{const t=()=>{Le.info(`Example Canvas Action Clicked! Interaction ID: ${e.interactionId}`)};return p.jsxs(Ct,{variant:"outline",size:"sm",onClick:t,className:"h-6 px-2 text-xs",children:[p.jsx(aJ,{className:"h-3 w-3 mr-1"})," Example Action"]})};class _Me{constructor(){Ne(this,"id","example-canvas-control-module")}async initialize(t){}register(t){t.registerCanvasControl({id:"example-canvas-action",type:"interaction",targetSlot:"actions",renderer:n=>dt.createElement(xMe,{context:n})})}destroy(t){}}const SMe=({isFolded:e,toggleFold:t,canFold:n})=>{if(!n)return null;const r=s=>{s.stopPropagation(),t()};return p.jsx(gn,{tooltipText:e?"Unfold":"Fold",onClick:r,"aria-label":e?"Unfold response":"Fold response",icon:e?p.jsx(Fl,{}):p.jsx(fd,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})};class EMe{constructor(){Ne(this,"id","core-canvas-fold-interaction")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.toggleFold||n.isFolded===void 0?null:dt.createElement(SMe,{isFolded:n.isFolded,toggleFold:n.toggleFold,canFold:!0})})}destroy(t){}}const CMe=({interactionId:e,codeBlockId:t,language:n,codeToCopy:r,disabled:s})=>{const[i,a]=T.useState(!1),o=T.useCallback(async l=>{l.stopPropagation(),!(s||!r)&&(Be.emit(Ep.copyCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,content:r}),a(!0),setTimeout(()=>a(!1),1500))},[e,t,n,r,s]);return p.jsx(gn,{tooltipText:"Copy Code",onClick:o,"aria-label":"Copy code block",disabled:s||!r,icon:i?p.jsx(Ui,{className:"text-green-500"}):p.jsx(P1,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class kMe{constructor(){Ne(this,"id","core-codeblock-copy")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>dt.createElement(CMe,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToCopy:n.codeBlockContent??"",disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const TMe=({isFolded:e,toggleFold:t})=>{const n=r=>{r.stopPropagation(),t()};return p.jsx(gn,{tooltipText:e?"Unfold Code":"Fold Code",onClick:n,"aria-label":e?"Unfold code block":"Fold code block",icon:p.jsx(M1,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class AMe{constructor(){Ne(this,"id","core-codeblock-fold")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>n.toggleFold===void 0||n.isFolded===void 0?null:dt.createElement(TMe,{isFolded:n.isFolded,toggleFold:n.toggleFold})})}destroy(t){}}const RMe=({toolCall:e})=>{const[t,n]=T.useState(!0),r=()=>n(i=>!i),s=T.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return p.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[p.jsxs("div",{className:"flex items-center justify-between mb-1",children:[p.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",p.jsx("code",{className:"font-mono",children:e.toolName})]}),p.jsx(gn,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?p.jsx(Fl,{}):p.jsx(fd,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&p.jsx(hm,{lang:"json",code:s})]})},NMe=({toolResult:e})=>{const[t,n]=T.useState(!0),r=()=>n(a=>!a),s=T.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),i=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return p.jsxs("div",{className:ct("my-2 p-2 border rounded-md text-xs",i?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[p.jsxs("div",{className:"flex items-center justify-between mb-1",children:[p.jsxs("span",{className:ct("font-semibold",i?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",p.jsx("code",{className:"font-mono",children:e.toolName})]}),p.jsx(gn,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?p.jsx(Fl,{}):p.jsx(fd,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&p.jsx(hm,{lang:i?"text":"json",code:s})]})},IMe=({interactionId:e,toolCall:t,toolResult:n})=>p.jsxs("div",{className:"tool-call-step my-1","data-interaction-id":e,"data-tool-call-id":t.toolCallId,children:[p.jsx(RMe,{toolCall:t}),n&&p.jsx(NMe,{toolResult:n})]});class jMe{constructor(){Ne(this,"id","core-tool-call-step-display")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"tool-call-step",targetSlot:"tool-call-content",renderer:n=>!n.interactionId||!n.toolCall?(console.warn("[ToolCallStepControlModule] Missing interactionId or toolCall in context"),null):dt.createElement(IMe,{interactionId:n.interactionId,toolCall:n.toolCall,toolResult:n.toolResult})})}destroy(t){}}const MMe=[MIe,FIe,VIe,Kje,aMe,dMe,pMe,Oke,vTe,yTe,JNe,QNe,IIe,oIe,cIe,dIe,GTe,VRe,RIe,tIe,yNe,UTe,sIe,tNe,lNe,pNe,gMe,EMe,bMe,wMe,kMe,AMe,_Me,jMe];function OMe(){return p.jsxs(Nke,{children:[p.jsx(Ake,{}),p.jsx(Tke,{}),p.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:p.jsx("main",{className:"flex-grow overflow-hidden",children:p.jsx(xke,{controls:MMe})})})]})}VJ();gZ.createRoot(document.getElementById("root")).render(p.jsx(dt.StrictMode,{children:p.jsx(OMe,{})}));
