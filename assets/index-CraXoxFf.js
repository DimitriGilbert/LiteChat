var z7=Object.defineProperty;var U7=(e,t,n)=>t in e?z7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Oa=(e,t,n)=>U7(e,typeof t!="symbol"?t+"":t,n);function q7(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function di(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var V_={exports:{}},Im={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tI;function H7(){if(tI)return Im;tI=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,a,i){var s=null;if(i!==void 0&&(s=""+i),a.key!==void 0&&(s=""+a.key),"key"in a){i={};for(var o in a)o!=="key"&&(i[o]=a[o])}else i=a;return a=i.ref,{$$typeof:e,type:r,key:s,ref:a!==void 0?a:null,props:i}}return Im.Fragment=t,Im.jsx=n,Im.jsxs=n,Im}var nI;function V7(){return nI||(nI=1,V_.exports=H7()),V_.exports}var m=V7(),G_={exports:{}};function G7(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var e6={exports:{}},oa=e6.exports={},Oo,Do;function u2(){throw new Error("setTimeout has not been defined")}function d2(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Oo=setTimeout:Oo=u2}catch{Oo=u2}try{typeof clearTimeout=="function"?Do=clearTimeout:Do=d2}catch{Do=d2}})();function t6(e){if(Oo===setTimeout)return setTimeout(e,0);if((Oo===u2||!Oo)&&setTimeout)return Oo=setTimeout,setTimeout(e,0);try{return Oo(e,0)}catch{try{return Oo.call(null,e,0)}catch{return Oo.call(this,e,0)}}}function W7(e){if(Do===clearTimeout)return clearTimeout(e);if((Do===d2||!Do)&&clearTimeout)return Do=clearTimeout,clearTimeout(e);try{return Do(e)}catch{try{return Do.call(null,e)}catch{return Do.call(this,e)}}}var Pl=[],gh=!1,xd,Xb=-1;function K7(){!gh||!xd||(gh=!1,xd.length?Pl=xd.concat(Pl):Xb=-1,Pl.length&&n6())}function n6(){if(!gh){var e=t6(K7);gh=!0;for(var t=Pl.length;t;){for(xd=Pl,Pl=[];++Xb<t;)xd&&xd[Xb].run();Xb=-1,t=Pl.length}xd=null,gh=!1,W7(e)}}oa.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Pl.push(new r6(e,t)),Pl.length===1&&!gh&&t6(n6)};function r6(e,t){this.fun=e,this.array=t}r6.prototype.run=function(){this.fun.apply(null,this.array)};oa.title="browser";oa.browser=!0;oa.env={};oa.argv=[];oa.version="";oa.versions={};function Jl(){}oa.on=Jl;oa.addListener=Jl;oa.once=Jl;oa.off=Jl;oa.removeListener=Jl;oa.removeAllListeners=Jl;oa.emit=Jl;oa.prependListener=Jl;oa.prependOnceListener=Jl;oa.listeners=function(e){return[]};oa.binding=function(e){throw new Error("process.binding is not supported")};oa.cwd=function(){return"/"};oa.chdir=function(e){throw new Error("process.chdir is not supported")};oa.umask=function(){return 0};var Z7=e6.exports;const ea=G7(Z7);var Dn={},rI;function Y7(){if(rI)return Dn;rI=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;function p(B){return B===null||typeof B!="object"?null:(B=h&&B[h]||B["@@iterator"],typeof B=="function"?B:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,b={};function w(B,J,ee){this.props=B,this.context=J,this.refs=b,this.updater=ee||y}w.prototype.isReactComponent={},w.prototype.setState=function(B,J){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,J,"setState")},w.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function x(){}x.prototype=w.prototype;function S(B,J,ee){this.props=B,this.context=J,this.refs=b,this.updater=ee||y}var E=S.prototype=new x;E.constructor=S,v(E,w.prototype),E.isPureReactComponent=!0;var C=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},R=Object.prototype.hasOwnProperty;function O(B,J,ee,oe,me,xe){return ee=xe.ref,{$$typeof:e,type:B,key:J,ref:ee!==void 0?ee:null,props:xe}}function j(B,J){return O(B.type,J,void 0,void 0,void 0,B.props)}function $(B){return typeof B=="object"&&B!==null&&B.$$typeof===e}function L(B){var J={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ee){return J[ee]})}var X=/\/+/g;function F(B,J){return typeof B=="object"&&B!==null&&B.key!=null?L(""+B.key):J.toString(36)}function K(){}function q(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(K,K):(B.status="pending",B.then(function(J){B.status==="pending"&&(B.status="fulfilled",B.value=J)},function(J){B.status==="pending"&&(B.status="rejected",B.reason=J)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function de(B,J,ee,oe,me){var xe=typeof B;(xe==="undefined"||xe==="boolean")&&(B=null);var Pe=!1;if(B===null)Pe=!0;else switch(xe){case"bigint":case"string":case"number":Pe=!0;break;case"object":switch(B.$$typeof){case e:case t:Pe=!0;break;case d:return Pe=B._init,de(Pe(B._payload),J,ee,oe,me)}}if(Pe)return me=me(B),Pe=oe===""?"."+F(B,0):oe,C(me)?(ee="",Pe!=null&&(ee=Pe.replace(X,"$&/")+"/"),de(me,J,ee,"",function(ke){return ke})):me!=null&&($(me)&&(me=j(me,ee+(me.key==null||B&&B.key===me.key?"":(""+me.key).replace(X,"$&/")+"/")+Pe)),J.push(me)),1;Pe=0;var Ne=oe===""?".":oe+":";if(C(B))for(var Re=0;Re<B.length;Re++)oe=B[Re],xe=Ne+F(oe,Re),Pe+=de(oe,J,ee,xe,me);else if(Re=p(B),typeof Re=="function")for(B=Re.call(B),Re=0;!(oe=B.next()).done;)oe=oe.value,xe=Ne+F(oe,Re++),Pe+=de(oe,J,ee,xe,me);else if(xe==="object"){if(typeof B.then=="function")return de(q(B),J,ee,oe,me);throw J=String(B),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Pe}function re(B,J,ee){if(B==null)return B;var oe=[],me=0;return de(B,oe,"","",function(xe){return J.call(ee,xe,me++)}),oe}function Y(B){if(B._status===-1){var J=B._result;J=J(),J.then(function(ee){(B._status===0||B._status===-1)&&(B._status=1,B._result=ee)},function(ee){(B._status===0||B._status===-1)&&(B._status=2,B._result=ee)}),B._status===-1&&(B._status=0,B._result=J)}if(B._status===1)return B._result.default;throw B._result}var Q=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(J))return}else if(typeof ea=="object"&&typeof ea.emit=="function"){ea.emit("uncaughtException",B);return}console.error(B)};function ae(){}return Dn.Children={map:re,forEach:function(B,J,ee){re(B,function(){J.apply(this,arguments)},ee)},count:function(B){var J=0;return re(B,function(){J++}),J},toArray:function(B){return re(B,function(J){return J})||[]},only:function(B){if(!$(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},Dn.Component=w,Dn.Fragment=n,Dn.Profiler=a,Dn.PureComponent=S,Dn.StrictMode=r,Dn.Suspense=l,Dn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Dn.__COMPILER_RUNTIME={__proto__:null,c:function(B){return k.H.useMemoCache(B)}},Dn.cache=function(B){return function(){return B.apply(null,arguments)}},Dn.cloneElement=function(B,J,ee){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var oe=v({},B.props),me=B.key,xe=void 0;if(J!=null)for(Pe in J.ref!==void 0&&(xe=void 0),J.key!==void 0&&(me=""+J.key),J)!R.call(J,Pe)||Pe==="key"||Pe==="__self"||Pe==="__source"||Pe==="ref"&&J.ref===void 0||(oe[Pe]=J[Pe]);var Pe=arguments.length-2;if(Pe===1)oe.children=ee;else if(1<Pe){for(var Ne=Array(Pe),Re=0;Re<Pe;Re++)Ne[Re]=arguments[Re+2];oe.children=Ne}return O(B.type,me,void 0,void 0,xe,oe)},Dn.createContext=function(B){return B={$$typeof:s,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:i,_context:B},B},Dn.createElement=function(B,J,ee){var oe,me={},xe=null;if(J!=null)for(oe in J.key!==void 0&&(xe=""+J.key),J)R.call(J,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(me[oe]=J[oe]);var Pe=arguments.length-2;if(Pe===1)me.children=ee;else if(1<Pe){for(var Ne=Array(Pe),Re=0;Re<Pe;Re++)Ne[Re]=arguments[Re+2];me.children=Ne}if(B&&B.defaultProps)for(oe in Pe=B.defaultProps,Pe)me[oe]===void 0&&(me[oe]=Pe[oe]);return O(B,xe,void 0,void 0,null,me)},Dn.createRef=function(){return{current:null}},Dn.forwardRef=function(B){return{$$typeof:o,render:B}},Dn.isValidElement=$,Dn.lazy=function(B){return{$$typeof:d,_payload:{_status:-1,_result:B},_init:Y}},Dn.memo=function(B,J){return{$$typeof:u,type:B,compare:J===void 0?null:J}},Dn.startTransition=function(B){var J=k.T,ee={};k.T=ee;try{var oe=B(),me=k.S;me!==null&&me(ee,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(ae,Q)}catch(xe){Q(xe)}finally{k.T=J}},Dn.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Dn.use=function(B){return k.H.use(B)},Dn.useActionState=function(B,J,ee){return k.H.useActionState(B,J,ee)},Dn.useCallback=function(B,J){return k.H.useCallback(B,J)},Dn.useContext=function(B){return k.H.useContext(B)},Dn.useDebugValue=function(){},Dn.useDeferredValue=function(B,J){return k.H.useDeferredValue(B,J)},Dn.useEffect=function(B,J,ee){var oe=k.H;if(typeof ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return oe.useEffect(B,J)},Dn.useId=function(){return k.H.useId()},Dn.useImperativeHandle=function(B,J,ee){return k.H.useImperativeHandle(B,J,ee)},Dn.useInsertionEffect=function(B,J){return k.H.useInsertionEffect(B,J)},Dn.useLayoutEffect=function(B,J){return k.H.useLayoutEffect(B,J)},Dn.useMemo=function(B,J){return k.H.useMemo(B,J)},Dn.useOptimistic=function(B,J){return k.H.useOptimistic(B,J)},Dn.useReducer=function(B,J,ee){return k.H.useReducer(B,J,ee)},Dn.useRef=function(B){return k.H.useRef(B)},Dn.useState=function(B){return k.H.useState(B)},Dn.useSyncExternalStore=function(B,J,ee){return k.H.useSyncExternalStore(B,J,ee)},Dn.useTransition=function(){return k.H.useTransition()},Dn.version="19.1.0",Dn}var aI;function FC(){return aI||(aI=1,G_.exports=Y7()),G_.exports}var T=FC();const gt=di(T),a6=q7({__proto__:null,default:gt},[T]);var W_={exports:{}},jm={},K_={exports:{}},Z_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iI;function X7(){return iI||(iI=1,function(e){function t(re,Y){var Q=re.length;re.push(Y);e:for(;0<Q;){var ae=Q-1>>>1,B=re[ae];if(0<a(B,Y))re[ae]=Y,re[Q]=B,Q=ae;else break e}}function n(re){return re.length===0?null:re[0]}function r(re){if(re.length===0)return null;var Y=re[0],Q=re.pop();if(Q!==Y){re[0]=Q;e:for(var ae=0,B=re.length,J=B>>>1;ae<J;){var ee=2*(ae+1)-1,oe=re[ee],me=ee+1,xe=re[me];if(0>a(oe,Q))me<B&&0>a(xe,oe)?(re[ae]=xe,re[me]=Q,ae=me):(re[ae]=oe,re[ee]=Q,ae=ee);else if(me<B&&0>a(xe,Q))re[ae]=xe,re[me]=Q,ae=me;else break e}}return Y}function a(re,Y){var Q=re.sortIndex-Y.sortIndex;return Q!==0?Q:re.id-Y.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],u=[],d=1,h=null,p=3,y=!1,v=!1,b=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(re){for(var Y=n(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=re)r(u),Y.sortIndex=Y.expirationTime,t(l,Y);else break;Y=n(u)}}function k(re){if(b=!1,C(re),!v)if(n(l)!==null)v=!0,R||(R=!0,F());else{var Y=n(u);Y!==null&&de(k,Y.startTime-re)}}var R=!1,O=-1,j=5,$=-1;function L(){return w?!0:!(e.unstable_now()-$<j)}function X(){if(w=!1,R){var re=e.unstable_now();$=re;var Y=!0;try{e:{v=!1,b&&(b=!1,S(O),O=-1),y=!0;var Q=p;try{t:{for(C(re),h=n(l);h!==null&&!(h.expirationTime>re&&L());){var ae=h.callback;if(typeof ae=="function"){h.callback=null,p=h.priorityLevel;var B=ae(h.expirationTime<=re);if(re=e.unstable_now(),typeof B=="function"){h.callback=B,C(re),Y=!0;break t}h===n(l)&&r(l),C(re)}else r(l);h=n(l)}if(h!==null)Y=!0;else{var J=n(u);J!==null&&de(k,J.startTime-re),Y=!1}}break e}finally{h=null,p=Q,y=!1}Y=void 0}}finally{Y?F():R=!1}}}var F;if(typeof E=="function")F=function(){E(X)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,q=K.port2;K.port1.onmessage=X,F=function(){q.postMessage(null)}}else F=function(){x(X,0)};function de(re,Y){O=x(function(){re(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(re){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var Q=p;p=Y;try{return re()}finally{p=Q}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(re,Y){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var Q=p;p=re;try{return Y()}finally{p=Q}},e.unstable_scheduleCallback=function(re,Y,Q){var ae=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ae+Q:ae):Q=ae,re){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Q+B,re={id:d++,callback:Y,priorityLevel:re,startTime:Q,expirationTime:B,sortIndex:-1},Q>ae?(re.sortIndex=Q,t(u,re),n(l)===null&&re===n(u)&&(b?(S(O),O=-1):b=!0,de(k,Q-ae))):(re.sortIndex=B,t(l,re),v||y||(v=!0,R||(R=!0,F()))),re},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(re){var Y=p;return function(){var Q=p;p=Y;try{return re.apply(this,arguments)}finally{p=Q}}}}(Z_)),Z_}var sI;function J7(){return sI||(sI=1,K_.exports=X7()),K_.exports}var Y_={exports:{}},ni={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oI;function Q7(){if(oI)return ni;oI=1;var e=FC();function t(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)u+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(l,u,d){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:h==null?null:""+h,children:l,containerInfo:u,implementation:d}}var s=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,u){if(l==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return ni.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,ni.createPortal=function(l,u){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(t(299));return i(l,u,null,d)},ni.flushSync=function(l){var u=s.T,d=r.p;try{if(s.T=null,r.p=2,l)return l()}finally{s.T=u,r.p=d,r.d.f()}},ni.preconnect=function(l,u){typeof l=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(l,u))},ni.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},ni.preinit=function(l,u){if(typeof l=="string"&&u&&typeof u.as=="string"){var d=u.as,h=o(d,u.crossOrigin),p=typeof u.integrity=="string"?u.integrity:void 0,y=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;d==="style"?r.d.S(l,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:h,integrity:p,fetchPriority:y}):d==="script"&&r.d.X(l,{crossOrigin:h,integrity:p,fetchPriority:y,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},ni.preinitModule=function(l,u){if(typeof l=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var d=o(u.as,u.crossOrigin);r.d.M(l,{crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(l)},ni.preload=function(l,u){if(typeof l=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var d=u.as,h=o(d,u.crossOrigin);r.d.L(l,d,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},ni.preloadModule=function(l,u){if(typeof l=="string")if(u){var d=o(u.as,u.crossOrigin);r.d.m(l,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:d,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(l)},ni.requestFormReset=function(l){r.d.r(l)},ni.unstable_batchedUpdates=function(l,u){return l(u)},ni.useFormState=function(l,u,d){return s.H.useFormState(l,u,d)},ni.useFormStatus=function(){return s.H.useHostTransitionStatus()},ni.version="19.1.0",ni}var lI;function i6(){if(lI)return Y_.exports;lI=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Y_.exports=Q7(),Y_.exports}var cI;function eU(){if(cI)return jm;cI=1;var e=J7(),t=FC(),n=i6();function r(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function i(c){var f=c,g=c;if(c.alternate)for(;f.return;)f=f.return;else{c=f;do f=c,(f.flags&4098)!==0&&(g=f.return),c=f.return;while(c)}return f.tag===3?g:null}function s(c){if(c.tag===13){var f=c.memoizedState;if(f===null&&(c=c.alternate,c!==null&&(f=c.memoizedState)),f!==null)return f.dehydrated}return null}function o(c){if(i(c)!==c)throw Error(r(188))}function l(c){var f=c.alternate;if(!f){if(f=i(c),f===null)throw Error(r(188));return f!==c?null:c}for(var g=c,_=f;;){var N=g.return;if(N===null)break;var P=N.alternate;if(P===null){if(_=N.return,_!==null){g=_;continue}break}if(N.child===P.child){for(P=N.child;P;){if(P===g)return o(N),c;if(P===_)return o(N),f;P=P.sibling}throw Error(r(188))}if(g.return!==_.return)g=N,_=P;else{for(var se=!1,Se=N.child;Se;){if(Se===g){se=!0,g=N,_=P;break}if(Se===_){se=!0,_=N,g=P;break}Se=Se.sibling}if(!se){for(Se=P.child;Se;){if(Se===g){se=!0,g=P,_=N;break}if(Se===_){se=!0,_=P,g=N;break}Se=Se.sibling}if(!se)throw Error(r(189))}}if(g.alternate!==_)throw Error(r(190))}if(g.tag!==3)throw Error(r(188));return g.stateNode.current===g?c:f}function u(c){var f=c.tag;if(f===5||f===26||f===27||f===6)return c;for(c=c.child;c!==null;){if(f=u(c),f!==null)return f;c=c.sibling}return null}var d=Object.assign,h=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),S=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function F(c){return c===null||typeof c!="object"?null:(c=X&&c[X]||c["@@iterator"],typeof c=="function"?c:null)}var K=Symbol.for("react.client.reference");function q(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===K?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case v:return"Fragment";case w:return"Profiler";case b:return"StrictMode";case k:return"Suspense";case R:return"SuspenseList";case $:return"Activity"}if(typeof c=="object")switch(c.$$typeof){case y:return"Portal";case E:return(c.displayName||"Context")+".Provider";case S:return(c._context.displayName||"Context")+".Consumer";case C:var f=c.render;return c=c.displayName,c||(c=f.displayName||f.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case O:return f=c.displayName||null,f!==null?f:q(c.type)||"Memo";case j:f=c._payload,c=c._init;try{return q(c(f))}catch{}}return null}var de=Array.isArray,re=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},ae=[],B=-1;function J(c){return{current:c}}function ee(c){0>B||(c.current=ae[B],ae[B]=null,B--)}function oe(c,f){B++,ae[B]=c.current,c.current=f}var me=J(null),xe=J(null),Pe=J(null),Ne=J(null);function Re(c,f){switch(oe(Pe,f),oe(xe,c),oe(me,null),f.nodeType){case 9:case 11:c=(c=f.documentElement)&&(c=c.namespaceURI)?NR(c):0;break;default:if(c=f.tagName,f=f.namespaceURI)f=NR(f),c=RR(f,c);else switch(c){case"svg":c=1;break;case"math":c=2;break;default:c=0}}ee(me),oe(me,c)}function ke(){ee(me),ee(xe),ee(Pe)}function Fe(c){c.memoizedState!==null&&oe(Ne,c);var f=me.current,g=RR(f,c.type);f!==g&&(oe(xe,c),oe(me,g))}function Qe(c){xe.current===c&&(ee(me),ee(xe)),Ne.current===c&&(ee(Ne),km._currentValue=Q)}var Le=Object.prototype.hasOwnProperty,Ie=e.unstable_scheduleCallback,V=e.unstable_cancelCallback,ge=e.unstable_shouldYield,Te=e.unstable_requestPaint,le=e.unstable_now,ie=e.unstable_getCurrentPriorityLevel,te=e.unstable_ImmediatePriority,_e=e.unstable_UserBlockingPriority,Me=e.unstable_NormalPriority,Ee=e.unstable_LowPriority,We=e.unstable_IdlePriority,kt=e.log,it=e.unstable_setDisableYieldValue,xt=null,Dt=null;function Ot(c){if(typeof kt=="function"&&it(c),Dt&&typeof Dt.setStrictMode=="function")try{Dt.setStrictMode(xt,c)}catch{}}var Wt=Math.clz32?Math.clz32:G,be=Math.log,I=Math.LN2;function G(c){return c>>>=0,c===0?32:31-(be(c)/I|0)|0}var fe=256,je=4194304;function ve(c){var f=c&42;if(f!==0)return f;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function Ce(c,f,g){var _=c.pendingLanes;if(_===0)return 0;var N=0,P=c.suspendedLanes,se=c.pingedLanes;c=c.warmLanes;var Se=_&134217727;return Se!==0?(_=Se&~P,_!==0?N=ve(_):(se&=Se,se!==0?N=ve(se):g||(g=Se&~c,g!==0&&(N=ve(g))))):(Se=_&~P,Se!==0?N=ve(Se):se!==0?N=ve(se):g||(g=_&~c,g!==0&&(N=ve(g)))),N===0?0:f!==0&&f!==N&&(f&P)===0&&(P=N&-N,g=f&-f,P>=g||P===32&&(g&4194048)!==0)?f:N}function ce(c,f){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&f)===0}function ft(c,f){switch(c){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vt(){var c=fe;return fe<<=1,(fe&4194048)===0&&(fe=256),c}function M(){var c=je;return je<<=1,(je&62914560)===0&&(je=4194304),c}function Be(c){for(var f=[],g=0;31>g;g++)f.push(c);return f}function nt(c,f){c.pendingLanes|=f,f!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function ye(c,f,g,_,N,P){var se=c.pendingLanes;c.pendingLanes=g,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=g,c.entangledLanes&=g,c.errorRecoveryDisabledLanes&=g,c.shellSuspendCounter=0;var Se=c.entanglements,ze=c.expirationTimes,dt=c.hiddenUpdates;for(g=se&~g;0<g;){var Ct=31-Wt(g),It=1<<Ct;Se[Ct]=0,ze[Ct]=-1;var mt=dt[Ct];if(mt!==null)for(dt[Ct]=null,Ct=0;Ct<mt.length;Ct++){var yt=mt[Ct];yt!==null&&(yt.lane&=-536870913)}g&=~It}_!==0&&Oe(c,_,0),P!==0&&N===0&&c.tag!==0&&(c.suspendedLanes|=P&~(se&~f))}function Oe(c,f,g){c.pendingLanes|=f,c.suspendedLanes&=~f;var _=31-Wt(f);c.entangledLanes|=f,c.entanglements[_]=c.entanglements[_]|1073741824|g&4194090}function Ke(c,f){var g=c.entangledLanes|=f;for(c=c.entanglements;g;){var _=31-Wt(g),N=1<<_;N&f|c[_]&f&&(c[_]|=f),g&=~N}}function Rt(c){switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=128;break;case 268435456:c=134217728;break;default:c=0}return c}function pe(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function H(){var c=Y.p;return c!==0?c:(c=window.event,c===void 0?32:ZR(c.type))}function U(c,f){var g=Y.p;try{return Y.p=c,f()}finally{Y.p=g}}var W=Math.random().toString(36).slice(2),he="__reactFiber$"+W,Ae="__reactProps$"+W,qe="__reactContainer$"+W,pt="__reactEvents$"+W,Gt="__reactListeners$"+W,ut="__reactHandles$"+W,Tt="__reactResources$"+W,Pt="__reactMarker$"+W;function Jt(c){delete c[he],delete c[Ae],delete c[pt],delete c[Gt],delete c[ut]}function An(c){var f=c[he];if(f)return f;for(var g=c.parentNode;g;){if(f=g[qe]||g[he]){if(g=f.alternate,f.child!==null||g!==null&&g.child!==null)for(c=DR(c);c!==null;){if(g=c[he])return g;c=DR(c)}return f}c=g,g=c.parentNode}return null}function Hn(c){if(c=c[he]||c[qe]){var f=c.tag;if(f===5||f===6||f===13||f===26||f===27||f===3)return c}return null}function wr(c){var f=c.tag;if(f===5||f===26||f===27||f===6)return c.stateNode;throw Error(r(33))}function xr(c){var f=c[Tt];return f||(f=c[Tt]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function Mn(c){c[Pt]=!0}var hi=new Set,ho={};function po(c,f){mo(c,f),mo(c+"Capture",f)}function mo(c,f){for(ho[c]=f,c=0;c<f.length;c++)hi.add(f[c])}var Wr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),go={},ss={};function ny(c){return Le.call(ss,c)?!0:Le.call(go,c)?!1:Wr.test(c)?ss[c]=!0:(go[c]=!0,!1)}function Ds(c,f,g){if(ny(f))if(g===null)c.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":c.removeAttribute(f);return;case"boolean":var _=f.toLowerCase().slice(0,5);if(_!=="data-"&&_!=="aria-"){c.removeAttribute(f);return}}c.setAttribute(f,""+g)}}function tl(c,f,g){if(g===null)c.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(f);return}c.setAttribute(f,""+g)}}function zi(c,f,g,_){if(_===null)c.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(g);return}c.setAttributeNS(f,g,""+_)}}var zu,yo;function nl(c){if(zu===void 0)try{throw Error()}catch(g){var f=g.stack.trim().match(/\n( *(at )?)/);zu=f&&f[1]||"",yo=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zu+c+yo}var rc=!1;function uf(c,f){if(!c||rc)return"";rc=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var _={DetermineComponentFrameRoot:function(){try{if(f){var It=function(){throw Error()};if(Object.defineProperty(It.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(It,[])}catch(yt){var mt=yt}Reflect.construct(c,[],It)}else{try{It.call()}catch(yt){mt=yt}c.call(It.prototype)}}else{try{throw Error()}catch(yt){mt=yt}(It=c())&&typeof It.catch=="function"&&It.catch(function(){})}}catch(yt){if(yt&&mt&&typeof yt.stack=="string")return[yt.stack,mt.stack]}return[null,null]}};_.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(_.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(_.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=_.DetermineComponentFrameRoot(),se=P[0],Se=P[1];if(se&&Se){var ze=se.split(`
`),dt=Se.split(`
`);for(N=_=0;_<ze.length&&!ze[_].includes("DetermineComponentFrameRoot");)_++;for(;N<dt.length&&!dt[N].includes("DetermineComponentFrameRoot");)N++;if(_===ze.length||N===dt.length)for(_=ze.length-1,N=dt.length-1;1<=_&&0<=N&&ze[_]!==dt[N];)N--;for(;1<=_&&0<=N;_--,N--)if(ze[_]!==dt[N]){if(_!==1||N!==1)do if(_--,N--,0>N||ze[_]!==dt[N]){var Ct=`
`+ze[_].replace(" at new "," at ");return c.displayName&&Ct.includes("<anonymous>")&&(Ct=Ct.replace("<anonymous>",c.displayName)),Ct}while(1<=_&&0<=N);break}}}finally{rc=!1,Error.prepareStackTrace=g}return(g=c?c.displayName||c.name:"")?nl(g):""}function Vn(c){switch(c.tag){case 26:case 27:case 5:return nl(c.type);case 16:return nl("Lazy");case 13:return nl("Suspense");case 19:return nl("SuspenseList");case 0:case 15:return uf(c.type,!1);case 11:return uf(c.type.render,!1);case 1:return uf(c.type,!0);case 31:return nl("Activity");default:return""}}function Ap(c){try{var f="";do f+=Vn(c),c=c.return;while(c);return f}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function pi(c){switch(typeof c){case"bigint":case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Np(c){var f=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function Nr(c){var f=Np(c)?"checked":"value",g=Object.getOwnPropertyDescriptor(c.constructor.prototype,f),_=""+c[f];if(!c.hasOwnProperty(f)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var N=g.get,P=g.set;return Object.defineProperty(c,f,{configurable:!0,get:function(){return N.call(this)},set:function(se){_=""+se,P.call(this,se)}}),Object.defineProperty(c,f,{enumerable:g.enumerable}),{getValue:function(){return _},setValue:function(se){_=""+se},stopTracking:function(){c._valueTracker=null,delete c[f]}}}}function bo(c){c._valueTracker||(c._valueTracker=Nr(c))}function ac(c){if(!c)return!1;var f=c._valueTracker;if(!f)return!0;var g=f.getValue(),_="";return c&&(_=Np(c)?c.checked?"true":"false":c.value),c=_,c!==g?(f.setValue(c),!0):!1}function Ms(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}var Rp=/[\n"\\]/g;function Ja(c){return c.replace(Rp,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function ic(c,f,g,_,N,P,se,Se){c.name="",se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"?c.type=se:c.removeAttribute("type"),f!=null?se==="number"?(f===0&&c.value===""||c.value!=f)&&(c.value=""+pi(f)):c.value!==""+pi(f)&&(c.value=""+pi(f)):se!=="submit"&&se!=="reset"||c.removeAttribute("value"),f!=null?sc(c,se,pi(f)):g!=null?sc(c,se,pi(g)):_!=null&&c.removeAttribute("value"),N==null&&P!=null&&(c.defaultChecked=!!P),N!=null&&(c.checked=N&&typeof N!="function"&&typeof N!="symbol"),Se!=null&&typeof Se!="function"&&typeof Se!="symbol"&&typeof Se!="boolean"?c.name=""+pi(Se):c.removeAttribute("name")}function Ip(c,f,g,_,N,P,se,Se){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(c.type=P),f!=null||g!=null){if(!(P!=="submit"&&P!=="reset"||f!=null))return;g=g!=null?""+pi(g):"",f=f!=null?""+pi(f):g,Se||f===c.value||(c.value=f),c.defaultValue=f}_=_??N,_=typeof _!="function"&&typeof _!="symbol"&&!!_,c.checked=Se?c.checked:!!_,c.defaultChecked=!!_,se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"&&(c.name=se)}function sc(c,f,g){f==="number"&&Ms(c.ownerDocument)===c||c.defaultValue===""+g||(c.defaultValue=""+g)}function rl(c,f,g,_){if(c=c.options,f){f={};for(var N=0;N<g.length;N++)f["$"+g[N]]=!0;for(g=0;g<c.length;g++)N=f.hasOwnProperty("$"+c[g].value),c[g].selected!==N&&(c[g].selected=N),N&&_&&(c[g].defaultSelected=!0)}else{for(g=""+pi(g),f=null,N=0;N<c.length;N++){if(c[N].value===g){c[N].selected=!0,_&&(c[N].defaultSelected=!0);return}f!==null||c[N].disabled||(f=c[N])}f!==null&&(f.selected=!0)}}function oc(c,f,g){if(f!=null&&(f=""+pi(f),f!==c.value&&(c.value=f),g==null)){c.defaultValue!==f&&(c.defaultValue=f);return}c.defaultValue=g!=null?""+pi(g):""}function jp(c,f,g,_){if(f==null){if(_!=null){if(g!=null)throw Error(r(92));if(de(_)){if(1<_.length)throw Error(r(93));_=_[0]}g=_}g==null&&(g=""),f=g}g=pi(f),c.defaultValue=g,_=c.textContent,_===g&&_!==""&&_!==null&&(c.value=_)}function lc(c,f){if(f){var g=c.firstChild;if(g&&g===c.lastChild&&g.nodeType===3){g.nodeValue=f;return}}c.textContent=f}var er=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function df(c,f,g){var _=f.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?_?c.setProperty(f,""):f==="float"?c.cssFloat="":c[f]="":_?c.setProperty(f,g):typeof g!="number"||g===0||er.has(f)?f==="float"?c.cssFloat=g:c[f]=(""+g).trim():c[f]=g+"px"}function ry(c,f,g){if(f!=null&&typeof f!="object")throw Error(r(62));if(c=c.style,g!=null){for(var _ in g)!g.hasOwnProperty(_)||f!=null&&f.hasOwnProperty(_)||(_.indexOf("--")===0?c.setProperty(_,""):_==="float"?c.cssFloat="":c[_]="");for(var N in f)_=f[N],f.hasOwnProperty(N)&&g[N]!==_&&df(c,N,_)}else for(var P in f)f.hasOwnProperty(P)&&df(c,P,f[P])}function Op(c){if(c.indexOf("-")===-1)return!1;switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function al(c){return cc.test(""+c)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":c}var os=null;function ff(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var il=null,Lr=null;function Ui(c){var f=Hn(c);if(f&&(c=f.stateNode)){var g=c[Ae]||null;e:switch(c=f.stateNode,f.type){case"input":if(ic(c,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),f=g.name,g.type==="radio"&&f!=null){for(g=c;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Ja(""+f)+'"][type="radio"]'),f=0;f<g.length;f++){var _=g[f];if(_!==c&&_.form===c.form){var N=_[Ae]||null;if(!N)throw Error(r(90));ic(_,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(f=0;f<g.length;f++)_=g[f],_.form===c.form&&ac(_)}break e;case"textarea":oc(c,g.value,g.defaultValue);break e;case"select":f=g.value,f!=null&&rl(c,!!g.multiple,f,!1)}}}var sl=!1;function uc(c,f,g){if(sl)return c(f,g);sl=!0;try{var _=c(f);return _}finally{if(sl=!1,(il!==null||Lr!==null)&&(Vy(),il&&(f=il,c=Lr,Lr=il=null,Ui(f),c)))for(f=0;f<c.length;f++)Ui(c[f])}}function ol(c,f){var g=c.stateNode;if(g===null)return null;var _=g[Ae]||null;if(_===null)return null;g=_[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(c=c.type,_=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!_;break e;default:c=!1}if(c)return null;if(g&&typeof g!="function")throw Error(r(231,f,typeof g));return g}var Ta=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dp=!1;if(Ta)try{var Qa={};Object.defineProperty(Qa,"passive",{get:function(){Dp=!0}}),window.addEventListener("test",Qa,Qa),window.removeEventListener("test",Qa,Qa)}catch{Dp=!1}var ls=null,hf=null,dc=null;function fc(){if(dc)return dc;var c,f=hf,g=f.length,_,N="value"in ls?ls.value:ls.textContent,P=N.length;for(c=0;c<g&&f[c]===N[c];c++);var se=g-c;for(_=1;_<=se&&f[g-_]===N[P-_];_++);return dc=N.slice(c,1<_?1-_:void 0)}function hc(c){var f=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&f===13&&(c=13)):c=f,c===10&&(c=13),32<=c||c===13?c:0}function Uu(){return!0}function ay(){return!1}function la(c){function f(g,_,N,P,se){this._reactName=g,this._targetInst=N,this.type=_,this.nativeEvent=P,this.target=se,this.currentTarget=null;for(var Se in c)c.hasOwnProperty(Se)&&(g=c[Se],this[Se]=g?g(P):P[Se]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Uu:ay,this.isPropagationStopped=ay,this}return d(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Uu)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Uu)},persist:function(){},isPersistent:Uu}),f}var ll={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pf=la(ll),vo=d({},ll,{view:0,detail:0}),mf=la(vo),qu,Mp,Hu,gf=d({},vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cl,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Hu&&(Hu&&c.type==="mousemove"?(qu=c.screenX-Hu.screenX,Mp=c.screenY-Hu.screenY):Mp=qu=0,Hu=c),qu)},movementY:function(c){return"movementY"in c?c.movementY:Mp}}),yf=la(gf),Pp=d({},gf,{dataTransfer:0}),iy=la(Pp),bf=d({},vo,{relatedTarget:0}),pc=la(bf),vf=d({},ll,{animationName:0,elapsedTime:0,pseudoElement:0}),sy=la(vf),i1=d({},ll,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),wf=la(i1),Fp=d({},ll,{data:0}),xf=la(Fp),Lp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$p={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Aa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vu(c){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(c):(c=Aa[c])?!!f[c]:!1}function cl(){return Vu}var oy=d({},vo,{key:function(c){if(c.key){var f=Lp[c.key]||c.key;if(f!=="Unidentified")return f}return c.type==="keypress"?(c=hc(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?$p[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cl,charCode:function(c){return c.type==="keypress"?hc(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?hc(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),_f=la(oy),ly=d({},gf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bp=la(ly),Sf=d({},vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cl}),zp=la(Sf),ul=d({},ll,{propertyName:0,elapsedTime:0,pseudoElement:0}),Up=la(ul),qp=d({},gf,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),Ef=la(qp),Hp=d({},ll,{newState:0,oldState:0}),cy=la(Hp),s1=[9,13,27,32],Gu=Ta&&"CompositionEvent"in window,wo=null;Ta&&"documentMode"in document&&(wo=document.documentMode);var o1=Ta&&"TextEvent"in window&&!wo,Cf=Ta&&(!Gu||wo&&8<wo&&11>=wo),kf=" ",uy=!1;function Vp(c,f){switch(c){case"keyup":return s1.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dy(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var dl=!1;function fy(c,f){switch(c){case"compositionend":return dy(f);case"keypress":return f.which!==32?null:(uy=!0,kf);case"textInput":return c=f.data,c===kf&&uy?null:c;default:return null}}function l1(c,f){if(dl)return c==="compositionend"||!Gu&&Vp(c,f)?(c=fc(),dc=hf=ls=null,dl=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return Cf&&f.locale!=="ko"?null:f.data;default:return null}}var hy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tf(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f==="input"?!!hy[c.type]:f==="textarea"}function Gp(c,f,g,_){il?Lr?Lr.push(_):Lr=[_]:il=_,f=Xy(f,"onChange"),0<f.length&&(g=new pf("onChange","change",null,g,_),c.push({event:g,listeners:f}))}var mc=null,Wu=null;function c1(c){ER(c,0)}function Af(c){var f=wr(c);if(ac(f))return c}function Ku(c,f){if(c==="change")return f}var cs=!1;if(Ta){var $r;if(Ta){var gc="oninput"in document;if(!gc){var gi=document.createElement("div");gi.setAttribute("oninput","return;"),gc=typeof gi.oninput=="function"}$r=gc}else $r=!1;cs=$r&&(!document.documentMode||9<document.documentMode)}function py(){mc&&(mc.detachEvent("onpropertychange",Nf),Wu=mc=null)}function Nf(c){if(c.propertyName==="value"&&Af(Wu)){var f=[];Gp(f,Wu,c,ff(c)),uc(c1,f)}}function my(c,f,g){c==="focusin"?(py(),mc=f,Wu=g,mc.attachEvent("onpropertychange",Nf)):c==="focusout"&&py()}function fl(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Af(Wu)}function Wp(c,f){if(c==="click")return Af(f)}function yc(c,f){if(c==="input"||c==="change")return Af(f)}function xo(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var ei=typeof Object.is=="function"?Object.is:xo;function A(c,f){if(ei(c,f))return!0;if(typeof c!="object"||c===null||typeof f!="object"||f===null)return!1;var g=Object.keys(c),_=Object.keys(f);if(g.length!==_.length)return!1;for(_=0;_<g.length;_++){var N=g[_];if(!Le.call(f,N)||!ei(c[N],f[N]))return!1}return!0}function D(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function Z(c,f){var g=D(c);c=0;for(var _;g;){if(g.nodeType===3){if(_=c+g.textContent.length,c<=f&&_>=f)return{node:g,offset:f-c};c=_}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=D(g)}}function ne(c,f){return c&&f?c===f?!0:c&&c.nodeType===3?!1:f&&f.nodeType===3?ne(c,f.parentNode):"contains"in c?c.contains(f):c.compareDocumentPosition?!!(c.compareDocumentPosition(f)&16):!1:!1}function ue(c){c=c!=null&&c.ownerDocument!=null&&c.ownerDocument.defaultView!=null?c.ownerDocument.defaultView:window;for(var f=Ms(c.document);f instanceof c.HTMLIFrameElement;){try{var g=typeof f.contentWindow.location.href=="string"}catch{g=!1}if(g)c=f.contentWindow;else break;f=Ms(c.document)}return f}function we(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f&&(f==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||f==="textarea"||c.contentEditable==="true")}var De=Ta&&"documentMode"in document&&11>=document.documentMode,$e=null,Ge=null,Ye=null,rt=!1;function He(c,f,g){var _=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;rt||$e==null||$e!==Ms(_)||(_=$e,"selectionStart"in _&&we(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),Ye&&A(Ye,_)||(Ye=_,_=Xy(Ge,"onSelect"),0<_.length&&(f=new pf("onSelect","select",null,f,g),c.push({event:f,listeners:_}),f.target=$e)))}function st(c,f){var g={};return g[c.toLowerCase()]=f.toLowerCase(),g["Webkit"+c]="webkit"+f,g["Moz"+c]="moz"+f,g}var Ve={animationend:st("Animation","AnimationEnd"),animationiteration:st("Animation","AnimationIteration"),animationstart:st("Animation","AnimationStart"),transitionrun:st("Transition","TransitionRun"),transitionstart:st("Transition","TransitionStart"),transitioncancel:st("Transition","TransitionCancel"),transitionend:st("Transition","TransitionEnd")},et={},ot={};Ta&&(ot=document.createElement("div").style,"AnimationEvent"in window||(delete Ve.animationend.animation,delete Ve.animationiteration.animation,delete Ve.animationstart.animation),"TransitionEvent"in window||delete Ve.transitionend.transition);function Xe(c){if(et[c])return et[c];if(!Ve[c])return c;var f=Ve[c],g;for(g in f)if(f.hasOwnProperty(g)&&g in ot)return et[c]=f[g];return c}var ht=Xe("animationend"),bt=Xe("animationiteration"),wt=Xe("animationstart"),Et=Xe("transitionrun"),Ut=Xe("transitionstart"),Kt=Xe("transitioncancel"),$t=Xe("transitionend"),Ht=new Map,Zt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zt.push("scrollEnd");function Bt(c,f){Ht.set(c,f),po(f,[c])}var tn=new WeakMap;function pn(c,f){if(typeof c=="object"&&c!==null){var g=tn.get(c);return g!==void 0?g:(f={value:c,source:f,stack:Ap(f)},tn.set(c,f),f)}return{value:c,source:f,stack:Ap(f)}}var gn=[],Nn=0,Ha=0;function _n(){for(var c=Nn,f=Ha=Nn=0;f<c;){var g=gn[f];gn[f++]=null;var _=gn[f];gn[f++]=null;var N=gn[f];gn[f++]=null;var P=gn[f];if(gn[f++]=null,_!==null&&N!==null){var se=_.pending;se===null?N.next=N:(N.next=se.next,se.next=N),_.pending=N}P!==0&&Na(g,N,P)}}function ra(c,f,g,_){gn[Nn++]=c,gn[Nn++]=f,gn[Nn++]=g,gn[Nn++]=_,Ha|=_,c.lanes|=_,c=c.alternate,c!==null&&(c.lanes|=_)}function ca(c,f,g,_){return ra(c,f,g,_),us(c)}function Ps(c,f){return ra(c,null,null,f),us(c)}function Na(c,f,g){c.lanes|=g;var _=c.alternate;_!==null&&(_.lanes|=g);for(var N=!1,P=c.return;P!==null;)P.childLanes|=g,_=P.alternate,_!==null&&(_.childLanes|=g),P.tag===22&&(c=P.stateNode,c===null||c._visibility&1||(N=!0)),c=P,P=P.return;return c.tag===3?(P=c.stateNode,N&&f!==null&&(N=31-Wt(g),c=P.hiddenUpdates,_=c[N],_===null?c[N]=[f]:_.push(f),f.lane=g|536870912),P):null}function us(c){if(50<bm)throw bm=0,m_=null,Error(r(185));for(var f=c.return;f!==null;)c=f,f=c.return;return c.tag===3?c.stateNode:null}var _o={};function kz(c,f,g,_){this.tag=c,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qi(c,f,g,_){return new kz(c,f,g,_)}function u1(c){return c=c.prototype,!(!c||!c.isReactComponent)}function hl(c,f){var g=c.alternate;return g===null?(g=qi(c.tag,f,c.key,c.mode),g.elementType=c.elementType,g.type=c.type,g.stateNode=c.stateNode,g.alternate=c,c.alternate=g):(g.pendingProps=f,g.type=c.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=c.flags&65011712,g.childLanes=c.childLanes,g.lanes=c.lanes,g.child=c.child,g.memoizedProps=c.memoizedProps,g.memoizedState=c.memoizedState,g.updateQueue=c.updateQueue,f=c.dependencies,g.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},g.sibling=c.sibling,g.index=c.index,g.ref=c.ref,g.refCleanup=c.refCleanup,g}function cA(c,f){c.flags&=65011714;var g=c.alternate;return g===null?(c.childLanes=0,c.lanes=f,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=g.childLanes,c.lanes=g.lanes,c.child=g.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=g.memoizedProps,c.memoizedState=g.memoizedState,c.updateQueue=g.updateQueue,c.type=g.type,f=g.dependencies,c.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),c}function gy(c,f,g,_,N,P){var se=0;if(_=c,typeof c=="function")u1(c)&&(se=1);else if(typeof c=="string")se=A7(c,g,me.current)?26:c==="html"||c==="head"||c==="body"?27:5;else e:switch(c){case $:return c=qi(31,g,f,N),c.elementType=$,c.lanes=P,c;case v:return Zu(g.children,N,P,f);case b:se=8,N|=24;break;case w:return c=qi(12,g,f,N|2),c.elementType=w,c.lanes=P,c;case k:return c=qi(13,g,f,N),c.elementType=k,c.lanes=P,c;case R:return c=qi(19,g,f,N),c.elementType=R,c.lanes=P,c;default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case x:case E:se=10;break e;case S:se=9;break e;case C:se=11;break e;case O:se=14;break e;case j:se=16,_=null;break e}se=29,g=Error(r(130,c===null?"null":typeof c,"")),_=null}return f=qi(se,g,f,N),f.elementType=c,f.type=_,f.lanes=P,f}function Zu(c,f,g,_){return c=qi(7,c,_,f),c.lanes=g,c}function d1(c,f,g){return c=qi(6,c,null,f),c.lanes=g,c}function f1(c,f,g){return f=qi(4,c.children!==null?c.children:[],c.key,f),f.lanes=g,f.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},f}var Rf=[],If=0,yy=null,by=0,ds=[],fs=0,Yu=null,pl=1,ml="";function Xu(c,f){Rf[If++]=by,Rf[If++]=yy,yy=c,by=f}function uA(c,f,g){ds[fs++]=pl,ds[fs++]=ml,ds[fs++]=Yu,Yu=c;var _=pl;c=ml;var N=32-Wt(_)-1;_&=~(1<<N),g+=1;var P=32-Wt(f)+N;if(30<P){var se=N-N%5;P=(_&(1<<se)-1).toString(32),_>>=se,N-=se,pl=1<<32-Wt(f)+N|g<<N|_,ml=P+c}else pl=1<<P|g<<N|_,ml=c}function h1(c){c.return!==null&&(Xu(c,1),uA(c,1,0))}function p1(c){for(;c===yy;)yy=Rf[--If],Rf[If]=null,by=Rf[--If],Rf[If]=null;for(;c===Yu;)Yu=ds[--fs],ds[fs]=null,ml=ds[--fs],ds[fs]=null,pl=ds[--fs],ds[fs]=null}var yi=null,Jr=null,lr=!1,Ju=null,So=!1,m1=Error(r(519));function Qu(c){var f=Error(r(418,""));throw Yp(pn(f,c)),m1}function dA(c){var f=c.stateNode,g=c.type,_=c.memoizedProps;switch(f[he]=c,f[Ae]=_,g){case"dialog":Wn("cancel",f),Wn("close",f);break;case"iframe":case"object":case"embed":Wn("load",f);break;case"video":case"audio":for(g=0;g<wm.length;g++)Wn(wm[g],f);break;case"source":Wn("error",f);break;case"img":case"image":case"link":Wn("error",f),Wn("load",f);break;case"details":Wn("toggle",f);break;case"input":Wn("invalid",f),Ip(f,_.value,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name,!0),bo(f);break;case"select":Wn("invalid",f);break;case"textarea":Wn("invalid",f),jp(f,_.value,_.defaultValue,_.children),bo(f)}g=_.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||f.textContent===""+g||_.suppressHydrationWarning===!0||AR(f.textContent,g)?(_.popover!=null&&(Wn("beforetoggle",f),Wn("toggle",f)),_.onScroll!=null&&Wn("scroll",f),_.onScrollEnd!=null&&Wn("scrollend",f),_.onClick!=null&&(f.onclick=Jy),f=!0):f=!1,f||Qu(c)}function fA(c){for(yi=c.return;yi;)switch(yi.tag){case 5:case 13:So=!1;return;case 27:case 3:So=!0;return;default:yi=yi.return}}function Kp(c){if(c!==yi)return!1;if(!lr)return fA(c),lr=!0,!1;var f=c.tag,g;if((g=f!==3&&f!==27)&&((g=f===5)&&(g=c.type,g=!(g!=="form"&&g!=="button")||I_(c.type,c.memoizedProps)),g=!g),g&&Jr&&Qu(c),fA(c),f===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(317));e:{for(c=c.nextSibling,f=0;c;){if(c.nodeType===8)if(g=c.data,g==="/$"){if(f===0){Jr=Ls(c.nextSibling);break e}f--}else g!=="$"&&g!=="$!"&&g!=="$?"||f++;c=c.nextSibling}Jr=null}}else f===27?(f=Jr,Oc(c.type)?(c=M_,M_=null,Jr=c):Jr=f):Jr=yi?Ls(c.stateNode.nextSibling):null;return!0}function Zp(){Jr=yi=null,lr=!1}function hA(){var c=Ju;return c!==null&&(Ni===null?Ni=c:Ni.push.apply(Ni,c),Ju=null),c}function Yp(c){Ju===null?Ju=[c]:Ju.push(c)}var g1=J(null),ed=null,gl=null;function bc(c,f,g){oe(g1,f._currentValue),f._currentValue=g}function yl(c){c._currentValue=g1.current,ee(g1)}function y1(c,f,g){for(;c!==null;){var _=c.alternate;if((c.childLanes&f)!==f?(c.childLanes|=f,_!==null&&(_.childLanes|=f)):_!==null&&(_.childLanes&f)!==f&&(_.childLanes|=f),c===g)break;c=c.return}}function b1(c,f,g,_){var N=c.child;for(N!==null&&(N.return=c);N!==null;){var P=N.dependencies;if(P!==null){var se=N.child;P=P.firstContext;e:for(;P!==null;){var Se=P;P=N;for(var ze=0;ze<f.length;ze++)if(Se.context===f[ze]){P.lanes|=g,Se=P.alternate,Se!==null&&(Se.lanes|=g),y1(P.return,g,c),_||(se=null);break e}P=Se.next}}else if(N.tag===18){if(se=N.return,se===null)throw Error(r(341));se.lanes|=g,P=se.alternate,P!==null&&(P.lanes|=g),y1(se,g,c),se=null}else se=N.child;if(se!==null)se.return=N;else for(se=N;se!==null;){if(se===c){se=null;break}if(N=se.sibling,N!==null){N.return=se.return,se=N;break}se=se.return}N=se}}function Xp(c,f,g,_){c=null;for(var N=f,P=!1;N!==null;){if(!P){if((N.flags&524288)!==0)P=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var se=N.alternate;if(se===null)throw Error(r(387));if(se=se.memoizedProps,se!==null){var Se=N.type;ei(N.pendingProps.value,se.value)||(c!==null?c.push(Se):c=[Se])}}else if(N===Ne.current){if(se=N.alternate,se===null)throw Error(r(387));se.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(c!==null?c.push(km):c=[km])}N=N.return}c!==null&&b1(f,c,g,_),f.flags|=262144}function vy(c){for(c=c.firstContext;c!==null;){if(!ei(c.context._currentValue,c.memoizedValue))return!0;c=c.next}return!1}function td(c){ed=c,gl=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function ti(c){return pA(ed,c)}function wy(c,f){return ed===null&&td(c),pA(c,f)}function pA(c,f){var g=f._currentValue;if(f={context:f,memoizedValue:g,next:null},gl===null){if(c===null)throw Error(r(308));gl=f,c.dependencies={lanes:0,firstContext:f},c.flags|=524288}else gl=gl.next=f;return g}var Tz=typeof AbortController<"u"?AbortController:function(){var c=[],f=this.signal={aborted:!1,addEventListener:function(g,_){c.push(_)}};this.abort=function(){f.aborted=!0,c.forEach(function(g){return g()})}},Az=e.unstable_scheduleCallback,Nz=e.unstable_NormalPriority,ya={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function v1(){return{controller:new Tz,data:new Map,refCount:0}}function Jp(c){c.refCount--,c.refCount===0&&Az(Nz,function(){c.controller.abort()})}var Qp=null,w1=0,jf=0,Of=null;function Rz(c,f){if(Qp===null){var g=Qp=[];w1=0,jf=__(),Of={status:"pending",value:void 0,then:function(_){g.push(_)}}}return w1++,f.then(mA,mA),f}function mA(){if(--w1===0&&Qp!==null){Of!==null&&(Of.status="fulfilled");var c=Qp;Qp=null,jf=0,Of=null;for(var f=0;f<c.length;f++)(0,c[f])()}}function Iz(c,f){var g=[],_={status:"pending",value:null,reason:null,then:function(N){g.push(N)}};return c.then(function(){_.status="fulfilled",_.value=f;for(var N=0;N<g.length;N++)(0,g[N])(f)},function(N){for(_.status="rejected",_.reason=N,N=0;N<g.length;N++)(0,g[N])(void 0)}),_}var gA=re.S;re.S=function(c,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&Rz(c,f),gA!==null&&gA(c,f)};var nd=J(null);function x1(){var c=nd.current;return c!==null?c:Mr.pooledCache}function xy(c,f){f===null?oe(nd,nd.current):oe(nd,f.pool)}function yA(){var c=x1();return c===null?null:{parent:ya._currentValue,pool:c}}var em=Error(r(460)),bA=Error(r(474)),_y=Error(r(542)),_1={then:function(){}};function vA(c){return c=c.status,c==="fulfilled"||c==="rejected"}function Sy(){}function wA(c,f,g){switch(g=c[g],g===void 0?c.push(f):g!==f&&(f.then(Sy,Sy),f=g),f.status){case"fulfilled":return f.value;case"rejected":throw c=f.reason,_A(c),c;default:if(typeof f.status=="string")f.then(Sy,Sy);else{if(c=Mr,c!==null&&100<c.shellSuspendCounter)throw Error(r(482));c=f,c.status="pending",c.then(function(_){if(f.status==="pending"){var N=f;N.status="fulfilled",N.value=_}},function(_){if(f.status==="pending"){var N=f;N.status="rejected",N.reason=_}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw c=f.reason,_A(c),c}throw tm=f,em}}var tm=null;function xA(){if(tm===null)throw Error(r(459));var c=tm;return tm=null,c}function _A(c){if(c===em||c===_y)throw Error(r(483))}var vc=!1;function S1(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function E1(c,f){c=c.updateQueue,f.updateQueue===c&&(f.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function wc(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function xc(c,f,g){var _=c.updateQueue;if(_===null)return null;if(_=_.shared,(mr&2)!==0){var N=_.pending;return N===null?f.next=f:(f.next=N.next,N.next=f),_.pending=f,f=us(c),Na(c,null,g),f}return ra(c,_,f,g),us(c)}function nm(c,f,g){if(f=f.updateQueue,f!==null&&(f=f.shared,(g&4194048)!==0)){var _=f.lanes;_&=c.pendingLanes,g|=_,f.lanes=g,Ke(c,g)}}function C1(c,f){var g=c.updateQueue,_=c.alternate;if(_!==null&&(_=_.updateQueue,g===_)){var N=null,P=null;if(g=g.firstBaseUpdate,g!==null){do{var se={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};P===null?N=P=se:P=P.next=se,g=g.next}while(g!==null);P===null?N=P=f:P=P.next=f}else N=P=f;g={baseState:_.baseState,firstBaseUpdate:N,lastBaseUpdate:P,shared:_.shared,callbacks:_.callbacks},c.updateQueue=g;return}c=g.lastBaseUpdate,c===null?g.firstBaseUpdate=f:c.next=f,g.lastBaseUpdate=f}var k1=!1;function rm(){if(k1){var c=Of;if(c!==null)throw c}}function am(c,f,g,_){k1=!1;var N=c.updateQueue;vc=!1;var P=N.firstBaseUpdate,se=N.lastBaseUpdate,Se=N.shared.pending;if(Se!==null){N.shared.pending=null;var ze=Se,dt=ze.next;ze.next=null,se===null?P=dt:se.next=dt,se=ze;var Ct=c.alternate;Ct!==null&&(Ct=Ct.updateQueue,Se=Ct.lastBaseUpdate,Se!==se&&(Se===null?Ct.firstBaseUpdate=dt:Se.next=dt,Ct.lastBaseUpdate=ze))}if(P!==null){var It=N.baseState;se=0,Ct=dt=ze=null,Se=P;do{var mt=Se.lane&-536870913,yt=mt!==Se.lane;if(yt?(tr&mt)===mt:(_&mt)===mt){mt!==0&&mt===jf&&(k1=!0),Ct!==null&&(Ct=Ct.next={lane:0,tag:Se.tag,payload:Se.payload,callback:null,next:null});e:{var Sn=c,yn=Se;mt=f;var Er=g;switch(yn.tag){case 1:if(Sn=yn.payload,typeof Sn=="function"){It=Sn.call(Er,It,mt);break e}It=Sn;break e;case 3:Sn.flags=Sn.flags&-65537|128;case 0:if(Sn=yn.payload,mt=typeof Sn=="function"?Sn.call(Er,It,mt):Sn,mt==null)break e;It=d({},It,mt);break e;case 2:vc=!0}}mt=Se.callback,mt!==null&&(c.flags|=64,yt&&(c.flags|=8192),yt=N.callbacks,yt===null?N.callbacks=[mt]:yt.push(mt))}else yt={lane:mt,tag:Se.tag,payload:Se.payload,callback:Se.callback,next:null},Ct===null?(dt=Ct=yt,ze=It):Ct=Ct.next=yt,se|=mt;if(Se=Se.next,Se===null){if(Se=N.shared.pending,Se===null)break;yt=Se,Se=yt.next,yt.next=null,N.lastBaseUpdate=yt,N.shared.pending=null}}while(!0);Ct===null&&(ze=It),N.baseState=ze,N.firstBaseUpdate=dt,N.lastBaseUpdate=Ct,P===null&&(N.shared.lanes=0),Nc|=se,c.lanes=se,c.memoizedState=It}}function SA(c,f){if(typeof c!="function")throw Error(r(191,c));c.call(f)}function EA(c,f){var g=c.callbacks;if(g!==null)for(c.callbacks=null,c=0;c<g.length;c++)SA(g[c],f)}var Df=J(null),Ey=J(0);function CA(c,f){c=El,oe(Ey,c),oe(Df,f),El=c|f.baseLanes}function T1(){oe(Ey,El),oe(Df,Df.current)}function A1(){El=Ey.current,ee(Df),ee(Ey)}var _c=0,$n=null,_r=null,ua=null,Cy=!1,Mf=!1,rd=!1,ky=0,im=0,Pf=null,jz=0;function aa(){throw Error(r(321))}function N1(c,f){if(f===null)return!1;for(var g=0;g<f.length&&g<c.length;g++)if(!ei(c[g],f[g]))return!1;return!0}function R1(c,f,g,_,N,P){return _c=P,$n=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,re.H=c===null||c.memoizedState===null?lN:cN,rd=!1,P=g(_,N),rd=!1,Mf&&(P=TA(f,g,_,N)),kA(c),P}function kA(c){re.H=jy;var f=_r!==null&&_r.next!==null;if(_c=0,ua=_r=$n=null,Cy=!1,im=0,Pf=null,f)throw Error(r(300));c===null||Ra||(c=c.dependencies,c!==null&&vy(c)&&(Ra=!0))}function TA(c,f,g,_){$n=c;var N=0;do{if(Mf&&(Pf=null),im=0,Mf=!1,25<=N)throw Error(r(301));if(N+=1,ua=_r=null,c.updateQueue!=null){var P=c.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}re.H=$z,P=f(g,_)}while(Mf);return P}function Oz(){var c=re.H,f=c.useState()[0];return f=typeof f.then=="function"?sm(f):f,c=c.useState()[0],(_r!==null?_r.memoizedState:null)!==c&&($n.flags|=1024),f}function I1(){var c=ky!==0;return ky=0,c}function j1(c,f,g){f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~g}function O1(c){if(Cy){for(c=c.memoizedState;c!==null;){var f=c.queue;f!==null&&(f.pending=null),c=c.next}Cy=!1}_c=0,ua=_r=$n=null,Mf=!1,im=ky=0,Pf=null}function Ti(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ua===null?$n.memoizedState=ua=c:ua=ua.next=c,ua}function da(){if(_r===null){var c=$n.alternate;c=c!==null?c.memoizedState:null}else c=_r.next;var f=ua===null?$n.memoizedState:ua.next;if(f!==null)ua=f,_r=c;else{if(c===null)throw $n.alternate===null?Error(r(467)):Error(r(310));_r=c,c={memoizedState:_r.memoizedState,baseState:_r.baseState,baseQueue:_r.baseQueue,queue:_r.queue,next:null},ua===null?$n.memoizedState=ua=c:ua=ua.next=c}return ua}function D1(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function sm(c){var f=im;return im+=1,Pf===null&&(Pf=[]),c=wA(Pf,c,f),f=$n,(ua===null?f.memoizedState:ua.next)===null&&(f=f.alternate,re.H=f===null||f.memoizedState===null?lN:cN),c}function Ty(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return sm(c);if(c.$$typeof===E)return ti(c)}throw Error(r(438,String(c)))}function M1(c){var f=null,g=$n.updateQueue;if(g!==null&&(f=g.memoCache),f==null){var _=$n.alternate;_!==null&&(_=_.updateQueue,_!==null&&(_=_.memoCache,_!=null&&(f={data:_.data.map(function(N){return N.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),g===null&&(g=D1(),$n.updateQueue=g),g.memoCache=f,g=f.data[f.index],g===void 0)for(g=f.data[f.index]=Array(c),_=0;_<c;_++)g[_]=L;return f.index++,g}function bl(c,f){return typeof f=="function"?f(c):f}function Ay(c){var f=da();return P1(f,_r,c)}function P1(c,f,g){var _=c.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=g;var N=c.baseQueue,P=_.pending;if(P!==null){if(N!==null){var se=N.next;N.next=P.next,P.next=se}f.baseQueue=N=P,_.pending=null}if(P=c.baseState,N===null)c.memoizedState=P;else{f=N.next;var Se=se=null,ze=null,dt=f,Ct=!1;do{var It=dt.lane&-536870913;if(It!==dt.lane?(tr&It)===It:(_c&It)===It){var mt=dt.revertLane;if(mt===0)ze!==null&&(ze=ze.next={lane:0,revertLane:0,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),It===jf&&(Ct=!0);else if((_c&mt)===mt){dt=dt.next,mt===jf&&(Ct=!0);continue}else It={lane:0,revertLane:dt.revertLane,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},ze===null?(Se=ze=It,se=P):ze=ze.next=It,$n.lanes|=mt,Nc|=mt;It=dt.action,rd&&g(P,It),P=dt.hasEagerState?dt.eagerState:g(P,It)}else mt={lane:It,revertLane:dt.revertLane,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},ze===null?(Se=ze=mt,se=P):ze=ze.next=mt,$n.lanes|=It,Nc|=It;dt=dt.next}while(dt!==null&&dt!==f);if(ze===null?se=P:ze.next=Se,!ei(P,c.memoizedState)&&(Ra=!0,Ct&&(g=Of,g!==null)))throw g;c.memoizedState=P,c.baseState=se,c.baseQueue=ze,_.lastRenderedState=P}return N===null&&(_.lanes=0),[c.memoizedState,_.dispatch]}function F1(c){var f=da(),g=f.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=c;var _=g.dispatch,N=g.pending,P=f.memoizedState;if(N!==null){g.pending=null;var se=N=N.next;do P=c(P,se.action),se=se.next;while(se!==N);ei(P,f.memoizedState)||(Ra=!0),f.memoizedState=P,f.baseQueue===null&&(f.baseState=P),g.lastRenderedState=P}return[P,_]}function AA(c,f,g){var _=$n,N=da(),P=lr;if(P){if(g===void 0)throw Error(r(407));g=g()}else g=f();var se=!ei((_r||N).memoizedState,g);se&&(N.memoizedState=g,Ra=!0),N=N.queue;var Se=IA.bind(null,_,N,c);if(om(2048,8,Se,[c]),N.getSnapshot!==f||se||ua!==null&&ua.memoizedState.tag&1){if(_.flags|=2048,Ff(9,Ny(),RA.bind(null,_,N,g,f),null),Mr===null)throw Error(r(349));P||(_c&124)!==0||NA(_,f,g)}return g}function NA(c,f,g){c.flags|=16384,c={getSnapshot:f,value:g},f=$n.updateQueue,f===null?(f=D1(),$n.updateQueue=f,f.stores=[c]):(g=f.stores,g===null?f.stores=[c]:g.push(c))}function RA(c,f,g,_){f.value=g,f.getSnapshot=_,jA(f)&&OA(c)}function IA(c,f,g){return g(function(){jA(f)&&OA(c)})}function jA(c){var f=c.getSnapshot;c=c.value;try{var g=f();return!ei(c,g)}catch{return!0}}function OA(c){var f=Ps(c,2);f!==null&&Ki(f,c,2)}function L1(c){var f=Ti();if(typeof c=="function"){var g=c;if(c=g(),rd){Ot(!0);try{g()}finally{Ot(!1)}}}return f.memoizedState=f.baseState=c,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:c},f}function DA(c,f,g,_){return c.baseState=g,P1(c,_r,typeof _=="function"?_:bl)}function Dz(c,f,g,_,N){if(Iy(c))throw Error(r(485));if(c=f.action,c!==null){var P={payload:N,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(se){P.listeners.push(se)}};re.T!==null?g(!0):P.isTransition=!1,_(P),g=f.pending,g===null?(P.next=f.pending=P,MA(f,P)):(P.next=g.next,f.pending=g.next=P)}}function MA(c,f){var g=f.action,_=f.payload,N=c.state;if(f.isTransition){var P=re.T,se={};re.T=se;try{var Se=g(N,_),ze=re.S;ze!==null&&ze(se,Se),PA(c,f,Se)}catch(dt){$1(c,f,dt)}finally{re.T=P}}else try{P=g(N,_),PA(c,f,P)}catch(dt){$1(c,f,dt)}}function PA(c,f,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(_){FA(c,f,_)},function(_){return $1(c,f,_)}):FA(c,f,g)}function FA(c,f,g){f.status="fulfilled",f.value=g,LA(f),c.state=g,f=c.pending,f!==null&&(g=f.next,g===f?c.pending=null:(g=g.next,f.next=g,MA(c,g)))}function $1(c,f,g){var _=c.pending;if(c.pending=null,_!==null){_=_.next;do f.status="rejected",f.reason=g,LA(f),f=f.next;while(f!==_)}c.action=null}function LA(c){c=c.listeners;for(var f=0;f<c.length;f++)(0,c[f])()}function $A(c,f){return f}function BA(c,f){if(lr){var g=Mr.formState;if(g!==null){e:{var _=$n;if(lr){if(Jr){t:{for(var N=Jr,P=So;N.nodeType!==8;){if(!P){N=null;break t}if(N=Ls(N.nextSibling),N===null){N=null;break t}}P=N.data,N=P==="F!"||P==="F"?N:null}if(N){Jr=Ls(N.nextSibling),_=N.data==="F!";break e}}Qu(_)}_=!1}_&&(f=g[0])}}return g=Ti(),g.memoizedState=g.baseState=f,_={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$A,lastRenderedState:f},g.queue=_,g=iN.bind(null,$n,_),_.dispatch=g,_=L1(!1),P=H1.bind(null,$n,!1,_.queue),_=Ti(),N={state:f,dispatch:null,action:c,pending:null},_.queue=N,g=Dz.bind(null,$n,N,P,g),N.dispatch=g,_.memoizedState=c,[f,g,!1]}function zA(c){var f=da();return UA(f,_r,c)}function UA(c,f,g){if(f=P1(c,f,$A)[0],c=Ay(bl)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var _=sm(f)}catch(se){throw se===em?_y:se}else _=f;f=da();var N=f.queue,P=N.dispatch;return g!==f.memoizedState&&($n.flags|=2048,Ff(9,Ny(),Mz.bind(null,N,g),null)),[_,P,c]}function Mz(c,f){c.action=f}function qA(c){var f=da(),g=_r;if(g!==null)return UA(f,g,c);da(),f=f.memoizedState,g=da();var _=g.queue.dispatch;return g.memoizedState=c,[f,_,!1]}function Ff(c,f,g,_){return c={tag:c,create:g,deps:_,inst:f,next:null},f=$n.updateQueue,f===null&&(f=D1(),$n.updateQueue=f),g=f.lastEffect,g===null?f.lastEffect=c.next=c:(_=g.next,g.next=c,c.next=_,f.lastEffect=c),c}function Ny(){return{destroy:void 0,resource:void 0}}function HA(){return da().memoizedState}function Ry(c,f,g,_){var N=Ti();_=_===void 0?null:_,$n.flags|=c,N.memoizedState=Ff(1|f,Ny(),g,_)}function om(c,f,g,_){var N=da();_=_===void 0?null:_;var P=N.memoizedState.inst;_r!==null&&_!==null&&N1(_,_r.memoizedState.deps)?N.memoizedState=Ff(f,P,g,_):($n.flags|=c,N.memoizedState=Ff(1|f,P,g,_))}function VA(c,f){Ry(8390656,8,c,f)}function GA(c,f){om(2048,8,c,f)}function WA(c,f){return om(4,2,c,f)}function KA(c,f){return om(4,4,c,f)}function ZA(c,f){if(typeof f=="function"){c=c();var g=f(c);return function(){typeof g=="function"?g():f(null)}}if(f!=null)return c=c(),f.current=c,function(){f.current=null}}function YA(c,f,g){g=g!=null?g.concat([c]):null,om(4,4,ZA.bind(null,f,c),g)}function B1(){}function XA(c,f){var g=da();f=f===void 0?null:f;var _=g.memoizedState;return f!==null&&N1(f,_[1])?_[0]:(g.memoizedState=[c,f],c)}function JA(c,f){var g=da();f=f===void 0?null:f;var _=g.memoizedState;if(f!==null&&N1(f,_[1]))return _[0];if(_=c(),rd){Ot(!0);try{c()}finally{Ot(!1)}}return g.memoizedState=[_,f],_}function z1(c,f,g){return g===void 0||(_c&1073741824)!==0?c.memoizedState=f:(c.memoizedState=g,c=tR(),$n.lanes|=c,Nc|=c,g)}function QA(c,f,g,_){return ei(g,f)?g:Df.current!==null?(c=z1(c,g,_),ei(c,f)||(Ra=!0),c):(_c&42)===0?(Ra=!0,c.memoizedState=g):(c=tR(),$n.lanes|=c,Nc|=c,f)}function eN(c,f,g,_,N){var P=Y.p;Y.p=P!==0&&8>P?P:8;var se=re.T,Se={};re.T=Se,H1(c,!1,f,g);try{var ze=N(),dt=re.S;if(dt!==null&&dt(Se,ze),ze!==null&&typeof ze=="object"&&typeof ze.then=="function"){var Ct=Iz(ze,_);lm(c,f,Ct,Wi(c))}else lm(c,f,_,Wi(c))}catch(It){lm(c,f,{then:function(){},status:"rejected",reason:It},Wi())}finally{Y.p=P,re.T=se}}function Pz(){}function U1(c,f,g,_){if(c.tag!==5)throw Error(r(476));var N=tN(c).queue;eN(c,N,f,Q,g===null?Pz:function(){return nN(c),g(_)})}function tN(c){var f=c.memoizedState;if(f!==null)return f;f={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:Q},next:null};var g={};return f.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:g},next:null},c.memoizedState=f,c=c.alternate,c!==null&&(c.memoizedState=f),f}function nN(c){var f=tN(c).next.queue;lm(c,f,{},Wi())}function q1(){return ti(km)}function rN(){return da().memoizedState}function aN(){return da().memoizedState}function Fz(c){for(var f=c.return;f!==null;){switch(f.tag){case 24:case 3:var g=Wi();c=wc(g);var _=xc(f,c,g);_!==null&&(Ki(_,f,g),nm(_,f,g)),f={cache:v1()},c.payload=f;return}f=f.return}}function Lz(c,f,g){var _=Wi();g={lane:_,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null},Iy(c)?sN(f,g):(g=ca(c,f,g,_),g!==null&&(Ki(g,c,_),oN(g,f,_)))}function iN(c,f,g){var _=Wi();lm(c,f,g,_)}function lm(c,f,g,_){var N={lane:_,revertLane:0,action:g,hasEagerState:!1,eagerState:null,next:null};if(Iy(c))sN(f,N);else{var P=c.alternate;if(c.lanes===0&&(P===null||P.lanes===0)&&(P=f.lastRenderedReducer,P!==null))try{var se=f.lastRenderedState,Se=P(se,g);if(N.hasEagerState=!0,N.eagerState=Se,ei(Se,se))return ra(c,f,N,0),Mr===null&&_n(),!1}catch{}finally{}if(g=ca(c,f,N,_),g!==null)return Ki(g,c,_),oN(g,f,_),!0}return!1}function H1(c,f,g,_){if(_={lane:2,revertLane:__(),action:_,hasEagerState:!1,eagerState:null,next:null},Iy(c)){if(f)throw Error(r(479))}else f=ca(c,g,_,2),f!==null&&Ki(f,c,2)}function Iy(c){var f=c.alternate;return c===$n||f!==null&&f===$n}function sN(c,f){Mf=Cy=!0;var g=c.pending;g===null?f.next=f:(f.next=g.next,g.next=f),c.pending=f}function oN(c,f,g){if((g&4194048)!==0){var _=f.lanes;_&=c.pendingLanes,g|=_,f.lanes=g,Ke(c,g)}}var jy={readContext:ti,use:Ty,useCallback:aa,useContext:aa,useEffect:aa,useImperativeHandle:aa,useLayoutEffect:aa,useInsertionEffect:aa,useMemo:aa,useReducer:aa,useRef:aa,useState:aa,useDebugValue:aa,useDeferredValue:aa,useTransition:aa,useSyncExternalStore:aa,useId:aa,useHostTransitionStatus:aa,useFormState:aa,useActionState:aa,useOptimistic:aa,useMemoCache:aa,useCacheRefresh:aa},lN={readContext:ti,use:Ty,useCallback:function(c,f){return Ti().memoizedState=[c,f===void 0?null:f],c},useContext:ti,useEffect:VA,useImperativeHandle:function(c,f,g){g=g!=null?g.concat([c]):null,Ry(4194308,4,ZA.bind(null,f,c),g)},useLayoutEffect:function(c,f){return Ry(4194308,4,c,f)},useInsertionEffect:function(c,f){Ry(4,2,c,f)},useMemo:function(c,f){var g=Ti();f=f===void 0?null:f;var _=c();if(rd){Ot(!0);try{c()}finally{Ot(!1)}}return g.memoizedState=[_,f],_},useReducer:function(c,f,g){var _=Ti();if(g!==void 0){var N=g(f);if(rd){Ot(!0);try{g(f)}finally{Ot(!1)}}}else N=f;return _.memoizedState=_.baseState=N,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:N},_.queue=c,c=c.dispatch=Lz.bind(null,$n,c),[_.memoizedState,c]},useRef:function(c){var f=Ti();return c={current:c},f.memoizedState=c},useState:function(c){c=L1(c);var f=c.queue,g=iN.bind(null,$n,f);return f.dispatch=g,[c.memoizedState,g]},useDebugValue:B1,useDeferredValue:function(c,f){var g=Ti();return z1(g,c,f)},useTransition:function(){var c=L1(!1);return c=eN.bind(null,$n,c.queue,!0,!1),Ti().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,f,g){var _=$n,N=Ti();if(lr){if(g===void 0)throw Error(r(407));g=g()}else{if(g=f(),Mr===null)throw Error(r(349));(tr&124)!==0||NA(_,f,g)}N.memoizedState=g;var P={value:g,getSnapshot:f};return N.queue=P,VA(IA.bind(null,_,P,c),[c]),_.flags|=2048,Ff(9,Ny(),RA.bind(null,_,P,g,f),null),g},useId:function(){var c=Ti(),f=Mr.identifierPrefix;if(lr){var g=ml,_=pl;g=(_&~(1<<32-Wt(_)-1)).toString(32)+g,f=""+f+"R"+g,g=ky++,0<g&&(f+="H"+g.toString(32)),f+=""}else g=jz++,f=""+f+"r"+g.toString(32)+"";return c.memoizedState=f},useHostTransitionStatus:q1,useFormState:BA,useActionState:BA,useOptimistic:function(c){var f=Ti();f.memoizedState=f.baseState=c;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=g,f=H1.bind(null,$n,!0,g),g.dispatch=f,[c,f]},useMemoCache:M1,useCacheRefresh:function(){return Ti().memoizedState=Fz.bind(null,$n)}},cN={readContext:ti,use:Ty,useCallback:XA,useContext:ti,useEffect:GA,useImperativeHandle:YA,useInsertionEffect:WA,useLayoutEffect:KA,useMemo:JA,useReducer:Ay,useRef:HA,useState:function(){return Ay(bl)},useDebugValue:B1,useDeferredValue:function(c,f){var g=da();return QA(g,_r.memoizedState,c,f)},useTransition:function(){var c=Ay(bl)[0],f=da().memoizedState;return[typeof c=="boolean"?c:sm(c),f]},useSyncExternalStore:AA,useId:rN,useHostTransitionStatus:q1,useFormState:zA,useActionState:zA,useOptimistic:function(c,f){var g=da();return DA(g,_r,c,f)},useMemoCache:M1,useCacheRefresh:aN},$z={readContext:ti,use:Ty,useCallback:XA,useContext:ti,useEffect:GA,useImperativeHandle:YA,useInsertionEffect:WA,useLayoutEffect:KA,useMemo:JA,useReducer:F1,useRef:HA,useState:function(){return F1(bl)},useDebugValue:B1,useDeferredValue:function(c,f){var g=da();return _r===null?z1(g,c,f):QA(g,_r.memoizedState,c,f)},useTransition:function(){var c=F1(bl)[0],f=da().memoizedState;return[typeof c=="boolean"?c:sm(c),f]},useSyncExternalStore:AA,useId:rN,useHostTransitionStatus:q1,useFormState:qA,useActionState:qA,useOptimistic:function(c,f){var g=da();return _r!==null?DA(g,_r,c,f):(g.baseState=c,[c,g.queue.dispatch])},useMemoCache:M1,useCacheRefresh:aN},Lf=null,cm=0;function Oy(c){var f=cm;return cm+=1,Lf===null&&(Lf=[]),wA(Lf,c,f)}function um(c,f){f=f.props.ref,c.ref=f!==void 0?f:null}function Dy(c,f){throw f.$$typeof===h?Error(r(525)):(c=Object.prototype.toString.call(f),Error(r(31,c==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":c)))}function uN(c){var f=c._init;return f(c._payload)}function dN(c){function f(at,Ze){if(c){var ct=at.deletions;ct===null?(at.deletions=[Ze],at.flags|=16):ct.push(Ze)}}function g(at,Ze){if(!c)return null;for(;Ze!==null;)f(at,Ze),Ze=Ze.sibling;return null}function _(at){for(var Ze=new Map;at!==null;)at.key!==null?Ze.set(at.key,at):Ze.set(at.index,at),at=at.sibling;return Ze}function N(at,Ze){return at=hl(at,Ze),at.index=0,at.sibling=null,at}function P(at,Ze,ct){return at.index=ct,c?(ct=at.alternate,ct!==null?(ct=ct.index,ct<Ze?(at.flags|=67108866,Ze):ct):(at.flags|=67108866,Ze)):(at.flags|=1048576,Ze)}function se(at){return c&&at.alternate===null&&(at.flags|=67108866),at}function Se(at,Ze,ct,At){return Ze===null||Ze.tag!==6?(Ze=d1(ct,at.mode,At),Ze.return=at,Ze):(Ze=N(Ze,ct),Ze.return=at,Ze)}function ze(at,Ze,ct,At){var sn=ct.type;return sn===v?Ct(at,Ze,ct.props.children,At,ct.key):Ze!==null&&(Ze.elementType===sn||typeof sn=="object"&&sn!==null&&sn.$$typeof===j&&uN(sn)===Ze.type)?(Ze=N(Ze,ct.props),um(Ze,ct),Ze.return=at,Ze):(Ze=gy(ct.type,ct.key,ct.props,null,at.mode,At),um(Ze,ct),Ze.return=at,Ze)}function dt(at,Ze,ct,At){return Ze===null||Ze.tag!==4||Ze.stateNode.containerInfo!==ct.containerInfo||Ze.stateNode.implementation!==ct.implementation?(Ze=f1(ct,at.mode,At),Ze.return=at,Ze):(Ze=N(Ze,ct.children||[]),Ze.return=at,Ze)}function Ct(at,Ze,ct,At,sn){return Ze===null||Ze.tag!==7?(Ze=Zu(ct,at.mode,At,sn),Ze.return=at,Ze):(Ze=N(Ze,ct),Ze.return=at,Ze)}function It(at,Ze,ct){if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return Ze=d1(""+Ze,at.mode,ct),Ze.return=at,Ze;if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case p:return ct=gy(Ze.type,Ze.key,Ze.props,null,at.mode,ct),um(ct,Ze),ct.return=at,ct;case y:return Ze=f1(Ze,at.mode,ct),Ze.return=at,Ze;case j:var At=Ze._init;return Ze=At(Ze._payload),It(at,Ze,ct)}if(de(Ze)||F(Ze))return Ze=Zu(Ze,at.mode,ct,null),Ze.return=at,Ze;if(typeof Ze.then=="function")return It(at,Oy(Ze),ct);if(Ze.$$typeof===E)return It(at,wy(at,Ze),ct);Dy(at,Ze)}return null}function mt(at,Ze,ct,At){var sn=Ze!==null?Ze.key:null;if(typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint")return sn!==null?null:Se(at,Ze,""+ct,At);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case p:return ct.key===sn?ze(at,Ze,ct,At):null;case y:return ct.key===sn?dt(at,Ze,ct,At):null;case j:return sn=ct._init,ct=sn(ct._payload),mt(at,Ze,ct,At)}if(de(ct)||F(ct))return sn!==null?null:Ct(at,Ze,ct,At,null);if(typeof ct.then=="function")return mt(at,Ze,Oy(ct),At);if(ct.$$typeof===E)return mt(at,Ze,wy(at,ct),At);Dy(at,ct)}return null}function yt(at,Ze,ct,At,sn){if(typeof At=="string"&&At!==""||typeof At=="number"||typeof At=="bigint")return at=at.get(ct)||null,Se(Ze,at,""+At,sn);if(typeof At=="object"&&At!==null){switch(At.$$typeof){case p:return at=at.get(At.key===null?ct:At.key)||null,ze(Ze,at,At,sn);case y:return at=at.get(At.key===null?ct:At.key)||null,dt(Ze,at,At,sn);case j:var Un=At._init;return At=Un(At._payload),yt(at,Ze,ct,At,sn)}if(de(At)||F(At))return at=at.get(ct)||null,Ct(Ze,at,At,sn,null);if(typeof At.then=="function")return yt(at,Ze,ct,Oy(At),sn);if(At.$$typeof===E)return yt(at,Ze,ct,wy(Ze,At),sn);Dy(Ze,At)}return null}function Sn(at,Ze,ct,At){for(var sn=null,Un=null,fn=Ze,wn=Ze=0,ja=null;fn!==null&&wn<ct.length;wn++){fn.index>wn?(ja=fn,fn=null):ja=fn.sibling;var or=mt(at,fn,ct[wn],At);if(or===null){fn===null&&(fn=ja);break}c&&fn&&or.alternate===null&&f(at,fn),Ze=P(or,Ze,wn),Un===null?sn=or:Un.sibling=or,Un=or,fn=ja}if(wn===ct.length)return g(at,fn),lr&&Xu(at,wn),sn;if(fn===null){for(;wn<ct.length;wn++)fn=It(at,ct[wn],At),fn!==null&&(Ze=P(fn,Ze,wn),Un===null?sn=fn:Un.sibling=fn,Un=fn);return lr&&Xu(at,wn),sn}for(fn=_(fn);wn<ct.length;wn++)ja=yt(fn,at,wn,ct[wn],At),ja!==null&&(c&&ja.alternate!==null&&fn.delete(ja.key===null?wn:ja.key),Ze=P(ja,Ze,wn),Un===null?sn=ja:Un.sibling=ja,Un=ja);return c&&fn.forEach(function(Lc){return f(at,Lc)}),lr&&Xu(at,wn),sn}function yn(at,Ze,ct,At){if(ct==null)throw Error(r(151));for(var sn=null,Un=null,fn=Ze,wn=Ze=0,ja=null,or=ct.next();fn!==null&&!or.done;wn++,or=ct.next()){fn.index>wn?(ja=fn,fn=null):ja=fn.sibling;var Lc=mt(at,fn,or.value,At);if(Lc===null){fn===null&&(fn=ja);break}c&&fn&&Lc.alternate===null&&f(at,fn),Ze=P(Lc,Ze,wn),Un===null?sn=Lc:Un.sibling=Lc,Un=Lc,fn=ja}if(or.done)return g(at,fn),lr&&Xu(at,wn),sn;if(fn===null){for(;!or.done;wn++,or=ct.next())or=It(at,or.value,At),or!==null&&(Ze=P(or,Ze,wn),Un===null?sn=or:Un.sibling=or,Un=or);return lr&&Xu(at,wn),sn}for(fn=_(fn);!or.done;wn++,or=ct.next())or=yt(fn,at,wn,or.value,At),or!==null&&(c&&or.alternate!==null&&fn.delete(or.key===null?wn:or.key),Ze=P(or,Ze,wn),Un===null?sn=or:Un.sibling=or,Un=or);return c&&fn.forEach(function(B7){return f(at,B7)}),lr&&Xu(at,wn),sn}function Er(at,Ze,ct,At){if(typeof ct=="object"&&ct!==null&&ct.type===v&&ct.key===null&&(ct=ct.props.children),typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case p:e:{for(var sn=ct.key;Ze!==null;){if(Ze.key===sn){if(sn=ct.type,sn===v){if(Ze.tag===7){g(at,Ze.sibling),At=N(Ze,ct.props.children),At.return=at,at=At;break e}}else if(Ze.elementType===sn||typeof sn=="object"&&sn!==null&&sn.$$typeof===j&&uN(sn)===Ze.type){g(at,Ze.sibling),At=N(Ze,ct.props),um(At,ct),At.return=at,at=At;break e}g(at,Ze);break}else f(at,Ze);Ze=Ze.sibling}ct.type===v?(At=Zu(ct.props.children,at.mode,At,ct.key),At.return=at,at=At):(At=gy(ct.type,ct.key,ct.props,null,at.mode,At),um(At,ct),At.return=at,at=At)}return se(at);case y:e:{for(sn=ct.key;Ze!==null;){if(Ze.key===sn)if(Ze.tag===4&&Ze.stateNode.containerInfo===ct.containerInfo&&Ze.stateNode.implementation===ct.implementation){g(at,Ze.sibling),At=N(Ze,ct.children||[]),At.return=at,at=At;break e}else{g(at,Ze);break}else f(at,Ze);Ze=Ze.sibling}At=f1(ct,at.mode,At),At.return=at,at=At}return se(at);case j:return sn=ct._init,ct=sn(ct._payload),Er(at,Ze,ct,At)}if(de(ct))return Sn(at,Ze,ct,At);if(F(ct)){if(sn=F(ct),typeof sn!="function")throw Error(r(150));return ct=sn.call(ct),yn(at,Ze,ct,At)}if(typeof ct.then=="function")return Er(at,Ze,Oy(ct),At);if(ct.$$typeof===E)return Er(at,Ze,wy(at,ct),At);Dy(at,ct)}return typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint"?(ct=""+ct,Ze!==null&&Ze.tag===6?(g(at,Ze.sibling),At=N(Ze,ct),At.return=at,at=At):(g(at,Ze),At=d1(ct,at.mode,At),At.return=at,at=At),se(at)):g(at,Ze)}return function(at,Ze,ct,At){try{cm=0;var sn=Er(at,Ze,ct,At);return Lf=null,sn}catch(fn){if(fn===em||fn===_y)throw fn;var Un=qi(29,fn,null,at.mode);return Un.lanes=At,Un.return=at,Un}finally{}}}var $f=dN(!0),fN=dN(!1),hs=J(null),Eo=null;function Sc(c){var f=c.alternate;oe(ba,ba.current&1),oe(hs,c),Eo===null&&(f===null||Df.current!==null||f.memoizedState!==null)&&(Eo=c)}function hN(c){if(c.tag===22){if(oe(ba,ba.current),oe(hs,c),Eo===null){var f=c.alternate;f!==null&&f.memoizedState!==null&&(Eo=c)}}else Ec()}function Ec(){oe(ba,ba.current),oe(hs,hs.current)}function vl(c){ee(hs),Eo===c&&(Eo=null),ee(ba)}var ba=J(0);function My(c){for(var f=c;f!==null;){if(f.tag===13){var g=f.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||D_(g)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function V1(c,f,g,_){f=c.memoizedState,g=g(_,f),g=g==null?f:d({},f,g),c.memoizedState=g,c.lanes===0&&(c.updateQueue.baseState=g)}var G1={enqueueSetState:function(c,f,g){c=c._reactInternals;var _=Wi(),N=wc(_);N.payload=f,g!=null&&(N.callback=g),f=xc(c,N,_),f!==null&&(Ki(f,c,_),nm(f,c,_))},enqueueReplaceState:function(c,f,g){c=c._reactInternals;var _=Wi(),N=wc(_);N.tag=1,N.payload=f,g!=null&&(N.callback=g),f=xc(c,N,_),f!==null&&(Ki(f,c,_),nm(f,c,_))},enqueueForceUpdate:function(c,f){c=c._reactInternals;var g=Wi(),_=wc(g);_.tag=2,f!=null&&(_.callback=f),f=xc(c,_,g),f!==null&&(Ki(f,c,g),nm(f,c,g))}};function pN(c,f,g,_,N,P,se){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(_,P,se):f.prototype&&f.prototype.isPureReactComponent?!A(g,_)||!A(N,P):!0}function mN(c,f,g,_){c=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(g,_),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(g,_),f.state!==c&&G1.enqueueReplaceState(f,f.state,null)}function ad(c,f){var g=f;if("ref"in f){g={};for(var _ in f)_!=="ref"&&(g[_]=f[_])}if(c=c.defaultProps){g===f&&(g=d({},g));for(var N in c)g[N]===void 0&&(g[N]=c[N])}return g}var Py=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(f))return}else if(typeof ea=="object"&&typeof ea.emit=="function"){ea.emit("uncaughtException",c);return}console.error(c)};function gN(c){Py(c)}function yN(c){console.error(c)}function bN(c){Py(c)}function Fy(c,f){try{var g=c.onUncaughtError;g(f.value,{componentStack:f.stack})}catch(_){setTimeout(function(){throw _})}}function vN(c,f,g){try{var _=c.onCaughtError;_(g.value,{componentStack:g.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function W1(c,f,g){return g=wc(g),g.tag=3,g.payload={element:null},g.callback=function(){Fy(c,f)},g}function wN(c){return c=wc(c),c.tag=3,c}function xN(c,f,g,_){var N=g.type.getDerivedStateFromError;if(typeof N=="function"){var P=_.value;c.payload=function(){return N(P)},c.callback=function(){vN(f,g,_)}}var se=g.stateNode;se!==null&&typeof se.componentDidCatch=="function"&&(c.callback=function(){vN(f,g,_),typeof N!="function"&&(Rc===null?Rc=new Set([this]):Rc.add(this));var Se=_.stack;this.componentDidCatch(_.value,{componentStack:Se!==null?Se:""})})}function Bz(c,f,g,_,N){if(g.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){if(f=g.alternate,f!==null&&Xp(f,g,N,!0),g=hs.current,g!==null){switch(g.tag){case 13:return Eo===null?y_():g.alternate===null&&Qr===0&&(Qr=3),g.flags&=-257,g.flags|=65536,g.lanes=N,_===_1?g.flags|=16384:(f=g.updateQueue,f===null?g.updateQueue=new Set([_]):f.add(_),v_(c,_,N)),!1;case 22:return g.flags|=65536,_===_1?g.flags|=16384:(f=g.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([_])},g.updateQueue=f):(g=f.retryQueue,g===null?f.retryQueue=new Set([_]):g.add(_)),v_(c,_,N)),!1}throw Error(r(435,g.tag))}return v_(c,_,N),y_(),!1}if(lr)return f=hs.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=N,_!==m1&&(c=Error(r(422),{cause:_}),Yp(pn(c,g)))):(_!==m1&&(f=Error(r(423),{cause:_}),Yp(pn(f,g))),c=c.current.alternate,c.flags|=65536,N&=-N,c.lanes|=N,_=pn(_,g),N=W1(c.stateNode,_,N),C1(c,N),Qr!==4&&(Qr=2)),!1;var P=Error(r(520),{cause:_});if(P=pn(P,g),ym===null?ym=[P]:ym.push(P),Qr!==4&&(Qr=2),f===null)return!0;_=pn(_,g),g=f;do{switch(g.tag){case 3:return g.flags|=65536,c=N&-N,g.lanes|=c,c=W1(g.stateNode,_,c),C1(g,c),!1;case 1:if(f=g.type,P=g.stateNode,(g.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Rc===null||!Rc.has(P))))return g.flags|=65536,N&=-N,g.lanes|=N,N=wN(N),xN(N,c,g,_),C1(g,N),!1}g=g.return}while(g!==null);return!1}var _N=Error(r(461)),Ra=!1;function Va(c,f,g,_){f.child=c===null?fN(f,null,g,_):$f(f,c.child,g,_)}function SN(c,f,g,_,N){g=g.render;var P=f.ref;if("ref"in _){var se={};for(var Se in _)Se!=="ref"&&(se[Se]=_[Se])}else se=_;return td(f),_=R1(c,f,g,se,P,N),Se=I1(),c!==null&&!Ra?(j1(c,f,N),wl(c,f,N)):(lr&&Se&&h1(f),f.flags|=1,Va(c,f,_,N),f.child)}function EN(c,f,g,_,N){if(c===null){var P=g.type;return typeof P=="function"&&!u1(P)&&P.defaultProps===void 0&&g.compare===null?(f.tag=15,f.type=P,CN(c,f,P,_,N)):(c=gy(g.type,null,_,f,f.mode,N),c.ref=f.ref,c.return=f,f.child=c)}if(P=c.child,!t_(c,N)){var se=P.memoizedProps;if(g=g.compare,g=g!==null?g:A,g(se,_)&&c.ref===f.ref)return wl(c,f,N)}return f.flags|=1,c=hl(P,_),c.ref=f.ref,c.return=f,f.child=c}function CN(c,f,g,_,N){if(c!==null){var P=c.memoizedProps;if(A(P,_)&&c.ref===f.ref)if(Ra=!1,f.pendingProps=_=P,t_(c,N))(c.flags&131072)!==0&&(Ra=!0);else return f.lanes=c.lanes,wl(c,f,N)}return K1(c,f,g,_,N)}function kN(c,f,g){var _=f.pendingProps,N=_.children,P=c!==null?c.memoizedState:null;if(_.mode==="hidden"){if((f.flags&128)!==0){if(_=P!==null?P.baseLanes|g:g,c!==null){for(N=f.child=c.child,P=0;N!==null;)P=P|N.lanes|N.childLanes,N=N.sibling;f.childLanes=P&~_}else f.childLanes=0,f.child=null;return TN(c,f,_,g)}if((g&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},c!==null&&xy(f,P!==null?P.cachePool:null),P!==null?CA(f,P):T1(),hN(f);else return f.lanes=f.childLanes=536870912,TN(c,f,P!==null?P.baseLanes|g:g,g)}else P!==null?(xy(f,P.cachePool),CA(f,P),Ec(),f.memoizedState=null):(c!==null&&xy(f,null),T1(),Ec());return Va(c,f,N,g),f.child}function TN(c,f,g,_){var N=x1();return N=N===null?null:{parent:ya._currentValue,pool:N},f.memoizedState={baseLanes:g,cachePool:N},c!==null&&xy(f,null),T1(),hN(f),c!==null&&Xp(c,f,_,!0),null}function Ly(c,f){var g=f.ref;if(g===null)c!==null&&c.ref!==null&&(f.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(r(284));(c===null||c.ref!==g)&&(f.flags|=4194816)}}function K1(c,f,g,_,N){return td(f),g=R1(c,f,g,_,void 0,N),_=I1(),c!==null&&!Ra?(j1(c,f,N),wl(c,f,N)):(lr&&_&&h1(f),f.flags|=1,Va(c,f,g,N),f.child)}function AN(c,f,g,_,N,P){return td(f),f.updateQueue=null,g=TA(f,_,g,N),kA(c),_=I1(),c!==null&&!Ra?(j1(c,f,P),wl(c,f,P)):(lr&&_&&h1(f),f.flags|=1,Va(c,f,g,P),f.child)}function NN(c,f,g,_,N){if(td(f),f.stateNode===null){var P=_o,se=g.contextType;typeof se=="object"&&se!==null&&(P=ti(se)),P=new g(_,P),f.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=G1,f.stateNode=P,P._reactInternals=f,P=f.stateNode,P.props=_,P.state=f.memoizedState,P.refs={},S1(f),se=g.contextType,P.context=typeof se=="object"&&se!==null?ti(se):_o,P.state=f.memoizedState,se=g.getDerivedStateFromProps,typeof se=="function"&&(V1(f,g,se,_),P.state=f.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(se=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),se!==P.state&&G1.enqueueReplaceState(P,P.state,null),am(f,_,P,N),rm(),P.state=f.memoizedState),typeof P.componentDidMount=="function"&&(f.flags|=4194308),_=!0}else if(c===null){P=f.stateNode;var Se=f.memoizedProps,ze=ad(g,Se);P.props=ze;var dt=P.context,Ct=g.contextType;se=_o,typeof Ct=="object"&&Ct!==null&&(se=ti(Ct));var It=g.getDerivedStateFromProps;Ct=typeof It=="function"||typeof P.getSnapshotBeforeUpdate=="function",Se=f.pendingProps!==Se,Ct||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(Se||dt!==se)&&mN(f,P,_,se),vc=!1;var mt=f.memoizedState;P.state=mt,am(f,_,P,N),rm(),dt=f.memoizedState,Se||mt!==dt||vc?(typeof It=="function"&&(V1(f,g,It,_),dt=f.memoizedState),(ze=vc||pN(f,g,ze,_,mt,dt,se))?(Ct||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(f.flags|=4194308)):(typeof P.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=_,f.memoizedState=dt),P.props=_,P.state=dt,P.context=se,_=ze):(typeof P.componentDidMount=="function"&&(f.flags|=4194308),_=!1)}else{P=f.stateNode,E1(c,f),se=f.memoizedProps,Ct=ad(g,se),P.props=Ct,It=f.pendingProps,mt=P.context,dt=g.contextType,ze=_o,typeof dt=="object"&&dt!==null&&(ze=ti(dt)),Se=g.getDerivedStateFromProps,(dt=typeof Se=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(se!==It||mt!==ze)&&mN(f,P,_,ze),vc=!1,mt=f.memoizedState,P.state=mt,am(f,_,P,N),rm();var yt=f.memoizedState;se!==It||mt!==yt||vc||c!==null&&c.dependencies!==null&&vy(c.dependencies)?(typeof Se=="function"&&(V1(f,g,Se,_),yt=f.memoizedState),(Ct=vc||pN(f,g,Ct,_,mt,yt,ze)||c!==null&&c.dependencies!==null&&vy(c.dependencies))?(dt||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(_,yt,ze),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(_,yt,ze)),typeof P.componentDidUpdate=="function"&&(f.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof P.componentDidUpdate!="function"||se===c.memoizedProps&&mt===c.memoizedState||(f.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||se===c.memoizedProps&&mt===c.memoizedState||(f.flags|=1024),f.memoizedProps=_,f.memoizedState=yt),P.props=_,P.state=yt,P.context=ze,_=Ct):(typeof P.componentDidUpdate!="function"||se===c.memoizedProps&&mt===c.memoizedState||(f.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||se===c.memoizedProps&&mt===c.memoizedState||(f.flags|=1024),_=!1)}return P=_,Ly(c,f),_=(f.flags&128)!==0,P||_?(P=f.stateNode,g=_&&typeof g.getDerivedStateFromError!="function"?null:P.render(),f.flags|=1,c!==null&&_?(f.child=$f(f,c.child,null,N),f.child=$f(f,null,g,N)):Va(c,f,g,N),f.memoizedState=P.state,c=f.child):c=wl(c,f,N),c}function RN(c,f,g,_){return Zp(),f.flags|=256,Va(c,f,g,_),f.child}var Z1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Y1(c){return{baseLanes:c,cachePool:yA()}}function X1(c,f,g){return c=c!==null?c.childLanes&~g:0,f&&(c|=ps),c}function IN(c,f,g){var _=f.pendingProps,N=!1,P=(f.flags&128)!==0,se;if((se=P)||(se=c!==null&&c.memoizedState===null?!1:(ba.current&2)!==0),se&&(N=!0,f.flags&=-129),se=(f.flags&32)!==0,f.flags&=-33,c===null){if(lr){if(N?Sc(f):Ec(),lr){var Se=Jr,ze;if(ze=Se){e:{for(ze=Se,Se=So;ze.nodeType!==8;){if(!Se){Se=null;break e}if(ze=Ls(ze.nextSibling),ze===null){Se=null;break e}}Se=ze}Se!==null?(f.memoizedState={dehydrated:Se,treeContext:Yu!==null?{id:pl,overflow:ml}:null,retryLane:536870912,hydrationErrors:null},ze=qi(18,null,null,0),ze.stateNode=Se,ze.return=f,f.child=ze,yi=f,Jr=null,ze=!0):ze=!1}ze||Qu(f)}if(Se=f.memoizedState,Se!==null&&(Se=Se.dehydrated,Se!==null))return D_(Se)?f.lanes=32:f.lanes=536870912,null;vl(f)}return Se=_.children,_=_.fallback,N?(Ec(),N=f.mode,Se=$y({mode:"hidden",children:Se},N),_=Zu(_,N,g,null),Se.return=f,_.return=f,Se.sibling=_,f.child=Se,N=f.child,N.memoizedState=Y1(g),N.childLanes=X1(c,se,g),f.memoizedState=Z1,_):(Sc(f),J1(f,Se))}if(ze=c.memoizedState,ze!==null&&(Se=ze.dehydrated,Se!==null)){if(P)f.flags&256?(Sc(f),f.flags&=-257,f=Q1(c,f,g)):f.memoizedState!==null?(Ec(),f.child=c.child,f.flags|=128,f=null):(Ec(),N=_.fallback,Se=f.mode,_=$y({mode:"visible",children:_.children},Se),N=Zu(N,Se,g,null),N.flags|=2,_.return=f,N.return=f,_.sibling=N,f.child=_,$f(f,c.child,null,g),_=f.child,_.memoizedState=Y1(g),_.childLanes=X1(c,se,g),f.memoizedState=Z1,f=N);else if(Sc(f),D_(Se)){if(se=Se.nextSibling&&Se.nextSibling.dataset,se)var dt=se.dgst;se=dt,_=Error(r(419)),_.stack="",_.digest=se,Yp({value:_,source:null,stack:null}),f=Q1(c,f,g)}else if(Ra||Xp(c,f,g,!1),se=(g&c.childLanes)!==0,Ra||se){if(se=Mr,se!==null&&(_=g&-g,_=(_&42)!==0?1:Rt(_),_=(_&(se.suspendedLanes|g))!==0?0:_,_!==0&&_!==ze.retryLane))throw ze.retryLane=_,Ps(c,_),Ki(se,c,_),_N;Se.data==="$?"||y_(),f=Q1(c,f,g)}else Se.data==="$?"?(f.flags|=192,f.child=c.child,f=null):(c=ze.treeContext,Jr=Ls(Se.nextSibling),yi=f,lr=!0,Ju=null,So=!1,c!==null&&(ds[fs++]=pl,ds[fs++]=ml,ds[fs++]=Yu,pl=c.id,ml=c.overflow,Yu=f),f=J1(f,_.children),f.flags|=4096);return f}return N?(Ec(),N=_.fallback,Se=f.mode,ze=c.child,dt=ze.sibling,_=hl(ze,{mode:"hidden",children:_.children}),_.subtreeFlags=ze.subtreeFlags&65011712,dt!==null?N=hl(dt,N):(N=Zu(N,Se,g,null),N.flags|=2),N.return=f,_.return=f,_.sibling=N,f.child=_,_=N,N=f.child,Se=c.child.memoizedState,Se===null?Se=Y1(g):(ze=Se.cachePool,ze!==null?(dt=ya._currentValue,ze=ze.parent!==dt?{parent:dt,pool:dt}:ze):ze=yA(),Se={baseLanes:Se.baseLanes|g,cachePool:ze}),N.memoizedState=Se,N.childLanes=X1(c,se,g),f.memoizedState=Z1,_):(Sc(f),g=c.child,c=g.sibling,g=hl(g,{mode:"visible",children:_.children}),g.return=f,g.sibling=null,c!==null&&(se=f.deletions,se===null?(f.deletions=[c],f.flags|=16):se.push(c)),f.child=g,f.memoizedState=null,g)}function J1(c,f){return f=$y({mode:"visible",children:f},c.mode),f.return=c,c.child=f}function $y(c,f){return c=qi(22,c,null,f),c.lanes=0,c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},c}function Q1(c,f,g){return $f(f,c.child,null,g),c=J1(f,f.pendingProps.children),c.flags|=2,f.memoizedState=null,c}function jN(c,f,g){c.lanes|=f;var _=c.alternate;_!==null&&(_.lanes|=f),y1(c.return,f,g)}function e_(c,f,g,_,N){var P=c.memoizedState;P===null?c.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:_,tail:g,tailMode:N}:(P.isBackwards=f,P.rendering=null,P.renderingStartTime=0,P.last=_,P.tail=g,P.tailMode=N)}function ON(c,f,g){var _=f.pendingProps,N=_.revealOrder,P=_.tail;if(Va(c,f,_.children,g),_=ba.current,(_&2)!==0)_=_&1|2,f.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=f.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&jN(c,g,f);else if(c.tag===19)jN(c,g,f);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===f)break e;for(;c.sibling===null;){if(c.return===null||c.return===f)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}_&=1}switch(oe(ba,_),N){case"forwards":for(g=f.child,N=null;g!==null;)c=g.alternate,c!==null&&My(c)===null&&(N=g),g=g.sibling;g=N,g===null?(N=f.child,f.child=null):(N=g.sibling,g.sibling=null),e_(f,!1,N,g,P);break;case"backwards":for(g=null,N=f.child,f.child=null;N!==null;){if(c=N.alternate,c!==null&&My(c)===null){f.child=N;break}c=N.sibling,N.sibling=g,g=N,N=c}e_(f,!0,g,null,P);break;case"together":e_(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function wl(c,f,g){if(c!==null&&(f.dependencies=c.dependencies),Nc|=f.lanes,(g&f.childLanes)===0)if(c!==null){if(Xp(c,f,g,!1),(g&f.childLanes)===0)return null}else return null;if(c!==null&&f.child!==c.child)throw Error(r(153));if(f.child!==null){for(c=f.child,g=hl(c,c.pendingProps),f.child=g,g.return=f;c.sibling!==null;)c=c.sibling,g=g.sibling=hl(c,c.pendingProps),g.return=f;g.sibling=null}return f.child}function t_(c,f){return(c.lanes&f)!==0?!0:(c=c.dependencies,!!(c!==null&&vy(c)))}function zz(c,f,g){switch(f.tag){case 3:Re(f,f.stateNode.containerInfo),bc(f,ya,c.memoizedState.cache),Zp();break;case 27:case 5:Fe(f);break;case 4:Re(f,f.stateNode.containerInfo);break;case 10:bc(f,f.type,f.memoizedProps.value);break;case 13:var _=f.memoizedState;if(_!==null)return _.dehydrated!==null?(Sc(f),f.flags|=128,null):(g&f.child.childLanes)!==0?IN(c,f,g):(Sc(f),c=wl(c,f,g),c!==null?c.sibling:null);Sc(f);break;case 19:var N=(c.flags&128)!==0;if(_=(g&f.childLanes)!==0,_||(Xp(c,f,g,!1),_=(g&f.childLanes)!==0),N){if(_)return ON(c,f,g);f.flags|=128}if(N=f.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),oe(ba,ba.current),_)break;return null;case 22:case 23:return f.lanes=0,kN(c,f,g);case 24:bc(f,ya,c.memoizedState.cache)}return wl(c,f,g)}function DN(c,f,g){if(c!==null)if(c.memoizedProps!==f.pendingProps)Ra=!0;else{if(!t_(c,g)&&(f.flags&128)===0)return Ra=!1,zz(c,f,g);Ra=(c.flags&131072)!==0}else Ra=!1,lr&&(f.flags&1048576)!==0&&uA(f,by,f.index);switch(f.lanes=0,f.tag){case 16:e:{c=f.pendingProps;var _=f.elementType,N=_._init;if(_=N(_._payload),f.type=_,typeof _=="function")u1(_)?(c=ad(_,c),f.tag=1,f=NN(null,f,_,c,g)):(f.tag=0,f=K1(null,f,_,c,g));else{if(_!=null){if(N=_.$$typeof,N===C){f.tag=11,f=SN(null,f,_,c,g);break e}else if(N===O){f.tag=14,f=EN(null,f,_,c,g);break e}}throw f=q(_)||_,Error(r(306,f,""))}}return f;case 0:return K1(c,f,f.type,f.pendingProps,g);case 1:return _=f.type,N=ad(_,f.pendingProps),NN(c,f,_,N,g);case 3:e:{if(Re(f,f.stateNode.containerInfo),c===null)throw Error(r(387));_=f.pendingProps;var P=f.memoizedState;N=P.element,E1(c,f),am(f,_,null,g);var se=f.memoizedState;if(_=se.cache,bc(f,ya,_),_!==P.cache&&b1(f,[ya],g,!0),rm(),_=se.element,P.isDehydrated)if(P={element:_,isDehydrated:!1,cache:se.cache},f.updateQueue.baseState=P,f.memoizedState=P,f.flags&256){f=RN(c,f,_,g);break e}else if(_!==N){N=pn(Error(r(424)),f),Yp(N),f=RN(c,f,_,g);break e}else{switch(c=f.stateNode.containerInfo,c.nodeType){case 9:c=c.body;break;default:c=c.nodeName==="HTML"?c.ownerDocument.body:c}for(Jr=Ls(c.firstChild),yi=f,lr=!0,Ju=null,So=!0,g=fN(f,null,_,g),f.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(Zp(),_===N){f=wl(c,f,g);break e}Va(c,f,_,g)}f=f.child}return f;case 26:return Ly(c,f),c===null?(g=LR(f.type,null,f.pendingProps,null))?f.memoizedState=g:lr||(g=f.type,c=f.pendingProps,_=Qy(Pe.current).createElement(g),_[he]=f,_[Ae]=c,Wa(_,g,c),Mn(_),f.stateNode=_):f.memoizedState=LR(f.type,c.memoizedProps,f.pendingProps,c.memoizedState),null;case 27:return Fe(f),c===null&&lr&&(_=f.stateNode=MR(f.type,f.pendingProps,Pe.current),yi=f,So=!0,N=Jr,Oc(f.type)?(M_=N,Jr=Ls(_.firstChild)):Jr=N),Va(c,f,f.pendingProps.children,g),Ly(c,f),c===null&&(f.flags|=4194304),f.child;case 5:return c===null&&lr&&((N=_=Jr)&&(_=m7(_,f.type,f.pendingProps,So),_!==null?(f.stateNode=_,yi=f,Jr=Ls(_.firstChild),So=!1,N=!0):N=!1),N||Qu(f)),Fe(f),N=f.type,P=f.pendingProps,se=c!==null?c.memoizedProps:null,_=P.children,I_(N,P)?_=null:se!==null&&I_(N,se)&&(f.flags|=32),f.memoizedState!==null&&(N=R1(c,f,Oz,null,null,g),km._currentValue=N),Ly(c,f),Va(c,f,_,g),f.child;case 6:return c===null&&lr&&((c=g=Jr)&&(g=g7(g,f.pendingProps,So),g!==null?(f.stateNode=g,yi=f,Jr=null,c=!0):c=!1),c||Qu(f)),null;case 13:return IN(c,f,g);case 4:return Re(f,f.stateNode.containerInfo),_=f.pendingProps,c===null?f.child=$f(f,null,_,g):Va(c,f,_,g),f.child;case 11:return SN(c,f,f.type,f.pendingProps,g);case 7:return Va(c,f,f.pendingProps,g),f.child;case 8:return Va(c,f,f.pendingProps.children,g),f.child;case 12:return Va(c,f,f.pendingProps.children,g),f.child;case 10:return _=f.pendingProps,bc(f,f.type,_.value),Va(c,f,_.children,g),f.child;case 9:return N=f.type._context,_=f.pendingProps.children,td(f),N=ti(N),_=_(N),f.flags|=1,Va(c,f,_,g),f.child;case 14:return EN(c,f,f.type,f.pendingProps,g);case 15:return CN(c,f,f.type,f.pendingProps,g);case 19:return ON(c,f,g);case 31:return _=f.pendingProps,g=f.mode,_={mode:_.mode,children:_.children},c===null?(g=$y(_,g),g.ref=f.ref,f.child=g,g.return=f,f=g):(g=hl(c.child,_),g.ref=f.ref,f.child=g,g.return=f,f=g),f;case 22:return kN(c,f,g);case 24:return td(f),_=ti(ya),c===null?(N=x1(),N===null&&(N=Mr,P=v1(),N.pooledCache=P,P.refCount++,P!==null&&(N.pooledCacheLanes|=g),N=P),f.memoizedState={parent:_,cache:N},S1(f),bc(f,ya,N)):((c.lanes&g)!==0&&(E1(c,f),am(f,null,null,g),rm()),N=c.memoizedState,P=f.memoizedState,N.parent!==_?(N={parent:_,cache:_},f.memoizedState=N,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=N),bc(f,ya,_)):(_=P.cache,bc(f,ya,_),_!==N.cache&&b1(f,[ya],g,!0))),Va(c,f,f.pendingProps.children,g),f.child;case 29:throw f.pendingProps}throw Error(r(156,f.tag))}function xl(c){c.flags|=4}function MN(c,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)c.flags&=-16777217;else if(c.flags|=16777216,!qR(f)){if(f=hs.current,f!==null&&((tr&4194048)===tr?Eo!==null:(tr&62914560)!==tr&&(tr&536870912)===0||f!==Eo))throw tm=_1,bA;c.flags|=8192}}function By(c,f){f!==null&&(c.flags|=4),c.flags&16384&&(f=c.tag!==22?M():536870912,c.lanes|=f,qf|=f)}function dm(c,f){if(!lr)switch(c.tailMode){case"hidden":f=c.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?c.tail=null:g.sibling=null;break;case"collapsed":g=c.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?f||c.tail===null?c.tail=null:c.tail.sibling=null:_.sibling=null}}function Kr(c){var f=c.alternate!==null&&c.alternate.child===c.child,g=0,_=0;if(f)for(var N=c.child;N!==null;)g|=N.lanes|N.childLanes,_|=N.subtreeFlags&65011712,_|=N.flags&65011712,N.return=c,N=N.sibling;else for(N=c.child;N!==null;)g|=N.lanes|N.childLanes,_|=N.subtreeFlags,_|=N.flags,N.return=c,N=N.sibling;return c.subtreeFlags|=_,c.childLanes=g,f}function Uz(c,f,g){var _=f.pendingProps;switch(p1(f),f.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kr(f),null;case 1:return Kr(f),null;case 3:return g=f.stateNode,_=null,c!==null&&(_=c.memoizedState.cache),f.memoizedState.cache!==_&&(f.flags|=2048),yl(ya),ke(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(c===null||c.child===null)&&(Kp(f)?xl(f):c===null||c.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,hA())),Kr(f),null;case 26:return g=f.memoizedState,c===null?(xl(f),g!==null?(Kr(f),MN(f,g)):(Kr(f),f.flags&=-16777217)):g?g!==c.memoizedState?(xl(f),Kr(f),MN(f,g)):(Kr(f),f.flags&=-16777217):(c.memoizedProps!==_&&xl(f),Kr(f),f.flags&=-16777217),null;case 27:Qe(f),g=Pe.current;var N=f.type;if(c!==null&&f.stateNode!=null)c.memoizedProps!==_&&xl(f);else{if(!_){if(f.stateNode===null)throw Error(r(166));return Kr(f),null}c=me.current,Kp(f)?dA(f):(c=MR(N,_,g),f.stateNode=c,xl(f))}return Kr(f),null;case 5:if(Qe(f),g=f.type,c!==null&&f.stateNode!=null)c.memoizedProps!==_&&xl(f);else{if(!_){if(f.stateNode===null)throw Error(r(166));return Kr(f),null}if(c=me.current,Kp(f))dA(f);else{switch(N=Qy(Pe.current),c){case 1:c=N.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:c=N.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":c=N.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":c=N.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":c=N.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild);break;case"select":c=typeof _.is=="string"?N.createElement("select",{is:_.is}):N.createElement("select"),_.multiple?c.multiple=!0:_.size&&(c.size=_.size);break;default:c=typeof _.is=="string"?N.createElement(g,{is:_.is}):N.createElement(g)}}c[he]=f,c[Ae]=_;e:for(N=f.child;N!==null;){if(N.tag===5||N.tag===6)c.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===f)break e;for(;N.sibling===null;){if(N.return===null||N.return===f)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}f.stateNode=c;e:switch(Wa(c,g,_),g){case"button":case"input":case"select":case"textarea":c=!!_.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&xl(f)}}return Kr(f),f.flags&=-16777217,null;case 6:if(c&&f.stateNode!=null)c.memoizedProps!==_&&xl(f);else{if(typeof _!="string"&&f.stateNode===null)throw Error(r(166));if(c=Pe.current,Kp(f)){if(c=f.stateNode,g=f.memoizedProps,_=null,N=yi,N!==null)switch(N.tag){case 27:case 5:_=N.memoizedProps}c[he]=f,c=!!(c.nodeValue===g||_!==null&&_.suppressHydrationWarning===!0||AR(c.nodeValue,g)),c||Qu(f)}else c=Qy(c).createTextNode(_),c[he]=f,f.stateNode=c}return Kr(f),null;case 13:if(_=f.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(N=Kp(f),_!==null&&_.dehydrated!==null){if(c===null){if(!N)throw Error(r(318));if(N=f.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[he]=f}else Zp(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Kr(f),N=!1}else N=hA(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=N),N=!0;if(!N)return f.flags&256?(vl(f),f):(vl(f),null)}if(vl(f),(f.flags&128)!==0)return f.lanes=g,f;if(g=_!==null,c=c!==null&&c.memoizedState!==null,g){_=f.child,N=null,_.alternate!==null&&_.alternate.memoizedState!==null&&_.alternate.memoizedState.cachePool!==null&&(N=_.alternate.memoizedState.cachePool.pool);var P=null;_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(P=_.memoizedState.cachePool.pool),P!==N&&(_.flags|=2048)}return g!==c&&g&&(f.child.flags|=8192),By(f,f.updateQueue),Kr(f),null;case 4:return ke(),c===null&&k_(f.stateNode.containerInfo),Kr(f),null;case 10:return yl(f.type),Kr(f),null;case 19:if(ee(ba),N=f.memoizedState,N===null)return Kr(f),null;if(_=(f.flags&128)!==0,P=N.rendering,P===null)if(_)dm(N,!1);else{if(Qr!==0||c!==null&&(c.flags&128)!==0)for(c=f.child;c!==null;){if(P=My(c),P!==null){for(f.flags|=128,dm(N,!1),c=P.updateQueue,f.updateQueue=c,By(f,c),f.subtreeFlags=0,c=g,g=f.child;g!==null;)cA(g,c),g=g.sibling;return oe(ba,ba.current&1|2),f.child}c=c.sibling}N.tail!==null&&le()>qy&&(f.flags|=128,_=!0,dm(N,!1),f.lanes=4194304)}else{if(!_)if(c=My(P),c!==null){if(f.flags|=128,_=!0,c=c.updateQueue,f.updateQueue=c,By(f,c),dm(N,!0),N.tail===null&&N.tailMode==="hidden"&&!P.alternate&&!lr)return Kr(f),null}else 2*le()-N.renderingStartTime>qy&&g!==536870912&&(f.flags|=128,_=!0,dm(N,!1),f.lanes=4194304);N.isBackwards?(P.sibling=f.child,f.child=P):(c=N.last,c!==null?c.sibling=P:f.child=P,N.last=P)}return N.tail!==null?(f=N.tail,N.rendering=f,N.tail=f.sibling,N.renderingStartTime=le(),f.sibling=null,c=ba.current,oe(ba,_?c&1|2:c&1),f):(Kr(f),null);case 22:case 23:return vl(f),A1(),_=f.memoizedState!==null,c!==null?c.memoizedState!==null!==_&&(f.flags|=8192):_&&(f.flags|=8192),_?(g&536870912)!==0&&(f.flags&128)===0&&(Kr(f),f.subtreeFlags&6&&(f.flags|=8192)):Kr(f),g=f.updateQueue,g!==null&&By(f,g.retryQueue),g=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),_=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(_=f.memoizedState.cachePool.pool),_!==g&&(f.flags|=2048),c!==null&&ee(nd),null;case 24:return g=null,c!==null&&(g=c.memoizedState.cache),f.memoizedState.cache!==g&&(f.flags|=2048),yl(ya),Kr(f),null;case 25:return null;case 30:return null}throw Error(r(156,f.tag))}function qz(c,f){switch(p1(f),f.tag){case 1:return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 3:return yl(ya),ke(),c=f.flags,(c&65536)!==0&&(c&128)===0?(f.flags=c&-65537|128,f):null;case 26:case 27:case 5:return Qe(f),null;case 13:if(vl(f),c=f.memoizedState,c!==null&&c.dehydrated!==null){if(f.alternate===null)throw Error(r(340));Zp()}return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 19:return ee(ba),null;case 4:return ke(),null;case 10:return yl(f.type),null;case 22:case 23:return vl(f),A1(),c!==null&&ee(nd),c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 24:return yl(ya),null;case 25:return null;default:return null}}function PN(c,f){switch(p1(f),f.tag){case 3:yl(ya),ke();break;case 26:case 27:case 5:Qe(f);break;case 4:ke();break;case 13:vl(f);break;case 19:ee(ba);break;case 10:yl(f.type);break;case 22:case 23:vl(f),A1(),c!==null&&ee(nd);break;case 24:yl(ya)}}function fm(c,f){try{var g=f.updateQueue,_=g!==null?g.lastEffect:null;if(_!==null){var N=_.next;g=N;do{if((g.tag&c)===c){_=void 0;var P=g.create,se=g.inst;_=P(),se.destroy=_}g=g.next}while(g!==N)}}catch(Se){Rr(f,f.return,Se)}}function Cc(c,f,g){try{var _=f.updateQueue,N=_!==null?_.lastEffect:null;if(N!==null){var P=N.next;_=P;do{if((_.tag&c)===c){var se=_.inst,Se=se.destroy;if(Se!==void 0){se.destroy=void 0,N=f;var ze=g,dt=Se;try{dt()}catch(Ct){Rr(N,ze,Ct)}}}_=_.next}while(_!==P)}}catch(Ct){Rr(f,f.return,Ct)}}function FN(c){var f=c.updateQueue;if(f!==null){var g=c.stateNode;try{EA(f,g)}catch(_){Rr(c,c.return,_)}}}function LN(c,f,g){g.props=ad(c.type,c.memoizedProps),g.state=c.memoizedState;try{g.componentWillUnmount()}catch(_){Rr(c,f,_)}}function hm(c,f){try{var g=c.ref;if(g!==null){switch(c.tag){case 26:case 27:case 5:var _=c.stateNode;break;case 30:_=c.stateNode;break;default:_=c.stateNode}typeof g=="function"?c.refCleanup=g(_):g.current=_}}catch(N){Rr(c,f,N)}}function Co(c,f){var g=c.ref,_=c.refCleanup;if(g!==null)if(typeof _=="function")try{_()}catch(N){Rr(c,f,N)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(N){Rr(c,f,N)}else g.current=null}function $N(c){var f=c.type,g=c.memoizedProps,_=c.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":g.autoFocus&&_.focus();break e;case"img":g.src?_.src=g.src:g.srcSet&&(_.srcset=g.srcSet)}}catch(N){Rr(c,c.return,N)}}function n_(c,f,g){try{var _=c.stateNode;u7(_,c.type,g,f),_[Ae]=f}catch(N){Rr(c,c.return,N)}}function BN(c){return c.tag===5||c.tag===3||c.tag===26||c.tag===27&&Oc(c.type)||c.tag===4}function r_(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||BN(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.tag===27&&Oc(c.type)||c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function a_(c,f,g){var _=c.tag;if(_===5||_===6)c=c.stateNode,f?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(c,f):(f=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,f.appendChild(c),g=g._reactRootContainer,g!=null||f.onclick!==null||(f.onclick=Jy));else if(_!==4&&(_===27&&Oc(c.type)&&(g=c.stateNode,f=null),c=c.child,c!==null))for(a_(c,f,g),c=c.sibling;c!==null;)a_(c,f,g),c=c.sibling}function zy(c,f,g){var _=c.tag;if(_===5||_===6)c=c.stateNode,f?g.insertBefore(c,f):g.appendChild(c);else if(_!==4&&(_===27&&Oc(c.type)&&(g=c.stateNode),c=c.child,c!==null))for(zy(c,f,g),c=c.sibling;c!==null;)zy(c,f,g),c=c.sibling}function zN(c){var f=c.stateNode,g=c.memoizedProps;try{for(var _=c.type,N=f.attributes;N.length;)f.removeAttributeNode(N[0]);Wa(f,_,g),f[he]=c,f[Ae]=g}catch(P){Rr(c,c.return,P)}}var _l=!1,ia=!1,i_=!1,UN=typeof WeakSet=="function"?WeakSet:Set,Ia=null;function Hz(c,f){if(c=c.containerInfo,N_=ib,c=ue(c),we(c)){if("selectionStart"in c)var g={start:c.selectionStart,end:c.selectionEnd};else e:{g=(g=c.ownerDocument)&&g.defaultView||window;var _=g.getSelection&&g.getSelection();if(_&&_.rangeCount!==0){g=_.anchorNode;var N=_.anchorOffset,P=_.focusNode;_=_.focusOffset;try{g.nodeType,P.nodeType}catch{g=null;break e}var se=0,Se=-1,ze=-1,dt=0,Ct=0,It=c,mt=null;t:for(;;){for(var yt;It!==g||N!==0&&It.nodeType!==3||(Se=se+N),It!==P||_!==0&&It.nodeType!==3||(ze=se+_),It.nodeType===3&&(se+=It.nodeValue.length),(yt=It.firstChild)!==null;)mt=It,It=yt;for(;;){if(It===c)break t;if(mt===g&&++dt===N&&(Se=se),mt===P&&++Ct===_&&(ze=se),(yt=It.nextSibling)!==null)break;It=mt,mt=It.parentNode}It=yt}g=Se===-1||ze===-1?null:{start:Se,end:ze}}else g=null}g=g||{start:0,end:0}}else g=null;for(R_={focusedElem:c,selectionRange:g},ib=!1,Ia=f;Ia!==null;)if(f=Ia,c=f.child,(f.subtreeFlags&1024)!==0&&c!==null)c.return=f,Ia=c;else for(;Ia!==null;){switch(f=Ia,P=f.alternate,c=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if((c&1024)!==0&&P!==null){c=void 0,g=f,N=P.memoizedProps,P=P.memoizedState,_=g.stateNode;try{var Sn=ad(g.type,N,g.elementType===g.type);c=_.getSnapshotBeforeUpdate(Sn,P),_.__reactInternalSnapshotBeforeUpdate=c}catch(yn){Rr(g,g.return,yn)}}break;case 3:if((c&1024)!==0){if(c=f.stateNode.containerInfo,g=c.nodeType,g===9)O_(c);else if(g===1)switch(c.nodeName){case"HEAD":case"HTML":case"BODY":O_(c);break;default:c.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((c&1024)!==0)throw Error(r(163))}if(c=f.sibling,c!==null){c.return=f.return,Ia=c;break}Ia=f.return}}function qN(c,f,g){var _=g.flags;switch(g.tag){case 0:case 11:case 15:kc(c,g),_&4&&fm(5,g);break;case 1:if(kc(c,g),_&4)if(c=g.stateNode,f===null)try{c.componentDidMount()}catch(se){Rr(g,g.return,se)}else{var N=ad(g.type,f.memoizedProps);f=f.memoizedState;try{c.componentDidUpdate(N,f,c.__reactInternalSnapshotBeforeUpdate)}catch(se){Rr(g,g.return,se)}}_&64&&FN(g),_&512&&hm(g,g.return);break;case 3:if(kc(c,g),_&64&&(c=g.updateQueue,c!==null)){if(f=null,g.child!==null)switch(g.child.tag){case 27:case 5:f=g.child.stateNode;break;case 1:f=g.child.stateNode}try{EA(c,f)}catch(se){Rr(g,g.return,se)}}break;case 27:f===null&&_&4&&zN(g);case 26:case 5:kc(c,g),f===null&&_&4&&$N(g),_&512&&hm(g,g.return);break;case 12:kc(c,g);break;case 13:kc(c,g),_&4&&GN(c,g),_&64&&(c=g.memoizedState,c!==null&&(c=c.dehydrated,c!==null&&(g=Qz.bind(null,g),y7(c,g))));break;case 22:if(_=g.memoizedState!==null||_l,!_){f=f!==null&&f.memoizedState!==null||ia,N=_l;var P=ia;_l=_,(ia=f)&&!P?Tc(c,g,(g.subtreeFlags&8772)!==0):kc(c,g),_l=N,ia=P}break;case 30:break;default:kc(c,g)}}function HN(c){var f=c.alternate;f!==null&&(c.alternate=null,HN(f)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(f=c.stateNode,f!==null&&Jt(f)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}var Hr=null,Ai=!1;function Sl(c,f,g){for(g=g.child;g!==null;)VN(c,f,g),g=g.sibling}function VN(c,f,g){if(Dt&&typeof Dt.onCommitFiberUnmount=="function")try{Dt.onCommitFiberUnmount(xt,g)}catch{}switch(g.tag){case 26:ia||Co(g,f),Sl(c,f,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:ia||Co(g,f);var _=Hr,N=Ai;Oc(g.type)&&(Hr=g.stateNode,Ai=!1),Sl(c,f,g),_m(g.stateNode),Hr=_,Ai=N;break;case 5:ia||Co(g,f);case 6:if(_=Hr,N=Ai,Hr=null,Sl(c,f,g),Hr=_,Ai=N,Hr!==null)if(Ai)try{(Hr.nodeType===9?Hr.body:Hr.nodeName==="HTML"?Hr.ownerDocument.body:Hr).removeChild(g.stateNode)}catch(P){Rr(g,f,P)}else try{Hr.removeChild(g.stateNode)}catch(P){Rr(g,f,P)}break;case 18:Hr!==null&&(Ai?(c=Hr,OR(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,g.stateNode),Rm(c)):OR(Hr,g.stateNode));break;case 4:_=Hr,N=Ai,Hr=g.stateNode.containerInfo,Ai=!0,Sl(c,f,g),Hr=_,Ai=N;break;case 0:case 11:case 14:case 15:ia||Cc(2,g,f),ia||Cc(4,g,f),Sl(c,f,g);break;case 1:ia||(Co(g,f),_=g.stateNode,typeof _.componentWillUnmount=="function"&&LN(g,f,_)),Sl(c,f,g);break;case 21:Sl(c,f,g);break;case 22:ia=(_=ia)||g.memoizedState!==null,Sl(c,f,g),ia=_;break;default:Sl(c,f,g)}}function GN(c,f){if(f.memoizedState===null&&(c=f.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{Rm(c)}catch(g){Rr(f,f.return,g)}}function Vz(c){switch(c.tag){case 13:case 19:var f=c.stateNode;return f===null&&(f=c.stateNode=new UN),f;case 22:return c=c.stateNode,f=c._retryCache,f===null&&(f=c._retryCache=new UN),f;default:throw Error(r(435,c.tag))}}function s_(c,f){var g=Vz(c);f.forEach(function(_){var N=e7.bind(null,c,_);g.has(_)||(g.add(_),_.then(N,N))})}function Hi(c,f){var g=f.deletions;if(g!==null)for(var _=0;_<g.length;_++){var N=g[_],P=c,se=f,Se=se;e:for(;Se!==null;){switch(Se.tag){case 27:if(Oc(Se.type)){Hr=Se.stateNode,Ai=!1;break e}break;case 5:Hr=Se.stateNode,Ai=!1;break e;case 3:case 4:Hr=Se.stateNode.containerInfo,Ai=!0;break e}Se=Se.return}if(Hr===null)throw Error(r(160));VN(P,se,N),Hr=null,Ai=!1,P=N.alternate,P!==null&&(P.return=null),N.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)WN(f,c),f=f.sibling}var Fs=null;function WN(c,f){var g=c.alternate,_=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:Hi(f,c),Vi(c),_&4&&(Cc(3,c,c.return),fm(3,c),Cc(5,c,c.return));break;case 1:Hi(f,c),Vi(c),_&512&&(ia||g===null||Co(g,g.return)),_&64&&_l&&(c=c.updateQueue,c!==null&&(_=c.callbacks,_!==null&&(g=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=g===null?_:g.concat(_))));break;case 26:var N=Fs;if(Hi(f,c),Vi(c),_&512&&(ia||g===null||Co(g,g.return)),_&4){var P=g!==null?g.memoizedState:null;if(_=c.memoizedState,g===null)if(_===null)if(c.stateNode===null){e:{_=c.type,g=c.memoizedProps,N=N.ownerDocument||N;t:switch(_){case"title":P=N.getElementsByTagName("title")[0],(!P||P[Pt]||P[he]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=N.createElement(_),N.head.insertBefore(P,N.querySelector("head > title"))),Wa(P,_,g),P[he]=c,Mn(P),_=P;break e;case"link":var se=zR("link","href",N).get(_+(g.href||""));if(se){for(var Se=0;Se<se.length;Se++)if(P=se[Se],P.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&P.getAttribute("rel")===(g.rel==null?null:g.rel)&&P.getAttribute("title")===(g.title==null?null:g.title)&&P.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){se.splice(Se,1);break t}}P=N.createElement(_),Wa(P,_,g),N.head.appendChild(P);break;case"meta":if(se=zR("meta","content",N).get(_+(g.content||""))){for(Se=0;Se<se.length;Se++)if(P=se[Se],P.getAttribute("content")===(g.content==null?null:""+g.content)&&P.getAttribute("name")===(g.name==null?null:g.name)&&P.getAttribute("property")===(g.property==null?null:g.property)&&P.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&P.getAttribute("charset")===(g.charSet==null?null:g.charSet)){se.splice(Se,1);break t}}P=N.createElement(_),Wa(P,_,g),N.head.appendChild(P);break;default:throw Error(r(468,_))}P[he]=c,Mn(P),_=P}c.stateNode=_}else UR(N,c.type,c.stateNode);else c.stateNode=BR(N,_,c.memoizedProps);else P!==_?(P===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):P.count--,_===null?UR(N,c.type,c.stateNode):BR(N,_,c.memoizedProps)):_===null&&c.stateNode!==null&&n_(c,c.memoizedProps,g.memoizedProps)}break;case 27:Hi(f,c),Vi(c),_&512&&(ia||g===null||Co(g,g.return)),g!==null&&_&4&&n_(c,c.memoizedProps,g.memoizedProps);break;case 5:if(Hi(f,c),Vi(c),_&512&&(ia||g===null||Co(g,g.return)),c.flags&32){N=c.stateNode;try{lc(N,"")}catch(yt){Rr(c,c.return,yt)}}_&4&&c.stateNode!=null&&(N=c.memoizedProps,n_(c,N,g!==null?g.memoizedProps:N)),_&1024&&(i_=!0);break;case 6:if(Hi(f,c),Vi(c),_&4){if(c.stateNode===null)throw Error(r(162));_=c.memoizedProps,g=c.stateNode;try{g.nodeValue=_}catch(yt){Rr(c,c.return,yt)}}break;case 3:if(nb=null,N=Fs,Fs=eb(f.containerInfo),Hi(f,c),Fs=N,Vi(c),_&4&&g!==null&&g.memoizedState.isDehydrated)try{Rm(f.containerInfo)}catch(yt){Rr(c,c.return,yt)}i_&&(i_=!1,KN(c));break;case 4:_=Fs,Fs=eb(c.stateNode.containerInfo),Hi(f,c),Vi(c),Fs=_;break;case 12:Hi(f,c),Vi(c);break;case 13:Hi(f,c),Vi(c),c.child.flags&8192&&c.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(f_=le()),_&4&&(_=c.updateQueue,_!==null&&(c.updateQueue=null,s_(c,_)));break;case 22:N=c.memoizedState!==null;var ze=g!==null&&g.memoizedState!==null,dt=_l,Ct=ia;if(_l=dt||N,ia=Ct||ze,Hi(f,c),ia=Ct,_l=dt,Vi(c),_&8192)e:for(f=c.stateNode,f._visibility=N?f._visibility&-2:f._visibility|1,N&&(g===null||ze||_l||ia||id(c)),g=null,f=c;;){if(f.tag===5||f.tag===26){if(g===null){ze=g=f;try{if(P=ze.stateNode,N)se=P.style,typeof se.setProperty=="function"?se.setProperty("display","none","important"):se.display="none";else{Se=ze.stateNode;var It=ze.memoizedProps.style,mt=It!=null&&It.hasOwnProperty("display")?It.display:null;Se.style.display=mt==null||typeof mt=="boolean"?"":(""+mt).trim()}}catch(yt){Rr(ze,ze.return,yt)}}}else if(f.tag===6){if(g===null){ze=f;try{ze.stateNode.nodeValue=N?"":ze.memoizedProps}catch(yt){Rr(ze,ze.return,yt)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===c)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break e;for(;f.sibling===null;){if(f.return===null||f.return===c)break e;g===f&&(g=null),f=f.return}g===f&&(g=null),f.sibling.return=f.return,f=f.sibling}_&4&&(_=c.updateQueue,_!==null&&(g=_.retryQueue,g!==null&&(_.retryQueue=null,s_(c,g))));break;case 19:Hi(f,c),Vi(c),_&4&&(_=c.updateQueue,_!==null&&(c.updateQueue=null,s_(c,_)));break;case 30:break;case 21:break;default:Hi(f,c),Vi(c)}}function Vi(c){var f=c.flags;if(f&2){try{for(var g,_=c.return;_!==null;){if(BN(_)){g=_;break}_=_.return}if(g==null)throw Error(r(160));switch(g.tag){case 27:var N=g.stateNode,P=r_(c);zy(c,P,N);break;case 5:var se=g.stateNode;g.flags&32&&(lc(se,""),g.flags&=-33);var Se=r_(c);zy(c,Se,se);break;case 3:case 4:var ze=g.stateNode.containerInfo,dt=r_(c);a_(c,dt,ze);break;default:throw Error(r(161))}}catch(Ct){Rr(c,c.return,Ct)}c.flags&=-3}f&4096&&(c.flags&=-4097)}function KN(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var f=c;KN(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),c=c.sibling}}function kc(c,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)qN(c,f.alternate,f),f=f.sibling}function id(c){for(c=c.child;c!==null;){var f=c;switch(f.tag){case 0:case 11:case 14:case 15:Cc(4,f,f.return),id(f);break;case 1:Co(f,f.return);var g=f.stateNode;typeof g.componentWillUnmount=="function"&&LN(f,f.return,g),id(f);break;case 27:_m(f.stateNode);case 26:case 5:Co(f,f.return),id(f);break;case 22:f.memoizedState===null&&id(f);break;case 30:id(f);break;default:id(f)}c=c.sibling}}function Tc(c,f,g){for(g=g&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var _=f.alternate,N=c,P=f,se=P.flags;switch(P.tag){case 0:case 11:case 15:Tc(N,P,g),fm(4,P);break;case 1:if(Tc(N,P,g),_=P,N=_.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(dt){Rr(_,_.return,dt)}if(_=P,N=_.updateQueue,N!==null){var Se=_.stateNode;try{var ze=N.shared.hiddenCallbacks;if(ze!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ze.length;N++)SA(ze[N],Se)}catch(dt){Rr(_,_.return,dt)}}g&&se&64&&FN(P),hm(P,P.return);break;case 27:zN(P);case 26:case 5:Tc(N,P,g),g&&_===null&&se&4&&$N(P),hm(P,P.return);break;case 12:Tc(N,P,g);break;case 13:Tc(N,P,g),g&&se&4&&GN(N,P);break;case 22:P.memoizedState===null&&Tc(N,P,g),hm(P,P.return);break;case 30:break;default:Tc(N,P,g)}f=f.sibling}}function o_(c,f){var g=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),c=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(c=f.memoizedState.cachePool.pool),c!==g&&(c!=null&&c.refCount++,g!=null&&Jp(g))}function l_(c,f){c=null,f.alternate!==null&&(c=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==c&&(f.refCount++,c!=null&&Jp(c))}function ko(c,f,g,_){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)ZN(c,f,g,_),f=f.sibling}function ZN(c,f,g,_){var N=f.flags;switch(f.tag){case 0:case 11:case 15:ko(c,f,g,_),N&2048&&fm(9,f);break;case 1:ko(c,f,g,_);break;case 3:ko(c,f,g,_),N&2048&&(c=null,f.alternate!==null&&(c=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==c&&(f.refCount++,c!=null&&Jp(c)));break;case 12:if(N&2048){ko(c,f,g,_),c=f.stateNode;try{var P=f.memoizedProps,se=P.id,Se=P.onPostCommit;typeof Se=="function"&&Se(se,f.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(ze){Rr(f,f.return,ze)}}else ko(c,f,g,_);break;case 13:ko(c,f,g,_);break;case 23:break;case 22:P=f.stateNode,se=f.alternate,f.memoizedState!==null?P._visibility&2?ko(c,f,g,_):pm(c,f):P._visibility&2?ko(c,f,g,_):(P._visibility|=2,Bf(c,f,g,_,(f.subtreeFlags&10256)!==0)),N&2048&&o_(se,f);break;case 24:ko(c,f,g,_),N&2048&&l_(f.alternate,f);break;default:ko(c,f,g,_)}}function Bf(c,f,g,_,N){for(N=N&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var P=c,se=f,Se=g,ze=_,dt=se.flags;switch(se.tag){case 0:case 11:case 15:Bf(P,se,Se,ze,N),fm(8,se);break;case 23:break;case 22:var Ct=se.stateNode;se.memoizedState!==null?Ct._visibility&2?Bf(P,se,Se,ze,N):pm(P,se):(Ct._visibility|=2,Bf(P,se,Se,ze,N)),N&&dt&2048&&o_(se.alternate,se);break;case 24:Bf(P,se,Se,ze,N),N&&dt&2048&&l_(se.alternate,se);break;default:Bf(P,se,Se,ze,N)}f=f.sibling}}function pm(c,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var g=c,_=f,N=_.flags;switch(_.tag){case 22:pm(g,_),N&2048&&o_(_.alternate,_);break;case 24:pm(g,_),N&2048&&l_(_.alternate,_);break;default:pm(g,_)}f=f.sibling}}var mm=8192;function zf(c){if(c.subtreeFlags&mm)for(c=c.child;c!==null;)YN(c),c=c.sibling}function YN(c){switch(c.tag){case 26:zf(c),c.flags&mm&&c.memoizedState!==null&&R7(Fs,c.memoizedState,c.memoizedProps);break;case 5:zf(c);break;case 3:case 4:var f=Fs;Fs=eb(c.stateNode.containerInfo),zf(c),Fs=f;break;case 22:c.memoizedState===null&&(f=c.alternate,f!==null&&f.memoizedState!==null?(f=mm,mm=16777216,zf(c),mm=f):zf(c));break;default:zf(c)}}function XN(c){var f=c.alternate;if(f!==null&&(c=f.child,c!==null)){f.child=null;do f=c.sibling,c.sibling=null,c=f;while(c!==null)}}function gm(c){var f=c.deletions;if((c.flags&16)!==0){if(f!==null)for(var g=0;g<f.length;g++){var _=f[g];Ia=_,QN(_,c)}XN(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)JN(c),c=c.sibling}function JN(c){switch(c.tag){case 0:case 11:case 15:gm(c),c.flags&2048&&Cc(9,c,c.return);break;case 3:gm(c);break;case 12:gm(c);break;case 22:var f=c.stateNode;c.memoizedState!==null&&f._visibility&2&&(c.return===null||c.return.tag!==13)?(f._visibility&=-3,Uy(c)):gm(c);break;default:gm(c)}}function Uy(c){var f=c.deletions;if((c.flags&16)!==0){if(f!==null)for(var g=0;g<f.length;g++){var _=f[g];Ia=_,QN(_,c)}XN(c)}for(c=c.child;c!==null;){switch(f=c,f.tag){case 0:case 11:case 15:Cc(8,f,f.return),Uy(f);break;case 22:g=f.stateNode,g._visibility&2&&(g._visibility&=-3,Uy(f));break;default:Uy(f)}c=c.sibling}}function QN(c,f){for(;Ia!==null;){var g=Ia;switch(g.tag){case 0:case 11:case 15:Cc(8,g,f);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var _=g.memoizedState.cachePool.pool;_!=null&&_.refCount++}break;case 24:Jp(g.memoizedState.cache)}if(_=g.child,_!==null)_.return=g,Ia=_;else e:for(g=c;Ia!==null;){_=Ia;var N=_.sibling,P=_.return;if(HN(_),_===g){Ia=null;break e}if(N!==null){N.return=P,Ia=N;break e}Ia=P}}}var Gz={getCacheForType:function(c){var f=ti(ya),g=f.data.get(c);return g===void 0&&(g=c(),f.data.set(c,g)),g}},Wz=typeof WeakMap=="function"?WeakMap:Map,mr=0,Mr=null,Gn=null,tr=0,gr=0,Gi=null,Ac=!1,Uf=!1,c_=!1,El=0,Qr=0,Nc=0,sd=0,u_=0,ps=0,qf=0,ym=null,Ni=null,d_=!1,f_=0,qy=1/0,Hy=null,Rc=null,Ga=0,Ic=null,Hf=null,Vf=0,h_=0,p_=null,eR=null,bm=0,m_=null;function Wi(){if((mr&2)!==0&&tr!==0)return tr&-tr;if(re.T!==null){var c=jf;return c!==0?c:__()}return H()}function tR(){ps===0&&(ps=(tr&536870912)===0||lr?vt():536870912);var c=hs.current;return c!==null&&(c.flags|=32),ps}function Ki(c,f,g){(c===Mr&&(gr===2||gr===9)||c.cancelPendingCommit!==null)&&(Gf(c,0),jc(c,tr,ps,!1)),nt(c,g),((mr&2)===0||c!==Mr)&&(c===Mr&&((mr&2)===0&&(sd|=g),Qr===4&&jc(c,tr,ps,!1)),To(c))}function nR(c,f,g){if((mr&6)!==0)throw Error(r(327));var _=!g&&(f&124)===0&&(f&c.expiredLanes)===0||ce(c,f),N=_?Yz(c,f):b_(c,f,!0),P=_;do{if(N===0){Uf&&!_&&jc(c,f,0,!1);break}else{if(g=c.current.alternate,P&&!Kz(g)){N=b_(c,f,!1),P=!1;continue}if(N===2){if(P=f,c.errorRecoveryDisabledLanes&P)var se=0;else se=c.pendingLanes&-536870913,se=se!==0?se:se&536870912?536870912:0;if(se!==0){f=se;e:{var Se=c;N=ym;var ze=Se.current.memoizedState.isDehydrated;if(ze&&(Gf(Se,se).flags|=256),se=b_(Se,se,!1),se!==2){if(c_&&!ze){Se.errorRecoveryDisabledLanes|=P,sd|=P,N=4;break e}P=Ni,Ni=N,P!==null&&(Ni===null?Ni=P:Ni.push.apply(Ni,P))}N=se}if(P=!1,N!==2)continue}}if(N===1){Gf(c,0),jc(c,f,0,!0);break}e:{switch(_=c,P=N,P){case 0:case 1:throw Error(r(345));case 4:if((f&4194048)!==f)break;case 6:jc(_,f,ps,!Ac);break e;case 2:Ni=null;break;case 3:case 5:break;default:throw Error(r(329))}if((f&62914560)===f&&(N=f_+300-le(),10<N)){if(jc(_,f,ps,!Ac),Ce(_,0,!0)!==0)break e;_.timeoutHandle=IR(rR.bind(null,_,g,Ni,Hy,d_,f,ps,sd,qf,Ac,P,2,-0,0),N);break e}rR(_,g,Ni,Hy,d_,f,ps,sd,qf,Ac,P,0,-0,0)}}break}while(!0);To(c)}function rR(c,f,g,_,N,P,se,Se,ze,dt,Ct,It,mt,yt){if(c.timeoutHandle=-1,It=f.subtreeFlags,(It&8192||(It&16785408)===16785408)&&(Cm={stylesheets:null,count:0,unsuspend:N7},YN(f),It=I7(),It!==null)){c.cancelPendingCommit=It(uR.bind(null,c,f,P,g,_,N,se,Se,ze,Ct,1,mt,yt)),jc(c,P,se,!dt);return}uR(c,f,P,g,_,N,se,Se,ze)}function Kz(c){for(var f=c;;){var g=f.tag;if((g===0||g===11||g===15)&&f.flags&16384&&(g=f.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var _=0;_<g.length;_++){var N=g[_],P=N.getSnapshot;N=N.value;try{if(!ei(P(),N))return!1}catch{return!1}}if(g=f.child,f.subtreeFlags&16384&&g!==null)g.return=f,f=g;else{if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function jc(c,f,g,_){f&=~u_,f&=~sd,c.suspendedLanes|=f,c.pingedLanes&=~f,_&&(c.warmLanes|=f),_=c.expirationTimes;for(var N=f;0<N;){var P=31-Wt(N),se=1<<P;_[P]=-1,N&=~se}g!==0&&Oe(c,g,f)}function Vy(){return(mr&6)===0?(vm(0),!1):!0}function g_(){if(Gn!==null){if(gr===0)var c=Gn.return;else c=Gn,gl=ed=null,O1(c),Lf=null,cm=0,c=Gn;for(;c!==null;)PN(c.alternate,c),c=c.return;Gn=null}}function Gf(c,f){var g=c.timeoutHandle;g!==-1&&(c.timeoutHandle=-1,f7(g)),g=c.cancelPendingCommit,g!==null&&(c.cancelPendingCommit=null,g()),g_(),Mr=c,Gn=g=hl(c.current,null),tr=f,gr=0,Gi=null,Ac=!1,Uf=ce(c,f),c_=!1,qf=ps=u_=sd=Nc=Qr=0,Ni=ym=null,d_=!1,(f&8)!==0&&(f|=f&32);var _=c.entangledLanes;if(_!==0)for(c=c.entanglements,_&=f;0<_;){var N=31-Wt(_),P=1<<N;f|=c[N],_&=~P}return El=f,_n(),g}function aR(c,f){$n=null,re.H=jy,f===em||f===_y?(f=xA(),gr=3):f===bA?(f=xA(),gr=4):gr=f===_N?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Gi=f,Gn===null&&(Qr=1,Fy(c,pn(f,c.current)))}function iR(){var c=re.H;return re.H=jy,c===null?jy:c}function sR(){var c=re.A;return re.A=Gz,c}function y_(){Qr=4,Ac||(tr&4194048)!==tr&&hs.current!==null||(Uf=!0),(Nc&134217727)===0&&(sd&134217727)===0||Mr===null||jc(Mr,tr,ps,!1)}function b_(c,f,g){var _=mr;mr|=2;var N=iR(),P=sR();(Mr!==c||tr!==f)&&(Hy=null,Gf(c,f)),f=!1;var se=Qr;e:do try{if(gr!==0&&Gn!==null){var Se=Gn,ze=Gi;switch(gr){case 8:g_(),se=6;break e;case 3:case 2:case 9:case 6:hs.current===null&&(f=!0);var dt=gr;if(gr=0,Gi=null,Wf(c,Se,ze,dt),g&&Uf){se=0;break e}break;default:dt=gr,gr=0,Gi=null,Wf(c,Se,ze,dt)}}Zz(),se=Qr;break}catch(Ct){aR(c,Ct)}while(!0);return f&&c.shellSuspendCounter++,gl=ed=null,mr=_,re.H=N,re.A=P,Gn===null&&(Mr=null,tr=0,_n()),se}function Zz(){for(;Gn!==null;)oR(Gn)}function Yz(c,f){var g=mr;mr|=2;var _=iR(),N=sR();Mr!==c||tr!==f?(Hy=null,qy=le()+500,Gf(c,f)):Uf=ce(c,f);e:do try{if(gr!==0&&Gn!==null){f=Gn;var P=Gi;t:switch(gr){case 1:gr=0,Gi=null,Wf(c,f,P,1);break;case 2:case 9:if(vA(P)){gr=0,Gi=null,lR(f);break}f=function(){gr!==2&&gr!==9||Mr!==c||(gr=7),To(c)},P.then(f,f);break e;case 3:gr=7;break e;case 4:gr=5;break e;case 7:vA(P)?(gr=0,Gi=null,lR(f)):(gr=0,Gi=null,Wf(c,f,P,7));break;case 5:var se=null;switch(Gn.tag){case 26:se=Gn.memoizedState;case 5:case 27:var Se=Gn;if(!se||qR(se)){gr=0,Gi=null;var ze=Se.sibling;if(ze!==null)Gn=ze;else{var dt=Se.return;dt!==null?(Gn=dt,Gy(dt)):Gn=null}break t}}gr=0,Gi=null,Wf(c,f,P,5);break;case 6:gr=0,Gi=null,Wf(c,f,P,6);break;case 8:g_(),Qr=6;break e;default:throw Error(r(462))}}Xz();break}catch(Ct){aR(c,Ct)}while(!0);return gl=ed=null,re.H=_,re.A=N,mr=g,Gn!==null?0:(Mr=null,tr=0,_n(),Qr)}function Xz(){for(;Gn!==null&&!ge();)oR(Gn)}function oR(c){var f=DN(c.alternate,c,El);c.memoizedProps=c.pendingProps,f===null?Gy(c):Gn=f}function lR(c){var f=c,g=f.alternate;switch(f.tag){case 15:case 0:f=AN(g,f,f.pendingProps,f.type,void 0,tr);break;case 11:f=AN(g,f,f.pendingProps,f.type.render,f.ref,tr);break;case 5:O1(f);default:PN(g,f),f=Gn=cA(f,El),f=DN(g,f,El)}c.memoizedProps=c.pendingProps,f===null?Gy(c):Gn=f}function Wf(c,f,g,_){gl=ed=null,O1(f),Lf=null,cm=0;var N=f.return;try{if(Bz(c,N,f,g,tr)){Qr=1,Fy(c,pn(g,c.current)),Gn=null;return}}catch(P){if(N!==null)throw Gn=N,P;Qr=1,Fy(c,pn(g,c.current)),Gn=null;return}f.flags&32768?(lr||_===1?c=!0:Uf||(tr&536870912)!==0?c=!1:(Ac=c=!0,(_===2||_===9||_===3||_===6)&&(_=hs.current,_!==null&&_.tag===13&&(_.flags|=16384))),cR(f,c)):Gy(f)}function Gy(c){var f=c;do{if((f.flags&32768)!==0){cR(f,Ac);return}c=f.return;var g=Uz(f.alternate,f,El);if(g!==null){Gn=g;return}if(f=f.sibling,f!==null){Gn=f;return}Gn=f=c}while(f!==null);Qr===0&&(Qr=5)}function cR(c,f){do{var g=qz(c.alternate,c);if(g!==null){g.flags&=32767,Gn=g;return}if(g=c.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!f&&(c=c.sibling,c!==null)){Gn=c;return}Gn=c=g}while(c!==null);Qr=6,Gn=null}function uR(c,f,g,_,N,P,se,Se,ze){c.cancelPendingCommit=null;do Wy();while(Ga!==0);if((mr&6)!==0)throw Error(r(327));if(f!==null){if(f===c.current)throw Error(r(177));if(P=f.lanes|f.childLanes,P|=Ha,ye(c,g,P,se,Se,ze),c===Mr&&(Gn=Mr=null,tr=0),Hf=f,Ic=c,Vf=g,h_=P,p_=N,eR=_,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(c.callbackNode=null,c.callbackPriority=0,t7(Me,function(){return mR(),null})):(c.callbackNode=null,c.callbackPriority=0),_=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||_){_=re.T,re.T=null,N=Y.p,Y.p=2,se=mr,mr|=4;try{Hz(c,f,g)}finally{mr=se,Y.p=N,re.T=_}}Ga=1,dR(),fR(),hR()}}function dR(){if(Ga===1){Ga=0;var c=Ic,f=Hf,g=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||g){g=re.T,re.T=null;var _=Y.p;Y.p=2;var N=mr;mr|=4;try{WN(f,c);var P=R_,se=ue(c.containerInfo),Se=P.focusedElem,ze=P.selectionRange;if(se!==Se&&Se&&Se.ownerDocument&&ne(Se.ownerDocument.documentElement,Se)){if(ze!==null&&we(Se)){var dt=ze.start,Ct=ze.end;if(Ct===void 0&&(Ct=dt),"selectionStart"in Se)Se.selectionStart=dt,Se.selectionEnd=Math.min(Ct,Se.value.length);else{var It=Se.ownerDocument||document,mt=It&&It.defaultView||window;if(mt.getSelection){var yt=mt.getSelection(),Sn=Se.textContent.length,yn=Math.min(ze.start,Sn),Er=ze.end===void 0?yn:Math.min(ze.end,Sn);!yt.extend&&yn>Er&&(se=Er,Er=yn,yn=se);var at=Z(Se,yn),Ze=Z(Se,Er);if(at&&Ze&&(yt.rangeCount!==1||yt.anchorNode!==at.node||yt.anchorOffset!==at.offset||yt.focusNode!==Ze.node||yt.focusOffset!==Ze.offset)){var ct=It.createRange();ct.setStart(at.node,at.offset),yt.removeAllRanges(),yn>Er?(yt.addRange(ct),yt.extend(Ze.node,Ze.offset)):(ct.setEnd(Ze.node,Ze.offset),yt.addRange(ct))}}}}for(It=[],yt=Se;yt=yt.parentNode;)yt.nodeType===1&&It.push({element:yt,left:yt.scrollLeft,top:yt.scrollTop});for(typeof Se.focus=="function"&&Se.focus(),Se=0;Se<It.length;Se++){var At=It[Se];At.element.scrollLeft=At.left,At.element.scrollTop=At.top}}ib=!!N_,R_=N_=null}finally{mr=N,Y.p=_,re.T=g}}c.current=f,Ga=2}}function fR(){if(Ga===2){Ga=0;var c=Ic,f=Hf,g=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||g){g=re.T,re.T=null;var _=Y.p;Y.p=2;var N=mr;mr|=4;try{qN(c,f.alternate,f)}finally{mr=N,Y.p=_,re.T=g}}Ga=3}}function hR(){if(Ga===4||Ga===3){Ga=0,Te();var c=Ic,f=Hf,g=Vf,_=eR;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?Ga=5:(Ga=0,Hf=Ic=null,pR(c,c.pendingLanes));var N=c.pendingLanes;if(N===0&&(Rc=null),pe(g),f=f.stateNode,Dt&&typeof Dt.onCommitFiberRoot=="function")try{Dt.onCommitFiberRoot(xt,f,void 0,(f.current.flags&128)===128)}catch{}if(_!==null){f=re.T,N=Y.p,Y.p=2,re.T=null;try{for(var P=c.onRecoverableError,se=0;se<_.length;se++){var Se=_[se];P(Se.value,{componentStack:Se.stack})}}finally{re.T=f,Y.p=N}}(Vf&3)!==0&&Wy(),To(c),N=c.pendingLanes,(g&4194090)!==0&&(N&42)!==0?c===m_?bm++:(bm=0,m_=c):bm=0,vm(0)}}function pR(c,f){(c.pooledCacheLanes&=f)===0&&(f=c.pooledCache,f!=null&&(c.pooledCache=null,Jp(f)))}function Wy(c){return dR(),fR(),hR(),mR()}function mR(){if(Ga!==5)return!1;var c=Ic,f=h_;h_=0;var g=pe(Vf),_=re.T,N=Y.p;try{Y.p=32>g?32:g,re.T=null,g=p_,p_=null;var P=Ic,se=Vf;if(Ga=0,Hf=Ic=null,Vf=0,(mr&6)!==0)throw Error(r(331));var Se=mr;if(mr|=4,JN(P.current),ZN(P,P.current,se,g),mr=Se,vm(0,!1),Dt&&typeof Dt.onPostCommitFiberRoot=="function")try{Dt.onPostCommitFiberRoot(xt,P)}catch{}return!0}finally{Y.p=N,re.T=_,pR(c,f)}}function gR(c,f,g){f=pn(g,f),f=W1(c.stateNode,f,2),c=xc(c,f,2),c!==null&&(nt(c,2),To(c))}function Rr(c,f,g){if(c.tag===3)gR(c,c,g);else for(;f!==null;){if(f.tag===3){gR(f,c,g);break}else if(f.tag===1){var _=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Rc===null||!Rc.has(_))){c=pn(g,c),g=wN(2),_=xc(f,g,2),_!==null&&(xN(g,_,f,c),nt(_,2),To(_));break}}f=f.return}}function v_(c,f,g){var _=c.pingCache;if(_===null){_=c.pingCache=new Wz;var N=new Set;_.set(f,N)}else N=_.get(f),N===void 0&&(N=new Set,_.set(f,N));N.has(g)||(c_=!0,N.add(g),c=Jz.bind(null,c,f,g),f.then(c,c))}function Jz(c,f,g){var _=c.pingCache;_!==null&&_.delete(f),c.pingedLanes|=c.suspendedLanes&g,c.warmLanes&=~g,Mr===c&&(tr&g)===g&&(Qr===4||Qr===3&&(tr&62914560)===tr&&300>le()-f_?(mr&2)===0&&Gf(c,0):u_|=g,qf===tr&&(qf=0)),To(c)}function yR(c,f){f===0&&(f=M()),c=Ps(c,f),c!==null&&(nt(c,f),To(c))}function Qz(c){var f=c.memoizedState,g=0;f!==null&&(g=f.retryLane),yR(c,g)}function e7(c,f){var g=0;switch(c.tag){case 13:var _=c.stateNode,N=c.memoizedState;N!==null&&(g=N.retryLane);break;case 19:_=c.stateNode;break;case 22:_=c.stateNode._retryCache;break;default:throw Error(r(314))}_!==null&&_.delete(f),yR(c,g)}function t7(c,f){return Ie(c,f)}var Ky=null,Kf=null,w_=!1,Zy=!1,x_=!1,od=0;function To(c){c!==Kf&&c.next===null&&(Kf===null?Ky=Kf=c:Kf=Kf.next=c),Zy=!0,w_||(w_=!0,r7())}function vm(c,f){if(!x_&&Zy){x_=!0;do for(var g=!1,_=Ky;_!==null;){if(c!==0){var N=_.pendingLanes;if(N===0)var P=0;else{var se=_.suspendedLanes,Se=_.pingedLanes;P=(1<<31-Wt(42|c)+1)-1,P&=N&~(se&~Se),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(g=!0,xR(_,P))}else P=tr,P=Ce(_,_===Mr?P:0,_.cancelPendingCommit!==null||_.timeoutHandle!==-1),(P&3)===0||ce(_,P)||(g=!0,xR(_,P));_=_.next}while(g);x_=!1}}function n7(){bR()}function bR(){Zy=w_=!1;var c=0;od!==0&&(d7()&&(c=od),od=0);for(var f=le(),g=null,_=Ky;_!==null;){var N=_.next,P=vR(_,f);P===0?(_.next=null,g===null?Ky=N:g.next=N,N===null&&(Kf=g)):(g=_,(c!==0||(P&3)!==0)&&(Zy=!0)),_=N}vm(c)}function vR(c,f){for(var g=c.suspendedLanes,_=c.pingedLanes,N=c.expirationTimes,P=c.pendingLanes&-62914561;0<P;){var se=31-Wt(P),Se=1<<se,ze=N[se];ze===-1?((Se&g)===0||(Se&_)!==0)&&(N[se]=ft(Se,f)):ze<=f&&(c.expiredLanes|=Se),P&=~Se}if(f=Mr,g=tr,g=Ce(c,c===f?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),_=c.callbackNode,g===0||c===f&&(gr===2||gr===9)||c.cancelPendingCommit!==null)return _!==null&&_!==null&&V(_),c.callbackNode=null,c.callbackPriority=0;if((g&3)===0||ce(c,g)){if(f=g&-g,f===c.callbackPriority)return f;switch(_!==null&&V(_),pe(g)){case 2:case 8:g=_e;break;case 32:g=Me;break;case 268435456:g=We;break;default:g=Me}return _=wR.bind(null,c),g=Ie(g,_),c.callbackPriority=f,c.callbackNode=g,f}return _!==null&&_!==null&&V(_),c.callbackPriority=2,c.callbackNode=null,2}function wR(c,f){if(Ga!==0&&Ga!==5)return c.callbackNode=null,c.callbackPriority=0,null;var g=c.callbackNode;if(Wy()&&c.callbackNode!==g)return null;var _=tr;return _=Ce(c,c===Mr?_:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),_===0?null:(nR(c,_,f),vR(c,le()),c.callbackNode!=null&&c.callbackNode===g?wR.bind(null,c):null)}function xR(c,f){if(Wy())return null;nR(c,f,!0)}function r7(){h7(function(){(mr&6)!==0?Ie(te,n7):bR()})}function __(){return od===0&&(od=vt()),od}function _R(c){return c==null||typeof c=="symbol"||typeof c=="boolean"?null:typeof c=="function"?c:al(""+c)}function SR(c,f){var g=f.ownerDocument.createElement("input");return g.name=f.name,g.value=f.value,c.id&&g.setAttribute("form",c.id),f.parentNode.insertBefore(g,f),c=new FormData(c),g.parentNode.removeChild(g),c}function a7(c,f,g,_,N){if(f==="submit"&&g&&g.stateNode===N){var P=_R((N[Ae]||null).action),se=_.submitter;se&&(f=(f=se[Ae]||null)?_R(f.formAction):se.getAttribute("formAction"),f!==null&&(P=f,se=null));var Se=new pf("action","action",null,_,N);c.push({event:Se,listeners:[{instance:null,listener:function(){if(_.defaultPrevented){if(od!==0){var ze=se?SR(N,se):new FormData(N);U1(g,{pending:!0,data:ze,method:N.method,action:P},null,ze)}}else typeof P=="function"&&(Se.preventDefault(),ze=se?SR(N,se):new FormData(N),U1(g,{pending:!0,data:ze,method:N.method,action:P},P,ze))},currentTarget:N}]})}}for(var S_=0;S_<Zt.length;S_++){var E_=Zt[S_],i7=E_.toLowerCase(),s7=E_[0].toUpperCase()+E_.slice(1);Bt(i7,"on"+s7)}Bt(ht,"onAnimationEnd"),Bt(bt,"onAnimationIteration"),Bt(wt,"onAnimationStart"),Bt("dblclick","onDoubleClick"),Bt("focusin","onFocus"),Bt("focusout","onBlur"),Bt(Et,"onTransitionRun"),Bt(Ut,"onTransitionStart"),Bt(Kt,"onTransitionCancel"),Bt($t,"onTransitionEnd"),mo("onMouseEnter",["mouseout","mouseover"]),mo("onMouseLeave",["mouseout","mouseover"]),mo("onPointerEnter",["pointerout","pointerover"]),mo("onPointerLeave",["pointerout","pointerover"]),po("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),po("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),po("onBeforeInput",["compositionend","keypress","textInput","paste"]),po("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),po("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),po("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o7=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wm));function ER(c,f){f=(f&4)!==0;for(var g=0;g<c.length;g++){var _=c[g],N=_.event;_=_.listeners;e:{var P=void 0;if(f)for(var se=_.length-1;0<=se;se--){var Se=_[se],ze=Se.instance,dt=Se.currentTarget;if(Se=Se.listener,ze!==P&&N.isPropagationStopped())break e;P=Se,N.currentTarget=dt;try{P(N)}catch(Ct){Py(Ct)}N.currentTarget=null,P=ze}else for(se=0;se<_.length;se++){if(Se=_[se],ze=Se.instance,dt=Se.currentTarget,Se=Se.listener,ze!==P&&N.isPropagationStopped())break e;P=Se,N.currentTarget=dt;try{P(N)}catch(Ct){Py(Ct)}N.currentTarget=null,P=ze}}}}function Wn(c,f){var g=f[pt];g===void 0&&(g=f[pt]=new Set);var _=c+"__bubble";g.has(_)||(CR(f,c,2,!1),g.add(_))}function C_(c,f,g){var _=0;f&&(_|=4),CR(g,c,_,f)}var Yy="_reactListening"+Math.random().toString(36).slice(2);function k_(c){if(!c[Yy]){c[Yy]=!0,hi.forEach(function(g){g!=="selectionchange"&&(o7.has(g)||C_(g,!1,c),C_(g,!0,c))});var f=c.nodeType===9?c:c.ownerDocument;f===null||f[Yy]||(f[Yy]=!0,C_("selectionchange",!1,f))}}function CR(c,f,g,_){switch(ZR(f)){case 2:var N=D7;break;case 8:N=M7;break;default:N=B_}g=N.bind(null,f,g,c),N=void 0,!Dp||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(N=!0),_?N!==void 0?c.addEventListener(f,g,{capture:!0,passive:N}):c.addEventListener(f,g,!0):N!==void 0?c.addEventListener(f,g,{passive:N}):c.addEventListener(f,g,!1)}function T_(c,f,g,_,N){var P=_;if((f&1)===0&&(f&2)===0&&_!==null)e:for(;;){if(_===null)return;var se=_.tag;if(se===3||se===4){var Se=_.stateNode.containerInfo;if(Se===N)break;if(se===4)for(se=_.return;se!==null;){var ze=se.tag;if((ze===3||ze===4)&&se.stateNode.containerInfo===N)return;se=se.return}for(;Se!==null;){if(se=An(Se),se===null)return;if(ze=se.tag,ze===5||ze===6||ze===26||ze===27){_=P=se;continue e}Se=Se.parentNode}}_=_.return}uc(function(){var dt=P,Ct=ff(g),It=[];e:{var mt=Ht.get(c);if(mt!==void 0){var yt=pf,Sn=c;switch(c){case"keypress":if(hc(g)===0)break e;case"keydown":case"keyup":yt=_f;break;case"focusin":Sn="focus",yt=pc;break;case"focusout":Sn="blur",yt=pc;break;case"beforeblur":case"afterblur":yt=pc;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":yt=yf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":yt=iy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":yt=zp;break;case ht:case bt:case wt:yt=sy;break;case $t:yt=Up;break;case"scroll":case"scrollend":yt=mf;break;case"wheel":yt=Ef;break;case"copy":case"cut":case"paste":yt=wf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":yt=Bp;break;case"toggle":case"beforetoggle":yt=cy}var yn=(f&4)!==0,Er=!yn&&(c==="scroll"||c==="scrollend"),at=yn?mt!==null?mt+"Capture":null:mt;yn=[];for(var Ze=dt,ct;Ze!==null;){var At=Ze;if(ct=At.stateNode,At=At.tag,At!==5&&At!==26&&At!==27||ct===null||at===null||(At=ol(Ze,at),At!=null&&yn.push(xm(Ze,At,ct))),Er)break;Ze=Ze.return}0<yn.length&&(mt=new yt(mt,Sn,null,g,Ct),It.push({event:mt,listeners:yn}))}}if((f&7)===0){e:{if(mt=c==="mouseover"||c==="pointerover",yt=c==="mouseout"||c==="pointerout",mt&&g!==os&&(Sn=g.relatedTarget||g.fromElement)&&(An(Sn)||Sn[qe]))break e;if((yt||mt)&&(mt=Ct.window===Ct?Ct:(mt=Ct.ownerDocument)?mt.defaultView||mt.parentWindow:window,yt?(Sn=g.relatedTarget||g.toElement,yt=dt,Sn=Sn?An(Sn):null,Sn!==null&&(Er=i(Sn),yn=Sn.tag,Sn!==Er||yn!==5&&yn!==27&&yn!==6)&&(Sn=null)):(yt=null,Sn=dt),yt!==Sn)){if(yn=yf,At="onMouseLeave",at="onMouseEnter",Ze="mouse",(c==="pointerout"||c==="pointerover")&&(yn=Bp,At="onPointerLeave",at="onPointerEnter",Ze="pointer"),Er=yt==null?mt:wr(yt),ct=Sn==null?mt:wr(Sn),mt=new yn(At,Ze+"leave",yt,g,Ct),mt.target=Er,mt.relatedTarget=ct,At=null,An(Ct)===dt&&(yn=new yn(at,Ze+"enter",Sn,g,Ct),yn.target=ct,yn.relatedTarget=Er,At=yn),Er=At,yt&&Sn)t:{for(yn=yt,at=Sn,Ze=0,ct=yn;ct;ct=Zf(ct))Ze++;for(ct=0,At=at;At;At=Zf(At))ct++;for(;0<Ze-ct;)yn=Zf(yn),Ze--;for(;0<ct-Ze;)at=Zf(at),ct--;for(;Ze--;){if(yn===at||at!==null&&yn===at.alternate)break t;yn=Zf(yn),at=Zf(at)}yn=null}else yn=null;yt!==null&&kR(It,mt,yt,yn,!1),Sn!==null&&Er!==null&&kR(It,Er,Sn,yn,!0)}}e:{if(mt=dt?wr(dt):window,yt=mt.nodeName&&mt.nodeName.toLowerCase(),yt==="select"||yt==="input"&&mt.type==="file")var sn=Ku;else if(Tf(mt))if(cs)sn=yc;else{sn=fl;var Un=my}else yt=mt.nodeName,!yt||yt.toLowerCase()!=="input"||mt.type!=="checkbox"&&mt.type!=="radio"?dt&&Op(dt.elementType)&&(sn=Ku):sn=Wp;if(sn&&(sn=sn(c,dt))){Gp(It,sn,g,Ct);break e}Un&&Un(c,mt,dt),c==="focusout"&&dt&&mt.type==="number"&&dt.memoizedProps.value!=null&&sc(mt,"number",mt.value)}switch(Un=dt?wr(dt):window,c){case"focusin":(Tf(Un)||Un.contentEditable==="true")&&($e=Un,Ge=dt,Ye=null);break;case"focusout":Ye=Ge=$e=null;break;case"mousedown":rt=!0;break;case"contextmenu":case"mouseup":case"dragend":rt=!1,He(It,g,Ct);break;case"selectionchange":if(De)break;case"keydown":case"keyup":He(It,g,Ct)}var fn;if(Gu)e:{switch(c){case"compositionstart":var wn="onCompositionStart";break e;case"compositionend":wn="onCompositionEnd";break e;case"compositionupdate":wn="onCompositionUpdate";break e}wn=void 0}else dl?Vp(c,g)&&(wn="onCompositionEnd"):c==="keydown"&&g.keyCode===229&&(wn="onCompositionStart");wn&&(Cf&&g.locale!=="ko"&&(dl||wn!=="onCompositionStart"?wn==="onCompositionEnd"&&dl&&(fn=fc()):(ls=Ct,hf="value"in ls?ls.value:ls.textContent,dl=!0)),Un=Xy(dt,wn),0<Un.length&&(wn=new xf(wn,c,null,g,Ct),It.push({event:wn,listeners:Un}),fn?wn.data=fn:(fn=dy(g),fn!==null&&(wn.data=fn)))),(fn=o1?fy(c,g):l1(c,g))&&(wn=Xy(dt,"onBeforeInput"),0<wn.length&&(Un=new xf("onBeforeInput","beforeinput",null,g,Ct),It.push({event:Un,listeners:wn}),Un.data=fn)),a7(It,c,dt,g,Ct)}ER(It,f)})}function xm(c,f,g){return{instance:c,listener:f,currentTarget:g}}function Xy(c,f){for(var g=f+"Capture",_=[];c!==null;){var N=c,P=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||P===null||(N=ol(c,g),N!=null&&_.unshift(xm(c,N,P)),N=ol(c,f),N!=null&&_.push(xm(c,N,P))),c.tag===3)return _;c=c.return}return[]}function Zf(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5&&c.tag!==27);return c||null}function kR(c,f,g,_,N){for(var P=f._reactName,se=[];g!==null&&g!==_;){var Se=g,ze=Se.alternate,dt=Se.stateNode;if(Se=Se.tag,ze!==null&&ze===_)break;Se!==5&&Se!==26&&Se!==27||dt===null||(ze=dt,N?(dt=ol(g,P),dt!=null&&se.unshift(xm(g,dt,ze))):N||(dt=ol(g,P),dt!=null&&se.push(xm(g,dt,ze)))),g=g.return}se.length!==0&&c.push({event:f,listeners:se})}var l7=/\r\n?/g,c7=/\u0000|\uFFFD/g;function TR(c){return(typeof c=="string"?c:""+c).replace(l7,`
`).replace(c7,"")}function AR(c,f){return f=TR(f),TR(c)===f}function Jy(){}function Sr(c,f,g,_,N,P){switch(g){case"children":typeof _=="string"?f==="body"||f==="textarea"&&_===""||lc(c,_):(typeof _=="number"||typeof _=="bigint")&&f!=="body"&&lc(c,""+_);break;case"className":tl(c,"class",_);break;case"tabIndex":tl(c,"tabindex",_);break;case"dir":case"role":case"viewBox":case"width":case"height":tl(c,g,_);break;case"style":ry(c,_,P);break;case"data":if(f!=="object"){tl(c,"data",_);break}case"src":case"href":if(_===""&&(f!=="a"||g!=="href")){c.removeAttribute(g);break}if(_==null||typeof _=="function"||typeof _=="symbol"||typeof _=="boolean"){c.removeAttribute(g);break}_=al(""+_),c.setAttribute(g,_);break;case"action":case"formAction":if(typeof _=="function"){c.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(g==="formAction"?(f!=="input"&&Sr(c,f,"name",N.name,N,null),Sr(c,f,"formEncType",N.formEncType,N,null),Sr(c,f,"formMethod",N.formMethod,N,null),Sr(c,f,"formTarget",N.formTarget,N,null)):(Sr(c,f,"encType",N.encType,N,null),Sr(c,f,"method",N.method,N,null),Sr(c,f,"target",N.target,N,null)));if(_==null||typeof _=="symbol"||typeof _=="boolean"){c.removeAttribute(g);break}_=al(""+_),c.setAttribute(g,_);break;case"onClick":_!=null&&(c.onclick=Jy);break;case"onScroll":_!=null&&Wn("scroll",c);break;case"onScrollEnd":_!=null&&Wn("scrollend",c);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(r(61));if(g=_.__html,g!=null){if(N.children!=null)throw Error(r(60));c.innerHTML=g}}break;case"multiple":c.multiple=_&&typeof _!="function"&&typeof _!="symbol";break;case"muted":c.muted=_&&typeof _!="function"&&typeof _!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(_==null||typeof _=="function"||typeof _=="boolean"||typeof _=="symbol"){c.removeAttribute("xlink:href");break}g=al(""+_),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":_!=null&&typeof _!="function"&&typeof _!="symbol"?c.setAttribute(g,""+_):c.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":_&&typeof _!="function"&&typeof _!="symbol"?c.setAttribute(g,""):c.removeAttribute(g);break;case"capture":case"download":_===!0?c.setAttribute(g,""):_!==!1&&_!=null&&typeof _!="function"&&typeof _!="symbol"?c.setAttribute(g,_):c.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":_!=null&&typeof _!="function"&&typeof _!="symbol"&&!isNaN(_)&&1<=_?c.setAttribute(g,_):c.removeAttribute(g);break;case"rowSpan":case"start":_==null||typeof _=="function"||typeof _=="symbol"||isNaN(_)?c.removeAttribute(g):c.setAttribute(g,_);break;case"popover":Wn("beforetoggle",c),Wn("toggle",c),Ds(c,"popover",_);break;case"xlinkActuate":zi(c,"http://www.w3.org/1999/xlink","xlink:actuate",_);break;case"xlinkArcrole":zi(c,"http://www.w3.org/1999/xlink","xlink:arcrole",_);break;case"xlinkRole":zi(c,"http://www.w3.org/1999/xlink","xlink:role",_);break;case"xlinkShow":zi(c,"http://www.w3.org/1999/xlink","xlink:show",_);break;case"xlinkTitle":zi(c,"http://www.w3.org/1999/xlink","xlink:title",_);break;case"xlinkType":zi(c,"http://www.w3.org/1999/xlink","xlink:type",_);break;case"xmlBase":zi(c,"http://www.w3.org/XML/1998/namespace","xml:base",_);break;case"xmlLang":zi(c,"http://www.w3.org/XML/1998/namespace","xml:lang",_);break;case"xmlSpace":zi(c,"http://www.w3.org/XML/1998/namespace","xml:space",_);break;case"is":Ds(c,"is",_);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=mi.get(g)||g,Ds(c,g,_))}}function A_(c,f,g,_,N,P){switch(g){case"style":ry(c,_,P);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(r(61));if(g=_.__html,g!=null){if(N.children!=null)throw Error(r(60));c.innerHTML=g}}break;case"children":typeof _=="string"?lc(c,_):(typeof _=="number"||typeof _=="bigint")&&lc(c,""+_);break;case"onScroll":_!=null&&Wn("scroll",c);break;case"onScrollEnd":_!=null&&Wn("scrollend",c);break;case"onClick":_!=null&&(c.onclick=Jy);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ho.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(N=g.endsWith("Capture"),f=g.slice(2,N?g.length-7:void 0),P=c[Ae]||null,P=P!=null?P[g]:null,typeof P=="function"&&c.removeEventListener(f,P,N),typeof _=="function")){typeof P!="function"&&P!==null&&(g in c?c[g]=null:c.hasAttribute(g)&&c.removeAttribute(g)),c.addEventListener(f,_,N);break e}g in c?c[g]=_:_===!0?c.setAttribute(g,""):Ds(c,g,_)}}}function Wa(c,f,g){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Wn("error",c),Wn("load",c);var _=!1,N=!1,P;for(P in g)if(g.hasOwnProperty(P)){var se=g[P];if(se!=null)switch(P){case"src":_=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,f));default:Sr(c,f,P,se,g,null)}}N&&Sr(c,f,"srcSet",g.srcSet,g,null),_&&Sr(c,f,"src",g.src,g,null);return;case"input":Wn("invalid",c);var Se=P=se=N=null,ze=null,dt=null;for(_ in g)if(g.hasOwnProperty(_)){var Ct=g[_];if(Ct!=null)switch(_){case"name":N=Ct;break;case"type":se=Ct;break;case"checked":ze=Ct;break;case"defaultChecked":dt=Ct;break;case"value":P=Ct;break;case"defaultValue":Se=Ct;break;case"children":case"dangerouslySetInnerHTML":if(Ct!=null)throw Error(r(137,f));break;default:Sr(c,f,_,Ct,g,null)}}Ip(c,P,Se,ze,dt,se,N,!1),bo(c);return;case"select":Wn("invalid",c),_=se=P=null;for(N in g)if(g.hasOwnProperty(N)&&(Se=g[N],Se!=null))switch(N){case"value":P=Se;break;case"defaultValue":se=Se;break;case"multiple":_=Se;default:Sr(c,f,N,Se,g,null)}f=P,g=se,c.multiple=!!_,f!=null?rl(c,!!_,f,!1):g!=null&&rl(c,!!_,g,!0);return;case"textarea":Wn("invalid",c),P=N=_=null;for(se in g)if(g.hasOwnProperty(se)&&(Se=g[se],Se!=null))switch(se){case"value":_=Se;break;case"defaultValue":N=Se;break;case"children":P=Se;break;case"dangerouslySetInnerHTML":if(Se!=null)throw Error(r(91));break;default:Sr(c,f,se,Se,g,null)}jp(c,_,N,P),bo(c);return;case"option":for(ze in g)if(g.hasOwnProperty(ze)&&(_=g[ze],_!=null))switch(ze){case"selected":c.selected=_&&typeof _!="function"&&typeof _!="symbol";break;default:Sr(c,f,ze,_,g,null)}return;case"dialog":Wn("beforetoggle",c),Wn("toggle",c),Wn("cancel",c),Wn("close",c);break;case"iframe":case"object":Wn("load",c);break;case"video":case"audio":for(_=0;_<wm.length;_++)Wn(wm[_],c);break;case"image":Wn("error",c),Wn("load",c);break;case"details":Wn("toggle",c);break;case"embed":case"source":case"link":Wn("error",c),Wn("load",c);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(dt in g)if(g.hasOwnProperty(dt)&&(_=g[dt],_!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,f));default:Sr(c,f,dt,_,g,null)}return;default:if(Op(f)){for(Ct in g)g.hasOwnProperty(Ct)&&(_=g[Ct],_!==void 0&&A_(c,f,Ct,_,g,void 0));return}}for(Se in g)g.hasOwnProperty(Se)&&(_=g[Se],_!=null&&Sr(c,f,Se,_,g,null))}function u7(c,f,g,_){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,P=null,se=null,Se=null,ze=null,dt=null,Ct=null;for(yt in g){var It=g[yt];if(g.hasOwnProperty(yt)&&It!=null)switch(yt){case"checked":break;case"value":break;case"defaultValue":ze=It;default:_.hasOwnProperty(yt)||Sr(c,f,yt,null,_,It)}}for(var mt in _){var yt=_[mt];if(It=g[mt],_.hasOwnProperty(mt)&&(yt!=null||It!=null))switch(mt){case"type":P=yt;break;case"name":N=yt;break;case"checked":dt=yt;break;case"defaultChecked":Ct=yt;break;case"value":se=yt;break;case"defaultValue":Se=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(r(137,f));break;default:yt!==It&&Sr(c,f,mt,yt,_,It)}}ic(c,se,Se,ze,dt,Ct,P,N);return;case"select":yt=se=Se=mt=null;for(P in g)if(ze=g[P],g.hasOwnProperty(P)&&ze!=null)switch(P){case"value":break;case"multiple":yt=ze;default:_.hasOwnProperty(P)||Sr(c,f,P,null,_,ze)}for(N in _)if(P=_[N],ze=g[N],_.hasOwnProperty(N)&&(P!=null||ze!=null))switch(N){case"value":mt=P;break;case"defaultValue":Se=P;break;case"multiple":se=P;default:P!==ze&&Sr(c,f,N,P,_,ze)}f=Se,g=se,_=yt,mt!=null?rl(c,!!g,mt,!1):!!_!=!!g&&(f!=null?rl(c,!!g,f,!0):rl(c,!!g,g?[]:"",!1));return;case"textarea":yt=mt=null;for(Se in g)if(N=g[Se],g.hasOwnProperty(Se)&&N!=null&&!_.hasOwnProperty(Se))switch(Se){case"value":break;case"children":break;default:Sr(c,f,Se,null,_,N)}for(se in _)if(N=_[se],P=g[se],_.hasOwnProperty(se)&&(N!=null||P!=null))switch(se){case"value":mt=N;break;case"defaultValue":yt=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==P&&Sr(c,f,se,N,_,P)}oc(c,mt,yt);return;case"option":for(var Sn in g)if(mt=g[Sn],g.hasOwnProperty(Sn)&&mt!=null&&!_.hasOwnProperty(Sn))switch(Sn){case"selected":c.selected=!1;break;default:Sr(c,f,Sn,null,_,mt)}for(ze in _)if(mt=_[ze],yt=g[ze],_.hasOwnProperty(ze)&&mt!==yt&&(mt!=null||yt!=null))switch(ze){case"selected":c.selected=mt&&typeof mt!="function"&&typeof mt!="symbol";break;default:Sr(c,f,ze,mt,_,yt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var yn in g)mt=g[yn],g.hasOwnProperty(yn)&&mt!=null&&!_.hasOwnProperty(yn)&&Sr(c,f,yn,null,_,mt);for(dt in _)if(mt=_[dt],yt=g[dt],_.hasOwnProperty(dt)&&mt!==yt&&(mt!=null||yt!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":if(mt!=null)throw Error(r(137,f));break;default:Sr(c,f,dt,mt,_,yt)}return;default:if(Op(f)){for(var Er in g)mt=g[Er],g.hasOwnProperty(Er)&&mt!==void 0&&!_.hasOwnProperty(Er)&&A_(c,f,Er,void 0,_,mt);for(Ct in _)mt=_[Ct],yt=g[Ct],!_.hasOwnProperty(Ct)||mt===yt||mt===void 0&&yt===void 0||A_(c,f,Ct,mt,_,yt);return}}for(var at in g)mt=g[at],g.hasOwnProperty(at)&&mt!=null&&!_.hasOwnProperty(at)&&Sr(c,f,at,null,_,mt);for(It in _)mt=_[It],yt=g[It],!_.hasOwnProperty(It)||mt===yt||mt==null&&yt==null||Sr(c,f,It,mt,_,yt)}var N_=null,R_=null;function Qy(c){return c.nodeType===9?c:c.ownerDocument}function NR(c){switch(c){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function RR(c,f){if(c===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return c===1&&f==="foreignObject"?0:c}function I_(c,f){return c==="textarea"||c==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var j_=null;function d7(){var c=window.event;return c&&c.type==="popstate"?c===j_?!1:(j_=c,!0):(j_=null,!1)}var IR=typeof setTimeout=="function"?setTimeout:void 0,f7=typeof clearTimeout=="function"?clearTimeout:void 0,jR=typeof Promise=="function"?Promise:void 0,h7=typeof queueMicrotask=="function"?queueMicrotask:typeof jR<"u"?function(c){return jR.resolve(null).then(c).catch(p7)}:IR;function p7(c){setTimeout(function(){throw c})}function Oc(c){return c==="head"}function OR(c,f){var g=f,_=0,N=0;do{var P=g.nextSibling;if(c.removeChild(g),P&&P.nodeType===8)if(g=P.data,g==="/$"){if(0<_&&8>_){g=_;var se=c.ownerDocument;if(g&1&&_m(se.documentElement),g&2&&_m(se.body),g&4)for(g=se.head,_m(g),se=g.firstChild;se;){var Se=se.nextSibling,ze=se.nodeName;se[Pt]||ze==="SCRIPT"||ze==="STYLE"||ze==="LINK"&&se.rel.toLowerCase()==="stylesheet"||g.removeChild(se),se=Se}}if(N===0){c.removeChild(P),Rm(f);return}N--}else g==="$"||g==="$?"||g==="$!"?N++:_=g.charCodeAt(0)-48;else _=0;g=P}while(g);Rm(f)}function O_(c){var f=c.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var g=f;switch(f=f.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":O_(g),Jt(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}c.removeChild(g)}}function m7(c,f,g,_){for(;c.nodeType===1;){var N=g;if(c.nodeName.toLowerCase()!==f.toLowerCase()){if(!_&&(c.nodeName!=="INPUT"||c.type!=="hidden"))break}else if(_){if(!c[Pt])switch(f){case"meta":if(!c.hasAttribute("itemprop"))break;return c;case"link":if(P=c.getAttribute("rel"),P==="stylesheet"&&c.hasAttribute("data-precedence"))break;if(P!==N.rel||c.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||c.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||c.getAttribute("title")!==(N.title==null?null:N.title))break;return c;case"style":if(c.hasAttribute("data-precedence"))break;return c;case"script":if(P=c.getAttribute("src"),(P!==(N.src==null?null:N.src)||c.getAttribute("type")!==(N.type==null?null:N.type)||c.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&P&&c.hasAttribute("async")&&!c.hasAttribute("itemprop"))break;return c;default:return c}}else if(f==="input"&&c.type==="hidden"){var P=N.name==null?null:""+N.name;if(N.type==="hidden"&&c.getAttribute("name")===P)return c}else return c;if(c=Ls(c.nextSibling),c===null)break}return null}function g7(c,f,g){if(f==="")return null;for(;c.nodeType!==3;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!g||(c=Ls(c.nextSibling),c===null))return null;return c}function D_(c){return c.data==="$!"||c.data==="$?"&&c.ownerDocument.readyState==="complete"}function y7(c,f){var g=c.ownerDocument;if(c.data!=="$?"||g.readyState==="complete")f();else{var _=function(){f(),g.removeEventListener("DOMContentLoaded",_)};g.addEventListener("DOMContentLoaded",_),c._reactRetry=_}}function Ls(c){for(;c!=null;c=c.nextSibling){var f=c.nodeType;if(f===1||f===3)break;if(f===8){if(f=c.data,f==="$"||f==="$!"||f==="$?"||f==="F!"||f==="F")break;if(f==="/$")return null}}return c}var M_=null;function DR(c){c=c.previousSibling;for(var f=0;c;){if(c.nodeType===8){var g=c.data;if(g==="$"||g==="$!"||g==="$?"){if(f===0)return c;f--}else g==="/$"&&f++}c=c.previousSibling}return null}function MR(c,f,g){switch(f=Qy(g),c){case"html":if(c=f.documentElement,!c)throw Error(r(452));return c;case"head":if(c=f.head,!c)throw Error(r(453));return c;case"body":if(c=f.body,!c)throw Error(r(454));return c;default:throw Error(r(451))}}function _m(c){for(var f=c.attributes;f.length;)c.removeAttributeNode(f[0]);Jt(c)}var ms=new Map,PR=new Set;function eb(c){return typeof c.getRootNode=="function"?c.getRootNode():c.nodeType===9?c:c.ownerDocument}var Cl=Y.d;Y.d={f:b7,r:v7,D:w7,C:x7,L:_7,m:S7,X:C7,S:E7,M:k7};function b7(){var c=Cl.f(),f=Vy();return c||f}function v7(c){var f=Hn(c);f!==null&&f.tag===5&&f.type==="form"?nN(f):Cl.r(c)}var Yf=typeof document>"u"?null:document;function FR(c,f,g){var _=Yf;if(_&&typeof f=="string"&&f){var N=Ja(f);N='link[rel="'+c+'"][href="'+N+'"]',typeof g=="string"&&(N+='[crossorigin="'+g+'"]'),PR.has(N)||(PR.add(N),c={rel:c,crossOrigin:g,href:f},_.querySelector(N)===null&&(f=_.createElement("link"),Wa(f,"link",c),Mn(f),_.head.appendChild(f)))}}function w7(c){Cl.D(c),FR("dns-prefetch",c,null)}function x7(c,f){Cl.C(c,f),FR("preconnect",c,f)}function _7(c,f,g){Cl.L(c,f,g);var _=Yf;if(_&&c&&f){var N='link[rel="preload"][as="'+Ja(f)+'"]';f==="image"&&g&&g.imageSrcSet?(N+='[imagesrcset="'+Ja(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(N+='[imagesizes="'+Ja(g.imageSizes)+'"]')):N+='[href="'+Ja(c)+'"]';var P=N;switch(f){case"style":P=Xf(c);break;case"script":P=Jf(c)}ms.has(P)||(c=d({rel:"preload",href:f==="image"&&g&&g.imageSrcSet?void 0:c,as:f},g),ms.set(P,c),_.querySelector(N)!==null||f==="style"&&_.querySelector(Sm(P))||f==="script"&&_.querySelector(Em(P))||(f=_.createElement("link"),Wa(f,"link",c),Mn(f),_.head.appendChild(f)))}}function S7(c,f){Cl.m(c,f);var g=Yf;if(g&&c){var _=f&&typeof f.as=="string"?f.as:"script",N='link[rel="modulepreload"][as="'+Ja(_)+'"][href="'+Ja(c)+'"]',P=N;switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=Jf(c)}if(!ms.has(P)&&(c=d({rel:"modulepreload",href:c},f),ms.set(P,c),g.querySelector(N)===null)){switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Em(P)))return}_=g.createElement("link"),Wa(_,"link",c),Mn(_),g.head.appendChild(_)}}}function E7(c,f,g){Cl.S(c,f,g);var _=Yf;if(_&&c){var N=xr(_).hoistableStyles,P=Xf(c);f=f||"default";var se=N.get(P);if(!se){var Se={loading:0,preload:null};if(se=_.querySelector(Sm(P)))Se.loading=5;else{c=d({rel:"stylesheet",href:c,"data-precedence":f},g),(g=ms.get(P))&&P_(c,g);var ze=se=_.createElement("link");Mn(ze),Wa(ze,"link",c),ze._p=new Promise(function(dt,Ct){ze.onload=dt,ze.onerror=Ct}),ze.addEventListener("load",function(){Se.loading|=1}),ze.addEventListener("error",function(){Se.loading|=2}),Se.loading|=4,tb(se,f,_)}se={type:"stylesheet",instance:se,count:1,state:Se},N.set(P,se)}}}function C7(c,f){Cl.X(c,f);var g=Yf;if(g&&c){var _=xr(g).hoistableScripts,N=Jf(c),P=_.get(N);P||(P=g.querySelector(Em(N)),P||(c=d({src:c,async:!0},f),(f=ms.get(N))&&F_(c,f),P=g.createElement("script"),Mn(P),Wa(P,"link",c),g.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},_.set(N,P))}}function k7(c,f){Cl.M(c,f);var g=Yf;if(g&&c){var _=xr(g).hoistableScripts,N=Jf(c),P=_.get(N);P||(P=g.querySelector(Em(N)),P||(c=d({src:c,async:!0,type:"module"},f),(f=ms.get(N))&&F_(c,f),P=g.createElement("script"),Mn(P),Wa(P,"link",c),g.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},_.set(N,P))}}function LR(c,f,g,_){var N=(N=Pe.current)?eb(N):null;if(!N)throw Error(r(446));switch(c){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(f=Xf(g.href),g=xr(N).hoistableStyles,_=g.get(f),_||(_={type:"style",instance:null,count:0,state:null},g.set(f,_)),_):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){c=Xf(g.href);var P=xr(N).hoistableStyles,se=P.get(c);if(se||(N=N.ownerDocument||N,se={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(c,se),(P=N.querySelector(Sm(c)))&&!P._p&&(se.instance=P,se.state.loading=5),ms.has(c)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},ms.set(c,g),P||T7(N,c,g,se.state))),f&&_===null)throw Error(r(528,""));return se}if(f&&_!==null)throw Error(r(529,""));return null;case"script":return f=g.async,g=g.src,typeof g=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=Jf(g),g=xr(N).hoistableScripts,_=g.get(f),_||(_={type:"script",instance:null,count:0,state:null},g.set(f,_)),_):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,c))}}function Xf(c){return'href="'+Ja(c)+'"'}function Sm(c){return'link[rel="stylesheet"]['+c+"]"}function $R(c){return d({},c,{"data-precedence":c.precedence,precedence:null})}function T7(c,f,g,_){c.querySelector('link[rel="preload"][as="style"]['+f+"]")?_.loading=1:(f=c.createElement("link"),_.preload=f,f.addEventListener("load",function(){return _.loading|=1}),f.addEventListener("error",function(){return _.loading|=2}),Wa(f,"link",g),Mn(f),c.head.appendChild(f))}function Jf(c){return'[src="'+Ja(c)+'"]'}function Em(c){return"script[async]"+c}function BR(c,f,g){if(f.count++,f.instance===null)switch(f.type){case"style":var _=c.querySelector('style[data-href~="'+Ja(g.href)+'"]');if(_)return f.instance=_,Mn(_),_;var N=d({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return _=(c.ownerDocument||c).createElement("style"),Mn(_),Wa(_,"style",N),tb(_,g.precedence,c),f.instance=_;case"stylesheet":N=Xf(g.href);var P=c.querySelector(Sm(N));if(P)return f.state.loading|=4,f.instance=P,Mn(P),P;_=$R(g),(N=ms.get(N))&&P_(_,N),P=(c.ownerDocument||c).createElement("link"),Mn(P);var se=P;return se._p=new Promise(function(Se,ze){se.onload=Se,se.onerror=ze}),Wa(P,"link",_),f.state.loading|=4,tb(P,g.precedence,c),f.instance=P;case"script":return P=Jf(g.src),(N=c.querySelector(Em(P)))?(f.instance=N,Mn(N),N):(_=g,(N=ms.get(P))&&(_=d({},g),F_(_,N)),c=c.ownerDocument||c,N=c.createElement("script"),Mn(N),Wa(N,"link",_),c.head.appendChild(N),f.instance=N);case"void":return null;default:throw Error(r(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(_=f.instance,f.state.loading|=4,tb(_,g.precedence,c));return f.instance}function tb(c,f,g){for(var _=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=_.length?_[_.length-1]:null,P=N,se=0;se<_.length;se++){var Se=_[se];if(Se.dataset.precedence===f)P=Se;else if(P!==N)break}P?P.parentNode.insertBefore(c,P.nextSibling):(f=g.nodeType===9?g.head:g,f.insertBefore(c,f.firstChild))}function P_(c,f){c.crossOrigin==null&&(c.crossOrigin=f.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=f.referrerPolicy),c.title==null&&(c.title=f.title)}function F_(c,f){c.crossOrigin==null&&(c.crossOrigin=f.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=f.referrerPolicy),c.integrity==null&&(c.integrity=f.integrity)}var nb=null;function zR(c,f,g){if(nb===null){var _=new Map,N=nb=new Map;N.set(g,_)}else N=nb,_=N.get(g),_||(_=new Map,N.set(g,_));if(_.has(c))return _;for(_.set(c,null),g=g.getElementsByTagName(c),N=0;N<g.length;N++){var P=g[N];if(!(P[Pt]||P[he]||c==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var se=P.getAttribute(f)||"";se=c+se;var Se=_.get(se);Se?Se.push(P):_.set(se,[P])}}return _}function UR(c,f,g){c=c.ownerDocument||c,c.head.insertBefore(g,f==="title"?c.querySelector("head > title"):null)}function A7(c,f,g){if(g===1||f.itemProp!=null)return!1;switch(c){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return c=f.disabled,typeof f.precedence=="string"&&c==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function qR(c){return!(c.type==="stylesheet"&&(c.state.loading&3)===0)}var Cm=null;function N7(){}function R7(c,f,g){if(Cm===null)throw Error(r(475));var _=Cm;if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var N=Xf(g.href),P=c.querySelector(Sm(N));if(P){c=P._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(_.count++,_=rb.bind(_),c.then(_,_)),f.state.loading|=4,f.instance=P,Mn(P);return}P=c.ownerDocument||c,g=$R(g),(N=ms.get(N))&&P_(g,N),P=P.createElement("link"),Mn(P);var se=P;se._p=new Promise(function(Se,ze){se.onload=Se,se.onerror=ze}),Wa(P,"link",g),f.instance=P}_.stylesheets===null&&(_.stylesheets=new Map),_.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(_.count++,f=rb.bind(_),c.addEventListener("load",f),c.addEventListener("error",f))}}function I7(){if(Cm===null)throw Error(r(475));var c=Cm;return c.stylesheets&&c.count===0&&L_(c,c.stylesheets),0<c.count?function(f){var g=setTimeout(function(){if(c.stylesheets&&L_(c,c.stylesheets),c.unsuspend){var _=c.unsuspend;c.unsuspend=null,_()}},6e4);return c.unsuspend=f,function(){c.unsuspend=null,clearTimeout(g)}}:null}function rb(){if(this.count--,this.count===0){if(this.stylesheets)L_(this,this.stylesheets);else if(this.unsuspend){var c=this.unsuspend;this.unsuspend=null,c()}}}var ab=null;function L_(c,f){c.stylesheets=null,c.unsuspend!==null&&(c.count++,ab=new Map,f.forEach(j7,c),ab=null,rb.call(c))}function j7(c,f){if(!(f.state.loading&4)){var g=ab.get(c);if(g)var _=g.get(null);else{g=new Map,ab.set(c,g);for(var N=c.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<N.length;P++){var se=N[P];(se.nodeName==="LINK"||se.getAttribute("media")!=="not all")&&(g.set(se.dataset.precedence,se),_=se)}_&&g.set(null,_)}N=f.instance,se=N.getAttribute("data-precedence"),P=g.get(se)||_,P===_&&g.set(null,N),g.set(se,N),this.count++,_=rb.bind(this),N.addEventListener("load",_),N.addEventListener("error",_),P?P.parentNode.insertBefore(N,P.nextSibling):(c=c.nodeType===9?c.head:c,c.insertBefore(N,c.firstChild)),f.state.loading|=4}}var km={$$typeof:E,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function O7(c,f,g,_,N,P,se,Se){this.tag=1,this.containerInfo=c,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Be(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Be(0),this.hiddenUpdates=Be(null),this.identifierPrefix=_,this.onUncaughtError=N,this.onCaughtError=P,this.onRecoverableError=se,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Se,this.incompleteTransitions=new Map}function HR(c,f,g,_,N,P,se,Se,ze,dt,Ct,It){return c=new O7(c,f,g,se,Se,ze,dt,It),f=1,P===!0&&(f|=24),P=qi(3,null,null,f),c.current=P,P.stateNode=c,f=v1(),f.refCount++,c.pooledCache=f,f.refCount++,P.memoizedState={element:_,isDehydrated:g,cache:f},S1(P),c}function VR(c){return c?(c=_o,c):_o}function GR(c,f,g,_,N,P){N=VR(N),_.context===null?_.context=N:_.pendingContext=N,_=wc(f),_.payload={element:g},P=P===void 0?null:P,P!==null&&(_.callback=P),g=xc(c,_,f),g!==null&&(Ki(g,c,f),nm(g,c,f))}function WR(c,f){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var g=c.retryLane;c.retryLane=g!==0&&g<f?g:f}}function $_(c,f){WR(c,f),(c=c.alternate)&&WR(c,f)}function KR(c){if(c.tag===13){var f=Ps(c,67108864);f!==null&&Ki(f,c,67108864),$_(c,67108864)}}var ib=!0;function D7(c,f,g,_){var N=re.T;re.T=null;var P=Y.p;try{Y.p=2,B_(c,f,g,_)}finally{Y.p=P,re.T=N}}function M7(c,f,g,_){var N=re.T;re.T=null;var P=Y.p;try{Y.p=8,B_(c,f,g,_)}finally{Y.p=P,re.T=N}}function B_(c,f,g,_){if(ib){var N=z_(_);if(N===null)T_(c,f,_,sb,g),YR(c,_);else if(F7(N,c,f,g,_))_.stopPropagation();else if(YR(c,_),f&4&&-1<P7.indexOf(c)){for(;N!==null;){var P=Hn(N);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var se=ve(P.pendingLanes);if(se!==0){var Se=P;for(Se.pendingLanes|=2,Se.entangledLanes|=2;se;){var ze=1<<31-Wt(se);Se.entanglements[1]|=ze,se&=~ze}To(P),(mr&6)===0&&(qy=le()+500,vm(0))}}break;case 13:Se=Ps(P,2),Se!==null&&Ki(Se,P,2),Vy(),$_(P,2)}if(P=z_(_),P===null&&T_(c,f,_,sb,g),P===N)break;N=P}N!==null&&_.stopPropagation()}else T_(c,f,_,null,g)}}function z_(c){return c=ff(c),U_(c)}var sb=null;function U_(c){if(sb=null,c=An(c),c!==null){var f=i(c);if(f===null)c=null;else{var g=f.tag;if(g===13){if(c=s(f),c!==null)return c;c=null}else if(g===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;c=null}else f!==c&&(c=null)}}return sb=c,null}function ZR(c){switch(c){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ie()){case te:return 2;case _e:return 8;case Me:case Ee:return 32;case We:return 268435456;default:return 32}default:return 32}}var q_=!1,Dc=null,Mc=null,Pc=null,Tm=new Map,Am=new Map,Fc=[],P7="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function YR(c,f){switch(c){case"focusin":case"focusout":Dc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Pc=null;break;case"pointerover":case"pointerout":Tm.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":Am.delete(f.pointerId)}}function Nm(c,f,g,_,N,P){return c===null||c.nativeEvent!==P?(c={blockedOn:f,domEventName:g,eventSystemFlags:_,nativeEvent:P,targetContainers:[N]},f!==null&&(f=Hn(f),f!==null&&KR(f)),c):(c.eventSystemFlags|=_,f=c.targetContainers,N!==null&&f.indexOf(N)===-1&&f.push(N),c)}function F7(c,f,g,_,N){switch(f){case"focusin":return Dc=Nm(Dc,c,f,g,_,N),!0;case"dragenter":return Mc=Nm(Mc,c,f,g,_,N),!0;case"mouseover":return Pc=Nm(Pc,c,f,g,_,N),!0;case"pointerover":var P=N.pointerId;return Tm.set(P,Nm(Tm.get(P)||null,c,f,g,_,N)),!0;case"gotpointercapture":return P=N.pointerId,Am.set(P,Nm(Am.get(P)||null,c,f,g,_,N)),!0}return!1}function XR(c){var f=An(c.target);if(f!==null){var g=i(f);if(g!==null){if(f=g.tag,f===13){if(f=s(g),f!==null){c.blockedOn=f,U(c.priority,function(){if(g.tag===13){var _=Wi();_=Rt(_);var N=Ps(g,_);N!==null&&Ki(N,g,_),$_(g,_)}});return}}else if(f===3&&g.stateNode.current.memoizedState.isDehydrated){c.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}c.blockedOn=null}function ob(c){if(c.blockedOn!==null)return!1;for(var f=c.targetContainers;0<f.length;){var g=z_(c.nativeEvent);if(g===null){g=c.nativeEvent;var _=new g.constructor(g.type,g);os=_,g.target.dispatchEvent(_),os=null}else return f=Hn(g),f!==null&&KR(f),c.blockedOn=g,!1;f.shift()}return!0}function JR(c,f,g){ob(c)&&g.delete(f)}function L7(){q_=!1,Dc!==null&&ob(Dc)&&(Dc=null),Mc!==null&&ob(Mc)&&(Mc=null),Pc!==null&&ob(Pc)&&(Pc=null),Tm.forEach(JR),Am.forEach(JR)}function lb(c,f){c.blockedOn===f&&(c.blockedOn=null,q_||(q_=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,L7)))}var cb=null;function QR(c){cb!==c&&(cb=c,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){cb===c&&(cb=null);for(var f=0;f<c.length;f+=3){var g=c[f],_=c[f+1],N=c[f+2];if(typeof _!="function"){if(U_(_||g)===null)continue;break}var P=Hn(g);P!==null&&(c.splice(f,3),f-=3,U1(P,{pending:!0,data:N,method:g.method,action:_},_,N))}}))}function Rm(c){function f(ze){return lb(ze,c)}Dc!==null&&lb(Dc,c),Mc!==null&&lb(Mc,c),Pc!==null&&lb(Pc,c),Tm.forEach(f),Am.forEach(f);for(var g=0;g<Fc.length;g++){var _=Fc[g];_.blockedOn===c&&(_.blockedOn=null)}for(;0<Fc.length&&(g=Fc[0],g.blockedOn===null);)XR(g),g.blockedOn===null&&Fc.shift();if(g=(c.ownerDocument||c).$$reactFormReplay,g!=null)for(_=0;_<g.length;_+=3){var N=g[_],P=g[_+1],se=N[Ae]||null;if(typeof P=="function")se||QR(g);else if(se){var Se=null;if(P&&P.hasAttribute("formAction")){if(N=P,se=P[Ae]||null)Se=se.formAction;else if(U_(N)!==null)continue}else Se=se.action;typeof Se=="function"?g[_+1]=Se:(g.splice(_,3),_-=3),QR(g)}}}function H_(c){this._internalRoot=c}ub.prototype.render=H_.prototype.render=function(c){var f=this._internalRoot;if(f===null)throw Error(r(409));var g=f.current,_=Wi();GR(g,_,c,f,null,null)},ub.prototype.unmount=H_.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var f=c.containerInfo;GR(c.current,2,null,c,null,null),Vy(),f[qe]=null}};function ub(c){this._internalRoot=c}ub.prototype.unstable_scheduleHydration=function(c){if(c){var f=H();c={blockedOn:null,target:c,priority:f};for(var g=0;g<Fc.length&&f!==0&&f<Fc[g].priority;g++);Fc.splice(g,0,c),g===0&&XR(c)}};var eI=t.version;if(eI!=="19.1.0")throw Error(r(527,eI,"19.1.0"));Y.findDOMNode=function(c){var f=c._reactInternals;if(f===void 0)throw typeof c.render=="function"?Error(r(188)):(c=Object.keys(c).join(","),Error(r(268,c)));return c=l(f),c=c!==null?u(c):null,c=c===null?null:c.stateNode,c};var $7={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:re,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var db=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!db.isDisabled&&db.supportsFiber)try{xt=db.inject($7),Dt=db}catch{}}return jm.createRoot=function(c,f){if(!a(c))throw Error(r(299));var g=!1,_="",N=gN,P=yN,se=bN,Se=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onUncaughtError!==void 0&&(N=f.onUncaughtError),f.onCaughtError!==void 0&&(P=f.onCaughtError),f.onRecoverableError!==void 0&&(se=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(Se=f.unstable_transitionCallbacks)),f=HR(c,1,!1,null,null,g,_,N,P,se,Se,null),c[qe]=f.current,k_(c),new H_(f)},jm.hydrateRoot=function(c,f,g){if(!a(c))throw Error(r(299));var _=!1,N="",P=gN,se=yN,Se=bN,ze=null,dt=null;return g!=null&&(g.unstable_strictMode===!0&&(_=!0),g.identifierPrefix!==void 0&&(N=g.identifierPrefix),g.onUncaughtError!==void 0&&(P=g.onUncaughtError),g.onCaughtError!==void 0&&(se=g.onCaughtError),g.onRecoverableError!==void 0&&(Se=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(ze=g.unstable_transitionCallbacks),g.formState!==void 0&&(dt=g.formState)),f=HR(c,1,!0,f,g??null,_,N,P,se,Se,ze,dt),f.context=VR(null),g=f.current,_=Wi(),_=Rt(_),N=wc(_),N.callback=null,xc(g,N,_),g=_,f.current.lanes=g,nt(f,g),To(f),c[qe]=f.current,k_(c),new ub(f)},jm.version="19.1.0",jm}var uI;function tU(){if(uI)return W_.exports;uI=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),W_.exports=eU(),W_.exports}var nU=tU();const rU=di(nU);function dI(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Qc(...e){return t=>{let n=!1;const r=e.map(a=>{const i=dI(a,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let a=0;a<r.length;a++){const i=r[a];typeof i=="function"?i():dI(e[a],null)}}}}function Cn(...e){return T.useCallback(Qc(...e),e)}function eu(e){const t=aU(e),n=T.forwardRef((r,a)=>{const{children:i,...s}=r,o=T.Children.toArray(i),l=o.find(sU);if(l){const u=l.props.children,d=o.map(h=>h===l?T.Children.count(u)>1?T.Children.only(null):T.isValidElement(u)?u.props.children:null:h);return m.jsx(t,{...s,ref:a,children:T.isValidElement(u)?T.cloneElement(u,void 0,d):null})}return m.jsx(t,{...s,ref:a,children:i})});return n.displayName=`${e}.Slot`,n}var s6=eu("Slot");function aU(e){const t=T.forwardRef((n,r)=>{const{children:a,...i}=n;if(T.isValidElement(a)){const s=lU(a),o=oU(i,a.props);return a.type!==T.Fragment&&(o.ref=r?Qc(r,s):s),T.cloneElement(a,o)}return T.Children.count(a)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var o6=Symbol("radix.slottable");function iU(e){const t=({children:n})=>m.jsx(m.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=o6,t}function sU(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===o6}function oU(e,t){const n={...t};for(const r in t){const a=e[r],i=t[r];/^on[A-Z]/.test(r)?a&&i?n[r]=(...o)=>{i(...o),a(...o)}:a&&(n[r]=a):r==="style"?n[r]={...a,...i}:r==="className"&&(n[r]=[a,i].filter(Boolean).join(" "))}return{...e,...n}}function lU(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function l6(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=l6(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function c6(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=l6(e))&&(r&&(r+=" "),r+=t);return r}const fI=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,hI=c6,LC=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return hI(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:i}=t,s=Object.keys(a).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const p=fI(d)||fI(h);return a[u][p]}),o=n&&Object.entries(n).reduce((u,d)=>{let[h,p]=d;return p===void 0||(u[h]=p),u},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:p,...y}=d;return Object.entries(y).every(v=>{let[b,w]=v;return Array.isArray(w)?w.includes({...i,...o}[b]):{...i,...o}[b]===w})?[...u,h,p]:u},[]);return hI(e,s,l,n==null?void 0:n.class,n==null?void 0:n.className)},$C="-",cU=e=>{const t=dU(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:s=>{const o=s.split($C);return o[0]===""&&o.length!==1&&o.shift(),u6(o,t)||uU(s)},getConflictingClassGroupIds:(s,o)=>{const l=n[s]||[];return o&&r[s]?[...l,...r[s]]:l}}},u6=(e,t)=>{var s;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),a=r?u6(e.slice(1),r):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join($C);return(s=t.validators.find(({validator:o})=>o(i)))==null?void 0:s.classGroupId},pI=/^\[(.+)\]$/,uU=e=>{if(pI.test(e)){const t=pI.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},dU=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const a in n)f2(n[a],r,a,t);return r},f2=(e,t,n,r)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:mI(t,a);i.classGroupId=n;return}if(typeof a=="function"){if(fU(a)){f2(a(r),t,n,r);return}t.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([i,s])=>{f2(s,mI(t,i),n,r)})})},mI=(e,t)=>{let n=e;return t.split($C).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},fU=e=>e.isThemeGetter,hU=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const a=(i,s)=>{n.set(i,s),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let s=n.get(i);if(s!==void 0)return s;if((s=r.get(i))!==void 0)return a(i,s),s},set(i,s){n.has(i)?n.set(i,s):a(i,s)}}},h2="!",p2=":",pU=p2.length,mU=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=a=>{const i=[];let s=0,o=0,l=0,u;for(let v=0;v<a.length;v++){let b=a[v];if(s===0&&o===0){if(b===p2){i.push(a.slice(l,v)),l=v+pU;continue}if(b==="/"){u=v;continue}}b==="["?s++:b==="]"?s--:b==="("?o++:b===")"&&o--}const d=i.length===0?a:a.substring(l),h=gU(d),p=h!==d,y=u&&u>l?u-l:void 0;return{modifiers:i,hasImportantModifier:p,baseClassName:h,maybePostfixModifierPosition:y}};if(t){const a=t+p2,i=r;r=s=>s.startsWith(a)?i(s.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:s,maybePostfixModifierPosition:void 0}}if(n){const a=r;r=i=>n({className:i,parseClassName:a})}return r},gU=e=>e.endsWith(h2)?e.substring(0,e.length-1):e.startsWith(h2)?e.substring(1):e,yU=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const a=[];let i=[];return r.forEach(s=>{s[0]==="["||t[s]?(a.push(...i.sort(),s),i=[]):i.push(s)}),a.push(...i.sort()),a}},bU=e=>({cache:hU(e.cacheSize),parseClassName:mU(e),sortModifiers:yU(e),...cU(e)}),vU=/\s+/,wU=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a,sortModifiers:i}=t,s=[],o=e.trim().split(vU);let l="";for(let u=o.length-1;u>=0;u-=1){const d=o[u],{isExternal:h,modifiers:p,hasImportantModifier:y,baseClassName:v,maybePostfixModifierPosition:b}=n(d);if(h){l=d+(l.length>0?" "+l:l);continue}let w=!!b,x=r(w?v.substring(0,b):v);if(!x){if(!w){l=d+(l.length>0?" "+l:l);continue}if(x=r(v),!x){l=d+(l.length>0?" "+l:l);continue}w=!1}const S=i(p).join(":"),E=y?S+h2:S,C=E+x;if(s.includes(C))continue;s.push(C);const k=a(x,w);for(let R=0;R<k.length;++R){const O=k[R];s.push(E+O)}l=d+(l.length>0?" "+l:l)}return l};function xU(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=d6(t))&&(r&&(r+=" "),r+=n);return r}const d6=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=d6(e[r]))&&(n&&(n+=" "),n+=t);return n};function _U(e,...t){let n,r,a,i=s;function s(l){const u=t.reduce((d,h)=>h(d),e());return n=bU(u),r=n.cache.get,a=n.cache.set,i=o,o(l)}function o(l){const u=r(l);if(u)return u;const d=wU(l,n);return a(l,d),d}return function(){return i(xU.apply(null,arguments))}}const va=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},f6=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,h6=/^\((?:(\w[\w-]*):)?(.+)\)$/i,SU=/^\d+\/\d+$/,EU=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,CU=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,kU=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,TU=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,AU=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Qf=e=>SU.test(e),Bn=e=>!!e&&!Number.isNaN(Number(e)),$c=e=>!!e&&Number.isInteger(Number(e)),X_=e=>e.endsWith("%")&&Bn(e.slice(0,-1)),kl=e=>EU.test(e),NU=()=>!0,RU=e=>CU.test(e)&&!kU.test(e),p6=()=>!1,IU=e=>TU.test(e),jU=e=>AU.test(e),OU=e=>!on(e)&&!ln(e),DU=e=>Xh(e,y6,p6),on=e=>f6.test(e),ld=e=>Xh(e,b6,RU),J_=e=>Xh(e,$U,Bn),gI=e=>Xh(e,m6,p6),MU=e=>Xh(e,g6,jU),fb=e=>Xh(e,v6,IU),ln=e=>h6.test(e),Om=e=>Jh(e,b6),PU=e=>Jh(e,BU),yI=e=>Jh(e,m6),FU=e=>Jh(e,y6),LU=e=>Jh(e,g6),hb=e=>Jh(e,v6,!0),Xh=(e,t,n)=>{const r=f6.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},Jh=(e,t,n=!1)=>{const r=h6.exec(e);return r?r[1]?t(r[1]):n:!1},m6=e=>e==="position"||e==="percentage",g6=e=>e==="image"||e==="url",y6=e=>e==="length"||e==="size"||e==="bg-size",b6=e=>e==="length",$U=e=>e==="number",BU=e=>e==="family-name",v6=e=>e==="shadow",zU=()=>{const e=va("color"),t=va("font"),n=va("text"),r=va("font-weight"),a=va("tracking"),i=va("leading"),s=va("breakpoint"),o=va("container"),l=va("spacing"),u=va("radius"),d=va("shadow"),h=va("inset-shadow"),p=va("text-shadow"),y=va("drop-shadow"),v=va("blur"),b=va("perspective"),w=va("aspect"),x=va("ease"),S=va("animate"),E=()=>["auto","avoid","all","avoid-page","page","left","right","column"],C=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[...C(),ln,on],R=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto","contain","none"],j=()=>[ln,on,l],$=()=>[Qf,"full","auto",...j()],L=()=>[$c,"none","subgrid",ln,on],X=()=>["auto",{span:["full",$c,ln,on]},$c,ln,on],F=()=>[$c,"auto",ln,on],K=()=>["auto","min","max","fr",ln,on],q=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],de=()=>["start","end","center","stretch","center-safe","end-safe"],re=()=>["auto",...j()],Y=()=>[Qf,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...j()],Q=()=>[e,ln,on],ae=()=>[...C(),yI,gI,{position:[ln,on]}],B=()=>["no-repeat",{repeat:["","x","y","space","round"]}],J=()=>["auto","cover","contain",FU,DU,{size:[ln,on]}],ee=()=>[X_,Om,ld],oe=()=>["","none","full",u,ln,on],me=()=>["",Bn,Om,ld],xe=()=>["solid","dashed","dotted","double"],Pe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ne=()=>[Bn,X_,yI,gI],Re=()=>["","none",v,ln,on],ke=()=>["none",Bn,ln,on],Fe=()=>["none",Bn,ln,on],Qe=()=>[Bn,ln,on],Le=()=>[Qf,"full",...j()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[kl],breakpoint:[kl],color:[NU],container:[kl],"drop-shadow":[kl],ease:["in","out","in-out"],font:[OU],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[kl],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[kl],shadow:[kl],spacing:["px",Bn],text:[kl],"text-shadow":[kl],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Qf,on,ln,w]}],container:["container"],columns:[{columns:[Bn,on,ln,o]}],"break-after":[{"break-after":E()}],"break-before":[{"break-before":E()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:$()}],"inset-x":[{"inset-x":$()}],"inset-y":[{"inset-y":$()}],start:[{start:$()}],end:[{end:$()}],top:[{top:$()}],right:[{right:$()}],bottom:[{bottom:$()}],left:[{left:$()}],visibility:["visible","invisible","collapse"],z:[{z:[$c,"auto",ln,on]}],basis:[{basis:[Qf,"full","auto",o,...j()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Bn,Qf,"auto","initial","none",on]}],grow:[{grow:["",Bn,ln,on]}],shrink:[{shrink:["",Bn,ln,on]}],order:[{order:[$c,"first","last","none",ln,on]}],"grid-cols":[{"grid-cols":L()}],"col-start-end":[{col:X()}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":L()}],"row-start-end":[{row:X()}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":K()}],"auto-rows":[{"auto-rows":K()}],gap:[{gap:j()}],"gap-x":[{"gap-x":j()}],"gap-y":[{"gap-y":j()}],"justify-content":[{justify:[...q(),"normal"]}],"justify-items":[{"justify-items":[...de(),"normal"]}],"justify-self":[{"justify-self":["auto",...de()]}],"align-content":[{content:["normal",...q()]}],"align-items":[{items:[...de(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...de(),{baseline:["","last"]}]}],"place-content":[{"place-content":q()}],"place-items":[{"place-items":[...de(),"baseline"]}],"place-self":[{"place-self":["auto",...de()]}],p:[{p:j()}],px:[{px:j()}],py:[{py:j()}],ps:[{ps:j()}],pe:[{pe:j()}],pt:[{pt:j()}],pr:[{pr:j()}],pb:[{pb:j()}],pl:[{pl:j()}],m:[{m:re()}],mx:[{mx:re()}],my:[{my:re()}],ms:[{ms:re()}],me:[{me:re()}],mt:[{mt:re()}],mr:[{mr:re()}],mb:[{mb:re()}],ml:[{ml:re()}],"space-x":[{"space-x":j()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":j()}],"space-y-reverse":["space-y-reverse"],size:[{size:Y()}],w:[{w:[o,"screen",...Y()]}],"min-w":[{"min-w":[o,"screen","none",...Y()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[s]},...Y()]}],h:[{h:["screen",...Y()]}],"min-h":[{"min-h":["screen","none",...Y()]}],"max-h":[{"max-h":["screen",...Y()]}],"font-size":[{text:["base",n,Om,ld]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,ln,J_]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",X_,on]}],"font-family":[{font:[PU,on,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,ln,on]}],"line-clamp":[{"line-clamp":[Bn,"none",ln,J_]}],leading:[{leading:[i,...j()]}],"list-image":[{"list-image":["none",ln,on]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",ln,on]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Q()}],"text-color":[{text:Q()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...xe(),"wavy"]}],"text-decoration-thickness":[{decoration:[Bn,"from-font","auto",ln,ld]}],"text-decoration-color":[{decoration:Q()}],"underline-offset":[{"underline-offset":[Bn,"auto",ln,on]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ln,on]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ln,on]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ae()}],"bg-repeat":[{bg:B()}],"bg-size":[{bg:J()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},$c,ln,on],radial:["",ln,on],conic:[$c,ln,on]},LU,MU]}],"bg-color":[{bg:Q()}],"gradient-from-pos":[{from:ee()}],"gradient-via-pos":[{via:ee()}],"gradient-to-pos":[{to:ee()}],"gradient-from":[{from:Q()}],"gradient-via":[{via:Q()}],"gradient-to":[{to:Q()}],rounded:[{rounded:oe()}],"rounded-s":[{"rounded-s":oe()}],"rounded-e":[{"rounded-e":oe()}],"rounded-t":[{"rounded-t":oe()}],"rounded-r":[{"rounded-r":oe()}],"rounded-b":[{"rounded-b":oe()}],"rounded-l":[{"rounded-l":oe()}],"rounded-ss":[{"rounded-ss":oe()}],"rounded-se":[{"rounded-se":oe()}],"rounded-ee":[{"rounded-ee":oe()}],"rounded-es":[{"rounded-es":oe()}],"rounded-tl":[{"rounded-tl":oe()}],"rounded-tr":[{"rounded-tr":oe()}],"rounded-br":[{"rounded-br":oe()}],"rounded-bl":[{"rounded-bl":oe()}],"border-w":[{border:me()}],"border-w-x":[{"border-x":me()}],"border-w-y":[{"border-y":me()}],"border-w-s":[{"border-s":me()}],"border-w-e":[{"border-e":me()}],"border-w-t":[{"border-t":me()}],"border-w-r":[{"border-r":me()}],"border-w-b":[{"border-b":me()}],"border-w-l":[{"border-l":me()}],"divide-x":[{"divide-x":me()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":me()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...xe(),"hidden","none"]}],"divide-style":[{divide:[...xe(),"hidden","none"]}],"border-color":[{border:Q()}],"border-color-x":[{"border-x":Q()}],"border-color-y":[{"border-y":Q()}],"border-color-s":[{"border-s":Q()}],"border-color-e":[{"border-e":Q()}],"border-color-t":[{"border-t":Q()}],"border-color-r":[{"border-r":Q()}],"border-color-b":[{"border-b":Q()}],"border-color-l":[{"border-l":Q()}],"divide-color":[{divide:Q()}],"outline-style":[{outline:[...xe(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Bn,ln,on]}],"outline-w":[{outline:["",Bn,Om,ld]}],"outline-color":[{outline:Q()}],shadow:[{shadow:["","none",d,hb,fb]}],"shadow-color":[{shadow:Q()}],"inset-shadow":[{"inset-shadow":["none",h,hb,fb]}],"inset-shadow-color":[{"inset-shadow":Q()}],"ring-w":[{ring:me()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Q()}],"ring-offset-w":[{"ring-offset":[Bn,ld]}],"ring-offset-color":[{"ring-offset":Q()}],"inset-ring-w":[{"inset-ring":me()}],"inset-ring-color":[{"inset-ring":Q()}],"text-shadow":[{"text-shadow":["none",p,hb,fb]}],"text-shadow-color":[{"text-shadow":Q()}],opacity:[{opacity:[Bn,ln,on]}],"mix-blend":[{"mix-blend":[...Pe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Pe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Bn]}],"mask-image-linear-from-pos":[{"mask-linear-from":Ne()}],"mask-image-linear-to-pos":[{"mask-linear-to":Ne()}],"mask-image-linear-from-color":[{"mask-linear-from":Q()}],"mask-image-linear-to-color":[{"mask-linear-to":Q()}],"mask-image-t-from-pos":[{"mask-t-from":Ne()}],"mask-image-t-to-pos":[{"mask-t-to":Ne()}],"mask-image-t-from-color":[{"mask-t-from":Q()}],"mask-image-t-to-color":[{"mask-t-to":Q()}],"mask-image-r-from-pos":[{"mask-r-from":Ne()}],"mask-image-r-to-pos":[{"mask-r-to":Ne()}],"mask-image-r-from-color":[{"mask-r-from":Q()}],"mask-image-r-to-color":[{"mask-r-to":Q()}],"mask-image-b-from-pos":[{"mask-b-from":Ne()}],"mask-image-b-to-pos":[{"mask-b-to":Ne()}],"mask-image-b-from-color":[{"mask-b-from":Q()}],"mask-image-b-to-color":[{"mask-b-to":Q()}],"mask-image-l-from-pos":[{"mask-l-from":Ne()}],"mask-image-l-to-pos":[{"mask-l-to":Ne()}],"mask-image-l-from-color":[{"mask-l-from":Q()}],"mask-image-l-to-color":[{"mask-l-to":Q()}],"mask-image-x-from-pos":[{"mask-x-from":Ne()}],"mask-image-x-to-pos":[{"mask-x-to":Ne()}],"mask-image-x-from-color":[{"mask-x-from":Q()}],"mask-image-x-to-color":[{"mask-x-to":Q()}],"mask-image-y-from-pos":[{"mask-y-from":Ne()}],"mask-image-y-to-pos":[{"mask-y-to":Ne()}],"mask-image-y-from-color":[{"mask-y-from":Q()}],"mask-image-y-to-color":[{"mask-y-to":Q()}],"mask-image-radial":[{"mask-radial":[ln,on]}],"mask-image-radial-from-pos":[{"mask-radial-from":Ne()}],"mask-image-radial-to-pos":[{"mask-radial-to":Ne()}],"mask-image-radial-from-color":[{"mask-radial-from":Q()}],"mask-image-radial-to-color":[{"mask-radial-to":Q()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":C()}],"mask-image-conic-pos":[{"mask-conic":[Bn]}],"mask-image-conic-from-pos":[{"mask-conic-from":Ne()}],"mask-image-conic-to-pos":[{"mask-conic-to":Ne()}],"mask-image-conic-from-color":[{"mask-conic-from":Q()}],"mask-image-conic-to-color":[{"mask-conic-to":Q()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ae()}],"mask-repeat":[{mask:B()}],"mask-size":[{mask:J()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",ln,on]}],filter:[{filter:["","none",ln,on]}],blur:[{blur:Re()}],brightness:[{brightness:[Bn,ln,on]}],contrast:[{contrast:[Bn,ln,on]}],"drop-shadow":[{"drop-shadow":["","none",y,hb,fb]}],"drop-shadow-color":[{"drop-shadow":Q()}],grayscale:[{grayscale:["",Bn,ln,on]}],"hue-rotate":[{"hue-rotate":[Bn,ln,on]}],invert:[{invert:["",Bn,ln,on]}],saturate:[{saturate:[Bn,ln,on]}],sepia:[{sepia:["",Bn,ln,on]}],"backdrop-filter":[{"backdrop-filter":["","none",ln,on]}],"backdrop-blur":[{"backdrop-blur":Re()}],"backdrop-brightness":[{"backdrop-brightness":[Bn,ln,on]}],"backdrop-contrast":[{"backdrop-contrast":[Bn,ln,on]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Bn,ln,on]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Bn,ln,on]}],"backdrop-invert":[{"backdrop-invert":["",Bn,ln,on]}],"backdrop-opacity":[{"backdrop-opacity":[Bn,ln,on]}],"backdrop-saturate":[{"backdrop-saturate":[Bn,ln,on]}],"backdrop-sepia":[{"backdrop-sepia":["",Bn,ln,on]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":j()}],"border-spacing-x":[{"border-spacing-x":j()}],"border-spacing-y":[{"border-spacing-y":j()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",ln,on]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Bn,"initial",ln,on]}],ease:[{ease:["linear","initial",x,ln,on]}],delay:[{delay:[Bn,ln,on]}],animate:[{animate:["none",S,ln,on]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,ln,on]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:ke()}],"rotate-x":[{"rotate-x":ke()}],"rotate-y":[{"rotate-y":ke()}],"rotate-z":[{"rotate-z":ke()}],scale:[{scale:Fe()}],"scale-x":[{"scale-x":Fe()}],"scale-y":[{"scale-y":Fe()}],"scale-z":[{"scale-z":Fe()}],"scale-3d":["scale-3d"],skew:[{skew:Qe()}],"skew-x":[{"skew-x":Qe()}],"skew-y":[{"skew-y":Qe()}],transform:[{transform:[ln,on,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Le()}],"translate-x":[{"translate-x":Le()}],"translate-y":[{"translate-y":Le()}],"translate-z":[{"translate-z":Le()}],"translate-none":["translate-none"],accent:[{accent:Q()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Q()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ln,on]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ln,on]}],fill:[{fill:["none",...Q()]}],"stroke-w":[{stroke:[Bn,Om,ld,J_]}],stroke:[{stroke:["none",...Q()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},UU=_U(zU);function Nt(...e){return UU(c6(e))}const qU=LC("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Mt({className:e,variant:t,size:n,asChild:r=!1,...a}){const i=r?s6:"button";return m.jsx(i,{"data-slot":"button",className:Nt(qU({variant:t,size:n,className:e})),...a})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HU=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),VU=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),bI=e=>{const t=VU(e);return t.charAt(0).toUpperCase()+t.slice(1)},w6=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var GU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WU=T.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:i,iconNode:s,...o},l)=>T.createElement("svg",{ref:l,...GU,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:w6("lucide",a),...o},[...s.map(([u,d])=>T.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=(e,t)=>{const n=T.forwardRef(({className:r,...a},i)=>T.createElement(WU,{ref:i,iconNode:t,className:w6(`lucide-${HU(bI(e))}`,`lucide-${e}`,r),...a}));return n.displayName=bI(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KU=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],ZU=an("archive",KU);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YU=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],XU=an("arrow-down",YU);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JU=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],QU=an("bot",JU);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eq=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],x6=an("brain-circuit",eq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tq=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],so=an("check",tq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nq=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Yo=an("chevron-down",nq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rq=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],_6=an("chevron-right",rq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aq=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],qd=an("chevron-up",aq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iq=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],kw=an("chevrons-up-down",iq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ad=an("circle-alert",sq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],BC=an("circle-check",oq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],S6=an("circle",lq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cq=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],zC=an("clipboard",cq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],dq=an("clock",uq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fq=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],E6=an("cloud-upload",fq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hq=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],pq=an("code",hq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mq=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],gq=an("cog",mq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yq=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],bq=an("coins",yq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vq=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],yh=an("download",vq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wq=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],xq=an("file-archive",wq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _q=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],Sq=an("file-json",_q);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eq=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],Cq=an("file-question",Eq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kq=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Tq=an("file-text",kq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aq=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Nq=an("file",Aq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rq=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],Iq=an("folder-git",Rq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jq=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],UC=an("folder-plus",jq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oq=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],Dq=an("folder-up",Oq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mq=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],s0=an("folder",Mq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pq=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],eg=an("git-branch",Pq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fq=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],Lq=an("git-commit-horizontal",Fq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $q=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],Bq=an("git-merge",$q);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zq=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],C6=an("git-pull-request",zq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uq=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],qq=an("grip-vertical",Uq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hq=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],k6=an("hard-drive",Hq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vq=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Gq=an("house",Vq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wq=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Kq=an("image",Wq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Yq=an("info",Zq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xq=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Jq=an("key",Xq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qq=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],zn=an("loader-circle",Qq);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eH=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],T6=an("message-square-plus",eH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tH=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],nH=an("message-square",tH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rH=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],aH=an("music",rH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iH=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],sH=an("panel-left-close",iH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oH=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],lH=an("panel-right-close",oH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cH=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],m2=an("paperclip",cH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uH=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],o0=an("pen",uH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dH=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Hd=an("plus",dH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fH=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Tw=an("refresh-cw",fH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hH=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],pH=an("rotate-ccw",hH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mH=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Vd=an("save",mH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gH=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Nd=an("search",gH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yH=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],bH=an("send-horizontal",yH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vH=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],A6=an("settings",vH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wH=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],xH=an("sliders-horizontal",wH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _H=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Jb=an("square-pen",_H);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SH=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],EH=an("square",SH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CH=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],kH=an("tags",CH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TH=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],AH=an("text",TH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NH=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ts=an("trash-2",NH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RH=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],qC=an("triangle-alert",RH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IH=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],jH=an("upload",IH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OH=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],DH=an("user",OH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MH=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],vI=an("users",MH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PH=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],FH=an("video",PH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LH=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],$H=an("wrench",LH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BH=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ts=an("x",BH);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zH=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],UH=an("zap",zH),wI=({controls:e,area:t,className:n})=>{const r=e.filter(a=>t==="trigger"?!!a.triggerRenderer:!!a.renderer);return r.length===0?null:m.jsx("div",{className:Nt(n),children:r.map(a=>{var s,o;const i=t==="trigger"?(s=a.triggerRenderer)==null?void 0:s.call(a):(o=a.renderer)==null?void 0:o.call(a);return i?m.jsx(gt.Fragment,{children:i},a.id):null})})},xI=e=>{let t;const n=new Set,r=(u,d)=>{const h=typeof u=="function"?u(t):u;if(!Object.is(h,t)){const p=t;t=d??(typeof h!="object"||h===null)?h:Object.assign({},t,h),n.forEach(y=>y(t,p))}},a=()=>t,o={setState:r,getState:a,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u))},l=t=e(r,a,o);return o},qH=e=>e?xI(e):xI,HH=e=>e;function VH(e,t=HH){const n=gt.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return gt.useDebugValue(n),n}const _I=e=>{const t=qH(e),n=r=>VH(t,r);return Object.assign(n,t),n},As=e=>e?_I(e):_I;var N6=Symbol.for("immer-nothing"),SI=Symbol.for("immer-draftable"),fr=Symbol.for("immer-state");function Ss(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ch=Object.getPrototypeOf;function kh(e){return!!e&&!!e[fr]}function Ul(e){var t;return e?R6(e)||Array.isArray(e)||!!e[SI]||!!((t=e.constructor)!=null&&t[SI])||Nw(e)||Rw(e):!1}var GH=Object.prototype.constructor.toString();function R6(e){if(!e||typeof e!="object")return!1;const t=Ch(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===GH}function tg(e,t){Aw(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function Aw(e){const t=e[fr];return t?t.type_:Array.isArray(e)?1:Nw(e)?2:Rw(e)?3:0}function g2(e,t){return Aw(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function I6(e,t,n){const r=Aw(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function WH(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Nw(e){return e instanceof Map}function Rw(e){return e instanceof Set}function Ma(e){return e.copy_||e.base_}function y2(e,t){if(Nw(e))return new Map(e);if(Rw(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=R6(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[fr];let a=Reflect.ownKeys(r);for(let i=0;i<a.length;i++){const s=a[i],o=r[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(Ch(e),r)}else{const r=Ch(e);if(r!==null&&n)return{...e};const a=Object.create(r);return Object.assign(a,e)}}function HC(e,t=!1){return Iw(e)||kh(e)||!Ul(e)||(Aw(e)>1&&(e.set=e.add=e.clear=e.delete=KH),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>HC(r,!0))),e}function KH(){Ss(2)}function Iw(e){return Object.isFrozen(e)}var b2={};function Rd(e){const t=b2[e];return t||Ss(0,e),t}function ZH(e,t){b2[e]||(b2[e]=t)}var ng;function uv(){return ng}function YH(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function EI(e,t){t&&(Rd("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function v2(e){w2(e),e.drafts_.forEach(XH),e.drafts_=null}function w2(e){e===ng&&(ng=e.parent_)}function CI(e){return ng=YH(ng,e)}function XH(e){const t=e[fr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function kI(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[fr].modified_&&(v2(t),Ss(4)),Ul(e)&&(e=dv(t,e),t.parent_||fv(t,e)),t.patches_&&Rd("Patches").generateReplacementPatches_(n[fr].base_,e,t.patches_,t.inversePatches_)):e=dv(t,n,[]),v2(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==N6?e:void 0}function dv(e,t,n){if(Iw(t))return t;const r=t[fr];if(!r)return tg(t,(a,i)=>TI(e,r,t,a,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return fv(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const a=r.copy_;let i=a,s=!1;r.type_===3&&(i=new Set(a),a.clear(),s=!0),tg(i,(o,l)=>TI(e,r,a,o,l,n,s)),fv(e,a,!1),n&&e.patches_&&Rd("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function TI(e,t,n,r,a,i,s){if(kh(a)){const o=i&&t&&t.type_!==3&&!g2(t.assigned_,r)?i.concat(r):void 0,l=dv(e,a,o);if(I6(n,r,l),kh(l))e.canAutoFreeze_=!1;else return}else s&&n.add(a);if(Ul(a)&&!Iw(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;dv(e,a),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&fv(e,a)}}function fv(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&HC(t,n)}function JH(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:uv(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,i=VC;n&&(a=[r],i=rg);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return r.draft_=o,r.revoke_=s,o}var VC={get(e,t){if(t===fr)return e;const n=Ma(e);if(!g2(n,t))return QH(e,n,t);const r=n[t];return e.finalized_||!Ul(r)?r:r===Q_(e.base_,t)?(eS(e),e.copy_[t]=ag(r,e)):r},has(e,t){return t in Ma(e)},ownKeys(e){return Reflect.ownKeys(Ma(e))},set(e,t,n){const r=j6(Ma(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const a=Q_(Ma(e),t),i=a==null?void 0:a[fr];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(WH(n,a)&&(n!==void 0||g2(e.base_,t)))return!0;eS(e),Rl(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Q_(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,eS(e),Rl(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=Ma(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){Ss(11)},getPrototypeOf(e){return Ch(e.base_)},setPrototypeOf(){Ss(12)}},rg={};tg(VC,(e,t)=>{rg[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});rg.deleteProperty=function(e,t){return rg.set.call(this,e,t,void 0)};rg.set=function(e,t,n){return VC.set.call(this,e[0],t,n,e[0])};function Q_(e,t){const n=e[fr];return(n?Ma(n):e)[t]}function QH(e,t,n){var a;const r=j6(t,n);return r?"value"in r?r.value:(a=r.get)==null?void 0:a.call(e.draft_):void 0}function j6(e,t){if(!(t in e))return;let n=Ch(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Ch(n)}}function Rl(e){e.modified_||(e.modified_=!0,e.parent_&&Rl(e.parent_))}function eS(e){e.copy_||(e.copy_=y2(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var eV=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const s=this;return function(l=i,...u){return s.produce(l,d=>n.call(this,d,...u))}}typeof n!="function"&&Ss(6),r!==void 0&&typeof r!="function"&&Ss(7);let a;if(Ul(t)){const i=CI(this),s=ag(t,void 0);let o=!0;try{a=n(s),o=!1}finally{o?v2(i):w2(i)}return EI(i,r),kI(a,i)}else if(!t||typeof t!="object"){if(a=n(t),a===void 0&&(a=t),a===N6&&(a=void 0),this.autoFreeze_&&HC(a,!0),r){const i=[],s=[];Rd("Patches").generateReplacementPatches_(t,a,i,s),r(i,s)}return a}else Ss(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,l=>t(l,...o));let r,a;return[this.produce(t,n,(s,o)=>{r=s,a=o}),r,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ul(e)||Ss(8),kh(e)&&(e=tV(e));const t=CI(this),n=ag(e,void 0);return n[fr].isManual_=!0,w2(t),n}finishDraft(e,t){const n=e&&e[fr];(!n||!n.isManual_)&&Ss(9);const{scope_:r}=n;return EI(r,t),kI(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const a=t[n];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}n>-1&&(t=t.slice(n+1));const r=Rd("Patches").applyPatches_;return kh(e)?r(e,t):this.produce(e,a=>r(a,t))}};function ag(e,t){const n=Nw(e)?Rd("MapSet").proxyMap_(e,t):Rw(e)?Rd("MapSet").proxySet_(e,t):JH(e,t);return(t?t.scope_:uv()).drafts_.push(n),n}function tV(e){return kh(e)||Ss(10,e),O6(e)}function O6(e){if(!Ul(e)||Iw(e))return e;const t=e[fr];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=y2(e,t.scope_.immer_.useStrictShallowCopy_)}else n=y2(e,!0);return tg(n,(r,a)=>{I6(n,r,O6(a))}),t&&(t.finalized_=!1),n}function nV(){class e extends Map{constructor(l,u){super(),this[fr]={type_:2,parent_:u,scope_:u?u.scope_:uv(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return Ma(this[fr]).size}has(l){return Ma(this[fr]).has(l)}set(l,u){const d=this[fr];return s(d),(!Ma(d).has(l)||Ma(d).get(l)!==u)&&(n(d),Rl(d),d.assigned_.set(l,!0),d.copy_.set(l,u),d.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const u=this[fr];return s(u),n(u),Rl(u),u.base_.has(l)?u.assigned_.set(l,!1):u.assigned_.delete(l),u.copy_.delete(l),!0}clear(){const l=this[fr];s(l),Ma(l).size&&(n(l),Rl(l),l.assigned_=new Map,tg(l.base_,u=>{l.assigned_.set(u,!1)}),l.copy_.clear())}forEach(l,u){const d=this[fr];Ma(d).forEach((h,p,y)=>{l.call(u,this.get(p),p,this)})}get(l){const u=this[fr];s(u);const d=Ma(u).get(l);if(u.finalized_||!Ul(d)||d!==u.base_.get(l))return d;const h=ag(d,u);return n(u),u.copy_.set(l,h),h}keys(){return Ma(this[fr]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const u=l.next();return u.done?u:{done:!1,value:this.get(u.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const u=l.next();if(u.done)return u;const d=this.get(u.value);return{done:!1,value:[u.value,d]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,u){super(),this[fr]={type_:3,parent_:u,scope_:u?u.scope_:uv(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return Ma(this[fr]).size}has(l){const u=this[fr];return s(u),u.copy_?!!(u.copy_.has(l)||u.drafts_.has(l)&&u.copy_.has(u.drafts_.get(l))):u.base_.has(l)}add(l){const u=this[fr];return s(u),this.has(l)||(i(u),Rl(u),u.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const u=this[fr];return s(u),i(u),Rl(u),u.copy_.delete(l)||(u.drafts_.has(l)?u.copy_.delete(u.drafts_.get(l)):!1)}clear(){const l=this[fr];s(l),Ma(l).size&&(i(l),Rl(l),l.copy_.clear())}values(){const l=this[fr];return s(l),i(l),l.copy_.values()}entries(){const l=this[fr];return s(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,u){const d=this.values();let h=d.next();for(;!h.done;)l.call(u,h.value,h.value,this),h=d.next()}}function a(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(Ul(l)){const u=ag(l,o);o.drafts_.set(l,u),o.copy_.add(u)}else o.copy_.add(l)}))}function s(o){o.revoked_&&Ss(3,JSON.stringify(Ma(o)))}ZH("MapSet",{proxyMap_:t,proxySet_:a})}var as=new eV,rV=as.produce;as.produceWithPatches.bind(as);as.setAutoFreeze.bind(as);as.setUseStrictShallowCopy.bind(as);as.applyPatches.bind(as);as.createDraft.bind(as);as.finishDraft.bind(as);const aV=e=>(t,n,r)=>(r.setState=(a,i,...s)=>{const o=typeof a=="function"?rV(a):a;return t(o,i,...s)},e(r.setState,n,r)),Ns=aV,Dr=As(Ns((e,t)=>({promptControls:{},chatControls:{},middlewareRegistry:{},tools:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)})},registerMiddleware:(n,r,a,i=0)=>{const s={modId:r,callback:a,order:i};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(s),o.middlewareRegistry[n].sort((l,u)=>(l.order??0)-(u.order??0))}),()=>t().unregisterMiddleware(n,r,a)},unregisterMiddleware:(n,r,a)=>{e(i=>{var s;i.middlewareRegistry[n]?(i.middlewareRegistry[n]=i.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===a)),((s=i.middlewareRegistry[n])==null?void 0:s.length)===0&&delete i.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((a,i)=>(a.order??0)-(i.order??0)))},registerTool:(n,r,a,i)=>(e(s=>{s.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${s.tools[r].modId}". Overwriting with registration from mod "${n}".`),s.tools[r]={definition:a,implementation:i,modId:n}}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)})},getRegisteredTools:()=>Object.freeze({...t().tools})})));var Qb={exports:{}},iV=Qb.exports,AI;function sV(){return AI||(AI=1,function(e,t){(function(n,r){e.exports=r()})(iV,function(){var n=function(A,D){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Z,ne){Z.__proto__=ne}||function(Z,ne){for(var ue in ne)Object.prototype.hasOwnProperty.call(ne,ue)&&(Z[ue]=ne[ue])})(A,D)},r=function(){return(r=Object.assign||function(A){for(var D,Z=1,ne=arguments.length;Z<ne;Z++)for(var ue in D=arguments[Z])Object.prototype.hasOwnProperty.call(D,ue)&&(A[ue]=D[ue]);return A}).apply(this,arguments)};function a(A,D,Z){for(var ne,ue=0,we=D.length;ue<we;ue++)!ne&&ue in D||((ne=ne||Array.prototype.slice.call(D,0,ue))[ue]=D[ue]);return A.concat(ne||Array.prototype.slice.call(D))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:wd,s=Object.keys,o=Array.isArray;function l(A,D){return typeof D!="object"||s(D).forEach(function(Z){A[Z]=D[Z]}),A}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var u=Object.getPrototypeOf,d={}.hasOwnProperty;function h(A,D){return d.call(A,D)}function p(A,D){typeof D=="function"&&(D=D(u(A))),(typeof Reflect>"u"?s:Reflect.ownKeys)(D).forEach(function(Z){v(A,Z,D[Z])})}var y=Object.defineProperty;function v(A,D,Z,ne){y(A,D,l(Z&&h(Z,"get")&&typeof Z.get=="function"?{get:Z.get,set:Z.set,configurable:!0}:{value:Z,configurable:!0,writable:!0},ne))}function b(A){return{from:function(D){return A.prototype=Object.create(D.prototype),v(A.prototype,"constructor",A),{extend:p.bind(null,A.prototype)}}}}var w=Object.getOwnPropertyDescriptor,x=[].slice;function S(A,D,Z){return x.call(A,D,Z)}function E(A,D){return D(A)}function C(A){if(!A)throw new Error("Assertion Failed")}function k(A){i.setImmediate?setImmediate(A):setTimeout(A,0)}function R(A,D){if(typeof D=="string"&&h(A,D))return A[D];if(!D)return A;if(typeof D!="string"){for(var Z=[],ne=0,ue=D.length;ne<ue;++ne){var we=R(A,D[ne]);Z.push(we)}return Z}var De=D.indexOf(".");if(De!==-1){var $e=A[D.substr(0,De)];return $e==null?void 0:R($e,D.substr(De+1))}}function O(A,D,Z){if(A&&D!==void 0&&!("isFrozen"in Object&&Object.isFrozen(A)))if(typeof D!="string"&&"length"in D){C(typeof Z!="string"&&"length"in Z);for(var ne=0,ue=D.length;ne<ue;++ne)O(A,D[ne],Z[ne])}else{var we,De,$e=D.indexOf(".");$e!==-1?(we=D.substr(0,$e),(De=D.substr($e+1))===""?Z===void 0?o(A)&&!isNaN(parseInt(we))?A.splice(we,1):delete A[we]:A[we]=Z:O($e=!($e=A[we])||!h(A,we)?A[we]={}:$e,De,Z)):Z===void 0?o(A)&&!isNaN(parseInt(D))?A.splice(D,1):delete A[D]:A[D]=Z}}function j(A){var D,Z={};for(D in A)h(A,D)&&(Z[D]=A[D]);return Z}var $=[].concat;function L(A){return $.apply([],A)}var xt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(L([8,16,32,64].map(function(A){return["Int","Uint","Float"].map(function(D){return D+A+"Array"})}))).filter(function(A){return i[A]}),X=new Set(xt.map(function(A){return i[A]})),F=null;function K(A){return F=new WeakMap,A=function D(Z){if(!Z||typeof Z!="object")return Z;var ne=F.get(Z);if(ne)return ne;if(o(Z)){ne=[],F.set(Z,ne);for(var ue=0,we=Z.length;ue<we;++ue)ne.push(D(Z[ue]))}else if(X.has(Z.constructor))ne=Z;else{var De,$e=u(Z);for(De in ne=$e===Object.prototype?{}:Object.create($e),F.set(Z,ne),Z)h(Z,De)&&(ne[De]=D(Z[De]))}return ne}(A),F=null,A}var q={}.toString;function de(A){return q.call(A).slice(8,-1)}var re=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Y=typeof re=="symbol"?function(A){var D;return A!=null&&(D=A[re])&&D.apply(A)}:function(){return null};function Q(A,D){return D=A.indexOf(D),0<=D&&A.splice(D,1),0<=D}var ae={};function B(A){var D,Z,ne,ue;if(arguments.length===1){if(o(A))return A.slice();if(this===ae&&typeof A=="string")return[A];if(ue=Y(A)){for(Z=[];!(ne=ue.next()).done;)Z.push(ne.value);return Z}if(A==null)return[A];if(typeof(D=A.length)!="number")return[A];for(Z=new Array(D);D--;)Z[D]=A[D];return Z}for(D=arguments.length,Z=new Array(D);D--;)Z[D]=arguments[D];return Z}var J=typeof Symbol<"u"?function(A){return A[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},it=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],gi=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(it),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function oe(A,D){this.name=A,this.message=D}function me(A,D){return A+". Errors: "+Object.keys(D).map(function(Z){return D[Z].toString()}).filter(function(Z,ne,ue){return ue.indexOf(Z)===ne}).join(`
`)}function xe(A,D,Z,ne){this.failures=D,this.failedKeys=ne,this.successCount=Z,this.message=me(A,D)}function Pe(A,D){this.name="BulkError",this.failures=Object.keys(D).map(function(Z){return D[Z]}),this.failuresByPos=D,this.message=me(A,this.failures)}b(oe).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(xe).from(oe),b(Pe).from(oe);var Ne=gi.reduce(function(A,D){return A[D]=D+"Error",A},{}),Re=oe,ke=gi.reduce(function(A,D){var Z=D+"Error";function ne(ue,we){this.name=Z,ue?typeof ue=="string"?(this.message="".concat(ue).concat(we?`
 `+we:""),this.inner=we||null):typeof ue=="object"&&(this.message="".concat(ue.name," ").concat(ue.message),this.inner=ue):(this.message=ee[D]||Z,this.inner=null)}return b(ne).from(Re),A[D]=ne,A},{});ke.Syntax=SyntaxError,ke.Type=TypeError,ke.Range=RangeError;var Fe=it.reduce(function(A,D){return A[D+"Error"]=ke[D],A},{}),Qe=gi.reduce(function(A,D){return["Syntax","Type","Range"].indexOf(D)===-1&&(A[D+"Error"]=ke[D]),A},{});function Le(){}function Ie(A){return A}function V(A,D){return A==null||A===Ie?D:function(Z){return D(A(Z))}}function ge(A,D){return function(){A.apply(this,arguments),D.apply(this,arguments)}}function Te(A,D){return A===Le?D:function(){var Z=A.apply(this,arguments);Z!==void 0&&(arguments[0]=Z);var ne=this.onsuccess,ue=this.onerror;this.onsuccess=null,this.onerror=null;var we=D.apply(this,arguments);return ne&&(this.onsuccess=this.onsuccess?ge(ne,this.onsuccess):ne),ue&&(this.onerror=this.onerror?ge(ue,this.onerror):ue),we!==void 0?we:Z}}function le(A,D){return A===Le?D:function(){A.apply(this,arguments);var Z=this.onsuccess,ne=this.onerror;this.onsuccess=this.onerror=null,D.apply(this,arguments),Z&&(this.onsuccess=this.onsuccess?ge(Z,this.onsuccess):Z),ne&&(this.onerror=this.onerror?ge(ne,this.onerror):ne)}}function ie(A,D){return A===Le?D:function(Z){var ne=A.apply(this,arguments);l(Z,ne);var ue=this.onsuccess,we=this.onerror;return this.onsuccess=null,this.onerror=null,Z=D.apply(this,arguments),ue&&(this.onsuccess=this.onsuccess?ge(ue,this.onsuccess):ue),we&&(this.onerror=this.onerror?ge(we,this.onerror):we),ne===void 0?Z===void 0?void 0:Z:l(ne,Z)}}function te(A,D){return A===Le?D:function(){return D.apply(this,arguments)!==!1&&A.apply(this,arguments)}}function _e(A,D){return A===Le?D:function(){var Z=A.apply(this,arguments);if(Z&&typeof Z.then=="function"){for(var ne=this,ue=arguments.length,we=new Array(ue);ue--;)we[ue]=arguments[ue];return Z.then(function(){return D.apply(ne,we)})}return D.apply(this,arguments)}}Qe.ModifyError=xe,Qe.DexieError=oe,Qe.BulkError=Pe;var Me=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ee(A){Me=A}var We={},kt=100,xt=typeof Promise>"u"?[]:function(){var A=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[A,u(A),A];var D=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[D,u(D),A]}(),it=xt[0],gi=xt[1],xt=xt[2],gi=gi&&gi.then,Dt=it&&it.constructor,Ot=!!xt,Wt=function(A,D){ce.push([A,D]),I&&(queueMicrotask(pe),I=!1)},be=!0,I=!0,G=[],fe=[],je=Ie,ve={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Le,pgp:!1,env:{},finalize:Le},Ce=ve,ce=[],ft=0,vt=[];function M(A){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var D=this._PSD=Ce;if(typeof A!="function"){if(A!==We)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ye(this,this._value))}this._state=null,this._value=null,++D.ref,function Z(ne,ue){try{ue(function(we){if(ne._state===null){if(we===ne)throw new TypeError("A promise cannot be resolved with itself.");var De=ne._lib&&H();we&&typeof we.then=="function"?Z(ne,function($e,Ge){we instanceof M?we._then($e,Ge):we.then($e,Ge)}):(ne._state=!0,ne._value=we,Oe(ne)),De&&U()}},ye.bind(null,ne))}catch(we){ye(ne,we)}}(this,A)}var Be={get:function(){var A=Ce,D=Tt;function Z(ne,ue){var we=this,De=!A.global&&(A!==Ce||D!==Tt),$e=De&&!Hn(),Ge=new M(function(Ye,rt){Ke(we,new nt(po(ne,A,De,$e),po(ue,A,De,$e),Ye,rt,A))});return this._consoleTask&&(Ge._consoleTask=this._consoleTask),Ge}return Z.prototype=We,Z},set:function(A){v(this,"then",A&&A.prototype===We?Be:{get:function(){return A},set:Be.set})}};function nt(A,D,Z,ne,ue){this.onFulfilled=typeof A=="function"?A:null,this.onRejected=typeof D=="function"?D:null,this.resolve=Z,this.reject=ne,this.psd=ue}function ye(A,D){var Z,ne;fe.push(D),A._state===null&&(Z=A._lib&&H(),D=je(D),A._state=!1,A._value=D,ne=A,G.some(function(ue){return ue._value===ne._value})||G.push(ne),Oe(A),Z&&U())}function Oe(A){var D=A._listeners;A._listeners=[];for(var Z=0,ne=D.length;Z<ne;++Z)Ke(A,D[Z]);var ue=A._PSD;--ue.ref||ue.finalize(),ft===0&&(++ft,Wt(function(){--ft==0&&W()},[]))}function Ke(A,D){if(A._state!==null){var Z=A._state?D.onFulfilled:D.onRejected;if(Z===null)return(A._state?D.resolve:D.reject)(A._value);++D.psd.ref,++ft,Wt(Rt,[Z,A,D])}else A._listeners.push(D)}function Rt(A,D,Z){try{var ne,ue=D._value;!D._state&&fe.length&&(fe=[]),ne=Me&&D._consoleTask?D._consoleTask.run(function(){return A(ue)}):A(ue),D._state||fe.indexOf(ue)!==-1||function(we){for(var De=G.length;De;)if(G[--De]._value===we._value)return G.splice(De,1)}(D),Z.resolve(ne)}catch(we){Z.reject(we)}finally{--ft==0&&W(),--Z.psd.ref||Z.psd.finalize()}}function pe(){ho(ve,function(){H()&&U()})}function H(){var A=be;return I=be=!1,A}function U(){var A,D,Z;do for(;0<ce.length;)for(A=ce,ce=[],Z=A.length,D=0;D<Z;++D){var ne=A[D];ne[0].apply(null,ne[1])}while(0<ce.length);I=be=!0}function W(){var A=G;G=[],A.forEach(function(ne){ne._PSD.onunhandled.call(null,ne._value,ne)});for(var D=vt.slice(0),Z=D.length;Z;)D[--Z]()}function he(A){return new M(We,!1,A)}function Ae(A,D){var Z=Ce;return function(){var ne=H(),ue=Ce;try{return Mn(Z,!0),A.apply(this,arguments)}catch(we){D&&D(we)}finally{Mn(ue,!1),ne&&U()}}}p(M.prototype,{then:Be,_then:function(A,D){Ke(this,new nt(null,null,A,D,Ce))},catch:function(A){if(arguments.length===1)return this.then(null,A);var D=A,Z=arguments[1];return typeof D=="function"?this.then(null,function(ne){return(ne instanceof D?Z:he)(ne)}):this.then(null,function(ne){return(ne&&ne.name===D?Z:he)(ne)})},finally:function(A){return this.then(function(D){return M.resolve(A()).then(function(){return D})},function(D){return M.resolve(A()).then(function(){return he(D)})})},timeout:function(A,D){var Z=this;return A<1/0?new M(function(ne,ue){var we=setTimeout(function(){return ue(new ke.Timeout(D))},A);Z.then(ne,ue).finally(clearTimeout.bind(null,we))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&v(M.prototype,Symbol.toStringTag,"Dexie.Promise"),ve.env=hi(),p(M,{all:function(){var A=B.apply(null,arguments).map(wr);return new M(function(D,Z){A.length===0&&D([]);var ne=A.length;A.forEach(function(ue,we){return M.resolve(ue).then(function(De){A[we]=De,--ne||D(A)},Z)})})},resolve:function(A){return A instanceof M?A:A&&typeof A.then=="function"?new M(function(D,Z){A.then(D,Z)}):new M(We,!0,A)},reject:he,race:function(){var A=B.apply(null,arguments).map(wr);return new M(function(D,Z){A.map(function(ne){return M.resolve(ne).then(D,Z)})})},PSD:{get:function(){return Ce},set:function(A){return Ce=A}},totalEchoes:{get:function(){return Tt}},newPSD:Jt,usePSD:ho,scheduler:{get:function(){return Wt},set:function(A){Wt=A}},rejectionMapper:{get:function(){return je},set:function(A){je=A}},follow:function(A,D){return new M(function(Z,ne){return Jt(function(ue,we){var De=Ce;De.unhandleds=[],De.onunhandled=we,De.finalize=ge(function(){var $e,Ge=this;$e=function(){Ge.unhandleds.length===0?ue():we(Ge.unhandleds[0])},vt.push(function Ye(){$e(),vt.splice(vt.indexOf(Ye),1)}),++ft,Wt(function(){--ft==0&&W()},[])},De.finalize),A()},D,Z,ne)})}}),Dt&&(Dt.allSettled&&v(M,"allSettled",function(){var A=B.apply(null,arguments).map(wr);return new M(function(D){A.length===0&&D([]);var Z=A.length,ne=new Array(Z);A.forEach(function(ue,we){return M.resolve(ue).then(function(De){return ne[we]={status:"fulfilled",value:De}},function(De){return ne[we]={status:"rejected",reason:De}}).then(function(){return--Z||D(ne)})})})}),Dt.any&&typeof AggregateError<"u"&&v(M,"any",function(){var A=B.apply(null,arguments).map(wr);return new M(function(D,Z){A.length===0&&Z(new AggregateError([]));var ne=A.length,ue=new Array(ne);A.forEach(function(we,De){return M.resolve(we).then(function($e){return D($e)},function($e){ue[De]=$e,--ne||Z(new AggregateError(ue))})})})}),Dt.withResolvers&&(M.withResolvers=Dt.withResolvers));var qe={awaits:0,echoes:0,id:0},pt=0,Gt=[],ut=0,Tt=0,Pt=0;function Jt(A,D,Z,ne){var ue=Ce,we=Object.create(ue);return we.parent=ue,we.ref=0,we.global=!1,we.id=++Pt,ve.env,we.env=Ot?{Promise:M,PromiseProp:{value:M,configurable:!0,writable:!0},all:M.all,race:M.race,allSettled:M.allSettled,any:M.any,resolve:M.resolve,reject:M.reject}:{},D&&l(we,D),++ue.ref,we.finalize=function(){--this.parent.ref||this.parent.finalize()},ne=ho(we,A,Z,ne),we.ref===0&&we.finalize(),ne}function An(){return qe.id||(qe.id=++pt),++qe.awaits,qe.echoes+=kt,qe.id}function Hn(){return!!qe.awaits&&(--qe.awaits==0&&(qe.id=0),qe.echoes=qe.awaits*kt,!0)}function wr(A){return qe.echoes&&A&&A.constructor===Dt?(An(),A.then(function(D){return Hn(),D},function(D){return Hn(),Wr(D)})):A}function xr(){var A=Gt[Gt.length-1];Gt.pop(),Mn(A,!1)}function Mn(A,D){var Z,ne=Ce;(D?!qe.echoes||ut++&&A===Ce:!ut||--ut&&A===Ce)||queueMicrotask(D?(function(ue){++Tt,qe.echoes&&--qe.echoes!=0||(qe.echoes=qe.awaits=qe.id=0),Gt.push(Ce),Mn(ue,!0)}).bind(null,A):xr),A!==Ce&&(Ce=A,ne===ve&&(ve.env=hi()),Ot&&(Z=ve.env.Promise,D=A.env,(ne.global||A.global)&&(Object.defineProperty(i,"Promise",D.PromiseProp),Z.all=D.all,Z.race=D.race,Z.resolve=D.resolve,Z.reject=D.reject,D.allSettled&&(Z.allSettled=D.allSettled),D.any&&(Z.any=D.any))))}function hi(){var A=i.Promise;return Ot?{Promise:A,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:A.all,race:A.race,allSettled:A.allSettled,any:A.any,resolve:A.resolve,reject:A.reject}:{}}function ho(A,D,Z,ne,ue){var we=Ce;try{return Mn(A,!0),D(Z,ne,ue)}finally{Mn(we,!1)}}function po(A,D,Z,ne){return typeof A!="function"?A:function(){var ue=Ce;Z&&An(),Mn(D,!0);try{return A.apply(this,arguments)}finally{Mn(ue,!1),ne&&queueMicrotask(Hn)}}}function mo(A){Promise===Dt&&qe.echoes===0?ut===0?A():enqueueNativeMicroTask(A):setTimeout(A,0)}(""+gi).indexOf("[native code]")===-1&&(An=Hn=Le);var Wr=M.reject,go="",ss="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ny="String expected.",Ds=[],tl="__dbnames",zi="readonly",zu="readwrite";function yo(A,D){return A?D?function(){return A.apply(this,arguments)&&D.apply(this,arguments)}:A:D}var nl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function rc(A){return typeof A!="string"||/\./.test(A)?function(D){return D}:function(D){return D[A]===void 0&&A in D&&delete(D=K(D))[A],D}}function uf(){throw ke.Type()}function Vn(A,D){try{var Z=Ap(A),ne=Ap(D);if(Z!==ne)return Z==="Array"?1:ne==="Array"?-1:Z==="binary"?1:ne==="binary"?-1:Z==="string"?1:ne==="string"?-1:Z==="Date"?1:ne!=="Date"?NaN:-1;switch(Z){case"number":case"Date":case"string":return D<A?1:A<D?-1:0;case"binary":return function(ue,we){for(var De=ue.length,$e=we.length,Ge=De<$e?De:$e,Ye=0;Ye<Ge;++Ye)if(ue[Ye]!==we[Ye])return ue[Ye]<we[Ye]?-1:1;return De===$e?0:De<$e?-1:1}(pi(A),pi(D));case"Array":return function(ue,we){for(var De=ue.length,$e=we.length,Ge=De<$e?De:$e,Ye=0;Ye<Ge;++Ye){var rt=Vn(ue[Ye],we[Ye]);if(rt!==0)return rt}return De===$e?0:De<$e?-1:1}(A,D)}}catch{}return NaN}function Ap(A){var D=typeof A;return D!="object"?D:ArrayBuffer.isView(A)?"binary":(A=de(A),A==="ArrayBuffer"?"binary":A)}function pi(A){return A instanceof Uint8Array?A:ArrayBuffer.isView(A)?new Uint8Array(A.buffer,A.byteOffset,A.byteLength):new Uint8Array(A)}var Np=(Nr.prototype._trans=function(A,D,Z){var ne=this._tx||Ce.trans,ue=this.name,we=Me&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(A==="readonly"?"read":"write"," ").concat(this.name));function De(Ye,rt,He){if(!He.schema[ue])throw new ke.NotFound("Table "+ue+" not part of transaction");return D(He.idbtrans,He)}var $e=H();try{var Ge=ne&&ne.db._novip===this.db._novip?ne===Ce.trans?ne._promise(A,De,Z):Jt(function(){return ne._promise(A,De,Z)},{trans:ne,transless:Ce.transless||Ce}):function Ye(rt,He,st,Ve){if(rt.idbdb&&(rt._state.openComplete||Ce.letThrough||rt._vip)){var et=rt._createTransaction(He,st,rt._dbSchema);try{et.create(),rt._state.PR1398_maxLoop=3}catch(ot){return ot.name===Ne.InvalidState&&rt.isOpen()&&0<--rt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),rt.close({disableAutoOpen:!1}),rt.open().then(function(){return Ye(rt,He,st,Ve)})):Wr(ot)}return et._promise(He,function(ot,Xe){return Jt(function(){return Ce.trans=et,Ve(ot,Xe,et)})}).then(function(ot){if(He==="readwrite")try{et.idbtrans.commit()}catch{}return He==="readonly"?ot:et._completion.then(function(){return ot})})}if(rt._state.openComplete)return Wr(new ke.DatabaseClosed(rt._state.dbOpenError));if(!rt._state.isBeingOpened){if(!rt._state.autoOpen)return Wr(new ke.DatabaseClosed);rt.open().catch(Le)}return rt._state.dbReadyPromise.then(function(){return Ye(rt,He,st,Ve)})}(this.db,A,[this.name],De);return we&&(Ge._consoleTask=we,Ge=Ge.catch(function(Ye){return console.trace(Ye),Wr(Ye)})),Ge}finally{$e&&U()}},Nr.prototype.get=function(A,D){var Z=this;return A&&A.constructor===Object?this.where(A).first(D):A==null?Wr(new ke.Type("Invalid argument to Table.get()")):this._trans("readonly",function(ne){return Z.core.get({trans:ne,key:A}).then(function(ue){return Z.hook.reading.fire(ue)})}).then(D)},Nr.prototype.where=function(A){if(typeof A=="string")return new this.db.WhereClause(this,A);if(o(A))return new this.db.WhereClause(this,"[".concat(A.join("+"),"]"));var D=s(A);if(D.length===1)return this.where(D[0]).equals(A[D[0]]);var Z=this.schema.indexes.concat(this.schema.primKey).filter(function($e){if($e.compound&&D.every(function(Ye){return 0<=$e.keyPath.indexOf(Ye)})){for(var Ge=0;Ge<D.length;++Ge)if(D.indexOf($e.keyPath[Ge])===-1)return!1;return!0}return!1}).sort(function($e,Ge){return $e.keyPath.length-Ge.keyPath.length})[0];if(Z&&this.db._maxKey!==go){var we=Z.keyPath.slice(0,D.length);return this.where(we).equals(we.map(function(Ge){return A[Ge]}))}!Z&&Me&&console.warn("The query ".concat(JSON.stringify(A)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(D.join("+"),"]"));var ne=this.schema.idxByName;function ue($e,Ge){return Vn($e,Ge)===0}var De=D.reduce(function(He,Ge){var Ye=He[0],rt=He[1],He=ne[Ge],st=A[Ge];return[Ye||He,Ye||!He?yo(rt,He&&He.multi?function(Ve){return Ve=R(Ve,Ge),o(Ve)&&Ve.some(function(et){return ue(st,et)})}:function(Ve){return ue(st,R(Ve,Ge))}):rt]},[null,null]),we=De[0],De=De[1];return we?this.where(we.name).equals(A[we.keyPath]).filter(De):Z?this.filter(De):this.where(D).equals("")},Nr.prototype.filter=function(A){return this.toCollection().and(A)},Nr.prototype.count=function(A){return this.toCollection().count(A)},Nr.prototype.offset=function(A){return this.toCollection().offset(A)},Nr.prototype.limit=function(A){return this.toCollection().limit(A)},Nr.prototype.each=function(A){return this.toCollection().each(A)},Nr.prototype.toArray=function(A){return this.toCollection().toArray(A)},Nr.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Nr.prototype.orderBy=function(A){return new this.db.Collection(new this.db.WhereClause(this,o(A)?"[".concat(A.join("+"),"]"):A))},Nr.prototype.reverse=function(){return this.toCollection().reverse()},Nr.prototype.mapToClass=function(A){var D,Z=this.db,ne=this.name;function ue(){return D!==null&&D.apply(this,arguments)||this}(this.schema.mappedClass=A).prototype instanceof uf&&(function(Ge,Ye){if(typeof Ye!="function"&&Ye!==null)throw new TypeError("Class extends value "+String(Ye)+" is not a constructor or null");function rt(){this.constructor=Ge}n(Ge,Ye),Ge.prototype=Ye===null?Object.create(Ye):(rt.prototype=Ye.prototype,new rt)}(ue,D=A),Object.defineProperty(ue.prototype,"db",{get:function(){return Z},enumerable:!1,configurable:!0}),ue.prototype.table=function(){return ne},A=ue);for(var we=new Set,De=A.prototype;De;De=u(De))Object.getOwnPropertyNames(De).forEach(function(Ge){return we.add(Ge)});function $e(Ge){if(!Ge)return Ge;var Ye,rt=Object.create(A.prototype);for(Ye in Ge)if(!we.has(Ye))try{rt[Ye]=Ge[Ye]}catch{}return rt}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=$e,this.hook("reading",$e),A},Nr.prototype.defineClass=function(){return this.mapToClass(function(A){l(this,A)})},Nr.prototype.add=function(A,D){var Z=this,ne=this.schema.primKey,ue=ne.auto,we=ne.keyPath,De=A;return we&&ue&&(De=rc(we)(A)),this._trans("readwrite",function($e){return Z.core.mutate({trans:$e,type:"add",keys:D!=null?[D]:null,values:[De]})}).then(function($e){return $e.numFailures?M.reject($e.failures[0]):$e.lastResult}).then(function($e){if(we)try{O(A,we,$e)}catch{}return $e})},Nr.prototype.update=function(A,D){return typeof A!="object"||o(A)?this.where(":id").equals(A).modify(D):(A=R(A,this.schema.primKey.keyPath),A===void 0?Wr(new ke.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(A).modify(D))},Nr.prototype.put=function(A,D){var Z=this,ne=this.schema.primKey,ue=ne.auto,we=ne.keyPath,De=A;return we&&ue&&(De=rc(we)(A)),this._trans("readwrite",function($e){return Z.core.mutate({trans:$e,type:"put",values:[De],keys:D!=null?[D]:null})}).then(function($e){return $e.numFailures?M.reject($e.failures[0]):$e.lastResult}).then(function($e){if(we)try{O(A,we,$e)}catch{}return $e})},Nr.prototype.delete=function(A){var D=this;return this._trans("readwrite",function(Z){return D.core.mutate({trans:Z,type:"delete",keys:[A]})}).then(function(Z){return Z.numFailures?M.reject(Z.failures[0]):void 0})},Nr.prototype.clear=function(){var A=this;return this._trans("readwrite",function(D){return A.core.mutate({trans:D,type:"deleteRange",range:nl})}).then(function(D){return D.numFailures?M.reject(D.failures[0]):void 0})},Nr.prototype.bulkGet=function(A){var D=this;return this._trans("readonly",function(Z){return D.core.getMany({keys:A,trans:Z}).then(function(ne){return ne.map(function(ue){return D.hook.reading.fire(ue)})})})},Nr.prototype.bulkAdd=function(A,D,Z){var ne=this,ue=Array.isArray(D)?D:void 0,we=(Z=Z||(ue?void 0:D))?Z.allKeys:void 0;return this._trans("readwrite",function(De){var Ye=ne.schema.primKey,$e=Ye.auto,Ye=Ye.keyPath;if(Ye&&ue)throw new ke.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(ue&&ue.length!==A.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var Ge=A.length,Ye=Ye&&$e?A.map(rc(Ye)):A;return ne.core.mutate({trans:De,type:"add",keys:ue,values:Ye,wantResults:we}).then(function(et){var He=et.numFailures,st=et.results,Ve=et.lastResult,et=et.failures;if(He===0)return we?st:Ve;throw new Pe("".concat(ne.name,".bulkAdd(): ").concat(He," of ").concat(Ge," operations failed"),et)})})},Nr.prototype.bulkPut=function(A,D,Z){var ne=this,ue=Array.isArray(D)?D:void 0,we=(Z=Z||(ue?void 0:D))?Z.allKeys:void 0;return this._trans("readwrite",function(De){var Ye=ne.schema.primKey,$e=Ye.auto,Ye=Ye.keyPath;if(Ye&&ue)throw new ke.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(ue&&ue.length!==A.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var Ge=A.length,Ye=Ye&&$e?A.map(rc(Ye)):A;return ne.core.mutate({trans:De,type:"put",keys:ue,values:Ye,wantResults:we}).then(function(et){var He=et.numFailures,st=et.results,Ve=et.lastResult,et=et.failures;if(He===0)return we?st:Ve;throw new Pe("".concat(ne.name,".bulkPut(): ").concat(He," of ").concat(Ge," operations failed"),et)})})},Nr.prototype.bulkUpdate=function(A){var D=this,Z=this.core,ne=A.map(function(De){return De.key}),ue=A.map(function(De){return De.changes}),we=[];return this._trans("readwrite",function(De){return Z.getMany({trans:De,keys:ne,cache:"clone"}).then(function($e){var Ge=[],Ye=[];A.forEach(function(He,st){var Ve=He.key,et=He.changes,ot=$e[st];if(ot){for(var Xe=0,ht=Object.keys(et);Xe<ht.length;Xe++){var bt=ht[Xe],wt=et[bt];if(bt===D.schema.primKey.keyPath){if(Vn(wt,Ve)!==0)throw new ke.Constraint("Cannot update primary key in bulkUpdate()")}else O(ot,bt,wt)}we.push(st),Ge.push(Ve),Ye.push(ot)}});var rt=Ge.length;return Z.mutate({trans:De,type:"put",keys:Ge,values:Ye,updates:{keys:ne,changeSpecs:ue}}).then(function(He){var st=He.numFailures,Ve=He.failures;if(st===0)return rt;for(var et=0,ot=Object.keys(Ve);et<ot.length;et++){var Xe,ht=ot[et],bt=we[Number(ht)];bt!=null&&(Xe=Ve[ht],delete Ve[ht],Ve[bt]=Xe)}throw new Pe("".concat(D.name,".bulkUpdate(): ").concat(st," of ").concat(rt," operations failed"),Ve)})})})},Nr.prototype.bulkDelete=function(A){var D=this,Z=A.length;return this._trans("readwrite",function(ne){return D.core.mutate({trans:ne,type:"delete",keys:A})}).then(function(De){var ue=De.numFailures,we=De.lastResult,De=De.failures;if(ue===0)return we;throw new Pe("".concat(D.name,".bulkDelete(): ").concat(ue," of ").concat(Z," operations failed"),De)})},Nr);function Nr(){}function bo(A){function D(De,$e){if($e){for(var Ge=arguments.length,Ye=new Array(Ge-1);--Ge;)Ye[Ge-1]=arguments[Ge];return Z[De].subscribe.apply(null,Ye),A}if(typeof De=="string")return Z[De]}var Z={};D.addEventType=we;for(var ne=1,ue=arguments.length;ne<ue;++ne)we(arguments[ne]);return D;function we(De,$e,Ge){if(typeof De!="object"){var Ye;$e=$e||te;var rt={subscribers:[],fire:Ge=Ge||Le,subscribe:function(He){rt.subscribers.indexOf(He)===-1&&(rt.subscribers.push(He),rt.fire=$e(rt.fire,He))},unsubscribe:function(He){rt.subscribers=rt.subscribers.filter(function(st){return st!==He}),rt.fire=rt.subscribers.reduce($e,Ge)}};return Z[De]=D[De]=rt}s(Ye=De).forEach(function(He){var st=Ye[He];if(o(st))we(He,Ye[He][0],Ye[He][1]);else{if(st!=="asap")throw new ke.InvalidArgument("Invalid event config");var Ve=we(He,Ie,function(){for(var et=arguments.length,ot=new Array(et);et--;)ot[et]=arguments[et];Ve.subscribers.forEach(function(Xe){k(function(){Xe.apply(null,ot)})})})}})}}function ac(A,D){return b(D).from({prototype:A}),D}function Ms(A,D){return!(A.filter||A.algorithm||A.or)&&(D?A.justLimit:!A.replayFilter)}function Rp(A,D){A.filter=yo(A.filter,D)}function Ja(A,D,Z){var ne=A.replayFilter;A.replayFilter=ne?function(){return yo(ne(),D())}:D,A.justLimit=Z&&!ne}function ic(A,D){if(A.isPrimKey)return D.primaryKey;var Z=D.getIndexByKeyPath(A.index);if(!Z)throw new ke.Schema("KeyPath "+A.index+" on object store "+D.name+" is not indexed");return Z}function Ip(A,D,Z){var ne=ic(A,D.schema);return D.openCursor({trans:Z,values:!A.keysOnly,reverse:A.dir==="prev",unique:!!A.unique,query:{index:ne,range:A.range}})}function sc(A,D,Z,ne){var ue=A.replayFilter?yo(A.filter,A.replayFilter()):A.filter;if(A.or){var we={},De=function($e,Ge,Ye){var rt,He;ue&&!ue(Ge,Ye,function(st){return Ge.stop(st)},function(st){return Ge.fail(st)})||((He=""+(rt=Ge.primaryKey))=="[object ArrayBuffer]"&&(He=""+new Uint8Array(rt)),h(we,He)||(we[He]=!0,D($e,Ge,Ye)))};return Promise.all([A.or._iterate(De,Z),rl(Ip(A,ne,Z),A.algorithm,De,!A.keysOnly&&A.valueMapper)])}return rl(Ip(A,ne,Z),yo(A.algorithm,ue),D,!A.keysOnly&&A.valueMapper)}function rl(A,D,Z,ne){var ue=Ae(ne?function(we,De,$e){return Z(ne(we),De,$e)}:Z);return A.then(function(we){if(we)return we.start(function(){var De=function(){return we.continue()};D&&!D(we,function($e){return De=$e},function($e){we.stop($e),De=Le},function($e){we.fail($e),De=Le})||ue(we.value,we,function($e){return De=$e}),De()})})}var oc=(jp.prototype.execute=function(A){var D=this["@@propmod"];if(D.add!==void 0){var Z=D.add;if(o(Z))return a(a([],o(A)?A:[],!0),Z).sort();if(typeof Z=="number")return(Number(A)||0)+Z;if(typeof Z=="bigint")try{return BigInt(A)+Z}catch{return BigInt(0)+Z}throw new TypeError("Invalid term ".concat(Z))}if(D.remove!==void 0){var ne=D.remove;if(o(ne))return o(A)?A.filter(function(ue){return!ne.includes(ue)}).sort():[];if(typeof ne=="number")return Number(A)-ne;if(typeof ne=="bigint")try{return BigInt(A)-ne}catch{return BigInt(0)-ne}throw new TypeError("Invalid subtrahend ".concat(ne))}return Z=(Z=D.replacePrefix)===null||Z===void 0?void 0:Z[0],Z&&typeof A=="string"&&A.startsWith(Z)?D.replacePrefix[1]+A.substring(Z.length):A},jp);function jp(A){this["@@propmod"]=A}var lc=(er.prototype._read=function(A,D){var Z=this._ctx;return Z.error?Z.table._trans(null,Wr.bind(null,Z.error)):Z.table._trans("readonly",A).then(D)},er.prototype._write=function(A){var D=this._ctx;return D.error?D.table._trans(null,Wr.bind(null,D.error)):D.table._trans("readwrite",A,"locked")},er.prototype._addAlgorithm=function(A){var D=this._ctx;D.algorithm=yo(D.algorithm,A)},er.prototype._iterate=function(A,D){return sc(this._ctx,A,D,this._ctx.table.core)},er.prototype.clone=function(A){var D=Object.create(this.constructor.prototype),Z=Object.create(this._ctx);return A&&l(Z,A),D._ctx=Z,D},er.prototype.raw=function(){return this._ctx.valueMapper=null,this},er.prototype.each=function(A){var D=this._ctx;return this._read(function(Z){return sc(D,A,Z,D.table.core)})},er.prototype.count=function(A){var D=this;return this._read(function(Z){var ne=D._ctx,ue=ne.table.core;if(Ms(ne,!0))return ue.count({trans:Z,query:{index:ic(ne,ue.schema),range:ne.range}}).then(function(De){return Math.min(De,ne.limit)});var we=0;return sc(ne,function(){return++we,!1},Z,ue).then(function(){return we})}).then(A)},er.prototype.sortBy=function(A,D){var Z=A.split(".").reverse(),ne=Z[0],ue=Z.length-1;function we(Ge,Ye){return Ye?we(Ge[Z[Ye]],Ye-1):Ge[ne]}var De=this._ctx.dir==="next"?1:-1;function $e(Ge,Ye){return Vn(we(Ge,ue),we(Ye,ue))*De}return this.toArray(function(Ge){return Ge.sort($e)}).then(D)},er.prototype.toArray=function(A){var D=this;return this._read(function(Z){var ne=D._ctx;if(ne.dir==="next"&&Ms(ne,!0)&&0<ne.limit){var ue=ne.valueMapper,we=ic(ne,ne.table.core.schema);return ne.table.core.query({trans:Z,limit:ne.limit,values:!0,query:{index:we,range:ne.range}}).then(function($e){return $e=$e.result,ue?$e.map(ue):$e})}var De=[];return sc(ne,function($e){return De.push($e)},Z,ne.table.core).then(function(){return De})},A)},er.prototype.offset=function(A){var D=this._ctx;return A<=0||(D.offset+=A,Ms(D)?Ja(D,function(){var Z=A;return function(ne,ue){return Z===0||(Z===1?--Z:ue(function(){ne.advance(Z),Z=0}),!1)}}):Ja(D,function(){var Z=A;return function(){return--Z<0}})),this},er.prototype.limit=function(A){return this._ctx.limit=Math.min(this._ctx.limit,A),Ja(this._ctx,function(){var D=A;return function(Z,ne,ue){return--D<=0&&ne(ue),0<=D}},!0),this},er.prototype.until=function(A,D){return Rp(this._ctx,function(Z,ne,ue){return!A(Z.value)||(ne(ue),D)}),this},er.prototype.first=function(A){return this.limit(1).toArray(function(D){return D[0]}).then(A)},er.prototype.last=function(A){return this.reverse().first(A)},er.prototype.filter=function(A){var D;return Rp(this._ctx,function(Z){return A(Z.value)}),(D=this._ctx).isMatch=yo(D.isMatch,A),this},er.prototype.and=function(A){return this.filter(A)},er.prototype.or=function(A){return new this.db.WhereClause(this._ctx.table,A,this)},er.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},er.prototype.desc=function(){return this.reverse()},er.prototype.eachKey=function(A){var D=this._ctx;return D.keysOnly=!D.isMatch,this.each(function(Z,ne){A(ne.key,ne)})},er.prototype.eachUniqueKey=function(A){return this._ctx.unique="unique",this.eachKey(A)},er.prototype.eachPrimaryKey=function(A){var D=this._ctx;return D.keysOnly=!D.isMatch,this.each(function(Z,ne){A(ne.primaryKey,ne)})},er.prototype.keys=function(A){var D=this._ctx;D.keysOnly=!D.isMatch;var Z=[];return this.each(function(ne,ue){Z.push(ue.key)}).then(function(){return Z}).then(A)},er.prototype.primaryKeys=function(A){var D=this._ctx;if(D.dir==="next"&&Ms(D,!0)&&0<D.limit)return this._read(function(ne){var ue=ic(D,D.table.core.schema);return D.table.core.query({trans:ne,values:!1,limit:D.limit,query:{index:ue,range:D.range}})}).then(function(ne){return ne.result}).then(A);D.keysOnly=!D.isMatch;var Z=[];return this.each(function(ne,ue){Z.push(ue.primaryKey)}).then(function(){return Z}).then(A)},er.prototype.uniqueKeys=function(A){return this._ctx.unique="unique",this.keys(A)},er.prototype.firstKey=function(A){return this.limit(1).keys(function(D){return D[0]}).then(A)},er.prototype.lastKey=function(A){return this.reverse().firstKey(A)},er.prototype.distinct=function(){var A=this._ctx,A=A.index&&A.table.schema.idxByName[A.index];if(!A||!A.multi)return this;var D={};return Rp(this._ctx,function(ue){var ne=ue.primaryKey.toString(),ue=h(D,ne);return D[ne]=!0,!ue}),this},er.prototype.modify=function(A){var D=this,Z=this._ctx;return this._write(function(ne){var ue,we,De;De=typeof A=="function"?A:(ue=s(A),we=ue.length,function(Xe){for(var ht=!1,bt=0;bt<we;++bt){var wt=ue[bt],Et=A[wt],Ut=R(Xe,wt);Et instanceof oc?(O(Xe,wt,Et.execute(Ut)),ht=!0):Ut!==Et&&(O(Xe,wt,Et),ht=!0)}return ht});var $e=Z.table.core,He=$e.schema.primaryKey,Ge=He.outbound,Ye=He.extractKey,rt=200,He=D.db._options.modifyChunkSize;He&&(rt=typeof He=="object"?He[$e.name]||He["*"]||200:He);function st(Xe,wt){var bt=wt.failures,wt=wt.numFailures;et+=Xe-wt;for(var Et=0,Ut=s(bt);Et<Ut.length;Et++){var Kt=Ut[Et];Ve.push(bt[Kt])}}var Ve=[],et=0,ot=[];return D.clone().primaryKeys().then(function(Xe){function ht(wt){var Et=Math.min(rt,Xe.length-wt);return $e.getMany({trans:ne,keys:Xe.slice(wt,wt+Et),cache:"immutable"}).then(function(Ut){for(var Kt=[],$t=[],Ht=Ge?[]:null,Zt=[],Bt=0;Bt<Et;++Bt){var tn=Ut[Bt],pn={value:K(tn),primKey:Xe[wt+Bt]};De.call(pn,pn.value,pn)!==!1&&(pn.value==null?Zt.push(Xe[wt+Bt]):Ge||Vn(Ye(tn),Ye(pn.value))===0?($t.push(pn.value),Ge&&Ht.push(Xe[wt+Bt])):(Zt.push(Xe[wt+Bt]),Kt.push(pn.value)))}return Promise.resolve(0<Kt.length&&$e.mutate({trans:ne,type:"add",values:Kt}).then(function(gn){for(var Nn in gn.failures)Zt.splice(parseInt(Nn),1);st(Kt.length,gn)})).then(function(){return(0<$t.length||bt&&typeof A=="object")&&$e.mutate({trans:ne,type:"put",keys:Ht,values:$t,criteria:bt,changeSpec:typeof A!="function"&&A,isAdditionalChunk:0<wt}).then(function(gn){return st($t.length,gn)})}).then(function(){return(0<Zt.length||bt&&A===df)&&$e.mutate({trans:ne,type:"delete",keys:Zt,criteria:bt,isAdditionalChunk:0<wt}).then(function(gn){return st(Zt.length,gn)})}).then(function(){return Xe.length>wt+Et&&ht(wt+rt)})})}var bt=Ms(Z)&&Z.limit===1/0&&(typeof A!="function"||A===df)&&{index:Z.index,range:Z.range};return ht(0).then(function(){if(0<Ve.length)throw new xe("Error modifying one or more objects",Ve,et,ot);return Xe.length})})})},er.prototype.delete=function(){var A=this._ctx,D=A.range;return Ms(A)&&(A.isPrimKey||D.type===3)?this._write(function(Z){var ne=A.table.core.schema.primaryKey,ue=D;return A.table.core.count({trans:Z,query:{index:ne,range:ue}}).then(function(we){return A.table.core.mutate({trans:Z,type:"deleteRange",range:ue}).then(function(De){var $e=De.failures;if(De.lastResult,De.results,De=De.numFailures,De)throw new xe("Could not delete some values",Object.keys($e).map(function(Ge){return $e[Ge]}),we-De);return we-De})})}):this.modify(df)},er);function er(){}var df=function(A,D){return D.value=null};function ry(A,D){return A<D?-1:A===D?0:1}function Op(A,D){return D<A?-1:A===D?0:1}function mi(A,D,Z){return A=A instanceof il?new A.Collection(A):A,A._ctx.error=new(Z||TypeError)(D),A}function cc(A){return new A.Collection(A,function(){return ff("")}).limit(0)}function al(A,D,Z,ne){var ue,we,De,$e,Ge,Ye,rt,He=Z.length;if(!Z.every(function(et){return typeof et=="string"}))return mi(A,ny);function st(et){ue=et==="next"?function(Xe){return Xe.toUpperCase()}:function(Xe){return Xe.toLowerCase()},we=et==="next"?function(Xe){return Xe.toLowerCase()}:function(Xe){return Xe.toUpperCase()},De=et==="next"?ry:Op;var ot=Z.map(function(Xe){return{lower:we(Xe),upper:ue(Xe)}}).sort(function(Xe,ht){return De(Xe.lower,ht.lower)});$e=ot.map(function(Xe){return Xe.upper}),Ge=ot.map(function(Xe){return Xe.lower}),rt=(Ye=et)==="next"?"":ne}st("next"),A=new A.Collection(A,function(){return os($e[0],Ge[He-1]+ne)}),A._ondirectionchange=function(et){st(et)};var Ve=0;return A._addAlgorithm(function(et,ot,Xe){var ht=et.key;if(typeof ht!="string")return!1;var bt=we(ht);if(D(bt,Ge,Ve))return!0;for(var wt=null,Et=Ve;Et<He;++Et){var Ut=function(Kt,$t,Ht,Zt,Bt,tn){for(var pn=Math.min(Kt.length,Zt.length),gn=-1,Nn=0;Nn<pn;++Nn){var Ha=$t[Nn];if(Ha!==Zt[Nn])return Bt(Kt[Nn],Ht[Nn])<0?Kt.substr(0,Nn)+Ht[Nn]+Ht.substr(Nn+1):Bt(Kt[Nn],Zt[Nn])<0?Kt.substr(0,Nn)+Zt[Nn]+Ht.substr(Nn+1):0<=gn?Kt.substr(0,gn)+$t[gn]+Ht.substr(gn+1):null;Bt(Kt[Nn],Ha)<0&&(gn=Nn)}return pn<Zt.length&&tn==="next"?Kt+Ht.substr(Kt.length):pn<Kt.length&&tn==="prev"?Kt.substr(0,Ht.length):gn<0?null:Kt.substr(0,gn)+Zt[gn]+Ht.substr(gn+1)}(ht,bt,$e[Et],Ge[Et],De,Ye);Ut===null&&wt===null?Ve=Et+1:(wt===null||0<De(wt,Ut))&&(wt=Ut)}return ot(wt!==null?function(){et.continue(wt+rt)}:Xe),!1}),A}function os(A,D,Z,ne){return{type:2,lower:A,upper:D,lowerOpen:Z,upperOpen:ne}}function ff(A){return{type:1,lower:A,upper:A}}var il=(Object.defineProperty(Lr.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Lr.prototype.between=function(A,D,Z,ne){Z=Z!==!1,ne=ne===!0;try{return 0<this._cmp(A,D)||this._cmp(A,D)===0&&(Z||ne)&&(!Z||!ne)?cc(this):new this.Collection(this,function(){return os(A,D,!Z,!ne)})}catch{return mi(this,ss)}},Lr.prototype.equals=function(A){return A==null?mi(this,ss):new this.Collection(this,function(){return ff(A)})},Lr.prototype.above=function(A){return A==null?mi(this,ss):new this.Collection(this,function(){return os(A,void 0,!0)})},Lr.prototype.aboveOrEqual=function(A){return A==null?mi(this,ss):new this.Collection(this,function(){return os(A,void 0,!1)})},Lr.prototype.below=function(A){return A==null?mi(this,ss):new this.Collection(this,function(){return os(void 0,A,!1,!0)})},Lr.prototype.belowOrEqual=function(A){return A==null?mi(this,ss):new this.Collection(this,function(){return os(void 0,A)})},Lr.prototype.startsWith=function(A){return typeof A!="string"?mi(this,ny):this.between(A,A+go,!0,!0)},Lr.prototype.startsWithIgnoreCase=function(A){return A===""?this.startsWith(A):al(this,function(D,Z){return D.indexOf(Z[0])===0},[A],go)},Lr.prototype.equalsIgnoreCase=function(A){return al(this,function(D,Z){return D===Z[0]},[A],"")},Lr.prototype.anyOfIgnoreCase=function(){var A=B.apply(ae,arguments);return A.length===0?cc(this):al(this,function(D,Z){return Z.indexOf(D)!==-1},A,"")},Lr.prototype.startsWithAnyOfIgnoreCase=function(){var A=B.apply(ae,arguments);return A.length===0?cc(this):al(this,function(D,Z){return Z.some(function(ne){return D.indexOf(ne)===0})},A,go)},Lr.prototype.anyOf=function(){var A=this,D=B.apply(ae,arguments),Z=this._cmp;try{D.sort(Z)}catch{return mi(this,ss)}if(D.length===0)return cc(this);var ne=new this.Collection(this,function(){return os(D[0],D[D.length-1])});ne._ondirectionchange=function(we){Z=we==="next"?A._ascending:A._descending,D.sort(Z)};var ue=0;return ne._addAlgorithm(function(we,De,$e){for(var Ge=we.key;0<Z(Ge,D[ue]);)if(++ue===D.length)return De($e),!1;return Z(Ge,D[ue])===0||(De(function(){we.continue(D[ue])}),!1)}),ne},Lr.prototype.notEqual=function(A){return this.inAnyRange([[-1/0,A],[A,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Lr.prototype.noneOf=function(){var A=B.apply(ae,arguments);if(A.length===0)return new this.Collection(this);try{A.sort(this._ascending)}catch{return mi(this,ss)}var D=A.reduce(function(Z,ne){return Z?Z.concat([[Z[Z.length-1][1],ne]]):[[-1/0,ne]]},null);return D.push([A[A.length-1],this.db._maxKey]),this.inAnyRange(D,{includeLowers:!1,includeUppers:!1})},Lr.prototype.inAnyRange=function(ht,D){var Z=this,ne=this._cmp,ue=this._ascending,we=this._descending,De=this._min,$e=this._max;if(ht.length===0)return cc(this);if(!ht.every(function(bt){return bt[0]!==void 0&&bt[1]!==void 0&&ue(bt[0],bt[1])<=0}))return mi(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ke.InvalidArgument);var Ge=!D||D.includeLowers!==!1,Ye=D&&D.includeUppers===!0,rt,He=ue;function st(bt,wt){return He(bt[0],wt[0])}try{(rt=ht.reduce(function(bt,wt){for(var Et=0,Ut=bt.length;Et<Ut;++Et){var Kt=bt[Et];if(ne(wt[0],Kt[1])<0&&0<ne(wt[1],Kt[0])){Kt[0]=De(Kt[0],wt[0]),Kt[1]=$e(Kt[1],wt[1]);break}}return Et===Ut&&bt.push(wt),bt},[])).sort(st)}catch{return mi(this,ss)}var Ve=0,et=Ye?function(bt){return 0<ue(bt,rt[Ve][1])}:function(bt){return 0<=ue(bt,rt[Ve][1])},ot=Ge?function(bt){return 0<we(bt,rt[Ve][0])}:function(bt){return 0<=we(bt,rt[Ve][0])},Xe=et,ht=new this.Collection(this,function(){return os(rt[0][0],rt[rt.length-1][1],!Ge,!Ye)});return ht._ondirectionchange=function(bt){He=bt==="next"?(Xe=et,ue):(Xe=ot,we),rt.sort(st)},ht._addAlgorithm(function(bt,wt,Et){for(var Ut,Kt=bt.key;Xe(Kt);)if(++Ve===rt.length)return wt(Et),!1;return!et(Ut=Kt)&&!ot(Ut)||(Z._cmp(Kt,rt[Ve][1])===0||Z._cmp(Kt,rt[Ve][0])===0||wt(function(){He===ue?bt.continue(rt[Ve][0]):bt.continue(rt[Ve][1])}),!1)}),ht},Lr.prototype.startsWithAnyOf=function(){var A=B.apply(ae,arguments);return A.every(function(D){return typeof D=="string"})?A.length===0?cc(this):this.inAnyRange(A.map(function(D){return[D,D+go]})):mi(this,"startsWithAnyOf() only works with strings")},Lr);function Lr(){}function Ui(A){return Ae(function(D){return sl(D),A(D.target.error),!1})}function sl(A){A.stopPropagation&&A.stopPropagation(),A.preventDefault&&A.preventDefault()}var uc="storagemutated",ol="x-storagemutated-1",Ta=bo(null,uc),Dp=(Qa.prototype._lock=function(){return C(!Ce.global),++this._reculock,this._reculock!==1||Ce.global||(Ce.lockOwnerFor=this),this},Qa.prototype._unlock=function(){if(C(!Ce.global),--this._reculock==0)for(Ce.global||(Ce.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var A=this._blockedFuncs.shift();try{ho(A[1],A[0])}catch{}}return this},Qa.prototype._locked=function(){return this._reculock&&Ce.lockOwnerFor!==this},Qa.prototype.create=function(A){var D=this;if(!this.mode)return this;var Z=this.db.idbdb,ne=this.db._state.dbOpenError;if(C(!this.idbtrans),!A&&!Z)switch(ne&&ne.name){case"DatabaseClosedError":throw new ke.DatabaseClosed(ne);case"MissingAPIError":throw new ke.MissingAPI(ne.message,ne);default:throw new ke.OpenFailed(ne)}if(!this.active)throw new ke.TransactionInactive;return C(this._completion._state===null),(A=this.idbtrans=A||(this.db.core||Z).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ae(function(ue){sl(ue),D._reject(A.error)}),A.onabort=Ae(function(ue){sl(ue),D.active&&D._reject(new ke.Abort(A.error)),D.active=!1,D.on("abort").fire(ue)}),A.oncomplete=Ae(function(){D.active=!1,D._resolve(),"mutatedParts"in A&&Ta.storagemutated.fire(A.mutatedParts)}),this},Qa.prototype._promise=function(A,D,Z){var ne=this;if(A==="readwrite"&&this.mode!=="readwrite")return Wr(new ke.ReadOnly("Transaction is readonly"));if(!this.active)return Wr(new ke.TransactionInactive);if(this._locked())return new M(function(we,De){ne._blockedFuncs.push([function(){ne._promise(A,D,Z).then(we,De)},Ce])});if(Z)return Jt(function(){var we=new M(function(De,$e){ne._lock();var Ge=D(De,$e,ne);Ge&&Ge.then&&Ge.then(De,$e)});return we.finally(function(){return ne._unlock()}),we._lib=!0,we});var ue=new M(function(we,De){var $e=D(we,De,ne);$e&&$e.then&&$e.then(we,De)});return ue._lib=!0,ue},Qa.prototype._root=function(){return this.parent?this.parent._root():this},Qa.prototype.waitFor=function(A){var D,Z=this._root(),ne=M.resolve(A);Z._waitingFor?Z._waitingFor=Z._waitingFor.then(function(){return ne}):(Z._waitingFor=ne,Z._waitingQueue=[],D=Z.idbtrans.objectStore(Z.storeNames[0]),function we(){for(++Z._spinCount;Z._waitingQueue.length;)Z._waitingQueue.shift()();Z._waitingFor&&(D.get(-1/0).onsuccess=we)}());var ue=Z._waitingFor;return new M(function(we,De){ne.then(function($e){return Z._waitingQueue.push(Ae(we.bind(null,$e)))},function($e){return Z._waitingQueue.push(Ae(De.bind(null,$e)))}).finally(function(){Z._waitingFor===ue&&(Z._waitingFor=null)})})},Qa.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ke.Abort))},Qa.prototype.table=function(A){var D=this._memoizedTables||(this._memoizedTables={});if(h(D,A))return D[A];var Z=this.schema[A];if(!Z)throw new ke.NotFound("Table "+A+" not part of transaction");return Z=new this.db.Table(A,Z,this),Z.core=this.db.core.table(A),D[A]=Z},Qa);function Qa(){}function ls(A,D,Z,ne,ue,we,De){return{name:A,keyPath:D,unique:Z,multi:ne,auto:ue,compound:we,src:(Z&&!De?"&":"")+(ne?"*":"")+(ue?"++":"")+hf(D)}}function hf(A){return typeof A=="string"?A:A?"["+[].join.call(A,"+")+"]":""}function dc(A,D,Z){return{name:A,primKey:D,indexes:Z,mappedClass:null,idxByName:(ne=function(ue){return[ue.name,ue]},Z.reduce(function(ue,we,De){return De=ne(we,De),De&&(ue[De[0]]=De[1]),ue},{}))};var ne}var fc=function(A){try{return A.only([[]]),fc=function(){return[[]]},[[]]}catch{return fc=function(){return go},go}};function hc(A){return A==null?function(){}:typeof A=="string"?(D=A).split(".").length===1?function(Z){return Z[D]}:function(Z){return R(Z,D)}:function(Z){return R(Z,A)};var D}function Uu(A){return[].slice.call(A)}var ay=0;function la(A){return A==null?":id":typeof A=="string"?A:"[".concat(A.join("+"),"]")}function ll(A,D,Ge){function ne(Xe){if(Xe.type===3)return null;if(Xe.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Ve=Xe.lower,et=Xe.upper,ot=Xe.lowerOpen,Xe=Xe.upperOpen;return Ve===void 0?et===void 0?null:D.upperBound(et,!!Xe):et===void 0?D.lowerBound(Ve,!!ot):D.bound(Ve,et,!!ot,!!Xe)}function ue(st){var Ve,et=st.name;return{name:et,schema:st,mutate:function(ot){var Xe=ot.trans,ht=ot.type,bt=ot.keys,wt=ot.values,Et=ot.range;return new Promise(function(Ut,Kt){Ut=Ae(Ut);var $t=Xe.objectStore(et),Ht=$t.keyPath==null,Zt=ht==="put"||ht==="add";if(!Zt&&ht!=="delete"&&ht!=="deleteRange")throw new Error("Invalid operation type: "+ht);var Bt,tn=(bt||wt||{length:1}).length;if(bt&&wt&&bt.length!==wt.length)throw new Error("Given keys array must have same length as given values array.");if(tn===0)return Ut({numFailures:0,failures:{},results:[],lastResult:void 0});function pn(Na){++Ha,sl(Na)}var gn=[],Nn=[],Ha=0;if(ht==="deleteRange"){if(Et.type===4)return Ut({numFailures:Ha,failures:Nn,results:[],lastResult:void 0});Et.type===3?gn.push(Bt=$t.clear()):gn.push(Bt=$t.delete(ne(Et)))}else{var Ht=Zt?Ht?[wt,bt]:[wt,null]:[bt,null],_n=Ht[0],ra=Ht[1];if(Zt)for(var ca=0;ca<tn;++ca)gn.push(Bt=ra&&ra[ca]!==void 0?$t[ht](_n[ca],ra[ca]):$t[ht](_n[ca])),Bt.onerror=pn;else for(ca=0;ca<tn;++ca)gn.push(Bt=$t[ht](_n[ca])),Bt.onerror=pn}function Ps(Na){Na=Na.target.result,gn.forEach(function(us,_o){return us.error!=null&&(Nn[_o]=us.error)}),Ut({numFailures:Ha,failures:Nn,results:ht==="delete"?bt:gn.map(function(us){return us.result}),lastResult:Na})}Bt.onerror=function(Na){pn(Na),Ps(Na)},Bt.onsuccess=Ps})},getMany:function(ot){var Xe=ot.trans,ht=ot.keys;return new Promise(function(bt,wt){bt=Ae(bt);for(var Et,Ut=Xe.objectStore(et),Kt=ht.length,$t=new Array(Kt),Ht=0,Zt=0,Bt=function(gn){gn=gn.target,$t[gn._pos]=gn.result,++Zt===Ht&&bt($t)},tn=Ui(wt),pn=0;pn<Kt;++pn)ht[pn]!=null&&((Et=Ut.get(ht[pn]))._pos=pn,Et.onsuccess=Bt,Et.onerror=tn,++Ht);Ht===0&&bt($t)})},get:function(ot){var Xe=ot.trans,ht=ot.key;return new Promise(function(bt,wt){bt=Ae(bt);var Et=Xe.objectStore(et).get(ht);Et.onsuccess=function(Ut){return bt(Ut.target.result)},Et.onerror=Ui(wt)})},query:(Ve=Ye,function(ot){return new Promise(function(Xe,ht){Xe=Ae(Xe);var bt,wt,Et,Ht=ot.trans,Ut=ot.values,Kt=ot.limit,Bt=ot.query,$t=Kt===1/0?void 0:Kt,Zt=Bt.index,Bt=Bt.range,Ht=Ht.objectStore(et),Zt=Zt.isPrimaryKey?Ht:Ht.index(Zt.name),Bt=ne(Bt);if(Kt===0)return Xe({result:[]});Ve?(($t=Ut?Zt.getAll(Bt,$t):Zt.getAllKeys(Bt,$t)).onsuccess=function(tn){return Xe({result:tn.target.result})},$t.onerror=Ui(ht)):(bt=0,wt=!Ut&&"openKeyCursor"in Zt?Zt.openKeyCursor(Bt):Zt.openCursor(Bt),Et=[],wt.onsuccess=function(tn){var pn=wt.result;return pn?(Et.push(Ut?pn.value:pn.primaryKey),++bt===Kt?Xe({result:Et}):void pn.continue()):Xe({result:Et})},wt.onerror=Ui(ht))})}),openCursor:function(ot){var Xe=ot.trans,ht=ot.values,bt=ot.query,wt=ot.reverse,Et=ot.unique;return new Promise(function(Ut,Kt){Ut=Ae(Ut);var Zt=bt.index,$t=bt.range,Ht=Xe.objectStore(et),Ht=Zt.isPrimaryKey?Ht:Ht.index(Zt.name),Zt=wt?Et?"prevunique":"prev":Et?"nextunique":"next",Bt=!ht&&"openKeyCursor"in Ht?Ht.openKeyCursor(ne($t),Zt):Ht.openCursor(ne($t),Zt);Bt.onerror=Ui(Kt),Bt.onsuccess=Ae(function(tn){var pn,gn,Nn,Ha,_n=Bt.result;_n?(_n.___id=++ay,_n.done=!1,pn=_n.continue.bind(_n),gn=(gn=_n.continuePrimaryKey)&&gn.bind(_n),Nn=_n.advance.bind(_n),Ha=function(){throw new Error("Cursor not stopped")},_n.trans=Xe,_n.stop=_n.continue=_n.continuePrimaryKey=_n.advance=function(){throw new Error("Cursor not started")},_n.fail=Ae(Kt),_n.next=function(){var ra=this,ca=1;return this.start(function(){return ca--?ra.continue():ra.stop()}).then(function(){return ra})},_n.start=function(ra){function ca(){if(Bt.result)try{ra()}catch(Na){_n.fail(Na)}else _n.done=!0,_n.start=function(){throw new Error("Cursor behind last entry")},_n.stop()}var Ps=new Promise(function(Na,us){Na=Ae(Na),Bt.onerror=Ui(us),_n.fail=us,_n.stop=function(_o){_n.stop=_n.continue=_n.continuePrimaryKey=_n.advance=Ha,Na(_o)}});return Bt.onsuccess=Ae(function(Na){Bt.onsuccess=ca,ca()}),_n.continue=pn,_n.continuePrimaryKey=gn,_n.advance=Nn,ca(),Ps},Ut(_n)):Ut(null)},Kt)})},count:function(ot){var Xe=ot.query,ht=ot.trans,bt=Xe.index,wt=Xe.range;return new Promise(function(Et,Ut){var Kt=ht.objectStore(et),$t=bt.isPrimaryKey?Kt:Kt.index(bt.name),Kt=ne(wt),$t=Kt?$t.count(Kt):$t.count();$t.onsuccess=Ae(function(Ht){return Et(Ht.target.result)}),$t.onerror=Ui(Ut)})}}}var we,De,$e,rt=(De=Ge,$e=Uu((we=A).objectStoreNames),{schema:{name:we.name,tables:$e.map(function(st){return De.objectStore(st)}).map(function(st){var Ve=st.keyPath,Xe=st.autoIncrement,et=o(Ve),ot={},Xe={name:st.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Ve==null,compound:et,keyPath:Ve,autoIncrement:Xe,unique:!0,extractKey:hc(Ve)},indexes:Uu(st.indexNames).map(function(ht){return st.index(ht)}).map(function(Et){var bt=Et.name,wt=Et.unique,Ut=Et.multiEntry,Et=Et.keyPath,Ut={name:bt,compound:o(Et),keyPath:Et,unique:wt,multiEntry:Ut,extractKey:hc(Et)};return ot[la(Et)]=Ut}),getIndexByKeyPath:function(ht){return ot[la(ht)]}};return ot[":id"]=Xe.primaryKey,Ve!=null&&(ot[la(Ve)]=Xe.primaryKey),Xe})},hasGetAll:0<$e.length&&"getAll"in De.objectStore($e[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),Ge=rt.schema,Ye=rt.hasGetAll,rt=Ge.tables.map(ue),He={};return rt.forEach(function(st){return He[st.name]=st}),{stack:"dbcore",transaction:A.transaction.bind(A),table:function(st){if(!He[st])throw new Error("Table '".concat(st,"' not found"));return He[st]},MIN_KEY:-1/0,MAX_KEY:fc(D),schema:Ge}}function pf(A,D,Z,ne){var ue=Z.IDBKeyRange;return Z.indexedDB,{dbcore:(ne=ll(D,ue,ne),A.dbcore.reduce(function(we,De){return De=De.create,r(r({},we),De(we))},ne))}}function vo(A,ne){var Z=ne.db,ne=pf(A._middlewares,Z,A._deps,ne);A.core=ne.dbcore,A.tables.forEach(function(ue){var we=ue.name;A.core.schema.tables.some(function(De){return De.name===we})&&(ue.core=A.core.table(we),A[we]instanceof A.Table&&(A[we].core=ue.core))})}function mf(A,D,Z,ne){Z.forEach(function(ue){var we=ne[ue];D.forEach(function(De){var $e=function Ge(Ye,rt){return w(Ye,rt)||(Ye=u(Ye))&&Ge(Ye,rt)}(De,ue);(!$e||"value"in $e&&$e.value===void 0)&&(De===A.Transaction.prototype||De instanceof A.Transaction?v(De,ue,{get:function(){return this.table(ue)},set:function(Ge){y(this,ue,{value:Ge,writable:!0,configurable:!0,enumerable:!0})}}):De[ue]=new A.Table(ue,we))})})}function qu(A,D){D.forEach(function(Z){for(var ne in Z)Z[ne]instanceof A.Table&&delete Z[ne]})}function Mp(A,D){return A._cfg.version-D._cfg.version}function Hu(A,D,Z,ne){var ue=A._dbSchema;Z.objectStoreNames.contains("$meta")&&!ue.$meta&&(ue.$meta=dc("$meta",sy("")[0],[]),A._storeNames.push("$meta"));var we=A._createTransaction("readwrite",A._storeNames,ue);we.create(Z),we._completion.catch(ne);var De=we._reject.bind(we),$e=Ce.transless||Ce;Jt(function(){return Ce.trans=we,Ce.transless=$e,D!==0?(vo(A,Z),Ye=D,((Ge=we).storeNames.includes("$meta")?Ge.table("$meta").get("version").then(function(rt){return rt??Ye}):M.resolve(Ye)).then(function(rt){return st=rt,Ve=we,et=Z,ot=[],rt=(He=A)._versions,Xe=He._dbSchema=pc(0,He.idbdb,et),(rt=rt.filter(function(ht){return ht._cfg.version>=st})).length!==0?(rt.forEach(function(ht){ot.push(function(){var bt=Xe,wt=ht._cfg.dbschema;vf(He,bt,et),vf(He,wt,et),Xe=He._dbSchema=wt;var Et=yf(bt,wt);Et.add.forEach(function(Zt){Pp(et,Zt[0],Zt[1].primKey,Zt[1].indexes)}),Et.change.forEach(function(Zt){if(Zt.recreate)throw new ke.Upgrade("Not yet support for changing primary key");var Bt=et.objectStore(Zt.name);Zt.add.forEach(function(tn){return bf(Bt,tn)}),Zt.change.forEach(function(tn){Bt.deleteIndex(tn.name),bf(Bt,tn)}),Zt.del.forEach(function(tn){return Bt.deleteIndex(tn)})});var Ut=ht._cfg.contentUpgrade;if(Ut&&ht._cfg.version>st){vo(He,et),Ve._memoizedTables={};var Kt=j(wt);Et.del.forEach(function(Zt){Kt[Zt]=bt[Zt]}),qu(He,[He.Transaction.prototype]),mf(He,[He.Transaction.prototype],s(Kt),Kt),Ve.schema=Kt;var $t,Ht=J(Ut);return Ht&&An(),Et=M.follow(function(){var Zt;($t=Ut(Ve))&&Ht&&(Zt=Hn.bind(null,null),$t.then(Zt,Zt))}),$t&&typeof $t.then=="function"?M.resolve($t):Et.then(function(){return $t})}}),ot.push(function(bt){var wt,Et,Ut=ht._cfg.dbschema;wt=Ut,Et=bt,[].slice.call(Et.db.objectStoreNames).forEach(function(Kt){return wt[Kt]==null&&Et.db.deleteObjectStore(Kt)}),qu(He,[He.Transaction.prototype]),mf(He,[He.Transaction.prototype],He._storeNames,He._dbSchema),Ve.schema=He._dbSchema}),ot.push(function(bt){He.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(He.idbdb.version/10)===ht._cfg.version?(He.idbdb.deleteObjectStore("$meta"),delete He._dbSchema.$meta,He._storeNames=He._storeNames.filter(function(wt){return wt!=="$meta"})):bt.objectStore("$meta").put(ht._cfg.version,"version"))})}),function ht(){return ot.length?M.resolve(ot.shift()(Ve.idbtrans)).then(ht):M.resolve()}().then(function(){iy(Xe,et)})):M.resolve();var He,st,Ve,et,ot,Xe}).catch(De)):(s(ue).forEach(function(rt){Pp(Z,rt,ue[rt].primKey,ue[rt].indexes)}),vo(A,Z),void M.follow(function(){return A.on.populate.fire(we)}).catch(De));var Ge,Ye})}function gf(A,D){iy(A._dbSchema,D),D.db.version%10!=0||D.objectStoreNames.contains("$meta")||D.db.createObjectStore("$meta").add(Math.ceil(D.db.version/10-1),"version");var Z=pc(0,A.idbdb,D);vf(A,A._dbSchema,D);for(var ne=0,ue=yf(Z,A._dbSchema).change;ne<ue.length;ne++){var we=function(De){if(De.change.length||De.recreate)return console.warn("Unable to patch indexes of table ".concat(De.name," because it has changes on the type of index or primary key.")),{value:void 0};var $e=D.objectStore(De.name);De.add.forEach(function(Ge){Me&&console.debug("Dexie upgrade patch: Creating missing index ".concat(De.name,".").concat(Ge.src)),bf($e,Ge)})}(ue[ne]);if(typeof we=="object")return we.value}}function yf(A,D){var Z,ne={del:[],add:[],change:[]};for(Z in A)D[Z]||ne.del.push(Z);for(Z in D){var ue=A[Z],we=D[Z];if(ue){var De={name:Z,def:we,recreate:!1,del:[],add:[],change:[]};if(""+(ue.primKey.keyPath||"")!=""+(we.primKey.keyPath||"")||ue.primKey.auto!==we.primKey.auto)De.recreate=!0,ne.change.push(De);else{var $e=ue.idxByName,Ge=we.idxByName,Ye=void 0;for(Ye in $e)Ge[Ye]||De.del.push(Ye);for(Ye in Ge){var rt=$e[Ye],He=Ge[Ye];rt?rt.src!==He.src&&De.change.push(He):De.add.push(He)}(0<De.del.length||0<De.add.length||0<De.change.length)&&ne.change.push(De)}}else ne.add.push([Z,we])}return ne}function Pp(A,D,Z,ne){var ue=A.db.createObjectStore(D,Z.keyPath?{keyPath:Z.keyPath,autoIncrement:Z.auto}:{autoIncrement:Z.auto});return ne.forEach(function(we){return bf(ue,we)}),ue}function iy(A,D){s(A).forEach(function(Z){D.db.objectStoreNames.contains(Z)||(Me&&console.debug("Dexie: Creating missing table",Z),Pp(D,Z,A[Z].primKey,A[Z].indexes))})}function bf(A,D){A.createIndex(D.name,D.keyPath,{unique:D.unique,multiEntry:D.multi})}function pc(A,D,Z){var ne={};return S(D.objectStoreNames,0).forEach(function(ue){for(var we=Z.objectStore(ue),De=ls(hf(Ye=we.keyPath),Ye||"",!0,!1,!!we.autoIncrement,Ye&&typeof Ye!="string",!0),$e=[],Ge=0;Ge<we.indexNames.length;++Ge){var rt=we.index(we.indexNames[Ge]),Ye=rt.keyPath,rt=ls(rt.name,Ye,!!rt.unique,!!rt.multiEntry,!1,Ye&&typeof Ye!="string",!1);$e.push(rt)}ne[ue]=dc(ue,De,$e)}),ne}function vf(A,D,Z){for(var ne=Z.db.objectStoreNames,ue=0;ue<ne.length;++ue){var we=ne[ue],De=Z.objectStore(we);A._hasGetAll="getAll"in De;for(var $e=0;$e<De.indexNames.length;++$e){var Ge=De.indexNames[$e],Ye=De.index(Ge).keyPath,rt=typeof Ye=="string"?Ye:"["+S(Ye).join("+")+"]";!D[we]||(Ye=D[we].idxByName[rt])&&(Ye.name=Ge,delete D[we].idxByName[rt],D[we].idxByName[Ge]=Ye)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(A._hasGetAll=!1)}function sy(A){return A.split(",").map(function(D,Z){var ne=(D=D.trim()).replace(/([&*]|\+\+)/g,""),ue=/^\[/.test(ne)?ne.match(/^\[(.*)\]$/)[1].split("+"):ne;return ls(ne,ue||null,/\&/.test(D),/\*/.test(D),/\+\+/.test(D),o(ue),Z===0)})}var i1=(wf.prototype._parseStoresSpec=function(A,D){s(A).forEach(function(Z){if(A[Z]!==null){var ne=sy(A[Z]),ue=ne.shift();if(ue.unique=!0,ue.multi)throw new ke.Schema("Primary key cannot be multi-valued");ne.forEach(function(we){if(we.auto)throw new ke.Schema("Only primary key can be marked as autoIncrement (++)");if(!we.keyPath)throw new ke.Schema("Index must have a name and cannot be an empty string")}),D[Z]=dc(Z,ue,ne)}})},wf.prototype.stores=function(Z){var D=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,Z):Z;var Z=D._versions,ne={},ue={};return Z.forEach(function(we){l(ne,we._cfg.storesSource),ue=we._cfg.dbschema={},we._parseStoresSpec(ne,ue)}),D._dbSchema=ue,qu(D,[D._allTables,D,D.Transaction.prototype]),mf(D,[D._allTables,D,D.Transaction.prototype,this._cfg.tables],s(ue),ue),D._storeNames=s(ue),this},wf.prototype.upgrade=function(A){return this._cfg.contentUpgrade=_e(this._cfg.contentUpgrade||Le,A),this},wf);function wf(){}function Fp(A,D){var Z=A._dbNamesDB;return Z||(Z=A._dbNamesDB=new cs(tl,{addons:[],indexedDB:A,IDBKeyRange:D})).version(1).stores({dbnames:"name"}),Z.table("dbnames")}function xf(A){return A&&typeof A.databases=="function"}function Lp(A){return Jt(function(){return Ce.letThrough=!0,A()})}function $p(A){return!("from"in A)}var Aa=function(A,D){if(!this){var Z=new Aa;return A&&"d"in A&&l(Z,A),Z}l(this,arguments.length?{d:1,from:A,to:1<arguments.length?D:A}:{d:0})};function Vu(A,D,Z){var ne=Vn(D,Z);if(!isNaN(ne)){if(0<ne)throw RangeError();if($p(A))return l(A,{from:D,to:Z,d:1});var ue=A.l,ne=A.r;if(Vn(Z,A.from)<0)return ue?Vu(ue,D,Z):A.l={from:D,to:Z,d:1,l:null,r:null},ly(A);if(0<Vn(D,A.to))return ne?Vu(ne,D,Z):A.r={from:D,to:Z,d:1,l:null,r:null},ly(A);Vn(D,A.from)<0&&(A.from=D,A.l=null,A.d=ne?ne.d+1:1),0<Vn(Z,A.to)&&(A.to=Z,A.r=null,A.d=A.l?A.l.d+1:1),Z=!A.r,ue&&!A.l&&cl(A,ue),ne&&Z&&cl(A,ne)}}function cl(A,D){$p(D)||function Z(ne,Ge){var we=Ge.from,De=Ge.to,$e=Ge.l,Ge=Ge.r;Vu(ne,we,De),$e&&Z(ne,$e),Ge&&Z(ne,Ge)}(A,D)}function oy(A,D){var Z=_f(D),ne=Z.next();if(ne.done)return!1;for(var ue=ne.value,we=_f(A),De=we.next(ue.from),$e=De.value;!ne.done&&!De.done;){if(Vn($e.from,ue.to)<=0&&0<=Vn($e.to,ue.from))return!0;Vn(ue.from,$e.from)<0?ue=(ne=Z.next($e.from)).value:$e=(De=we.next(ue.from)).value}return!1}function _f(A){var D=$p(A)?null:{s:0,n:A};return{next:function(Z){for(var ne=0<arguments.length;D;)switch(D.s){case 0:if(D.s=1,ne)for(;D.n.l&&Vn(Z,D.n.from)<0;)D={up:D,n:D.n.l,s:1};else for(;D.n.l;)D={up:D,n:D.n.l,s:1};case 1:if(D.s=2,!ne||Vn(Z,D.n.to)<=0)return{value:D.n,done:!1};case 2:if(D.n.r){D.s=3,D={up:D,n:D.n.r,s:0};continue}case 3:D=D.up}return{done:!0}}}}function ly(A){var D,Z,ne=(((D=A.r)===null||D===void 0?void 0:D.d)||0)-(((Z=A.l)===null||Z===void 0?void 0:Z.d)||0),ue=1<ne?"r":ne<-1?"l":"";ue&&(D=ue=="r"?"l":"r",Z=r({},A),ne=A[ue],A.from=ne.from,A.to=ne.to,A[ue]=ne[ue],Z[ue]=ne[D],(A[D]=Z).d=Bp(Z)),A.d=Bp(A)}function Bp(Z){var D=Z.r,Z=Z.l;return(D?Z?Math.max(D.d,Z.d):D.d:Z?Z.d:0)+1}function Sf(A,D){return s(D).forEach(function(Z){A[Z]?cl(A[Z],D[Z]):A[Z]=function ne(ue){var we,De,$e={};for(we in ue)h(ue,we)&&(De=ue[we],$e[we]=!De||typeof De!="object"||X.has(De.constructor)?De:ne(De));return $e}(D[Z])}),A}function zp(A,D){return A.all||D.all||Object.keys(A).some(function(Z){return D[Z]&&oy(D[Z],A[Z])})}p(Aa.prototype,((gi={add:function(A){return cl(this,A),this},addKey:function(A){return Vu(this,A,A),this},addKeys:function(A){var D=this;return A.forEach(function(Z){return Vu(D,Z,Z)}),this},hasKey:function(A){var D=_f(this).next(A).value;return D&&Vn(D.from,A)<=0&&0<=Vn(D.to,A)}})[re]=function(){return _f(this)},gi));var ul={},Up={},qp=!1;function Ef(A){Sf(Up,A),qp||(qp=!0,setTimeout(function(){qp=!1,Hp(Up,!(Up={}))},0))}function Hp(A,D){D===void 0&&(D=!1);var Z=new Set;if(A.all)for(var ne=0,ue=Object.values(ul);ne<ue.length;ne++)cy(De=ue[ne],A,Z,D);else for(var we in A){var De,$e=/^idb\:\/\/(.*)\/(.*)\//.exec(we);$e&&(we=$e[1],$e=$e[2],(De=ul["idb://".concat(we,"/").concat($e)])&&cy(De,A,Z,D))}Z.forEach(function(Ge){return Ge()})}function cy(A,D,Z,ne){for(var ue=[],we=0,De=Object.entries(A.queries.query);we<De.length;we++){for(var $e=De[we],Ge=$e[0],Ye=[],rt=0,He=$e[1];rt<He.length;rt++){var st=He[rt];zp(D,st.obsSet)?st.subscribers.forEach(function(Xe){return Z.add(Xe)}):ne&&Ye.push(st)}ne&&ue.push([Ge,Ye])}if(ne)for(var Ve=0,et=ue;Ve<et.length;Ve++){var ot=et[Ve],Ge=ot[0],Ye=ot[1];A.queries.query[Ge]=Ye}}function s1(A){var D=A._state,Z=A._deps.indexedDB;if(D.isBeingOpened||A.idbdb)return D.dbReadyPromise.then(function(){return D.dbOpenError?Wr(D.dbOpenError):A});D.isBeingOpened=!0,D.dbOpenError=null,D.openComplete=!1;var ne=D.openCanceller,ue=Math.round(10*A.verno),we=!1;function De(){if(D.openCanceller!==ne)throw new ke.DatabaseClosed("db.open() was cancelled")}function $e(){return new M(function(st,Ve){if(De(),!Z)throw new ke.MissingAPI;var et=A.name,ot=D.autoSchema||!ue?Z.open(et):Z.open(et,ue);if(!ot)throw new ke.MissingAPI;ot.onerror=Ui(Ve),ot.onblocked=Ae(A._fireOnBlocked),ot.onupgradeneeded=Ae(function(Xe){var ht;rt=ot.transaction,D.autoSchema&&!A._options.allowEmptyDB?(ot.onerror=sl,rt.abort(),ot.result.close(),(ht=Z.deleteDatabase(et)).onsuccess=ht.onerror=Ae(function(){Ve(new ke.NoSuchDatabase("Database ".concat(et," doesnt exist")))})):(rt.onerror=Ui(Ve),Xe=Xe.oldVersion>Math.pow(2,62)?0:Xe.oldVersion,He=Xe<1,A.idbdb=ot.result,we&&gf(A,rt),Hu(A,Xe/10,rt,Ve))},Ve),ot.onsuccess=Ae(function(){rt=null;var Xe,ht,bt,wt,Et,Ut=A.idbdb=ot.result,Kt=S(Ut.objectStoreNames);if(0<Kt.length)try{var $t=Ut.transaction((wt=Kt).length===1?wt[0]:wt,"readonly");if(D.autoSchema)ht=Ut,bt=$t,(Xe=A).verno=ht.version/10,bt=Xe._dbSchema=pc(0,ht,bt),Xe._storeNames=S(ht.objectStoreNames,0),mf(Xe,[Xe._allTables],s(bt),bt);else if(vf(A,A._dbSchema,$t),((Et=yf(pc(0,(Et=A).idbdb,$t),Et._dbSchema)).add.length||Et.change.some(function(Ht){return Ht.add.length||Ht.change.length}))&&!we)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Ut.close(),ue=Ut.version+1,we=!0,st($e());vo(A,$t)}catch{}Ds.push(A),Ut.onversionchange=Ae(function(Ht){D.vcFired=!0,A.on("versionchange").fire(Ht)}),Ut.onclose=Ae(function(Ht){A.on("close").fire(Ht)}),He&&(Et=A._deps,$t=et,Ut=Et.indexedDB,Et=Et.IDBKeyRange,xf(Ut)||$t===tl||Fp(Ut,Et).put({name:$t}).catch(Le)),st()},Ve)}).catch(function(st){switch(st==null?void 0:st.name){case"UnknownError":if(0<D.PR1398_maxLoop)return D.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),$e();break;case"VersionError":if(0<ue)return ue=0,$e()}return M.reject(st)})}var Ge,Ye=D.dbReadyResolve,rt=null,He=!1;return M.race([ne,(typeof navigator>"u"?M.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(st){function Ve(){return indexedDB.databases().finally(st)}Ge=setInterval(Ve,100),Ve()}).finally(function(){return clearInterval(Ge)}):Promise.resolve()).then($e)]).then(function(){return De(),D.onReadyBeingFired=[],M.resolve(Lp(function(){return A.on.ready.fire(A.vip)})).then(function st(){if(0<D.onReadyBeingFired.length){var Ve=D.onReadyBeingFired.reduce(_e,Le);return D.onReadyBeingFired=[],M.resolve(Lp(function(){return Ve(A.vip)})).then(st)}})}).finally(function(){D.openCanceller===ne&&(D.onReadyBeingFired=null,D.isBeingOpened=!1)}).catch(function(st){D.dbOpenError=st;try{rt&&rt.abort()}catch{}return ne===D.openCanceller&&A._close(),Wr(st)}).finally(function(){D.openComplete=!0,Ye()}).then(function(){var st;return He&&(st={},A.tables.forEach(function(Ve){Ve.schema.indexes.forEach(function(et){et.name&&(st["idb://".concat(A.name,"/").concat(Ve.name,"/").concat(et.name)]=new Aa(-1/0,[[[]]]))}),st["idb://".concat(A.name,"/").concat(Ve.name,"/")]=st["idb://".concat(A.name,"/").concat(Ve.name,"/:dels")]=new Aa(-1/0,[[[]]])}),Ta(uc).fire(st),Hp(st,!0)),A})}function Gu(A){function D(we){return A.next(we)}var Z=ue(D),ne=ue(function(we){return A.throw(we)});function ue(we){return function(Ge){var $e=we(Ge),Ge=$e.value;return $e.done?Ge:Ge&&typeof Ge.then=="function"?Ge.then(Z,ne):o(Ge)?Promise.all(Ge).then(Z,ne):Z(Ge)}}return ue(D)()}function wo(A,D,Z){for(var ne=o(A)?A.slice():[A],ue=0;ue<Z;++ue)ne.push(D);return ne}var o1={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(A){return r(r({},A),{table:function(D){var Z=A.table(D),ne=Z.schema,ue={},we=[];function De(He,st,Ve){var et=la(He),ot=ue[et]=ue[et]||[],Xe=He==null?0:typeof He=="string"?1:He.length,ht=0<st,ht=r(r({},Ve),{name:ht?"".concat(et,"(virtual-from:").concat(Ve.name,")"):Ve.name,lowLevelIndex:Ve,isVirtual:ht,keyTail:st,keyLength:Xe,extractKey:hc(He),unique:!ht&&Ve.unique});return ot.push(ht),ht.isPrimaryKey||we.push(ht),1<Xe&&De(Xe===2?He[0]:He.slice(0,Xe-1),st+1,Ve),ot.sort(function(bt,wt){return bt.keyTail-wt.keyTail}),ht}D=De(ne.primaryKey.keyPath,0,ne.primaryKey),ue[":id"]=[D];for(var $e=0,Ge=ne.indexes;$e<Ge.length;$e++){var Ye=Ge[$e];De(Ye.keyPath,0,Ye)}function rt(He){var st,Ve=He.query.index;return Ve.isVirtual?r(r({},He),{query:{index:Ve.lowLevelIndex,range:(st=He.query.range,Ve=Ve.keyTail,{type:st.type===1?2:st.type,lower:wo(st.lower,st.lowerOpen?A.MAX_KEY:A.MIN_KEY,Ve),lowerOpen:!0,upper:wo(st.upper,st.upperOpen?A.MIN_KEY:A.MAX_KEY,Ve),upperOpen:!0})}}):He}return r(r({},Z),{schema:r(r({},ne),{primaryKey:D,indexes:we,getIndexByKeyPath:function(He){return(He=ue[la(He)])&&He[0]}}),count:function(He){return Z.count(rt(He))},query:function(He){return Z.query(rt(He))},openCursor:function(He){var st=He.query.index,Ve=st.keyTail,et=st.isVirtual,ot=st.keyLength;return et?Z.openCursor(rt(He)).then(function(ht){return ht&&Xe(ht)}):Z.openCursor(He);function Xe(ht){return Object.create(ht,{continue:{value:function(bt){bt!=null?ht.continue(wo(bt,He.reverse?A.MAX_KEY:A.MIN_KEY,Ve)):He.unique?ht.continue(ht.key.slice(0,ot).concat(He.reverse?A.MIN_KEY:A.MAX_KEY,Ve)):ht.continue()}},continuePrimaryKey:{value:function(bt,wt){ht.continuePrimaryKey(wo(bt,A.MAX_KEY,Ve),wt)}},primaryKey:{get:function(){return ht.primaryKey}},key:{get:function(){var bt=ht.key;return ot===1?bt[0]:bt.slice(0,ot)}},value:{get:function(){return ht.value}}})}}})}})}};function Cf(A,D,Z,ne){return Z=Z||{},ne=ne||"",s(A).forEach(function(ue){var we,De,$e;h(D,ue)?(we=A[ue],De=D[ue],typeof we=="object"&&typeof De=="object"&&we&&De?($e=de(we))!==de(De)?Z[ne+ue]=D[ue]:$e==="Object"?Cf(we,De,Z,ne+ue+"."):we!==De&&(Z[ne+ue]=D[ue]):we!==De&&(Z[ne+ue]=D[ue])):Z[ne+ue]=void 0}),s(D).forEach(function(ue){h(A,ue)||(Z[ne+ue]=D[ue])}),Z}function kf(A,D){return D.type==="delete"?D.keys:D.keys||D.values.map(A.extractKey)}var uy={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(A){return r(r({},A),{table:function(D){var Z=A.table(D),ne=Z.schema.primaryKey;return r(r({},Z),{mutate:function(ue){var we=Ce.trans,De=we.table(D).hook,$e=De.deleting,Ge=De.creating,Ye=De.updating;switch(ue.type){case"add":if(Ge.fire===Le)break;return we._promise("readwrite",function(){return rt(ue)},!0);case"put":if(Ge.fire===Le&&Ye.fire===Le)break;return we._promise("readwrite",function(){return rt(ue)},!0);case"delete":if($e.fire===Le)break;return we._promise("readwrite",function(){return rt(ue)},!0);case"deleteRange":if($e.fire===Le)break;return we._promise("readwrite",function(){return function He(st,Ve,et){return Z.query({trans:st,values:!1,query:{index:ne,range:Ve},limit:et}).then(function(ot){var Xe=ot.result;return rt({type:"delete",keys:Xe,trans:st}).then(function(ht){return 0<ht.numFailures?Promise.reject(ht.failures[0]):Xe.length<et?{failures:[],numFailures:0,lastResult:void 0}:He(st,r(r({},Ve),{lower:Xe[Xe.length-1],lowerOpen:!0}),et)})})}(ue.trans,ue.range,1e4)},!0)}return Z.mutate(ue);function rt(He){var st,Ve,et,ot=Ce.trans,Xe=He.keys||kf(ne,He);if(!Xe)throw new Error("Keys missing");return(He=He.type==="add"||He.type==="put"?r(r({},He),{keys:Xe}):r({},He)).type!=="delete"&&(He.values=a([],He.values)),He.keys&&(He.keys=a([],He.keys)),st=Z,et=Xe,((Ve=He).type==="add"?Promise.resolve([]):st.getMany({trans:Ve.trans,keys:et,cache:"immutable"})).then(function(ht){var bt=Xe.map(function(wt,Et){var Ut,Kt,$t,Ht=ht[Et],Zt={onerror:null,onsuccess:null};return He.type==="delete"?$e.fire.call(Zt,wt,Ht,ot):He.type==="add"||Ht===void 0?(Ut=Ge.fire.call(Zt,wt,He.values[Et],ot),wt==null&&Ut!=null&&(He.keys[Et]=wt=Ut,ne.outbound||O(He.values[Et],ne.keyPath,wt))):(Ut=Cf(Ht,He.values[Et]),(Kt=Ye.fire.call(Zt,Ut,wt,Ht,ot))&&($t=He.values[Et],Object.keys(Kt).forEach(function(Bt){h($t,Bt)?$t[Bt]=Kt[Bt]:O($t,Bt,Kt[Bt])}))),Zt});return Z.mutate(He).then(function(wt){for(var Et=wt.failures,Ut=wt.results,Kt=wt.numFailures,wt=wt.lastResult,$t=0;$t<Xe.length;++$t){var Ht=(Ut||Xe)[$t],Zt=bt[$t];Ht==null?Zt.onerror&&Zt.onerror(Et[$t]):Zt.onsuccess&&Zt.onsuccess(He.type==="put"&&ht[$t]?He.values[$t]:Ht)}return{failures:Et,results:Ut,numFailures:Kt,lastResult:wt}}).catch(function(wt){return bt.forEach(function(Et){return Et.onerror&&Et.onerror(wt)}),Promise.reject(wt)})})}}})}})}};function Vp(A,D,Z){try{if(!D||D.keys.length<A.length)return null;for(var ne=[],ue=0,we=0;ue<D.keys.length&&we<A.length;++ue)Vn(D.keys[ue],A[we])===0&&(ne.push(Z?K(D.values[ue]):D.values[ue]),++we);return ne.length===A.length?ne:null}catch{return null}}var dy={stack:"dbcore",level:-1,create:function(A){return{table:function(D){var Z=A.table(D);return r(r({},Z),{getMany:function(ne){if(!ne.cache)return Z.getMany(ne);var ue=Vp(ne.keys,ne.trans._cache,ne.cache==="clone");return ue?M.resolve(ue):Z.getMany(ne).then(function(we){return ne.trans._cache={keys:ne.keys,values:ne.cache==="clone"?K(we):we},we})},mutate:function(ne){return ne.type!=="add"&&(ne.trans._cache=null),Z.mutate(ne)}})}}}};function dl(A,D){return A.trans.mode==="readonly"&&!!A.subscr&&!A.trans.explicit&&A.trans.db._options.cache!=="disabled"&&!D.schema.primaryKey.outbound}function fy(A,D){switch(A){case"query":return D.values&&!D.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var l1={stack:"dbcore",level:0,name:"Observability",create:function(A){var D=A.schema.name,Z=new Aa(A.MIN_KEY,A.MAX_KEY);return r(r({},A),{transaction:function(ne,ue,we){if(Ce.subscr&&ue!=="readonly")throw new ke.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ce.querier));return A.transaction(ne,ue,we)},table:function(ne){var ue=A.table(ne),we=ue.schema,De=we.primaryKey,He=we.indexes,$e=De.extractKey,Ge=De.outbound,Ye=De.autoIncrement&&He.filter(function(Ve){return Ve.compound&&Ve.keyPath.includes(De.keyPath)}),rt=r(r({},ue),{mutate:function(Ve){function et(Bt){return Bt="idb://".concat(D,"/").concat(ne,"/").concat(Bt),wt[Bt]||(wt[Bt]=new Aa)}var ot,Xe,ht,bt=Ve.trans,wt=Ve.mutatedParts||(Ve.mutatedParts={}),Et=et(""),Ut=et(":dels"),Kt=Ve.type,Zt=Ve.type==="deleteRange"?[Ve.range]:Ve.type==="delete"?[Ve.keys]:Ve.values.length<50?[kf(De,Ve).filter(function(Bt){return Bt}),Ve.values]:[],$t=Zt[0],Ht=Zt[1],Zt=Ve.trans._cache;return o($t)?(Et.addKeys($t),(Zt=Kt==="delete"||$t.length===Ht.length?Vp($t,Zt):null)||Ut.addKeys($t),(Zt||Ht)&&(ot=et,Xe=Zt,ht=Ht,we.indexes.forEach(function(Bt){var tn=ot(Bt.name||"");function pn(Nn){return Nn!=null?Bt.extractKey(Nn):null}function gn(Nn){return Bt.multiEntry&&o(Nn)?Nn.forEach(function(Ha){return tn.addKey(Ha)}):tn.addKey(Nn)}(Xe||ht).forEach(function(Nn,ra){var _n=Xe&&pn(Xe[ra]),ra=ht&&pn(ht[ra]);Vn(_n,ra)!==0&&(_n!=null&&gn(_n),ra!=null&&gn(ra))})}))):$t?(Ht={from:(Ht=$t.lower)!==null&&Ht!==void 0?Ht:A.MIN_KEY,to:(Ht=$t.upper)!==null&&Ht!==void 0?Ht:A.MAX_KEY},Ut.add(Ht),Et.add(Ht)):(Et.add(Z),Ut.add(Z),we.indexes.forEach(function(Bt){return et(Bt.name).add(Z)})),ue.mutate(Ve).then(function(Bt){return!$t||Ve.type!=="add"&&Ve.type!=="put"||(Et.addKeys(Bt.results),Ye&&Ye.forEach(function(tn){for(var pn=Ve.values.map(function(_n){return tn.extractKey(_n)}),gn=tn.keyPath.findIndex(function(_n){return _n===De.keyPath}),Nn=0,Ha=Bt.results.length;Nn<Ha;++Nn)pn[Nn][gn]=Bt.results[Nn];et(tn.name).addKeys(pn)})),bt.mutatedParts=Sf(bt.mutatedParts||{},wt),Bt})}}),He=function(et){var ot=et.query,et=ot.index,ot=ot.range;return[et,new Aa((et=ot.lower)!==null&&et!==void 0?et:A.MIN_KEY,(ot=ot.upper)!==null&&ot!==void 0?ot:A.MAX_KEY)]},st={get:function(Ve){return[De,new Aa(Ve.key)]},getMany:function(Ve){return[De,new Aa().addKeys(Ve.keys)]},count:He,query:He,openCursor:He};return s(st).forEach(function(Ve){rt[Ve]=function(et){var ot=Ce.subscr,Xe=!!ot,ht=dl(Ce,ue)&&fy(Ve,et)?et.obsSet={}:ot;if(Xe){var bt=function(Ht){return Ht="idb://".concat(D,"/").concat(ne,"/").concat(Ht),ht[Ht]||(ht[Ht]=new Aa)},wt=bt(""),Et=bt(":dels"),ot=st[Ve](et),Xe=ot[0],ot=ot[1];if((Ve==="query"&&Xe.isPrimaryKey&&!et.values?Et:bt(Xe.name||"")).add(ot),!Xe.isPrimaryKey){if(Ve!=="count"){var Ut=Ve==="query"&&Ge&&et.values&&ue.query(r(r({},et),{values:!1}));return ue[Ve].apply(this,arguments).then(function(Ht){if(Ve==="query"){if(Ge&&et.values)return Ut.then(function(pn){return pn=pn.result,wt.addKeys(pn),Ht});var Zt=et.values?Ht.result.map($e):Ht.result;(et.values?wt:Et).addKeys(Zt)}else if(Ve==="openCursor"){var Bt=Ht,tn=et.values;return Bt&&Object.create(Bt,{key:{get:function(){return Et.addKey(Bt.primaryKey),Bt.key}},primaryKey:{get:function(){var pn=Bt.primaryKey;return Et.addKey(pn),pn}},value:{get:function(){return tn&&wt.addKey(Bt.primaryKey),Bt.value}}})}return Ht})}Et.add(Z)}}return ue[Ve].apply(this,arguments)}}),rt}})}};function hy(A,D,Z){if(Z.numFailures===0)return D;if(D.type==="deleteRange")return null;var ne=D.keys?D.keys.length:"values"in D&&D.values?D.values.length:1;return Z.numFailures===ne?null:(D=r({},D),o(D.keys)&&(D.keys=D.keys.filter(function(ue,we){return!(we in Z.failures)})),"values"in D&&o(D.values)&&(D.values=D.values.filter(function(ue,we){return!(we in Z.failures)})),D)}function Tf(A,D){return Z=A,((ne=D).lower===void 0||(ne.lowerOpen?0<Vn(Z,ne.lower):0<=Vn(Z,ne.lower)))&&(A=A,(D=D).upper===void 0||(D.upperOpen?Vn(A,D.upper)<0:Vn(A,D.upper)<=0));var Z,ne}function Gp(A,D,st,ne,ue,we){if(!st||st.length===0)return A;var De=D.query.index,$e=De.multiEntry,Ge=D.query.range,Ye=ne.schema.primaryKey.extractKey,rt=De.extractKey,He=(De.lowLevelIndex||De).extractKey,st=st.reduce(function(Ve,et){var ot=Ve,Xe=[];if(et.type==="add"||et.type==="put")for(var ht=new Aa,bt=et.values.length-1;0<=bt;--bt){var wt,Et=et.values[bt],Ut=Ye(Et);ht.hasKey(Ut)||(wt=rt(Et),($e&&o(wt)?wt.some(function(Bt){return Tf(Bt,Ge)}):Tf(wt,Ge))&&(ht.addKey(Ut),Xe.push(Et)))}switch(et.type){case"add":var Kt=new Aa().addKeys(D.values?Ve.map(function(tn){return Ye(tn)}):Ve),ot=Ve.concat(D.values?Xe.filter(function(tn){return tn=Ye(tn),!Kt.hasKey(tn)&&(Kt.addKey(tn),!0)}):Xe.map(function(tn){return Ye(tn)}).filter(function(tn){return!Kt.hasKey(tn)&&(Kt.addKey(tn),!0)}));break;case"put":var $t=new Aa().addKeys(et.values.map(function(tn){return Ye(tn)}));ot=Ve.filter(function(tn){return!$t.hasKey(D.values?Ye(tn):tn)}).concat(D.values?Xe:Xe.map(function(tn){return Ye(tn)}));break;case"delete":var Ht=new Aa().addKeys(et.keys);ot=Ve.filter(function(tn){return!Ht.hasKey(D.values?Ye(tn):tn)});break;case"deleteRange":var Zt=et.range;ot=Ve.filter(function(tn){return!Tf(Ye(tn),Zt)})}return ot},A);return st===A?A:(st.sort(function(Ve,et){return Vn(He(Ve),He(et))||Vn(Ye(Ve),Ye(et))}),D.limit&&D.limit<1/0&&(st.length>D.limit?st.length=D.limit:A.length===D.limit&&st.length<D.limit&&(ue.dirty=!0)),we?Object.freeze(st):st)}function mc(A,D){return Vn(A.lower,D.lower)===0&&Vn(A.upper,D.upper)===0&&!!A.lowerOpen==!!D.lowerOpen&&!!A.upperOpen==!!D.upperOpen}function Wu(A,D){return function(Z,ne,ue,we){if(Z===void 0)return ne!==void 0?-1:0;if(ne===void 0)return 1;if((ne=Vn(Z,ne))===0){if(ue&&we)return 0;if(ue)return 1;if(we)return-1}return ne}(A.lower,D.lower,A.lowerOpen,D.lowerOpen)<=0&&0<=function(Z,ne,ue,we){if(Z===void 0)return ne!==void 0?1:0;if(ne===void 0)return-1;if((ne=Vn(Z,ne))===0){if(ue&&we)return 0;if(ue)return-1;if(we)return 1}return ne}(A.upper,D.upper,A.upperOpen,D.upperOpen)}function c1(A,D,Z,ne){A.subscribers.add(Z),ne.addEventListener("abort",function(){var ue,we;A.subscribers.delete(Z),A.subscribers.size===0&&(ue=A,we=D,setTimeout(function(){ue.subscribers.size===0&&Q(we,ue)},3e3))})}var Af={stack:"dbcore",level:0,name:"Cache",create:function(A){var D=A.schema.name;return r(r({},A),{transaction:function(Z,ne,ue){var we,De,$e=A.transaction(Z,ne,ue);return ne==="readwrite"&&(De=(we=new AbortController).signal,ue=function(Ge){return function(){if(we.abort(),ne==="readwrite"){for(var Ye=new Set,rt=0,He=Z;rt<He.length;rt++){var st=He[rt],Ve=ul["idb://".concat(D,"/").concat(st)];if(Ve){var et=A.table(st),ot=Ve.optimisticOps.filter(function(tn){return tn.trans===$e});if($e._explicit&&Ge&&$e.mutatedParts)for(var Xe=0,ht=Object.values(Ve.queries.query);Xe<ht.length;Xe++)for(var bt=0,wt=(Kt=ht[Xe]).slice();bt<wt.length;bt++)zp(($t=wt[bt]).obsSet,$e.mutatedParts)&&(Q(Kt,$t),$t.subscribers.forEach(function(tn){return Ye.add(tn)}));else if(0<ot.length){Ve.optimisticOps=Ve.optimisticOps.filter(function(tn){return tn.trans!==$e});for(var Et=0,Ut=Object.values(Ve.queries.query);Et<Ut.length;Et++)for(var Kt,$t,Ht,Zt=0,Bt=(Kt=Ut[Et]).slice();Zt<Bt.length;Zt++)($t=Bt[Zt]).res!=null&&$e.mutatedParts&&(Ge&&!$t.dirty?(Ht=Object.isFrozen($t.res),Ht=Gp($t.res,$t.req,ot,et,$t,Ht),$t.dirty?(Q(Kt,$t),$t.subscribers.forEach(function(tn){return Ye.add(tn)})):Ht!==$t.res&&($t.res=Ht,$t.promise=M.resolve({result:Ht}))):($t.dirty&&Q(Kt,$t),$t.subscribers.forEach(function(tn){return Ye.add(tn)})))}}}Ye.forEach(function(tn){return tn()})}}},$e.addEventListener("abort",ue(!1),{signal:De}),$e.addEventListener("error",ue(!1),{signal:De}),$e.addEventListener("complete",ue(!0),{signal:De})),$e},table:function(Z){var ne=A.table(Z),ue=ne.schema.primaryKey;return r(r({},ne),{mutate:function(we){var De=Ce.trans;if(ue.outbound||De.db._options.cache==="disabled"||De.explicit||De.idbtrans.mode!=="readwrite")return ne.mutate(we);var $e=ul["idb://".concat(D,"/").concat(Z)];return $e?(De=ne.mutate(we),we.type!=="add"&&we.type!=="put"||!(50<=we.values.length||kf(ue,we).some(function(Ge){return Ge==null}))?($e.optimisticOps.push(we),we.mutatedParts&&Ef(we.mutatedParts),De.then(function(Ge){0<Ge.numFailures&&(Q($e.optimisticOps,we),(Ge=hy(0,we,Ge))&&$e.optimisticOps.push(Ge),we.mutatedParts&&Ef(we.mutatedParts))}),De.catch(function(){Q($e.optimisticOps,we),we.mutatedParts&&Ef(we.mutatedParts)})):De.then(function(Ge){var Ye=hy(0,r(r({},we),{values:we.values.map(function(rt,He){var st;return Ge.failures[He]?rt:(rt=(st=ue.keyPath)!==null&&st!==void 0&&st.includes(".")?K(rt):r({},rt),O(rt,ue.keyPath,Ge.results[He]),rt)})}),Ge);$e.optimisticOps.push(Ye),queueMicrotask(function(){return we.mutatedParts&&Ef(we.mutatedParts)})}),De):ne.mutate(we)},query:function(we){if(!dl(Ce,ne)||!fy("query",we))return ne.query(we);var De=((Ye=Ce.trans)===null||Ye===void 0?void 0:Ye.db._options.cache)==="immutable",He=Ce,$e=He.requery,Ge=He.signal,Ye=function(et,ot,Xe,ht){var bt=ul["idb://".concat(et,"/").concat(ot)];if(!bt)return[];if(!(ot=bt.queries[Xe]))return[null,!1,bt,null];var wt=ot[(ht.query?ht.query.index.name:null)||""];if(!wt)return[null,!1,bt,null];switch(Xe){case"query":var Et=wt.find(function(Ut){return Ut.req.limit===ht.limit&&Ut.req.values===ht.values&&mc(Ut.req.query.range,ht.query.range)});return Et?[Et,!0,bt,wt]:[wt.find(function(Ut){return("limit"in Ut.req?Ut.req.limit:1/0)>=ht.limit&&(!ht.values||Ut.req.values)&&Wu(Ut.req.query.range,ht.query.range)}),!1,bt,wt];case"count":return Et=wt.find(function(Ut){return mc(Ut.req.query.range,ht.query.range)}),[Et,!!Et,bt,wt]}}(D,Z,"query",we),rt=Ye[0],He=Ye[1],st=Ye[2],Ve=Ye[3];return rt&&He?rt.obsSet=we.obsSet:(He=ne.query(we).then(function(et){var ot=et.result;if(rt&&(rt.res=ot),De){for(var Xe=0,ht=ot.length;Xe<ht;++Xe)Object.freeze(ot[Xe]);Object.freeze(ot)}else et.result=K(ot);return et}).catch(function(et){return Ve&&rt&&Q(Ve,rt),Promise.reject(et)}),rt={obsSet:we.obsSet,promise:He,subscribers:new Set,type:"query",req:we,dirty:!1},Ve?Ve.push(rt):(Ve=[rt],(st=st||(ul["idb://".concat(D,"/").concat(Z)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[we.query.index.name||""]=Ve)),c1(rt,Ve,$e,Ge),rt.promise.then(function(et){return{result:Gp(et.result,we,st==null?void 0:st.optimisticOps,ne,rt,De)}})}})}})}};function Ku(A,D){return new Proxy(A,{get:function(Z,ne,ue){return ne==="db"?D:Reflect.get(Z,ne,ue)}})}var cs=($r.prototype.version=function(A){if(isNaN(A)||A<.1)throw new ke.Type("Given version is not a positive number");if(A=Math.round(10*A)/10,this.idbdb||this._state.isBeingOpened)throw new ke.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,A);var D=this._versions,Z=D.filter(function(ne){return ne._cfg.version===A})[0];return Z||(Z=new this.Version(A),D.push(Z),D.sort(Mp),Z.stores({}),this._state.autoSchema=!1,Z)},$r.prototype._whenReady=function(A){var D=this;return this.idbdb&&(this._state.openComplete||Ce.letThrough||this._vip)?A():new M(function(Z,ne){if(D._state.openComplete)return ne(new ke.DatabaseClosed(D._state.dbOpenError));if(!D._state.isBeingOpened){if(!D._state.autoOpen)return void ne(new ke.DatabaseClosed);D.open().catch(Le)}D._state.dbReadyPromise.then(Z,ne)}).then(A)},$r.prototype.use=function(A){var D=A.stack,Z=A.create,ne=A.level,ue=A.name;return ue&&this.unuse({stack:D,name:ue}),A=this._middlewares[D]||(this._middlewares[D]=[]),A.push({stack:D,create:Z,level:ne??10,name:ue}),A.sort(function(we,De){return we.level-De.level}),this},$r.prototype.unuse=function(A){var D=A.stack,Z=A.name,ne=A.create;return D&&this._middlewares[D]&&(this._middlewares[D]=this._middlewares[D].filter(function(ue){return ne?ue.create!==ne:!!Z&&ue.name!==Z})),this},$r.prototype.open=function(){var A=this;return ho(ve,function(){return s1(A)})},$r.prototype._close=function(){var A=this._state,D=Ds.indexOf(this);if(0<=D&&Ds.splice(D,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}A.isBeingOpened||(A.dbReadyPromise=new M(function(Z){A.dbReadyResolve=Z}),A.openCanceller=new M(function(Z,ne){A.cancelOpen=ne}))},$r.prototype.close=function(Z){var D=(Z===void 0?{disableAutoOpen:!0}:Z).disableAutoOpen,Z=this._state;D?(Z.isBeingOpened&&Z.cancelOpen(new ke.DatabaseClosed),this._close(),Z.autoOpen=!1,Z.dbOpenError=new ke.DatabaseClosed):(this._close(),Z.autoOpen=this._options.autoOpen||Z.isBeingOpened,Z.openComplete=!1,Z.dbOpenError=null)},$r.prototype.delete=function(A){var D=this;A===void 0&&(A={disableAutoOpen:!0});var Z=0<arguments.length&&typeof arguments[0]!="object",ne=this._state;return new M(function(ue,we){function De(){D.close(A);var $e=D._deps.indexedDB.deleteDatabase(D.name);$e.onsuccess=Ae(function(){var Ge,Ye,rt;Ge=D._deps,Ye=D.name,rt=Ge.indexedDB,Ge=Ge.IDBKeyRange,xf(rt)||Ye===tl||Fp(rt,Ge).delete(Ye).catch(Le),ue()}),$e.onerror=Ui(we),$e.onblocked=D._fireOnBlocked}if(Z)throw new ke.InvalidArgument("Invalid closeOptions argument to db.delete()");ne.isBeingOpened?ne.dbReadyPromise.then(De):De()})},$r.prototype.backendDB=function(){return this.idbdb},$r.prototype.isOpen=function(){return this.idbdb!==null},$r.prototype.hasBeenClosed=function(){var A=this._state.dbOpenError;return A&&A.name==="DatabaseClosed"},$r.prototype.hasFailed=function(){return this._state.dbOpenError!==null},$r.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty($r.prototype,"tables",{get:function(){var A=this;return s(this._allTables).map(function(D){return A._allTables[D]})},enumerable:!1,configurable:!0}),$r.prototype.transaction=function(){var A=(function(D,Z,ne){var ue=arguments.length;if(ue<2)throw new ke.InvalidArgument("Too few arguments");for(var we=new Array(ue-1);--ue;)we[ue-1]=arguments[ue];return ne=we.pop(),[D,L(we),ne]}).apply(this,arguments);return this._transaction.apply(this,A)},$r.prototype._transaction=function(A,D,Z){var ne=this,ue=Ce.trans;ue&&ue.db===this&&A.indexOf("!")===-1||(ue=null);var we,De,$e=A.indexOf("?")!==-1;A=A.replace("!","").replace("?","");try{if(De=D.map(function(Ye){if(Ye=Ye instanceof ne.Table?Ye.name:Ye,typeof Ye!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return Ye}),A=="r"||A===zi)we=zi;else{if(A!="rw"&&A!=zu)throw new ke.InvalidArgument("Invalid transaction mode: "+A);we=zu}if(ue){if(ue.mode===zi&&we===zu){if(!$e)throw new ke.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");ue=null}ue&&De.forEach(function(Ye){if(ue&&ue.storeNames.indexOf(Ye)===-1){if(!$e)throw new ke.SubTransaction("Table "+Ye+" not included in parent transaction.");ue=null}}),$e&&ue&&!ue.active&&(ue=null)}}catch(Ye){return ue?ue._promise(null,function(rt,He){He(Ye)}):Wr(Ye)}var Ge=(function Ye(rt,He,st,Ve,et){return M.resolve().then(function(){var ot=Ce.transless||Ce,Xe=rt._createTransaction(He,st,rt._dbSchema,Ve);if(Xe.explicit=!0,ot={trans:Xe,transless:ot},Ve)Xe.idbtrans=Ve.idbtrans;else try{Xe.create(),Xe.idbtrans._explicit=!0,rt._state.PR1398_maxLoop=3}catch(wt){return wt.name===Ne.InvalidState&&rt.isOpen()&&0<--rt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),rt.close({disableAutoOpen:!1}),rt.open().then(function(){return Ye(rt,He,st,null,et)})):Wr(wt)}var ht,bt=J(et);return bt&&An(),ot=M.follow(function(){var wt;(ht=et.call(Xe,Xe))&&(bt?(wt=Hn.bind(null,null),ht.then(wt,wt)):typeof ht.next=="function"&&typeof ht.throw=="function"&&(ht=Gu(ht)))},ot),(ht&&typeof ht.then=="function"?M.resolve(ht).then(function(wt){return Xe.active?wt:Wr(new ke.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):ot.then(function(){return ht})).then(function(wt){return Ve&&Xe._resolve(),Xe._completion.then(function(){return wt})}).catch(function(wt){return Xe._reject(wt),Wr(wt)})})}).bind(null,this,we,De,ue,Z);return ue?ue._promise(we,Ge,"lock"):Ce.trans?ho(Ce.transless,function(){return ne._whenReady(Ge)}):this._whenReady(Ge)},$r.prototype.table=function(A){if(!h(this._allTables,A))throw new ke.InvalidTable("Table ".concat(A," does not exist"));return this._allTables[A]},$r);function $r(A,D){var Z=this;this._middlewares={},this.verno=0;var ne=$r.dependencies;this._options=D=r({addons:$r.addons,autoOpen:!0,indexedDB:ne.indexedDB,IDBKeyRange:ne.IDBKeyRange,cache:"cloned"},D),this._deps={indexedDB:D.indexedDB,IDBKeyRange:D.IDBKeyRange},ne=D.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var ue,we,De,$e,Ge,Ye={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Le,dbReadyPromise:null,cancelOpen:Le,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:D.autoOpen};Ye.dbReadyPromise=new M(function(He){Ye.dbReadyResolve=He}),Ye.openCanceller=new M(function(He,st){Ye.cancelOpen=st}),this._state=Ye,this.name=A,this.on=bo(this,"populate","blocked","versionchange","close",{ready:[_e,Le]}),this.on.ready.subscribe=E(this.on.ready.subscribe,function(He){return function(st,Ve){$r.vip(function(){var et,ot=Z._state;ot.openComplete?(ot.dbOpenError||M.resolve().then(st),Ve&&He(st)):ot.onReadyBeingFired?(ot.onReadyBeingFired.push(st),Ve&&He(st)):(He(st),et=Z,Ve||He(function Xe(){et.on.ready.unsubscribe(st),et.on.ready.unsubscribe(Xe)}))})}}),this.Collection=(ue=this,ac(lc.prototype,function(ht,Xe){this.db=ue;var Ve=nl,et=null;if(Xe)try{Ve=Xe()}catch(bt){et=bt}var ot=ht._ctx,Xe=ot.table,ht=Xe.hook.reading.fire;this._ctx={table:Xe,index:ot.index,isPrimKey:!ot.index||Xe.schema.primKey.keyPath&&ot.index===Xe.schema.primKey.name,range:Ve,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:et,or:ot.or,valueMapper:ht!==Ie?ht:null}})),this.Table=(we=this,ac(Np.prototype,function(He,st,Ve){this.db=we,this._tx=Ve,this.name=He,this.schema=st,this.hook=we._allTables[He]?we._allTables[He].hook:bo(null,{creating:[Te,Le],reading:[V,Ie],updating:[ie,Le],deleting:[le,Le]})})),this.Transaction=(De=this,ac(Dp.prototype,function(He,st,Ve,et,ot){var Xe=this;this.db=De,this.mode=He,this.storeNames=st,this.schema=Ve,this.chromeTransactionDurability=et,this.idbtrans=null,this.on=bo(this,"complete","error","abort"),this.parent=ot||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new M(function(ht,bt){Xe._resolve=ht,Xe._reject=bt}),this._completion.then(function(){Xe.active=!1,Xe.on.complete.fire()},function(ht){var bt=Xe.active;return Xe.active=!1,Xe.on.error.fire(ht),Xe.parent?Xe.parent._reject(ht):bt&&Xe.idbtrans&&Xe.idbtrans.abort(),Wr(ht)})})),this.Version=($e=this,ac(i1.prototype,function(He){this.db=$e,this._cfg={version:He,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Ge=this,ac(il.prototype,function(He,st,Ve){if(this.db=Ge,this._ctx={table:He,index:st===":id"?null:st,or:Ve},this._cmp=this._ascending=Vn,this._descending=function(et,ot){return Vn(ot,et)},this._max=function(et,ot){return 0<Vn(et,ot)?et:ot},this._min=function(et,ot){return Vn(et,ot)<0?et:ot},this._IDBKeyRange=Ge._deps.IDBKeyRange,!this._IDBKeyRange)throw new ke.MissingAPI})),this.on("versionchange",function(He){0<He.newVersion?console.warn("Another connection wants to upgrade database '".concat(Z.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(Z.name,"'. Closing db now to resume the delete request.")),Z.close({disableAutoOpen:!1})}),this.on("blocked",function(He){!He.newVersion||He.newVersion<He.oldVersion?console.warn("Dexie.delete('".concat(Z.name,"') was blocked")):console.warn("Upgrade '".concat(Z.name,"' blocked by other connection holding version ").concat(He.oldVersion/10))}),this._maxKey=fc(D.IDBKeyRange),this._createTransaction=function(He,st,Ve,et){return new Z.Transaction(He,st,Ve,Z._options.chromeTransactionDurability,et)},this._fireOnBlocked=function(He){Z.on("blocked").fire(He),Ds.filter(function(st){return st.name===Z.name&&st!==Z&&!st._state.vcFired}).map(function(st){return st.on("versionchange").fire(He)})},this.use(dy),this.use(Af),this.use(l1),this.use(o1),this.use(uy);var rt=new Proxy(this,{get:function(He,st,Ve){if(st==="_vip")return!0;if(st==="table")return function(ot){return Ku(Z.table(ot),rt)};var et=Reflect.get(He,st,Ve);return et instanceof Np?Ku(et,rt):st==="tables"?et.map(function(ot){return Ku(ot,rt)}):st==="_createTransaction"?function(){return Ku(et.apply(this,arguments),rt)}:et}});this.vip=rt,ne.forEach(function(He){return He(Z)})}var gc,gi=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",py=(Nf.prototype.subscribe=function(A,D,Z){return this._subscribe(A&&typeof A!="function"?A:{next:A,error:D,complete:Z})},Nf.prototype[gi]=function(){return this},Nf);function Nf(A){this._subscribe=A}try{gc={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{gc={indexedDB:null,IDBKeyRange:null}}function my(A){var D,Z=!1,ne=new py(function(ue){var we=J(A),De,$e=!1,Ge={},Ye={},rt={get closed(){return $e},unsubscribe:function(){$e||($e=!0,De&&De.abort(),He&&Ta.storagemutated.unsubscribe(Ve))}};ue.start&&ue.start(rt);var He=!1,st=function(){return mo(et)},Ve=function(ot){Sf(Ge,ot),zp(Ye,Ge)&&st()},et=function(){var ot,Xe,ht;!$e&&gc.indexedDB&&(Ge={},ot={},De&&De.abort(),De=new AbortController,ht=function(bt){var wt=H();try{we&&An();var Et=Jt(A,bt);return Et=we?Et.finally(Hn):Et}finally{wt&&U()}}(Xe={subscr:ot,signal:De.signal,requery:st,querier:A,trans:null}),Promise.resolve(ht).then(function(bt){Z=!0,D=bt,$e||Xe.signal.aborted||(Ge={},function(wt){for(var Et in wt)if(h(wt,Et))return;return 1}(Ye=ot)||He||(Ta(uc,Ve),He=!0),mo(function(){return!$e&&ue.next&&ue.next(bt)}))},function(bt){Z=!1,["DatabaseClosedError","AbortError"].includes(bt==null?void 0:bt.name)||$e||mo(function(){$e||ue.error&&ue.error(bt)})}))};return setTimeout(st,0),rt});return ne.hasValue=function(){return Z},ne.getValue=function(){return D},ne}var fl=cs;function Wp(A){var D=xo;try{xo=!0,Ta.storagemutated.fire(A),Hp(A,!0)}finally{xo=D}}p(fl,r(r({},Qe),{delete:function(A){return new fl(A,{addons:[]}).delete()},exists:function(A){return new fl(A,{addons:[]}).open().then(function(D){return D.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(A){try{return D=fl.dependencies,Z=D.indexedDB,D=D.IDBKeyRange,(xf(Z)?Promise.resolve(Z.databases()).then(function(ne){return ne.map(function(ue){return ue.name}).filter(function(ue){return ue!==tl})}):Fp(Z,D).toCollection().primaryKeys()).then(A)}catch{return Wr(new ke.MissingAPI)}var D,Z},defineClass:function(){return function(A){l(this,A)}},ignoreTransaction:function(A){return Ce.trans?ho(Ce.transless,A):A()},vip:Lp,async:function(A){return function(){try{var D=Gu(A.apply(this,arguments));return D&&typeof D.then=="function"?D:M.resolve(D)}catch(Z){return Wr(Z)}}},spawn:function(A,D,Z){try{var ne=Gu(A.apply(Z,D||[]));return ne&&typeof ne.then=="function"?ne:M.resolve(ne)}catch(ue){return Wr(ue)}},currentTransaction:{get:function(){return Ce.trans||null}},waitFor:function(A,D){return D=M.resolve(typeof A=="function"?fl.ignoreTransaction(A):A).timeout(D||6e4),Ce.trans?Ce.trans.waitFor(D):D},Promise:M,debug:{get:function(){return Me},set:function(A){Ee(A)}},derive:b,extend:l,props:p,override:E,Events:bo,on:Ta,liveQuery:my,extendObservabilitySet:Sf,getByKeyPath:R,setByKeyPath:O,delByKeyPath:function(A,D){typeof D=="string"?O(A,D,void 0):"length"in D&&[].map.call(D,function(Z){O(A,Z,void 0)})},shallowClone:j,deepClone:K,getObjectDiff:Cf,cmp:Vn,asap:k,minKey:-1/0,addons:[],connections:Ds,errnames:Ne,dependencies:gc,cache:ul,semVer:"4.0.11",version:"4.0.11".split(".").map(function(A){return parseInt(A)}).reduce(function(A,D,Z){return A+D/Math.pow(10,2*Z)})})),fl.maxKey=fc(fl.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ta(uc,function(A){xo||(A=new CustomEvent(ol,{detail:A}),xo=!0,dispatchEvent(A),xo=!1)}),addEventListener(ol,function(A){A=A.detail,xo||Wp(A)}));var yc,xo=!1,ei=function(){};return typeof BroadcastChannel<"u"&&((ei=function(){(yc=new BroadcastChannel(ol)).onmessage=function(A){return A.data&&Wp(A.data)}})(),typeof yc.unref=="function"&&yc.unref(),Ta(uc,function(A){xo||yc.postMessage(A)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(A){if(!cs.disableBfCache&&A.persisted){Me&&console.debug("Dexie: handling persisted pagehide"),yc!=null&&yc.close();for(var D=0,Z=Ds;D<Z.length;D++)Z[D].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(A){!cs.disableBfCache&&A.persisted&&(Me&&console.debug("Dexie: handling persisted pageshow"),ei(),Wp({all:new Aa(-1/0,[[]])}))})),M.rejectionMapper=function(A,D){return!A||A instanceof oe||A instanceof TypeError||A instanceof SyntaxError||!A.name||!Fe[A.name]?A:(D=new Fe[A.name](D||A.message,A),"stack"in A&&v(D,"stack",{get:function(){return this.inner.stack}}),D)},Ee(Me),r(cs,Object.freeze({__proto__:null,Dexie:cs,liveQuery:my,Entity:uf,cmp:Vn,PropModification:oc,replacePrefix:function(A,D){return new oc({replacePrefix:[A,D]})},add:function(A){return new oc({add:A})},remove:function(A){return new oc({remove:A})},default:cs,RangeSet:Aa,mergeRanges:cl,rangesOverlap:oy}),{default:cs}),cs})}(Qb)),Qb.exports}var oV=sV();const x2=di(oV),NI=Symbol.for("Dexie"),hv=globalThis[NI]||(globalThis[NI]=x2);if(x2.semVer!==hv.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${x2.semVer} and ${hv.semVer}`);const{liveQuery:C1e,mergeRanges:k1e,rangesOverlap:T1e,RangeSet:A1e,cmp:N1e,Entity:R1e,PropModification:I1e,replacePrefix:j1e,add:O1e,remove:D1e}=hv;class lV extends hv{constructor(){super("LiteChatDatabase_Rewrite_v1");Oa(this,"conversations");Oa(this,"interactions");Oa(this,"mods");Oa(this,"appState");Oa(this,"providerConfigs");Oa(this,"apiKeys");Oa(this,"syncRepos");Oa(this,"projects");Oa(this,"rules");Oa(this,"tags");Oa(this,"tagRuleLinks");this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const Yt=new lV,Tl=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class Ft{static async loadConversations(){try{return(await Yt.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>Tl(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await Yt.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await Yt.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await Yt.interactions.where({conversationId:t}).sortBy("index")).map(r=>Tl(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await Yt.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await Yt.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await Yt.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await Yt.mods.orderBy("loadOrder").toArray()).map(n=>Tl(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await Yt.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await Yt.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await Yt.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await Yt.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=Yt.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>Tl(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await Yt.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await Yt.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=Yt.apiKeys)==null?void 0:t.toArray())??[]).map(r=>Tl(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await Yt.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await Yt.transaction("rw",[Yt.apiKeys,Yt.providerConfigs],async()=>{const n=await Yt.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(a=>Yt.providerConfigs.update(a.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await Yt.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await Yt.syncRepos.toArray()).map(n=>Tl(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await Yt.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await Yt.transaction("rw",[Yt.syncRepos,Yt.conversations],async()=>{const n=await Yt.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(a=>Yt.conversations.update(a.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await Yt.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await Yt.projects.orderBy("updatedAt").reverse().toArray()).map(n=>Tl(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,metadata:t.metadata?{...t.metadata}:{}};return await Yt.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const a=await Yt.projects.where("parentId").equals(r).toArray();for(const s of a)await n(s.id);const i=await Yt.conversations.where("projectId").equals(r).toArray();if(i.length>0){const s=i.map(o=>Yt.conversations.update(o.id,{projectId:null}));await Promise.all(s),console.log(`PersistenceService: Unlinked Project ${r} from ${i.length} conversations.`)}await Yt.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await Yt.transaction("rw",[Yt.projects,Yt.conversations],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await Yt.rules.orderBy("name").toArray()).map(n=>Tl(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await Yt.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await Yt.transaction("rw",[Yt.rules,Yt.tagRuleLinks],async()=>{await Yt.tagRuleLinks.where("ruleId").equals(t).delete(),await Yt.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await Yt.tags.orderBy("name").toArray()).map(n=>Tl(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await Yt.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await Yt.transaction("rw",[Yt.tags,Yt.tagRuleLinks],async()=>{await Yt.tagRuleLinks.where("tagId").equals(t).delete(),await Yt.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await Yt.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await Yt.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await Yt.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async clearAllData(){try{await Yt.transaction("rw",[Yt.conversations,Yt.interactions,Yt.mods,Yt.appState,Yt.providerConfigs,Yt.apiKeys,Yt.syncRepos,Yt.projects,Yt.rules,Yt.tags,Yt.tagRuleLinks],async()=>{await Yt.interactions.clear(),await Yt.conversations.clear(),await Yt.projects.clear(),await Yt.mods.clear(),await Yt.appState.clear(),await Yt.providerConfigs.clear(),await Yt.apiKeys.clear(),await Yt.syncRepos.clear(),await Yt.rules.clear(),await Yt.tags.clear(),await Yt.tagRuleLinks.clear()}),console.log("PersistenceService: All data cleared.")}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}function cV(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(a){a(n)}),(r=e.get("*"))&&r.slice().map(function(a){a(t,n)})}}}const St=cV();var _t=(e=>(e.APP_LOADED="app:loaded",e.MOD_LOADED="mod:loaded",e.MOD_ERROR="mod:error",e.CONVERSATION_SELECTED="conversation:selected",e.CONVERSATION_ADDED="conversation:added",e.CONVERSATION_UPDATED="conversation:updated",e.CONVERSATION_DELETED="conversation:deleted",e.PROJECT_SELECTED="project:selected",e.PROJECT_ADDED="project:added",e.PROJECT_UPDATED="project:updated",e.PROJECT_DELETED="project:deleted",e.INTERACTION_STARTED="interaction:started",e.INTERACTION_STREAM_CHUNK="interaction:stream_chunk",e.INTERACTION_COMPLETED="interaction:completed",e.PROMPT_SUBMITTED="prompt:submitted",e.PROMPT_INPUT_CHANGE="prompt:input_change",e.SETTINGS_CHANGED="settings:changed",e.PROVIDER_CONFIG_CHANGED="provider:config_changed",e.API_KEY_CHANGED="provider:api_key_changed",e.MODEL_SELECTION_CHANGED="provider:model_selection_changed",e.VFS_FILE_WRITTEN="vfs:file_written",e.VFS_FILE_READ="vfs:file_read",e.VFS_FILE_DELETED="vfs:file_deleted",e.VFS_CONTEXT_CHANGED="vfs:context_changed",e.SYNC_REPO_CHANGED="sync:repo_changed",e.CONVERSATION_SYNC_STATUS_CHANGED="sync:conversation_status_changed",e.REPO_INIT_STATUS_CHANGED="sync:repo_init_status_changed",e.ATTACHED_FILES_CHANGED="input:attached_files_changed",e.PROMPT_PARAMS_CHANGED="input:prompt_params_changed",e.INTERACTION_STATUS_CHANGED="interaction:status_changed",e.CONTEXT_CHANGED="ui:context_changed",e))(_t||{}),pv=(e=>(e.PROMPT_TURN_FINALIZE="middleware:prompt:turnFinalize",e.INTERACTION_BEFORE_START="middleware:interaction:beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware:interaction:processChunk",e))(pv||{});const Zn=As(Ns((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(!n){t().clearInteractions();return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},currentConversationId:n}),r!=="loading"&&St.emit(_t.INTERACTION_STATUS_CHANGED,{status:"loading"});try{const a=await Ft.loadInteractionsForConversation(n);a.sort((i,s)=>i.index-s.index),e({interactions:a,status:"idle"}),St.emit(_t.INTERACTION_STATUS_CHANGED,{status:"idle"})}catch(a){console.error("InteractionStore: Error loading interactions",a),e({error:"Failed load interactions",status:"error"}),St.emit(_t.INTERACTION_STATUS_CHANGED,{status:"error"})}},_addInteractionToState:n=>{e(r=>{if(!r.interactions.some(a=>a.id===n.id))r.interactions.push(n),r.interactions.sort((a,i)=>a.index-i.index);else{console.warn(`InteractionStore: Interaction ${n.id} already exists. Updating instead.`);const a=r.interactions.findIndex(i=>i.id===n.id);a!==-1&&(r.interactions[a]={...r.interactions[a],...n})}})},_updateInteractionInState:(n,r)=>{e(a=>{const i=a.interactions.findIndex(s=>s.id===n);if(i!==-1){const s=a.interactions[i];let o={...s.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]));const l={...s,...r,metadata:o};"response"in r&&(l.response=r.response),a.interactions[i]=l}else console.warn(`InteractionStore: Interaction ${n} not found for sync state update.`)})},appendInteractionResponseChunk:(n,r)=>{e(a=>{a.streamingInteractionIds.includes(n)&&(a.activeStreamBuffers[n]=(a.activeStreamBuffers[n]||"")+r)})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(a=>a.id!==n)})},setCurrentConversationId:async n=>{t().currentConversationId!==n?(console.log(`InteractionStore: Setting current conversation ID to ${n}`),n?await t().loadInteractions(n):t().clearInteractions()):console.log(`InteractionStore: Conversation ID ${n} is already current.`)},clearInteractions:()=>{console.log("InteractionStore: Clearing interactions.");const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&St.emit(_t.INTERACTION_STATUS_CHANGED,{status:"idle"})},setError:n=>{const r=t().status;let a="idle";e(i=>{i.error=n,n?(a="error",i.status="error"):i.status==="error"?(a=i.streamingInteractionIds.length>0?"streaming":"idle",i.status=a):a=i.status}),r!==a&&St.emit(_t.INTERACTION_STATUS_CHANGED,{status:a})},setStatus:n=>{t().status!==n&&(e({status:n}),St.emit(_t.INTERACTION_STATUS_CHANGED,{status:n}))},_addStreamingId:n=>{let r=!1;e(a=>{a.streamingInteractionIds.includes(n)||(a.streamingInteractionIds.push(n),a.activeStreamBuffers[n]="",a.streamingInteractionIds.length===1&&(a.status="streaming",r=!0),a.error=null)}),r&&St.emit(_t.INTERACTION_STATUS_CHANGED,{status:"streaming"})},_removeStreamingId:n=>{let r=!1;e(a=>{const i=a.streamingInteractionIds.indexOf(n);i!==-1&&(a.streamingInteractionIds.splice(i,1),delete a.activeStreamBuffers[n],console.log(`InteractionStore: Cleaned up buffer for ${n}.`),a.streamingInteractionIds.length===0&&a.status==="streaming"&&(a.status=a.error?"error":"idle",r=!0))}),r&&St.emit(_t.INTERACTION_STATUS_CHANGED,{status:t().status})}}))),pa=As(Ns(e=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,initialSettingsTab:null,initialSettingsSubTab:null,isProjectSettingsModalOpen:!1,projectSettingsModalTargetId:null,isVfsModalOpen:!1,toggleChatControlPanel:(t,n)=>{e(r=>{r.isChatControlPanelOpen[t]=n??!r.isChatControlPanelOpen[t],t==="settingsModal"&&!r.isChatControlPanelOpen[t]&&(r.initialSettingsTab=null,r.initialSettingsSubTab=null)})},togglePromptControlPanel:(t,n)=>{e(r=>{r.isPromptControlPanelOpen[t]=n??!r.isPromptControlPanelOpen[t]})},toggleSidebar:t=>{console.log("toggleSidebar called :",t),e(n=>{n.isSidebarCollapsed=t??!n.isSidebarCollapsed})},setGlobalLoading:t=>{e({globalLoading:t})},setGlobalError:t=>{e({globalError:t})},setFocusInputFlag:t=>{e({focusInputOnNextRender:t})},setInitialSettingsTabs:(t,n=null)=>{e({initialSettingsTab:t,initialSettingsSubTab:n})},clearInitialSettingsTabs:()=>{e({initialSettingsTab:null,initialSettingsSubTab:null})},openProjectSettingsModal:t=>{e({isProjectSettingsModalOpen:!0,projectSettingsModalTargetId:t})},closeProjectSettingsModal:()=>{e({isProjectSettingsModalOpen:!1,projectSettingsModalTargetId:null})},toggleVfsModal:t=>{e(n=>{n.isVfsModalOpen=t??!n.isVfsModalOpen})}}))),uV="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Pi=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=uV[n[e]&63];return t};const tu=As(Ns((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(a=>{if(a.attachedFilesMetadata.some(s=>s.source==="direct"&&n.source==="direct"?s.name===n.name&&s.size===n.size:s.source==="vfs"&&n.source==="vfs"?s.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const s={id:Pi(),...n};a.attachedFilesMetadata.push(s),r=!0}}),r&&St.emit(_t.ATTACHED_FILES_CHANGED,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(a=>{const i=a.attachedFilesMetadata.length;a.attachedFilesMetadata=a.attachedFilesMetadata.filter(s=>s.id!==n),r=a.attachedFilesMetadata.length<i}),r&&St.emit(_t.ATTACHED_FILES_CHANGED,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&St.emit(_t.ATTACHED_FILES_CHANGED,{files:[]})}}))),D6=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(D6);const GC=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml")return!0;const r="."+n.split(".").pop();return D6.has(r)};var M6="vercel.ai.error",dV=Symbol.for(M6),P6,fV=class F6 extends Error{constructor({name:t,message:n,cause:r}){super(n),this[P6]=!0,this.name=t,this.cause=r}static isInstance(t){return F6.hasMarker(t,M6)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};P6=dV;var Tn=fV,L6="AI_APICallError",$6=`vercel.ai.error.${L6}`,hV=Symbol.for($6),B6,xa=class extends Tn{constructor({message:t,url:n,requestBodyValues:r,statusCode:a,responseHeaders:i,responseBody:s,cause:o,isRetryable:l=a!=null&&(a===408||a===409||a===429||a>=500),data:u}){super({name:L6,message:t,cause:o}),this[B6]=!0,this.url=n,this.requestBodyValues=r,this.statusCode=a,this.responseHeaders=i,this.responseBody=s,this.isRetryable=l,this.data=u}static isInstance(t){return Tn.hasMarker(t,$6)}};B6=hV;var z6="AI_EmptyResponseBodyError",U6=`vercel.ai.error.${z6}`,pV=Symbol.for(U6),q6,WC=class extends Tn{constructor({message:t="Empty response body"}={}){super({name:z6,message:t}),this[q6]=!0}static isInstance(t){return Tn.hasMarker(t,U6)}};q6=pV;function l0(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var H6="AI_InvalidArgumentError",V6=`vercel.ai.error.${H6}`,mV=Symbol.for(V6),G6,KC=class extends Tn{constructor({message:t,cause:n,argument:r}){super({name:H6,message:t,cause:n}),this[G6]=!0,this.argument=r}static isInstance(t){return Tn.hasMarker(t,V6)}};G6=mV;var W6="AI_InvalidPromptError",K6=`vercel.ai.error.${W6}`,gV=Symbol.for(K6),Z6,Nl=class extends Tn{constructor({prompt:t,message:n,cause:r}){super({name:W6,message:`Invalid prompt: ${n}`,cause:r}),this[Z6]=!0,this.prompt=t}static isInstance(t){return Tn.hasMarker(t,K6)}};Z6=gV;var Y6="AI_InvalidResponseDataError",X6=`vercel.ai.error.${Y6}`,yV=Symbol.for(X6),J6,bh=class extends Tn{constructor({data:t,message:n=`Invalid response data: ${JSON.stringify(t)}.`}){super({name:Y6,message:n}),this[J6]=!0,this.data=t}static isInstance(t){return Tn.hasMarker(t,X6)}};J6=yV;var Q6="AI_JSONParseError",eD=`vercel.ai.error.${Q6}`,bV=Symbol.for(eD),tD,nu=class extends Tn{constructor({text:t,cause:n}){super({name:Q6,message:`JSON parsing failed: Text: ${t}.
Error message: ${l0(n)}`,cause:n}),this[tD]=!0,this.text=t}static isInstance(t){return Tn.hasMarker(t,eD)}};tD=bV;var nD="AI_LoadAPIKeyError",rD=`vercel.ai.error.${nD}`,vV=Symbol.for(rD),aD,pb=class extends Tn{constructor({message:t}){super({name:nD,message:t}),this[aD]=!0}static isInstance(t){return Tn.hasMarker(t,rD)}};aD=vV;var iD="AI_TooManyEmbeddingValuesForCallError",sD=`vercel.ai.error.${iD}`,wV=Symbol.for(sD),oD,ZC=class extends Tn{constructor(t){super({name:iD,message:`Too many values for a single embedding call. The ${t.provider} model "${t.modelId}" can only embed up to ${t.maxEmbeddingsPerCall} values per call, but ${t.values.length} values were provided.`}),this[oD]=!0,this.provider=t.provider,this.modelId=t.modelId,this.maxEmbeddingsPerCall=t.maxEmbeddingsPerCall,this.values=t.values}static isInstance(t){return Tn.hasMarker(t,sD)}};oD=wV;var lD="AI_TypeValidationError",cD=`vercel.ai.error.${lD}`,xV=Symbol.for(cD),uD,_V=class _2 extends Tn{constructor({value:t,cause:n}){super({name:lD,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${l0(n)}`,cause:n}),this[uD]=!0,this.value=t}static isInstance(t){return Tn.hasMarker(t,cD)}static wrap({value:t,cause:n}){return _2.isInstance(n)&&n.value===t?n:new _2({value:t,cause:n})}};uD=xV;var ru=_V,dD="AI_UnsupportedFunctionalityError",fD=`vercel.ai.error.${dD}`,SV=Symbol.for(fD),hD,Tr=class extends Tn{constructor({functionality:t,message:n=`'${t}' functionality not supported.`}){super({name:dD,message:n}),this[hD]=!0,this.functionality=t}static isInstance(t){return Tn.hasMarker(t,fD)}};hD=SV;let EV=(e,t=21)=>(n=t)=>{let r="",a=n|0;for(;a--;)r+=e[Math.random()*e.length|0];return r};var YC={},jw={};jw.byteLength=TV;jw.toByteArray=NV;jw.fromByteArray=jV;var Mo=[],vs=[],CV=typeof Uint8Array<"u"?Uint8Array:Array,tS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var eh=0,kV=tS.length;eh<kV;++eh)Mo[eh]=tS[eh],vs[tS.charCodeAt(eh)]=eh;vs[45]=62;vs[95]=63;function pD(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function TV(e){var t=pD(e),n=t[0],r=t[1];return(n+r)*3/4-r}function AV(e,t,n){return(t+n)*3/4-n}function NV(e){var t,n=pD(e),r=n[0],a=n[1],i=new CV(AV(e,r,a)),s=0,o=a>0?r-4:r,l;for(l=0;l<o;l+=4)t=vs[e.charCodeAt(l)]<<18|vs[e.charCodeAt(l+1)]<<12|vs[e.charCodeAt(l+2)]<<6|vs[e.charCodeAt(l+3)],i[s++]=t>>16&255,i[s++]=t>>8&255,i[s++]=t&255;return a===2&&(t=vs[e.charCodeAt(l)]<<2|vs[e.charCodeAt(l+1)]>>4,i[s++]=t&255),a===1&&(t=vs[e.charCodeAt(l)]<<10|vs[e.charCodeAt(l+1)]<<4|vs[e.charCodeAt(l+2)]>>2,i[s++]=t>>8&255,i[s++]=t&255),i}function RV(e){return Mo[e>>18&63]+Mo[e>>12&63]+Mo[e>>6&63]+Mo[e&63]}function IV(e,t,n){for(var r,a=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),a.push(RV(r));return a.join("")}function jV(e){for(var t,n=e.length,r=n%3,a=[],i=16383,s=0,o=n-r;s<o;s+=i)a.push(IV(e,s,s+i>o?o:s+i));return r===1?(t=e[n-1],a.push(Mo[t>>2]+Mo[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],a.push(Mo[t>>10]+Mo[t>>4&63]+Mo[t<<2&63]+"=")),a.join("")}var XC={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */XC.read=function(e,t,n,r,a){var i,s,o=a*8-r-1,l=(1<<o)-1,u=l>>1,d=-7,h=n?a-1:0,p=n?-1:1,y=e[t+h];for(h+=p,i=y&(1<<-d)-1,y>>=-d,d+=o;d>0;i=i*256+e[t+h],h+=p,d-=8);for(s=i&(1<<-d)-1,i>>=-d,d+=r;d>0;s=s*256+e[t+h],h+=p,d-=8);if(i===0)i=1-u;else{if(i===l)return s?NaN:(y?-1:1)*(1/0);s=s+Math.pow(2,r),i=i-u}return(y?-1:1)*s*Math.pow(2,i-r)};XC.write=function(e,t,n,r,a,i){var s,o,l,u=i*8-a-1,d=(1<<u)-1,h=d>>1,p=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=r?0:i-1,v=r?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?t+=p/l:t+=p*Math.pow(2,1-h),t*l>=2&&(s++,l/=2),s+h>=d?(o=0,s=d):s+h>=1?(o=(t*l-1)*Math.pow(2,a),s=s+h):(o=t*Math.pow(2,h-1)*Math.pow(2,a),s=0));a>=8;e[n+y]=o&255,y+=v,o/=256,a-=8);for(s=s<<a|o,u+=a;u>0;e[n+y]=s&255,y+=v,s/=256,u-=8);e[n+y-v]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=jw,n=XC,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=d,e.SlowBuffer=k,e.INSPECT_MAX_BYTES=50;const a=2147483647;e.kMaxLength=a;const{Uint8Array:i,ArrayBuffer:s,SharedArrayBuffer:o}=globalThis;d.TYPED_ARRAY_SUPPORT=l(),!d.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const be=new i(1),I={foo:function(){return 42}};return Object.setPrototypeOf(I,i.prototype),Object.setPrototypeOf(be,I),be.foo()===42}catch{return!1}}Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}});function u(be){if(be>a)throw new RangeError('The value "'+be+'" is invalid for option "size"');const I=new i(be);return Object.setPrototypeOf(I,d.prototype),I}function d(be,I,G){if(typeof be=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(be)}return h(be,I,G)}d.poolSize=8192;function h(be,I,G){if(typeof be=="string")return b(be,I);if(s.isView(be))return x(be);if(be==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof be);if(it(be,s)||be&&it(be.buffer,s)||typeof o<"u"&&(it(be,o)||be&&it(be.buffer,o)))return S(be,I,G);if(typeof be=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const fe=be.valueOf&&be.valueOf();if(fe!=null&&fe!==be)return d.from(fe,I,G);const je=E(be);if(je)return je;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof be[Symbol.toPrimitive]=="function")return d.from(be[Symbol.toPrimitive]("string"),I,G);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof be)}d.from=function(be,I,G){return h(be,I,G)},Object.setPrototypeOf(d.prototype,i.prototype),Object.setPrototypeOf(d,i);function p(be){if(typeof be!="number")throw new TypeError('"size" argument must be of type number');if(be<0)throw new RangeError('The value "'+be+'" is invalid for option "size"')}function y(be,I,G){return p(be),be<=0?u(be):I!==void 0?typeof G=="string"?u(be).fill(I,G):u(be).fill(I):u(be)}d.alloc=function(be,I,G){return y(be,I,G)};function v(be){return p(be),u(be<0?0:C(be)|0)}d.allocUnsafe=function(be){return v(be)},d.allocUnsafeSlow=function(be){return v(be)};function b(be,I){if((typeof I!="string"||I==="")&&(I="utf8"),!d.isEncoding(I))throw new TypeError("Unknown encoding: "+I);const G=R(be,I)|0;let fe=u(G);const je=fe.write(be,I);return je!==G&&(fe=fe.slice(0,je)),fe}function w(be){const I=be.length<0?0:C(be.length)|0,G=u(I);for(let fe=0;fe<I;fe+=1)G[fe]=be[fe]&255;return G}function x(be){if(it(be,i)){const I=new i(be);return S(I.buffer,I.byteOffset,I.byteLength)}return w(be)}function S(be,I,G){if(I<0||be.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(be.byteLength<I+(G||0))throw new RangeError('"length" is outside of buffer bounds');let fe;return I===void 0&&G===void 0?fe=new i(be):G===void 0?fe=new i(be,I):fe=new i(be,I,G),Object.setPrototypeOf(fe,d.prototype),fe}function E(be){if(d.isBuffer(be)){const I=C(be.length)|0,G=u(I);return G.length===0||be.copy(G,0,0,I),G}if(be.length!==void 0)return typeof be.length!="number"||xt(be.length)?u(0):w(be);if(be.type==="Buffer"&&Array.isArray(be.data))return w(be.data)}function C(be){if(be>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return be|0}function k(be){return+be!=be&&(be=0),d.alloc(+be)}d.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==d.prototype},d.compare=function(I,G){if(it(I,i)&&(I=d.from(I,I.offset,I.byteLength)),it(G,i)&&(G=d.from(G,G.offset,G.byteLength)),!d.isBuffer(I)||!d.isBuffer(G))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===G)return 0;let fe=I.length,je=G.length;for(let ve=0,Ce=Math.min(fe,je);ve<Ce;++ve)if(I[ve]!==G[ve]){fe=I[ve],je=G[ve];break}return fe<je?-1:je<fe?1:0},d.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(I,G){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return d.alloc(0);let fe;if(G===void 0)for(G=0,fe=0;fe<I.length;++fe)G+=I[fe].length;const je=d.allocUnsafe(G);let ve=0;for(fe=0;fe<I.length;++fe){let Ce=I[fe];if(it(Ce,i))ve+Ce.length>je.length?(d.isBuffer(Ce)||(Ce=d.from(Ce)),Ce.copy(je,ve)):i.prototype.set.call(je,Ce,ve);else if(d.isBuffer(Ce))Ce.copy(je,ve);else throw new TypeError('"list" argument must be an Array of Buffers');ve+=Ce.length}return je};function R(be,I){if(d.isBuffer(be))return be.length;if(s.isView(be)||it(be,s))return be.byteLength;if(typeof be!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof be);const G=be.length,fe=arguments.length>2&&arguments[2]===!0;if(!fe&&G===0)return 0;let je=!1;for(;;)switch(I){case"ascii":case"latin1":case"binary":return G;case"utf8":case"utf-8":return _e(be).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G*2;case"hex":return G>>>1;case"base64":return We(be).length;default:if(je)return fe?-1:_e(be).length;I=(""+I).toLowerCase(),je=!0}}d.byteLength=R;function O(be,I,G){let fe=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((G===void 0||G>this.length)&&(G=this.length),G<=0)||(G>>>=0,I>>>=0,G<=I))return"";for(be||(be="utf8");;)switch(be){case"hex":return ee(this,I,G);case"utf8":case"utf-8":return Y(this,I,G);case"ascii":return B(this,I,G);case"latin1":case"binary":return J(this,I,G);case"base64":return re(this,I,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,I,G);default:if(fe)throw new TypeError("Unknown encoding: "+be);be=(be+"").toLowerCase(),fe=!0}}d.prototype._isBuffer=!0;function j(be,I,G){const fe=be[I];be[I]=be[G],be[G]=fe}d.prototype.swap16=function(){const I=this.length;if(I%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let G=0;G<I;G+=2)j(this,G,G+1);return this},d.prototype.swap32=function(){const I=this.length;if(I%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let G=0;G<I;G+=4)j(this,G,G+3),j(this,G+1,G+2);return this},d.prototype.swap64=function(){const I=this.length;if(I%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let G=0;G<I;G+=8)j(this,G,G+7),j(this,G+1,G+6),j(this,G+2,G+5),j(this,G+3,G+4);return this},d.prototype.toString=function(){const I=this.length;return I===0?"":arguments.length===0?Y(this,0,I):O.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(I){if(!d.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I?!0:d.compare(this,I)===0},d.prototype.inspect=function(){let I="";const G=e.INSPECT_MAX_BYTES;return I=this.toString("hex",0,G).replace(/(.{2})/g,"$1 ").trim(),this.length>G&&(I+=" ... "),"<Buffer "+I+">"},r&&(d.prototype[r]=d.prototype.inspect),d.prototype.compare=function(I,G,fe,je,ve){if(it(I,i)&&(I=d.from(I,I.offset,I.byteLength)),!d.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(G===void 0&&(G=0),fe===void 0&&(fe=I?I.length:0),je===void 0&&(je=0),ve===void 0&&(ve=this.length),G<0||fe>I.length||je<0||ve>this.length)throw new RangeError("out of range index");if(je>=ve&&G>=fe)return 0;if(je>=ve)return-1;if(G>=fe)return 1;if(G>>>=0,fe>>>=0,je>>>=0,ve>>>=0,this===I)return 0;let Ce=ve-je,ce=fe-G;const ft=Math.min(Ce,ce),vt=this.slice(je,ve),M=I.slice(G,fe);for(let Be=0;Be<ft;++Be)if(vt[Be]!==M[Be]){Ce=vt[Be],ce=M[Be];break}return Ce<ce?-1:ce<Ce?1:0};function $(be,I,G,fe,je){if(be.length===0)return-1;if(typeof G=="string"?(fe=G,G=0):G>2147483647?G=2147483647:G<-2147483648&&(G=-2147483648),G=+G,xt(G)&&(G=je?0:be.length-1),G<0&&(G=be.length+G),G>=be.length){if(je)return-1;G=be.length-1}else if(G<0)if(je)G=0;else return-1;if(typeof I=="string"&&(I=d.from(I,fe)),d.isBuffer(I))return I.length===0?-1:L(be,I,G,fe,je);if(typeof I=="number")return I=I&255,typeof i.prototype.indexOf=="function"?je?i.prototype.indexOf.call(be,I,G):i.prototype.lastIndexOf.call(be,I,G):L(be,[I],G,fe,je);throw new TypeError("val must be string, number or Buffer")}function L(be,I,G,fe,je){let ve=1,Ce=be.length,ce=I.length;if(fe!==void 0&&(fe=String(fe).toLowerCase(),fe==="ucs2"||fe==="ucs-2"||fe==="utf16le"||fe==="utf-16le")){if(be.length<2||I.length<2)return-1;ve=2,Ce/=2,ce/=2,G/=2}function ft(M,Be){return ve===1?M[Be]:M.readUInt16BE(Be*ve)}let vt;if(je){let M=-1;for(vt=G;vt<Ce;vt++)if(ft(be,vt)===ft(I,M===-1?0:vt-M)){if(M===-1&&(M=vt),vt-M+1===ce)return M*ve}else M!==-1&&(vt-=vt-M),M=-1}else for(G+ce>Ce&&(G=Ce-ce),vt=G;vt>=0;vt--){let M=!0;for(let Be=0;Be<ce;Be++)if(ft(be,vt+Be)!==ft(I,Be)){M=!1;break}if(M)return vt}return-1}d.prototype.includes=function(I,G,fe){return this.indexOf(I,G,fe)!==-1},d.prototype.indexOf=function(I,G,fe){return $(this,I,G,fe,!0)},d.prototype.lastIndexOf=function(I,G,fe){return $(this,I,G,fe,!1)};function X(be,I,G,fe){G=Number(G)||0;const je=be.length-G;fe?(fe=Number(fe),fe>je&&(fe=je)):fe=je;const ve=I.length;fe>ve/2&&(fe=ve/2);let Ce;for(Ce=0;Ce<fe;++Ce){const ce=parseInt(I.substr(Ce*2,2),16);if(xt(ce))return Ce;be[G+Ce]=ce}return Ce}function F(be,I,G,fe){return kt(_e(I,be.length-G),be,G,fe)}function K(be,I,G,fe){return kt(Me(I),be,G,fe)}function q(be,I,G,fe){return kt(We(I),be,G,fe)}function de(be,I,G,fe){return kt(Ee(I,be.length-G),be,G,fe)}d.prototype.write=function(I,G,fe,je){if(G===void 0)je="utf8",fe=this.length,G=0;else if(fe===void 0&&typeof G=="string")je=G,fe=this.length,G=0;else if(isFinite(G))G=G>>>0,isFinite(fe)?(fe=fe>>>0,je===void 0&&(je="utf8")):(je=fe,fe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ve=this.length-G;if((fe===void 0||fe>ve)&&(fe=ve),I.length>0&&(fe<0||G<0)||G>this.length)throw new RangeError("Attempt to write outside buffer bounds");je||(je="utf8");let Ce=!1;for(;;)switch(je){case"hex":return X(this,I,G,fe);case"utf8":case"utf-8":return F(this,I,G,fe);case"ascii":case"latin1":case"binary":return K(this,I,G,fe);case"base64":return q(this,I,G,fe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return de(this,I,G,fe);default:if(Ce)throw new TypeError("Unknown encoding: "+je);je=(""+je).toLowerCase(),Ce=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function re(be,I,G){return I===0&&G===be.length?t.fromByteArray(be):t.fromByteArray(be.slice(I,G))}function Y(be,I,G){G=Math.min(be.length,G);const fe=[];let je=I;for(;je<G;){const ve=be[je];let Ce=null,ce=ve>239?4:ve>223?3:ve>191?2:1;if(je+ce<=G){let ft,vt,M,Be;switch(ce){case 1:ve<128&&(Ce=ve);break;case 2:ft=be[je+1],(ft&192)===128&&(Be=(ve&31)<<6|ft&63,Be>127&&(Ce=Be));break;case 3:ft=be[je+1],vt=be[je+2],(ft&192)===128&&(vt&192)===128&&(Be=(ve&15)<<12|(ft&63)<<6|vt&63,Be>2047&&(Be<55296||Be>57343)&&(Ce=Be));break;case 4:ft=be[je+1],vt=be[je+2],M=be[je+3],(ft&192)===128&&(vt&192)===128&&(M&192)===128&&(Be=(ve&15)<<18|(ft&63)<<12|(vt&63)<<6|M&63,Be>65535&&Be<1114112&&(Ce=Be))}}Ce===null?(Ce=65533,ce=1):Ce>65535&&(Ce-=65536,fe.push(Ce>>>10&1023|55296),Ce=56320|Ce&1023),fe.push(Ce),je+=ce}return ae(fe)}const Q=4096;function ae(be){const I=be.length;if(I<=Q)return String.fromCharCode.apply(String,be);let G="",fe=0;for(;fe<I;)G+=String.fromCharCode.apply(String,be.slice(fe,fe+=Q));return G}function B(be,I,G){let fe="";G=Math.min(be.length,G);for(let je=I;je<G;++je)fe+=String.fromCharCode(be[je]&127);return fe}function J(be,I,G){let fe="";G=Math.min(be.length,G);for(let je=I;je<G;++je)fe+=String.fromCharCode(be[je]);return fe}function ee(be,I,G){const fe=be.length;(!I||I<0)&&(I=0),(!G||G<0||G>fe)&&(G=fe);let je="";for(let ve=I;ve<G;++ve)je+=Dt[be[ve]];return je}function oe(be,I,G){const fe=be.slice(I,G);let je="";for(let ve=0;ve<fe.length-1;ve+=2)je+=String.fromCharCode(fe[ve]+fe[ve+1]*256);return je}d.prototype.slice=function(I,G){const fe=this.length;I=~~I,G=G===void 0?fe:~~G,I<0?(I+=fe,I<0&&(I=0)):I>fe&&(I=fe),G<0?(G+=fe,G<0&&(G=0)):G>fe&&(G=fe),G<I&&(G=I);const je=this.subarray(I,G);return Object.setPrototypeOf(je,d.prototype),je};function me(be,I,G){if(be%1!==0||be<0)throw new RangeError("offset is not uint");if(be+I>G)throw new RangeError("Trying to access beyond buffer length")}d.prototype.readUintLE=d.prototype.readUIntLE=function(I,G,fe){I=I>>>0,G=G>>>0,fe||me(I,G,this.length);let je=this[I],ve=1,Ce=0;for(;++Ce<G&&(ve*=256);)je+=this[I+Ce]*ve;return je},d.prototype.readUintBE=d.prototype.readUIntBE=function(I,G,fe){I=I>>>0,G=G>>>0,fe||me(I,G,this.length);let je=this[I+--G],ve=1;for(;G>0&&(ve*=256);)je+=this[I+--G]*ve;return je},d.prototype.readUint8=d.prototype.readUInt8=function(I,G){return I=I>>>0,G||me(I,1,this.length),this[I]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(I,G){return I=I>>>0,G||me(I,2,this.length),this[I]|this[I+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(I,G){return I=I>>>0,G||me(I,2,this.length),this[I]<<8|this[I+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(I,G){return I=I>>>0,G||me(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+this[I+3]*16777216},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(I,G){return I=I>>>0,G||me(I,4,this.length),this[I]*16777216+(this[I+1]<<16|this[I+2]<<8|this[I+3])},d.prototype.readBigUInt64LE=Ot(function(I){I=I>>>0,Te(I,"offset");const G=this[I],fe=this[I+7];(G===void 0||fe===void 0)&&le(I,this.length-8);const je=G+this[++I]*2**8+this[++I]*2**16+this[++I]*2**24,ve=this[++I]+this[++I]*2**8+this[++I]*2**16+fe*2**24;return BigInt(je)+(BigInt(ve)<<BigInt(32))}),d.prototype.readBigUInt64BE=Ot(function(I){I=I>>>0,Te(I,"offset");const G=this[I],fe=this[I+7];(G===void 0||fe===void 0)&&le(I,this.length-8);const je=G*2**24+this[++I]*2**16+this[++I]*2**8+this[++I],ve=this[++I]*2**24+this[++I]*2**16+this[++I]*2**8+fe;return(BigInt(je)<<BigInt(32))+BigInt(ve)}),d.prototype.readIntLE=function(I,G,fe){I=I>>>0,G=G>>>0,fe||me(I,G,this.length);let je=this[I],ve=1,Ce=0;for(;++Ce<G&&(ve*=256);)je+=this[I+Ce]*ve;return ve*=128,je>=ve&&(je-=Math.pow(2,8*G)),je},d.prototype.readIntBE=function(I,G,fe){I=I>>>0,G=G>>>0,fe||me(I,G,this.length);let je=G,ve=1,Ce=this[I+--je];for(;je>0&&(ve*=256);)Ce+=this[I+--je]*ve;return ve*=128,Ce>=ve&&(Ce-=Math.pow(2,8*G)),Ce},d.prototype.readInt8=function(I,G){return I=I>>>0,G||me(I,1,this.length),this[I]&128?(255-this[I]+1)*-1:this[I]},d.prototype.readInt16LE=function(I,G){I=I>>>0,G||me(I,2,this.length);const fe=this[I]|this[I+1]<<8;return fe&32768?fe|4294901760:fe},d.prototype.readInt16BE=function(I,G){I=I>>>0,G||me(I,2,this.length);const fe=this[I+1]|this[I]<<8;return fe&32768?fe|4294901760:fe},d.prototype.readInt32LE=function(I,G){return I=I>>>0,G||me(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},d.prototype.readInt32BE=function(I,G){return I=I>>>0,G||me(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},d.prototype.readBigInt64LE=Ot(function(I){I=I>>>0,Te(I,"offset");const G=this[I],fe=this[I+7];(G===void 0||fe===void 0)&&le(I,this.length-8);const je=this[I+4]+this[I+5]*2**8+this[I+6]*2**16+(fe<<24);return(BigInt(je)<<BigInt(32))+BigInt(G+this[++I]*2**8+this[++I]*2**16+this[++I]*2**24)}),d.prototype.readBigInt64BE=Ot(function(I){I=I>>>0,Te(I,"offset");const G=this[I],fe=this[I+7];(G===void 0||fe===void 0)&&le(I,this.length-8);const je=(G<<24)+this[++I]*2**16+this[++I]*2**8+this[++I];return(BigInt(je)<<BigInt(32))+BigInt(this[++I]*2**24+this[++I]*2**16+this[++I]*2**8+fe)}),d.prototype.readFloatLE=function(I,G){return I=I>>>0,G||me(I,4,this.length),n.read(this,I,!0,23,4)},d.prototype.readFloatBE=function(I,G){return I=I>>>0,G||me(I,4,this.length),n.read(this,I,!1,23,4)},d.prototype.readDoubleLE=function(I,G){return I=I>>>0,G||me(I,8,this.length),n.read(this,I,!0,52,8)},d.prototype.readDoubleBE=function(I,G){return I=I>>>0,G||me(I,8,this.length),n.read(this,I,!1,52,8)};function xe(be,I,G,fe,je,ve){if(!d.isBuffer(be))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>je||I<ve)throw new RangeError('"value" argument is out of bounds');if(G+fe>be.length)throw new RangeError("Index out of range")}d.prototype.writeUintLE=d.prototype.writeUIntLE=function(I,G,fe,je){if(I=+I,G=G>>>0,fe=fe>>>0,!je){const ce=Math.pow(2,8*fe)-1;xe(this,I,G,fe,ce,0)}let ve=1,Ce=0;for(this[G]=I&255;++Ce<fe&&(ve*=256);)this[G+Ce]=I/ve&255;return G+fe},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(I,G,fe,je){if(I=+I,G=G>>>0,fe=fe>>>0,!je){const ce=Math.pow(2,8*fe)-1;xe(this,I,G,fe,ce,0)}let ve=fe-1,Ce=1;for(this[G+ve]=I&255;--ve>=0&&(Ce*=256);)this[G+ve]=I/Ce&255;return G+fe},d.prototype.writeUint8=d.prototype.writeUInt8=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,1,255,0),this[G]=I&255,G+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,2,65535,0),this[G]=I&255,this[G+1]=I>>>8,G+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,2,65535,0),this[G]=I>>>8,this[G+1]=I&255,G+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,4,4294967295,0),this[G+3]=I>>>24,this[G+2]=I>>>16,this[G+1]=I>>>8,this[G]=I&255,G+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,4,4294967295,0),this[G]=I>>>24,this[G+1]=I>>>16,this[G+2]=I>>>8,this[G+3]=I&255,G+4};function Pe(be,I,G,fe,je){ge(I,fe,je,be,G,7);let ve=Number(I&BigInt(4294967295));be[G++]=ve,ve=ve>>8,be[G++]=ve,ve=ve>>8,be[G++]=ve,ve=ve>>8,be[G++]=ve;let Ce=Number(I>>BigInt(32)&BigInt(4294967295));return be[G++]=Ce,Ce=Ce>>8,be[G++]=Ce,Ce=Ce>>8,be[G++]=Ce,Ce=Ce>>8,be[G++]=Ce,G}function Ne(be,I,G,fe,je){ge(I,fe,je,be,G,7);let ve=Number(I&BigInt(4294967295));be[G+7]=ve,ve=ve>>8,be[G+6]=ve,ve=ve>>8,be[G+5]=ve,ve=ve>>8,be[G+4]=ve;let Ce=Number(I>>BigInt(32)&BigInt(4294967295));return be[G+3]=Ce,Ce=Ce>>8,be[G+2]=Ce,Ce=Ce>>8,be[G+1]=Ce,Ce=Ce>>8,be[G]=Ce,G+8}d.prototype.writeBigUInt64LE=Ot(function(I,G=0){return Pe(this,I,G,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeBigUInt64BE=Ot(function(I,G=0){return Ne(this,I,G,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeIntLE=function(I,G,fe,je){if(I=+I,G=G>>>0,!je){const ft=Math.pow(2,8*fe-1);xe(this,I,G,fe,ft-1,-ft)}let ve=0,Ce=1,ce=0;for(this[G]=I&255;++ve<fe&&(Ce*=256);)I<0&&ce===0&&this[G+ve-1]!==0&&(ce=1),this[G+ve]=(I/Ce>>0)-ce&255;return G+fe},d.prototype.writeIntBE=function(I,G,fe,je){if(I=+I,G=G>>>0,!je){const ft=Math.pow(2,8*fe-1);xe(this,I,G,fe,ft-1,-ft)}let ve=fe-1,Ce=1,ce=0;for(this[G+ve]=I&255;--ve>=0&&(Ce*=256);)I<0&&ce===0&&this[G+ve+1]!==0&&(ce=1),this[G+ve]=(I/Ce>>0)-ce&255;return G+fe},d.prototype.writeInt8=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,1,127,-128),I<0&&(I=255+I+1),this[G]=I&255,G+1},d.prototype.writeInt16LE=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,2,32767,-32768),this[G]=I&255,this[G+1]=I>>>8,G+2},d.prototype.writeInt16BE=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,2,32767,-32768),this[G]=I>>>8,this[G+1]=I&255,G+2},d.prototype.writeInt32LE=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,4,2147483647,-2147483648),this[G]=I&255,this[G+1]=I>>>8,this[G+2]=I>>>16,this[G+3]=I>>>24,G+4},d.prototype.writeInt32BE=function(I,G,fe){return I=+I,G=G>>>0,fe||xe(this,I,G,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[G]=I>>>24,this[G+1]=I>>>16,this[G+2]=I>>>8,this[G+3]=I&255,G+4},d.prototype.writeBigInt64LE=Ot(function(I,G=0){return Pe(this,I,G,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),d.prototype.writeBigInt64BE=Ot(function(I,G=0){return Ne(this,I,G,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Re(be,I,G,fe,je,ve){if(G+fe>be.length)throw new RangeError("Index out of range");if(G<0)throw new RangeError("Index out of range")}function ke(be,I,G,fe,je){return I=+I,G=G>>>0,je||Re(be,I,G,4),n.write(be,I,G,fe,23,4),G+4}d.prototype.writeFloatLE=function(I,G,fe){return ke(this,I,G,!0,fe)},d.prototype.writeFloatBE=function(I,G,fe){return ke(this,I,G,!1,fe)};function Fe(be,I,G,fe,je){return I=+I,G=G>>>0,je||Re(be,I,G,8),n.write(be,I,G,fe,52,8),G+8}d.prototype.writeDoubleLE=function(I,G,fe){return Fe(this,I,G,!0,fe)},d.prototype.writeDoubleBE=function(I,G,fe){return Fe(this,I,G,!1,fe)},d.prototype.copy=function(I,G,fe,je){if(!d.isBuffer(I))throw new TypeError("argument should be a Buffer");if(fe||(fe=0),!je&&je!==0&&(je=this.length),G>=I.length&&(G=I.length),G||(G=0),je>0&&je<fe&&(je=fe),je===fe||I.length===0||this.length===0)return 0;if(G<0)throw new RangeError("targetStart out of bounds");if(fe<0||fe>=this.length)throw new RangeError("Index out of range");if(je<0)throw new RangeError("sourceEnd out of bounds");je>this.length&&(je=this.length),I.length-G<je-fe&&(je=I.length-G+fe);const ve=je-fe;return this===I&&typeof i.prototype.copyWithin=="function"?this.copyWithin(G,fe,je):i.prototype.set.call(I,this.subarray(fe,je),G),ve},d.prototype.fill=function(I,G,fe,je){if(typeof I=="string"){if(typeof G=="string"?(je=G,G=0,fe=this.length):typeof fe=="string"&&(je=fe,fe=this.length),je!==void 0&&typeof je!="string")throw new TypeError("encoding must be a string");if(typeof je=="string"&&!d.isEncoding(je))throw new TypeError("Unknown encoding: "+je);if(I.length===1){const Ce=I.charCodeAt(0);(je==="utf8"&&Ce<128||je==="latin1")&&(I=Ce)}}else typeof I=="number"?I=I&255:typeof I=="boolean"&&(I=Number(I));if(G<0||this.length<G||this.length<fe)throw new RangeError("Out of range index");if(fe<=G)return this;G=G>>>0,fe=fe===void 0?this.length:fe>>>0,I||(I=0);let ve;if(typeof I=="number")for(ve=G;ve<fe;++ve)this[ve]=I;else{const Ce=d.isBuffer(I)?I:d.from(I,je),ce=Ce.length;if(ce===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(ve=0;ve<fe-G;++ve)this[ve+G]=Ce[ve%ce]}return this};const Qe={};function Le(be,I,G){Qe[be]=class extends G{constructor(){super(),Object.defineProperty(this,"message",{value:I.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${be}]`,this.stack,delete this.name}get code(){return be}set code(je){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:je,writable:!0})}toString(){return`${this.name} [${be}]: ${this.message}`}}}Le("ERR_BUFFER_OUT_OF_BOUNDS",function(be){return be?`${be} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Le("ERR_INVALID_ARG_TYPE",function(be,I){return`The "${be}" argument must be of type number. Received type ${typeof I}`},TypeError),Le("ERR_OUT_OF_RANGE",function(be,I,G){let fe=`The value of "${be}" is out of range.`,je=G;return Number.isInteger(G)&&Math.abs(G)>2**32?je=Ie(String(G)):typeof G=="bigint"&&(je=String(G),(G>BigInt(2)**BigInt(32)||G<-(BigInt(2)**BigInt(32)))&&(je=Ie(je)),je+="n"),fe+=` It must be ${I}. Received ${je}`,fe},RangeError);function Ie(be){let I="",G=be.length;const fe=be[0]==="-"?1:0;for(;G>=fe+4;G-=3)I=`_${be.slice(G-3,G)}${I}`;return`${be.slice(0,G)}${I}`}function V(be,I,G){Te(I,"offset"),(be[I]===void 0||be[I+G]===void 0)&&le(I,be.length-(G+1))}function ge(be,I,G,fe,je,ve){if(be>G||be<I){const Ce=typeof I=="bigint"?"n":"";let ce;throw I===0||I===BigInt(0)?ce=`>= 0${Ce} and < 2${Ce} ** ${(ve+1)*8}${Ce}`:ce=`>= -(2${Ce} ** ${(ve+1)*8-1}${Ce}) and < 2 ** ${(ve+1)*8-1}${Ce}`,new Qe.ERR_OUT_OF_RANGE("value",ce,be)}V(fe,je,ve)}function Te(be,I){if(typeof be!="number")throw new Qe.ERR_INVALID_ARG_TYPE(I,"number",be)}function le(be,I,G){throw Math.floor(be)!==be?(Te(be,G),new Qe.ERR_OUT_OF_RANGE("offset","an integer",be)):I<0?new Qe.ERR_BUFFER_OUT_OF_BOUNDS:new Qe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${I}`,be)}const ie=/[^+/0-9A-Za-z-_]/g;function te(be){if(be=be.split("=")[0],be=be.trim().replace(ie,""),be.length<2)return"";for(;be.length%4!==0;)be=be+"=";return be}function _e(be,I){I=I||1/0;let G;const fe=be.length;let je=null;const ve=[];for(let Ce=0;Ce<fe;++Ce){if(G=be.charCodeAt(Ce),G>55295&&G<57344){if(!je){if(G>56319){(I-=3)>-1&&ve.push(239,191,189);continue}else if(Ce+1===fe){(I-=3)>-1&&ve.push(239,191,189);continue}je=G;continue}if(G<56320){(I-=3)>-1&&ve.push(239,191,189),je=G;continue}G=(je-55296<<10|G-56320)+65536}else je&&(I-=3)>-1&&ve.push(239,191,189);if(je=null,G<128){if((I-=1)<0)break;ve.push(G)}else if(G<2048){if((I-=2)<0)break;ve.push(G>>6|192,G&63|128)}else if(G<65536){if((I-=3)<0)break;ve.push(G>>12|224,G>>6&63|128,G&63|128)}else if(G<1114112){if((I-=4)<0)break;ve.push(G>>18|240,G>>12&63|128,G>>6&63|128,G&63|128)}else throw new Error("Invalid code point")}return ve}function Me(be){const I=[];for(let G=0;G<be.length;++G)I.push(be.charCodeAt(G)&255);return I}function Ee(be,I){let G,fe,je;const ve=[];for(let Ce=0;Ce<be.length&&!((I-=2)<0);++Ce)G=be.charCodeAt(Ce),fe=G>>8,je=G%256,ve.push(je),ve.push(fe);return ve}function We(be){return t.toByteArray(te(be))}function kt(be,I,G,fe){let je;for(je=0;je<fe&&!(je+G>=I.length||je>=be.length);++je)I[je+G]=be[je];return je}function it(be,I){return be instanceof I||be!=null&&be.constructor!=null&&be.constructor.name!=null&&be.constructor.name===I.name}function xt(be){return be!==be}const Dt=function(){const be="0123456789abcdef",I=new Array(256);for(let G=0;G<16;++G){const fe=G*16;for(let je=0;je<16;++je)I[fe+je]=be[G]+be[je]}return I}();function Ot(be){return typeof BigInt>"u"?Wt:be}function Wt(){throw new Error("BigInt not supported")}})(YC);const Xt=YC.Buffer,Pr=YC.Buffer;var cd={exports:{}},RI;function OV(){if(RI)return cd.exports;RI=1;const e=typeof Xt<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,u){u==null&&l!==null&&typeof l=="object"&&(u=l,l=void 0),e&&Xt.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const d=JSON.parse(o,l);if(d===null||typeof d!="object")return d;const h=u&&u.protoAction||"error",p=u&&u.constructorAction||"error";if(h==="ignore"&&p==="ignore")return d;if(h!=="ignore"&&p!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return d}else if(h!=="ignore"&&p==="ignore"){if(t.test(o)===!1)return d}else if(n.test(o)===!1)return d;return a(d,{protoAction:h,constructorAction:p,safe:u&&u.safe})}function a(o,{protoAction:l="error",constructorAction:u="error",safe:d}={}){let h=[o];for(;h.length;){const p=h;h=[];for(const y of p){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(y,"__proto__")){if(d===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete y.__proto__}if(u!=="ignore"&&Object.prototype.hasOwnProperty.call(y,"constructor")&&Object.prototype.hasOwnProperty.call(y.constructor,"prototype")){if(d===!0)return null;if(u==="error")throw new SyntaxError("Object contains forbidden prototype property");delete y.constructor}for(const v in y){const b=y[v];b&&typeof b=="object"&&h.push(b)}}}return o}function i(o,l,u){const d=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,u)}finally{Error.stackTraceLimit=d}}function s(o,l){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=u}}return cd.exports=i,cd.exports.default=i,cd.exports.parse=i,cd.exports.safeParse=s,cd.exports.scan=a,cd.exports}var DV=OV();const oo=di(DV);var MV={};function Ho(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function PV(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function FV(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function LV(){let e="",t,n=[],r,a;function i(l,u){if(l===""){s(u);return}if(l.startsWith(":"))return;const d=l.indexOf(":");if(d===-1){o(l,"");return}const h=l.slice(0,d),p=d+1,y=p<l.length&&l[p]===" "?l.slice(p+1):l.slice(p);o(h,y)}function s(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:a}),n=[],t=void 0,a=void 0)}function o(l,u){switch(l){case"event":t=u;break;case"data":n.push(u);break;case"id":r=u;break;case"retry":const d=parseInt(u,10);isNaN(d)||(a=d);break}}return new TransformStream({transform(l,u){const{lines:d,incompleteLine:h}=$V(e,l);e=h;for(let p=0;p<d.length;p++)i(d[p],u)},flush(l){i(e,l),s(l)}})}function $V(e,t){const n=[];let r=e;for(let a=0;a<t.length;){const i=t[a++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[a+1]===`
`&&a++):r+=i}return{lines:n,incompleteLine:r}}function c0(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Gd=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=EV(n,t);if(e==null)return a;if(n.includes(r))throw new KC({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${a(i)}`},Po=Gd();function BV(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function zV(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function ev(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function UV({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new pb({message:`${r} API key must be a string.`});if(typeof ea>"u")throw new pb({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=MV[t],e==null)throw new pb({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new pb({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var mv=Symbol.for("vercel.ai.validator");function qV(e){return{[mv]:!0,validate:e}}function HV(e){return typeof e=="object"&&e!==null&&mv in e&&e[mv]===!0&&"validate"in e}function VV(e){return HV(e)?e:GV(e)}function GV(e){return qV(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function WV({value:e,schema:t}){const n=Qh({value:e,schema:t});if(!n.success)throw ru.wrap({value:e,cause:n.error});return n.value}function Qh({value:e,schema:t}){const n=VV(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:ru.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:ru.wrap({value:e,cause:r})}}}function KV({text:e,schema:t}){try{const n=oo.parse(e);return t==null?n:WV({value:n,schema:t})}catch(n){throw nu.isInstance(n)||ru.isInstance(n)?n:new nu({text:e,cause:n})}}function Id({text:e,schema:t}){try{const n=oo.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=Qh({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:nu.isInstance(n)?n:new nu({text:e,cause:n})}}}function II(e){try{return oo.parse(e),!0}catch{return!1}}function ZV({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=Qh({value:t[e],schema:n});if(!r.success)throw new KC({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var YV=()=>globalThis.fetch,Js=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s})=>XV({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s}),XV=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:a,abortSignal:i,fetch:s=YV()})=>{try{const o=await s(e,{method:"POST",headers:zV(t),body:n.content,signal:i}),l=c0(o);if(!o.ok){let u;try{u=await a({response:o,url:e,requestBodyValues:n.values})}catch(d){throw ev(d)||xa.isInstance(d)?d:new xa({message:"Failed to process error response",cause:d,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw u.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(u){throw u instanceof Error&&(ev(u)||xa.isInstance(u))?u:new xa({message:"Failed to process successful response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(ev(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new xa({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}},mD=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:a,requestBodyValues:i})=>{const s=await r.text(),o=c0(r);if(s.trim()==="")return{responseHeaders:o,value:new xa({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:n==null?void 0:n(r)})};try{const l=KV({text:s,schema:e});return{responseHeaders:o,value:new xa({message:t(l),url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new xa({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:n==null?void 0:n(r)})}}},JC=e=>async({response:t})=>{const n=c0(t);if(t.body==null)throw new WC({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(LV()).pipeThrough(new TransformStream({transform({data:r},a){r!=="[DONE]"&&a.enqueue(Id({text:r,schema:e}))}}))}},Wd=e=>async({response:t,url:n,requestBodyValues:r})=>{const a=await t.text(),i=Id({text:a,schema:e}),s=c0(t);if(!i.success)throw new xa({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:s,responseBody:a,url:n,requestBodyValues:r});return{responseHeaders:s,value:i.value,rawValue:i.rawValue}},{btoa:JV,atob:QV}=globalThis;function gD(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=QV(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function Th(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return JV(t)}function yD(e){return e==null?void 0:e.replace(/\/$/,"")}var ar;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function n(a){throw new Error}e.assertNever=n,e.arrayToEnum=a=>{const i={};for(const s of a)i[s]=s;return i},e.getValidEnumValues=a=>{const i=e.objectKeys(a).filter(o=>typeof a[a[o]]!="number"),s={};for(const o of i)s[o]=a[o];return e.objectValues(s)},e.objectValues=a=>e.objectKeys(a).map(function(i){return a[i]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const s in a)Object.prototype.hasOwnProperty.call(a,s)&&i.push(s);return i},e.find=(a,i)=>{for(const s of a)if(i(s))return s},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(ar||(ar={}));var S2;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(S2||(S2={}));const nn=ar.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Il=e=>{switch(typeof e){case"undefined":return nn.undefined;case"string":return nn.string;case"number":return isNaN(e)?nn.nan:nn.number;case"boolean":return nn.boolean;case"function":return nn.function;case"bigint":return nn.bigint;case"symbol":return nn.symbol;case"object":return Array.isArray(e)?nn.array:e===null?nn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?nn.promise:typeof Map<"u"&&e instanceof Map?nn.map:typeof Set<"u"&&e instanceof Set?nn.set:typeof Date<"u"&&e instanceof Date?nn.date:nn.object;default:return nn.unknown}},Lt=ar.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),eG=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class ns extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},a=i=>{for(const s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(a);else if(s.code==="invalid_return_type")a(s.returnTypeError);else if(s.code==="invalid_arguments")a(s.argumentsError);else if(s.path.length===0)r._errors.push(n(s));else{let o=r,l=0;for(;l<s.path.length;){const u=s.path[l];l===s.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(n(s))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return a(this),r}static assert(t){if(!(t instanceof ns))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ar.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const a of this.issues)a.path.length>0?(n[a.path[0]]=n[a.path[0]]||[],n[a.path[0]].push(t(a))):r.push(t(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}ns.create=e=>new ns(e);const Ah=(e,t)=>{let n;switch(e.code){case Lt.invalid_type:e.received===nn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Lt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,ar.jsonStringifyReplacer)}`;break;case Lt.unrecognized_keys:n=`Unrecognized key(s) in object: ${ar.joinValues(e.keys,", ")}`;break;case Lt.invalid_union:n="Invalid input";break;case Lt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${ar.joinValues(e.options)}`;break;case Lt.invalid_enum_value:n=`Invalid enum value. Expected ${ar.joinValues(e.options)}, received '${e.received}'`;break;case Lt.invalid_arguments:n="Invalid function arguments";break;case Lt.invalid_return_type:n="Invalid function return type";break;case Lt.invalid_date:n="Invalid date";break;case Lt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:ar.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Lt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Lt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Lt.custom:n="Invalid input";break;case Lt.invalid_intersection_types:n="Intersection results could not be merged";break;case Lt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Lt.not_finite:n="Number must be finite";break;default:n=t.defaultError,ar.assertNever(e)}return{message:n}};let bD=Ah;function tG(e){bD=e}function gv(){return bD}const yv=e=>{const{data:t,path:n,errorMaps:r,issueData:a}=e,i=[...n,...a.path||[]],s={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(s,{data:t,defaultError:o}).message;return{...a,path:i,message:o}},nG=[];function Qt(e,t){const n=gv(),r=yv({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Ah?void 0:Ah].filter(a=>!!a)});e.common.issues.push(r)}class oi{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const a of n){if(a.status==="aborted")return En;a.status==="dirty"&&t.dirty(),r.push(a.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const a of n){const i=await a.key,s=await a.value;r.push({key:i,value:s})}return oi.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const a of n){const{key:i,value:s}=a;if(i.status==="aborted"||s.status==="aborted")return En;i.status==="dirty"&&t.dirty(),s.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||a.alwaysSet)&&(r[i.value]=s.value)}return{status:t.value,value:r}}}const En=Object.freeze({status:"aborted"}),dh=e=>({status:"dirty",value:e}),xi=e=>({status:"valid",value:e}),E2=e=>e.status==="aborted",C2=e=>e.status==="dirty",jd=e=>e.status==="valid",ig=e=>typeof Promise<"u"&&e instanceof Promise;function bv(e,t,n,r){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function vD(e,t,n,r,a){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}var un;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(un||(un={}));var Um,qm;class Vo{constructor(t,n,r,a){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const jI=(e,t)=>{if(jd(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new ns(e.common.issues);return this._error=n,this._error}}};function On(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(s,o)=>{var l,u;const{message:d}=e;return s.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:(l=d??r)!==null&&l!==void 0?l:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(u=d??n)!==null&&u!==void 0?u:o.defaultError}},description:a}}class Pn{get description(){return this._def.description}_getType(t){return Il(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Il(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new oi,ctx:{common:t.parent.common,data:t.data,parsedType:Il(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(ig(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){var r;const a={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Il(t)},i=this._parseSync({data:t,path:a.path,parent:a});return jI(a,i)}"~validate"(t){var n,r;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Il(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:a});return jd(i)?{value:i.value}:{issues:a.common.issues}}catch(i){!((r=(n=i==null?void 0:i.message)===null||n===void 0?void 0:n.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:a}).then(i=>jd(i)?{value:i.value}:{issues:a.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Il(t)},a=this._parse({data:t,path:r.path,parent:r}),i=await(ig(a)?a:Promise.resolve(a));return jI(r,i)}refine(t,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const s=t(a),o=()=>i.addIssue({code:Lt.custom,...r(a)});return typeof Promise<"u"&&s instanceof Promise?s.then(l=>l?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,a)=>t(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(t){return new Qs({schema:this,typeName:qt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Ks.create(this,this._def)}nullable(){return ou.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ws.create(this)}promise(){return Rh.create(this,this._def)}or(t){return cg.create([this,t],this._def)}and(t){return ug.create(this,t,this._def)}transform(t){return new Qs({...On(this._def),schema:this,typeName:qt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new mg({...On(this._def),innerType:this,defaultValue:n,typeName:qt.ZodDefault})}brand(){return new QC({typeName:qt.ZodBranded,type:this,...On(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new gg({...On(this._def),innerType:this,catchValue:n,typeName:qt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return u0.create(this,t)}readonly(){return yg.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const rG=/^c[^\s-]{8,}$/i,aG=/^[0-9a-z]+$/,iG=/^[0-9A-HJKMNP-TV-Z]{26}$/i,sG=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,oG=/^[a-z0-9_-]{21}$/i,lG=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,cG=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,uG=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,dG="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let nS;const fG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,hG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,pG=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,mG=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,gG=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,yG=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,wD="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",bG=new RegExp(`^${wD}$`);function xD(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function vG(e){return new RegExp(`^${xD(e)}$`)}function _D(e){let t=`${wD}T${xD(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function wG(e,t){return!!((t==="v4"||!t)&&fG.test(e)||(t==="v6"||!t)&&pG.test(e))}function xG(e,t){if(!lG.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||!a.typ||!a.alg||t&&a.alg!==t)}catch{return!1}}function _G(e,t){return!!((t==="v4"||!t)&&hG.test(e)||(t==="v6"||!t)&&mG.test(e))}class Hs extends Pn{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==nn.string){const i=this._getOrReturnCtx(t);return Qt(i,{code:Lt.invalid_type,expected:nn.string,received:i.parsedType}),En}const r=new oi;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const s=t.data.length>i.value,o=t.data.length<i.value;(s||o)&&(a=this._getOrReturnCtx(t,a),s?Qt(a,{code:Lt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&Qt(a,{code:Lt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")uG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"email",code:Lt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")nS||(nS=new RegExp(dG,"u")),nS.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"emoji",code:Lt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")sG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"uuid",code:Lt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")oG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"nanoid",code:Lt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")rG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"cuid",code:Lt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")aG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"cuid2",code:Lt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")iG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"ulid",code:Lt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Qt(a,{validation:"url",code:Lt.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"regex",code:Lt.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?_D(i).test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?bG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?vG(i).test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?cG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"duration",code:Lt.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?wG(t.data,i.version)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"ip",code:Lt.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?xG(t.data,i.alg)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"jwt",code:Lt.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?_G(t.data,i.version)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"cidr",code:Lt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?gG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"base64",code:Lt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?yG.test(t.data)||(a=this._getOrReturnCtx(t,a),Qt(a,{validation:"base64url",code:Lt.invalid_string,message:i.message}),r.dirty()):ar.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(a=>t.test(a),{validation:n,code:Lt.invalid_string,...un.errToObj(r)})}_addCheck(t){return new Hs({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...un.errToObj(t)})}url(t){return this._addCheck({kind:"url",...un.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...un.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...un.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...un.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...un.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...un.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...un.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...un.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...un.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...un.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...un.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...un.errToObj(t)})}datetime(t){var n,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(n=t==null?void 0:t.offset)!==null&&n!==void 0?n:!1,local:(r=t==null?void 0:t.local)!==null&&r!==void 0?r:!1,...un.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...un.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...un.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...un.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...un.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...un.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...un.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...un.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...un.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...un.errToObj(n)})}nonempty(t){return this.min(1,un.errToObj(t))}trim(){return new Hs({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Hs({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Hs({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Hs.create=e=>{var t;return new Hs({checks:[],typeName:qt.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...On(e)})};function SG(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r,i=parseInt(e.toFixed(a).replace(".","")),s=parseInt(t.toFixed(a).replace(".",""));return i%s/Math.pow(10,a)}class au extends Pn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==nn.number){const i=this._getOrReturnCtx(t);return Qt(i,{code:Lt.invalid_type,expected:nn.number,received:i.parsedType}),En}let r;const a=new oi;for(const i of this._def.checks)i.kind==="int"?ar.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),Qt(r,{code:Lt.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),Qt(r,{code:Lt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),Qt(r,{code:Lt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?SG(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),Qt(r,{code:Lt.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),Qt(r,{code:Lt.not_finite,message:i.message}),a.dirty()):ar.assertNever(i);return{status:a.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,un.toString(n))}gt(t,n){return this.setLimit("min",t,!1,un.toString(n))}lte(t,n){return this.setLimit("max",t,!0,un.toString(n))}lt(t,n){return this.setLimit("max",t,!1,un.toString(n))}setLimit(t,n,r,a){return new au({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:un.toString(a)}]})}_addCheck(t){return new au({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:un.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:un.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:un.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:un.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:un.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:un.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:un.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:un.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:un.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ar.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}au.create=e=>new au({checks:[],typeName:qt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...On(e)});class iu extends Pn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==nn.bigint)return this._getInvalidInput(t);let r;const a=new oi;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),Qt(r,{code:Lt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),Qt(r,{code:Lt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),Qt(r,{code:Lt.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):ar.assertNever(i);return{status:a.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return Qt(n,{code:Lt.invalid_type,expected:nn.bigint,received:n.parsedType}),En}gte(t,n){return this.setLimit("min",t,!0,un.toString(n))}gt(t,n){return this.setLimit("min",t,!1,un.toString(n))}lte(t,n){return this.setLimit("max",t,!0,un.toString(n))}lt(t,n){return this.setLimit("max",t,!1,un.toString(n))}setLimit(t,n,r,a){return new iu({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:un.toString(a)}]})}_addCheck(t){return new iu({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:un.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:un.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:un.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:un.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:un.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}iu.create=e=>{var t;return new iu({checks:[],typeName:qt.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...On(e)})};class sg extends Pn{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==nn.boolean){const r=this._getOrReturnCtx(t);return Qt(r,{code:Lt.invalid_type,expected:nn.boolean,received:r.parsedType}),En}return xi(t.data)}}sg.create=e=>new sg({typeName:qt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...On(e)});class Od extends Pn{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==nn.date){const i=this._getOrReturnCtx(t);return Qt(i,{code:Lt.invalid_type,expected:nn.date,received:i.parsedType}),En}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return Qt(i,{code:Lt.invalid_date}),En}const r=new oi;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),Qt(a,{code:Lt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):ar.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Od({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:un.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:un.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}Od.create=e=>new Od({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:qt.ZodDate,...On(e)});class vv extends Pn{_parse(t){if(this._getType(t)!==nn.symbol){const r=this._getOrReturnCtx(t);return Qt(r,{code:Lt.invalid_type,expected:nn.symbol,received:r.parsedType}),En}return xi(t.data)}}vv.create=e=>new vv({typeName:qt.ZodSymbol,...On(e)});class og extends Pn{_parse(t){if(this._getType(t)!==nn.undefined){const r=this._getOrReturnCtx(t);return Qt(r,{code:Lt.invalid_type,expected:nn.undefined,received:r.parsedType}),En}return xi(t.data)}}og.create=e=>new og({typeName:qt.ZodUndefined,...On(e)});class lg extends Pn{_parse(t){if(this._getType(t)!==nn.null){const r=this._getOrReturnCtx(t);return Qt(r,{code:Lt.invalid_type,expected:nn.null,received:r.parsedType}),En}return xi(t.data)}}lg.create=e=>new lg({typeName:qt.ZodNull,...On(e)});class Nh extends Pn{constructor(){super(...arguments),this._any=!0}_parse(t){return xi(t.data)}}Nh.create=e=>new Nh({typeName:qt.ZodAny,...On(e)});class kd extends Pn{constructor(){super(...arguments),this._unknown=!0}_parse(t){return xi(t.data)}}kd.create=e=>new kd({typeName:qt.ZodUnknown,...On(e)});class ql extends Pn{_parse(t){const n=this._getOrReturnCtx(t);return Qt(n,{code:Lt.invalid_type,expected:nn.never,received:n.parsedType}),En}}ql.create=e=>new ql({typeName:qt.ZodNever,...On(e)});class wv extends Pn{_parse(t){if(this._getType(t)!==nn.undefined){const r=this._getOrReturnCtx(t);return Qt(r,{code:Lt.invalid_type,expected:nn.void,received:r.parsedType}),En}return xi(t.data)}}wv.create=e=>new wv({typeName:qt.ZodVoid,...On(e)});class Ws extends Pn{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),a=this._def;if(n.parsedType!==nn.array)return Qt(n,{code:Lt.invalid_type,expected:nn.array,received:n.parsedType}),En;if(a.exactLength!==null){const s=n.data.length>a.exactLength.value,o=n.data.length<a.exactLength.value;(s||o)&&(Qt(n,{code:s?Lt.too_big:Lt.too_small,minimum:o?a.exactLength.value:void 0,maximum:s?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Qt(n,{code:Lt.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Qt(n,{code:Lt.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((s,o)=>a.type._parseAsync(new Vo(n,s,n.path,o)))).then(s=>oi.mergeArray(r,s));const i=[...n.data].map((s,o)=>a.type._parseSync(new Vo(n,s,n.path,o)));return oi.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new Ws({...this._def,minLength:{value:t,message:un.toString(n)}})}max(t,n){return new Ws({...this._def,maxLength:{value:t,message:un.toString(n)}})}length(t,n){return new Ws({...this._def,exactLength:{value:t,message:un.toString(n)}})}nonempty(t){return this.min(1,t)}}Ws.create=(e,t)=>new Ws({type:e,minLength:null,maxLength:null,exactLength:null,typeName:qt.ZodArray,...On(t)});function lh(e){if(e instanceof Zr){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Ks.create(lh(r))}return new Zr({...e._def,shape:()=>t})}else return e instanceof Ws?new Ws({...e._def,type:lh(e.element)}):e instanceof Ks?Ks.create(lh(e.unwrap())):e instanceof ou?ou.create(lh(e.unwrap())):e instanceof Go?Go.create(e.items.map(t=>lh(t))):e}class Zr extends Pn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=ar.objectKeys(t);return this._cached={shape:t,keys:n}}_parse(t){if(this._getType(t)!==nn.object){const u=this._getOrReturnCtx(t);return Qt(u,{code:Lt.invalid_type,expected:nn.object,received:u.parsedType}),En}const{status:r,ctx:a}=this._processInputParams(t),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof ql&&this._def.unknownKeys==="strip"))for(const u in a.data)s.includes(u)||o.push(u);const l=[];for(const u of s){const d=i[u],h=a.data[u];l.push({key:{status:"valid",value:u},value:d._parse(new Vo(a,h,a.path,u)),alwaysSet:u in a.data})}if(this._def.catchall instanceof ql){const u=this._def.unknownKeys;if(u==="passthrough")for(const d of o)l.push({key:{status:"valid",value:d},value:{status:"valid",value:a.data[d]}});else if(u==="strict")o.length>0&&(Qt(a,{code:Lt.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of o){const h=a.data[d];l.push({key:{status:"valid",value:d},value:u._parse(new Vo(a,h,a.path,d)),alwaysSet:d in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const u=[];for(const d of l){const h=await d.key,p=await d.value;u.push({key:h,value:p,alwaysSet:d.alwaysSet})}return u}).then(u=>oi.mergeObjectSync(r,u)):oi.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return un.errToObj,new Zr({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var a,i,s,o;const l=(s=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,n,r).message)!==null&&s!==void 0?s:r.defaultError;return n.code==="unrecognized_keys"?{message:(o=un.errToObj(t).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new Zr({...this._def,unknownKeys:"strip"})}passthrough(){return new Zr({...this._def,unknownKeys:"passthrough"})}extend(t){return new Zr({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Zr({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:qt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Zr({...this._def,catchall:t})}pick(t){const n={};return ar.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Zr({...this._def,shape:()=>n})}omit(t){const n={};return ar.objectKeys(this.shape).forEach(r=>{t[r]||(n[r]=this.shape[r])}),new Zr({...this._def,shape:()=>n})}deepPartial(){return lh(this)}partial(t){const n={};return ar.objectKeys(this.shape).forEach(r=>{const a=this.shape[r];t&&!t[r]?n[r]=a:n[r]=a.optional()}),new Zr({...this._def,shape:()=>n})}required(t){const n={};return ar.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Ks;)i=i._def.innerType;n[r]=i}}),new Zr({...this._def,shape:()=>n})}keyof(){return SD(ar.objectKeys(this.shape))}}Zr.create=(e,t)=>new Zr({shape:()=>e,unknownKeys:"strip",catchall:ql.create(),typeName:qt.ZodObject,...On(t)});Zr.strictCreate=(e,t)=>new Zr({shape:()=>e,unknownKeys:"strict",catchall:ql.create(),typeName:qt.ZodObject,...On(t)});Zr.lazycreate=(e,t)=>new Zr({shape:e,unknownKeys:"strip",catchall:ql.create(),typeName:qt.ZodObject,...On(t)});class cg extends Pn{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function a(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const s=i.map(o=>new ns(o.ctx.common.issues));return Qt(n,{code:Lt.invalid_union,unionErrors:s}),En}if(n.common.async)return Promise.all(r.map(async i=>{const s={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:s}),ctx:s}})).then(a);{let i;const s=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},d=l._parseSync({data:n.data,path:n.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:u}),u.common.issues.length&&s.push(u.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=s.map(l=>new ns(l));return Qt(n,{code:Lt.invalid_union,unionErrors:o}),En}}get options(){return this._def.options}}cg.create=(e,t)=>new cg({options:e,typeName:qt.ZodUnion,...On(t)});const Al=e=>e instanceof fg?Al(e.schema):e instanceof Qs?Al(e.innerType()):e instanceof hg?[e.value]:e instanceof su?e.options:e instanceof pg?ar.objectValues(e.enum):e instanceof mg?Al(e._def.innerType):e instanceof og?[void 0]:e instanceof lg?[null]:e instanceof Ks?[void 0,...Al(e.unwrap())]:e instanceof ou?[null,...Al(e.unwrap())]:e instanceof QC||e instanceof yg?Al(e.unwrap()):e instanceof gg?Al(e._def.innerType):[];class Ow extends Pn{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==nn.object)return Qt(n,{code:Lt.invalid_type,expected:nn.object,received:n.parsedType}),En;const r=this.discriminator,a=n.data[r],i=this.optionsMap.get(a);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(Qt(n,{code:Lt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),En)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const a=new Map;for(const i of n){const s=Al(i.shape[t]);if(!s.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of s){if(a.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);a.set(o,i)}}return new Ow({typeName:qt.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:a,...On(r)})}}function k2(e,t){const n=Il(e),r=Il(t);if(e===t)return{valid:!0,data:e};if(n===nn.object&&r===nn.object){const a=ar.objectKeys(t),i=ar.objectKeys(e).filter(o=>a.indexOf(o)!==-1),s={...e,...t};for(const o of i){const l=k2(e[o],t[o]);if(!l.valid)return{valid:!1};s[o]=l.data}return{valid:!0,data:s}}else if(n===nn.array&&r===nn.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<e.length;i++){const s=e[i],o=t[i],l=k2(s,o);if(!l.valid)return{valid:!1};a.push(l.data)}return{valid:!0,data:a}}else return n===nn.date&&r===nn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ug extends Pn{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=(i,s)=>{if(E2(i)||E2(s))return En;const o=k2(i.value,s.value);return o.valid?((C2(i)||C2(s))&&n.dirty(),{status:n.value,value:o.data}):(Qt(r,{code:Lt.invalid_intersection_types}),En)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,s])=>a(i,s)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ug.create=(e,t,n)=>new ug({left:e,right:t,typeName:qt.ZodIntersection,...On(n)});class Go extends Pn{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==nn.array)return Qt(r,{code:Lt.invalid_type,expected:nn.array,received:r.parsedType}),En;if(r.data.length<this._def.items.length)return Qt(r,{code:Lt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),En;!this._def.rest&&r.data.length>this._def.items.length&&(Qt(r,{code:Lt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((s,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Vo(r,s,r.path,o)):null}).filter(s=>!!s);return r.common.async?Promise.all(i).then(s=>oi.mergeArray(n,s)):oi.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new Go({...this._def,rest:t})}}Go.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Go({items:e,typeName:qt.ZodTuple,rest:null,...On(t)})};class dg extends Pn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==nn.object)return Qt(r,{code:Lt.invalid_type,expected:nn.object,received:r.parsedType}),En;const a=[],i=this._def.keyType,s=this._def.valueType;for(const o in r.data)a.push({key:i._parse(new Vo(r,o,r.path,o)),value:s._parse(new Vo(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?oi.mergeObjectAsync(n,a):oi.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Pn?new dg({keyType:t,valueType:n,typeName:qt.ZodRecord,...On(r)}):new dg({keyType:Hs.create(),valueType:t,typeName:qt.ZodRecord,...On(n)})}}class xv extends Pn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==nn.map)return Qt(r,{code:Lt.invalid_type,expected:nn.map,received:r.parsedType}),En;const a=this._def.keyType,i=this._def.valueType,s=[...r.data.entries()].map(([o,l],u)=>({key:a._parse(new Vo(r,o,r.path,[u,"key"])),value:i._parse(new Vo(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of s){const u=await l.key,d=await l.value;if(u.status==="aborted"||d.status==="aborted")return En;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),o.set(u.value,d.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of s){const u=l.key,d=l.value;if(u.status==="aborted"||d.status==="aborted")return En;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),o.set(u.value,d.value)}return{status:n.value,value:o}}}}xv.create=(e,t,n)=>new xv({valueType:t,keyType:e,typeName:qt.ZodMap,...On(n)});class Dd extends Pn{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==nn.set)return Qt(r,{code:Lt.invalid_type,expected:nn.set,received:r.parsedType}),En;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Qt(r,{code:Lt.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Qt(r,{code:Lt.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function s(l){const u=new Set;for(const d of l){if(d.status==="aborted")return En;d.status==="dirty"&&n.dirty(),u.add(d.value)}return{status:n.value,value:u}}const o=[...r.data.values()].map((l,u)=>i._parse(new Vo(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>s(l)):s(o)}min(t,n){return new Dd({...this._def,minSize:{value:t,message:un.toString(n)}})}max(t,n){return new Dd({...this._def,maxSize:{value:t,message:un.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Dd.create=(e,t)=>new Dd({valueType:e,minSize:null,maxSize:null,typeName:qt.ZodSet,...On(t)});class vh extends Pn{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==nn.function)return Qt(n,{code:Lt.invalid_type,expected:nn.function,received:n.parsedType}),En;function r(o,l){return yv({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,gv(),Ah].filter(u=>!!u),issueData:{code:Lt.invalid_arguments,argumentsError:l}})}function a(o,l){return yv({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,gv(),Ah].filter(u=>!!u),issueData:{code:Lt.invalid_return_type,returnTypeError:l}})}const i={errorMap:n.common.contextualErrorMap},s=n.data;if(this._def.returns instanceof Rh){const o=this;return xi(async function(...l){const u=new ns([]),d=await o._def.args.parseAsync(l,i).catch(y=>{throw u.addIssue(r(l,y)),u}),h=await Reflect.apply(s,this,d);return await o._def.returns._def.type.parseAsync(h,i).catch(y=>{throw u.addIssue(a(h,y)),u})})}else{const o=this;return xi(function(...l){const u=o._def.args.safeParse(l,i);if(!u.success)throw new ns([r(l,u.error)]);const d=Reflect.apply(s,this,u.data),h=o._def.returns.safeParse(d,i);if(!h.success)throw new ns([a(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new vh({...this._def,args:Go.create(t).rest(kd.create())})}returns(t){return new vh({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new vh({args:t||Go.create([]).rest(kd.create()),returns:n||kd.create(),typeName:qt.ZodFunction,...On(r)})}}class fg extends Pn{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}fg.create=(e,t)=>new fg({getter:e,typeName:qt.ZodLazy,...On(t)});class hg extends Pn{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Qt(n,{received:n.data,code:Lt.invalid_literal,expected:this._def.value}),En}return{status:"valid",value:t.data}}get value(){return this._def.value}}hg.create=(e,t)=>new hg({value:e,typeName:qt.ZodLiteral,...On(t)});function SD(e,t){return new su({values:e,typeName:qt.ZodEnum,...On(t)})}class su extends Pn{constructor(){super(...arguments),Um.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return Qt(n,{expected:ar.joinValues(r),received:n.parsedType,code:Lt.invalid_type}),En}if(bv(this,Um)||vD(this,Um,new Set(this._def.values)),!bv(this,Um).has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return Qt(n,{received:n.data,code:Lt.invalid_enum_value,options:r}),En}return xi(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return su.create(t,{...this._def,...n})}exclude(t,n=this._def){return su.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}Um=new WeakMap;su.create=SD;class pg extends Pn{constructor(){super(...arguments),qm.set(this,void 0)}_parse(t){const n=ar.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==nn.string&&r.parsedType!==nn.number){const a=ar.objectValues(n);return Qt(r,{expected:ar.joinValues(a),received:r.parsedType,code:Lt.invalid_type}),En}if(bv(this,qm)||vD(this,qm,new Set(ar.getValidEnumValues(this._def.values))),!bv(this,qm).has(t.data)){const a=ar.objectValues(n);return Qt(r,{received:r.data,code:Lt.invalid_enum_value,options:a}),En}return xi(t.data)}get enum(){return this._def.values}}qm=new WeakMap;pg.create=(e,t)=>new pg({values:e,typeName:qt.ZodNativeEnum,...On(t)});class Rh extends Pn{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==nn.promise&&n.common.async===!1)return Qt(n,{code:Lt.invalid_type,expected:nn.promise,received:n.parsedType}),En;const r=n.parsedType===nn.promise?n.data:Promise.resolve(n.data);return xi(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Rh.create=(e,t)=>new Rh({type:e,typeName:qt.ZodPromise,...On(t)});class Qs extends Pn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===qt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:s=>{Qt(r,s),s.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const s=a.transform(r.data,i);if(r.common.async)return Promise.resolve(s).then(async o=>{if(n.value==="aborted")return En;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?En:l.status==="dirty"||n.value==="dirty"?dh(l.value):l});{if(n.value==="aborted")return En;const o=this._def.schema._parseSync({data:s,path:r.path,parent:r});return o.status==="aborted"?En:o.status==="dirty"||n.value==="dirty"?dh(o.value):o}}if(a.type==="refinement"){const s=o=>{const l=a.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?En:(o.status==="dirty"&&n.dirty(),s(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?En:(o.status==="dirty"&&n.dirty(),s(o.value).then(()=>({status:n.value,value:o.value}))))}if(a.type==="transform")if(r.common.async===!1){const s=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!jd(s))return s;const o=a.transform(s.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(s=>jd(s)?Promise.resolve(a.transform(s.value,i)).then(o=>({status:n.value,value:o})):s);ar.assertNever(a)}}Qs.create=(e,t,n)=>new Qs({schema:e,typeName:qt.ZodEffects,effect:t,...On(n)});Qs.createWithPreprocess=(e,t,n)=>new Qs({schema:t,effect:{type:"preprocess",transform:e},typeName:qt.ZodEffects,...On(n)});class Ks extends Pn{_parse(t){return this._getType(t)===nn.undefined?xi(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ks.create=(e,t)=>new Ks({innerType:e,typeName:qt.ZodOptional,...On(t)});class ou extends Pn{_parse(t){return this._getType(t)===nn.null?xi(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ou.create=(e,t)=>new ou({innerType:e,typeName:qt.ZodNullable,...On(t)});class mg extends Pn{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===nn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}mg.create=(e,t)=>new mg({innerType:e,typeName:qt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...On(t)});class gg extends Pn{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ig(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ns(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ns(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}gg.create=(e,t)=>new gg({innerType:e,typeName:qt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...On(t)});class _v extends Pn{_parse(t){if(this._getType(t)!==nn.nan){const r=this._getOrReturnCtx(t);return Qt(r,{code:Lt.invalid_type,expected:nn.nan,received:r.parsedType}),En}return{status:"valid",value:t.data}}}_v.create=e=>new _v({typeName:qt.ZodNaN,...On(e)});const EG=Symbol("zod_brand");class QC extends Pn{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class u0 extends Pn{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?En:i.status==="dirty"?(n.dirty(),dh(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?En:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(t,n){return new u0({in:t,out:n,typeName:qt.ZodPipeline})}}class yg extends Pn{_parse(t){const n=this._def.innerType._parse(t),r=a=>(jd(a)&&(a.value=Object.freeze(a.value)),a);return ig(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}yg.create=(e,t)=>new yg({innerType:e,typeName:qt.ZodReadonly,...On(t)});function OI(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function ED(e,t={},n){return e?Nh.create().superRefine((r,a)=>{var i,s;const o=e(r);if(o instanceof Promise)return o.then(l=>{var u,d;if(!l){const h=OI(t,r),p=(d=(u=h.fatal)!==null&&u!==void 0?u:n)!==null&&d!==void 0?d:!0;a.addIssue({code:"custom",...h,fatal:p})}});if(!o){const l=OI(t,r),u=(s=(i=l.fatal)!==null&&i!==void 0?i:n)!==null&&s!==void 0?s:!0;a.addIssue({code:"custom",...l,fatal:u})}}):Nh.create()}const CG={object:Zr.lazycreate};var qt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(qt||(qt={}));const kG=(e,t={message:`Input not instance of ${e.name}`})=>ED(n=>n instanceof e,t),CD=Hs.create,kD=au.create,TG=_v.create,AG=iu.create,TD=sg.create,NG=Od.create,RG=vv.create,IG=og.create,jG=lg.create,OG=Nh.create,DG=kd.create,MG=ql.create,PG=wv.create,FG=Ws.create,LG=Zr.create,$G=Zr.strictCreate,BG=cg.create,zG=Ow.create,UG=ug.create,qG=Go.create,HG=dg.create,VG=xv.create,GG=Dd.create,WG=vh.create,KG=fg.create,ZG=hg.create,YG=su.create,XG=pg.create,JG=Rh.create,DI=Qs.create,QG=Ks.create,eW=ou.create,tW=Qs.createWithPreprocess,nW=u0.create,rW=()=>CD().optional(),aW=()=>kD().optional(),iW=()=>TD().optional(),sW={string:e=>Hs.create({...e,coerce:!0}),number:e=>au.create({...e,coerce:!0}),boolean:e=>sg.create({...e,coerce:!0}),bigint:e=>iu.create({...e,coerce:!0}),date:e=>Od.create({...e,coerce:!0})},oW=En;var z=Object.freeze({__proto__:null,defaultErrorMap:Ah,setErrorMap:tG,getErrorMap:gv,makeIssue:yv,EMPTY_PATH:nG,addIssueToContext:Qt,ParseStatus:oi,INVALID:En,DIRTY:dh,OK:xi,isAborted:E2,isDirty:C2,isValid:jd,isAsync:ig,get util(){return ar},get objectUtil(){return S2},ZodParsedType:nn,getParsedType:Il,ZodType:Pn,datetimeRegex:_D,ZodString:Hs,ZodNumber:au,ZodBigInt:iu,ZodBoolean:sg,ZodDate:Od,ZodSymbol:vv,ZodUndefined:og,ZodNull:lg,ZodAny:Nh,ZodUnknown:kd,ZodNever:ql,ZodVoid:wv,ZodArray:Ws,ZodObject:Zr,ZodUnion:cg,ZodDiscriminatedUnion:Ow,ZodIntersection:ug,ZodTuple:Go,ZodRecord:dg,ZodMap:xv,ZodSet:Dd,ZodFunction:vh,ZodLazy:fg,ZodLiteral:hg,ZodEnum:su,ZodNativeEnum:pg,ZodPromise:Rh,ZodEffects:Qs,ZodTransformer:Qs,ZodOptional:Ks,ZodNullable:ou,ZodDefault:mg,ZodCatch:gg,ZodNaN:_v,BRAND:EG,ZodBranded:QC,ZodPipeline:u0,ZodReadonly:yg,custom:ED,Schema:Pn,ZodSchema:Pn,late:CG,get ZodFirstPartyTypeKind(){return qt},coerce:sW,any:OG,array:FG,bigint:AG,boolean:TD,date:NG,discriminatedUnion:zG,effect:DI,enum:YG,function:WG,instanceof:kG,intersection:UG,lazy:KG,literal:ZG,map:VG,nan:TG,nativeEnum:XG,never:MG,null:jG,nullable:eW,number:kD,object:LG,oboolean:iW,onumber:aW,optional:QG,ostring:rW,pipeline:nW,preprocess:tW,promise:JG,record:HG,set:GG,strictObject:$G,string:CD,symbol:RG,transformer:DI,tuple:qG,undefined:IG,union:BG,unknown:DG,void:PG,NEVER:oW,ZodIssueCode:Lt,quotelessJson:eG,ZodError:ns});function lW({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],a=[];for(const{role:i,content:s}of e)switch(i){case"system":{switch(n){case"system":{r.push({role:"system",content:s});break}case"developer":{r.push({role:"developer",content:s});break}case"remove":{a.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(s.length===1&&s[0].type==="text"){r.push({role:"user",content:s[0].text});break}r.push({role:"user",content:s.map((o,l)=>{var u,d,h,p;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(u=o.mimeType)!=null?u:"image/jpeg"};base64,${Th(o.image)}`,detail:(h=(d=o.providerMetadata)==null?void 0:d.openai)==null?void 0:h.imageDetail}};case"file":{if(o.data instanceof URL)throw new Tr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(p=o.filename)!=null?p:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new Tr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const u of s)switch(u.type){case"text":{o+=u.text;break}case"tool-call":{l.push({id:u.toolCallId,type:"function",function:{name:u.toolName,arguments:JSON.stringify(u.args)}});break}}if(t){if(l.length>1)throw new Tr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of s)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:a}}function MI(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:a,top_logprobs:i})=>({token:r,logprob:a,topLogprobs:i?i.map(({token:s,logprob:o})=>({token:s,logprob:o})):[]})))!=null?n:void 0}function Sv(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var ek=z.object({error:z.object({message:z.string(),type:z.string().nullish(),param:z.any().nullish(),code:z.union([z.string(),z.number()]).nullish()})}),lu=mD({errorSchema:ek,errorToMessage:e=>e.error.message});function Ev({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function cW({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const a=(r=e.tools)!=null&&r.length?e.tools:void 0,i=[];if(a==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const s=e.toolChoice;if(t){const u=[];for(const h of a)h.type==="provider-defined"?i.push({type:"unsupported-tool",tool:h}):u.push({name:h.name,description:h.description,parameters:h.parameters});if(s==null)return{functions:u,function_call:void 0,toolWarnings:i};switch(s.type){case"auto":case"none":case void 0:return{functions:u,function_call:void 0,toolWarnings:i};case"required":throw new Tr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:u,function_call:{name:s.toolName},toolWarnings:i}}}const o=[];for(const u of a)u.type==="provider-defined"?i.push({type:"unsupported-tool",tool:u}):o.push({type:"function",function:{name:u.name,description:u.description,parameters:u.parameters,strict:n?!0:void 0}});if(s==null)return{tools:o,tool_choice:void 0,toolWarnings:i};const l=s.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:s.toolName}},toolWarnings:i};default:{const u=l;throw new Tr({functionality:`Unsupported tool choice type: ${u}`})}}}var uW=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:T2(this.modelId)}get defaultObjectGenerationMode(){return hW(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:a,topK:i,frequencyPenalty:s,presencePenalty:o,stopSequences:l,responseFormat:u,seed:d,providerMetadata:h}){var p,y,v,b,w,x,S,E;const C=e.type,k=[];i!=null&&k.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&k.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const R=this.settings.useLegacyFunctionCalling;if(R&&this.settings.parallelToolCalls===!0)throw new Tr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(R&&this.supportsStructuredOutputs)throw new Tr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:O,warnings:j}=lW({prompt:t,useLegacyFunctionCalling:R,systemMessageMode:pW(this.modelId)});k.push(...j);const $={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:a,frequency_penalty:s,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,strict:!0,name:(p=u.name)!=null?p:"response",description:u.description}}:{type:"json_object"}:void 0,stop:l,seed:d,max_completion_tokens:(y=h==null?void 0:h.openai)==null?void 0:y.maxCompletionTokens,store:(v=h==null?void 0:h.openai)==null?void 0:v.store,metadata:(b=h==null?void 0:h.openai)==null?void 0:b.metadata,prediction:(w=h==null?void 0:h.openai)==null?void 0:w.prediction,reasoning_effort:(S=(x=h==null?void 0:h.openai)==null?void 0:x.reasoningEffort)!=null?S:this.settings.reasoningEffort,messages:O};switch(T2(this.modelId)&&($.temperature!=null&&($.temperature=void 0,k.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),$.top_p!=null&&($.top_p=void 0,k.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),$.frequency_penalty!=null&&($.frequency_penalty=void 0,k.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),$.presence_penalty!=null&&($.presence_penalty=void 0,k.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),$.logit_bias!=null&&($.logit_bias=void 0,k.push({type:"other",message:"logitBias is not supported for reasoning models"})),$.logprobs!=null&&($.logprobs=void 0,k.push({type:"other",message:"logprobs is not supported for reasoning models"})),$.top_logprobs!=null&&($.top_logprobs=void 0,k.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),$.max_tokens!=null&&($.max_completion_tokens==null&&($.max_completion_tokens=$.max_tokens),$.max_tokens=void 0)),C){case"regular":{const{tools:L,tool_choice:X,functions:F,function_call:K,toolWarnings:q}=cW({mode:e,useLegacyFunctionCalling:R,structuredOutputs:this.supportsStructuredOutputs});return{args:{...$,tools:L,tool_choice:X,functions:F,function_call:K},warnings:[...k,...q]}}case"object-json":return{args:{...$,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(E=e.name)!=null?E:"response",description:e.description}}:{type:"json_object"}},warnings:k};case"object-tool":return{args:R?{...$,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...$,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:k};default:{const L=C;throw new Error(`Unsupported type: ${L}`)}}}async doGenerate(e){var t,n,r,a,i,s,o,l;const{args:u,warnings:d}=this.getArgs(e),{responseHeaders:h,value:p,rawValue:y}=await Js({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ho(this.config.headers(),e.headers),body:u,failedResponseHandler:lu,successfulResponseHandler:Wd(dW),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:v,...b}=u,w=p.choices[0],x=(t=p.usage)==null?void 0:t.completion_tokens_details,S=(n=p.usage)==null?void 0:n.prompt_tokens_details,E={openai:{}};return(x==null?void 0:x.reasoning_tokens)!=null&&(E.openai.reasoningTokens=x==null?void 0:x.reasoning_tokens),(x==null?void 0:x.accepted_prediction_tokens)!=null&&(E.openai.acceptedPredictionTokens=x==null?void 0:x.accepted_prediction_tokens),(x==null?void 0:x.rejected_prediction_tokens)!=null&&(E.openai.rejectedPredictionTokens=x==null?void 0:x.rejected_prediction_tokens),(S==null?void 0:S.cached_tokens)!=null&&(E.openai.cachedPromptTokens=S==null?void 0:S.cached_tokens),{text:(r=w.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&w.message.function_call?[{toolCallType:"function",toolCallId:Po(),toolName:w.message.function_call.name,args:w.message.function_call.arguments}]:(a=w.message.tool_calls)==null?void 0:a.map(C=>{var k;return{toolCallType:"function",toolCallId:(k=C.id)!=null?k:Po(),toolName:C.function.name,args:C.function.arguments}}),finishReason:Sv(w.finish_reason),usage:{promptTokens:(s=(i=p.usage)==null?void 0:i.prompt_tokens)!=null?s:NaN,completionTokens:(l=(o=p.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:v,rawSettings:b},rawResponse:{headers:h,body:y},request:{body:JSON.stringify(u)},response:Ev(p),warnings:d,logprobs:MI(w.logprobs),providerMetadata:E}}async doStream(e){if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const S of b.toolCalls)x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:S.toolCallId,toolName:S.toolName,argsTextDelta:S.args}),x.enqueue({type:"tool-call",...S});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:a,value:i}=await Js({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ho(this.config.headers(),e.headers),body:r,failedResponseHandler:lu,successfulResponseHandler:JC(fW),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:s,...o}=t,l=[];let u="unknown",d={promptTokens:void 0,completionTokens:void 0},h,p=!0;const{useLegacyFunctionCalling:y}=this.settings,v={openai:{}};return{stream:i.pipeThrough(new TransformStream({transform(b,w){var x,S,E,C,k,R,O,j,$,L,X,F;if(!b.success){u="error",w.enqueue({type:"error",error:b.error});return}const K=b.value;if("error"in K){u="error",w.enqueue({type:"error",error:K.error});return}if(p&&(p=!1,w.enqueue({type:"response-metadata",...Ev(K)})),K.usage!=null){const{prompt_tokens:Q,completion_tokens:ae,prompt_tokens_details:B,completion_tokens_details:J}=K.usage;d={promptTokens:Q??void 0,completionTokens:ae??void 0},(J==null?void 0:J.reasoning_tokens)!=null&&(v.openai.reasoningTokens=J==null?void 0:J.reasoning_tokens),(J==null?void 0:J.accepted_prediction_tokens)!=null&&(v.openai.acceptedPredictionTokens=J==null?void 0:J.accepted_prediction_tokens),(J==null?void 0:J.rejected_prediction_tokens)!=null&&(v.openai.rejectedPredictionTokens=J==null?void 0:J.rejected_prediction_tokens),(B==null?void 0:B.cached_tokens)!=null&&(v.openai.cachedPromptTokens=B==null?void 0:B.cached_tokens)}const q=K.choices[0];if((q==null?void 0:q.finish_reason)!=null&&(u=Sv(q.finish_reason)),(q==null?void 0:q.delta)==null)return;const de=q.delta;de.content!=null&&w.enqueue({type:"text-delta",textDelta:de.content});const re=MI(q==null?void 0:q.logprobs);re!=null&&re.length&&(h===void 0&&(h=[]),h.push(...re));const Y=y&&de.function_call!=null?[{type:"function",id:Po(),function:de.function_call,index:0}]:de.tool_calls;if(Y!=null)for(const Q of Y){const ae=Q.index;if(l[ae]==null){if(Q.type!=="function")throw new bh({data:Q,message:"Expected 'function' type."});if(Q.id==null)throw new bh({data:Q,message:"Expected 'id' to be a string."});if(((x=Q.function)==null?void 0:x.name)==null)throw new bh({data:Q,message:"Expected 'function.name' to be a string."});l[ae]={id:Q.id,type:"function",function:{name:Q.function.name,arguments:(S=Q.function.arguments)!=null?S:""},hasFinished:!1};const J=l[ae];((E=J.function)==null?void 0:E.name)!=null&&((C=J.function)==null?void 0:C.arguments)!=null&&(J.function.arguments.length>0&&w.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:J.id,toolName:J.function.name,argsTextDelta:J.function.arguments}),II(J.function.arguments)&&(w.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(k=J.id)!=null?k:Po(),toolName:J.function.name,args:J.function.arguments}),J.hasFinished=!0));continue}const B=l[ae];B.hasFinished||(((R=Q.function)==null?void 0:R.arguments)!=null&&(B.function.arguments+=(j=(O=Q.function)==null?void 0:O.arguments)!=null?j:""),w.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:B.id,toolName:B.function.name,argsTextDelta:($=Q.function.arguments)!=null?$:""}),((L=B.function)==null?void 0:L.name)!=null&&((X=B.function)==null?void 0:X.arguments)!=null&&II(B.function.arguments)&&(w.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(F=B.id)!=null?F:Po(),toolName:B.function.name,args:B.function.arguments}),B.hasFinished=!0))}},flush(b){var w,x;b.enqueue({type:"finish",finishReason:u,logprobs:h,usage:{promptTokens:(w=d.promptTokens)!=null?w:NaN,completionTokens:(x=d.completionTokens)!=null?x:NaN},...v!=null?{providerMetadata:v}:{}})}})),rawCall:{rawPrompt:s,rawSettings:o},rawResponse:{headers:a},request:{body:JSON.stringify(r)},warnings:n}}},AD=z.object({prompt_tokens:z.number().nullish(),completion_tokens:z.number().nullish(),prompt_tokens_details:z.object({cached_tokens:z.number().nullish()}).nullish(),completion_tokens_details:z.object({reasoning_tokens:z.number().nullish(),accepted_prediction_tokens:z.number().nullish(),rejected_prediction_tokens:z.number().nullish()}).nullish()}).nullish(),dW=z.object({id:z.string().nullish(),created:z.number().nullish(),model:z.string().nullish(),choices:z.array(z.object({message:z.object({role:z.literal("assistant").nullish(),content:z.string().nullish(),function_call:z.object({arguments:z.string(),name:z.string()}).nullish(),tool_calls:z.array(z.object({id:z.string().nullish(),type:z.literal("function"),function:z.object({name:z.string(),arguments:z.string()})})).nullish()}),index:z.number(),logprobs:z.object({content:z.array(z.object({token:z.string(),logprob:z.number(),top_logprobs:z.array(z.object({token:z.string(),logprob:z.number()}))})).nullable()}).nullish(),finish_reason:z.string().nullish()})),usage:AD}),fW=z.union([z.object({id:z.string().nullish(),created:z.number().nullish(),model:z.string().nullish(),choices:z.array(z.object({delta:z.object({role:z.enum(["assistant"]).nullish(),content:z.string().nullish(),function_call:z.object({name:z.string().optional(),arguments:z.string().optional()}).nullish(),tool_calls:z.array(z.object({index:z.number(),id:z.string().nullish(),type:z.literal("function").optional(),function:z.object({name:z.string().nullish(),arguments:z.string().nullish()})})).nullish()}).nullish(),logprobs:z.object({content:z.array(z.object({token:z.string(),logprob:z.number(),top_logprobs:z.array(z.object({token:z.string(),logprob:z.number()}))})).nullable()}).nullish(),finish_reason:z.string().nullable().optional(),index:z.number()})),usage:AD}),ek]);function T2(e){return e==="o1"||e.startsWith("o1-")||e==="o3"||e.startsWith("o3-")}function hW(e){return e.startsWith("gpt-4o-audio-preview")}function pW(e){var t,n;return T2(e)?(n=(t=mW[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var mW={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"}};function gW({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let a="";e[0].role==="system"&&(a+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:s}of e)switch(i){case"system":throw new Nl({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=s.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new Tr({functionality:"images"})}}).join("");a+=`${n}:
${o}

`;break}case"assistant":{const o=s.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new Tr({functionality:"tool-call messages"})}}).join("");a+=`${r}:
${o}

`;break}case"tool":throw new Tr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return a+=`${r}:
`,{prompt:a,stopSequences:[`
${n}:`]}}function PI(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,a])=>({token:r,logprob:a})):[]}))}var yW=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:a,topP:i,topK:s,frequencyPenalty:o,presencePenalty:l,stopSequences:u,responseFormat:d,seed:h}){var p;const y=e.type,v=[];s!=null&&v.push({type:"unsupported-setting",setting:"topK"}),d!=null&&d.type!=="text"&&v.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:b,stopSequences:w}=gW({prompt:n,inputFormat:t}),x=[...w??[],...u??[]],S={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:a,top_p:i,frequency_penalty:o,presence_penalty:l,seed:h,prompt:b,stop:x.length>0?x:void 0};switch(y){case"regular":{if((p=e.tools)!=null&&p.length)throw new Tr({functionality:"tools"});if(e.toolChoice)throw new Tr({functionality:"toolChoice"});return{args:S,warnings:v}}case"object-json":throw new Tr({functionality:"object-json mode"});case"object-tool":throw new Tr({functionality:"object-tool mode"});default:{const E=y;throw new Error(`Unsupported type: ${E}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:a,rawValue:i}=await Js({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ho(this.config.headers(),e.headers),body:t,failedResponseHandler:lu,successfulResponseHandler:Wd(bW),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:s,...o}=t,l=a.choices[0];return{text:l.text,usage:{promptTokens:a.usage.prompt_tokens,completionTokens:a.usage.completion_tokens},finishReason:Sv(l.finish_reason),logprobs:PI(l.logprobs),rawCall:{rawPrompt:s,rawSettings:o},rawResponse:{headers:r,body:i},response:Ev(a),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:a,value:i}=await Js({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ho(this.config.headers(),e.headers),body:r,failedResponseHandler:lu,successfulResponseHandler:JC(vW),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:s,...o}=t;let l="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d,h=!0;return{stream:i.pipeThrough(new TransformStream({transform(p,y){if(!p.success){l="error",y.enqueue({type:"error",error:p.error});return}const v=p.value;if("error"in v){l="error",y.enqueue({type:"error",error:v.error});return}h&&(h=!1,y.enqueue({type:"response-metadata",...Ev(v)})),v.usage!=null&&(u={promptTokens:v.usage.prompt_tokens,completionTokens:v.usage.completion_tokens});const b=v.choices[0];(b==null?void 0:b.finish_reason)!=null&&(l=Sv(b.finish_reason)),(b==null?void 0:b.text)!=null&&y.enqueue({type:"text-delta",textDelta:b.text});const w=PI(b==null?void 0:b.logprobs);w!=null&&w.length&&(d===void 0&&(d=[]),d.push(...w))},flush(p){p.enqueue({type:"finish",finishReason:l,logprobs:d,usage:u})}})),rawCall:{rawPrompt:s,rawSettings:o},rawResponse:{headers:a},warnings:n,request:{body:JSON.stringify(r)}}}},bW=z.object({id:z.string().nullish(),created:z.number().nullish(),model:z.string().nullish(),choices:z.array(z.object({text:z.string(),finish_reason:z.string(),logprobs:z.object({tokens:z.array(z.string()),token_logprobs:z.array(z.number()),top_logprobs:z.array(z.record(z.string(),z.number())).nullable()}).nullish()})),usage:z.object({prompt_tokens:z.number(),completion_tokens:z.number()})}),vW=z.union([z.object({id:z.string().nullish(),created:z.number().nullish(),model:z.string().nullish(),choices:z.array(z.object({text:z.string(),finish_reason:z.string().nullish(),index:z.number(),logprobs:z.object({tokens:z.array(z.string()),token_logprobs:z.array(z.number()),top_logprobs:z.array(z.record(z.string(),z.number())).nullable()}).nullish()})),usage:z.object({prompt_tokens:z.number(),completion_tokens:z.number()}).nullish()}),ek]),wW=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new ZC({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:a}=await Js({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Ho(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:lu,successfulResponseHandler:Wd(xW),abortSignal:n,fetch:this.config.fetch});return{embeddings:a.data.map(i=>i.embedding),usage:a.usage?{tokens:a.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},xW=z.object({data:z.array(z.object({embedding:z.array(z.number())})),usage:z.object({prompt_tokens:z.number()}).nullish()}),_W={"dall-e-3":1,"dall-e-2":10},SW=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:_W[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:a,providerOptions:i,headers:s,abortSignal:o}){var l,u,d,h;const p=[];r!=null&&p.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),a!=null&&p.push({type:"unsupported-setting",setting:"seed"});const y=(d=(u=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:u.call(l))!=null?d:new Date,{value:v,responseHeaders:b}=await Js({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Ho(this.config.headers(),s),body:{model:this.modelId,prompt:e,n:t,size:n,...(h=i.openai)!=null?h:{},response_format:"b64_json"},failedResponseHandler:lu,successfulResponseHandler:Wd(EW),abortSignal:o,fetch:this.config.fetch});return{images:v.data.map(w=>w.b64_json),warnings:p,response:{timestamp:y,modelId:this.modelId,headers:b}}}},EW=z.object({data:z.array(z.object({b64_json:z.string()}))});function CW({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:a,content:i}of e)switch(a){case"system":{switch(t){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const s=t;throw new Error(`Unsupported system message mode: ${s}`)}}break}case"user":{n.push({role:"user",content:i.map((s,o)=>{var l,u,d,h;switch(s.type){case"text":return{type:"input_text",text:s.text};case"image":return{type:"input_image",image_url:s.image instanceof URL?s.image.toString():`data:${(l=s.mimeType)!=null?l:"image/jpeg"};base64,${Th(s.image)}`,detail:(d=(u=s.providerMetadata)==null?void 0:u.openai)==null?void 0:d.imageDetail};case"file":{if(s.data instanceof URL)throw new Tr({functionality:"File URLs in user messages"});switch(s.mimeType){case"application/pdf":return{type:"input_file",filename:(h=s.filename)!=null?h:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${s.data}`};default:throw new Tr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const s of i)switch(s.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:s.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:s.toolCallId,name:s.toolName,arguments:JSON.stringify(s.args)});break}}break}case"tool":{for(const s of i)n.push({type:"function_call_output",call_id:s.toolCallId,output:JSON.stringify(s.result)});break}default:{const s=a;throw new Error(`Unsupported role: ${s}`)}}return{messages:n,warnings:r}}function FI({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function kW({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,a=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:a};const i=e.toolChoice,s=[];for(const l of r)switch(l.type){case"function":s.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":s.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:a.push({type:"unsupported-tool",tool:l});break}break;default:a.push({type:"unsupported-tool",tool:l});break}if(i==null)return{tools:s,tool_choice:void 0,toolWarnings:a};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:s,tool_choice:o,toolWarnings:a};case"tool":return i.toolName==="web_search_preview"?{tools:s,tool_choice:{type:"web_search_preview"},toolWarnings:a}:{tools:s,tool_choice:{type:"function",name:i.toolName},toolWarnings:a};default:{const l=o;throw new Tr({functionality:`Unsupported tool choice type: ${l}`})}}}var TW=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:a,topK:i,presencePenalty:s,frequencyPenalty:o,seed:l,prompt:u,providerMetadata:d,responseFormat:h}){var p,y,v;const b=[],w=qW(this.modelId),x=e.type;i!=null&&b.push({type:"unsupported-setting",setting:"topK"}),l!=null&&b.push({type:"unsupported-setting",setting:"seed"}),s!=null&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&b.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:S,warnings:E}=CW({prompt:u,systemMessageMode:w.systemMessageMode});b.push(...E);const C=ZV({provider:"openai",providerOptions:d,schema:HW}),k=(p=C==null?void 0:C.strictSchemas)!=null?p:!0,R={model:this.modelId,input:S,temperature:n,top_p:a,max_output_tokens:t,...(h==null?void 0:h.type)==="json"&&{text:{format:h.schema!=null?{type:"json_schema",strict:k,name:(y=h.name)!=null?y:"response",description:h.description,schema:h.schema}:{type:"json_object"}}},metadata:C==null?void 0:C.metadata,parallel_tool_calls:C==null?void 0:C.parallelToolCalls,previous_response_id:C==null?void 0:C.previousResponseId,store:C==null?void 0:C.store,user:C==null?void 0:C.user,instructions:C==null?void 0:C.instructions,...w.isReasoningModel&&(C==null?void 0:C.reasoningEffort)!=null&&{reasoning:{effort:C==null?void 0:C.reasoningEffort}},...w.requiredAutoTruncation&&{truncation:"auto"}};switch(w.isReasoningModel&&(R.temperature!=null&&(R.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),R.top_p!=null&&(R.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),x){case"regular":{const{tools:O,tool_choice:j,toolWarnings:$}=kW({mode:e,strict:k});return{args:{...R,tools:O,tool_choice:j},warnings:[...b,...$]}}case"object-json":return{args:{...R,text:{format:e.schema!=null?{type:"json_schema",strict:k,name:(v=e.name)!=null?v:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...R,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:k}]},warnings:b};default:{const O=x;throw new Error(`Unsupported type: ${O}`)}}}async doGenerate(e){var t,n,r,a,i;const{args:s,warnings:o}=this.getArgs(e),{responseHeaders:l,value:u,rawValue:d}=await Js({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Ho(this.config.headers(),e.headers),body:s,failedResponseHandler:lu,successfulResponseHandler:Wd(z.object({id:z.string(),created_at:z.number(),model:z.string(),output:z.array(z.discriminatedUnion("type",[z.object({type:z.literal("message"),role:z.literal("assistant"),content:z.array(z.object({type:z.literal("output_text"),text:z.string(),annotations:z.array(z.object({type:z.literal("url_citation"),start_index:z.number(),end_index:z.number(),url:z.string(),title:z.string()}))}))}),z.object({type:z.literal("function_call"),call_id:z.string(),name:z.string(),arguments:z.string()}),z.object({type:z.literal("web_search_call")}),z.object({type:z.literal("computer_call")}),z.object({type:z.literal("reasoning")})])),incomplete_details:z.object({reason:z.string()}).nullable(),usage:ND})),abortSignal:e.abortSignal,fetch:this.config.fetch}),h=u.output.filter(y=>y.type==="message").flatMap(y=>y.content).filter(y=>y.type==="output_text"),p=u.output.filter(y=>y.type==="function_call").map(y=>({toolCallType:"function",toolCallId:y.call_id,toolName:y.name,args:y.arguments}));return{text:h.map(y=>y.text).join(`
`),sources:h.flatMap(y=>y.annotations.map(v=>{var b,w,x;return{sourceType:"url",id:(x=(w=(b=this.config).generateId)==null?void 0:w.call(b))!=null?x:Po(),url:v.url,title:v.title}})),finishReason:FI({finishReason:(t=u.incomplete_details)==null?void 0:t.reason,hasToolCalls:p.length>0}),toolCalls:p.length>0?p:void 0,usage:{promptTokens:u.usage.input_tokens,completionTokens:u.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:l,body:d},request:{body:JSON.stringify(s)},response:{id:u.id,timestamp:new Date(u.created_at*1e3),modelId:u.model},providerMetadata:{openai:{responseId:u.id,cachedPromptTokens:(r=(n=u.usage.input_tokens_details)==null?void 0:n.cached_tokens)!=null?r:null,reasoningTokens:(i=(a=u.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?i:null}},warnings:o}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:a}=await Js({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Ho(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:lu,successfulResponseHandler:JC(MW),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this;let s="unknown",o=NaN,l=NaN,u=null,d=null,h=null;const p={};let y=!1;return{stream:a.pipeThrough(new TransformStream({transform(v,b){var w,x,S,E,C,k,R,O;if(!v.success){s="error",b.enqueue({type:"error",error:v.error});return}const j=v.value;if(zW(j))j.item.type==="function_call"&&(p[j.output_index]={toolName:j.item.name,toolCallId:j.item.call_id},b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:j.item.call_id,toolName:j.item.name,argsTextDelta:j.item.arguments}));else if(BW(j)){const $=p[j.output_index];$!=null&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:$.toolCallId,toolName:$.toolName,argsTextDelta:j.delta})}else $W(j)?(h=j.response.id,b.enqueue({type:"response-metadata",id:j.response.id,timestamp:new Date(j.response.created_at*1e3),modelId:j.response.model})):PW(j)?b.enqueue({type:"text-delta",textDelta:j.delta}):FW(j)&&j.item.type==="function_call"?(p[j.output_index]=void 0,y=!0,b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:j.item.call_id,toolName:j.item.name,args:j.item.arguments})):LW(j)?(s=FI({finishReason:(w=j.response.incomplete_details)==null?void 0:w.reason,hasToolCalls:y}),o=j.response.usage.input_tokens,l=j.response.usage.output_tokens,u=(S=(x=j.response.usage.input_tokens_details)==null?void 0:x.cached_tokens)!=null?S:u,d=(C=(E=j.response.usage.output_tokens_details)==null?void 0:E.reasoning_tokens)!=null?C:d):UW(j)&&b.enqueue({type:"source",source:{sourceType:"url",id:(O=(R=(k=i.config).generateId)==null?void 0:R.call(k))!=null?O:Po(),url:j.annotation.url,title:j.annotation.title}})},flush(v){v.enqueue({type:"finish",finishReason:s,usage:{promptTokens:o,completionTokens:l},...(u!=null||d!=null)&&{providerMetadata:{openai:{responseId:h,cachedPromptTokens:u,reasoningTokens:d}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},ND=z.object({input_tokens:z.number(),input_tokens_details:z.object({cached_tokens:z.number().nullish()}).nullish(),output_tokens:z.number(),output_tokens_details:z.object({reasoning_tokens:z.number().nullish()}).nullish()}),AW=z.object({type:z.literal("response.output_text.delta"),delta:z.string()}),NW=z.object({type:z.enum(["response.completed","response.incomplete"]),response:z.object({incomplete_details:z.object({reason:z.string()}).nullish(),usage:ND})}),RW=z.object({type:z.literal("response.created"),response:z.object({id:z.string(),created_at:z.number(),model:z.string()})}),IW=z.object({type:z.literal("response.output_item.done"),output_index:z.number(),item:z.discriminatedUnion("type",[z.object({type:z.literal("message")}),z.object({type:z.literal("function_call"),id:z.string(),call_id:z.string(),name:z.string(),arguments:z.string(),status:z.literal("completed")})])}),jW=z.object({type:z.literal("response.function_call_arguments.delta"),item_id:z.string(),output_index:z.number(),delta:z.string()}),OW=z.object({type:z.literal("response.output_item.added"),output_index:z.number(),item:z.discriminatedUnion("type",[z.object({type:z.literal("message")}),z.object({type:z.literal("function_call"),id:z.string(),call_id:z.string(),name:z.string(),arguments:z.string()})])}),DW=z.object({type:z.literal("response.output_text.annotation.added"),annotation:z.object({type:z.literal("url_citation"),url:z.string(),title:z.string()})}),MW=z.union([AW,NW,RW,IW,jW,OW,DW,z.object({type:z.string()}).passthrough()]);function PW(e){return e.type==="response.output_text.delta"}function FW(e){return e.type==="response.output_item.done"}function LW(e){return e.type==="response.completed"||e.type==="response.incomplete"}function $W(e){return e.type==="response.created"}function BW(e){return e.type==="response.function_call_arguments.delta"}function zW(e){return e.type==="response.output_item.added"}function UW(e){return e.type==="response.output_text.annotation.added"}function qW(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var HW=z.object({metadata:z.any().nullish(),parallelToolCalls:z.boolean().nullish(),previousResponseId:z.string().nullish(),store:z.boolean().nullish(),user:z.string().nullish(),reasoningEffort:z.string().nullish(),strictSchemas:z.boolean().nullish(),instructions:z.string().nullish()}),VW=z.object({});function GW({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:VW}}var WW={webSearchPreview:GW};function RD(e={}){var t,n,r;const a=(t=yD(e.baseURL))!=null?t:"https://api.openai.com/v1",i=(n=e.compatibility)!=null?n:"compatible",s=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${UV({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(b,w={})=>new uW(b,w,{provider:`${s}.chat`,url:({path:x})=>`${a}${x}`,headers:o,compatibility:i,fetch:e.fetch}),u=(b,w={})=>new yW(b,w,{provider:`${s}.completion`,url:({path:x})=>`${a}${x}`,headers:o,compatibility:i,fetch:e.fetch}),d=(b,w={})=>new wW(b,w,{provider:`${s}.embedding`,url:({path:x})=>`${a}${x}`,headers:o,fetch:e.fetch}),h=(b,w={})=>new SW(b,w,{provider:`${s}.image`,url:({path:x})=>`${a}${x}`,headers:o,fetch:e.fetch}),p=(b,w)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return b==="gpt-3.5-turbo-instruct"?u(b,w):l(b,w)},y=b=>new TW(b,{provider:`${s}.responses`,url:({path:w})=>`${a}${w}`,headers:o,fetch:e.fetch}),v=function(b,w){return p(b,w)};return v.languageModel=p,v.chat=l,v.completion=u,v.responses=y,v.embedding=d,v.textEmbedding=d,v.textEmbeddingModel=d,v.image=h,v.imageModel=h,v.tools=WW,v}RD({compatibility:"strict"});var ID="vercel.ai.error",KW=Symbol.for(ID),jD,ZW=class OD extends Error{constructor({name:t,message:n,cause:r}){super(n),this[jD]=!0,this.name=t,this.cause=r}static isInstance(t){return OD.hasMarker(t,ID)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};jD=KW;var li=ZW,DD="AI_APICallError",MD=`vercel.ai.error.${DD}`,YW=Symbol.for(MD),PD,Ol=class extends li{constructor({message:t,url:n,requestBodyValues:r,statusCode:a,responseHeaders:i,responseBody:s,cause:o,isRetryable:l=a!=null&&(a===408||a===409||a===429||a>=500),data:u}){super({name:DD,message:t,cause:o}),this[PD]=!0,this.url=n,this.requestBodyValues=r,this.statusCode=a,this.responseHeaders=i,this.responseBody=s,this.isRetryable=l,this.data=u}static isInstance(t){return li.hasMarker(t,MD)}};PD=YW;var FD="AI_EmptyResponseBodyError",LD=`vercel.ai.error.${FD}`,XW=Symbol.for(LD),$D,JW=class extends li{constructor({message:t="Empty response body"}={}){super({name:FD,message:t}),this[$D]=!0}static isInstance(t){return li.hasMarker(t,LD)}};$D=XW;function BD(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var zD="AI_InvalidArgumentError",UD=`vercel.ai.error.${zD}`,QW=Symbol.for(UD),qD,HD=class extends li{constructor({message:t,cause:n,argument:r}){super({name:zD,message:t,cause:n}),this[qD]=!0,this.argument=r}static isInstance(t){return li.hasMarker(t,UD)}};qD=QW;var VD="AI_JSONParseError",GD=`vercel.ai.error.${VD}`,eK=Symbol.for(GD),WD,Cv=class extends li{constructor({text:t,cause:n}){super({name:VD,message:`JSON parsing failed: Text: ${t}.
Error message: ${BD(n)}`,cause:n}),this[WD]=!0,this.text=t}static isInstance(t){return li.hasMarker(t,GD)}};WD=eK;var KD="AI_LoadAPIKeyError",ZD=`vercel.ai.error.${KD}`,tK=Symbol.for(ZD),YD,mb=class extends li{constructor({message:t}){super({name:KD,message:t}),this[YD]=!0}static isInstance(t){return li.hasMarker(t,ZD)}};YD=tK;var XD="AI_TooManyEmbeddingValuesForCallError",JD=`vercel.ai.error.${XD}`,nK=Symbol.for(JD),QD,rK=class extends li{constructor(e){super({name:XD,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[QD]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return li.hasMarker(e,JD)}};QD=nK;var eM="AI_TypeValidationError",tM=`vercel.ai.error.${eM}`,aK=Symbol.for(tM),nM,iK=class A2 extends li{constructor({value:t,cause:n}){super({name:eM,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${BD(n)}`,cause:n}),this[nM]=!0,this.value=t}static isInstance(t){return li.hasMarker(t,tM)}static wrap({value:t,cause:n}){return A2.isInstance(n)&&n.value===t?n:new A2({value:t,cause:n})}};nM=aK;var kv=iK,rM="AI_UnsupportedFunctionalityError",aM=`vercel.ai.error.${rM}`,sK=Symbol.for(aM),iM,tv=class extends li{constructor({functionality:t,message:n=`'${t}' functionality not supported.`}){super({name:rM,message:n}),this[iM]=!0,this.functionality=t}static isInstance(t){return li.hasMarker(t,aM)}};iM=sK;let oK=(e,t=21)=>(n=t)=>{let r="",a=n|0;for(;a--;)r+=e[Math.random()*e.length|0];return r};var lK={};function N2(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function cK(){let e="",t,n=[],r,a;function i(l,u){if(l===""){s(u);return}if(l.startsWith(":"))return;const d=l.indexOf(":");if(d===-1){o(l,"");return}const h=l.slice(0,d),p=d+1,y=p<l.length&&l[p]===" "?l.slice(p+1):l.slice(p);o(h,y)}function s(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:a}),n=[],t=void 0,a=void 0)}function o(l,u){switch(l){case"event":t=u;break;case"data":n.push(u);break;case"id":r=u;break;case"retry":const d=parseInt(u,10);isNaN(d)||(a=d);break}}return new TransformStream({transform(l,u){const{lines:d,incompleteLine:h}=uK(e,l);e=h;for(let p=0;p<d.length;p++)i(d[p],u)},flush(l){i(e,l),s(l)}})}function uK(e,t){const n=[];let r=e;for(let a=0;a<t.length;){const i=t[a++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[a+1]===`
`&&a++):r+=i}return{lines:n,incompleteLine:r}}function Dw(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var dK=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=oK(n,t);if(e==null)return a;if(n.includes(r))throw new HD({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${a(i)}`},fK=dK();function hK(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function rS(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function pK({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new mb({message:`${r} API key must be a string.`});if(typeof ea>"u")throw new mb({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=lK[t],e==null)throw new mb({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new mb({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var R2=Symbol.for("vercel.ai.validator");function mK(e){return{[R2]:!0,validate:e}}function gK(e){return typeof e=="object"&&e!==null&&R2 in e&&e[R2]===!0&&"validate"in e}function yK(e){return gK(e)?e:bK(e)}function bK(e){return mK(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function vK({value:e,schema:t}){const n=tk({value:e,schema:t});if(!n.success)throw kv.wrap({value:e,cause:n.error});return n.value}function tk({value:e,schema:t}){const n=yK(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:kv.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:kv.wrap({value:e,cause:r})}}}function wK({text:e,schema:t}){try{const n=oo.parse(e);return t==null?n:vK({value:n,schema:t})}catch(n){throw Cv.isInstance(n)||kv.isInstance(n)?n:new Cv({text:e,cause:n})}}function sM({text:e,schema:t}){try{const n=oo.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=tk({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:Cv.isInstance(n)?n:new Cv({text:e,cause:n})}}}function xK({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=tk({value:t[e],schema:n});if(!r.success)throw new HD({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var _K=()=>globalThis.fetch,I2=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s})=>SK({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s}),SK=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:a,abortSignal:i,fetch:s=_K()})=>{try{const o=await s(e,{method:"POST",headers:hK(t),body:n.content,signal:i}),l=Dw(o);if(!o.ok){let u;try{u=await a({response:o,url:e,requestBodyValues:n.values})}catch(d){throw rS(d)||Ol.isInstance(d)?d:new Ol({message:"Failed to process error response",cause:d,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw u.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(u){throw u instanceof Error&&(rS(u)||Ol.isInstance(u))?u:new Ol({message:"Failed to process successful response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(rS(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new Ol({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function j2(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var EK=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:a,requestBodyValues:i})=>{const s=await r.text(),o=Dw(r);if(s.trim()==="")return{responseHeaders:o,value:new Ol({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:n==null?void 0:n(r)})};try{const l=wK({text:s,schema:e});return{responseHeaders:o,value:new Ol({message:t(l),url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new Ol({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:n==null?void 0:n(r)})}}},CK=e=>async({response:t})=>{const n=Dw(t);if(t.body==null)throw new JW({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(cK()).pipeThrough(new TransformStream({transform({data:r},a){r!=="[DONE]"&&a.enqueue(sM({text:r,schema:e}))}}))}},oM=e=>async({response:t,url:n,requestBodyValues:r})=>{const a=await t.text(),i=sM({text:a,schema:e}),s=Dw(t);if(!i.success)throw new Ol({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:s,responseBody:a,url:n,requestBodyValues:r});return{responseHeaders:s,value:i.value,rawValue:i.rawValue}},{btoa:kK}=globalThis;function TK(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return kK(t)}function AK(e){return e==null?void 0:e.replace(/\/$/,"")}function ws(e){if(NK(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:a,items:i,allOf:s,anyOf:o,oneOf:l,format:u,const:d,minLength:h,enum:p}=e,y={};if(n&&(y.description=n),r&&(y.required=r),u&&(y.format=u),d!==void 0&&(y.enum=[d]),t&&(Array.isArray(t)?t.includes("null")?(y.type=t.filter(v=>v!=="null")[0],y.nullable=!0):y.type=t:t==="null"?y.type="null":y.type=t),p!==void 0&&(y.enum=p),a!=null&&(y.properties=Object.entries(a).reduce((v,[b,w])=>(v[b]=ws(w),v),{})),i&&(y.items=Array.isArray(i)?i.map(ws):ws(i)),s&&(y.allOf=s.map(ws)),o)if(o.some(v=>typeof v=="object"&&(v==null?void 0:v.type)==="null")){const v=o.filter(b=>!(typeof b=="object"&&(b==null?void 0:b.type)==="null"));if(v.length===1){const b=ws(v[0]);typeof b=="object"&&(y.nullable=!0,Object.assign(y,b))}else y.anyOf=v.map(ws),y.nullable=!0}else y.anyOf=o.map(ws);return l&&(y.oneOf=l.map(ws)),h!==void 0&&(y.minLength=h),y}function NK(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function RK(e){var t,n;const r=[],a=[];let i=!0;for(const{role:s,content:o}of e)switch(s){case"system":{if(!i)throw new tv({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{i=!1;const l=[];for(const u of o)switch(u.type){case"text":{l.push({text:u.text});break}case"image":{l.push(u.image instanceof URL?{fileData:{mimeType:(t=u.mimeType)!=null?t:"image/jpeg",fileUri:u.image.toString()}}:{inlineData:{mimeType:(n=u.mimeType)!=null?n:"image/jpeg",data:TK(u.image)}});break}case"file":{l.push(u.data instanceof URL?{fileData:{mimeType:u.mimeType,fileUri:u.data.toString()}}:{inlineData:{mimeType:u.mimeType,data:u.data}});break}}a.push({role:"user",parts:l});break}case"assistant":{i=!1,a.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new tv({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new tv({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{i=!1,a.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:a}}function LI(e){return e.includes("/")?e:`models/${e}`}var IK=z.object({error:z.object({code:z.number().nullable(),message:z.string(),status:z.string()})}),O2=EK({errorSchema:IK,errorToMessage:e=>e.error.message});function jK(e,t,n,r){var a,i;const s=(a=e.tools)!=null&&a.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),u=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!u||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(s==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const d=[];for(const y of s)y.type==="provider-defined"?o.push({type:"unsupported-tool",tool:y}):d.push({name:y.name,description:(i=y.description)!=null?i:"",parameters:ws(y.parameters)});const h=e.toolChoice;if(h==null)return{tools:{functionDeclarations:d},toolConfig:void 0,toolWarnings:o};const p=h.type;switch(p){case"auto":return{tools:{functionDeclarations:d},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:d},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:d},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:d},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[h.toolName]}},toolWarnings:o};default:{const y=p;throw new tv({functionality:`Unsupported tool choice type: ${y}`})}}}function $I({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var OK=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:a,topK:i,frequencyPenalty:s,presencePenalty:o,stopSequences:l,responseFormat:u,seed:d,providerMetadata:h}){var p,y;const v=e.type,b=[],w=xK({provider:"google",providerOptions:h,schema:FK}),x={maxOutputTokens:n,temperature:r,topK:i,topP:a,frequencyPenalty:s,presencePenalty:o,stopSequences:l,seed:d,responseMimeType:(u==null?void 0:u.type)==="json"?"application/json":void 0,responseSchema:(u==null?void 0:u.type)==="json"&&u.schema!=null&&this.supportsStructuredOutputs?ws(u.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:w==null?void 0:w.responseModalities},{contents:S,systemInstruction:E}=RK(t);switch(v){case"regular":{const{tools:C,toolConfig:k,toolWarnings:R}=jK(e,(p=this.settings.useSearchGrounding)!=null?p:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:x,contents:S,systemInstruction:E,safetySettings:this.settings.safetySettings,tools:C,toolConfig:k,cachedContent:this.settings.cachedContent},warnings:[...b,...R]}}case"object-json":return{args:{generationConfig:{...x,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?ws(e.schema):void 0},contents:S,systemInstruction:E,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:b};case"object-tool":return{args:{generationConfig:x,contents:S,tools:{functionDeclarations:[{name:e.tool.name,description:(y=e.tool.description)!=null?y:"",parameters:ws(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:b};default:{const C=v;throw new Error(`Unsupported type: ${C}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,a,i;const{args:s,warnings:o}=await this.getArgs(e),l=JSON.stringify(s),u=N2(await j2(this.config.headers),e.headers),{responseHeaders:d,value:h,rawValue:p}=await I2({url:`${this.config.baseURL}/${LI(this.modelId)}:generateContent`,headers:u,body:s,failedResponseHandler:O2,successfulResponseHandler:oM(MK),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:y,...v}=s,b=h.candidates[0],w=b.content==null||typeof b.content!="object"||!("parts"in b.content)?[]:b.content.parts,x=BI({parts:w,generateId:this.config.generateId}),S=h.usageMetadata;return{text:zI(w),files:(t=UI(w))==null?void 0:t.map(E=>({data:E.inlineData.data,mimeType:E.inlineData.mimeType})),toolCalls:x,finishReason:$I({finishReason:b.finishReason,hasToolCalls:x!=null&&x.length>0}),usage:{promptTokens:(n=S==null?void 0:S.promptTokenCount)!=null?n:NaN,completionTokens:(r=S==null?void 0:S.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:y,rawSettings:v},rawResponse:{headers:d,body:p},warnings:o,providerMetadata:{google:{groundingMetadata:(a=b.groundingMetadata)!=null?a:null,safetyRatings:(i=b.safetyRatings)!=null?i:null}},sources:qI({groundingMetadata:b.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),a=N2(await j2(this.config.headers),e.headers),{responseHeaders:i,value:s}=await I2({url:`${this.config.baseURL}/${LI(this.modelId)}:streamGenerateContent?alt=sse`,headers:a,body:t,failedResponseHandler:O2,successfulResponseHandler:CK(PK),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let u="unknown",d={promptTokens:Number.NaN,completionTokens:Number.NaN},h;const p=this.config.generateId;let y=!1;return{stream:s.pipeThrough(new TransformStream({transform(v,b){var w,x,S,E,C,k;if(!v.success){b.enqueue({type:"error",error:v.error});return}const R=v.value,O=R.usageMetadata;O!=null&&(d={promptTokens:(w=O.promptTokenCount)!=null?w:NaN,completionTokens:(x=O.candidatesTokenCount)!=null?x:NaN});const j=(S=R.candidates)==null?void 0:S[0];if(j==null)return;const $=j.content;if($!=null){const L=zI($.parts);L!=null&&b.enqueue({type:"text-delta",textDelta:L});const X=UI($.parts);if(X!=null)for(const K of X)b.enqueue({type:"file",mimeType:K.inlineData.mimeType,data:K.inlineData.data});const F=BI({parts:$.parts,generateId:p});if(F!=null)for(const K of F)b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:K.toolCallId,toolName:K.toolName,argsTextDelta:K.args}),b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:K.toolCallId,toolName:K.toolName,args:K.args}),y=!0}if(j.finishReason!=null){u=$I({finishReason:j.finishReason,hasToolCalls:y});const L=(E=qI({groundingMetadata:j.groundingMetadata,generateId:p}))!=null?E:[];for(const X of L)b.enqueue({type:"source",source:X});h={google:{groundingMetadata:(C=j.groundingMetadata)!=null?C:null,safetyRatings:(k=j.safetyRatings)!=null?k:null}}}},flush(v){v.enqueue({type:"finish",finishReason:u,usage:d,providerMetadata:h})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:n,request:{body:r}}}};function BI({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function zI(e){const t=e==null?void 0:e.filter(n=>"text"in n);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function UI(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function qI({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var lM=z.object({role:z.string(),parts:z.array(z.union([z.object({text:z.string()}),z.object({functionCall:z.object({name:z.string(),args:z.unknown()})}),z.object({inlineData:z.object({mimeType:z.string(),data:z.string()})})])).nullish()}),DK=z.object({web:z.object({uri:z.string(),title:z.string()}).nullish(),retrievedContext:z.object({uri:z.string(),title:z.string()}).nullish()}),cM=z.object({webSearchQueries:z.array(z.string()).nullish(),retrievalQueries:z.array(z.string()).nullish(),searchEntryPoint:z.object({renderedContent:z.string()}).nullish(),groundingChunks:z.array(DK).nullish(),groundingSupports:z.array(z.object({segment:z.object({startIndex:z.number().nullish(),endIndex:z.number().nullish(),text:z.string().nullish()}),segment_text:z.string().nullish(),groundingChunkIndices:z.array(z.number()).nullish(),supportChunkIndices:z.array(z.number()).nullish(),confidenceScores:z.array(z.number()).nullish(),confidenceScore:z.array(z.number()).nullish()})).nullish(),retrievalMetadata:z.union([z.object({webDynamicRetrievalScore:z.number()}),z.object({})]).nullish()}),uM=z.object({category:z.string(),probability:z.string(),probabilityScore:z.number().nullish(),severity:z.string().nullish(),severityScore:z.number().nullish(),blocked:z.boolean().nullish()}),MK=z.object({candidates:z.array(z.object({content:lM.nullish().or(z.object({}).strict()),finishReason:z.string().nullish(),safetyRatings:z.array(uM).nullish(),groundingMetadata:cM.nullish()})),usageMetadata:z.object({promptTokenCount:z.number().nullish(),candidatesTokenCount:z.number().nullish(),totalTokenCount:z.number().nullish()}).nullish()}),PK=z.object({candidates:z.array(z.object({content:lM.nullish(),finishReason:z.string().nullish(),safetyRatings:z.array(uM).nullish(),groundingMetadata:cM.nullish()})).nullish(),usageMetadata:z.object({promptTokenCount:z.number().nullish(),candidatesTokenCount:z.number().nullish(),totalTokenCount:z.number().nullish()}).nullish()}),FK=z.object({responseModalities:z.array(z.enum(["TEXT","IMAGE"])).nullish()}),LK=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new rK({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=N2(await j2(this.config.headers),t),{responseHeaders:a,value:i}=await I2({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(s=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:s}]},outputDimensionality:this.settings.outputDimensionality}))},failedResponseHandler:O2,successfulResponseHandler:oM($K),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.embeddings.map(s=>s.values),usage:void 0,rawResponse:{headers:a}}}},$K=z.object({embeddings:z.array(z.object({values:z.array(z.number())}))});function BK(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function dM(e={}){var t;const n=(t=AK(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":pK({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),a=(o,l={})=>{var u;return new OK(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(u=e.generateId)!=null?u:fK,isSupportedUrl:BK,fetch:e.fetch})},i=(o,l={})=>new LK(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),s=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return a(o,l)};return s.languageModel=a,s.chat=a,s.generativeAI=a,s.embedding=i,s.textEmbedding=i,s.textEmbeddingModel=i,s}dM();var fM="vercel.ai.error",zK=Symbol.for(fM),hM,UK=class pM extends Error{constructor({name:t,message:n,cause:r}){super(n),this[hM]=!0,this.name=t,this.cause=r}static isInstance(t){return pM.hasMarker(t,fM)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};hM=zK;var Ba=UK,mM="AI_APICallError",gM=`vercel.ai.error.${mM}`,qK=Symbol.for(gM),yM,Dl=class extends Ba{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:a,responseBody:i,cause:s,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:mM,message:e,cause:s}),this[yM]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=a,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return Ba.hasMarker(e,gM)}};yM=qK;var bM="AI_EmptyResponseBodyError",vM=`vercel.ai.error.${bM}`,HK=Symbol.for(vM),wM,VK=class extends Ba{constructor({message:e="Empty response body"}={}){super({name:bM,message:e}),this[wM]=!0}static isInstance(e){return Ba.hasMarker(e,vM)}};wM=HK;function xM(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var _M="AI_InvalidArgumentError",SM=`vercel.ai.error.${_M}`,GK=Symbol.for(SM),EM,WK=class extends Ba{constructor({message:t,cause:n,argument:r}){super({name:_M,message:t,cause:n}),this[EM]=!0,this.argument=r}static isInstance(t){return Ba.hasMarker(t,SM)}};EM=GK;var CM="AI_InvalidPromptError",kM=`vercel.ai.error.${CM}`,KK=Symbol.for(kM),TM,ZK=class extends Ba{constructor({prompt:e,message:t,cause:n}){super({name:CM,message:`Invalid prompt: ${t}`,cause:n}),this[TM]=!0,this.prompt=e}static isInstance(e){return Ba.hasMarker(e,kM)}};TM=KK;var AM="AI_InvalidResponseDataError",NM=`vercel.ai.error.${AM}`,YK=Symbol.for(NM),RM,aS=class extends Ba{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:AM,message:t}),this[RM]=!0,this.data=e}static isInstance(e){return Ba.hasMarker(e,NM)}};RM=YK;var IM="AI_JSONParseError",jM=`vercel.ai.error.${IM}`,XK=Symbol.for(jM),OM,Tv=class extends Ba{constructor({text:e,cause:t}){super({name:IM,message:`JSON parsing failed: Text: ${e}.
Error message: ${xM(t)}`,cause:t}),this[OM]=!0,this.text=e}static isInstance(e){return Ba.hasMarker(e,jM)}};OM=XK;var DM="AI_LoadAPIKeyError",MM=`vercel.ai.error.${DM}`,JK=Symbol.for(MM),PM,gb=class extends Ba{constructor({message:e}){super({name:DM,message:e}),this[PM]=!0}static isInstance(e){return Ba.hasMarker(e,MM)}};PM=JK;var FM="AI_TypeValidationError",LM=`vercel.ai.error.${FM}`,QK=Symbol.for(LM),$M,eZ=class D2 extends Ba{constructor({value:t,cause:n}){super({name:FM,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${xM(n)}`,cause:n}),this[$M]=!0,this.value=t}static isInstance(t){return Ba.hasMarker(t,LM)}static wrap({value:t,cause:n}){return D2.isInstance(n)&&n.value===t?n:new D2({value:t,cause:n})}};$M=QK;var Av=eZ,BM="AI_UnsupportedFunctionalityError",zM=`vercel.ai.error.${BM}`,tZ=Symbol.for(zM),UM,_s=class extends Ba{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:BM,message:t}),this[UM]=!0,this.functionality=e}static isInstance(e){return Ba.hasMarker(e,zM)}};UM=tZ;let nZ=(e,t=21)=>(n=t)=>{let r="",a=n|0;for(;a--;)r+=e[Math.random()*e.length|0];return r},HI=class extends Error{constructor(t,n){super(t),this.name="ParseError",this.type=n.type,this.field=n.field,this.value=n.value,this.line=n.line}};function iS(e){}function rZ(e){if(typeof e=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=iS,onError:n=iS,onRetry:r=iS,onComment:a}=e;let i="",s=!0,o,l="",u="";function d(b){const w=s?b.replace(/^\xEF\xBB\xBF/,""):b,[x,S]=aZ(`${i}${w}`);for(const E of x)h(E);i=S,s=!1}function h(b){if(b===""){y();return}if(b.startsWith(":")){a&&a(b.slice(b.startsWith(": ")?2:1));return}const w=b.indexOf(":");if(w!==-1){const x=b.slice(0,w),S=b[w+1]===" "?2:1,E=b.slice(w+S);p(x,E,b);return}p(b,"",b)}function p(b,w,x){switch(b){case"event":u=w;break;case"data":l=`${l}${w}
`;break;case"id":o=w.includes("\0")?void 0:w;break;case"retry":/^\d+$/.test(w)?r(parseInt(w,10)):n(new HI(`Invalid \`retry\` value: "${w}"`,{type:"invalid-retry",value:w,line:x}));break;default:n(new HI(`Unknown field "${b.length>20?`${b.slice(0,20)}`:b}"`,{type:"unknown-field",field:b,value:w,line:x}));break}}function y(){l.length>0&&t({id:o,event:u||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),o=void 0,l="",u=""}function v(b={}){i&&b.consume&&h(i),s=!0,o=void 0,l="",u="",i=""}return{feed:d,reset:v}}function aZ(e){const t=[];let n="",r=0;for(;r<e.length;){const a=e.indexOf("\r",r),i=e.indexOf(`
`,r);let s=-1;if(a!==-1&&i!==-1?s=Math.min(a,i):a!==-1?s=a:i!==-1&&(s=i),s===-1){n=e.slice(r);break}else{const o=e.slice(r,s);t.push(o),r=s+1,e[r-1]==="\r"&&e[r]===`
`&&r++}}return[t,n]}class iZ extends TransformStream{constructor({onError:t,onRetry:n,onComment:r}={}){let a;super({start(i){a=rZ({onEvent:s=>{i.enqueue(s)},onError(s){t==="terminate"?i.error(s):typeof t=="function"&&t(s)},onRetry:n,onComment:r})},transform(i){a.feed(i)}})}}var sZ={};function Nv(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function Mw(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var oZ=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=nZ(n,t);if(e==null)return a;if(n.includes(r))throw new WK({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${a(i)}`},yb=oZ();function lZ(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function sS(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function cZ({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new gb({message:`${r} API key must be a string.`});if(typeof ea>"u")throw new gb({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=sZ[t],e==null)throw new gb({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new gb({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var M2=Symbol.for("vercel.ai.validator");function uZ(e){return{[M2]:!0,validate:e}}function dZ(e){return typeof e=="object"&&e!==null&&M2 in e&&e[M2]===!0&&"validate"in e}function fZ(e){return dZ(e)?e:hZ(e)}function hZ(e){return uZ(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function pZ({value:e,schema:t}){const n=qM({value:e,schema:t});if(!n.success)throw Av.wrap({value:e,cause:n.error});return n.value}function qM({value:e,schema:t}){const n=fZ(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:Av.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:Av.wrap({value:e,cause:r})}}}function mZ({text:e,schema:t}){try{const n=oo.parse(e);return t==null?n:pZ({value:n,schema:t})}catch(n){throw Tv.isInstance(n)||Av.isInstance(n)?n:new Tv({text:e,cause:n})}}function HM({text:e,schema:t}){try{const n=oo.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=qM({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:Tv.isInstance(n)?n:new Tv({text:e,cause:n})}}}function oS(e){try{return oo.parse(e),!0}catch{return!1}}var gZ=()=>globalThis.fetch,Rv=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s})=>yZ({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s}),yZ=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:a,abortSignal:i,fetch:s=gZ()})=>{try{const o=await s(e,{method:"POST",headers:lZ(t),body:n.content,signal:i}),l=Mw(o);if(!o.ok){let u;try{u=await a({response:o,url:e,requestBodyValues:n.values})}catch(d){throw sS(d)||Dl.isInstance(d)?d:new Dl({message:"Failed to process error response",cause:d,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw u.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(u){throw u instanceof Error&&(sS(u)||Dl.isInstance(u))?u:new Dl({message:"Failed to process successful response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(sS(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new Dl({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}},bZ=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:a,requestBodyValues:i})=>{const s=await r.text(),o=Mw(r);if(s.trim()==="")return{responseHeaders:o,value:new Dl({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:n==null?void 0:n(r)})};try{const l=mZ({text:s,schema:e});return{responseHeaders:o,value:new Dl({message:t(l),url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new Dl({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:n==null?void 0:n(r)})}}},VM=e=>async({response:t})=>{const n=Mw(t);if(t.body==null)throw new VK({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new iZ).pipeThrough(new TransformStream({transform({data:r},a){r!=="[DONE]"&&a.enqueue(HM({text:r,schema:e}))}}))}},GM=e=>async({response:t,url:n,requestBodyValues:r})=>{const a=await t.text(),i=HM({text:a,schema:e}),s=Mw(t);if(!i.success)throw new Dl({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:s,responseBody:a,url:n,requestBodyValues:r});return{responseHeaders:s,value:i.value,rawValue:i.rawValue}},{btoa:vZ}=globalThis;function wZ(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return vZ(t)}function xZ(e){return e==null?void 0:e.replace(/\/$/,"")}var _Z=Object.defineProperty,SZ=Object.defineProperties,EZ=Object.getOwnPropertyDescriptors,Iv=Object.getOwnPropertySymbols,WM=Object.prototype.hasOwnProperty,KM=Object.prototype.propertyIsEnumerable,VI=(e,t,n)=>t in e?_Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Qi=(e,t)=>{for(var n in t||(t={}))WM.call(t,n)&&VI(e,n,t[n]);if(Iv)for(var n of Iv(t))KM.call(t,n)&&VI(e,n,t[n]);return e},nv=(e,t)=>SZ(e,EZ(t)),jv=(e,t)=>{var n={};for(var r in e)WM.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Iv)for(var r of Iv(e))t.indexOf(r)<0&&KM.call(e,r)&&(n[r]=e[r]);return n};function Ao(e){var t,n,r;const a=e==null?void 0:e.anthropic,i=e==null?void 0:e.openrouter;return(r=(n=(t=i==null?void 0:i.cacheControl)!=null?t:i==null?void 0:i.cache_control)!=null?n:a==null?void 0:a.cacheControl)!=null?r:a==null?void 0:a.cache_control}function CZ(e){var t,n,r;const a=[];for(const{role:i,content:s,providerMetadata:o}of e)switch(i){case"system":{a.push({role:"system",content:s,cache_control:Ao(o)});break}case"user":{if(s.length===1&&((t=s[0])==null?void 0:t.type)==="text"){a.push({role:"user",content:s[0].text,cache_control:(n=Ao(o))!=null?n:Ao(s[0].providerMetadata)});break}const l=Ao(o),u=s.map(d=>{var h,p,y,v;switch(d.type){case"text":return{type:"text",text:d.text,cache_control:(h=Ao(d.providerMetadata))!=null?h:l};case"image":return{type:"image_url",image_url:{url:d.image instanceof URL?d.image.toString():`data:${(p=d.mimeType)!=null?p:"image/jpeg"};base64,${wZ(d.image)}`},cache_control:(y=Ao(d.providerMetadata))!=null?y:l};case"file":return{type:"text",text:d.data instanceof URL?d.data.toString():d.data,cache_control:(v=Ao(d.providerMetadata))!=null?v:l};default:{const b=d;throw new Error(`Unsupported content part type: ${b}`)}}});a.push({role:"user",content:u});break}case"assistant":{let l="";const u=[];for(const d of s)switch(d.type){case"text":{l+=d.text;break}case"tool-call":{u.push({id:d.toolCallId,type:"function",function:{name:d.toolName,arguments:JSON.stringify(d.args)}});break}case"reasoning":case"redacted-reasoning":break;default:{const h=d;throw new Error(`Unsupported part: ${h}`)}}a.push({role:"assistant",content:l,tool_calls:u.length>0?u:void 0,cache_control:Ao(o)});break}case"tool":{for(const l of s)a.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=Ao(o))!=null?r:Ao(l.providerMetadata)});break}default:{const l=i;throw new Error(`Unsupported role: ${l}`)}}return a}function GI(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:a,top_logprobs:i})=>({token:r,logprob:a,topLogprobs:i?i.map(({token:s,logprob:o})=>({token:s,logprob:o})):[]})))!=null?n:void 0}function Ov(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var nk=z.object({error:z.object({message:z.string(),type:z.string(),param:z.any().nullable(),code:z.string().nullable()})}),Dv=bZ({errorSchema:nk,errorToMessage:e=>e.error.message});function kZ(e){return"parameters"in e}var TZ=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:a,frequencyPenalty:i,presencePenalty:s,seed:o,stopSequences:l,responseFormat:u,topK:d,providerMetadata:h}){var p;const y=e.type,v=(p=h==null?void 0:h.openrouter)!=null?p:{},b=Qi(Qi(Qi({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:a,frequency_penalty:i,presence_penalty:s,seed:o,stop:l,response_format:u,top_k:d,messages:CZ(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),v);switch(y){case"regular":return Qi(Qi({},b),RZ(e));case"object-json":return nv(Qi({},b),{response_format:{type:"json_object"}});case"object-tool":return nv(Qi({},b),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const w=y;throw new _s({functionality:`${w} mode`})}}}async doGenerate(e){var t,n,r,a,i,s,o;const l=this.getArgs(e),{responseHeaders:u,value:d}=await Rv({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Nv(this.config.headers(),e.headers),body:l,failedResponseHandler:Dv,successfulResponseHandler:GM(AZ),abortSignal:e.abortSignal,fetch:this.config.fetch}),h=l,{messages:p}=h,y=jv(h,["messages"]),v=d.choices[0];if(!v)throw new Error("No choice in response");return{response:{id:d.id,modelId:d.model},text:(t=v.message.content)!=null?t:void 0,reasoning:(n=v.message.reasoning)!=null?n:void 0,toolCalls:(r=v.message.tool_calls)==null?void 0:r.map(b=>{var w;return{toolCallType:"function",toolCallId:(w=b.id)!=null?w:yb(),toolName:b.function.name,args:b.function.arguments}}),finishReason:Ov(v.finish_reason),usage:{promptTokens:(i=(a=d.usage)==null?void 0:a.prompt_tokens)!=null?i:0,completionTokens:(o=(s=d.usage)==null?void 0:s.completion_tokens)!=null?o:0},rawCall:{rawPrompt:p,rawSettings:y},rawResponse:{headers:u},warnings:[],logprobs:GI(v.logprobs)}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Rv({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Nv(this.config.headers(),e.headers),body:nv(Qi({},t),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:Dv,successfulResponseHandler:VM(NZ),abortSignal:e.abortSignal,fetch:this.config.fetch}),a=t,{messages:i}=a,s=jv(a,["messages"]),o=[];let l="other",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d;return{stream:r.pipeThrough(new TransformStream({transform(h,p){var y,v,b,w,x,S,E,C,k,R,O,j;if(!h.success){l="error",p.enqueue({type:"error",error:h.error});return}const $=h.value;if("error"in $){l="error",p.enqueue({type:"error",error:$.error});return}$.id&&p.enqueue({type:"response-metadata",id:$.id}),$.model&&p.enqueue({type:"response-metadata",modelId:$.model}),$.usage!=null&&(u={promptTokens:$.usage.prompt_tokens,completionTokens:$.usage.completion_tokens});const L=$.choices[0];if((L==null?void 0:L.finish_reason)!=null&&(l=Ov(L.finish_reason)),(L==null?void 0:L.delta)==null)return;const X=L.delta;X.content!=null&&p.enqueue({type:"text-delta",textDelta:X.content}),X.reasoning!=null&&p.enqueue({type:"reasoning",textDelta:X.reasoning});const F=GI(L==null?void 0:L.logprobs);if(F!=null&&F.length&&(d===void 0&&(d=[]),d.push(...F)),X.tool_calls!=null)for(const K of X.tool_calls){const q=K.index;if(o[q]==null){if(K.type!=="function")throw new aS({data:K,message:"Expected 'function' type."});if(K.id==null)throw new aS({data:K,message:"Expected 'id' to be a string."});if(((y=K.function)==null?void 0:y.name)==null)throw new aS({data:K,message:"Expected 'function.name' to be a string."});o[q]={id:K.id,type:"function",function:{name:K.function.name,arguments:(v=K.function.arguments)!=null?v:""},sent:!1};const re=o[q];if(re==null)throw new Error("Tool call is missing");((b=re.function)==null?void 0:b.name)!=null&&((w=re.function)==null?void 0:w.arguments)!=null&&oS(re.function.arguments)&&(p.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:re.id,toolName:re.function.name,argsTextDelta:re.function.arguments}),p.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(x=re.id)!=null?x:yb(),toolName:re.function.name,args:re.function.arguments}),re.sent=!0);continue}const de=o[q];if(de==null)throw new Error("Tool call is missing");((S=K.function)==null?void 0:S.arguments)!=null&&(de.function.arguments+=(C=(E=K.function)==null?void 0:E.arguments)!=null?C:""),p.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:de.id,toolName:de.function.name,argsTextDelta:(k=K.function.arguments)!=null?k:""}),((R=de.function)==null?void 0:R.name)!=null&&((O=de.function)==null?void 0:O.arguments)!=null&&oS(de.function.arguments)&&(p.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(j=de.id)!=null?j:yb(),toolName:de.function.name,args:de.function.arguments}),de.sent=!0)}},flush(h){var p;if(l==="tool-calls")for(const y of o)y.sent||(h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(p=y.id)!=null?p:yb(),toolName:y.function.name,args:oS(y.function.arguments)?y.function.arguments:"{}"}),y.sent=!0);h.enqueue({type:"finish",finishReason:l,logprobs:d,usage:u})}})),rawCall:{rawPrompt:i,rawSettings:s},rawResponse:{headers:n},warnings:[]}}},ZM=z.object({id:z.string().optional(),model:z.string().optional(),usage:z.object({prompt_tokens:z.number(),completion_tokens:z.number(),total_tokens:z.number()}).nullish()}),AZ=ZM.extend({choices:z.array(z.object({message:z.object({role:z.literal("assistant"),content:z.string().nullable().optional(),reasoning:z.string().nullable().optional(),tool_calls:z.array(z.object({id:z.string().optional().nullable(),type:z.literal("function"),function:z.object({name:z.string(),arguments:z.string()})})).optional()}),index:z.number(),logprobs:z.object({content:z.array(z.object({token:z.string(),logprob:z.number(),top_logprobs:z.array(z.object({token:z.string(),logprob:z.number()}))})).nullable()}).nullable().optional(),finish_reason:z.string().optional().nullable()}))}),NZ=z.union([ZM.extend({choices:z.array(z.object({delta:z.object({role:z.enum(["assistant"]).optional(),content:z.string().nullish(),reasoning:z.string().nullish().optional(),tool_calls:z.array(z.object({index:z.number(),id:z.string().nullish(),type:z.literal("function").optional(),function:z.object({name:z.string().nullish(),arguments:z.string().nullish()})})).nullish()}).nullish(),logprobs:z.object({content:z.array(z.object({token:z.string(),logprob:z.number(),top_logprobs:z.array(z.object({token:z.string(),logprob:z.number()}))})).nullable()}).nullish(),finish_reason:z.string().nullable().optional(),index:z.number()}))}),nk]);function RZ(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(s=>kZ(s)?{type:"function",function:{name:s.name,description:s.description,parameters:s.parameters}}:{type:"function",function:{name:s.name}}),a=e.toolChoice;if(a==null)return{tools:r,tool_choice:void 0};const i=a.type;switch(i){case"auto":case"none":case"required":return{tools:r,tool_choice:i};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:a.toolName}}};default:{const s=i;throw new Error(`Unsupported tool choice type: ${s}`)}}}function IZ({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let a="";e[0]&&e[0].role==="system"&&(a+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:s}of e)switch(i){case"system":throw new ZK({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=s.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new _s({functionality:"images"});case"file":throw new _s({functionality:"file attachments"});default:{const u=l;throw new Error(`Unsupported content type: ${u}`)}}}).join("");a+=`${n}:
${o}

`;break}case"assistant":{const o=s.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new _s({functionality:"tool-call messages"});case"reasoning":throw new _s({functionality:"reasoning messages"});case"redacted-reasoning":throw new _s({functionality:"redacted reasoning messages"});default:{const u=l;throw new Error(`Unsupported content type: ${u}`)}}}).join("");a+=`${r}:
${o}

`;break}case"tool":throw new _s({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return a+=`${r}:
`,{prompt:a}}function WI(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,a;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((a=e.top_logprobs[n])!=null?a:{}).map(([i,s])=>({token:i,logprob:s})):[]}})}var jZ=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:a,topP:i,frequencyPenalty:s,presencePenalty:o,seed:l,responseFormat:u,topK:d,stopSequences:h,providerMetadata:p}){var y,v;const b=e.type,w=(y=p==null?void 0:p.openrouter)!=null?y:{},{prompt:x}=IZ({prompt:n,inputFormat:t}),S=Qi(Qi(Qi({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:a,top_p:i,frequency_penalty:s,presence_penalty:o,seed:l,stop:h,response_format:u,top_k:d,prompt:x,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),w);switch(b){case"regular":{if((v=e.tools)!=null&&v.length)throw new _s({functionality:"tools"});if(e.toolChoice)throw new _s({functionality:"toolChoice"});return S}case"object-json":throw new _s({functionality:"object-json mode"});case"object-tool":throw new _s({functionality:"object-tool mode"});default:{const E=b;throw new _s({functionality:`${E} mode`})}}}async doGenerate(e){var t,n,r,a,i;const s=this.getArgs(e),{responseHeaders:o,value:l}=await Rv({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Nv(this.config.headers(),e.headers),body:s,failedResponseHandler:Dv,successfulResponseHandler:GM(KI),abortSignal:e.abortSignal,fetch:this.config.fetch}),u=s,{prompt:d}=u,h=jv(u,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const p=l.choices[0];if(!p)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=p.text)!=null?t:"",reasoning:p.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(i=(a=l.usage)==null?void 0:a.completion_tokens)!=null?i:0},finishReason:Ov(p.finish_reason),logprobs:WI(p.logprobs),rawCall:{rawPrompt:d,rawSettings:h},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Rv({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Nv(this.config.headers(),e.headers),body:nv(Qi({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:Dv,successfulResponseHandler:VM(KI),abortSignal:e.abortSignal,fetch:this.config.fetch}),a=t,{prompt:i}=a,s=jv(a,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},u;return{stream:r.pipeThrough(new TransformStream({transform(d,h){if(!d.success){o="error",h.enqueue({type:"error",error:d.error});return}const p=d.value;if("error"in p){o="error",h.enqueue({type:"error",error:p.error});return}p.usage!=null&&(l={promptTokens:p.usage.prompt_tokens,completionTokens:p.usage.completion_tokens});const y=p.choices[0];(y==null?void 0:y.finish_reason)!=null&&(o=Ov(y.finish_reason)),(y==null?void 0:y.text)!=null&&h.enqueue({type:"text-delta",textDelta:y.text});const v=WI(y==null?void 0:y.logprobs);v!=null&&v.length&&(u===void 0&&(u=[]),u.push(...v))},flush(d){d.enqueue({type:"finish",finishReason:o,logprobs:u,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:s},rawResponse:{headers:n},warnings:[]}}},KI=z.union([z.object({id:z.string().optional(),model:z.string().optional(),choices:z.array(z.object({text:z.string(),reasoning:z.string().nullish().optional(),finish_reason:z.string().nullish(),index:z.number(),logprobs:z.object({tokens:z.array(z.string()),token_logprobs:z.array(z.number()),top_logprobs:z.array(z.record(z.string(),z.number())).nullable()}).nullable().optional()})),usage:z.object({prompt_tokens:z.number(),completion_tokens:z.number()}).optional().nullable()}),nk]);function YM(e={}){var t,n,r;const a=(n=xZ((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",i=(r=e.compatibility)!=null?r:"compatible",s=()=>Qi({Authorization:`Bearer ${cZ({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(h,p={})=>new TZ(h,p,{provider:"openrouter.chat",url:({path:y})=>`${a}${y}`,headers:s,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),l=(h,p={})=>new jZ(h,p,{provider:"openrouter.completion",url:({path:y})=>`${a}${y}`,headers:s,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),u=(h,p)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return h==="openai/gpt-3.5-turbo-instruct"?l(h,p):o(h,p)},d=function(h,p){return u(h,p)};return d.languageModel=u,d.chat=o,d.completion=l,d}YM({compatibility:"strict"});var ud={},lS={},ZI;function YI(){return ZI||(ZI=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(lS)),lS}var XI;function OZ(){return XI||(XI=1,function(e){var t=ud&&ud.__createBinding||(Object.create?function(u,d,h,p){p===void 0&&(p=h);var y=Object.getOwnPropertyDescriptor(d,h);(!y||("get"in y?!d.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return d[h]}}),Object.defineProperty(u,p,y)}:function(u,d,h,p){p===void 0&&(p=h),u[p]=d[h]}),n=ud&&ud.__exportStar||function(u,d){for(var h in u)h!=="default"&&!Object.prototype.hasOwnProperty.call(d,h)&&t(d,u,h)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=YI();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(YI(),e);class a extends Error{}e.PartialJSON=a;class i extends Error{}e.MalformedJSON=i;function s(u,d=r.Allow.ALL){if(typeof u!="string")throw new TypeError(`expecting str, got ${typeof u}`);if(!u.trim())throw new Error(`${u} is empty`);return o(u.trim(),d)}e.parseJSON=s;const o=(u,d)=>{const h=u.length;let p=0;const y=k=>{throw new a(`${k} at position ${p}`)},v=k=>{throw new i(`${k} at position ${p}`)},b=()=>(C(),p>=h&&y("Unexpected end of input"),u[p]==='"'?w():u[p]==="{"?x():u[p]==="["?S():u.substring(p,p+4)==="null"||r.Allow.NULL&d&&h-p<4&&"null".startsWith(u.substring(p))?(p+=4,null):u.substring(p,p+4)==="true"||r.Allow.BOOL&d&&h-p<4&&"true".startsWith(u.substring(p))?(p+=4,!0):u.substring(p,p+5)==="false"||r.Allow.BOOL&d&&h-p<5&&"false".startsWith(u.substring(p))?(p+=5,!1):u.substring(p,p+8)==="Infinity"||r.Allow.INFINITY&d&&h-p<8&&"Infinity".startsWith(u.substring(p))?(p+=8,1/0):u.substring(p,p+9)==="-Infinity"||r.Allow._INFINITY&d&&1<h-p&&h-p<9&&"-Infinity".startsWith(u.substring(p))?(p+=9,-1/0):u.substring(p,p+3)==="NaN"||r.Allow.NAN&d&&h-p<3&&"NaN".startsWith(u.substring(p))?(p+=3,NaN):E()),w=()=>{const k=p;let R=!1;for(p++;p<h&&(u[p]!=='"'||R&&u[p-1]==="\\");)R=u[p]==="\\"?!R:!1,p++;if(u.charAt(p)=='"')try{return JSON.parse(u.substring(k,++p-Number(R)))}catch(O){v(String(O))}else if(r.Allow.STR&d)try{return JSON.parse(u.substring(k,p-Number(R))+'"')}catch{return JSON.parse(u.substring(k,u.lastIndexOf("\\"))+'"')}y("Unterminated string literal")},x=()=>{p++,C();const k={};try{for(;u[p]!=="}";){if(C(),p>=h&&r.Allow.OBJ&d)return k;const R=w();C(),p++;try{const O=b();k[R]=O}catch(O){if(r.Allow.OBJ&d)return k;throw O}C(),u[p]===","&&p++}}catch{if(r.Allow.OBJ&d)return k;y("Expected '}' at end of object")}return p++,k},S=()=>{p++;const k=[];try{for(;u[p]!=="]";)k.push(b()),C(),u[p]===","&&p++}catch{if(r.Allow.ARR&d)return k;y("Expected ']' at end of array")}return p++,k},E=()=>{if(p===0){u==="-"&&v("Not sure what '-' is");try{return JSON.parse(u)}catch(R){if(r.Allow.NUM&d)try{return JSON.parse(u.substring(0,u.lastIndexOf("e")))}catch{}v(String(R))}}const k=p;for(u[p]==="-"&&p++;u[p]&&",]}".indexOf(u[p])===-1;)p++;p==h&&!(r.Allow.NUM&d)&&y("Unterminated number literal");try{return JSON.parse(u.substring(k,p))}catch{u.substring(k,p)==="-"&&y("Not sure what '-' is");try{return JSON.parse(u.substring(k,u.lastIndexOf("e")))}catch(O){v(String(O))}}},C=()=>{for(;p<h&&` 
\r	`.includes(u[p]);)p++};return b()},l=s;e.parse=l}(ud)),ud}var DZ=OZ();function cS(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((a,i)=>{if(i.type==="text")a.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new Tr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(a.images=a.images||[],a.images.push(Th(i.image)))}return a},{content:""}),role:"user"});break}case"assistant":{const a=[],i=[];for(const s of n)switch(s.type){case"text":{a.push(s.text);break}case"tool-call":{i.push({function:{arguments:s.args,name:s.toolName},id:s.toolCallId,type:"function"});break}default:{const o=s;throw new Error(`Unsupported part: ${o}`)}}t.push({content:a.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{t.push(...n.map(a=>({content:typeof a.result=="object"?JSON.stringify(a.result):`${a.result}`,role:"tool",tool_call_id:a.toolCallId})));break}default:{const a=r;throw new Error(`Unsupported role: ${a}`)}}return t}var MZ=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=DZ.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[a,i]of r.entries()){const s=(n=JSON.stringify(i==null?void 0:i.parameters))!=null?n:"";if(s==="")continue;this._toolCalls[a]||(this._toolCalls[a]={function:{arguments:"",name:i.name},id:Po(),type:"function"});const o=this._toolCalls[a];o.function.arguments=s,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function PZ({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var FZ=z.object({error:z.object({code:z.string().nullable(),message:z.string(),param:z.any().nullable(),type:z.string()})}),P2=mD({errorSchema:FZ,errorToMessage:e=>e.error.message});function LZ({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],a=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const i=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):i.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(a===void 0)return{tools:i,toolWarnings:r};const s=a.type;switch(s){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=s;throw new Tr({functionality:`Unsupported tool choice type: ${o}`})}}}function $Z(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var BZ=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},zZ=e=>async({response:t})=>{const n=c0(t);if(t.body===null)throw new WC({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new BZ).pipeThrough(new TransformStream({transform(r,a){a.enqueue(Id({schema:e,text:r}))}}))}},UZ=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:a,responseFormat:i,seed:s,stopSequences:o,temperature:l,topK:u,topP:d}){const h=n.type,p=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&!this.supportsStructuredOutputs&&p.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const y={format:i==null?void 0:i.type,model:this.modelId,options:$Z({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:s,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:u,top_p:d,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(h){case"regular":{const{tools:v,toolWarnings:b}=LZ({mode:n});return{args:{...y,messages:cS(a),tools:v},type:h,warnings:[...p,...b]}}case"object-json":return{args:{...y,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:cS(a)},type:h,warnings:p};case"object-tool":return{args:{...y,messages:cS(a),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:h,warnings:p};default:{const v=h;throw new Error(`Unsupported type: ${v}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:a}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:s,value:o}=await Js({abortSignal:e.abortSignal,body:i,failedResponseHandler:P2,fetch:this.config.fetch,headers:Ho(this.config.headers(),e.headers),successfulResponseHandler:Wd(qZ),url:`${this.config.baseURL}/chat`}),{messages:l,...u}=i,d=(t=o.message.tool_calls)==null?void 0:t.map(h=>{var p;return{args:JSON.stringify(h.function.arguments),toolCallId:(p=h.id)!=null?p:Po(),toolCallType:"function",toolName:h.function.name}});return{finishReason:PZ({finishReason:o.done_reason,hasToolCalls:d!==void 0&&d.length>0}),rawCall:{rawPrompt:l,rawSettings:u},rawResponse:{headers:s},request:{body:JSON.stringify(i)},text:(n=o.message.content)!=null?n:void 0,toolCalls:d,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:a}}async doStream(e){if(this.settings.simulateStreaming){const y=await this.doGenerate(e),v=new ReadableStream({start(b){if(b.enqueue({type:"response-metadata",...y.response}),y.text&&b.enqueue({textDelta:y.text,type:"text-delta"}),y.toolCalls)for(const w of y.toolCalls)b.enqueue({argsTextDelta:w.args,toolCallId:w.toolCallId,toolCallType:"function",toolName:w.toolName,type:"tool-call-delta"}),b.enqueue({type:"tool-call",...w});b.enqueue({finishReason:y.finishReason,logprobs:y.logprobs,providerMetadata:y.providerMetadata,type:"finish",usage:y.usage}),b.close()}});return{rawCall:y.rawCall,rawResponse:y.rawResponse,stream:v,warnings:y.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:a,value:i}=await Js({abortSignal:e.abortSignal,body:t,failedResponseHandler:P2,fetch:this.config.fetch,headers:Ho(this.config.headers(),e.headers),successfulResponseHandler:zZ(HZ),url:`${this.config.baseURL}/chat`}),{messages:s,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,u=new MZ({tools:l,type:n});let d="other",h={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:p=!0}=this.settings;return{rawCall:{rawPrompt:s,rawSettings:o},rawResponse:{headers:a},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(y){y.enqueue({finishReason:d,type:"finish",usage:h})},async transform(y,v){if(!y.success){v.enqueue({error:y.error,type:"error"});return}const b=y.value;if(b.done){d=u.finish({controller:v}),h={completionTokens:b.eval_count,promptTokens:b.prompt_eval_count||0};return}p&&u.parse({controller:v,delta:b.message.content})||b.message.content!==null&&v.enqueue({textDelta:b.message.content,type:"text-delta"})}})),warnings:r}}},qZ=z.object({created_at:z.string(),done:z.literal(!0),done_reason:z.string().optional().nullable(),eval_count:z.number(),eval_duration:z.number(),load_duration:z.number().optional(),message:z.object({content:z.string(),role:z.string(),tool_calls:z.array(z.object({function:z.object({arguments:z.record(z.any()),name:z.string()}),id:z.string().optional()})).optional().nullable()}),model:z.string(),prompt_eval_count:z.number().optional(),prompt_eval_duration:z.number().optional(),total_duration:z.number()}),HZ=z.discriminatedUnion("done",[z.object({created_at:z.string(),done:z.literal(!1),message:z.object({content:z.string(),role:z.string()}),model:z.string()}),z.object({created_at:z.string(),done:z.literal(!0),eval_count:z.number(),eval_duration:z.number(),load_duration:z.number().optional(),model:z.string(),prompt_eval_count:z.number().optional(),prompt_eval_duration:z.number().optional(),total_duration:z.number()})]),VZ=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new ZC({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await Js({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:P2,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:Wd(GZ),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},GZ=z.object({embeddings:z.array(z.array(z.number())),prompt_eval_count:z.number().nullable()});function XM(e={}){var t;const n=(t=yD(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),a=(o,l={})=>new UZ(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),i=(o,l={})=>new VZ(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),s=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return a(o,l)};return s.chat=a,s.embedding=i,s.languageModel=a,s.textEmbedding=i,s.textEmbeddingModel=i,s}XM();let WZ=(e,t=21)=>(n=t)=>{let r="",a=n|0;for(;a--;)r+=e[Math.random()*e.length|0];return r};function Ih(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function KZ(){let e="",t,n=[],r,a;function i(l,u){if(l===""){s(u);return}if(l.startsWith(":"))return;const d=l.indexOf(":");if(d===-1){o(l,"");return}const h=l.slice(0,d),p=d+1,y=p<l.length&&l[p]===" "?l.slice(p+1):l.slice(p);o(h,y)}function s(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:a}),n=[],t=void 0,a=void 0)}function o(l,u){switch(l){case"event":t=u;break;case"data":n.push(u);break;case"id":r=u;break;case"retry":const d=parseInt(u,10);isNaN(d)||(a=d);break}}return new TransformStream({transform(l,u){const{lines:d,incompleteLine:h}=ZZ(e,l);e=h;for(let p=0;p<d.length;p++)i(d[p],u)},flush(l){i(e,l),s(l)}})}function ZZ(e,t){const n=[];let r=e;for(let a=0;a<t.length;){const i=t[a++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[a+1]===`
`&&a++):r+=i}return{lines:n,incompleteLine:r}}function Pw(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var YZ=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const a=WZ(n,t);if(e==null)return a;if(n.includes(r))throw new KC({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${a(i)}`},uS=YZ();function XZ(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function dS(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}var F2=Symbol.for("vercel.ai.validator");function JZ(e){return{[F2]:!0,validate:e}}function QZ(e){return typeof e=="object"&&e!==null&&F2 in e&&e[F2]===!0&&"validate"in e}function eY(e){return QZ(e)?e:tY(e)}function tY(e){return JZ(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function nY({value:e,schema:t}){const n=JM({value:e,schema:t});if(!n.success)throw ru.wrap({value:e,cause:n.error});return n.value}function JM({value:e,schema:t}){const n=eY(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:ru.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:ru.wrap({value:e,cause:r})}}}function rY({text:e,schema:t}){try{const n=oo.parse(e);return t==null?n:nY({value:n,schema:t})}catch(n){throw nu.isInstance(n)||ru.isInstance(n)?n:new nu({text:e,cause:n})}}function QM({text:e,schema:t}){try{const n=oo.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=JM({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:nu.isInstance(n)?n:new nu({text:e,cause:n})}}}function JI(e){try{return oo.parse(e),!0}catch{return!1}}var aY=()=>globalThis.fetch,jh=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s})=>iY({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s}),iY=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:a,abortSignal:i,fetch:s=aY()})=>{try{const o=await s(e,{method:"POST",headers:XZ(t),body:n.content,signal:i}),l=Pw(o);if(!o.ok){let u;try{u=await a({response:o,url:e,requestBodyValues:n.values})}catch(d){throw dS(d)||xa.isInstance(d)?d:new xa({message:"Failed to process error response",cause:d,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw u.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(u){throw u instanceof Error&&(dS(u)||xa.isInstance(u))?u:new xa({message:"Failed to process successful response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(dS(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new xa({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}},Fw=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:a,requestBodyValues:i})=>{const s=await r.text(),o=Pw(r);if(s.trim()==="")return{responseHeaders:o,value:new xa({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:n==null?void 0:n(r)})};try{const l=rY({text:s,schema:e});return{responseHeaders:o,value:new xa({message:t(l),url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new xa({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:n==null?void 0:n(r)})}}},e8=e=>async({response:t})=>{const n=Pw(t);if(t.body==null)throw new WC({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(KZ()).pipeThrough(new TransformStream({transform({data:r},a){r!=="[DONE]"&&a.enqueue(QM({text:r,schema:e}))}}))}},Lw=e=>async({response:t,url:n,requestBodyValues:r})=>{const a=await t.text(),i=QM({text:a,schema:e}),s=Pw(t);if(!i.success)throw new xa({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:s,responseBody:a,url:n,requestBodyValues:r});return{responseHeaders:s,value:i.value,rawValue:i.rawValue}},{btoa:sY}=globalThis;function oY(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return sY(t)}function lY(e){return e==null?void 0:e.replace(/\/$/,"")}function Dm(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function cY(e){const t=[];for(const{role:n,content:r,...a}of e){const i=Dm({...a});switch(n){case"system":{t.push({role:"system",content:r,...i});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...Dm(r[0])});break}t.push({role:"user",content:r.map(s=>{var o;const l=Dm(s);switch(s.type){case"text":return{type:"text",text:s.text,...l};case"image":return{type:"image_url",image_url:{url:s.image instanceof URL?s.image.toString():`data:${(o=s.mimeType)!=null?o:"image/jpeg"};base64,${oY(s.image)}`},...l};case"file":throw new Tr({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let s="";const o=[];for(const l of r){const u=Dm(l);switch(l.type){case"text":{s+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...u});break}}}t.push({role:"assistant",content:s,tool_calls:o.length>0?o:void 0,...i});break}case"tool":{for(const s of r){const o=Dm(s);t.push({role:"tool",tool_call_id:s.toolCallId,content:JSON.stringify(s.result),...o})}break}default:{const s=n;throw new Error(`Unsupported role: ${s}`)}}}return t}function Mv({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function Pv(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var uY=z.object({error:z.object({message:z.string(),type:z.string().nullish(),param:z.any().nullish(),code:z.union([z.string(),z.number()]).nullish()})}),$w={errorSchema:uY,errorToMessage:e=>e.error.message};function dY({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,a=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:a};const i=e.toolChoice,s=[];for(const l of r)l.type==="provider-defined"?a.push({type:"unsupported-tool",tool:l}):s.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:s,tool_choice:void 0,toolWarnings:a};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:s,tool_choice:o,toolWarnings:a};case"tool":return{tools:s,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:a};default:{const l=o;throw new Tr({functionality:`Unsupported tool choice type: ${l}`})}}}var fY=class{constructor(e,t,n){this.specificationVersion="v1";var r,a;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:$w;this.chunkSchema=pY(i.errorSchema),this.failedResponseHandler=Fw(i),this.supportsStructuredOutputs=(a=n.supportsStructuredOutputs)!=null?a:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:a,topK:i,frequencyPenalty:s,presencePenalty:o,providerMetadata:l,stopSequences:u,responseFormat:d,seed:h}){var p,y;const v=e.type,b=[];i!=null&&b.push({type:"unsupported-setting",setting:"topK"}),(d==null?void 0:d.type)==="json"&&d.schema!=null&&!this.supportsStructuredOutputs&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const w={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:a,frequency_penalty:s,presence_penalty:o,response_format:(d==null?void 0:d.type)==="json"?this.supportsStructuredOutputs===!0&&d.schema!=null?{type:"json_schema",json_schema:{schema:d.schema,name:(p=d.name)!=null?p:"response",description:d.description}}:{type:"json_object"}:void 0,stop:u,seed:h,...l==null?void 0:l[this.providerOptionsName],messages:cY(t)};switch(v){case"regular":{const{tools:x,tool_choice:S,toolWarnings:E}=dY({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...w,tools:x,tool_choice:S},warnings:[...b,...E]}}case"object-json":return{args:{...w,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(y=e.name)!=null?y:"response",description:e.description}}:{type:"json_object"}},warnings:b};case"object-tool":return{args:{...w,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:b};default:{const x=v;throw new Error(`Unsupported type: ${x}`)}}}async doGenerate(e){var t,n,r,a,i,s,o,l,u;const{args:d,warnings:h}=this.getArgs({...e}),p=JSON.stringify(d),{responseHeaders:y,value:v,rawValue:b}=await jh({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ih(this.config.headers(),e.headers),body:d,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Lw(hY),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:w,...x}=d,S=v.choices[0],E=(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:b});return{text:(r=S.message.content)!=null?r:void 0,reasoning:(a=S.message.reasoning_content)!=null?a:void 0,toolCalls:(i=S.message.tool_calls)==null?void 0:i.map(C=>{var k;return{toolCallType:"function",toolCallId:(k=C.id)!=null?k:uS(),toolName:C.function.name,args:C.function.arguments}}),finishReason:Pv(S.finish_reason),usage:{promptTokens:(o=(s=v.usage)==null?void 0:s.prompt_tokens)!=null?o:NaN,completionTokens:(u=(l=v.usage)==null?void 0:l.completion_tokens)!=null?u:NaN},...E&&{providerMetadata:E},rawCall:{rawPrompt:w,rawSettings:x},rawResponse:{headers:y,body:b},response:Mv(v),warnings:h,request:{body:p}}}async doStream(e){var t;if(this.settings.simulateStreaming){const v=await this.doGenerate(e);return{stream:new ReadableStream({start(w){if(w.enqueue({type:"response-metadata",...v.response}),v.reasoning)if(Array.isArray(v.reasoning))for(const x of v.reasoning)x.type==="text"&&w.enqueue({type:"reasoning",textDelta:x.text});else w.enqueue({type:"reasoning",textDelta:v.reasoning});if(v.text&&w.enqueue({type:"text-delta",textDelta:v.text}),v.toolCalls)for(const x of v.toolCalls)w.enqueue({type:"tool-call",...x});w.enqueue({type:"finish",finishReason:v.finishReason,usage:v.usage,logprobs:v.logprobs,providerMetadata:v.providerMetadata}),w.close()}}),rawCall:v.rawCall,rawResponse:v.rawResponse,warnings:v.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),a=JSON.stringify({...n,stream:!0}),i=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:s,value:o}=await jh({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ih(this.config.headers(),e.headers),body:{...n,stream:!0},failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:e8(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...u}=n,d=[];let h="unknown",p={promptTokens:void 0,completionTokens:void 0},y=!0;return{stream:o.pipeThrough(new TransformStream({transform(v,b){var w,x,S,E,C,k,R,O,j,$,L,X,F,K;if(!v.success){h="error",b.enqueue({type:"error",error:v.error});return}const q=v.value;if(i==null||i.processChunk(v.rawValue),"error"in q){h="error",b.enqueue({type:"error",error:q.error.message});return}y&&(y=!1,b.enqueue({type:"response-metadata",...Mv(q)})),q.usage!=null&&(p={promptTokens:(w=q.usage.prompt_tokens)!=null?w:void 0,completionTokens:(x=q.usage.completion_tokens)!=null?x:void 0});const de=q.choices[0];if((de==null?void 0:de.finish_reason)!=null&&(h=Pv(de.finish_reason)),(de==null?void 0:de.delta)==null)return;const re=de.delta;if(re.reasoning_content!=null&&b.enqueue({type:"reasoning",textDelta:re.reasoning_content}),re.content!=null&&b.enqueue({type:"text-delta",textDelta:re.content}),re.tool_calls!=null)for(const Y of re.tool_calls){const Q=Y.index;if(d[Q]==null){if(Y.type!=="function")throw new bh({data:Y,message:"Expected 'function' type."});if(Y.id==null)throw new bh({data:Y,message:"Expected 'id' to be a string."});if(((S=Y.function)==null?void 0:S.name)==null)throw new bh({data:Y,message:"Expected 'function.name' to be a string."});d[Q]={id:Y.id,type:"function",function:{name:Y.function.name,arguments:(E=Y.function.arguments)!=null?E:""},hasFinished:!1};const B=d[Q];((C=B.function)==null?void 0:C.name)!=null&&((k=B.function)==null?void 0:k.arguments)!=null&&(B.function.arguments.length>0&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:B.id,toolName:B.function.name,argsTextDelta:B.function.arguments}),JI(B.function.arguments)&&(b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(R=B.id)!=null?R:uS(),toolName:B.function.name,args:B.function.arguments}),B.hasFinished=!0));continue}const ae=d[Q];ae.hasFinished||(((O=Y.function)==null?void 0:O.arguments)!=null&&(ae.function.arguments+=($=(j=Y.function)==null?void 0:j.arguments)!=null?$:""),b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ae.id,toolName:ae.function.name,argsTextDelta:(L=Y.function.arguments)!=null?L:""}),((X=ae.function)==null?void 0:X.name)!=null&&((F=ae.function)==null?void 0:F.arguments)!=null&&JI(ae.function.arguments)&&(b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(K=ae.id)!=null?K:uS(),toolName:ae.function.name,args:ae.function.arguments}),ae.hasFinished=!0))}},flush(v){var b,w;const x=i==null?void 0:i.buildMetadata();v.enqueue({type:"finish",finishReason:h,usage:{promptTokens:(b=p.promptTokens)!=null?b:NaN,completionTokens:(w=p.completionTokens)!=null?w:NaN},...x&&{providerMetadata:x}})}})),rawCall:{rawPrompt:l,rawSettings:u},rawResponse:{headers:s},warnings:r,request:{body:a}}}},hY=z.object({id:z.string().nullish(),created:z.number().nullish(),model:z.string().nullish(),choices:z.array(z.object({message:z.object({role:z.literal("assistant").nullish(),content:z.string().nullish(),reasoning_content:z.string().nullish(),tool_calls:z.array(z.object({id:z.string().nullish(),type:z.literal("function"),function:z.object({name:z.string(),arguments:z.string()})})).nullish()}),finish_reason:z.string().nullish()})),usage:z.object({prompt_tokens:z.number().nullish(),completion_tokens:z.number().nullish()}).nullish()}),pY=e=>z.union([z.object({id:z.string().nullish(),created:z.number().nullish(),model:z.string().nullish(),choices:z.array(z.object({delta:z.object({role:z.enum(["assistant"]).nullish(),content:z.string().nullish(),reasoning_content:z.string().nullish(),tool_calls:z.array(z.object({index:z.number(),id:z.string().nullish(),type:z.literal("function").optional(),function:z.object({name:z.string().nullish(),arguments:z.string().nullish()})})).nullish()}).nullish(),finish_reason:z.string().nullish()})),usage:z.object({prompt_tokens:z.number().nullish(),completion_tokens:z.number().nullish()}).nullish()}),e]);function mY({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let a="";e[0].role==="system"&&(a+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:s}of e)switch(i){case"system":throw new Nl({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=s.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new Tr({functionality:"images"})}}).join("");a+=`${n}:
${o}

`;break}case"assistant":{const o=s.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new Tr({functionality:"tool-call messages"})}}).join("");a+=`${r}:
${o}

`;break}case"tool":throw new Tr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return a+=`${r}:
`,{prompt:a,stopSequences:[`
${n}:`]}}var gY=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const a=(r=n.errorStructure)!=null?r:$w;this.chunkSchema=bY(a.errorSchema),this.failedResponseHandler=Fw(a)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:a,topP:i,topK:s,frequencyPenalty:o,presencePenalty:l,stopSequences:u,responseFormat:d,seed:h,providerMetadata:p}){var y;const v=e.type,b=[];s!=null&&b.push({type:"unsupported-setting",setting:"topK"}),d!=null&&d.type!=="text"&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:w,stopSequences:x}=mY({prompt:n,inputFormat:t}),S=[...x??[],...u??[]],E={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:a,top_p:i,frequency_penalty:o,presence_penalty:l,seed:h,...p==null?void 0:p[this.providerOptionsName],prompt:w,stop:S.length>0?S:void 0};switch(v){case"regular":{if((y=e.tools)!=null&&y.length)throw new Tr({functionality:"tools"});if(e.toolChoice)throw new Tr({functionality:"toolChoice"});return{args:E,warnings:b}}case"object-json":throw new Tr({functionality:"object-json mode"});case"object-tool":throw new Tr({functionality:"object-tool mode"});default:{const C=v;throw new Error(`Unsupported type: ${C}`)}}}async doGenerate(e){var t,n,r,a;const{args:i,warnings:s}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:u}=await jh({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ih(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Lw(yY),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:d,...h}=i,p=l.choices[0];return{text:p.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(a=(r=l.usage)==null?void 0:r.completion_tokens)!=null?a:NaN},finishReason:Pv(p.finish_reason),rawCall:{rawPrompt:d,rawSettings:h},rawResponse:{headers:o,body:u},response:Mv(l),warnings:s,request:{body:JSON.stringify(i)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0},{responseHeaders:a,value:i}=await jh({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ih(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:e8(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:s,...o}=t;let l="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d=!0;return{stream:i.pipeThrough(new TransformStream({transform(h,p){if(!h.success){l="error",p.enqueue({type:"error",error:h.error});return}const y=h.value;if("error"in y){l="error",p.enqueue({type:"error",error:y.error});return}d&&(d=!1,p.enqueue({type:"response-metadata",...Mv(y)})),y.usage!=null&&(u={promptTokens:y.usage.prompt_tokens,completionTokens:y.usage.completion_tokens});const v=y.choices[0];(v==null?void 0:v.finish_reason)!=null&&(l=Pv(v.finish_reason)),(v==null?void 0:v.text)!=null&&p.enqueue({type:"text-delta",textDelta:v.text})},flush(h){h.enqueue({type:"finish",finishReason:l,usage:u})}})),rawCall:{rawPrompt:s,rawSettings:o},rawResponse:{headers:a},warnings:n,request:{body:JSON.stringify(r)}}}},yY=z.object({id:z.string().nullish(),created:z.number().nullish(),model:z.string().nullish(),choices:z.array(z.object({text:z.string(),finish_reason:z.string()})),usage:z.object({prompt_tokens:z.number(),completion_tokens:z.number()}).nullish()}),bY=e=>z.union([z.object({id:z.string().nullish(),created:z.number().nullish(),model:z.string().nullish(),choices:z.array(z.object({text:z.string(),finish_reason:z.string().nullish(),index:z.number()})),usage:z.object({prompt_tokens:z.number(),completion_tokens:z.number()}).nullish()}),e]),vY=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new ZC({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:a,value:i}=await jh({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Ih(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Fw((r=this.config.errorStructure)!=null?r:$w),successfulResponseHandler:Lw(wY),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(s=>s.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:a}}}},wY=z.object({data:z.array(z.object({embedding:z.array(z.number())})),usage:z.object({prompt_tokens:z.number()}).nullish()}),xY=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:a,providerOptions:i,headers:s,abortSignal:o}){var l,u,d,h,p;const y=[];r!=null&&y.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),a!=null&&y.push({type:"unsupported-setting",setting:"seed"});const v=(d=(u=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:u.call(l))!=null?d:new Date,{value:b,responseHeaders:w}=await jh({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Ih(this.config.headers(),s),body:{model:this.modelId,prompt:e,n:t,size:n,...(h=i.openai)!=null?h:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:Fw((p=this.config.errorStructure)!=null?p:$w),successfulResponseHandler:Lw(_Y),abortSignal:o,fetch:this.config.fetch});return{images:b.data.map(x=>x.b64_json),warnings:y,response:{timestamp:v,modelId:this.modelId,headers:w}}}},_Y=z.object({data:z.array(z.object({b64_json:z.string()}))});function SY(e){const t=lY(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),a=h=>({provider:`${n}.${h}`,url:({path:p})=>{const y=new URL(`${t}${p}`);return e.queryParams&&(y.search=new URLSearchParams(e.queryParams).toString()),y.toString()},headers:r,fetch:e.fetch}),i=(h,p={})=>s(h,p),s=(h,p={})=>new fY(h,p,{...a("chat"),defaultObjectGenerationMode:"tool"}),o=(h,p={})=>new gY(h,p,a("completion")),l=(h,p={})=>new vY(h,p,a("embedding")),u=(h,p={})=>new xY(h,p,a("image")),d=(h,p)=>i(h,p);return d.languageModel=i,d.chatModel=s,d.completionModel=o,d.textEmbeddingModel=l,d.imageModel=u,d}const Wc=(e,t)=>`${e}:${t}`,Ql=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},Fv=e=>e==="openai"||e==="openrouter"||e==="google",rk=e=>e==="ollama"||e==="openai-compatible",fh=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",Td=[{value:"openai",label:"OpenAI"},{value:"google",label:"Google Gemini"},{value:"openrouter",label:"OpenRouter"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"}],EY={openai:[{id:"gpt-4o",name:"GPT-4o"}],google:[{id:"gemini-1.5-flash-latest",name:"Gemini 1.5 Flash"},{id:"gemini-1.5-pro-latest",name:"Gemini 1.5 Pro"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},t8=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function n8(e,t,n){try{switch(e.type){case"openai":return RD({apiKey:n})(t);case"google":return dM({apiKey:n})(t);case"openrouter":return YM({apiKey:n})(t);case"ollama":return XM({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return SY({baseURL:t8(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function ak(e,t,n){const a=Fn.getState().getAllAvailableModelDefsForProvider(e.id).find(s=>s.id===t);if(!a){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const i=n8(e,t,n);if(!i){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:Wc(e.id,t),name:a.name,providerId:e.id,providerName:e.name,instance:i,metadata:a}}const r8={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]};var $o=i6();const a8=di($o);function CY(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const kY=e=>{switch(e){case"success":return NY;case"info":return IY;case"warning":return RY;case"error":return jY;default:return null}},TY=Array(12).fill(0),AY=({visible:e,className:t})=>gt.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},gt.createElement("div",{className:"sonner-spinner"},TY.map((n,r)=>gt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),NY=gt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},gt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),RY=gt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},gt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),IY=gt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},gt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),jY=gt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},gt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),OY=gt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},gt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),gt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),DY=()=>{const[e,t]=gt.useState(document.hidden);return gt.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let L2=1;class MY{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...a}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:L2++,s=this.toasts.find(l=>l.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),s?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...a,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const a=Promise.resolve(t instanceof Function?t():t);let i=r!==void 0,s;const o=a.then(async u=>{if(s=["resolve",u],gt.isValidElement(u))i=!1,this.create({id:r,type:"default",message:u});else if(FY(u)&&!u.ok){i=!1;const h=typeof n.error=="function"?await n.error(`HTTP error! status: ${u.status}`):n.error,p=typeof n.description=="function"?await n.description(`HTTP error! status: ${u.status}`):n.description,v=typeof h=="object"&&!gt.isValidElement(h)?h:{message:h};this.create({id:r,type:"error",description:p,...v})}else if(u instanceof Error){i=!1;const h=typeof n.error=="function"?await n.error(u):n.error,p=typeof n.description=="function"?await n.description(u):n.description,v=typeof h=="object"&&!gt.isValidElement(h)?h:{message:h};this.create({id:r,type:"error",description:p,...v})}else if(n.success!==void 0){i=!1;const h=typeof n.success=="function"?await n.success(u):n.success,p=typeof n.description=="function"?await n.description(u):n.description,v=typeof h=="object"&&!gt.isValidElement(h)?h:{message:h};this.create({id:r,type:"success",description:p,...v})}}).catch(async u=>{if(s=["reject",u],n.error!==void 0){i=!1;const d=typeof n.error=="function"?await n.error(u):n.error,h=typeof n.description=="function"?await n.description(u):n.description,y=typeof d=="object"&&!gt.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((u,d)=>o.then(()=>s[0]==="reject"?d(s[1]):u(s[1])).catch(d));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||L2++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Ii=new MY,PY=(e,t)=>{const n=(t==null?void 0:t.id)||L2++;return Ii.addToast({title:e,...t,id:n}),n},FY=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",LY=PY,$Y=()=>Ii.toasts,BY=()=>Ii.getActiveToasts(),tt=Object.assign(LY,{success:Ii.success,info:Ii.info,warning:Ii.warning,error:Ii.error,custom:Ii.custom,message:Ii.message,promise:Ii.promise,dismiss:Ii.dismiss,loading:Ii.loading},{getHistory:$Y,getToasts:BY});CY("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function bb(e){return e.label!==void 0}const zY=3,UY="24px",qY="16px",QI=4e3,HY=356,VY=14,GY=45,WY=200;function No(...e){return e.filter(Boolean).join(" ")}function KY(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const ZY=e=>{var t,n,r,a,i,s,o,l,u;const{invert:d,toast:h,unstyled:p,interacting:y,setHeights:v,visibleToasts:b,heights:w,index:x,toasts:S,expanded:E,removeToast:C,defaultRichColors:k,closeButton:R,style:O,cancelButtonStyle:j,actionButtonStyle:$,className:L="",descriptionClassName:X="",duration:F,position:K,gap:q,expandByDefault:de,classNames:re,icons:Y,closeButtonAriaLabel:Q="Close toast"}=e,[ae,B]=gt.useState(null),[J,ee]=gt.useState(null),[oe,me]=gt.useState(!1),[xe,Pe]=gt.useState(!1),[Ne,Re]=gt.useState(!1),[ke,Fe]=gt.useState(!1),[Qe,Le]=gt.useState(!1),[Ie,V]=gt.useState(0),[ge,Te]=gt.useState(0),le=gt.useRef(h.duration||F||QI),ie=gt.useRef(null),te=gt.useRef(null),_e=x===0,Me=x+1<=b,Ee=h.type,We=h.dismissible!==!1,kt=h.className||"",it=h.descriptionClassName||"",xt=gt.useMemo(()=>w.findIndex(Oe=>Oe.toastId===h.id)||0,[w,h.id]),Dt=gt.useMemo(()=>{var Oe;return(Oe=h.closeButton)!=null?Oe:R},[h.closeButton,R]),Ot=gt.useMemo(()=>h.duration||F||QI,[h.duration,F]),Wt=gt.useRef(0),be=gt.useRef(0),I=gt.useRef(0),G=gt.useRef(null),[fe,je]=K.split("-"),ve=gt.useMemo(()=>w.reduce((Oe,Ke,Rt)=>Rt>=xt?Oe:Oe+Ke.height,0),[w,xt]),Ce=DY(),ce=h.invert||d,ft=Ee==="loading";be.current=gt.useMemo(()=>xt*q+ve,[xt,ve]),gt.useEffect(()=>{le.current=Ot},[Ot]),gt.useEffect(()=>{me(!0)},[]),gt.useEffect(()=>{const Oe=te.current;if(Oe){const Ke=Oe.getBoundingClientRect().height;return Te(Ke),v(Rt=>[{toastId:h.id,height:Ke,position:h.position},...Rt]),()=>v(Rt=>Rt.filter(pe=>pe.toastId!==h.id))}},[v,h.id]),gt.useLayoutEffect(()=>{if(!oe)return;const Oe=te.current,Ke=Oe.style.height;Oe.style.height="auto";const Rt=Oe.getBoundingClientRect().height;Oe.style.height=Ke,Te(Rt),v(pe=>pe.find(U=>U.toastId===h.id)?pe.map(U=>U.toastId===h.id?{...U,height:Rt}:U):[{toastId:h.id,height:Rt,position:h.position},...pe])},[oe,h.title,h.description,v,h.id]);const vt=gt.useCallback(()=>{Pe(!0),V(be.current),v(Oe=>Oe.filter(Ke=>Ke.toastId!==h.id)),setTimeout(()=>{C(h)},WY)},[h,C,v,be]);gt.useEffect(()=>{if(h.promise&&Ee==="loading"||h.duration===1/0||h.type==="loading")return;let Oe;return E||y||Ce?(()=>{if(I.current<Wt.current){const pe=new Date().getTime()-Wt.current;le.current=le.current-pe}I.current=new Date().getTime()})():(()=>{le.current!==1/0&&(Wt.current=new Date().getTime(),Oe=setTimeout(()=>{h.onAutoClose==null||h.onAutoClose.call(h,h),vt()},le.current))})(),()=>clearTimeout(Oe)},[E,y,h,Ee,Ce,vt]),gt.useEffect(()=>{h.delete&&vt()},[vt,h.delete]);function M(){var Oe;if(Y!=null&&Y.loading){var Ke;return gt.createElement("div",{className:No(re==null?void 0:re.loader,h==null||(Ke=h.classNames)==null?void 0:Ke.loader,"sonner-loader"),"data-visible":Ee==="loading"},Y.loading)}return gt.createElement(AY,{className:No(re==null?void 0:re.loader,h==null||(Oe=h.classNames)==null?void 0:Oe.loader),visible:Ee==="loading"})}const Be=h.icon||(Y==null?void 0:Y[Ee])||kY(Ee);var nt,ye;return gt.createElement("li",{tabIndex:0,ref:te,className:No(L,kt,re==null?void 0:re.toast,h==null||(t=h.classNames)==null?void 0:t.toast,re==null?void 0:re.default,re==null?void 0:re[Ee],h==null||(n=h.classNames)==null?void 0:n[Ee]),"data-sonner-toast":"","data-rich-colors":(nt=h.richColors)!=null?nt:k,"data-styled":!(h.jsx||h.unstyled||p),"data-mounted":oe,"data-promise":!!h.promise,"data-swiped":Qe,"data-removed":xe,"data-visible":Me,"data-y-position":fe,"data-x-position":je,"data-index":x,"data-front":_e,"data-swiping":Ne,"data-dismissible":We,"data-type":Ee,"data-invert":ce,"data-swipe-out":ke,"data-swipe-direction":J,"data-expanded":!!(E||de&&oe),style:{"--index":x,"--toasts-before":x,"--z-index":S.length-x,"--offset":`${xe?Ie:be.current}px`,"--initial-height":de?"auto":`${ge}px`,...O,...h.style},onDragEnd:()=>{Re(!1),B(null),G.current=null},onPointerDown:Oe=>{ft||!We||(ie.current=new Date,V(be.current),Oe.target.setPointerCapture(Oe.pointerId),Oe.target.tagName!=="BUTTON"&&(Re(!0),G.current={x:Oe.clientX,y:Oe.clientY}))},onPointerUp:()=>{var Oe,Ke,Rt;if(ke||!We)return;G.current=null;const pe=Number(((Oe=te.current)==null?void 0:Oe.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),H=Number(((Ke=te.current)==null?void 0:Ke.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),U=new Date().getTime()-((Rt=ie.current)==null?void 0:Rt.getTime()),W=ae==="x"?pe:H,he=Math.abs(W)/U;if(Math.abs(W)>=GY||he>.11){V(be.current),h.onDismiss==null||h.onDismiss.call(h,h),ee(ae==="x"?pe>0?"right":"left":H>0?"down":"up"),vt(),Fe(!0);return}else{var Ae,qe;(Ae=te.current)==null||Ae.style.setProperty("--swipe-amount-x","0px"),(qe=te.current)==null||qe.style.setProperty("--swipe-amount-y","0px")}Le(!1),Re(!1),B(null)},onPointerMove:Oe=>{var Ke,Rt,pe;if(!G.current||!We||((Ke=window.getSelection())==null?void 0:Ke.toString().length)>0)return;const U=Oe.clientY-G.current.y,W=Oe.clientX-G.current.x;var he;const Ae=(he=e.swipeDirections)!=null?he:KY(K);!ae&&(Math.abs(W)>1||Math.abs(U)>1)&&B(Math.abs(W)>Math.abs(U)?"x":"y");let qe={x:0,y:0};const pt=Gt=>1/(1.5+Math.abs(Gt)/20);if(ae==="y"){if(Ae.includes("top")||Ae.includes("bottom"))if(Ae.includes("top")&&U<0||Ae.includes("bottom")&&U>0)qe.y=U;else{const Gt=U*pt(U);qe.y=Math.abs(Gt)<Math.abs(U)?Gt:U}}else if(ae==="x"&&(Ae.includes("left")||Ae.includes("right")))if(Ae.includes("left")&&W<0||Ae.includes("right")&&W>0)qe.x=W;else{const Gt=W*pt(W);qe.x=Math.abs(Gt)<Math.abs(W)?Gt:W}(Math.abs(qe.x)>0||Math.abs(qe.y)>0)&&Le(!0),(Rt=te.current)==null||Rt.style.setProperty("--swipe-amount-x",`${qe.x}px`),(pe=te.current)==null||pe.style.setProperty("--swipe-amount-y",`${qe.y}px`)}},Dt&&!h.jsx&&Ee!=="loading"?gt.createElement("button",{"aria-label":Q,"data-disabled":ft,"data-close-button":!0,onClick:ft||!We?()=>{}:()=>{vt(),h.onDismiss==null||h.onDismiss.call(h,h)},className:No(re==null?void 0:re.closeButton,h==null||(r=h.classNames)==null?void 0:r.closeButton)},(ye=Y==null?void 0:Y.close)!=null?ye:OY):null,(Ee||h.icon||h.promise)&&h.icon!==null&&((Y==null?void 0:Y[Ee])!==null||h.icon)?gt.createElement("div",{"data-icon":"",className:No(re==null?void 0:re.icon,h==null||(a=h.classNames)==null?void 0:a.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||M():null,h.type!=="loading"?Be:null):null,gt.createElement("div",{"data-content":"",className:No(re==null?void 0:re.content,h==null||(i=h.classNames)==null?void 0:i.content)},gt.createElement("div",{"data-title":"",className:No(re==null?void 0:re.title,h==null||(s=h.classNames)==null?void 0:s.title)},h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title),h.description?gt.createElement("div",{"data-description":"",className:No(X,it,re==null?void 0:re.description,h==null||(o=h.classNames)==null?void 0:o.description)},typeof h.description=="function"?h.description():h.description):null),gt.isValidElement(h.cancel)?h.cancel:h.cancel&&bb(h.cancel)?gt.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||j,onClick:Oe=>{bb(h.cancel)&&We&&(h.cancel.onClick==null||h.cancel.onClick.call(h.cancel,Oe),vt())},className:No(re==null?void 0:re.cancelButton,h==null||(l=h.classNames)==null?void 0:l.cancelButton)},h.cancel.label):null,gt.isValidElement(h.action)?h.action:h.action&&bb(h.action)?gt.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||$,onClick:Oe=>{bb(h.action)&&(h.action.onClick==null||h.action.onClick.call(h.action,Oe),!Oe.defaultPrevented&&vt())},className:No(re==null?void 0:re.actionButton,h==null||(u=h.classNames)==null?void 0:u.actionButton)},h.action.label):null)};function e3(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function YY(e,t){const n={};return[e,t].forEach((r,a)=>{const i=a===1,s=i?"--mobile-offset":"--offset",o=i?qY:UY;function l(u){["top","right","bottom","left"].forEach(d=>{n[`${s}-${d}`]=typeof u=="number"?`${u}px`:u})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(u=>{r[u]===void 0?n[`${s}-${u}`]=o:n[`${s}-${u}`]=typeof r[u]=="number"?`${r[u]}px`:r[u]}):l(o)}),n}const XY=gt.forwardRef(function(t,n){const{invert:r,position:a="bottom-right",hotkey:i=["altKey","KeyT"],expand:s,closeButton:o,className:l,offset:u,mobileOffset:d,theme:h="light",richColors:p,duration:y,style:v,visibleToasts:b=zY,toastOptions:w,dir:x=e3(),gap:S=VY,icons:E,containerAriaLabel:C="Notifications"}=t,[k,R]=gt.useState([]),O=gt.useMemo(()=>Array.from(new Set([a].concat(k.filter(J=>J.position).map(J=>J.position)))),[k,a]),[j,$]=gt.useState([]),[L,X]=gt.useState(!1),[F,K]=gt.useState(!1),[q,de]=gt.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),re=gt.useRef(null),Y=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),Q=gt.useRef(null),ae=gt.useRef(!1),B=gt.useCallback(J=>{R(ee=>{var oe;return(oe=ee.find(me=>me.id===J.id))!=null&&oe.delete||Ii.dismiss(J.id),ee.filter(({id:me})=>me!==J.id)})},[]);return gt.useEffect(()=>Ii.subscribe(J=>{if(J.dismiss){requestAnimationFrame(()=>{R(ee=>ee.map(oe=>oe.id===J.id?{...oe,delete:!0}:oe))});return}setTimeout(()=>{a8.flushSync(()=>{R(ee=>{const oe=ee.findIndex(me=>me.id===J.id);return oe!==-1?[...ee.slice(0,oe),{...ee[oe],...J},...ee.slice(oe+1)]:[J,...ee]})})})}),[k]),gt.useEffect(()=>{if(h!=="system"){de(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?de("dark"):de("light")),typeof window>"u")return;const J=window.matchMedia("(prefers-color-scheme: dark)");try{J.addEventListener("change",({matches:ee})=>{de(ee?"dark":"light")})}catch{J.addListener(({matches:oe})=>{try{de(oe?"dark":"light")}catch(me){console.error(me)}})}},[h]),gt.useEffect(()=>{k.length<=1&&X(!1)},[k]),gt.useEffect(()=>{const J=ee=>{var oe;if(i.every(Pe=>ee[Pe]||ee.code===Pe)){var xe;X(!0),(xe=re.current)==null||xe.focus()}ee.code==="Escape"&&(document.activeElement===re.current||(oe=re.current)!=null&&oe.contains(document.activeElement))&&X(!1)};return document.addEventListener("keydown",J),()=>document.removeEventListener("keydown",J)},[i]),gt.useEffect(()=>{if(re.current)return()=>{Q.current&&(Q.current.focus({preventScroll:!0}),Q.current=null,ae.current=!1)}},[re.current]),gt.createElement("section",{ref:n,"aria-label":`${C} ${Y}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},O.map((J,ee)=>{var oe;const[me,xe]=J.split("-");return k.length?gt.createElement("ol",{key:J,dir:x==="auto"?e3():x,tabIndex:-1,ref:re,className:l,"data-sonner-toaster":!0,"data-sonner-theme":q,"data-y-position":me,"data-lifted":L&&k.length>1&&!s,"data-x-position":xe,style:{"--front-toast-height":`${((oe=j[0])==null?void 0:oe.height)||0}px`,"--width":`${HY}px`,"--gap":`${S}px`,...v,...YY(u,d)},onBlur:Pe=>{ae.current&&!Pe.currentTarget.contains(Pe.relatedTarget)&&(ae.current=!1,Q.current&&(Q.current.focus({preventScroll:!0}),Q.current=null))},onFocus:Pe=>{Pe.target instanceof HTMLElement&&Pe.target.dataset.dismissible==="false"||ae.current||(ae.current=!0,Q.current=Pe.relatedTarget)},onMouseEnter:()=>X(!0),onMouseMove:()=>X(!0),onMouseLeave:()=>{F||X(!1)},onDragEnd:()=>X(!1),onPointerDown:Pe=>{Pe.target instanceof HTMLElement&&Pe.target.dataset.dismissible==="false"||K(!0)},onPointerUp:()=>K(!1)},k.filter(Pe=>!Pe.position&&ee===0||Pe.position===J).map((Pe,Ne)=>{var Re,ke;return gt.createElement(ZY,{key:Pe.id,icons:E,index:Ne,toast:Pe,defaultRichColors:p,duration:(Re=w==null?void 0:w.duration)!=null?Re:y,className:w==null?void 0:w.className,descriptionClassName:w==null?void 0:w.descriptionClassName,invert:r,visibleToasts:b,closeButton:(ke=w==null?void 0:w.closeButton)!=null?ke:o,interacting:F,position:J,style:w==null?void 0:w.style,unstyled:w==null?void 0:w.unstyled,classNames:w==null?void 0:w.classNames,cancelButtonStyle:w==null?void 0:w.cancelButtonStyle,actionButtonStyle:w==null?void 0:w.actionButtonStyle,closeButtonAriaLabel:w==null?void 0:w.closeButtonAriaLabel,removeToast:B,toasts:k.filter(Fe=>Fe.position==Pe.position),heights:j.filter(Fe=>Fe.position==Pe.position),setHeights:$,expandByDefault:s,gap:S,expanded:L,swipeDirections:t.swipeDirections})})):null}))}),Mm=new Map,JY=5*60*1e3,QY=(e,t)=>{var i,s,o,l,u,d,h,p,y,v,b,w,x,S;const n=e.id||e.name,r=e.name||n,a={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((i=e.architecture)==null?void 0:i.modality)??"text->text",input_modalities:((s=e.architecture)==null?void 0:s.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((u=e.architecture)==null?void 0:u.instruct_type)??null},pricing:{prompt:((d=e.pricing)==null?void 0:d.prompt)??"0",completion:((h=e.pricing)==null?void 0:h.completion)??"0",request:((p=e.pricing)==null?void 0:p.request)??"0",image:((y=e.pricing)==null?void 0:y.image)??"0",web_search:((v=e.pricing)==null?void 0:v.web_search)??"0",internal_reasoning:((b=e.pricing)==null?void 0:b.internal_reasoning)??"0"},top_provider:{context_length:((w=e.top_provider)==null?void 0:w.context_length)??e.context_length??null,max_completion_tokens:((x=e.top_provider)==null?void 0:x.max_completion_tokens)??null,is_moderated:((S=e.top_provider)==null?void 0:S.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??r8[t]??[]};return t==="ollama"?(a.context_length=a.context_length??4096,a.top_provider&&(a.top_provider.context_length=a.context_length),a.architecture&&(a.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(a.context_length=8192),n.includes("gpt-4-32k")&&(a.context_length=32768),n.includes("gpt-4-turbo")&&(a.context_length=128e3),n.includes("gpt-4o")&&(a.context_length=128e3),n.includes("gpt-3.5-turbo")&&(a.context_length=16385),a.top_provider&&(a.top_provider.context_length=a.context_length),a.architecture&&(a.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?a.context_length=1048576:n.includes("gemini")&&(a.context_length=32768),a.top_provider&&(a.top_provider.context_length=a.context_length),a.architecture&&(a.architecture.tokenizer="Google")):t==="openai-compatible"&&(a.context_length=a.context_length??4096,a.top_provider&&(a.top_provider.context_length=a.context_length),a.architecture&&(a.architecture.tokenizer="Compatible")),a};async function eX(e,t){const n=`${e.id}-${e.baseURL||""}`,r=Mm.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const a=(async()=>{var o,l,u;let i;const s={Accept:"application/json"};t&&(s.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");i="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");i="https://openrouter.ai/api/v1/models",s["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",s["X-Title"]="LiteChat";break;case"ollama":const d=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";i=new URL("/api/tags",d).toString(),delete s.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const h=t8(e.baseURL);i=new URL("models",h.endsWith("/")?h:h+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(d){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,d),tt.error(`Invalid Base URL for ${e.name}: ${d instanceof Error?d.message:String(d)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${i}`);try{const d=await fetch(i,{headers:s});if(!d.ok){let v=`(${d.status} ${d.statusText})`;try{const b=await d.text();v=b||v;try{const w=JSON.parse(b);v=((u=w==null?void 0:w.error)==null?void 0:u.message)||(w==null?void 0:w.message)||v}catch{}}catch(b){console.warn("[ModelFetcher] Failed to read error response body:",b)}throw new Error(`API Error: ${v}`)}const h=await d.json();let p=[];if(e.type==="ollama"?p=h.models||[]:p=h.data||h||[],!Array.isArray(p))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,h),[];const y=p.map(v=>QY(v,e.type));return y.sort((v,b)=>(v.name||v.id).localeCompare(b.name||b.id)),console.log(`[ModelFetcher] Fetched and mapped ${y.length} models for ${e.name}`),y}catch(d){const h=d instanceof Error?d.message:String(d);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,h),tt.error(`Failed to fetch models for ${e.name}: ${h}`),Mm.delete(n),[]}})();return Mm.set(n,a),setTimeout(()=>{Mm.get(n)===a&&(Mm.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},JY),a}const fS="provider:lastModelSelection",t3="provider:globalModelSortOrder",Fn=As(Ns((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),Ft.saveSetting("enableApiKeyManagement",n),St.emit(_t.SETTINGS_CHANGED,{key:"enableApiKeyManagement",value:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await Ft.loadSetting("enableApiKeyManagement",!0),[r,a,i,s]=await Promise.all([Ft.loadProviderConfigs(),Ft.loadApiKeys(),Ft.loadSetting(t3,[]),Ft.loadSetting(fS,null)]);e({dbProviderConfigs:r,dbApiKeys:a,enableApiKeyManagement:n});const o=r.reduce((p,y)=>(y.isEnabled&&y.enabledModels&&y.enabledModels.forEach(v=>{p.push(Wc(y.id,v))}),p),[]),l=new Set(o),u=i.filter(p=>l.has(p));let d=s;d&&l.has(d)||(d=u[0]??null,d||(d=o[0]??null),console.log(`[ProviderStore] Saved selection invalid or missing, selecting default: ${d}`)),e({globalModelSortOrder:u,selectedModelId:d,isLoading:!1}),await Ft.saveSetting(fS,d),console.log(`[ProviderStore] Emitting initial ${_t.MODEL_SELECTION_CHANGED} with payload:`,{modelId:d}),St.emit(_t.MODEL_SELECTION_CHANGED,{modelId:d})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),tt.error("Failed to load provider data")}},selectModel:n=>{const r=t().selectedModelId;console.log(`[ProviderStore] selectModel called. Current: ${r}, New: ${n}`),r!==n?(e({selectedModelId:n}),Ft.saveSetting(fS,n),console.log(`[ProviderStore] Emitting ${_t.MODEL_SELECTION_CHANGED} with payload:`,{modelId:n}),St.emit(_t.MODEL_SELECTION_CHANGED,{modelId:n})):console.log(`[ProviderStore] selectModel skipped: ID ${n} already selected.`)},addApiKey:async(n,r,a)=>{const i=Pi(),s=new Date,o={id:i,name:n,value:a,providerId:r,createdAt:s,updatedAt:s};try{return await Ft.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),tt.success(`API Key "${n}" added.`),St.emit(_t.API_KEY_CHANGED,{keyId:i,action:"added"}),i}catch(l){throw console.error("ProviderStore: Error adding API key",l),tt.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var a;const r=((a=t().dbApiKeys.find(i=>i.id===n))==null?void 0:a.name)??"Unknown Key";try{await Ft.deleteApiKey(n),e(i=>{i.dbApiKeys=i.dbApiKeys.filter(s=>s.id!==n),i.dbProviderConfigs=i.dbProviderConfigs.map(s=>s.apiKeyId===n?{...s,apiKeyId:null}:s)}),tt.success(`API Key "${r}" deleted.`),St.emit(_t.API_KEY_CHANGED,{keyId:n,action:"deleted"})}catch(i){throw console.error("ProviderStore: Error deleting API key",i),tt.error(`Failed to delete API Key: ${i instanceof Error?i.message:String(i)}`),i}},addProviderConfig:async n=>{const r=Pi(),a=new Date,i={id:r,createdAt:a,updatedAt:a,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await Ft.saveProviderConfig(i),e(s=>{s.dbProviderConfigs.push(i)}),tt.success(`Provider "${n.name}" added.`),St.emit(_t.PROVIDER_CONFIG_CHANGED,{providerId:r,config:i}),t().fetchModels(r).catch(s=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,s)}),r}catch(s){throw console.error("ProviderStore: Error adding provider config",s),tt.error(`Failed to add Provider: ${s instanceof Error?s.message:String(s)}`),s}},updateProviderConfig:async(n,r)=>{const a=t().dbProviderConfigs.find(s=>s.id===n);if(!a){console.warn(`ProviderStore: Config ${n} not found for update.`);return}const i={...a,...r,updatedAt:new Date};try{await Ft.saveProviderConfig(i),e(h=>{const p=h.dbProviderConfigs.findIndex(y=>y.id===n);p!==-1&&(h.dbProviderConfigs[p]=i)}),St.emit(_t.PROVIDER_CONFIG_CHANGED,{providerId:n,config:i});const s=t().globalModelSortOrder,o=t().dbProviderConfigs;let l=[...s];const u=o.reduce((h,p)=>(p.isEnabled&&p.enabledModels&&p.enabledModels.forEach(y=>{h.push(Wc(p.id,y))}),h),[]),d=new Set(u);l=s.filter(h=>d.has(h)),d.forEach(h=>{l.includes(h)||l.push(h)}),await t().setGlobalModelSortOrder(l)}catch(s){throw console.error("ProviderStore: Error updating provider config",s),tt.error(`Failed to update Provider: ${s instanceof Error?s.message:String(s)}`),s}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r)return;const a=r.name;try{await Ft.deleteProviderConfig(n),e(d=>{d.dbProviderConfigs=d.dbProviderConfigs.filter(h=>h.id!==n),delete d.providerFetchStatus[n]}),St.emit(_t.PROVIDER_CONFIG_CHANGED,{providerId:n,config:{...r,isEnabled:!1}});const s=t().dbProviderConfigs.reduce((d,h)=>(h.isEnabled&&h.enabledModels&&h.enabledModels.forEach(p=>{d.push(Wc(h.id,p))}),d),[]),o=new Set(s),u=t().globalModelSortOrder.filter(d=>o.has(d));await t().setGlobalModelSortOrder(u),tt.success(`Provider "${a}" deleted.`)}catch(i){throw console.error("ProviderStore: Error deleting provider config",i),tt.error(`Failed to delete Provider: ${i instanceof Error?i.message:String(i)}`),i}},fetchModels:async n=>{var a;const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r){tt.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]==="fetching"){console.log(`[ProviderStore] Fetch already in progress for ${r.name}`);return}t()._setProviderFetchStatus(n,"fetching");try{const i=r.apiKeyId,s=(a=t().dbApiKeys.find(l=>l.id===i))==null?void 0:a.value,o=await eX(r,s);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),tt.success(`Models fetched successfully for ${r.name}`)}catch(i){console.error(`Error fetching models for ${r.name}:`,i),t()._setProviderFetchStatus(n,"error")}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await Ft.saveSetting(t3,r);const a=t().selectedModelId,s=t().dbProviderConfigs.reduce((l,u)=>(u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(d=>{l.push(Wc(u.id,d))}),l),[]),o=new Set(s);if(!a||!o.has(a)){const l=r.find(h=>o.has(h)),u=s[0]??null,d=l??u;d!==a&&(console.log(`[ProviderStore] Selection ${a} invalidated or missing. Selecting ${d}`),t().selectModel(d))}},_setProviderFetchStatus:(n,r)=>{e(a=>{a.providerFetchStatus[n]=r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n})},getSelectedModel:()=>{const{selectedModelId:n,dbProviderConfigs:r,dbApiKeys:a}=t();if(!n)return;const{providerId:i,modelId:s}=Ql(n);if(!i||!s)return;const o=r.find(u=>u.id===i);if(!o)return;const l=a.find(u=>u.id===o.apiKeyId);return ak(o,s,l==null?void 0:l.value)},getApiKeyForProvider:n=>{var a;const r=t().dbProviderConfigs.find(i=>i.id===n);return(a=t().dbApiKeys.find(i=>i.id===(r==null?void 0:r.apiKeyId)))==null?void 0:a.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(s=>s.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const a=r.type;return(EY[a]||[]).map(s=>({id:s.id,name:s.name,context_length:4096,architecture:{modality:"text->text",input_modalities:["text"],output_modalities:["text"]},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:r8[r.type]??[]}))}}))),vb="system",n3="You are a helpful AI assistant.",r3=.7,a3=null,i3=null,s3=null,o3=0,l3=0,c3=!0,wb=!0,xb=!1,_b=!1,Sb=!1,Eb=15,u3=null,d3=null,f3=5,Cb=null,qr=As(Ns(e=>({theme:vb,globalSystemPrompt:n3,temperature:r3,maxTokens:a3,topP:i3,topK:s3,presencePenalty:o3,frequencyPenalty:l3,enableAdvancedSettings:c3,enableStreamingMarkdown:wb,enableStreamingCodeBlockParsing:xb,foldStreamingCodeBlocks:_b,foldUserMessagesOnCompletion:Sb,streamingRenderFPS:Eb,gitUserName:u3,gitUserEmail:d3,toolMaxSteps:f3,prismThemeUrl:Cb,setTheme:t=>{e({theme:t}),Ft.saveSetting("theme",t)},setGlobalSystemPrompt:t=>{e({globalSystemPrompt:t}),Ft.saveSetting("globalSystemPrompt",t)},setTemperature:t=>{e({temperature:t}),Ft.saveSetting("temperature",t)},setMaxTokens:t=>{e({maxTokens:t}),Ft.saveSetting("maxTokens",t)},setTopP:t=>{e({topP:t}),Ft.saveSetting("topP",t)},setTopK:t=>{e({topK:t}),Ft.saveSetting("topK",t)},setPresencePenalty:t=>{e({presencePenalty:t}),Ft.saveSetting("presencePenalty",t)},setFrequencyPenalty:t=>{e({frequencyPenalty:t}),Ft.saveSetting("frequencyPenalty",t)},setEnableAdvancedSettings:t=>{e({enableAdvancedSettings:t}),Ft.saveSetting("enableAdvancedSettings",t)},setEnableStreamingMarkdown:t=>{e({enableStreamingMarkdown:t}),Ft.saveSetting("enableStreamingMarkdown",t)},setEnableStreamingCodeBlockParsing:t=>{e({enableStreamingCodeBlockParsing:t}),Ft.saveSetting("enableStreamingCodeBlockParsing",t)},setFoldStreamingCodeBlocks:t=>{e({foldStreamingCodeBlocks:t}),Ft.saveSetting("foldStreamingCodeBlocks",t)},setFoldUserMessagesOnCompletion:t=>{e({foldUserMessagesOnCompletion:t}),Ft.saveSetting("foldUserMessagesOnCompletion",t)},setStreamingRenderFPS:t=>{const n=Math.max(3,Math.min(60,t));e({streamingRenderFPS:n}),Ft.saveSetting("streamingRenderFPS",n)},setGitUserName:t=>{const n=(t==null?void 0:t.trim())||null;e({gitUserName:n}),Ft.saveSetting("gitUserName",n)},setGitUserEmail:t=>{const n=(t==null?void 0:t.trim())||null;e({gitUserEmail:n}),Ft.saveSetting("gitUserEmail",n)},setToolMaxSteps:t=>{const n=Math.max(1,Math.min(20,t));e({toolMaxSteps:n}),Ft.saveSetting("toolMaxSteps",n)},setPrismThemeUrl:t=>{const n=(t==null?void 0:t.trim())||null;e({prismThemeUrl:n}),Ft.saveSetting("prismThemeUrl",n)},loadSettings:async()=>{try{const[t,n,r,a,i,s,o,l,u,d,h,p,y,v,b,w,x,S]=await Promise.all([Ft.loadSetting("theme",vb),Ft.loadSetting("temperature",r3),Ft.loadSetting("maxTokens",a3),Ft.loadSetting("topP",i3),Ft.loadSetting("topK",s3),Ft.loadSetting("presencePenalty",o3),Ft.loadSetting("frequencyPenalty",l3),Ft.loadSetting("globalSystemPrompt",n3),Ft.loadSetting("enableAdvancedSettings",c3),Ft.loadSetting("enableStreamingMarkdown",wb),Ft.loadSetting("enableStreamingCodeBlockParsing",xb),Ft.loadSetting("foldStreamingCodeBlocks",_b),Ft.loadSetting("foldUserMessagesOnCompletion",Sb),Ft.loadSetting("streamingRenderFPS",Eb),Ft.loadSetting("gitUserName",u3),Ft.loadSetting("gitUserEmail",d3),Ft.loadSetting("toolMaxSteps",f3),Ft.loadSetting("prismThemeUrl",Cb)]);e({theme:t,temperature:n,maxTokens:r,topP:a,topK:i,presencePenalty:s,frequencyPenalty:o,globalSystemPrompt:l,enableAdvancedSettings:u,enableStreamingMarkdown:d,enableStreamingCodeBlockParsing:h,foldStreamingCodeBlocks:p,foldUserMessagesOnCompletion:y,streamingRenderFPS:v,gitUserName:b,gitUserEmail:w,toolMaxSteps:x,prismThemeUrl:S})}catch(t){console.error("SettingsStore: Error loading settings",t)}},resetGeneralSettings:async()=>{try{e({theme:vb,enableStreamingMarkdown:wb,enableStreamingCodeBlockParsing:xb,foldStreamingCodeBlocks:_b,foldUserMessagesOnCompletion:Sb,streamingRenderFPS:Eb,prismThemeUrl:Cb}),await Promise.all([Ft.saveSetting("theme",vb),Ft.saveSetting("enableStreamingMarkdown",wb),Ft.saveSetting("enableStreamingCodeBlockParsing",xb),Ft.saveSetting("foldStreamingCodeBlocks",_b),Ft.saveSetting("foldUserMessagesOnCompletion",Sb),Ft.saveSetting("streamingRenderFPS",Eb),Ft.saveSetting("prismThemeUrl",Cb)]),tt.success("General settings reset to defaults.")}catch(t){console.error("SettingsStore: Error resetting general settings",t),tt.error("Failed to reset general settings.")}}})));async function $2(e,t){const n=Dr.getState().getMiddlewareForHook,r=n(e);let a=t;for(const i of r)try{const s=await i.callback(a);if(s===!1)return console.log(`Middleware ${i.modId} cancelled action for hook ${e}`),!1;s&&typeof s=="object"&&(a=s)}catch(s){return console.error(`Middleware error in mod ${i.modId} for hook ${e}:`,s),!1}return a}function tX(){const e=Zn.getState(),t=Fn.getState(),n=qr.getState(),{providerId:r}=Ql(t.selectedModelId),a={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme};return Object.freeze(a)}function nX(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let a=0;a<n;a++)r[a]=t.charCodeAt(a);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function h3(e){try{const t=e.type||"application/octet-stream",n=GC(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:nX(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),tt.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function p3(e){return e.flatMap(t=>{var a,i,s;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(a=r.metadata)!=null&&a.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(i=t.metadata)!=null&&i.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const u=JSON.parse(l);u&&u.type==="tool-call"&&u.toolCallId&&u.toolName&&u.args!==void 0?o.push(u):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(u){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,u)}}),o.length>0&&n.push({role:"assistant",content:o})}if((s=t.metadata)!=null&&s.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const u=JSON.parse(l);u&&u.type==="tool-result"&&u.toolCallId&&u.toolName&&u.result!==void 0?o.push(u):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(u){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,u)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const m3=e=>Symbol.iterator in e,g3=e=>"entries"in e,y3=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[a,i]of n)if(!Object.is(i,r.get(a)))return!1;return!0},rX=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let a=n.next(),i=r.next();for(;!a.done&&!i.done;){if(!Object.is(a.value,i.value))return!1;a=n.next(),i=r.next()}return!!a.done&&!!i.done};function aX(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!m3(e)||!m3(t)?y3({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):g3(e)&&g3(t)?y3(e,t):rX(e,t)}function dn(e){const t=gt.useRef(void 0);return n=>{const r=e(n);return aX(t.current,r)?t.current:t.current=r}}const iX=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message..."})=>{const a=T.useRef(null),[i,s]=T.useState(!1),[o,l]=T.useState(!1),u=Dr(dn(C=>C.promptControls)),d=Zn(dn(C=>C.status==="streaming")),{focusInputOnNextRender:h,setFocusInputFlag:p}=pa(dn(C=>({focusInputOnNextRender:C.focusInputOnNextRender,setFocusInputFlag:C.setFocusInputFlag}))),{attachedFilesMetadata:y,clearAttachedFiles:v}=tu(dn(C=>({attachedFilesMetadata:C.attachedFilesMetadata,clearAttachedFiles:C.clearAttachedFiles})));T.useEffect(()=>{h&&a.current&&(a.current.focus(),p(!1))},[h,p]);const b=T.useMemo(()=>Object.values(u).filter(C=>C.show?C.show():!0),[u]),w=T.useMemo(()=>b.filter(C=>C.renderer),[b]),x=T.useMemo(()=>b.filter(C=>C.triggerRenderer),[b]),S=T.useCallback(async()=>{var O;const k=(((O=a.current)==null?void 0:O.getValue())??"").trim(),R=tu.getState().attachedFilesMetadata;if(!(!k&&R.length===0)&&!(d||i)){s(!0);try{let j={},$={};for(const K of b){if(K.getParameters){const q=await K.getParameters();q&&(j={...j,...q})}if(K.getMetadata){const q=await K.getMetadata();q&&($={...$,...q})}}R.length>0&&($.attachedFiles=[...R]);let L={id:Pi(),content:k,parameters:j,metadata:$};St.emit(_t.PROMPT_SUBMITTED,{turnData:L});const X=await $2(pv.PROMPT_TURN_FINALIZE,{turnData:L});if(X===!1){console.log("Prompt submission cancelled by middleware."),s(!1);return}const F=X&&typeof X=="object"?X.turnData:L;await t(F),v(),b.forEach(K=>{K.clearOnSubmit&&K.clearOnSubmit()}),p(!0),l(!1)}catch(j){console.error("Error during prompt submission:",j),tt.error(`Failed to send message: ${j instanceof Error?j.message:String(j)}`)}finally{s(!1)}}},[d,i,b,t,v,p]),E=T.useCallback(C=>{l(C.trim().length>0),St.emit(_t.PROMPT_INPUT_CHANGE,{value:C})},[]);return m.jsxs("div",{className:Nt("p-4 space-y-3",n),children:[w.length>0&&m.jsx(wI,{controls:w,area:"panel",className:"flex flex-wrap gap-2 items-start mb-2"}),m.jsx(e,{ref:a,onSubmit:S,disabled:d||i,placeholder:r,onValueChange:E}),m.jsxs("div",{className:"flex items-center justify-between gap-2 mt-2",children:[m.jsx(wI,{controls:x,area:"trigger",className:"flex items-center gap-1 flex-shrink-0"}),m.jsx("div",{className:"flex-grow"}),m.jsx(Mt,{type:"button",size:"icon",onClick:S,disabled:d||i||!o&&y.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:i?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(bH,{className:"h-4 w-4"})})]})]})};function Vt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function sX(e,t){const n=T.createContext(t),r=i=>{const{children:s,...o}=i,l=T.useMemo(()=>o,Object.values(o));return m.jsx(n.Provider,{value:l,children:s})};r.displayName=e+"Provider";function a(i){const s=T.useContext(n);if(s)return s;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,a]}function Si(e,t=[]){let n=[];function r(i,s){const o=T.createContext(s),l=n.length;n=[...n,s];const u=h=>{var x;const{scope:p,children:y,...v}=h,b=((x=p==null?void 0:p[e])==null?void 0:x[l])||o,w=T.useMemo(()=>v,Object.values(v));return m.jsx(b.Provider,{value:w,children:y})};u.displayName=i+"Provider";function d(h,p){var b;const y=((b=p==null?void 0:p[e])==null?void 0:b[l])||o,v=T.useContext(y);if(v)return v;if(s!==void 0)return s;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const a=()=>{const i=n.map(s=>T.createContext(s));return function(o){const l=(o==null?void 0:o[e])||i;return T.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return a.scopeName=e,[r,oX(a,...t)]}function oX(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const s=r.reduce((o,{useScope:l,scopeName:u})=>{const h=l(i)[`__scope${u}`];return{...o,...h}},{});return T.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return n.scopeName=t.scopeName,n}var lX=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],rn=lX.reduce((e,t)=>{const n=eu(`Primitive.${t}`),r=T.forwardRef((a,i)=>{const{asChild:s,...o}=a,l=s?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),m.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function i8(e,t){e&&$o.flushSync(()=>e.dispatchEvent(t))}function Fa(e){const t=T.useRef(e);return T.useEffect(()=>{t.current=e}),T.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function cX(e,t=globalThis==null?void 0:globalThis.document){const n=Fa(e);T.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var uX="DismissableLayer",B2="dismissableLayer.update",dX="dismissableLayer.pointerDownOutside",fX="dismissableLayer.focusOutside",b3,s8=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ep=T.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:s,onDismiss:o,...l}=e,u=T.useContext(s8),[d,h]=T.useState(null),p=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,y]=T.useState({}),v=Cn(t,O=>h(O)),b=Array.from(u.layers),[w]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(w),S=d?b.indexOf(d):-1,E=u.layersWithOutsidePointerEventsDisabled.size>0,C=S>=x,k=mX(O=>{const j=O.target,$=[...u.branches].some(L=>L.contains(j));!C||$||(a==null||a(O),s==null||s(O),O.defaultPrevented||o==null||o())},p),R=gX(O=>{const j=O.target;[...u.branches].some(L=>L.contains(j))||(i==null||i(O),s==null||s(O),O.defaultPrevented||o==null||o())},p);return cX(O=>{S===u.layers.size-1&&(r==null||r(O),!O.defaultPrevented&&o&&(O.preventDefault(),o()))},p),T.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(b3=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),v3(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=b3)}},[d,p,n,u]),T.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),v3())},[d,u]),T.useEffect(()=>{const O=()=>y({});return document.addEventListener(B2,O),()=>document.removeEventListener(B2,O)},[]),m.jsx(rn.div,{...l,ref:v,style:{pointerEvents:E?C?"auto":"none":void 0,...e.style},onFocusCapture:Vt(e.onFocusCapture,R.onFocusCapture),onBlurCapture:Vt(e.onBlurCapture,R.onBlurCapture),onPointerDownCapture:Vt(e.onPointerDownCapture,k.onPointerDownCapture)})});ep.displayName=uX;var hX="DismissableLayerBranch",pX=T.forwardRef((e,t)=>{const n=T.useContext(s8),r=T.useRef(null),a=Cn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),m.jsx(rn.div,{...e,ref:a})});pX.displayName=hX;function mX(e,t=globalThis==null?void 0:globalThis.document){const n=Fa(e),r=T.useRef(!1),a=T.useRef(()=>{});return T.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){o8(dX,n,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=l,t.addEventListener("click",a.current,{once:!0})):l()}else t.removeEventListener("click",a.current);r.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function gX(e,t=globalThis==null?void 0:globalThis.document){const n=Fa(e),r=T.useRef(!1);return T.useEffect(()=>{const a=i=>{i.target&&!r.current&&o8(fX,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function v3(){const e=new CustomEvent(B2);document.dispatchEvent(e)}function o8(e,t,n,{discrete:r}){const a=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?i8(a,i):a.dispatchEvent(i)}var za=globalThis!=null&&globalThis.document?T.useLayoutEffect:()=>{},yX=a6[" useId ".trim().toString()]||(()=>{}),bX=0;function Ya(e){const[t,n]=T.useState(yX());return za(()=>{n(r=>r??String(bX++))},[e]),t?`radix-${t}`:""}const vX=["top","right","bottom","left"],cu=Math.min,es=Math.max,Lv=Math.round,kb=Math.floor,qo=e=>({x:e,y:e}),wX={left:"right",right:"left",bottom:"top",top:"bottom"},xX={start:"end",end:"start"};function z2(e,t,n){return es(e,cu(t,n))}function Hl(e,t){return typeof e=="function"?e(t):e}function Vl(e){return e.split("-")[0]}function tp(e){return e.split("-")[1]}function ik(e){return e==="x"?"y":"x"}function sk(e){return e==="y"?"height":"width"}function uu(e){return["top","bottom"].includes(Vl(e))?"y":"x"}function ok(e){return ik(uu(e))}function _X(e,t,n){n===void 0&&(n=!1);const r=tp(e),a=ok(e),i=sk(a);let s=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=$v(s)),[s,$v(s)]}function SX(e){const t=$v(e);return[U2(e),t,U2(t)]}function U2(e){return e.replace(/start|end/g,t=>xX[t])}function EX(e,t,n){const r=["left","right"],a=["right","left"],i=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:r:t?r:a;case"left":case"right":return t?i:s;default:return[]}}function CX(e,t,n,r){const a=tp(e);let i=EX(Vl(e),n==="start",r);return a&&(i=i.map(s=>s+"-"+a),t&&(i=i.concat(i.map(U2)))),i}function $v(e){return e.replace(/left|right|bottom|top/g,t=>wX[t])}function kX(e){return{top:0,right:0,bottom:0,left:0,...e}}function l8(e){return typeof e!="number"?kX(e):{top:e,right:e,bottom:e,left:e}}function Bv(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function w3(e,t,n){let{reference:r,floating:a}=e;const i=uu(t),s=ok(t),o=sk(s),l=Vl(t),u=i==="y",d=r.x+r.width/2-a.width/2,h=r.y+r.height/2-a.height/2,p=r[o]/2-a[o]/2;let y;switch(l){case"top":y={x:d,y:r.y-a.height};break;case"bottom":y={x:d,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:h};break;case"left":y={x:r.x-a.width,y:h};break;default:y={x:r.x,y:r.y}}switch(tp(t)){case"start":y[s]-=p*(n&&u?-1:1);break;case"end":y[s]+=p*(n&&u?-1:1);break}return y}const TX=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:i=[],platform:s}=n,o=i.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(t));let u=await s.getElementRects({reference:e,floating:t,strategy:a}),{x:d,y:h}=w3(u,r,l),p=r,y={},v=0;for(let b=0;b<o.length;b++){const{name:w,fn:x}=o[b],{x:S,y:E,data:C,reset:k}=await x({x:d,y:h,initialPlacement:r,placement:p,strategy:a,middlewareData:y,rects:u,platform:s,elements:{reference:e,floating:t}});d=S??d,h=E??h,y={...y,[w]:{...y[w],...C}},k&&v<=50&&(v++,typeof k=="object"&&(k.placement&&(p=k.placement),k.rects&&(u=k.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:a}):k.rects),{x:d,y:h}=w3(u,p,l)),b=-1)}return{x:d,y:h,placement:p,strategy:a,middlewareData:y}};async function bg(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:i,rects:s,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:p=!1,padding:y=0}=Hl(t,e),v=l8(y),w=o[p?h==="floating"?"reference":"floating":h],x=Bv(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(w)))==null||n?w:w.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:u,rootBoundary:d,strategy:l})),S=h==="floating"?{x:r,y:a,width:s.floating.width,height:s.floating.height}:s.reference,E=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),C=await(i.isElement==null?void 0:i.isElement(E))?await(i.getScale==null?void 0:i.getScale(E))||{x:1,y:1}:{x:1,y:1},k=Bv(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:S,offsetParent:E,strategy:l}):S);return{top:(x.top-k.top+v.top)/C.y,bottom:(k.bottom-x.bottom+v.bottom)/C.y,left:(x.left-k.left+v.left)/C.x,right:(k.right-x.right+v.right)/C.x}}const AX=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:i,platform:s,elements:o,middlewareData:l}=t,{element:u,padding:d=0}=Hl(e,t)||{};if(u==null)return{};const h=l8(d),p={x:n,y:r},y=ok(a),v=sk(y),b=await s.getDimensions(u),w=y==="y",x=w?"top":"left",S=w?"bottom":"right",E=w?"clientHeight":"clientWidth",C=i.reference[v]+i.reference[y]-p[y]-i.floating[v],k=p[y]-i.reference[y],R=await(s.getOffsetParent==null?void 0:s.getOffsetParent(u));let O=R?R[E]:0;(!O||!await(s.isElement==null?void 0:s.isElement(R)))&&(O=o.floating[E]||i.floating[v]);const j=C/2-k/2,$=O/2-b[v]/2-1,L=cu(h[x],$),X=cu(h[S],$),F=L,K=O-b[v]-X,q=O/2-b[v]/2+j,de=z2(F,q,K),re=!l.arrow&&tp(a)!=null&&q!==de&&i.reference[v]/2-(q<F?L:X)-b[v]/2<0,Y=re?q<F?q-F:q-K:0;return{[y]:p[y]+Y,data:{[y]:de,centerOffset:q-de-Y,...re&&{alignmentOffset:Y}},reset:re}}}),NX=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:i,rects:s,initialPlacement:o,platform:l,elements:u}=t,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:p,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:b=!0,...w}=Hl(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=Vl(a),S=uu(o),E=Vl(o)===o,C=await(l.isRTL==null?void 0:l.isRTL(u.floating)),k=p||(E||!b?[$v(o)]:SX(o)),R=v!=="none";!p&&R&&k.push(...CX(o,b,v,C));const O=[o,...k],j=await bg(t,w),$=[];let L=((r=i.flip)==null?void 0:r.overflows)||[];if(d&&$.push(j[x]),h){const q=_X(a,s,C);$.push(j[q[0]],j[q[1]])}if(L=[...L,{placement:a,overflows:$}],!$.every(q=>q<=0)){var X,F;const q=(((X=i.flip)==null?void 0:X.index)||0)+1,de=O[q];if(de)return{data:{index:q,overflows:L},reset:{placement:de}};let re=(F=L.filter(Y=>Y.overflows[0]<=0).sort((Y,Q)=>Y.overflows[1]-Q.overflows[1])[0])==null?void 0:F.placement;if(!re)switch(y){case"bestFit":{var K;const Y=(K=L.filter(Q=>{if(R){const ae=uu(Q.placement);return ae===S||ae==="y"}return!0}).map(Q=>[Q.placement,Q.overflows.filter(ae=>ae>0).reduce((ae,B)=>ae+B,0)]).sort((Q,ae)=>Q[1]-ae[1])[0])==null?void 0:K[0];Y&&(re=Y);break}case"initialPlacement":re=o;break}if(a!==re)return{reset:{placement:re}}}return{}}}};function x3(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function _3(e){return vX.some(t=>e[t]>=0)}const RX=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=Hl(e,t);switch(r){case"referenceHidden":{const i=await bg(t,{...a,elementContext:"reference"}),s=x3(i,n.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:_3(s)}}}case"escaped":{const i=await bg(t,{...a,altBoundary:!0}),s=x3(i,n.floating);return{data:{escapedOffsets:s,escaped:_3(s)}}}default:return{}}}}};async function IX(e,t){const{placement:n,platform:r,elements:a}=e,i=await(r.isRTL==null?void 0:r.isRTL(a.floating)),s=Vl(n),o=tp(n),l=uu(n)==="y",u=["left","top"].includes(s)?-1:1,d=i&&l?-1:1,h=Hl(t,e);let{mainAxis:p,crossAxis:y,alignmentAxis:v}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&typeof v=="number"&&(y=o==="end"?v*-1:v),l?{x:y*d,y:p*u}:{x:p*u,y:y*d}}const jX=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:i,placement:s,middlewareData:o}=t,l=await IX(t,e);return s===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:a+l.x,y:i+l.y,data:{...l,placement:s}}}}},OX=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:i=!0,crossAxis:s=!1,limiter:o={fn:w=>{let{x,y:S}=w;return{x,y:S}}},...l}=Hl(e,t),u={x:n,y:r},d=await bg(t,l),h=uu(Vl(a)),p=ik(h);let y=u[p],v=u[h];if(i){const w=p==="y"?"top":"left",x=p==="y"?"bottom":"right",S=y+d[w],E=y-d[x];y=z2(S,y,E)}if(s){const w=h==="y"?"top":"left",x=h==="y"?"bottom":"right",S=v+d[w],E=v-d[x];v=z2(S,v,E)}const b=o.fn({...t,[p]:y,[h]:v});return{...b,data:{x:b.x-n,y:b.y-r,enabled:{[p]:i,[h]:s}}}}}},DX=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:i,middlewareData:s}=t,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=Hl(e,t),d={x:n,y:r},h=uu(a),p=ik(h);let y=d[p],v=d[h];const b=Hl(o,t),w=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const E=p==="y"?"height":"width",C=i.reference[p]-i.floating[E]+w.mainAxis,k=i.reference[p]+i.reference[E]-w.mainAxis;y<C?y=C:y>k&&(y=k)}if(u){var x,S;const E=p==="y"?"width":"height",C=["top","left"].includes(Vl(a)),k=i.reference[h]-i.floating[E]+(C&&((x=s.offset)==null?void 0:x[h])||0)+(C?0:w.crossAxis),R=i.reference[h]+i.reference[E]+(C?0:((S=s.offset)==null?void 0:S[h])||0)-(C?w.crossAxis:0);v<k?v=k:v>R&&(v=R)}return{[p]:y,[h]:v}}}},MX=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:a,rects:i,platform:s,elements:o}=t,{apply:l=()=>{},...u}=Hl(e,t),d=await bg(t,u),h=Vl(a),p=tp(a),y=uu(a)==="y",{width:v,height:b}=i.floating;let w,x;h==="top"||h==="bottom"?(w=h,x=p===(await(s.isRTL==null?void 0:s.isRTL(o.floating))?"start":"end")?"left":"right"):(x=h,w=p==="end"?"top":"bottom");const S=b-d.top-d.bottom,E=v-d.left-d.right,C=cu(b-d[w],S),k=cu(v-d[x],E),R=!t.middlewareData.shift;let O=C,j=k;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(j=E),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(O=S),R&&!p){const L=es(d.left,0),X=es(d.right,0),F=es(d.top,0),K=es(d.bottom,0);y?j=v-2*(L!==0||X!==0?L+X:es(d.left,d.right)):O=b-2*(F!==0||K!==0?F+K:es(d.top,d.bottom))}await l({...t,availableWidth:j,availableHeight:O});const $=await s.getDimensions(o.floating);return v!==$.width||b!==$.height?{reset:{rects:!0}}:{}}}};function Bw(){return typeof window<"u"}function np(e){return c8(e)?(e.nodeName||"").toLowerCase():"#document"}function rs(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Xo(e){var t;return(t=(c8(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function c8(e){return Bw()?e instanceof Node||e instanceof rs(e).Node:!1}function eo(e){return Bw()?e instanceof Element||e instanceof rs(e).Element:!1}function Wo(e){return Bw()?e instanceof HTMLElement||e instanceof rs(e).HTMLElement:!1}function S3(e){return!Bw()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof rs(e).ShadowRoot}function d0(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=to(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(a)}function PX(e){return["table","td","th"].includes(np(e))}function zw(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function lk(e){const t=ck(),n=eo(e)?to(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function FX(e){let t=du(e);for(;Wo(t)&&!Oh(t);){if(lk(t))return t;if(zw(t))return null;t=du(t)}return null}function ck(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Oh(e){return["html","body","#document"].includes(np(e))}function to(e){return rs(e).getComputedStyle(e)}function Uw(e){return eo(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function du(e){if(np(e)==="html")return e;const t=e.assignedSlot||e.parentNode||S3(e)&&e.host||Xo(e);return S3(t)?t.host:t}function u8(e){const t=du(e);return Oh(t)?e.ownerDocument?e.ownerDocument.body:e.body:Wo(t)&&d0(t)?t:u8(t)}function vg(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=u8(e),i=a===((r=e.ownerDocument)==null?void 0:r.body),s=rs(a);if(i){const o=q2(s);return t.concat(s,s.visualViewport||[],d0(a)?a:[],o&&n?vg(o):[])}return t.concat(a,vg(a,[],n))}function q2(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function d8(e){const t=to(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=Wo(e),i=a?e.offsetWidth:n,s=a?e.offsetHeight:r,o=Lv(n)!==i||Lv(r)!==s;return o&&(n=i,r=s),{width:n,height:r,$:o}}function uk(e){return eo(e)?e:e.contextElement}function wh(e){const t=uk(e);if(!Wo(t))return qo(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:i}=d8(t);let s=(i?Lv(n.width):n.width)/r,o=(i?Lv(n.height):n.height)/a;return(!s||!Number.isFinite(s))&&(s=1),(!o||!Number.isFinite(o))&&(o=1),{x:s,y:o}}const LX=qo(0);function f8(e){const t=rs(e);return!ck()||!t.visualViewport?LX:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function $X(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==rs(e)?!1:t}function Md(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),i=uk(e);let s=qo(1);t&&(r?eo(r)&&(s=wh(r)):s=wh(e));const o=$X(i,n,r)?f8(i):qo(0);let l=(a.left+o.x)/s.x,u=(a.top+o.y)/s.y,d=a.width/s.x,h=a.height/s.y;if(i){const p=rs(i),y=r&&eo(r)?rs(r):r;let v=p,b=q2(v);for(;b&&r&&y!==v;){const w=wh(b),x=b.getBoundingClientRect(),S=to(b),E=x.left+(b.clientLeft+parseFloat(S.paddingLeft))*w.x,C=x.top+(b.clientTop+parseFloat(S.paddingTop))*w.y;l*=w.x,u*=w.y,d*=w.x,h*=w.y,l+=E,u+=C,v=rs(b),b=q2(v)}}return Bv({width:d,height:h,x:l,y:u})}function dk(e,t){const n=Uw(e).scrollLeft;return t?t.left+n:Md(Xo(e)).left+n}function h8(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),a=r.left+t.scrollLeft-(n?0:dk(e,r)),i=r.top+t.scrollTop;return{x:a,y:i}}function BX(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const i=a==="fixed",s=Xo(r),o=t?zw(t.floating):!1;if(r===s||o&&i)return n;let l={scrollLeft:0,scrollTop:0},u=qo(1);const d=qo(0),h=Wo(r);if((h||!h&&!i)&&((np(r)!=="body"||d0(s))&&(l=Uw(r)),Wo(r))){const y=Md(r);u=wh(r),d.x=y.x+r.clientLeft,d.y=y.y+r.clientTop}const p=s&&!h&&!i?h8(s,l,!0):qo(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+d.x+p.x,y:n.y*u.y-l.scrollTop*u.y+d.y+p.y}}function zX(e){return Array.from(e.getClientRects())}function UX(e){const t=Xo(e),n=Uw(e),r=e.ownerDocument.body,a=es(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=es(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+dk(e);const o=-n.scrollTop;return to(r).direction==="rtl"&&(s+=es(t.clientWidth,r.clientWidth)-a),{width:a,height:i,x:s,y:o}}function qX(e,t){const n=rs(e),r=Xo(e),a=n.visualViewport;let i=r.clientWidth,s=r.clientHeight,o=0,l=0;if(a){i=a.width,s=a.height;const u=ck();(!u||u&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}return{width:i,height:s,x:o,y:l}}function HX(e,t){const n=Md(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,i=Wo(e)?wh(e):qo(1),s=e.clientWidth*i.x,o=e.clientHeight*i.y,l=a*i.x,u=r*i.y;return{width:s,height:o,x:l,y:u}}function E3(e,t,n){let r;if(t==="viewport")r=qX(e,n);else if(t==="document")r=UX(Xo(e));else if(eo(t))r=HX(t,n);else{const a=f8(e);r={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return Bv(r)}function p8(e,t){const n=du(e);return n===t||!eo(n)||Oh(n)?!1:to(n).position==="fixed"||p8(n,t)}function VX(e,t){const n=t.get(e);if(n)return n;let r=vg(e,[],!1).filter(o=>eo(o)&&np(o)!=="body"),a=null;const i=to(e).position==="fixed";let s=i?du(e):e;for(;eo(s)&&!Oh(s);){const o=to(s),l=lk(s);!l&&o.position==="fixed"&&(a=null),(i?!l&&!a:!l&&o.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||d0(s)&&!l&&p8(e,s))?r=r.filter(d=>d!==s):a=o,s=du(s)}return t.set(e,r),r}function GX(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const s=[...n==="clippingAncestors"?zw(t)?[]:VX(t,this._c):[].concat(n),r],o=s[0],l=s.reduce((u,d)=>{const h=E3(t,d,a);return u.top=es(h.top,u.top),u.right=cu(h.right,u.right),u.bottom=cu(h.bottom,u.bottom),u.left=es(h.left,u.left),u},E3(t,o,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function WX(e){const{width:t,height:n}=d8(e);return{width:t,height:n}}function KX(e,t,n){const r=Wo(t),a=Xo(t),i=n==="fixed",s=Md(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=qo(0);if(r||!r&&!i)if((np(t)!=="body"||d0(a))&&(o=Uw(t)),r){const p=Md(t,!0,i,t);l.x=p.x+t.clientLeft,l.y=p.y+t.clientTop}else a&&(l.x=dk(a));const u=a&&!r&&!i?h8(a,o):qo(0),d=s.left+o.scrollLeft-l.x-u.x,h=s.top+o.scrollTop-l.y-u.y;return{x:d,y:h,width:s.width,height:s.height}}function hS(e){return to(e).position==="static"}function C3(e,t){if(!Wo(e)||to(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Xo(e)===n&&(n=n.ownerDocument.body),n}function m8(e,t){const n=rs(e);if(zw(e))return n;if(!Wo(e)){let a=du(e);for(;a&&!Oh(a);){if(eo(a)&&!hS(a))return a;a=du(a)}return n}let r=C3(e,t);for(;r&&PX(r)&&hS(r);)r=C3(r,t);return r&&Oh(r)&&hS(r)&&!lk(r)?n:r||FX(e)||n}const ZX=async function(e){const t=this.getOffsetParent||m8,n=this.getDimensions,r=await n(e.floating);return{reference:KX(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function YX(e){return to(e).direction==="rtl"}const XX={convertOffsetParentRelativeRectToViewportRelativeRect:BX,getDocumentElement:Xo,getClippingRect:GX,getOffsetParent:m8,getElementRects:ZX,getClientRects:zX,getDimensions:WX,getScale:wh,isElement:eo,isRTL:YX};function g8(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function JX(e,t){let n=null,r;const a=Xo(e);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function s(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const u=e.getBoundingClientRect(),{left:d,top:h,width:p,height:y}=u;if(o||t(),!p||!y)return;const v=kb(h),b=kb(a.clientWidth-(d+p)),w=kb(a.clientHeight-(h+y)),x=kb(d),E={rootMargin:-v+"px "+-b+"px "+-w+"px "+-x+"px",threshold:es(0,cu(1,l))||1};let C=!0;function k(R){const O=R[0].intersectionRatio;if(O!==l){if(!C)return s();O?s(!1,O):r=setTimeout(()=>{s(!1,1e-7)},1e3)}O===1&&!g8(u,e.getBoundingClientRect())&&s(),C=!1}try{n=new IntersectionObserver(k,{...E,root:a.ownerDocument})}catch{n=new IntersectionObserver(k,E)}n.observe(e)}return s(!0),i}function QX(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,u=uk(e),d=a||i?[...u?vg(u):[],...vg(t)]:[];d.forEach(x=>{a&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const h=u&&o?JX(u,n):null;let p=-1,y=null;s&&(y=new ResizeObserver(x=>{let[S]=x;S&&S.target===u&&y&&(y.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var E;(E=y)==null||E.observe(t)})),n()}),u&&!l&&y.observe(u),y.observe(t));let v,b=l?Md(e):null;l&&w();function w(){const x=Md(e);b&&!g8(b,x)&&n(),b=x,v=requestAnimationFrame(w)}return n(),()=>{var x;d.forEach(S=>{a&&S.removeEventListener("scroll",n),i&&S.removeEventListener("resize",n)}),h==null||h(),(x=y)==null||x.disconnect(),y=null,l&&cancelAnimationFrame(v)}}const eJ=jX,tJ=OX,nJ=NX,rJ=MX,aJ=RX,k3=AX,iJ=DX,sJ=(e,t,n)=>{const r=new Map,a={platform:XX,...n},i={...a.platform,_c:r};return TX(e,t,{...a,platform:i})};var rv=typeof document<"u"?T.useLayoutEffect:T.useEffect;function zv(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!zv(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const i=a[r];if(!(i==="_owner"&&e.$$typeof)&&!zv(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function y8(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function T3(e,t){const n=y8(e);return Math.round(t*n)/n}function pS(e){const t=T.useRef(e);return rv(()=>{t.current=e}),t}function oJ(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:i,floating:s}={},transform:o=!0,whileElementsMounted:l,open:u}=e,[d,h]=T.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,y]=T.useState(r);zv(p,r)||y(r);const[v,b]=T.useState(null),[w,x]=T.useState(null),S=T.useCallback(Q=>{Q!==R.current&&(R.current=Q,b(Q))},[]),E=T.useCallback(Q=>{Q!==O.current&&(O.current=Q,x(Q))},[]),C=i||v,k=s||w,R=T.useRef(null),O=T.useRef(null),j=T.useRef(d),$=l!=null,L=pS(l),X=pS(a),F=pS(u),K=T.useCallback(()=>{if(!R.current||!O.current)return;const Q={placement:t,strategy:n,middleware:p};X.current&&(Q.platform=X.current),sJ(R.current,O.current,Q).then(ae=>{const B={...ae,isPositioned:F.current!==!1};q.current&&!zv(j.current,B)&&(j.current=B,$o.flushSync(()=>{h(B)}))})},[p,t,n,X,F]);rv(()=>{u===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,h(Q=>({...Q,isPositioned:!1})))},[u]);const q=T.useRef(!1);rv(()=>(q.current=!0,()=>{q.current=!1}),[]),rv(()=>{if(C&&(R.current=C),k&&(O.current=k),C&&k){if(L.current)return L.current(C,k,K);K()}},[C,k,K,L,$]);const de=T.useMemo(()=>({reference:R,floating:O,setReference:S,setFloating:E}),[S,E]),re=T.useMemo(()=>({reference:C,floating:k}),[C,k]),Y=T.useMemo(()=>{const Q={position:n,left:0,top:0};if(!re.floating)return Q;const ae=T3(re.floating,d.x),B=T3(re.floating,d.y);return o?{...Q,transform:"translate("+ae+"px, "+B+"px)",...y8(re.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ae,top:B}},[n,o,re.floating,d.x,d.y]);return T.useMemo(()=>({...d,update:K,refs:de,elements:re,floatingStyles:Y}),[d,K,de,re,Y])}const lJ=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?k3({element:r.current,padding:a}).fn(n):{}:r?k3({element:r,padding:a}).fn(n):{}}}},cJ=(e,t)=>({...eJ(e),options:[e,t]}),uJ=(e,t)=>({...tJ(e),options:[e,t]}),dJ=(e,t)=>({...iJ(e),options:[e,t]}),fJ=(e,t)=>({...nJ(e),options:[e,t]}),hJ=(e,t)=>({...rJ(e),options:[e,t]}),pJ=(e,t)=>({...aJ(e),options:[e,t]}),mJ=(e,t)=>({...lJ(e),options:[e,t]});var gJ="Arrow",b8=T.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...i}=e;return m.jsx(rn.svg,{...i,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:m.jsx("polygon",{points:"0,0 30,0 15,10"})})});b8.displayName=gJ;var yJ=b8;function qw(e){const[t,n]=T.useState(void 0);return za(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let s,o;if("borderBoxSize"in i){const l=i.borderBoxSize,u=Array.isArray(l)?l[0]:l;s=u.inlineSize,o=u.blockSize}else s=e.offsetWidth,o=e.offsetHeight;n({width:s,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var fk="Popper",[v8,wu]=Si(fk),[bJ,w8]=v8(fk),x8=e=>{const{__scopePopper:t,children:n}=e,[r,a]=T.useState(null);return m.jsx(bJ,{scope:t,anchor:r,onAnchorChange:a,children:n})};x8.displayName=fk;var _8="PopperAnchor",S8=T.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,i=w8(_8,n),s=T.useRef(null),o=Cn(t,s);return T.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:m.jsx(rn.div,{...a,ref:o})});S8.displayName=_8;var hk="PopperContent",[vJ,wJ]=v8(hk),E8=T.forwardRef((e,t)=>{var Ne,Re,ke,Fe,Qe,Le;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:i="center",alignOffset:s=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:p=!1,updatePositionStrategy:y="optimized",onPlaced:v,...b}=e,w=w8(hk,n),[x,S]=T.useState(null),E=Cn(t,Ie=>S(Ie)),[C,k]=T.useState(null),R=qw(C),O=(R==null?void 0:R.width)??0,j=(R==null?void 0:R.height)??0,$=r+(i!=="center"?"-"+i:""),L=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},X=Array.isArray(u)?u:[u],F=X.length>0,K={padding:L,boundary:X.filter(_J),altBoundary:F},{refs:q,floatingStyles:de,placement:re,isPositioned:Y,middlewareData:Q}=oJ({strategy:"fixed",placement:$,whileElementsMounted:(...Ie)=>QX(...Ie,{animationFrame:y==="always"}),elements:{reference:w.anchor},middleware:[cJ({mainAxis:a+j,alignmentAxis:s}),l&&uJ({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?dJ():void 0,...K}),l&&fJ({...K}),hJ({...K,apply:({elements:Ie,rects:V,availableWidth:ge,availableHeight:Te})=>{const{width:le,height:ie}=V.reference,te=Ie.floating.style;te.setProperty("--radix-popper-available-width",`${ge}px`),te.setProperty("--radix-popper-available-height",`${Te}px`),te.setProperty("--radix-popper-anchor-width",`${le}px`),te.setProperty("--radix-popper-anchor-height",`${ie}px`)}}),C&&mJ({element:C,padding:o}),SJ({arrowWidth:O,arrowHeight:j}),p&&pJ({strategy:"referenceHidden",...K})]}),[ae,B]=T8(re),J=Fa(v);za(()=>{Y&&(J==null||J())},[Y,J]);const ee=(Ne=Q.arrow)==null?void 0:Ne.x,oe=(Re=Q.arrow)==null?void 0:Re.y,me=((ke=Q.arrow)==null?void 0:ke.centerOffset)!==0,[xe,Pe]=T.useState();return za(()=>{x&&Pe(window.getComputedStyle(x).zIndex)},[x]),m.jsx("div",{ref:q.setFloating,"data-radix-popper-content-wrapper":"",style:{...de,transform:Y?de.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:xe,"--radix-popper-transform-origin":[(Fe=Q.transformOrigin)==null?void 0:Fe.x,(Qe=Q.transformOrigin)==null?void 0:Qe.y].join(" "),...((Le=Q.hide)==null?void 0:Le.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:m.jsx(vJ,{scope:n,placedSide:ae,onArrowChange:k,arrowX:ee,arrowY:oe,shouldHideArrow:me,children:m.jsx(rn.div,{"data-side":ae,"data-align":B,...b,ref:E,style:{...b.style,animation:Y?void 0:"none"}})})})});E8.displayName=hk;var C8="PopperArrow",xJ={top:"bottom",right:"left",bottom:"top",left:"right"},k8=T.forwardRef(function(t,n){const{__scopePopper:r,...a}=t,i=wJ(C8,r),s=xJ[i.placedSide];return m.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:m.jsx(yJ,{...a,ref:n,style:{...a.style,display:"block"}})})});k8.displayName=C8;function _J(e){return e!==null}var SJ=e=>({name:"transformOrigin",options:e,fn(t){var w,x,S;const{placement:n,rects:r,middlewareData:a}=t,s=((w=a.arrow)==null?void 0:w.centerOffset)!==0,o=s?0:e.arrowWidth,l=s?0:e.arrowHeight,[u,d]=T8(n),h={start:"0%",center:"50%",end:"100%"}[d],p=(((x=a.arrow)==null?void 0:x.x)??0)+o/2,y=(((S=a.arrow)==null?void 0:S.y)??0)+l/2;let v="",b="";return u==="bottom"?(v=s?h:`${p}px`,b=`${-l}px`):u==="top"?(v=s?h:`${p}px`,b=`${r.floating.height+l}px`):u==="right"?(v=`${-l}px`,b=s?h:`${y}px`):u==="left"&&(v=`${r.floating.width+l}px`,b=s?h:`${y}px`),{data:{x:v,y:b}}}});function T8(e){const[t,n="center"]=e.split("-");return[t,n]}var Hw=x8,f0=S8,Vw=E8,Gw=k8,EJ="Portal",rp=T.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[a,i]=T.useState(!1);za(()=>i(!0),[]);const s=n||a&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return s?a8.createPortal(m.jsx(rn.div,{...r,ref:t}),s):null});rp.displayName=EJ;function CJ(e,t){return T.useReducer((n,r)=>t[n][r]??n,e)}var ka=e=>{const{present:t,children:n}=e,r=kJ(t),a=typeof n=="function"?n({present:r.isPresent}):T.Children.only(n),i=Cn(r.ref,TJ(a));return typeof n=="function"||r.isPresent?T.cloneElement(a,{ref:i}):null};ka.displayName="Presence";function kJ(e){const[t,n]=T.useState(),r=T.useRef(null),a=T.useRef(e),i=T.useRef("none"),s=e?"mounted":"unmounted",[o,l]=CJ(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return T.useEffect(()=>{const u=Tb(r.current);i.current=o==="mounted"?u:"none"},[o]),za(()=>{const u=r.current,d=a.current;if(d!==e){const p=i.current,y=Tb(u);e?l("MOUNT"):y==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(d&&p!==y?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,l]),za(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,h=y=>{const b=Tb(r.current).includes(y.animationName);if(y.target===t&&b&&(l("ANIMATION_END"),!a.current)){const w=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=w)})}},p=y=>{y.target===t&&(i.current=Tb(r.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:T.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function Tb(e){return(e==null?void 0:e.animationName)||"none"}function TJ(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var AJ=a6[" useInsertionEffect ".trim().toString()]||za;function no({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[a,i,s]=NJ({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:a;{const d=T.useRef(e!==void 0);T.useEffect(()=>{const h=d.current;h!==o&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=o},[o,r])}const u=T.useCallback(d=>{var h;if(o){const p=RJ(d)?d(e):d;p!==e&&((h=s.current)==null||h.call(s,p))}else i(d)},[o,e,i,s]);return[l,u]}function NJ({defaultProp:e,onChange:t}){const[n,r]=T.useState(e),a=T.useRef(n),i=T.useRef(t);return AJ(()=>{i.current=t},[t]),T.useEffect(()=>{var s;a.current!==n&&((s=i.current)==null||s.call(i,n),a.current=n)},[n,a]),[n,r,i]}function RJ(e){return typeof e=="function"}var A8=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),IJ="VisuallyHidden",N8=T.forwardRef((e,t)=>m.jsx(rn.span,{...e,ref:t,style:{...A8,...e.style}}));N8.displayName=IJ;var jJ=N8,[Ww,Q1e]=Si("Tooltip",[wu]),Kw=wu(),R8="TooltipProvider",OJ=700,H2="tooltip.open",[DJ,pk]=Ww(R8),I8=e=>{const{__scopeTooltip:t,delayDuration:n=OJ,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:i}=e,s=T.useRef(!0),o=T.useRef(!1),l=T.useRef(0);return T.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),m.jsx(DJ,{scope:t,isOpenDelayedRef:s,delayDuration:n,onOpen:T.useCallback(()=>{window.clearTimeout(l.current),s.current=!1},[]),onClose:T.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>s.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:T.useCallback(u=>{o.current=u},[]),disableHoverableContent:a,children:i})};I8.displayName=R8;var wg="Tooltip",[MJ,h0]=Ww(wg),j8=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a,onOpenChange:i,disableHoverableContent:s,delayDuration:o}=e,l=pk(wg,e.__scopeTooltip),u=Kw(t),[d,h]=T.useState(null),p=Ya(),y=T.useRef(0),v=s??l.disableHoverableContent,b=o??l.delayDuration,w=T.useRef(!1),[x,S]=no({prop:r,defaultProp:a??!1,onChange:O=>{O?(l.onOpen(),document.dispatchEvent(new CustomEvent(H2))):l.onClose(),i==null||i(O)},caller:wg}),E=T.useMemo(()=>x?w.current?"delayed-open":"instant-open":"closed",[x]),C=T.useCallback(()=>{window.clearTimeout(y.current),y.current=0,w.current=!1,S(!0)},[S]),k=T.useCallback(()=>{window.clearTimeout(y.current),y.current=0,S(!1)},[S]),R=T.useCallback(()=>{window.clearTimeout(y.current),y.current=window.setTimeout(()=>{w.current=!0,S(!0),y.current=0},b)},[b,S]);return T.useEffect(()=>()=>{y.current&&(window.clearTimeout(y.current),y.current=0)},[]),m.jsx(Hw,{...u,children:m.jsx(MJ,{scope:t,contentId:p,open:x,stateAttribute:E,trigger:d,onTriggerChange:h,onTriggerEnter:T.useCallback(()=>{l.isOpenDelayedRef.current?R():C()},[l.isOpenDelayedRef,R,C]),onTriggerLeave:T.useCallback(()=>{v?k():(window.clearTimeout(y.current),y.current=0)},[k,v]),onOpen:C,onClose:k,disableHoverableContent:v,children:n})})};j8.displayName=wg;var V2="TooltipTrigger",O8=T.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=h0(V2,n),i=pk(V2,n),s=Kw(n),o=T.useRef(null),l=Cn(t,o,a.onTriggerChange),u=T.useRef(!1),d=T.useRef(!1),h=T.useCallback(()=>u.current=!1,[]);return T.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),m.jsx(f0,{asChild:!0,...s,children:m.jsx(rn.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:l,onPointerMove:Vt(e.onPointerMove,p=>{p.pointerType!=="touch"&&!d.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),d.current=!0)}),onPointerLeave:Vt(e.onPointerLeave,()=>{a.onTriggerLeave(),d.current=!1}),onPointerDown:Vt(e.onPointerDown,()=>{a.open&&a.onClose(),u.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Vt(e.onFocus,()=>{u.current||a.onOpen()}),onBlur:Vt(e.onBlur,a.onClose),onClick:Vt(e.onClick,a.onClose)})})});O8.displayName=V2;var mk="TooltipPortal",[PJ,FJ]=Ww(mk,{forceMount:void 0}),D8=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:a}=e,i=h0(mk,t);return m.jsx(PJ,{scope:t,forceMount:n,children:m.jsx(ka,{present:n||i.open,children:m.jsx(rp,{asChild:!0,container:a,children:r})})})};D8.displayName=mk;var Dh="TooltipContent",M8=T.forwardRef((e,t)=>{const n=FJ(Dh,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...i}=e,s=h0(Dh,e.__scopeTooltip);return m.jsx(ka,{present:r||s.open,children:s.disableHoverableContent?m.jsx(P8,{side:a,...i,ref:t}):m.jsx(LJ,{side:a,...i,ref:t})})}),LJ=T.forwardRef((e,t)=>{const n=h0(Dh,e.__scopeTooltip),r=pk(Dh,e.__scopeTooltip),a=T.useRef(null),i=Cn(t,a),[s,o]=T.useState(null),{trigger:l,onClose:u}=n,d=a.current,{onPointerInTransitChange:h}=r,p=T.useCallback(()=>{o(null),h(!1)},[h]),y=T.useCallback((v,b)=>{const w=v.currentTarget,x={x:v.clientX,y:v.clientY},S=UJ(x,w.getBoundingClientRect()),E=qJ(x,S),C=HJ(b.getBoundingClientRect()),k=GJ([...E,...C]);o(k),h(!0)},[h]);return T.useEffect(()=>()=>p(),[p]),T.useEffect(()=>{if(l&&d){const v=w=>y(w,d),b=w=>y(w,l);return l.addEventListener("pointerleave",v),d.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",v),d.removeEventListener("pointerleave",b)}}},[l,d,y,p]),T.useEffect(()=>{if(s){const v=b=>{const w=b.target,x={x:b.clientX,y:b.clientY},S=(l==null?void 0:l.contains(w))||(d==null?void 0:d.contains(w)),E=!VJ(x,s);S?p():E&&(p(),u())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[l,d,s,u,p]),m.jsx(P8,{...e,ref:i})}),[$J,BJ]=Ww(wg,{isInside:!1}),zJ=iU("TooltipContent"),P8=T.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:s,...o}=e,l=h0(Dh,n),u=Kw(n),{onClose:d}=l;return T.useEffect(()=>(document.addEventListener(H2,d),()=>document.removeEventListener(H2,d)),[d]),T.useEffect(()=>{if(l.trigger){const h=p=>{const y=p.target;y!=null&&y.contains(l.trigger)&&d()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,d]),m.jsx(ep,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:h=>h.preventDefault(),onDismiss:d,children:m.jsxs(Vw,{"data-state":l.stateAttribute,...u,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[m.jsx(zJ,{children:r}),m.jsx($J,{scope:n,isInside:!0,children:m.jsx(jJ,{id:l.contentId,role:"tooltip",children:a||r})})]})})});M8.displayName=Dh;var F8="TooltipArrow",L8=T.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=Kw(n);return BJ(F8,n).isInside?null:m.jsx(Gw,{...a,...r,ref:t})});L8.displayName=F8;function UJ(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,a,i)){case i:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function qJ(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function HJ(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function VJ(e,t){const{x:n,y:r}=e;let a=!1;for(let i=0,s=t.length-1;i<t.length;s=i++){const o=t[i],l=t[s],u=o.x,d=o.y,h=l.x,p=l.y;d>r!=p>r&&n<(h-u)*(r-d)/(p-d)+u&&(a=!a)}return a}function GJ(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),WJ(t)}function WJ(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const i=t[t.length-1],s=t[t.length-2];if((i.x-s.x)*(a.y-s.y)>=(i.y-s.y)*(a.x-s.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const i=n[n.length-1],s=n[n.length-2];if((i.x-s.x)*(a.y-s.y)>=(i.y-s.y)*(a.x-s.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var KJ=I8,ZJ=j8,YJ=O8,XJ=D8,JJ=M8,QJ=L8;function Kn({delayDuration:e=0,...t}){return m.jsx(KJ,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function Yn({...e}){return m.jsx(Kn,{children:m.jsx(ZJ,{"data-slot":"tooltip",...e})})}function Xn({...e}){return m.jsx(YJ,{"data-slot":"tooltip-trigger",...e})}function Jn({className:e,sideOffset:t=0,children:n,...r}){return m.jsx(XJ,{children:m.jsxs(JJ,{"data-slot":"tooltip-content",sideOffset:t,className:Nt("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,m.jsx(QJ,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var mS={exports:{}},A3;function eQ(){return A3||(A3=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var a=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,s={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function S(E){return E instanceof l?new l(E.type,S(E.content),E.alias):Array.isArray(E)?E.map(S):E.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(S){return Object.prototype.toString.call(S).slice(8,-1)},objId:function(S){return S.__id||Object.defineProperty(S,"__id",{value:++i}),S.__id},clone:function S(E,C){C=C||{};var k,R;switch(o.util.type(E)){case"Object":if(R=o.util.objId(E),C[R])return C[R];k={},C[R]=k;for(var O in E)E.hasOwnProperty(O)&&(k[O]=S(E[O],C));return k;case"Array":return R=o.util.objId(E),C[R]?C[R]:(k=[],C[R]=k,E.forEach(function(j,$){k[$]=S(j,C)}),k);default:return E}},getLanguage:function(S){for(;S;){var E=a.exec(S.className);if(E)return E[1].toLowerCase();S=S.parentElement}return"none"},setLanguage:function(S,E){S.className=S.className.replace(RegExp(a,"gi"),""),S.classList.add("language-"+E)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(k){var S=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(k.stack)||[])[1];if(S){var E=document.getElementsByTagName("script");for(var C in E)if(E[C].src==S)return E[C]}return null}},isActive:function(S,E,C){for(var k="no-"+E;S;){var R=S.classList;if(R.contains(E))return!0;if(R.contains(k))return!1;S=S.parentElement}return!!C}},languages:{plain:s,plaintext:s,text:s,txt:s,extend:function(S,E){var C=o.util.clone(o.languages[S]);for(var k in E)C[k]=E[k];return C},insertBefore:function(S,E,C,k){k=k||o.languages;var R=k[S],O={};for(var j in R)if(R.hasOwnProperty(j)){if(j==E)for(var $ in C)C.hasOwnProperty($)&&(O[$]=C[$]);C.hasOwnProperty(j)||(O[j]=R[j])}var L=k[S];return k[S]=O,o.languages.DFS(o.languages,function(X,F){F===L&&X!=S&&(this[X]=O)}),O},DFS:function S(E,C,k,R){R=R||{};var O=o.util.objId;for(var j in E)if(E.hasOwnProperty(j)){C.call(E,j,E[j],k||j);var $=E[j],L=o.util.type($);L==="Object"&&!R[O($)]?(R[O($)]=!0,S($,C,null,R)):L==="Array"&&!R[O($)]&&(R[O($)]=!0,S($,C,j,R))}}},plugins:{},highlightAll:function(S,E){o.highlightAllUnder(document,S,E)},highlightAllUnder:function(S,E,C){var k={callback:C,container:S,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",k),k.elements=Array.prototype.slice.apply(k.container.querySelectorAll(k.selector)),o.hooks.run("before-all-elements-highlight",k);for(var R=0,O;O=k.elements[R++];)o.highlightElement(O,E===!0,k.callback)},highlightElement:function(S,E,C){var k=o.util.getLanguage(S),R=o.languages[k];o.util.setLanguage(S,k);var O=S.parentElement;O&&O.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(O,k);var j=S.textContent,$={element:S,language:k,grammar:R,code:j};function L(F){$.highlightedCode=F,o.hooks.run("before-insert",$),$.element.innerHTML=$.highlightedCode,o.hooks.run("after-highlight",$),o.hooks.run("complete",$),C&&C.call($.element)}if(o.hooks.run("before-sanity-check",$),O=$.element.parentElement,O&&O.nodeName.toLowerCase()==="pre"&&!O.hasAttribute("tabindex")&&O.setAttribute("tabindex","0"),!$.code){o.hooks.run("complete",$),C&&C.call($.element);return}if(o.hooks.run("before-highlight",$),!$.grammar){L(o.util.encode($.code));return}if(E&&r.Worker){var X=new Worker(o.filename);X.onmessage=function(F){L(F.data)},X.postMessage(JSON.stringify({language:$.language,code:$.code,immediateClose:!0}))}else L(o.highlight($.code,$.grammar,$.language))},highlight:function(S,E,C){var k={code:S,grammar:E,language:C};if(o.hooks.run("before-tokenize",k),!k.grammar)throw new Error('The language "'+k.language+'" has no grammar.');return k.tokens=o.tokenize(k.code,k.grammar),o.hooks.run("after-tokenize",k),l.stringify(o.util.encode(k.tokens),k.language)},tokenize:function(S,E){var C=E.rest;if(C){for(var k in C)E[k]=C[k];delete E.rest}var R=new h;return p(R,R.head,S),d(S,R,E,R.head,0),v(R)},hooks:{all:{},add:function(S,E){var C=o.hooks.all;C[S]=C[S]||[],C[S].push(E)},run:function(S,E){var C=o.hooks.all[S];if(!(!C||!C.length))for(var k=0,R;R=C[k++];)R(E)}},Token:l};r.Prism=o;function l(S,E,C,k){this.type=S,this.content=E,this.alias=C,this.length=(k||"").length|0}l.stringify=function S(E,C){if(typeof E=="string")return E;if(Array.isArray(E)){var k="";return E.forEach(function(L){k+=S(L,C)}),k}var R={type:E.type,content:S(E.content,C),tag:"span",classes:["token",E.type],attributes:{},language:C},O=E.alias;O&&(Array.isArray(O)?Array.prototype.push.apply(R.classes,O):R.classes.push(O)),o.hooks.run("wrap",R);var j="";for(var $ in R.attributes)j+=" "+$+'="'+(R.attributes[$]||"").replace(/"/g,"&quot;")+'"';return"<"+R.tag+' class="'+R.classes.join(" ")+'"'+j+">"+R.content+"</"+R.tag+">"};function u(S,E,C,k){S.lastIndex=E;var R=S.exec(C);if(R&&k&&R[1]){var O=R[1].length;R.index+=O,R[0]=R[0].slice(O)}return R}function d(S,E,C,k,R,O){for(var j in C)if(!(!C.hasOwnProperty(j)||!C[j])){var $=C[j];$=Array.isArray($)?$:[$];for(var L=0;L<$.length;++L){if(O&&O.cause==j+","+L)return;var X=$[L],F=X.inside,K=!!X.lookbehind,q=!!X.greedy,de=X.alias;if(q&&!X.pattern.global){var re=X.pattern.toString().match(/[imsuy]*$/)[0];X.pattern=RegExp(X.pattern.source,re+"g")}for(var Y=X.pattern||X,Q=k.next,ae=R;Q!==E.tail&&!(O&&ae>=O.reach);ae+=Q.value.length,Q=Q.next){var B=Q.value;if(E.length>S.length)return;if(!(B instanceof l)){var J=1,ee;if(q){if(ee=u(Y,ae,S,K),!ee||ee.index>=S.length)break;var Pe=ee.index,oe=ee.index+ee[0].length,me=ae;for(me+=Q.value.length;Pe>=me;)Q=Q.next,me+=Q.value.length;if(me-=Q.value.length,ae=me,Q.value instanceof l)continue;for(var xe=Q;xe!==E.tail&&(me<oe||typeof xe.value=="string");xe=xe.next)J++,me+=xe.value.length;J--,B=S.slice(ae,me),ee.index-=ae}else if(ee=u(Y,0,B,K),!ee)continue;var Pe=ee.index,Ne=ee[0],Re=B.slice(0,Pe),ke=B.slice(Pe+Ne.length),Fe=ae+B.length;O&&Fe>O.reach&&(O.reach=Fe);var Qe=Q.prev;Re&&(Qe=p(E,Qe,Re),ae+=Re.length),y(E,Qe,J);var Le=new l(j,F?o.tokenize(Ne,F):Ne,de,Ne);if(Q=p(E,Qe,Le),ke&&p(E,Q,ke),J>1){var Ie={cause:j+","+L,reach:Fe};d(S,E,C,Q.prev,ae,Ie),O&&Ie.reach>O.reach&&(O.reach=Ie.reach)}}}}}}function h(){var S={value:null,prev:null,next:null},E={value:null,prev:S,next:null};S.next=E,this.head=S,this.tail=E,this.length=0}function p(S,E,C){var k=E.next,R={value:C,prev:E,next:k};return E.next=R,k.prev=R,S.length++,R}function y(S,E,C){for(var k=E.next,R=0;R<C&&k!==S.tail;R++)k=k.next;E.next=k,k.prev=E,S.length-=R}function v(S){for(var E=[],C=S.head.next;C!==S.tail;)E.push(C.value),C=C.next;return E}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(S){var E=JSON.parse(S.data),C=E.language,k=E.code,R=E.immediateClose;r.postMessage(o.highlight(k,o.languages[C],C)),R&&r.close()},!1)),o;var b=o.util.currentScript();b&&(o.filename=b.src,b.hasAttribute("data-manual")&&(o.manual=!0));function w(){o.manual||o.highlightAll()}if(!o.manual){var x=document.readyState;x==="loading"||x==="interactive"&&b&&b.defer?document.addEventListener("DOMContentLoaded",w):window.requestAnimationFrame?window.requestAnimationFrame(w):window.setTimeout(w,16)}return o}(t);e.exports&&(e.exports=n),typeof wd<"u"&&(wd.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(a,i){var s={};s["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},s.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:s}};o["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[a]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return a}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,a){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[a,"language-"+a],inside:n.languages[a]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var a=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+a.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+a.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+a.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+a.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:a,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var i=r.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",a=function(b,w){return" Error "+b+" while fetching file: "+w},i=" Error: File does not exist or is empty",s={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",u="loaded",d="failed",h="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+l+'"])';function p(b,w,x){var S=new XMLHttpRequest;S.open("GET",b,!0),S.onreadystatechange=function(){S.readyState==4&&(S.status<400&&S.responseText?w(S.responseText):S.status>=400?x(a(S.status,S.statusText)):x(i))},S.send(null)}function y(b){var w=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(b||"");if(w){var x=Number(w[1]),S=w[2],E=w[3];return S?E?[x,Number(E)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(b){b.selector+=", "+h}),n.hooks.add("before-sanity-check",function(b){var w=b.element;if(w.matches(h)){b.code="",w.setAttribute(o,l);var x=w.appendChild(document.createElement("CODE"));x.textContent=r;var S=w.getAttribute("data-src"),E=b.language;if(E==="none"){var C=(/\.(\w+)$/.exec(S)||[,"none"])[1];E=s[C]||C}n.util.setLanguage(x,E),n.util.setLanguage(w,E);var k=n.plugins.autoloader;k&&k.loadLanguages(E),p(S,function(R){w.setAttribute(o,u);var O=y(w.getAttribute("data-range"));if(O){var j=R.split(/\r\n?|\n/g),$=O[0],L=O[1]==null?j.length:O[1];$<0&&($+=j.length),$=Math.max(0,Math.min($-1,j.length)),L<0&&(L+=j.length),L=Math.max(0,Math.min(L,j.length)),R=j.slice($,L).join(`
`),w.hasAttribute("data-start")||w.setAttribute("data-start",String($+1))}x.textContent=R,n.highlightElement(x)},function(R){w.setAttribute(o,d),x.textContent=R})}}),n.plugins.fileHighlight={highlight:function(w){for(var x=(w||document).querySelectorAll(h),S=0,E;E=x[S++];)n.highlightElement(E)}};var v=!1;n.fileHighlight=function(){v||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),v=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(mS)),mS.exports}var tQ=eQ();const nQ=di(tQ);var N3={},R3;function rQ(){return R3||(R3=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),N3}rQ();var I3={},j3;function aQ(){return j3||(j3=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),I3}aQ();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var a=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=r.variable[1].inside,s=0;s<a.length;s++)i[a[s]]=e.languages.bash[a[s]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(d){return d=d.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+d+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,a=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+a+i+"(?:"+a+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+a+i+")(?:"+a+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+a+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+a+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(d){["url","bold","italic","strike","code-snippet"].forEach(function(h){d!==h&&(e.languages.markdown[d].inside.content.inside[h]=e.languages.markdown[h])})}),e.hooks.add("after-tokenize",function(d){if(d.language!=="markdown"&&d.language!=="md")return;function h(p){if(!(!p||typeof p=="string"))for(var y=0,v=p.length;y<v;y++){var b=p[y];if(b.type!=="code"){h(b.content);continue}var w=b.content[1],x=b.content[3];if(w&&x&&w.type==="code-language"&&x.type==="code-block"&&typeof w.content=="string"){var S=w.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");S=(/[a-z][\w-]*/i.exec(S)||[""])[0].toLowerCase();var E="language-"+S;x.alias?typeof x.alias=="string"?x.alias=[x.alias,E]:x.alias.push(E):x.alias=[E]}}}h(d.tokens)}),e.hooks.add("wrap",function(d){if(d.type==="code-block"){for(var h="",p=0,y=d.classes.length;p<y;p++){var v=d.classes[p],b=/language-(.+)/.exec(v);if(b){h=b[1];break}}var w=e.languages[h];if(w)d.content=e.highlight(u(d.content),w,h);else if(h&&h!=="none"&&e.plugins.autoloader){var x="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);d.attributes.id=x,e.plugins.autoloader.loadLanguages(h,function(){var S=document.getElementById(x);S&&(S.innerHTML=e.highlight(S.textContent,e.languages[h],h))})}}});var s=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function u(d){var h=d.replace(s,"");return h=h.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(p,y){if(y=y.toLowerCase(),y[0]==="#"){var v;return y[1]==="x"?v=parseInt(y.slice(2),16):v=Number(y.slice(1)),l(v)}else{var b=o[y];return b||p}}),h}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],a=[];/^\w+$/.test(n)||a.push(/\w+/.exec(n)[0]),n==="diff"&&a.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:a,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",a=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),i=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function s(o,l){l=(l||"").replace(/m/g,"")+"m";var u=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(u,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+a+"|"+i+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:s(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:s(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:s(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:s(i),lookbehind:!0,greedy:!0},number:{pattern:s(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var O3={},D3;function iQ(){return D3||(D3=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),O3}iQ();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const M3="prism-theme-link",gS="prism-default-light-theme-link",yS="prism-default-dark-theme-link",sQ="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.5.0/prism-material-light.min.css",oQ="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.5.0/prism-coldark-dark.min.css",P3=e=>e.replace("github.com","raw.githubusercontent.com").replace("/blob/","/"),lQ=({lang:e,code:t,isStreaming:n=!1})=>{const{prismThemeUrl:r,theme:a,foldStreamingCodeBlocks:i}=qr(dn(S=>({prismThemeUrl:S.prismThemeUrl,theme:S.theme,foldStreamingCodeBlocks:S.foldStreamingCodeBlocks}))),[s,o]=T.useState(!1),[l,u]=T.useState(n?i:!1),d=T.useRef(null),h=T.useMemo(()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),p=a==="system"?h:a;T.useEffect(()=>{const S=(C,k)=>{const R=document.getElementById(k);if(R)R.href!==C&&(R.href=C);else{const O=document.createElement("link");O.id=k,O.rel="stylesheet",O.href=C,document.head.appendChild(O)}},E=C=>{const k=document.getElementById(C);k&&k.remove()};r?(S(r,M3),E(gS),E(yS)):(E(M3),p==="dark"?(S(P3(oQ),yS),E(gS)):(S(P3(sQ),gS),E(yS)))},[r,p]);const y=T.useCallback(()=>{if(d.current&&t)try{d.current.style.whiteSpace!=="pre-wrap"&&(d.current.style.whiteSpace="pre-wrap"),d.current.textContent=t,nQ.highlightElement(d.current)}catch(S){console.error("Prism highlight error:",S),d.current.textContent=t}else d.current&&(d.current.textContent="")},[t]);T.useEffect(()=>{l||y()},[t,e,l,y]);const v=async()=>{try{await navigator.clipboard.writeText(t),o(!0),tt.success("Code copied to clipboard!"),setTimeout(()=>o(!1),1500)}catch(S){tt.error("Failed to copy code."),console.error("Clipboard copy failed:",S)}},b=()=>{const S=l;u(E=>!E),S&&setTimeout(y,0)},w=e?`language-${e}`:"language-plaintext",x=T.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]);return m.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[m.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),m.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:b,"aria-label":l?"Unfold code":"Fold code",children:m.jsx(kw,{className:"h-3.5 w-3.5"})})}),m.jsx(Jn,{side:"top",children:l?"Unfold":"Fold"})]})}),m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:v,"aria-label":"Copy code",children:s?m.jsx(so,{className:"h-3.5 w-3.5 text-green-500"}):m.jsx(zC,{className:"h-3.5 w-3.5"})})}),m.jsx(Jn,{side:"top",children:"Copy"})]})})]})]}),m.jsx("div",{})]}),!l&&m.jsx("div",{className:"overflow-hidden w-full",children:m.jsx("pre",{className:"overflow-x-auto w-full relative break-words",children:m.jsx("code",{ref:d,className:w+" block"})})}),l&&m.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:b,children:m.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:x})})]})},p0=T.memo(lQ);var lt;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(lt||(lt={}));const F3={[lt.EPERM]:"Operation not permitted",[lt.ENOENT]:"No such file or directory",[lt.EINTR]:"Interrupted system call",[lt.EIO]:"Input/output error",[lt.ENXIO]:"No such device or address",[lt.EBADF]:"Bad file descriptor",[lt.EAGAIN]:"Resource temporarily unavailable",[lt.ENOMEM]:"Cannot allocate memory",[lt.EACCES]:"Permission denied",[lt.EFAULT]:"Bad address",[lt.ENOTBLK]:"Block device required",[lt.EBUSY]:"Resource busy or locked",[lt.EEXIST]:"File exists",[lt.EXDEV]:"Invalid cross-device link",[lt.ENODEV]:"No such device",[lt.ENOTDIR]:"File is not a directory",[lt.EISDIR]:"File is a directory",[lt.EINVAL]:"Invalid argument",[lt.ENFILE]:"Too many open files in system",[lt.EMFILE]:"Too many open files",[lt.ETXTBSY]:"Text file busy",[lt.EFBIG]:"File is too big",[lt.ENOSPC]:"No space left on disk",[lt.ESPIPE]:"Illegal seek",[lt.EROFS]:"Cannot modify a read-only file system",[lt.EMLINK]:"Too many links",[lt.EPIPE]:"Broken pipe",[lt.EDOM]:"Numerical argument out of domain",[lt.ERANGE]:"Numerical result out of range",[lt.EDEADLK]:"Resource deadlock would occur",[lt.ENAMETOOLONG]:"File name too long",[lt.ENOLCK]:"No locks available",[lt.ENOSYS]:"Function not implemented",[lt.ENOTEMPTY]:"Directory is not empty",[lt.ELOOP]:"Too many levels of symbolic links",[lt.ENOMSG]:"No message of desired type",[lt.EBADE]:"Invalid exchange",[lt.EBADR]:"Invalid request descriptor",[lt.EXFULL]:"Exchange full",[lt.ENOANO]:"No anode",[lt.EBADRQC]:"Invalid request code",[lt.ENOSTR]:"Device not a stream",[lt.ENODATA]:"No data available",[lt.ETIME]:"Timer expired",[lt.ENOSR]:"Out of streams resources",[lt.ENONET]:"Machine is not on the network",[lt.EREMOTE]:"Object is remote",[lt.ENOLINK]:"Link has been severed",[lt.ECOMM]:"Communication error on send",[lt.EPROTO]:"Protocol error",[lt.EBADMSG]:"Bad message",[lt.EOVERFLOW]:"Value too large for defined data type",[lt.EBADFD]:"File descriptor in bad state",[lt.ESTRPIPE]:"Streams pipe error",[lt.ENOTSOCK]:"Socket operation on non-socket",[lt.EDESTADDRREQ]:"Destination address required",[lt.EMSGSIZE]:"Message too long",[lt.EPROTOTYPE]:"Protocol wrong type for socket",[lt.ENOPROTOOPT]:"Protocol not available",[lt.EPROTONOSUPPORT]:"Protocol not supported",[lt.ESOCKTNOSUPPORT]:"Socket type not supported",[lt.ENOTSUP]:"Operation is not supported",[lt.ENETDOWN]:"Network is down",[lt.ENETUNREACH]:"Network is unreachable",[lt.ENETRESET]:"Network dropped connection on reset",[lt.ETIMEDOUT]:"Connection timed out",[lt.ECONNREFUSED]:"Connection refused",[lt.EHOSTDOWN]:"Host is down",[lt.EHOSTUNREACH]:"No route to host",[lt.EALREADY]:"Operation already in progress",[lt.EINPROGRESS]:"Operation now in progress",[lt.ESTALE]:"Stale file handle",[lt.EREMOTEIO]:"Remote I/O error",[lt.EDQUOT]:"Disk quota exceeded"};class Ue extends Error{static fromJSON(t){const n=new Ue(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Ue(lt[t],F3[lt[t]],n,r)}constructor(t,n=F3[t],r,a=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=a,this.code=lt[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var bS={exports:{}},L3;function cQ(){return L3||(L3=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function i(l,u,d,h,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var y=new a(d,h||l,p),v=n?n+u:u;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],y]:l._events[v].push(y):(l._events[v]=y,l._eventsCount++),l}function s(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=n?n+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,y=h.length,v=new Array(y);p<y;p++)v[p]=h[p].fn;return v},o.prototype.listenerCount=function(u){var d=n?n+u:u,h=this._events[d];return h?h.fn?1:h.length:0},o.prototype.emit=function(u,d,h,p,y,v){var b=n?n+u:u;if(!this._events[b])return!1;var w=this._events[b],x=arguments.length,S,E;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),x){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,d),!0;case 3:return w.fn.call(w.context,d,h),!0;case 4:return w.fn.call(w.context,d,h,p),!0;case 5:return w.fn.call(w.context,d,h,p,y),!0;case 6:return w.fn.call(w.context,d,h,p,y,v),!0}for(E=1,S=new Array(x-1);E<x;E++)S[E-1]=arguments[E];w.fn.apply(w.context,S)}else{var C=w.length,k;for(E=0;E<C;E++)switch(w[E].once&&this.removeListener(u,w[E].fn,void 0,!0),x){case 1:w[E].fn.call(w[E].context);break;case 2:w[E].fn.call(w[E].context,d);break;case 3:w[E].fn.call(w[E].context,d,h);break;case 4:w[E].fn.call(w[E].context,d,h,p);break;default:if(!S)for(k=1,S=new Array(x-1);k<x;k++)S[k-1]=arguments[k];w[E].fn.apply(w[E].context,S)}}return!0},o.prototype.on=function(u,d,h){return i(this,u,d,h,!1)},o.prototype.once=function(u,d,h){return i(this,u,d,h,!0)},o.prototype.removeListener=function(u,d,h,p){var y=n?n+u:u;if(!this._events[y])return this;if(!d)return s(this,y),this;var v=this._events[y];if(v.fn)v.fn===d&&(!p||v.once)&&(!h||v.context===h)&&s(this,y);else{for(var b=0,w=[],x=v.length;b<x;b++)(v[b].fn!==d||p&&!v[b].once||h&&v[b].context!==h)&&w.push(v[b]);w.length?this._events[y]=w.length===1?w[0]:w:s(this,y)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=n?n+u:u,this._events[d]&&s(this,d)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(bS)),bS.exports}var uQ=cQ();const gk=di(uQ);var QO;let dQ=class extends gk{constructor(n){super();Oa(this,QO,"List");Oa(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,a=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const i=Array.from(this.data);i.splice(n,+a,r),this.data=new Set(i),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...a){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const i=Array.from(this.data),s=i.splice(n,r,...a);return this.data=new Set(i),this.emit("update"),s}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(QO=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function $3(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function yr(e){throw e}const B3=Intl.NumberFormat("en",{notation:"compact"});B3.format.bind(B3);function Kd(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function fQ(e){try{return JSON.parse(e),!0}catch{return!1}}function G2(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function yk(e){return e.at(0).toUpperCase()+e.slice(1)}const hQ=new TextEncoder;function bd(e){return hQ.encode(e)}const z3=new TextDecoder;function bk(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return z3.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),z3.decode(t)}function xg(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=xg(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function pQ(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var mQ={};let gQ="process"in globalThis&&"env"in globalThis.process&&mQ.U_DEBUG=="true";function _g(...e){gQ&&console.debug("[U]",...e)}const U3=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],yQ=[...U3,...U3.map(e=>yk(e)),"char"],vk=/^(u?int|float)(8|16|32|64|128)$/i;function $8(e){return e=="char"?"uint8":e.toLowerCase()}function wk(e){return vk.test(e.toString())}function W2(e){return e=="char"||vk.test(e.toString().toLowerCase())}function bQ(e){if(!W2(e))throw new TypeError("Not a valid primitive type: "+e)}const q3=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function B8(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function vQ(e){return e!=null&&typeof e=="object"&&"struct"in e}function Zw(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function Zs(e){return typeof e=="function"&&Symbol.metadata in e&&vQ(e[Symbol.metadata])}function m0(e){return e!=null&&typeof e=="object"&&Zs(e.constructor)}function z8(e){if(!m0(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function xk(e){return m0(e)||Zs(e)}function U8(e){if(!xk(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function _k(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function Ur(e){if(e==null)return 0;if(Array.isArray(e)){let a=0;for(let i=0;i<e.length;i++)a+=Ur(e[i]);return a}if(typeof e=="string")return bQ(e),+$8(e).match(vk)[2]/8;if(_k(e))return e[Symbol.size];U8(e);const t=Zs(e)?e:e.constructor;Zw(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(Zs(e))return r;for(const a of n.members.values()){const i=e[a.name];if(m0(i)&&i.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,Ur(i)):r+=Ur(i);continue}if(typeof a.length!="string")continue;let s=0;for(let o=0;o<e[a.length];o++)s+=Ur(xk(i[o])?i[o]:a.type);n.isUnion?r=Math.max(r,s):r+=s}return r}function wQ(e,t){var i;U8(e);const n=Zs(e)?e:e.constructor;Zw(n);const{struct:r}=n[Symbol.metadata];if(Zs(e)||!r.isDynamic)return((i=r.members.get(t))==null?void 0:i.staticOffset)??yr(new Error("Struct does not have member: "+t));let a=0;for(const s of r.members.values()){if(s.name==t)return a;const o=e[s.name];a+=Ur(xk(o)?o:s.type)}throw new Error("Struct does not have member: "+t)}function xQ(e,t){return Math.ceil(e/t)*t}function Zd(e={}){return function(n,r){const a=new Map;let i=0,s=!1;for(const{name:o,type:l,length:u}of B8(r)){if(!W2(l)&&!Zs(l))throw new TypeError("Not a valid type: "+l);if(typeof u=="string"){const p=a.get(u);if(!p)throw new Error(`"${u}" is undefined or declared after "${o}"`);if(!wk(p.type))throw new Error(`"${u}" is not a number and cannot be used to count "${o}"`)}let d=`${typeof l=="string"?l:l.name} ${o}`;u!==void 0&&(d+=`[${u}]`),a.set(o,{name:o,staticOffset:e.isUnion?0:i,type:W2(l)?$8(l):l,length:u,decl:d});const h=typeof u=="string"||Zs(l)&&l[Symbol.metadata].struct.isDynamic?0:Ur(l)*(u||1);s||(s=Zs(l)?l[Symbol.metadata].struct.isDynamic:typeof u=="string"),i=e.isUnion?Math.max(i,h):i+h,i=xQ(i,e.align||1),_g("define",n.name+"."+o)}return r.metadata.struct={options:e,members:a,staticSize:i,isDynamic:s,isUnion:e.isUnion??!1},n}}function Sg(e,t){return function(n,r){let a=r.name;if(typeof a=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+a.toString()),a=a.toString()),!a)throw new ReferenceError("Invalid name for struct member");return B8(r).push({name:a,type:e,length:t}),n}}function q8(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:yr(new Error("Array lengths must be natural numbers"))}function Ka(e){if(_k(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();z8(e),Zw(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=Ur(e),a=new Uint8Array(r),i=new DataView(a.buffer);_g("serialize",e.constructor.name);let s=0,o=0;for(const l of n.values()){const u=q8(e,l);_g("	",l.decl);for(let d=0;d<Math.abs(u);d++){let h=u!=-1?e[l.name][d]:e[l.name];if(typeof h=="string"&&(h=h.charCodeAt(0)),s=o,o+=m0(h)?Ur(h):Ur(l.type),!wk(l.type)){a.set(h?Ka(h):new Uint8Array(Ur(l.type)),s);continue}const p=`set${yk(l.type)}`;if(p=="setInt64"){i.setBigInt64(s,BigInt(h),!t.bigEndian);continue}if(p=="setUint64"){i.setBigUint64(s,BigInt(h),!t.bigEndian);continue}if(p=="setInt128"){i.setBigUint64(s+(t.bigEndian?8:0),h&q3,!t.bigEndian),i.setBigInt64(s+(t.bigEndian?0:8),h>>BigInt(64),!t.bigEndian);continue}if(p=="setUint128"){i.setBigUint64(s+(t.bigEndian?8:0),h&q3,!t.bigEndian),i.setBigUint64(s+(t.bigEndian?0:8),h>>BigInt(64),!t.bigEndian);continue}if(p=="setFloat128"){i.setFloat64(s+(t.bigEndian?8:0),Number(h),!t.bigEndian),i.setBigUint64(s+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}i[p](s,Number(h),!t.bigEndian)}}return a}function Yw(e,t){const n=pQ(t);if(_k(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);z8(e),Zw(e.constructor);const{options:r,members:a}=e.constructor[Symbol.metadata].struct,i=new DataView(n.buffer,n.byteOffset,n.byteLength);_g("deserialize",e.constructor.name);let s=0,o=0;for(const l of a.values()){const u=q8(e,l);_g("	",l.decl);for(let d=0;d<Math.abs(u);d++){let h=u!=-1?e[l.name]:e;const p=u!=-1?d:l.name,y=h[p]===null||h[p]===void 0,v=y&&Zs(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(s=o,!m0(h[p])&&!v&&(o+=Ur(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,d)+String.fromCharCode(i.getUint8(s))+e[l.name].slice(d+1);continue}if(!wk(l.type)){if(v&&Zs(l.type))h[p]??(h[p]=new l.type);else if(y)continue;Yw(h[p],new Uint8Array(n.subarray(s))),o+=Ur(h[p]);continue}u&&u!=-1&&(h||(h=[]));const b=`get${yk(l.type)}`;if(b=="getInt64"){h[p]=i.getBigInt64(s,!r.bigEndian);continue}if(b=="getUint64"){h[p]=i.getBigUint64(s,!r.bigEndian);continue}if(b=="getInt128"){h[p]=i.getBigInt64(s+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(s+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getUint128"){h[p]=i.getBigUint64(s+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(s+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getFloat128"){h[p]=i.getFloat64(s+(r.bigEndian?8:0),!r.bigEndian);continue}h[p]=i[b](s,!r.bigEndian)}}}function _Q(e){function t(n,r){return typeof n=="number"||typeof n=="string"?Sg(e,n):Sg(e)(n,r)}return t}const xn=Object.fromEntries(yQ.map(e=>[e,_Q(e)]));function SQ(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const lo={root:"/",pwd:"/",credentials:SQ({uid:0,gid:0}),descriptors:new Map};function H8(e,t){let n="",r=0,a=-1,i=0,s="\0";for(let o=0;o<=e.length;++o){if(o<e.length)s=e[o];else{if(s=="/")break;s="/"}if(s=="/"){if(!(a===o-1||i===1))if(i===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),a=o,i=0;continue}else if(n.length!==0){n="",r=0,a=o,i=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(a+1,o):n=e.slice(a+1,o),r=o-a-1;a=o,i=0}else s==="."&&i!==-1?++i:i=-1}return n}function Gl(...e){var t;let n="";for(const a of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:lo.pwd])if(a!=null&&a.length&&(n=`${a}/${n}`,a.startsWith("/")))break;const r=n.startsWith("/");return n=H8(n,!r),r?`/${n}`:n.length?n:"/"}function EQ(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=H8(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function cr(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?EQ(t):"."}function V8(e,t){if(e===t||(e=Gl.call(this,e),t=Gl.call(this,t),e===t))return"";const n=1,r=e.length,a=r-n,i=1,s=t.length-i,o=a<s?a:s;let l=-1,u=0;for(;u<o;u++){const h=e[n+u];if(h!==t[i+u])break;h==="/"&&(l=u)}if(u===o)if(s>o){if(t[i+u]==="/")return t.slice(i+u+1);if(u===0)return t.slice(i+u)}else a>o&&(e[n+u]==="/"?l=u:u===0&&(l=0));let d="";for(u=n+l+1;u<=r;++u)(u===r||e[u]==="/")&&(d+=d.length===0?"..":"/..");return`${d}${t.slice(i+l)}`}function ir(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let a=e.length-1;a>=1;--a)if(e[a]==="/"){if(!r){n=a;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function Mh(e,t){let n=0,r=-1,a=!0;for(let i=e.length-1;i>=0;--i)if(e[i]==="/"){if(!a){n=i+1;break}}else r===-1&&(a=!1,r=i+1);return r===-1?"":e.slice(n,r)}function jo(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let a=-1,i=0,s=-1,o=!0,l=e.length-1,u=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){i=l+1;break}continue}s===-1&&(o=!1,s=l+1),e[l]==="."?a===-1?a=l:u!==1&&(u=1):a!==-1&&(u=-1)}if(s!==-1){const d=i===0&&t?1:i;a===-1||u===0||u===1&&a===s-1&&a===i+1?n.base=n.name=e.slice(d,s):(n.name=e.slice(d,a),n.base=e.slice(d,s),n.ext=e.slice(a,s))}return i>0?n.dir=e.slice(0,i-1):t&&(n.dir="/"),n}var vn;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(vn||(vn={}));vn.EMERG+"",vn.ALERT+"",vn.CRIT+"",vn.ERR+"",vn.WARN+"",vn.NOTICE+"",vn.INFO+"",vn.DEBUG+"";const CQ=new dQ;function kQ(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};CQ.add(n),DQ(n)}function TQ(e,t){var n,r;if(!(e instanceof Ue))return e.toString();const a=e.code+": "+e.message;if(!e.path)return a;const i=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return a+": "+cr(i,e.path)}function xu(e){return function(t,n={}){return kQ(e,TQ(t,n)),t}}xu(vn.EMERG);const AQ=xu(vn.ALERT),Xw=xu(vn.CRIT),ji=xu(vn.ERR),si=xu(vn.WARN),Sk=xu(vn.NOTICE),G8=xu(vn.INFO),Zm=xu(vn.DEBUG);function NQ(e,t){return`\x1B[${t}m${e}\x1B[0m`}function RQ(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[NQ(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}vn.EMERG+"",vn.ALERT+"",vn.CRIT+"",vn.ERR+"",vn.WARN+"",vn.NOTICE+"",vn.INFO+"",vn.DEBUG+"",vn.EMERG+"",vn.ALERT+"",vn.CRIT+"",vn.ERR+"",vn.WARN+"",vn.NOTICE+"",vn.INFO+"",vn.DEBUG+"";vn.EMERG+"",vn.ALERT+"",vn.CRIT+"",vn.ERR+"",vn.WARN+"",vn.NOTICE+"",vn.INFO+"",vn.DEBUG+"",vn.EMERG+"",vn.ALERT+"",vn.CRIT+"",vn.ERR+"",vn.WARN+"",vn.NOTICE+"",vn.INFO+"",vn.DEBUG+"";let IQ=e=>[...RQ(e),e.message];function jQ(e){const t=IQ(e);return typeof t=="string"?[t]:Array.from(t)}let OQ=console.error;function DQ(e){e.level>MQ||OQ(...jQ(e))}let MQ=vn.ALERT;function Ek(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function PQ(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function FQ(e,t){if(typeof t!="object"||t===null)throw ji(new Ue(lt.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const a=t==null?void 0:t[n];if(a==null){if(!r.required){Zm("Using default for option: "+n);continue}throw ji(new Ue(lt.EINVAL,"Missing required option: "+n))}const i=(u,d=a)=>{var h;return typeof u=="function"?Symbol.hasInstance in u&&u.prototype?a instanceof u:u(a):typeof a===u||((h=a==null?void 0:a.constructor)===null||h===void 0?void 0:h.name)===u};if(Array.isArray(r.type)?r.type.some(u=>i(u)):i(r.type))continue;const s=typeof a=="object"&&"constructor"in a?a.constructor.name:typeof a,o=u=>typeof u=="function"?u.name!="type"?u.name:u.toString():u,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw ji(new Ue(lt.EINVAL,`Incorrect type for "${n}": ${s} (expected ${l})`))}}function W8(e){return e!=null&&typeof e=="object"&&"backend"in e&&Ek(e.backend)}const Ck=0,Sa=4,ta=2,av=1,kk=1,LQ=2,$Q=4,K8=0,ai=1,Ll=2,Jw=64,Qw=128,BQ=256,ex=512,Pd=1024,zQ=65536,UQ=262144,qQ=131072,tx=1052672,HQ=4096,VQ=32768,GQ=16384,WQ=2048,Cr=61440,Yd=49152,ec=40960,Ys=32768,Xd=24576,ha=16384,Jd=8192,Qd=4096,g0=2048,y0=1024,KQ=512,ZQ=448,Z8=256,Y8=128,X8=64,YQ=56,J8=32,Q8=16,eP=8,XQ=7,tP=4,nP=2,rP=1,JQ=0,_i=4294967295,aP=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:kk,COPYFILE_FICLONE:LQ,COPYFILE_FICLONE_FORCE:$Q,F_OK:Ck,O_APPEND:Pd,O_CREAT:Jw,O_DIRECT:GQ,O_DIRECTORY:zQ,O_DSYNC:HQ,O_EXCL:Qw,O_NOATIME:UQ,O_NOCTTY:BQ,O_NOFOLLOW:qQ,O_NONBLOCK:WQ,O_RDONLY:K8,O_RDWR:Ll,O_SYMLINK:VQ,O_SYNC:tx,O_TRUNC:ex,O_WRONLY:ai,R_OK:Sa,S_IFBLK:Xd,S_IFCHR:Jd,S_IFDIR:ha,S_IFIFO:Qd,S_IFLNK:ec,S_IFMT:Cr,S_IFREG:Ys,S_IFSOCK:Yd,S_IRGRP:J8,S_IROTH:tP,S_IRUSR:Z8,S_IRWXG:YQ,S_IRWXO:XQ,S_IRWXU:ZQ,S_ISGID:y0,S_ISUID:g0,S_ISVTX:KQ,S_IWGRP:Q8,S_IWOTH:nP,S_IWUSR:Y8,S_IXGRP:eP,S_IXOTH:rP,S_IXUSR:X8,UV_FS_O_FILEMAP:JQ,W_OK:ta,X_OK:av,size_max:_i},Symbol.toStringTag,{value:"Module"})),Ab=BigInt(1e3);class iP{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:a,uid:i,gid:s,size:o,mode:l,ino:u,...d}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const h=Date.now();this.atimeMs=this._convert(t??h),this.mtimeMs=this._convert(n??h),this.ctimeMs=this._convert(r??h),this.birthtimeMs=this._convert(a??h),this.uid=this._convert(i??0),this.gid=this._convert(s??0),this.size=this._convert(o??0),this.ino=this._convert(u??0),this.mode=this._convert(l??420&Ys),(this.mode&Cr)==0&&(this.mode=this.mode|this._convert(Ys)),Object.assign(this,d)}isFile(){return(this.mode&Cr)===Ys}isDirectory(){return(this.mode&Cr)===ha}isSymbolicLink(){return(this.mode&Cr)===ec}isSocket(){return(this.mode&Cr)===Yd}isBlockDevice(){return(this.mode&Cr)===Xd}isCharacterDevice(){return(this.mode&Cr)===Jd}isFIFO(){return(this.mode&Cr)===Qd}toJSON(){return Kd(this,K2)}hasAccess(t,n){return hr(n,this._isBigint?new tc(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*Ab}get mtimeNs(){return BigInt(this.mtimeMs)*Ab}get ctimeNs(){return BigInt(this.ctimeMs)*Ab}get birthtimeNs(){return BigInt(this.birthtimeMs)*Ab}}function sP(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<_i?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<_i?e.gid=n:r=!1,r}class tc extends iP{constructor(){super(...arguments),this._isBigint=!1}}class ef extends iP{constructor(){super(...arguments),this._isBigint=!0}}function QQ(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class eee{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=_i,this.ffree=_i}}class tee{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(_i),this.ffree=BigInt(_i)}}var Or=function(e,t,n,r,a,i){function s(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",u=!t&&e?r.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),h,p=!1,y=n.length-1;y>=0;y--){var v={};for(var b in r)v[b]=b==="access"?{}:r[b];for(var b in r.access)v.access[b]=r.access[b];v.addInitializer=function(x){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(x||null))};var w=(0,n[y])(o==="accessor"?{get:d.get,set:d.set}:d[l],v);if(o==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(h=s(w.get))&&(d.get=h),(h=s(w.set))&&(d.set=h),(h=s(w.init))&&a.unshift(h)}else(h=s(w))&&(o==="field"?a.unshift(h):d[l]=h)}u&&Object.defineProperty(u,r.name,d),p=!0},bn=function(e,t,n){for(var r=arguments.length>2,a=0;a<t.length;a++)n=r?t[a].call(e,n):t[a].call(e);return r?n:void 0},Tk=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const Zi=0,nee=1024;let H3=(()=>{var e,t;let n=[Zd()],r,a=[],i,s,o=[],l=[],u,d=[],h=[],p,y=[],v=[],b,w=[],x=[];return i=class{get key(){return this._key}set key(S){this._key=S,this.keySize=S.length}get value(){return this._value.subarray(0,this.valueSize)}set value(S){this._value=S,this.valueSize=S.length}constructor(S,E){this.keySize=bn(this,o,0),this.valueSize=(bn(this,l),bn(this,d,0)),this._key=(bn(this,h),bn(this,y,"")),this._value=(bn(this,v),bn(this,w,new Uint8Array(nee))),bn(this,x),S&&(this.key=S),E&&(this.value=E)}},Tk(i,"Attribute"),(()=>{const S=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;s=[(e=xn).uint32.bind(e)],u=[(t=xn).uint32.bind(t)],p=[xn.char("keySize")],b=[xn.uint8("valueSize")],Or(null,null,s,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:E=>"keySize"in E,get:E=>E.keySize,set:(E,C)=>{E.keySize=C}},metadata:S},o,l),Or(null,null,u,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:E=>"valueSize"in E,get:E=>E.valueSize,set:(E,C)=>{E.valueSize=C}},metadata:S},d,h),Or(null,null,p,{kind:"field",name:"_key",static:!1,private:!1,access:{has:E=>"_key"in E,get:E=>E._key,set:(E,C)=>{E._key=C}},metadata:S},y,v),Or(null,null,b,{kind:"field",name:"_value",static:!1,private:!1,access:{has:E=>"_value"in E,get:E=>E._value,set:(E,C)=>{E._value=C}},metadata:S},w,x),Or(null,r={value:i},n,{kind:"class",name:i.name,metadata:S},null,a),i=r.value,S&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:S}),bn(i,a)})(),i})(),fu=(()=>{var e;let t=[Zd()],n,r=[],a,i,s=[],o=[],l,u=[],d=[];return a=class{has(h){return this.data.some(p=>p.key==h)}get(h){return this.data.find(p=>p.key==h)}set(h,p){const y=this.get(h);if(y){y.value=p;return}this.data.push(new H3(h,p)),this.size++}remove(h){const p=this.data.findIndex(y=>y.key==h);return p===-1?!1:(this.data.splice(p,1),this.size--,!0)}keys(){return this.data.map(h=>h.key)}values(){return this.data.map(h=>h.value)}entries(){return this.data.map(h=>[h.key,h.value])}constructor(){this.size=bn(this,s,0),this.data=(bn(this,o),bn(this,u,[])),bn(this,d)}},Tk(a,"Attributes"),(()=>{const h=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[(e=xn).uint32.bind(e)],l=[Sg(H3,"size")],Or(null,null,i,{kind:"field",name:"size",static:!1,private:!1,access:{has:p=>"size"in p,get:p=>p.size,set:(p,y)=>{p.size=y}},metadata:h},s,o),Or(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:p=>"data"in p,get:p=>p.data,set:(p,y)=>{p.data=y}},metadata:h},u,d),Or(null,n={value:a},t,{kind:"class",name:a.name,metadata:h},null,r),a=n.value,h&&Object.defineProperty(a,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h}),bn(a,r)})(),a})();const K2=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],ree=4;var Oi;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})(Oi||(Oi={}));let fa=(()=>{var e,t,n,r,a,i,s,o,l,u,d,h,p,y,v,b;let w=[Zd()],x,S=[],E,C,k=[],R=[],O,j=[],$=[],L,X=[],F=[],K,q=[],de=[],re,Y=[],Q=[],ae,B=[],J=[],ee,oe=[],me=[],xe,Pe=[],Ne=[],Re,ke=[],Fe=[],Qe,Le=[],Ie=[],V,ge=[],Te=[],le,ie=[],te=[],_e,Me=[],Ee=[],We,kt=[],it=[],xt,Dt=[],Ot=[],Wt,be=[],I=[],G,fe=[],je=[],ve,Ce=[],ce=[];var ft=E=class{constructor(vt){if(this.data=bn(this,k,G2(0,_i)),this.__data_old=(bn(this,R),bn(this,j,0)),this.size=(bn(this,$),bn(this,X,0)),this.mode=(bn(this,F),bn(this,q,0)),this.nlink=(bn(this,de),bn(this,Y,1)),this.uid=(bn(this,Q),bn(this,B,0)),this.gid=(bn(this,J),bn(this,oe,0)),this.atimeMs=(bn(this,me),bn(this,Pe,Date.now())),this.birthtimeMs=(bn(this,Ne),bn(this,ke,Date.now())),this.mtimeMs=(bn(this,Fe),bn(this,Le,Date.now())),this.ctimeMs=(bn(this,Ie),bn(this,ge,Date.now())),this.ino=(bn(this,Te),bn(this,ie,G2(0,_i))),this.__ino_old=(bn(this,te),bn(this,Me,0)),this.flags=(bn(this,Ee),bn(this,kt,0)),this.__after_flags=(bn(this,it),bn(this,Dt,0)),this.version=(bn(this,Ot),bn(this,be,0)),this.__padding=(bn(this,I),bn(this,fe,[])),this.attributes=(bn(this,je),bn(this,Ce,new fu)),bn(this,ce),!!vt){if(!("byteLength"in vt)){Object.assign(this,vt);return}if(vt.byteLength<Ur(ft))throw Xw(new Ue(lt.EIO,"Buffer is too small to create an inode"));Yw(this,vt)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...Kd(this,K2),attributes:this.attributes}}toStats(){return new tc(this)}update(vt){if(!vt)return!1;let M=!1;for(const Be of K2)vt[Be]!==void 0&&(Be=="ino"||Be=="data"||this[Be]!==vt[Be]&&(Be=="atimeMs"&&this.flags&Oi.NoAtime||(this[Be]=vt[Be],M=!0)));return vt.attributes&&(this.attributes=vt.attributes,M=!0),M&&(this.ctimeMs=Date.now()),M}};return Tk(E,"Inode"),(()=>{const vt=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;C=[(e=xn).uint32.bind(e)],O=[(t=xn).uint32.bind(t)],L=[(n=xn).uint32.bind(n)],K=[(r=xn).uint16.bind(r)],re=[(a=xn).uint32.bind(a)],ae=[(i=xn).uint32.bind(i)],ee=[(s=xn).uint32.bind(s)],xe=[(o=xn).float64.bind(o)],Re=[(l=xn).float64.bind(l)],Qe=[(u=xn).float64.bind(u)],V=[(d=xn).float64.bind(d)],le=[(h=xn).uint32.bind(h)],_e=[(p=xn).uint32.bind(p)],We=[(y=xn).uint32.bind(y)],xt=[(v=xn).uint16.bind(v)],Wt=[(b=xn).uint32.bind(b)],G=[xn.uint8(48)],ve=[Sg(fu)],Or(null,null,C,{kind:"field",name:"data",static:!1,private:!1,access:{has:M=>"data"in M,get:M=>M.data,set:(M,Be)=>{M.data=Be}},metadata:vt},k,R),Or(null,null,O,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:M=>"__data_old"in M,get:M=>M.__data_old,set:(M,Be)=>{M.__data_old=Be}},metadata:vt},j,$),Or(null,null,L,{kind:"field",name:"size",static:!1,private:!1,access:{has:M=>"size"in M,get:M=>M.size,set:(M,Be)=>{M.size=Be}},metadata:vt},X,F),Or(null,null,K,{kind:"field",name:"mode",static:!1,private:!1,access:{has:M=>"mode"in M,get:M=>M.mode,set:(M,Be)=>{M.mode=Be}},metadata:vt},q,de),Or(null,null,re,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:M=>"nlink"in M,get:M=>M.nlink,set:(M,Be)=>{M.nlink=Be}},metadata:vt},Y,Q),Or(null,null,ae,{kind:"field",name:"uid",static:!1,private:!1,access:{has:M=>"uid"in M,get:M=>M.uid,set:(M,Be)=>{M.uid=Be}},metadata:vt},B,J),Or(null,null,ee,{kind:"field",name:"gid",static:!1,private:!1,access:{has:M=>"gid"in M,get:M=>M.gid,set:(M,Be)=>{M.gid=Be}},metadata:vt},oe,me),Or(null,null,xe,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:M=>"atimeMs"in M,get:M=>M.atimeMs,set:(M,Be)=>{M.atimeMs=Be}},metadata:vt},Pe,Ne),Or(null,null,Re,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:M=>"birthtimeMs"in M,get:M=>M.birthtimeMs,set:(M,Be)=>{M.birthtimeMs=Be}},metadata:vt},ke,Fe),Or(null,null,Qe,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:M=>"mtimeMs"in M,get:M=>M.mtimeMs,set:(M,Be)=>{M.mtimeMs=Be}},metadata:vt},Le,Ie),Or(null,null,V,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:M=>"ctimeMs"in M,get:M=>M.ctimeMs,set:(M,Be)=>{M.ctimeMs=Be}},metadata:vt},ge,Te),Or(null,null,le,{kind:"field",name:"ino",static:!1,private:!1,access:{has:M=>"ino"in M,get:M=>M.ino,set:(M,Be)=>{M.ino=Be}},metadata:vt},ie,te),Or(null,null,_e,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:M=>"__ino_old"in M,get:M=>M.__ino_old,set:(M,Be)=>{M.__ino_old=Be}},metadata:vt},Me,Ee),Or(null,null,We,{kind:"field",name:"flags",static:!1,private:!1,access:{has:M=>"flags"in M,get:M=>M.flags,set:(M,Be)=>{M.flags=Be}},metadata:vt},kt,it),Or(null,null,xt,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:M=>"__after_flags"in M,get:M=>M.__after_flags,set:(M,Be)=>{M.__after_flags=Be}},metadata:vt},Dt,Ot),Or(null,null,Wt,{kind:"field",name:"version",static:!1,private:!1,access:{has:M=>"version"in M,get:M=>M.version,set:(M,Be)=>{M.version=Be}},metadata:vt},be,I),Or(null,null,G,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:M=>"__padding"in M,get:M=>M.__padding,set:(M,Be)=>{M.__padding=Be}},metadata:vt},fe,je),Or(null,null,ve,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:M=>"attributes"in M,get:M=>M.attributes,set:(M,Be)=>{M.attributes=Be}},metadata:vt},Ce,ce),Or(null,x={value:E},w,{kind:"class",name:E.name,metadata:vt},null,S),ft=E=x.value,vt&&Object.defineProperty(E,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:vt}),bn(E,S)})(),ft=E})();function aee(e){return(e.mode&Cr)===Ys}function ro(e){return(e.mode&Cr)===ha}function Ph(e){return(e.mode&Cr)===ec}function iee(e){return(e.mode&Cr)===Yd}function Eg(e){return(e.mode&Cr)===Xd}function Cg(e){return(e.mode&Cr)===Jd}function see(e){return(e.mode&Cr)===Qd}function hr(e,t,n){const r=(e==null?void 0:e.credentials)||lo.credentials;if(Ph(t)||r.euid===0||r.egid===0)return!0;let a=0;return r.uid===t.uid&&(t.mode&Z8&&(a|=Sa),t.mode&Y8&&(a|=ta),t.mode&X8&&(a|=av)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&J8&&(a|=Sa),t.mode&Q8&&(a|=ta),t.mode&eP&&(a|=av)),t.mode&tP&&(a|=Sa),t.mode&nP&&(a|=ta),t.mode&rP&&(a|=av),(a&n)===n}const V3=1;class Uv extends Map{constructor(){super(...arguments),this.maxSize=_i}toJSON(){return{version:V3,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*Ur(fa);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Ue.With("ENOENT",t);if((n.mode&Cr)!=ha)throw Ue.With("ENOTDIR",t);const r={};for(const a of this.keys())ir(a)==t&&a!=t&&(r[Mh(a)]=this.get(a).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&Cr)!=ha)continue;const a={};for(const i of this.keys())ir(i)==n&&i!=n&&(a[Mh(i)]=this.get(i).ino);t.set(n,a)}return t}fromJSON(t){var n;if(t.version!=V3)throw new Ue(lt.EINVAL,"Index version mismatch");this.clear();for(const[r,a]of Object.entries(t.entries))(n=a.data)!==null&&n!==void 0||(a.data=G2(1,_i)),r=="/"&&(a.ino=0),this.set(r,new fa(a));return this}static parse(t){if(!fQ(t))throw new Ue(lt.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new Uv;return r.fromJSON(n),r}}const vS=4096;let Ak=class Z2{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===Z2.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===Z2.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:a}=await this.stat(t),{start:i=0,end:s=a}=n;for(let o=i;o<s;o+=vS){const l=o+vS>s?s-o:vS,u=new Uint8Array(l);await this.read(t,u,o,o+l).catch(r.error.bind(r)),r.enqueue(u)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let a=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(i,s)=>{let o=!1;const l=d=>{o=!0,s.error(d)},{size:u}=await this.stat(t);await this.write(t,i,a).catch(l),!o&&(a+=i.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(u,a)}).catch(l))}})}};function bi(e){return JSON.parse(bk(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function gs(e){return bd(JSON.stringify(e))}function _u(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Ue(lt.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function qv(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Ue(lt.EINVAL,"Invalid time.")}}function hn(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Ue(lt.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Ue(lt.EINVAL,"Path can not contain null character");if(e.length==0)throw new Ue(lt.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:Gl(e)}function $l(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:_u("mode"in e?e==null?void 0:e.mode:null,r)}}class oee{constructor(t,n,r,a){Oa(this,"id");Oa(this,"_size");Oa(this,"options");Oa(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),a==null||a.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const a=t-r.offset;r.data.byteLength>a&&(r.data=r.data.subarray(0,a)),r.ranges=r.ranges.filter(i=>i.start<t).map(i=>i.end>t?{start:i.start,end:t}:i)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],a=this.regions[n+1];if(a.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...a.ranges),r.ranges.sort((i,s)=>i.start-s.start),r.ranges=r.ranges.reduce((i,s)=>(!i.length||i.at(-1).end<s.start?i.push(s):i.at(-1).end=Math.max(i.at(-1).end,s.end),i),[]),r.data=xg(r.data,a.offset+a.data.byteLength),r.data.set(a.data,a.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const a of this.regions){if(a.offset>=n)break;for(const i of a.ranges)if(!(i.end<=t)&&(i.start>=n||(i.start>t&&r.push({start:t,end:Math.min(i.start,n)}),i.end>t&&(t=Math.max(t,i.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const s of i.ranges)if(!(s.end<=t)){if(s.start>=n)break;r.push({start:Math.max(t,s.start),end:Math.min(n,s.end)})}}r.sort((i,s)=>i.start-s.start);const a=[];for(const i of r){const s=a.at(-1);s&&i.start<=s.end?s.end=Math.max(s.end,i.end):a.push(i)}return a}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,a=this.regionAt(n);if(a)return a.data=xg(a.data,r),a.data.set(t,n),a.ranges.push({start:n,end:r}),a.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const i={data:t,offset:n,ranges:[{start:n,end:r}]},s=this.regions.findIndex(o=>o.offset>n);return s==-1?this.regions.push(i):this.regions.splice(s,0,i),this.collect(),this}}var wS,xS,_S;(wS=Promise.withResolvers)!==null&&wS!==void 0||(Promise.withResolvers=(si("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,a)=>{e=r,t=a}),resolve:e,reject:t}}));(xS=Symbol.dispose)!==null&&xS!==void 0||(Symbol.dispose=(si("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(_S=Symbol.asyncDispose)!==null&&_S!==void 0||(Symbol.asyncDispose=(si("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class oP{constructor(t){this.store=t}}class lee extends oP{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class Y2 extends oP{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,a;(r=(a=this.store).cache)!==null&&r!==void 0||(a.cache=new Map);const i=this.store.cache.get(t);return i?(n&&(i.size=n.size),i):n?new oee(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var a;const i=this._cached(t);if(!i)return;r??(r=i.size);const s=i.missing(n,r);for(const{start:l,end:u}of s)this.async(this.get(t,l,u));if(s.length)throw ji(Ue.With("EAGAIN",(a=this.store._fs)===null||a===void 0?void 0:a._path(t)));const o=i.regionAt(n);if(!o){si("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class cee{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const a=await this.raw.get(t,n,r);return this.stash(t),a}getSync(t,n=0,r){const a=this.raw.getSync(t,n,r);return this.stash(t),a}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const a=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,a),n)}catch(i){if(!(this.raw instanceof Y2))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,a??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const a=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,a),n)}catch(i){if(!(this.raw instanceof Y2))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,a??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var Ir=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,a;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(a=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");a&&(r=function(){try{a.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},jr=function(e){return function(t){function n(s){t.error=t.hasError?new e(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,a=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&a===1)return a=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(s).then(i,function(o){return n(o),i()})}else a|=1}catch(o){n(o)}if(a===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class lP extends Ak{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[a,i]of this._ids){const s=V8(t,a);if(s.startsWith(".."))continue;let o=cr(n,s);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:a,newKey:o,ino:i})}for(const{oldKey:a,newKey:i,ino:s}of r){this._ids.delete(a),this._ids.set(i,s);const o=this._paths.get(s);if(!o){si("Missing paths in table for ino "+s);continue}o.delete(a),o.add(i)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,a;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,Zm(this.name+": supports features: "+((a=this.store.flags)===null||a===void 0?void 0:a.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ir(n,this.transaction(),!0),a=t.directories();for(const[i,s]of t)this._add(s.ino,i),await r.set(s.ino,Ka(s)),a.has(i)&&await r.set(s.data,gs(a.get(i)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=jr(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ir(n,this.transaction(),!1),a=t.directories();for(const[i,s]of t)this._add(s.ino,i),r.setSync(s.ino,Ka(s)),a.has(i)&&r.setSync(s.data,gs(a.get(i)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{jr(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new Uv,a=Ir(n,this.transaction(),!0),i=[["/",0]],s=$3(Ue.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),u=new fa(await a.get(l));if(r.set(o,u),u.mode&ha){const d=bi((t=await a.get(u.data))!==null&&t!==void 0?t:yr(Ue.With("ENODATA",o)));for(const[h,p]of Object.entries(d))i.push([cr(o,h),p])}}return s(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=jr(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new Uv,a=Ir(n,this.transaction(),!1),i=[["/",0]],s=$3(Ue.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),u=new fa(a.getSync(l));if(r.set(o,u),u.mode&ha){const d=bi((t=a.getSync(u.data))!==null&&t!==void 0?t:yr(Ue.With("ENODATA",o)));for(const[h,p]of Object.entries(d))i.push([cr(o,h),p])}}return s(),r}catch(r){n.error=r,n.hasError=!0}finally{jr(n)}}async rename(t,n){var r,a,i;const s={stack:[],error:void 0,hasError:!1};try{const o=Ir(s,this.transaction(),!0),l=jo(t),u=jo(n),d=await this.findInode(o,l.dir,"rename"),h=bi((r=await o.get(d.data))!==null&&r!==void 0?r:yr(Ue.With("ENODATA",l.dir,"rename")));if(!h[l.base])throw Ue.With("ENOENT",t,"rename");const p=h[l.base];if(p!=this._ids.get(t)&&ji(`Ino mismatch while renaming ${t} to ${n}`),delete h[l.base],(u.dir+"/").startsWith(t+"/"))throw new Ue(lt.EBUSY,l.dir);const y=u.dir==l.dir,v=y?d:await this.findInode(o,u.dir,"rename"),b=y?h:bi((a=await o.get(v.data))!==null&&a!==void 0?a:yr(Ue.With("ENODATA",u.dir,"rename")));if(b[u.base]){const w=new fa((i=await o.get(b[u.base]))!==null&&i!==void 0?i:yr(Ue.With("ENOENT",n,"rename")));if(!w.toStats().isFile())throw Ue.With("EPERM",n,"rename");await o.remove(w.data),await o.remove(b[u.base])}b[u.base]=p,await o.set(d.data,gs(h)),await o.set(v.data,gs(b)),await o.commit(),this._move(t,n)}catch(o){s.error=o,s.hasError=!0}finally{const o=jr(s);o&&await o}}renameSync(t,n){var r,a,i;const s={stack:[],error:void 0,hasError:!1};try{const o=Ir(s,this.transaction(),!1),l=jo(t),u=jo(n),d=this.findInodeSync(o,l.dir,"rename"),h=bi((r=o.getSync(d.data))!==null&&r!==void 0?r:yr(Ue.With("ENODATA",l.dir,"rename")));if(!h[l.base])throw Ue.With("ENOENT",t,"rename");const p=h[l.base];if(p!=this._ids.get(t)&&ji(`Ino mismatch while renaming ${t} to ${n}`),delete h[l.base],(u.dir+"/").startsWith(t+"/"))throw new Ue(lt.EBUSY,l.dir);const y=u.dir===l.dir,v=y?d:this.findInodeSync(o,u.dir,"rename"),b=y?h:bi((a=o.getSync(v.data))!==null&&a!==void 0?a:yr(Ue.With("ENODATA",u.dir,"rename")));if(b[u.base]){const w=new fa((i=o.getSync(b[u.base]))!==null&&i!==void 0?i:yr(Ue.With("ENOENT",n,"rename")));if(!w.toStats().isFile())throw Ue.With("EPERM",n,"rename");o.removeSync(w.data),o.removeSync(b[u.base])}b[u.base]=p,o.setSync(d.data,gs(h)),o.setSync(v.data,gs(b)),o.commitSync(),this._move(t,n)}catch(o){s.error=o,s.hasError=!0}finally{jr(s)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ir(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=jr(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ir(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{jr(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const a=Ir(r,this.transaction(),!0),i=await this.findInode(a,t,"touch");i.update(n)&&(this._add(i.ino,t),a.setSync(i.ino,Ka(i))),await a.commit()}catch(a){r.error=a,r.hasError=!0}finally{const a=jr(r);a&&await a}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const a=Ir(r,this.transaction(),!1),i=this.findInodeSync(a,t,"touch");i.update(n)&&(this._add(i.ino,t),a.setSync(i.ino,Ka(i))),a.commitSync()}catch(a){r.error=a,r.hasError=!0}finally{jr(r)}}async createFile(t,n){return n.mode|=Ys,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=Ys,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Ue.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Ue.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=ha,await this.commitNew(t,n,bd("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=ha,this.commitNewSync(t,n,bd("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const a=Ir(r,this.transaction(),!0),i=await this.findInode(a,t,"readdir");return Object.keys(bi((n=await a.get(i.data))!==null&&n!==void 0?n:yr(Ue.With("ENOENT",t,"readdir"))))}catch(a){r.error=a,r.hasError=!0}finally{const a=jr(r);a&&await a}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const a=Ir(r,this.transaction(),!1),i=this.findInodeSync(a,t,"readdir");return Object.keys(bi((n=a.getSync(i.data))!==null&&n!==void 0?n:yr(Ue.With("ENOENT",t,"readdir"))))}catch(a){r.error=a,r.hasError=!0}finally{jr(r)}}async sync(t,n,r){const a={stack:[],error:void 0,hasError:!1};try{const i=Ir(a,this.transaction(),!0),s=await this.findInode(i,t,"sync");n&&await i.set(s.data,n),s.update(r)&&(this._add(s.ino,t),await i.set(s.ino,Ka(s))),await i.commit()}catch(i){a.error=i,a.hasError=!0}finally{const i=jr(a);i&&await i}}syncSync(t,n,r){const a={stack:[],error:void 0,hasError:!1};try{const i=Ir(a,this.transaction(),!1),s=this.findInodeSync(i,t,"sync");n&&i.setSync(s.data,n),s.update(r)&&(this._add(s.ino,t),i.setSync(s.ino,Ka(s))),i.commitSync()}catch(i){a.error=i,a.hasError=!0}finally{jr(a)}}async link(t,n){var r;const a={stack:[],error:void 0,hasError:!1};try{const i=Ir(a,this.transaction(),!0),s=ir(n),o=await this.findInode(i,s,"link"),l=bi((r=await i.get(o.data))!==null&&r!==void 0?r:yr(Ue.With("ENOENT",s,"link"))),u=await this.findInode(i,t,"link");u.nlink++,l[Mh(n)]=u.ino,this._add(u.ino,n),await i.set(u.ino,Ka(u)),await i.set(o.data,gs(l)),await i.commit()}catch(i){a.error=i,a.hasError=!0}finally{const i=jr(a);i&&await i}}linkSync(t,n){var r;const a={stack:[],error:void 0,hasError:!1};try{const i=Ir(a,this.transaction(),!1),s=ir(n),o=this.findInodeSync(i,s,"link"),l=bi((r=i.getSync(o.data))!==null&&r!==void 0?r:yr(Ue.With("ENOENT",s,"link"))),u=this.findInodeSync(i,t,"link");u.nlink++,l[Mh(n)]=u.ino,this._add(u.ino,n),i.setSync(u.ino,Ka(u)),i.setSync(o.data,gs(l)),i.commitSync()}catch(i){a.error=i,a.hasError=!0}finally{jr(a)}}async read(t,n,r,a){var i;const s={stack:[],error:void 0,hasError:!1};try{const o=Ir(s,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const u=(i=await o.get(l.data,r,a))!==null&&i!==void 0?i:yr(Ue.With("ENODATA",t,"read")),d=o.flag("partial")?u:u.subarray(r,a);d.byteLength>n.byteLength&&ji(`Trying to place ${d.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(d)}catch(o){s.error=o,s.hasError=!0}finally{const o=jr(s);o&&await o}}readSync(t,n,r,a){var i;const s={stack:[],error:void 0,hasError:!1};try{const o=Ir(s,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const u=(i=o.getSync(l.data,r,a))!==null&&i!==void 0?i:yr(Ue.With("ENODATA",t,"read")),d=o.flag("partial")?u:u.subarray(r,a);d.byteLength>n.byteLength&&ji(`Trying to place ${d.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(d)}catch(o){s.error=o,s.hasError=!0}finally{jr(s)}}async write(t,n,r){var a;const i={stack:[],error:void 0,hasError:!1};try{const s=Ir(i,this.transaction(),!0),o=await this.findInode(s,t,"write");let l=n;s.flag("partial")||(l=xg((a=await s.get(o.data))!==null&&a!==void 0?a:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await s.set(o.data,l,r),this._add(o.ino,t),await s.commit()}catch(s){i.error=s,i.hasError=!0}finally{const s=jr(i);s&&await s}}writeSync(t,n,r){var a;const i={stack:[],error:void 0,hasError:!1};try{const s=Ir(i,this.transaction(),!1),o=this.findInodeSync(s,t,"write");let l=n;s.flag("partial")||(l=xg((a=s.getSync(o.data))!==null&&a!==void 0?a:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),s.setSync(o.data,l,r),this._add(o.ino,t),s.commitSync()}catch(s){i.error=s,i.hasError=!0}finally{jr(i)}}transaction(){return new cee(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ir(t,this.transaction(),!0);if(await n.get(Zi))return;const r=new fa({ino:Zi,data:1,mode:511|ha});await n.set(r.data,bd("{}")),this._add(Zi,"/"),await n.set(Zi,Ka(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=jr(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ir(t,this.transaction(),!1);if(n.getSync(Zi))return;const r=new fa({ino:Zi,data:1,mode:511|ha});n.setSync(r.data,bd("{}")),this._add(Zi,"/"),n.setSync(Zi,Ka(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{jr(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){si("Attempted to populate tables after initialization");return}Zm("Populating tables with existing store metadata");const n=Ir(t,this.transaction(),!0),r=await n.get(Zi);if(!r){Sk("Store does not have a root inode");const o=new fa({ino:Zi,data:1,mode:511|ha});await n.set(o.data,bd("{}")),this._add(Zi,"/"),await n.set(Zi,Ka(o)),await n.commit();return}if(r.length<Ur(fa)){Xw("Store contains an invalid root inode. Refusing to populate tables");return}const a=new Set;let i=0;const s=[["/",Zi]];for(;s.length>0;){i++;const[o,l]=s.shift();this._add(l,o);const u=await n.get(l);if(!u){si("Store is missing data for inode: "+l);continue}if(u.length<Ur(fa)){si(`Invalid inode size for ino ${l}: ${u.length}`);continue}const d=new fa(u);if((d.mode&ha)!=ha||a.has(l))continue;a.add(l);const h=await n.get(d.data);if(!h){si("Store is missing directory data: "+d.data);continue}const p=bi(h);for(const[y,v]of Object.entries(p))s.push([cr(o,y),v])}Zm(`Added ${i} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=jr(t);n&&await n}}async findInode(t,n,r){var a;const i=this._ids.get(n);if(i===void 0)throw Ue.With("ENOENT",n,r);return new fa((a=await t.get(i))!==null&&a!==void 0?a:yr(Ue.With("ENOENT",n,r)))}findInodeSync(t,n,r){var a;const i=this._ids.get(n);if(i===void 0)throw Ue.With("ENOENT",n,r);return new fa((a=t.getSync(i))!==null&&a!==void 0?a:yr(Ue.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const a=this._lastID;if(a>_i)throw ji(new Ue(lt.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(a,t),a}async commitNew(t,n,r,a){var i;const s={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ue.With("EEXIST",t,a);const o=Ir(s,this.transaction(),!0),{dir:l,base:u}=jo(t),d=await this.findInode(o,l,a),h=bi((i=await o.get(d.data))!==null&&i!==void 0?i:yr(Ue.With("ENOENT",l,a)));if(h[u])throw Ue.With("EEXIST",t,a);const p=this.allocNew(t,a),y=new fa({...n,ino:p,data:p+1,size:r.byteLength});return await o.set(y.ino,Ka(y)),await o.set(y.data,r),h[u]=y.ino,await o.set(d.data,gs(h)),await o.commit(),y}catch(o){s.error=o,s.hasError=!0}finally{const o=jr(s);o&&await o}}commitNewSync(t,n,r,a){var i;const s={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ue.With("EEXIST",t,a);const o=Ir(s,this.transaction(),!1),{dir:l,base:u}=jo(t),d=this.findInodeSync(o,l,a),h=bi((i=o.getSync(d.data))!==null&&i!==void 0?i:yr(Ue.With("ENOENT",l,a)));if(h[u])throw Ue.With("EEXIST",t,a);const p=this.allocNew(t,a),y=new fa({...n,ino:p,data:p+1,size:r.byteLength});return o.setSync(y.ino,Ka(y)),o.setSync(y.data,r),h[u]=y.ino,o.setSync(d.data,gs(h)),o.commitSync(),y}catch(o){s.error=o,s.hasError=!0}finally{jr(s)}}async remove(t,n){var r,a;const i={stack:[],error:void 0,hasError:!1};try{const s=n?"rmdir":"unlink",o=Ir(i,this.transaction(),!0),{dir:l,base:u}=jo(t),d=await this.findInode(o,l,s),h=bi((r=await o.get(d.data))!==null&&r!==void 0?r:yr(Ue.With("ENOENT",l,s)));if(!h[u])throw Ue.With("ENOENT",t,s);const p=h[u],y=new fa((a=await o.get(p))!==null&&a!==void 0?a:yr(Ue.With("ENOENT",t,s)));if(delete h[u],!n&&ro(y))throw Ue.With("EISDIR",t,s);await o.set(d.data,gs(h)),y.nlink>1?(y.update({nlink:y.nlink-1}),await o.set(y.ino,Ka(y))):(await o.remove(y.data),await o.remove(p),this._remove(p)),await o.commit()}catch(s){i.error=s,i.hasError=!0}finally{const s=jr(i);s&&await s}}removeSync(t,n){var r,a;const i={stack:[],error:void 0,hasError:!1};try{const s=n?"rmdir":"unlink",o=Ir(i,this.transaction(),!1),{dir:l,base:u}=jo(t),d=this.findInodeSync(o,l,s),h=bi((r=o.getSync(d.data))!==null&&r!==void 0?r:yr(Ue.With("ENOENT",l,s))),p=h[u];if(!p)throw Ue.With("ENOENT",t,s);const y=new fa((a=o.getSync(p))!==null&&a!==void 0?a:yr(Ue.With("ENOENT",t,s)));if(delete h[u],!n&&ro(y))throw Ue.With("EISDIR",t,s);o.setSync(d.data,gs(h)),y.nlink>1?(y.update({nlink:y.nlink-1}),o.setSync(y.ino,Ka(y))):(o.removeSync(y.data),o.removeSync(p),this._remove(p)),o.commitSync()}catch(s){i.error=s,i.hasError=!0}finally{jr(i)}}}class uee extends lee{async keys(){return this.store.keys()}async get(t){var n,r,a;return await((a=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&a!==void 0?a:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class dee extends Map{constructor(t=_i,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new uee(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const fee={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new lP(new dee(e,t));return n.checkRootSync(),n}},hee=fee;let Ea=!0;class G3 extends gk{get cursor(){return this._cursor}constructor(t,n,r,a=!1){super(),this.input=t,this.output=n,this.terminal=a,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=i=>{if(!(this._paused||this._closed)){this._buffer+=typeof i=="string"?i:i.toString("utf8");for(let s=this._buffer.indexOf(`
`);s>=0;s=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,s);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(s+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;ys(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;ys(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);Nb(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);Nb(this.output,0),ys(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const a=this.line.slice(0,r+1)+this.line.slice(this._cursor),i=r+1;this._renderLine(a),this._cursor=i,this._cursor=i,ys(this.output,-a.length,0),ys(this.output,i,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const a=Math.max(0,Math.min(this.line.length,this._cursor+r));if(a==this._cursor)return;ys(this.output,r,0),this._cursor=a,this._cursor=a;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(ys(this.output,-this._cursor,0),ys(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);Nb(this.output,0),ys(this.output,0,0),this.output.write(this._prompt+r),this.line=r,ys(this.output,-r.length,0),ys(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&(Nb(this.output,0),ys(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const a=typeof n=="function"?n:r;if(this._closed||!this.output){a("");return}this.output.write(t),this.once("line",a)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return si("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return si("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",a=>n({value:a,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function pee(e,t,n,r){return"input"in e?new G3(e.input,e.output,e.completer,e.terminal):new G3(e,t,n,r)}function Nb(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function ys(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class Hv{get position(){return this.flag&Pd?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,a,i,s){this.context=t,this.path=n,this.fs=r,this.internalPath=a,this.flag=i,this.inode=s,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&tx||this.inode.flags&Oi.Sync)}sync(){if(this.closed)throw Ue.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Ue.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Ue.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ue.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Ue.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Ue.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&ai||this.flag&Ll))throw new Ue(lt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,a=this.position){if(this.closed)throw Ue.With("EBADF",this.path,"write");if(!(this.flag&ai||this.flag&Ll))throw new Ue(lt.EPERM,"File not opened with a writeable mode");if(this.inode.flags&Oi.Immutable)throw new Ue(lt.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const i=a+r,s=t.subarray(n,n+r);return!Cg(this.inode)&&!Eg(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=a+s.byteLength,this.fs.writeSync(this.internalPath,s,a),this._isSync&&this.sync(),s.byteLength}read(t,n=0,r=t.byteLength-n,a=this.position){if(this.closed)throw Ue.With("EBADF",this.path,"read");if(this.flag&ai)throw new Ue(lt.EPERM,"File not opened with a readable mode");this.inode.flags&Oi.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=a+r;!Cg(this.inode)&&!Eg(this.inode)&&i>this.inode.size&&(i=a+Math.max(this.inode.size-a,0)),this._position=i;const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,s.subarray(n,n+r),a,i),this._isSync&&this.sync(),i-a}chmod(t){if(this.closed)throw Ue.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>Cr?-61441:Cr)|t,(this._isSync||t>Cr)&&this.sync()}chown(t,n){if(this.closed)throw Ue.With("EBADF",this.path,"chown");this.dirty=!0,sP(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Ue.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Ue.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Ue.With("EBADF",this.path,"streamWrite");if(this.inode.flags&Oi.Immutable)throw new Ue(lt.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function Vv(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:lo.descriptors,a=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(a,e),a}function fi(e,t){var n;const a=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:lo.descriptors).get(t);if(!a)throw new Ue(lt.EBADF);return a}function cP(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:lo.descriptors).delete(t)}const mee=/[rwasx]{1,2}\+?/;function Bl(e){if(typeof e=="number")return e;if(!mee.test(e))throw new Ue(lt.EINVAL,"Invalid flag string: "+e);return gee(e)}function gee(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Ue(lt.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?K8:Jw;return e.includes("w")&&(t|=ex),e.includes("a")&&(t|=Pd),e.includes("+")?t|=Ll:e.includes("r")||(t|=ai),e.includes("s")&&(t|=tx),e.includes("x")&&(t|=Qw),t}function uP(e){let t=0;return e&ai||(t|=Sa),(e&ai||e&Ll)&&(t|=ta),t}const kg=new Map;Nk("/",hee.create({label:"root"}));function Nk(e,t){if(e[0]!="/"&&(e="/"+e),e=Gl.call(this,e),kg.has(e))throw ji(new Ue(lt.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,kg.set(e,t),G8(`Mounted ${t.name} on ${e}`),Zm(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function dP(e){if(e[0]!="/"&&(e="/"+e),e=Gl.call(this,e),!kg.has(e)){si(e+" is already unmounted");return}kg.delete(e),Sk("Unmounted "+e)}function Ln(e,t){const n=(t==null?void 0:t.root)||lo.root;e=hn(cr(n,e));const r=[...kg].sort((a,i)=>a[0].length>i[0].length?-1:1);for(const[a,i]of r)if(bee(a,e))return e=e.slice(a.length>1?a.length:0),e===""&&(e=n),{fs:i,path:e,mountPoint:a,root:n};throw AQ(new Ue(lt.EIO,"No file system",e))}function SS(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function pr(e,t){typeof e.stack=="string"&&(e.stack=SS(e.stack,t));try{e.message=SS(e.message,t)}catch{}return e.path&&(e.path=SS(e.path,t)),e}function fP(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||_i),files:(t?BigInt:Number)(n.totalNodes||_i),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function yee(e){var t,n,r,a,i,s,o;const l=this!==null&&this!==void 0?this:lo;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((a=l.credentials)===null||a===void 0?void 0:a.egid)!==0)throw new Ue(lt.EPERM,"Can not chroot() as non-root user");(i=l.root)!==null&&i!==void 0||(l.root="/");const u=cr(l.root,e);for(const d of(o=(s=l.descriptors)===null||s===void 0?void 0:s.values())!==null&&o!==void 0?o:[]){if(!d.path.startsWith(l.root))throw Ue.With("EBUSY",d.path,"chroot");d.path=d.path.slice(l.root.length)}if(u.length>l.root.length)throw new Ue(lt.EPERM,"Can not chroot() outside of current root");l.root=u}function bee(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class hP extends gk{off(t,n,r,a){return super.off(t,n,r,a)}removeListener(t,n,r,a){return super.removeListener(t,n,r,a)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Ue.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Ue.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Ue.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Ue.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Ue.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class pP extends hP{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?cr(t.root,n):n,wee(this.realpath,this)}close(){super.emit("close"),xee(this.realpath,this)}[Symbol.dispose](){this.close()}}class vee extends hP{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=hu(this.path);QQ(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=hu(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const Kc=new Map;function wee(e,t){const n=hn(e);Kc.has(n)||Kc.set(n,new Set),Kc.get(n).add(t)}function xee(e,t){const n=hn(e);Kc.has(n)&&(Kc.get(n).delete(t),Kc.get(n).size===0&&Kc.delete(n))}function Xa(e,t,n){var r;e&&(n=cr((r=e.root)!==null&&r!==void 0?r:"/",n)),n=hn(n);for(let a=n;a!="/";a=ir(a)){const i=Kc.get(a);if(i)for(const s of i)s.emit("change",t,V8.call(s._context,a,n)||Mh(n))}}var b0=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,a;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(a=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");a&&(r=function(){try{a.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},v0=function(e){return function(t){function n(s){t.error=t.hasError?new e(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,a=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&a===1)return a=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(s).then(i,function(o){return n(o),i()})}else a|=1}catch(o){n(o)}if(a===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function _ee(e,t){e=hn(e),t=hn(t);const n=Ln(e,this),r=Ln(t,this);if(!hu.call(this,ir(e)).hasAccess(ta,this))throw Ue.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),Xa(this,"rename",e.toString()),Xa(this,"change",t.toString());return}Dk.call(this,t,Ok(e)),jk.call(this,e),Xa(this,"rename",e.toString())}catch(a){throw pr(a,{[n.path]:e,[r.path]:t})}}function Rk(e){e=hn(e);try{const{fs:t,path:n}=Ln(Su.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==lt.ENOENT)return!1;throw t}}function hu(e,t){e=hn(e);const{fs:n,path:r}=Ln(Su.call(this,e),this);try{const a=n.statSync(r);if(Ea&&!hr(this,a,Sa))throw Ue.With("EACCES",r,"stat");return t!=null&&t.bigint?new ef(a):new tc(a)}catch(a){throw pr(a,{[r]:e})}}function Ik(e,t){e=hn(e);const{fs:n,path:r}=Ln(e,this);try{const a=n.statSync(r);if(Ea&&!hr(this,a,Sa))throw Ue.With("EACCES",r,"lstat");return t!=null&&t.bigint?new ef(a):new tc(a)}catch(a){throw pr(a,{[r]:e})}}function See(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=b0(n,tf.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Ue(lt.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{v0(n)}}function jk(e){e=hn(e);const{fs:t,path:n}=Ln(e,this);try{if(Ea&&!hr(this,t.statSync(n),ta))throw Ue.With("EACCES",n,"unlink");t.unlinkSync(n),Xa(this,"rename",e.toString())}catch(r){throw pr(r,{[n]:e})}}function tf(e,t){var n;e=hn(e);const r=_u(t.mode,420),a=Bl(t.flag);e=t.preserveSymlinks?e:Su.call(this,e);const{fs:i,path:s}=Ln(e,this);let o;try{o=i.statSync(s)}catch{}if(!o){if(!(a&Jw))throw Ue.With("ENOENT",e,"_open");const u=i.statSync(ir(s));if(!hr(this,u,ta))throw Ue.With("EACCES",ir(e),"_open");if(!ro(u))throw Ue.With("ENOTDIR",ir(e),"_open");if(!t.allowDirectory&&r&ha)throw Ue.With("EISDIR",e,"_open");if(!hr(this,u,ta))throw Ue.With("EACCES",ir(s),"_open");const{euid:d,egid:h}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:lo.credentials,p=i.createFileSync(s,{mode:r,uid:u.mode&g0?u.uid:d,gid:u.mode&y0?u.gid:h});return new Hv(this,e,i,s,a,p)}if(!hr(this,o,r)||!hr(this,o,uP(a)))throw Ue.With("EACCES",e,"_open");if(a&Qw)throw Ue.With("EEXIST",e,"_open");const l=new Hv(this,e,i,s,a,o);if(a&ex&&l.truncate(0),!t.allowDirectory&&o.mode&ha)throw Ue.With("EISDIR",e,"_open");return l}function nx(e,t,n=Ck){return Vv(tf.call(this,e,{flag:t,mode:n}))}function rx(e,t,n){return Vv(tf.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function mP(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const a=b0(r,typeof e=="number"?fi(this,e):tf.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:i}=a.stat(),s=new Uint8Array(i);return a.read(s,0,i,0),s}catch(a){r.error=a,r.hasError=!0}finally{v0(r)}}function Ok(e,t={}){const n=$l(t,null,"r",420);if(Bl(n.flag)&ai)throw new Ue(lt.EINVAL,"Flag passed to readFile must allow for reading");const a=Pr.from(mP.call(this,e,n.flag,!1));return n.encoding?a.toString(n.encoding):a}function Dk(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const a=$l(n,"utf8","w+",420),i=Bl(a.flag);if(!(i&ai||i&Ll))throw new Ue(lt.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!a.encoding)throw new Ue(lt.EINVAL,"Encoding not specified");const s=typeof t=="string"?Pr.from(t,a.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!s)throw new Ue(lt.EINVAL,"Data not specified");b0(r,typeof e=="number"?fi(this,e):tf.call(this,e.toString(),{flag:i,mode:a.mode,preserveSymlinks:!0}),!1).write(s,0,s.byteLength,0),Xa(this,"change",e.toString())}catch(a){r.error=a,r.hasError=!0}finally{v0(r)}}function Eee(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const a=$l(n,"utf8","a+",420),i=Bl(a.flag);if(!(i&Pd))throw new Ue(lt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!a.encoding)throw new Ue(lt.EINVAL,"Encoding not specified");const s=typeof t=="string"?Pr.from(t,a.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);b0(r,tf.call(this,typeof e=="number"?fi(this,e).path:e.toString(),{flag:i,mode:a.mode,preserveSymlinks:!0}),!1).write(s,0,s.byteLength)}catch(a){r.error=a,r.hasError=!0}finally{v0(r)}}function Cee(e,t){const n=fi(this,e).stat();return t!=null&&t.bigint?new ef(n):new tc(n)}function nf(e){fi(this,e).close(),cP(this,e)}function kee(e,t=0){if(t||(t=0),t<0)throw new Ue(lt.EINVAL);fi(this,e).truncate(t)}function Tee(e){fi(this,e).sync()}function Aee(e){fi(this,e).datasync()}function Nee(e,t,n,r,a){let i,s,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const h=typeof r=="string"?r:"utf8";s=0,i=Pr.from(t,h),o=i.byteLength}else i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),s=n,o=r,l=typeof a=="number"?a:null;const u=fi(this,e);l??(l=u.position);const d=u.write(i,s,o,l);return Xa(this,"change",u.path),d}function Ree(e,t,n,r,a){const i=fi(this,e),s=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,a=n.position),a=Number(a),isNaN(a)&&(a=i.position),i.read(t,s,r,a)}function Mk(e,t,n){fi(this,e).chown(t,n)}function Pk(e,t){const n=_u(t,-1);if(n<0)throw new Ue(lt.EINVAL,"Invalid mode.");fi(this,e).chmod(n)}function Fk(e,t,n){fi(this,e).utimes(qv(t),qv(n))}function gP(e){e=hn(e);const{fs:t,path:n}=Ln(Su.call(this,e),this);try{const r=t.statSync(n);if(!ro(r))throw Ue.With("ENOTDIR",n,"rmdir");if(Ea&&!hr(this,r,ta))throw Ue.With("EACCES",n,"rmdir");t.rmdirSync(n),Xa(this,"rename",e.toString())}catch(r){throw pr(r,{[n]:e})}}function Lk(e,t){var n,r;const{euid:a,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:lo.credentials;t=typeof t=="object"?t:{mode:t};const s=_u(t==null?void 0:t.mode,511);e=Su.call(this,e);const{fs:o,path:l,root:u}=Ln(e,this),d={[l]:e},h=(p,y)=>{if(!hr(this,y,ta))throw Ue.With("EACCES",ir(p),"mkdir");const v=o.mkdirSync(p,{mode:s,uid:y.mode&g0?y.uid:a,gid:y.mode&y0?y.gid:i});return Xa(this,"rename",p),v};try{if(!(t!=null&&t.recursive)){h(l,o.statSync(ir(l)));return}const p=[];for(let v=l,b=e;!o.existsSync(v);v=ir(v),b=ir(b))p.unshift(v),d[v]=b;if(!p.length)return;const y=[o.statSync(ir(p[0]))];for(const[v,b]of p.entries())y.push(h(b,y[v]));return u.length==1?p[0]:(r=p[0])===null||r===void 0?void 0:r.slice(u.length)}catch(p){throw pr(p,d)}}function ap(e,t){t=typeof t=="object"?t:{encoding:t},e=hn(e);const{fs:n,path:r}=Ln(Su.call(this,e),this);let a;try{const s=n.statSync(r);if(Ea&&!hr(this,s,Sa))throw Ue.With("EACCES",r,"readdir");if(!ro(s))throw Ue.With("ENOTDIR",r,"readdir");a=n.readdirSync(r)}catch(s){throw pr(s,{[r]:e})}const i=[];for(const s of a){let o;try{o=n.statSync(cr(r,s))}catch{continue}if(t!=null&&t.withFileTypes?i.push(new Tg(s,o)):(t==null?void 0:t.encoding)=="buffer"?i.push(Pr.from(s)):i.push(s),!(!ro(o)||!(t!=null&&t.recursive)))for(const l of ap.call(this,cr(e,s),t))l instanceof Tg?(l.path=cr(s,l.path),i.push(l)):Pr.isBuffer(l)?i.push(Pr.from(cr(s,bk(l)))):i.push(cr(s,l))}return i}function Iee(e,t){if(e=hn(e),!hu(ir(e)).hasAccess(Sa,this))throw Ue.With("EACCES",ir(e),"link");if(t=hn(t),!hu(ir(t)).hasAccess(ta,this))throw Ue.With("EACCES",ir(t),"link");const{fs:n,path:r}=Ln(e,this),a=Ln(t,this);if(n!=a.fs)throw Ue.With("EXDEV",t,"link");try{if(Ea&&!hr(this,n.statSync(r),Sa))throw Ue.With("EACCES",r,"link");return n.linkSync(r,a.path)}catch(i){throw pr(i,{[r]:e,[a.path]:t})}}function jee(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ue(lt.EINVAL,"Invalid type: "+n);t=hn(t);const a=b0(r,tf.call(this,t,{flag:"wx",mode:420}),!1);a.write(bd(hn(e,!0))),a.chmod(ec)}catch(a){r.error=a,r.hasError=!0}finally{v0(r)}}function X2(e,t){const n=Pr.from(mP.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function Oee(e,t,n){const r=nx.call(this,e,"r+");Mk.call(this,r,t,n),nf.call(this,r)}function Dee(e,t,n){const r=rx.call(this,e,"r+");Mk.call(this,r,t,n),nf.call(this,r)}function Mee(e,t){const n=nx.call(this,e,"r+");Pk.call(this,n,t),nf.call(this,n)}function Pee(e,t){const n=rx.call(this,e,"r+");Pk.call(this,n,t),nf.call(this,n)}function yP(e,t,n){const r=nx.call(this,e,"r+");Fk.call(this,r,t,n),nf.call(this,r)}function Fee(e,t,n){const r=rx.call(this,e,"r+");Fk.call(this,r,t,n),nf.call(this,r)}function J2(e,t,n){try{const l=Ln(t,e),u=l.fs.statSync(l.path);if(!Ph(u))return{...l,fullPath:t,stats:u};const d=Gl.call(e,ir(t),X2.call(e,t).toString());return J2(e,d)}catch{}const{base:r,dir:a}=jo(t),i=a=="/"?"/":Su.call(e,a),s=cr(i,r),o=Ln(s,e);try{const l=o.fs.statSync(o.path);if(!Ph(l))return{...o,fullPath:s,stats:l};const u=Gl.call(e,i,X2.call(e,s).toString());return J2(e,u)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw pr(l,{[o.path]:s})}}function Su(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=hn(e);const{fullPath:a}=J2(this,e);if(r=="utf8"||r=="utf-8")return a;const i=Pr.from(a,"utf-8");return r=="buffer"?i:i.toString(r)}function Lee(e,t=384){if(!hr(this,hu.call(this,e),t))throw new Ue(lt.EACCES)}function bP(e,t){e=hn(e);let n;try{n=Ik.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&Cr){case ha:if(t!=null&&t.recursive)for(const r of ap.call(this,e))bP.call(this,cr(e,r),t);gP.call(this,e);break;case Ys:case ec:case Xd:case Jd:jk.call(this,e);break;case Qd:case Yd:default:throw new Ue(lt.EPERM,"File type not supported",e,"rm")}}function $ee(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",a="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return Lk.call(this,a),n=="buffer"?Pr.from(a):a}function vP(e,t,n){if(e=hn(e),t=hn(t),n&&n&kk&&Rk(t))throw new Ue(lt.EEXIST,"Destination file already exists",t,"copyFile");Dk.call(this,t,Ok(e)),Xa(this,"rename",t.toString())}function Bee(e,t,n){const r=fi(this,e);let a=0;for(const i of t)a+=r.read(i,0,i.byteLength,n+a);return a}function zee(e,t,n){const r=fi(this,e);let a=0;for(const i of t)a+=r.write(new Uint8Array(i.buffer),0,i.byteLength,n+a);return a}function Uee(e,t){return e=hn(e),new $k(e,this)}function wP(e,t,n){e=hn(e),t=hn(t);const r=Ik.call(this,e);if(n!=null&&n.errorOnExist&&Rk.call(this,t))throw new Ue(lt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Cr){case ha:if(!(n!=null&&n.recursive))throw new Ue(lt.EISDIR,e+" is a directory (not copied)",e,"cp");Lk.call(this,t,{recursive:!0});for(const a of ap.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(cr(e,a.name),cr(t,a.name))||wP.call(this,cr(e,a.name),cr(t,a.name),n);break;case Ys:case ec:vP.call(this,e,t);break;case Xd:case Jd:case Qd:case Yd:default:throw new Ue(lt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&yP.call(this,t,r.atime,r.mtime)}function qee(e,t){e=hn(e);const{fs:n}=Ln(e,this);return fP(n,t==null?void 0:t.bigint)}function Hee(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:a=()=>!1}=t,i=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),s=[];function o(l){const u=ap(l,{withFileTypes:r,encoding:"utf8"});for(const d of u){const h=r?d.path:l+"/"+d;a(r?d:h)||(hu(h).isDirectory()&&i.some(p=>p.source.includes(".*"))&&o(h),i.some(p=>p.test(h.replace(/^\/+/g,"")))&&s.push(r?d.path:h.replace(/^\/+/g,"")))}}return o(n),s}class Tg{get name(){return Mh(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return aee(this.stats)}isDirectory(){return ro(this.stats)}isBlockDevice(){return Eg(this.stats)}isCharacterDevice(){return Cg(this.stats)}isSymbolicLink(){return Ph(this.stats)}isFIFO(){return see(this.stats)}isSocket(){return iee(this.stats)}}class $k{checkClosed(){if(this.closed)throw new Ue(lt.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await af.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=ap.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var ES={exports:{}},CS={exports:{}},kS={},W3;function Eu(){return W3||(W3=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=d,n.toByteArray=p,n.fromByteArray=b;for(var r=[],a=[],i=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)r[o]=s[o],a[s.charCodeAt(o)]=o;a[45]=62,a[95]=63;function u(S){var E=S.length;if(E%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var C=S.indexOf("=");C===-1&&(C=E);var k=C===E?0:4-C%4;return[C,k]}function d(S){var E=u(S),C=E[0],k=E[1];return(C+k)*3/4-k}function h(S,E,C){return(E+C)*3/4-C}function p(S){var E,C=u(S),k=C[0],R=C[1],O=new i(h(S,k,R)),j=0,$=R>0?k-4:k,L;for(L=0;L<$;L+=4)E=a[S.charCodeAt(L)]<<18|a[S.charCodeAt(L+1)]<<12|a[S.charCodeAt(L+2)]<<6|a[S.charCodeAt(L+3)],O[j++]=E>>16&255,O[j++]=E>>8&255,O[j++]=E&255;return R===2&&(E=a[S.charCodeAt(L)]<<2|a[S.charCodeAt(L+1)]>>4,O[j++]=E&255),R===1&&(E=a[S.charCodeAt(L)]<<10|a[S.charCodeAt(L+1)]<<4|a[S.charCodeAt(L+2)]>>2,O[j++]=E>>8&255,O[j++]=E&255),O}function y(S){return r[S>>18&63]+r[S>>12&63]+r[S>>6&63]+r[S&63]}function v(S,E,C){for(var k,R=[],O=E;O<C;O+=3)k=(S[O]<<16&16711680)+(S[O+1]<<8&65280)+(S[O+2]&255),R.push(y(k));return R.join("")}function b(S){for(var E,C=S.length,k=C%3,R=[],O=16383,j=0,$=C-k;j<$;j+=O)R.push(v(S,j,j+O>$?$:j+O));return k===1?(E=S[C-1],R.push(r[E>>2]+r[E<<4&63]+"==")):k===2&&(E=(S[C-2]<<8)+S[C-1],R.push(r[E>>10]+r[E>>4&63]+r[E<<2&63]+"=")),R.join("")}var w={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */w.read=function(S,E,C,k,R){var O,j,$=R*8-k-1,L=(1<<$)-1,X=L>>1,F=-7,K=C?R-1:0,q=C?-1:1,de=S[E+K];for(K+=q,O=de&(1<<-F)-1,de>>=-F,F+=$;F>0;O=O*256+S[E+K],K+=q,F-=8);for(j=O&(1<<-F)-1,O>>=-F,F+=k;F>0;j=j*256+S[E+K],K+=q,F-=8);if(O===0)O=1-X;else{if(O===L)return j?NaN:(de?-1:1)*(1/0);j=j+Math.pow(2,k),O=O-X}return(de?-1:1)*j*Math.pow(2,O-k)},w.write=function(S,E,C,k,R,O){var j,$,L,X=O*8-R-1,F=(1<<X)-1,K=F>>1,q=R===23?Math.pow(2,-24)-Math.pow(2,-77):0,de=k?0:O-1,re=k?1:-1,Y=E<0||E===0&&1/E<0?1:0;for(E=Math.abs(E),isNaN(E)||E===1/0?($=isNaN(E)?1:0,j=F):(j=Math.floor(Math.log(E)/Math.LN2),E*(L=Math.pow(2,-j))<1&&(j--,L*=2),j+K>=1?E+=q/L:E+=q*Math.pow(2,1-K),E*L>=2&&(j++,L/=2),j+K>=F?($=0,j=F):j+K>=1?($=(E*L-1)*Math.pow(2,R),j=j+K):($=E*Math.pow(2,K-1)*Math.pow(2,R),j=0));R>=8;S[C+de]=$&255,de+=re,$/=256,R-=8);for(j=j<<R|$,X+=R;X>0;S[C+de]=j&255,de+=re,j/=256,X-=8);S[C+de-re]|=Y*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(S){const E=n,C=w,k=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;S.Buffer=F,S.SlowBuffer=oe,S.INSPECT_MAX_BYTES=50;const R=2147483647;S.kMaxLength=R;const{Uint8Array:O,ArrayBuffer:j,SharedArrayBuffer:$}=globalThis;F.TYPED_ARRAY_SUPPORT=L(),!F.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function L(){try{const H=new O(1),U={foo:function(){return 42}};return Object.setPrototypeOf(U,O.prototype),Object.setPrototypeOf(H,U),H.foo()===42}catch{return!1}}Object.defineProperty(F.prototype,"parent",{enumerable:!0,get:function(){if(F.isBuffer(this))return this.buffer}}),Object.defineProperty(F.prototype,"offset",{enumerable:!0,get:function(){if(F.isBuffer(this))return this.byteOffset}});function X(H){if(H>R)throw new RangeError('The value "'+H+'" is invalid for option "size"');const U=new O(H);return Object.setPrototypeOf(U,F.prototype),U}function F(H,U,W){if(typeof H=="number"){if(typeof U=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return re(H)}return K(H,U,W)}F.poolSize=8192;function K(H,U,W){if(typeof H=="string")return Y(H,U);if(j.isView(H))return ae(H);if(H==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H);if(ye(H,j)||H&&ye(H.buffer,j)||typeof $<"u"&&(ye(H,$)||H&&ye(H.buffer,$)))return B(H,U,W);if(typeof H=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const he=H.valueOf&&H.valueOf();if(he!=null&&he!==H)return F.from(he,U,W);const Ae=J(H);if(Ae)return Ae;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof H[Symbol.toPrimitive]=="function")return F.from(H[Symbol.toPrimitive]("string"),U,W);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H)}F.from=function(H,U,W){return K(H,U,W)},Object.setPrototypeOf(F.prototype,O.prototype),Object.setPrototypeOf(F,O);function q(H){if(typeof H!="number")throw new TypeError('"size" argument must be of type number');if(H<0)throw new RangeError('The value "'+H+'" is invalid for option "size"')}function de(H,U,W){return q(H),H<=0?X(H):U!==void 0?typeof W=="string"?X(H).fill(U,W):X(H).fill(U):X(H)}F.alloc=function(H,U,W){return de(H,U,W)};function re(H){return q(H),X(H<0?0:ee(H)|0)}F.allocUnsafe=function(H){return re(H)},F.allocUnsafeSlow=function(H){return re(H)};function Y(H,U){if((typeof U!="string"||U==="")&&(U="utf8"),!F.isEncoding(U))throw new TypeError("Unknown encoding: "+U);const W=me(H,U)|0;let he=X(W);const Ae=he.write(H,U);return Ae!==W&&(he=he.slice(0,Ae)),he}function Q(H){const U=H.length<0?0:ee(H.length)|0,W=X(U);for(let he=0;he<U;he+=1)W[he]=H[he]&255;return W}function ae(H){if(ye(H,O)){const U=new O(H);return B(U.buffer,U.byteOffset,U.byteLength)}return Q(H)}function B(H,U,W){if(U<0||H.byteLength<U)throw new RangeError('"offset" is outside of buffer bounds');if(H.byteLength<U+(W||0))throw new RangeError('"length" is outside of buffer bounds');let he;return U===void 0&&W===void 0?he=new O(H):W===void 0?he=new O(H,U):he=new O(H,U,W),Object.setPrototypeOf(he,F.prototype),he}function J(H){if(F.isBuffer(H)){const U=ee(H.length)|0,W=X(U);return W.length===0||H.copy(W,0,0,U),W}if(H.length!==void 0)return typeof H.length!="number"||Oe(H.length)?X(0):Q(H);if(H.type==="Buffer"&&Array.isArray(H.data))return Q(H.data)}function ee(H){if(H>=R)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+R.toString(16)+" bytes");return H|0}function oe(H){return+H!=H&&(H=0),F.alloc(+H)}F.isBuffer=function(U){return U!=null&&U._isBuffer===!0&&U!==F.prototype},F.compare=function(U,W){if(ye(U,O)&&(U=F.from(U,U.offset,U.byteLength)),ye(W,O)&&(W=F.from(W,W.offset,W.byteLength)),!F.isBuffer(U)||!F.isBuffer(W))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(U===W)return 0;let he=U.length,Ae=W.length;for(let qe=0,pt=Math.min(he,Ae);qe<pt;++qe)if(U[qe]!==W[qe]){he=U[qe],Ae=W[qe];break}return he<Ae?-1:Ae<he?1:0},F.isEncoding=function(U){switch(String(U).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},F.concat=function(U,W){if(!Array.isArray(U))throw new TypeError('"list" argument must be an Array of Buffers');if(U.length===0)return F.alloc(0);let he;if(W===void 0)for(W=0,he=0;he<U.length;++he)W+=U[he].length;const Ae=F.allocUnsafe(W);let qe=0;for(he=0;he<U.length;++he){let pt=U[he];if(ye(pt,O))qe+pt.length>Ae.length?(F.isBuffer(pt)||(pt=F.from(pt)),pt.copy(Ae,qe)):O.prototype.set.call(Ae,pt,qe);else if(F.isBuffer(pt))pt.copy(Ae,qe);else throw new TypeError('"list" argument must be an Array of Buffers');qe+=pt.length}return Ae};function me(H,U){if(F.isBuffer(H))return H.length;if(j.isView(H)||ye(H,j))return H.byteLength;if(typeof H!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof H);const W=H.length,he=arguments.length>2&&arguments[2]===!0;if(!he&&W===0)return 0;let Ae=!1;for(;;)switch(U){case"ascii":case"latin1":case"binary":return W;case"utf8":case"utf-8":return ft(H).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W*2;case"hex":return W>>>1;case"base64":return Be(H).length;default:if(Ae)return he?-1:ft(H).length;U=(""+U).toLowerCase(),Ae=!0}}F.byteLength=me;function xe(H,U,W){let he=!1;if((U===void 0||U<0)&&(U=0),U>this.length||((W===void 0||W>this.length)&&(W=this.length),W<=0)||(W>>>=0,U>>>=0,W<=U))return"";for(H||(H="utf8");;)switch(H){case"hex":return _e(this,U,W);case"utf8":case"utf-8":return ge(this,U,W);case"ascii":return ie(this,U,W);case"latin1":case"binary":return te(this,U,W);case"base64":return V(this,U,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Me(this,U,W);default:if(he)throw new TypeError("Unknown encoding: "+H);H=(H+"").toLowerCase(),he=!0}}F.prototype._isBuffer=!0;function Pe(H,U,W){const he=H[U];H[U]=H[W],H[W]=he}F.prototype.swap16=function(){const U=this.length;if(U%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let W=0;W<U;W+=2)Pe(this,W,W+1);return this},F.prototype.swap32=function(){const U=this.length;if(U%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let W=0;W<U;W+=4)Pe(this,W,W+3),Pe(this,W+1,W+2);return this},F.prototype.swap64=function(){const U=this.length;if(U%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let W=0;W<U;W+=8)Pe(this,W,W+7),Pe(this,W+1,W+6),Pe(this,W+2,W+5),Pe(this,W+3,W+4);return this},F.prototype.toString=function(){const U=this.length;return U===0?"":arguments.length===0?ge(this,0,U):xe.apply(this,arguments)},F.prototype.toLocaleString=F.prototype.toString,F.prototype.equals=function(U){if(!F.isBuffer(U))throw new TypeError("Argument must be a Buffer");return this===U?!0:F.compare(this,U)===0},F.prototype.inspect=function(){let U="";const W=S.INSPECT_MAX_BYTES;return U=this.toString("hex",0,W).replace(/(.{2})/g,"$1 ").trim(),this.length>W&&(U+=" ... "),"<Buffer "+U+">"},k&&(F.prototype[k]=F.prototype.inspect),F.prototype.compare=function(U,W,he,Ae,qe){if(ye(U,O)&&(U=F.from(U,U.offset,U.byteLength)),!F.isBuffer(U))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof U);if(W===void 0&&(W=0),he===void 0&&(he=U?U.length:0),Ae===void 0&&(Ae=0),qe===void 0&&(qe=this.length),W<0||he>U.length||Ae<0||qe>this.length)throw new RangeError("out of range index");if(Ae>=qe&&W>=he)return 0;if(Ae>=qe)return-1;if(W>=he)return 1;if(W>>>=0,he>>>=0,Ae>>>=0,qe>>>=0,this===U)return 0;let pt=qe-Ae,Gt=he-W;const ut=Math.min(pt,Gt),Tt=this.slice(Ae,qe),Pt=U.slice(W,he);for(let Jt=0;Jt<ut;++Jt)if(Tt[Jt]!==Pt[Jt]){pt=Tt[Jt],Gt=Pt[Jt];break}return pt<Gt?-1:Gt<pt?1:0};function Ne(H,U,W,he,Ae){if(H.length===0)return-1;if(typeof W=="string"?(he=W,W=0):W>2147483647?W=2147483647:W<-2147483648&&(W=-2147483648),W=+W,Oe(W)&&(W=Ae?0:H.length-1),W<0&&(W=H.length+W),W>=H.length){if(Ae)return-1;W=H.length-1}else if(W<0)if(Ae)W=0;else return-1;if(typeof U=="string"&&(U=F.from(U,he)),F.isBuffer(U))return U.length===0?-1:Re(H,U,W,he,Ae);if(typeof U=="number")return U=U&255,typeof O.prototype.indexOf=="function"?Ae?O.prototype.indexOf.call(H,U,W):O.prototype.lastIndexOf.call(H,U,W):Re(H,[U],W,he,Ae);throw new TypeError("val must be string, number or Buffer")}function Re(H,U,W,he,Ae){let qe=1,pt=H.length,Gt=U.length;if(he!==void 0&&(he=String(he).toLowerCase(),he==="ucs2"||he==="ucs-2"||he==="utf16le"||he==="utf-16le")){if(H.length<2||U.length<2)return-1;qe=2,pt/=2,Gt/=2,W/=2}function ut(Pt,Jt){return qe===1?Pt[Jt]:Pt.readUInt16BE(Jt*qe)}let Tt;if(Ae){let Pt=-1;for(Tt=W;Tt<pt;Tt++)if(ut(H,Tt)===ut(U,Pt===-1?0:Tt-Pt)){if(Pt===-1&&(Pt=Tt),Tt-Pt+1===Gt)return Pt*qe}else Pt!==-1&&(Tt-=Tt-Pt),Pt=-1}else for(W+Gt>pt&&(W=pt-Gt),Tt=W;Tt>=0;Tt--){let Pt=!0;for(let Jt=0;Jt<Gt;Jt++)if(ut(H,Tt+Jt)!==ut(U,Jt)){Pt=!1;break}if(Pt)return Tt}return-1}F.prototype.includes=function(U,W,he){return this.indexOf(U,W,he)!==-1},F.prototype.indexOf=function(U,W,he){return Ne(this,U,W,he,!0)},F.prototype.lastIndexOf=function(U,W,he){return Ne(this,U,W,he,!1)};function ke(H,U,W,he){W=Number(W)||0;const Ae=H.length-W;he?(he=Number(he),he>Ae&&(he=Ae)):he=Ae;const qe=U.length;he>qe/2&&(he=qe/2);let pt;for(pt=0;pt<he;++pt){const Gt=parseInt(U.substr(pt*2,2),16);if(Oe(Gt))return pt;H[W+pt]=Gt}return pt}function Fe(H,U,W,he){return nt(ft(U,H.length-W),H,W,he)}function Qe(H,U,W,he){return nt(vt(U),H,W,he)}function Le(H,U,W,he){return nt(Be(U),H,W,he)}function Ie(H,U,W,he){return nt(M(U,H.length-W),H,W,he)}F.prototype.write=function(U,W,he,Ae){if(W===void 0)Ae="utf8",he=this.length,W=0;else if(he===void 0&&typeof W=="string")Ae=W,he=this.length,W=0;else if(isFinite(W))W=W>>>0,isFinite(he)?(he=he>>>0,Ae===void 0&&(Ae="utf8")):(Ae=he,he=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const qe=this.length-W;if((he===void 0||he>qe)&&(he=qe),U.length>0&&(he<0||W<0)||W>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ae||(Ae="utf8");let pt=!1;for(;;)switch(Ae){case"hex":return ke(this,U,W,he);case"utf8":case"utf-8":return Fe(this,U,W,he);case"ascii":case"latin1":case"binary":return Qe(this,U,W,he);case"base64":return Le(this,U,W,he);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ie(this,U,W,he);default:if(pt)throw new TypeError("Unknown encoding: "+Ae);Ae=(""+Ae).toLowerCase(),pt=!0}},F.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V(H,U,W){return U===0&&W===H.length?E.fromByteArray(H):E.fromByteArray(H.slice(U,W))}function ge(H,U,W){W=Math.min(H.length,W);const he=[];let Ae=U;for(;Ae<W;){const qe=H[Ae];let pt=null,Gt=qe>239?4:qe>223?3:qe>191?2:1;if(Ae+Gt<=W){let ut,Tt,Pt,Jt;switch(Gt){case 1:qe<128&&(pt=qe);break;case 2:ut=H[Ae+1],(ut&192)===128&&(Jt=(qe&31)<<6|ut&63,Jt>127&&(pt=Jt));break;case 3:ut=H[Ae+1],Tt=H[Ae+2],(ut&192)===128&&(Tt&192)===128&&(Jt=(qe&15)<<12|(ut&63)<<6|Tt&63,Jt>2047&&(Jt<55296||Jt>57343)&&(pt=Jt));break;case 4:ut=H[Ae+1],Tt=H[Ae+2],Pt=H[Ae+3],(ut&192)===128&&(Tt&192)===128&&(Pt&192)===128&&(Jt=(qe&15)<<18|(ut&63)<<12|(Tt&63)<<6|Pt&63,Jt>65535&&Jt<1114112&&(pt=Jt))}}pt===null?(pt=65533,Gt=1):pt>65535&&(pt-=65536,he.push(pt>>>10&1023|55296),pt=56320|pt&1023),he.push(pt),Ae+=Gt}return le(he)}const Te=4096;function le(H){const U=H.length;if(U<=Te)return String.fromCharCode.apply(String,H);let W="",he=0;for(;he<U;)W+=String.fromCharCode.apply(String,H.slice(he,he+=Te));return W}function ie(H,U,W){let he="";W=Math.min(H.length,W);for(let Ae=U;Ae<W;++Ae)he+=String.fromCharCode(H[Ae]&127);return he}function te(H,U,W){let he="";W=Math.min(H.length,W);for(let Ae=U;Ae<W;++Ae)he+=String.fromCharCode(H[Ae]);return he}function _e(H,U,W){const he=H.length;(!U||U<0)&&(U=0),(!W||W<0||W>he)&&(W=he);let Ae="";for(let qe=U;qe<W;++qe)Ae+=Ke[H[qe]];return Ae}function Me(H,U,W){const he=H.slice(U,W);let Ae="";for(let qe=0;qe<he.length-1;qe+=2)Ae+=String.fromCharCode(he[qe]+he[qe+1]*256);return Ae}F.prototype.slice=function(U,W){const he=this.length;U=~~U,W=W===void 0?he:~~W,U<0?(U+=he,U<0&&(U=0)):U>he&&(U=he),W<0?(W+=he,W<0&&(W=0)):W>he&&(W=he),W<U&&(W=U);const Ae=this.subarray(U,W);return Object.setPrototypeOf(Ae,F.prototype),Ae};function Ee(H,U,W){if(H%1!==0||H<0)throw new RangeError("offset is not uint");if(H+U>W)throw new RangeError("Trying to access beyond buffer length")}F.prototype.readUintLE=F.prototype.readUIntLE=function(U,W,he){U=U>>>0,W=W>>>0,he||Ee(U,W,this.length);let Ae=this[U],qe=1,pt=0;for(;++pt<W&&(qe*=256);)Ae+=this[U+pt]*qe;return Ae},F.prototype.readUintBE=F.prototype.readUIntBE=function(U,W,he){U=U>>>0,W=W>>>0,he||Ee(U,W,this.length);let Ae=this[U+--W],qe=1;for(;W>0&&(qe*=256);)Ae+=this[U+--W]*qe;return Ae},F.prototype.readUint8=F.prototype.readUInt8=function(U,W){return U=U>>>0,W||Ee(U,1,this.length),this[U]},F.prototype.readUint16LE=F.prototype.readUInt16LE=function(U,W){return U=U>>>0,W||Ee(U,2,this.length),this[U]|this[U+1]<<8},F.prototype.readUint16BE=F.prototype.readUInt16BE=function(U,W){return U=U>>>0,W||Ee(U,2,this.length),this[U]<<8|this[U+1]},F.prototype.readUint32LE=F.prototype.readUInt32LE=function(U,W){return U=U>>>0,W||Ee(U,4,this.length),(this[U]|this[U+1]<<8|this[U+2]<<16)+this[U+3]*16777216},F.prototype.readUint32BE=F.prototype.readUInt32BE=function(U,W){return U=U>>>0,W||Ee(U,4,this.length),this[U]*16777216+(this[U+1]<<16|this[U+2]<<8|this[U+3])},F.prototype.readBigUInt64LE=Rt(function(U){U=U>>>0,je(U,"offset");const W=this[U],he=this[U+7];(W===void 0||he===void 0)&&ve(U,this.length-8);const Ae=W+this[++U]*2**8+this[++U]*2**16+this[++U]*2**24,qe=this[++U]+this[++U]*2**8+this[++U]*2**16+he*2**24;return BigInt(Ae)+(BigInt(qe)<<BigInt(32))}),F.prototype.readBigUInt64BE=Rt(function(U){U=U>>>0,je(U,"offset");const W=this[U],he=this[U+7];(W===void 0||he===void 0)&&ve(U,this.length-8);const Ae=W*2**24+this[++U]*2**16+this[++U]*2**8+this[++U],qe=this[++U]*2**24+this[++U]*2**16+this[++U]*2**8+he;return(BigInt(Ae)<<BigInt(32))+BigInt(qe)}),F.prototype.readIntLE=function(U,W,he){U=U>>>0,W=W>>>0,he||Ee(U,W,this.length);let Ae=this[U],qe=1,pt=0;for(;++pt<W&&(qe*=256);)Ae+=this[U+pt]*qe;return qe*=128,Ae>=qe&&(Ae-=Math.pow(2,8*W)),Ae},F.prototype.readIntBE=function(U,W,he){U=U>>>0,W=W>>>0,he||Ee(U,W,this.length);let Ae=W,qe=1,pt=this[U+--Ae];for(;Ae>0&&(qe*=256);)pt+=this[U+--Ae]*qe;return qe*=128,pt>=qe&&(pt-=Math.pow(2,8*W)),pt},F.prototype.readInt8=function(U,W){return U=U>>>0,W||Ee(U,1,this.length),this[U]&128?(255-this[U]+1)*-1:this[U]},F.prototype.readInt16LE=function(U,W){U=U>>>0,W||Ee(U,2,this.length);const he=this[U]|this[U+1]<<8;return he&32768?he|4294901760:he},F.prototype.readInt16BE=function(U,W){U=U>>>0,W||Ee(U,2,this.length);const he=this[U+1]|this[U]<<8;return he&32768?he|4294901760:he},F.prototype.readInt32LE=function(U,W){return U=U>>>0,W||Ee(U,4,this.length),this[U]|this[U+1]<<8|this[U+2]<<16|this[U+3]<<24},F.prototype.readInt32BE=function(U,W){return U=U>>>0,W||Ee(U,4,this.length),this[U]<<24|this[U+1]<<16|this[U+2]<<8|this[U+3]},F.prototype.readBigInt64LE=Rt(function(U){U=U>>>0,je(U,"offset");const W=this[U],he=this[U+7];(W===void 0||he===void 0)&&ve(U,this.length-8);const Ae=this[U+4]+this[U+5]*2**8+this[U+6]*2**16+(he<<24);return(BigInt(Ae)<<BigInt(32))+BigInt(W+this[++U]*2**8+this[++U]*2**16+this[++U]*2**24)}),F.prototype.readBigInt64BE=Rt(function(U){U=U>>>0,je(U,"offset");const W=this[U],he=this[U+7];(W===void 0||he===void 0)&&ve(U,this.length-8);const Ae=(W<<24)+this[++U]*2**16+this[++U]*2**8+this[++U];return(BigInt(Ae)<<BigInt(32))+BigInt(this[++U]*2**24+this[++U]*2**16+this[++U]*2**8+he)}),F.prototype.readFloatLE=function(U,W){return U=U>>>0,W||Ee(U,4,this.length),C.read(this,U,!0,23,4)},F.prototype.readFloatBE=function(U,W){return U=U>>>0,W||Ee(U,4,this.length),C.read(this,U,!1,23,4)},F.prototype.readDoubleLE=function(U,W){return U=U>>>0,W||Ee(U,8,this.length),C.read(this,U,!0,52,8)},F.prototype.readDoubleBE=function(U,W){return U=U>>>0,W||Ee(U,8,this.length),C.read(this,U,!1,52,8)};function We(H,U,W,he,Ae,qe){if(!F.isBuffer(H))throw new TypeError('"buffer" argument must be a Buffer instance');if(U>Ae||U<qe)throw new RangeError('"value" argument is out of bounds');if(W+he>H.length)throw new RangeError("Index out of range")}F.prototype.writeUintLE=F.prototype.writeUIntLE=function(U,W,he,Ae){if(U=+U,W=W>>>0,he=he>>>0,!Ae){const Gt=Math.pow(2,8*he)-1;We(this,U,W,he,Gt,0)}let qe=1,pt=0;for(this[W]=U&255;++pt<he&&(qe*=256);)this[W+pt]=U/qe&255;return W+he},F.prototype.writeUintBE=F.prototype.writeUIntBE=function(U,W,he,Ae){if(U=+U,W=W>>>0,he=he>>>0,!Ae){const Gt=Math.pow(2,8*he)-1;We(this,U,W,he,Gt,0)}let qe=he-1,pt=1;for(this[W+qe]=U&255;--qe>=0&&(pt*=256);)this[W+qe]=U/pt&255;return W+he},F.prototype.writeUint8=F.prototype.writeUInt8=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,1,255,0),this[W]=U&255,W+1},F.prototype.writeUint16LE=F.prototype.writeUInt16LE=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,2,65535,0),this[W]=U&255,this[W+1]=U>>>8,W+2},F.prototype.writeUint16BE=F.prototype.writeUInt16BE=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,2,65535,0),this[W]=U>>>8,this[W+1]=U&255,W+2},F.prototype.writeUint32LE=F.prototype.writeUInt32LE=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,4,4294967295,0),this[W+3]=U>>>24,this[W+2]=U>>>16,this[W+1]=U>>>8,this[W]=U&255,W+4},F.prototype.writeUint32BE=F.prototype.writeUInt32BE=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,4,4294967295,0),this[W]=U>>>24,this[W+1]=U>>>16,this[W+2]=U>>>8,this[W+3]=U&255,W+4};function kt(H,U,W,he,Ae){fe(U,he,Ae,H,W,7);let qe=Number(U&BigInt(4294967295));H[W++]=qe,qe=qe>>8,H[W++]=qe,qe=qe>>8,H[W++]=qe,qe=qe>>8,H[W++]=qe;let pt=Number(U>>BigInt(32)&BigInt(4294967295));return H[W++]=pt,pt=pt>>8,H[W++]=pt,pt=pt>>8,H[W++]=pt,pt=pt>>8,H[W++]=pt,W}function it(H,U,W,he,Ae){fe(U,he,Ae,H,W,7);let qe=Number(U&BigInt(4294967295));H[W+7]=qe,qe=qe>>8,H[W+6]=qe,qe=qe>>8,H[W+5]=qe,qe=qe>>8,H[W+4]=qe;let pt=Number(U>>BigInt(32)&BigInt(4294967295));return H[W+3]=pt,pt=pt>>8,H[W+2]=pt,pt=pt>>8,H[W+1]=pt,pt=pt>>8,H[W]=pt,W+8}F.prototype.writeBigUInt64LE=Rt(function(U,W=0){return kt(this,U,W,BigInt(0),BigInt("0xffffffffffffffff"))}),F.prototype.writeBigUInt64BE=Rt(function(U,W=0){return it(this,U,W,BigInt(0),BigInt("0xffffffffffffffff"))}),F.prototype.writeIntLE=function(U,W,he,Ae){if(U=+U,W=W>>>0,!Ae){const ut=Math.pow(2,8*he-1);We(this,U,W,he,ut-1,-ut)}let qe=0,pt=1,Gt=0;for(this[W]=U&255;++qe<he&&(pt*=256);)U<0&&Gt===0&&this[W+qe-1]!==0&&(Gt=1),this[W+qe]=(U/pt>>0)-Gt&255;return W+he},F.prototype.writeIntBE=function(U,W,he,Ae){if(U=+U,W=W>>>0,!Ae){const ut=Math.pow(2,8*he-1);We(this,U,W,he,ut-1,-ut)}let qe=he-1,pt=1,Gt=0;for(this[W+qe]=U&255;--qe>=0&&(pt*=256);)U<0&&Gt===0&&this[W+qe+1]!==0&&(Gt=1),this[W+qe]=(U/pt>>0)-Gt&255;return W+he},F.prototype.writeInt8=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,1,127,-128),U<0&&(U=255+U+1),this[W]=U&255,W+1},F.prototype.writeInt16LE=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,2,32767,-32768),this[W]=U&255,this[W+1]=U>>>8,W+2},F.prototype.writeInt16BE=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,2,32767,-32768),this[W]=U>>>8,this[W+1]=U&255,W+2},F.prototype.writeInt32LE=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,4,2147483647,-2147483648),this[W]=U&255,this[W+1]=U>>>8,this[W+2]=U>>>16,this[W+3]=U>>>24,W+4},F.prototype.writeInt32BE=function(U,W,he){return U=+U,W=W>>>0,he||We(this,U,W,4,2147483647,-2147483648),U<0&&(U=4294967295+U+1),this[W]=U>>>24,this[W+1]=U>>>16,this[W+2]=U>>>8,this[W+3]=U&255,W+4},F.prototype.writeBigInt64LE=Rt(function(U,W=0){return kt(this,U,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),F.prototype.writeBigInt64BE=Rt(function(U,W=0){return it(this,U,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function xt(H,U,W,he,Ae,qe){if(W+he>H.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("Index out of range")}function Dt(H,U,W,he,Ae){return U=+U,W=W>>>0,Ae||xt(H,U,W,4),C.write(H,U,W,he,23,4),W+4}F.prototype.writeFloatLE=function(U,W,he){return Dt(this,U,W,!0,he)},F.prototype.writeFloatBE=function(U,W,he){return Dt(this,U,W,!1,he)};function Ot(H,U,W,he,Ae){return U=+U,W=W>>>0,Ae||xt(H,U,W,8),C.write(H,U,W,he,52,8),W+8}F.prototype.writeDoubleLE=function(U,W,he){return Ot(this,U,W,!0,he)},F.prototype.writeDoubleBE=function(U,W,he){return Ot(this,U,W,!1,he)},F.prototype.copy=function(U,W,he,Ae){if(!F.isBuffer(U))throw new TypeError("argument should be a Buffer");if(he||(he=0),!Ae&&Ae!==0&&(Ae=this.length),W>=U.length&&(W=U.length),W||(W=0),Ae>0&&Ae<he&&(Ae=he),Ae===he||U.length===0||this.length===0)return 0;if(W<0)throw new RangeError("targetStart out of bounds");if(he<0||he>=this.length)throw new RangeError("Index out of range");if(Ae<0)throw new RangeError("sourceEnd out of bounds");Ae>this.length&&(Ae=this.length),U.length-W<Ae-he&&(Ae=U.length-W+he);const qe=Ae-he;return this===U&&typeof O.prototype.copyWithin=="function"?this.copyWithin(W,he,Ae):O.prototype.set.call(U,this.subarray(he,Ae),W),qe},F.prototype.fill=function(U,W,he,Ae){if(typeof U=="string"){if(typeof W=="string"?(Ae=W,W=0,he=this.length):typeof he=="string"&&(Ae=he,he=this.length),Ae!==void 0&&typeof Ae!="string")throw new TypeError("encoding must be a string");if(typeof Ae=="string"&&!F.isEncoding(Ae))throw new TypeError("Unknown encoding: "+Ae);if(U.length===1){const pt=U.charCodeAt(0);(Ae==="utf8"&&pt<128||Ae==="latin1")&&(U=pt)}}else typeof U=="number"?U=U&255:typeof U=="boolean"&&(U=Number(U));if(W<0||this.length<W||this.length<he)throw new RangeError("Out of range index");if(he<=W)return this;W=W>>>0,he=he===void 0?this.length:he>>>0,U||(U=0);let qe;if(typeof U=="number")for(qe=W;qe<he;++qe)this[qe]=U;else{const pt=F.isBuffer(U)?U:F.from(U,Ae),Gt=pt.length;if(Gt===0)throw new TypeError('The value "'+U+'" is invalid for argument "value"');for(qe=0;qe<he-W;++qe)this[qe+W]=pt[qe%Gt]}return this};const Wt={};function be(H,U,W){Wt[H]=class extends W{constructor(){super(),Object.defineProperty(this,"message",{value:U.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${H}]`,this.stack,delete this.name}get code(){return H}set code(Ae){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ae,writable:!0})}toString(){return`${this.name} [${H}]: ${this.message}`}}}be("ERR_BUFFER_OUT_OF_BOUNDS",function(H){return H?`${H} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),be("ERR_INVALID_ARG_TYPE",function(H,U){return`The "${H}" argument must be of type number. Received type ${typeof U}`},TypeError),be("ERR_OUT_OF_RANGE",function(H,U,W){let he=`The value of "${H}" is out of range.`,Ae=W;return Number.isInteger(W)&&Math.abs(W)>2**32?Ae=I(String(W)):typeof W=="bigint"&&(Ae=String(W),(W>BigInt(2)**BigInt(32)||W<-(BigInt(2)**BigInt(32)))&&(Ae=I(Ae)),Ae+="n"),he+=` It must be ${U}. Received ${Ae}`,he},RangeError);function I(H){let U="",W=H.length;const he=H[0]==="-"?1:0;for(;W>=he+4;W-=3)U=`_${H.slice(W-3,W)}${U}`;return`${H.slice(0,W)}${U}`}function G(H,U,W){je(U,"offset"),(H[U]===void 0||H[U+W]===void 0)&&ve(U,H.length-(W+1))}function fe(H,U,W,he,Ae,qe){if(H>W||H<U){const pt=typeof U=="bigint"?"n":"";let Gt;throw U===0||U===BigInt(0)?Gt=`>= 0${pt} and < 2${pt} ** ${(qe+1)*8}${pt}`:Gt=`>= -(2${pt} ** ${(qe+1)*8-1}${pt}) and < 2 ** ${(qe+1)*8-1}${pt}`,new Wt.ERR_OUT_OF_RANGE("value",Gt,H)}G(he,Ae,qe)}function je(H,U){if(typeof H!="number")throw new Wt.ERR_INVALID_ARG_TYPE(U,"number",H)}function ve(H,U,W){throw Math.floor(H)!==H?(je(H,W),new Wt.ERR_OUT_OF_RANGE("offset","an integer",H)):U<0?new Wt.ERR_BUFFER_OUT_OF_BOUNDS:new Wt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${U}`,H)}const Ce=/[^+/0-9A-Za-z-_]/g;function ce(H){if(H=H.split("=")[0],H=H.trim().replace(Ce,""),H.length<2)return"";for(;H.length%4!==0;)H=H+"=";return H}function ft(H,U){U=U||1/0;let W;const he=H.length;let Ae=null;const qe=[];for(let pt=0;pt<he;++pt){if(W=H.charCodeAt(pt),W>55295&&W<57344){if(!Ae){if(W>56319){(U-=3)>-1&&qe.push(239,191,189);continue}else if(pt+1===he){(U-=3)>-1&&qe.push(239,191,189);continue}Ae=W;continue}if(W<56320){(U-=3)>-1&&qe.push(239,191,189),Ae=W;continue}W=(Ae-55296<<10|W-56320)+65536}else Ae&&(U-=3)>-1&&qe.push(239,191,189);if(Ae=null,W<128){if((U-=1)<0)break;qe.push(W)}else if(W<2048){if((U-=2)<0)break;qe.push(W>>6|192,W&63|128)}else if(W<65536){if((U-=3)<0)break;qe.push(W>>12|224,W>>6&63|128,W&63|128)}else if(W<1114112){if((U-=4)<0)break;qe.push(W>>18|240,W>>12&63|128,W>>6&63|128,W&63|128)}else throw new Error("Invalid code point")}return qe}function vt(H){const U=[];for(let W=0;W<H.length;++W)U.push(H.charCodeAt(W)&255);return U}function M(H,U){let W,he,Ae;const qe=[];for(let pt=0;pt<H.length&&!((U-=2)<0);++pt)W=H.charCodeAt(pt),he=W>>8,Ae=W%256,qe.push(Ae),qe.push(he);return qe}function Be(H){return E.toByteArray(ce(H))}function nt(H,U,W,he){let Ae;for(Ae=0;Ae<he&&!(Ae+W>=U.length||Ae>=H.length);++Ae)U[Ae+W]=H[Ae];return Ae}function ye(H,U){return H instanceof U||H!=null&&H.constructor!=null&&H.constructor.name!=null&&H.constructor.name===U.name}function Oe(H){return H!==H}const Ke=function(){const H="0123456789abcdef",U=new Array(256);for(let W=0;W<16;++W){const he=W*16;for(let Ae=0;Ae<16;++Ae)U[he+Ae]=H[W]+H[Ae]}return U}();function Rt(H){return typeof BigInt>"u"?pe:H}function pe(){throw new Error("BigInt not supported")}})(t);const x=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=x,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(kS)),kS}var TS,K3;function Xr(){if(K3)return TS;K3=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let a=0;a<n.length;a++)r+=`    ${n[a].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return TS={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},TS}var AS={exports:{}},NS,Z3;function xP(){return Z3||(Z3=1,NS={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const a=t.shift();return r==="f"?a.toFixed(6):r==="j"?JSON.stringify(a):r==="s"&&typeof a=="object"?`${a.constructor!==Object?a.constructor.name:""} {}`.trim():a.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),NS}var RS,Y3;function Ei(){if(Y3)return RS;Y3=1;const{format:e,inspect:t}=xP(),{AggregateError:n}=Xr(),r=globalThis.AggregateError||n,a=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],s=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function u(w,x){if(!w)throw new l.ERR_INTERNAL_ASSERTION(x)}function d(w){let x="",S=w.length;const E=w[0]==="-"?1:0;for(;S>=E+4;S-=3)x=`_${w.slice(S-3,S)}${x}`;return`${w.slice(0,S)}${x}`}function h(w,x,S){if(typeof x=="function")return u(x.length<=S.length,`Code: ${w}; The provided arguments length (${S.length}) does not match the required ones (${x.length}).`),x(...S);const E=(x.match(/%[dfijoOs]/g)||[]).length;return u(E===S.length,`Code: ${w}; The provided arguments length (${S.length}) does not match the required ones (${E}).`),S.length===0?x:e(x,...S)}function p(w,x,S){S||(S=Error);class E extends S{constructor(...k){super(h(w,x,k))}toString(){return`${this.name} [${w}]: ${this.message}`}}Object.defineProperties(E.prototype,{name:{value:S.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${w}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),E.prototype.code=w,E.prototype[a]=!0,l[w]=E}function y(w){const x=o+w.name;return Object.defineProperty(w,"name",{value:x}),w}function v(w,x){if(w&&x&&w!==x){if(Array.isArray(x.errors))return x.errors.push(w),x;const S=new r([x,w],x.message);return S.code=x.code,S}return w||x}class b extends Error{constructor(x="The operation was aborted",S=void 0){if(S!==void 0&&typeof S!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",S);super(x,S),this.code="ABORT_ERR",this.name="AbortError"}}return p("ERR_ASSERTION","%s",Error),p("ERR_INVALID_ARG_TYPE",(w,x,S)=>{u(typeof w=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let E="The ";w.endsWith(" argument")?E+=`${w} `:E+=`"${w}" ${w.includes(".")?"property":"argument"} `,E+="must be ";const C=[],k=[],R=[];for(const j of x)u(typeof j=="string","All expected entries have to be of type string"),i.includes(j)?C.push(j.toLowerCase()):s.test(j)?k.push(j):(u(j!=="object",'The value "object" should be written as "Object"'),R.push(j));if(k.length>0){const j=C.indexOf("object");j!==-1&&(C.splice(C,j,1),k.push("Object"))}if(C.length>0){switch(C.length){case 1:E+=`of type ${C[0]}`;break;case 2:E+=`one of type ${C[0]} or ${C[1]}`;break;default:{const j=C.pop();E+=`one of type ${C.join(", ")}, or ${j}`}}(k.length>0||R.length>0)&&(E+=" or ")}if(k.length>0){switch(k.length){case 1:E+=`an instance of ${k[0]}`;break;case 2:E+=`an instance of ${k[0]} or ${k[1]}`;break;default:{const j=k.pop();E+=`an instance of ${k.join(", ")}, or ${j}`}}R.length>0&&(E+=" or ")}switch(R.length){case 0:break;case 1:R[0].toLowerCase()!==R[0]&&(E+="an "),E+=`${R[0]}`;break;case 2:E+=`one of ${R[0]} or ${R[1]}`;break;default:{const j=R.pop();E+=`one of ${R.join(", ")}, or ${j}`}}if(S==null)E+=`. Received ${S}`;else if(typeof S=="function"&&S.name)E+=`. Received function ${S.name}`;else if(typeof S=="object"){var O;if((O=S.constructor)!==null&&O!==void 0&&O.name)E+=`. Received an instance of ${S.constructor.name}`;else{const j=t(S,{depth:-1});E+=`. Received ${j}`}}else{let j=t(S,{colors:!1});j.length>25&&(j=`${j.slice(0,25)}...`),E+=`. Received type ${typeof S} (${j})`}return E},TypeError),p("ERR_INVALID_ARG_VALUE",(w,x,S="is invalid")=>{let E=t(x);return E.length>128&&(E=E.slice(0,128)+"..."),`The ${w.includes(".")?"property":"argument"} '${w}' ${S}. Received ${E}`},TypeError),p("ERR_INVALID_RETURN_VALUE",(w,x,S)=>{var E;const C=S!=null&&(E=S.constructor)!==null&&E!==void 0&&E.name?`instance of ${S.constructor.name}`:`type ${typeof S}`;return`Expected ${w} to be returned from the "${x}" function but got ${C}.`},TypeError),p("ERR_MISSING_ARGS",(...w)=>{u(w.length>0,"At least one arg needs to be specified");let x;const S=w.length;switch(w=(Array.isArray(w)?w:[w]).map(E=>`"${E}"`).join(" or "),S){case 1:x+=`The ${w[0]} argument`;break;case 2:x+=`The ${w[0]} and ${w[1]} arguments`;break;default:{const E=w.pop();x+=`The ${w.join(", ")}, and ${E} arguments`}break}return`${x} must be specified`},TypeError),p("ERR_OUT_OF_RANGE",(w,x,S)=>{u(x,'Missing "range" argument');let E;if(Number.isInteger(S)&&Math.abs(S)>2**32)E=d(String(S));else if(typeof S=="bigint"){E=String(S);const C=BigInt(2)**BigInt(32);(S>C||S<-C)&&(E=d(E)),E+="n"}else E=t(S);return`The value of "${w}" is out of range. It must be ${x}. Received ${E}`},RangeError),p("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),p("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),p("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),p("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),p("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),p("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),p("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),p("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),p("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),p("ERR_STREAM_WRITE_AFTER_END","write after end",Error),p("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),RS={AbortError:b,aggregateTwoErrors:y(v),hideStackFrames:y,codes:l},RS}var Pm={exports:{}},X3;function Ag(){if(X3)return Pm.exports;X3=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Pm.exports=e,Pm.exports.AbortSignal=t,Pm.exports.default=e,Pm.exports}var Rb={exports:{}},J3;function ax(){if(J3)return Rb.exports;J3=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(k,R,O){return Function.prototype.apply.call(k,R,O)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:n=function(k){return Object.getOwnPropertyNames(k)};function r(C){console&&console.warn&&console.warn(C)}var a=Number.isNaN||function(k){return k!==k};function i(){i.init.call(this)}Rb.exports=i,Rb.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function o(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(C){if(typeof C!="number"||C<0||a(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");s=C}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||a(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function l(C){return C._maxListeners===void 0?i.defaultMaxListeners:C._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(k){for(var R=[],O=1;O<arguments.length;O++)R.push(arguments[O]);var j=k==="error",$=this._events;if($!==void 0)j=j&&$.error===void 0;else if(!j)return!1;if(j){var L;if(R.length>0&&(L=R[0]),L instanceof Error)throw L;var X=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw X.context=L,X}var F=$[k];if(F===void 0)return!1;if(typeof F=="function")t(F,this,R);else for(var K=F.length,q=v(F,K),O=0;O<K;++O)t(q[O],this,R);return!0};function u(C,k,R,O){var j,$,L;if(o(R),$=C._events,$===void 0?($=C._events=Object.create(null),C._eventsCount=0):($.newListener!==void 0&&(C.emit("newListener",k,R.listener?R.listener:R),$=C._events),L=$[k]),L===void 0)L=$[k]=R,++C._eventsCount;else if(typeof L=="function"?L=$[k]=O?[R,L]:[L,R]:O?L.unshift(R):L.push(R),j=l(C),j>0&&L.length>j&&!L.warned){L.warned=!0;var X=new Error("Possible EventEmitter memory leak detected. "+L.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");X.name="MaxListenersExceededWarning",X.emitter=C,X.type=k,X.count=L.length,r(X)}return C}i.prototype.addListener=function(k,R){return u(this,k,R,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(k,R){return u(this,k,R,!0)};function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(C,k,R){var O={fired:!1,wrapFn:void 0,target:C,type:k,listener:R},j=d.bind(O);return j.listener=R,O.wrapFn=j,j}i.prototype.once=function(k,R){return o(R),this.on(k,h(this,k,R)),this},i.prototype.prependOnceListener=function(k,R){return o(R),this.prependListener(k,h(this,k,R)),this},i.prototype.removeListener=function(k,R){var O,j,$,L,X;if(o(R),j=this._events,j===void 0)return this;if(O=j[k],O===void 0)return this;if(O===R||O.listener===R)--this._eventsCount===0?this._events=Object.create(null):(delete j[k],j.removeListener&&this.emit("removeListener",k,O.listener||R));else if(typeof O!="function"){for($=-1,L=O.length-1;L>=0;L--)if(O[L]===R||O[L].listener===R){X=O[L].listener,$=L;break}if($<0)return this;$===0?O.shift():b(O,$),O.length===1&&(j[k]=O[0]),j.removeListener!==void 0&&this.emit("removeListener",k,X||R)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(k){var R,O,j;if(O=this._events,O===void 0)return this;if(O.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):O[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete O[k]),this;if(arguments.length===0){var $=Object.keys(O),L;for(j=0;j<$.length;++j)L=$[j],L!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=O[k],typeof R=="function")this.removeListener(k,R);else if(R!==void 0)for(j=R.length-1;j>=0;j--)this.removeListener(k,R[j]);return this};function p(C,k,R){var O=C._events;if(O===void 0)return[];var j=O[k];return j===void 0?[]:typeof j=="function"?R?[j.listener||j]:[j]:R?w(j):v(j,j.length)}i.prototype.listeners=function(k){return p(this,k,!0)},i.prototype.rawListeners=function(k){return p(this,k,!1)},i.listenerCount=function(C,k){return typeof C.listenerCount=="function"?C.listenerCount(k):y.call(C,k)},i.prototype.listenerCount=y;function y(C){var k=this._events;if(k!==void 0){var R=k[C];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function v(C,k){for(var R=new Array(k),O=0;O<k;++O)R[O]=C[O];return R}function b(C,k){for(;k+1<C.length;k++)C[k]=C[k+1];C.pop()}function w(C){for(var k=new Array(C.length),R=0;R<k.length;++R)k[R]=C[R].listener||C[R];return k}function x(C,k){return new Promise(function(R,O){function j(L){C.removeListener(k,$),O(L)}function $(){typeof C.removeListener=="function"&&C.removeListener("error",j),R([].slice.call(arguments))}E(C,k,$,{once:!0}),k!=="error"&&S(C,j,{once:!0})})}function S(C,k,R){typeof C.on=="function"&&E(C,"error",k,R)}function E(C,k,R,O){if(typeof C.on=="function")O.once?C.once(k,R):C.on(k,R);else if(typeof C.addEventListener=="function")C.addEventListener(k,function j($){O.once&&C.removeEventListener(k,j),R($)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return Rb.exports}var Q3;function Di(){return Q3||(Q3=1,function(e){const t=Eu(),{format:n,inspect:r}=xP(),{codes:{ERR_INVALID_ARG_TYPE:a}}=Ei(),{kResistStopPropagation:i,AggregateError:s,SymbolDispose:o}=Xr(),l=globalThis.AbortSignal||Ag().AbortSignal,u=globalThis.AbortController||Ag().AbortController,d=Object.getPrototypeOf(async function(){}).constructor,h=globalThis.Blob||t.Blob,p=typeof h<"u"?function(w){return w instanceof h}:function(w){return!1},y=(b,w)=>{if(b!==void 0&&(b===null||typeof b!="object"||!("aborted"in b)))throw new a(w,"AbortSignal",b)},v=(b,w)=>{if(typeof b!="function")throw new a(w,"Function",b)};e.exports={AggregateError:s,kEmptyObject:Object.freeze({}),once(b){let w=!1;return function(...x){w||(w=!0,b.apply(this,x))}},createDeferredPromise:function(){let b,w;return{promise:new Promise((S,E)=>{b=S,w=E}),resolve:b,reject:w}},promisify(b){return new Promise((w,x)=>{b((S,...E)=>S?x(S):w(...E))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(b){return b instanceof d},isArrayBufferView(b){return ArrayBuffer.isView(b)}},isBlob:p,deprecate(b,w){return b},addAbortListener:ax().addAbortListener||function(w,x){if(w===void 0)throw new a("signal","AbortSignal",w);y(w,"signal"),v(x,"listener");let S;return w.aborted?queueMicrotask(()=>x()):(w.addEventListener("abort",x,{__proto__:null,once:!0,[i]:!0}),S=()=>{w.removeEventListener("abort",x)}),{__proto__:null,[o](){var E;(E=S)===null||E===void 0||E()}}},AbortSignalAny:l.any||function(w){if(w.length===1)return w[0];const x=new u,S=()=>x.abort();return w.forEach(E=>{y(E,"signals"),E.addEventListener("abort",S,{once:!0})}),x.signal.addEventListener("abort",()=>{w.forEach(E=>E.removeEventListener("abort",S))},{once:!0}),x.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(AS)),AS.exports}var Ib={},IS,ej;function w0(){if(ej)return IS;ej=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:a,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:s,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:u,RegExpPrototypeExec:d,String:h,StringPrototypeToUpperCase:p,StringPrototypeTrim:y}=Xr(),{hideStackFrames:v,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:w,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:S,ERR_UNKNOWN_SIGNAL:E}}=Ei(),{normalizeEncoding:C}=Di(),{isAsyncFunction:k,isArrayBufferView:R}=Di().types,O={};function j(te){return te===(te|0)}function $(te){return te===te>>>0}const L=/^[0-7]+$/,X="must be a 32-bit unsigned integer or an octal string";function F(te,_e,Me){if(typeof te>"u"&&(te=Me),typeof te=="string"){if(d(L,te)===null)throw new x(_e,te,X);te=l(te,8)}return de(te,_e),te}const K=v((te,_e,Me=o,Ee=s)=>{if(typeof te!="number")throw new w(_e,"number",te);if(!a(te))throw new S(_e,"an integer",te);if(te<Me||te>Ee)throw new S(_e,`>= ${Me} && <= ${Ee}`,te)}),q=v((te,_e,Me=-2147483648,Ee=2147483647)=>{if(typeof te!="number")throw new w(_e,"number",te);if(!a(te))throw new S(_e,"an integer",te);if(te<Me||te>Ee)throw new S(_e,`>= ${Me} && <= ${Ee}`,te)}),de=v((te,_e,Me=!1)=>{if(typeof te!="number")throw new w(_e,"number",te);if(!a(te))throw new S(_e,"an integer",te);const Ee=Me?1:0,We=4294967295;if(te<Ee||te>We)throw new S(_e,`>= ${Ee} && <= ${We}`,te)});function re(te,_e){if(typeof te!="string")throw new w(_e,"string",te)}function Y(te,_e,Me=void 0,Ee){if(typeof te!="number")throw new w(_e,"number",te);if(Me!=null&&te<Me||Ee!=null&&te>Ee||(Me!=null||Ee!=null)&&i(te))throw new S(_e,`${Me!=null?`>= ${Me}`:""}${Me!=null&&Ee!=null?" && ":""}${Ee!=null?`<= ${Ee}`:""}`,te)}const Q=v((te,_e,Me)=>{if(!t(Me,te)){const We="must be one of: "+n(r(Me,kt=>typeof kt=="string"?`'${kt}'`:h(kt)),", ");throw new x(_e,te,We)}});function ae(te,_e){if(typeof te!="boolean")throw new w(_e,"boolean",te)}function B(te,_e,Me){return te==null||!u(te,_e)?Me:te[_e]}const J=v((te,_e,Me=null)=>{const Ee=B(Me,"allowArray",!1),We=B(Me,"allowFunction",!1);if(!B(Me,"nullable",!1)&&te===null||!Ee&&e(te)||typeof te!="object"&&(!We||typeof te!="function"))throw new w(_e,"Object",te)}),ee=v((te,_e)=>{if(te!=null&&typeof te!="object"&&typeof te!="function")throw new w(_e,"a dictionary",te)}),oe=v((te,_e,Me=0)=>{if(!e(te))throw new w(_e,"Array",te);if(te.length<Me){const Ee=`must be longer than ${Me}`;throw new x(_e,te,Ee)}});function me(te,_e){oe(te,_e);for(let Me=0;Me<te.length;Me++)re(te[Me],`${_e}[${Me}]`)}function xe(te,_e){oe(te,_e);for(let Me=0;Me<te.length;Me++)ae(te[Me],`${_e}[${Me}]`)}function Pe(te,_e){oe(te,_e);for(let Me=0;Me<te.length;Me++){const Ee=te[Me],We=`${_e}[${Me}]`;if(Ee==null)throw new w(We,"AbortSignal",Ee);Qe(Ee,We)}}function Ne(te,_e="signal"){if(re(te,_e),O[te]===void 0)throw O[p(te)]!==void 0?new E(te+" (signals must use all capital letters)"):new E(te)}const Re=v((te,_e="buffer")=>{if(!R(te))throw new w(_e,["Buffer","TypedArray","DataView"],te)});function ke(te,_e){const Me=C(_e),Ee=te.length;if(Me==="hex"&&Ee%2!==0)throw new x("encoding",_e,`is invalid for data of length ${Ee}`)}function Fe(te,_e="Port",Me=!0){if(typeof te!="number"&&typeof te!="string"||typeof te=="string"&&y(te).length===0||+te!==+te>>>0||te>65535||te===0&&!Me)throw new b(_e,te,Me);return te|0}const Qe=v((te,_e)=>{if(te!==void 0&&(te===null||typeof te!="object"||!("aborted"in te)))throw new w(_e,"AbortSignal",te)}),Le=v((te,_e)=>{if(typeof te!="function")throw new w(_e,"Function",te)}),Ie=v((te,_e)=>{if(typeof te!="function"||k(te))throw new w(_e,"Function",te)}),V=v((te,_e)=>{if(te!==void 0)throw new w(_e,"undefined",te)});function ge(te,_e,Me){if(!t(Me,te))throw new w(_e,`('${n(Me,"|")}')`,te)}const Te=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function le(te,_e){if(typeof te>"u"||!d(Te,te))throw new x(_e,te,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ie(te){if(typeof te=="string")return le(te,"hints"),te;if(e(te)){const _e=te.length;let Me="";if(_e===0)return Me;for(let Ee=0;Ee<_e;Ee++){const We=te[Ee];le(We,"hints"),Me+=We,Ee!==_e-1&&(Me+=", ")}return Me}throw new x("hints",te,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return IS={isInt32:j,isUint32:$,parseFileMode:F,validateArray:oe,validateStringArray:me,validateBooleanArray:xe,validateAbortSignalArray:Pe,validateBoolean:ae,validateBuffer:Re,validateDictionary:ee,validateEncoding:ke,validateFunction:Le,validateInt32:q,validateInteger:K,validateNumber:Y,validateObject:J,validateOneOf:Q,validatePlainFunction:Ie,validatePort:Fe,validateSignalName:Ne,validateString:re,validateUint32:de,validateUndefined:V,validateUnion:ge,validateAbortSignal:Qe,validateLinkHeaderValue:ie},IS}var jb={exports:{}},jS={},tj;function rf(){return tj||(tj=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}var n={exports:{}},r=n.exports={},a,i;function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?a=setTimeout:a=s}catch{a=s}try{typeof clearTimeout=="function"?i=clearTimeout:i=o}catch{i=o}})();function l(C){if(a===setTimeout)return setTimeout(C,0);if((a===s||!a)&&setTimeout)return a=setTimeout,setTimeout(C,0);try{return a(C,0)}catch{try{return a.call(null,C,0)}catch{return a.call(this,C,0)}}}function u(C){if(i===clearTimeout)return clearTimeout(C);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(C);try{return i(C)}catch{try{return i.call(null,C)}catch{return i.call(this,C)}}}var d=[],h=!1,p,y=-1;function v(){!h||!p||(h=!1,p.length?d=p.concat(d):y=-1,d.length&&b())}function b(){if(!h){var C=l(v);h=!0;for(var k=d.length;k;){for(p=d,d=[];++y<k;)p&&p[y].run();y=-1,k=d.length}p=null,h=!1,u(C)}}r.nextTick=function(C){var k=new Array(arguments.length-1);if(arguments.length>1)for(var R=1;R<arguments.length;R++)k[R-1]=arguments[R];d.push(new w(C,k)),d.length===1&&!h&&l(b)};function w(C,k){this.fun=C,this.array=k}w.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(C){return[]},r.binding=function(C){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(C){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var S=n.exports;const E=t(S);e.default=E,e.process=E}(jS)),jS}var OS,nj;function nc(){if(nj)return OS;nj=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=Xr(),r=n("nodejs.stream.destroyed"),a=n("nodejs.stream.errored"),i=n("nodejs.stream.readable"),s=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),u=n("nodejs.webstream.controllerErrorFunction");function d(B,J=!1){var ee;return!!(B&&typeof B.pipe=="function"&&typeof B.on=="function"&&(!J||typeof B.pause=="function"&&typeof B.resume=="function")&&(!B._writableState||((ee=B._readableState)===null||ee===void 0?void 0:ee.readable)!==!1)&&(!B._writableState||B._readableState))}function h(B){var J;return!!(B&&typeof B.write=="function"&&typeof B.on=="function"&&(!B._readableState||((J=B._writableState)===null||J===void 0?void 0:J.writable)!==!1))}function p(B){return!!(B&&typeof B.pipe=="function"&&B._readableState&&typeof B.on=="function"&&typeof B.write=="function")}function y(B){return B&&(B._readableState||B._writableState||typeof B.write=="function"&&typeof B.on=="function"||typeof B.pipe=="function"&&typeof B.on=="function")}function v(B){return!!(B&&!y(B)&&typeof B.pipeThrough=="function"&&typeof B.getReader=="function"&&typeof B.cancel=="function")}function b(B){return!!(B&&!y(B)&&typeof B.getWriter=="function"&&typeof B.abort=="function")}function w(B){return!!(B&&!y(B)&&typeof B.readable=="object"&&typeof B.writable=="object")}function x(B){return v(B)||b(B)||w(B)}function S(B,J){return B==null?!1:J===!0?typeof B[e]=="function":J===!1?typeof B[t]=="function":typeof B[e]=="function"||typeof B[t]=="function"}function E(B){if(!y(B))return null;const J=B._writableState,ee=B._readableState,oe=J||ee;return!!(B.destroyed||B[r]||oe!=null&&oe.destroyed)}function C(B){if(!h(B))return null;if(B.writableEnded===!0)return!0;const J=B._writableState;return J!=null&&J.errored?!1:typeof(J==null?void 0:J.ended)!="boolean"?null:J.ended}function k(B,J){if(!h(B))return null;if(B.writableFinished===!0)return!0;const ee=B._writableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.finished)!="boolean"?null:!!(ee.finished||J===!1&&ee.ended===!0&&ee.length===0)}function R(B){if(!d(B))return null;if(B.readableEnded===!0)return!0;const J=B._readableState;return!J||J.errored?!1:typeof(J==null?void 0:J.ended)!="boolean"?null:J.ended}function O(B,J){if(!d(B))return null;const ee=B._readableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.endEmitted)!="boolean"?null:!!(ee.endEmitted||J===!1&&ee.ended===!0&&ee.length===0)}function j(B){return B&&B[i]!=null?B[i]:typeof(B==null?void 0:B.readable)!="boolean"?null:E(B)?!1:d(B)&&B.readable&&!O(B)}function $(B){return B&&B[s]!=null?B[s]:typeof(B==null?void 0:B.writable)!="boolean"?null:E(B)?!1:h(B)&&B.writable&&!C(B)}function L(B,J){return y(B)?E(B)?!0:!((J==null?void 0:J.readable)!==!1&&j(B)||(J==null?void 0:J.writable)!==!1&&$(B)):null}function X(B){var J,ee;return y(B)?B.writableErrored?B.writableErrored:(J=(ee=B._writableState)===null||ee===void 0?void 0:ee.errored)!==null&&J!==void 0?J:null:null}function F(B){var J,ee;return y(B)?B.readableErrored?B.readableErrored:(J=(ee=B._readableState)===null||ee===void 0?void 0:ee.errored)!==null&&J!==void 0?J:null:null}function K(B){if(!y(B))return null;if(typeof B.closed=="boolean")return B.closed;const J=B._writableState,ee=B._readableState;return typeof(J==null?void 0:J.closed)=="boolean"||typeof(ee==null?void 0:ee.closed)=="boolean"?(J==null?void 0:J.closed)||(ee==null?void 0:ee.closed):typeof B._closed=="boolean"&&q(B)?B._closed:null}function q(B){return typeof B._closed=="boolean"&&typeof B._defaultKeepAlive=="boolean"&&typeof B._removedConnection=="boolean"&&typeof B._removedContLen=="boolean"}function de(B){return typeof B._sent100=="boolean"&&q(B)}function re(B){var J;return typeof B._consuming=="boolean"&&typeof B._dumped=="boolean"&&((J=B.req)===null||J===void 0?void 0:J.upgradeOrConnect)===void 0}function Y(B){if(!y(B))return null;const J=B._writableState,ee=B._readableState,oe=J||ee;return!oe&&de(B)||!!(oe&&oe.autoDestroy&&oe.emitClose&&oe.closed===!1)}function Q(B){var J;return!!(B&&((J=B[o])!==null&&J!==void 0?J:B.readableDidRead||B.readableAborted))}function ae(B){var J,ee,oe,me,xe,Pe,Ne,Re,ke,Fe;return!!(B&&((J=(ee=(oe=(me=(xe=(Pe=B[a])!==null&&Pe!==void 0?Pe:B.readableErrored)!==null&&xe!==void 0?xe:B.writableErrored)!==null&&me!==void 0?me:(Ne=B._readableState)===null||Ne===void 0?void 0:Ne.errorEmitted)!==null&&oe!==void 0?oe:(Re=B._writableState)===null||Re===void 0?void 0:Re.errorEmitted)!==null&&ee!==void 0?ee:(ke=B._readableState)===null||ke===void 0?void 0:ke.errored)!==null&&J!==void 0?J:!((Fe=B._writableState)===null||Fe===void 0)&&Fe.errored))}return OS={isDestroyed:E,kIsDestroyed:r,isDisturbed:Q,kIsDisturbed:o,isErrored:ae,kIsErrored:a,isReadable:j,kIsReadable:i,kIsClosedPromise:l,kControllerErrorFunction:u,kIsWritable:s,isClosed:K,isDuplexNodeStream:p,isFinished:L,isIterable:S,isReadableNodeStream:d,isReadableStream:v,isReadableEnded:R,isReadableFinished:O,isReadableErrored:F,isNodeStream:y,isWebStream:x,isWritable:$,isWritableNodeStream:h,isWritableStream:b,isWritableEnded:C,isWritableFinished:k,isWritableErrored:X,isServerRequest:re,isServerResponse:de,willEmitClose:Y,isTransformStream:w},OS}var rj;function Cu(){if(rj)return jb.exports;rj=1;const e=rf(),{AbortError:t,codes:n}=Ei(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:a}=n,{kEmptyObject:i,once:s}=Di(),{validateAbortSignal:o,validateFunction:l,validateObject:u,validateBoolean:d}=w0(),{Promise:h,PromisePrototypeThen:p,SymbolDispose:y}=Xr(),{isClosed:v,isReadable:b,isReadableNodeStream:w,isReadableStream:x,isReadableFinished:S,isReadableErrored:E,isWritable:C,isWritableNodeStream:k,isWritableStream:R,isWritableFinished:O,isWritableErrored:j,isNodeStream:$,willEmitClose:L,kIsClosedPromise:X}=nc();let F;function K(Q){return Q.setHeader&&typeof Q.abort=="function"}const q=()=>{};function de(Q,ae,B){var J,ee;if(arguments.length===2?(B=ae,ae=i):ae==null?ae=i:u(ae,"options"),l(B,"callback"),o(ae.signal,"options.signal"),B=s(B),x(Q)||R(Q))return re(Q,ae,B);if(!$(Q))throw new r("stream",["ReadableStream","WritableStream","Stream"],Q);const oe=(J=ae.readable)!==null&&J!==void 0?J:w(Q),me=(ee=ae.writable)!==null&&ee!==void 0?ee:k(Q),xe=Q._writableState,Pe=Q._readableState,Ne=()=>{Q.writable||Fe()};let Re=L(Q)&&w(Q)===oe&&k(Q)===me,ke=O(Q,!1);const Fe=()=>{ke=!0,Q.destroyed&&(Re=!1),!(Re&&(!Q.readable||oe))&&(!oe||Qe)&&B.call(Q)};let Qe=S(Q,!1);const Le=()=>{Qe=!0,Q.destroyed&&(Re=!1),!(Re&&(!Q.writable||me))&&(!me||ke)&&B.call(Q)},Ie=te=>{B.call(Q,te)};let V=v(Q);const ge=()=>{V=!0;const te=j(Q)||E(Q);if(te&&typeof te!="boolean")return B.call(Q,te);if(oe&&!Qe&&w(Q,!0)&&!S(Q,!1))return B.call(Q,new a);if(me&&!ke&&!O(Q,!1))return B.call(Q,new a);B.call(Q)},Te=()=>{V=!0;const te=j(Q)||E(Q);if(te&&typeof te!="boolean")return B.call(Q,te);B.call(Q)},le=()=>{Q.req.on("finish",Fe)};K(Q)?(Q.on("complete",Fe),Re||Q.on("abort",ge),Q.req?le():Q.on("request",le)):me&&!xe&&(Q.on("end",Ne),Q.on("close",Ne)),!Re&&typeof Q.aborted=="boolean"&&Q.on("aborted",ge),Q.on("end",Le),Q.on("finish",Fe),ae.error!==!1&&Q.on("error",Ie),Q.on("close",ge),V?e.nextTick(ge):xe!=null&&xe.errorEmitted||Pe!=null&&Pe.errorEmitted?Re||e.nextTick(Te):(!oe&&(!Re||b(Q))&&(ke||C(Q)===!1)||!me&&(!Re||C(Q))&&(Qe||b(Q)===!1)||Pe&&Q.req&&Q.aborted)&&e.nextTick(Te);const ie=()=>{B=q,Q.removeListener("aborted",ge),Q.removeListener("complete",Fe),Q.removeListener("abort",ge),Q.removeListener("request",le),Q.req&&Q.req.removeListener("finish",Fe),Q.removeListener("end",Ne),Q.removeListener("close",Ne),Q.removeListener("finish",Fe),Q.removeListener("end",Le),Q.removeListener("error",Ie),Q.removeListener("close",ge)};if(ae.signal&&!V){const te=()=>{const _e=B;ie(),_e.call(Q,new t(void 0,{cause:ae.signal.reason}))};if(ae.signal.aborted)e.nextTick(te);else{F=F||Di().addAbortListener;const _e=F(ae.signal,te),Me=B;B=s((...Ee)=>{_e[y](),Me.apply(Q,Ee)})}}return ie}function re(Q,ae,B){let J=!1,ee=q;if(ae.signal)if(ee=()=>{J=!0,B.call(Q,new t(void 0,{cause:ae.signal.reason}))},ae.signal.aborted)e.nextTick(ee);else{F=F||Di().addAbortListener;const me=F(ae.signal,ee),xe=B;B=s((...Pe)=>{me[y](),xe.apply(Q,Pe)})}const oe=(...me)=>{J||e.nextTick(()=>B.apply(Q,me))};return p(Q[X].promise,oe,oe),q}function Y(Q,ae){var B;let J=!1;return ae===null&&(ae=i),(B=ae)!==null&&B!==void 0&&B.cleanup&&(d(ae.cleanup,"cleanup"),J=ae.cleanup),new h((ee,oe)=>{const me=de(Q,ae,xe=>{J&&me(),xe?oe(xe):ee()})})}return jb.exports=de,jb.exports.finished=Y,jb.exports}var DS,aj;function ip(){if(aj)return DS;aj=1;const e=rf(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=Ei(),{Symbol:a}=Xr(),{kIsDestroyed:i,isDestroyed:s,isFinished:o,isServerRequest:l}=nc(),u=a("kDestroy"),d=a("kConstruct");function h(L,X,F){L&&(L.stack,X&&!X.errored&&(X.errored=L),F&&!F.errored&&(F.errored=L))}function p(L,X){const F=this._readableState,K=this._writableState,q=K||F;return K!=null&&K.destroyed||F!=null&&F.destroyed?(typeof X=="function"&&X(),this):(h(L,K,F),K&&(K.destroyed=!0),F&&(F.destroyed=!0),q.constructed?y(this,L,X):this.once(u,function(de){y(this,t(de,L),X)}),this)}function y(L,X,F){let K=!1;function q(de){if(K)return;K=!0;const re=L._readableState,Y=L._writableState;h(de,Y,re),Y&&(Y.closed=!0),re&&(re.closed=!0),typeof F=="function"&&F(de),de?e.nextTick(v,L,de):e.nextTick(b,L)}try{L._destroy(X||null,q)}catch(de){q(de)}}function v(L,X){w(L,X),b(L)}function b(L){const X=L._readableState,F=L._writableState;F&&(F.closeEmitted=!0),X&&(X.closeEmitted=!0),(F!=null&&F.emitClose||X!=null&&X.emitClose)&&L.emit("close")}function w(L,X){const F=L._readableState,K=L._writableState;K!=null&&K.errorEmitted||F!=null&&F.errorEmitted||(K&&(K.errorEmitted=!0),F&&(F.errorEmitted=!0),L.emit("error",X))}function x(){const L=this._readableState,X=this._writableState;L&&(L.constructed=!0,L.closed=!1,L.closeEmitted=!1,L.destroyed=!1,L.errored=null,L.errorEmitted=!1,L.reading=!1,L.ended=L.readable===!1,L.endEmitted=L.readable===!1),X&&(X.constructed=!0,X.destroyed=!1,X.closed=!1,X.closeEmitted=!1,X.errored=null,X.errorEmitted=!1,X.finalCalled=!1,X.prefinished=!1,X.ended=X.writable===!1,X.ending=X.writable===!1,X.finished=X.writable===!1)}function S(L,X,F){const K=L._readableState,q=L._writableState;if(q!=null&&q.destroyed||K!=null&&K.destroyed)return this;K!=null&&K.autoDestroy||q!=null&&q.autoDestroy?L.destroy(X):X&&(X.stack,q&&!q.errored&&(q.errored=X),K&&!K.errored&&(K.errored=X),F?e.nextTick(w,L,X):w(L,X))}function E(L,X){if(typeof L._construct!="function")return;const F=L._readableState,K=L._writableState;F&&(F.constructed=!1),K&&(K.constructed=!1),L.once(d,X),!(L.listenerCount(d)>1)&&e.nextTick(C,L)}function C(L){let X=!1;function F(K){if(X){S(L,K??new n);return}X=!0;const q=L._readableState,de=L._writableState,re=de||q;q&&(q.constructed=!0),de&&(de.constructed=!0),re.destroyed?L.emit(u,K):K?S(L,K,!0):e.nextTick(k,L)}try{L._construct(K=>{e.nextTick(F,K)})}catch(K){e.nextTick(F,K)}}function k(L){L.emit(d)}function R(L){return(L==null?void 0:L.setHeader)&&typeof L.abort=="function"}function O(L){L.emit("close")}function j(L,X){L.emit("error",X),e.nextTick(O,L)}function $(L,X){!L||s(L)||(!X&&!o(L)&&(X=new r),l(L)?(L.socket=null,L.destroy(X)):R(L)?L.abort():R(L.req)?L.req.abort():typeof L.destroy=="function"?L.destroy(X):typeof L.close=="function"?L.close():X?e.nextTick(j,L,X):e.nextTick(O,L),L.destroyed||(L[i]=!0))}return DS={construct:E,destroyer:$,destroy:p,undestroy:x,errorOrDestroy:S},DS}var MS,ij;function Bk(){if(ij)return MS;ij=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=Xr(),{EventEmitter:n}=ax();function r(i){n.call(this,i)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(i,s){const o=this;function l(b){i.writable&&i.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function u(){o.readable&&o.resume&&o.resume()}i.on("drain",u),!i._isStdio&&(!s||s.end!==!1)&&(o.on("end",h),o.on("close",p));let d=!1;function h(){d||(d=!0,i.end())}function p(){d||(d=!0,typeof i.destroy=="function"&&i.destroy())}function y(b){v(),n.listenerCount(this,"error")===0&&this.emit("error",b)}a(o,"error",y),a(i,"error",y);function v(){o.removeListener("data",l),i.removeListener("drain",u),o.removeListener("end",h),o.removeListener("close",p),o.removeListener("error",y),i.removeListener("error",y),o.removeListener("end",v),o.removeListener("close",v),i.removeListener("close",v)}return o.on("end",v),o.on("close",v),i.on("close",v),i.emit("pipe",o),i};function a(i,s,o){if(typeof i.prependListener=="function")return i.prependListener(s,o);!i._events||!i._events[s]?i.on(s,o):e(i._events[s])?i._events[s].unshift(o):i._events[s]=[o,i._events[s]]}return MS={Stream:r,prependListener:a},MS}var PS={exports:{}},sj;function ix(){return sj||(sj=1,function(e){const{SymbolDispose:t}=Xr(),{AbortError:n,codes:r}=Ei(),{isNodeStream:a,isWebStream:i,kControllerErrorFunction:s}=nc(),o=Cu(),{ERR_INVALID_ARG_TYPE:l}=r;let u;const d=(h,p)=>{if(typeof h!="object"||!("aborted"in h))throw new l(p,"AbortSignal",h)};e.exports.addAbortSignal=function(p,y){if(d(p,"signal"),!a(y)&&!i(y))throw new l("stream",["ReadableStream","WritableStream","Stream"],y);return e.exports.addAbortSignalNoValidate(p,y)},e.exports.addAbortSignalNoValidate=function(h,p){if(typeof h!="object"||!("aborted"in h))return p;const y=a(p)?()=>{p.destroy(new n(void 0,{cause:h.reason}))}:()=>{p[s](new n(void 0,{cause:h.reason}))};if(h.aborted)y();else{u=u||Di().addAbortListener;const v=u(h,y);o(p,v[t])}return p}}(PS)),PS.exports}var FS,oj;function Vee(){if(oj)return FS;oj=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=Xr(),{Buffer:a}=Eu(),{inspect:i}=Di();return FS=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,u=""+l.data;for(;(l=l.next)!==null;)u+=o+l.data;return u}concat(o){if(this.length===0)return a.alloc(0);const l=a.allocUnsafe(o>>>0);let u=this.head,d=0;for(;u;)n(l,u.data,d),d+=u.data.length,u=u.next;return l}consume(o,l){const u=this.head.data;if(o<u.length){const d=u.slice(0,o);return this.head.data=u.slice(o),d}return o===u.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",u=this.head,d=0;do{const h=u.data;if(o>h.length)l+=h,o-=h.length;else{o===h.length?(l+=h,++d,u.next?this.head=u.next:this.head=this.tail=null):(l+=e(h,0,o),this.head=u,u.data=e(h,o));break}++d}while((u=u.next)!==null);return this.length-=d,l}_getBuffer(o){const l=a.allocUnsafe(o),u=o;let d=this.head,h=0;do{const p=d.data;if(o>p.length)n(l,p,u-o),o-=p.length;else{o===p.length?(n(l,p,u-o),++h,d.next?this.head=d.next:this.head=this.tail=null):(n(l,new r(p.buffer,p.byteOffset,o),u-o),this.head=d,d.data=p.slice(o));break}++h}while((d=d.next)!==null);return this.length-=h,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return i(this,{...l,depth:0,customInspect:!1})}},FS}var LS,lj;function sx(){if(lj)return LS;lj=1;const{MathFloor:e,NumberIsInteger:t}=Xr(),{validateInteger:n}=w0(),{ERR_INVALID_ARG_VALUE:r}=Ei().codes;let a=16*1024,i=16;function s(d,h,p){return d.highWaterMark!=null?d.highWaterMark:h?d[p]:null}function o(d){return d?i:a}function l(d,h){n(h,"value",0),d?i=h:a=h}function u(d,h,p,y){const v=s(h,y,p);if(v!=null){if(!t(v)||v<0){const b=y?`options.${p}`:"options.highWaterMark";throw new r(b,v)}return e(v)}return o(d.objectMode)}return LS={getHighWaterMark:u,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},LS}var $S={},Ob={exports:{}},cj;function zk(){return cj||(cj=1,function(e,t){var n=Eu(),r=n.Buffer;function a(s,o){for(var l in s)o[l]=s[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=i);function i(s,o,l){return r(s,o,l)}a(r,i),i.from=function(s,o,l){if(typeof s=="number")throw new TypeError("Argument must not be a number");return r(s,o,l)},i.alloc=function(s,o,l){if(typeof s!="number")throw new TypeError("Argument must be a number");var u=r(s);return o!==void 0?typeof l=="string"?u.fill(o,l):u.fill(o):u.fill(0),u},i.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r(s)},i.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(s)}}(Ob,Ob.exports)),Ob.exports}var uj;function Gee(){if(uj)return $S;uj=1;var e=zk().Buffer,t=e.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(x){if(!x)return"utf8";for(var S;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(S)return;x=(""+x).toLowerCase(),S=!0}}function r(x){var S=n(x);if(typeof S!="string"&&(e.isEncoding===t||!t(x)))throw new Error("Unknown encoding: "+x);return S||x}$S.StringDecoder=a;function a(x){this.encoding=r(x);var S;switch(this.encoding){case"utf16le":this.text=h,this.end=p,S=4;break;case"utf8":this.fillLast=l,S=4;break;case"base64":this.text=y,this.end=v,S=3;break;default:this.write=b,this.end=w;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(S)}a.prototype.write=function(x){if(x.length===0)return"";var S,E;if(this.lastNeed){if(S=this.fillLast(x),S===void 0)return"";E=this.lastNeed,this.lastNeed=0}else E=0;return E<x.length?S?S+this.text(x,E):this.text(x,E):S||""},a.prototype.end=d,a.prototype.text=u,a.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length};function i(x){return x<=127?0:x>>5===6?2:x>>4===14?3:x>>3===30?4:x>>6===2?-1:-2}function s(x,S,E){var C=S.length-1;if(C<E)return 0;var k=i(S[C]);return k>=0?(k>0&&(x.lastNeed=k-1),k):--C<E||k===-2?0:(k=i(S[C]),k>=0?(k>0&&(x.lastNeed=k-2),k):--C<E||k===-2?0:(k=i(S[C]),k>=0?(k>0&&(k===2?k=0:x.lastNeed=k-3),k):0))}function o(x,S,E){if((S[0]&192)!==128)return x.lastNeed=0,"";if(x.lastNeed>1&&S.length>1){if((S[1]&192)!==128)return x.lastNeed=1,"";if(x.lastNeed>2&&S.length>2&&(S[2]&192)!==128)return x.lastNeed=2,""}}function l(x){var S=this.lastTotal-this.lastNeed,E=o(this,x);if(E!==void 0)return E;if(this.lastNeed<=x.length)return x.copy(this.lastChar,S,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,S,0,x.length),this.lastNeed-=x.length}function u(x,S){var E=s(this,x,S);if(!this.lastNeed)return x.toString("utf8",S);this.lastTotal=E;var C=x.length-(E-this.lastNeed);return x.copy(this.lastChar,0,C),x.toString("utf8",S,C)}function d(x){var S=x&&x.length?this.write(x):"";return this.lastNeed?S+"":S}function h(x,S){if((x.length-S)%2===0){var E=x.toString("utf16le",S);if(E){var C=E.charCodeAt(E.length-1);if(C>=55296&&C<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],E.slice(0,-1)}return E}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",S,x.length-1)}function p(x){var S=x&&x.length?this.write(x):"";if(this.lastNeed){var E=this.lastTotal-this.lastNeed;return S+this.lastChar.toString("utf16le",0,E)}return S}function y(x,S){var E=(x.length-S)%3;return E===0?x.toString("base64",S):(this.lastNeed=3-E,this.lastTotal=3,E===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",S,x.length-E))}function v(x){var S=x&&x.length?this.write(x):"";return this.lastNeed?S+this.lastChar.toString("base64",0,3-this.lastNeed):S}function b(x){return x.toString(this.encoding)}function w(x){return x&&x.length?this.write(x):""}return $S}var BS,dj;function _P(){if(dj)return BS;dj=1;const e=rf(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=Xr(),{Buffer:a}=Eu(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:s}=Ei().codes;function o(l,u,d){let h;if(typeof u=="string"||u instanceof a)return new l({objectMode:!0,...d,read(){this.push(u),this.push(null)}});let p;if(u&&u[n])p=!0,h=u[n]();else if(u&&u[r])p=!1,h=u[r]();else throw new i("iterable",["Iterable"],u);const y=new l({objectMode:!0,highWaterMark:1,...d});let v=!1;y._read=function(){v||(v=!0,w())},y._destroy=function(x,S){t(b(x),()=>e.nextTick(S,x),E=>e.nextTick(S,E||x))};async function b(x){const S=x!=null,E=typeof h.throw=="function";if(S&&E){const{value:C,done:k}=await h.throw(x);if(await C,k)return}if(typeof h.return=="function"){const{value:C}=await h.return();await C}}async function w(){for(;;){try{const{value:x,done:S}=p?await h.next():h.next();if(S)y.push(null);else{const E=x&&typeof x.then=="function"?await x:x;if(E===null)throw v=!1,new s;if(y.push(E))continue;v=!1}}catch(x){y.destroy(x)}break}}return y}return BS=o,BS}var zS,fj;function ox(){if(fj)return zS;fj=1;const e=rf(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:a,ObjectDefineProperties:i,ObjectKeys:s,ObjectSetPrototypeOf:o,Promise:l,SafeSet:u,SymbolAsyncDispose:d,SymbolAsyncIterator:h,Symbol:p}=Xr();zS=Ee,Ee.ReadableState=Me;const{EventEmitter:y}=ax(),{Stream:v,prependListener:b}=Bk(),{Buffer:w}=Eu(),{addAbortSignal:x}=ix(),S=Cu();let E=Di().debuglog("stream",pe=>{E=pe});const C=Vee(),k=ip(),{getHighWaterMark:R,getDefaultHighWaterMark:O}=sx(),{aggregateTwoErrors:j,codes:{ERR_INVALID_ARG_TYPE:$,ERR_METHOD_NOT_IMPLEMENTED:L,ERR_OUT_OF_RANGE:X,ERR_STREAM_PUSH_AFTER_EOF:F,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:K},AbortError:q}=Ei(),{validateObject:de}=w0(),re=p("kPaused"),{StringDecoder:Y}=Gee(),Q=_P();o(Ee.prototype,v.prototype),o(Ee,v);const ae=()=>{},{errorOrDestroy:B}=k,J=1,ee=2,oe=4,me=8,xe=16,Pe=32,Ne=64,Re=128,ke=256,Fe=512,Qe=1024,Le=2048,Ie=4096,V=8192,ge=16384,Te=32768,le=65536,ie=1<<17,te=1<<18;function _e(pe){return{enumerable:!1,get(){return(this.state&pe)!==0},set(H){H?this.state|=pe:this.state&=~pe}}}i(Me.prototype,{objectMode:_e(J),ended:_e(ee),endEmitted:_e(oe),reading:_e(me),constructed:_e(xe),sync:_e(Pe),needReadable:_e(Ne),emittedReadable:_e(Re),readableListening:_e(ke),resumeScheduled:_e(Fe),errorEmitted:_e(Qe),emitClose:_e(Le),autoDestroy:_e(Ie),destroyed:_e(V),closed:_e(ge),closeEmitted:_e(Te),multiAwaitDrain:_e(le),readingMore:_e(ie),dataEmitted:_e(te)});function Me(pe,H,U){typeof U!="boolean"&&(U=H instanceof Wl()),this.state=Le|Ie|xe|Pe,pe&&pe.objectMode&&(this.state|=J),U&&pe&&pe.readableObjectMode&&(this.state|=J),this.highWaterMark=pe?R(this,pe,"readableHighWaterMark",U):O(!1),this.buffer=new C,this.length=0,this.pipes=[],this.flowing=null,this[re]=null,pe&&pe.emitClose===!1&&(this.state&=-2049),pe&&pe.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=pe&&pe.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,pe&&pe.encoding&&(this.decoder=new Y(pe.encoding),this.encoding=pe.encoding)}function Ee(pe){if(!(this instanceof Ee))return new Ee(pe);const H=this instanceof Wl();this._readableState=new Me(pe,this,H),pe&&(typeof pe.read=="function"&&(this._read=pe.read),typeof pe.destroy=="function"&&(this._destroy=pe.destroy),typeof pe.construct=="function"&&(this._construct=pe.construct),pe.signal&&!H&&x(pe.signal,this)),v.call(this,pe),k.construct(this,()=>{this._readableState.needReadable&&I(this,this._readableState)})}Ee.prototype.destroy=k.destroy,Ee.prototype._undestroy=k.undestroy,Ee.prototype._destroy=function(pe,H){H(pe)},Ee.prototype[y.captureRejectionSymbol]=function(pe){this.destroy(pe)},Ee.prototype[d]=function(){let pe;return this.destroyed||(pe=this.readableEnded?null:new q,this.destroy(pe)),new l((H,U)=>S(this,W=>W&&W!==pe?U(W):H(null)))},Ee.prototype.push=function(pe,H){return We(this,pe,H,!1)},Ee.prototype.unshift=function(pe,H){return We(this,pe,H,!0)};function We(pe,H,U,W){E("readableAddChunk",H);const he=pe._readableState;let Ae;if((he.state&J)===0&&(typeof H=="string"?(U=U||he.defaultEncoding,he.encoding!==U&&(W&&he.encoding?H=w.from(H,U).toString(he.encoding):(H=w.from(H,U),U=""))):H instanceof w?U="":v._isUint8Array(H)?(H=v._uint8ArrayToBuffer(H),U=""):H!=null&&(Ae=new $("chunk",["string","Buffer","Uint8Array"],H))),Ae)B(pe,Ae);else if(H===null)he.state&=-9,Ot(pe,he);else if((he.state&J)!==0||H&&H.length>0)if(W)if((he.state&oe)!==0)B(pe,new K);else{if(he.destroyed||he.errored)return!1;kt(pe,he,H,!0)}else if(he.ended)B(pe,new F);else{if(he.destroyed||he.errored)return!1;he.state&=-9,he.decoder&&!U?(H=he.decoder.write(H),he.objectMode||H.length!==0?kt(pe,he,H,!1):I(pe,he)):kt(pe,he,H,!1)}else W||(he.state&=-9,I(pe,he));return!he.ended&&(he.length<he.highWaterMark||he.length===0)}function kt(pe,H,U,W){H.flowing&&H.length===0&&!H.sync&&pe.listenerCount("data")>0?((H.state&le)!==0?H.awaitDrainWriters.clear():H.awaitDrainWriters=null,H.dataEmitted=!0,pe.emit("data",U)):(H.length+=H.objectMode?1:U.length,W?H.buffer.unshift(U):H.buffer.push(U),(H.state&Ne)!==0&&Wt(pe)),I(pe,H)}Ee.prototype.isPaused=function(){const pe=this._readableState;return pe[re]===!0||pe.flowing===!1},Ee.prototype.setEncoding=function(pe){const H=new Y(pe);this._readableState.decoder=H,this._readableState.encoding=this._readableState.decoder.encoding;const U=this._readableState.buffer;let W="";for(const he of U)W+=H.write(he);return U.clear(),W!==""&&U.push(W),this._readableState.length=W.length,this};const it=1073741824;function xt(pe){if(pe>it)throw new X("size","<= 1GiB",pe);return pe--,pe|=pe>>>1,pe|=pe>>>2,pe|=pe>>>4,pe|=pe>>>8,pe|=pe>>>16,pe++,pe}function Dt(pe,H){return pe<=0||H.length===0&&H.ended?0:(H.state&J)!==0?1:r(pe)?H.flowing&&H.length?H.buffer.first().length:H.length:pe<=H.length?pe:H.ended?H.length:0}Ee.prototype.read=function(pe){E("read",pe),pe===void 0?pe=NaN:n(pe)||(pe=a(pe,10));const H=this._readableState,U=pe;if(pe>H.highWaterMark&&(H.highWaterMark=xt(pe)),pe!==0&&(H.state&=-129),pe===0&&H.needReadable&&((H.highWaterMark!==0?H.length>=H.highWaterMark:H.length>0)||H.ended))return E("read: emitReadable",H.length,H.ended),H.length===0&&H.ended?nt(this):Wt(this),null;if(pe=Dt(pe,H),pe===0&&H.ended)return H.length===0&&nt(this),null;let W=(H.state&Ne)!==0;if(E("need readable",W),(H.length===0||H.length-pe<H.highWaterMark)&&(W=!0,E("length less than watermark",W)),H.ended||H.reading||H.destroyed||H.errored||!H.constructed)W=!1,E("reading, ended or constructing",W);else if(W){E("do read"),H.state|=me|Pe,H.length===0&&(H.state|=Ne);try{this._read(H.highWaterMark)}catch(Ae){B(this,Ae)}H.state&=-33,H.reading||(pe=Dt(U,H))}let he;return pe>0?he=Be(pe,H):he=null,he===null?(H.needReadable=H.length<=H.highWaterMark,pe=0):(H.length-=pe,H.multiAwaitDrain?H.awaitDrainWriters.clear():H.awaitDrainWriters=null),H.length===0&&(H.ended||(H.needReadable=!0),U!==pe&&H.ended&&nt(this)),he!==null&&!H.errorEmitted&&!H.closeEmitted&&(H.dataEmitted=!0,this.emit("data",he)),he};function Ot(pe,H){if(E("onEofChunk"),!H.ended){if(H.decoder){const U=H.decoder.end();U&&U.length&&(H.buffer.push(U),H.length+=H.objectMode?1:U.length)}H.ended=!0,H.sync?Wt(pe):(H.needReadable=!1,H.emittedReadable=!0,be(pe))}}function Wt(pe){const H=pe._readableState;E("emitReadable",H.needReadable,H.emittedReadable),H.needReadable=!1,H.emittedReadable||(E("emitReadable",H.flowing),H.emittedReadable=!0,e.nextTick(be,pe))}function be(pe){const H=pe._readableState;E("emitReadable_",H.destroyed,H.length,H.ended),!H.destroyed&&!H.errored&&(H.length||H.ended)&&(pe.emit("readable"),H.emittedReadable=!1),H.needReadable=!H.flowing&&!H.ended&&H.length<=H.highWaterMark,ft(pe)}function I(pe,H){!H.readingMore&&H.constructed&&(H.readingMore=!0,e.nextTick(G,pe,H))}function G(pe,H){for(;!H.reading&&!H.ended&&(H.length<H.highWaterMark||H.flowing&&H.length===0);){const U=H.length;if(E("maybeReadMore read 0"),pe.read(0),U===H.length)break}H.readingMore=!1}Ee.prototype._read=function(pe){throw new L("_read()")},Ee.prototype.pipe=function(pe,H){const U=this,W=this._readableState;W.pipes.length===1&&(W.multiAwaitDrain||(W.multiAwaitDrain=!0,W.awaitDrainWriters=new u(W.awaitDrainWriters?[W.awaitDrainWriters]:[]))),W.pipes.push(pe),E("pipe count=%d opts=%j",W.pipes.length,H);const Ae=(!H||H.end!==!1)&&pe!==e.stdout&&pe!==e.stderr?pt:xr;W.endEmitted?e.nextTick(Ae):U.once("end",Ae),pe.on("unpipe",qe);function qe(Mn,hi){E("onunpipe"),Mn===U&&hi&&hi.hasUnpiped===!1&&(hi.hasUnpiped=!0,Tt())}function pt(){E("onend"),pe.end()}let Gt,ut=!1;function Tt(){E("cleanup"),pe.removeListener("close",Hn),pe.removeListener("finish",wr),Gt&&pe.removeListener("drain",Gt),pe.removeListener("error",An),pe.removeListener("unpipe",qe),U.removeListener("end",pt),U.removeListener("end",xr),U.removeListener("data",Jt),ut=!0,Gt&&W.awaitDrainWriters&&(!pe._writableState||pe._writableState.needDrain)&&Gt()}function Pt(){ut||(W.pipes.length===1&&W.pipes[0]===pe?(E("false write response, pause",0),W.awaitDrainWriters=pe,W.multiAwaitDrain=!1):W.pipes.length>1&&W.pipes.includes(pe)&&(E("false write response, pause",W.awaitDrainWriters.size),W.awaitDrainWriters.add(pe)),U.pause()),Gt||(Gt=fe(U,pe),pe.on("drain",Gt))}U.on("data",Jt);function Jt(Mn){E("ondata");const hi=pe.write(Mn);E("dest.write",hi),hi===!1&&Pt()}function An(Mn){if(E("onerror",Mn),xr(),pe.removeListener("error",An),pe.listenerCount("error")===0){const hi=pe._writableState||pe._readableState;hi&&!hi.errorEmitted?B(pe,Mn):pe.emit("error",Mn)}}b(pe,"error",An);function Hn(){pe.removeListener("finish",wr),xr()}pe.once("close",Hn);function wr(){E("onfinish"),pe.removeListener("close",Hn),xr()}pe.once("finish",wr);function xr(){E("unpipe"),U.unpipe(pe)}return pe.emit("pipe",U),pe.writableNeedDrain===!0?Pt():W.flowing||(E("pipe resume"),U.resume()),pe};function fe(pe,H){return function(){const W=pe._readableState;W.awaitDrainWriters===H?(E("pipeOnDrain",1),W.awaitDrainWriters=null):W.multiAwaitDrain&&(E("pipeOnDrain",W.awaitDrainWriters.size),W.awaitDrainWriters.delete(H)),(!W.awaitDrainWriters||W.awaitDrainWriters.size===0)&&pe.listenerCount("data")&&pe.resume()}}Ee.prototype.unpipe=function(pe){const H=this._readableState,U={hasUnpiped:!1};if(H.pipes.length===0)return this;if(!pe){const he=H.pipes;H.pipes=[],this.pause();for(let Ae=0;Ae<he.length;Ae++)he[Ae].emit("unpipe",this,{hasUnpiped:!1});return this}const W=t(H.pipes,pe);return W===-1?this:(H.pipes.splice(W,1),H.pipes.length===0&&this.pause(),pe.emit("unpipe",this,U),this)},Ee.prototype.on=function(pe,H){const U=v.prototype.on.call(this,pe,H),W=this._readableState;return pe==="data"?(W.readableListening=this.listenerCount("readable")>0,W.flowing!==!1&&this.resume()):pe==="readable"&&!W.endEmitted&&!W.readableListening&&(W.readableListening=W.needReadable=!0,W.flowing=!1,W.emittedReadable=!1,E("on readable",W.length,W.reading),W.length?Wt(this):W.reading||e.nextTick(ve,this)),U},Ee.prototype.addListener=Ee.prototype.on,Ee.prototype.removeListener=function(pe,H){const U=v.prototype.removeListener.call(this,pe,H);return pe==="readable"&&e.nextTick(je,this),U},Ee.prototype.off=Ee.prototype.removeListener,Ee.prototype.removeAllListeners=function(pe){const H=v.prototype.removeAllListeners.apply(this,arguments);return(pe==="readable"||pe===void 0)&&e.nextTick(je,this),H};function je(pe){const H=pe._readableState;H.readableListening=pe.listenerCount("readable")>0,H.resumeScheduled&&H[re]===!1?H.flowing=!0:pe.listenerCount("data")>0?pe.resume():H.readableListening||(H.flowing=null)}function ve(pe){E("readable nexttick read 0"),pe.read(0)}Ee.prototype.resume=function(){const pe=this._readableState;return pe.flowing||(E("resume"),pe.flowing=!pe.readableListening,Ce(this,pe)),pe[re]=!1,this};function Ce(pe,H){H.resumeScheduled||(H.resumeScheduled=!0,e.nextTick(ce,pe,H))}function ce(pe,H){E("resume",H.reading),H.reading||pe.read(0),H.resumeScheduled=!1,pe.emit("resume"),ft(pe),H.flowing&&!H.reading&&pe.read(0)}Ee.prototype.pause=function(){return E("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(E("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[re]=!0,this};function ft(pe){const H=pe._readableState;for(E("flow",H.flowing);H.flowing&&pe.read()!==null;);}Ee.prototype.wrap=function(pe){let H=!1;pe.on("data",W=>{!this.push(W)&&pe.pause&&(H=!0,pe.pause())}),pe.on("end",()=>{this.push(null)}),pe.on("error",W=>{B(this,W)}),pe.on("close",()=>{this.destroy()}),pe.on("destroy",()=>{this.destroy()}),this._read=()=>{H&&pe.resume&&(H=!1,pe.resume())};const U=s(pe);for(let W=1;W<U.length;W++){const he=U[W];this[he]===void 0&&typeof pe[he]=="function"&&(this[he]=pe[he].bind(pe))}return this},Ee.prototype[h]=function(){return vt(this)},Ee.prototype.iterator=function(pe){return pe!==void 0&&de(pe,"options"),vt(this,pe)};function vt(pe,H){typeof pe.read!="function"&&(pe=Ee.wrap(pe,{objectMode:!0}));const U=M(pe,H);return U.stream=pe,U}async function*M(pe,H){let U=ae;function W(qe){this===pe?(U(),U=ae):U=qe}pe.on("readable",W);let he;const Ae=S(pe,{writable:!1},qe=>{he=qe?j(he,qe):null,U(),U=ae});try{for(;;){const qe=pe.destroyed?null:pe.read();if(qe!==null)yield qe;else{if(he)throw he;if(he===null)return;await new l(W)}}}catch(qe){throw he=j(he,qe),he}finally{(he||(H==null?void 0:H.destroyOnReturn)!==!1)&&(he===void 0||pe._readableState.autoDestroy)?k.destroyer(pe,null):(pe.off("readable",W),Ae())}}i(Ee.prototype,{readable:{__proto__:null,get(){const pe=this._readableState;return!!pe&&pe.readable!==!1&&!pe.destroyed&&!pe.errorEmitted&&!pe.endEmitted},set(pe){this._readableState&&(this._readableState.readable=!!pe)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(pe){this._readableState&&(this._readableState.flowing=pe)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(pe){this._readableState&&(this._readableState.destroyed=pe)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Me.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[re]!==!1},set(pe){this[re]=!!pe}}}),Ee._fromList=Be;function Be(pe,H){if(H.length===0)return null;let U;return H.objectMode?U=H.buffer.shift():!pe||pe>=H.length?(H.decoder?U=H.buffer.join(""):H.buffer.length===1?U=H.buffer.first():U=H.buffer.concat(H.length),H.buffer.clear()):U=H.buffer.consume(pe,H.decoder),U}function nt(pe){const H=pe._readableState;E("endReadable",H.endEmitted),H.endEmitted||(H.ended=!0,e.nextTick(ye,H,pe))}function ye(pe,H){if(E("endReadableNT",pe.endEmitted,pe.length),!pe.errored&&!pe.closeEmitted&&!pe.endEmitted&&pe.length===0){if(pe.endEmitted=!0,H.emit("end"),H.writable&&H.allowHalfOpen===!1)e.nextTick(Oe,H);else if(pe.autoDestroy){const U=H._writableState;(!U||U.autoDestroy&&(U.finished||U.writable===!1))&&H.destroy()}}}function Oe(pe){pe.writable&&!pe.writableEnded&&!pe.destroyed&&pe.end()}Ee.from=function(pe,H){return Q(Ee,pe,H)};let Ke;function Rt(){return Ke===void 0&&(Ke={}),Ke}return Ee.fromWeb=function(pe,H){return Rt().newStreamReadableFromReadableStream(pe,H)},Ee.toWeb=function(pe,H){return Rt().newReadableStreamFromStreamReadable(pe,H)},Ee.wrap=function(pe,H){var U,W;return new Ee({objectMode:(U=(W=pe.readableObjectMode)!==null&&W!==void 0?W:pe.objectMode)!==null&&U!==void 0?U:!0,...H,destroy(he,Ae){k.destroyer(pe,he),Ae(he)}}).wrap(pe)},zS}var US,hj;function Uk(){if(hj)return US;hj=1;const e=rf(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:a,ObjectDefineProperties:i,ObjectSetPrototypeOf:s,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:u}=Xr();US=de,de.WritableState=K;const{EventEmitter:d}=ax(),h=Bk().Stream,{Buffer:p}=Eu(),y=ip(),{addAbortSignal:v}=ix(),{getHighWaterMark:b,getDefaultHighWaterMark:w}=sx(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:S,ERR_MULTIPLE_CALLBACK:E,ERR_STREAM_CANNOT_PIPE:C,ERR_STREAM_DESTROYED:k,ERR_STREAM_ALREADY_FINISHED:R,ERR_STREAM_NULL_VALUES:O,ERR_STREAM_WRITE_AFTER_END:j,ERR_UNKNOWN_ENCODING:$}=Ei().codes,{errorOrDestroy:L}=y;s(de.prototype,h.prototype),s(de,h);function X(){}const F=l("kOnFinished");function K(Ie,V,ge){typeof ge!="boolean"&&(ge=V instanceof Wl()),this.objectMode=!!(Ie&&Ie.objectMode),ge&&(this.objectMode=this.objectMode||!!(Ie&&Ie.writableObjectMode)),this.highWaterMark=Ie?b(this,Ie,"writableHighWaterMark",ge):w(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Te=!!(Ie&&Ie.decodeStrings===!1);this.decodeStrings=!Te,this.defaultEncoding=Ie&&Ie.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=B.bind(void 0,V),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,q(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!Ie||Ie.emitClose!==!1,this.autoDestroy=!Ie||Ie.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[F]=[]}function q(Ie){Ie.buffered=[],Ie.bufferedIndex=0,Ie.allBuffers=!0,Ie.allNoop=!0}K.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},a(K.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function de(Ie){const V=this instanceof Wl();if(!V&&!r(de,this))return new de(Ie);this._writableState=new K(Ie,this,V),Ie&&(typeof Ie.write=="function"&&(this._write=Ie.write),typeof Ie.writev=="function"&&(this._writev=Ie.writev),typeof Ie.destroy=="function"&&(this._destroy=Ie.destroy),typeof Ie.final=="function"&&(this._final=Ie.final),typeof Ie.construct=="function"&&(this._construct=Ie.construct),Ie.signal&&v(Ie.signal,this)),h.call(this,Ie),y.construct(this,()=>{const ge=this._writableState;ge.writing||me(this,ge),Re(this,ge)})}a(de,u,{__proto__:null,value:function(Ie){return r(this,Ie)?!0:this!==de?!1:Ie&&Ie._writableState instanceof K}}),de.prototype.pipe=function(){L(this,new C)};function re(Ie,V,ge,Te){const le=Ie._writableState;if(typeof ge=="function")Te=ge,ge=le.defaultEncoding;else{if(!ge)ge=le.defaultEncoding;else if(ge!=="buffer"&&!p.isEncoding(ge))throw new $(ge);typeof Te!="function"&&(Te=X)}if(V===null)throw new O;if(!le.objectMode)if(typeof V=="string")le.decodeStrings!==!1&&(V=p.from(V,ge),ge="buffer");else if(V instanceof p)ge="buffer";else if(h._isUint8Array(V))V=h._uint8ArrayToBuffer(V),ge="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],V);let ie;return le.ending?ie=new j:le.destroyed&&(ie=new k("write")),ie?(e.nextTick(Te,ie),L(Ie,ie,!0),ie):(le.pendingcb++,Y(Ie,le,V,ge,Te))}de.prototype.write=function(Ie,V,ge){return re(this,Ie,V,ge)===!0},de.prototype.cork=function(){this._writableState.corked++},de.prototype.uncork=function(){const Ie=this._writableState;Ie.corked&&(Ie.corked--,Ie.writing||me(this,Ie))},de.prototype.setDefaultEncoding=function(V){if(typeof V=="string"&&(V=o(V)),!p.isEncoding(V))throw new $(V);return this._writableState.defaultEncoding=V,this};function Y(Ie,V,ge,Te,le){const ie=V.objectMode?1:ge.length;V.length+=ie;const te=V.length<V.highWaterMark;return te||(V.needDrain=!0),V.writing||V.corked||V.errored||!V.constructed?(V.buffered.push({chunk:ge,encoding:Te,callback:le}),V.allBuffers&&Te!=="buffer"&&(V.allBuffers=!1),V.allNoop&&le!==X&&(V.allNoop=!1)):(V.writelen=ie,V.writecb=le,V.writing=!0,V.sync=!0,Ie._write(ge,Te,V.onwrite),V.sync=!1),te&&!V.errored&&!V.destroyed}function Q(Ie,V,ge,Te,le,ie,te){V.writelen=Te,V.writecb=te,V.writing=!0,V.sync=!0,V.destroyed?V.onwrite(new k("write")):ge?Ie._writev(le,V.onwrite):Ie._write(le,ie,V.onwrite),V.sync=!1}function ae(Ie,V,ge,Te){--V.pendingcb,Te(ge),oe(V),L(Ie,ge)}function B(Ie,V){const ge=Ie._writableState,Te=ge.sync,le=ge.writecb;if(typeof le!="function"){L(Ie,new E);return}ge.writing=!1,ge.writecb=null,ge.length-=ge.writelen,ge.writelen=0,V?(V.stack,ge.errored||(ge.errored=V),Ie._readableState&&!Ie._readableState.errored&&(Ie._readableState.errored=V),Te?e.nextTick(ae,Ie,ge,V,le):ae(Ie,ge,V,le)):(ge.buffered.length>ge.bufferedIndex&&me(Ie,ge),Te?ge.afterWriteTickInfo!==null&&ge.afterWriteTickInfo.cb===le?ge.afterWriteTickInfo.count++:(ge.afterWriteTickInfo={count:1,cb:le,stream:Ie,state:ge},e.nextTick(J,ge.afterWriteTickInfo)):ee(Ie,ge,1,le))}function J({stream:Ie,state:V,count:ge,cb:Te}){return V.afterWriteTickInfo=null,ee(Ie,V,ge,Te)}function ee(Ie,V,ge,Te){for(!V.ending&&!Ie.destroyed&&V.length===0&&V.needDrain&&(V.needDrain=!1,Ie.emit("drain"));ge-- >0;)V.pendingcb--,Te();V.destroyed&&oe(V),Re(Ie,V)}function oe(Ie){if(Ie.writing)return;for(let le=Ie.bufferedIndex;le<Ie.buffered.length;++le){var V;const{chunk:ie,callback:te}=Ie.buffered[le],_e=Ie.objectMode?1:ie.length;Ie.length-=_e,te((V=Ie.errored)!==null&&V!==void 0?V:new k("write"))}const ge=Ie[F].splice(0);for(let le=0;le<ge.length;le++){var Te;ge[le]((Te=Ie.errored)!==null&&Te!==void 0?Te:new k("end"))}q(Ie)}function me(Ie,V){if(V.corked||V.bufferProcessing||V.destroyed||!V.constructed)return;const{buffered:ge,bufferedIndex:Te,objectMode:le}=V,ie=ge.length-Te;if(!ie)return;let te=Te;if(V.bufferProcessing=!0,ie>1&&Ie._writev){V.pendingcb-=ie-1;const _e=V.allNoop?X:Ee=>{for(let We=te;We<ge.length;++We)ge[We].callback(Ee)},Me=V.allNoop&&te===0?ge:t(ge,te);Me.allBuffers=V.allBuffers,Q(Ie,V,!0,V.length,Me,"",_e),q(V)}else{do{const{chunk:_e,encoding:Me,callback:Ee}=ge[te];ge[te++]=null;const We=le?1:_e.length;Q(Ie,V,!1,We,_e,Me,Ee)}while(te<ge.length&&!V.writing);te===ge.length?q(V):te>256?(ge.splice(0,te),V.bufferedIndex=0):V.bufferedIndex=te}V.bufferProcessing=!1}de.prototype._write=function(Ie,V,ge){if(this._writev)this._writev([{chunk:Ie,encoding:V}],ge);else throw new S("_write()")},de.prototype._writev=null,de.prototype.end=function(Ie,V,ge){const Te=this._writableState;typeof Ie=="function"?(ge=Ie,Ie=null,V=null):typeof V=="function"&&(ge=V,V=null);let le;if(Ie!=null){const ie=re(this,Ie,V);ie instanceof n&&(le=ie)}return Te.corked&&(Te.corked=1,this.uncork()),le||(!Te.errored&&!Te.ending?(Te.ending=!0,Re(this,Te,!0),Te.ended=!0):Te.finished?le=new R("end"):Te.destroyed&&(le=new k("end"))),typeof ge=="function"&&(le||Te.finished?e.nextTick(ge,le):Te[F].push(ge)),this};function xe(Ie){return Ie.ending&&!Ie.destroyed&&Ie.constructed&&Ie.length===0&&!Ie.errored&&Ie.buffered.length===0&&!Ie.finished&&!Ie.writing&&!Ie.errorEmitted&&!Ie.closeEmitted}function Pe(Ie,V){let ge=!1;function Te(le){if(ge){L(Ie,le??E());return}if(ge=!0,V.pendingcb--,le){const ie=V[F].splice(0);for(let te=0;te<ie.length;te++)ie[te](le);L(Ie,le,V.sync)}else xe(V)&&(V.prefinished=!0,Ie.emit("prefinish"),V.pendingcb++,e.nextTick(ke,Ie,V))}V.sync=!0,V.pendingcb++;try{Ie._final(Te)}catch(le){Te(le)}V.sync=!1}function Ne(Ie,V){!V.prefinished&&!V.finalCalled&&(typeof Ie._final=="function"&&!V.destroyed?(V.finalCalled=!0,Pe(Ie,V)):(V.prefinished=!0,Ie.emit("prefinish")))}function Re(Ie,V,ge){xe(V)&&(Ne(Ie,V),V.pendingcb===0&&(ge?(V.pendingcb++,e.nextTick((Te,le)=>{xe(le)?ke(Te,le):le.pendingcb--},Ie,V)):xe(V)&&(V.pendingcb++,ke(Ie,V))))}function ke(Ie,V){V.pendingcb--,V.finished=!0;const ge=V[F].splice(0);for(let Te=0;Te<ge.length;Te++)ge[Te]();if(Ie.emit("finish"),V.autoDestroy){const Te=Ie._readableState;(!Te||Te.autoDestroy&&(Te.endEmitted||Te.readable===!1))&&Ie.destroy()}}i(de.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(Ie){this._writableState&&(this._writableState.destroyed=Ie)}},writable:{__proto__:null,get(){const Ie=this._writableState;return!!Ie&&Ie.writable!==!1&&!Ie.destroyed&&!Ie.errored&&!Ie.ending&&!Ie.ended},set(Ie){this._writableState&&(this._writableState.writable=!!Ie)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const Ie=this._writableState;return Ie?!Ie.destroyed&&!Ie.ending&&Ie.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Fe=y.destroy;de.prototype.destroy=function(Ie,V){const ge=this._writableState;return!ge.destroyed&&(ge.bufferedIndex<ge.buffered.length||ge[F].length)&&e.nextTick(oe,ge),Fe.call(this,Ie,V),this},de.prototype._undestroy=y.undestroy,de.prototype._destroy=function(Ie,V){V(Ie)},de.prototype[d.captureRejectionSymbol]=function(Ie){this.destroy(Ie)};let Qe;function Le(){return Qe===void 0&&(Qe={}),Qe}return de.fromWeb=function(Ie,V){return Le().newStreamWritableFromWritableStream(Ie,V)},de.toWeb=function(Ie){return Le().newWritableStreamFromStreamWritable(Ie)},US}var qS,pj;function Wee(){if(pj)return qS;pj=1;const e=rf(),t=Eu(),{isReadable:n,isWritable:r,isIterable:a,isNodeStream:i,isReadableNodeStream:s,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:u,isWritableStream:d}=nc(),h=Cu(),{AbortError:p,codes:{ERR_INVALID_ARG_TYPE:y,ERR_INVALID_RETURN_VALUE:v}}=Ei(),{destroyer:b}=ip(),w=Wl(),x=ox(),S=Uk(),{createDeferredPromise:E}=Di(),C=_P(),k=globalThis.Blob||t.Blob,R=typeof k<"u"?function(K){return K instanceof k}:function(K){return!1},O=globalThis.AbortController||Ag().AbortController,{FunctionPrototypeCall:j}=Xr();class $ extends w{constructor(K){super(K),(K==null?void 0:K.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(K==null?void 0:K.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}qS=function F(K,q){if(l(K))return K;if(s(K))return X({readable:K});if(o(K))return X({writable:K});if(i(K))return X({writable:!1,readable:!1});if(u(K))return X({readable:x.fromWeb(K)});if(d(K))return X({writable:S.fromWeb(K)});if(typeof K=="function"){const{value:re,write:Y,final:Q,destroy:ae}=L(K);if(a(re))return C($,re,{objectMode:!0,write:Y,final:Q,destroy:ae});const B=re==null?void 0:re.then;if(typeof B=="function"){let J;const ee=j(B,re,oe=>{if(oe!=null)throw new v("nully","body",oe)},oe=>{b(J,oe)});return J=new $({objectMode:!0,readable:!1,write:Y,final(oe){Q(async()=>{try{await ee,e.nextTick(oe,null)}catch(me){e.nextTick(oe,me)}})},destroy:ae})}throw new v("Iterable, AsyncIterable or AsyncFunction",q,re)}if(R(K))return F(K.arrayBuffer());if(a(K))return C($,K,{objectMode:!0,writable:!1});if(u(K==null?void 0:K.readable)&&d(K==null?void 0:K.writable))return $.fromWeb(K);if(typeof(K==null?void 0:K.writable)=="object"||typeof(K==null?void 0:K.readable)=="object"){const re=K!=null&&K.readable?s(K==null?void 0:K.readable)?K==null?void 0:K.readable:F(K.readable):void 0,Y=K!=null&&K.writable?o(K==null?void 0:K.writable)?K==null?void 0:K.writable:F(K.writable):void 0;return X({readable:re,writable:Y})}const de=K==null?void 0:K.then;if(typeof de=="function"){let re;return j(de,K,Y=>{Y!=null&&re.push(Y),re.push(null)},Y=>{b(re,Y)}),re=new $({objectMode:!0,writable:!1,read(){}})}throw new y(q,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],K)};function L(F){let{promise:K,resolve:q}=E();const de=new O,re=de.signal;return{value:F(async function*(){for(;;){const Q=K;K=null;const{chunk:ae,done:B,cb:J}=await Q;if(e.nextTick(J),B)return;if(re.aborted)throw new p(void 0,{cause:re.reason});({promise:K,resolve:q}=E()),yield ae}}(),{signal:re}),write(Q,ae,B){const J=q;q=null,J({chunk:Q,done:!1,cb:B})},final(Q){const ae=q;q=null,ae({done:!0,cb:Q})},destroy(Q,ae){de.abort(),ae(Q)}}}function X(F){const K=F.readable&&typeof F.readable.read!="function"?x.wrap(F.readable):F.readable,q=F.writable;let de=!!n(K),re=!!r(q),Y,Q,ae,B,J;function ee(oe){const me=B;B=null,me?me(oe):oe&&J.destroy(oe)}return J=new $({readableObjectMode:!!(K!=null&&K.readableObjectMode),writableObjectMode:!!(q!=null&&q.writableObjectMode),readable:de,writable:re}),re&&(h(q,oe=>{re=!1,oe&&b(K,oe),ee(oe)}),J._write=function(oe,me,xe){q.write(oe,me)?xe():Y=xe},J._final=function(oe){q.end(),Q=oe},q.on("drain",function(){if(Y){const oe=Y;Y=null,oe()}}),q.on("finish",function(){if(Q){const oe=Q;Q=null,oe()}})),de&&(h(K,oe=>{de=!1,oe&&b(K,oe),ee(oe)}),K.on("readable",function(){if(ae){const oe=ae;ae=null,oe()}}),K.on("end",function(){J.push(null)}),J._read=function(){for(;;){const oe=K.read();if(oe===null){ae=J._read;return}if(!J.push(oe))return}}),J._destroy=function(oe,me){!oe&&B!==null&&(oe=new p),ae=null,Y=null,Q=null,B===null?me(oe):(B=me,b(q,oe),b(K,oe))},J}return qS}var HS,mj;function Wl(){if(mj)return HS;mj=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=Xr();HS=s;const a=ox(),i=Uk();r(s.prototype,a.prototype),r(s,a);{const d=n(i.prototype);for(let h=0;h<d.length;h++){const p=d[h];s.prototype[p]||(s.prototype[p]=i.prototype[p])}}function s(d){if(!(this instanceof s))return new s(d);a.call(this,d),i.call(this,d),d?(this.allowHalfOpen=d.allowHalfOpen!==!1,d.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),d.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(s.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(d){this._readableState&&this._writableState&&(this._readableState.destroyed=d,this._writableState.destroyed=d)}}});let o;function l(){return o===void 0&&(o={}),o}s.fromWeb=function(d,h){return l().newStreamDuplexFromReadableWritablePair(d,h)},s.toWeb=function(d){return l().newReadableWritablePairFromDuplex(d)};let u;return s.from=function(d){return u||(u=Wee()),u(d,"body")},HS}var VS,gj;function SP(){if(gj)return VS;gj=1;const{ObjectSetPrototypeOf:e,Symbol:t}=Xr();VS=s;const{ERR_METHOD_NOT_IMPLEMENTED:n}=Ei().codes,r=Wl(),{getHighWaterMark:a}=sx();e(s.prototype,r.prototype),e(s,r);const i=t("kCallback");function s(u){if(!(this instanceof s))return new s(u);const d=u?a(this,u,"readableHighWaterMark",!0):null;d===0&&(u={...u,highWaterMark:null,readableHighWaterMark:d,writableHighWaterMark:u.writableHighWaterMark||0}),r.call(this,u),this._readableState.sync=!1,this[i]=null,u&&(typeof u.transform=="function"&&(this._transform=u.transform),typeof u.flush=="function"&&(this._flush=u.flush)),this.on("prefinish",l)}function o(u){typeof this._flush=="function"&&!this.destroyed?this._flush((d,h)=>{if(d){u?u(d):this.destroy(d);return}h!=null&&this.push(h),this.push(null),u&&u()}):(this.push(null),u&&u())}function l(){this._final!==o&&o.call(this)}return s.prototype._final=o,s.prototype._transform=function(u,d,h){throw new n("_transform()")},s.prototype._write=function(u,d,h){const p=this._readableState,y=this._writableState,v=p.length;this._transform(u,d,(b,w)=>{if(b){h(b);return}w!=null&&this.push(w),y.ended||v===p.length||p.length<p.highWaterMark?h():this[i]=h})},s.prototype._read=function(){if(this[i]){const u=this[i];this[i]=null,u()}},VS}var GS,yj;function EP(){if(yj)return GS;yj=1;const{ObjectSetPrototypeOf:e}=Xr();GS=n;const t=SP();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,a,i){i(null,r)},GS}var WS,bj;function qk(){if(bj)return WS;bj=1;const e=rf(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:a}=Xr(),i=Cu(),{once:s}=Di(),o=ip(),l=Wl(),{aggregateTwoErrors:u,codes:{ERR_INVALID_ARG_TYPE:d,ERR_INVALID_RETURN_VALUE:h,ERR_MISSING_ARGS:p,ERR_STREAM_DESTROYED:y,ERR_STREAM_PREMATURE_CLOSE:v},AbortError:b}=Ei(),{validateFunction:w,validateAbortSignal:x}=w0(),{isIterable:S,isReadable:E,isReadableNodeStream:C,isNodeStream:k,isTransformStream:R,isWebStream:O,isReadableStream:j,isReadableFinished:$}=nc(),L=globalThis.AbortController||Ag().AbortController;let X,F,K;function q(oe,me,xe){let Pe=!1;oe.on("close",()=>{Pe=!0});const Ne=i(oe,{readable:me,writable:xe},Re=>{Pe=!Re});return{destroy:Re=>{Pe||(Pe=!0,o.destroyer(oe,Re||new y("pipe")))},cleanup:Ne}}function de(oe){return w(oe[oe.length-1],"streams[stream.length - 1]"),oe.pop()}function re(oe){if(S(oe))return oe;if(C(oe))return Y(oe);throw new d("val",["Readable","Iterable","AsyncIterable"],oe)}async function*Y(oe){F||(F=ox()),yield*F.prototype[r].call(oe)}async function Q(oe,me,xe,{end:Pe}){let Ne,Re=null;const ke=Le=>{if(Le&&(Ne=Le),Re){const Ie=Re;Re=null,Ie()}},Fe=()=>new n((Le,Ie)=>{Ne?Ie(Ne):Re=()=>{Ne?Ie(Ne):Le()}});me.on("drain",ke);const Qe=i(me,{readable:!1},ke);try{me.writableNeedDrain&&await Fe();for await(const Le of oe)me.write(Le)||await Fe();Pe&&(me.end(),await Fe()),xe()}catch(Le){xe(Ne!==Le?u(Ne,Le):Le)}finally{Qe(),me.off("drain",ke)}}async function ae(oe,me,xe,{end:Pe}){R(me)&&(me=me.writable);const Ne=me.getWriter();try{for await(const Re of oe)await Ne.ready,Ne.write(Re).catch(()=>{});await Ne.ready,Pe&&await Ne.close(),xe()}catch(Re){try{await Ne.abort(Re),xe(Re)}catch(ke){xe(ke)}}}function B(...oe){return J(oe,s(de(oe)))}function J(oe,me,xe){if(oe.length===1&&t(oe[0])&&(oe=oe[0]),oe.length<2)throw new p("streams");const Pe=new L,Ne=Pe.signal,Re=xe==null?void 0:xe.signal,ke=[];x(Re,"options.signal");function Fe(){le(new b)}K=K||Di().addAbortListener;let Qe;Re&&(Qe=K(Re,Fe));let Le,Ie;const V=[];let ge=0;function Te(Ee){le(Ee,--ge===0)}function le(Ee,We){var kt;if(Ee&&(!Le||Le.code==="ERR_STREAM_PREMATURE_CLOSE")&&(Le=Ee),!(!Le&&!We)){for(;V.length;)V.shift()(Le);(kt=Qe)===null||kt===void 0||kt[a](),Pe.abort(),We&&(Le||ke.forEach(it=>it()),e.nextTick(me,Le,Ie))}}let ie;for(let Ee=0;Ee<oe.length;Ee++){const We=oe[Ee],kt=Ee<oe.length-1,it=Ee>0,xt=kt||(xe==null?void 0:xe.end)!==!1,Dt=Ee===oe.length-1;if(k(We)){let Ot=function(Wt){Wt&&Wt.name!=="AbortError"&&Wt.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Te(Wt)};var Me=Ot;if(xt){const{destroy:Wt,cleanup:be}=q(We,kt,it);V.push(Wt),E(We)&&Dt&&ke.push(be)}We.on("error",Ot),E(We)&&Dt&&ke.push(()=>{We.removeListener("error",Ot)})}if(Ee===0)if(typeof We=="function"){if(ie=We({signal:Ne}),!S(ie))throw new h("Iterable, AsyncIterable or Stream","source",ie)}else S(We)||C(We)||R(We)?ie=We:ie=l.from(We);else if(typeof We=="function"){if(R(ie)){var te;ie=re((te=ie)===null||te===void 0?void 0:te.readable)}else ie=re(ie);if(ie=We(ie,{signal:Ne}),kt){if(!S(ie,!0))throw new h("AsyncIterable",`transform[${Ee-1}]`,ie)}else{var _e;X||(X=EP());const Ot=new X({objectMode:!0}),Wt=(_e=ie)===null||_e===void 0?void 0:_e.then;if(typeof Wt=="function")ge++,Wt.call(ie,G=>{Ie=G,G!=null&&Ot.write(G),xt&&Ot.end(),e.nextTick(Te)},G=>{Ot.destroy(G),e.nextTick(Te,G)});else if(S(ie,!0))ge++,Q(ie,Ot,Te,{end:xt});else if(j(ie)||R(ie)){const G=ie.readable||ie;ge++,Q(G,Ot,Te,{end:xt})}else throw new h("AsyncIterable or Promise","destination",ie);ie=Ot;const{destroy:be,cleanup:I}=q(ie,!1,!0);V.push(be),Dt&&ke.push(I)}}else if(k(We)){if(C(ie)){ge+=2;const Ot=ee(ie,We,Te,{end:xt});E(We)&&Dt&&ke.push(Ot)}else if(R(ie)||j(ie)){const Ot=ie.readable||ie;ge++,Q(Ot,We,Te,{end:xt})}else if(S(ie))ge++,Q(ie,We,Te,{end:xt});else throw new d("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ie);ie=We}else if(O(We)){if(C(ie))ge++,ae(re(ie),We,Te,{end:xt});else if(j(ie)||S(ie))ge++,ae(ie,We,Te,{end:xt});else if(R(ie))ge++,ae(ie.readable,We,Te,{end:xt});else throw new d("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ie);ie=We}else ie=l.from(We)}return(Ne!=null&&Ne.aborted||Re!=null&&Re.aborted)&&e.nextTick(Fe),ie}function ee(oe,me,xe,{end:Pe}){let Ne=!1;if(me.on("close",()=>{Ne||xe(new v)}),oe.pipe(me,{end:!1}),Pe){let ke=function(){Ne=!0,me.end()};var Re=ke;$(oe)?e.nextTick(ke):oe.once("end",ke)}else xe();return i(oe,{readable:!0,writable:!1},ke=>{const Fe=oe._readableState;ke&&ke.code==="ERR_STREAM_PREMATURE_CLOSE"&&Fe&&Fe.ended&&!Fe.errored&&!Fe.errorEmitted?oe.once("end",xe).once("error",xe):xe(ke)}),i(me,{readable:!1,writable:!0},xe)}return WS={pipelineImpl:J,pipeline:B},WS}var KS,vj;function CP(){if(vj)return KS;vj=1;const{pipeline:e}=qk(),t=Wl(),{destroyer:n}=ip(),{isNodeStream:r,isReadable:a,isWritable:i,isWebStream:s,isTransformStream:o,isWritableStream:l,isReadableStream:u}=nc(),{AbortError:d,codes:{ERR_INVALID_ARG_VALUE:h,ERR_MISSING_ARGS:p}}=Ei(),y=Cu();return KS=function(...b){if(b.length===0)throw new p("streams");if(b.length===1)return t.from(b[0]);const w=[...b];if(typeof b[0]=="function"&&(b[0]=t.from(b[0])),typeof b[b.length-1]=="function"){const X=b.length-1;b[X]=t.from(b[X])}for(let X=0;X<b.length;++X)if(!(!r(b[X])&&!s(b[X]))){if(X<b.length-1&&!(a(b[X])||u(b[X])||o(b[X])))throw new h(`streams[${X}]`,w[X],"must be readable");if(X>0&&!(i(b[X])||l(b[X])||o(b[X])))throw new h(`streams[${X}]`,w[X],"must be writable")}let x,S,E,C,k;function R(X){const F=C;C=null,F?F(X):X?k.destroy(X):!L&&!$&&k.destroy()}const O=b[0],j=e(b,R),$=!!(i(O)||l(O)||o(O)),L=!!(a(j)||u(j)||o(j));if(k=new t({writableObjectMode:!!(O!=null&&O.writableObjectMode),readableObjectMode:!!(j!=null&&j.readableObjectMode),writable:$,readable:L}),$){if(r(O))k._write=function(F,K,q){O.write(F,K)?q():x=q},k._final=function(F){O.end(),S=F},O.on("drain",function(){if(x){const F=x;x=null,F()}});else if(s(O)){const K=(o(O)?O.writable:O).getWriter();k._write=async function(q,de,re){try{await K.ready,K.write(q).catch(()=>{}),re()}catch(Y){re(Y)}},k._final=async function(q){try{await K.ready,K.close().catch(()=>{}),S=q}catch(de){q(de)}}}const X=o(j)?j.readable:j;y(X,()=>{if(S){const F=S;S=null,F()}})}if(L){if(r(j))j.on("readable",function(){if(E){const X=E;E=null,X()}}),j.on("end",function(){k.push(null)}),k._read=function(){for(;;){const X=j.read();if(X===null){E=k._read;return}if(!k.push(X))return}};else if(s(j)){const F=(o(j)?j.readable:j).getReader();k._read=async function(){for(;;)try{const{value:K,done:q}=await F.read();if(!k.push(K))return;if(q){k.push(null);return}}catch{return}}}}return k._destroy=function(X,F){!X&&C!==null&&(X=new d),E=null,x=null,S=null,C===null?F(X):(C=F,r(j)&&n(j,X))},k},KS}var wj;function Kee(){if(wj)return Ib;wj=1;const e=globalThis.AbortController||Ag().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:a},AbortError:i}=Ei(),{validateAbortSignal:s,validateInteger:o,validateObject:l}=w0(),u=Xr().Symbol("kWeak"),d=Xr().Symbol("kResistStopPropagation"),{finished:h}=Cu(),p=CP(),{addAbortSignalNoValidate:y}=ix(),{isWritable:v,isNodeStream:b}=nc(),{deprecate:w}=Di(),{ArrayPrototypePush:x,Boolean:S,MathFloor:E,Number:C,NumberIsNaN:k,Promise:R,PromiseReject:O,PromiseResolve:j,PromisePrototypeThen:$,Symbol:L}=Xr(),X=L("kEmpty"),F=L("kEof");function K(Re,ke){if(ke!=null&&l(ke,"options"),(ke==null?void 0:ke.signal)!=null&&s(ke.signal,"options.signal"),b(Re)&&!v(Re))throw new t("stream",Re,"must be writable");const Fe=p(this,Re);return ke!=null&&ke.signal&&y(ke.signal,Fe),Fe}function q(Re,ke){if(typeof Re!="function")throw new n("fn",["Function","AsyncFunction"],Re);ke!=null&&l(ke,"options"),(ke==null?void 0:ke.signal)!=null&&s(ke.signal,"options.signal");let Fe=1;(ke==null?void 0:ke.concurrency)!=null&&(Fe=E(ke.concurrency));let Qe=Fe-1;return(ke==null?void 0:ke.highWaterMark)!=null&&(Qe=E(ke.highWaterMark)),o(Fe,"options.concurrency",1),o(Qe,"options.highWaterMark",0),Qe+=Fe,(async function*(){const Ie=Di().AbortSignalAny([ke==null?void 0:ke.signal].filter(S)),V=this,ge=[],Te={signal:Ie};let le,ie,te=!1,_e=0;function Me(){te=!0,Ee()}function Ee(){_e-=1,We()}function We(){ie&&!te&&_e<Fe&&ge.length<Qe&&(ie(),ie=null)}async function kt(){try{for await(let it of V){if(te)return;if(Ie.aborted)throw new i;try{if(it=Re(it,Te),it===X)continue;it=j(it)}catch(xt){it=O(xt)}_e+=1,$(it,Ee,Me),ge.push(it),le&&(le(),le=null),!te&&(ge.length>=Qe||_e>=Fe)&&await new R(xt=>{ie=xt})}ge.push(F)}catch(it){const xt=O(it);$(xt,Ee,Me),ge.push(xt)}finally{te=!0,le&&(le(),le=null)}}kt();try{for(;;){for(;ge.length>0;){const it=await ge[0];if(it===F)return;if(Ie.aborted)throw new i;it!==X&&(yield it),ge.shift(),We()}await new R(it=>{le=it})}}finally{te=!0,ie&&(ie(),ie=null)}}).call(this)}function de(Re=void 0){return Re!=null&&l(Re,"options"),(Re==null?void 0:Re.signal)!=null&&s(Re.signal,"options.signal"),(async function*(){let Fe=0;for await(const Le of this){var Qe;if(Re!=null&&(Qe=Re.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i({cause:Re.signal.reason});yield[Fe++,Le]}}).call(this)}async function re(Re,ke=void 0){for await(const Fe of B.call(this,Re,ke))return!0;return!1}async function Y(Re,ke=void 0){if(typeof Re!="function")throw new n("fn",["Function","AsyncFunction"],Re);return!await re.call(this,async(...Fe)=>!await Re(...Fe),ke)}async function Q(Re,ke){for await(const Fe of B.call(this,Re,ke))return Fe}async function ae(Re,ke){if(typeof Re!="function")throw new n("fn",["Function","AsyncFunction"],Re);async function Fe(Qe,Le){return await Re(Qe,Le),X}for await(const Qe of q.call(this,Fe,ke));}function B(Re,ke){if(typeof Re!="function")throw new n("fn",["Function","AsyncFunction"],Re);async function Fe(Qe,Le){return await Re(Qe,Le)?Qe:X}return q.call(this,Fe,ke)}class J extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function ee(Re,ke,Fe){var Qe;if(typeof Re!="function")throw new n("reducer",["Function","AsyncFunction"],Re);Fe!=null&&l(Fe,"options"),(Fe==null?void 0:Fe.signal)!=null&&s(Fe.signal,"options.signal");let Le=arguments.length>1;if(Fe!=null&&(Qe=Fe.signal)!==null&&Qe!==void 0&&Qe.aborted){const le=new i(void 0,{cause:Fe.signal.reason});throw this.once("error",()=>{}),await h(this.destroy(le)),le}const Ie=new e,V=Ie.signal;if(Fe!=null&&Fe.signal){const le={once:!0,[u]:this,[d]:!0};Fe.signal.addEventListener("abort",()=>Ie.abort(),le)}let ge=!1;try{for await(const le of this){var Te;if(ge=!0,Fe!=null&&(Te=Fe.signal)!==null&&Te!==void 0&&Te.aborted)throw new i;Le?ke=await Re(ke,le,{signal:V}):(ke=le,Le=!0)}if(!ge&&!Le)throw new J}finally{Ie.abort()}return ke}async function oe(Re){Re!=null&&l(Re,"options"),(Re==null?void 0:Re.signal)!=null&&s(Re.signal,"options.signal");const ke=[];for await(const Qe of this){var Fe;if(Re!=null&&(Fe=Re.signal)!==null&&Fe!==void 0&&Fe.aborted)throw new i(void 0,{cause:Re.signal.reason});x(ke,Qe)}return ke}function me(Re,ke){const Fe=q.call(this,Re,ke);return(async function*(){for await(const Le of Fe)yield*Le}).call(this)}function xe(Re){if(Re=C(Re),k(Re))return 0;if(Re<0)throw new a("number",">= 0",Re);return Re}function Pe(Re,ke=void 0){return ke!=null&&l(ke,"options"),(ke==null?void 0:ke.signal)!=null&&s(ke.signal,"options.signal"),Re=xe(Re),(async function*(){var Qe;if(ke!=null&&(Qe=ke.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ie of this){var Le;if(ke!=null&&(Le=ke.signal)!==null&&Le!==void 0&&Le.aborted)throw new i;Re--<=0&&(yield Ie)}}).call(this)}function Ne(Re,ke=void 0){return ke!=null&&l(ke,"options"),(ke==null?void 0:ke.signal)!=null&&s(ke.signal,"options.signal"),Re=xe(Re),(async function*(){var Qe;if(ke!=null&&(Qe=ke.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ie of this){var Le;if(ke!=null&&(Le=ke.signal)!==null&&Le!==void 0&&Le.aborted)throw new i;if(Re-- >0&&(yield Ie),Re<=0)return}}).call(this)}return Ib.streamReturningOperators={asIndexedPairs:w(de,"readable.asIndexedPairs will be removed in a future version."),drop:Pe,filter:B,flatMap:me,map:q,take:Ne,compose:K},Ib.promiseReturningOperators={every:Y,forEach:ae,reduce:ee,toArray:oe,some:re,find:Q},Ib}var ZS,xj;function kP(){if(xj)return ZS;xj=1;const{ArrayPrototypePop:e,Promise:t}=Xr(),{isIterable:n,isNodeStream:r,isWebStream:a}=nc(),{pipelineImpl:i}=qk(),{finished:s}=Cu();TP();function o(...l){return new t((u,d)=>{let h,p;const y=l[l.length-1];if(y&&typeof y=="object"&&!r(y)&&!n(y)&&!a(y)){const v=e(l);h=v.signal,p=v.end}i(l,(v,b)=>{v?d(v):u(b)},{signal:h,end:p})})}return ZS={finished:s,pipeline:o},ZS}var _j;function TP(){if(_j)return CS.exports;_j=1;const{Buffer:e}=Eu(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=Xr(),{promisify:{custom:a}}=Di(),{streamReturningOperators:i,promiseReturningOperators:s}=Kee(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=Ei(),l=CP(),{setDefaultHighWaterMark:u,getDefaultHighWaterMark:d}=sx(),{pipeline:h}=qk(),{destroyer:p}=ip(),y=Cu(),v=kP(),b=nc(),w=CS.exports=Bk().Stream;w.isDestroyed=b.isDestroyed,w.isDisturbed=b.isDisturbed,w.isErrored=b.isErrored,w.isReadable=b.isReadable,w.isWritable=b.isWritable,w.Readable=ox();for(const E of n(i)){let k=function(...R){if(new.target)throw o();return w.Readable.from(r(C,this,R))};var S=k;const C=i[E];t(k,"name",{__proto__:null,value:C.name}),t(k,"length",{__proto__:null,value:C.length}),t(w.Readable.prototype,E,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}for(const E of n(s)){let k=function(...O){if(new.target)throw o();return r(C,this,O)};var S=k;const C=s[E];t(k,"name",{__proto__:null,value:C.name}),t(k,"length",{__proto__:null,value:C.length}),t(w.Readable.prototype,E,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}w.Writable=Uk(),w.Duplex=Wl(),w.Transform=SP(),w.PassThrough=EP(),w.pipeline=h;const{addAbortSignal:x}=ix();return w.addAbortSignal=x,w.finished=y,w.destroy=p,w.compose=l,w.setDefaultHighWaterMark=u,w.getDefaultHighWaterMark=d,t(w,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return v}}),t(h,a,{__proto__:null,enumerable:!0,get(){return v.pipeline}}),t(y,a,{__proto__:null,enumerable:!0,get(){return v.finished}}),w.Stream=w,w._isUint8Array=function(C){return C instanceof Uint8Array},w._uint8ArrayToBuffer=function(C){return e.from(C.buffer,C.byteOffset,C.byteLength)},CS.exports}var Sj;function Zee(){return Sj||(Sj=1,function(e){const t=TP(),n=kP(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(ES)),ES.exports}var AP=Zee();class Hk extends AP.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(a=>{this._path=a.path;const i=a.readableWebStream({start:t.start,end:t.end});this.reader=i.getReader(),this.pending=!1}).catch(a=>{this.destroy(a)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Ue(lt.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ue(lt.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class Vk extends AP.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const a=r.writableWebStream({start:t.start});this.writer=a.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(si(new Ue(lt.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(si(new Ue(lt.ENOTSUP,"Unsupported encoding for stream",this._path)));const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(a),this._bytesWritten+=t.byteLength,r()}catch(i){r(new Ue(lt.EIO,i.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Ue(lt.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ue(lt.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var Rs=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,a;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(a=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");a&&(r=function(){try{a.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Is=function(e){return function(t){function n(s){t.error=t.hasError?new e(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,a=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&a===1)return a=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(s).then(i,function(o){return n(o),i()})}else a|=1}catch(o){n(o)}if(a===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class ci{get position(){return this.flag&Pd?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=fi(t,n);Object.assign(this,Kd(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&tx||this.inode.flags&Oi.Sync)}_emitChange(){Xa(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Ue.With("EBADF",this.path,"chown");this.dirty=!0,sP(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=_u(t,-1);if(n<0)throw new Ue(lt.EINVAL,"Invalid mode");if(this.closed)throw Ue.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>Cr?-61441:Cr)|n,(this._isSync||n>Cr)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Ue.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Ue.With("EBADF",this.path,"truncate");if(t<0)throw new Ue(lt.EINVAL);if(this.dirty=!0,!(this.flag&ai||this.flag&Ll))throw new Ue(lt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Ue.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=qv(t),this.inode.mtimeMs=qv(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=$l(n,"utf8","a",420);if(!(Bl(r.flag)&Pd))throw new Ue(lt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Ue(lt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Pr.from(t,r.encoding):t;await this._write(i,0,i.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,a=this.position){if(this.closed)throw Ue.With("EBADF",this.path,"read");if(this.flag&ai)throw new Ue(lt.EPERM,"File not opened with a readable mode");this.inode.flags&Oi.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=a+r;!Cg(this.inode)&&!Eg(this.inode)&&i>this.inode.size&&(i=a+Math.max(this.inode.size-a,0)),this._position=i;const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,s.subarray(n,n+r),a,i),this._isSync&&await this.sync(),{bytesRead:i-a,buffer:t}}async read(t,n,r,a){typeof n=="object"&&n!=null&&(a=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(a=t.position,r=t.length,n=t.offset,t=t.buffer);const i=Number.isSafeInteger(a)?a:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,i)}async readFile(t){const n=$l(t,null,"r",292);if(Bl(n.flag)&ai)throw new Ue(lt.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:a}=await this.stat(),{buffer:i}=await this._read(new Uint8Array(a),0,a,0),s=Pr.from(i);return n.encoding?s.toString(n.encoding):s}readableWebStream(t={}){if(this.closed)throw Ue.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Ue.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&Oi.Immutable)throw new Ue(lt.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&ai)throw Ue.With("EBADF",this.path,"readLines");return pee({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Ue.With("EBADF",this.path,"stat");if(!hr(this.context,this.inode,Sa))throw Ue.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new ef(this.inode):new tc(this.inode)}async _write(t,n=0,r=t.byteLength-n,a=this.position){if(this.closed)throw Ue.With("EBADF",this.path,"write");if(this.inode.flags&Oi.Immutable)throw new Ue(lt.EPERM,"File is immutable",this.path,"write");if(!(this.flag&ai||this.flag&Ll))throw new Ue(lt.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const i=a+r,s=t.subarray(n,n+r);return!Cg(this.inode)&&!Eg(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=a+s.byteLength,await this.fs.write(this.internalPath,s,a),this._isSync&&await this.sync(),s.byteLength}async write(t,n,r,a){let i,s,o;typeof n=="object"&&n!=null&&(r=n.length,a=n.position,n=n.offset),typeof t=="string"?(a=typeof n=="number"?n:null,s=0,i=Pr.from(t,typeof r=="string"?r:"utf8"),o=i.length):(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),s=n??0,o=typeof r=="number"?r:i.byteLength,a=typeof a=="number"?a:null),a??(a=this.position);const l=await this._write(i,s,o,a);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=$l(n,"utf8","w",420),a=Bl(r.flag);if(!(a&ai||a&Ll))throw new Ue(lt.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Ue(lt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Pr.from(t,r.encoding):t;await this._write(i,0,i.length,0),this._emitChange()}async close(){if(this.closed)throw Ue.With("EBADF",this.path,"close");await this.sync(),this.dispose(),cP(this.context,this.fd)}dispose(t){if(this.closed)throw Ue.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ue.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const a of t)r+=(await this.write(a)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const a of t)r+=(await this.read(a)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&ai)throw Ue.With("EBADF",this.path,"createReadStream");return new Hk(t,this)}createWriteStream(t={}){if(this.closed)throw Ue.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&Oi.Immutable)throw new Ue(lt.EPERM,"File is immutable",this.path,"createWriteStream");return new Vk(t,this)}}async function NP(e,t){e=hn(e),t=hn(t);const n=Ln(e,this),r=Ln(t,this);if(!(await sp.call(this,ir(e))).hasAccess(ta,this))throw Ue.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),Xa(this,"rename",e.toString()),Xa(this,"change",t.toString());return}await dx.call(this,t,await ux(e)),await cx.call(this,e),Xa(this,"rename",e.toString())}catch(a){throw pr(a,{[n.path]:e,[r.path]:t})}}async function x0(e){try{const{fs:t,path:n}=Ln(await ku.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Ue&&t.code=="ENOENT")return!1;throw t}}async function sp(e,t){e=hn(e);const{fs:n,path:r}=Ln(await ku.call(this,e),this);try{const a=await n.stat(r);if(Ea&&!hr(this,a,Sa))throw Ue.With("EACCES",r,"stat");return t!=null&&t.bigint?new ef(a):new tc(a)}catch(a){throw pr(a,{[r]:e})}}async function lx(e,t){e=hn(e);const{fs:n,path:r}=Ln(e,this);try{const a=await n.stat(r);if(Ea&&!hr(this,a,Sa))throw Ue.With("EACCES",r,"lstat");return t!=null&&t.bigint?new ef(a):new tc(a)}catch(a){throw pr(a,{[r]:e})}}async function RP(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await Rs(n,await js.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Is(n);r&&await r}}async function cx(e){e=hn(e);const{fs:t,path:n}=Ln(e,this);try{if(Ea&&!hr(this,await t.stat(n),ta))throw Ue.With("EACCES",n,"unlink");await t.unlink(n),Xa(this,"rename",e.toString())}catch(r){throw pr(r,{[n]:e})}}async function op(e,t,n){var r;t=hn(t);const a=_u(n.mode,420),i=Bl(n.flag),{fullPath:s,fs:o,path:l,stats:u}=await Wv(e,t.toString(),n.preserveSymlinks);if(!u){if(!(i&Jw))throw Ue.With("ENOENT",s,"_open");const h=await o.stat(ir(l));if(!hr(e,h,ta))throw Ue.With("EACCES",ir(s),"_open");if(!ro(h))throw Ue.With("ENOTDIR",ir(s),"_open");const{euid:p,egid:y}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:lo.credentials,v=await o.createFile(l,{mode:a,uid:h.mode&g0?h.uid:p,gid:h.mode&y0?h.gid:y});return new ci(e,Vv(new Hv(e,t,o,l,i,v)))}if(!hr(e,u,uP(i)))throw Ue.With("EACCES",s,"_open");if(i&Qw)throw Ue.With("EEXIST",s,"_open");const d=new ci(e,Vv(new Hv(e,t,o,l,i,u)));return i&ex&&await d.truncate(0),d}async function js(e,t="r",n=420){return await op(this,e,{flag:t,mode:n})}async function ux(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=$l(t,null,"r",292);return await Rs(n,typeof e=="object"&&"fd"in e?e:await js.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=Is(n);r&&await r}}async function dx(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const a=$l(n,"utf8","w+",420),i=Rs(r,e instanceof ci?e:await js.call(this,e.toString(),a.flag,a.mode),!0),s=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof s!="string"&&!(s instanceof Uint8Array))throw new Ue(lt.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,i.path,"writeFile");await i.writeFile(s,a)}catch(a){r.error=a,r.hasError=!0}finally{const a=Is(r);a&&await a}}async function IP(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const a=$l(n,"utf8","a",420);if(!(Bl(a.flag)&Pd))throw new Ue(lt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!a.encoding)throw new Ue(lt.EINVAL,"Encoding not specified");const s=typeof t=="string"?Pr.from(t,a.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await Rs(r,typeof e=="object"&&"fd"in e?e:await js.call(this,e,a.flag,a.mode),!0).appendFile(s,a)}catch(a){r.error=a,r.hasError=!0}finally{const a=Is(r);a&&await a}}async function Gk(e){e=await ku.call(this,e);const{fs:t,path:n}=Ln(e,this);try{const r=await t.stat(n);if(!r)throw Ue.With("ENOENT",e,"rmdir");if(!ro(r))throw Ue.With("ENOTDIR",n,"rmdir");if(Ea&&!hr(this,r,ta))throw Ue.With("EACCES",n,"rmdir");await t.rmdir(n),Xa(this,"rename",e.toString())}catch(r){throw pr(r,{[n]:e})}}async function fx(e,t){var n,r;const{euid:a,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:lo.credentials;t=typeof t=="object"?t:{mode:t};const s=_u(t==null?void 0:t.mode,511);e=await ku.call(this,e);const{fs:o,path:l,root:u}=Ln(e,this),d={[l]:e},h=async(p,y)=>{if(!hr(this,y,ta))throw Ue.With("EACCES",ir(p),"mkdir");const v=await o.mkdir(p,{mode:s,uid:y.mode&g0?y.uid:a,gid:y.mode&y0?y.gid:i});return Xa(this,"rename",p),v};try{if(!(t!=null&&t.recursive)){await h(l,await o.stat(ir(l)));return}const p=[];for(let v=l,b=e;!await o.exists(v);v=ir(v),b=ir(b))p.unshift(v),d[v]=b;if(!p.length)return;const y=[await o.stat(ir(p[0]))];for(const[v,b]of p.entries())y.push(await h(b,y[v]));return u.length==1?p[0]:(r=p[0])===null||r===void 0?void 0:r.slice(u.length)}catch(p){throw pr(p,d)}}async function af(e,t){t=typeof t=="object"?t:{encoding:t},e=await ku.call(this,e);const{fs:n,path:r}=Ln(e,this),a=await n.stat(r).catch(l=>yr(pr(l,{[r]:e})));if(!a)throw Ue.With("ENOENT",e,"readdir");if(!hr(this,a,Sa))throw Ue.With("EACCES",e,"readdir");if(!ro(a))throw Ue.With("ENOTDIR",e,"readdir");const i=await n.readdir(r).catch(l=>yr(pr(l,{[r]:e}))),s=[],o=async l=>{let u;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(u=await n.stat(cr(r,l)).catch(d=>{if(d.code!="ENOENT")throw pr(d,{[r]:e})}),!u))&&(t!=null&&t.withFileTypes?s.push(new Tg(l,u)):(t==null?void 0:t.encoding)=="buffer"?s.push(Pr.from(l)):s.push(l),!(!(t!=null&&t.recursive)||!ro(u))))for(const d of await af.call(this,cr(e,l),t))d instanceof Tg?(d.path=cr(l,d.path),s.push(d)):Pr.isBuffer(d)?s.push(Pr.from(cr(l,bk(d)))):s.push(cr(l,d))};return await Promise.all(i.map(o)),s}async function jP(e,t){e=hn(e),t=hn(t);const{fs:n,path:r}=Ln(e,this),a=Ln(t,this);if(n!=a.fs)throw Ue.With("EXDEV",t,"link");try{if(Ea&&!hr(this,await n.stat(ir(r)),Sa))throw Ue.With("EACCES",ir(r),"link");if(Ea&&!(await sp.call(this,ir(t))).hasAccess(ta,this))throw Ue.With("EACCES",ir(t),"link");if(Ea&&!hr(this,await n.stat(r),Sa))throw Ue.With("EACCES",r,"link");return await n.link(r,a.path)}catch(i){throw pr(i,{[a.path]:t,[r]:e})}}async function OP(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ue(lt.EINVAL,"Invalid symlink type: "+n);if(t=hn(t),await x0.call(this,t))throw Ue.With("EEXIST",t,"symlink");const a=Rs(r,await op(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await a.writeFile(hn(e,!0)),await a.chmod(ec)}catch(a){r.error=a,r.hasError=!0}finally{const a=Is(r);a&&await a}}async function Gv(e,t){const n={stack:[],error:void 0,hasError:!1};try{const a=await Rs(n,await op(this,hn(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),i=typeof t=="object"?t==null?void 0:t.encoding:t;return i=="buffer"?a:a.toString(i??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=Is(n);r&&await r}}async function DP(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Rs(r,await js.call(this,e,"r+"),!0).chown(t,n)}catch(a){r.error=a,r.hasError=!0}finally{const a=Is(r);a&&await a}}async function MP(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Rs(r,await op(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(a){r.error=a,r.hasError=!0}finally{const a=Is(r);a&&await a}}async function PP(e,t){const n={stack:[],error:void 0,hasError:!1};try{await Rs(n,await js.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Is(n);r&&await r}}async function FP(e,t){const n={stack:[],error:void 0,hasError:!1};try{await Rs(n,await op(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Is(n);r&&await r}}async function Wk(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Rs(r,await js.call(this,e,"r+"),!0).utimes(t,n)}catch(a){r.error=a,r.hasError=!0}finally{const a=Is(r);a&&await a}}async function LP(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Rs(r,await op(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(a){r.error=a,r.hasError=!0}finally{const a=Is(r);a&&await a}}async function Wv(e,t,n){if(n){const l=Ln(t,e),u=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:u}}try{const l=Ln(t,e),u=await l.fs.stat(l.path);if(!Ph(u))return{...l,fullPath:t,stats:u};const d=Gl.call(e,ir(t),(await Gv.call(e,t)).toString());return await Wv(e,d)}catch{}const{base:r,dir:a}=jo(t),i=a=="/"?"/":await ku.call(e,a),s=cr(i,r),o=Ln(s,e);try{const l=await o.fs.stat(o.path);if(!Ph(l))return{...o,fullPath:s,stats:l};const u=Gl.call(e,i,(await Gv.call(e,s)).toString());return await Wv(e,u)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw pr(l,{[o.path]:s})}}async function ku(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=hn(e);const{fullPath:a}=await Wv(this,e);if(r=="utf8"||r=="utf-8")return a;const i=Pr.from(a,"utf-8");return r=="buffer"?i:i.toString(r)}function Yee(e,t={}){const n=new pP(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let a=!1;n.on("change",(s,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:s,filename:o},done:!1})});function i(){a=!0,n.close();for(const s of r)s({value:null,done:a});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(a)return Promise.resolve({value:null,done:a});const{promise:s,resolve:o}=Promise.withResolvers();return r.push(o),s},return:i,throw:i,async[Symbol.asyncDispose](){await i()},[Symbol.asyncIterator](){return this}}}async function $P(e,t=Ck){if(!(await sp.call(this,e)).hasAccess(t,this))throw new Ue(lt.EACCES)}async function Kk(e,t){e=hn(e);const n=await lx.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&Cr){case ha:if(t!=null&&t.recursive)for(const r of await af.call(this,e))await Kk.call(this,cr(e,r),t);await Gk.call(this,e);break;case Ys:case ec:case Xd:case Jd:await cx.call(this,e);break;case Qd:case Yd:default:throw new Ue(lt.EPERM,"File type not supported",e,"rm")}}async function BP(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",a="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await fx.call(this,a),n=="buffer"?Pr.from(a):a}async function Zk(e,t,n){if(e=hn(e),t=hn(t),n&&n&kk&&await x0.call(this,t))throw new Ue(lt.EEXIST,"Destination file already exists",t,"copyFile");await dx.call(this,t,await ux.call(this,e)),Xa(this,"rename",t.toString())}function zP(e,t){return e=hn(e),Promise.resolve(new $k(e,this))}async function Yk(e,t,n){e=hn(e),t=hn(t);const r=await lx.call(this,e);if(n!=null&&n.errorOnExist&&await x0.call(this,t))throw new Ue(lt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Cr){case ha:{if(!(n!=null&&n.recursive))throw new Ue(lt.EISDIR,e+" is a directory (not copied)",e,"cp");const[a]=await Promise.all([af.call(this,e,{withFileTypes:!0}),fx.call(this,t,{recursive:!0})]),i=async s=>{n.filter&&!n.filter(cr(e,s.name),cr(t,s.name))||await Yk.call(this,cr(e,s.name),cr(t,s.name),n)};await Promise.all(a.map(i));break}case Ys:case ec:await Zk.call(this,e,t);break;case Xd:case Jd:case Qd:case Yd:default:throw new Ue(lt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await Wk.call(this,t,r.atime,r.mtime)}async function UP(e,t){e=hn(e);const{fs:n}=Ln(e,this);return Promise.resolve(fP(n,t==null?void 0:t.bigint))}function qP(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:a=()=>!1}=t||{},i=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*s(o){const l=await af(o,{withFileTypes:r,encoding:"utf8"});for(const u of l){const d=r?u.path:o+"/"+u;a(r?u:d)||((await sp(d)).isDirectory()&&i.some(h=>h.source.includes(".*"))&&(yield*s(d)),i.some(h=>h.test(d.replace(/^\/+/g,"")))&&(yield r?u:d.replace(/^\/+/g,"")))}}return s(n)}const Xee=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:ci,access:$P,appendFile:IP,chmod:PP,chown:DP,constants:aP,copyFile:Zk,cp:Yk,exists:x0,glob:qP,lchmod:FP,lchown:MP,link:jP,lstat:lx,lutimes:LP,mkdir:fx,mkdtemp:BP,open:js,opendir:zP,readFile:ux,readdir:af,readlink:Gv,realpath:ku,rename:NP,rm:Kk,rmdir:Gk,stat:sp,statfs:UP,symlink:OP,truncate:RP,unlink:cx,utimes:Wk,watch:Yee,writeFile:dx},Symbol.toStringTag,{value:"Module"})),Rn=()=>{};async function Jee(e){const t=[];for await(const n of e)t.push(n);return t}function Qee(e,t,n=Rn){NP.call(this,e,t).then(()=>n()).catch(n)}function ete(e,t=Rn){x0.call(this,e).then(t).catch(()=>t(!1))}function tte(e,t,n=Rn){n=typeof t=="function"?t:n,sp.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function nte(e,t,n=Rn){n=typeof t=="function"?t:n,lx.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function rte(e,t=0,n=Rn){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;RP.call(this,e,r).then(()=>n()).catch(n)}function ate(e,t=Rn){cx.call(this,e).then(()=>t()).catch(t)}function ite(e,t,n,r=Rn){const a=_u(n,420);r=typeof n=="function"?n:r,js.call(this,e,t,a).then(i=>r(void 0,i.fd)).catch(r)}function ste(e,t,n=Rn){n=typeof t=="function"?t:n,ux.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function ote(e,t,n,r=Rn){r=typeof n=="function"?n:r,dx.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function lte(e,t,n,r=Rn){const a=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,IP.call(this,e,t,a).then(()=>r()).catch(r)}function cte(e,t,n=Rn){n=typeof t=="function"?t:n,new ci(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new ef(r):r)).catch(n)}function ute(e,t=Rn){new ci(this,e).close().then(()=>t()).catch(t)}function dte(e,t,n=Rn){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const a=new ci(this,e);if(r<0)throw new Ue(lt.EINVAL);a.truncate(r).then(()=>n()).catch(n)}function fte(e,t=Rn){new ci(this,e).sync().then(()=>t()).catch(t)}function hte(e,t=Rn){new ci(this,e).datasync().then(()=>t()).catch(t)}function pte(e,t,n,r,a,i=Rn){let s,o,l,u,d;const h=new ci(this,e);if(typeof t=="string"){switch(d="utf8",typeof n){case"function":i=n;break;case"number":u=n,d=typeof r=="string"?r:"utf8",i=typeof a=="function"?a:i;break;default:i=typeof r=="function"?r:typeof a=="function"?a:i,i(new Ue(lt.EINVAL,"Invalid arguments"));return}s=Pr.from(t),o=0,l=s.length;const p=i;h.write(s,o,l,u).then(({bytesWritten:y})=>p(void 0,y,s.toString(d))).catch(p)}else{s=Pr.from(t.buffer),o=n,l=r,u=typeof a=="number"?a:null;const p=typeof a=="function"?a:i;h.write(s,o,l,u).then(({bytesWritten:y})=>p(void 0,y,s)).catch(p)}}function mte(e,t,n,r,a,i=Rn){new ci(this,e).read(t,n,r,a).then(({bytesRead:s,buffer:o})=>i(void 0,s,o)).catch(i)}function gte(e,t,n,r=Rn){new ci(this,e).chown(t,n).then(()=>r()).catch(r)}function yte(e,t,n){new ci(this,e).chmod(t).then(()=>n()).catch(n)}function bte(e,t,n,r=Rn){new ci(this,e).utimes(t,n).then(()=>r()).catch(r)}function vte(e,t=Rn){Gk.call(this,e).then(()=>t()).catch(t)}function wte(e,t,n=Rn){fx.call(this,e,t).then(()=>n()).catch(n)}function xte(e,t,n=Rn){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};af.call(this,e,r).then(a=>n(void 0,a)).catch(n)}function _te(e,t,n=Rn){jP.call(this,e,t).then(()=>n()).catch(n)}function Ste(e,t,n,r=Rn){const a=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,OP.call(this,e,t,a).then(()=>r()).catch(r)}function Ete(e,t,n=Rn){n=typeof t=="function"?t:n,Gv.call(this,e).then(r=>n(void 0,r)).catch(n)}function Cte(e,t,n,r=Rn){DP.call(this,e,t,n).then(()=>r()).catch(r)}function kte(e,t,n,r=Rn){MP.call(this,e,t,n).then(()=>r()).catch(r)}function Tte(e,t,n=Rn){PP.call(this,e,t).then(()=>n()).catch(n)}function Ate(e,t,n=Rn){FP.call(this,e,t).then(()=>n()).catch(n)}function Nte(e,t,n,r=Rn){Wk.call(this,e,t,n).then(()=>r()).catch(r)}function Rte(e,t,n,r=Rn){LP.call(this,e,t,n).then(()=>r()).catch(r)}function Ite(e,t,n=Rn){n=typeof t=="function"?t:n,ku.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function jte(e,t,n=Rn){const r=typeof t=="number"?t:Sa;n=typeof t=="function"?t:n,$P.call(this,e,r).then(()=>n()).catch(n)}const hh=new Map;function Ote(e,t,n){const r=hn(e),a=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Ue(lt.EINVAL,"No listener specified",e.toString(),"watchFile");if(hh.has(r)){const s=hh.get(r);s&&s.listeners.add(n);return}const i=new vee(this,r,a);i.on("change",(s,o)=>{const l=hh.get(r);if(l)for(const u of l.listeners)u(s,o)}),hh.set(r,{watcher:i,listeners:new Set})}function Dte(e,t=Rn){const n=hn(e),r=hh.get(n);r&&(t&&t!==Rn?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),hh.delete(n)))}function Mte(e,t,n){const r=new pP(this,hn(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||Rn),r}function Pte(e,t){t=typeof t=="object"?t:{encoding:t};const n=js.call(this,e,"r",t==null?void 0:t.mode);return new Hk({...t,autoClose:!0},n)}function Fte(e,t){t=typeof t=="object"?t:{encoding:t};const n=js.call(this,e,"w",t==null?void 0:t.mode);return new Vk(t,n)}function Lte(e,t,n=Rn){n=typeof t=="function"?t:n,Kk.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function $te(e,t,n=Rn){n=typeof t=="function"?t:n,BP.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function Bte(e,t,n,r=Rn){r=typeof n=="function"?n:r,Zk.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function zte(e,t,n,r=Rn){r=typeof n=="function"?n:r,new ci(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:a,bytesRead:i})=>r(void 0,i,a)).catch(r)}function Ute(e,t,n,r=Rn){r=typeof n=="function"?n:r,new ci(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:a,bytesWritten:i})=>r(void 0,i,a)).catch(r)}function qte(e,t,n=Rn){n=typeof t=="function"?t:n,zP.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function Hte(e,t,n,r=Rn){r=typeof n=="function"?n:r,Yk.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function Vte(e,t,n=Rn){n=typeof t=="function"?t:n,UP.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function Gte(e,t){const n=await js.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function Wte(e,t,n=Rn){n=typeof t=="function"?t:n;const r=qP.call(this,e,typeof t=="function"?void 0:t);Jee(r).then(a=>{var i;return n(null,(i=a)!==null&&i!==void 0?i:[])}).catch(a=>n(a))}var dd=function(e,t,n,r,a,i){function s(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",u=!t&&e?r.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),h,p=!1,y=n.length-1;y>=0;y--){var v={};for(var b in r)v[b]=b==="access"?{}:r[b];for(var b in r.access)v.access[b]=r.access[b];v.addInitializer=function(x){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(x||null))};var w=(0,n[y])(o==="accessor"?{get:d.get,set:d.set}:d[l],v);if(o==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(h=s(w.get))&&(d.get=h),(h=s(w.set))&&(d.set=h),(h=s(w.init))&&a.unshift(h)}else(h=s(w))&&(o==="field"?a.unshift(h):d[l]=h)}u&&Object.defineProperty(u,r.name,d),p=!0},Yi=function(e,t,n){for(var r=arguments.length>2,a=0;a<t.length;a++)n=r?t[a].call(e,n):t[a].call(e);return r?n:void 0},Kte=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},Kv;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})(Kv||(Kv={}));let HP=(()=>{var e,t,n,r,a;let i=[Zd()],s,o=[],l,u,d=[],h=[],p,y=[],v=[],b,w=[],x=[],S,E=[],C=[],k,R=[],O=[],j,$=[],L=[];return l=class{constructor(X=yr(new Ue(lt.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=Yi(this,d,0),this.extsize=(Yi(this,h),Yi(this,y,0)),this.nextents=(Yi(this,v),Yi(this,w,0)),this.projid=(Yi(this,x),Yi(this,E,0)),this.cowextsize=(Yi(this,C),Yi(this,R,0)),this.pad=(Yi(this,O),Yi(this,$,[])),Yi(this,L),this.extsize=X.size,this.nextents=1,this.projid=X.uid,this.cowextsize=X.size;for(const F of Object.keys(Oi))X.flags&Oi[F]&&F in Kv&&(this.xflags|=Kv[F])}},Kte(l,"fsxattr"),(()=>{const X=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;u=[(e=xn).uint32.bind(e)],p=[(t=xn).uint32.bind(t)],b=[(n=xn).uint32.bind(n)],S=[(r=xn).uint32.bind(r)],k=[(a=xn).uint32.bind(a)],j=[xn.char(8)],dd(null,null,u,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:F=>"xflags"in F,get:F=>F.xflags,set:(F,K)=>{F.xflags=K}},metadata:X},d,h),dd(null,null,p,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:F=>"extsize"in F,get:F=>F.extsize,set:(F,K)=>{F.extsize=K}},metadata:X},y,v),dd(null,null,b,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:F=>"nextents"in F,get:F=>F.nextents,set:(F,K)=>{F.nextents=K}},metadata:X},w,x),dd(null,null,S,{kind:"field",name:"projid",static:!1,private:!1,access:{has:F=>"projid"in F,get:F=>F.projid,set:(F,K)=>{F.projid=K}},metadata:X},E,C),dd(null,null,k,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:F=>"cowextsize"in F,get:F=>F.cowextsize,set:(F,K)=>{F.cowextsize=K}},metadata:X},R,O),dd(null,null,j,{kind:"field",name:"pad",static:!1,private:!1,access:{has:F=>"pad"in F,get:F=>F.pad,set:(F,K)=>{F.pad=K}},metadata:X},$,L),dd(null,s={value:l},i,{kind:"class",name:l.name,metadata:X},null,o),l=s.value,X&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:X}),Yi(l,o)})(),l})();var zr;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})(zr||(zr={}));var Vs;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(Vs||(Vs={}));async function Zte(e,t,...n){e=hn(e);const{fs:r,path:a}=Ln(e,this);try{const i=new fa(await r.stat(a));switch(t){case zr.GetFlags:case Vs.GetFlags:return i.flags;case zr.SetFlags:case Vs.SetFlags:i.flags=n[0],await r.touch(a,i);return;case zr.GetVersion:case Vs.GetVersion:return i.version;case zr.SetVersion:case Vs.SetVersion:i.version=n[0],await r.touch(a,i);return;case zr.Fiemap:break;case zr.GetXattr:return new HP(i);case zr.SetXattr:break;case zr.GetLabel:return r.label;case zr.SetLabel:r.label=n[0];return;case zr.GetUUID:return r.uuid;case zr.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw pr(i,{[a]:e})}throw new Ue(lt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function Yte(e,t,...n){e=hn(e);const{fs:r,path:a}=Ln(e,this);try{const i=new fa(r.statSync(a));switch(t){case zr.GetFlags:case Vs.GetFlags:return i.flags;case zr.SetFlags:case Vs.SetFlags:i.flags=n[0],r.touchSync(a,i);return;case zr.GetVersion:case Vs.GetVersion:return i.version;case zr.SetVersion:case Vs.SetVersion:i.version=n[0],r.touchSync(a,i);return;case zr.Fiemap:break;case zr.GetXattr:return new HP(i);case zr.SetXattr:break;case zr.GetLabel:return r.label;case zr.SetLabel:r.label=n[0];return;case zr.GetUUID:return r.uuid;case zr.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw pr(i,{[a]:e})}throw new Ue(lt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const Xte=[];function lp(e,t,n,r){if(!t.startsWith("user.")&&!Xte.includes(t))throw new Ue(lt.EPERM,"Only attributes in the user namespace are supported",n,r)}async function Jte(e,t,n={}){var r;e=hn(e);const{fs:a,path:i}=Ln(e,this);lp(this,t,e,"xattr.get");try{const s=await a.stat(i);if(Ea&&!hr(this,s,Sa))throw Ue.With("EACCES",i,"xattr.get");(r=s.attributes)!==null&&r!==void 0||(s.attributes=new fu);const o=s.attributes.get(t);if(!o)throw Ue.With("ENODATA",i,"xattr.get");const l=Pr.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(s){throw pr(s,{[i]:e})}}function Qte(e,t,n={}){var r;e=hn(e),lp(this,t,e,"xattr.get");const{fs:a,path:i}=Ln(e,this);try{const s=a.statSync(i);if(Ea&&!hr(this,s,Sa))throw Ue.With("EACCES",i,"xattr.get");(r=s.attributes)!==null&&r!==void 0||(s.attributes=new fu);const o=s.attributes.get(t);if(!o)throw Ue.With("ENODATA",i,"xattr.get");const l=Pr.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(s){throw pr(s,{[i]:e})}}async function ene(e,t,n,r={}){var a;e=hn(e);const{fs:i,path:s}=Ln(e,this);lp(this,t,e,"xattr.set");try{const o=await i.stat(s);if(Ea&&!hr(this,o,ta))throw Ue.With("EACCES",s,"xattr.set");(a=o.attributes)!==null&&a!==void 0||(o.attributes=new fu);const l=o.attributes.get(t);if(r.create&&l)throw Ue.With("EEXIST",s,"xattr.set");if(r.replace&&!l)throw Ue.With("ENODATA",s,"xattr.set");o.attributes.set(t,Pr.from(n)),await i.touch(s,Kd(o,"attributes"))}catch(o){throw pr(o,{[s]:e})}}function tne(e,t,n,r={}){var a;e=hn(e);const{fs:i,path:s}=Ln(e,this);lp(this,t,e,"xattr.set");try{const o=i.statSync(s);if(Ea&&!hr(this,o,ta))throw Ue.With("EACCES",s,"xattr.set");(a=o.attributes)!==null&&a!==void 0||(o.attributes=new fu);const l=o.attributes.get(t);if(r.create&&l)throw Ue.With("EEXIST",s,"xattr.set");if(r.replace&&!l)throw Ue.With("ENODATA",s,"xattr.set");o.attributes.set(t,Pr.from(n)),i.touchSync(s,Kd(o,"attributes"))}catch(o){throw pr(o,{[s]:e})}}async function nne(e,t){var n;e=hn(e);const{fs:r,path:a}=Ln(e,this);lp(this,t,e,"xattr.remove");try{const i=await r.stat(a);if(Ea&&!hr(this,i,ta))throw Ue.With("EACCES",a,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new fu),!i.attributes.get(t))throw Ue.With("ENODATA",a,"xattr.remove");i.attributes.remove(t),await r.touch(a,Kd(i,"attributes"))}catch(i){throw pr(i,{[a]:e})}}function rne(e,t){var n;e=hn(e);const{fs:r,path:a}=Ln(e,this);lp(this,t,e,"xattr.remove");try{const i=r.statSync(a);if(Ea&&!hr(this,i,ta))throw Ue.With("EACCES",a,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new fu),!i.attributes.get(t))throw Ue.With("ENODATA",a,"xattr.remove");i.attributes.remove(t),r.touchSync(a,Kd(i,"attributes"))}catch(i){throw pr(i,{[a]:e})}}async function ane(e){e=hn(e);const{fs:t,path:n}=Ln(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw pr(r,{[n]:e})}}function ine(e){e=hn(e);const{fs:t,path:n}=Ln(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw pr(r,{[n]:e})}}const sne=Object.freeze(Object.defineProperty({__proto__:null,get:Jte,getSync:Qte,list:ane,listSync:ine,remove:nne,removeSync:rne,set:ene,setSync:tne},Symbol.toStringTag,{value:"Module"})),qa=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:tee,Dir:$k,Dirent:Tg,get IOC(){return zr},get IOC32(){return Vs},ReadStream:Hk,Stats:tc,StatsFs:eee,WriteStream:Vk,access:jte,accessSync:Lee,appendFile:lte,appendFileSync:Eee,chmod:Tte,chmodSync:Mee,chown:Cte,chownSync:Oee,chroot:yee,close:ute,closeSync:nf,constants:aP,copyFile:Bte,copyFileSync:vP,cp:Hte,cpSync:wP,createReadStream:Pte,createWriteStream:Fte,exists:ete,existsSync:Rk,fchmod:yte,fchmodSync:Pk,fchown:gte,fchownSync:Mk,fdatasync:hte,fdatasyncSync:Aee,fstat:cte,fstatSync:Cee,fsync:fte,fsyncSync:Tee,ftruncate:dte,ftruncateSync:kee,futimes:bte,futimesSync:Fk,glob:Wte,globSync:Hee,ioctl:Zte,ioctlSync:Yte,lchmod:Ate,lchmodSync:Pee,lchown:kte,lchownSync:Dee,link:_te,linkSync:Iee,lopenSync:rx,lstat:nte,lstatSync:Ik,lutimes:Rte,lutimesSync:Fee,mkdir:wte,mkdirSync:Lk,mkdtemp:$te,mkdtempSync:$ee,mount:Nk,open:ite,openAsBlob:Gte,openSync:nx,opendir:qte,opendirSync:Uee,promises:Xee,read:mte,readFile:ste,readFileSync:Ok,readSync:Ree,readdir:xte,readdirSync:ap,readlink:Ete,readlinkSync:X2,readv:zte,readvSync:Bee,realpath:Ite,realpathSync:Su,rename:Qee,renameSync:_ee,rm:Lte,rmSync:bP,rmdir:vte,rmdirSync:gP,stat:tte,statSync:hu,statfs:Vte,statfsSync:qee,symlink:Ste,symlinkSync:jee,truncate:rte,truncateSync:See,umount:dP,unlink:ate,unlinkSync:jk,unwatchFile:Dte,utimes:Nte,utimesSync:yP,watch:Mte,watchFile:Ote,write:pte,writeFile:ote,writeFileSync:Dk,writeSync:Nee,writev:Ute,writevSync:zee,xattr:sne},Symbol.toStringTag,{value:"Module"}));function Ej(e){return W8(e)||Ek(e)||e instanceof Ak}async function VP(e,t=0){if(typeof e!="object"||e==null)throw ji(new Ue(lt.EINVAL,"Invalid options on mount configuration"));if(!Ej(e))throw ji(new Ue(lt.EINVAL,"Invalid mount configuration"));if(e instanceof Ak)return await e.ready(),e;Ek(e)&&(e={backend:e});for(const[a,i]of Object.entries(e))if(a!="backend"&&Ej(i)){if(G8("Resolving nested mount configuration: "+a),t>10)throw ji(new Ue(lt.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[a]=await VP(i,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw ji(new Ue(lt.EPERM,"Backend not available: "+n.name));FQ(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function one(e){if(!W8(e))throw new TypeError("Invalid single mount point configuration");const t=await VP(e);dP("/"),Nk("/",t)}const lne=["delete"];Math.max(...lne.map(e=>e.length));PQ("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const GP=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;GP[e]=t}function cne(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^GP[(t^e[n])&255];return(t^4294967295)>>>0}var Br=function(e,t,n,r,a,i){function s(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",u=!t&&e?r.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),h,p=!1,y=n.length-1;y>=0;y--){var v={};for(var b in r)v[b]=b==="access"?{}:r[b];for(var b in r.access)v.access[b]=r.access[b];v.addInitializer=function(x){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(x||null))};var w=(0,n[y])(o==="accessor"?{get:d.get,set:d.set}:d[l],v);if(o==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(h=s(w.get))&&(d.get=h),(h=s(w.set))&&(d.set=h),(h=s(w.init))&&a.unshift(h)}else(h=s(w))&&(o==="field"?a.unshift(h):d[l]=h)}u&&Object.defineProperty(u,r.name,d),p=!0},kn=function(e,t,n){for(var r=arguments.length>2,a=0;a<t.length;a++)n=r?t[a].call(e,n):t[a].call(e);return r?n:void 0},Xk=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let Cj=(()=>{var e,t,n,r;let a=[Zd()],i,s=[],o,l,u=[],d=[],h,p=[],y=[],v,b=[],w=[],x,S=[],E=[];return o=class{constructor(){this.id=kn(this,u,0),this.offset_=(kn(this,d),kn(this,p,0)),this.offset=(kn(this,y),kn(this,b,0)),this.size=(kn(this,w),kn(this,S,0)),kn(this,E)}},Xk(o,"MetadataEntry"),(()=>{const C=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=xn).uint32.bind(e)],h=[(t=xn).uint32.bind(t)],v=[(n=xn).uint32.bind(n)],x=[(r=xn).uint32.bind(r)],Br(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:k=>"id"in k,get:k=>k.id,set:(k,R)=>{k.id=R}},metadata:C},u,d),Br(null,null,h,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:k=>"offset_"in k,get:k=>k.offset_,set:(k,R)=>{k.offset_=R}},metadata:C},p,y),Br(null,null,v,{kind:"field",name:"offset",static:!1,private:!1,access:{has:k=>"offset"in k,get:k=>k.offset,set:(k,R)=>{k.offset=R}},metadata:C},b,w),Br(null,null,x,{kind:"field",name:"size",static:!1,private:!1,access:{has:k=>"size"in k,get:k=>k.size,set:(k,R)=>{k.size=R}},metadata:C},S,E),Br(null,i={value:o},a,{kind:"class",name:o.name,metadata:C},null,s),o=i.value,C&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:C}),kn(o,s)})(),o})();const kj=255;let fd=(()=>{var e,t,n,r;let a=[Zd()],i,s=[],o,l,u=[],d=[],h,p=[],y=[],v,b=[],w=[],x,S=[],E=[],C,k=[],R=[];var O=o=class{constructor(j=yr(new Ue(lt.EINVAL,"Metadata block must be initialized with a superblock")),$=0){if(this.superblock=j,this.offset=$,this.checksum=kn(this,u,0),this.timestamp=(kn(this,d),kn(this,p,Date.now())),this.previous_offset_=(kn(this,y),kn(this,b,0)),this.previous_offset=(kn(this,w),kn(this,S,0)),this._previous=kn(this,E),this.entries=kn(this,k,Array.from({length:kj},()=>new Cj)),kn(this,R),this.superblock=j,this.offset=$,!!$&&(Yw(this,j.store._buffer.subarray($,$+Ur(O))),!WP(this)))throw Xw(new Ue(lt.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+$.toString(16)))}get previous(){var j;if(this.previous_offset)return(j=this._previous)!==null&&j!==void 0||(this._previous=new O(this.superblock,this.previous_offset)),this._previous}};return Xk(o,"MetadataBlock"),(()=>{const j=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=xn).uint32.bind(e)],h=[(t=xn).uint32.bind(t)],v=[(n=xn).uint32.bind(n)],x=[(r=xn).uint32.bind(r)],C=[Sg(Cj,kj)],Br(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:$=>"checksum"in $,get:$=>$.checksum,set:($,L)=>{$.checksum=L}},metadata:j},u,d),Br(null,null,h,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:$=>"timestamp"in $,get:$=>$.timestamp,set:($,L)=>{$.timestamp=L}},metadata:j},p,y),Br(null,null,v,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:$=>"previous_offset_"in $,get:$=>$.previous_offset_,set:($,L)=>{$.previous_offset_=L}},metadata:j},b,w),Br(null,null,x,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:$=>"previous_offset"in $,get:$=>$.previous_offset,set:($,L)=>{$.previous_offset=L}},metadata:j},S,E),Br(null,null,C,{kind:"field",name:"entries",static:!1,private:!1,access:{has:$=>"entries"in $,get:$=>$.entries,set:($,L)=>{$.entries=L}},metadata:j},k,R),Br(null,i={value:o},a,{kind:"class",name:o.name,metadata:j},null,s),O=o=i.value,j&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:j}),kn(o,s)})(),O=o})();const Tj=2049864546;(()=>{var e,t,n,r,a,i,s,o,l,u,d;let h=[Zd()],p,y=[],v,b,w=[],x=[],S,E=[],C=[],k,R=[],O=[],j,$=[],L=[],X,F=[],K=[],q,de=[],re=[],Y,Q=[],ae=[],B,J=[],ee=[],oe,me=[],xe=[],Pe,Ne=[],Re=[],ke,Fe=[],Qe=[],Le,Ie=[],V=[],ge,Te=[],le=[];var ie=v=class{constructor(te=yr(new Ue(lt.EINVAL,"Super block must be initialized with a store"))){if(this.store=te,this.checksum=kn(this,w,0),this.magic=(kn(this,x),kn(this,E,Tj)),this.version=(kn(this,C),kn(this,R,1)),this.inode_format=(kn(this,O),kn(this,$,ree)),this.flags=(kn(this,L),kn(this,F,0)),this.used_bytes=(kn(this,K),kn(this,de,BigInt(0))),this.total_bytes=(kn(this,re),kn(this,Q,BigInt(0))),this.uuid=(kn(this,ae),kn(this,J,BigInt(0))),this.metadata_block_size=(kn(this,ee),kn(this,me,Ur(fd))),this.metadata_offset_=(kn(this,xe),kn(this,Ne,0)),this.metadata_offset=(kn(this,Re),kn(this,Fe,0)),this.metadata=kn(this,Qe),this.label=kn(this,Ie,""),this._padding=(kn(this,V),kn(this,Te,new Array(132).fill(0))),kn(this,le),this.store=te,te._view.getUint32(wQ(ie,"magic"),!0)!=Tj){si("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new fd(this),this.metadata.offset=Ur(ie),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(Ur(ie)+Ur(fd)),this.total_bytes=BigInt(te._buffer.byteLength),te._write(this),te._write(this.metadata);return}if(Yw(this,te._buffer.subarray(0,Ur(ie))),!WP(this))throw Xw(new Ue(lt.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new fd(this,this.metadata_offset)}rotateMetadata(){const te=new fd(this);return te.offset=Number(this.used_bytes),te.previous_offset=this.metadata_offset,this.metadata=te,this.metadata_offset=te.offset,this.store._write(te),this.used_bytes+=BigInt(Ur(fd)),this.store._write(this),te}isUnused(te,_e){if(!_e)return!0;if(te+_e>this.total_bytes||te<Ur(ie))return!1;for(let Me=this.metadata;Me;Me=Me.previous){if(te<Me.offset+Ur(fd)&&te+_e>Me.offset)return!1;for(const Ee of Me.entries)if(Ee.offset&&(te>=Ee.offset&&te<Ee.offset+Ee.size||te+_e>Ee.offset&&te+_e<=Ee.offset+Ee.size||te<=Ee.offset&&te+_e>=Ee.offset+Ee.size))return!1}return!0}};return Xk(v,"SuperBlock"),(()=>{const te=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;b=[(e=xn).uint32.bind(e)],S=[(t=xn).uint32.bind(t)],k=[(n=xn).uint16.bind(n)],j=[(r=xn).uint16.bind(r)],X=[(a=xn).uint32.bind(a)],q=[(i=xn).uint64.bind(i)],Y=[(s=xn).uint64.bind(s)],B=[(o=xn).uint128.bind(o)],oe=[(l=xn).uint32.bind(l)],Pe=[(u=xn).uint32.bind(u)],ke=[(d=xn).uint32.bind(d)],Le=[xn.char(64)],ge=[xn.char(132)],Br(null,null,b,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:_e=>"checksum"in _e,get:_e=>_e.checksum,set:(_e,Me)=>{_e.checksum=Me}},metadata:te},w,x),Br(null,null,S,{kind:"field",name:"magic",static:!1,private:!1,access:{has:_e=>"magic"in _e,get:_e=>_e.magic,set:(_e,Me)=>{_e.magic=Me}},metadata:te},E,C),Br(null,null,k,{kind:"field",name:"version",static:!1,private:!1,access:{has:_e=>"version"in _e,get:_e=>_e.version,set:(_e,Me)=>{_e.version=Me}},metadata:te},R,O),Br(null,null,j,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:_e=>"inode_format"in _e,get:_e=>_e.inode_format,set:(_e,Me)=>{_e.inode_format=Me}},metadata:te},$,L),Br(null,null,X,{kind:"field",name:"flags",static:!1,private:!1,access:{has:_e=>"flags"in _e,get:_e=>_e.flags,set:(_e,Me)=>{_e.flags=Me}},metadata:te},F,K),Br(null,null,q,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:_e=>"used_bytes"in _e,get:_e=>_e.used_bytes,set:(_e,Me)=>{_e.used_bytes=Me}},metadata:te},de,re),Br(null,null,Y,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:_e=>"total_bytes"in _e,get:_e=>_e.total_bytes,set:(_e,Me)=>{_e.total_bytes=Me}},metadata:te},Q,ae),Br(null,null,B,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:_e=>"uuid"in _e,get:_e=>_e.uuid,set:(_e,Me)=>{_e.uuid=Me}},metadata:te},J,ee),Br(null,null,oe,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:_e=>"metadata_block_size"in _e,get:_e=>_e.metadata_block_size,set:(_e,Me)=>{_e.metadata_block_size=Me}},metadata:te},me,xe),Br(null,null,Pe,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:_e=>"metadata_offset_"in _e,get:_e=>_e.metadata_offset_,set:(_e,Me)=>{_e.metadata_offset_=Me}},metadata:te},Ne,Re),Br(null,null,ke,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:_e=>"metadata_offset"in _e,get:_e=>_e.metadata_offset,set:(_e,Me)=>{_e.metadata_offset=Me}},metadata:te},Fe,Qe),Br(null,null,Le,{kind:"field",name:"label",static:!1,private:!1,access:{has:_e=>"label"in _e,get:_e=>_e.label,set:(_e,Me)=>{_e.label=Me}},metadata:te},Ie,V),Br(null,null,ge,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:_e=>"_padding"in _e,get:_e=>_e._padding,set:(_e,Me)=>{_e._padding=Me}},metadata:te},Te,le),Br(null,p={value:v},h,{kind:"class",name:v.name,metadata:te},null,y),ie=v=p.value,te&&Object.defineProperty(v,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:te}),kn(v,y)})(),ie=v})();function WP(e){const t=Ka(e),n=cne(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=qa;function une(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function Q2(e,t,n){if(e instanceof Ue)return e;const r=e instanceof DOMException?lt[une(e)]:lt.EIO,a=new Ue(r,e.message,t,n);return a.stack=e.stack,a.cause=e.cause,a}function ph(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(Q2(e.error))}})}class dne extends Y2{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await ph(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await ph(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await ph(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),ph(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(Q2(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(Q2(this.tx.error)),this.tx.abort(),t}}async function fne(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(si("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await ph(n)}class hne{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new dne(t,this)}}const pne={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await ph(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await fne(e.storeName||"zenfs",e.idbFactory),n=new hne(t),r=new lP(n);if(e!=null&&e.disableAsyncCache)return Sk("Async preloading disabled for IndexedDB"),r;const a=n.transaction();for(const i of await a.keys())await a.get(i);return r}},mne=pne;function Db(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var YS={exports:{}},Aj;function gne(){return Aj||(Aj=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,a,i){function s(u,d){if(!a[u]){if(!r[u]){var h=typeof Db=="function"&&Db;if(!d&&h)return h(u,!0);if(o)return o(u,!0);var p=new Error("Cannot find module '"+u+"'");throw p.code="MODULE_NOT_FOUND",p}var y=a[u]={exports:{}};r[u][0].call(y.exports,function(v){var b=r[u][1][v];return s(b||v)},y,y.exports,n,r,a,i)}return a[u].exports}for(var o=typeof Db=="function"&&Db,l=0;l<i.length;l++)s(i[l]);return s}({1:[function(n,r,a){var i=n("./utils"),s=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(l){for(var u,d,h,p,y,v,b,w=[],x=0,S=l.length,E=S,C=i.getTypeOf(l)!=="string";x<l.length;)E=S-x,h=C?(u=l[x++],d=x<S?l[x++]:0,x<S?l[x++]:0):(u=l.charCodeAt(x++),d=x<S?l.charCodeAt(x++):0,x<S?l.charCodeAt(x++):0),p=u>>2,y=(3&u)<<4|d>>4,v=1<E?(15&d)<<2|h>>6:64,b=2<E?63&h:64,w.push(o.charAt(p)+o.charAt(y)+o.charAt(v)+o.charAt(b));return w.join("")},a.decode=function(l){var u,d,h,p,y,v,b=0,w=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var S,E=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&E--,l.charAt(l.length-2)===o.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=s.uint8array?new Uint8Array(0|E):new Array(0|E);b<l.length;)u=o.indexOf(l.charAt(b++))<<2|(p=o.indexOf(l.charAt(b++)))>>4,d=(15&p)<<4|(y=o.indexOf(l.charAt(b++)))>>2,h=(3&y)<<6|(v=o.indexOf(l.charAt(b++))),S[w++]=u,y!==64&&(S[w++]=d),v!==64&&(S[w++]=h);return S}},{"./support":30,"./utils":32}],2:[function(n,r,a){var i=n("./external"),s=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function u(d,h,p,y,v){this.compressedSize=d,this.uncompressedSize=h,this.crc32=p,this.compression=y,this.compressedContent=v}u.prototype={getContentWorker:function(){var d=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return d.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(d,h,p){return d.pipe(new o).pipe(new l("uncompressedSize")).pipe(h.compressWorker(p)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},r.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,a){var i=n("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,a){var i=n("./utils"),s=function(){for(var o,l=[],u=0;u<256;u++){o=u;for(var d=0;d<8;d++)o=1&o?3988292384^o>>>1:o>>>1;l[u]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(u,d,h,p){var y=s,v=p+h;u^=-1;for(var b=p;b<v;b++)u=u>>>8^y[255&(u^d[b])];return-1^u}(0|l,o,o.length,0):function(u,d,h,p){var y=s,v=p+h;u^=-1;for(var b=p;b<v;b++)u=u>>>8^y[255&(u^d.charCodeAt(b))];return-1^u}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(n,r,a){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),u=i?"uint8array":"array";function d(h,p){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=p,this.meta={}}a.magic="\b\0",o.inherits(d,l),d.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(u,h.data),!1)},d.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(p){h.push({data:p,meta:h.meta})}},a.compressWorker=function(h){return new d("Deflate",h)},a.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,a){function i(y,v){var b,w="";for(b=0;b<v;b++)w+=String.fromCharCode(255&y),y>>>=8;return w}function s(y,v,b,w,x,S){var E,C,k=y.file,R=y.compression,O=S!==u.utf8encode,j=o.transformTo("string",S(k.name)),$=o.transformTo("string",u.utf8encode(k.name)),L=k.comment,X=o.transformTo("string",S(L)),F=o.transformTo("string",u.utf8encode(L)),K=$.length!==k.name.length,q=F.length!==L.length,de="",re="",Y="",Q=k.dir,ae=k.date,B={crc32:0,compressedSize:0,uncompressedSize:0};v&&!b||(B.crc32=y.crc32,B.compressedSize=y.compressedSize,B.uncompressedSize=y.uncompressedSize);var J=0;v&&(J|=8),O||!K&&!q||(J|=2048);var ee=0,oe=0;Q&&(ee|=16),x==="UNIX"?(oe=798,ee|=function(xe,Pe){var Ne=xe;return xe||(Ne=Pe?16893:33204),(65535&Ne)<<16}(k.unixPermissions,Q)):(oe=20,ee|=function(xe){return 63&(xe||0)}(k.dosPermissions)),E=ae.getUTCHours(),E<<=6,E|=ae.getUTCMinutes(),E<<=5,E|=ae.getUTCSeconds()/2,C=ae.getUTCFullYear()-1980,C<<=4,C|=ae.getUTCMonth()+1,C<<=5,C|=ae.getUTCDate(),K&&(re=i(1,1)+i(d(j),4)+$,de+="up"+i(re.length,2)+re),q&&(Y=i(1,1)+i(d(X),4)+F,de+="uc"+i(Y.length,2)+Y);var me="";return me+=`
\0`,me+=i(J,2),me+=R.magic,me+=i(E,2),me+=i(C,2),me+=i(B.crc32,4),me+=i(B.compressedSize,4),me+=i(B.uncompressedSize,4),me+=i(j.length,2),me+=i(de.length,2),{fileRecord:h.LOCAL_FILE_HEADER+me+j+de,dirRecord:h.CENTRAL_FILE_HEADER+i(oe,2)+me+i(X.length,2)+"\0\0\0\0"+i(ee,4)+i(w,4)+j+de+X}}var o=n("../utils"),l=n("../stream/GenericWorker"),u=n("../utf8"),d=n("../crc32"),h=n("../signature");function p(y,v,b,w){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=b,this.encodeFileName=w,this.streamFiles=y,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(p,l),p.prototype.push=function(y){var v=y.meta.percent||0,b=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(y):(this.bytesWritten+=y.data.length,l.prototype.push.call(this,{data:y.data,meta:{currentFile:this.currentFile,percent:b?(v+100*(b-w-1))/b:100}}))},p.prototype.openedSource=function(y){this.currentSourceOffset=this.bytesWritten,this.currentFile=y.file.name;var v=this.streamFiles&&!y.file.dir;if(v){var b=s(y,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(y){this.accumulate=!1;var v=this.streamFiles&&!y.file.dir,b=s(y,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),v)this.push({data:function(w){return h.DATA_DESCRIPTOR+i(w.crc32,4)+i(w.compressedSize,4)+i(w.uncompressedSize,4)}(y),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var y=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var b=this.bytesWritten-y,w=function(x,S,E,C,k){var R=o.transformTo("string",k(C));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(x,2)+i(x,2)+i(S,4)+i(E,4)+i(R.length,2)+R}(this.dirRecords.length,b,y,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(y){this._sources.push(y);var v=this;return y.on("data",function(b){v.processChunk(b)}),y.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),y.on("error",function(b){v.error(b)}),this},p.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(y){var v=this._sources;if(!l.prototype.error.call(this,y))return!1;for(var b=0;b<v.length;b++)try{v[b].error(y)}catch{}return!0},p.prototype.lock=function(){l.prototype.lock.call(this);for(var y=this._sources,v=0;v<y.length;v++)y[v].lock()},r.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,a){var i=n("../compressions"),s=n("./ZipFileWorker");a.generateWorker=function(o,l,u){var d=new s(l.streamFiles,u,l.platform,l.encodeFileName),h=0;try{o.forEach(function(p,y){h++;var v=function(S,E){var C=S||E,k=i[C];if(!k)throw new Error(C+" is not a valid compression method !");return k}(y.options.compression,l.compression),b=y.options.compressionOptions||l.compressionOptions||{},w=y.dir,x=y.date;y._compressWorker(v,b).withStreamInfo("file",{name:p,dir:w,date:x,comment:y.comment||"",unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions}).pipe(d)}),d.entriesCount=h}catch(p){d.error(p)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var o in this)typeof this[o]!="function"&&(s[o]=this[o]);return s}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(s,o){return new i().loadAsync(s,o)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,a){var i=n("./utils"),s=n("./external"),o=n("./utf8"),l=n("./zipEntries"),u=n("./stream/Crc32Probe"),d=n("./nodejsUtils");function h(p){return new s.Promise(function(y,v){var b=p.decompressed.getContentWorker().pipe(new u);b.on("error",function(w){v(w)}).on("end",function(){b.streamInfo.crc32!==p.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):y()}).resume()})}r.exports=function(p,y){var v=this;return y=i.extend(y||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),d.isNode&&d.isStream(p)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",p,!0,y.optimizedBinaryString,y.base64).then(function(b){var w=new l(y);return w.load(b),w}).then(function(b){var w=[s.Promise.resolve(b)],x=b.files;if(y.checkCRC32)for(var S=0;S<x.length;S++)w.push(h(x[S]));return s.Promise.all(w)}).then(function(b){for(var w=b.shift(),x=w.files,S=0;S<x.length;S++){var E=x[S],C=E.fileNameStr,k=i.resolve(E.fileNameStr);v.file(k,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:y.createFolders}),E.dir||(v.file(k).unsafeOriginalName=C)}return w.zipComment.length&&(v.comment=w.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,a){var i=n("../utils"),s=n("../stream/GenericWorker");function o(l,u){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(o,s),o.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(d){u.push({data:d,meta:{percent:0}})}).on("error",function(d){u.isPaused?this.generatedError=d:u.error(d)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},o.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,a){var i=n("readable-stream").Readable;function s(o,l,u){i.call(this,l),this._helper=o;var d=this;o.on("data",function(h,p){d.push(h)||d._helper.pause(),u&&u(p)}).on("error",function(h){d.emit("error",h)}).on("end",function(){d.push(null)})}n("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},r.exports=s},{"../utils":32,"readable-stream":16}],14:[function(n,r,a){r.exports={isNode:typeof Xt<"u",newBufferFrom:function(i,s){if(Xt.from&&Xt.from!==Uint8Array.from)return Xt.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Xt(i,s)},allocBuffer:function(i){if(Xt.alloc)return Xt.alloc(i);var s=new Xt(i);return s.fill(0),s},isBuffer:function(i){return Xt.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,a){function i(k,R,O){var j,$=o.getTypeOf(R),L=o.extend(O||{},d);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&16384&L.unixPermissions&&(L.dir=!0),L.dosPermissions&&16&L.dosPermissions&&(L.dir=!0),L.dir&&(k=x(k)),L.createFolders&&(j=w(k))&&S.call(this,j,!0);var X=$==="string"&&L.binary===!1&&L.base64===!1;O&&O.binary!==void 0||(L.binary=!X),(R instanceof h&&R.uncompressedSize===0||L.dir||!R||R.length===0)&&(L.base64=!1,L.binary=!0,R="",L.compression="STORE",$="string");var F=null;F=R instanceof h||R instanceof l?R:v.isNode&&v.isStream(R)?new b(k,R):o.prepareContent(k,R,L.binary,L.optimizedBinaryString,L.base64);var K=new p(k,F,L);this.files[k]=K}var s=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),u=n("./stream/StreamHelper"),d=n("./defaults"),h=n("./compressedObject"),p=n("./zipObject"),y=n("./generate"),v=n("./nodejsUtils"),b=n("./nodejs/NodejsStreamInputAdapter"),w=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var R=k.lastIndexOf("/");return 0<R?k.substring(0,R):""},x=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},S=function(k,R){return R=R!==void 0?R:d.createFolders,k=x(k),this.files[k]||i.call(this,k,null,{dir:!0,createFolders:R}),this.files[k]};function E(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var R,O,j;for(R in this.files)j=this.files[R],(O=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&k(O,j)},filter:function(k){var R=[];return this.forEach(function(O,j){k(O,j)&&R.push(j)}),R},file:function(k,R,O){if(arguments.length!==1)return k=this.root+k,i.call(this,k,R,O),this;if(E(k)){var j=k;return this.filter(function(L,X){return!X.dir&&j.test(L)})}var $=this.files[this.root+k];return $&&!$.dir?$:null},folder:function(k){if(!k)return this;if(E(k))return this.filter(function($,L){return L.dir&&k.test($)});var R=this.root+k,O=S.call(this,R),j=this.clone();return j.root=O.name,j},remove:function(k){k=this.root+k;var R=this.files[k];if(R||(k.slice(-1)!=="/"&&(k+="/"),R=this.files[k]),R&&!R.dir)delete this.files[k];else for(var O=this.filter(function($,L){return L.name.slice(0,k.length)===k}),j=0;j<O.length;j++)delete this.files[O[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var R,O={};try{if((O=o.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");o.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var j=O.comment||this.comment||"";R=y.generateWorker(this,O,j)}catch($){(R=new l("error")).error($)}return new u(R,O.type||"string",O.mimeType)},generateAsync:function(k,R){return this.generateInternalStream(k).accumulate(R)},generateNodeStream:function(k,R){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(R)}};r.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,a){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,a){var i=n("./DataReader");function s(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(s,i),s.prototype.byteAt=function(o){return this.data[this.zero+o]},s.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),u=o.charCodeAt(1),d=o.charCodeAt(2),h=o.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===l&&this.data[p+1]===u&&this.data[p+2]===d&&this.data[p+3]===h)return p-this.zero;return-1},s.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),u=o.charCodeAt(1),d=o.charCodeAt(2),h=o.charCodeAt(3),p=this.readData(4);return l===p[0]&&u===p[1]&&d===p[2]&&h===p[3]},s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=s},{"../utils":32,"./DataReader":18}],18:[function(n,r,a){var i=n("../utils");function s(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,u=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=o,u},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=s},{"../utils":32}],19:[function(n,r,a){var i=n("./Uint8ArrayReader");function s(o){i.call(this,o)}n("../utils").inherits(s,i),s.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,a){var i=n("./DataReader");function s(o){i.call(this,o)}n("../utils").inherits(s,i),s.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},s.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},s.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},s.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=s},{"../utils":32,"./DataReader":18}],21:[function(n,r,a){var i=n("./ArrayReader");function s(o){i.call(this,o)}n("../utils").inherits(s,i),s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,a){var i=n("../utils"),s=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),u=n("./NodeBufferReader"),d=n("./Uint8ArrayReader");r.exports=function(h){var p=i.getTypeOf(h);return i.checkSupport(p),p!=="string"||s.uint8array?p==="nodebuffer"?new u(h):s.uint8array?new d(i.transformTo("uint8array",h)):new o(i.transformTo("array",h)):new l(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,a){var i=n("./GenericWorker"),s=n("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,a){var i=n("./GenericWorker"),s=n("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,a){var i=n("../utils"),s=n("./GenericWorker");function o(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,s),o.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}s.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,a){var i=n("../utils"),s=n("./GenericWorker");function o(l){s.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(d){u.dataIsReady=!0,u.data=d,u.max=d&&d.length||0,u.type=i.getTypeOf(d),u.isPaused||u._tickAndRepeat()},function(d){u.error(d)})}i.inherits(o,s),o.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,a){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,o){return this._listeners[s].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,o){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,o)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var o=this;return s.on("data",function(l){o.processChunk(l)}),s.on("end",function(){o.end()}),s.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,o){return this.extraStreamInfo[s]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},r.exports=i},{}],29:[function(n,r,a){var i=n("../utils"),s=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),u=n("../support"),d=n("../external"),h=null;if(u.nodestream)try{h=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(v,b){return new d.Promise(function(w,x){var S=[],E=v._internalType,C=v._outputType,k=v._mimeType;v.on("data",function(R,O){S.push(R),b&&b(O)}).on("error",function(R){S=[],x(R)}).on("end",function(){try{var R=function(O,j,$){switch(O){case"blob":return i.newBlob(i.transformTo("arraybuffer",j),$);case"base64":return l.encode(j);default:return i.transformTo(O,j)}}(C,function(O,j){var $,L=0,X=null,F=0;for($=0;$<j.length;$++)F+=j[$].length;switch(O){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(X=new Uint8Array(F),$=0;$<j.length;$++)X.set(j[$],L),L+=j[$].length;return X;case"nodebuffer":return Xt.concat(j);default:throw new Error("concat : unsupported type '"+O+"'")}}(E,S),k);w(R)}catch(O){x(O)}S=[]}).resume()})}function y(v,b,w){var x=b;switch(b){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=b,this._mimeType=w,i.checkSupport(x),this._worker=v.pipe(new s(x)),v.lock()}catch(S){this._worker=new o("error"),this._worker.error(S)}}y.prototype={accumulate:function(v){return p(this,v)},on:function(v,b){var w=this;return v==="data"?this._worker.on(v,function(x){b.call(w,x.data,x.meta)}):this._worker.on(v,function(){i.delay(b,arguments,w)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},v)}},r.exports=y},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Xt<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),a.blob=s.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!n("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,a){for(var i=n("./utils"),s=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),u=new Array(256),d=0;d<256;d++)u[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;u[254]=u[254]=1;function h(){l.call(this,"utf-8 decode"),this.leftOver=null}function p(){l.call(this,"utf-8 encode")}a.utf8encode=function(y){return s.nodebuffer?o.newBufferFrom(y,"utf-8"):function(v){var b,w,x,S,E,C=v.length,k=0;for(S=0;S<C;S++)(64512&(w=v.charCodeAt(S)))==55296&&S+1<C&&(64512&(x=v.charCodeAt(S+1)))==56320&&(w=65536+(w-55296<<10)+(x-56320),S++),k+=w<128?1:w<2048?2:w<65536?3:4;for(b=s.uint8array?new Uint8Array(k):new Array(k),S=E=0;E<k;S++)(64512&(w=v.charCodeAt(S)))==55296&&S+1<C&&(64512&(x=v.charCodeAt(S+1)))==56320&&(w=65536+(w-55296<<10)+(x-56320),S++),w<128?b[E++]=w:(w<2048?b[E++]=192|w>>>6:(w<65536?b[E++]=224|w>>>12:(b[E++]=240|w>>>18,b[E++]=128|w>>>12&63),b[E++]=128|w>>>6&63),b[E++]=128|63&w);return b}(y)},a.utf8decode=function(y){return s.nodebuffer?i.transformTo("nodebuffer",y).toString("utf-8"):function(v){var b,w,x,S,E=v.length,C=new Array(2*E);for(b=w=0;b<E;)if((x=v[b++])<128)C[w++]=x;else if(4<(S=u[x]))C[w++]=65533,b+=S-1;else{for(x&=S===2?31:S===3?15:7;1<S&&b<E;)x=x<<6|63&v[b++],S--;1<S?C[w++]=65533:x<65536?C[w++]=x:(x-=65536,C[w++]=55296|x>>10&1023,C[w++]=56320|1023&x)}return C.length!==w&&(C.subarray?C=C.subarray(0,w):C.length=w),i.applyFromCharCode(C)}(y=i.transformTo(s.uint8array?"uint8array":"array",y))},i.inherits(h,l),h.prototype.processChunk=function(y){var v=i.transformTo(s.uint8array?"uint8array":"array",y.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var b=v;(v=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),v.set(b,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var w=function(S,E){var C;for((E=E||S.length)>S.length&&(E=S.length),C=E-1;0<=C&&(192&S[C])==128;)C--;return C<0||C===0?E:C+u[S[C]]>E?C:E}(v),x=v;w!==v.length&&(s.uint8array?(x=v.subarray(0,w),this.leftOver=v.subarray(w,v.length)):(x=v.slice(0,w),this.leftOver=v.slice(w,v.length))),this.push({data:a.utf8decode(x),meta:y.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=h,i.inherits(p,l),p.prototype.processChunk=function(y){this.push({data:a.utf8encode(y.data),meta:y.meta})},a.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,a){var i=n("./support"),s=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function u(b){return b}function d(b,w){for(var x=0;x<b.length;++x)w[x]=255&b.charCodeAt(x);return w}n("setimmediate"),a.newBlob=function(b,w){a.checkSupport("blob");try{return new Blob([b],{type:w})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(b),x.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(b,w,x){var S=[],E=0,C=b.length;if(C<=x)return String.fromCharCode.apply(null,b);for(;E<C;)w==="array"||w==="nodebuffer"?S.push(String.fromCharCode.apply(null,b.slice(E,Math.min(E+x,C)))):S.push(String.fromCharCode.apply(null,b.subarray(E,Math.min(E+x,C)))),E+=x;return S.join("")},stringifyByChar:function(b){for(var w="",x=0;x<b.length;x++)w+=String.fromCharCode(b[x]);return w},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function p(b){var w=65536,x=a.getTypeOf(b),S=!0;if(x==="uint8array"?S=h.applyCanBeUsed.uint8array:x==="nodebuffer"&&(S=h.applyCanBeUsed.nodebuffer),S)for(;1<w;)try{return h.stringifyByChunk(b,x,w)}catch{w=Math.floor(w/2)}return h.stringifyByChar(b)}function y(b,w){for(var x=0;x<b.length;x++)w[x]=b[x];return w}a.applyFromCharCode=p;var v={};v.string={string:u,array:function(b){return d(b,new Array(b.length))},arraybuffer:function(b){return v.string.uint8array(b).buffer},uint8array:function(b){return d(b,new Uint8Array(b.length))},nodebuffer:function(b){return d(b,o.allocBuffer(b.length))}},v.array={string:p,array:u,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(b)}},v.arraybuffer={string:function(b){return p(new Uint8Array(b))},array:function(b){return y(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:u,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(new Uint8Array(b))}},v.uint8array={string:p,array:function(b){return y(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:u,nodebuffer:function(b){return o.newBufferFrom(b)}},v.nodebuffer={string:p,array:function(b){return y(b,new Array(b.length))},arraybuffer:function(b){return v.nodebuffer.uint8array(b).buffer},uint8array:function(b){return y(b,new Uint8Array(b.length))},nodebuffer:u},a.transformTo=function(b,w){if(w=w||"",!b)return w;a.checkSupport(b);var x=a.getTypeOf(w);return v[x][b](w)},a.resolve=function(b){for(var w=b.split("/"),x=[],S=0;S<w.length;S++){var E=w[S];E==="."||E===""&&S!==0&&S!==w.length-1||(E===".."?x.pop():x.push(E))}return x.join("/")},a.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(b)?"nodebuffer":i.uint8array&&b instanceof Uint8Array?"uint8array":i.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(b){if(!i[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(b){var w,x,S="";for(x=0;x<(b||"").length;x++)S+="\\x"+((w=b.charCodeAt(x))<16?"0":"")+w.toString(16).toUpperCase();return S},a.delay=function(b,w,x){setImmediate(function(){b.apply(x||null,w||[])})},a.inherits=function(b,w){function x(){}x.prototype=w.prototype,b.prototype=new x},a.extend=function(){var b,w,x={};for(b=0;b<arguments.length;b++)for(w in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],w)&&x[w]===void 0&&(x[w]=arguments[b][w]);return x},a.prepareContent=function(b,w,x,S,E){return l.Promise.resolve(w).then(function(C){return i.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new l.Promise(function(k,R){var O=new FileReader;O.onload=function(j){k(j.target.result)},O.onerror=function(j){R(j.target.error)},O.readAsArrayBuffer(C)}):C}).then(function(C){var k=a.getTypeOf(C);return k?(k==="arraybuffer"?C=a.transformTo("uint8array",C):k==="string"&&(E?C=s.decode(C):x&&S!==!0&&(C=function(R){return d(R,i.uint8array?new Uint8Array(R.length):new Array(R.length))}(C))),C):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,a){var i=n("./reader/readerFor"),s=n("./utils"),o=n("./signature"),l=n("./zipEntry"),u=n("./support");function d(h){this.files=[],this.loadOptions=h}d.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(p)+", expected "+s.pretty(h)+")")}},isSignature:function(h,p){var y=this.reader.index;this.reader.setIndex(h);var v=this.reader.readString(4)===p;return this.reader.setIndex(y),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),p=u.uint8array?"uint8array":"array",y=s.transformTo(p,h);this.zipComment=this.loadOptions.decodeFileName(y)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,p,y,v=this.zip64EndOfCentralSize-44;0<v;)h=this.reader.readInt(2),p=this.reader.readInt(4),y=this.reader.readData(p),this.zip64ExtensibleData[h]={id:h,length:p,value:y}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,p;for(h=0;h<this.files.length;h++)p=this.files[h],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(h=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var p=h;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var y=this.centralDirOffset+this.centralDirSize;this.zip64&&(y+=20,y+=12+this.zip64EndOfCentralSize);var v=p-y;if(0<v)this.isSignature(p,o.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(h){this.reader=i(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,a){var i=n("./reader/readerFor"),s=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),u=n("./utf8"),d=n("./compressions"),h=n("./support");function p(y,v){this.options=y,this.loadOptions=v}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(y){var v,b;if(y.skip(22),this.fileNameLength=y.readInt(2),b=y.readInt(2),this.fileName=y.readData(this.fileNameLength),y.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(w){for(var x in d)if(Object.prototype.hasOwnProperty.call(d,x)&&d[x].magic===w)return d[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,v,y.readData(this.compressedSize))},readCentralPart:function(y){this.versionMadeBy=y.readInt(2),y.skip(2),this.bitFlag=y.readInt(2),this.compressionMethod=y.readString(2),this.date=y.readDate(),this.crc32=y.readInt(4),this.compressedSize=y.readInt(4),this.uncompressedSize=y.readInt(4);var v=y.readInt(2);if(this.extraFieldsLength=y.readInt(2),this.fileCommentLength=y.readInt(2),this.diskNumberStart=y.readInt(2),this.internalFileAttributes=y.readInt(2),this.externalFileAttributes=y.readInt(4),this.localHeaderOffset=y.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");y.skip(v),this.readExtraFields(y),this.parseZIP64ExtraField(y),this.fileComment=y.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var y=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),y==0&&(this.dosPermissions=63&this.externalFileAttributes),y==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var y=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=y.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=y.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=y.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=y.readInt(4))}},readExtraFields:function(y){var v,b,w,x=y.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});y.index+4<x;)v=y.readInt(2),b=y.readInt(2),w=y.readData(b),this.extraFields[v]={id:v,length:b,value:w};y.setIndex(x)},handleUTF8:function(){var y=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var b=s.transformTo(y,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var x=s.transformTo(y,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var y=this.extraFields[28789];if(y){var v=i(y.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:u.utf8decode(v.readData(y.length-5))}return null},findExtraFieldUnicodeComment:function(){var y=this.extraFields[25461];if(y){var v=i(y.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:u.utf8decode(v.readData(y.length-5))}return null}},r.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,a){function i(v,b,w){this.name=v,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=b,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var s=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),u=n("./compressedObject"),d=n("./stream/GenericWorker");i.prototype={internalStream:function(v){var b=null,w="string";try{if(!v)throw new Error("No output type specified.");var x=(w=v.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),b=this._decompressWorker();var S=!this._dataBinary;S&&!x&&(b=b.pipe(new l.Utf8EncodeWorker)),!S&&x&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(E){(b=new d("error")).error(E)}return new s(b,w,"")},async:function(v,b){return this.internalStream(v).accumulate(b)},nodeStream:function(v,b){return this.internalStream(v||"nodebuffer").toNodejsStream(b)},_compressWorker:function(v,b){if(this._data instanceof u&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(w,v,b)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof d?this._data:new o(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},y=0;y<h.length;y++)i.prototype[h[y]]=p;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,a){(function(i){var s,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var u=0,d=new l(v),h=i.document.createTextNode("");d.observe(h,{characterData:!0}),s=function(){h.data=u=++u%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var b=i.document.createElement("script");b.onreadystatechange=function(){v(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:function(){setTimeout(v,0)};else{var p=new i.MessageChannel;p.port1.onmessage=v,s=function(){p.port2.postMessage(0)}}var y=[];function v(){var b,w;o=!0;for(var x=y.length;x;){for(w=y,y=[],b=-1;++b<x;)w[b]();x=y.length}o=!1}r.exports=function(b){y.push(b)!==1||o||s()}}).call(this,typeof wd<"u"?wd:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,a){var i=n("immediate");function s(){}var o={},l=["REJECTED"],u=["FULFILLED"],d=["PENDING"];function h(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,x!==s&&b(this,x)}function p(x,S,E){this.promise=x,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function y(x,S,E){i(function(){var C;try{C=S(E)}catch(k){return o.reject(x,k)}C===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,C)})}function v(x){var S=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof S=="function")return function(){S.apply(x,arguments)}}function b(x,S){var E=!1;function C(O){E||(E=!0,o.reject(x,O))}function k(O){E||(E=!0,o.resolve(x,O))}var R=w(function(){S(k,C)});R.status==="error"&&C(R.value)}function w(x,S){var E={};try{E.value=x(S),E.status="success"}catch(C){E.status="error",E.value=C}return E}(r.exports=h).prototype.finally=function(x){if(typeof x!="function")return this;var S=this.constructor;return this.then(function(E){return S.resolve(x()).then(function(){return E})},function(E){return S.resolve(x()).then(function(){throw E})})},h.prototype.catch=function(x){return this.then(null,x)},h.prototype.then=function(x,S){if(typeof x!="function"&&this.state===u||typeof S!="function"&&this.state===l)return this;var E=new this.constructor(s);return this.state!==d?y(E,this.state===u?x:S,this.outcome):this.queue.push(new p(E,x,S)),E},p.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},p.prototype.otherCallFulfilled=function(x){y(this.promise,this.onFulfilled,x)},p.prototype.callRejected=function(x){o.reject(this.promise,x)},p.prototype.otherCallRejected=function(x){y(this.promise,this.onRejected,x)},o.resolve=function(x,S){var E=w(v,S);if(E.status==="error")return o.reject(x,E.value);var C=E.value;if(C)b(x,C);else{x.state=u,x.outcome=S;for(var k=-1,R=x.queue.length;++k<R;)x.queue[k].callFulfilled(S)}return x},o.reject=function(x,S){x.state=l,x.outcome=S;for(var E=-1,C=x.queue.length;++E<C;)x.queue[E].callRejected(S);return x},h.resolve=function(x){return x instanceof this?x:o.resolve(new this(s),x)},h.reject=function(x){var S=new this(s);return o.reject(S,x)},h.all=function(x){var S=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=x.length,C=!1;if(!E)return this.resolve([]);for(var k=new Array(E),R=0,O=-1,j=new this(s);++O<E;)$(x[O],O);return j;function $(L,X){S.resolve(L).then(function(F){k[X]=F,++R!==E||C||(C=!0,o.resolve(j,k))},function(F){C||(C=!0,o.reject(j,F))})}},h.race=function(x){var S=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=x.length,C=!1;if(!E)return this.resolve([]);for(var k=-1,R=new this(s);++k<E;)O=x[k],S.resolve(O).then(function(j){C||(C=!0,o.resolve(R,j))},function(j){C||(C=!0,o.reject(R,j))});var O;return R}},{immediate:36}],38:[function(n,r,a){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,a){var i=n("./zlib/deflate"),s=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),u=n("./zlib/zstream"),d=Object.prototype.toString,h=0,p=-1,y=0,v=8;function b(x){if(!(this instanceof b))return new b(x);this.options=s.assign({level:p,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:y,to:""},x||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var E=i.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(E!==h)throw new Error(l[E]);if(S.header&&i.deflateSetHeader(this.strm,S.header),S.dictionary){var C;if(C=typeof S.dictionary=="string"?o.string2buf(S.dictionary):d.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(E=i.deflateSetDictionary(this.strm,C))!==h)throw new Error(l[E]);this._dict_set=!0}}function w(x,S){var E=new b(S);if(E.push(x,!0),E.err)throw E.msg||l[E.err];return E.result}b.prototype.push=function(x,S){var E,C,k=this.strm,R=this.options.chunkSize;if(this.ended)return!1;C=S===~~S?S:S===!0?4:0,typeof x=="string"?k.input=o.string2buf(x):d.call(x)==="[object ArrayBuffer]"?k.input=new Uint8Array(x):k.input=x,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new s.Buf8(R),k.next_out=0,k.avail_out=R),(E=i.deflate(k,C))!==1&&E!==h)return this.onEnd(E),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(s.shrinkBuf(k.output,k.next_out))):this.onData(s.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&E!==1);return C===4?(E=i.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===h):C!==2||(this.onEnd(h),!(k.avail_out=0))},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},a.Deflate=b,a.deflate=w,a.deflateRaw=function(x,S){return(S=S||{}).raw=!0,w(x,S)},a.gzip=function(x,S){return(S=S||{}).gzip=!0,w(x,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,a){var i=n("./zlib/inflate"),s=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),u=n("./zlib/messages"),d=n("./zlib/zstream"),h=n("./zlib/gzheader"),p=Object.prototype.toString;function y(b){if(!(this instanceof y))return new y(b);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},b||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||b&&b.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&(15&w.windowBits)==0&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var x=i.inflateInit2(this.strm,w.windowBits);if(x!==l.Z_OK)throw new Error(u[x]);this.header=new h,i.inflateGetHeader(this.strm,this.header)}function v(b,w){var x=new y(w);if(x.push(b,!0),x.err)throw x.msg||u[x.err];return x.result}y.prototype.push=function(b,w){var x,S,E,C,k,R,O=this.strm,j=this.options.chunkSize,$=this.options.dictionary,L=!1;if(this.ended)return!1;S=w===~~w?w:w===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?O.input=o.binstring2buf(b):p.call(b)==="[object ArrayBuffer]"?O.input=new Uint8Array(b):O.input=b,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new s.Buf8(j),O.next_out=0,O.avail_out=j),(x=i.inflate(O,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&$&&(R=typeof $=="string"?o.string2buf($):p.call($)==="[object ArrayBuffer]"?new Uint8Array($):$,x=i.inflateSetDictionary(this.strm,R)),x===l.Z_BUF_ERROR&&L===!0&&(x=l.Z_OK,L=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&x!==l.Z_STREAM_END&&(O.avail_in!==0||S!==l.Z_FINISH&&S!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=o.utf8border(O.output,O.next_out),C=O.next_out-E,k=o.buf2string(O.output,E),O.next_out=C,O.avail_out=j-C,C&&s.arraySet(O.output,O.output,E,C,0),this.onData(k)):this.onData(s.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(L=!0)}while((0<O.avail_in||O.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(S=l.Z_FINISH),S===l.Z_FINISH?(x=i.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):S!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(O.avail_out=0))},y.prototype.onData=function(b){this.chunks.push(b)},y.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},a.Inflate=y,a.inflate=v,a.inflateRaw=function(b,w){return(w=w||{}).raw=!0,v(b,w)},a.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var d=u.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var h in d)d.hasOwnProperty(h)&&(l[h]=d[h])}}return l},a.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var s={arraySet:function(l,u,d,h,p){if(u.subarray&&l.subarray)l.set(u.subarray(d,d+h),p);else for(var y=0;y<h;y++)l[p+y]=u[d+y]},flattenChunks:function(l){var u,d,h,p,y,v;for(u=h=0,d=l.length;u<d;u++)h+=l[u].length;for(v=new Uint8Array(h),u=p=0,d=l.length;u<d;u++)y=l[u],v.set(y,p),p+=y.length;return v}},o={arraySet:function(l,u,d,h,p){for(var y=0;y<h;y++)l[p+y]=u[d+y]},flattenChunks:function(l){return[].concat.apply([],l)}};a.setTyped=function(l){l?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,s)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,o))},a.setTyped(i)},{}],42:[function(n,r,a){var i=n("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function d(h,p){if(p<65537&&(h.subarray&&o||!h.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(h,p));for(var y="",v=0;v<p;v++)y+=String.fromCharCode(h[v]);return y}l[254]=l[254]=1,a.string2buf=function(h){var p,y,v,b,w,x=h.length,S=0;for(b=0;b<x;b++)(64512&(y=h.charCodeAt(b)))==55296&&b+1<x&&(64512&(v=h.charCodeAt(b+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),b++),S+=y<128?1:y<2048?2:y<65536?3:4;for(p=new i.Buf8(S),b=w=0;w<S;b++)(64512&(y=h.charCodeAt(b)))==55296&&b+1<x&&(64512&(v=h.charCodeAt(b+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),b++),y<128?p[w++]=y:(y<2048?p[w++]=192|y>>>6:(y<65536?p[w++]=224|y>>>12:(p[w++]=240|y>>>18,p[w++]=128|y>>>12&63),p[w++]=128|y>>>6&63),p[w++]=128|63&y);return p},a.buf2binstring=function(h){return d(h,h.length)},a.binstring2buf=function(h){for(var p=new i.Buf8(h.length),y=0,v=p.length;y<v;y++)p[y]=h.charCodeAt(y);return p},a.buf2string=function(h,p){var y,v,b,w,x=p||h.length,S=new Array(2*x);for(y=v=0;y<x;)if((b=h[y++])<128)S[v++]=b;else if(4<(w=l[b]))S[v++]=65533,y+=w-1;else{for(b&=w===2?31:w===3?15:7;1<w&&y<x;)b=b<<6|63&h[y++],w--;1<w?S[v++]=65533:b<65536?S[v++]=b:(b-=65536,S[v++]=55296|b>>10&1023,S[v++]=56320|1023&b)}return d(S,v)},a.utf8border=function(h,p){var y;for((p=p||h.length)>h.length&&(p=h.length),y=p-1;0<=y&&(192&h[y])==128;)y--;return y<0||y===0?p:y+l[h[y]]>p?y:p}},{"./common":41}],43:[function(n,r,a){r.exports=function(i,s,o,l){for(var u=65535&i|0,d=i>>>16&65535|0,h=0;o!==0;){for(o-=h=2e3<o?2e3:o;d=d+(u=u+s[l++]|0)|0,--h;);u%=65521,d%=65521}return u|d<<16|0}},{}],44:[function(n,r,a){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,a){var i=function(){for(var s,o=[],l=0;l<256;l++){s=l;for(var u=0;u<8;u++)s=1&s?3988292384^s>>>1:s>>>1;o[l]=s}return o}();r.exports=function(s,o,l,u){var d=i,h=u+l;s^=-1;for(var p=u;p<h;p++)s=s>>>8^d[255&(s^o[p])];return-1^s}},{}],46:[function(n,r,a){var i,s=n("../utils/common"),o=n("./trees"),l=n("./adler32"),u=n("./crc32"),d=n("./messages"),h=0,p=4,y=0,v=-2,b=-1,w=4,x=2,S=8,E=9,C=286,k=30,R=19,O=2*C+1,j=15,$=3,L=258,X=L+$+1,F=42,K=113,q=1,de=2,re=3,Y=4;function Q(V,ge){return V.msg=d[ge],ge}function ae(V){return(V<<1)-(4<V?9:0)}function B(V){for(var ge=V.length;0<=--ge;)V[ge]=0}function J(V){var ge=V.state,Te=ge.pending;Te>V.avail_out&&(Te=V.avail_out),Te!==0&&(s.arraySet(V.output,ge.pending_buf,ge.pending_out,Te,V.next_out),V.next_out+=Te,ge.pending_out+=Te,V.total_out+=Te,V.avail_out-=Te,ge.pending-=Te,ge.pending===0&&(ge.pending_out=0))}function ee(V,ge){o._tr_flush_block(V,0<=V.block_start?V.block_start:-1,V.strstart-V.block_start,ge),V.block_start=V.strstart,J(V.strm)}function oe(V,ge){V.pending_buf[V.pending++]=ge}function me(V,ge){V.pending_buf[V.pending++]=ge>>>8&255,V.pending_buf[V.pending++]=255&ge}function xe(V,ge){var Te,le,ie=V.max_chain_length,te=V.strstart,_e=V.prev_length,Me=V.nice_match,Ee=V.strstart>V.w_size-X?V.strstart-(V.w_size-X):0,We=V.window,kt=V.w_mask,it=V.prev,xt=V.strstart+L,Dt=We[te+_e-1],Ot=We[te+_e];V.prev_length>=V.good_match&&(ie>>=2),Me>V.lookahead&&(Me=V.lookahead);do if(We[(Te=ge)+_e]===Ot&&We[Te+_e-1]===Dt&&We[Te]===We[te]&&We[++Te]===We[te+1]){te+=2,Te++;do;while(We[++te]===We[++Te]&&We[++te]===We[++Te]&&We[++te]===We[++Te]&&We[++te]===We[++Te]&&We[++te]===We[++Te]&&We[++te]===We[++Te]&&We[++te]===We[++Te]&&We[++te]===We[++Te]&&te<xt);if(le=L-(xt-te),te=xt-L,_e<le){if(V.match_start=ge,Me<=(_e=le))break;Dt=We[te+_e-1],Ot=We[te+_e]}}while((ge=it[ge&kt])>Ee&&--ie!=0);return _e<=V.lookahead?_e:V.lookahead}function Pe(V){var ge,Te,le,ie,te,_e,Me,Ee,We,kt,it=V.w_size;do{if(ie=V.window_size-V.lookahead-V.strstart,V.strstart>=it+(it-X)){for(s.arraySet(V.window,V.window,it,it,0),V.match_start-=it,V.strstart-=it,V.block_start-=it,ge=Te=V.hash_size;le=V.head[--ge],V.head[ge]=it<=le?le-it:0,--Te;);for(ge=Te=it;le=V.prev[--ge],V.prev[ge]=it<=le?le-it:0,--Te;);ie+=it}if(V.strm.avail_in===0)break;if(_e=V.strm,Me=V.window,Ee=V.strstart+V.lookahead,We=ie,kt=void 0,kt=_e.avail_in,We<kt&&(kt=We),Te=kt===0?0:(_e.avail_in-=kt,s.arraySet(Me,_e.input,_e.next_in,kt,Ee),_e.state.wrap===1?_e.adler=l(_e.adler,Me,kt,Ee):_e.state.wrap===2&&(_e.adler=u(_e.adler,Me,kt,Ee)),_e.next_in+=kt,_e.total_in+=kt,kt),V.lookahead+=Te,V.lookahead+V.insert>=$)for(te=V.strstart-V.insert,V.ins_h=V.window[te],V.ins_h=(V.ins_h<<V.hash_shift^V.window[te+1])&V.hash_mask;V.insert&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[te+$-1])&V.hash_mask,V.prev[te&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=te,te++,V.insert--,!(V.lookahead+V.insert<$)););}while(V.lookahead<X&&V.strm.avail_in!==0)}function Ne(V,ge){for(var Te,le;;){if(V.lookahead<X){if(Pe(V),V.lookahead<X&&ge===h)return q;if(V.lookahead===0)break}if(Te=0,V.lookahead>=$&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+$-1])&V.hash_mask,Te=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),Te!==0&&V.strstart-Te<=V.w_size-X&&(V.match_length=xe(V,Te)),V.match_length>=$)if(le=o._tr_tally(V,V.strstart-V.match_start,V.match_length-$),V.lookahead-=V.match_length,V.match_length<=V.max_lazy_match&&V.lookahead>=$){for(V.match_length--;V.strstart++,V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+$-1])&V.hash_mask,Te=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart,--V.match_length!=0;);V.strstart++}else V.strstart+=V.match_length,V.match_length=0,V.ins_h=V.window[V.strstart],V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+1])&V.hash_mask;else le=o._tr_tally(V,0,V.window[V.strstart]),V.lookahead--,V.strstart++;if(le&&(ee(V,!1),V.strm.avail_out===0))return q}return V.insert=V.strstart<$-1?V.strstart:$-1,ge===p?(ee(V,!0),V.strm.avail_out===0?re:Y):V.last_lit&&(ee(V,!1),V.strm.avail_out===0)?q:de}function Re(V,ge){for(var Te,le,ie;;){if(V.lookahead<X){if(Pe(V),V.lookahead<X&&ge===h)return q;if(V.lookahead===0)break}if(Te=0,V.lookahead>=$&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+$-1])&V.hash_mask,Te=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),V.prev_length=V.match_length,V.prev_match=V.match_start,V.match_length=$-1,Te!==0&&V.prev_length<V.max_lazy_match&&V.strstart-Te<=V.w_size-X&&(V.match_length=xe(V,Te),V.match_length<=5&&(V.strategy===1||V.match_length===$&&4096<V.strstart-V.match_start)&&(V.match_length=$-1)),V.prev_length>=$&&V.match_length<=V.prev_length){for(ie=V.strstart+V.lookahead-$,le=o._tr_tally(V,V.strstart-1-V.prev_match,V.prev_length-$),V.lookahead-=V.prev_length-1,V.prev_length-=2;++V.strstart<=ie&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+$-1])&V.hash_mask,Te=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),--V.prev_length!=0;);if(V.match_available=0,V.match_length=$-1,V.strstart++,le&&(ee(V,!1),V.strm.avail_out===0))return q}else if(V.match_available){if((le=o._tr_tally(V,0,V.window[V.strstart-1]))&&ee(V,!1),V.strstart++,V.lookahead--,V.strm.avail_out===0)return q}else V.match_available=1,V.strstart++,V.lookahead--}return V.match_available&&(le=o._tr_tally(V,0,V.window[V.strstart-1]),V.match_available=0),V.insert=V.strstart<$-1?V.strstart:$-1,ge===p?(ee(V,!0),V.strm.avail_out===0?re:Y):V.last_lit&&(ee(V,!1),V.strm.avail_out===0)?q:de}function ke(V,ge,Te,le,ie){this.good_length=V,this.max_lazy=ge,this.nice_length=Te,this.max_chain=le,this.func=ie}function Fe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*O),this.dyn_dtree=new s.Buf16(2*(2*k+1)),this.bl_tree=new s.Buf16(2*(2*R+1)),B(this.dyn_ltree),B(this.dyn_dtree),B(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(j+1),this.heap=new s.Buf16(2*C+1),B(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*C+1),B(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Qe(V){var ge;return V&&V.state?(V.total_in=V.total_out=0,V.data_type=x,(ge=V.state).pending=0,ge.pending_out=0,ge.wrap<0&&(ge.wrap=-ge.wrap),ge.status=ge.wrap?F:K,V.adler=ge.wrap===2?0:1,ge.last_flush=h,o._tr_init(ge),y):Q(V,v)}function Le(V){var ge=Qe(V);return ge===y&&function(Te){Te.window_size=2*Te.w_size,B(Te.head),Te.max_lazy_match=i[Te.level].max_lazy,Te.good_match=i[Te.level].good_length,Te.nice_match=i[Te.level].nice_length,Te.max_chain_length=i[Te.level].max_chain,Te.strstart=0,Te.block_start=0,Te.lookahead=0,Te.insert=0,Te.match_length=Te.prev_length=$-1,Te.match_available=0,Te.ins_h=0}(V.state),ge}function Ie(V,ge,Te,le,ie,te){if(!V)return v;var _e=1;if(ge===b&&(ge=6),le<0?(_e=0,le=-le):15<le&&(_e=2,le-=16),ie<1||E<ie||Te!==S||le<8||15<le||ge<0||9<ge||te<0||w<te)return Q(V,v);le===8&&(le=9);var Me=new Fe;return(V.state=Me).strm=V,Me.wrap=_e,Me.gzhead=null,Me.w_bits=le,Me.w_size=1<<Me.w_bits,Me.w_mask=Me.w_size-1,Me.hash_bits=ie+7,Me.hash_size=1<<Me.hash_bits,Me.hash_mask=Me.hash_size-1,Me.hash_shift=~~((Me.hash_bits+$-1)/$),Me.window=new s.Buf8(2*Me.w_size),Me.head=new s.Buf16(Me.hash_size),Me.prev=new s.Buf16(Me.w_size),Me.lit_bufsize=1<<ie+6,Me.pending_buf_size=4*Me.lit_bufsize,Me.pending_buf=new s.Buf8(Me.pending_buf_size),Me.d_buf=1*Me.lit_bufsize,Me.l_buf=3*Me.lit_bufsize,Me.level=ge,Me.strategy=te,Me.method=Te,Le(V)}i=[new ke(0,0,0,0,function(V,ge){var Te=65535;for(Te>V.pending_buf_size-5&&(Te=V.pending_buf_size-5);;){if(V.lookahead<=1){if(Pe(V),V.lookahead===0&&ge===h)return q;if(V.lookahead===0)break}V.strstart+=V.lookahead,V.lookahead=0;var le=V.block_start+Te;if((V.strstart===0||V.strstart>=le)&&(V.lookahead=V.strstart-le,V.strstart=le,ee(V,!1),V.strm.avail_out===0)||V.strstart-V.block_start>=V.w_size-X&&(ee(V,!1),V.strm.avail_out===0))return q}return V.insert=0,ge===p?(ee(V,!0),V.strm.avail_out===0?re:Y):(V.strstart>V.block_start&&(ee(V,!1),V.strm.avail_out),q)}),new ke(4,4,8,4,Ne),new ke(4,5,16,8,Ne),new ke(4,6,32,32,Ne),new ke(4,4,16,16,Re),new ke(8,16,32,32,Re),new ke(8,16,128,128,Re),new ke(8,32,128,256,Re),new ke(32,128,258,1024,Re),new ke(32,258,258,4096,Re)],a.deflateInit=function(V,ge){return Ie(V,ge,S,15,8,0)},a.deflateInit2=Ie,a.deflateReset=Le,a.deflateResetKeep=Qe,a.deflateSetHeader=function(V,ge){return V&&V.state?V.state.wrap!==2?v:(V.state.gzhead=ge,y):v},a.deflate=function(V,ge){var Te,le,ie,te;if(!V||!V.state||5<ge||ge<0)return V?Q(V,v):v;if(le=V.state,!V.output||!V.input&&V.avail_in!==0||le.status===666&&ge!==p)return Q(V,V.avail_out===0?-5:v);if(le.strm=V,Te=le.last_flush,le.last_flush=ge,le.status===F)if(le.wrap===2)V.adler=0,oe(le,31),oe(le,139),oe(le,8),le.gzhead?(oe(le,(le.gzhead.text?1:0)+(le.gzhead.hcrc?2:0)+(le.gzhead.extra?4:0)+(le.gzhead.name?8:0)+(le.gzhead.comment?16:0)),oe(le,255&le.gzhead.time),oe(le,le.gzhead.time>>8&255),oe(le,le.gzhead.time>>16&255),oe(le,le.gzhead.time>>24&255),oe(le,le.level===9?2:2<=le.strategy||le.level<2?4:0),oe(le,255&le.gzhead.os),le.gzhead.extra&&le.gzhead.extra.length&&(oe(le,255&le.gzhead.extra.length),oe(le,le.gzhead.extra.length>>8&255)),le.gzhead.hcrc&&(V.adler=u(V.adler,le.pending_buf,le.pending,0)),le.gzindex=0,le.status=69):(oe(le,0),oe(le,0),oe(le,0),oe(le,0),oe(le,0),oe(le,le.level===9?2:2<=le.strategy||le.level<2?4:0),oe(le,3),le.status=K);else{var _e=S+(le.w_bits-8<<4)<<8;_e|=(2<=le.strategy||le.level<2?0:le.level<6?1:le.level===6?2:3)<<6,le.strstart!==0&&(_e|=32),_e+=31-_e%31,le.status=K,me(le,_e),le.strstart!==0&&(me(le,V.adler>>>16),me(le,65535&V.adler)),V.adler=1}if(le.status===69)if(le.gzhead.extra){for(ie=le.pending;le.gzindex<(65535&le.gzhead.extra.length)&&(le.pending!==le.pending_buf_size||(le.gzhead.hcrc&&le.pending>ie&&(V.adler=u(V.adler,le.pending_buf,le.pending-ie,ie)),J(V),ie=le.pending,le.pending!==le.pending_buf_size));)oe(le,255&le.gzhead.extra[le.gzindex]),le.gzindex++;le.gzhead.hcrc&&le.pending>ie&&(V.adler=u(V.adler,le.pending_buf,le.pending-ie,ie)),le.gzindex===le.gzhead.extra.length&&(le.gzindex=0,le.status=73)}else le.status=73;if(le.status===73)if(le.gzhead.name){ie=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>ie&&(V.adler=u(V.adler,le.pending_buf,le.pending-ie,ie)),J(V),ie=le.pending,le.pending===le.pending_buf_size)){te=1;break}te=le.gzindex<le.gzhead.name.length?255&le.gzhead.name.charCodeAt(le.gzindex++):0,oe(le,te)}while(te!==0);le.gzhead.hcrc&&le.pending>ie&&(V.adler=u(V.adler,le.pending_buf,le.pending-ie,ie)),te===0&&(le.gzindex=0,le.status=91)}else le.status=91;if(le.status===91)if(le.gzhead.comment){ie=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>ie&&(V.adler=u(V.adler,le.pending_buf,le.pending-ie,ie)),J(V),ie=le.pending,le.pending===le.pending_buf_size)){te=1;break}te=le.gzindex<le.gzhead.comment.length?255&le.gzhead.comment.charCodeAt(le.gzindex++):0,oe(le,te)}while(te!==0);le.gzhead.hcrc&&le.pending>ie&&(V.adler=u(V.adler,le.pending_buf,le.pending-ie,ie)),te===0&&(le.status=103)}else le.status=103;if(le.status===103&&(le.gzhead.hcrc?(le.pending+2>le.pending_buf_size&&J(V),le.pending+2<=le.pending_buf_size&&(oe(le,255&V.adler),oe(le,V.adler>>8&255),V.adler=0,le.status=K)):le.status=K),le.pending!==0){if(J(V),V.avail_out===0)return le.last_flush=-1,y}else if(V.avail_in===0&&ae(ge)<=ae(Te)&&ge!==p)return Q(V,-5);if(le.status===666&&V.avail_in!==0)return Q(V,-5);if(V.avail_in!==0||le.lookahead!==0||ge!==h&&le.status!==666){var Me=le.strategy===2?function(Ee,We){for(var kt;;){if(Ee.lookahead===0&&(Pe(Ee),Ee.lookahead===0)){if(We===h)return q;break}if(Ee.match_length=0,kt=o._tr_tally(Ee,0,Ee.window[Ee.strstart]),Ee.lookahead--,Ee.strstart++,kt&&(ee(Ee,!1),Ee.strm.avail_out===0))return q}return Ee.insert=0,We===p?(ee(Ee,!0),Ee.strm.avail_out===0?re:Y):Ee.last_lit&&(ee(Ee,!1),Ee.strm.avail_out===0)?q:de}(le,ge):le.strategy===3?function(Ee,We){for(var kt,it,xt,Dt,Ot=Ee.window;;){if(Ee.lookahead<=L){if(Pe(Ee),Ee.lookahead<=L&&We===h)return q;if(Ee.lookahead===0)break}if(Ee.match_length=0,Ee.lookahead>=$&&0<Ee.strstart&&(it=Ot[xt=Ee.strstart-1])===Ot[++xt]&&it===Ot[++xt]&&it===Ot[++xt]){Dt=Ee.strstart+L;do;while(it===Ot[++xt]&&it===Ot[++xt]&&it===Ot[++xt]&&it===Ot[++xt]&&it===Ot[++xt]&&it===Ot[++xt]&&it===Ot[++xt]&&it===Ot[++xt]&&xt<Dt);Ee.match_length=L-(Dt-xt),Ee.match_length>Ee.lookahead&&(Ee.match_length=Ee.lookahead)}if(Ee.match_length>=$?(kt=o._tr_tally(Ee,1,Ee.match_length-$),Ee.lookahead-=Ee.match_length,Ee.strstart+=Ee.match_length,Ee.match_length=0):(kt=o._tr_tally(Ee,0,Ee.window[Ee.strstart]),Ee.lookahead--,Ee.strstart++),kt&&(ee(Ee,!1),Ee.strm.avail_out===0))return q}return Ee.insert=0,We===p?(ee(Ee,!0),Ee.strm.avail_out===0?re:Y):Ee.last_lit&&(ee(Ee,!1),Ee.strm.avail_out===0)?q:de}(le,ge):i[le.level].func(le,ge);if(Me!==re&&Me!==Y||(le.status=666),Me===q||Me===re)return V.avail_out===0&&(le.last_flush=-1),y;if(Me===de&&(ge===1?o._tr_align(le):ge!==5&&(o._tr_stored_block(le,0,0,!1),ge===3&&(B(le.head),le.lookahead===0&&(le.strstart=0,le.block_start=0,le.insert=0))),J(V),V.avail_out===0))return le.last_flush=-1,y}return ge!==p?y:le.wrap<=0?1:(le.wrap===2?(oe(le,255&V.adler),oe(le,V.adler>>8&255),oe(le,V.adler>>16&255),oe(le,V.adler>>24&255),oe(le,255&V.total_in),oe(le,V.total_in>>8&255),oe(le,V.total_in>>16&255),oe(le,V.total_in>>24&255)):(me(le,V.adler>>>16),me(le,65535&V.adler)),J(V),0<le.wrap&&(le.wrap=-le.wrap),le.pending!==0?y:1)},a.deflateEnd=function(V){var ge;return V&&V.state?(ge=V.state.status)!==F&&ge!==69&&ge!==73&&ge!==91&&ge!==103&&ge!==K&&ge!==666?Q(V,v):(V.state=null,ge===K?Q(V,-3):y):v},a.deflateSetDictionary=function(V,ge){var Te,le,ie,te,_e,Me,Ee,We,kt=ge.length;if(!V||!V.state||(te=(Te=V.state).wrap)===2||te===1&&Te.status!==F||Te.lookahead)return v;for(te===1&&(V.adler=l(V.adler,ge,kt,0)),Te.wrap=0,kt>=Te.w_size&&(te===0&&(B(Te.head),Te.strstart=0,Te.block_start=0,Te.insert=0),We=new s.Buf8(Te.w_size),s.arraySet(We,ge,kt-Te.w_size,Te.w_size,0),ge=We,kt=Te.w_size),_e=V.avail_in,Me=V.next_in,Ee=V.input,V.avail_in=kt,V.next_in=0,V.input=ge,Pe(Te);Te.lookahead>=$;){for(le=Te.strstart,ie=Te.lookahead-($-1);Te.ins_h=(Te.ins_h<<Te.hash_shift^Te.window[le+$-1])&Te.hash_mask,Te.prev[le&Te.w_mask]=Te.head[Te.ins_h],Te.head[Te.ins_h]=le,le++,--ie;);Te.strstart=le,Te.lookahead=$-1,Pe(Te)}return Te.strstart+=Te.lookahead,Te.block_start=Te.strstart,Te.insert=Te.lookahead,Te.lookahead=0,Te.match_length=Te.prev_length=$-1,Te.match_available=0,V.next_in=Me,V.input=Ee,V.avail_in=_e,Te.wrap=te,y},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,a){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,a){r.exports=function(i,s){var o,l,u,d,h,p,y,v,b,w,x,S,E,C,k,R,O,j,$,L,X,F,K,q,de;o=i.state,l=i.next_in,q=i.input,u=l+(i.avail_in-5),d=i.next_out,de=i.output,h=d-(s-i.avail_out),p=d+(i.avail_out-257),y=o.dmax,v=o.wsize,b=o.whave,w=o.wnext,x=o.window,S=o.hold,E=o.bits,C=o.lencode,k=o.distcode,R=(1<<o.lenbits)-1,O=(1<<o.distbits)-1;e:do{E<15&&(S+=q[l++]<<E,E+=8,S+=q[l++]<<E,E+=8),j=C[S&R];t:for(;;){if(S>>>=$=j>>>24,E-=$,($=j>>>16&255)===0)de[d++]=65535&j;else{if(!(16&$)){if((64&$)==0){j=C[(65535&j)+(S&(1<<$)-1)];continue t}if(32&$){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}L=65535&j,($&=15)&&(E<$&&(S+=q[l++]<<E,E+=8),L+=S&(1<<$)-1,S>>>=$,E-=$),E<15&&(S+=q[l++]<<E,E+=8,S+=q[l++]<<E,E+=8),j=k[S&O];n:for(;;){if(S>>>=$=j>>>24,E-=$,!(16&($=j>>>16&255))){if((64&$)==0){j=k[(65535&j)+(S&(1<<$)-1)];continue n}i.msg="invalid distance code",o.mode=30;break e}if(X=65535&j,E<($&=15)&&(S+=q[l++]<<E,(E+=8)<$&&(S+=q[l++]<<E,E+=8)),y<(X+=S&(1<<$)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(S>>>=$,E-=$,($=d-h)<X){if(b<($=X-$)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(K=x,(F=0)===w){if(F+=v-$,$<L){for(L-=$;de[d++]=x[F++],--$;);F=d-X,K=de}}else if(w<$){if(F+=v+w-$,($-=w)<L){for(L-=$;de[d++]=x[F++],--$;);if(F=0,w<L){for(L-=$=w;de[d++]=x[F++],--$;);F=d-X,K=de}}}else if(F+=w-$,$<L){for(L-=$;de[d++]=x[F++],--$;);F=d-X,K=de}for(;2<L;)de[d++]=K[F++],de[d++]=K[F++],de[d++]=K[F++],L-=3;L&&(de[d++]=K[F++],1<L&&(de[d++]=K[F++]))}else{for(F=d-X;de[d++]=de[F++],de[d++]=de[F++],de[d++]=de[F++],2<(L-=3););L&&(de[d++]=de[F++],1<L&&(de[d++]=de[F++]))}break}}break}}while(l<u&&d<p);l-=L=E>>3,S&=(1<<(E-=L<<3))-1,i.next_in=l,i.next_out=d,i.avail_in=l<u?u-l+5:5-(l-u),i.avail_out=d<p?p-d+257:257-(d-p),o.hold=S,o.bits=E}},{}],49:[function(n,r,a){var i=n("../utils/common"),s=n("./adler32"),o=n("./crc32"),l=n("./inffast"),u=n("./inftrees"),d=1,h=2,p=0,y=-2,v=1,b=852,w=592;function x(F){return(F>>>24&255)+(F>>>8&65280)+((65280&F)<<8)+((255&F)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(F){var K;return F&&F.state?(K=F.state,F.total_in=F.total_out=K.total=0,F.msg="",K.wrap&&(F.adler=1&K.wrap),K.mode=v,K.last=0,K.havedict=0,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new i.Buf32(b),K.distcode=K.distdyn=new i.Buf32(w),K.sane=1,K.back=-1,p):y}function C(F){var K;return F&&F.state?((K=F.state).wsize=0,K.whave=0,K.wnext=0,E(F)):y}function k(F,K){var q,de;return F&&F.state?(de=F.state,K<0?(q=0,K=-K):(q=1+(K>>4),K<48&&(K&=15)),K&&(K<8||15<K)?y:(de.window!==null&&de.wbits!==K&&(de.window=null),de.wrap=q,de.wbits=K,C(F))):y}function R(F,K){var q,de;return F?(de=new S,(F.state=de).window=null,(q=k(F,K))!==p&&(F.state=null),q):y}var O,j,$=!0;function L(F){if($){var K;for(O=new i.Buf32(512),j=new i.Buf32(32),K=0;K<144;)F.lens[K++]=8;for(;K<256;)F.lens[K++]=9;for(;K<280;)F.lens[K++]=7;for(;K<288;)F.lens[K++]=8;for(u(d,F.lens,0,288,O,0,F.work,{bits:9}),K=0;K<32;)F.lens[K++]=5;u(h,F.lens,0,32,j,0,F.work,{bits:5}),$=!1}F.lencode=O,F.lenbits=9,F.distcode=j,F.distbits=5}function X(F,K,q,de){var re,Y=F.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new i.Buf8(Y.wsize)),de>=Y.wsize?(i.arraySet(Y.window,K,q-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize):(de<(re=Y.wsize-Y.wnext)&&(re=de),i.arraySet(Y.window,K,q-de,re,Y.wnext),(de-=re)?(i.arraySet(Y.window,K,q-de,de,0),Y.wnext=de,Y.whave=Y.wsize):(Y.wnext+=re,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=re))),0}a.inflateReset=C,a.inflateReset2=k,a.inflateResetKeep=E,a.inflateInit=function(F){return R(F,15)},a.inflateInit2=R,a.inflate=function(F,K){var q,de,re,Y,Q,ae,B,J,ee,oe,me,xe,Pe,Ne,Re,ke,Fe,Qe,Le,Ie,V,ge,Te,le,ie=0,te=new i.Buf8(4),_e=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return y;(q=F.state).mode===12&&(q.mode=13),Q=F.next_out,re=F.output,B=F.avail_out,Y=F.next_in,de=F.input,ae=F.avail_in,J=q.hold,ee=q.bits,oe=ae,me=B,ge=p;e:for(;;)switch(q.mode){case v:if(q.wrap===0){q.mode=13;break}for(;ee<16;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if(2&q.wrap&&J===35615){te[q.check=0]=255&J,te[1]=J>>>8&255,q.check=o(q.check,te,2,0),ee=J=0,q.mode=2;break}if(q.flags=0,q.head&&(q.head.done=!1),!(1&q.wrap)||(((255&J)<<8)+(J>>8))%31){F.msg="incorrect header check",q.mode=30;break}if((15&J)!=8){F.msg="unknown compression method",q.mode=30;break}if(ee-=4,V=8+(15&(J>>>=4)),q.wbits===0)q.wbits=V;else if(V>q.wbits){F.msg="invalid window size",q.mode=30;break}q.dmax=1<<V,F.adler=q.check=1,q.mode=512&J?10:12,ee=J=0;break;case 2:for(;ee<16;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if(q.flags=J,(255&q.flags)!=8){F.msg="unknown compression method",q.mode=30;break}if(57344&q.flags){F.msg="unknown header flags set",q.mode=30;break}q.head&&(q.head.text=J>>8&1),512&q.flags&&(te[0]=255&J,te[1]=J>>>8&255,q.check=o(q.check,te,2,0)),ee=J=0,q.mode=3;case 3:for(;ee<32;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}q.head&&(q.head.time=J),512&q.flags&&(te[0]=255&J,te[1]=J>>>8&255,te[2]=J>>>16&255,te[3]=J>>>24&255,q.check=o(q.check,te,4,0)),ee=J=0,q.mode=4;case 4:for(;ee<16;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}q.head&&(q.head.xflags=255&J,q.head.os=J>>8),512&q.flags&&(te[0]=255&J,te[1]=J>>>8&255,q.check=o(q.check,te,2,0)),ee=J=0,q.mode=5;case 5:if(1024&q.flags){for(;ee<16;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}q.length=J,q.head&&(q.head.extra_len=J),512&q.flags&&(te[0]=255&J,te[1]=J>>>8&255,q.check=o(q.check,te,2,0)),ee=J=0}else q.head&&(q.head.extra=null);q.mode=6;case 6:if(1024&q.flags&&(ae<(xe=q.length)&&(xe=ae),xe&&(q.head&&(V=q.head.extra_len-q.length,q.head.extra||(q.head.extra=new Array(q.head.extra_len)),i.arraySet(q.head.extra,de,Y,xe,V)),512&q.flags&&(q.check=o(q.check,de,xe,Y)),ae-=xe,Y+=xe,q.length-=xe),q.length))break e;q.length=0,q.mode=7;case 7:if(2048&q.flags){if(ae===0)break e;for(xe=0;V=de[Y+xe++],q.head&&V&&q.length<65536&&(q.head.name+=String.fromCharCode(V)),V&&xe<ae;);if(512&q.flags&&(q.check=o(q.check,de,xe,Y)),ae-=xe,Y+=xe,V)break e}else q.head&&(q.head.name=null);q.length=0,q.mode=8;case 8:if(4096&q.flags){if(ae===0)break e;for(xe=0;V=de[Y+xe++],q.head&&V&&q.length<65536&&(q.head.comment+=String.fromCharCode(V)),V&&xe<ae;);if(512&q.flags&&(q.check=o(q.check,de,xe,Y)),ae-=xe,Y+=xe,V)break e}else q.head&&(q.head.comment=null);q.mode=9;case 9:if(512&q.flags){for(;ee<16;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if(J!==(65535&q.check)){F.msg="header crc mismatch",q.mode=30;break}ee=J=0}q.head&&(q.head.hcrc=q.flags>>9&1,q.head.done=!0),F.adler=q.check=0,q.mode=12;break;case 10:for(;ee<32;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}F.adler=q.check=x(J),ee=J=0,q.mode=11;case 11:if(q.havedict===0)return F.next_out=Q,F.avail_out=B,F.next_in=Y,F.avail_in=ae,q.hold=J,q.bits=ee,2;F.adler=q.check=1,q.mode=12;case 12:if(K===5||K===6)break e;case 13:if(q.last){J>>>=7&ee,ee-=7&ee,q.mode=27;break}for(;ee<3;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}switch(q.last=1&J,ee-=1,3&(J>>>=1)){case 0:q.mode=14;break;case 1:if(L(q),q.mode=20,K!==6)break;J>>>=2,ee-=2;break e;case 2:q.mode=17;break;case 3:F.msg="invalid block type",q.mode=30}J>>>=2,ee-=2;break;case 14:for(J>>>=7&ee,ee-=7&ee;ee<32;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if((65535&J)!=(J>>>16^65535)){F.msg="invalid stored block lengths",q.mode=30;break}if(q.length=65535&J,ee=J=0,q.mode=15,K===6)break e;case 15:q.mode=16;case 16:if(xe=q.length){if(ae<xe&&(xe=ae),B<xe&&(xe=B),xe===0)break e;i.arraySet(re,de,Y,xe,Q),ae-=xe,Y+=xe,B-=xe,Q+=xe,q.length-=xe;break}q.mode=12;break;case 17:for(;ee<14;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if(q.nlen=257+(31&J),J>>>=5,ee-=5,q.ndist=1+(31&J),J>>>=5,ee-=5,q.ncode=4+(15&J),J>>>=4,ee-=4,286<q.nlen||30<q.ndist){F.msg="too many length or distance symbols",q.mode=30;break}q.have=0,q.mode=18;case 18:for(;q.have<q.ncode;){for(;ee<3;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}q.lens[_e[q.have++]]=7&J,J>>>=3,ee-=3}for(;q.have<19;)q.lens[_e[q.have++]]=0;if(q.lencode=q.lendyn,q.lenbits=7,Te={bits:q.lenbits},ge=u(0,q.lens,0,19,q.lencode,0,q.work,Te),q.lenbits=Te.bits,ge){F.msg="invalid code lengths set",q.mode=30;break}q.have=0,q.mode=19;case 19:for(;q.have<q.nlen+q.ndist;){for(;ke=(ie=q.lencode[J&(1<<q.lenbits)-1])>>>16&255,Fe=65535&ie,!((Re=ie>>>24)<=ee);){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if(Fe<16)J>>>=Re,ee-=Re,q.lens[q.have++]=Fe;else{if(Fe===16){for(le=Re+2;ee<le;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if(J>>>=Re,ee-=Re,q.have===0){F.msg="invalid bit length repeat",q.mode=30;break}V=q.lens[q.have-1],xe=3+(3&J),J>>>=2,ee-=2}else if(Fe===17){for(le=Re+3;ee<le;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}ee-=Re,V=0,xe=3+(7&(J>>>=Re)),J>>>=3,ee-=3}else{for(le=Re+7;ee<le;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}ee-=Re,V=0,xe=11+(127&(J>>>=Re)),J>>>=7,ee-=7}if(q.have+xe>q.nlen+q.ndist){F.msg="invalid bit length repeat",q.mode=30;break}for(;xe--;)q.lens[q.have++]=V}}if(q.mode===30)break;if(q.lens[256]===0){F.msg="invalid code -- missing end-of-block",q.mode=30;break}if(q.lenbits=9,Te={bits:q.lenbits},ge=u(d,q.lens,0,q.nlen,q.lencode,0,q.work,Te),q.lenbits=Te.bits,ge){F.msg="invalid literal/lengths set",q.mode=30;break}if(q.distbits=6,q.distcode=q.distdyn,Te={bits:q.distbits},ge=u(h,q.lens,q.nlen,q.ndist,q.distcode,0,q.work,Te),q.distbits=Te.bits,ge){F.msg="invalid distances set",q.mode=30;break}if(q.mode=20,K===6)break e;case 20:q.mode=21;case 21:if(6<=ae&&258<=B){F.next_out=Q,F.avail_out=B,F.next_in=Y,F.avail_in=ae,q.hold=J,q.bits=ee,l(F,me),Q=F.next_out,re=F.output,B=F.avail_out,Y=F.next_in,de=F.input,ae=F.avail_in,J=q.hold,ee=q.bits,q.mode===12&&(q.back=-1);break}for(q.back=0;ke=(ie=q.lencode[J&(1<<q.lenbits)-1])>>>16&255,Fe=65535&ie,!((Re=ie>>>24)<=ee);){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if(ke&&(240&ke)==0){for(Qe=Re,Le=ke,Ie=Fe;ke=(ie=q.lencode[Ie+((J&(1<<Qe+Le)-1)>>Qe)])>>>16&255,Fe=65535&ie,!(Qe+(Re=ie>>>24)<=ee);){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}J>>>=Qe,ee-=Qe,q.back+=Qe}if(J>>>=Re,ee-=Re,q.back+=Re,q.length=Fe,ke===0){q.mode=26;break}if(32&ke){q.back=-1,q.mode=12;break}if(64&ke){F.msg="invalid literal/length code",q.mode=30;break}q.extra=15&ke,q.mode=22;case 22:if(q.extra){for(le=q.extra;ee<le;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}q.length+=J&(1<<q.extra)-1,J>>>=q.extra,ee-=q.extra,q.back+=q.extra}q.was=q.length,q.mode=23;case 23:for(;ke=(ie=q.distcode[J&(1<<q.distbits)-1])>>>16&255,Fe=65535&ie,!((Re=ie>>>24)<=ee);){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if((240&ke)==0){for(Qe=Re,Le=ke,Ie=Fe;ke=(ie=q.distcode[Ie+((J&(1<<Qe+Le)-1)>>Qe)])>>>16&255,Fe=65535&ie,!(Qe+(Re=ie>>>24)<=ee);){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}J>>>=Qe,ee-=Qe,q.back+=Qe}if(J>>>=Re,ee-=Re,q.back+=Re,64&ke){F.msg="invalid distance code",q.mode=30;break}q.offset=Fe,q.extra=15&ke,q.mode=24;case 24:if(q.extra){for(le=q.extra;ee<le;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}q.offset+=J&(1<<q.extra)-1,J>>>=q.extra,ee-=q.extra,q.back+=q.extra}if(q.offset>q.dmax){F.msg="invalid distance too far back",q.mode=30;break}q.mode=25;case 25:if(B===0)break e;if(xe=me-B,q.offset>xe){if((xe=q.offset-xe)>q.whave&&q.sane){F.msg="invalid distance too far back",q.mode=30;break}Pe=xe>q.wnext?(xe-=q.wnext,q.wsize-xe):q.wnext-xe,xe>q.length&&(xe=q.length),Ne=q.window}else Ne=re,Pe=Q-q.offset,xe=q.length;for(B<xe&&(xe=B),B-=xe,q.length-=xe;re[Q++]=Ne[Pe++],--xe;);q.length===0&&(q.mode=21);break;case 26:if(B===0)break e;re[Q++]=q.length,B--,q.mode=21;break;case 27:if(q.wrap){for(;ee<32;){if(ae===0)break e;ae--,J|=de[Y++]<<ee,ee+=8}if(me-=B,F.total_out+=me,q.total+=me,me&&(F.adler=q.check=q.flags?o(q.check,re,me,Q-me):s(q.check,re,me,Q-me)),me=B,(q.flags?J:x(J))!==q.check){F.msg="incorrect data check",q.mode=30;break}ee=J=0}q.mode=28;case 28:if(q.wrap&&q.flags){for(;ee<32;){if(ae===0)break e;ae--,J+=de[Y++]<<ee,ee+=8}if(J!==(4294967295&q.total)){F.msg="incorrect length check",q.mode=30;break}ee=J=0}q.mode=29;case 29:ge=1;break e;case 30:ge=-3;break e;case 31:return-4;case 32:default:return y}return F.next_out=Q,F.avail_out=B,F.next_in=Y,F.avail_in=ae,q.hold=J,q.bits=ee,(q.wsize||me!==F.avail_out&&q.mode<30&&(q.mode<27||K!==4))&&X(F,F.output,F.next_out,me-F.avail_out)?(q.mode=31,-4):(oe-=F.avail_in,me-=F.avail_out,F.total_in+=oe,F.total_out+=me,q.total+=me,q.wrap&&me&&(F.adler=q.check=q.flags?o(q.check,re,me,F.next_out-me):s(q.check,re,me,F.next_out-me)),F.data_type=q.bits+(q.last?64:0)+(q.mode===12?128:0)+(q.mode===20||q.mode===15?256:0),(oe==0&&me===0||K===4)&&ge===p&&(ge=-5),ge)},a.inflateEnd=function(F){if(!F||!F.state)return y;var K=F.state;return K.window&&(K.window=null),F.state=null,p},a.inflateGetHeader=function(F,K){var q;return F&&F.state?(2&(q=F.state).wrap)==0?y:((q.head=K).done=!1,p):y},a.inflateSetDictionary=function(F,K){var q,de=K.length;return F&&F.state?(q=F.state).wrap!==0&&q.mode!==11?y:q.mode===11&&s(1,K,de,0)!==q.check?-3:X(F,K,de,de)?(q.mode=31,-4):(q.havedict=1,p):y},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,a){var i=n("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(d,h,p,y,v,b,w,x){var S,E,C,k,R,O,j,$,L,X=x.bits,F=0,K=0,q=0,de=0,re=0,Y=0,Q=0,ae=0,B=0,J=0,ee=null,oe=0,me=new i.Buf16(16),xe=new i.Buf16(16),Pe=null,Ne=0;for(F=0;F<=15;F++)me[F]=0;for(K=0;K<y;K++)me[h[p+K]]++;for(re=X,de=15;1<=de&&me[de]===0;de--);if(de<re&&(re=de),de===0)return v[b++]=20971520,v[b++]=20971520,x.bits=1,0;for(q=1;q<de&&me[q]===0;q++);for(re<q&&(re=q),F=ae=1;F<=15;F++)if(ae<<=1,(ae-=me[F])<0)return-1;if(0<ae&&(d===0||de!==1))return-1;for(xe[1]=0,F=1;F<15;F++)xe[F+1]=xe[F]+me[F];for(K=0;K<y;K++)h[p+K]!==0&&(w[xe[h[p+K]]++]=K);if(O=d===0?(ee=Pe=w,19):d===1?(ee=s,oe-=257,Pe=o,Ne-=257,256):(ee=l,Pe=u,-1),F=q,R=b,Q=K=J=0,C=-1,k=(B=1<<(Y=re))-1,d===1&&852<B||d===2&&592<B)return 1;for(;;){for(j=F-Q,L=w[K]<O?($=0,w[K]):w[K]>O?($=Pe[Ne+w[K]],ee[oe+w[K]]):($=96,0),S=1<<F-Q,q=E=1<<Y;v[R+(J>>Q)+(E-=S)]=j<<24|$<<16|L|0,E!==0;);for(S=1<<F-1;J&S;)S>>=1;if(S!==0?(J&=S-1,J+=S):J=0,K++,--me[F]==0){if(F===de)break;F=h[p+w[K]]}if(re<F&&(J&k)!==C){for(Q===0&&(Q=re),R+=q,ae=1<<(Y=F-Q);Y+Q<de&&!((ae-=me[Y+Q])<=0);)Y++,ae<<=1;if(B+=1<<Y,d===1&&852<B||d===2&&592<B)return 1;v[C=J&k]=re<<24|Y<<16|R-b|0}}return J!==0&&(v[R+J]=F-Q<<24|64<<16|0),x.bits=re,0}},{"../utils/common":41}],51:[function(n,r,a){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,a){var i=n("../utils/common"),s=0,o=1;function l(ie){for(var te=ie.length;0<=--te;)ie[te]=0}var u=0,d=29,h=256,p=h+1+d,y=30,v=19,b=2*p+1,w=15,x=16,S=7,E=256,C=16,k=17,R=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],$=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=new Array(2*(p+2));l(X);var F=new Array(2*y);l(F);var K=new Array(512);l(K);var q=new Array(256);l(q);var de=new Array(d);l(de);var re,Y,Q,ae=new Array(y);function B(ie,te,_e,Me,Ee){this.static_tree=ie,this.extra_bits=te,this.extra_base=_e,this.elems=Me,this.max_length=Ee,this.has_stree=ie&&ie.length}function J(ie,te){this.dyn_tree=ie,this.max_code=0,this.stat_desc=te}function ee(ie){return ie<256?K[ie]:K[256+(ie>>>7)]}function oe(ie,te){ie.pending_buf[ie.pending++]=255&te,ie.pending_buf[ie.pending++]=te>>>8&255}function me(ie,te,_e){ie.bi_valid>x-_e?(ie.bi_buf|=te<<ie.bi_valid&65535,oe(ie,ie.bi_buf),ie.bi_buf=te>>x-ie.bi_valid,ie.bi_valid+=_e-x):(ie.bi_buf|=te<<ie.bi_valid&65535,ie.bi_valid+=_e)}function xe(ie,te,_e){me(ie,_e[2*te],_e[2*te+1])}function Pe(ie,te){for(var _e=0;_e|=1&ie,ie>>>=1,_e<<=1,0<--te;);return _e>>>1}function Ne(ie,te,_e){var Me,Ee,We=new Array(w+1),kt=0;for(Me=1;Me<=w;Me++)We[Me]=kt=kt+_e[Me-1]<<1;for(Ee=0;Ee<=te;Ee++){var it=ie[2*Ee+1];it!==0&&(ie[2*Ee]=Pe(We[it]++,it))}}function Re(ie){var te;for(te=0;te<p;te++)ie.dyn_ltree[2*te]=0;for(te=0;te<y;te++)ie.dyn_dtree[2*te]=0;for(te=0;te<v;te++)ie.bl_tree[2*te]=0;ie.dyn_ltree[2*E]=1,ie.opt_len=ie.static_len=0,ie.last_lit=ie.matches=0}function ke(ie){8<ie.bi_valid?oe(ie,ie.bi_buf):0<ie.bi_valid&&(ie.pending_buf[ie.pending++]=ie.bi_buf),ie.bi_buf=0,ie.bi_valid=0}function Fe(ie,te,_e,Me){var Ee=2*te,We=2*_e;return ie[Ee]<ie[We]||ie[Ee]===ie[We]&&Me[te]<=Me[_e]}function Qe(ie,te,_e){for(var Me=ie.heap[_e],Ee=_e<<1;Ee<=ie.heap_len&&(Ee<ie.heap_len&&Fe(te,ie.heap[Ee+1],ie.heap[Ee],ie.depth)&&Ee++,!Fe(te,Me,ie.heap[Ee],ie.depth));)ie.heap[_e]=ie.heap[Ee],_e=Ee,Ee<<=1;ie.heap[_e]=Me}function Le(ie,te,_e){var Me,Ee,We,kt,it=0;if(ie.last_lit!==0)for(;Me=ie.pending_buf[ie.d_buf+2*it]<<8|ie.pending_buf[ie.d_buf+2*it+1],Ee=ie.pending_buf[ie.l_buf+it],it++,Me===0?xe(ie,Ee,te):(xe(ie,(We=q[Ee])+h+1,te),(kt=O[We])!==0&&me(ie,Ee-=de[We],kt),xe(ie,We=ee(--Me),_e),(kt=j[We])!==0&&me(ie,Me-=ae[We],kt)),it<ie.last_lit;);xe(ie,E,te)}function Ie(ie,te){var _e,Me,Ee,We=te.dyn_tree,kt=te.stat_desc.static_tree,it=te.stat_desc.has_stree,xt=te.stat_desc.elems,Dt=-1;for(ie.heap_len=0,ie.heap_max=b,_e=0;_e<xt;_e++)We[2*_e]!==0?(ie.heap[++ie.heap_len]=Dt=_e,ie.depth[_e]=0):We[2*_e+1]=0;for(;ie.heap_len<2;)We[2*(Ee=ie.heap[++ie.heap_len]=Dt<2?++Dt:0)]=1,ie.depth[Ee]=0,ie.opt_len--,it&&(ie.static_len-=kt[2*Ee+1]);for(te.max_code=Dt,_e=ie.heap_len>>1;1<=_e;_e--)Qe(ie,We,_e);for(Ee=xt;_e=ie.heap[1],ie.heap[1]=ie.heap[ie.heap_len--],Qe(ie,We,1),Me=ie.heap[1],ie.heap[--ie.heap_max]=_e,ie.heap[--ie.heap_max]=Me,We[2*Ee]=We[2*_e]+We[2*Me],ie.depth[Ee]=(ie.depth[_e]>=ie.depth[Me]?ie.depth[_e]:ie.depth[Me])+1,We[2*_e+1]=We[2*Me+1]=Ee,ie.heap[1]=Ee++,Qe(ie,We,1),2<=ie.heap_len;);ie.heap[--ie.heap_max]=ie.heap[1],function(Ot,Wt){var be,I,G,fe,je,ve,Ce=Wt.dyn_tree,ce=Wt.max_code,ft=Wt.stat_desc.static_tree,vt=Wt.stat_desc.has_stree,M=Wt.stat_desc.extra_bits,Be=Wt.stat_desc.extra_base,nt=Wt.stat_desc.max_length,ye=0;for(fe=0;fe<=w;fe++)Ot.bl_count[fe]=0;for(Ce[2*Ot.heap[Ot.heap_max]+1]=0,be=Ot.heap_max+1;be<b;be++)nt<(fe=Ce[2*Ce[2*(I=Ot.heap[be])+1]+1]+1)&&(fe=nt,ye++),Ce[2*I+1]=fe,ce<I||(Ot.bl_count[fe]++,je=0,Be<=I&&(je=M[I-Be]),ve=Ce[2*I],Ot.opt_len+=ve*(fe+je),vt&&(Ot.static_len+=ve*(ft[2*I+1]+je)));if(ye!==0){do{for(fe=nt-1;Ot.bl_count[fe]===0;)fe--;Ot.bl_count[fe]--,Ot.bl_count[fe+1]+=2,Ot.bl_count[nt]--,ye-=2}while(0<ye);for(fe=nt;fe!==0;fe--)for(I=Ot.bl_count[fe];I!==0;)ce<(G=Ot.heap[--be])||(Ce[2*G+1]!==fe&&(Ot.opt_len+=(fe-Ce[2*G+1])*Ce[2*G],Ce[2*G+1]=fe),I--)}}(ie,te),Ne(We,Dt,ie.bl_count)}function V(ie,te,_e){var Me,Ee,We=-1,kt=te[1],it=0,xt=7,Dt=4;for(kt===0&&(xt=138,Dt=3),te[2*(_e+1)+1]=65535,Me=0;Me<=_e;Me++)Ee=kt,kt=te[2*(Me+1)+1],++it<xt&&Ee===kt||(it<Dt?ie.bl_tree[2*Ee]+=it:Ee!==0?(Ee!==We&&ie.bl_tree[2*Ee]++,ie.bl_tree[2*C]++):it<=10?ie.bl_tree[2*k]++:ie.bl_tree[2*R]++,We=Ee,Dt=(it=0)===kt?(xt=138,3):Ee===kt?(xt=6,3):(xt=7,4))}function ge(ie,te,_e){var Me,Ee,We=-1,kt=te[1],it=0,xt=7,Dt=4;for(kt===0&&(xt=138,Dt=3),Me=0;Me<=_e;Me++)if(Ee=kt,kt=te[2*(Me+1)+1],!(++it<xt&&Ee===kt)){if(it<Dt)for(;xe(ie,Ee,ie.bl_tree),--it!=0;);else Ee!==0?(Ee!==We&&(xe(ie,Ee,ie.bl_tree),it--),xe(ie,C,ie.bl_tree),me(ie,it-3,2)):it<=10?(xe(ie,k,ie.bl_tree),me(ie,it-3,3)):(xe(ie,R,ie.bl_tree),me(ie,it-11,7));We=Ee,Dt=(it=0)===kt?(xt=138,3):Ee===kt?(xt=6,3):(xt=7,4)}}l(ae);var Te=!1;function le(ie,te,_e,Me){me(ie,(u<<1)+(Me?1:0),3),function(Ee,We,kt,it){ke(Ee),oe(Ee,kt),oe(Ee,~kt),i.arraySet(Ee.pending_buf,Ee.window,We,kt,Ee.pending),Ee.pending+=kt}(ie,te,_e)}a._tr_init=function(ie){Te||(function(){var te,_e,Me,Ee,We,kt=new Array(w+1);for(Ee=Me=0;Ee<d-1;Ee++)for(de[Ee]=Me,te=0;te<1<<O[Ee];te++)q[Me++]=Ee;for(q[Me-1]=Ee,Ee=We=0;Ee<16;Ee++)for(ae[Ee]=We,te=0;te<1<<j[Ee];te++)K[We++]=Ee;for(We>>=7;Ee<y;Ee++)for(ae[Ee]=We<<7,te=0;te<1<<j[Ee]-7;te++)K[256+We++]=Ee;for(_e=0;_e<=w;_e++)kt[_e]=0;for(te=0;te<=143;)X[2*te+1]=8,te++,kt[8]++;for(;te<=255;)X[2*te+1]=9,te++,kt[9]++;for(;te<=279;)X[2*te+1]=7,te++,kt[7]++;for(;te<=287;)X[2*te+1]=8,te++,kt[8]++;for(Ne(X,p+1,kt),te=0;te<y;te++)F[2*te+1]=5,F[2*te]=Pe(te,5);re=new B(X,O,h+1,p,w),Y=new B(F,j,0,y,w),Q=new B(new Array(0),$,0,v,S)}(),Te=!0),ie.l_desc=new J(ie.dyn_ltree,re),ie.d_desc=new J(ie.dyn_dtree,Y),ie.bl_desc=new J(ie.bl_tree,Q),ie.bi_buf=0,ie.bi_valid=0,Re(ie)},a._tr_stored_block=le,a._tr_flush_block=function(ie,te,_e,Me){var Ee,We,kt=0;0<ie.level?(ie.strm.data_type===2&&(ie.strm.data_type=function(it){var xt,Dt=4093624447;for(xt=0;xt<=31;xt++,Dt>>>=1)if(1&Dt&&it.dyn_ltree[2*xt]!==0)return s;if(it.dyn_ltree[18]!==0||it.dyn_ltree[20]!==0||it.dyn_ltree[26]!==0)return o;for(xt=32;xt<h;xt++)if(it.dyn_ltree[2*xt]!==0)return o;return s}(ie)),Ie(ie,ie.l_desc),Ie(ie,ie.d_desc),kt=function(it){var xt;for(V(it,it.dyn_ltree,it.l_desc.max_code),V(it,it.dyn_dtree,it.d_desc.max_code),Ie(it,it.bl_desc),xt=v-1;3<=xt&&it.bl_tree[2*L[xt]+1]===0;xt--);return it.opt_len+=3*(xt+1)+5+5+4,xt}(ie),Ee=ie.opt_len+3+7>>>3,(We=ie.static_len+3+7>>>3)<=Ee&&(Ee=We)):Ee=We=_e+5,_e+4<=Ee&&te!==-1?le(ie,te,_e,Me):ie.strategy===4||We===Ee?(me(ie,2+(Me?1:0),3),Le(ie,X,F)):(me(ie,4+(Me?1:0),3),function(it,xt,Dt,Ot){var Wt;for(me(it,xt-257,5),me(it,Dt-1,5),me(it,Ot-4,4),Wt=0;Wt<Ot;Wt++)me(it,it.bl_tree[2*L[Wt]+1],3);ge(it,it.dyn_ltree,xt-1),ge(it,it.dyn_dtree,Dt-1)}(ie,ie.l_desc.max_code+1,ie.d_desc.max_code+1,kt+1),Le(ie,ie.dyn_ltree,ie.dyn_dtree)),Re(ie),Me&&ke(ie)},a._tr_tally=function(ie,te,_e){return ie.pending_buf[ie.d_buf+2*ie.last_lit]=te>>>8&255,ie.pending_buf[ie.d_buf+2*ie.last_lit+1]=255&te,ie.pending_buf[ie.l_buf+ie.last_lit]=255&_e,ie.last_lit++,te===0?ie.dyn_ltree[2*_e]++:(ie.matches++,te--,ie.dyn_ltree[2*(q[_e]+h+1)]++,ie.dyn_dtree[2*ee(te)]++),ie.last_lit===ie.lit_bufsize-1},a._tr_align=function(ie){me(ie,2,3),xe(ie,E,X),function(te){te.bi_valid===16?(oe(te,te.bi_buf),te.bi_buf=0,te.bi_valid=0):8<=te.bi_valid&&(te.pending_buf[te.pending++]=255&te.bi_buf,te.bi_buf>>=8,te.bi_valid-=8)}(ie)}},{"../utils/common":41}],53:[function(n,r,a){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,a){(function(i){(function(s,o){if(!s.setImmediate){var l,u,d,h,p=1,y={},v=!1,b=s.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(s);w=w&&w.setTimeout?w:s,l={}.toString.call(s.process)==="[object process]"?function(C){ea.nextTick(function(){S(C)})}:function(){if(s.postMessage&&!s.importScripts){var C=!0,k=s.onmessage;return s.onmessage=function(){C=!1},s.postMessage("","*"),s.onmessage=k,C}}()?(h="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",E,!1):s.attachEvent("onmessage",E),function(C){s.postMessage(h+C,"*")}):s.MessageChannel?((d=new MessageChannel).port1.onmessage=function(C){S(C.data)},function(C){d.port2.postMessage(C)}):b&&"onreadystatechange"in b.createElement("script")?(u=b.documentElement,function(C){var k=b.createElement("script");k.onreadystatechange=function(){S(C),k.onreadystatechange=null,u.removeChild(k),k=null},u.appendChild(k)}):function(C){setTimeout(S,0,C)},w.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var k=new Array(arguments.length-1),R=0;R<k.length;R++)k[R]=arguments[R+1];var O={callback:C,args:k};return y[p]=O,l(p),p++},w.clearImmediate=x}function x(C){delete y[C]}function S(C){if(v)setTimeout(S,0,C);else{var k=y[C];if(k){v=!0;try{(function(R){var O=R.callback,j=R.args;switch(j.length){case 0:O();break;case 1:O(j[0]);break;case 2:O(j[0],j[1]);break;case 3:O(j[0],j[1],j[2]);break;default:O.apply(o,j)}})(k)}finally{x(C),v=!1}}}}function E(C){C.source===s&&typeof C.data=="string"&&C.data.indexOf(h)===0&&S(+C.data.slice(h.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof wd<"u"?wd:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(YS)),YS.exports}var yne=gne();const KP=di(yne),Zv=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+a[i]},nr=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},Ko=(...e)=>nr(e.map(t=>t.trim()).filter(Boolean).join("/")),_0=e=>{const t=nr(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},ma=e=>{const t=nr(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},Ng=(e,t)=>nr(e==="/"?`/${t}`:`${e}/${t}`);var XS,Nj;function bne(){if(Nj)return XS;Nj=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof ea>"u"||typeof ea.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,a){if(Array.isArray(t))return this._acquireBatch(t,n,r,a);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,s=null,o=null;typeof r!="function"&&(a=r,r=null,o=new this.Promise(function(E,C){i=E,s=C})),a=a||{};var l=!1,u=null,d=null,h=null,p=this,y=function(E,C,k){d&&(clearTimeout(d),d=null),h&&(clearTimeout(h),h=null),E&&(p.queues[t]&&p.queues[t].length===0&&delete p.queues[t],p.domainReentrant&&delete p.domains[t]),l||(o?C?s(C):i(k):typeof r=="function"&&r(C,k),l=!0),E&&p.queues[t]&&p.queues[t].length>0&&p.queues[t].shift()()},v=function(E){if(l)return y(E);u&&(clearTimeout(u),u=null),p.domainReentrant&&E&&(p.domains[t]=ea.domain);var C=a.maxExecutionTime||p.maxExecutionTime;if(C&&(h=setTimeout(function(){p.queues[t]&&y(E,new Error("Maximum execution time is exceeded "+t))},C)),n.length===1){var k=!1;try{n(function(R,O){k||(k=!0,y(E,R,O))})}catch(R){k||(k=!0,y(E,R))}}else p._promiseTry(function(){return n()}).then(function(R){y(E,void 0,R)},function(R){y(E,R)})};p.domainReentrant&&ea.domain&&(v=ea.domain.bind(v));var b=a.maxPending||p.maxPending;if(!p.queues[t])p.queues[t]=[],v(!0);else if(p.domainReentrant&&ea.domain&&ea.domain===p.domains[t])v(!1);else if(p.queues[t].length>=b)y(!1,new Error("Too many pending tasks in queue "+t));else{var w=function(){v(!0)};a.skipQueue?p.queues[t].unshift(w):p.queues[t].push(w);var x=a.timeout||p.timeout;x&&(u=setTimeout(function(){u=null,y(!1,new Error("async-lock timed out in queue "+t))},x))}var S=a.maxOccupationTime||p.maxOccupationTime;if(S&&(d=setTimeout(function(){p.queues[t]&&y(!1,new Error("Maximum occupation time is exceeded in queue "+t))},S)),o)return o},e.prototype._acquireBatch=function(t,n,r,a){typeof r!="function"&&(a=r,r=null);var i=this,s=function(l,u){return function(d){i.acquire(l,u,d,a)}},o=t.reduceRight(function(l,u){return s(u,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,u){o.length===1?o(function(d,h){d?u(d):l(h)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},XS=e,XS}var JS,Rj;function vne(){return Rj||(Rj=1,JS=bne()),JS}var wne=vne();const Rg=di(wne);var Mb={exports:{}},Ij;function xne(){return Ij||(Ij=1,typeof Object.create=="function"?Mb.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Mb.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),Mb.exports}var QS,jj;function _ne(){if(jj)return QS;jj=1;var e=zk().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var a=this._block,i=this._blockSize,s=n.length,o=this._len,l=0;l<s;){for(var u=o%i,d=Math.min(s-l,i-u),h=0;h<d;h++)a[u+h]=n[l+h];o+=d,l+=d,o%i===0&&this._update(a)}return this._len+=s,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var i=(a&4294967295)>>>0,s=(a-i)/4294967296;this._block.writeUInt32BE(s,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},QS=t,QS}var eE,Oj;function Sne(){if(Oj)return eE;Oj=1;var e=xne(),t=_ne(),n=zk().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function i(){this.init(),this._w=a,t.call(this,64,56)}e(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function s(d){return d<<1|d>>>31}function o(d){return d<<5|d>>>27}function l(d){return d<<30|d>>>2}function u(d,h,p,y){return d===0?h&p|~h&y:d===2?h&p|h&y|p&y:h^p^y}return i.prototype._update=function(d){for(var h=this._w,p=this._a|0,y=this._b|0,v=this._c|0,b=this._d|0,w=this._e|0,x=0;x<16;++x)h[x]=d.readInt32BE(x*4);for(;x<80;++x)h[x]=s(h[x-3]^h[x-8]^h[x-14]^h[x-16]);for(var S=0;S<80;++S){var E=~~(S/20),C=o(p)+u(E,y,v,b)+w+h[S]+r[E]|0;w=b,b=v,v=l(y),y=p,p=C}this._a=p+this._a|0,this._b=y+this._b|0,this._c=v+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0},i.prototype._hash=function(){var d=n.allocUnsafe(20);return d.writeInt32BE(this._a|0,0),d.writeInt32BE(this._b|0,4),d.writeInt32BE(this._c|0,8),d.writeInt32BE(this._d|0,12),d.writeInt32BE(this._e|0,16),d},eE=i,eE}var Ene=Sne();const ZP=di(Ene);var tE,Dj;function Cne(){if(Dj)return tE;Dj=1;function e(a){if(typeof a!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(a))}function t(a,i){for(var s="",o=0,l=-1,u=0,d,h=0;h<=a.length;++h){if(h<a.length)d=a.charCodeAt(h);else{if(d===47)break;d=47}if(d===47){if(!(l===h-1||u===1))if(l!==h-1&&u===2){if(s.length<2||o!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){var p=s.lastIndexOf("/");if(p!==s.length-1){p===-1?(s="",o=0):(s=s.slice(0,p),o=s.length-1-s.lastIndexOf("/")),l=h,u=0;continue}}else if(s.length===2||s.length===1){s="",o=0,l=h,u=0;continue}}i&&(s.length>0?s+="/..":s="..",o=2)}else s.length>0?s+="/"+a.slice(l+1,h):s=a.slice(l+1,h),o=h-l-1;l=h,u=0}else d===46&&u!==-1?++u:u=-1}return s}function n(a,i){var s=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return s?s===i.root?s+o:s+a+o:o}var r={resolve:function(){for(var i="",s=!1,o,l=arguments.length-1;l>=-1&&!s;l--){var u;l>=0?u=arguments[l]:(o===void 0&&(o=ea.cwd()),u=o),e(u),u.length!==0&&(i=u+"/"+i,s=u.charCodeAt(0)===47)}return i=t(i,!s),s?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(e(i),i.length===0)return".";var s=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!s),i.length===0&&!s&&(i="."),i.length>0&&o&&(i+="/"),s?"/"+i:i},isAbsolute:function(i){return e(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,s=0;s<arguments.length;++s){var o=arguments[s];e(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":r.normalize(i)},relative:function(i,s){if(e(i),e(s),i===s||(i=r.resolve(i),s=r.resolve(s),i===s))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var l=i.length,u=l-o,d=1;d<s.length&&s.charCodeAt(d)===47;++d);for(var h=s.length,p=h-d,y=u<p?u:p,v=-1,b=0;b<=y;++b){if(b===y){if(p>y){if(s.charCodeAt(d+b)===47)return s.slice(d+b+1);if(b===0)return s.slice(d+b)}else u>y&&(i.charCodeAt(o+b)===47?v=b:b===0&&(v=0));break}var w=i.charCodeAt(o+b),x=s.charCodeAt(d+b);if(w!==x)break;w===47&&(v=b)}var S="";for(b=o+v+1;b<=l;++b)(b===l||i.charCodeAt(b)===47)&&(S.length===0?S+="..":S+="/..");return S.length>0?S+s.slice(d+v):(d+=v,s.charCodeAt(d)===47&&++d,s.slice(d))},_makeLong:function(i){return i},dirname:function(i){if(e(i),i.length===0)return".";for(var s=i.charCodeAt(0),o=s===47,l=-1,u=!0,d=i.length-1;d>=1;--d)if(s=i.charCodeAt(d),s===47){if(!u){l=d;break}}else u=!1;return l===-1?o?"/":".":o&&l===1?"//":i.slice(0,l)},basename:function(i,s){if(s!==void 0&&typeof s!="string")throw new TypeError('"ext" argument must be a string');e(i);var o=0,l=-1,u=!0,d;if(s!==void 0&&s.length>0&&s.length<=i.length){if(s.length===i.length&&s===i)return"";var h=s.length-1,p=-1;for(d=i.length-1;d>=0;--d){var y=i.charCodeAt(d);if(y===47){if(!u){o=d+1;break}}else p===-1&&(u=!1,p=d+1),h>=0&&(y===s.charCodeAt(h)?--h===-1&&(l=d):(h=-1,l=p))}return o===l?l=p:l===-1&&(l=i.length),i.slice(o,l)}else{for(d=i.length-1;d>=0;--d)if(i.charCodeAt(d)===47){if(!u){o=d+1;break}}else l===-1&&(u=!1,l=d+1);return l===-1?"":i.slice(o,l)}},extname:function(i){e(i);for(var s=-1,o=0,l=-1,u=!0,d=0,h=i.length-1;h>=0;--h){var p=i.charCodeAt(h);if(p===47){if(!u){o=h+1;break}continue}l===-1&&(u=!1,l=h+1),p===46?s===-1?s=h:d!==1&&(d=1):s!==-1&&(d=-1)}return s===-1||l===-1||d===0||d===1&&s===l-1&&s===o+1?"":i.slice(s,l)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return n("/",i)},parse:function(i){e(i);var s={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return s;var o=i.charCodeAt(0),l=o===47,u;l?(s.root="/",u=1):u=0;for(var d=-1,h=0,p=-1,y=!0,v=i.length-1,b=0;v>=u;--v){if(o=i.charCodeAt(v),o===47){if(!y){h=v+1;break}continue}p===-1&&(y=!1,p=v+1),o===46?d===-1?d=v:b!==1&&(b=1):d!==-1&&(b=-1)}return d===-1||p===-1||b===0||b===1&&d===p-1&&d===h+1?p!==-1&&(h===0&&l?s.base=s.name=i.slice(1,p):s.base=s.name=i.slice(h,p)):(h===0&&l?(s.name=i.slice(1,d),s.base=i.slice(1,p)):(s.name=i.slice(h,d),s.base=i.slice(h,p)),s.ext=i.slice(d,p)),h>0?s.dir=i.slice(0,h-1):l&&(s.dir="/"),s},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,tE=r,tE}var jt=Cne(),nE={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var Mj;function kne(){return Mj||(Mj=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var j=0,$=new Array(256),L=0;L!=256;++L)j=L,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,$[L]=j;return typeof Int32Array<"u"?new Int32Array($):$}var r=n();function a(j){var $=0,L=0,X=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)F[X]=j[X];for(X=0;X!=256;++X)for(L=j[X],$=256+X;$<4096;$+=256)L=F[$]=L>>>8^j[L&255];var K=[];for(X=1;X!=16;++X)K[X-1]=typeof Int32Array<"u"?F.subarray(X*256,X*256+256):F.slice(X*256,X*256+256);return K}var i=a(r),s=i[0],o=i[1],l=i[2],u=i[3],d=i[4],h=i[5],p=i[6],y=i[7],v=i[8],b=i[9],w=i[10],x=i[11],S=i[12],E=i[13],C=i[14];function k(j,$){for(var L=$^-1,X=0,F=j.length;X<F;)L=L>>>8^r[(L^j.charCodeAt(X++))&255];return~L}function R(j,$){for(var L=$^-1,X=j.length-15,F=0;F<X;)L=C[j[F++]^L&255]^E[j[F++]^L>>8&255]^S[j[F++]^L>>16&255]^x[j[F++]^L>>>24]^w[j[F++]]^b[j[F++]]^v[j[F++]]^y[j[F++]]^p[j[F++]]^h[j[F++]]^d[j[F++]]^u[j[F++]]^l[j[F++]]^o[j[F++]]^s[j[F++]]^r[j[F++]];for(X+=15;F<X;)L=L>>>8^r[(L^j[F++])&255];return~L}function O(j,$){for(var L=$^-1,X=0,F=j.length,K=0,q=0;X<F;)K=j.charCodeAt(X++),K<128?L=L>>>8^r[(L^K)&255]:K<2048?(L=L>>>8^r[(L^(192|K>>6&31))&255],L=L>>>8^r[(L^(128|K&63))&255]):K>=55296&&K<57344?(K=(K&1023)+64,q=j.charCodeAt(X++)&1023,L=L>>>8^r[(L^(240|K>>8&7))&255],L=L>>>8^r[(L^(128|K>>2&63))&255],L=L>>>8^r[(L^(128|q>>6&15|(K&3)<<4))&255],L=L>>>8^r[(L^(128|q&63))&255]):(L=L>>>8^r[(L^(224|K>>12&15))&255],L=L>>>8^r[(L^(128|K>>6&63))&255],L=L>>>8^r[(L^(128|K&63))&255]);return~L}t.table=r,t.bstr=k,t.buf=R,t.str=O})}(nE)),nE}var Tne=kne();const Ane=di(Tne);var rE={},Pj;function Tu(){return Pj||(Pj=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(i,s){return Object.prototype.hasOwnProperty.call(i,s)}e.assign=function(i){for(var s=Array.prototype.slice.call(arguments,1);s.length;){var o=s.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(i[l]=o[l])}}return i},e.shrinkBuf=function(i,s){return i.length===s?i:i.subarray?i.subarray(0,s):(i.length=s,i)};var r={arraySet:function(i,s,o,l,u){if(s.subarray&&i.subarray){i.set(s.subarray(o,o+l),u);return}for(var d=0;d<l;d++)i[u+d]=s[o+d]},flattenChunks:function(i){var s,o,l,u,d,h;for(l=0,s=0,o=i.length;s<o;s++)l+=i[s].length;for(h=new Uint8Array(l),u=0,s=0,o=i.length;s<o;s++)d=i[s],h.set(d,u),u+=d.length;return h}},a={arraySet:function(i,s,o,l,u){for(var d=0;d<l;d++)i[u+d]=s[o+d]},flattenChunks:function(i){return[].concat.apply([],i)}};e.setTyped=function(i){i?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(t)}(rE)),rE}var th={},$s={},hd={},Fj;function Nne(){if(Fj)return hd;Fj=1;var e=Tu(),t=4,n=0,r=1,a=2;function i(I){for(var G=I.length;--G>=0;)I[G]=0}var s=0,o=1,l=2,u=3,d=258,h=29,p=256,y=p+1+h,v=30,b=19,w=2*y+1,x=15,S=16,E=7,C=256,k=16,R=17,O=18,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=512,K=new Array((y+2)*2);i(K);var q=new Array(v*2);i(q);var de=new Array(F);i(de);var re=new Array(d-u+1);i(re);var Y=new Array(h);i(Y);var Q=new Array(v);i(Q);function ae(I,G,fe,je,ve){this.static_tree=I,this.extra_bits=G,this.extra_base=fe,this.elems=je,this.max_length=ve,this.has_stree=I&&I.length}var B,J,ee;function oe(I,G){this.dyn_tree=I,this.max_code=0,this.stat_desc=G}function me(I){return I<256?de[I]:de[256+(I>>>7)]}function xe(I,G){I.pending_buf[I.pending++]=G&255,I.pending_buf[I.pending++]=G>>>8&255}function Pe(I,G,fe){I.bi_valid>S-fe?(I.bi_buf|=G<<I.bi_valid&65535,xe(I,I.bi_buf),I.bi_buf=G>>S-I.bi_valid,I.bi_valid+=fe-S):(I.bi_buf|=G<<I.bi_valid&65535,I.bi_valid+=fe)}function Ne(I,G,fe){Pe(I,fe[G*2],fe[G*2+1])}function Re(I,G){var fe=0;do fe|=I&1,I>>>=1,fe<<=1;while(--G>0);return fe>>>1}function ke(I){I.bi_valid===16?(xe(I,I.bi_buf),I.bi_buf=0,I.bi_valid=0):I.bi_valid>=8&&(I.pending_buf[I.pending++]=I.bi_buf&255,I.bi_buf>>=8,I.bi_valid-=8)}function Fe(I,G){var fe=G.dyn_tree,je=G.max_code,ve=G.stat_desc.static_tree,Ce=G.stat_desc.has_stree,ce=G.stat_desc.extra_bits,ft=G.stat_desc.extra_base,vt=G.stat_desc.max_length,M,Be,nt,ye,Oe,Ke,Rt=0;for(ye=0;ye<=x;ye++)I.bl_count[ye]=0;for(fe[I.heap[I.heap_max]*2+1]=0,M=I.heap_max+1;M<w;M++)Be=I.heap[M],ye=fe[fe[Be*2+1]*2+1]+1,ye>vt&&(ye=vt,Rt++),fe[Be*2+1]=ye,!(Be>je)&&(I.bl_count[ye]++,Oe=0,Be>=ft&&(Oe=ce[Be-ft]),Ke=fe[Be*2],I.opt_len+=Ke*(ye+Oe),Ce&&(I.static_len+=Ke*(ve[Be*2+1]+Oe)));if(Rt!==0){do{for(ye=vt-1;I.bl_count[ye]===0;)ye--;I.bl_count[ye]--,I.bl_count[ye+1]+=2,I.bl_count[vt]--,Rt-=2}while(Rt>0);for(ye=vt;ye!==0;ye--)for(Be=I.bl_count[ye];Be!==0;)nt=I.heap[--M],!(nt>je)&&(fe[nt*2+1]!==ye&&(I.opt_len+=(ye-fe[nt*2+1])*fe[nt*2],fe[nt*2+1]=ye),Be--)}}function Qe(I,G,fe){var je=new Array(x+1),ve=0,Ce,ce;for(Ce=1;Ce<=x;Ce++)je[Ce]=ve=ve+fe[Ce-1]<<1;for(ce=0;ce<=G;ce++){var ft=I[ce*2+1];ft!==0&&(I[ce*2]=Re(je[ft]++,ft))}}function Le(){var I,G,fe,je,ve,Ce=new Array(x+1);for(fe=0,je=0;je<h-1;je++)for(Y[je]=fe,I=0;I<1<<j[je];I++)re[fe++]=je;for(re[fe-1]=je,ve=0,je=0;je<16;je++)for(Q[je]=ve,I=0;I<1<<$[je];I++)de[ve++]=je;for(ve>>=7;je<v;je++)for(Q[je]=ve<<7,I=0;I<1<<$[je]-7;I++)de[256+ve++]=je;for(G=0;G<=x;G++)Ce[G]=0;for(I=0;I<=143;)K[I*2+1]=8,I++,Ce[8]++;for(;I<=255;)K[I*2+1]=9,I++,Ce[9]++;for(;I<=279;)K[I*2+1]=7,I++,Ce[7]++;for(;I<=287;)K[I*2+1]=8,I++,Ce[8]++;for(Qe(K,y+1,Ce),I=0;I<v;I++)q[I*2+1]=5,q[I*2]=Re(I,5);B=new ae(K,j,p+1,y,x),J=new ae(q,$,0,v,x),ee=new ae(new Array(0),L,0,b,E)}function Ie(I){var G;for(G=0;G<y;G++)I.dyn_ltree[G*2]=0;for(G=0;G<v;G++)I.dyn_dtree[G*2]=0;for(G=0;G<b;G++)I.bl_tree[G*2]=0;I.dyn_ltree[C*2]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function V(I){I.bi_valid>8?xe(I,I.bi_buf):I.bi_valid>0&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function ge(I,G,fe,je){V(I),xe(I,fe),xe(I,~fe),e.arraySet(I.pending_buf,I.window,G,fe,I.pending),I.pending+=fe}function Te(I,G,fe,je){var ve=G*2,Ce=fe*2;return I[ve]<I[Ce]||I[ve]===I[Ce]&&je[G]<=je[fe]}function le(I,G,fe){for(var je=I.heap[fe],ve=fe<<1;ve<=I.heap_len&&(ve<I.heap_len&&Te(G,I.heap[ve+1],I.heap[ve],I.depth)&&ve++,!Te(G,je,I.heap[ve],I.depth));)I.heap[fe]=I.heap[ve],fe=ve,ve<<=1;I.heap[fe]=je}function ie(I,G,fe){var je,ve,Ce=0,ce,ft;if(I.last_lit!==0)do je=I.pending_buf[I.d_buf+Ce*2]<<8|I.pending_buf[I.d_buf+Ce*2+1],ve=I.pending_buf[I.l_buf+Ce],Ce++,je===0?Ne(I,ve,G):(ce=re[ve],Ne(I,ce+p+1,G),ft=j[ce],ft!==0&&(ve-=Y[ce],Pe(I,ve,ft)),je--,ce=me(je),Ne(I,ce,fe),ft=$[ce],ft!==0&&(je-=Q[ce],Pe(I,je,ft)));while(Ce<I.last_lit);Ne(I,C,G)}function te(I,G){var fe=G.dyn_tree,je=G.stat_desc.static_tree,ve=G.stat_desc.has_stree,Ce=G.stat_desc.elems,ce,ft,vt=-1,M;for(I.heap_len=0,I.heap_max=w,ce=0;ce<Ce;ce++)fe[ce*2]!==0?(I.heap[++I.heap_len]=vt=ce,I.depth[ce]=0):fe[ce*2+1]=0;for(;I.heap_len<2;)M=I.heap[++I.heap_len]=vt<2?++vt:0,fe[M*2]=1,I.depth[M]=0,I.opt_len--,ve&&(I.static_len-=je[M*2+1]);for(G.max_code=vt,ce=I.heap_len>>1;ce>=1;ce--)le(I,fe,ce);M=Ce;do ce=I.heap[1],I.heap[1]=I.heap[I.heap_len--],le(I,fe,1),ft=I.heap[1],I.heap[--I.heap_max]=ce,I.heap[--I.heap_max]=ft,fe[M*2]=fe[ce*2]+fe[ft*2],I.depth[M]=(I.depth[ce]>=I.depth[ft]?I.depth[ce]:I.depth[ft])+1,fe[ce*2+1]=fe[ft*2+1]=M,I.heap[1]=M++,le(I,fe,1);while(I.heap_len>=2);I.heap[--I.heap_max]=I.heap[1],Fe(I,G),Qe(fe,vt,I.bl_count)}function _e(I,G,fe){var je,ve=-1,Ce,ce=G[0*2+1],ft=0,vt=7,M=4;for(ce===0&&(vt=138,M=3),G[(fe+1)*2+1]=65535,je=0;je<=fe;je++)Ce=ce,ce=G[(je+1)*2+1],!(++ft<vt&&Ce===ce)&&(ft<M?I.bl_tree[Ce*2]+=ft:Ce!==0?(Ce!==ve&&I.bl_tree[Ce*2]++,I.bl_tree[k*2]++):ft<=10?I.bl_tree[R*2]++:I.bl_tree[O*2]++,ft=0,ve=Ce,ce===0?(vt=138,M=3):Ce===ce?(vt=6,M=3):(vt=7,M=4))}function Me(I,G,fe){var je,ve=-1,Ce,ce=G[0*2+1],ft=0,vt=7,M=4;for(ce===0&&(vt=138,M=3),je=0;je<=fe;je++)if(Ce=ce,ce=G[(je+1)*2+1],!(++ft<vt&&Ce===ce)){if(ft<M)do Ne(I,Ce,I.bl_tree);while(--ft!==0);else Ce!==0?(Ce!==ve&&(Ne(I,Ce,I.bl_tree),ft--),Ne(I,k,I.bl_tree),Pe(I,ft-3,2)):ft<=10?(Ne(I,R,I.bl_tree),Pe(I,ft-3,3)):(Ne(I,O,I.bl_tree),Pe(I,ft-11,7));ft=0,ve=Ce,ce===0?(vt=138,M=3):Ce===ce?(vt=6,M=3):(vt=7,M=4)}}function Ee(I){var G;for(_e(I,I.dyn_ltree,I.l_desc.max_code),_e(I,I.dyn_dtree,I.d_desc.max_code),te(I,I.bl_desc),G=b-1;G>=3&&I.bl_tree[X[G]*2+1]===0;G--);return I.opt_len+=3*(G+1)+5+5+4,G}function We(I,G,fe,je){var ve;for(Pe(I,G-257,5),Pe(I,fe-1,5),Pe(I,je-4,4),ve=0;ve<je;ve++)Pe(I,I.bl_tree[X[ve]*2+1],3);Me(I,I.dyn_ltree,G-1),Me(I,I.dyn_dtree,fe-1)}function kt(I){var G=4093624447,fe;for(fe=0;fe<=31;fe++,G>>>=1)if(G&1&&I.dyn_ltree[fe*2]!==0)return n;if(I.dyn_ltree[9*2]!==0||I.dyn_ltree[10*2]!==0||I.dyn_ltree[13*2]!==0)return r;for(fe=32;fe<p;fe++)if(I.dyn_ltree[fe*2]!==0)return r;return n}var it=!1;function xt(I){it||(Le(),it=!0),I.l_desc=new oe(I.dyn_ltree,B),I.d_desc=new oe(I.dyn_dtree,J),I.bl_desc=new oe(I.bl_tree,ee),I.bi_buf=0,I.bi_valid=0,Ie(I)}function Dt(I,G,fe,je){Pe(I,(s<<1)+(je?1:0),3),ge(I,G,fe)}function Ot(I){Pe(I,o<<1,3),Ne(I,C,K),ke(I)}function Wt(I,G,fe,je){var ve,Ce,ce=0;I.level>0?(I.strm.data_type===a&&(I.strm.data_type=kt(I)),te(I,I.l_desc),te(I,I.d_desc),ce=Ee(I),ve=I.opt_len+3+7>>>3,Ce=I.static_len+3+7>>>3,Ce<=ve&&(ve=Ce)):ve=Ce=fe+5,fe+4<=ve&&G!==-1?Dt(I,G,fe,je):I.strategy===t||Ce===ve?(Pe(I,(o<<1)+(je?1:0),3),ie(I,K,q)):(Pe(I,(l<<1)+(je?1:0),3),We(I,I.l_desc.max_code+1,I.d_desc.max_code+1,ce+1),ie(I,I.dyn_ltree,I.dyn_dtree)),Ie(I),je&&V(I)}function be(I,G,fe){return I.pending_buf[I.d_buf+I.last_lit*2]=G>>>8&255,I.pending_buf[I.d_buf+I.last_lit*2+1]=G&255,I.pending_buf[I.l_buf+I.last_lit]=fe&255,I.last_lit++,G===0?I.dyn_ltree[fe*2]++:(I.matches++,G--,I.dyn_ltree[(re[fe]+p+1)*2]++,I.dyn_dtree[me(G)*2]++),I.last_lit===I.lit_bufsize-1}return hd._tr_init=xt,hd._tr_stored_block=Dt,hd._tr_flush_block=Wt,hd._tr_tally=be,hd._tr_align=Ot,hd}var aE,Lj;function YP(){if(Lj)return aE;Lj=1;function e(t,n,r,a){for(var i=t&65535|0,s=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+n[a++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0}return aE=e,aE}var iE,$j;function XP(){if($j)return iE;$j=1;function e(){for(var r,a=[],i=0;i<256;i++){r=i;for(var s=0;s<8;s++)r=r&1?3988292384^r>>>1:r>>>1;a[i]=r}return a}var t=e();function n(r,a,i,s){var o=t,l=s+i;r^=-1;for(var u=s;u<l;u++)r=r>>>8^o[(r^a[u])&255];return r^-1}return iE=n,iE}var sE,Bj;function Jk(){return Bj||(Bj=1,sE={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),sE}var zj;function Rne(){if(zj)return $s;zj=1;var e=Tu(),t=Nne(),n=YP(),r=XP(),a=Jk(),i=0,s=1,o=3,l=4,u=5,d=0,h=1,p=-2,y=-3,v=-5,b=-1,w=1,x=2,S=3,E=4,C=0,k=2,R=8,O=9,j=15,$=8,L=29,X=256,F=X+1+L,K=30,q=19,de=2*F+1,re=15,Y=3,Q=258,ae=Q+Y+1,B=32,J=42,ee=69,oe=73,me=91,xe=103,Pe=113,Ne=666,Re=1,ke=2,Fe=3,Qe=4,Le=3;function Ie(M,Be){return M.msg=a[Be],Be}function V(M){return(M<<1)-(M>4?9:0)}function ge(M){for(var Be=M.length;--Be>=0;)M[Be]=0}function Te(M){var Be=M.state,nt=Be.pending;nt>M.avail_out&&(nt=M.avail_out),nt!==0&&(e.arraySet(M.output,Be.pending_buf,Be.pending_out,nt,M.next_out),M.next_out+=nt,Be.pending_out+=nt,M.total_out+=nt,M.avail_out-=nt,Be.pending-=nt,Be.pending===0&&(Be.pending_out=0))}function le(M,Be){t._tr_flush_block(M,M.block_start>=0?M.block_start:-1,M.strstart-M.block_start,Be),M.block_start=M.strstart,Te(M.strm)}function ie(M,Be){M.pending_buf[M.pending++]=Be}function te(M,Be){M.pending_buf[M.pending++]=Be>>>8&255,M.pending_buf[M.pending++]=Be&255}function _e(M,Be,nt,ye){var Oe=M.avail_in;return Oe>ye&&(Oe=ye),Oe===0?0:(M.avail_in-=Oe,e.arraySet(Be,M.input,M.next_in,Oe,nt),M.state.wrap===1?M.adler=n(M.adler,Be,Oe,nt):M.state.wrap===2&&(M.adler=r(M.adler,Be,Oe,nt)),M.next_in+=Oe,M.total_in+=Oe,Oe)}function Me(M,Be){var nt=M.max_chain_length,ye=M.strstart,Oe,Ke,Rt=M.prev_length,pe=M.nice_match,H=M.strstart>M.w_size-ae?M.strstart-(M.w_size-ae):0,U=M.window,W=M.w_mask,he=M.prev,Ae=M.strstart+Q,qe=U[ye+Rt-1],pt=U[ye+Rt];M.prev_length>=M.good_match&&(nt>>=2),pe>M.lookahead&&(pe=M.lookahead);do if(Oe=Be,!(U[Oe+Rt]!==pt||U[Oe+Rt-1]!==qe||U[Oe]!==U[ye]||U[++Oe]!==U[ye+1])){ye+=2,Oe++;do;while(U[++ye]===U[++Oe]&&U[++ye]===U[++Oe]&&U[++ye]===U[++Oe]&&U[++ye]===U[++Oe]&&U[++ye]===U[++Oe]&&U[++ye]===U[++Oe]&&U[++ye]===U[++Oe]&&U[++ye]===U[++Oe]&&ye<Ae);if(Ke=Q-(Ae-ye),ye=Ae-Q,Ke>Rt){if(M.match_start=Be,Rt=Ke,Ke>=pe)break;qe=U[ye+Rt-1],pt=U[ye+Rt]}}while((Be=he[Be&W])>H&&--nt!==0);return Rt<=M.lookahead?Rt:M.lookahead}function Ee(M){var Be=M.w_size,nt,ye,Oe,Ke,Rt;do{if(Ke=M.window_size-M.lookahead-M.strstart,M.strstart>=Be+(Be-ae)){e.arraySet(M.window,M.window,Be,Be,0),M.match_start-=Be,M.strstart-=Be,M.block_start-=Be,ye=M.hash_size,nt=ye;do Oe=M.head[--nt],M.head[nt]=Oe>=Be?Oe-Be:0;while(--ye);ye=Be,nt=ye;do Oe=M.prev[--nt],M.prev[nt]=Oe>=Be?Oe-Be:0;while(--ye);Ke+=Be}if(M.strm.avail_in===0)break;if(ye=_e(M.strm,M.window,M.strstart+M.lookahead,Ke),M.lookahead+=ye,M.lookahead+M.insert>=Y)for(Rt=M.strstart-M.insert,M.ins_h=M.window[Rt],M.ins_h=(M.ins_h<<M.hash_shift^M.window[Rt+1])&M.hash_mask;M.insert&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[Rt+Y-1])&M.hash_mask,M.prev[Rt&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=Rt,Rt++,M.insert--,!(M.lookahead+M.insert<Y)););}while(M.lookahead<ae&&M.strm.avail_in!==0)}function We(M,Be){var nt=65535;for(nt>M.pending_buf_size-5&&(nt=M.pending_buf_size-5);;){if(M.lookahead<=1){if(Ee(M),M.lookahead===0&&Be===i)return Re;if(M.lookahead===0)break}M.strstart+=M.lookahead,M.lookahead=0;var ye=M.block_start+nt;if((M.strstart===0||M.strstart>=ye)&&(M.lookahead=M.strstart-ye,M.strstart=ye,le(M,!1),M.strm.avail_out===0)||M.strstart-M.block_start>=M.w_size-ae&&(le(M,!1),M.strm.avail_out===0))return Re}return M.insert=0,Be===l?(le(M,!0),M.strm.avail_out===0?Fe:Qe):(M.strstart>M.block_start&&(le(M,!1),M.strm.avail_out===0),Re)}function kt(M,Be){for(var nt,ye;;){if(M.lookahead<ae){if(Ee(M),M.lookahead<ae&&Be===i)return Re;if(M.lookahead===0)break}if(nt=0,M.lookahead>=Y&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+Y-1])&M.hash_mask,nt=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),nt!==0&&M.strstart-nt<=M.w_size-ae&&(M.match_length=Me(M,nt)),M.match_length>=Y)if(ye=t._tr_tally(M,M.strstart-M.match_start,M.match_length-Y),M.lookahead-=M.match_length,M.match_length<=M.max_lazy_match&&M.lookahead>=Y){M.match_length--;do M.strstart++,M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+Y-1])&M.hash_mask,nt=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart;while(--M.match_length!==0);M.strstart++}else M.strstart+=M.match_length,M.match_length=0,M.ins_h=M.window[M.strstart],M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+1])&M.hash_mask;else ye=t._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++;if(ye&&(le(M,!1),M.strm.avail_out===0))return Re}return M.insert=M.strstart<Y-1?M.strstart:Y-1,Be===l?(le(M,!0),M.strm.avail_out===0?Fe:Qe):M.last_lit&&(le(M,!1),M.strm.avail_out===0)?Re:ke}function it(M,Be){for(var nt,ye,Oe;;){if(M.lookahead<ae){if(Ee(M),M.lookahead<ae&&Be===i)return Re;if(M.lookahead===0)break}if(nt=0,M.lookahead>=Y&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+Y-1])&M.hash_mask,nt=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),M.prev_length=M.match_length,M.prev_match=M.match_start,M.match_length=Y-1,nt!==0&&M.prev_length<M.max_lazy_match&&M.strstart-nt<=M.w_size-ae&&(M.match_length=Me(M,nt),M.match_length<=5&&(M.strategy===w||M.match_length===Y&&M.strstart-M.match_start>4096)&&(M.match_length=Y-1)),M.prev_length>=Y&&M.match_length<=M.prev_length){Oe=M.strstart+M.lookahead-Y,ye=t._tr_tally(M,M.strstart-1-M.prev_match,M.prev_length-Y),M.lookahead-=M.prev_length-1,M.prev_length-=2;do++M.strstart<=Oe&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+Y-1])&M.hash_mask,nt=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart);while(--M.prev_length!==0);if(M.match_available=0,M.match_length=Y-1,M.strstart++,ye&&(le(M,!1),M.strm.avail_out===0))return Re}else if(M.match_available){if(ye=t._tr_tally(M,0,M.window[M.strstart-1]),ye&&le(M,!1),M.strstart++,M.lookahead--,M.strm.avail_out===0)return Re}else M.match_available=1,M.strstart++,M.lookahead--}return M.match_available&&(ye=t._tr_tally(M,0,M.window[M.strstart-1]),M.match_available=0),M.insert=M.strstart<Y-1?M.strstart:Y-1,Be===l?(le(M,!0),M.strm.avail_out===0?Fe:Qe):M.last_lit&&(le(M,!1),M.strm.avail_out===0)?Re:ke}function xt(M,Be){for(var nt,ye,Oe,Ke,Rt=M.window;;){if(M.lookahead<=Q){if(Ee(M),M.lookahead<=Q&&Be===i)return Re;if(M.lookahead===0)break}if(M.match_length=0,M.lookahead>=Y&&M.strstart>0&&(Oe=M.strstart-1,ye=Rt[Oe],ye===Rt[++Oe]&&ye===Rt[++Oe]&&ye===Rt[++Oe])){Ke=M.strstart+Q;do;while(ye===Rt[++Oe]&&ye===Rt[++Oe]&&ye===Rt[++Oe]&&ye===Rt[++Oe]&&ye===Rt[++Oe]&&ye===Rt[++Oe]&&ye===Rt[++Oe]&&ye===Rt[++Oe]&&Oe<Ke);M.match_length=Q-(Ke-Oe),M.match_length>M.lookahead&&(M.match_length=M.lookahead)}if(M.match_length>=Y?(nt=t._tr_tally(M,1,M.match_length-Y),M.lookahead-=M.match_length,M.strstart+=M.match_length,M.match_length=0):(nt=t._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++),nt&&(le(M,!1),M.strm.avail_out===0))return Re}return M.insert=0,Be===l?(le(M,!0),M.strm.avail_out===0?Fe:Qe):M.last_lit&&(le(M,!1),M.strm.avail_out===0)?Re:ke}function Dt(M,Be){for(var nt;;){if(M.lookahead===0&&(Ee(M),M.lookahead===0)){if(Be===i)return Re;break}if(M.match_length=0,nt=t._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++,nt&&(le(M,!1),M.strm.avail_out===0))return Re}return M.insert=0,Be===l?(le(M,!0),M.strm.avail_out===0?Fe:Qe):M.last_lit&&(le(M,!1),M.strm.avail_out===0)?Re:ke}function Ot(M,Be,nt,ye,Oe){this.good_length=M,this.max_lazy=Be,this.nice_length=nt,this.max_chain=ye,this.func=Oe}var Wt;Wt=[new Ot(0,0,0,0,We),new Ot(4,4,8,4,kt),new Ot(4,5,16,8,kt),new Ot(4,6,32,32,kt),new Ot(4,4,16,16,it),new Ot(8,16,32,32,it),new Ot(8,16,128,128,it),new Ot(8,32,128,256,it),new Ot(32,128,258,1024,it),new Ot(32,258,258,4096,it)];function be(M){M.window_size=2*M.w_size,ge(M.head),M.max_lazy_match=Wt[M.level].max_lazy,M.good_match=Wt[M.level].good_length,M.nice_match=Wt[M.level].nice_length,M.max_chain_length=Wt[M.level].max_chain,M.strstart=0,M.block_start=0,M.lookahead=0,M.insert=0,M.match_length=M.prev_length=Y-1,M.match_available=0,M.ins_h=0}function I(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(de*2),this.dyn_dtree=new e.Buf16((2*K+1)*2),this.bl_tree=new e.Buf16((2*q+1)*2),ge(this.dyn_ltree),ge(this.dyn_dtree),ge(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(re+1),this.heap=new e.Buf16(2*F+1),ge(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*F+1),ge(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(M){var Be;return!M||!M.state?Ie(M,p):(M.total_in=M.total_out=0,M.data_type=k,Be=M.state,Be.pending=0,Be.pending_out=0,Be.wrap<0&&(Be.wrap=-Be.wrap),Be.status=Be.wrap?J:Pe,M.adler=Be.wrap===2?0:1,Be.last_flush=i,t._tr_init(Be),d)}function fe(M){var Be=G(M);return Be===d&&be(M.state),Be}function je(M,Be){return!M||!M.state||M.state.wrap!==2?p:(M.state.gzhead=Be,d)}function ve(M,Be,nt,ye,Oe,Ke){if(!M)return p;var Rt=1;if(Be===b&&(Be=6),ye<0?(Rt=0,ye=-ye):ye>15&&(Rt=2,ye-=16),Oe<1||Oe>O||nt!==R||ye<8||ye>15||Be<0||Be>9||Ke<0||Ke>E)return Ie(M,p);ye===8&&(ye=9);var pe=new I;return M.state=pe,pe.strm=M,pe.wrap=Rt,pe.gzhead=null,pe.w_bits=ye,pe.w_size=1<<pe.w_bits,pe.w_mask=pe.w_size-1,pe.hash_bits=Oe+7,pe.hash_size=1<<pe.hash_bits,pe.hash_mask=pe.hash_size-1,pe.hash_shift=~~((pe.hash_bits+Y-1)/Y),pe.window=new e.Buf8(pe.w_size*2),pe.head=new e.Buf16(pe.hash_size),pe.prev=new e.Buf16(pe.w_size),pe.lit_bufsize=1<<Oe+6,pe.pending_buf_size=pe.lit_bufsize*4,pe.pending_buf=new e.Buf8(pe.pending_buf_size),pe.d_buf=1*pe.lit_bufsize,pe.l_buf=3*pe.lit_bufsize,pe.level=Be,pe.strategy=Ke,pe.method=nt,fe(M)}function Ce(M,Be){return ve(M,Be,R,j,$,C)}function ce(M,Be){var nt,ye,Oe,Ke;if(!M||!M.state||Be>u||Be<0)return M?Ie(M,p):p;if(ye=M.state,!M.output||!M.input&&M.avail_in!==0||ye.status===Ne&&Be!==l)return Ie(M,M.avail_out===0?v:p);if(ye.strm=M,nt=ye.last_flush,ye.last_flush=Be,ye.status===J)if(ye.wrap===2)M.adler=0,ie(ye,31),ie(ye,139),ie(ye,8),ye.gzhead?(ie(ye,(ye.gzhead.text?1:0)+(ye.gzhead.hcrc?2:0)+(ye.gzhead.extra?4:0)+(ye.gzhead.name?8:0)+(ye.gzhead.comment?16:0)),ie(ye,ye.gzhead.time&255),ie(ye,ye.gzhead.time>>8&255),ie(ye,ye.gzhead.time>>16&255),ie(ye,ye.gzhead.time>>24&255),ie(ye,ye.level===9?2:ye.strategy>=x||ye.level<2?4:0),ie(ye,ye.gzhead.os&255),ye.gzhead.extra&&ye.gzhead.extra.length&&(ie(ye,ye.gzhead.extra.length&255),ie(ye,ye.gzhead.extra.length>>8&255)),ye.gzhead.hcrc&&(M.adler=r(M.adler,ye.pending_buf,ye.pending,0)),ye.gzindex=0,ye.status=ee):(ie(ye,0),ie(ye,0),ie(ye,0),ie(ye,0),ie(ye,0),ie(ye,ye.level===9?2:ye.strategy>=x||ye.level<2?4:0),ie(ye,Le),ye.status=Pe);else{var Rt=R+(ye.w_bits-8<<4)<<8,pe=-1;ye.strategy>=x||ye.level<2?pe=0:ye.level<6?pe=1:ye.level===6?pe=2:pe=3,Rt|=pe<<6,ye.strstart!==0&&(Rt|=B),Rt+=31-Rt%31,ye.status=Pe,te(ye,Rt),ye.strstart!==0&&(te(ye,M.adler>>>16),te(ye,M.adler&65535)),M.adler=1}if(ye.status===ee)if(ye.gzhead.extra){for(Oe=ye.pending;ye.gzindex<(ye.gzhead.extra.length&65535)&&!(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>Oe&&(M.adler=r(M.adler,ye.pending_buf,ye.pending-Oe,Oe)),Te(M),Oe=ye.pending,ye.pending===ye.pending_buf_size));)ie(ye,ye.gzhead.extra[ye.gzindex]&255),ye.gzindex++;ye.gzhead.hcrc&&ye.pending>Oe&&(M.adler=r(M.adler,ye.pending_buf,ye.pending-Oe,Oe)),ye.gzindex===ye.gzhead.extra.length&&(ye.gzindex=0,ye.status=oe)}else ye.status=oe;if(ye.status===oe)if(ye.gzhead.name){Oe=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>Oe&&(M.adler=r(M.adler,ye.pending_buf,ye.pending-Oe,Oe)),Te(M),Oe=ye.pending,ye.pending===ye.pending_buf_size)){Ke=1;break}ye.gzindex<ye.gzhead.name.length?Ke=ye.gzhead.name.charCodeAt(ye.gzindex++)&255:Ke=0,ie(ye,Ke)}while(Ke!==0);ye.gzhead.hcrc&&ye.pending>Oe&&(M.adler=r(M.adler,ye.pending_buf,ye.pending-Oe,Oe)),Ke===0&&(ye.gzindex=0,ye.status=me)}else ye.status=me;if(ye.status===me)if(ye.gzhead.comment){Oe=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>Oe&&(M.adler=r(M.adler,ye.pending_buf,ye.pending-Oe,Oe)),Te(M),Oe=ye.pending,ye.pending===ye.pending_buf_size)){Ke=1;break}ye.gzindex<ye.gzhead.comment.length?Ke=ye.gzhead.comment.charCodeAt(ye.gzindex++)&255:Ke=0,ie(ye,Ke)}while(Ke!==0);ye.gzhead.hcrc&&ye.pending>Oe&&(M.adler=r(M.adler,ye.pending_buf,ye.pending-Oe,Oe)),Ke===0&&(ye.status=xe)}else ye.status=xe;if(ye.status===xe&&(ye.gzhead.hcrc?(ye.pending+2>ye.pending_buf_size&&Te(M),ye.pending+2<=ye.pending_buf_size&&(ie(ye,M.adler&255),ie(ye,M.adler>>8&255),M.adler=0,ye.status=Pe)):ye.status=Pe),ye.pending!==0){if(Te(M),M.avail_out===0)return ye.last_flush=-1,d}else if(M.avail_in===0&&V(Be)<=V(nt)&&Be!==l)return Ie(M,v);if(ye.status===Ne&&M.avail_in!==0)return Ie(M,v);if(M.avail_in!==0||ye.lookahead!==0||Be!==i&&ye.status!==Ne){var H=ye.strategy===x?Dt(ye,Be):ye.strategy===S?xt(ye,Be):Wt[ye.level].func(ye,Be);if((H===Fe||H===Qe)&&(ye.status=Ne),H===Re||H===Fe)return M.avail_out===0&&(ye.last_flush=-1),d;if(H===ke&&(Be===s?t._tr_align(ye):Be!==u&&(t._tr_stored_block(ye,0,0,!1),Be===o&&(ge(ye.head),ye.lookahead===0&&(ye.strstart=0,ye.block_start=0,ye.insert=0))),Te(M),M.avail_out===0))return ye.last_flush=-1,d}return Be!==l?d:ye.wrap<=0?h:(ye.wrap===2?(ie(ye,M.adler&255),ie(ye,M.adler>>8&255),ie(ye,M.adler>>16&255),ie(ye,M.adler>>24&255),ie(ye,M.total_in&255),ie(ye,M.total_in>>8&255),ie(ye,M.total_in>>16&255),ie(ye,M.total_in>>24&255)):(te(ye,M.adler>>>16),te(ye,M.adler&65535)),Te(M),ye.wrap>0&&(ye.wrap=-ye.wrap),ye.pending!==0?d:h)}function ft(M){var Be;return!M||!M.state?p:(Be=M.state.status,Be!==J&&Be!==ee&&Be!==oe&&Be!==me&&Be!==xe&&Be!==Pe&&Be!==Ne?Ie(M,p):(M.state=null,Be===Pe?Ie(M,y):d))}function vt(M,Be){var nt=Be.length,ye,Oe,Ke,Rt,pe,H,U,W;if(!M||!M.state||(ye=M.state,Rt=ye.wrap,Rt===2||Rt===1&&ye.status!==J||ye.lookahead))return p;for(Rt===1&&(M.adler=n(M.adler,Be,nt,0)),ye.wrap=0,nt>=ye.w_size&&(Rt===0&&(ge(ye.head),ye.strstart=0,ye.block_start=0,ye.insert=0),W=new e.Buf8(ye.w_size),e.arraySet(W,Be,nt-ye.w_size,ye.w_size,0),Be=W,nt=ye.w_size),pe=M.avail_in,H=M.next_in,U=M.input,M.avail_in=nt,M.next_in=0,M.input=Be,Ee(ye);ye.lookahead>=Y;){Oe=ye.strstart,Ke=ye.lookahead-(Y-1);do ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[Oe+Y-1])&ye.hash_mask,ye.prev[Oe&ye.w_mask]=ye.head[ye.ins_h],ye.head[ye.ins_h]=Oe,Oe++;while(--Ke);ye.strstart=Oe,ye.lookahead=Y-1,Ee(ye)}return ye.strstart+=ye.lookahead,ye.block_start=ye.strstart,ye.insert=ye.lookahead,ye.lookahead=0,ye.match_length=ye.prev_length=Y-1,ye.match_available=0,M.next_in=H,M.input=U,M.avail_in=pe,ye.wrap=Rt,d}return $s.deflateInit=Ce,$s.deflateInit2=ve,$s.deflateReset=fe,$s.deflateResetKeep=G,$s.deflateSetHeader=je,$s.deflate=ce,$s.deflateEnd=ft,$s.deflateSetDictionary=vt,$s.deflateInfo="pako deflate (from Nodeca project)",$s}var pd={},Uj;function JP(){if(Uj)return pd;Uj=1;var e=Tu(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),a=0;a<256;a++)r[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;r[254]=r[254]=1,pd.string2buf=function(s){var o,l,u,d,h,p=s.length,y=0;for(d=0;d<p;d++)l=s.charCodeAt(d),(l&64512)===55296&&d+1<p&&(u=s.charCodeAt(d+1),(u&64512)===56320&&(l=65536+(l-55296<<10)+(u-56320),d++)),y+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(y),h=0,d=0;h<y;d++)l=s.charCodeAt(d),(l&64512)===55296&&d+1<p&&(u=s.charCodeAt(d+1),(u&64512)===56320&&(l=65536+(l-55296<<10)+(u-56320),d++)),l<128?o[h++]=l:l<2048?(o[h++]=192|l>>>6,o[h++]=128|l&63):l<65536?(o[h++]=224|l>>>12,o[h++]=128|l>>>6&63,o[h++]=128|l&63):(o[h++]=240|l>>>18,o[h++]=128|l>>>12&63,o[h++]=128|l>>>6&63,o[h++]=128|l&63);return o};function i(s,o){if(o<65534&&(s.subarray&&n||!s.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(s,o));for(var l="",u=0;u<o;u++)l+=String.fromCharCode(s[u]);return l}return pd.buf2binstring=function(s){return i(s,s.length)},pd.binstring2buf=function(s){for(var o=new e.Buf8(s.length),l=0,u=o.length;l<u;l++)o[l]=s.charCodeAt(l);return o},pd.buf2string=function(s,o){var l,u,d,h,p=o||s.length,y=new Array(p*2);for(u=0,l=0;l<p;){if(d=s[l++],d<128){y[u++]=d;continue}if(h=r[d],h>4){y[u++]=65533,l+=h-1;continue}for(d&=h===2?31:h===3?15:7;h>1&&l<p;)d=d<<6|s[l++]&63,h--;if(h>1){y[u++]=65533;continue}d<65536?y[u++]=d:(d-=65536,y[u++]=55296|d>>10&1023,y[u++]=56320|d&1023)}return i(y,u)},pd.utf8border=function(s,o){var l;for(o=o||s.length,o>s.length&&(o=s.length),l=o-1;l>=0&&(s[l]&192)===128;)l--;return l<0||l===0?o:l+r[s[l]]>o?l:o},pd}var oE,qj;function QP(){if(qj)return oE;qj=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return oE=e,oE}var Hj;function Ine(){if(Hj)return th;Hj=1;var e=Rne(),t=Tu(),n=JP(),r=Jk(),a=QP(),i=Object.prototype.toString,s=0,o=4,l=0,u=1,d=2,h=-1,p=0,y=8;function v(S){if(!(this instanceof v))return new v(S);this.options=t.assign({level:h,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},S||{});var E=this.options;E.raw&&E.windowBits>0?E.windowBits=-E.windowBits:E.gzip&&E.windowBits>0&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var C=e.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(C!==l)throw new Error(r[C]);if(E.header&&e.deflateSetHeader(this.strm,E.header),E.dictionary){var k;if(typeof E.dictionary=="string"?k=n.string2buf(E.dictionary):i.call(E.dictionary)==="[object ArrayBuffer]"?k=new Uint8Array(E.dictionary):k=E.dictionary,C=e.deflateSetDictionary(this.strm,k),C!==l)throw new Error(r[C]);this._dict_set=!0}}v.prototype.push=function(S,E){var C=this.strm,k=this.options.chunkSize,R,O;if(this.ended)return!1;O=E===~~E?E:E===!0?o:s,typeof S=="string"?C.input=n.string2buf(S):i.call(S)==="[object ArrayBuffer]"?C.input=new Uint8Array(S):C.input=S,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new t.Buf8(k),C.next_out=0,C.avail_out=k),R=e.deflate(C,O),R!==u&&R!==l)return this.onEnd(R),this.ended=!0,!1;(C.avail_out===0||C.avail_in===0&&(O===o||O===d))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(C.output,C.next_out))):this.onData(t.shrinkBuf(C.output,C.next_out)))}while((C.avail_in>0||C.avail_out===0)&&R!==u);return O===o?(R=e.deflateEnd(this.strm),this.onEnd(R),this.ended=!0,R===l):(O===d&&(this.onEnd(l),C.avail_out=0),!0)},v.prototype.onData=function(S){this.chunks.push(S)},v.prototype.onEnd=function(S){S===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg};function b(S,E){var C=new v(E);if(C.push(S,!0),C.err)throw C.msg||r[C.err];return C.result}function w(S,E){return E=E||{},E.raw=!0,b(S,E)}function x(S,E){return E=E||{},E.gzip=!0,b(S,E)}return th.Deflate=v,th.deflate=b,th.deflateRaw=w,th.gzip=x,th}var nh={},bs={},lE,Vj;function jne(){if(Vj)return lE;Vj=1;var e=30,t=12;return lE=function(r,a){var i,s,o,l,u,d,h,p,y,v,b,w,x,S,E,C,k,R,O,j,$,L,X,F,K;i=r.state,s=r.next_in,F=r.input,o=s+(r.avail_in-5),l=r.next_out,K=r.output,u=l-(a-r.avail_out),d=l+(r.avail_out-257),h=i.dmax,p=i.wsize,y=i.whave,v=i.wnext,b=i.window,w=i.hold,x=i.bits,S=i.lencode,E=i.distcode,C=(1<<i.lenbits)-1,k=(1<<i.distbits)-1;e:do{x<15&&(w+=F[s++]<<x,x+=8,w+=F[s++]<<x,x+=8),R=S[w&C];t:for(;;){if(O=R>>>24,w>>>=O,x-=O,O=R>>>16&255,O===0)K[l++]=R&65535;else if(O&16){j=R&65535,O&=15,O&&(x<O&&(w+=F[s++]<<x,x+=8),j+=w&(1<<O)-1,w>>>=O,x-=O),x<15&&(w+=F[s++]<<x,x+=8,w+=F[s++]<<x,x+=8),R=E[w&k];n:for(;;){if(O=R>>>24,w>>>=O,x-=O,O=R>>>16&255,O&16){if($=R&65535,O&=15,x<O&&(w+=F[s++]<<x,x+=8,x<O&&(w+=F[s++]<<x,x+=8)),$+=w&(1<<O)-1,$>h){r.msg="invalid distance too far back",i.mode=e;break e}if(w>>>=O,x-=O,O=l-u,$>O){if(O=$-O,O>y&&i.sane){r.msg="invalid distance too far back",i.mode=e;break e}if(L=0,X=b,v===0){if(L+=p-O,O<j){j-=O;do K[l++]=b[L++];while(--O);L=l-$,X=K}}else if(v<O){if(L+=p+v-O,O-=v,O<j){j-=O;do K[l++]=b[L++];while(--O);if(L=0,v<j){O=v,j-=O;do K[l++]=b[L++];while(--O);L=l-$,X=K}}}else if(L+=v-O,O<j){j-=O;do K[l++]=b[L++];while(--O);L=l-$,X=K}for(;j>2;)K[l++]=X[L++],K[l++]=X[L++],K[l++]=X[L++],j-=3;j&&(K[l++]=X[L++],j>1&&(K[l++]=X[L++]))}else{L=l-$;do K[l++]=K[L++],K[l++]=K[L++],K[l++]=K[L++],j-=3;while(j>2);j&&(K[l++]=K[L++],j>1&&(K[l++]=K[L++]))}}else if((O&64)===0){R=E[(R&65535)+(w&(1<<O)-1)];continue n}else{r.msg="invalid distance code",i.mode=e;break e}break}}else if((O&64)===0){R=S[(R&65535)+(w&(1<<O)-1)];continue t}else if(O&32){i.mode=t;break e}else{r.msg="invalid literal/length code",i.mode=e;break e}break}}while(s<o&&l<d);j=x>>3,s-=j,x-=j<<3,w&=(1<<x)-1,r.next_in=s,r.next_out=l,r.avail_in=s<o?5+(o-s):5-(s-o),r.avail_out=l<d?257+(d-l):257-(l-d),i.hold=w,i.bits=x},lE}var cE,Gj;function One(){if(Gj)return cE;Gj=1;var e=Tu(),t=15,n=852,r=592,a=0,i=1,s=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return cE=function(p,y,v,b,w,x,S,E){var C=E.bits,k=0,R=0,O=0,j=0,$=0,L=0,X=0,F=0,K=0,q=0,de,re,Y,Q,ae,B=null,J=0,ee,oe=new e.Buf16(t+1),me=new e.Buf16(t+1),xe=null,Pe=0,Ne,Re,ke;for(k=0;k<=t;k++)oe[k]=0;for(R=0;R<b;R++)oe[y[v+R]]++;for($=C,j=t;j>=1&&oe[j]===0;j--);if($>j&&($=j),j===0)return w[x++]=1<<24|64<<16|0,w[x++]=1<<24|64<<16|0,E.bits=1,0;for(O=1;O<j&&oe[O]===0;O++);for($<O&&($=O),F=1,k=1;k<=t;k++)if(F<<=1,F-=oe[k],F<0)return-1;if(F>0&&(p===a||j!==1))return-1;for(me[1]=0,k=1;k<t;k++)me[k+1]=me[k]+oe[k];for(R=0;R<b;R++)y[v+R]!==0&&(S[me[y[v+R]]++]=R);if(p===a?(B=xe=S,ee=19):p===i?(B=o,J-=257,xe=l,Pe-=257,ee=256):(B=u,xe=d,ee=-1),q=0,R=0,k=O,ae=x,L=$,X=0,Y=-1,K=1<<$,Q=K-1,p===i&&K>n||p===s&&K>r)return 1;for(;;){Ne=k-X,S[R]<ee?(Re=0,ke=S[R]):S[R]>ee?(Re=xe[Pe+S[R]],ke=B[J+S[R]]):(Re=96,ke=0),de=1<<k-X,re=1<<L,O=re;do re-=de,w[ae+(q>>X)+re]=Ne<<24|Re<<16|ke|0;while(re!==0);for(de=1<<k-1;q&de;)de>>=1;if(de!==0?(q&=de-1,q+=de):q=0,R++,--oe[k]===0){if(k===j)break;k=y[v+S[R]]}if(k>$&&(q&Q)!==Y){for(X===0&&(X=$),ae+=O,L=k-X,F=1<<L;L+X<j&&(F-=oe[L+X],!(F<=0));)L++,F<<=1;if(K+=1<<L,p===i&&K>n||p===s&&K>r)return 1;Y=q&Q,w[Y]=$<<24|L<<16|ae-x|0}}return q!==0&&(w[ae+q]=k-X<<24|64<<16|0),E.bits=$,0},cE}var Wj;function Dne(){if(Wj)return bs;Wj=1;var e=Tu(),t=YP(),n=XP(),r=jne(),a=One(),i=0,s=1,o=2,l=4,u=5,d=6,h=0,p=1,y=2,v=-2,b=-3,w=-4,x=-5,S=8,E=1,C=2,k=3,R=4,O=5,j=6,$=7,L=8,X=9,F=10,K=11,q=12,de=13,re=14,Y=15,Q=16,ae=17,B=18,J=19,ee=20,oe=21,me=22,xe=23,Pe=24,Ne=25,Re=26,ke=27,Fe=28,Qe=29,Le=30,Ie=31,V=32,ge=852,Te=592,le=15,ie=le;function te(ve){return(ve>>>24&255)+(ve>>>8&65280)+((ve&65280)<<8)+((ve&255)<<24)}function _e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Me(ve){var Ce;return!ve||!ve.state?v:(Ce=ve.state,ve.total_in=ve.total_out=Ce.total=0,ve.msg="",Ce.wrap&&(ve.adler=Ce.wrap&1),Ce.mode=E,Ce.last=0,Ce.havedict=0,Ce.dmax=32768,Ce.head=null,Ce.hold=0,Ce.bits=0,Ce.lencode=Ce.lendyn=new e.Buf32(ge),Ce.distcode=Ce.distdyn=new e.Buf32(Te),Ce.sane=1,Ce.back=-1,h)}function Ee(ve){var Ce;return!ve||!ve.state?v:(Ce=ve.state,Ce.wsize=0,Ce.whave=0,Ce.wnext=0,Me(ve))}function We(ve,Ce){var ce,ft;return!ve||!ve.state||(ft=ve.state,Ce<0?(ce=0,Ce=-Ce):(ce=(Ce>>4)+1,Ce<48&&(Ce&=15)),Ce&&(Ce<8||Ce>15))?v:(ft.window!==null&&ft.wbits!==Ce&&(ft.window=null),ft.wrap=ce,ft.wbits=Ce,Ee(ve))}function kt(ve,Ce){var ce,ft;return ve?(ft=new _e,ve.state=ft,ft.window=null,ce=We(ve,Ce),ce!==h&&(ve.state=null),ce):v}function it(ve){return kt(ve,ie)}var xt=!0,Dt,Ot;function Wt(ve){if(xt){var Ce;for(Dt=new e.Buf32(512),Ot=new e.Buf32(32),Ce=0;Ce<144;)ve.lens[Ce++]=8;for(;Ce<256;)ve.lens[Ce++]=9;for(;Ce<280;)ve.lens[Ce++]=7;for(;Ce<288;)ve.lens[Ce++]=8;for(a(s,ve.lens,0,288,Dt,0,ve.work,{bits:9}),Ce=0;Ce<32;)ve.lens[Ce++]=5;a(o,ve.lens,0,32,Ot,0,ve.work,{bits:5}),xt=!1}ve.lencode=Dt,ve.lenbits=9,ve.distcode=Ot,ve.distbits=5}function be(ve,Ce,ce,ft){var vt,M=ve.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new e.Buf8(M.wsize)),ft>=M.wsize?(e.arraySet(M.window,Ce,ce-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(vt=M.wsize-M.wnext,vt>ft&&(vt=ft),e.arraySet(M.window,Ce,ce-ft,vt,M.wnext),ft-=vt,ft?(e.arraySet(M.window,Ce,ce-ft,ft,0),M.wnext=ft,M.whave=M.wsize):(M.wnext+=vt,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=vt))),0}function I(ve,Ce){var ce,ft,vt,M,Be,nt,ye,Oe,Ke,Rt,pe,H,U,W,he=0,Ae,qe,pt,Gt,ut,Tt,Pt,Jt,An=new e.Buf8(4),Hn,wr,xr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ve||!ve.state||!ve.output||!ve.input&&ve.avail_in!==0)return v;ce=ve.state,ce.mode===q&&(ce.mode=de),Be=ve.next_out,vt=ve.output,ye=ve.avail_out,M=ve.next_in,ft=ve.input,nt=ve.avail_in,Oe=ce.hold,Ke=ce.bits,Rt=nt,pe=ye,Jt=h;e:for(;;)switch(ce.mode){case E:if(ce.wrap===0){ce.mode=de;break}for(;Ke<16;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if(ce.wrap&2&&Oe===35615){ce.check=0,An[0]=Oe&255,An[1]=Oe>>>8&255,ce.check=n(ce.check,An,2,0),Oe=0,Ke=0,ce.mode=C;break}if(ce.flags=0,ce.head&&(ce.head.done=!1),!(ce.wrap&1)||(((Oe&255)<<8)+(Oe>>8))%31){ve.msg="incorrect header check",ce.mode=Le;break}if((Oe&15)!==S){ve.msg="unknown compression method",ce.mode=Le;break}if(Oe>>>=4,Ke-=4,Pt=(Oe&15)+8,ce.wbits===0)ce.wbits=Pt;else if(Pt>ce.wbits){ve.msg="invalid window size",ce.mode=Le;break}ce.dmax=1<<Pt,ve.adler=ce.check=1,ce.mode=Oe&512?F:q,Oe=0,Ke=0;break;case C:for(;Ke<16;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if(ce.flags=Oe,(ce.flags&255)!==S){ve.msg="unknown compression method",ce.mode=Le;break}if(ce.flags&57344){ve.msg="unknown header flags set",ce.mode=Le;break}ce.head&&(ce.head.text=Oe>>8&1),ce.flags&512&&(An[0]=Oe&255,An[1]=Oe>>>8&255,ce.check=n(ce.check,An,2,0)),Oe=0,Ke=0,ce.mode=k;case k:for(;Ke<32;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}ce.head&&(ce.head.time=Oe),ce.flags&512&&(An[0]=Oe&255,An[1]=Oe>>>8&255,An[2]=Oe>>>16&255,An[3]=Oe>>>24&255,ce.check=n(ce.check,An,4,0)),Oe=0,Ke=0,ce.mode=R;case R:for(;Ke<16;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}ce.head&&(ce.head.xflags=Oe&255,ce.head.os=Oe>>8),ce.flags&512&&(An[0]=Oe&255,An[1]=Oe>>>8&255,ce.check=n(ce.check,An,2,0)),Oe=0,Ke=0,ce.mode=O;case O:if(ce.flags&1024){for(;Ke<16;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}ce.length=Oe,ce.head&&(ce.head.extra_len=Oe),ce.flags&512&&(An[0]=Oe&255,An[1]=Oe>>>8&255,ce.check=n(ce.check,An,2,0)),Oe=0,Ke=0}else ce.head&&(ce.head.extra=null);ce.mode=j;case j:if(ce.flags&1024&&(H=ce.length,H>nt&&(H=nt),H&&(ce.head&&(Pt=ce.head.extra_len-ce.length,ce.head.extra||(ce.head.extra=new Array(ce.head.extra_len)),e.arraySet(ce.head.extra,ft,M,H,Pt)),ce.flags&512&&(ce.check=n(ce.check,ft,H,M)),nt-=H,M+=H,ce.length-=H),ce.length))break e;ce.length=0,ce.mode=$;case $:if(ce.flags&2048){if(nt===0)break e;H=0;do Pt=ft[M+H++],ce.head&&Pt&&ce.length<65536&&(ce.head.name+=String.fromCharCode(Pt));while(Pt&&H<nt);if(ce.flags&512&&(ce.check=n(ce.check,ft,H,M)),nt-=H,M+=H,Pt)break e}else ce.head&&(ce.head.name=null);ce.length=0,ce.mode=L;case L:if(ce.flags&4096){if(nt===0)break e;H=0;do Pt=ft[M+H++],ce.head&&Pt&&ce.length<65536&&(ce.head.comment+=String.fromCharCode(Pt));while(Pt&&H<nt);if(ce.flags&512&&(ce.check=n(ce.check,ft,H,M)),nt-=H,M+=H,Pt)break e}else ce.head&&(ce.head.comment=null);ce.mode=X;case X:if(ce.flags&512){for(;Ke<16;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if(Oe!==(ce.check&65535)){ve.msg="header crc mismatch",ce.mode=Le;break}Oe=0,Ke=0}ce.head&&(ce.head.hcrc=ce.flags>>9&1,ce.head.done=!0),ve.adler=ce.check=0,ce.mode=q;break;case F:for(;Ke<32;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}ve.adler=ce.check=te(Oe),Oe=0,Ke=0,ce.mode=K;case K:if(ce.havedict===0)return ve.next_out=Be,ve.avail_out=ye,ve.next_in=M,ve.avail_in=nt,ce.hold=Oe,ce.bits=Ke,y;ve.adler=ce.check=1,ce.mode=q;case q:if(Ce===u||Ce===d)break e;case de:if(ce.last){Oe>>>=Ke&7,Ke-=Ke&7,ce.mode=ke;break}for(;Ke<3;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}switch(ce.last=Oe&1,Oe>>>=1,Ke-=1,Oe&3){case 0:ce.mode=re;break;case 1:if(Wt(ce),ce.mode=ee,Ce===d){Oe>>>=2,Ke-=2;break e}break;case 2:ce.mode=ae;break;case 3:ve.msg="invalid block type",ce.mode=Le}Oe>>>=2,Ke-=2;break;case re:for(Oe>>>=Ke&7,Ke-=Ke&7;Ke<32;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if((Oe&65535)!==(Oe>>>16^65535)){ve.msg="invalid stored block lengths",ce.mode=Le;break}if(ce.length=Oe&65535,Oe=0,Ke=0,ce.mode=Y,Ce===d)break e;case Y:ce.mode=Q;case Q:if(H=ce.length,H){if(H>nt&&(H=nt),H>ye&&(H=ye),H===0)break e;e.arraySet(vt,ft,M,H,Be),nt-=H,M+=H,ye-=H,Be+=H,ce.length-=H;break}ce.mode=q;break;case ae:for(;Ke<14;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if(ce.nlen=(Oe&31)+257,Oe>>>=5,Ke-=5,ce.ndist=(Oe&31)+1,Oe>>>=5,Ke-=5,ce.ncode=(Oe&15)+4,Oe>>>=4,Ke-=4,ce.nlen>286||ce.ndist>30){ve.msg="too many length or distance symbols",ce.mode=Le;break}ce.have=0,ce.mode=B;case B:for(;ce.have<ce.ncode;){for(;Ke<3;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}ce.lens[xr[ce.have++]]=Oe&7,Oe>>>=3,Ke-=3}for(;ce.have<19;)ce.lens[xr[ce.have++]]=0;if(ce.lencode=ce.lendyn,ce.lenbits=7,Hn={bits:ce.lenbits},Jt=a(i,ce.lens,0,19,ce.lencode,0,ce.work,Hn),ce.lenbits=Hn.bits,Jt){ve.msg="invalid code lengths set",ce.mode=Le;break}ce.have=0,ce.mode=J;case J:for(;ce.have<ce.nlen+ce.ndist;){for(;he=ce.lencode[Oe&(1<<ce.lenbits)-1],Ae=he>>>24,qe=he>>>16&255,pt=he&65535,!(Ae<=Ke);){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if(pt<16)Oe>>>=Ae,Ke-=Ae,ce.lens[ce.have++]=pt;else{if(pt===16){for(wr=Ae+2;Ke<wr;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if(Oe>>>=Ae,Ke-=Ae,ce.have===0){ve.msg="invalid bit length repeat",ce.mode=Le;break}Pt=ce.lens[ce.have-1],H=3+(Oe&3),Oe>>>=2,Ke-=2}else if(pt===17){for(wr=Ae+3;Ke<wr;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}Oe>>>=Ae,Ke-=Ae,Pt=0,H=3+(Oe&7),Oe>>>=3,Ke-=3}else{for(wr=Ae+7;Ke<wr;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}Oe>>>=Ae,Ke-=Ae,Pt=0,H=11+(Oe&127),Oe>>>=7,Ke-=7}if(ce.have+H>ce.nlen+ce.ndist){ve.msg="invalid bit length repeat",ce.mode=Le;break}for(;H--;)ce.lens[ce.have++]=Pt}}if(ce.mode===Le)break;if(ce.lens[256]===0){ve.msg="invalid code -- missing end-of-block",ce.mode=Le;break}if(ce.lenbits=9,Hn={bits:ce.lenbits},Jt=a(s,ce.lens,0,ce.nlen,ce.lencode,0,ce.work,Hn),ce.lenbits=Hn.bits,Jt){ve.msg="invalid literal/lengths set",ce.mode=Le;break}if(ce.distbits=6,ce.distcode=ce.distdyn,Hn={bits:ce.distbits},Jt=a(o,ce.lens,ce.nlen,ce.ndist,ce.distcode,0,ce.work,Hn),ce.distbits=Hn.bits,Jt){ve.msg="invalid distances set",ce.mode=Le;break}if(ce.mode=ee,Ce===d)break e;case ee:ce.mode=oe;case oe:if(nt>=6&&ye>=258){ve.next_out=Be,ve.avail_out=ye,ve.next_in=M,ve.avail_in=nt,ce.hold=Oe,ce.bits=Ke,r(ve,pe),Be=ve.next_out,vt=ve.output,ye=ve.avail_out,M=ve.next_in,ft=ve.input,nt=ve.avail_in,Oe=ce.hold,Ke=ce.bits,ce.mode===q&&(ce.back=-1);break}for(ce.back=0;he=ce.lencode[Oe&(1<<ce.lenbits)-1],Ae=he>>>24,qe=he>>>16&255,pt=he&65535,!(Ae<=Ke);){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if(qe&&(qe&240)===0){for(Gt=Ae,ut=qe,Tt=pt;he=ce.lencode[Tt+((Oe&(1<<Gt+ut)-1)>>Gt)],Ae=he>>>24,qe=he>>>16&255,pt=he&65535,!(Gt+Ae<=Ke);){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}Oe>>>=Gt,Ke-=Gt,ce.back+=Gt}if(Oe>>>=Ae,Ke-=Ae,ce.back+=Ae,ce.length=pt,qe===0){ce.mode=Re;break}if(qe&32){ce.back=-1,ce.mode=q;break}if(qe&64){ve.msg="invalid literal/length code",ce.mode=Le;break}ce.extra=qe&15,ce.mode=me;case me:if(ce.extra){for(wr=ce.extra;Ke<wr;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}ce.length+=Oe&(1<<ce.extra)-1,Oe>>>=ce.extra,Ke-=ce.extra,ce.back+=ce.extra}ce.was=ce.length,ce.mode=xe;case xe:for(;he=ce.distcode[Oe&(1<<ce.distbits)-1],Ae=he>>>24,qe=he>>>16&255,pt=he&65535,!(Ae<=Ke);){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if((qe&240)===0){for(Gt=Ae,ut=qe,Tt=pt;he=ce.distcode[Tt+((Oe&(1<<Gt+ut)-1)>>Gt)],Ae=he>>>24,qe=he>>>16&255,pt=he&65535,!(Gt+Ae<=Ke);){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}Oe>>>=Gt,Ke-=Gt,ce.back+=Gt}if(Oe>>>=Ae,Ke-=Ae,ce.back+=Ae,qe&64){ve.msg="invalid distance code",ce.mode=Le;break}ce.offset=pt,ce.extra=qe&15,ce.mode=Pe;case Pe:if(ce.extra){for(wr=ce.extra;Ke<wr;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}ce.offset+=Oe&(1<<ce.extra)-1,Oe>>>=ce.extra,Ke-=ce.extra,ce.back+=ce.extra}if(ce.offset>ce.dmax){ve.msg="invalid distance too far back",ce.mode=Le;break}ce.mode=Ne;case Ne:if(ye===0)break e;if(H=pe-ye,ce.offset>H){if(H=ce.offset-H,H>ce.whave&&ce.sane){ve.msg="invalid distance too far back",ce.mode=Le;break}H>ce.wnext?(H-=ce.wnext,U=ce.wsize-H):U=ce.wnext-H,H>ce.length&&(H=ce.length),W=ce.window}else W=vt,U=Be-ce.offset,H=ce.length;H>ye&&(H=ye),ye-=H,ce.length-=H;do vt[Be++]=W[U++];while(--H);ce.length===0&&(ce.mode=oe);break;case Re:if(ye===0)break e;vt[Be++]=ce.length,ye--,ce.mode=oe;break;case ke:if(ce.wrap){for(;Ke<32;){if(nt===0)break e;nt--,Oe|=ft[M++]<<Ke,Ke+=8}if(pe-=ye,ve.total_out+=pe,ce.total+=pe,pe&&(ve.adler=ce.check=ce.flags?n(ce.check,vt,pe,Be-pe):t(ce.check,vt,pe,Be-pe)),pe=ye,(ce.flags?Oe:te(Oe))!==ce.check){ve.msg="incorrect data check",ce.mode=Le;break}Oe=0,Ke=0}ce.mode=Fe;case Fe:if(ce.wrap&&ce.flags){for(;Ke<32;){if(nt===0)break e;nt--,Oe+=ft[M++]<<Ke,Ke+=8}if(Oe!==(ce.total&4294967295)){ve.msg="incorrect length check",ce.mode=Le;break}Oe=0,Ke=0}ce.mode=Qe;case Qe:Jt=p;break e;case Le:Jt=b;break e;case Ie:return w;case V:default:return v}return ve.next_out=Be,ve.avail_out=ye,ve.next_in=M,ve.avail_in=nt,ce.hold=Oe,ce.bits=Ke,(ce.wsize||pe!==ve.avail_out&&ce.mode<Le&&(ce.mode<ke||Ce!==l))&&be(ve,ve.output,ve.next_out,pe-ve.avail_out),Rt-=ve.avail_in,pe-=ve.avail_out,ve.total_in+=Rt,ve.total_out+=pe,ce.total+=pe,ce.wrap&&pe&&(ve.adler=ce.check=ce.flags?n(ce.check,vt,pe,ve.next_out-pe):t(ce.check,vt,pe,ve.next_out-pe)),ve.data_type=ce.bits+(ce.last?64:0)+(ce.mode===q?128:0)+(ce.mode===ee||ce.mode===Y?256:0),(Rt===0&&pe===0||Ce===l)&&Jt===h&&(Jt=x),Jt}function G(ve){if(!ve||!ve.state)return v;var Ce=ve.state;return Ce.window&&(Ce.window=null),ve.state=null,h}function fe(ve,Ce){var ce;return!ve||!ve.state||(ce=ve.state,(ce.wrap&2)===0)?v:(ce.head=Ce,Ce.done=!1,h)}function je(ve,Ce){var ce=Ce.length,ft,vt,M;return!ve||!ve.state||(ft=ve.state,ft.wrap!==0&&ft.mode!==K)?v:ft.mode===K&&(vt=1,vt=t(vt,Ce,ce,0),vt!==ft.check)?b:(M=be(ve,Ce,ce,ce),M?(ft.mode=Ie,w):(ft.havedict=1,h))}return bs.inflateReset=Ee,bs.inflateReset2=We,bs.inflateResetKeep=Me,bs.inflateInit=it,bs.inflateInit2=kt,bs.inflate=I,bs.inflateEnd=G,bs.inflateGetHeader=fe,bs.inflateSetDictionary=je,bs.inflateInfo="pako inflate (from Nodeca project)",bs}var uE,Kj;function e5(){return Kj||(Kj=1,uE={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),uE}var dE,Zj;function Mne(){if(Zj)return dE;Zj=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return dE=e,dE}var Yj;function Pne(){if(Yj)return nh;Yj=1;var e=Dne(),t=Tu(),n=JP(),r=e5(),a=Jk(),i=QP(),s=Mne(),o=Object.prototype.toString;function l(h){if(!(this instanceof l))return new l(h);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},h||{});var p=this.options;p.raw&&p.windowBits>=0&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),p.windowBits>=0&&p.windowBits<16&&!(h&&h.windowBits)&&(p.windowBits+=32),p.windowBits>15&&p.windowBits<48&&(p.windowBits&15)===0&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var y=e.inflateInit2(this.strm,p.windowBits);if(y!==r.Z_OK)throw new Error(a[y]);if(this.header=new s,e.inflateGetHeader(this.strm,this.header),p.dictionary&&(typeof p.dictionary=="string"?p.dictionary=n.string2buf(p.dictionary):o.call(p.dictionary)==="[object ArrayBuffer]"&&(p.dictionary=new Uint8Array(p.dictionary)),p.raw&&(y=e.inflateSetDictionary(this.strm,p.dictionary),y!==r.Z_OK)))throw new Error(a[y])}l.prototype.push=function(h,p){var y=this.strm,v=this.options.chunkSize,b=this.options.dictionary,w,x,S,E,C,k=!1;if(this.ended)return!1;x=p===~~p?p:p===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof h=="string"?y.input=n.binstring2buf(h):o.call(h)==="[object ArrayBuffer]"?y.input=new Uint8Array(h):y.input=h,y.next_in=0,y.avail_in=y.input.length;do{if(y.avail_out===0&&(y.output=new t.Buf8(v),y.next_out=0,y.avail_out=v),w=e.inflate(y,r.Z_NO_FLUSH),w===r.Z_NEED_DICT&&b&&(w=e.inflateSetDictionary(this.strm,b)),w===r.Z_BUF_ERROR&&k===!0&&(w=r.Z_OK,k=!1),w!==r.Z_STREAM_END&&w!==r.Z_OK)return this.onEnd(w),this.ended=!0,!1;y.next_out&&(y.avail_out===0||w===r.Z_STREAM_END||y.avail_in===0&&(x===r.Z_FINISH||x===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(S=n.utf8border(y.output,y.next_out),E=y.next_out-S,C=n.buf2string(y.output,S),y.next_out=E,y.avail_out=v-E,E&&t.arraySet(y.output,y.output,S,E,0),this.onData(C)):this.onData(t.shrinkBuf(y.output,y.next_out))),y.avail_in===0&&y.avail_out===0&&(k=!0)}while((y.avail_in>0||y.avail_out===0)&&w!==r.Z_STREAM_END);return w===r.Z_STREAM_END&&(x=r.Z_FINISH),x===r.Z_FINISH?(w=e.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===r.Z_OK):(x===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),y.avail_out=0),!0)},l.prototype.onData=function(h){this.chunks.push(h)},l.prototype.onEnd=function(h){h===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg};function u(h,p){var y=new l(p);if(y.push(h,!0),y.err)throw y.msg||a[y.err];return y.result}function d(h,p){return p=p||{},p.raw=!0,u(h,p)}return nh.Inflate=l,nh.inflate=u,nh.inflateRaw=d,nh.ungzip=u,nh}var fE,Xj;function Fne(){if(Xj)return fE;Xj=1;var e=Tu().assign,t=Ine(),n=Pne(),r=e5(),a={};return e(a,t,n,r),fE=a,fE}var Lne=Fne();const Qk=di(Lne);var hE,Jj;function $ne(){if(Jj)return hE;Jj=1;const e=(t,n)=>function(...r){const a=n.promiseModule;return new a((i,s)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?s(o):(o.shift(),i(o)):i(o)}):n.errorFirst?r.push((o,l)=>{o?s(o):i(l)}):r.push(i),t.apply(this,r)})};return hE=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const a=s=>{const o=l=>typeof l=="string"?s===l:l.test(s);return n.include?n.include.some(o):!n.exclude.some(o)};let i;r==="function"?i=function(...s){return n.excludeMain?t(...s):e(t,n).apply(this,s)}:i=Object.create(Object.getPrototypeOf(t));for(const s in t){const o=t[s];i[s]=typeof o=="function"&&a(s)?e(o,n):o}return i},hE}var Bne=$ne();const pE=di(Bne);var mE,Qj;function zne(){if(Qj)return mE;Qj=1;var e={};function t(Y){return Array.isArray(Y)?Y:[Y]}const n="",r=" ",a="\\",i=/^\s+$/,s=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,u=/\r?\n/g,d=/^\.*\/|^\.+$/,h="/";let p="node-ignore";typeof Symbol<"u"&&(p=Symbol.for("node-ignore"));const y=p,v=(Y,Q,ae)=>Object.defineProperty(Y,Q,{value:ae}),b=/([0-z])-([0-z])/g,w=()=>!1,x=Y=>Y.replace(b,(Q,ae,B)=>ae.charCodeAt(0)<=B.charCodeAt(0)?Q:n),S=Y=>{const{length:Q}=Y;return Y.slice(0,Q-Q%2)},E=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(Y,Q,ae)=>Q+(ae.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(Y,Q)=>{const{length:ae}=Q;return Q.slice(0,ae-ae%2)+r}],[/[\\$.|*+(){^]/g,Y=>`\\${Y}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(Y,Q,ae)=>Q+6<ae.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(Y,Q,ae)=>{const B=ae.replace(/\\\*/g,"[^\\/]*");return Q+B}],[/\\\\\\(?=[$.|*+(){^])/g,()=>a],[/\\\\/g,()=>a],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(Y,Q,ae,B,J)=>Q===a?`\\[${ae}${S(B)}${J}`:J==="]"&&B.length%2===0?`[${x(ae)}${B}]`:"[]"],[/(?:[^*])$/,Y=>/\/$/.test(Y)?`${Y}$`:`${Y}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(Y,Q)=>`${Q?`${Q}[^/]+`:"[^/]*"}(?=$|\\/$)`]],C=Object.create(null),k=(Y,Q)=>{let ae=C[Y];return ae||(ae=E.reduce((B,[J,ee])=>B.replace(J,ee.bind(Y)),Y),C[Y]=ae),Q?new RegExp(ae,"i"):new RegExp(ae)},R=Y=>typeof Y=="string",O=Y=>Y&&R(Y)&&!i.test(Y)&&!s.test(Y)&&Y.indexOf("#")!==0,j=Y=>Y.split(u);class ${constructor(Q,ae,B,J){this.origin=Q,this.pattern=ae,this.negative=B,this.regex=J}}const L=(Y,Q)=>{const ae=Y;let B=!1;Y.indexOf("!")===0&&(B=!0,Y=Y.substr(1)),Y=Y.replace(o,"!").replace(l,"#");const J=k(Y,Q);return new $(ae,Y,B,J)},X=(Y,Q)=>{throw new Q(Y)},F=(Y,Q,ae)=>R(Y)?Y?F.isNotRelative(Y)?ae(`path should be a \`path.relative()\`d string, but got "${Q}"`,RangeError):!0:ae("path must not be empty",TypeError):ae(`path must be a string, but got \`${Q}\``,TypeError),K=Y=>d.test(Y);F.isNotRelative=K,F.convert=Y=>Y;class q{constructor({ignorecase:Q=!0,ignoreCase:ae=Q,allowRelativePaths:B=!1}={}){v(this,y,!0),this._rules=[],this._ignoreCase=ae,this._allowRelativePaths=B,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(Q){if(Q&&Q[y]){this._rules=this._rules.concat(Q._rules),this._added=!0;return}if(O(Q)){const ae=L(Q,this._ignoreCase);this._added=!0,this._rules.push(ae)}}add(Q){return this._added=!1,t(R(Q)?j(Q):Q).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(Q){return this.add(Q)}_testOne(Q,ae){let B=!1,J=!1;return this._rules.forEach(ee=>{const{negative:oe}=ee;if(J===oe&&B!==J||oe&&!B&&!J&&!ae)return;ee.regex.test(Q)&&(B=!oe,J=oe)}),{ignored:B,unignored:J}}_test(Q,ae,B,J){const ee=Q&&F.convert(Q);return F(ee,Q,this._allowRelativePaths?w:X),this._t(ee,ae,B,J)}_t(Q,ae,B,J){if(Q in ae)return ae[Q];if(J||(J=Q.split(h)),J.pop(),!J.length)return ae[Q]=this._testOne(Q,B);const ee=this._t(J.join(h)+h,ae,B,J);return ae[Q]=ee.ignored?ee:this._testOne(Q,B)}ignores(Q){return this._test(Q,this._ignoreCache,!1).ignored}createFilter(){return Q=>!this.ignores(Q)}filter(Q){return t(Q).filter(this.createFilter())}test(Q){return this._test(Q,this._testCache,!0)}}const de=Y=>new q(Y),re=Y=>F(Y&&F.convert(Y),Y,w);if(de.isPathValid=re,de.default=de,mE=de,typeof ea<"u"&&(e&&e.IGNORE_TEST_WIN32||ea.platform==="win32")){const Y=ae=>/^\\\\\?\\/.test(ae)||/["<>|\u0000-\u001F]+/u.test(ae)?ae:ae.replace(/\\/g,"/");F.convert=Y;const Q=/^[a-z]:\//i;F.isNotRelative=ae=>Q.test(ae)||K(ae)}return mE}var Une=zne();const qne=di(Une);var gE,e4;function Hne(){if(e4)return gE;e4=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,a,i){return a=a instanceof RegExp?a:new RegExp(e(a),"g"),r.replace(a,i)}var n={clean:function(a){if(typeof a!="string")throw new Error("Expected a string, received: "+a);return a=t(a,"./","/"),a=t(a,"..","."),a=t(a," ","-"),a=t(a,/^[~^:?*\\\-]/g,""),a=t(a,/[~^:?*\\]/g,"-"),a=t(a,/[~^:?*\\\-]$/g,""),a=t(a,"@{","-"),a=t(a,/\.$/g,""),a=t(a,/\/$/g,""),a=t(a,/\.lock$/g,""),a}};return gE=n,gE}var Vne=Hne();const Bo=di(Vne);var yE,t4;function Gne(){return t4||(t4=1,yE=function(e,t){var n=e,r=t,a=n.length,i=r.length,s=!1,o=null,l=a+1,u=[],d=[],h=[],p="",y=-1,v=0,b=1,w,x,S=function(){a>=i&&(w=n,x=a,n=r,r=w,a=i,i=x,s=!0,l=a+1)},E=function(O,j,$){return{x:O,y:j,k:$}},C=function(O,j){return{elem:O,t:j}},k=function(O,j,$){var L,X,F;for(j>$?L=u[O-1+l]:L=u[O+1+l],F=Math.max(j,$),X=F-O;X<a&&F<i&&n[X]===r[F];)++X,++F;return u[O+l]=d.length,d[d.length]=new E(X,F,L),F},R=function(O){var j,$,L;for(j=$=0,L=O.length-1;L>=0;--L)for(;j<O[L].x||$<O[L].y;)O[L].y-O[L].x>$-j?(s?h[h.length]=new C(r[$],y):h[h.length]=new C(r[$],b),++$):O[L].y-O[L].x<$-j?(s?h[h.length]=new C(n[j],b):h[h.length]=new C(n[j],y),++j):(h[h.length]=new C(n[j],v),p+=n[j],++j,++$)};return S(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return p},getses:function(){return h},compose:function(){var O,j,$,L,X,F,K,q;for(O=i-a,j=a+i+3,$={},K=0;K<j;++K)$[K]=-1,u[K]=-1;L=-1;do{for(++L,q=-L;q<=O-1;++q)$[q+l]=k(q,$[q-1+l]+1,$[q+1+l]);for(q=O+L;q>=O+1;--q)$[q+l]=k(q,$[q-1+l]+1,$[q+1+l]);$[O+l]=k(O,$[O-1+l]+1,$[O+1+l])}while($[O+l]!==i);for(o=O+2*L,X=u[O+l],F=[];X!==-1;)F[F.length]=new E(d[X].x,d[X].y,null),X=d[X].k;R(F)}}}),yE}var bE,n4;function Wne(){if(n4)return bE;n4=1;var e=Gne();function t(i,s){var o=new e(i,s);o.compose();for(var l=o.getses(),u,d,h=i.length-1,p=s.length-1,y=l.length-1;y>=0;--y)l[y].t===o.SES_COMMON?(d?(d.chain={file1index:h,file2index:p,chain:null},d=d.chain):(u={file1index:h,file2index:p,chain:null},d=u),h--,p--):l[y].t===o.SES_DELETE?h--:l[y].t===o.SES_ADD&&p--;var v={file1index:-1,file2index:-1,chain:null};return d?(d.chain=v,u):v}function n(i,s){for(var o=[],l=i.length,u=s.length,d=t(i,s);d!==null;d=d.chain){var h=l-d.file1index-1,p=u-d.file2index-1;l=d.file1index,u=d.file2index,(h||p)&&o.push({file1:[l+1,h],file2:[u+1,p]})}return o.reverse(),o}function r(i,s,o){var l,u=n(s,i),d=n(s,o),h=[];function p(Q,ae){h.push([Q.file1[0],ae,Q.file1[1],Q.file2[0],Q.file2[1]])}for(l=0;l<u.length;l++)p(u[l],0);for(l=0;l<d.length;l++)p(d[l],2);h.sort(function(Q,ae){return Q[0]-ae[0]});var y=[],v=0;function b(Q){Q>v&&(y.push([1,v,Q-v]),v=Q)}for(var w=0;w<h.length;w++){for(var x=w,S=h[w],E=S[0],C=E+S[2];w<h.length-1;){var k=h[w+1],R=k[0];if(R>C)break;C=Math.max(C,R+k[2]),w++}if(b(E),x==w)S[4]>0&&y.push([S[1],S[3],S[4]]);else{var O={0:[i.length,-1,s.length,-1],2:[o.length,-1,s.length,-1]};for(l=x;l<=w;l++){S=h[l];var j=S[1],$=O[j],L=S[0],X=L+S[2],F=S[3],K=F+S[4];$[0]=Math.min(F,$[0]),$[1]=Math.max(K,$[1]),$[2]=Math.min(L,$[2]),$[3]=Math.max(X,$[3])}var q=O[0][0]+(E-O[0][2]),de=O[0][1]+(C-O[0][3]),re=O[2][0]+(E-O[2][2]),Y=O[2][1]+(C-O[2][3]);y.push([-1,q,de-q,E,C-E,re,Y-re])}v=C}return b(s.length),y}function a(i,s,o){var l=[],u=[i,s,o],d=r(i,s,o),h=[];function p(){h.length&&l.push({ok:h}),h=[]}function y(S){for(var E=0;E<S.length;E++)h.push(S[E])}function v(S){if(S[2]!=S[6])return!0;for(var E=S[1],C=S[5],k=0;k<S[2];k++)if(i[k+E]!=o[k+C])return!0;return!1}for(var b=0;b<d.length;b++){var w=d[b],x=w[0];x==-1?v(w)?(p(),l.push({conflict:{a:i.slice(w[1],w[1]+w[2]),aIndex:w[1],o:s.slice(w[3],w[3]+w[4]),oIndex:w[3],b:o.slice(w[5],w[5]+w[6]),bIndex:w[5]}})):y(u[0].slice(w[1],w[1]+w[2])):y(u[x].slice(w[1],w[1]+w[2]))}return p(),l}return bE=a,bE}var Kne=Wne();const Zne=di(Kne);class sr extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new sr(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class S0 extends sr{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=S0.code,this.data={filepaths:t}}}S0.code="UnmergedPathsError";class In extends sr{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=In.code,this.data={message:t}}}In.code="InternalError";class cp extends sr{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=cp.code,this.data={filepath:t}}}cp.code="UnsafeFilepathError";class Fo{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const a=this.buffer.write(t,this._start,n,r);return this._start+=n,a}copy(t,n,r){const a=t.copy(this.buffer,this._start,n,r);return this._start+=a,a}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function hx(e,t){return-(e<t)||+(e>t)}function t5(e,t){return hx(e.path,t.path)}function n5(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const Ro=2**32;function r4(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const a=Math.floor(n/1e3),i=(n-a*1e3)*1e6;return[a,i]}function Fh(e){const[t,n]=r4(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,a]=r4(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%Ro,ctimeNanoseconds:n%Ro,mtimeSeconds:r%Ro,mtimeNanoseconds:a%Ro,dev:e.dev%Ro,ino:e.ino%Ro,mode:n5(e.mode%Ro),uid:e.uid%Ro,gid:e.gid%Ro,size:e.size>-1?e.size%Ro:0}}function Yne(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let vE=null;async function Kl(e){return vE===null&&(vE=await Jne()),vE?r5(e):Xne(e)}function Xne(e){return new ZP().update(e).digest("hex")}async function r5(e){const t=await crypto.subtle.digest("SHA-1",e);return Yne(t)}async function Jne(){try{if(await r5(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function Qne(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function ere(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(Xt.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class vd{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(Xt.isBuffer(t))return vd.fromBuffer(t);if(t===null)return new vd(null);throw new In("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new In("Index file is empty (.git/index)");const n=new vd,r=new Fo(t),a=r.toString("utf8",4);if(a!=="DIRC")throw new In(`Invalid dircache magic file number: ${a}`);const i=await Kl(t.slice(0,-20)),s=t.slice(-20).toString("hex");if(s!==i)throw new In(`Invalid checksum in GitIndex buffer: expected ${s} but saw ${i}`);const o=r.readUInt32BE();if(o!==2)throw new In(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let u=0;for(;!r.eof()&&u<l;){const d={};d.ctimeSeconds=r.readUInt32BE(),d.ctimeNanoseconds=r.readUInt32BE(),d.mtimeSeconds=r.readUInt32BE(),d.mtimeNanoseconds=r.readUInt32BE(),d.dev=r.readUInt32BE(),d.ino=r.readUInt32BE(),d.mode=r.readUInt32BE(),d.uid=r.readUInt32BE(),d.gid=r.readUInt32BE(),d.size=r.readUInt32BE(),d.oid=r.slice(20).toString("hex");const h=r.readUInt16BE();d.flags=Qne(h);const p=t.indexOf(0,r.tell()+1)-r.tell();if(p<1)throw new In(`Got a path length of: ${p}`);if(d.path=r.toString("utf8",p),d.path.includes("..\\")||d.path.includes("../"))throw new cp(d.path);let y=8-(r.tell()-12)%8;for(y===0&&(y=8);y--;){const v=r.readUInt8();if(v!==0)throw new In(`Expected 1-8 null characters but got '${v}' after ${d.path}`);if(r.eof())throw new In("Unexpected end of file")}d.stages=[],n._addEntry(d),u++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(t5)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:a=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=Fh(n);const i=Xt.from(t),s={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:a,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(s),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=Xt.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,a=Xt.alloc(r),i=new Fo(a),s=Fh(t);return i.writeUInt32BE(s.ctimeSeconds),i.writeUInt32BE(s.ctimeNanoseconds),i.writeUInt32BE(s.mtimeSeconds),i.writeUInt32BE(s.mtimeNanoseconds),i.writeUInt32BE(s.dev),i.writeUInt32BE(s.ino),i.writeUInt32BE(s.mode),i.writeUInt32BE(s.uid),i.writeUInt32BE(s.gid),i.writeUInt32BE(s.size),i.write(t.oid,20,"hex"),i.writeUInt16BE(ere(t)),i.write(t.path,n.length,"utf8"),a}async toObject(){const t=Xt.alloc(12),n=new Fo(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(vd._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(vd._entryToBuffer(l));r=await Promise.all(r);const a=Xt.concat(r),i=Xt.concat([t,a]),s=await Kl(i);return Xt.concat([i,Xt.from(s,"hex")])}}function Yv(e,t,n=!0,r=!0){const a=Fh(e),i=Fh(t);return n&&a.mode!==i.mode||a.mtimeSeconds!==i.mtimeSeconds||a.ctimeSeconds!==i.ctimeSeconds||a.uid!==i.uid||a.gid!==i.gid||r&&a.ino!==i.ino||a.size!==i.size}let wE=null;const xE=Symbol("IndexCache");function tre(){return{map:new Map,stats:new Map}}async function nre(e,t,n){const[r,a]=await Promise.all([e.lstat(t),e.read(t)]),i=await vd.from(a);n.map.set(t,i),n.stats.set(t,r)}async function rre(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const a=await e.lstat(t);return a===null?!1:Yv(r,a)}class $a{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:a=!0},i){r[xE]||(r[xE]=tre());const s=`${n}/index`;wE===null&&(wE=new Rg({maxPending:1/0}));let o,l=[];return await wE.acquire(s,async()=>{const u=r[xE];await rre(t,s,u)&&await nre(t,s,u);const d=u.map.get(s);if(l=d.unmergedPaths,l.length&&!a)throw new S0(l);if(o=await i(d),d._dirty){const h=await d.toObject();await t.write(s,h),u.stats.set(s,await t.lstat(s)),d._dirty=!1}}),o}}function Xv(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function Lh(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function a5(e){const t=new Map,n=function(a){if(!t.has(a)){const i={type:"tree",fullpath:a,basename:Xv(a),metadata:{},children:[]};t.set(a,i),i.parent=n(Lh(a)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return t.get(a)},r=function(a,i){if(!t.has(a)){const s={type:"blob",fullpath:a,basename:Xv(a),metadata:i,parent:n(Lh(a)),children:[]};s.parent&&s.parent.children.push(s),t.set(a,s)}return t.get(a)};n(".");for(const a of e)r(a.path,a);return t}function are(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new In(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class ire{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=$a.acquire({fs:t,gitdir:n,cache:r},async function(i){return a5(i.entries)});const a=this;this.ConstructEntry=class{constructor(s){this._fullpath=s,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return a.type(this)}async mode(){return a.mode(this)}async stat(){return a.stat(this)}async content(){return a.content(this)}async oid(){return a.oid(this)}}}async readdir(t){const n=t._fullpath,a=(await this.treePromise).get(n);if(!a||a.type==="blob")return null;if(a.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const i=a.children.map(s=>s.fullpath);return i.sort(hx),i}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const a=r.type==="tree"?{}:Fh(r.metadata);t._type=r.type==="tree"?"tree":are(a.mode),t._mode=a.mode,r.type==="tree"?t._stat=void 0:t._stat=a}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const px=Symbol("GitWalkSymbol");function up(){const e=Object.create(null);return Object.defineProperty(e,px,{value:function({fs:t,gitdir:n,cache:r}){return new ire({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class Ar extends sr{constructor(t){super(`Could not find ${t}.`),this.code=this.name=Ar.code,this.data={what:t}}}Ar.code="NotFoundError";class Ci extends sr{constructor(t,n,r,a){super(`Object ${t} ${a?`at ${a}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=Ci.code,this.data={oid:t,actual:n,expected:r,filepath:a}}}Ci.code="ObjectTypeError";class pu extends sr{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=pu.code,this.data={value:t}}}pu.code="InvalidOidError";class E0 extends sr{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=E0.code,this.data={remote:t}}}E0.code="NoRefspecError";class Jv{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const a=r.indexOf(" ");if(r.startsWith("^")){const i=r.slice(1);return this.refs.set(n+"^{}",i),{line:r,ref:n,peeled:i}}else{const i=r.slice(0,a);return n=r.slice(a+1),this.refs.set(n,i),{line:r,ref:n,oid:i}}})}return this}static from(t){return new Jv(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class Qv{constructor({remotePath:t,localPath:n,force:r,matchPrefix:a}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:a})}static from(t){const[n,r,a,i,s]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=a==="*";if(l!==(s==="*"))throw new In("Invalid refspec");return new Qv({remotePath:r,localPath:i,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class eT{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(Qv.from(r));return new eT(n)}add(t){const n=Qv.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const a of t){const i=r.translate(a);i&&n.push([a,i])}return n}translateOne(t){let n=null;for(const r of this.rules){const a=r.translate(t);a&&(n=a)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function sre(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),a=-(n<r)||+(n>r);return a===0?e.endsWith("^{}")?1:-1:a}const ore=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},Fm=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},a4={core:{filemode:Fm,bare:Fm,logallrefupdates:Fm,symlinks:Fm,ignorecase:Fm,bigFileThreshold:ore}},lre=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,cre=/^[A-Za-z0-9-.]+$/,ure=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,dre=/^[A-Za-z][A-Za-z-]*$/,fre=/^(.*?)( *[#;].*)$/,hre=e=>{const t=lre.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},pre=e=>{const t=ure.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),a=mre(r),i=gre(a);return[n,i]}return null},mre=e=>{const t=fre.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return i4(n)&&i4(r)?`${n}${r}`:n},i4=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,gre=e=>e.split("").reduce((t,n,r,a)=>{const i=n==='"'&&a[r-1]!=="\\",s=n==="\\"&&a[r+1]==='"';return i||s?t:t+n},""),s4=e=>e!=null?e.toLowerCase():null,eC=(e,t,n)=>[s4(e),t,s4(n)].filter(r=>r!=null).join("."),o4=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),a=t.length?t.join("."):void 0;return{section:n,subsection:a,name:r,path:eC(n,a,r),sectionPath:eC(n,a,null),isSection:!!n}},yre=(e,t)=>e.reduce((n,r,a)=>t(r)?a:n,-1);class tT{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(a=>{let i=null,s=null;const o=a.trim(),l=hre(o),u=l!=null;if(u)[n,r]=l;else{const h=pre(o);h!=null&&([i,s]=h)}const d=eC(n,r,i);return{line:a,isSection:u,section:n,subsection:r,name:i,value:s,path:d}}):[]}static from(t){return new tT(t)}async get(t,n=!1){const r=o4(t).path,a=this.parsedConfig.filter(i=>i.path===r).map(({section:i,name:s,value:o})=>{const l=a4[i]&&a4[i][s];return l?l(o):o});return n?a:a.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:a,subsection:i,name:s,path:o,sectionPath:l,isSection:u}=o4(t),d=yre(this.parsedConfig,h=>h.path===o);if(n==null)d!==-1&&this.parsedConfig.splice(d,1);else if(d!==-1){const h=this.parsedConfig[d],p=Object.assign({},h,{name:s,value:n,modified:!0});r?this.parsedConfig.splice(d+1,0,p):this.parsedConfig[d]=p}else{const h=this.parsedConfig.findIndex(y=>y.path===l),p={section:a,subsection:i,name:s,value:n,modified:!0,path:o};if(cre.test(a)&&dre.test(s))if(h>=0)this.parsedConfig.splice(h+1,0,p);else{const y={isSection:u,section:a,subsection:i,modified:!0,path:l};this.parsedConfig.push(y,p)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:a,value:i,modified:s=!1})=>s?a!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${a} = "${i}"`:`	${a} = ${i}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class ga{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return tT.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const Pb=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],bre=["config","description","index","shallow","commondir"];let _E;async function Bc(e,t){return _E===void 0&&(_E=new Rg),_E.acquire(e,t)}class zt{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:a,symrefs:i,tags:s,refspecs:o=void 0,prune:l=!1,pruneTags:u=!1}){for(const w of a.values())if(!w.match(/[0-9a-f]{40}/))throw new pu(w);const d=await ga.get({fs:t,gitdir:n});if(!o){if(o=await d.getall(`remote.${r}.fetch`),o.length===0)throw new E0(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const h=eT.from(o),p=new Map;if(u){const w=await zt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await zt.deleteRefs({fs:t,gitdir:n,refs:w.map(x=>`refs/tags/${x}`)})}if(s){for(const w of a.keys())if(w.startsWith("refs/tags")&&!w.endsWith("^{}")&&!await zt.exists({fs:t,gitdir:n,ref:w})){const x=a.get(w);p.set(w,x)}}const y=h.translate([...a.keys()]);for(const[w,x]of y){const S=a.get(w);p.set(x,S)}const v=h.translate([...i.keys()]);for(const[w,x]of v){const S=i.get(w),E=h.translateOne(S);E&&p.set(x,`ref: ${E}`)}const b=[];if(l){for(const w of h.localNamespaces()){const x=(await zt.listRefs({fs:t,gitdir:n,filepath:w})).map(S=>`${w}/${S}`);for(const S of x)p.has(S)||b.push(S)}b.length>0&&await zt.deleteRefs({fs:t,gitdir:n,refs:b})}for(const[w,x]of p)await Bc(w,async()=>t.write(jt.join(n,w),`${x.trim()}
`,"utf8"));return{pruned:b}}static async writeRef({fs:t,gitdir:n,ref:r,value:a}){if(!a.match(/[0-9a-f]{40}/))throw new pu(a);await Bc(r,async()=>t.write(jt.join(n,r),`${a.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:a}){await Bc(r,async()=>t.write(jt.join(n,r),`ref: ${a.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return zt.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm(jt.join(n,o))));let a=await Bc("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const i=Jv.from(a),s=i.refs.size;for(const o of r)i.refs.has(o)&&i.delete(o);i.refs.size<s&&(a=i.toString(),await Bc("packed-refs",async()=>t.write(`${n}/packed-refs`,a,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:a=void 0}){if(a!==void 0&&(a--,a===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),zt.resolve({fs:t,gitdir:n,ref:r,depth:a});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await zt.packedRefs({fs:t,gitdir:n}),s=Pb(r).filter(o=>!bre.includes(o));for(const o of s){const l=await Bc(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||i.get(o));if(l)return zt.resolve({fs:t,gitdir:n,ref:l.trim(),depth:a})}throw new Ar(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await zt.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const a=await zt.packedRefs({fs:t,gitdir:n}),i=Pb(r);for(const s of i)if(await Bc(s,async()=>t.exists(`${n}/${s}`))||a.has(s))return s;throw new Ar(r)}static async expandAgainstMap({ref:t,map:n}){const r=Pb(t);for(const a of r)if(await n.has(a))return a;throw new Ar(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:a}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),zt.resolveAgainstMap({ref:t,fullref:n,depth:r,map:a});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const i=Pb(t);for(const s of i){const o=a.get(s);if(o)return zt.resolveAgainstMap({ref:o.trim(),fullref:s,depth:r,map:a})}throw new Ar(t)}static async packedRefs({fs:t,gitdir:n}){const r=await Bc("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return Jv.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const a=zt.packedRefs({fs:t,gitdir:n});let i=null;try{i=await t.readdirDeep(`${n}/${r}`),i=i.map(s=>s.replace(`${n}/${r}/`,""))}catch{i=[]}for(let s of(await a).keys())s.startsWith(r)&&(s=s.replace(r+"/",""),i.includes(s)||i.push(s));return i.sort(sre),i}static async listBranches({fs:t,gitdir:n,remote:r}){return r?zt.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):zt.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await zt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(a=>!a.endsWith("^{}"))}}function vre(e,t){return hx(l4(e),l4(t))}function l4(e){return e.mode==="040000"?e.path+"/":e.path}function i5(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new In(`Unexpected GitTree entry mode: ${e}`)}function wre(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new In(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const a=e.indexOf(0,n);if(a===-1)throw new In(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let i=e.slice(n,r).toString("utf8");i==="40000"&&(i="040000");const s=i5(i),o=e.slice(r+1,a).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new cp(o);const l=e.slice(a+1,a+21).toString("hex");n=a+21,t.push({mode:i,path:o,oid:l,type:s})}return t}function xre(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new In(`Could not understand file mode: ${e}`)}function _re(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=xre(e.mode),e.type||(e.type=i5(e.mode)),e}class Fi{constructor(t){if(Xt.isBuffer(t))this._entries=wre(t);else if(Array.isArray(t))this._entries=t.map(_re);else throw new In("invalid type passed to GitTree constructor");this._entries.sort(t5)}static from(t){return new Fi(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(vre),Xt.concat(t.map(n=>{const r=Xt.from(n.mode.replace(/^0/,"")),a=Xt.from(" "),i=Xt.from(n.path,"utf8"),s=Xt.from([0]),o=Xt.from(n.oid,"hex");return Xt.concat([r,a,i,s,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class dp{static wrap({type:t,object:n}){return Xt.concat([Xt.from(`${t} ${n.byteLength.toString()}\0`),Xt.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),a=t.slice(0,n).toString("utf8"),i=t.slice(n+1,r).toString("utf8"),s=t.length-(r+1);if(parseInt(i)!==s)throw new In(`Length mismatch: expected ${i} bytes but got ${s} instead.`);return{type:a,object:Xt.from(t.slice(r+1))}}}async function s5({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,a=await e.read(`${t}/${r}`);return a?{object:a,format:"deflated",source:r}:null}function Sre(e,t){const n=new Fo(e),r=c4(n);if(r!==t.byteLength)throw new In(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const a=c4(n);let i;const s=d4(n,t);if(s.byteLength===a)i=s;else{i=Xt.alloc(a);const o=new Fo(i);for(o.copy(s);!n.eof();)o.copy(d4(n,t));const l=o.tell();if(a!==l)throw new In(`applyDelta expected target buffer to be ${a} bytes but the resulting buffer was ${l} bytes`)}return i}function c4(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function u4(e,t,n){let r=0,a=0;for(;n--;)t&1&&(r|=e.readUInt8()<<a),t>>=1,a+=8;return r}function d4(e,t){const n=e.readUInt8(),r=128,a=15,i=112;if(n&r){const s=u4(e,n&a,4);let o=u4(e,(n&i)>>4,3);return o===0&&(o=65536),t.slice(s,s+o)}else return e.slice(n)}function Ere(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function o5(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:Ere(e)}class l5{constructor(t){if(typeof Xt>"u")throw new Error("Missing Buffer dependency");this.stream=o5(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?Xt.alloc(0):(n&&(n=Xt.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>Cre(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=Xt.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function Cre(e){return e.reduce((t,n)=>t+n.length,0)}async function kre(e,t){const n=new l5(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new In(`Invalid PACK header '${r}'`);let a=await n.read(4);if(a=a.readUInt32BE(0),a!==2)throw new In(`Invalid packfile version: ${a}`);let i=await n.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!n.eof()&&i--;){const s=n.tell(),{type:o,length:l,ofs:u,reference:d}=await Tre(n),h=new Qk.Inflate;for(;!h.result;){const p=await n.chunk();if(!p)break;if(h.push(p,!1),h.err)throw new In(`Pako error: ${h.msg}`);if(h.result){if(h.result.length!==l)throw new In("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(p.length-h.strm.avail_in);const y=n.tell();await t({data:h.result,type:o,num:i,offset:s,end:y,reference:d,ofs:u})}}}}async function Tre(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let s=4;do t=await e.byte(),r|=(t&127)<<s,s+=7;while(t&128)}let a,i;if(n===6){let s=0;a=0;const o=[];do t=await e.byte(),a|=(t&127)<<s,s+=7,o.push(t);while(t&128);i=Xt.from(o)}return n===7&&(i=await e.read(20)),{type:n,length:r,ofs:a,reference:i}}async function c5(e){return Qk.inflate(e)}function Are(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const a=n&127;t.push(a),r=n&128}while(r);return t.reduce((a,i)=>a+1<<7|i,-1)}function Nre(e,t){let n=t,r=4,a=null;do a=e.readUInt8(),n|=(a&127)<<r,r+=7;while(a&128);return n}class $h{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new Fo(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const i=r.readUInt32BE();if(i!==2)throw new In(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new In("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const s=r.readUInt32BE(),o=[];for(let d=0;d<s;d++){const h=r.slice(20).toString("hex");o[d]=h}r.seek(r.tell()+4*s);const l=new Map;for(let d=0;d<s;d++)l.set(o[d],r.readUInt32BE());const u=r.slice(20).toString("hex");return new $h({hashes:o,crcs:{},offsets:l,packfileSha:u,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const a={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},s=t.slice(-20).toString("hex"),o=[],l={},u=new Map;let d=null,h=null;await kre([t],async({data:w,type:x,reference:S,offset:E,num:C})=>{d===null&&(d=C);const k=Math.floor((d-C)*100/d);k!==h&&r&&await r({phase:"Receiving objects",loaded:d-C,total:d}),h=k,x=a[x],["commit","tree","blob","tag"].includes(x)?i[E]={type:x,offset:E}:x==="ofs-delta"?i[E]={type:x,offset:E}:x==="ref-delta"&&(i[E]={type:x,offset:E})});const p=Object.keys(i).map(Number);for(const[w,x]of p.entries()){const S=w+1===p.length?t.byteLength-20:p[w+1],E=i[x],C=Ane.buf(t.slice(x,S))>>>0;E.end=S,E.crc=C}const y=new $h({pack:Promise.resolve(t),packfileSha:s,crcs:l,hashes:o,offsets:u,getExternalRefDelta:n});h=null;let v=0;const b=[0,0,0,0,0,0,0,0,0,0,0,0];for(let w in i){w=Number(w);const x=Math.floor(v*100/d);x!==h&&r&&await r({phase:"Resolving deltas",loaded:v,total:d}),v++,h=x;const S=i[w];if(!S.oid)try{y.readDepth=0,y.externalReadDepth=0;const{type:E,object:C}=await y.readSlice({start:w});b[y.readDepth]+=1;const k=await Kl(dp.wrap({type:E,object:C}));S.oid=k,o.push(k),u.set(k,w),l[k]=S.crc}catch{continue}}return o.sort(),y}async toBuffer(){const t=[],n=(u,d)=>{t.push(Xt.from(u,d))};n("ff744f63","hex"),n("00000002","hex");const r=new Fo(Xt.alloc(256*4));for(let u=0;u<256;u++){let d=0;for(const h of this.hashes)parseInt(h.slice(0,2),16)<=u&&d++;r.writeUInt32BE(d)}t.push(r.buffer);for(const u of this.hashes)n(u,"hex");const a=new Fo(Xt.alloc(this.hashes.length*4));for(const u of this.hashes)a.writeUInt32BE(this.crcs[u]);t.push(a.buffer);const i=new Fo(Xt.alloc(this.hashes.length*4));for(const u of this.hashes)i.writeUInt32BE(this.offsets.get(u));t.push(i.buffer),n(this.packfileSha,"hex");const s=Xt.concat(t),o=await Kl(s),l=Xt.alloc(20);return l.write(o,"hex"),Xt.concat([s,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new In(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new In("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),a=new Fo(r),i=a.readUInt8(),s=i&112;let o=n[s];if(o===void 0)throw new In("Unrecognized type: 0b"+s.toString(2));const l=i&15;let u=l;i&128&&(u=Nre(a,l));let h=null,p=null;if(o==="ofs_delta"){const v=Are(a),b=t-v;({object:h,type:o}=await this.readSlice({start:b}))}if(o==="ref_delta"){const v=a.slice(20).toString("hex");({object:h,type:o}=await this.read({oid:v}))}const y=r.slice(a.tell());if(p=Xt.from(await c5(y)),p.byteLength!==u)throw new In(`Packfile told us object would have length ${u} but it had length ${p.byteLength}`);return h&&(p=Xt.from(Sre(p,h))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:p}),{type:o,format:"content",object:p}}}const Fb=Symbol("PackfileCache");async function Rre({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:a}){const i=await e.read(t);return $h.fromIdx({idx:i,getExternalRefDelta:n})}function nT({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:a,emitterPrefix:i}){t[Fb]||(t[Fb]=new Map);let s=t[Fb].get(n);return s||(s=Rre({fs:e,filename:n,getExternalRefDelta:r,emitter:a,emitterPrefix:i}),t[Fb].set(n,s)),s}async function Ire({fs:e,cache:t,gitdir:n,oid:r,format:a="content",getExternalRefDelta:i}){let s=await e.readdir(jt.join(n,"objects/pack"));s=s.filter(o=>o.endsWith(".idx"));for(const o of s){const l=`${n}/objects/pack/${o}`,u=await nT({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(u.error)throw new In(u.error);if(u.offsets.has(r)){if(!u.pack){const h=l.replace(/idx$/,"pack");u.pack=e.read(h)}const d=await u.read({oid:r,getExternalRefDelta:i});return d.format="content",d.source=`objects/pack/${o.replace(/idx$/,"pack")}`,d}}return null}async function Gr({fs:e,cache:t,gitdir:n,oid:r,format:a="content"}){const i=d=>Gr({fs:e,cache:t,gitdir:n,oid:d});let s;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(s={format:"wrapped",object:Xt.from("tree 0\0")}),s||(s=await s5({fs:e,gitdir:n,oid:r})),!s){if(s=await Ire({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}),!s)throw new Ar(r);return s}if(a==="deflated"||(s.format==="deflated"&&(s.object=Xt.from(await c5(s.object)),s.format="wrapped"),a==="wrapped"))return s;const o=await Kl(s.object);if(o!==r)throw new In(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:u}=dp.unwrap(s.object);if(s.type=u,s.object=l,s.format="content",a==="content")return s;throw new In(`invalid requested format "${a}"`)}class co extends sr{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=co.code,this.data={noun:t,where:n,canForce:r}}}co.code="AlreadyExistsError";class C0 extends sr{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=C0.code,this.data={nouns:t,short:n,matches:r}}}C0.code="AmbiguousError";class k0 extends sr{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=k0.code,this.data={filepaths:t}}}k0.code="CheckoutConflictError";class T0 extends sr{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=T0.code,this.data={ref:t,oid:n}}}T0.code="CommitNotFetchedError";class A0 extends sr{constructor(){super("Empty response from git server."),this.code=this.name=A0.code,this.data={}}}A0.code="EmptyServerResponseError";class N0 extends sr{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=N0.code,this.data={}}}N0.code="FastForwardError";class R0 extends sr{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=R0.code,this.data={prettyDetails:t,result:n}}}R0.code="GitPushError";class Bh extends sr{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=Bh.code,this.data={statusCode:t,statusMessage:n,response:r}}}Bh.code="HttpError";class mu extends sr{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=mu.code,this.data={reason:t}}}mu.code="InvalidFilepathError";class ao extends sr{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=ao.code,this.data={ref:t,suggestion:n}}}ao.code="InvalidRefNameError";class I0 extends sr{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=I0.code,this.data={depth:t}}}I0.code="MaxDepthError";class fp extends sr{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=fp.code,this.data={}}}fp.code="MergeNotSupportedError";class hp extends sr{constructor(t,n,r,a){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=hp.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:a}}}hp.code="MergeConflictError";class ui extends sr{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=ui.code,this.data={role:t}}}ui.code="MissingNameError";class Mi extends sr{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=Mi.code,this.data={parameter:t}}}Mi.code="MissingParameterError";class j0 extends sr{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=j0.code,this.data={errors:t},this.errors=t}}j0.code="MultipleGitError";class sf extends sr{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=sf.code,this.data={expected:t,actual:n}}}sf.code="ParseError";class zh extends sr{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=zh.code,this.data={reason:t}}}zh.code="PushRejectedError";class Zc extends sr{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=Zc.code,this.data={capability:t,parameter:n}}}Zc.code="RemoteCapabilityError";class O0 extends sr{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=O0.code,this.data={preview:t,response:n}}}O0.code="SmartHttpError";class D0 extends sr{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=D0.code,this.data={url:t,transport:n,suggestion:r}}}D0.code="UnknownTransportError";class M0 extends sr{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=M0.code,this.data={url:t}}}M0.code="UrlParseError";class pp extends sr{constructor(){super("The operation was canceled."),this.code=this.name=pp.code,this.data={}}}pp.code="UserCanceledError";class P0 extends sr{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=P0.code,this.data={filepath:t}}}P0.code="IndexResetError";class F0 extends sr{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=F0.code,this.data={ref:t}}}F0.code="NoCommitError";var jre=Object.freeze({__proto__:null,AlreadyExistsError:co,AmbiguousError:C0,CheckoutConflictError:k0,CommitNotFetchedError:T0,EmptyServerResponseError:A0,FastForwardError:N0,GitPushError:R0,HttpError:Bh,InternalError:In,InvalidFilepathError:mu,InvalidOidError:pu,InvalidRefNameError:ao,MaxDepthError:I0,MergeNotSupportedError:fp,MergeConflictError:hp,MissingNameError:ui,MissingParameterError:Mi,MultipleGitError:j0,NoRefspecError:E0,NotFoundError:Ar,ObjectTypeError:Ci,ParseError:sf,PushRejectedError:zh,RemoteCapabilityError:Zc,SmartHttpError:O0,UnknownTransportError:D0,UnsafeFilepathError:cp,UrlParseError:M0,UserCanceledError:pp,UnmergedPathsError:S0,IndexResetError:P0,NoCommitError:F0});function tC({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=Ore(r),`${e} <${t}> ${n} ${r}`}function Ore(e){const t=Dre(Mre(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),a=String(e);return r.length<2&&(r="0"+r),a.length<2&&(a="0"+a),(t===-1?"-":"+")+r+a}function Dre(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function Mre(e){return e===0?e:-e}function jl(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function ew(e){const[,t,n,r,a]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:Pre(a)}}function Pre(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),Fre(r)}function Fre(e){return e===0?e:-e}class wi{constructor(t){if(typeof t=="string")this._tag=t;else if(Xt.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=wi.render(t);else throw new In("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new wi(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${tC(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const a of t)a[0]===" "?n[n.length-1]+=`
`+a.slice(1):n.push(a);const r={};for(const a of n){const i=a.slice(0,a.indexOf(" ")),s=a.slice(a.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(s):r[i]=s}return r.tagger&&(r.tagger=ew(r.tagger)),r.committer&&(r.committer=ew(r.committer)),r}withoutSignature(){const t=jl(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return jl(t)}payload(){return this.withoutSignature()+`
`}toObject(){return Xt.from(this._tag,"utf8")}static async sign(t,n,r){const a=t.payload();let{signature:i}=await n({payload:a,secretKey:r});i=jl(i);const s=a+i;return wi.from(s)}}function SE(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function Lre(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class Vr{constructor(t){if(typeof t=="string")this._commit=t;else if(Xt.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=Vr.render(t);else throw new In("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=Vr.justHeaders(t),a=Vr.justMessage(t),i=jl(r+`
gpgsig`+SE(n)+`
`+a);return new Vr(i)}static from(t){return new Vr(t)}toObject(){return Xt.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Vr.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return jl(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=Vr.justHeaders(this._commit).split(`
`),n=[];for(const a of t)a[0]===" "?n[n.length-1]+=`
`+a.slice(1):n.push(a);const r={parent:[]};for(const a of n){const i=a.slice(0,a.indexOf(" ")),s=a.slice(a.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(s):r[i]=s}return r.author&&(r.author=ew(r.author)),r.committer&&(r.committer=ew(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new In("commit 'parent' property should be an array");for(const i of t.parent)n+=`parent ${i}
`}const r=t.author;n+=`author ${tC(r)}
`;const a=t.committer||t.author;return n+=`committer ${tC(a)}
`,t.gpgsig&&(n+="gpgsig"+SE(t.gpgsig)),n}static render(t){return Vr.renderHeaders(t)+`
`+jl(t.message)}render(){return this._commit}withoutSignature(){const t=jl(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return jl(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return Lre(t)}static async sign(t,n,r){const a=t.withoutSignature(),i=Vr.justMessage(t._commit);let{signature:s}=await n({payload:a,secretKey:r});s=jl(s);const l=Vr.justHeaders(t._commit)+`
gpgsig`+SE(s)+`
`+i;return Vr.from(l)}}async function Uh({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Fi.from([]),oid:r};const{type:a,object:i}=await Gr({fs:e,cache:t,gitdir:n,oid:r});if(a==="tag")return r=wi.from(i).parse().object,Uh({fs:e,cache:t,gitdir:n,oid:r});if(a==="commit")return r=Vr.from(i).parse().tree,Uh({fs:e,cache:t,gitdir:n,oid:r});if(a!=="tree")throw new Ci(r,a,"tree");return{tree:Fi.from(i),oid:r}}class $re{constructor({fs:t,gitdir:n,ref:r,cache:a}){this.fs=t,this.cache=a,this.gitdir=n,this.mapPromise=(async()=>{const s=new Map;let o;try{o=await zt.resolve({fs:t,gitdir:n,ref:r})}catch(u){u instanceof Ar&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await Uh({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",s.set(".",l),s})();const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:a,gitdir:i}=this,s=await this.mapPromise,o=s.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:u,object:d}=await Gr({fs:r,cache:a,gitdir:i,oid:l});if(u!==o.type)throw new Ci(l,u,o.type);const h=Fi.from(d);for(const p of h)s.set(jt.join(n,p.path),p);return h.entries().map(p=>jt.join(n,p.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=n5(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:a,gitdir:i}=this,o=n.get(t._fullpath).oid,{type:l,object:u}=await Gr({fs:r,cache:a,gitdir:i,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(u)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function Es({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,px,{value:function({fs:n,gitdir:r,cache:a}){return new $re({fs:n,gitdir:r,ref:e,cache:a})}}),Object.freeze(t),t}class Bre{constructor({fs:t,dir:n,gitdir:r,cache:a}){this.fs=t,this.cache=a,this.dir=n,this.gitdir=r,this.config=null;const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:a}=this,i=await r.readdir(jt.join(a,n));return i===null?null:i.map(s=>jt.join(n,s))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let a=await n.lstat(`${r}/${t._fullpath}`);if(!a)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let i=a.isDirectory()?"tree":"blob";i==="blob"&&!a.isFile()&&!a.isSymbolicLink()&&(i="special"),t._type=i,a=Fh(a),t._mode=a.mode,a.size===-1&&t._actualSize&&(a.size=t._actualSize),t._stat=a}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:a}=this;if(await t.type()==="tree")t._content=void 0;else{const s=await(await this._getGitConfig(n,a)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:s});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:a,cache:i}=this;let s;await $a.acquire({fs:r,gitdir:a,cache:i},async function(o){const l=o.entriesMap.get(t._fullpath),u=await t.stat(),h=await(await n._getGitConfig(r,a)).get("core.filemode"),p=typeof ea<"u"?ea.platform!=="win32":!0;if(!l||Yv(u,l,h,p)){const y=await t.content();y===void 0?s=void 0:(s=await Kl(dp.wrap({type:"blob",object:y})),l&&s===l.oid&&(!h||u.mode===l.mode)&&Yv(u,l,h,p)&&o.insert({filepath:t._fullpath,stats:u,oid:s}))}else s=l.oid}),t._oid=s}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await ga.get({fs:t,gitdir:n}),this.config)}}function L0(){const e=Object.create(null);return Object.defineProperty(e,px,{value:function({fs:t,dir:n,gitdir:r,cache:a}){return new Bre({fs:t,dir:n,gitdir:r,cache:a})}}),Object.freeze(e),e}function zre(e,t){const n=t-e;return Array.from({length:n},(r,a)=>e+a)}const u5=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class Ure{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*qre(e){const t=new Ure;let n;const r=[],a=e.length;for(let i=0;i<a;i++)r[i]=e[i].next().value,r[i]!==void 0&&t.consider(r[i]);if(t.value!==null)for(;;){const i=[];n=t.value,t.reset();for(let s=0;s<a;s++)r[s]!==void 0&&r[s]===n?(i[s]=r[s],r[s]=e[s].next().value):i[s]=null,r[s]!==void 0&&t.consider(r[s]);if(yield i,t.value===null)return}}async function gu({fs:e,cache:t,dir:n,gitdir:r,trees:a,map:i=async(l,u)=>u,reduce:s=async(l,u)=>{const d=u5(u);return l!==void 0&&d.unshift(l),d},iterate:o=(l,u)=>Promise.all([...u].map(l))}){const l=a.map(y=>y[px]({fs:e,dir:n,gitdir:r,cache:t})),u=new Array(l.length).fill("."),d=zre(0,l.length),h=async y=>{d.map(w=>{const x=y[w];y[w]=x&&new l[w].ConstructEntry(x)});const b=(await Promise.all(d.map(w=>{const x=y[w];return x?l[w].readdir(x):[]}))).map(w=>(w===null?[]:w)[Symbol.iterator]());return{entries:y,children:qre(b)}},p=async y=>{const{entries:v,children:b}=await h(y),w=v.find(S=>S&&S._fullpath)._fullpath,x=await i(w,v);if(x!==null){let S=await o(p,b);return S=S.filter(E=>E!==void 0),s(x,S)}};return p(u)}async function nC(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const a=jt.join(t,r);return e.lstat(a).then(i=>{if(i)return i.isDirectory()?nC(e,a):e.rm(a)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function Hre(e){return Vre(e)&&f4(e.then)&&f4(e.catch)}function Vre(e){return e&&typeof e=="object"}function f4(e){return typeof e=="function"}function h4(e){return Hre((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const p4=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function m4(e,t){if(h4(t))for(const n of p4)e[`_${n}`]=t[n].bind(t);else for(const n of p4)e[`_${n}`]=pE(t[n].bind(t));h4(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=nC.bind(null,e):t.rm?e._rm=pE(t.rm.bind(t)):t.rmdir.length>2?e._rm=pE(t.rmdir.bind(t)):e._rm=nC.bind(null,e)}class cn{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?m4(this,t.promises):m4(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=Xt.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(Lh(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const a=Lh(t);if(a==="."||a==="/"||a===t)throw r;await this.mkdir(a),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(hx),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async a=>{const i=t+"/"+a;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((a,i)=>a.concat(i),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return Xt.isBuffer(r)?r:Xt.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function Je(e,t){if(t===void 0)throw new Mi(e)}async function tw(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function Gre({fs:e,dir:t,gitdir:n=jt.join(t,".git"),commit:r="HEAD",cache:a={}}){try{Je("fs",e),Je("dir",t),Je("gitdir",n);const i=new cn(e),s=[Es({ref:r}),L0(),up()];let o=[];await $a.acquire({fs:i,gitdir:n,cache:a},async function(u){o=u.unmergedPaths});const l=await gu({fs:i,cache:a,dir:t,gitdir:n,trees:s,map:async function(u,[d,h,p]){const y=!await tw(h,p),v=o.includes(u),b=!await tw(p,d);if(y||v)return d?{path:u,mode:await d.mode(),oid:await d.oid(),type:await d.type(),content:await d.content()}:void 0;if(b)return!1;throw new P0(u)}});await $a.acquire({fs:i,gitdir:n,cache:a},async function(u){for(const d of l)if(d!==!1){if(!d){await i.rmdir(`${t}/${d.path}`,{recursive:!0}),u.delete({filepath:d.path});continue}if(d.type==="blob"){const h=new TextDecoder().decode(d.content);await i.write(`${t}/${d.path}`,h,{mode:d.mode}),u.insert({filepath:d.path,oid:d.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class mp{static async isIgnored({fs:t,dir:n,gitdir:r=jt.join(n,".git"),filepath:a}){if(Xv(a)===".git")return!0;if(a===".")return!1;let i="";const s=jt.join(r,"info","exclude");await t.exists(s)&&(i=await t.read(s,"utf8"));const o=[{gitignore:jt.join(n,".gitignore"),filepath:a}],l=a.split("/").filter(Boolean);for(let d=1;d<l.length;d++){const h=l.slice(0,d).join("/"),p=l.slice(d).join("/");o.push({gitignore:jt.join(n,h,".gitignore"),filepath:p})}let u=!1;for(const d of o){let h;try{h=await t.read(d.gitignore,"utf8")}catch(v){if(v.code==="NOENT")continue}const p=qne().add(i);p.add(h);const y=Lh(d.filepath);if(y!=="."&&p.ignores(y))return!0;u?u=!p.test(d.filepath).unignored:u=p.test(d.filepath).ignored}return u}}async function Wre({fs:e,gitdir:t,object:n,format:r,oid:a}){const i=`objects/${a.slice(0,2)}/${a.slice(2)}`,s=`${t}/${i}`;await e.exists(s)||await e.write(s,n)}let EE=null;async function d5(e){return EE===null&&(EE=Zre()),EE?Kre(e):Qk.deflate(e)}async function Kre(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function Zre(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function $i({fs:e,gitdir:t,type:n,object:r,format:a="content",oid:i=void 0,dryRun:s=!1}){return a!=="deflated"&&(a!=="wrapped"&&(r=dp.wrap({type:n,object:r})),i=await Kl(r),r=Xt.from(await d5(r))),s||await Wre({fs:e,gitdir:t,object:r,format:"deflated",oid:i}),i}function f5(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function Yre({fs:e,dir:t,gitdir:n=jt.join(t,".git"),filepath:r,cache:a={},force:i=!1,parallel:s=!0}){try{Je("fs",e),Je("dir",t),Je("gitdir",n),Je("filepath",r);const o=new cn(e);await $a.acquire({fs:o,gitdir:n,cache:a},async l=>{const d=await(await ga.get({fs:o,gitdir:n})).get("core.autocrlf");return rC({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:i,parallel:s,autocrlf:d})})}catch(o){throw o.caller="git.add",o}}async function rC({dir:e,gitdir:t,fs:n,filepath:r,index:a,force:i,parallel:s,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async p=>{if(!i&&await mp.isIgnored({fs:n,dir:e,gitdir:t,filepath:p}))return;const y=await n.lstat(jt.join(e,p));if(!y)throw new Ar(p);if(y.isDirectory()){const v=await n.readdir(jt.join(e,p));if(s){const b=v.map(w=>rC({dir:e,gitdir:t,fs:n,filepath:[jt.join(p,w)],index:a,force:i,parallel:s,autocrlf:o}));await Promise.all(b)}else for(const b of v)await rC({dir:e,gitdir:t,fs:n,filepath:[jt.join(p,b)],index:a,force:i,parallel:s,autocrlf:o})}else{const v=y.isSymbolicLink()?await n.readlink(jt.join(e,p)).then(f5):await n.read(jt.join(e,p),{autocrlf:o});if(v===null)throw new Ar(p);const b=await $i({fs:n,gitdir:t,type:"blob",object:v});a.insert({filepath:p,stats:y,oid:b})}}),u=await Promise.allSettled(l),d=u.filter(p=>p.status==="rejected").map(p=>p.reason);if(d.length>1)throw new j0(d);if(d.length===1)throw d[0];return u.filter(p=>p.status==="fulfilled"&&p.value).map(p=>p.value)}async function Ig({fs:e,gitdir:t,path:n}){return(await ga.get({fs:e,gitdir:t})).get(n)}function h5(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const a=n[r];a!==void 0&&(e[r]=a)}return e}async function yu({fs:e,gitdir:t,author:n,commit:r}){const a=Math.floor(Date.now()/1e3),i={name:await Ig({fs:e,gitdir:t,path:"user.name"}),email:await Ig({fs:e,gitdir:t,path:"user.email"})||"",timestamp:a,timezoneOffset:new Date(a*1e3).getTimezoneOffset()},s=h5({},i,r?r.author:void 0,n);if(s.name!==void 0)return s}async function qh({fs:e,gitdir:t,author:n,committer:r,commit:a}){const i=Math.floor(Date.now()/1e3),s={name:await Ig({fs:e,gitdir:t,path:"user.name"}),email:await Ig({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},o=h5({},s,a?a.committer:void 0,n,r);if(o.name!==void 0)return o}async function p5({fs:e,cache:t,gitdir:n,oid:r}){const{type:a,object:i}=await Gr({fs:e,cache:t,gitdir:n,oid:r});if(a==="tag")return r=wi.from(i).parse().object,p5({fs:e,cache:t,gitdir:n,oid:r});if(a!=="commit")throw new Ci(r,a,"commit");return{commit:Vr.from(i),oid:r}}async function Hh({fs:e,cache:t,gitdir:n,oid:r}){const{commit:a,oid:i}=await p5({fs:e,cache:t,gitdir:n,oid:r});return{oid:i,commit:a.parse(),payload:a.withoutSignature()}}async function mx({fs:e,cache:t,onSign:n,gitdir:r,message:a,author:i,committer:s,signingKey:o,amend:l=!1,dryRun:u=!1,noUpdateBranch:d=!1,ref:h,parent:p,tree:y}){let v=!1;h||(h=await zt.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let b,w;try{b=await zt.resolve({fs:e,gitdir:r,ref:h}),w=await Hh({fs:e,gitdir:r,oid:b,cache:{}})}catch{v=!0}if(l&&v)throw new F0(h);const x=l?await yu({fs:e,gitdir:r,author:i,commit:w.commit}):await yu({fs:e,gitdir:r,author:i});if(!x)throw new ui("author");const S=l?await qh({fs:e,gitdir:r,author:x,committer:s,commit:w.commit}):await qh({fs:e,gitdir:r,author:x,committer:s});if(!S)throw new ui("committer");return $a.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(E){const k=a5(E.entries).get(".");if(y||(y=await m5({fs:e,gitdir:r,inode:k,dryRun:u})),p?p=await Promise.all(p.map(j=>zt.resolve({fs:e,gitdir:r,ref:j}))):l?p=w.commit.parent:p=b?[b]:[],!a)if(l)a=w.commit.message;else throw new Mi("message");let R=Vr.from({tree:y,parent:p,author:x,committer:S,message:a});o&&(R=await Vr.sign(R,n,o));const O=await $i({fs:e,gitdir:r,type:"commit",object:R.toObject(),dryRun:u});return!d&&!u&&await zt.writeRef({fs:e,gitdir:r,ref:h,value:O}),O})}async function m5({fs:e,gitdir:t,inode:n,dryRun:r}){const a=n.children;for(const l of a)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await m5({fs:e,gitdir:t,inode:l,dryRun:r}));const i=a.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),s=Fi.from(i);return await $i({fs:e,gitdir:t,type:"tree",object:s.toObject(),dryRun:r})}async function $0({fs:e,cache:t,gitdir:n,oid:r,filepath:a}){if(a.startsWith("/"))throw new mu("leading-slash");if(a.endsWith("/"))throw new mu("trailing-slash");const i=r,s=await Uh({fs:e,cache:t,gitdir:n,oid:r}),o=s.tree;if(a==="")r=s.oid;else{const l=a.split("/");r=await g5({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:i,filepath:a})}return r}async function g5({fs:e,cache:t,gitdir:n,tree:r,pathArray:a,oid:i,filepath:s}){const o=a.shift();for(const l of r)if(l.path===o){if(a.length===0)return l.oid;{const{type:u,object:d}=await Gr({fs:e,cache:t,gitdir:n,oid:l.oid});if(u!=="tree")throw new Ci(i,u,"tree",s);return r=Fi.from(d),g5({fs:e,cache:t,gitdir:n,tree:r,pathArray:a,oid:i,filepath:s})}}throw new Ar(`file or directory found at "${i}:${s}"`)}async function gp({fs:e,cache:t,gitdir:n,oid:r,filepath:a=void 0}){a!==void 0&&(r=await $0({fs:e,cache:t,gitdir:n,oid:r,filepath:a}));const{tree:i,oid:s}=await Uh({fs:e,cache:t,gitdir:n,oid:r});return{oid:s,tree:i.entries()}}async function B0({fs:e,gitdir:t,tree:n}){const r=Fi.from(n).toObject();return await $i({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function Xre({fs:e,cache:t,onSign:n,gitdir:r,ref:a,oid:i,note:s,force:o,author:l,committer:u,signingKey:d}){let h;try{h=await zt.resolve({gitdir:r,fs:e,ref:a})}catch(x){if(!(x instanceof Ar))throw x}let y=(await gp({fs:e,cache:t,gitdir:r,oid:h||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)y=y.filter(x=>x.path!==i);else for(const x of y)if(x.path===i)throw new co("note",i);typeof s=="string"&&(s=Xt.from(s,"utf8"));const v=await $i({fs:e,gitdir:r,type:"blob",object:s,format:"content"});y.push({mode:"100644",path:i,oid:v,type:"blob"});const b=await B0({fs:e,gitdir:r,tree:y});return await mx({fs:e,cache:t,onSign:n,gitdir:r,ref:a,tree:b,parent:h&&[h],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:u,signingKey:d})}async function Jre({fs:e,onSign:t,dir:n,gitdir:r=jt.join(n,".git"),ref:a="refs/notes/commits",oid:i,note:s,force:o,author:l,committer:u,signingKey:d,cache:h={}}){try{Je("fs",e),Je("gitdir",r),Je("oid",i),Je("note",s),d&&Je("onSign",t);const p=new cn(e),y=await yu({fs:p,gitdir:r,author:l});if(!y)throw new ui("author");const v=await qh({fs:p,gitdir:r,author:y,committer:u});if(!v)throw new ui("committer");return await Xre({fs:new cn(p),cache:h,onSign:t,gitdir:r,ref:a,oid:i,note:s,force:o,author:y,committer:v,signingKey:d})}catch(p){throw p.caller="git.addNote",p}}async function y5({fs:e,gitdir:t,remote:n,url:r,force:a}){if(n!==Bo.clean(n))throw new ao(n,Bo.clean(n));const i=await ga.get({fs:e,gitdir:t});if(!a&&(await i.getSubsections("remote")).includes(n)&&r!==await i.get(`remote.${n}.url`))throw new co("remote",n);await i.set(`remote.${n}.url`,r),await i.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await ga.save({fs:e,gitdir:t,config:i})}async function Qre({fs:e,dir:t,gitdir:n=jt.join(t,".git"),remote:r,url:a,force:i=!1}){try{return Je("fs",e),Je("gitdir",n),Je("remote",r),Je("url",a),await y5({fs:new cn(e),gitdir:n,remote:r,url:a,force:i})}catch(s){throw s.caller="git.addRemote",s}}async function eae({fs:e,cache:t,onSign:n,gitdir:r,ref:a,tagger:i,message:s=a,gpgsig:o,object:l,signingKey:u,force:d=!1}){if(a=a.startsWith("refs/tags/")?a:`refs/tags/${a}`,!d&&await zt.exists({fs:e,gitdir:r,ref:a}))throw new co("tag",a);const h=await zt.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:p}=await Gr({fs:e,cache:t,gitdir:r,oid:h});let y=wi.from({object:h,type:p,tag:a.replace("refs/tags/",""),tagger:i,message:s,gpgsig:o});u&&(y=await wi.sign(y,n,u));const v=await $i({fs:e,gitdir:r,type:"tag",object:y.toObject()});await zt.writeRef({fs:e,gitdir:r,ref:a,value:v})}async function tae({fs:e,onSign:t,dir:n,gitdir:r=jt.join(n,".git"),ref:a,tagger:i,message:s=a,gpgsig:o,object:l,signingKey:u,force:d=!1,cache:h={}}){try{Je("fs",e),Je("gitdir",r),Je("ref",a),u&&Je("onSign",t);const p=new cn(e),y=await yu({fs:p,gitdir:r,author:i});if(!y)throw new ui("tagger");return await eae({fs:p,cache:h,onSign:t,gitdir:r,ref:a,tagger:y,message:s,gpgsig:o,object:l,signingKey:u,force:d})}catch(p){throw p.caller="git.annotatedTag",p}}async function nae({fs:e,gitdir:t,ref:n,object:r,checkout:a=!1,force:i=!1}){if(n!==Bo.clean(n))throw new ao(n,Bo.clean(n));const s=`refs/heads/${n}`;if(!i&&await zt.exists({fs:e,gitdir:t,ref:s}))throw new co("branch",n,!1);let o;try{o=await zt.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await zt.writeRef({fs:e,gitdir:t,ref:s,value:o}),a&&await zt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:s})}async function rae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r,object:a,checkout:i=!1,force:s=!1}){try{return Je("fs",e),Je("gitdir",n),Je("ref",r),await nae({fs:new cn(e),gitdir:n,ref:r,object:a,checkout:i,force:s})}catch(o){throw o.caller="git.branch",o}}const b5=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function rT({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:a,gitdir:i,remote:s,ref:o,filepaths:l,noCheckout:u,noUpdateHead:d,dryRun:h,force:p,track:y=!0}){let v;if(r)try{v=await zt.resolve({fs:e,gitdir:i,ref:"HEAD"})}catch{v="0000000000000000000000000000000000000000"}let b;try{b=await zt.resolve({fs:e,gitdir:i,ref:o})}catch(w){if(o==="HEAD")throw w;const x=`${s}/${o}`;if(b=await zt.resolve({fs:e,gitdir:i,ref:x}),y){const S=await ga.get({fs:e,gitdir:i});await S.set(`branch.${o}.remote`,s),await S.set(`branch.${o}.merge`,`refs/heads/${o}`),await ga.save({fs:e,gitdir:i,config:S})}await zt.writeRef({fs:e,gitdir:i,ref:`refs/heads/${o}`,value:b})}if(!u){let w;try{w=await aae({fs:e,cache:t,onProgress:n,dir:a,gitdir:i,ref:o,force:p,filepaths:l})}catch(k){throw k instanceof Ar&&k.data.what===b?new T0(o,b):k}const x=w.filter(([k])=>k==="conflict").map(([k,R])=>R);if(x.length>0)throw new k0(x);const S=w.filter(([k])=>k==="error").map(([k,R])=>R);if(S.length>0)throw new In(S.join(", "));if(h){r&&await r({previousHead:v,newHead:b,type:l!=null&&l.length>0?"file":"branch"});return}let E=0;const C=w.length;await $a.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(w.filter(([R])=>R==="delete"||R==="delete-index").map(async function([R,O]){const j=`${a}/${O}`;R==="delete"&&await e.rm(j),k.delete({filepath:O}),n&&await n({phase:"Updating workdir",loaded:++E,total:C})}))}),await $a.acquire({fs:e,gitdir:i,cache:t},async function(k){for(const[R,O]of w)if(R==="rmdir"||R==="rmdir-index"){const j=`${a}/${O}`;try{R==="rmdir-index"&&k.delete({filepath:O}),await e.rmdir(j),n&&await n({phase:"Updating workdir",loaded:++E,total:C})}catch($){if($.code==="ENOTEMPTY")console.log(`Did not delete ${O} because directory is not empty`);else throw $}}}),await Promise.all(w.filter(([k])=>k==="mkdir"||k==="mkdir-index").map(async function([k,R]){const O=`${a}/${R}`;await e.mkdir(O),n&&await n({phase:"Updating workdir",loaded:++E,total:C})})),await $a.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(w.filter(([R])=>R==="create"||R==="create-index"||R==="update"||R==="mkdir-index").map(async function([R,O,j,$,L]){const X=`${a}/${O}`;try{if(R!=="create-index"&&R!=="mkdir-index"){const{object:K}=await Gr({fs:e,cache:t,gitdir:i,oid:j});if(L&&await e.rm(X),$===33188)await e.write(X,K);else if($===33261)await e.write(X,K,{mode:511});else if($===40960)await e.writelink(X,K);else throw new In(`Invalid mode 0o${$.toString(8)} detected in blob ${j}`)}const F=await e.lstat(X);$===33261&&(F.mode=493),R==="mkdir-index"&&(F.mode=57344),k.insert({filepath:O,stats:F,oid:j}),n&&await n({phase:"Updating workdir",loaded:++E,total:C})}catch(F){console.log(F)}}))}),r&&await r({previousHead:v,newHead:b,type:l!=null&&l.length>0?"file":"branch"})}if(!d){const w=await zt.expand({fs:e,gitdir:i,ref:o});w.startsWith("refs/heads")?await zt.writeSymbolicRef({fs:e,gitdir:i,ref:"HEAD",value:w}):await zt.writeRef({fs:e,gitdir:i,ref:"HEAD",value:b})}}async function aae({fs:e,cache:t,onProgress:n,dir:r,gitdir:a,ref:i,force:s,filepaths:o}){let l=0;return gu({fs:e,cache:t,dir:r,gitdir:a,trees:[Es({ref:i}),L0(),up()],map:async function(u,[d,h,p]){if(u===".")return;if(o&&!o.some(v=>b5(u,v)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!p,!!d,!!h].map(Number).join("")){case"000":return;case"001":return s&&o&&o.includes(u)?["delete",u]:void 0;case"010":switch(await d.type()){case"tree":return["mkdir",u];case"blob":return["create",u,await d.oid(),await d.mode()];case"commit":return["mkdir-index",u,await d.oid(),await d.mode()];default:return["error",`new entry Unhandled type ${await d.type()}`]}case"011":switch(`${await d.type()}-${await h.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",u];case"blob-blob":return await d.oid()!==await h.oid()?s?["update",u,await d.oid(),await d.mode(),await d.mode()!==await h.mode()]:["conflict",u]:await d.mode()!==await h.mode()?s?["update",u,await d.oid(),await d.mode(),!0]:["conflict",u]:["create-index",u,await d.oid(),await d.mode()];case"commit-tree":return;case"commit-blob":return["conflict",u];default:return["error",`new entry Unhandled type ${d.type}`]}case"100":return["delete-index",u];case"101":switch(await p.type()){case"tree":return["rmdir",u];case"blob":return await p.oid()!==await h.oid()?s?["delete",u]:["conflict",u]:["delete",u];case"commit":return["rmdir-index",u];default:return["error",`delete entry Unhandled type ${await p.type()}`]}case"110":case"111":switch(`${await p.type()}-${await d.type()}`){case"tree-tree":return;case"blob-blob":{if(await p.oid()===await d.oid()&&await p.mode()===await d.mode()&&!s)return;if(h){if(await h.oid()!==await p.oid()&&await h.oid()!==await d.oid())return s?["update",u,await d.oid(),await d.mode(),await d.mode()!==await h.mode()]:["conflict",u]}else if(s)return["update",u,await d.oid(),await d.mode(),await d.mode()!==await p.mode()];return await d.mode()!==await p.mode()?["update",u,await d.oid(),await d.mode(),!0]:await d.oid()!==await p.oid()?["update",u,await d.oid(),await d.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",u,await d.oid()];case"blob-tree":return["update-blob-to-tree",u];case"commit-commit":return["mkdir-index",u,await d.oid(),await d.mode()];default:return["error",`update entry Unhandled type ${await p.type()}-${await d.type()}`]}}},reduce:async function(u,d){return d=u5(d),u?u&&u[0]==="rmdir"?(d.push(u),d):(d.unshift(u),d):d}})}async function v5({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:a=jt.join(r,".git"),remote:i="origin",ref:s,filepaths:o,noCheckout:l=!1,noUpdateHead:u=s===void 0,dryRun:d=!1,force:h=!1,track:p=!0,cache:y={}}){try{Je("fs",e),Je("dir",r),Je("gitdir",a);const v=s||"HEAD";return await rT({fs:new cn(e),cache:y,onProgress:t,onPostCheckout:n,dir:r,gitdir:a,remote:i,ref:v,filepaths:o,noCheckout:l,noUpdateHead:u,dryRun:d,force:h,track:p})}catch(v){throw v.caller="git.checkout",v}}const iae=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function _d(e){const t=iae.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function Au({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const a=await zt.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await zt.resolve({fs:e,gitdir:t,ref:a})}catch{return}if(a.startsWith("refs/"))return n?a:_d(a)}function sae(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function w5({username:e="",password:t=""}){return`Basic ${Xt.from(`${e}:${t}`).toString("base64")}`}async function z0(e,t){const n=o5(e);for(;;){const{value:r,done:a}=await n.next();if(r&&await t(r),a)break}n.return&&n.return()}async function nw(e){let t=0;const n=[];await z0(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let a=0;for(const i of n)r.set(i,a),a+=i.byteLength;return r}function g4(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function aC(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class sa{static flush(){return Xt.from("0000","utf8")}static delim(){return Xt.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=Xt.from(t));const n=t.length+4,r=aC(4,n);return Xt.concat([Xt.from(r,"utf8"),t])}static streamReader(t){const n=new l5(t);return async function(){try{let a=await n.read(4);if(a==null)return!0;if(a=parseInt(a.toString("utf8"),16),a===0||a===1)return null;const i=await n.read(a-4);return i??!0}catch(a){return t.error=a,!0}}}}async function y4(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const a=n.slice(0,r),i=n.slice(r+1);t[a]=i}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function b4(e,{service:t}){const n=new Set,r=new Map,a=new Map,i=sa.streamReader(e);let s=await i();for(;s===null;)s=await i();if(s===!0)throw new A0;if(s.includes("version 2"))return y4(i);if(s.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new sf(`# service=${t}\\n`,s.toString("utf8"));let o=await i();for(;o===null;)o=await i();if(o===!0)return{capabilities:n,refs:r,symrefs:a};if(o=o.toString("utf8"),o.includes("version 2"))return y4(i);const[l,u]=CE(o,"\0","\\x00");if(u.split(" ").map(d=>n.add(d)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[d,h]=CE(l," "," ");for(r.set(h,d);;){const p=await i();if(p===!0)break;if(p!==null){const[y,v]=CE(p.toString("utf8")," "," ");r.set(v,y)}}}for(const d of n)if(d.startsWith("symref=")){const h=d.match(/symref=([^:]+):(.*)/);h.length===3&&a.set(h[1],h[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:a}}function CE(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new sf(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const v4=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,w4=(e,t)=>{(t.username||t.password)&&(e.Authorization=w5(t)),t.headers&&Object.assign(e,t.headers)},kE=async e=>{try{const t=Xt.from(await nw(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class rw{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:a,onAuthFailure:i,corsProxy:s,service:o,url:l,headers:u,protocolVersion:d}){let{url:h,auth:p}=g4(l);const y=s?v4(s,h):h;(p.username||p.password)&&(u.Authorization=w5(p)),d===2&&(u["Git-Protocol"]="version=2");let v,b,w=!1;do if(v=await t.request({onProgress:n,method:"GET",url:`${y}/info/refs?service=${o}`,headers:u}),b=!1,v.statusCode===401||v.statusCode===203){const x=w?i:r;if(x){if(p=await x(h,{...p,headers:{...u}}),p&&p.cancel)throw new pp;p&&(w4(u,p),w=!0,b=!0)}}else v.statusCode===200&&w&&a&&await a(h,p);while(b);if(v.statusCode!==200){const{response:x}=await kE(v);throw new Bh(v.statusCode,v.statusMessage,x)}if(v.headers["content-type"]===`application/x-${o}-advertisement`){const x=await b4(v.body,{service:o});return x.auth=p,x}else{const{preview:x,response:S,data:E}=await kE(v);try{const C=await b4([E],{service:o});return C.auth=p,C}catch{throw new O0(x,S)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:a,url:i,auth:s,body:o,headers:l}){const u=g4(i);u&&(i=u.url),r&&(i=v4(r,i)),l["content-type"]=`application/x-${a}-request`,l.accept=`application/x-${a}-result`,w4(l,s);const d=await t.request({onProgress:n,method:"POST",url:`${i}/${a}`,body:o,headers:l});if(d.statusCode!==200){const{response:h}=kE(d);throw new Bh(d.statusCode,d.statusMessage,h)}return d}}function oae({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class gx{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",rw),n.set("https",rw);const r=oae({url:t});if(!r)throw new M0(t);if(n.has(r.transport))return n.get(r.transport);throw new D0(t,r.transport,r.transport==="ssh"?sae(t):void 0)}}let md=null;class jg{static async read({fs:t,gitdir:n}){md===null&&(md=new Rg);const r=jt.join(n,"shallow"),a=new Set;return await md.acquire(r,async function(){const i=await t.read(r,{encoding:"utf8"});if(i===null||i.trim()==="")return a;i.trim().split(`
`).map(s=>a.add(s))}),a}static async write({fs:t,gitdir:n,oids:r}){md===null&&(md=new Rg);const a=jt.join(n,"shallow");if(r.size>0){const i=[...r].join(`
`)+`
`;await md.acquire(a,async function(){await t.write(a,i,{encoding:"utf8"})})}else await md.acquire(a,async function(){await t.rm(a)})}}async function lae({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function cae({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:a}){let i=await e.readdir(jt.join(n,"objects/pack"));i=i.filter(s=>s.endsWith(".idx"));for(const s of i){const o=`${n}/objects/pack/${s}`,l=await nT({fs:e,cache:t,filename:o,getExternalRefDelta:a});if(l.error)throw new In(l.error);if(l.offsets.has(r))return!0}return!1}async function x4({fs:e,cache:t,gitdir:n,oid:r,format:a="content"}){const i=o=>Gr({fs:e,cache:t,gitdir:n,oid:o});let s=await lae({fs:e,gitdir:n,oid:r});return s||(s=await cae({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i})),s}function uae(e){const a="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===a}function x5(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const a=r.split("=",1)[0];return n.includes(a)})}const yx={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class iv{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function dae(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function _5(e){const t=new iv;let n="";return(async()=>(await z0(e,r=>{for(r=r.toString("utf8"),n+=r;;){const a=dae(n);if(a===-1)break;t.write(n.slice(0,a)),n=n.slice(a)}}),n.length>0&&t.write(n),t.end()))(),t}class S5{static demux(t){const n=sa.streamReader(t),r=new iv,a=new iv,i=new iv,s=async function(){const o=await n();if(o===null)return s();if(o===!0){r.end(),i.end(),t.error?a.destroy(t.error):a.end();return}switch(o[0]){case 1:{a.write(o.slice(1));break}case 2:{i.write(o.slice(1));break}case 3:{const l=o.slice(1);i.write(l),r.end(),i.end(),a.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}s()};return s(),{packetlines:r,packfile:a,progress:i}}}async function fae(e){const{packetlines:t,packfile:n,progress:r}=S5.demux(e),a=[],i=[],s=[];let o=!1,l=!1;return new Promise((u,d)=>{z0(t,h=>{const p=h.toString("utf8").trim();if(p.startsWith("shallow")){const y=p.slice(-41).trim();y.length!==40&&d(new pu(y)),a.push(y)}else if(p.startsWith("unshallow")){const y=p.slice(-41).trim();y.length!==40&&d(new pu(y)),i.push(y)}else if(p.startsWith("ACK")){const[,y,v]=p.split(" ");s.push({oid:y,status:v}),v||(l=!0)}else p.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?d(e.error):u({shallows:a,unshallows:i,acks:s,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?d(e.error):u({shallows:a,unshallows:i,acks:s,nak:o,packfile:n,progress:r}))})})}function hae({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:a=null,since:i=null,exclude:s=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const u of t)o.push(sa.encode(`want ${u}${l}
`)),l="";for(const u of r)o.push(sa.encode(`shallow ${u}
`));a!==null&&o.push(sa.encode(`deepen ${a}
`)),i!==null&&o.push(sa.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const u of s)o.push(sa.encode(`deepen-not ${u}
`));o.push(sa.flush());for(const u of n)o.push(sa.encode(`have ${u}
`));return o.push(sa.encode(`done
`)),o}async function aT({fs:e,cache:t,http:n,onProgress:r,onMessage:a,onAuth:i,onAuthSuccess:s,onAuthFailure:o,gitdir:l,ref:u,remoteRef:d,remote:h,url:p,corsProxy:y,depth:v=null,since:b=null,exclude:w=[],relative:x=!1,tags:S=!1,singleBranch:E=!1,headers:C={},prune:k=!1,pruneTags:R=!1}){const O=u||await Au({fs:e,gitdir:l,test:!0}),j=await ga.get({fs:e,gitdir:l}),$=h||O&&await j.get(`branch.${O}.remote`)||"origin",L=p||await j.get(`remote.${$}.url`);if(typeof L>"u")throw new Mi("remote OR url");const X=d||O&&await j.get(`branch.${O}.merge`)||u||"HEAD";y===void 0&&(y=await j.get("http.corsProxy"));const F=gx.getRemoteHelperFor({url:L}),K=await F.discover({http:n,onAuth:i,onAuthSuccess:s,onAuthFailure:o,corsProxy:y,service:"git-upload-pack",url:L,headers:C,protocolVersion:1}),q=K.auth,de=K.refs;if(de.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(v!==null&&!K.capabilities.has("shallow"))throw new Zc("shallow","depth");if(b!==null&&!K.capabilities.has("deepen-since"))throw new Zc("deepen-since","since");if(w.length>0&&!K.capabilities.has("deepen-not"))throw new Zc("deepen-not","exclude");if(x===!0&&!K.capabilities.has("deepen-relative"))throw new Zc("deepen-relative","relative");const{oid:re,fullref:Y}=zt.resolveAgainstMap({ref:X,map:de});for(const Le of de.keys())Le===Y||Le==="HEAD"||Le.startsWith("refs/heads/")||S&&Le.startsWith("refs/tags/")||de.delete(Le);const Q=x5([...K.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${yx.agent}`]);x&&Q.push("deepen-relative");const ae=E?[re]:de.values(),B=E?[O]:await zt.listRefs({fs:e,gitdir:l,filepath:"refs"});let J=[];for(let Le of B)try{Le=await zt.expand({fs:e,gitdir:l,ref:Le});const Ie=await zt.resolve({fs:e,gitdir:l,ref:Le});await x4({fs:e,cache:t,gitdir:l,oid:Ie})&&J.push(Ie)}catch{}J=[...new Set(J)];const ee=await jg.read({fs:e,gitdir:l}),oe=K.capabilities.has("shallow")?[...ee]:[],me=hae({capabilities:Q,wants:ae,haves:J,shallows:oe,depth:v,since:b,exclude:w}),xe=Xt.from(await nw(me)),Pe=await F.connect({http:n,onProgress:r,corsProxy:y,service:"git-upload-pack",url:L,auth:q,body:[xe],headers:C}),Ne=await fae(Pe.body);Pe.headers&&(Ne.headers=Pe.headers);for(const Le of Ne.shallows)if(!ee.has(Le))try{const{object:Ie}=await Gr({fs:e,cache:t,gitdir:l,oid:Le}),V=new Vr(Ie),ge=await Promise.all(V.headers().parent.map(le=>x4({fs:e,cache:t,gitdir:l,oid:le})));ge.length===0||ge.every(le=>le)||ee.add(Le)}catch{ee.add(Le)}for(const Le of Ne.unshallows)ee.delete(Le);if(await jg.write({fs:e,gitdir:l,oids:ee}),E){const Le=new Map([[Y,re]]),Ie=new Map;let V=10,ge=Y;for(;V--;){const ie=K.symrefs.get(ge);if(ie===void 0)break;Ie.set(ge,ie),ge=ie}const Te=de.get(ge);Te&&Le.set(ge,Te);const{pruned:le}=await zt.updateRemoteRefs({fs:e,gitdir:l,remote:$,refs:Le,symrefs:Ie,tags:S,prune:k});k&&(Ne.pruned=le)}else{const{pruned:Le}=await zt.updateRemoteRefs({fs:e,gitdir:l,remote:$,refs:de,symrefs:K.symrefs,tags:S,prune:k,pruneTags:R});k&&(Ne.pruned=Le)}if(Ne.HEAD=K.symrefs.get("HEAD"),Ne.HEAD===void 0){const{oid:Le}=zt.resolveAgainstMap({ref:"HEAD",map:de});for(const[Ie,V]of de.entries())if(Ie!=="HEAD"&&V===Le){Ne.HEAD=Ie;break}}const Re=Y.startsWith("refs/tags")?"tag":"branch";if(Ne.FETCH_HEAD={oid:re,description:`${Re} '${_d(Y)}' of ${L}`},r||a){const Le=_5(Ne.progress);z0(Le,async Ie=>{if(a&&await a(Ie),r){const V=Ie.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);V&&await r({phase:V[1].trim(),loaded:parseInt(V[2],10),total:parseInt(V[3],10)})}})}const ke=Xt.from(await nw(Ne.packfile));if(Pe.body.error)throw Pe.body.error;const Fe=ke.slice(-20).toString("hex"),Qe={defaultBranch:Ne.HEAD,fetchHead:Ne.FETCH_HEAD.oid,fetchHeadDescription:Ne.FETCH_HEAD.description};if(Ne.headers&&(Qe.headers=Ne.headers),k&&(Qe.pruned=Ne.pruned),Fe!==""&&!uae(ke)){Qe.packfile=`objects/pack/pack-${Fe}.pack`;const Le=jt.join(l,Qe.packfile);await e.write(Le,ke);const Ie=ge=>Gr({fs:e,cache:t,gitdir:l,oid:ge}),V=await $h.fromPack({pack:ke,getExternalRefDelta:Ie,onProgress:r});await e.write(Le.replace(/\.pack$/,".idx"),await V.toBuffer())}return Qe}async function E5({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:jt.join(n,".git"),defaultBranch:a="master"}){if(await e.exists(r+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(s=>r+"/"+s);for(const s of i)await e.mkdir(s);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${a}
`)}async function pae({fs:e,cache:t,http:n,onProgress:r,onMessage:a,onAuth:i,onAuthSuccess:s,onAuthFailure:o,onPostCheckout:l,dir:u,gitdir:d,url:h,corsProxy:p,ref:y,remote:v,depth:b,since:w,exclude:x,relative:S,singleBranch:E,noCheckout:C,noTags:k,headers:R}){try{if(await E5({fs:e,gitdir:d}),await y5({fs:e,gitdir:d,remote:v,url:h,force:!1}),p){const $=await ga.get({fs:e,gitdir:d});await $.set("http.corsProxy",p),await ga.save({fs:e,gitdir:d,config:$})}const{defaultBranch:O,fetchHead:j}=await aT({fs:e,cache:t,http:n,onProgress:r,onMessage:a,onAuth:i,onAuthSuccess:s,onAuthFailure:o,gitdir:d,ref:y,remote:v,corsProxy:p,depth:b,since:w,exclude:x,relative:S,singleBranch:E,headers:R,tags:!k});if(j===null)return;y=y||O,y=y.replace("refs/heads/",""),await rT({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:u,gitdir:d,ref:y,remote:v,noCheckout:C})}catch(O){throw await e.rmdir(d,{recursive:!0,maxRetries:10}).catch(()=>{}),O}}async function mae({fs:e,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,onPostCheckout:o,dir:l,gitdir:u=jt.join(l,".git"),url:d,corsProxy:h=void 0,ref:p=void 0,remote:y="origin",depth:v=void 0,since:b=void 0,exclude:w=[],relative:x=!1,singleBranch:S=!1,noCheckout:E=!1,noTags:C=!1,headers:k={},cache:R={}}){try{return Je("fs",e),Je("http",t),Je("gitdir",u),E||Je("dir",l),Je("url",d),await pae({fs:new cn(e),cache:R,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,onPostCheckout:o,dir:l,gitdir:u,url:d,corsProxy:h,ref:p,remote:y,depth:v,since:b,exclude:w,relative:x,singleBranch:S,noCheckout:E,noTags:C,headers:k})}catch(O){throw O.caller="git.clone",O}}async function gae({fs:e,onSign:t,dir:n,gitdir:r=jt.join(n,".git"),message:a,author:i,committer:s,signingKey:o,amend:l=!1,dryRun:u=!1,noUpdateBranch:d=!1,ref:h,parent:p,tree:y,cache:v={}}){try{Je("fs",e),l||Je("message",a),o&&Je("onSign",t);const b=new cn(e);return await mx({fs:b,cache:v,onSign:t,gitdir:r,message:a,author:i,committer:s,signingKey:o,amend:l,dryRun:u,noUpdateBranch:d,ref:h,parent:p,tree:y})}catch(b){throw b.caller="git.commit",b}}async function yae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),fullname:r=!1,test:a=!1}){try{return Je("fs",e),Je("gitdir",n),await Au({fs:new cn(e),gitdir:n,fullname:r,test:a})}catch(i){throw i.caller="git.currentBranch",i}}async function bae({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await zt.exists({fs:e,gitdir:t,ref:n}))throw new Ar(n);const a=await zt.expand({fs:e,gitdir:t,ref:n}),i=await Au({fs:e,gitdir:t,fullname:!0});if(a===i){const l=await zt.resolve({fs:e,gitdir:t,ref:a});await zt.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await zt.deleteRef({fs:e,gitdir:t,ref:a});const s=_d(n),o=await ga.get({fs:e,gitdir:t});await o.deleteSection("branch",s),await ga.save({fs:e,gitdir:t,config:o})}async function vae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r}){try{return Je("fs",e),Je("ref",r),await bae({fs:new cn(e),gitdir:n,ref:r})}catch(a){throw a.caller="git.deleteBranch",a}}async function wae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r}){try{Je("fs",e),Je("ref",r),await zt.deleteRef({fs:new cn(e),gitdir:n,ref:r})}catch(a){throw a.caller="git.deleteRef",a}}async function xae({fs:e,gitdir:t,remote:n}){const r=await ga.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await ga.save({fs:e,gitdir:t,config:r})}async function _ae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),remote:r}){try{return Je("fs",e),Je("remote",r),await xae({fs:new cn(e),gitdir:n,remote:r})}catch(a){throw a.caller="git.deleteRemote",a}}async function Sae({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await zt.deleteRef({fs:e,gitdir:t,ref:n})}async function Eae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r}){try{return Je("fs",e),Je("ref",r),await Sae({fs:new cn(e),gitdir:n,ref:r})}catch(a){throw a.caller="git.deleteTag",a}}async function Cae({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(i=>`${r}${i}`).filter(i=>i.startsWith(n))}async function kae({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:a}){const i=[];let s=await e.readdir(jt.join(n,"objects/pack"));s=s.filter(o=>o.endsWith(".idx"));for(const o of s){const l=`${n}/objects/pack/${o}`,u=await nT({fs:e,cache:t,filename:l,getExternalRefDelta:a});if(u.error)throw new In(u.error);for(const d of u.offsets.keys())d.startsWith(r)&&i.push(d)}return i}async function Tae({fs:e,cache:t,gitdir:n,oid:r}){const a=o=>Gr({fs:e,cache:t,gitdir:n,oid:o}),i=await Cae({fs:e,gitdir:n,oid:r}),s=await kae({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:a});for(const o of s)i.indexOf(o)===-1&&i.push(o);if(i.length===1)return i[0];throw i.length>1?new C0("oids",r,i):new Ar(`an object matching "${r}"`)}async function Aae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),oid:r,cache:a={}}){try{return Je("fs",e),Je("gitdir",n),Je("oid",r),await Tae({fs:new cn(e),cache:a,gitdir:n,oid:r})}catch(i){throw i.caller="git.expandOid",i}}async function Nae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r}){try{return Je("fs",e),Je("gitdir",n),Je("ref",r),await zt.expand({fs:new cn(e),gitdir:n,ref:r})}catch(a){throw a.caller="git.expandRef",a}}async function iT({fs:e,cache:t,gitdir:n,oids:r}){const a={},i=r.length;let s=r.map((o,l)=>({index:l,oid:o}));for(;s.length;){const o=new Set;for(const{oid:u,index:d}of s)a[u]||(a[u]=new Set),a[u].add(d),a[u].size===i&&o.add(u);if(o.size>0)return[...o];const l=new Map;for(const{oid:u,index:d}of s)try{const{object:h}=await Gr({fs:e,cache:t,gitdir:n,oid:u}),p=Vr.from(h),{parent:y}=p.parseHeaders();for(const v of y)(!a[v]||!a[v].has(d))&&l.set(v+":"+d,{oid:v,index:d})}catch{}s=Array.from(l.values())}return[]}const TE=/^.*(\r?\n|$)/gm;function Rae({branches:e,contents:t}){const n=e[1],r=e[2],a=t[0],i=t[1],s=t[2],o=i.match(TE),l=a.match(TE),u=s.match(TE),d=Zne(o,l,u),h=7;let p="",y=!0;for(const v of d)v.ok&&(p+=v.ok.join("")),v.conflict&&(y=!1,p+=`${"<".repeat(h)} ${n}
`,p+=v.conflict.a.join(""),p+=`${"=".repeat(h)}
`,p+=v.conflict.b.join(""),p+=`${">".repeat(h)} ${r}
`);return{cleanMerge:y,mergedText:p}}async function Iae({fs:e,cache:t,dir:n,gitdir:r=jt.join(n,".git"),index:a,ourOid:i,baseOid:s,theirOid:o,ourName:l="ours",baseName:u="base",theirName:d="theirs",dryRun:h=!1,abortOnConflict:p=!0,mergeDriver:y}){const v=Es({ref:i}),b=Es({ref:s}),w=Es({ref:o}),x=[],S=[],E=[],C=[],k=await gu({fs:e,cache:t,dir:n,gitdir:r,trees:[v,b,w],map:async function(R,[O,j,$]){const L=Xv(R),X=await tw(O,j),F=await tw($,j);switch(`${X}-${F}`){case"false-false":return{mode:await j.mode(),path:L,oid:await j.oid(),type:await j.type()};case"false-true":return $?{mode:await $.mode(),path:L,oid:await $.oid(),type:await $.type()}:void 0;case"true-false":return O?{mode:await O.mode(),path:L,oid:await O.oid(),type:await O.type()}:void 0;case"true-true":{if(O&&j&&$&&await O.type()==="blob"&&await j.type()==="blob"&&await $.type()==="blob")return jae({fs:e,gitdir:r,path:L,ours:O,base:j,theirs:$,ourName:l,baseName:u,theirName:d,mergeDriver:y}).then(async K=>{if(K.cleanMerge)p||a.insert({filepath:R,oid:K.mergeResult.oid,stage:0});else if(x.push(R),S.push(R),!p){const q=await j.oid(),de=await O.oid(),re=await $.oid();a.delete({filepath:R}),a.insert({filepath:R,oid:q,stage:1}),a.insert({filepath:R,oid:de,stage:2}),a.insert({filepath:R,oid:re,stage:3})}return K.mergeResult});if(j&&!O&&$&&await j.type()==="blob"&&await $.type()==="blob"){if(x.push(R),E.push(R),!p){const K=await j.oid(),q=await $.oid();a.delete({filepath:R}),a.insert({filepath:R,oid:K,stage:1}),a.insert({filepath:R,oid:q,stage:3})}return{mode:await $.mode(),oid:await $.oid(),type:"blob",path:L}}if(j&&O&&!$&&await j.type()==="blob"&&await O.type()==="blob"){if(x.push(R),C.push(R),!p){const K=await j.oid(),q=await O.oid();a.delete({filepath:R}),a.insert({filepath:R,oid:K,stage:1}),a.insert({filepath:R,oid:q,stage:2})}return{mode:await O.mode(),oid:await O.oid(),type:"blob",path:L}}if(j&&!O&&!$&&await j.type()==="blob")return;throw new fp}}},reduce:x.length!==0&&(!n||p)?void 0:async(R,O)=>{const j=O.filter(Boolean);if(R&&!(R&&R.type==="tree"&&j.length===0)){if(j.length>0){const L=new Fi(j).toObject(),X=await $i({fs:e,gitdir:r,type:"tree",object:L,dryRun:h});R.oid=X}return R}}});return x.length!==0?(n&&!p&&await gu({fs:e,cache:t,dir:n,gitdir:r,trees:[Es({ref:k.oid})],map:async function(R,[O]){const j=`${n}/${R}`;if(await O.type()==="blob"){const $=await O.mode(),L=new TextDecoder().decode(await O.content());await e.write(j,L,{mode:$})}return!0}}),new hp(x,S,E,C)):k.oid}async function jae({fs:e,gitdir:t,path:n,ours:r,base:a,theirs:i,ourName:s,theirName:o,baseName:l,dryRun:u,mergeDriver:d=Rae}){const h="blob",p=await a.mode()===await r.mode()?await i.mode():await r.mode();if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:p,path:n,oid:await r.oid(),type:h}};if(await r.oid()===await a.oid())return{cleanMerge:!0,mergeResult:{mode:p,path:n,oid:await i.oid(),type:h}};if(await i.oid()===await a.oid())return{cleanMerge:!0,mergeResult:{mode:p,path:n,oid:await r.oid(),type:h}};const y=Xt.from(await r.content()).toString("utf8"),v=Xt.from(await a.content()).toString("utf8"),b=Xt.from(await i.content()).toString("utf8"),{mergedText:w,cleanMerge:x}=await d({branches:[l,s,o],contents:[v,y,b],path:n}),S=await $i({fs:e,gitdir:t,type:"blob",object:Xt.from(w,"utf8"),dryRun:u});return{cleanMerge:x,mergeResult:{mode:p,path:n,oid:S,type:h}}}async function C5({fs:e,cache:t,dir:n,gitdir:r,ours:a,theirs:i,fastForward:s=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:u=!1,abortOnConflict:d=!0,message:h,author:p,committer:y,signingKey:v,onSign:b,mergeDriver:w}){a===void 0&&(a=await Au({fs:e,gitdir:r,fullname:!0})),a=await zt.expand({fs:e,gitdir:r,ref:a}),i=await zt.expand({fs:e,gitdir:r,ref:i});const x=await zt.resolve({fs:e,gitdir:r,ref:a}),S=await zt.resolve({fs:e,gitdir:r,ref:i}),E=await iT({fs:e,cache:t,gitdir:r,oids:[x,S]});if(E.length!==1)throw new fp;const C=E[0];if(C===S)return{oid:x,alreadyMerged:!0};if(s&&C===x)return!l&&!u&&await zt.writeRef({fs:e,gitdir:r,ref:a,value:S}),{oid:S,fastForward:!0};{if(o)throw new N0;const k=await $a.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async O=>Iae({fs:e,cache:t,dir:n,gitdir:r,index:O,ourOid:x,theirOid:S,baseOid:C,ourName:_d(a),baseName:"base",theirName:_d(i),dryRun:l,abortOnConflict:d,mergeDriver:w}));if(k instanceof hp)throw k;return h||(h=`Merge branch '${_d(i)}' into ${_d(a)}`),{oid:await mx({fs:e,cache:t,gitdir:r,message:h,ref:a,tree:k,parent:[x,S],author:p,committer:y,signingKey:v,onSign:b,dryRun:l,noUpdateBranch:u}),tree:k,mergeCommit:!0}}}async function k5({fs:e,cache:t,http:n,onProgress:r,onMessage:a,onAuth:i,onAuthSuccess:s,onAuthFailure:o,dir:l,gitdir:u,ref:d,url:h,remote:p,remoteRef:y,prune:v,pruneTags:b,fastForward:w,fastForwardOnly:x,corsProxy:S,singleBranch:E,headers:C,author:k,committer:R,signingKey:O}){try{if(!d){const L=await Au({fs:e,gitdir:u});if(!L)throw new Mi("ref");d=L}const{fetchHead:j,fetchHeadDescription:$}=await aT({fs:e,cache:t,http:n,onProgress:r,onMessage:a,onAuth:i,onAuthSuccess:s,onAuthFailure:o,gitdir:u,corsProxy:S,ref:d,url:h,remote:p,remoteRef:y,singleBranch:E,headers:C,prune:v,pruneTags:b});await C5({fs:e,cache:t,gitdir:u,ours:d,theirs:j,fastForward:w,fastForwardOnly:x,message:`Merge ${$}`,author:k,committer:R,signingKey:O,dryRun:!1,noUpdateBranch:!1}),await rT({fs:e,cache:t,onProgress:r,dir:l,gitdir:u,ref:d,remote:p,noCheckout:!1})}catch(j){throw j.caller="git.pull",j}}async function Oae({fs:e,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,dir:o,gitdir:l=jt.join(o,".git"),ref:u,url:d,remote:h,remoteRef:p,corsProxy:y,singleBranch:v,headers:b={},cache:w={}}){try{Je("fs",e),Je("http",t),Je("gitdir",l);const x={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await k5({fs:new cn(e),cache:w,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,dir:o,gitdir:l,ref:u,url:d,remote:h,remoteRef:p,fastForwardOnly:!0,corsProxy:y,singleBranch:v,headers:b,author:x,committer:x})}catch(x){throw x.caller="git.fastForward",x}}async function Dae({fs:e,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,dir:o,gitdir:l=jt.join(o,".git"),ref:u,remote:d,remoteRef:h,url:p,corsProxy:y,depth:v=null,since:b=null,exclude:w=[],relative:x=!1,tags:S=!1,singleBranch:E=!1,headers:C={},prune:k=!1,pruneTags:R=!1,cache:O={}}){try{return Je("fs",e),Je("http",t),Je("gitdir",l),await aT({fs:new cn(e),cache:O,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,gitdir:l,ref:u,remote:d,remoteRef:h,url:p,corsProxy:y,depth:v,since:b,exclude:w,relative:x,tags:S,singleBranch:E,headers:C,prune:k,pruneTags:R})}catch(j){throw j.caller="git.fetch",j}}async function Mae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),oids:r,cache:a={}}){try{return Je("fs",e),Je("gitdir",n),Je("oids",r),await iT({fs:new cn(e),cache:a,gitdir:n,oids:r})}catch(i){throw i.caller="git.findMergeBase",i}}async function T5({fs:e,filepath:t}){if(await e.exists(jt.join(t,".git")))return t;{const n=Lh(t);if(n===t)throw new Ar(`git root for ${t}`);return T5({fs:e,filepath:n})}}async function Pae({fs:e,filepath:t}){try{return Je("fs",e),Je("filepath",t),await T5({fs:new cn(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function Fae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),path:r}){try{return Je("fs",e),Je("gitdir",n),Je("path",r),await Ig({fs:new cn(e),gitdir:n,path:r})}catch(a){throw a.caller="git.getConfig",a}}async function Lae({fs:e,gitdir:t,path:n}){return(await ga.get({fs:e,gitdir:t})).getall(n)}async function $ae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),path:r}){try{return Je("fs",e),Je("gitdir",n),Je("path",r),await Lae({fs:new cn(e),gitdir:n,path:r})}catch(a){throw a.caller="git.getConfigAll",a}}async function Bae({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:a,url:i,headers:s={},forPush:o=!1}){try{Je("http",e),Je("url",i);const u=await gx.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:a,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:s,protocolVersion:1}),d={capabilities:[...u.capabilities]};for(const[h,p]of u.refs){const y=h.split("/"),v=y.pop();let b=d;for(const w of y)b[w]=b[w]||{},b=b[w];b[v]=p}for(const[h,p]of u.symrefs){const y=h.split("/"),v=y.pop();let b=d;for(const w of y)b[w]=b[w]||{},b=b[w];b[v]=p}return d}catch(l){throw l.caller="git.getRemoteInfo",l}}function A5(e,t,n,r){const a=[];for(const[i,s]of e.refs){if(t&&!i.startsWith(t))continue;if(i.endsWith("^{}")){if(r){const l=i.replace("^{}",""),u=a[a.length-1],d=u.ref===l?u:a.find(h=>h.ref===l);if(d===void 0)throw new Error("I did not expect this to happen");d.peeled=s}continue}const o={ref:i,oid:s};n&&e.symrefs.has(i)&&(o.target=e.symrefs.get(i)),a.push(o)}return a}async function zae({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:a,url:i,headers:s={},forPush:o=!1,protocolVersion:l=2}){try{Je("http",e),Je("url",i);const d=await gx.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:a,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:s,protocolVersion:l});if(d.protocolVersion===2)return{protocolVersion:d.protocolVersion,capabilities:d.capabilities2};const h={};for(const p of d.capabilities){const[y,v]=p.split("=");v?h[y]=v:h[y]=!0}return{protocolVersion:1,capabilities:h,refs:A5(d,void 0,!0,!0)}}catch(u){throw u.caller="git.getRemoteInfo2",u}}async function Uae({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=dp.wrap({type:e,object:t})),r=await Kl(t)),{oid:r,object:t}}async function qae({object:e}){try{Je("object",e),typeof e=="string"?e=Xt.from(e,"utf8"):e=Xt.from(e);const t="blob",{oid:n,object:r}=await Uae({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function Hae({fs:e,cache:t,onProgress:n,dir:r,gitdir:a,filepath:i}){try{i=jt.join(r,i);const s=await e.read(i),o=u=>Gr({fs:e,cache:t,gitdir:a,oid:u}),l=await $h.fromPack({pack:s,getExternalRefDelta:o,onProgress:n});return await e.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(s){throw s.caller="git.indexPack",s}}async function Vae({fs:e,onProgress:t,dir:n,gitdir:r=jt.join(n,".git"),filepath:a,cache:i={}}){try{return Je("fs",e),Je("dir",n),Je("gitdir",n),Je("filepath",a),await Hae({fs:new cn(e),cache:i,onProgress:t,dir:n,gitdir:r,filepath:a})}catch(s){throw s.caller="git.indexPack",s}}async function Gae({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:jt.join(n,".git"),defaultBranch:a="master"}){try{return Je("fs",e),Je("gitdir",r),t||Je("dir",n),await E5({fs:new cn(e),bare:t,dir:n,gitdir:r,defaultBranch:a})}catch(i){throw i.caller="git.init",i}}async function N5({fs:e,cache:t,gitdir:n,oid:r,ancestor:a,depth:i}){const s=await jg.read({fs:e,gitdir:n});if(!r)throw new Mi("oid");if(!a)throw new Mi("ancestor");if(r===a)return!1;const o=[r],l=new Set;let u=0;for(;o.length;){if(u++===i)throw new I0(i);const d=o.shift(),{type:h,object:p}=await Gr({fs:e,cache:t,gitdir:n,oid:d});if(h!=="commit")throw new Ci(d,h,"commit");const y=Vr.from(p).parse();for(const v of y.parent)if(v===a)return!0;if(!s.has(d))for(const v of y.parent)l.has(v)||(o.push(v),l.add(v))}return!1}async function Wae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),oid:r,ancestor:a,depth:i=-1,cache:s={}}){try{return Je("fs",e),Je("gitdir",n),Je("oid",r),Je("ancestor",a),await N5({fs:new cn(e),cache:s,gitdir:n,oid:r,ancestor:a,depth:i})}catch(o){throw o.caller="git.isDescendent",o}}async function Kae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),filepath:r}){try{return Je("fs",e),Je("dir",t),Je("gitdir",n),Je("filepath",r),mp.isIgnored({fs:new cn(e),dir:t,gitdir:n,filepath:r})}catch(a){throw a.caller="git.isIgnored",a}}async function Zae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),remote:r}){try{return Je("fs",e),Je("gitdir",n),zt.listBranches({fs:new cn(e),gitdir:n,remote:r})}catch(a){throw a.caller="git.listBranches",a}}async function Yae({fs:e,gitdir:t,ref:n,cache:r}){if(n){const a=await zt.resolve({gitdir:t,fs:e,ref:n}),i=[];return await R5({fs:e,cache:r,gitdir:t,oid:a,filenames:i,prefix:""}),i}else return $a.acquire({fs:e,gitdir:t,cache:r},async function(a){return a.entries.map(i=>i.path)})}async function R5({fs:e,cache:t,gitdir:n,oid:r,filenames:a,prefix:i}){const{tree:s}=await gp({fs:e,cache:t,gitdir:n,oid:r});for(const o of s)o.type==="tree"?await R5({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:a,prefix:jt.join(i,o.path)}):a.push(jt.join(i,o.path))}async function Xae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r,cache:a={}}){try{return Je("fs",e),Je("gitdir",n),await Yae({fs:new cn(e),cache:a,gitdir:n,ref:r})}catch(i){throw i.caller="git.listFiles",i}}async function Jae({fs:e,cache:t,gitdir:n,ref:r}){let a;try{a=await zt.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof Ar)return[]}return(await gp({fs:e,cache:t,gitdir:n,oid:a})).tree.map(o=>({target:o.path,note:o.oid}))}async function Qae({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r="refs/notes/commits",cache:a={}}){try{return Je("fs",e),Je("gitdir",n),Je("ref",r),await Jae({fs:new cn(e),cache:a,gitdir:n,ref:r})}catch(i){throw i.caller="git.listNotes",i}}async function eie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),filepath:r}){try{return Je("fs",e),Je("gitdir",n),zt.listRefs({fs:new cn(e),gitdir:n,filepath:r})}catch(a){throw a.caller="git.listRefs",a}}async function tie({fs:e,gitdir:t}){const n=await ga.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async i=>{const s=await n.get(`remote.${i}.url`);return{remote:i,url:s}}))}async function nie({fs:e,dir:t,gitdir:n=jt.join(t,".git")}){try{return Je("fs",e),Je("gitdir",n),await tie({fs:new cn(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function rie(e){const t=sa.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[a,i,...s]=r.split(" "),o={ref:i,oid:a};for(const l of s){const[u,d]=l.split(":");u==="symref-target"?o.target=d:u==="peeled"&&(o.peeled=d)}n.push(o)}return n}async function aie({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(sa.encode(`command=ls-refs
`)),r.push(sa.encode(`agent=${yx.agent}
`)),(n||t||e)&&r.push(sa.delim()),n&&r.push(sa.encode("peel")),t&&r.push(sa.encode("symrefs")),e&&r.push(sa.encode(`ref-prefix ${e}`)),r.push(sa.flush()),r}async function iie({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:a,url:i,headers:s={},forPush:o=!1,protocolVersion:l=2,prefix:u,symrefs:d,peelTags:h}){try{Je("http",e),Je("url",i);const p=await rw.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:a,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:s,protocolVersion:l});if(p.protocolVersion===1)return A5(p,u,d,h);const y=await aie({prefix:u,symrefs:d,peelTags:h}),v=await rw.connect({http:e,auth:p.auth,headers:s,corsProxy:a,service:o?"git-receive-pack":"git-upload-pack",url:i,body:y});return rie(v.body)}catch(p){throw p.caller="git.listServerRefs",p}}async function sie({fs:e,dir:t,gitdir:n=jt.join(t,".git")}){try{return Je("fs",e),Je("gitdir",n),zt.listTags({fs:new cn(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function oie(e,t){return e.committer.timestamp-t.committer.timestamp}const lie="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function _4({fs:e,cache:t,gitdir:n,oid:r,fileId:a}){if(a===lie)return;const i=r;let s;const o=await Uh({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return a===o.oid?s=o.path:(s=await I5({fs:e,cache:t,gitdir:n,tree:l,fileId:a,oid:i}),Array.isArray(s)&&(s.length===0?s=void 0:s.length===1&&(s=s[0]))),s}async function I5({fs:e,cache:t,gitdir:n,tree:r,fileId:a,oid:i,filepaths:s=[],parentPath:o=""}){const l=r.entries().map(function(u){let d;return u.oid===a?(d=jt.join(o,u.path),s.push(d)):u.type==="tree"&&(d=Gr({fs:e,cache:t,gitdir:n,oid:u.oid}).then(function({object:h}){return I5({fs:e,cache:t,gitdir:n,tree:Fi.from(h),fileId:a,oid:i,filepaths:s,parentPath:jt.join(o,u.path)})})),d});return await Promise.all(l),s}async function cie({fs:e,cache:t,gitdir:n,filepath:r,ref:a,depth:i,since:s,force:o,follow:l}){const u=typeof s>"u"?void 0:Math.floor(s.valueOf()/1e3),d=[],h=await jg.read({fs:e,gitdir:n}),p=await zt.resolve({fs:e,gitdir:n,ref:a}),y=[await Hh({fs:e,cache:t,gitdir:n,oid:p})];let v,b,w;function x(S){w&&r&&d.push(S)}for(;y.length>0;){const S=y.pop();if(u!==void 0&&S.commit.committer.timestamp<=u)break;if(r){let E;try{E=await $0({fs:e,cache:t,gitdir:n,oid:S.commit.tree,filepath:r}),b&&v!==E&&d.push(b),v=E,b=S,w=!0}catch(C){if(C instanceof Ar){let k=l&&v;if(k&&(k=await _4({fs:e,cache:t,gitdir:n,oid:S.commit.tree,fileId:v}),k))if(Array.isArray(k)){if(b){const R=await _4({fs:e,cache:t,gitdir:n,oid:b.commit.tree,fileId:v});if(Array.isArray(R))if(k=k.filter(O=>R.indexOf(O)===-1),k.length===1)k=k[0],r=k,b&&d.push(b);else{k=!1,b&&d.push(b);break}}}else r=k,b&&d.push(b);if(!k){if(w&&v&&(d.push(b),!o))break;if(!o&&!l)throw C}b=S,w=!1}else throw C}}else d.push(S);if(i!==void 0&&d.length===i){x(S);break}if(!h.has(S.oid))for(const E of S.commit.parent){const C=await Hh({fs:e,cache:t,gitdir:n,oid:E});y.map(k=>k.oid).includes(C.oid)||y.push(C)}y.length===0&&x(S),y.sort((E,C)=>oie(E.commit,C.commit))}return d}async function uie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),filepath:r,ref:a="HEAD",depth:i,since:s,force:o,follow:l,cache:u={}}){try{return Je("fs",e),Je("gitdir",n),Je("ref",a),await cie({fs:new cn(e),cache:u,gitdir:n,filepath:r,ref:a,depth:i,since:s,force:o,follow:l})}catch(d){throw d.caller="git.log",d}}async function die({fs:e,onSign:t,dir:n,gitdir:r=jt.join(n,".git"),ours:a,theirs:i,fastForward:s=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:u=!1,abortOnConflict:d=!0,message:h,author:p,committer:y,signingKey:v,cache:b={},mergeDriver:w}){try{Je("fs",e),v&&Je("onSign",t);const x=new cn(e),S=await yu({fs:x,gitdir:r,author:p});if(!S&&(!o||!s))throw new ui("author");const E=await qh({fs:x,gitdir:r,author:S,committer:y});if(!E&&(!o||!s))throw new ui("committer");return await C5({fs:x,cache:b,dir:n,gitdir:r,ours:a,theirs:i,fastForward:s,fastForwardOnly:o,dryRun:l,noUpdateBranch:u,abortOnConflict:d,message:h,author:S,committer:E,signingKey:v,onSign:t,mergeDriver:w})}catch(x){throw x.caller="git.merge",x}}const fie={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function j5({fs:e,cache:t,dir:n,gitdir:r=jt.join(n,".git"),oids:a}){const i=new ZP,s=[];function o(d,h){const p=Xt.from(d,h);s.push(p),i.update(p)}async function l({stype:d,object:h}){const p=fie[d];let y=h.length,v=y>15?128:0;const b=y&15;y=y>>>4;let w=(v|p|b).toString(16);for(o(w,"hex");v;)v=y>127?128:0,w=v|y&127,o(aC(2,w),"hex"),y=y>>>7;o(Xt.from(await d5(h)))}o("PACK"),o("00000002","hex"),o(aC(8,a.length),"hex");for(const d of a){const{type:h,object:p}=await Gr({fs:e,cache:t,gitdir:r,oid:d});await l({object:p,stype:h})}const u=i.digest();return s.push(u),s}async function hie({fs:e,cache:t,gitdir:n,oids:r,write:a}){const i=await j5({fs:e,cache:t,gitdir:n,oids:r}),s=Xt.from(await nw(i)),l=`pack-${s.slice(-20).toString("hex")}.pack`;return a?(await e.write(jt.join(n,`objects/pack/${l}`),s),{filename:l}):{filename:l,packfile:new Uint8Array(s)}}async function pie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),oids:r,write:a=!1,cache:i={}}){try{return Je("fs",e),Je("gitdir",n),Je("oids",r),await hie({fs:new cn(e),cache:i,gitdir:n,oids:r,write:a})}catch(s){throw s.caller="git.packObjects",s}}async function mie({fs:e,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,dir:o,gitdir:l=jt.join(o,".git"),ref:u,url:d,remote:h,remoteRef:p,prune:y=!1,pruneTags:v=!1,fastForward:b=!0,fastForwardOnly:w=!1,corsProxy:x,singleBranch:S,headers:E={},author:C,committer:k,signingKey:R,cache:O={}}){try{Je("fs",e),Je("gitdir",l);const j=new cn(e),$=await yu({fs:j,gitdir:l,author:C});if(!$)throw new ui("author");const L=await qh({fs:j,gitdir:l,author:$,committer:k});if(!L)throw new ui("committer");return await k5({fs:j,cache:O,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,dir:o,gitdir:l,ref:u,url:d,remote:h,remoteRef:p,fastForward:b,fastForwardOnly:w,corsProxy:x,singleBranch:S,headers:E,author:$,committer:L,signingKey:R,prune:y,pruneTags:v})}catch(j){throw j.caller="git.pull",j}}async function gie({fs:e,cache:t,dir:n,gitdir:r=jt.join(n,".git"),start:a,finish:i}){const s=await jg.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const h of a)o.add(await zt.resolve({fs:e,gitdir:r,ref:h}));for(const h of i)try{const p=await zt.resolve({fs:e,gitdir:r,ref:h});l.add(p)}catch{}const u=new Set;async function d(h){u.add(h);const{type:p,object:y}=await Gr({fs:e,cache:t,gitdir:r,oid:h});if(p==="tag"){const b=wi.from(y).headers().object;return d(b)}if(p!=="commit")throw new Ci(h,p,"commit");if(!s.has(h)){const b=Vr.from(y).headers().parent;for(h of b)!l.has(h)&&!u.has(h)&&await d(h)}}for(const h of o)await d(h);return u}async function AE({fs:e,cache:t,dir:n,gitdir:r=jt.join(n,".git"),oids:a}){const i=new Set;async function s(o){if(i.has(o))return;i.add(o);const{type:l,object:u}=await Gr({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const h=wi.from(u).headers().object;await s(h)}else if(l==="commit"){const h=Vr.from(u).headers().tree;await s(h)}else if(l==="tree"){const d=Fi.from(u);for(const h of d)h.type==="blob"&&i.add(h.oid),h.type==="tree"&&await s(h.oid)}}for(const o of a)await s(o);return i}async function yie(e){const t={};let n="";const r=sa.streamReader(e);let a=await r();for(;a!==!0;)a!==null&&(n+=a.toString("utf8")+`
`),a=await r();const i=n.toString("utf8").split(`
`);if(a=i.shift(),!a.startsWith("unpack "))throw new sf('unpack ok" or "unpack [error message]',a);t.ok=a==="unpack ok",t.ok||(t.error=a.slice(7)),t.refs={};for(const s of i){if(s.trim()==="")continue;const o=s.slice(0,2),l=s.slice(3);let u=l.indexOf(" ");u===-1&&(u=l.length);const d=l.slice(0,u),h=l.slice(u+1);t.refs[d]={ok:o==="ok",error:h}}return t}async function bie({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const a of t)n.push(sa.encode(`${a.oldoid} ${a.oid} ${a.fullRef}${r}
`)),r="";return n.push(sa.flush()),n}async function vie({fs:e,cache:t,http:n,onProgress:r,onMessage:a,onAuth:i,onAuthSuccess:s,onAuthFailure:o,onPrePush:l,gitdir:u,ref:d,remoteRef:h,remote:p,url:y,force:v=!1,delete:b=!1,corsProxy:w,headers:x={}}){const S=d||await Au({fs:e,gitdir:u});if(typeof S>"u")throw new Mi("ref");const E=await ga.get({fs:e,gitdir:u});p=p||await E.get(`branch.${S}.pushRemote`)||await E.get("remote.pushDefault")||await E.get(`branch.${S}.remote`)||"origin";const C=y||await E.get(`remote.${p}.pushurl`)||await E.get(`remote.${p}.url`);if(typeof C>"u")throw new Mi("remote OR url");const k=h||await E.get(`branch.${S}.merge`);if(typeof C>"u")throw new Mi("remoteRef");w===void 0&&(w=await E.get("http.corsProxy"));const R=await zt.expand({fs:e,gitdir:u,ref:S}),O=b?"0000000000000000000000000000000000000000":await zt.resolve({fs:e,gitdir:u,ref:R}),j=gx.getRemoteHelperFor({url:C}),$=await j.discover({http:n,onAuth:i,onAuthSuccess:s,onAuthFailure:o,corsProxy:w,service:"git-receive-pack",url:C,headers:x,protocolVersion:1}),L=$.auth;let X;if(!k)X=R;else try{X=await zt.expandAgainstMap({ref:k,map:$.refs})}catch(ee){if(ee instanceof Ar)X=k.startsWith("refs/")?k:`refs/heads/${k}`;else throw ee}const F=$.refs.get(X)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:p,url:C,localRef:{ref:b?"(delete)":R,oid:O},remoteRef:{ref:X,oid:F}}))throw new pp;const K=!$.capabilities.has("no-thin");let q=new Set;if(!b){const ee=[...$.refs.values()];let oe=new Set;if(F!=="0000000000000000000000000000000000000000"){const me=await iT({fs:e,cache:t,gitdir:u,oids:[O,F]});for(const xe of me)ee.push(xe);K&&(oe=await AE({fs:e,cache:t,gitdir:u,oids:me}))}if(!ee.includes(O)){const me=await gie({fs:e,cache:t,gitdir:u,start:[O],finish:ee});q=await AE({fs:e,cache:t,gitdir:u,oids:me})}if(K){try{const me=await zt.resolve({fs:e,gitdir:u,ref:`refs/remotes/${p}/HEAD`,depth:2}),{oid:xe}=await zt.resolveAgainstMap({ref:me.replace(`refs/remotes/${p}/`,""),fullref:me,map:$.refs}),Pe=[xe];for(const Ne of await AE({fs:e,cache:t,gitdir:u,oids:Pe}))oe.add(Ne)}catch{}for(const me of oe)q.delete(me)}if(O===F&&(v=!0),!v){if(R.startsWith("refs/tags")&&F!=="0000000000000000000000000000000000000000")throw new zh("tag-exists");if(O!=="0000000000000000000000000000000000000000"&&F!=="0000000000000000000000000000000000000000"&&!await N5({fs:e,cache:t,gitdir:u,oid:O,ancestor:F,depth:-1}))throw new zh("not-fast-forward")}}const de=x5([...$.capabilities],["report-status","side-band-64k",`agent=${yx.agent}`]),re=await bie({capabilities:de,triplets:[{oldoid:F,oid:O,fullRef:X}]}),Y=b?[]:await j5({fs:e,cache:t,gitdir:u,oids:[...q]}),Q=await j.connect({http:n,onProgress:r,corsProxy:w,service:"git-receive-pack",url:C,auth:L,headers:x,body:[...re,...Y]}),{packfile:ae,progress:B}=await S5.demux(Q.body);if(a){const ee=_5(B);z0(ee,async oe=>{await a(oe)})}const J=await yie(ae);if(Q.headers&&(J.headers=Q.headers),p&&J.ok&&J.refs[X].ok&&!R.startsWith("refs/tags")){const ee=`refs/remotes/${p}/${X.replace("refs/heads","")}`;b?await zt.deleteRef({fs:e,gitdir:u,ref:ee}):await zt.writeRef({fs:e,gitdir:u,ref:ee,value:O})}if(J.ok&&Object.values(J.refs).every(ee=>ee.ok))return J;{const ee=Object.entries(J.refs).filter(([oe,me])=>!me.ok).map(([oe,me])=>`
  - ${oe}: ${me.error}`).join("");throw new R0(ee,J)}}async function wie({fs:e,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,onPrePush:o,dir:l,gitdir:u=jt.join(l,".git"),ref:d,remoteRef:h,remote:p="origin",url:y,force:v=!1,delete:b=!1,corsProxy:w,headers:x={},cache:S={}}){try{return Je("fs",e),Je("http",t),Je("gitdir",u),await vie({fs:new cn(e),cache:S,http:t,onProgress:n,onMessage:r,onAuth:a,onAuthSuccess:i,onAuthFailure:s,onPrePush:o,gitdir:u,ref:d,remoteRef:h,remote:p,url:y,force:v,delete:b,corsProxy:w,headers:x})}catch(E){throw E.caller="git.push",E}}async function O5({fs:e,cache:t,gitdir:n,oid:r}){const{type:a,object:i}=await Gr({fs:e,cache:t,gitdir:n,oid:r});if(a==="tag")return r=wi.from(i).parse().object,O5({fs:e,cache:t,gitdir:n,oid:r});if(a!=="blob")throw new Ci(r,a,"blob");return{oid:r,blob:new Uint8Array(i)}}async function D5({fs:e,cache:t,gitdir:n,oid:r,filepath:a=void 0}){return a!==void 0&&(r=await $0({fs:e,cache:t,gitdir:n,oid:r,filepath:a})),await O5({fs:e,cache:t,gitdir:n,oid:r})}async function xie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),oid:r,filepath:a,cache:i={}}){try{return Je("fs",e),Je("gitdir",n),Je("oid",r),await D5({fs:new cn(e),cache:i,gitdir:n,oid:r,filepath:a})}catch(s){throw s.caller="git.readBlob",s}}async function M5({fs:e,dir:t,gitdir:n=jt.join(t,".git"),oid:r,cache:a={}}){try{return Je("fs",e),Je("gitdir",n),Je("oid",r),await Hh({fs:new cn(e),cache:a,gitdir:n,oid:r})}catch(i){throw i.caller="git.readCommit",i}}async function _ie({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:a}){const i=await zt.resolve({gitdir:n,fs:e,ref:r}),{blob:s}=await D5({fs:e,cache:t,gitdir:n,oid:i,filepath:a});return s}async function Sie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r="refs/notes/commits",oid:a,cache:i={}}){try{return Je("fs",e),Je("gitdir",n),Je("ref",r),Je("oid",a),await _ie({fs:new cn(e),cache:i,gitdir:n,ref:r,oid:a})}catch(s){throw s.caller="git.readNote",s}}async function Eie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),oid:r,format:a="parsed",filepath:i=void 0,encoding:s=void 0,cache:o={}}){try{Je("fs",e),Je("gitdir",n),Je("oid",r);const l=new cn(e);i!==void 0&&(r=await $0({fs:l,cache:o,gitdir:n,oid:r,filepath:i}));const d=await Gr({fs:l,cache:o,gitdir:n,oid:r,format:a==="parsed"?"content":a});if(d.oid=r,a==="parsed")switch(d.format="parsed",d.type){case"commit":d.object=Vr.from(d.object).parse();break;case"tree":d.object=Fi.from(d.object).entries();break;case"blob":s?d.object=d.object.toString(s):(d.object=new Uint8Array(d.object),d.format="content");break;case"tag":d.object=wi.from(d.object).parse();break;default:throw new Ci(d.oid,d.type,"blob|commit|tag|tree")}else(d.format==="deflated"||d.format==="wrapped")&&(d.type=d.format);return d}catch(l){throw l.caller="git.readObject",l}}async function Cie({fs:e,cache:t,gitdir:n,oid:r}){const{type:a,object:i}=await Gr({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(a!=="tag")throw new Ci(r,a,"tag");const s=wi.from(i);return{oid:r,tag:s.parse(),payload:s.payload()}}async function kie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),oid:r,cache:a={}}){try{return Je("fs",e),Je("gitdir",n),Je("oid",r),await Cie({fs:new cn(e),cache:a,gitdir:n,oid:r})}catch(i){throw i.caller="git.readTag",i}}async function Tie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),oid:r,filepath:a=void 0,cache:i={}}){try{return Je("fs",e),Je("gitdir",n),Je("oid",r),await gp({fs:new cn(e),cache:i,gitdir:n,oid:r,filepath:a})}catch(s){throw s.caller="git.readTree",s}}async function Aie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),filepath:r,cache:a={}}){try{Je("fs",e),Je("gitdir",n),Je("filepath",r),await $a.acquire({fs:new cn(e),gitdir:n,cache:a},async function(i){i.delete({filepath:r})})}catch(i){throw i.caller="git.remove",i}}async function Nie({fs:e,cache:t,onSign:n,gitdir:r,ref:a="refs/notes/commits",oid:i,author:s,committer:o,signingKey:l}){let u;try{u=await zt.resolve({gitdir:r,fs:e,ref:a})}catch(v){if(!(v instanceof Ar))throw v}let h=(await gp({fs:e,gitdir:r,oid:u||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;h=h.filter(v=>v.path!==i);const p=await B0({fs:e,gitdir:r,tree:h});return await mx({fs:e,cache:t,onSign:n,gitdir:r,ref:a,tree:p,parent:u&&[u],message:`Note removed by 'isomorphic-git removeNote'
`,author:s,committer:o,signingKey:l})}async function Rie({fs:e,onSign:t,dir:n,gitdir:r=jt.join(n,".git"),ref:a="refs/notes/commits",oid:i,author:s,committer:o,signingKey:l,cache:u={}}){try{Je("fs",e),Je("gitdir",r),Je("oid",i);const d=new cn(e),h=await yu({fs:d,gitdir:r,author:s});if(!h)throw new ui("author");const p=await qh({fs:d,gitdir:r,author:h,committer:o});if(!p)throw new ui("committer");return await Nie({fs:d,cache:u,onSign:t,gitdir:r,ref:a,oid:i,author:h,committer:p,signingKey:l})}catch(d){throw d.caller="git.removeNote",d}}async function Iie({fs:e,gitdir:t,oldref:n,ref:r,checkout:a=!1}){if(r!==Bo.clean(r))throw new ao(r,Bo.clean(r));if(n!==Bo.clean(n))throw new ao(n,Bo.clean(n));const i=`refs/heads/${n}`,s=`refs/heads/${r}`;if(await zt.exists({fs:e,gitdir:t,ref:s}))throw new co("branch",r,!1);const l=await zt.resolve({fs:e,gitdir:t,ref:i,depth:1});await zt.writeRef({fs:e,gitdir:t,ref:s,value:l}),await zt.deleteRef({fs:e,gitdir:t,ref:i});const d=await Au({fs:e,gitdir:t,fullname:!0})===i;(a||d)&&await zt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:s})}async function jie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r,oldref:a,checkout:i=!1}){try{return Je("fs",e),Je("gitdir",n),Je("ref",r),Je("oldref",a),await Iie({fs:new cn(e),gitdir:n,ref:r,oldref:a,checkout:i})}catch(s){throw s.caller="git.renameBranch",s}}async function P5({gitdir:e,type:t,object:n}){return Kl(dp.wrap({type:t,object:n}))}async function Oie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),filepath:r,ref:a,cache:i={}}){try{Je("fs",e),Je("gitdir",n),Je("filepath",r);const s=new cn(e);let o,l;try{o=await zt.resolve({fs:s,gitdir:n,ref:a||"HEAD"})}catch(h){if(a)throw h}if(o)try{o=await $0({fs:s,cache:i,gitdir:n,oid:o,filepath:r})}catch{o=null}let u={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const d=t&&await s.read(jt.join(t,r));d&&(l=await P5({gitdir:n,type:"blob",object:d}),o===l&&(u=await s.lstat(jt.join(t,r)))),await $a.acquire({fs:s,gitdir:n,cache:i},async function(h){h.delete({filepath:r}),o&&h.insert({filepath:r,stats:u,oid:o})})}catch(s){throw s.caller="git.reset",s}}async function Die({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r,depth:a}){try{return Je("fs",e),Je("gitdir",n),Je("ref",r),await zt.resolve({fs:new cn(e),gitdir:n,ref:r,depth:a})}catch(i){throw i.caller="git.resolveRef",i}}async function Mie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),path:r,value:a,append:i=!1}){try{Je("fs",e),Je("gitdir",n),Je("path",r);const s=new cn(e),o=await ga.get({fs:s,gitdir:n});i?await o.append(r,a):await o.set(r,a),await ga.save({fs:s,gitdir:n,config:o})}catch(s){throw s.caller="git.setConfig",s}}async function F5({fs:e,gitdir:t,commit:n}){const r=Vr.from(n).toObject();return await $i({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class aw{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const a=t.name.replace(/\s/g,""),i="0000000000000000000000000000000000000000",s=Math.floor(Date.now()/1e3),o=aw.timezoneOffsetForRefLogEntry;return`${i} ${n} ${a} ${t.email} ${s} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(i=>i).reverse().map((i,s)=>n?`stash@{${s}}: ${i.split("	")[1]}`:i)}}const Pie={stage:up,workdir:L0};let NE;async function Vh(e,t){return NE===void 0&&(NE=new Rg),NE.acquire(e,t)}async function Fie(e,t,n,r,a=null){const i=jt.join(n,r),s=await e.lstat(i);if(!s)throw new Ar(i);if(s.isDirectory())throw new In(`${i}: file expected, but found directory`);const o=a?await s5({fs:e,gitdir:t,oid:a}):void 0;let l=o?a:void 0;return o||await Vh({fs:e,gitdir:t,currentFilepath:i},async()=>{const u=s.isSymbolicLink()?await e.readlink(i).then(f5):await e.read(i);if(u===null)throw new Ar(i);l=await $i({fs:e,gitdir:t,type:"blob",object:u})}),l}async function Lie({fs:e,dir:t,gitdir:n,entries:r}){async function a(i){if(i.type==="tree"){if(!i.oid){const s=await Promise.all(i.children.map(a));i.oid=await B0({fs:e,gitdir:n,tree:s}),i.mode=16384}}else i.type==="blob"&&(i.oid=await Fie(e,n,t,i.path,i.oid),i.mode=33188);return i.path=i.path.split("/").pop(),i}return Promise.all(r.map(a))}async function S4({fs:e,dir:t,gitdir:n,treePair:r}){const a=r[1]==="stage",i=r.map(y=>typeof y=="string"?Pie[y]():y),s=[],d=await gu({fs:e,cache:{},dir:t,gitdir:n,trees:i,map:async(y,[v,b])=>{if(!(y==="."||await mp.isIgnored({fs:e,dir:t,gitdir:n,filepath:y}))&&b)return(!v||await v.oid()!==await b.oid()&&await b.oid()!==void 0)&&s.push([v,b]),{mode:await b.mode(),path:y,oid:await b.oid(),type:await b.type()}},reduce:async(y,v)=>(v=v.filter(Boolean),y?(y.children=v,y):v.length>0?v:void 0),iterate:async(y,v)=>{const b=[];for(const w of v){const[x,S]=w;a?S&&(await e.exists(`${t}/${S.toString()}`)?b.push(w):s.push([null,S])):x&&(S?b.push(w):s.push([x,null]))}return b.length?Promise.all(b.map(y)):[]}});if(s.length===0||d.length===0)return null;const p=(await Lie({fs:e,dir:t,gitdir:n,entries:d})).filter(Boolean).map(y=>({mode:y.mode,path:y.path,oid:y.oid,type:y.type}));return B0({fs:e,gitdir:n,tree:p})}async function $ie({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:a,wasStaged:i}){const s=[],o=[],l=await gu({fs:e,cache:{},dir:t,gitdir:n,trees:[Es({ref:a}),Es({ref:r})],map:async(u,[d,h])=>{if(u==="."||await mp.isIgnored({fs:e,dir:t,gitdir:n,filepath:u}))return;const p=h?await h.type():await d.type();if(p!=="tree"&&p!=="blob")return;if(!h&&d){const v=p==="tree"?"rmdir":"rm";return p==="tree"&&s.push(u),p==="blob"&&i&&o.push({filepath:u,oid:await d.oid()}),{method:v,filepath:u}}const y=await h.oid();if(!d||await d.oid()!==y)return p==="tree"?{method:"mkdir",filepath:u}:(i&&o.push({filepath:u,oid:y,stats:await e.lstat(jt.join(t,u))}),{method:"write",filepath:u,oid:y})}});await Vh({fs:e,gitdir:n,dirRemoved:s,ops:l},async()=>{for(const u of l){const d=jt.join(t,u.filepath);switch(u.method){case"rmdir":await e.rmdir(d);break;case"mkdir":await e.mkdir(d);break;case"rm":await e.rm(d);break;case"write":if(!s.some(h=>d.startsWith(h))){const{object:h}=await Gr({fs:e,cache:{},gitdir:n,oid:u.oid});await e.exists(d)&&await e.rm(d),await e.write(d,h)}break}}}),await $a.acquire({fs:e,gitdir:n,cache:{}},async u=>{o.forEach(({filepath:d,stats:h,oid:p})=>{u.insert({filepath:d,stats:h,oid:p})})})}class zl{constructor({fs:t,dir:n,gitdir:r=jt.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return jt.join(this.gitdir,zl.refStash)}get refLogsStashPath(){return jt.join(this.gitdir,zl.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await yu({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new ui("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return F5({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new ao(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?Hh({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return zt.writeRef({fs:this.fs,gitdir:this.gitdir,ref:zl.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),a=aw.createStashReflogEntry(r,t,n),i=this.refLogsStashPath;await Vh({filepath:i,entry:a},async()=>{const s=await this.fs.exists(i)?await this.fs.read(i,"utf8"):"";await this.fs.write(i,s+a,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return aw.getStashReflogEntry(r,t)}}async function Bie({fs:e,dir:t,gitdir:n,message:r=""}){const a=new zl({fs:e,dir:t,gitdir:n});await a.getAuthor();const i=await Au({fs:e,gitdir:n,fullname:!1}),s=await zt.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await M5({fs:e,dir:t,gitdir:n,oid:s})).commit.message,u=[s];let d=null,h=Es({ref:"HEAD"});const p=await S4({fs:e,dir:t,gitdir:n,treePair:[Es({ref:"HEAD"}),"stage"]});if(p){const w=await a.writeStashCommit({message:`stash-Index: WIP on ${i} - ${new Date().toISOString()}`,tree:p,parent:u});u.push(w),d=p,h=up()}const y=await S4({fs:e,dir:t,gitdir:n,treePair:[h,"workdir"]});if(y){const w=await a.writeStashCommit({message:`stash-WorkDir: WIP on ${i} - ${new Date().toISOString()}`,tree:y,parent:[u[u.length-1]]});u.push(w),d=y}if(!d||!p&&!y)throw new Ar("changes, nothing to stash");const v=(r.trim()||`WIP on ${i}`)+`: ${s.substring(0,7)} ${l}`,b=await a.writeStashCommit({message:v,tree:d,parent:u});return await a.writeStashRef(b),await a.writeStashReflogEntry({stashCommit:b,message:v}),await v5({fs:e,dir:t,gitdir:n,ref:i,track:!1,force:!0}),b}async function L5({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=await new zl({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:s=null}=i.commit?i.commit:{};if(!(!s||!Array.isArray(s)))for(let o=0;o<s.length-1;o++){const u=(await Hh({fs:e,cache:{},gitdir:n,oid:s[o+1]})).commit.message.startsWith("stash-Index");await $ie({fs:e,dir:t,gitdir:n,stashCommit:s[o+1],parentCommit:s[o],wasStaged:u})}}async function $5({fs:e,dir:t,gitdir:n,refIdx:r=0}){const a=new zl({fs:e,dir:t,gitdir:n});if(!(await a.readStashCommit(r)).commit)return;const s=a.refStashPath;await Vh(s,async()=>{await e.exists(s)&&await e.rm(s)});const o=await a.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=a.refLogsStashPath;await Vh({reflogEntries:o,stashReflogPath:l,stashMgr:a},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const u=o[o.length-1].split(" ")[1];await a.writeStashRef(u)}else await e.rm(l)})}async function zie({fs:e,dir:t,gitdir:n}){return new zl({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function Uie({fs:e,dir:t,gitdir:n}){const r=new zl({fs:e,dir:t,gitdir:n}),a=[r.refStashPath,r.refLogsStashPath];await Vh(a,async()=>{await Promise.all(a.map(async i=>{if(await e.exists(i))return e.rm(i)}))})}async function qie({fs:e,dir:t,gitdir:n,refIdx:r=0}){await L5({fs:e,dir:t,gitdir:n,refIdx:r}),await $5({fs:e,dir:t,gitdir:n,refIdx:r})}async function Hie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),op:r="push",message:a="",refIdx:i=0}){Je("fs",e),Je("dir",t),Je("gitdir",n),Je("op",r);const s={push:Bie,apply:L5,drop:$5,list:zie,clear:Uie,pop:qie},o=["apply","drop","pop"];try{const l=new cn(e);["refs","logs","logs/refs"].map(h=>jt.join(n,h)).forEach(async h=>{await l.exists(h)||await l.mkdir(h)});const d=s[r];if(d){if(o.includes(r)&&i<0)throw new ao(`stash@${i}`,"number that is in range of [0, num of stash pushed]");return await d({fs:l,dir:t,gitdir:n,message:a,refIdx:i})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function Vie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),filepath:r,cache:a={}}){try{Je("fs",e),Je("gitdir",n),Je("filepath",r);const i=new cn(e);if(await mp.isIgnored({fs:i,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await Gie({fs:i,cache:a,gitdir:n}),l=await B5({fs:i,cache:a,gitdir:n,tree:o,path:r}),u=await $a.acquire({fs:i,gitdir:n,cache:a},async function(b){for(const w of b)if(w.path===r)return w;return null}),d=await i.lstat(jt.join(t,r)),h=l!==null,p=u!==null,y=d!==null,v=async()=>{if(p&&!Yv(u,d))return u.oid;{const b=await i.read(jt.join(t,r)),w=await P5({gitdir:n,type:"blob",object:b});return p&&u.oid===w&&d.size!==-1&&$a.acquire({fs:i,gitdir:n,cache:a},async function(x){x.insert({filepath:r,stats:d,oid:w})}),w}};if(!h&&!y&&!p)return"absent";if(!h&&!y&&p)return"*absent";if(!h&&y&&!p)return"*added";if(!h&&y&&p)return await v()===u.oid?"added":"*added";if(h&&!y&&!p)return"deleted";if(h&&!y&&p)return l===u.oid,"*deleted";if(h&&y&&!p)return await v()===l?"*undeleted":"*undeletemodified";if(h&&y&&p){const b=await v();return b===l?b===u.oid?"unmodified":"*unmodified":b===u.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function B5({fs:e,cache:t,gitdir:n,tree:r,path:a}){typeof a=="string"&&(a=a.split("/"));const i=a.shift();for(const s of r)if(s.path===i){if(a.length===0)return s.oid;const{type:o,object:l}=await Gr({fs:e,cache:t,gitdir:n,oid:s.oid});if(o==="tree"){const u=Fi.from(l);return B5({fs:e,cache:t,gitdir:n,tree:u,path:a})}if(o==="blob")throw new Ci(s.oid,o,"blob",a.join("/"))}return null}async function Gie({fs:e,cache:t,gitdir:n}){let r;try{r=await zt.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(i){if(i instanceof Ar)return[]}const{tree:a}=await gp({fs:e,cache:t,gitdir:n,oid:r});return a}async function Wie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r="HEAD",filepaths:a=["."],filter:i,cache:s={},ignored:o=!1}){try{Je("fs",e),Je("gitdir",n),Je("ref",r);const l=new cn(e);return await gu({fs:l,cache:s,dir:t,gitdir:n,trees:[Es({ref:r}),L0(),up()],map:async function(u,[d,h,p]){if(!d&&!p&&h&&!o&&await mp.isIgnored({fs:l,dir:t,filepath:u})||!a.some(R=>b5(u,R)))return null;if(i&&!i(u))return;const[y,v,b]=await Promise.all([d&&d.type(),h&&h.type(),p&&p.type()]),w=[y,v,b].includes("blob");if((y==="tree"||y==="special")&&!w)return;if(y==="commit")return null;if((v==="tree"||v==="special")&&!w)return;if(b==="commit")return null;if((b==="tree"||b==="special")&&!w)return;const x=y==="blob"?await d.oid():void 0,S=b==="blob"?await p.oid():void 0;let E;y!=="blob"&&v==="blob"&&b!=="blob"?E="42":v==="blob"&&(E=await h.oid());const C=[void 0,x,E,S],k=C.map(R=>C.indexOf(R));return k.shift(),[u,...k]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function Kie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r,object:a,force:i=!1}){try{Je("fs",e),Je("gitdir",n),Je("ref",r);const s=new cn(e);if(r===void 0)throw new Mi("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await zt.resolve({fs:s,gitdir:n,ref:a||"HEAD"});if(!i&&await zt.exists({fs:s,gitdir:n,ref:r}))throw new co("tag",r);await zt.writeRef({fs:s,gitdir:n,ref:r,value:o})}catch(s){throw s.caller="git.tag",s}}async function Zie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),cache:r={},filepath:a,oid:i,mode:s,add:o,remove:l,force:u}){try{Je("fs",e),Je("gitdir",n),Je("filepath",a);const d=new cn(e);if(l)return await $a.acquire({fs:d,gitdir:n,cache:r},async function(p){if(!u){const y=await d.lstat(jt.join(t,a));if(y){if(y.isDirectory())throw new mu("directory");return}}p.has({filepath:a})&&p.delete({filepath:a})});let h;if(!i){if(h=await d.lstat(jt.join(t,a)),!h)throw new Ar(`file at "${a}" on disk and "remove" not set`);if(h.isDirectory())throw new mu("directory")}return await $a.acquire({fs:d,gitdir:n,cache:r},async function(p){if(!o&&!p.has({filepath:a}))throw new Ar(`file at "${a}" in index and "add" not set`);let y;if(i)y={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:s,uid:0,gid:0,size:0};else{y=h;const v=y.isSymbolicLink()?await d.readlink(jt.join(t,a)):await d.read(jt.join(t,a));i=await $i({fs:d,gitdir:n,type:"blob",format:"content",object:v})}return p.insert({filepath:a,oid:i,stats:y}),i})}catch(d){throw d.caller="git.updateIndex",d}}function Yie(){try{return yx.version}catch(e){throw e.caller="git.version",e}}async function Xie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),trees:r,map:a,reduce:i,iterate:s,cache:o={}}){try{return Je("fs",e),Je("gitdir",n),Je("trees",r),await gu({fs:new cn(e),cache:o,dir:t,gitdir:n,trees:r,map:a,reduce:i,iterate:s})}catch(l){throw l.caller="git.walk",l}}async function Jie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),blob:r}){try{return Je("fs",e),Je("gitdir",n),Je("blob",r),await $i({fs:new cn(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(a){throw a.caller="git.writeBlob",a}}async function Qie({fs:e,dir:t,gitdir:n=jt.join(t,".git"),commit:r}){try{return Je("fs",e),Je("gitdir",n),Je("commit",r),await F5({fs:new cn(e),gitdir:n,commit:r})}catch(a){throw a.caller="git.writeCommit",a}}async function ese({fs:e,dir:t,gitdir:n=jt.join(t,".git"),type:r,object:a,format:i="parsed",oid:s,encoding:o=void 0}){try{const l=new cn(e);if(i==="parsed"){switch(r){case"commit":a=Vr.from(a).toObject();break;case"tree":a=Fi.from(a).toObject();break;case"blob":a=Xt.from(a,o);break;case"tag":a=wi.from(a).toObject();break;default:throw new Ci(s||"",r,"blob|commit|tag|tree")}i="content"}return s=await $i({fs:l,gitdir:n,type:r,object:a,oid:s,format:i}),s}catch(l){throw l.caller="git.writeObject",l}}async function tse({fs:e,dir:t,gitdir:n=jt.join(t,".git"),ref:r,value:a,force:i=!1,symbolic:s=!1}){try{Je("fs",e),Je("gitdir",n),Je("ref",r),Je("value",a);const o=new cn(e);if(r!==Bo.clean(r))throw new ao(r,Bo.clean(r));if(!i&&await zt.exists({fs:o,gitdir:n,ref:r}))throw new co("ref",r);s?await zt.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:a}):(a=await zt.resolve({fs:o,gitdir:n,ref:a}),await zt.writeRef({fs:o,gitdir:n,ref:r,value:a}))}catch(o){throw o.caller="git.writeRef",o}}async function nse({fs:e,gitdir:t,tag:n}){const r=wi.from(n).toObject();return await $i({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function rse({fs:e,dir:t,gitdir:n=jt.join(t,".git"),tag:r}){try{return Je("fs",e),Je("gitdir",n),Je("tag",r),await nse({fs:new cn(e),gitdir:n,tag:r})}catch(a){throw a.caller="git.writeTag",a}}async function ase({fs:e,dir:t,gitdir:n=jt.join(t,".git"),tree:r}){try{return Je("fs",e),Je("gitdir",n),Je("tree",r),await B0({fs:new cn(e),gitdir:n,tree:r})}catch(a){throw a.caller="git.writeTree",a}}var _a={Errors:jre,STAGE:up,TREE:Es,WORKDIR:L0,add:Yre,abortMerge:Gre,addNote:Jre,addRemote:Qre,annotatedTag:tae,branch:rae,checkout:v5,clone:mae,commit:gae,getConfig:Fae,getConfigAll:$ae,setConfig:Mie,currentBranch:yae,deleteBranch:vae,deleteRef:wae,deleteRemote:_ae,deleteTag:Eae,expandOid:Aae,expandRef:Nae,fastForward:Oae,fetch:Dae,findMergeBase:Mae,findRoot:Pae,getRemoteInfo:Bae,getRemoteInfo2:zae,hashBlob:qae,indexPack:Vae,init:Gae,isDescendent:Wae,isIgnored:Kae,listBranches:Zae,listFiles:Xae,listNotes:Qae,listRefs:eie,listRemotes:nie,listServerRefs:iie,listTags:sie,log:uie,merge:die,packObjects:pie,pull:mie,push:wie,readBlob:xie,readCommit:M5,readNote:Sie,readObject:Eie,readTag:kie,readTree:Tie,remove:Aie,removeNote:Rie,renameBranch:jie,resetIndex:Oie,updateIndex:Zie,resolveRef:Die,status:Vie,statusMatrix:Wie,tag:Kie,version:Yie,walk:Xie,writeBlob:Jie,writeCommit:Qie,writeObject:ese,writeRef:tse,writeTag:rse,writeTree:ase,stash:Hie};function ise(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function sse(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:ise(e)}async function ose(e,t){const n=sse(e);for(;;){const{value:r,done:a}=await n.next();if(r&&await t(r),a)break}n.return&&n.return()}async function lse(e){let t=0;const n=[];await ose(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let a=0;for(const i of n)r.set(i,a),a+=i.byteLength;return r}function cse(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function use({onProgress:e,url:t,method:n="GET",headers:r={},body:a}){a&&(a=await lse(a));const i=await fetch(t,{method:n,headers:r,body:a}),s=i.body&&i.body.getReader?cse(i.body):[new Uint8Array(await i.arrayBuffer())];r={};for(const[o,l]of i.headers.entries())r[o]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:s,headers:r}}var Og={request:use};const Dg="https://cors.isomorphic-git.org",Gh=new Map,z5=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=qr.getState();if(!n||!r)return tt.error("Git user name and email must be configured in Settings before committing."),!1;try{const a=await _a.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),i=await _a.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return a!==n&&await _a.setConfig({fs:t,dir:e,path:"user.name",value:n}),i!==r&&await _a.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(a){return console.error("[VFS Git Op] Error checking/setting Git config:",a),tt.error(`Failed to configure Git user: ${a instanceof Error?a.message:String(a)}`),!1}},Mg=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=Gh.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const a=window.prompt(`Enter username for ${e}`);if(!a)return tt.error("Authentication cancelled: Username not provided."),null;const i=window.prompt(`Enter password or token for ${a}@${e}`);return i?(Gh.set(n,{username:a,password:i}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:a,password:i,authScheme:"Basic"}):(tt.error("Authentication cancelled: Password/token not provided."),null)},Pg=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),Gh.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),Gh.delete(n)),null},Fg=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!Gh.has(n)&&t.username&&t.password&&(Gh.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},xh=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let a="";if(r)try{const i=JSON.parse(r);a=i.message||i.error||JSON.stringify(i)}catch{a=r}return`HTTP ${t} ${n}${a?`: ${a}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},dse=async(e,t)=>{const n=qa,r=nr(e),a=Ko(r,".git");try{return(await n.promises.stat(a)).isDirectory()}catch(i){return i instanceof Error&&i.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,i),!1}},U5=async(e,t,n,r,a)=>{var o;const i=(a==null?void 0:a.fsInstance)??qa,s=nr(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${s}`);try{let l=!1;try{await i.promises.stat(Ko(s,".git")),l=!0}catch(p){if(p.code!=="ENOENT")throw p}if(l)throw console.warn(`[VFS Git Op] Clone target ${s} already contains a .git directory.`),new Error(`Repository already cloned at ${s}.`);const u=_0(s);if(u!=="/")try{await i.promises.mkdir(u,{recursive:!0})}catch(p){if(p.code!=="EEXIST")throw p}let d=n;if(!d)try{if(d=(o=(await _a.getRemoteInfo({http:Og,url:t,corsProxy:Dg,onAuth:y=>Mg(y,r),onAuthFailure:Pg,onAuthSuccess:Fg})).HEAD)==null?void 0:o.replace("refs/heads/",""),!d)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${d}`)}catch(p){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",p),new Error(`Failed to determine default branch: ${xh(p)}`)}await _a.clone({fs:i,http:Og,dir:s,corsProxy:Dg,url:t,ref:d,singleBranch:!0,depth:10,onAuth:p=>Mg(p,r),onAuthFailure:Pg,onAuthSuccess:Fg,onProgress:p=>{p.phase==="counting objects"&&p.total?console.log(`Clone progress: ${p.phase} ${p.loaded}/${p.total}`):p.phase==="receiving objects"&&p.total?console.log(`Clone progress: ${p.phase} ${p.loaded}/${p.total}`):console.log(`Clone progress: ${p.phase}`)}}),await i.promises.stat(Ko(s,".git"));const h=await _a.currentBranch({fs:i,dir:s,fullname:!1}).catch(()=>null);h!==d&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${h}, expected ${d}. Checking out...`),await _a.checkout({fs:i,dir:s,ref:d})),tt.success(`Repository cloned successfully into ${s} (branch: ${d}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const u=xh(l);if(l instanceof Error&&l.message.includes("already cloned")||tt.error(`Git clone failed: ${u}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${s}`),await i.promises.rm(s,{recursive:!0,force:!0})}catch(d){console.warn("[VFS Git Op] Failed cleanup after clone error:",d)}throw l}},q5=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??qa,r=nr(e);try{await _a.init({fs:n,dir:r}),tt.success(`Initialized empty Git repository in "${ma(r)}"`)}catch(a){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,a),tt.error(`Git init failed: ${a instanceof Error?a.message:String(a)}`),a}},sT=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??qa,a=nr(e);try{if(!await z5(a,r))throw new Error("Git user configuration is missing or invalid.");if(await _a.add({fs:r,dir:a,filepath:"."}),!(await _a.statusMatrix({fs:r,dir:a})).some(([,,u])=>u!==0)){tt.info("No changes detected to commit.");return}const l=await _a.commit({fs:r,dir:a,message:t,author:{name:qr.getState().gitUserName,email:qr.getState().gitUserEmail}});tt.success(`Changes committed: ${l.substring(0,7)}`)}catch(i){throw console.error(`[VFS Git Op] Git commit failed for ${a}:`,i),tt.error(`Git commit failed: ${i instanceof Error?i.message:String(i)}`),i}},bx=async(e,t,n,r)=>{const a=(r==null?void 0:r.fsInstance)??qa,i=nr(e);try{if(!await z5(i,a))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${i}`);const o=await _a.currentBranch({fs:a,dir:i,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await _a.checkout({fs:a,dir:i,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await _a.fetch({fs:a,http:Og,dir:i,corsProxy:Dg,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:u=>Mg(u,n),onAuthFailure:Pg,onAuthSuccess:Fg}),await _a.branch({fs:a,dir:i,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(u){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,u),new Error(`Failed to switch to or create local branch "${t}": ${xh(u)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${xh(l)}`)}}await _a.pull({fs:a,http:Og,dir:i,ref:t,singleBranch:!0,author:{name:qr.getState().gitUserName,email:qr.getState().gitUserEmail},corsProxy:Dg,onAuth:l=>Mg(l,n),onAuthFailure:Pg,onAuthSuccess:Fg}),tt.success(`Pulled changes successfully for "${ma(i)}"`),console.log(`[VFS Git Op] Pull successful for ${i}`)}catch(s){if(console.error(`[VFS Git Op] Git pull failed for ${i}:`,s),s instanceof Error&&s.message.toLowerCase().includes("already up-to-date")?tt.info(`Branch "${t}" is already up-to-date.`):tt.error(`Git pull failed: ${xh(s)}`),!(s instanceof Error&&s.message.toLowerCase().includes("already up-to-date")))throw s}},oT=async(e,t,n,r)=>{var s,o;const a=(r==null?void 0:r.fsInstance)??qa,i=nr(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${i}`);const l=await _a.push({fs:a,http:Og,dir:i,corsProxy:Dg,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:u=>Mg(u,n),onAuthFailure:Pg,onAuthSuccess:Fg});if(l!=null&&l.ok)tt.success(`Pushed changes successfully for "${ma(i)}"`);else if((s=l==null?void 0:l.error)!=null&&s.includes("up-to-date"))tt.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(tt.error(`Push rejected for "${ma(i)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${i}:`,l),l instanceof Error&&l.message.includes("rejected")||tt.error(`Git push failed: ${xh(l)}`),l}},H5=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??qa,r=nr(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const a=await _a.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",a);const i=a.map(([s,o,l,u])=>{let d="";return u===2&&(d+="INDEX_Modified "),u===3&&(d+="INDEX_Added "),o===0&&l===2?d+="WT_New":o===1&&l===2?d+="WT_Modified":o===1&&l===0?d+="WT_Deleted":o===1&&l===1&&u===0&&(d="Unmodified"),(!d||d==="INDEX_Unmodified ")&&(d=`h:${o} w:${l} s:${u}`),`${s}: ${d.trim()}`}).filter(s=>!s.endsWith("Unmodified")).join(`
`);tt.info(`Git Status for "${ma(r)}":
${i||"No changes"}`,{duration:15e3})}catch(a){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,a),tt.error(`Git status failed: ${a instanceof Error?a.message:String(a)}`),a}},Fd=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??qa,r=nr(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(a){if(a instanceof Error&&a.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,a),tt.error(`Error creating directory "${ma(r)}": ${a instanceof Error?a.message:String(a)}`),a}},fse=async e=>{try{const t={backend:mne,name:`litechat_vfs_${e}`};return await one(t),qa}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),tt.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},lT=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??qa,r=nr(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await Fd(r,{fsInstance:n}),[];throw l}const i=(await n.promises.readdir(r)).map(async l=>{const u=Ko(r,l);try{const d=await n.promises.stat(u);return{name:l,path:u,isDirectory:d.isDirectory(),size:d.size,lastModified:d.mtime}}catch(d){return console.error(`[VFS Op] Failed to stat ${u}:`,d),null}});return(await Promise.all(i)).filter(l=>l!==null)}catch(a){throw console.error(`[VFS Op] Failed to list directory ${r}:`,a),tt.error(`Error listing files: ${a instanceof Error?a.message:String(a)}`),a}},of=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??qa,r=nr(e);try{const a=await n.promises.readFile(r);return St.emit(_t.VFS_FILE_READ,{path:r}),a}catch(a){throw console.error(`[VFS Op] Failed to read file ${r}:`,a),tt.error(`Error reading file "${ma(r)}": ${a instanceof Error?a.message:String(a)}`),a}},vx=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??qa,a=nr(e),i=_0(a);try{i!=="/"&&await Fd(i,{fsInstance:r}),await r.promises.writeFile(a,t),St.emit(_t.VFS_FILE_WRITTEN,{path:a})}catch(s){throw s instanceof Error&&s.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${a}:`,s),tt.error(`Error writing file "${ma(a)}": ${s instanceof Error?s.message:String(s)}`)),s}},cT=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??qa,a=nr(e);if(a==="/")throw tt.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(a)).isDirectory()?(await r.promises.rm(a,{recursive:t}),St.emit(_t.VFS_FILE_DELETED,{path:a})):(await r.promises.unlink(a),St.emit(_t.VFS_FILE_DELETED,{path:a})),tt.success(`"${ma(a)}" deleted.`)}catch(i){if(i instanceof Error&&i.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${a}`);return}throw console.error(`[VFS Op] Failed to delete ${a}:`,i),tt.error(`Error deleting "${ma(a)}": ${i instanceof Error?i.message:String(i)}`),i}},V5=async(e,t)=>{await Fd(e,t)},hse=async(e,t,n)=>{try{const r=await of(e,n),a=new Blob([r]),i=URL.createObjectURL(a),s=document.createElement("a");s.href=i;const o=nr(e);s.download=t||ma(o),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||tt.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},G5=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??qa,a=nr(t);let i=0,s=0;const o=Array.from(e);try{await Fd(a,{fsInstance:r});for(const l of o){const u=Ko(a,l.name);try{const d=await l.arrayBuffer();await vx(u,new Uint8Array(d),{fsInstance:r}),i++}catch(d){s++,console.error(`[VFS Op] Failed to upload ${l.name}:`,d)}}}catch(l){s=o.length,console.error(`[VFS Op] Failed to prepare target directory ${a} for upload:`,l)}finally{s>0&&i>0?tt.warning(`Upload complete with issues. ${i} succeeded, ${s} failed.`):s===0&&i>0&&tt.success(`Successfully uploaded ${i} file(s) to ${a==="/"?"root":ma(a)}.`)}},pse=async(e,t,n)=>{const r=qa;if(!e.name.toLowerCase().endsWith(".zip")){tt.error("Please select a valid ZIP file.");return}const a=nr(t);let i;try{await Fd(a,{fsInstance:r}),i=await KP.loadAsync(e);const s=Object.values(i.files),o=await Promise.allSettled(s.map(async h=>{const p=Ko(a,h.name);if(h.dir)await Fd(p,{fsInstance:r});else{const y=await h.async("uint8array");await vx(p,y,{fsInstance:r})}return{name:h.name,isDir:h.dir}}));let l=0,u=0,d=0;o.forEach(h=>{h.status==="fulfilled"&&h.value?h.value.isDir?u++:l++:h.status==="rejected"&&(d++,console.error("[VFS Op] ZIP Extraction item failed:",h.reason))}),d>0?tt.warning(`Finished extracting "${e.name}". ${l+u} items succeeded, ${d} failed.`):tt.success(`Successfully extracted ${l} files and ${u} folders from "${e.name}" to ${a==="/"?"root":ma(a)}.`)}catch(s){s instanceof Error&&s.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,s),tt.error(`ZIP extraction failed: ${s instanceof Error?s.message:String(s)}`))}},E4=async(e,t="/",n)=>{const r=qa,a=new KP,i=nr(t),s=ma(i)||"root";try{try{if(!(await r.promises.stat(i)).isDirectory()){tt.error(`Cannot export: "${s}" is not a directory.`);return}}catch(p){p instanceof Error&&p.code==="ENOENT"?tt.error(`Cannot export: Path "${s}" not found.`):tt.error(`Cannot export: Error accessing path "${s}". ${p instanceof Error?p.message:String(p)}`);return}const o=async(p,y)=>{const v=await lT(p,{fsInstance:r});for(const b of v)if(b.isDirectory){if(b.name===".git")continue;const w=y.folder(b.name);if(w)await o(b.path,w);else throw new Error(`Failed to create subfolder ${b.name} in zip.`)}else{const w=await of(b.path,{fsInstance:r});y.file(b.name,w)}};await o(i,a);const l=await a.generateAsync({type:"blob"}),u=URL.createObjectURL(l),d=document.createElement("a");d.href=u;const h=`vfs_${s}_export.zip`;d.download=e||h,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(u),tt.success(`"${s}" exported as ${d.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||tt.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},W5=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??qa,a=nr(e),i=nr(t);if(a==="/"||i==="/")throw tt.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(a!==i)try{const s=_0(i);s!=="/"&&await Fd(s,{fsInstance:r}),await r.promises.rename(a,i),tt.success(`Renamed "${ma(a)}" to "${ma(i)}"`)}catch(s){throw s instanceof Error&&s.code==="ENOENT"?s.message.includes("Error creating directory")||tt.error(`Rename failed: Original item "${ma(a)}" not found.`):s instanceof Error&&s.code==="EEXIST"?tt.error(`Rename failed: An item named "${ma(i)}" already exists.`):s instanceof Error&&s.message.includes("Error creating directory")||tt.error(`Rename failed: ${s instanceof Error?s.message:String(s)}`),console.error(`[VFS Op] Failed to rename ${a} to ${i}:`,s),s}},mse=1024*5,gse=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);const a=new Uint8Array(r),i=new Blob([a],{type:t});return URL.createObjectURL(i)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},C4=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const a=new Uint8Array(r);t=new Blob([a],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},K5=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,a]=T.useState(null),[i,s]=T.useState(null),[o,l]=T.useState(!1),[u,d]=T.useState(!1),[h,p]=T.useState(!0),y=e.type||"application/octet-stream",v=GC(e.name,y),b=y.startsWith("image/"),w=y.startsWith("audio/"),x=y.startsWith("video/"),S=e.source==="vfs";T.useEffect(()=>{let $=null;return s(null),e.source==="direct"&&!v&&e.contentBase64?($=gse(e.contentBase64,y),$||s("Failed to decode file content for preview."),a($)):a(null),e.source==="direct"&&v&&e.contentText&&e.contentText.length>mse?s(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&v&&e.contentText===void 0&&s("Text content missing from metadata."),()=>{$&&(URL.revokeObjectURL($),a(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,y,v]);const E=async()=>{if(e.source==="vfs"){tt.info("File is already in VFS.");return}const $=C4(e);if(!$){tt.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await G5([$],"/"),tt.success(`"${e.name}" added to VFS root.`)}catch(L){console.error("Failed to add file to VFS:",L),tt.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},C=async()=>{d(!0);try{let $;if(e.source==="vfs"&&e.path){const F=await of(e.path);$=new Blob([F],{type:y})}else{const F=C4(e);if(!F)throw new Error("Could not reconstruct file data.");$=F}const L=URL.createObjectURL($),X=document.createElement("a");X.href=L,X.download=e.name,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(L)}catch($){console.error("Failed to download file:",$),tt.error(`Download failed: ${$ instanceof Error?$.message:String($)}`)}finally{d(!1)}},k=()=>p($=>!$),R=()=>S?m.jsx(k6,{className:"h-5 w-5 text-cyan-500"}):v?m.jsx(Tq,{className:"h-5 w-5 text-blue-500"}):b?m.jsx(Kq,{className:"h-5 w-5 text-purple-500"}):w?m.jsx(aH,{className:"h-5 w-5 text-green-500"}):x?m.jsx(FH,{className:"h-5 w-5 text-orange-500"}):m.jsx(Cq,{className:"h-5 w-5 text-muted-foreground"}),O=()=>S?m.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):i?m.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[m.jsx(Ad,{className:"h-4 w-4"}),m.jsx("span",{children:i})]}):v&&e.contentText!==void 0?m.jsx(p0,{lang:y==="text/markdown"?"markdown":"text",code:e.contentText}):b&&r?m.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):w&&r?m.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):x&&r?m.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):m.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),j=T.useMemo(()=>{let $="File";return S?$="VFS File":v?$="Text":b?$="Image":w?$="Audio":x&&($="Video"),`${$} (${Zv(e.size)})`},[S,v,b,w,x,e.size]);return m.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[m.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[m.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[R(),m.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),m.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",Zv(e.size),")"]}),S&&e.path&&m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),m.jsx(Jn,{children:m.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),m.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:C,disabled:u,"aria-label":"Download file",children:u?m.jsx(zn,{className:"h-3.5 w-3.5 animate-spin"}):m.jsx(yh,{className:"h-3.5 w-3.5"})})}),m.jsx(Jn,{children:"Download File"})]})}),m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:k,"aria-label":h?"Unfold preview":"Fold preview",children:m.jsx(kw,{className:"h-3.5 w-3.5"})})}),m.jsx(Jn,{side:"top",children:h?"Unfold":"Fold"})]})}),!n&&t&&m.jsxs(m.Fragment,{children:[e.source==="direct"&&m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:E,disabled:o,"aria-label":"Add to VFS",children:o?m.jsx(zn,{className:"h-3.5 w-3.5 animate-spin"}):m.jsx(E6,{className:"h-3.5 w-3.5"})})}),m.jsx(Jn,{children:"Add to VFS"})]})}),m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:m.jsx(Ts,{className:"h-3.5 w-3.5"})})}),m.jsx(Jn,{children:"Remove from Prompt"})]})})]})]})]}),h?m.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:k,children:j}):m.jsx("div",{className:Nt("p-2 max-h-80 overflow-y-auto"),children:O()})]})},Z5=6048e5,yse=864e5,Lb=43200,k4=1440,T4=Symbol.for("constructDateFrom");function Zl(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&T4 in e?e[T4](t):e instanceof Date?new e.constructor(t):new Date(t)}function Ua(e,t){return Zl(t||e,e)}let bse={};function U0(){return bse}function Lg(e,t){var o,l,u,d;const n=U0(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=Ua(e,t==null?void 0:t.in),i=a.getDay(),s=(i<r?7:0)+i-r;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function iw(e,t){return Lg(e,{...t,weekStartsOn:1})}function Y5(e,t){const n=Ua(e,t==null?void 0:t.in),r=n.getFullYear(),a=Zl(n,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const i=iw(a),s=Zl(n,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const o=iw(s);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function sw(e){const t=Ua(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function wx(e,...t){const n=Zl.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function A4(e,t){const n=Ua(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function vse(e,t,n){const[r,a]=wx(n==null?void 0:n.in,e,t),i=A4(r),s=A4(a),o=+i-sw(i),l=+s-sw(s);return Math.round((o-l)/yse)}function wse(e,t){const n=Y5(e,t),r=Zl(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),iw(r)}function sv(e,t){const n=+Ua(e)-+Ua(t);return n<0?-1:n>0?1:n}function xse(e){return Zl(e,Date.now())}function _se(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Sse(e){return!(!_se(e)&&typeof e!="number"||isNaN(+Ua(e)))}function Ese(e,t,n){const[r,a]=wx(n==null?void 0:n.in,e,t),i=r.getFullYear()-a.getFullYear(),s=r.getMonth()-a.getMonth();return i*12+s}function Cse(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function kse(e,t){return+Ua(e)-+Ua(t)}function Tse(e,t){const n=Ua(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function Ase(e,t){const n=Ua(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function Nse(e,t){const n=Ua(e,t==null?void 0:t.in);return+Tse(n,t)==+Ase(n,t)}function Rse(e,t,n){const[r,a,i]=wx(n==null?void 0:n.in,e,e,t),s=sv(a,i),o=Math.abs(Ese(a,i));if(o<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-s*o);let l=sv(a,i)===-s;Nse(r)&&o===1&&sv(r,i)===1&&(l=!1);const u=s*(o-+l);return u===0?0:u}function Ise(e,t,n){const r=kse(e,t)/1e3;return Cse(n==null?void 0:n.roundingMethod)(r)}function jse(e,t){const n=Ua(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const Ose={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Dse=(e,t,n)=>{let r;const a=Ose[e];return typeof a=="string"?r=a:t===1?r=a.one:r=a.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function RE(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const Mse={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Pse={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Fse={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Lse={date:RE({formats:Mse,defaultWidth:"full"}),time:RE({formats:Pse,defaultWidth:"full"}),dateTime:RE({formats:Fse,defaultWidth:"full"})},$se={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Bse=(e,t,n,r)=>$se[e];function Lm(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):s;a=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;a=e.values[o]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const zse={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Use={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},qse={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Hse={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Vse={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Gse={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Wse=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Kse={ordinalNumber:Wse,era:Lm({values:zse,defaultWidth:"wide"}),quarter:Lm({values:Use,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Lm({values:qse,defaultWidth:"wide"}),day:Lm({values:Hse,defaultWidth:"wide"}),dayPeriod:Lm({values:Vse,defaultWidth:"wide",formattingValues:Gse,defaultFormattingWidth:"wide"})};function $m(e){return(t,n={})=>{const r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?Yse(o,h=>h.test(s)):Zse(o,h=>h.test(s));let u;u=e.valueCallback?e.valueCallback(l):l,u=n.valueCallback?n.valueCallback(u):u;const d=t.slice(s.length);return{value:u,rest:d}}}function Zse(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function Yse(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Xse(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const a=r[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=n.valueCallback?n.valueCallback(s):s;const o=t.slice(a.length);return{value:s,rest:o}}}const Jse=/^(\d+)(th|st|nd|rd)?/i,Qse=/\d+/i,eoe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},toe={any:[/^b/i,/^(a|c)/i]},noe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},roe={any:[/1/i,/2/i,/3/i,/4/i]},aoe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ioe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},soe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ooe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},loe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},coe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},uoe={ordinalNumber:Xse({matchPattern:Jse,parsePattern:Qse,valueCallback:e=>parseInt(e,10)}),era:$m({matchPatterns:eoe,defaultMatchWidth:"wide",parsePatterns:toe,defaultParseWidth:"any"}),quarter:$m({matchPatterns:noe,defaultMatchWidth:"wide",parsePatterns:roe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:$m({matchPatterns:aoe,defaultMatchWidth:"wide",parsePatterns:ioe,defaultParseWidth:"any"}),day:$m({matchPatterns:soe,defaultMatchWidth:"wide",parsePatterns:ooe,defaultParseWidth:"any"}),dayPeriod:$m({matchPatterns:loe,defaultMatchWidth:"any",parsePatterns:coe,defaultParseWidth:"any"})},X5={code:"en-US",formatDistance:Dse,formatLong:Lse,formatRelative:Bse,localize:Kse,match:uoe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function doe(e,t){const n=Ua(e,t==null?void 0:t.in);return vse(n,jse(n))+1}function foe(e,t){const n=Ua(e,t==null?void 0:t.in),r=+iw(n)-+wse(n);return Math.round(r/Z5)+1}function J5(e,t){var d,h,p,y;const n=Ua(e,t==null?void 0:t.in),r=n.getFullYear(),a=U0(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((y=(p=a.locale)==null?void 0:p.options)==null?void 0:y.firstWeekContainsDate)??1,s=Zl((t==null?void 0:t.in)||e,0);s.setFullYear(r+1,0,i),s.setHours(0,0,0,0);const o=Lg(s,t),l=Zl((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const u=Lg(l,t);return+n>=+o?r+1:+n>=+u?r:r-1}function hoe(e,t){var o,l,u,d;const n=U0(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=J5(e,t),i=Zl((t==null?void 0:t.in)||e,0);return i.setFullYear(a,0,r),i.setHours(0,0,0,0),Lg(i,t)}function poe(e,t){const n=Ua(e,t==null?void 0:t.in),r=+Lg(n,t)-+hoe(n,t);return Math.round(r/Z5)+1}function br(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const zc={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return br(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):br(n+1,2)},d(e,t){return br(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return br(e.getHours()%12||12,t.length)},H(e,t){return br(e.getHours(),t.length)},m(e,t){return br(e.getMinutes(),t.length)},s(e,t){return br(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return br(a,t.length)}},rh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},N4={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return zc.y(e,t)},Y:function(e,t,n,r){const a=J5(e,r),i=a>0?a:1-a;if(t==="YY"){const s=i%100;return br(s,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):br(i,t.length)},R:function(e,t){const n=Y5(e);return br(n,t.length)},u:function(e,t){const n=e.getFullYear();return br(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return br(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return br(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return zc.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return br(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const a=poe(e,r);return t==="wo"?n.ordinalNumber(a,{unit:"week"}):br(a,t.length)},I:function(e,t,n){const r=foe(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):br(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):zc.d(e,t)},D:function(e,t,n){const r=doe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):br(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const a=e.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return br(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const a=e.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return br(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),a=r===0?7:r;switch(t){case"i":return String(a);case"ii":return br(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let a;switch(r===12?a=rh.noon:r===0?a=rh.midnight:a=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let a;switch(r>=17?a=rh.evening:r>=12?a=rh.afternoon:r>=4?a=rh.morning:a=rh.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return zc.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):zc.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):br(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):br(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):zc.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):zc.s(e,t)},S:function(e,t){return zc.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return I4(r);case"XXXX":case"XX":return gd(r);case"XXXXX":case"XXX":default:return gd(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return I4(r);case"xxxx":case"xx":return gd(r);case"xxxxx":case"xxx":default:return gd(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+R4(r,":");case"OOOO":default:return"GMT"+gd(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+R4(r,":");case"zzzz":default:return"GMT"+gd(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return br(r,t.length)},T:function(e,t,n){return br(+e,t.length)}};function R4(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),i=r%60;return i===0?n+String(a):n+String(a)+t+br(i,2)}function I4(e,t){return e%60===0?(e>0?"-":"+")+br(Math.abs(e)/60,2):gd(e,t)}function gd(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),a=br(Math.trunc(r/60),2),i=br(r%60,2);return n+a+t+i}const j4=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Q5=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},moe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return j4(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",j4(r,t)).replace("{{time}}",Q5(a,t))},goe={p:Q5,P:moe},yoe=/^D+$/,boe=/^Y+$/,voe=["D","DD","YY","YYYY"];function woe(e){return yoe.test(e)}function xoe(e){return boe.test(e)}function _oe(e,t,n){const r=Soe(e,t,n);if(console.warn(r),voe.includes(e))throw new RangeError(r)}function Soe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Eoe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Coe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,koe=/^'([^]*?)'?$/,Toe=/''/g,Aoe=/[a-zA-Z]/;function iC(e,t,n){var d,h,p,y;const r=U0(),a=r.locale??X5,i=r.firstWeekContainsDate??((h=(d=r.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,s=r.weekStartsOn??((y=(p=r.locale)==null?void 0:p.options)==null?void 0:y.weekStartsOn)??0,o=Ua(e,n==null?void 0:n.in);if(!Sse(o))throw new RangeError("Invalid time value");let l=t.match(Coe).map(v=>{const b=v[0];if(b==="p"||b==="P"){const w=goe[b];return w(v,a.formatLong)}return v}).join("").match(Eoe).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const b=v[0];if(b==="'")return{isToken:!1,value:Noe(v)};if(N4[b])return{isToken:!0,value:v};if(b.match(Aoe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:v}});a.localize.preprocessor&&(l=a.localize.preprocessor(o,l));const u={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return l.map(v=>{if(!v.isToken)return v.value;const b=v.value;(xoe(b)||woe(b))&&_oe(b,t,String(e));const w=N4[b[0]];return w(o,b,a.localize,u)}).join("")}function Noe(e){const t=e.match(koe);return t?t[1].replace(Toe,"'"):e}function Roe(e,t,n){const r=U0(),a=(n==null?void 0:n.locale)??r.locale??X5,i=2520,s=sv(e,t);if(isNaN(s))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:s}),[l,u]=wx(n==null?void 0:n.in,...s>0?[t,e]:[e,t]),d=Ise(u,l),h=(sw(u)-sw(l))/1e3,p=Math.round((d-h)/60);let y;if(p<2)return n!=null&&n.includeSeconds?d<5?a.formatDistance("lessThanXSeconds",5,o):d<10?a.formatDistance("lessThanXSeconds",10,o):d<20?a.formatDistance("lessThanXSeconds",20,o):d<40?a.formatDistance("halfAMinute",0,o):d<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):p===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",p,o);if(p<45)return a.formatDistance("xMinutes",p,o);if(p<90)return a.formatDistance("aboutXHours",1,o);if(p<k4){const v=Math.round(p/60);return a.formatDistance("aboutXHours",v,o)}else{if(p<i)return a.formatDistance("xDays",1,o);if(p<Lb){const v=Math.round(p/k4);return a.formatDistance("xDays",v,o)}else if(p<Lb*2)return y=Math.round(p/Lb),a.formatDistance("aboutXMonths",y,o)}if(y=Rse(u,l),y<12){const v=Math.round(p/Lb);return a.formatDistance("xMonths",v,o)}else{const v=y%12,b=Math.trunc(y/12);return v<3?a.formatDistance("aboutXYears",b,o):v<9?a.formatDistance("overXYears",b,o):a.formatDistance("almostXYears",b+1,o)}}function eF(e,t){return Roe(e,xse(e),t)}const rr=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:a,disabled:i,variant:s="ghost",size:o="icon",className:l,"aria-label":u,...d})=>{const h=typeof t=="function";return m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:s,size:o,onClick:a,disabled:i,className:Nt("h-6 w-6",l),"aria-label":u,...d,children:h?m.jsx(t,{className:Nt("h-3.5 w-3.5",n)}):t})}),m.jsx(Jn,{side:r,children:m.jsx("p",{children:e})})]})})},uT=gt.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0})=>{var v,b,w;const a=qr(x=>x.foldUserMessagesOnCompletion),[i,s]=T.useState(r&&a),[o,l]=T.useState(!1);T.useEffect(()=>{r&&a&&s(!0)},[r,a]);const u=t?eF(new Date(t),{addSuffix:!0}):"Sending...",d=((v=e.metadata)==null?void 0:v.attachedFiles)&&e.metadata.attachedFiles.length>0,h=e.content&&e.content.trim().length>0,p=T.useCallback(()=>s(x=>!x),[]),y=T.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),l(!0),tt.success("User prompt copied!"),setTimeout(()=>l(!1),1500)}catch(x){tt.error("Failed to copy prompt."),console.error("Clipboard copy failed:",x)}},[e.content]);return m.jsxs("div",{className:Nt("user-prompt relative group/user",n),children:[m.jsxs("div",{className:"flex justify-between items-center mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t",children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(DH,{className:"h-4 w-4 text-primary flex-shrink-0"}),m.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),m.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[h&&m.jsx(rr,{tooltipText:"Copy Prompt",onClick:y,"aria-label":"Copy user prompt",icon:o?m.jsx(so,{className:"text-green-500"}):m.jsx(zC,{}),className:"h-5 w-5"}),(h||d)&&m.jsx(rr,{tooltipText:i?"Unfold":"Fold",onClick:p,"aria-label":i?"Unfold prompt":"Fold prompt",icon:i?m.jsx(Yo,{}):m.jsx(qd,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),m.jsx("div",{className:"flex items-center flex-shrink-0",children:m.jsx("span",{className:"text-xs text-muted-foreground",children:u})})]}),!i&&m.jsxs(m.Fragment,{children:[d&&m.jsx("div",{className:"mb-2 space-y-1",children:(b=e.metadata.attachedFiles)==null?void 0:b.map(x=>m.jsx(K5,{fileMeta:x,isReadOnly:!0},x.id))}),h&&m.jsx("p",{className:"whitespace-pre-wrap text-sm text-foreground",children:e.content})]}),i&&m.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:p,children:[h?`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`:"",h&&d?" + ":"",d?`${(w=e.metadata.attachedFiles)==null?void 0:w.length} file(s)`:""]})]})});uT.displayName="UserPromptDisplay";const O4=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,Ioe=({displayModelName:e,timeAgo:t,responseContent:n,isFolded:r,toggleFold:a,canFold:i,promptTokens:s,completionTokens:o,timeToFirstToken:l,generationTime:u})=>{const[d,h]=T.useState(!1),p=T.useCallback(async()=>{if(!n||typeof n!="string"){tt.info("No text response to copy.");return}try{await navigator.clipboard.writeText(n),h(!0),tt.success("Assistant response copied!"),setTimeout(()=>h(!1),1500)}catch(v){tt.error("Failed to copy response."),console.error("Clipboard copy failed:",v)}},[n]),y=s!==void 0&&o!==void 0?s+o:void 0;return m.jsxs("div",{className:"flex justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t",children:[m.jsxs("div",{className:"flex items-start gap-1 min-w-0",children:[m.jsx(QU,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),m.jsxs("div",{className:"flex flex-col min-w-0",children:[m.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",e,")"]}),m.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[y!==void 0&&m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsxs(Xn,{className:"flex items-center gap-0.5 cursor-default",children:[m.jsx(bq,{className:"h-3 w-3"}),m.jsx("span",{children:y.toLocaleString()})]}),m.jsxs(Jn,{side:"bottom",children:["Tokens: ",s??"?"," (Prompt) +"," ",o??"?"," (Completion) = ",y]})]})}),l!==void 0&&m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsxs(Xn,{className:"flex items-center gap-0.5 cursor-default",children:[m.jsx(UH,{className:"h-3 w-3"}),m.jsx("span",{children:O4(l)})]}),m.jsx(Jn,{side:"bottom",children:"Time to First Token"})]})}),u!==void 0&&m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsxs(Xn,{className:"flex items-center gap-0.5 cursor-default",children:[m.jsx(dq,{className:"h-3 w-3"}),m.jsx("span",{children:O4(u)})]}),m.jsx(Jn,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),m.jsxs("div",{className:"flex items-start flex-shrink-0 gap-1",children:[m.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:t}),m.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:[n&&typeof n=="string"&&m.jsx(rr,{tooltipText:"Copy Response",onClick:p,"aria-label":"Copy assistant response",icon:d?m.jsx(so,{className:"text-green-500"}):m.jsx(zC,{}),className:"h-5 w-5"}),i&&m.jsx(rr,{tooltipText:r?"Unfold":"Fold",onClick:a,"aria-label":r?"Unfold response":"Fold response",icon:r?m.jsx(Yo,{}):m.jsx(qd,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]})]})},joe=({interactionId:e,onRegenerate:t,onDelete:n,onEdit:r})=>{const a=()=>{n&&window.confirm("Are you sure you want to delete this interaction?")&&n(e)},i=()=>{t&&t(e)},s=()=>{r&&r(e)};return m.jsxs("div",{className:`absolute bottom-2 right-2 flex items-center space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200
                 bg-card/80 backdrop-blur-sm p-1 rounded-md shadow-md z-20`,children:[r&&m.jsx(rr,{tooltipText:"Edit",onClick:s,"aria-label":"Edit User Prompt",icon:m.jsx(Jb,{}),className:"h-6 w-6"}),t&&m.jsx(rr,{tooltipText:"Regenerate",onClick:i,"aria-label":"Regenerate Response",icon:m.jsx(Tw,{}),className:"h-6 w-6"}),n&&m.jsx(rr,{tooltipText:"Delete",onClick:a,"aria-label":"Delete Interaction",icon:m.jsx(ts,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})},D4={};function Ooe(e){let t=D4[e];if(t)return t;t=D4[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function Wh(e,t){typeof t!="string"&&(t=Wh.defaultChars);const n=Ooe(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let a="";for(let i=0,s=r.length;i<s;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){a+=n[o];continue}if((o&224)===192&&i+3<s){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const u=o<<6&1984|l&63;u<128?a+="":a+=String.fromCharCode(u),i+=3;continue}}if((o&240)===224&&i+6<s){const l=parseInt(r.slice(i+4,i+6),16),u=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(u&192)===128){const d=o<<12&61440|l<<6&4032|u&63;d<2048||d>=55296&&d<=57343?a+="":a+=String.fromCharCode(d),i+=6;continue}}if((o&248)===240&&i+9<s){const l=parseInt(r.slice(i+4,i+6),16),u=parseInt(r.slice(i+7,i+9),16),d=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(u&192)===128&&(d&192)===128){let h=o<<18&1835008|l<<12&258048|u<<6&4032|d&63;h<65536||h>1114111?a+="":(h-=65536,a+=String.fromCharCode(55296+(h>>10),56320+(h&1023))),i+=9;continue}}a+=""}return a})}Wh.defaultChars=";/?:@&=+$,#";Wh.componentChars="";const M4={};function Doe(e){let t=M4[e];if(t)return t;t=M4[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function q0(e,t,n){typeof t!="string"&&(n=t,t=q0.defaultChars),typeof n>"u"&&(n=!0);const r=Doe(t);let a="";for(let i=0,s=e.length;i<s;i++){const o=e.charCodeAt(i);if(n&&o===37&&i+2<s&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3))){a+=e.slice(i,i+3),i+=2;continue}if(o<128){a+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<s){const l=e.charCodeAt(i+1);if(l>=56320&&l<=57343){a+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}a+="%EF%BF%BD";continue}a+=encodeURIComponent(e[i])}return a}q0.defaultChars=";/?:@&=+$,-_.!~*'()#";q0.componentChars="-_.!~*'()";function dT(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function ow(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const Moe=/^([a-z0-9.+-]+:)/i,Poe=/:[0-9]*$/,Foe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Loe=["<",">",'"',"`"," ","\r",`
`,"	"],$oe=["{","}","|","\\","^","`"].concat(Loe),Boe=["'"].concat($oe),P4=["%","/","?",";","#"].concat(Boe),F4=["/","?","#"],zoe=255,L4=/^[+a-z0-9A-Z_-]{0,63}$/,Uoe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,$4={javascript:!0,"javascript:":!0},B4={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function fT(e,t){if(e&&e instanceof ow)return e;const n=new ow;return n.parse(e,t),n}ow.prototype.parse=function(e,t){let n,r,a,i=e;if(i=i.trim(),!t&&e.split("#").length===1){const u=Foe.exec(i);if(u)return this.pathname=u[1],u[2]&&(this.search=u[2]),this}let s=Moe.exec(i);if(s&&(s=s[0],n=s.toLowerCase(),this.protocol=s,i=i.substr(s.length)),(t||s||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(a=i.substr(0,2)==="//",a&&!(s&&$4[s])&&(i=i.substr(2),this.slashes=!0)),!$4[s]&&(a||s&&!B4[s])){let u=-1;for(let v=0;v<F4.length;v++)r=i.indexOf(F4[v]),r!==-1&&(u===-1||r<u)&&(u=r);let d,h;u===-1?h=i.lastIndexOf("@"):h=i.lastIndexOf("@",u),h!==-1&&(d=i.slice(0,h),i=i.slice(h+1),this.auth=d),u=-1;for(let v=0;v<P4.length;v++)r=i.indexOf(P4[v]),r!==-1&&(u===-1||r<u)&&(u=r);u===-1&&(u=i.length),i[u-1]===":"&&u--;const p=i.slice(0,u);i=i.slice(u),this.parseHost(p),this.hostname=this.hostname||"";const y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y){const v=this.hostname.split(/\./);for(let b=0,w=v.length;b<w;b++){const x=v[b];if(x&&!x.match(L4)){let S="";for(let E=0,C=x.length;E<C;E++)x.charCodeAt(E)>127?S+="x":S+=x[E];if(!S.match(L4)){const E=v.slice(0,b),C=v.slice(b+1),k=x.match(Uoe);k&&(E.push(k[1]),C.unshift(k[2])),C.length&&(i=C.join(".")+i),this.hostname=E.join(".");break}}}}this.hostname.length>zoe&&(this.hostname=""),y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),B4[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};ow.prototype.parseHost=function(e){let t=Poe.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const qoe=Object.freeze(Object.defineProperty({__proto__:null,decode:Wh,encode:q0,format:dT,parse:fT},Symbol.toStringTag,{value:"Module"})),tF=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,nF=/[\0-\x1F\x7F-\x9F]/,Hoe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,hT=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,rF=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,aF=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Voe=Object.freeze(Object.defineProperty({__proto__:null,Any:tF,Cc:nF,Cf:Hoe,P:hT,S:rF,Z:aF},Symbol.toStringTag,{value:"Module"})),Goe=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),Woe=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var IE;const Koe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Zoe=(IE=String.fromCodePoint)!==null&&IE!==void 0?IE:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function Yoe(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=Koe.get(e))!==null&&t!==void 0?t:e}var La;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(La||(La={}));const Xoe=32;var Yc;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(Yc||(Yc={}));function sC(e){return e>=La.ZERO&&e<=La.NINE}function Joe(e){return e>=La.UPPER_A&&e<=La.UPPER_F||e>=La.LOWER_A&&e<=La.LOWER_F}function Qoe(e){return e>=La.UPPER_A&&e<=La.UPPER_Z||e>=La.LOWER_A&&e<=La.LOWER_Z||sC(e)}function ele(e){return e===La.EQUALS||Qoe(e)}var Da;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(Da||(Da={}));var Vc;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(Vc||(Vc={}));class tle{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=Da.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Vc.Strict}startEntity(t){this.decodeMode=t,this.state=Da.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case Da.EntityStart:return t.charCodeAt(n)===La.NUM?(this.state=Da.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=Da.NamedEntity,this.stateNamedEntity(t,n));case Da.NumericStart:return this.stateNumericStart(t,n);case Da.NumericDecimal:return this.stateNumericDecimal(t,n);case Da.NumericHex:return this.stateNumericHex(t,n);case Da.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|Xoe)===La.LOWER_X?(this.state=Da.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=Da.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,a){if(n!==r){const i=r-n;this.result=this.result*Math.pow(a,i)+parseInt(t.substr(n,i),a),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const a=t.charCodeAt(n);if(sC(a)||Joe(a))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(a,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const a=t.charCodeAt(n);if(sC(a))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(a,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===La.SEMI)this.consumed+=1;else if(this.decodeMode===Vc.Strict)return 0;return this.emitCodePoint(Yoe(this.result),this.consumed),this.errors&&(t!==La.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let a=r[this.treeIndex],i=(a&Yc.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const s=t.charCodeAt(n);if(this.treeIndex=nle(r,a,this.treeIndex+Math.max(1,i),s),this.treeIndex<0)return this.result===0||this.decodeMode===Vc.Attribute&&(i===0||ele(s))?0:this.emitNotTerminatedNamedEntity();if(a=r[this.treeIndex],i=(a&Yc.VALUE_LENGTH)>>14,i!==0){if(s===La.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==Vc.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,a=(r[n]&Yc.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,a,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:a}=this;return this.emitCodePoint(n===1?a[t]&~Yc.VALUE_LENGTH:a[t+1],r),n===3&&this.emitCodePoint(a[t+2],r),r}end(){var t;switch(this.state){case Da.NamedEntity:return this.result!==0&&(this.decodeMode!==Vc.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Da.NumericDecimal:return this.emitNumericEntity(0,2);case Da.NumericHex:return this.emitNumericEntity(0,3);case Da.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Da.EntityStart:return 0}}}function iF(e){let t="";const n=new tle(e,r=>t+=Zoe(r));return function(a,i){let s=0,o=0;for(;(o=a.indexOf("&",o))>=0;){t+=a.slice(s,o),n.startEntity(i);const u=n.write(a,o+1);if(u<0){s=o+n.end();break}s=o+u,o=u===0?s+1:s}const l=t+a.slice(s);return t="",l}}function nle(e,t,n,r){const a=(t&Yc.BRANCH_LENGTH)>>7,i=t&Yc.JUMP_TABLE;if(a===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=a?-1:e[n+l]-1}let s=n,o=s+a-1;for(;s<=o;){const l=s+o>>>1,u=e[l];if(u<r)s=l+1;else if(u>r)o=l-1;else return e[l+a]}return-1}const rle=iF(Goe);iF(Woe);function sF(e,t=Vc.Legacy){return rle(e,t)}function ale(e){return Object.prototype.toString.call(e)}function pT(e){return ale(e)==="[object String]"}const ile=Object.prototype.hasOwnProperty;function sle(e,t){return ile.call(e,t)}function xx(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function oF(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function mT(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function lw(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const lF=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,ole=/&([a-z#][a-z0-9]{1,31});/gi,lle=new RegExp(lF.source+"|"+ole.source,"gi"),cle=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function ule(e,t){if(t.charCodeAt(0)===35&&cle.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return mT(r)?lw(r):e}const n=sF(e);return n!==e?n:e}function dle(e){return e.indexOf("\\")<0?e:e.replace(lF,"$1")}function Kh(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(lle,function(t,n,r){return n||ule(t,r)})}const fle=/[&<>"]/,hle=/[&<>"]/g,ple={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function mle(e){return ple[e]}function bu(e){return fle.test(e)?e.replace(hle,mle):e}const gle=/[.?*+^$[\]\\(){}|-]/g;function yle(e){return e.replace(gle,"\\$&")}function Fr(e){switch(e){case 9:case 32:return!0}return!1}function $g(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Bg(e){return hT.test(e)||rF.test(e)}function zg(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function _x(e){return e=e.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(e=e.replace(//g,"")),e.toLowerCase().toUpperCase()}const ble={mdurl:qoe,ucmicro:Voe},vle=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:oF,assign:xx,escapeHtml:bu,escapeRE:yle,fromCodePoint:lw,has:sle,isMdAsciiPunct:zg,isPunctChar:Bg,isSpace:Fr,isString:pT,isValidEntityCode:mT,isWhiteSpace:$g,lib:ble,normalizeReference:_x,unescapeAll:Kh,unescapeMd:dle},Symbol.toStringTag,{value:"Module"}));function wle(e,t,n){let r,a,i,s;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(i=e.src.charCodeAt(e.pos),i===93&&(r--,r===0)){a=!0;break}if(s=e.pos,e.md.inline.skipToken(e),i===91){if(s===e.pos-1)r++;else if(n)return e.pos=l,-1}}let u=-1;return a&&(u=e.pos),e.pos=l,u}function xle(e,t,n){let r,a=t;const i={ok:!1,pos:0,str:""};if(e.charCodeAt(a)===60){for(a++;a<n;){if(r=e.charCodeAt(a),r===10||r===60)return i;if(r===62)return i.pos=a+1,i.str=Kh(e.slice(t+1,a)),i.ok=!0,i;if(r===92&&a+1<n){a+=2;continue}a++}return i}let s=0;for(;a<n&&(r=e.charCodeAt(a),!(r===32||r<32||r===127));){if(r===92&&a+1<n){if(e.charCodeAt(a+1)===32)break;a+=2;continue}if(r===40&&(s++,s>32))return i;if(r===41){if(s===0)break;s--}a++}return t===a||s!==0||(i.str=Kh(e.slice(t,a)),i.pos=a,i.ok=!0),i}function _le(e,t,n,r){let a,i=t;const s={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)s.str=r.str,s.marker=r.marker;else{if(i>=n)return s;let o=e.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return s;t++,i++,o===40&&(o=41),s.marker=o}for(;i<n;){if(a=e.charCodeAt(i),a===s.marker)return s.pos=i+1,s.str+=Kh(e.slice(t,i)),s.ok=!0,s;if(a===40&&s.marker===41)return s;a===92&&i+1<n&&i++,i++}return s.can_continue=!0,s.str+=Kh(e.slice(t,i)),s}const Sle=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:xle,parseLinkLabel:wle,parseLinkTitle:_le},Symbol.toStringTag,{value:"Module"})),Jo={};Jo.code_inline=function(e,t,n,r,a){const i=e[t];return"<code"+a.renderAttrs(i)+">"+bu(i.content)+"</code>"};Jo.code_block=function(e,t,n,r,a){const i=e[t];return"<pre"+a.renderAttrs(i)+"><code>"+bu(e[t].content)+`</code></pre>
`};Jo.fence=function(e,t,n,r,a){const i=e[t],s=i.info?Kh(i.info).trim():"";let o="",l="";if(s){const d=s.split(/(\s+)/g);o=d[0],l=d.slice(2).join("")}let u;if(n.highlight?u=n.highlight(i.content,o,l)||bu(i.content):u=bu(i.content),u.indexOf("<pre")===0)return u+`
`;if(s){const d=i.attrIndex("class"),h=i.attrs?i.attrs.slice():[];d<0?h.push(["class",n.langPrefix+o]):(h[d]=h[d].slice(),h[d][1]+=" "+n.langPrefix+o);const p={attrs:h};return`<pre><code${a.renderAttrs(p)}>${u}</code></pre>
`}return`<pre><code${a.renderAttrs(i)}>${u}</code></pre>
`};Jo.image=function(e,t,n,r,a){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=a.renderInlineAsText(i.children,n,r),a.renderToken(e,t,n)};Jo.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};Jo.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Jo.text=function(e,t){return bu(e[t].content)};Jo.html_block=function(e,t){return e[t].content};Jo.html_inline=function(e,t){return e[t].content};function yp(){this.rules=xx({},Jo)}yp.prototype.renderAttrs=function(t){let n,r,a;if(!t.attrs)return"";for(a="",n=0,r=t.attrs.length;n<r;n++)a+=" "+bu(t.attrs[n][0])+'="'+bu(t.attrs[n][1])+'"';return a};yp.prototype.renderToken=function(t,n,r){const a=t[n];let i="";if(a.hidden)return"";a.block&&a.nesting!==-1&&n&&t[n-1].hidden&&(i+=`
`),i+=(a.nesting===-1?"</":"<")+a.tag,i+=this.renderAttrs(a),a.nesting===0&&r.xhtmlOut&&(i+=" /");let s=!1;if(a.block&&(s=!0,a.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===a.tag)&&(s=!1)}return i+=s?`>
`:">",i};yp.prototype.renderInline=function(e,t,n){let r="";const a=this.rules;for(let i=0,s=e.length;i<s;i++){const o=e[i].type;typeof a[o]<"u"?r+=a[o](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r};yp.prototype.renderInlineAsText=function(e,t,n){let r="";for(let a=0,i=e.length;a<i;a++)switch(e[a].type){case"text":r+=e[a].content;break;case"image":r+=this.renderInlineAsText(e[a].children,t,n);break;case"html_inline":case"html_block":r+=e[a].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};yp.prototype.render=function(e,t,n){let r="";const a=this.rules;for(let i=0,s=e.length;i<s;i++){const o=e[i].type;o==="inline"?r+=this.renderInline(e[i].children,t,n):typeof a[o]<"u"?r+=a[o](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r};function Li(){this.__rules__=[],this.__cache__=null}Li.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};Li.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};Li.prototype.at=function(e,t,n){const r=this.__find__(e),a=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=a.alt||[],this.__cache__=null};Li.prototype.before=function(e,t,n,r){const a=this.__find__(e),i=r||{};if(a===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(a,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Li.prototype.after=function(e,t,n,r){const a=this.__find__(e),i=r||{};if(a===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(a+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Li.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};Li.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const a=this.__find__(r);if(a<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[a].enabled=!0,n.push(r)},this),this.__cache__=null,n};Li.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};Li.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const a=this.__find__(r);if(a<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[a].enabled=!1,n.push(r)},this),this.__cache__=null,n};Li.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function uo(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}uo.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,a=n.length;r<a;r++)if(n[r][0]===t)return r;return-1};uo.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};uo.prototype.attrSet=function(t,n){const r=this.attrIndex(t),a=[t,n];r<0?this.attrPush(a):this.attrs[r]=a};uo.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};uo.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function cF(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}cF.prototype.Token=uo;const Ele=/\r\n?|\n/g,Cle=/\0/g;function kle(e){let t;t=e.src.replace(Ele,`
`),t=t.replace(Cle,""),e.src=t}function Tle(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function Ale(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const a=t[n];a.type==="inline"&&e.md.inline.parse(a.content,e.md,e.env,a.children)}}function Nle(e){return/^<a[>\s]/i.test(e)}function Rle(e){return/^<\/a\s*>/i.test(e)}function Ile(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let a=t[n].children,i=0;for(let s=a.length-1;s>=0;s--){const o=a[s];if(o.type==="link_close"){for(s--;a[s].level!==o.level&&a[s].type!=="link_open";)s--;continue}if(o.type==="html_inline"&&(Nle(o.content)&&i>0&&i--,Rle(o.content)&&i++),!(i>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let u=e.md.linkify.match(l);const d=[];let h=o.level,p=0;u.length>0&&u[0].index===0&&s>0&&a[s-1].type==="text_special"&&(u=u.slice(1));for(let y=0;y<u.length;y++){const v=u[y].url,b=e.md.normalizeLink(v);if(!e.md.validateLink(b))continue;let w=u[y].text;u[y].schema?u[y].schema==="mailto:"&&!/^mailto:/i.test(w)?w=e.md.normalizeLinkText("mailto:"+w).replace(/^mailto:/,""):w=e.md.normalizeLinkText(w):w=e.md.normalizeLinkText("http://"+w).replace(/^http:\/\//,"");const x=u[y].index;if(x>p){const k=new e.Token("text","",0);k.content=l.slice(p,x),k.level=h,d.push(k)}const S=new e.Token("link_open","a",1);S.attrs=[["href",b]],S.level=h++,S.markup="linkify",S.info="auto",d.push(S);const E=new e.Token("text","",0);E.content=w,E.level=h,d.push(E);const C=new e.Token("link_close","a",-1);C.level=--h,C.markup="linkify",C.info="auto",d.push(C),p=u[y].lastIndex}if(p<l.length){const y=new e.Token("text","",0);y.content=l.slice(p),y.level=h,d.push(y)}t[n].children=a=oF(a,s,d)}}}}const uF=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,jle=/\((c|tm|r)\)/i,Ole=/\((c|tm|r)\)/ig,Dle={c:"",r:"",tm:""};function Mle(e,t){return Dle[t.toLowerCase()]}function Ple(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(Ole,Mle)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function Fle(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&uF.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function Lle(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(jle.test(e.tokens[t].content)&&Ple(e.tokens[t].children),uF.test(e.tokens[t].content)&&Fle(e.tokens[t].children))}const $le=/['"]/,z4=/['"]/g,U4="";function $b(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function Ble(e,t){let n;const r=[];for(let a=0;a<e.length;a++){const i=e[a],s=e[a].level;for(n=r.length-1;n>=0&&!(r[n].level<=s);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,u=o.length;e:for(;l<u;){z4.lastIndex=l;const d=z4.exec(o);if(!d)break;let h=!0,p=!0;l=d.index+1;const y=d[0]==="'";let v=32;if(d.index-1>=0)v=o.charCodeAt(d.index-1);else for(n=a-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){v=e[n].content.charCodeAt(e[n].content.length-1);break}let b=32;if(l<u)b=o.charCodeAt(l);else for(n=a+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){b=e[n].content.charCodeAt(0);break}const w=zg(v)||Bg(String.fromCharCode(v)),x=zg(b)||Bg(String.fromCharCode(b)),S=$g(v),E=$g(b);if(E?h=!1:x&&(S||w||(h=!1)),S?p=!1:w&&(E||x||(p=!1)),b===34&&d[0]==='"'&&v>=48&&v<=57&&(p=h=!1),h&&p&&(h=w,p=x),!h&&!p){y&&(i.content=$b(i.content,d.index,U4));continue}if(p)for(n=r.length-1;n>=0;n--){let C=r[n];if(r[n].level<s)break;if(C.single===y&&r[n].level===s){C=r[n];let k,R;y?(k=t.md.options.quotes[2],R=t.md.options.quotes[3]):(k=t.md.options.quotes[0],R=t.md.options.quotes[1]),i.content=$b(i.content,d.index,R),e[C.token].content=$b(e[C.token].content,C.pos,k),l+=R.length-1,C.token===a&&(l+=k.length-1),o=i.content,u=o.length,r.length=n;continue e}}h?r.push({token:a,pos:d.index,single:y,level:s}):p&&y&&(i.content=$b(i.content,d.index,U4))}}}function zle(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!$le.test(e.tokens[t].content)||Ble(e.tokens[t].children,e)}function Ule(e){let t,n;const r=e.tokens,a=r.length;for(let i=0;i<a;i++){if(r[i].type!=="inline")continue;const s=r[i].children,o=s.length;for(t=0;t<o;t++)s[t].type==="text_special"&&(s[t].type="text");for(t=n=0;t<o;t++)s[t].type==="text"&&t+1<o&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}}const jE=[["normalize",kle],["block",Tle],["inline",Ale],["linkify",Ile],["replacements",Lle],["smartquotes",zle],["text_join",Ule]];function gT(){this.ruler=new Li;for(let e=0;e<jE.length;e++)this.ruler.push(jE[e][0],jE[e][1])}gT.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};gT.prototype.State=cF;function Qo(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const a=this.src;for(let i=0,s=0,o=0,l=0,u=a.length,d=!1;s<u;s++){const h=a.charCodeAt(s);if(!d)if(Fr(h)){o++,h===9?l+=4-l%4:l++;continue}else d=!0;(h===10||s===u-1)&&(h!==10&&s++,this.bMarks.push(i),this.eMarks.push(s),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),d=!1,o=0,l=0,i=s+1)}this.bMarks.push(a.length),this.eMarks.push(a.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Qo.prototype.push=function(e,t,n){const r=new uo(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};Qo.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};Qo.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};Qo.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Fr(r))break}return t};Qo.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Fr(this.src.charCodeAt(--t)))return t+1;return t};Qo.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};Qo.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};Qo.prototype.getLines=function(t,n,r,a){if(t>=n)return"";const i=new Array(n-t);for(let s=0,o=t;o<n;o++,s++){let l=0;const u=this.bMarks[o];let d=u,h;for(o+1<n||a?h=this.eMarks[o]+1:h=this.eMarks[o];d<h&&l<r;){const p=this.src.charCodeAt(d);if(Fr(p))p===9?l+=4-(l+this.bsCount[o])%4:l++;else if(d-u<this.tShift[o])l++;else break;d++}l>r?i[s]=new Array(l-r+1).join(" ")+this.src.slice(d,h):i[s]=this.src.slice(d,h)}return i.join("")};Qo.prototype.Token=uo;const qle=65536;function OE(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function q4(e){const t=[],n=e.length;let r=0,a=e.charCodeAt(r),i=!1,s=0,o="";for(;r<n;)a===124&&(i?(o+=e.substring(s,r-1),s=r):(t.push(o+e.substring(s,r)),o="",s=r+1)),i=a===92,r++,a=e.charCodeAt(r);return t.push(o+e.substring(s)),t}function Hle(e,t,n,r){if(t+2>n)return!1;let a=t+1;if(e.sCount[a]<e.blkIndent||e.sCount[a]-e.blkIndent>=4)return!1;let i=e.bMarks[a]+e.tShift[a];if(i>=e.eMarks[a])return!1;const s=e.src.charCodeAt(i++);if(s!==124&&s!==45&&s!==58||i>=e.eMarks[a])return!1;const o=e.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!Fr(o)||s===45&&Fr(o))return!1;for(;i<e.eMarks[a];){const C=e.src.charCodeAt(i);if(C!==124&&C!==45&&C!==58&&!Fr(C))return!1;i++}let l=OE(e,t+1),u=l.split("|");const d=[];for(let C=0;C<u.length;C++){const k=u[C].trim();if(!k){if(C===0||C===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(k))return!1;k.charCodeAt(k.length-1)===58?d.push(k.charCodeAt(0)===58?"center":"right"):k.charCodeAt(0)===58?d.push("left"):d.push("")}if(l=OE(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;u=q4(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop();const h=u.length;if(h===0||h!==d.length)return!1;if(r)return!0;const p=e.parentType;e.parentType="table";const y=e.md.block.ruler.getRules("blockquote"),v=e.push("table_open","table",1),b=[t,0];v.map=b;const w=e.push("thead_open","thead",1);w.map=[t,t+1];const x=e.push("tr_open","tr",1);x.map=[t,t+1];for(let C=0;C<u.length;C++){const k=e.push("th_open","th",1);d[C]&&(k.attrs=[["style","text-align:"+d[C]]]);const R=e.push("inline","",0);R.content=u[C].trim(),R.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let S,E=0;for(a=t+2;a<n&&!(e.sCount[a]<e.blkIndent);a++){let C=!1;for(let R=0,O=y.length;R<O;R++)if(y[R](e,a,n,!0)){C=!0;break}if(C||(l=OE(e,a).trim(),!l)||e.sCount[a]-e.blkIndent>=4||(u=q4(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop(),E+=h-u.length,E>qle))break;if(a===t+2){const R=e.push("tbody_open","tbody",1);R.map=S=[t+2,0]}const k=e.push("tr_open","tr",1);k.map=[a,a+1];for(let R=0;R<h;R++){const O=e.push("td_open","td",1);d[R]&&(O.attrs=[["style","text-align:"+d[R]]]);const j=e.push("inline","",0);j.content=u[R]?u[R].trim():"",j.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return S&&(e.push("tbody_close","tbody",-1),S[1]=a),e.push("table_close","table",-1),b[1]=a,e.parentType=p,e.line=a,!0}function Vle(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,a=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,a=r;continue}break}e.line=a;const i=e.push("code_block","code",0);return i.content=e.getLines(t,a,4+e.blkIndent,!1)+`
`,i.map=[t,e.line],!0}function Gle(e,t,n,r){let a=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||a+3>i)return!1;const s=e.src.charCodeAt(a);if(s!==126&&s!==96)return!1;let o=a;a=e.skipChars(a,s);let l=a-o;if(l<3)return!1;const u=e.src.slice(o,a),d=e.src.slice(a,i);if(s===96&&d.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;let h=t,p=!1;for(;h++,!(h>=n||(a=o=e.bMarks[h]+e.tShift[h],i=e.eMarks[h],a<i&&e.sCount[h]<e.blkIndent));)if(e.src.charCodeAt(a)===s&&!(e.sCount[h]-e.blkIndent>=4)&&(a=e.skipChars(a,s),!(a-o<l)&&(a=e.skipSpaces(a),!(a<i)))){p=!0;break}l=e.sCount[t],e.line=h+(p?1:0);const y=e.push("fence","code",0);return y.info=d,y.content=e.getLines(t+1,h,l,!0),y.markup=u,y.map=[t,e.line],!0}function Wle(e,t,n,r){let a=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const s=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(a)!==62)return!1;if(r)return!0;const o=[],l=[],u=[],d=[],h=e.md.block.ruler.getRules("blockquote"),p=e.parentType;e.parentType="blockquote";let y=!1,v;for(v=t;v<n;v++){const E=e.sCount[v]<e.blkIndent;if(a=e.bMarks[v]+e.tShift[v],i=e.eMarks[v],a>=i)break;if(e.src.charCodeAt(a++)===62&&!E){let k=e.sCount[v]+1,R,O;e.src.charCodeAt(a)===32?(a++,k++,O=!1,R=!0):e.src.charCodeAt(a)===9?(R=!0,(e.bsCount[v]+k)%4===3?(a++,k++,O=!1):O=!0):R=!1;let j=k;for(o.push(e.bMarks[v]),e.bMarks[v]=a;a<i;){const $=e.src.charCodeAt(a);if(Fr($))$===9?j+=4-(j+e.bsCount[v]+(O?1:0))%4:j++;else break;a++}y=a>=i,l.push(e.bsCount[v]),e.bsCount[v]=e.sCount[v]+1+(R?1:0),u.push(e.sCount[v]),e.sCount[v]=j-k,d.push(e.tShift[v]),e.tShift[v]=a-e.bMarks[v];continue}if(y)break;let C=!1;for(let k=0,R=h.length;k<R;k++)if(h[k](e,v,n,!0)){C=!0;break}if(C){e.lineMax=v,e.blkIndent!==0&&(o.push(e.bMarks[v]),l.push(e.bsCount[v]),d.push(e.tShift[v]),u.push(e.sCount[v]),e.sCount[v]-=e.blkIndent);break}o.push(e.bMarks[v]),l.push(e.bsCount[v]),d.push(e.tShift[v]),u.push(e.sCount[v]),e.sCount[v]=-1}const b=e.blkIndent;e.blkIndent=0;const w=e.push("blockquote_open","blockquote",1);w.markup=">";const x=[t,0];w.map=x,e.md.block.tokenize(e,t,v);const S=e.push("blockquote_close","blockquote",-1);S.markup=">",e.lineMax=s,e.parentType=p,x[1]=e.line;for(let E=0;E<d.length;E++)e.bMarks[E+t]=o[E],e.tShift[E+t]=d[E],e.sCount[E+t]=u[E],e.bsCount[E+t]=l[E];return e.blkIndent=b,!0}function Kle(e,t,n,r){const a=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(i++);if(s!==42&&s!==45&&s!==95)return!1;let o=1;for(;i<a;){const u=e.src.charCodeAt(i++);if(u!==s&&!Fr(u))return!1;u===s&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(s)),!0}function H4(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(r++);if(a!==42&&a!==45&&a!==43)return-1;if(r<n){const i=e.src.charCodeAt(r);if(!Fr(i))return-1}return r}function V4(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let a=n;if(a+1>=r)return-1;let i=e.src.charCodeAt(a++);if(i<48||i>57)return-1;for(;;){if(a>=r)return-1;if(i=e.src.charCodeAt(a++),i>=48&&i<=57){if(a-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return a<r&&(i=e.src.charCodeAt(a),!Fr(i))?-1:a}function Zle(e,t){const n=e.level+2;for(let r=t+2,a=e.tokens.length-2;r<a;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function Yle(e,t,n,r){let a,i,s,o,l=t,u=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let d=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(d=!0);let h,p,y;if((y=V4(e,l))>=0){if(h=!0,s=e.bMarks[l]+e.tShift[l],p=Number(e.src.slice(s,y-1)),d&&p!==1)return!1}else if((y=H4(e,l))>=0)h=!1;else return!1;if(d&&e.skipSpaces(y)>=e.eMarks[l])return!1;if(r)return!0;const v=e.src.charCodeAt(y-1),b=e.tokens.length;h?(o=e.push("ordered_list_open","ol",1),p!==1&&(o.attrs=[["start",p]])):o=e.push("bullet_list_open","ul",1);const w=[l,0];o.map=w,o.markup=String.fromCharCode(v);let x=!1;const S=e.md.block.ruler.getRules("list"),E=e.parentType;for(e.parentType="list";l<n;){i=y,a=e.eMarks[l];const C=e.sCount[l]+y-(e.bMarks[l]+e.tShift[l]);let k=C;for(;i<a;){const de=e.src.charCodeAt(i);if(de===9)k+=4-(k+e.bsCount[l])%4;else if(de===32)k++;else break;i++}const R=i;let O;R>=a?O=1:O=k-C,O>4&&(O=1);const j=C+O;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(v);const $=[l,0];o.map=$,h&&(o.info=e.src.slice(s,y-1));const L=e.tight,X=e.tShift[l],F=e.sCount[l],K=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=j,e.tight=!0,e.tShift[l]=R-e.bMarks[l],e.sCount[l]=k,R>=a&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||x)&&(u=!1),x=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=K,e.tShift[l]=X,e.sCount[l]=F,e.tight=L,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(v),l=e.line,$[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let q=!1;for(let de=0,re=S.length;de<re;de++)if(S[de](e,l,n,!0)){q=!0;break}if(q)break;if(h){if(y=V4(e,l),y<0)break;s=e.bMarks[l]+e.tShift[l]}else if(y=H4(e,l),y<0)break;if(v!==e.src.charCodeAt(y-1))break}return h?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(v),w[1]=l,e.line=l,e.parentType=E,u&&Zle(e,b),!0}function Xle(e,t,n,r){let a=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],s=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(a)!==91)return!1;function o(S){const E=e.lineMax;if(S>=E||e.isEmpty(S))return null;let C=!1;if(e.sCount[S]-e.blkIndent>3&&(C=!0),e.sCount[S]<0&&(C=!0),!C){const O=e.md.block.ruler.getRules("reference"),j=e.parentType;e.parentType="reference";let $=!1;for(let L=0,X=O.length;L<X;L++)if(O[L](e,S,E,!0)){$=!0;break}if(e.parentType=j,$)return null}const k=e.bMarks[S]+e.tShift[S],R=e.eMarks[S];return e.src.slice(k,R+1)}let l=e.src.slice(a,i+1);i=l.length;let u=-1;for(a=1;a<i;a++){const S=l.charCodeAt(a);if(S===91)return!1;if(S===93){u=a;break}else if(S===10){const E=o(s);E!==null&&(l+=E,i=l.length,s++)}else if(S===92&&(a++,a<i&&l.charCodeAt(a)===10)){const E=o(s);E!==null&&(l+=E,i=l.length,s++)}}if(u<0||l.charCodeAt(u+1)!==58)return!1;for(a=u+2;a<i;a++){const S=l.charCodeAt(a);if(S===10){const E=o(s);E!==null&&(l+=E,i=l.length,s++)}else if(!Fr(S))break}const d=e.md.helpers.parseLinkDestination(l,a,i);if(!d.ok)return!1;const h=e.md.normalizeLink(d.str);if(!e.md.validateLink(h))return!1;a=d.pos;const p=a,y=s,v=a;for(;a<i;a++){const S=l.charCodeAt(a);if(S===10){const E=o(s);E!==null&&(l+=E,i=l.length,s++)}else if(!Fr(S))break}let b=e.md.helpers.parseLinkTitle(l,a,i);for(;b.can_continue;){const S=o(s);if(S===null)break;l+=S,a=i,i=l.length,s++,b=e.md.helpers.parseLinkTitle(l,a,i,b)}let w;for(a<i&&v!==a&&b.ok?(w=b.str,a=b.pos):(w="",a=p,s=y);a<i;){const S=l.charCodeAt(a);if(!Fr(S))break;a++}if(a<i&&l.charCodeAt(a)!==10&&w)for(w="",a=p,s=y;a<i;){const S=l.charCodeAt(a);if(!Fr(S))break;a++}if(a<i&&l.charCodeAt(a)!==10)return!1;const x=_x(l.slice(1,u));return x?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[x]>"u"&&(e.env.references[x]={title:w,href:h}),e.line=s),!0):!1}const Jle=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Qle="[a-zA-Z_:][a-zA-Z0-9:._-]*",ece="[^\"'=<>`\\x00-\\x20]+",tce="'[^']*'",nce='"[^"]*"',rce="(?:"+ece+"|"+tce+"|"+nce+")",ace="(?:\\s+"+Qle+"(?:\\s*=\\s*"+rce+")?)",dF="<[A-Za-z][A-Za-z0-9\\-]*"+ace+"*\\s*\\/?>",fF="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",ice="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",sce="<[?][\\s\\S]*?[?]>",oce="<![A-Za-z][^>]*>",lce="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",cce=new RegExp("^(?:"+dF+"|"+fF+"|"+ice+"|"+sce+"|"+oce+"|"+lce+")"),uce=new RegExp("^(?:"+dF+"|"+fF+")"),ah=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+Jle.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(uce.source+"\\s*$"),/^$/,!1]];function dce(e,t,n,r){let a=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(a)!==60)return!1;let s=e.src.slice(a,i),o=0;for(;o<ah.length&&!ah[o][0].test(s);o++);if(o===ah.length)return!1;if(r)return ah[o][2];let l=t+1;if(!ah[o][1].test(s)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(a=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],s=e.src.slice(a,i),ah[o][1].test(s)){s.length!==0&&l++;break}}e.line=l;const u=e.push("html_block","",0);return u.map=[t,l],u.content=e.getLines(t,l,e.blkIndent,!0),!0}function fce(e,t,n,r){let a=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let s=e.src.charCodeAt(a);if(s!==35||a>=i)return!1;let o=1;for(s=e.src.charCodeAt(++a);s===35&&a<i&&o<=6;)o++,s=e.src.charCodeAt(++a);if(o>6||a<i&&!Fr(s))return!1;if(r)return!0;i=e.skipSpacesBack(i,a);const l=e.skipCharsBack(i,35,a);l>a&&Fr(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const u=e.push("heading_open","h"+String(o),1);u.markup="########".slice(0,o),u.map=[t,e.line];const d=e.push("inline","",0);d.content=e.src.slice(a,i).trim(),d.map=[t,e.line],d.children=[];const h=e.push("heading_close","h"+String(o),-1);return h.markup="########".slice(0,o),!0}function hce(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const a=e.parentType;e.parentType="paragraph";let i=0,s,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let y=e.bMarks[o]+e.tShift[o];const v=e.eMarks[o];if(y<v&&(s=e.src.charCodeAt(y),(s===45||s===61)&&(y=e.skipChars(y,s),y=e.skipSpaces(y),y>=v))){i=s===61?1:2;break}}if(e.sCount[o]<0)continue;let p=!1;for(let y=0,v=r.length;y<v;y++)if(r[y](e,o,n,!0)){p=!0;break}if(p)break}if(!i)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const u=e.push("heading_open","h"+String(i),1);u.markup=String.fromCharCode(s),u.map=[t,e.line];const d=e.push("inline","",0);d.content=l,d.map=[t,e.line-1],d.children=[];const h=e.push("heading_close","h"+String(i),-1);return h.markup=String.fromCharCode(s),e.parentType=a,!0}function pce(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),a=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3||e.sCount[i]<0)continue;let u=!1;for(let d=0,h=r.length;d<h;d++)if(r[d](e,i,n,!0)){u=!0;break}if(u)break}const s=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=s,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=a,!0}const Bb=[["table",Hle,["paragraph","reference"]],["code",Vle],["fence",Gle,["paragraph","reference","blockquote","list"]],["blockquote",Wle,["paragraph","reference","blockquote","list"]],["hr",Kle,["paragraph","reference","blockquote","list"]],["list",Yle,["paragraph","reference","blockquote"]],["reference",Xle],["html_block",dce,["paragraph","reference","blockquote"]],["heading",fce,["paragraph","reference","blockquote"]],["lheading",hce],["paragraph",pce]];function Sx(){this.ruler=new Li;for(let e=0;e<Bb.length;e++)this.ruler.push(Bb[e][0],Bb[e][1],{alt:(Bb[e][2]||[]).slice()})}Sx.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),a=r.length,i=e.md.options.maxNesting;let s=t,o=!1;for(;s<n&&(e.line=s=e.skipEmptyLines(s),!(s>=n||e.sCount[s]<e.blkIndent));){if(e.level>=i){e.line=n;break}const l=e.line;let u=!1;for(let d=0;d<a;d++)if(u=r[d](e,s,n,!1),u){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!u)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),s=e.line,s<n&&e.isEmpty(s)&&(o=!0,s++,e.line=s)}};Sx.prototype.parse=function(e,t,n,r){if(!e)return;const a=new this.State(e,t,n,r);this.tokenize(a,a.line,a.lineMax)};Sx.prototype.State=Qo;function H0(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}H0.prototype.pushPending=function(){const e=new uo("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};H0.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new uo(e,t,n);let a=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],a={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(a),r};H0.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),a=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const s=i-e,o=i<n?this.src.charCodeAt(i):32,l=zg(a)||Bg(String.fromCharCode(a)),u=zg(o)||Bg(String.fromCharCode(o)),d=$g(a),h=$g(o),p=!h&&(!u||d||l),y=!d&&(!l||h||u);return{can_open:p&&(t||!y||l),can_close:y&&(t||!p||u),length:s}};H0.prototype.Token=uo;function mce(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function gce(e,t){let n=e.pos;for(;n<e.posMax&&!mce(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const yce=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function bce(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const a=e.pending.match(yce);if(!a)return!1;const i=a[1],s=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!s)return!1;let o=s.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);const u=e.push("link_open","a",1);u.attrs=[["href",l]],u.markup="linkify",u.info="auto";const d=e.push("text","",0);d.content=e.md.normalizeLinkText(o);const h=e.push("link_close","a",-1);h.markup="linkify",h.info="auto"}return e.pos+=o.length-i.length,!0}function vce(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,a=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&e.pending.charCodeAt(i-1)===32;)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<a&&Fr(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const yT=[];for(let e=0;e<256;e++)yT.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){yT[e.charCodeAt(0)]=1});function wce(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let a=e.src.charCodeAt(n);if(a===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(a=e.src.charCodeAt(n),!!Fr(a));)n++;return e.pos=n,!0}let i=e.src[n];if(a>=55296&&a<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=e.src[n+1],n++)}const s="\\"+i;if(!t){const o=e.push("text_special","",0);a<256&&yT[a]!==0?o.content=i:o.content=s,o.markup=s,o.info="escape"}return e.pos=n+1,!0}function xce(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const a=n;n++;const i=e.posMax;for(;n<i&&e.src.charCodeAt(n)===96;)n++;const s=e.src.slice(a,n),o=s.length;if(e.backticksScanned&&(e.backticks[o]||0)<=a)return t||(e.pending+=s),e.pos+=o,!0;let l=n,u;for(;(u=e.src.indexOf("`",l))!==-1;){for(l=u+1;l<i&&e.src.charCodeAt(l)===96;)l++;const d=l-u;if(d===o){if(!t){const h=e.push("code_inline","code",0);h.markup=s,h.content=e.src.slice(n,u).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[d]=u}return e.backticksScanned=!0,t||(e.pending+=s),e.pos+=o,!0}function _ce(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const a=e.scanDelims(e.pos,!0);let i=a.length;const s=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=e.push("text","",0),o.content=s,i--);for(let l=0;l<i;l+=2)o=e.push("text","",0),o.content=s+s,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:a.can_open,close:a.can_close});return e.pos+=a.length,!0}function G4(e,t){let n;const r=[],a=t.length;for(let i=0;i<a;i++){const s=t[i];if(s.marker!==126||s.end===-1)continue;const o=t[s.end];n=e.tokens[s.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let s=i+1;for(;s<e.tokens.length&&e.tokens[s].type==="s_close";)s++;s--,i!==s&&(n=e.tokens[s],e.tokens[s]=e.tokens[i],e.tokens[i]=n)}}function Sce(e){const t=e.tokens_meta,n=e.tokens_meta.length;G4(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&G4(e,t[r].delimiters)}const hF={tokenize:_ce,postProcess:Sce};function Ece(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const a=e.scanDelims(e.pos,r===42);for(let i=0;i<a.length;i++){const s=e.push("text","",0);s.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:a.length,token:e.tokens.length-1,end:-1,open:a.can_open,close:a.can_close})}return e.pos+=a.length,!0}function W4(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const a=t[r];if(a.marker!==95&&a.marker!==42||a.end===-1)continue;const i=t[a.end],s=r>0&&t[r-1].end===a.end+1&&t[r-1].marker===a.marker&&t[r-1].token===a.token-1&&t[a.end+1].token===i.token+1,o=String.fromCharCode(a.marker),l=e.tokens[a.token];l.type=s?"strong_open":"em_open",l.tag=s?"strong":"em",l.nesting=1,l.markup=s?o+o:o,l.content="";const u=e.tokens[i.token];u.type=s?"strong_close":"em_close",u.tag=s?"strong":"em",u.nesting=-1,u.markup=s?o+o:o,u.content="",s&&(e.tokens[t[r-1].token].content="",e.tokens[t[a.end+1].token].content="",r--)}}function Cce(e){const t=e.tokens_meta,n=e.tokens_meta.length;W4(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&W4(e,t[r].delimiters)}const pF={tokenize:Ece,postProcess:Cce};function kce(e,t){let n,r,a,i,s="",o="",l=e.pos,u=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const d=e.pos,h=e.posMax,p=e.pos+1,y=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(y<0)return!1;let v=y+1;if(v<h&&e.src.charCodeAt(v)===40){for(u=!1,v++;v<h&&(n=e.src.charCodeAt(v),!(!Fr(n)&&n!==10));v++);if(v>=h)return!1;if(l=v,a=e.md.helpers.parseLinkDestination(e.src,v,e.posMax),a.ok){for(s=e.md.normalizeLink(a.str),e.md.validateLink(s)?v=a.pos:s="",l=v;v<h&&(n=e.src.charCodeAt(v),!(!Fr(n)&&n!==10));v++);if(a=e.md.helpers.parseLinkTitle(e.src,v,e.posMax),v<h&&l!==v&&a.ok)for(o=a.str,v=a.pos;v<h&&(n=e.src.charCodeAt(v),!(!Fr(n)&&n!==10));v++);}(v>=h||e.src.charCodeAt(v)!==41)&&(u=!0),v++}if(u){if(typeof e.env.references>"u")return!1;if(v<h&&e.src.charCodeAt(v)===91?(l=v+1,v=e.md.helpers.parseLinkLabel(e,v),v>=0?r=e.src.slice(l,v++):v=y+1):v=y+1,r||(r=e.src.slice(p,y)),i=e.env.references[_x(r)],!i)return e.pos=d,!1;s=i.href,o=i.title}if(!t){e.pos=p,e.posMax=y;const b=e.push("link_open","a",1),w=[["href",s]];b.attrs=w,o&&w.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=v,e.posMax=h,!0}function Tce(e,t){let n,r,a,i,s,o,l,u,d="";const h=e.pos,p=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const y=e.pos+2,v=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(v<0)return!1;if(i=v+1,i<p&&e.src.charCodeAt(i)===40){for(i++;i<p&&(n=e.src.charCodeAt(i),!(!Fr(n)&&n!==10));i++);if(i>=p)return!1;for(u=i,o=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),o.ok&&(d=e.md.normalizeLink(o.str),e.md.validateLink(d)?i=o.pos:d=""),u=i;i<p&&(n=e.src.charCodeAt(i),!(!Fr(n)&&n!==10));i++);if(o=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<p&&u!==i&&o.ok)for(l=o.str,i=o.pos;i<p&&(n=e.src.charCodeAt(i),!(!Fr(n)&&n!==10));i++);else l="";if(i>=p||e.src.charCodeAt(i)!==41)return e.pos=h,!1;i++}else{if(typeof e.env.references>"u")return!1;if(i<p&&e.src.charCodeAt(i)===91?(u=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?a=e.src.slice(u,i++):i=v+1):i=v+1,a||(a=e.src.slice(y,v)),s=e.env.references[_x(a)],!s)return e.pos=h,!1;d=s.href,l=s.title}if(!t){r=e.src.slice(y,v);const b=[];e.md.inline.parse(r,e.md,e.env,b);const w=e.push("image","img",0),x=[["src",d],["alt",""]];w.attrs=x,w.children=b,w.content=r,l&&x.push(["title",l])}return e.pos=i,e.posMax=p,!0}const Ace=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,Nce=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function Rce(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,a=e.posMax;for(;;){if(++n>=a)return!1;const s=e.src.charCodeAt(n);if(s===60)return!1;if(s===62)break}const i=e.src.slice(r+1,n);if(Nce.test(i)){const s=e.md.normalizeLink(i);if(!e.md.validateLink(s))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",s]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const u=e.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return e.pos+=i.length+2,!0}if(Ace.test(i)){const s=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(s))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",s]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const u=e.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return e.pos+=i.length+2,!0}return!1}function Ice(e){return/^<a[>\s]/i.test(e)}function jce(e){return/^<\/a\s*>/i.test(e)}function Oce(e){const t=e|32;return t>=97&&t<=122}function Dce(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const a=e.src.charCodeAt(r+1);if(a!==33&&a!==63&&a!==47&&!Oce(a))return!1;const i=e.src.slice(r).match(cce);if(!i)return!1;if(!t){const s=e.push("html_inline","",0);s.content=i[0],Ice(s.content)&&e.linkLevel++,jce(s.content)&&e.linkLevel--}return e.pos+=i[0].length,!0}const Mce=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,Pce=/^&([a-z][a-z0-9]{1,31});/i;function Fce(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const i=e.src.slice(n).match(Mce);if(i){if(!t){const s=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=e.push("text_special","",0);o.content=mT(s)?lw(s):lw(65533),o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}else{const i=e.src.slice(n).match(Pce);if(i){const s=sF(i[0]);if(s!==i[0]){if(!t){const o=e.push("text_special","",0);o.content=s,o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}}return!1}function K4(e){const t={},n=e.length;if(!n)return;let r=0,a=-2;const i=[];for(let s=0;s<n;s++){const o=e[s];if(i.push(0),(e[r].marker!==o.marker||a!==o.token-1)&&(r=s),a=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let u=r-i[r]-1,d=u;for(;u>l;u-=i[u]+1){const h=e[u];if(h.marker===o.marker&&h.open&&h.end<0){let p=!1;if((h.close||o.open)&&(h.length+o.length)%3===0&&(h.length%3!==0||o.length%3!==0)&&(p=!0),!p){const y=u>0&&!e[u-1].open?i[u-1]+1:0;i[s]=s-u+y,i[u]=y,o.open=!1,h.end=s,h.close=!1,d=-1,a=-2;break}}}d!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=d)}}function Lce(e){const t=e.tokens_meta,n=e.tokens_meta.length;K4(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&K4(t[r].delimiters)}function $ce(e){let t,n,r=0;const a=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)a[t].nesting<0&&r--,a[t].level=r,a[t].nesting>0&&r++,a[t].type==="text"&&t+1<i&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}const DE=[["text",gce],["linkify",bce],["newline",vce],["escape",wce],["backticks",xce],["strikethrough",hF.tokenize],["emphasis",pF.tokenize],["link",kce],["image",Tce],["autolink",Rce],["html_inline",Dce],["entity",Fce]],ME=[["balance_pairs",Lce],["strikethrough",hF.postProcess],["emphasis",pF.postProcess],["fragments_join",$ce]];function V0(){this.ruler=new Li;for(let e=0;e<DE.length;e++)this.ruler.push(DE[e][0],DE[e][1]);this.ruler2=new Li;for(let e=0;e<ME.length;e++)this.ruler2.push(ME[e][0],ME[e][1])}V0.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,a=e.md.options.maxNesting,i=e.cache;if(typeof i[t]<"u"){e.pos=i[t];return}let s=!1;if(e.level<a){for(let o=0;o<r;o++)if(e.level++,s=n[o](e,!0),e.level--,s){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;s||e.pos++,i[t]=e.pos};V0.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,a=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let s=!1;if(e.level<a){for(let o=0;o<n;o++)if(s=t[o](e,!1),s){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(s){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};V0.prototype.parse=function(e,t,n,r){const a=new this.State(e,t,n,r);this.tokenize(a);const i=this.ruler2.getRules(""),s=i.length;for(let o=0;o<s;o++)i[o](a)};V0.prototype.State=H0;function Bce(e){const t={};e=e||{},t.src_Any=tF.source,t.src_Cc=nF.source,t.src_Z=aF.source,t.src_P=hT.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function oC(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function Ex(e){return Object.prototype.toString.call(e)}function zce(e){return Ex(e)==="[object String]"}function Uce(e){return Ex(e)==="[object Object]"}function qce(e){return Ex(e)==="[object RegExp]"}function Z4(e){return Ex(e)==="[object Function]"}function Hce(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const mF={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function Vce(e){return Object.keys(e||{}).reduce(function(t,n){return t||mF.hasOwnProperty(n)},!1)}const Gce={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},Wce="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Kce="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function Zce(e){e.__index__=-1,e.__text_cache__=""}function Yce(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function Y4(){return function(e,t){t.normalize(e)}}function cw(e){const t=e.re=Bce(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(Wce),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const a=[];e.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const u={validate:null,link:null};if(e.__compiled__[o]=u,Uce(l)){qce(l.validate)?u.validate=Yce(l.validate):Z4(l.validate)?u.validate=l.validate:i(o,l),Z4(l.normalize)?u.normalize=l.normalize:l.normalize?i(o,l):u.normalize=Y4();return}if(zce(l)){a.push(o);return}i(o,l)}),a.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:Y4()};const s=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(Hce).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+s+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+s+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),Zce(e)}function Xce(e,t){const n=e.__index__,r=e.__last_index__,a=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=a,this.text=a,this.url=a}function lC(e,t){const n=new Xce(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function is(e,t){if(!(this instanceof is))return new is(e,t);t||Vce(e)&&(t=e,e={}),this.__opts__=oC({},mF,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=oC({},Gce,e),this.__compiled__={},this.__tlds__=Kce,this.__tlds_replaced__=!1,this.re={},cw(this)}is.prototype.add=function(t,n){return this.__schemas__[t]=n,cw(this),this};is.prototype.set=function(t){return this.__opts__=oC(this.__opts__,t),this};is.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,a,i,s,o,l,u,d;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(i=this.testSchemaAt(t,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(u=t.search(this.re.host_fuzzy_test),u>=0&&(this.__index__<0||u<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(s=r.index+r[1].length,(this.__index__<0||s<this.__index__)&&(this.__schema__="",this.__index__=s,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(d=t.indexOf("@"),d>=0&&(a=t.match(this.re.email_fuzzy))!==null&&(s=a.index+a[1].length,o=a.index+a[0].length,(this.__index__<0||s<this.__index__||s===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=s,this.__last_index__=o))),this.__index__>=0};is.prototype.pretest=function(t){return this.re.pretest.test(t)};is.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};is.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(lC(this,r)),r=this.__last_index__);let a=r?t.slice(r):t;for(;this.test(a);)n.push(lC(this,r)),a=a.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};is.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,lC(this,0)):null};is.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,a,i){return r!==i[a-1]}).reverse(),cw(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,cw(this),this)};is.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};is.prototype.onCompile=function(){};const _h=2147483647,zo=36,bT=1,Ug=26,Jce=38,Qce=700,gF=72,yF=128,bF="-",eue=/^xn--/,tue=/[^\0-\x7F]/,nue=/[\x2E\u3002\uFF0E\uFF61]/g,rue={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},PE=zo-bT,Uo=Math.floor,FE=String.fromCharCode;function qc(e){throw new RangeError(rue[e])}function aue(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function vF(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(nue,".");const a=e.split("."),i=aue(a,t).join(".");return r+i}function wF(e){const t=[];let n=0;const r=e.length;for(;n<r;){const a=e.charCodeAt(n++);if(a>=55296&&a<=56319&&n<r){const i=e.charCodeAt(n++);(i&64512)==56320?t.push(((a&1023)<<10)+(i&1023)+65536):(t.push(a),n--)}else t.push(a)}return t}const iue=e=>String.fromCodePoint(...e),sue=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:zo},X4=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},xF=function(e,t,n){let r=0;for(e=n?Uo(e/Qce):e>>1,e+=Uo(e/t);e>PE*Ug>>1;r+=zo)e=Uo(e/PE);return Uo(r+(PE+1)*e/(e+Jce))},_F=function(e){const t=[],n=e.length;let r=0,a=yF,i=gF,s=e.lastIndexOf(bF);s<0&&(s=0);for(let o=0;o<s;++o)e.charCodeAt(o)>=128&&qc("not-basic"),t.push(e.charCodeAt(o));for(let o=s>0?s+1:0;o<n;){const l=r;for(let d=1,h=zo;;h+=zo){o>=n&&qc("invalid-input");const p=sue(e.charCodeAt(o++));p>=zo&&qc("invalid-input"),p>Uo((_h-r)/d)&&qc("overflow"),r+=p*d;const y=h<=i?bT:h>=i+Ug?Ug:h-i;if(p<y)break;const v=zo-y;d>Uo(_h/v)&&qc("overflow"),d*=v}const u=t.length+1;i=xF(r-l,u,l==0),Uo(r/u)>_h-a&&qc("overflow"),a+=Uo(r/u),r%=u,t.splice(r++,0,a)}return String.fromCodePoint(...t)},SF=function(e){const t=[];e=wF(e);const n=e.length;let r=yF,a=0,i=gF;for(const l of e)l<128&&t.push(FE(l));const s=t.length;let o=s;for(s&&t.push(bF);o<n;){let l=_h;for(const d of e)d>=r&&d<l&&(l=d);const u=o+1;l-r>Uo((_h-a)/u)&&qc("overflow"),a+=(l-r)*u,r=l;for(const d of e)if(d<r&&++a>_h&&qc("overflow"),d===r){let h=a;for(let p=zo;;p+=zo){const y=p<=i?bT:p>=i+Ug?Ug:p-i;if(h<y)break;const v=h-y,b=zo-y;t.push(FE(X4(y+v%b,0))),h=Uo(v/b)}t.push(FE(X4(h,0))),i=xF(a,u,o===s),a=0,++o}++a,++r}return t.join("")},oue=function(e){return vF(e,function(t){return eue.test(t)?_F(t.slice(4).toLowerCase()):t})},lue=function(e){return vF(e,function(t){return tue.test(t)?"xn--"+SF(t):t})},EF={version:"2.3.1",ucs2:{decode:wF,encode:iue},decode:_F,encode:SF,toASCII:lue,toUnicode:oue},cue={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},uue={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},due={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},fue={default:cue,zero:uue,commonmark:due},hue=/^(vbscript|javascript|file|data):/,pue=/^data:image\/(gif|png|jpeg|webp);/;function mue(e){const t=e.trim().toLowerCase();return hue.test(t)?pue.test(t):!0}const CF=["http:","https:","mailto:"];function gue(e){const t=fT(e,!0);if(t.hostname&&(!t.protocol||CF.indexOf(t.protocol)>=0))try{t.hostname=EF.toASCII(t.hostname)}catch{}return q0(dT(t))}function yue(e){const t=fT(e,!0);if(t.hostname&&(!t.protocol||CF.indexOf(t.protocol)>=0))try{t.hostname=EF.toUnicode(t.hostname)}catch{}return Wh(dT(t),Wh.defaultChars+"%")}function ks(e,t){if(!(this instanceof ks))return new ks(e,t);t||pT(e)||(t=e||{},e="default"),this.inline=new V0,this.block=new Sx,this.core=new gT,this.renderer=new yp,this.linkify=new is,this.validateLink=mue,this.normalizeLink=gue,this.normalizeLinkText=yue,this.utils=vle,this.helpers=xx({},Sle),this.options={},this.configure(e),t&&this.set(t)}ks.prototype.set=function(e){return xx(this.options,e),this};ks.prototype.configure=function(e){const t=this;if(pT(e)){const n=e;if(e=fue[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};ks.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(a){n=n.concat(this[a].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(a){return n.indexOf(a)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};ks.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(a){n=n.concat(this[a].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(a){return n.indexOf(a)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};ks.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};ks.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};ks.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};ks.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};ks.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const LE=new ks({html:!1,linkify:!0,breaks:!0});function kF(e){return T.useMemo(()=>{var n;if(!e)return[];try{const r=LE.parse(e,{}),a=[];let i="",s=0;for(;s<r.length;){const o=r[s];if(o.type==="fence"){i&&(a.push(i),i="");const l=((n=o.info)==null?void 0:n.split(" ")[0])||void 0;a.push({type:"code",lang:l,code:o.content}),s++}else{const l=[];for(;s<r.length&&r[s].type!=="fence";)l.push(r[s]),s++;l.length>0&&(i+=LE.renderer.render(l,LE.options,{}))}}return i&&a.push(i),a}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const bue=({toolCall:e})=>{const[t,n]=T.useState(!0),r=()=>n(i=>!i),a=T.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return m.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",m.jsx("code",{className:"font-mono",children:e.toolName})]}),m.jsx(rr,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?m.jsx(Yo,{}):m.jsx(qd,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&m.jsx(p0,{lang:"json",code:a})]})},vue=({toolResult:e})=>{const[t,n]=T.useState(!0),r=()=>n(s=>!s),a=T.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),i=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return m.jsxs("div",{className:Nt("my-2 p-2 border rounded-md text-xs",i?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsxs("span",{className:Nt("font-semibold",i?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",m.jsx("code",{className:"font-mono",children:e.toolName})]}),m.jsx(rr,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?m.jsx(Yo,{}):m.jsx(qd,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&m.jsx(p0,{lang:i?"text":"json",code:a})]})},wue=({markdownContent:e})=>{const t=kF(e);return e!=null&&e.trim()?m.jsx("div",{children:t.map((n,r)=>{if(typeof n=="string")return m.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`);if(n.type==="code"){const a=n;return m.jsx(p0,{lang:a.lang,code:a.code},`code-${r}`)}return null})}):null},xue=({response:e,toolCalls:t,toolResults:n,reasoning:r,isError:a,errorMessage:i,isFolded:s,toggleFold:o})=>{const[l,u]=T.useState(!0),d=T.useCallback(()=>u(b=>!b),[]),h=!!r,p=e&&(typeof e!="string"||e.trim().length>0),y=t&&t.length>0,v=n&&n.length>0;return s?m.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:o,children:[h?"[Reasoning] ":"",y?`[${t==null?void 0:t.length} Tool Call(s)] `:"",p&&typeof e=="string"?`"${e.substring(0,80)}${e.length>80?"...":""}"`:y||v||h?"":"[No text response]"]}):m.jsxs(m.Fragment,{children:[a&&i&&m.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[m.jsx("p",{className:"font-semibold",children:"Error:"}),m.jsx("p",{children:i})]}),h&&m.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[m.jsx(x6,{className:"h-3.5 w-3.5"})," Reasoning"]}),m.jsx(rr,{tooltipText:l?"Show Reasoning":"Hide Reasoning",onClick:d,"aria-label":l?"Show reasoning":"Hide reasoning",icon:l?m.jsx(Yo,{}):m.jsx(qd,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!l&&m.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1",children:r})]}),t==null?void 0:t.map((b,w)=>{try{const x=JSON.parse(b);return m.jsx(bue,{toolCall:x},`call-${w}`)}catch(x){return console.error("Failed to parse tool call string:",x),m.jsx("div",{className:"text-xs text-destructive",children:"[Error displaying tool call]"},`call-err-${w}`)}}),n==null?void 0:n.map((b,w)=>{try{const x=JSON.parse(b);return m.jsx(vue,{toolResult:x},`res-${w}`)}catch(x){return console.error("Failed to parse tool result string:",x),m.jsx("div",{className:"text-xs text-destructive",children:"[Error displaying tool result]"},`res-err-${w}`)}}),m.jsx(wue,{markdownContent:e}),!p&&!y&&!v&&!h&&m.jsx("div",{className:"text-muted-foreground italic",children:"No response content."})]})},TF=gt.memo(({interaction:e,onRegenerate:t,onDelete:n,onEdit:r,className:a})=>{var C,k,R,O,j,$,L,X,F,K,q,de;const[i,s]=T.useState(!1),{dbProviderConfigs:o,getAllAvailableModelDefsForProvider:l}=Fn(dn(re=>({dbProviderConfigs:re.dbProviderConfigs,getAllAvailableModelDefsForProvider:re.getAllAvailableModelDefsForProvider}))),u=T.useCallback(()=>s(re=>!re),[]),d=e.endedAt?eF(new Date(e.endedAt),{addSuffix:!0}):"Processing...",h=T.useMemo(()=>{var oe;const re=(oe=e.metadata)==null?void 0:oe.modelId;if(!re)return"Unknown Model";const{providerId:Y,modelId:Q}=Ql(re);if(!Y||!Q)return re;const ae=o.find(me=>me.id===Y),B=(ae==null?void 0:ae.name)??Y,ee=l(Y).find(me=>me.id===Q);return`${(ee==null?void 0:ee.name)??Q} (${B})`},[(C=e.metadata)==null?void 0:C.modelId,o,l]),p=e.status==="COMPLETED",y=p||e.status==="ERROR",v=e.status==="ERROR",b=e.response&&(typeof e.response!="string"||e.response.trim().length>0),w=((k=e.metadata)==null?void 0:k.toolCalls)&&e.metadata.toolCalls.length>0,x=((R=e.metadata)==null?void 0:R.toolResults)&&e.metadata.toolResults.length>0,S=!!((O=e.metadata)!=null&&O.reasoning),E=b||w||x||S;return m.jsxs("div",{className:Nt("group/card relative rounded-lg border bg-card p-4 shadow-sm transition-colors hover:bg-muted/50",v?"border-destructive/50 bg-destructive/5":"border-border",a),children:[e.prompt&&m.jsx(uT,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:p}),m.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50 relative group/assistant",children:[m.jsx(Ioe,{displayModelName:h,timeAgo:d,responseContent:typeof e.response=="string"?e.response:null,isFolded:i,toggleFold:u,canFold:E,promptTokens:(j=e.metadata)==null?void 0:j.promptTokens,completionTokens:($=e.metadata)==null?void 0:$.completionTokens,timeToFirstToken:(L=e.metadata)==null?void 0:L.timeToFirstToken,generationTime:(X=e.metadata)==null?void 0:X.generationTime}),m.jsx(xue,{response:e.response,toolCalls:(F=e.metadata)==null?void 0:F.toolCalls,toolResults:(K=e.metadata)==null?void 0:K.toolResults,reasoning:(q=e.metadata)==null?void 0:q.reasoning,isError:v,errorMessage:(de=e.metadata)==null?void 0:de.error,isFolded:i,toggleFold:u})]}),y&&m.jsx(joe,{interactionId:e.id,onEdit:r,onRegenerate:t,onDelete:n})]})});TF.displayName="InteractionCard";const J4=(e,t,n,r)=>{if(typeof e=="string")return e.trim()?m.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null;if(e.type==="code"){const a=e,i=a.lang?`language-${a.lang}`:"language-plaintext";return n?m.jsx(p0,{lang:a.lang,code:a.code,isStreaming:r},`code-${t}`):m.jsxs("pre",{className:"code-block-container my-4 border border-border rounded-lg overflow-x-auto",children:[m.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border-b border-border bg-muted/50",children:m.jsx("div",{className:"text-sm font-medium",children:a.lang?a.lang.toUpperCase():"CODE"})}),m.jsx("code",{className:Nt(i,"block p-4 font-mono text-sm leading-relaxed"),children:a.code})]},`pre-${t}`)}return null},_ue=({markdownContent:e,isStreaming:t=!1,className:n})=>{const{enableStreamingMarkdown:r,enableStreamingCodeBlockParsing:a}=qr(dn(p=>({enableStreamingMarkdown:p.enableStreamingMarkdown,enableStreamingCodeBlockParsing:p.enableStreamingCodeBlockParsing}))),i=kF(r?e:null),[s,o]=T.useState([]),[l,u]=T.useState(null),d=T.useRef(0);T.useEffect(()=>{if(!r){o([]),u(e??null),d.current=0;return}const p=d.current,y=i.slice(p,i.length-1);if(y.length>0){const b=y.map((w,x)=>J4(w,p+x,a,!1)).filter(w=>w!==null);o(w=>[...w,...b]),d.current+=y.length}const v=i.length>0?i[i.length-1]:null;JSON.stringify(v)!==JSON.stringify(l)&&u(v),e||(o([]),u(null),d.current=0)},[i,r,a,l,e]);const h=T.useMemo(()=>!l||!r?null:J4(l,d.current,a,!0),[l,a,r]);return!(e!=null&&e.trim())&&s.length===0?m.jsx("div",{className:Nt("text-muted-foreground italic",n),children:t?"Generating response...":"No response content."}):r?m.jsxs("div",{className:Nt(n),children:[s,h]}):m.jsx("pre",{className:Nt("whitespace-pre-wrap text-sm",n),children:e})},Sue=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":a="Stop Generation"})=>m.jsx(rr,{tooltipText:"Stop",onClick:e,"aria-label":a,icon:m.jsx(EH,{}),variant:r,size:n,className:t}),cC=gt.memo(({interactionId:e,onStop:t,className:n})=>{var v;const{interaction:r,interactionStatus:a}=Zn(dn(b=>{const w=b.interactions.find(x=>x.id===e);return{interaction:w,interactionStatus:w==null?void 0:w.status}})),i=qr(b=>b.streamingRenderFPS),[s,o]=T.useState(""),l=T.useRef(null),u=T.useRef(0);T.useEffect(()=>{const b=1e3/i;let w=!0;const x=S=>{if(!w)return;if(Zn.getState().streamingInteractionIds.includes(e)){if(S-u.current>=b){const C=Zn.getState().activeStreamBuffers[e]??"";o(C),u.current=S}l.current=requestAnimationFrame(x)}else{const C=Zn.getState().activeStreamBuffers[e]??"";o(C),l.current=null}};return l.current=requestAnimationFrame(x),()=>{w=!1,l.current&&(cancelAnimationFrame(l.current),l.current=null)}},[e,i]),T.useEffect(()=>{if(a&&a!=="STREAMING"){const b=Zn.getState().activeStreamBuffers[e]??"";o(b),l.current&&(cancelAnimationFrame(l.current),l.current=null)}},[a,e]);const{dbProviderConfigs:d,getAllAvailableModelDefsForProvider:h}=Fn(dn(b=>({dbProviderConfigs:b.dbProviderConfigs,getAllAvailableModelDefsForProvider:b.getAllAvailableModelDefsForProvider}))),p=T.useMemo(()=>{var R;const b=(R=r==null?void 0:r.metadata)==null?void 0:R.modelId;if(!b)return"Loading Model...";const{providerId:w,modelId:x}=Ql(b);if(!w||!x)return b;const S=d.find(O=>O.id===w),E=(S==null?void 0:S.name)??w,k=h(w).find(O=>O.id===x);return`${(k==null?void 0:k.name)??x} (${E})`},[(v=r==null?void 0:r.metadata)==null?void 0:v.modelId,d,h]);if(!r)return console.warn(`StreamingInteractionCard: Interaction data for ${e} not found yet.`),m.jsxs("div",{className:Nt("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",n),children:[m.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"})," ",m.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2",children:[m.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),m.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),m.jsx("div",{className:"h-16 bg-muted rounded w-full"})," "]})]});const y=()=>{t&&t(e)};return m.jsxs("div",{className:Nt("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-fadeIn",n),children:[r.prompt&&m.jsx(uT,{turnData:r.prompt,timestamp:r.startedAt,isAssistantComplete:!1}),m.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2",children:[m.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:["Assistant (",p,")"]}),m.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),m.jsx(_ue,{markdownContent:s,isStreaming:!0})]}),t&&m.jsx("div",{className:"absolute bottom-1 right-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200",children:m.jsx(Sue,{onStop:y,"aria-label":"Stop Generation"})})]})});cC.displayName="StreamingInteractionCard";var Eue=T.createContext(void 0);function bp(e){const t=T.useContext(Eue);return e||t||"ltr"}function qg(e,[t,n]){return Math.min(n,Math.max(t,e))}function Cue(e,t){return T.useReducer((n,r)=>t[n][r]??n,e)}var vT="ScrollArea",[AF,s_e]=Si(vT),[kue,Os]=AF(vT),NF=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:a,scrollHideDelay:i=600,...s}=e,[o,l]=T.useState(null),[u,d]=T.useState(null),[h,p]=T.useState(null),[y,v]=T.useState(null),[b,w]=T.useState(null),[x,S]=T.useState(0),[E,C]=T.useState(0),[k,R]=T.useState(!1),[O,j]=T.useState(!1),$=Cn(t,X=>l(X)),L=bp(a);return m.jsx(kue,{scope:n,type:r,dir:L,scrollHideDelay:i,scrollArea:o,viewport:u,onViewportChange:d,content:h,onContentChange:p,scrollbarX:y,onScrollbarXChange:v,scrollbarXEnabled:k,onScrollbarXEnabledChange:R,scrollbarY:b,onScrollbarYChange:w,scrollbarYEnabled:O,onScrollbarYEnabledChange:j,onCornerWidthChange:S,onCornerHeightChange:C,children:m.jsx(rn.div,{dir:L,...s,ref:$,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":E+"px",...e.style}})})});NF.displayName=vT;var RF="ScrollAreaViewport",IF=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:a,...i}=e,s=Os(RF,n),o=T.useRef(null),l=Cn(t,o,s.onViewportChange);return m.jsxs(m.Fragment,{children:[m.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),m.jsx(rn.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:s.scrollbarXEnabled?"scroll":"hidden",overflowY:s.scrollbarYEnabled?"scroll":"hidden",...e.style},children:m.jsx("div",{ref:s.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});IF.displayName=RF;var el="ScrollAreaScrollbar",jF=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Os(el,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:s}=a,o=e.orientation==="horizontal";return T.useEffect(()=>(o?i(!0):s(!0),()=>{o?i(!1):s(!1)}),[o,i,s]),a.type==="hover"?m.jsx(Tue,{...r,ref:t,forceMount:n}):a.type==="scroll"?m.jsx(Aue,{...r,ref:t,forceMount:n}):a.type==="auto"?m.jsx(OF,{...r,ref:t,forceMount:n}):a.type==="always"?m.jsx(wT,{...r,ref:t}):null});jF.displayName=el;var Tue=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Os(el,e.__scopeScrollArea),[i,s]=T.useState(!1);return T.useEffect(()=>{const o=a.scrollArea;let l=0;if(o){const u=()=>{window.clearTimeout(l),s(!0)},d=()=>{l=window.setTimeout(()=>s(!1),a.scrollHideDelay)};return o.addEventListener("pointerenter",u),o.addEventListener("pointerleave",d),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",u),o.removeEventListener("pointerleave",d)}}},[a.scrollArea,a.scrollHideDelay]),m.jsx(ka,{present:n||i,children:m.jsx(OF,{"data-state":i?"visible":"hidden",...r,ref:t})})}),Aue=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Os(el,e.__scopeScrollArea),i=e.orientation==="horizontal",s=kx(()=>l("SCROLL_END"),100),[o,l]=Cue("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return T.useEffect(()=>{if(o==="idle"){const u=window.setTimeout(()=>l("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(u)}},[o,a.scrollHideDelay,l]),T.useEffect(()=>{const u=a.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const p=()=>{const y=u[d];h!==y&&(l("SCROLL"),s()),h=y};return u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[a.viewport,i,l,s]),m.jsx(ka,{present:n||o!=="hidden",children:m.jsx(wT,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Vt(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Vt(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),OF=T.forwardRef((e,t)=>{const n=Os(el,e.__scopeScrollArea),{forceMount:r,...a}=e,[i,s]=T.useState(!1),o=e.orientation==="horizontal",l=kx(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,d=n.viewport.offsetHeight<n.viewport.scrollHeight;s(o?u:d)}},10);return Zh(n.viewport,l),Zh(n.content,l),m.jsx(ka,{present:r||i,children:m.jsx(wT,{"data-state":i?"visible":"hidden",...a,ref:t})})}),wT=T.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,a=Os(el,e.__scopeScrollArea),i=T.useRef(null),s=T.useRef(0),[o,l]=T.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=LF(o.viewport,o.content),d={...r,sizes:o,onSizesChange:l,hasThumb:u>0&&u<1,onThumbChange:p=>i.current=p,onThumbPointerUp:()=>s.current=0,onThumbPointerDown:p=>s.current=p};function h(p,y){return Due(p,s.current,o,y)}return n==="horizontal"?m.jsx(Nue,{...d,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollLeft,y=Q4(p,o,a.dir);i.current.style.transform=`translate3d(${y}px, 0, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollLeft=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollLeft=h(p,a.dir))}}):n==="vertical"?m.jsx(Rue,{...d,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollTop,y=Q4(p,o);i.current.style.transform=`translate3d(0, ${y}px, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollTop=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollTop=h(p))}}):null}),Nue=T.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...a}=e,i=Os(el,e.__scopeScrollArea),[s,o]=T.useState(),l=T.useRef(null),u=Cn(t,l,i.onScrollbarXChange);return T.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),m.jsx(MF,{"data-orientation":"horizontal",...a,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Cx(n)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.x),onDragScroll:d=>e.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const p=i.viewport.scrollLeft+d.deltaX;e.onWheelScroll(p),BF(p,h)&&d.preventDefault()}},onResize:()=>{l.current&&i.viewport&&s&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:dw(s.paddingLeft),paddingEnd:dw(s.paddingRight)}})}})}),Rue=T.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...a}=e,i=Os(el,e.__scopeScrollArea),[s,o]=T.useState(),l=T.useRef(null),u=Cn(t,l,i.onScrollbarYChange);return T.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),m.jsx(MF,{"data-orientation":"vertical",...a,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Cx(n)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.y),onDragScroll:d=>e.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const p=i.viewport.scrollTop+d.deltaY;e.onWheelScroll(p),BF(p,h)&&d.preventDefault()}},onResize:()=>{l.current&&i.viewport&&s&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:dw(s.paddingTop),paddingEnd:dw(s.paddingBottom)}})}})}),[Iue,DF]=AF(el),MF=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:a,onThumbChange:i,onThumbPointerUp:s,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:u,onWheelScroll:d,onResize:h,...p}=e,y=Os(el,n),[v,b]=T.useState(null),w=Cn(t,$=>b($)),x=T.useRef(null),S=T.useRef(""),E=y.viewport,C=r.content-r.viewport,k=Fa(d),R=Fa(l),O=kx(h,10);function j($){if(x.current){const L=$.clientX-x.current.left,X=$.clientY-x.current.top;u({x:L,y:X})}}return T.useEffect(()=>{const $=L=>{const X=L.target;(v==null?void 0:v.contains(X))&&k(L,C)};return document.addEventListener("wheel",$,{passive:!1}),()=>document.removeEventListener("wheel",$,{passive:!1})},[E,v,C,k]),T.useEffect(R,[r,R]),Zh(v,O),Zh(y.content,O),m.jsx(Iue,{scope:n,scrollbar:v,hasThumb:a,onThumbChange:Fa(i),onThumbPointerUp:Fa(s),onThumbPositionChange:R,onThumbPointerDown:Fa(o),children:m.jsx(rn.div,{...p,ref:w,style:{position:"absolute",...p.style},onPointerDown:Vt(e.onPointerDown,$=>{$.button===0&&($.target.setPointerCapture($.pointerId),x.current=v.getBoundingClientRect(),S.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",y.viewport&&(y.viewport.style.scrollBehavior="auto"),j($))}),onPointerMove:Vt(e.onPointerMove,j),onPointerUp:Vt(e.onPointerUp,$=>{const L=$.target;L.hasPointerCapture($.pointerId)&&L.releasePointerCapture($.pointerId),document.body.style.webkitUserSelect=S.current,y.viewport&&(y.viewport.style.scrollBehavior=""),x.current=null})})})}),uw="ScrollAreaThumb",PF=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=DF(uw,e.__scopeScrollArea);return m.jsx(ka,{present:n||a.hasThumb,children:m.jsx(jue,{ref:t,...r})})}),jue=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...a}=e,i=Os(uw,n),s=DF(uw,n),{onThumbPositionChange:o}=s,l=Cn(t,h=>s.onThumbChange(h)),u=T.useRef(void 0),d=kx(()=>{u.current&&(u.current(),u.current=void 0)},100);return T.useEffect(()=>{const h=i.viewport;if(h){const p=()=>{if(d(),!u.current){const y=Mue(h,o);u.current=y,o()}};return o(),h.addEventListener("scroll",p),()=>h.removeEventListener("scroll",p)}},[i.viewport,d,o]),m.jsx(rn.div,{"data-state":s.hasThumb?"visible":"hidden",...a,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Vt(e.onPointerDownCapture,h=>{const y=h.target.getBoundingClientRect(),v=h.clientX-y.left,b=h.clientY-y.top;s.onThumbPointerDown({x:v,y:b})}),onPointerUp:Vt(e.onPointerUp,s.onThumbPointerUp)})});PF.displayName=uw;var xT="ScrollAreaCorner",FF=T.forwardRef((e,t)=>{const n=Os(xT,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?m.jsx(Oue,{...e,ref:t}):null});FF.displayName=xT;var Oue=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,a=Os(xT,n),[i,s]=T.useState(0),[o,l]=T.useState(0),u=!!(i&&o);return Zh(a.scrollbarX,()=>{var h;const d=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(d),l(d)}),Zh(a.scrollbarY,()=>{var h;const d=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(d),s(d)}),u?m.jsx(rn.div,{...r,ref:t,style:{width:i,height:o,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function dw(e){return e?parseInt(e,10):0}function LF(e,t){const n=e/t;return isNaN(n)?0:n}function Cx(e){const t=LF(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function Due(e,t,n,r="ltr"){const a=Cx(n),i=a/2,s=t||i,o=a-s,l=n.scrollbar.paddingStart+s,u=n.scrollbar.size-n.scrollbar.paddingEnd-o,d=n.content-n.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return $F([l,u],h)(e)}function Q4(e,t,n="ltr"){const r=Cx(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-a,s=t.content-t.viewport,o=i-r,l=n==="ltr"?[0,s]:[s*-1,0],u=qg(e,l);return $F([0,s],[0,o])(u)}function $F(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function BF(e,t){return e>0&&e<t}var Mue=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function a(){const i={left:e.scrollLeft,top:e.scrollTop},s=n.left!==i.left,o=n.top!==i.top;(s||o)&&t(),n=i,r=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(r)};function kx(e,t){const n=Fa(e),r=T.useRef(0);return T.useEffect(()=>()=>window.clearTimeout(r.current),[]),T.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Zh(e,t){const n=Fa(t);za(()=>{let r=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return a.observe(e),()=>{window.cancelAnimationFrame(r),a.unobserve(e)}}},[e,n])}var Pue=NF,Fue=IF,Lue=FF;function Yl({className:e,children:t,...n}){return m.jsxs(Pue,{"data-slot":"scroll-area",className:Nt("relative",e),...n,children:[m.jsx(Fue,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),m.jsx($ue,{}),m.jsx(Lue,{})]})}function $ue({className:e,orientation:t="vertical",...n}){return m.jsx(jF,{"data-slot":"scroll-area-scrollbar",orientation:t,className:Nt("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:m.jsx(PF,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function ur({className:e,...t}){return m.jsx("div",{"data-slot":"skeleton",className:Nt("bg-accent animate-pulse rounded-md",e),...t})}const eO=()=>m.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[m.jsx(T6,{className:"h-16 w-16 text-muted-foreground mb-4"}),m.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),m.jsx("p",{className:"text-muted-foreground max-w-md",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat."})]}),Bue=".litechat/conversations",zF="/synced_repos";async function zue(e,t,n){n(t.id,"syncing");const r=nr(`${zF}/${t.id}`),a={username:t.username,password:t.password},i=t.branch||"main";try{let s=!1;try{await e.promises.stat(Ko(r,".git")),s=!0}catch(o){if(o.code==="ENOENT")s=!1;else throw o}s?(tt.info(`Pulling latest changes for "${t.name}"...`),await bx(r,i,a,{fsInstance:e}),tt.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(tt.info(`Cloning repository "${t.name}"...`),await U5(r,t.remoteUrl,i,a,{fsInstance:e}),tt.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(s){console.error(`Failed to initialize/sync repository ${t.name}:`,s),n(t.id,"error")}}async function Uue(e,t,n,r,a,i,s){var h,p;r(t.id,"syncing");const o=nr(`${zF}/${n.id}`),l=Ko(o,Bue,`${t.id}.json`),u={username:n.username,password:n.password},d=n.branch||"main";try{try{await e.promises.stat(Ko(o,".git"))}catch(x){if(x.code==="ENOENT"){tt.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw x}tt.info(`Pulling latest changes for "${n.name}"...`),await bx(o,d,u,{fsInstance:e});let y=null,v=null;try{const x=await of(l,{fsInstance:e}),S=new TextDecoder().decode(x);y=JSON.parse(S),v=(h=y==null?void 0:y.conversation)!=null&&h.updatedAt?new Date(y.conversation.updatedAt).getTime():null,isNaN(v??NaN)&&(v=null)}catch(x){x.code==="ENOENT"?console.log(`Conversation file ${l} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${x.message}`),tt.warning(`Could not read remote version of conversation: ${x.message}`))}const b=t.updatedAt.getTime(),w=((p=t.lastSyncedAt)==null?void 0:p.getTime())??0;if(!y||b>(v??0)||b>w&&b>=(v??0)){tt.info("Local changes detected. Pushing to remote...");const x=await Ft.loadInteractionsForConversation(t.id),{lastSyncedAt:S,...E}=t,C=JSON.stringify({conversation:E,interactions:x},null,2);await vx(l,C,{fsInstance:e}),await sT(o,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await oT(o,d,u,{fsInstance:e}),await a(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),tt.success("Conversation synced successfully (pushed).")}else if(v&&v>b){tt.info("Remote changes detected. Updating local conversation...");const x={...y.conversation,createdAt:new Date(y.conversation.createdAt),updatedAt:new Date(y.conversation.updatedAt),lastSyncedAt:new Date};await Ft.saveConversation(x),await Ft.deleteInteractionsForConversation(t.id);const S=y.interactions.map(E=>Ft.saveInteraction({...E,conversationId:t.id,startedAt:E.startedAt?new Date(E.startedAt):null,endedAt:E.endedAt?new Date(E.endedAt):null}));await Promise.all(S),i()===t.id&&s()==="conversation"&&await Zn.getState().loadInteractions(t.id),r(t.id,"idle"),tt.success("Conversation synced successfully (pulled).")}else tt.info("Conversation already up-to-date."),await a(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(y){console.error(`Sync failed for conversation ${t.id}:`,y),r(t.id,"error",y.message)}}const Xs=As(Ns((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&tt.error(`VFS Error: ${n}`)})},_addNodes:n=>{e(r=>{const a={};n.forEach(i=>{r.nodes[i.id]=i;const s=i.parentId??r.rootId??"";a[s]||(a[s]=r.childrenMap[s]?[...r.childrenMap[s]]:[]),a[s].includes(i.id)||a[s].push(i.id)});for(const i in a)(!r.childrenMap[i]||JSON.stringify(r.childrenMap[i].sort())!==JSON.stringify(a[i].sort()))&&(r.childrenMap[i]=a[i])})},_updateNode:(n,r)=>{e(a=>{a.nodes[n]&&Object.assign(a.nodes[n],r)})},_removeNodes:n=>{e(r=>{n.forEach(a=>{const i=r.nodes[a];if(i){const s=i.parentId??r.rootId??"";if(r.childrenMap[s]&&(r.childrenMap[s]=r.childrenMap[s].filter(o=>o!==a)),delete r.nodes[a],r.selectedFileIds.delete(a),i.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===a).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[a]}}})})},_setFsInstance:n=>{e({fs:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),n?!t().vfsKey&&!t().configuredVfsKey&&console.log("[VfsStore] VFS globally enabled, waiting for vfsKey to be set."):(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),St.emit(_t.VFS_CONTEXT_CHANGED,{vfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),St.emit(_t.VFS_CONTEXT_CHANGED,{vfsKey:n})},setVfsKey:n=>{const r=t().vfsKey,a=t().configuredVfsKey;if(n===r){console.log(`[VfsStore] setVfsKey: Key ${n} is already desired.`),n&&n!==a&&!t().initializingKey&&(console.log(`[VfsStore] setVfsKey: Re-triggering initialization for desired key ${n} as it's not configured.`),t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,i)}));return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${a}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),St.emit(_t.VFS_CONTEXT_CHANGED,{vfsKey:null}),n!==null?t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,i)}):console.log("[VfsStore] setVfsKey: Desired key is null. State cleared.")},initializeVFS:async(n,r)=>{if(!n)throw console.warn("[VfsStore] initializeVFS called without a valid vfsKey."),new Error("VFS key cannot be empty.");const a=(r==null?void 0:r.force)===!0;if(!a){if(t().vfsKey!==n){const d=`UI Initialization aborted for "${n}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${d}`),new Error(d)}if(t().initializingKey!==null){const d=`UI Initialization skipped for "${n}". Already initializing key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${d}`),new Error(d)}if(t().configuredVfsKey===n&&t().fs)return console.log(`[VfsStore] UI Initialization skipped for key "${n}" (already configured).`),e({loading:!1}),t().fs}const{_setLoading:i,_setError:s,_addNodes:o,_setFsInstance:l,_setConfiguredVfsKey:u}=t();console.log(`[VfsStore] Initializing VFS with key: ${n} (Forced: ${a})`),e({initializingKey:n}),a||(i(!0),s(null));try{const d=await fse(n);if(!d)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==n){const y=`UI Initialization for key "${n}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${y}`),e({initializingKey:null,loading:!1}),new Error(y)}if(a)return console.log(`[VfsStore] Forced initialization complete for key: ${n}. Returning instance.`),e({initializingKey:null}),d;l(d),u(n),console.log(`[VfsStore] UI VFS instance configured for key: ${n}`);const h="vfs-root";let p=t().nodes[h];try{await d.promises.stat("/"),console.log("[VfsStore] Root directory '/' exists.")}catch(y){if(y.code==="ENOENT")console.log("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw y}if(!p||p.path!=="/"){const y=Date.now();p={id:h,parentId:null,name:"",path:"/",type:"folder",createdAt:y,lastModified:y},o([p]),console.log("[VfsStore] Root node added/updated in state.")}return e(y=>{y.rootId=p.id,y.currentParentId=p.id}),console.log(`[VfsStore] Set rootId and currentParentId to: ${p.id}`),await t().fetchNodes(p.id),d}catch(d){const h=`Failed to initialize VFS (${n}): ${d instanceof Error?d.message:String(d)}`;throw console.error(`[VfsStore] ${h}`,d),t().initializingKey===n&&(s(h),a||(l(null),u(null))),new Error(h)}finally{t().initializingKey===n&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:a,_addNodes:i,fs:s,nodes:o,rootId:l,configuredVfsKey:u,vfsKey:d,initializingKey:h}=t();if(!s||u!==d||h){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!s}, Match: ${u===d}, Init: ${h}`);return}r(!0);try{const p=n?o[n]:o[l||""],y=p?p.path:"/";console.log(`[VfsStore] Fetching nodes for path: ${y} (Key: ${u})`);const v=await lT(y,{fsInstance:s});console.log(`[VfsStore] Fetched ${v.length} entries for ${y}`);const b=n??l??"",w=new Set(v.map(k=>k.path)),E=(t().childrenMap[b]||[]).map(k=>t().nodes[k]).filter(Boolean).filter(k=>!w.has(k.path)).map(k=>k.id);E.length>0&&(console.log(`[VfsStore] Removing ${E.length} nodes.`),t()._removeNodes(E));const C=v.map(k=>{const R=Object.values(t().nodes).find(j=>j.path===k.path),O=Date.now();return{id:(R==null?void 0:R.id)||Pi(),parentId:n,name:k.name,path:k.path,type:k.isDirectory?"folder":"file",size:k.size,createdAt:(R==null?void 0:R.createdAt)??O,lastModified:k.lastModified.getTime(),mimeType:k.isDirectory?void 0:k.mimeType}});C.length>0&&(console.log(`[VfsStore] Adding/Updating ${C.length} nodes.`),i(C)),e(k=>{const R=C.map(O=>O.id);(!k.childrenMap[b]||JSON.stringify(k.childrenMap[b].sort())!==JSON.stringify(R.sort()))&&(k.childrenMap[b]=R,console.log(`[VfsStore] Updated childrenMap for parent: ${b}`))})}catch(p){console.error("Failed to fetch VFS nodes:",p),a("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=nr(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const a=t().rootId;return a?t().nodes[a]:void 0}return Object.values(t().nodes).find(a=>a.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:a,rootId:i,fs:s}=t();if(!s||t().vfsKey!==t().configuredVfsKey)return;const o=nr(n),l=r(o);l&&l.type==="folder"?(e(u=>{u.currentParentId=l.id}),t().childrenMap[l.id]||await a(l.id)):o==="/"&&i?(e(u=>{u.currentParentId=i}),t().childrenMap[i]||await a(i)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:a,_setError:i,fs:s,nodes:o,rootId:l,_addNodes:u,configuredVfsKey:d,vfsKey:h}=t();if(!s||d!==h){i("Filesystem not ready.");return}if(!r.trim()){i("Directory name cannot be empty.");return}a(!0);try{const p=n?o[n]:o[l||""],y=p?p.path:"/",v=Ng(y,r.trim());try{throw await s.promises.stat(v),new Error(`"${r.trim()}" already exists.`)}catch(S){if(S.code!=="ENOENT")throw S}await V5(v,{fsInstance:s});const b=Date.now(),x={id:Pi(),parentId:n,name:r.trim(),path:v,type:"folder",createdAt:b,lastModified:b};u([x])}catch(p){console.error("Failed to create directory:",p),i(p.message||"Failed to create directory.")}finally{a(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:a,_setError:i,fs:s,nodes:o,rootId:l,configuredVfsKey:u,vfsKey:d}=t();if(!s||u!==d){i("Filesystem not ready.");return}a(!0);try{const h=n?o[n]:o[l||""],p=h?h.path:"/";await G5(Array.from(r),p,{fsInstance:s}),await t().fetchNodes(n)}catch(h){console.error("Failed to upload files:",h),i("Failed to upload one or more files.")}finally{a(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:a,_removeNodes:i,fs:s,configuredVfsKey:o,vfsKey:l}=t();if(!s||o!==l){a("Filesystem not ready.");return}r(!0);try{const u=n.map(d=>t().nodes[d]).filter(Boolean);for(const d of u)await cT(d.path,d.type==="folder",{fsInstance:s});i(n)}catch(u){console.error("Failed to delete nodes:",u),a("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:a,_setError:i,_updateNode:s,nodes:o,fs:l,rootId:u,configuredVfsKey:d,vfsKey:h}=t();if(!l||d!==h){i("Filesystem not ready.");return}if(!r.trim()){i("Name cannot be empty.");return}const p=o[n];if(!p){i("Item not found.");return}if(p.name!==r.trim()){a(!0);try{const y=p.parentId?o[p.parentId]:o[u||""],v=y?y.path:"/",b=Ng(v,r.trim());try{throw await l.promises.stat(b),new Error(`"${r.trim()}" already exists.`)}catch(x){if(x.code!=="ENOENT")throw x}await W5(p.path,b,{fsInstance:l});const w={name:r.trim(),path:b,lastModified:Date.now()};s(n,w)}catch(y){console.error("Failed to rename item:",y),i(y.message||"Failed to rename item.")}finally{a(!1)}}},downloadFile:async n=>{const{nodes:r,fs:a,_setError:i,configuredVfsKey:s,vfsKey:o}=t();if(!a||s!==o)return i("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return i("File not found."),null;try{const u=await of(l.path,{fsInstance:a}),d=l.mimeType||"application/octet-stream",h=new Blob([u],{type:d});return{name:l.name,blob:h}}catch(u){return console.error("Failed to download file:",u),i("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{const a=r.nodes[n];a&&a.type==="file"&&r.selectedFileIds.add(n)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()})}}))),ii=As(Ns((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await Ft.loadProjects();e({projects:n,isLoading:!1})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1})}},addProject:async n=>{const r=Pi(),a=new Date,i=n.parentId??null,s=i?t().getProjectById(i):null,o=s?s.path:"/",l=Ng(o,n.name),u={id:r,createdAt:a,updatedAt:a,name:n.name,parentId:i,path:l,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,metadata:n.metadata??{}};e(d=>{d.projects.push(u),d.projects.sort((h,p)=>p.updatedAt.getTime()-h.updatedAt.getTime())});try{const d=t().getProjectById(r);if(d)await Ft.saveProject(d),await Xs.getState().initializeVFS(r);else throw new Error("Failed to retrieve newly added project state");return r}catch(d){throw console.error("ProjectStore: Error adding project",d),e(h=>({error:"Failed to save new project",projects:h.projects.filter(p=>p.id!==r)})),d}},updateProject:async(n,r)=>{const a=t().getProjectById(n);if(!a){console.warn(`ProjectStore: Project ${n} not found for update.`);return}let i=a.path;if(r.name&&r.name!==a.name){const o=_0(a.path);i=Ng(o,r.name)}const s={...a,...r,path:i,updatedAt:new Date};e(o=>{const l=o.projects.findIndex(u=>u.id===n);l!==-1&&(o.projects[l]=s,o.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime()))});try{await Ft.saveProject(s)}catch(o){throw console.error("ProjectStore: Error updating project",o),e(l=>{const u=l.projects.findIndex(d=>d.id===n);u!==-1&&(l.projects[u]=a,l.projects.sort((d,h)=>h.updatedAt.getTime()-d.updatedAt.getTime())),l.error="Failed to save project update"}),o}},deleteProject:async n=>{const r=t().getProjectById(n);if(!r)return;const a=t().projects.filter(s=>s.parentId===n).map(s=>s.id),i=[n,...a];e(s=>({projects:s.projects.filter(o=>!i.includes(o.id))})),mn.getState()._unlinkConversationsFromProjects(i);try{await Ft.deleteProject(n),tt.success(`Project "${r.name}" deleted.`)}catch(s){throw console.error("ProjectStore: Error deleting project",s),e(o=>{const l=t().projects.filter(u=>i.includes(u.id)).concat(r);o.projects.push(...l),o.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime()),o.error="Failed to delete project"}),s}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getProjectHierarchy:n=>{const r=[];let a=n;for(;a;){const i=t().getProjectById(a);if(i)r.unshift({id:i.id,name:i.name}),a=i.parentId;else break}return r},getEffectiveProjectSettings:n=>{const r=qr.getState(),a=Fn.getState().selectedModelId;let i=n,s={systemPrompt:null,modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null};for(;i;){const o=t().getProjectById(i);if(o)s.systemPrompt===null&&o.systemPrompt!==null&&o.systemPrompt!==void 0&&(s.systemPrompt=o.systemPrompt),s.modelId===null&&o.modelId!==null&&o.modelId!==void 0&&(s.modelId=o.modelId),s.temperature===null&&o.temperature!==null&&o.temperature!==void 0&&(s.temperature=o.temperature),s.maxTokens===null&&o.maxTokens!==null&&o.maxTokens!==void 0&&(s.maxTokens=o.maxTokens),s.topP===null&&o.topP!==null&&o.topP!==void 0&&(s.topP=o.topP),s.topK===null&&o.topK!==null&&o.topK!==void 0&&(s.topK=o.topK),s.presencePenalty===null&&o.presencePenalty!==null&&o.presencePenalty!==void 0&&(s.presencePenalty=o.presencePenalty),s.frequencyPenalty===null&&o.frequencyPenalty!==null&&o.frequencyPenalty!==void 0&&(s.frequencyPenalty=o.frequencyPenalty),i=o.parentId;else break}return s.systemPrompt===null&&(s.systemPrompt=r.globalSystemPrompt),s.modelId===null&&(s.modelId=a),s.temperature===null&&(s.temperature=r.temperature),s.maxTokens===null&&(s.maxTokens=r.maxTokens),s.topP===null&&(s.topP=r.topP),s.topK===null&&(s.topK=r.topK),s.presencePenalty===null&&(s.presencePenalty=r.presencePenalty),s.frequencyPenalty===null&&(s.frequencyPenalty=r.frequencyPenalty),s}}))),$E=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},que=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${iC(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${iC(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,a)=>r.index-a.index).forEach(r=>{var a,i,s,o,l,u,d,h;((a=r.prompt)!=null&&a.content||(o=(s=(i=r.prompt)==null?void 0:i.metadata)==null?void 0:s.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(p=>{n+=`- ${p.name} (${p.type}, ${Zv(p.size)}) ${p.source==="vfs"?`(VFS: ${p.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(u=r.metadata)!=null&&u.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((d=r.metadata)!=null&&d.promptTokens||(h=r.metadata)!=null&&h.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class zb{static async importConversation(t,n,r){try{const a=await t.text(),i=JSON.parse(a);if(!i||typeof i!="object"||!i.conversation||!Array.isArray(i.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const s=i.conversation,o=i.interactions;if(!s.id||!s.title||!s.createdAt||!s.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:s.title||"Imported Chat",metadata:s.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),u=o.map(d=>Ft.saveInteraction({...d,conversationId:l,id:Pi()}));await Promise.all(u),await r(l,"conversation"),tt.success("Conversation imported successfully.")}catch(a){throw console.error("ImportExportService: Error importing conversation",a),tt.error(`Import failed: ${a instanceof Error?a.message:String(a)}`),a}}static async exportConversation(t,n){try{const r=mn.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const a=await Ft.loadInteractionsForConversation(t);let i,s;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const u=JSON.stringify({conversation:r,interactions:a},null,2);i=new Blob([u],{type:"application/json"}),s=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=que(r,a);i=new Blob([l],{type:"text/markdown"}),s=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");$E(i,s),tt.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),tt.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=ii.getState(),{conversations:a}=mn.getState(),i=r(t);if(!i)throw new Error("Project not found.");const s=async p=>{const y=n.find(x=>x.id===p);if(!y)throw new Error(`Project ${p} not found in state.`);const v=n.filter(x=>x.parentId===p),b=a.filter(x=>x.projectId===p),w=[];for(const x of v)w.push(await s(x.id));for(const x of b){const S=await Ft.loadInteractionsForConversation(x.id);w.push({conversation:x,interactions:S})}return{project:y,children:w}},o=await s(t),l=JSON.stringify(o,null,2),u=new Blob([l],{type:"application/json"}),h=`litechat_project_${i.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;$E(u,h),tt.success(`Project "${i.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),tt.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=mn.getState().conversations,n=[];for(const s of t){const o=await Ft.loadInteractionsForConversation(s.id);n.push({conversation:s,interactions:o})}const r=JSON.stringify(n,null,2),a=new Blob([r],{type:"application/json"}),i=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;$E(a,i),tt.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),tt.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}}const tO="sync_repos",Hue="/synced_repos",mn=As(Ns((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>{console.log("[ConversationStore] Ensuring Sync VFS is ready...");try{const n=await Xs.getState().initializeVFS(tO,{force:!0});return console.log(`[ConversationStore] Sync VFS ready for key ${tO}.`),n}catch(n){throw console.error("[ConversationStore] Failed to ensure Sync VFS:",n),tt.error(`Filesystem error for sync: ${n instanceof Error?n.message:String(n)}`),n}},loadSidebarItems:async()=>{e({isLoading:!0,error:null});try{await ii.getState().loadProjects();const[n,r]=await Promise.all([Ft.loadConversations(),Ft.loadSyncRepos()]),a={};n.forEach(i=>{if(i.syncRepoId){const s=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,o=i.updatedAt instanceof Date?i.updatedAt.getTime():null;s?o&&o>s?a[i.id]="needs-sync":a[i.id]="idle":a[i.id]="needs-sync"}else a[i.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:a,repoInitializationStatus:{},isLoading:!1})}catch(n){console.error("ConversationStore: Error loading sidebar items",n),e({error:"Failed load sidebar items",isLoading:!1})}},addConversation:async n=>{const r=Pi(),a=new Date,i={id:r,createdAt:a,updatedAt:a,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};e(s=>{s.conversations.some(o=>o.id===i.id)||(s.conversations.unshift(i),s.conversationSyncStatus[r]=i.syncRepoId?"needs-sync":"idle")});try{const s=t().getConversationById(r);if(s)await Ft.saveConversation(s),St.emit(_t.CONVERSATION_ADDED,{conversation:s});else throw new Error("Failed to retrieve newly added conversation state");return r}catch(s){throw console.error("ConversationStore: Error adding conversation",s),e(o=>({error:"Failed to save new conversation",conversations:o.conversations.filter(l=>l.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(o.conversationSyncStatus).filter(([l])=>l!==r))})),s}},updateConversation:async(n,r)=>{const a=t().getConversationById(n);if(!a){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(s=>{const o=s.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=s.conversations[o].metadata??{},u=r.metadata??{},d={...l,...u};Object.assign(s.conversations[o],{...r,metadata:d,updatedAt:new Date});const h=["title","metadata","projectId"].some(v=>v in r),p=s.conversations[o].lastSyncedAt instanceof Date?s.conversations[o].lastSyncedAt.getTime():null,y=s.conversations[o].updatedAt.getTime();"syncRepoId"in r?s.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":h&&s.conversations[o].syncRepoId&&s.conversationSyncStatus[n]==="idle"&&(!p||y>p)&&(s.conversationSyncStatus[n]="needs-sync")}});const i=t().getConversationById(n);if(i)try{const s=JSON.parse(JSON.stringify(i));await Ft.saveConversation(s),St.emit(_t.CONVERSATION_UPDATED,{conversationId:n,updates:r})}catch(s){throw console.error("ConversationStore: Error updating conversation",s),e(o=>{const l=o.conversations.findIndex(u=>u.id===n);if(l!==-1){o.conversations[l]=a;const u=a.lastSyncedAt instanceof Date?a.lastSyncedAt.getTime():null,d=a.updatedAt.getTime();o.conversationSyncStatus[n]=a.syncRepoId&&u&&d<=u?"idle":a.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),s}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(s=>{const o=s.conversations.findIndex(l=>l.id===n);if(o!==-1){s.conversations[o]=a;const l=a.lastSyncedAt instanceof Date?a.lastSyncedAt.getTime():null,u=a.updatedAt.getTime();s.conversationSyncStatus[n]=a.syncRepoId&&l&&u<=l?"idle":a.syncRepoId?"needs-sync":"idle"}s.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,a=t().selectedItemType,i=t().conversations.find(s=>s.id===n);if(i){e(s=>({conversations:s.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&a==="conversation"?null:r,selectedItemType:r===n&&a==="conversation"?null:a,conversationSyncStatus:Object.fromEntries(Object.entries(s.conversationSyncStatus).filter(([o])=>o!==n))}));try{await Ft.deleteConversation(n),await Ft.deleteInteractionsForConversation(n),St.emit(_t.CONVERSATION_DELETED,{conversationId:n}),r===n&&a==="conversation"&&(await Zn.getState().setCurrentConversationId(null),St.emit(_t.CONTEXT_CHANGED,{selectedItemId:null,selectedItemType:null}))}catch(s){throw console.error("ConversationStore: Error deleting conversation",s),e(o=>{if(i){o.conversations.push(i);const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,u=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&l&&u<=l?"idle":i.syncRepoId?"needs-sync":"idle"}r===n&&a==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),s}}},selectItem:async(n,r)=>{t().selectedItemId!==n||t().selectedItemType!==r?(e({selectedItemId:n,selectedItemType:r}),await Zn.getState().setCurrentConversationId(r==="conversation"?n:null),St.emit(_t.CONTEXT_CHANGED,{selectedItemId:n,selectedItemType:r}),r==="conversation"?St.emit(_t.CONVERSATION_SELECTED,{conversationId:n}):r==="project"?St.emit(_t.PROJECT_SELECTED,{projectId:n}):(St.emit(_t.CONVERSATION_SELECTED,{conversationId:null}),St.emit(_t.PROJECT_SELECTED,{projectId:null}))):console.log(`Item ${n} (${r}) already selected.`)},importConversation:async n=>{await zb.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await zb.exportConversation(n,r)},exportProject:async n=>{await zb.exportProject(n)},exportAllConversations:async()=>{await zb.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await Ft.loadSyncRepos();e({syncRepos:n,isLoading:!1})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1})}}},addSyncRepo:async n=>{const r=Pi(),a=new Date,i={id:r,createdAt:a,updatedAt:a,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(s=>{s.syncRepos.push(i)});try{const s=t().syncRepos.find(o=>o.id===r);if(s){const o=JSON.parse(JSON.stringify(s));await Ft.saveSyncRepo(o),St.emit(_t.SYNC_REPO_CHANGED,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");return tt.success(`Sync repository "${i.name}" added.`),r}catch(s){throw console.error("ConversationStore: Error adding sync repo",s),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),s}},updateSyncRepo:async(n,r)=>{const a=t().syncRepos.find(s=>s.id===n);if(!a){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(s=>{const o=s.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(s.syncRepos[o],{...r,branch:r.branch||s.syncRepos[o].branch||"main",updatedAt:new Date})});const i=t().syncRepos.find(s=>s.id===n);if(i)try{const s=JSON.parse(JSON.stringify(i));await Ft.saveSyncRepo(s),St.emit(_t.SYNC_REPO_CHANGED,{repoId:n,action:"updated"}),tt.success(`Sync repository "${i.name}" updated.`)}catch(s){throw console.error("ConversationStore: Error updating sync repo",s),e(o=>{const l=o.syncRepos.findIndex(u=>u.id===n);l!==-1&&(o.syncRepos[l]=a),o.error="Failed to save sync repository update"}),s}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(s=>{const o=s.syncRepos.findIndex(l=>l.id===n);o!==-1&&(s.syncRepos[o]=a),s.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(s=>s.id===n);if(!r)return;const a=nr(`${Hue}/${n}`);let i;try{i=await t()._ensureSyncVfsReady()}catch{return}e(s=>({syncRepos:s.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(s.repoInitializationStatus).filter(([o])=>o!==n))}));try{await Ft.deleteSyncRepo(n),St.emit(_t.SYNC_REPO_CHANGED,{repoId:n,action:"deleted"}),tt.success(`Sync repository "${r.name}" deleted.`);try{console.log(`[ConversationStore] Deleting VFS directory: ${a}`),await cT(a,!0,{fsInstance:i}),tt.info(`Removed local sync folder for "${r.name}".`)}catch(s){console.error(`[ConversationStore] Failed to delete VFS directory ${a}:`,s),s.code!=="ENOENT"&&tt.warning(`Failed to remove local sync folder: ${s.message}`)}}catch(s){throw console.error("ConversationStore: Error deleting sync repo",s),e(o=>{r&&o.syncRepos.push(r),o.error="Failed to delete sync repository"}),s}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),tt.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,a=null)=>{e(i=>{i.conversationSyncStatus[n]=r,r==="error"&&a&&console.error(`Sync error for ${n}: ${a}`)}),St.emit(_t.CONVERSATION_SYNC_STATUS_CHANGED,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(a=>{a.repoInitializationStatus[n]=r}),St.emit(_t.REPO_INIT_STATUS_CHANGED,{repoId:n,status:r})},initializeOrSyncRepo:async n=>{const r=t().syncRepos.find(i=>i.id===n);if(!r){tt.error("Sync repsitory configuration not found.");return}let a;try{a=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await zue(a,r,t()._setRepoInitializationStatus)},syncConversation:async n=>{const r=t().getConversationById(n);if(!r){tt.error("Conversation not found for syncing.");return}if(!r.syncRepoId){tt.info("Conversation not linked to a sync repository.");return}const a=t().syncRepos.find(o=>o.id===r.syncRepoId);if(!a){tt.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let i;try{i=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await Uue(i,r,a,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType);const s=t().getConversationById(n);s&&e(o=>{const l=o.conversations.findIndex(u=>u.id===n);l!==-1&&(o.conversations[l]=s)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:a,updateConversation:i}=t();if(a!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const s=t().getConversationById(r);if(!s){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=s.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!s.metadata)&&await i(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(a=>{a.conversations=a.conversations.map(i=>i.projectId&&r.has(i.projectId)?{...i,projectId:null}:i)})}})));function qn({className:e,type:t,...n}){return m.jsx("input",{type:t,"data-slot":"input",className:Nt("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}function Tx(e){const t=e+"CollectionProvider",[n,r]=Si(t),[a,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),s=b=>{const{scope:w,children:x}=b,S=gt.useRef(null),E=gt.useRef(new Map).current;return m.jsx(a,{scope:w,itemMap:E,collectionRef:S,children:x})};s.displayName=t;const o=e+"CollectionSlot",l=eu(o),u=gt.forwardRef((b,w)=>{const{scope:x,children:S}=b,E=i(o,x),C=Cn(w,E.collectionRef);return m.jsx(l,{ref:C,children:S})});u.displayName=o;const d=e+"CollectionItemSlot",h="data-radix-collection-item",p=eu(d),y=gt.forwardRef((b,w)=>{const{scope:x,children:S,...E}=b,C=gt.useRef(null),k=Cn(w,C),R=i(d,x);return gt.useEffect(()=>(R.itemMap.set(C,{ref:C,...E}),()=>void R.itemMap.delete(C))),m.jsx(p,{[h]:"",ref:k,children:S})});y.displayName=d;function v(b){const w=i(e+"CollectionConsumer",b);return gt.useCallback(()=>{const S=w.collectionRef.current;if(!S)return[];const E=Array.from(S.querySelectorAll(`[${h}]`));return Array.from(w.itemMap.values()).sort((R,O)=>E.indexOf(R.ref.current)-E.indexOf(O.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:s,Slot:u,ItemSlot:y},v,r]}var BE=0;function Ax(){T.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??nO()),document.body.insertAdjacentElement("beforeend",e[1]??nO()),BE++,()=>{BE===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),BE--}},[])}function nO(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var zE="focusScope.autoFocusOnMount",UE="focusScope.autoFocusOnUnmount",rO={bubbles:!1,cancelable:!0},Vue="FocusScope",G0=T.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...s}=e,[o,l]=T.useState(null),u=Fa(a),d=Fa(i),h=T.useRef(null),p=Cn(t,b=>l(b)),y=T.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;T.useEffect(()=>{if(r){let b=function(E){if(y.paused||!o)return;const C=E.target;o.contains(C)?h.current=C:Uc(h.current,{select:!0})},w=function(E){if(y.paused||!o)return;const C=E.relatedTarget;C!==null&&(o.contains(C)||Uc(h.current,{select:!0}))},x=function(E){if(document.activeElement===document.body)for(const k of E)k.removedNodes.length>0&&Uc(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",w);const S=new MutationObserver(x);return o&&S.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",w),S.disconnect()}}},[r,o,y.paused]),T.useEffect(()=>{if(o){iO.add(y);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(zE,rO);o.addEventListener(zE,u),o.dispatchEvent(x),x.defaultPrevented||(Gue(Xue(UF(o)),{select:!0}),document.activeElement===b&&Uc(o))}return()=>{o.removeEventListener(zE,u),setTimeout(()=>{const x=new CustomEvent(UE,rO);o.addEventListener(UE,d),o.dispatchEvent(x),x.defaultPrevented||Uc(b??document.body,{select:!0}),o.removeEventListener(UE,d),iO.remove(y)},0)}}},[o,u,d,y]);const v=T.useCallback(b=>{if(!n&&!r||y.paused)return;const w=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(w&&x){const S=b.currentTarget,[E,C]=Wue(S);E&&C?!b.shiftKey&&x===C?(b.preventDefault(),n&&Uc(E,{select:!0})):b.shiftKey&&x===E&&(b.preventDefault(),n&&Uc(C,{select:!0})):x===S&&b.preventDefault()}},[n,r,y.paused]);return m.jsx(rn.div,{tabIndex:-1,...s,ref:p,onKeyDown:v})});G0.displayName=Vue;function Gue(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Uc(r,{select:t}),document.activeElement!==n)return}function Wue(e){const t=UF(e),n=aO(t,e),r=aO(t.reverse(),e);return[n,r]}function UF(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function aO(e,t){for(const n of e)if(!Kue(n,{upTo:t}))return n}function Kue(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Zue(e){return e instanceof HTMLInputElement&&"select"in e}function Uc(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Zue(e)&&t&&e.select()}}var iO=Yue();function Yue(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=sO(e,t),e.unshift(t)},remove(t){var n;e=sO(e,t),(n=e[0])==null||n.resume()}}}function sO(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Xue(e){return e.filter(t=>t.tagName!=="A")}function Nx(e){const t=T.useRef({value:e,previous:e});return T.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Jue=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ih=new WeakMap,Ub=new WeakMap,qb={},qE=0,qF=function(e){return e&&(e.host||qF(e.parentNode))},Que=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=qF(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},ede=function(e,t,n,r){var a=Que(t,Array.isArray(e)?e:[e]);qb[n]||(qb[n]=new WeakMap);var i=qb[n],s=[],o=new Set,l=new Set(a),u=function(h){!h||o.has(h)||(o.add(h),u(h.parentNode))};a.forEach(u);var d=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(p){if(o.has(p))d(p);else try{var y=p.getAttribute(r),v=y!==null&&y!=="false",b=(ih.get(p)||0)+1,w=(i.get(p)||0)+1;ih.set(p,b),i.set(p,w),s.push(p),b===1&&v&&Ub.set(p,!0),w===1&&p.setAttribute(n,"true"),v||p.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",p,x)}})};return d(t),o.clear(),qE++,function(){s.forEach(function(h){var p=ih.get(h)-1,y=i.get(h)-1;ih.set(h,p),i.set(h,y),p||(Ub.has(h)||h.removeAttribute(r),Ub.delete(h)),y||h.removeAttribute(n)}),qE--,qE||(ih=new WeakMap,ih=new WeakMap,Ub=new WeakMap,qb={})}},Rx=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=Jue(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),ede(r,a,n,"aria-hidden")):function(){return null}},Lo=function(){return Lo=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Lo.apply(this,arguments)};function HF(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function tde(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var ov="right-scroll-bar-position",lv="width-before-scroll-bar",nde="with-scroll-bars-hidden",rde="--removed-body-scroll-bar-size";function HE(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function ade(e,t){var n=T.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var ide=typeof window<"u"?T.useLayoutEffect:T.useEffect,oO=new WeakMap;function sde(e,t){var n=ade(null,function(r){return e.forEach(function(a){return HE(a,r)})});return ide(function(){var r=oO.get(n);if(r){var a=new Set(r),i=new Set(e),s=n.current;a.forEach(function(o){i.has(o)||HE(o,null)}),i.forEach(function(o){a.has(o)||HE(o,s)})}oO.set(n,e)},[e]),n}function ode(e){return e}function lde(e,t){t===void 0&&(t=ode);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var s=t(i,r);return n.push(s),function(){n=n.filter(function(o){return o!==s})}},assignSyncMedium:function(i){for(r=!0;n.length;){var s=n;n=[],s.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var s=[];if(n.length){var o=n;n=[],o.forEach(i),s=n}var l=function(){var d=s;s=[],d.forEach(i)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(d){s.push(d),u()},filter:function(d){return s=s.filter(d),n}}}};return a}function cde(e){e===void 0&&(e={});var t=lde(null);return t.options=Lo({async:!0,ssr:!1},e),t}var VF=function(e){var t=e.sideCar,n=HF(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return T.createElement(r,Lo({},n))};VF.isSideCarExport=!0;function ude(e,t){return e.useMedium(t),VF}var GF=cde(),VE=function(){},Ix=T.forwardRef(function(e,t){var n=T.useRef(null),r=T.useState({onScrollCapture:VE,onWheelCapture:VE,onTouchMoveCapture:VE}),a=r[0],i=r[1],s=e.forwardProps,o=e.children,l=e.className,u=e.removeScrollBar,d=e.enabled,h=e.shards,p=e.sideCar,y=e.noIsolation,v=e.inert,b=e.allowPinchZoom,w=e.as,x=w===void 0?"div":w,S=e.gapMode,E=HF(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=p,k=sde([n,t]),R=Lo(Lo({},E),a);return T.createElement(T.Fragment,null,d&&T.createElement(C,{sideCar:GF,removeScrollBar:u,shards:h,noIsolation:y,inert:v,setCallbacks:i,allowPinchZoom:!!b,lockRef:n,gapMode:S}),s?T.cloneElement(T.Children.only(o),Lo(Lo({},R),{ref:k})):T.createElement(x,Lo({},R,{className:l,ref:k}),o))});Ix.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ix.classNames={fullWidth:lv,zeroRight:ov};var dde=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function fde(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=dde();return t&&e.setAttribute("nonce",t),e}function hde(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function pde(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var mde=function(){var e=0,t=null;return{add:function(n){e==0&&(t=fde())&&(hde(t,n),pde(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},gde=function(){var e=mde();return function(t,n){T.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},WF=function(){var e=gde(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},yde={left:0,top:0,right:0,gap:0},GE=function(e){return parseInt(e||"",10)||0},bde=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[GE(n),GE(r),GE(a)]},vde=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return yde;var t=bde(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},wde=WF(),Sh="data-scroll-locked",xde=function(e,t,n,r){var a=e.left,i=e.top,s=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(nde,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(Sh,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ov,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(lv,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(ov," .").concat(ov,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(lv," .").concat(lv,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Sh,`] {
    `).concat(rde,": ").concat(o,`px;
  }
`)},lO=function(){var e=parseInt(document.body.getAttribute(Sh)||"0",10);return isFinite(e)?e:0},_de=function(){T.useEffect(function(){return document.body.setAttribute(Sh,(lO()+1).toString()),function(){var e=lO()-1;e<=0?document.body.removeAttribute(Sh):document.body.setAttribute(Sh,e.toString())}},[])},Sde=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;_de();var i=T.useMemo(function(){return vde(a)},[a]);return T.createElement(wde,{styles:xde(i,!t,a,n?"":"!important")})},uC=!1;if(typeof window<"u")try{var Hb=Object.defineProperty({},"passive",{get:function(){return uC=!0,!0}});window.addEventListener("test",Hb,Hb),window.removeEventListener("test",Hb,Hb)}catch{uC=!1}var sh=uC?{passive:!1}:!1,Ede=function(e){return e.tagName==="TEXTAREA"},KF=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Ede(e)&&n[t]==="visible")},Cde=function(e){return KF(e,"overflowY")},kde=function(e){return KF(e,"overflowX")},cO=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=ZF(e,r);if(a){var i=YF(e,r),s=i[1],o=i[2];if(s>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Tde=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Ade=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},ZF=function(e,t){return e==="v"?Cde(t):kde(t)},YF=function(e,t){return e==="v"?Tde(t):Ade(t)},Nde=function(e,t){return e==="h"&&t==="rtl"?-1:1},Rde=function(e,t,n,r,a){var i=Nde(e,window.getComputedStyle(t).direction),s=i*r,o=n.target,l=t.contains(o),u=!1,d=s>0,h=0,p=0;do{var y=YF(e,o),v=y[0],b=y[1],w=y[2],x=b-w-i*v;(v||x)&&ZF(e,o)&&(h+=x,p+=v),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(d&&Math.abs(h)<1||!d&&Math.abs(p)<1)&&(u=!0),u},Vb=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},uO=function(e){return[e.deltaX,e.deltaY]},dO=function(e){return e&&"current"in e?e.current:e},Ide=function(e,t){return e[0]===t[0]&&e[1]===t[1]},jde=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Ode=0,oh=[];function Dde(e){var t=T.useRef([]),n=T.useRef([0,0]),r=T.useRef(),a=T.useState(Ode++)[0],i=T.useState(WF)[0],s=T.useRef(e);T.useEffect(function(){s.current=e},[e]),T.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var b=tde([e.lockRef.current],(e.shards||[]).map(dO),!0).filter(Boolean);return b.forEach(function(w){return w.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),b.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var o=T.useCallback(function(b,w){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!s.current.allowPinchZoom;var x=Vb(b),S=n.current,E="deltaX"in b?b.deltaX:S[0]-x[0],C="deltaY"in b?b.deltaY:S[1]-x[1],k,R=b.target,O=Math.abs(E)>Math.abs(C)?"h":"v";if("touches"in b&&O==="h"&&R.type==="range")return!1;var j=cO(O,R);if(!j)return!0;if(j?k=O:(k=O==="v"?"h":"v",j=cO(O,R)),!j)return!1;if(!r.current&&"changedTouches"in b&&(E||C)&&(r.current=k),!k)return!0;var $=r.current||k;return Rde($,w,b,$==="h"?E:C)},[]),l=T.useCallback(function(b){var w=b;if(!(!oh.length||oh[oh.length-1]!==i)){var x="deltaY"in w?uO(w):Vb(w),S=t.current.filter(function(k){return k.name===w.type&&(k.target===w.target||w.target===k.shadowParent)&&Ide(k.delta,x)})[0];if(S&&S.should){w.cancelable&&w.preventDefault();return}if(!S){var E=(s.current.shards||[]).map(dO).filter(Boolean).filter(function(k){return k.contains(w.target)}),C=E.length>0?o(w,E[0]):!s.current.noIsolation;C&&w.cancelable&&w.preventDefault()}}},[]),u=T.useCallback(function(b,w,x,S){var E={name:b,delta:w,target:x,should:S,shadowParent:Mde(x)};t.current.push(E),setTimeout(function(){t.current=t.current.filter(function(C){return C!==E})},1)},[]),d=T.useCallback(function(b){n.current=Vb(b),r.current=void 0},[]),h=T.useCallback(function(b){u(b.type,uO(b),b.target,o(b,e.lockRef.current))},[]),p=T.useCallback(function(b){u(b.type,Vb(b),b.target,o(b,e.lockRef.current))},[]);T.useEffect(function(){return oh.push(i),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:p}),document.addEventListener("wheel",l,sh),document.addEventListener("touchmove",l,sh),document.addEventListener("touchstart",d,sh),function(){oh=oh.filter(function(b){return b!==i}),document.removeEventListener("wheel",l,sh),document.removeEventListener("touchmove",l,sh),document.removeEventListener("touchstart",d,sh)}},[]);var y=e.removeScrollBar,v=e.inert;return T.createElement(T.Fragment,null,v?T.createElement(i,{styles:jde(a)}):null,y?T.createElement(Sde,{gapMode:e.gapMode}):null)}function Mde(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Pde=ude(GF,Dde);var W0=T.forwardRef(function(e,t){return T.createElement(Ix,Lo({},e,{ref:t,sideCar:Pde}))});W0.classNames=Ix.classNames;var Fde=[" ","Enter","ArrowUp","ArrowDown"],Lde=[" ","Enter"],Ld="Select",[jx,Ox,$de]=Tx(Ld),[vp,o_e]=Si(Ld,[$de,wu]),Dx=wu(),[Bde,Nu]=vp(Ld),[zde,Ude]=vp(Ld),XF=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:i,value:s,defaultValue:o,onValueChange:l,dir:u,name:d,autoComplete:h,disabled:p,required:y,form:v}=e,b=Dx(t),[w,x]=T.useState(null),[S,E]=T.useState(null),[C,k]=T.useState(!1),R=bp(u),[O,j]=no({prop:r,defaultProp:a??!1,onChange:i,caller:Ld}),[$,L]=no({prop:s,defaultProp:o,onChange:l,caller:Ld}),X=T.useRef(null),F=w?v||!!w.closest("form"):!0,[K,q]=T.useState(new Set),de=Array.from(K).map(re=>re.props.value).join(";");return m.jsx(Hw,{...b,children:m.jsxs(Bde,{required:y,scope:t,trigger:w,onTriggerChange:x,valueNode:S,onValueNodeChange:E,valueNodeHasChildren:C,onValueNodeHasChildrenChange:k,contentId:Ya(),value:$,onValueChange:L,open:O,onOpenChange:j,dir:R,triggerPointerDownPosRef:X,disabled:p,children:[m.jsx(jx.Provider,{scope:t,children:m.jsx(zde,{scope:e.__scopeSelect,onNativeOptionAdd:T.useCallback(re=>{q(Y=>new Set(Y).add(re))},[]),onNativeOptionRemove:T.useCallback(re=>{q(Y=>{const Q=new Set(Y);return Q.delete(re),Q})},[]),children:n})}),F?m.jsxs(vL,{"aria-hidden":!0,required:y,tabIndex:-1,name:d,autoComplete:h,value:$,onChange:re=>L(re.target.value),disabled:p,form:v,children:[$===void 0?m.jsx("option",{value:""}):null,Array.from(K)]},de):null]})})};XF.displayName=Ld;var JF="SelectTrigger",QF=T.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,i=Dx(n),s=Nu(JF,n),o=s.disabled||r,l=Cn(t,s.onTriggerChange),u=Ox(n),d=T.useRef("touch"),[h,p,y]=xL(b=>{const w=u().filter(E=>!E.disabled),x=w.find(E=>E.value===s.value),S=_L(w,b,x);S!==void 0&&s.onValueChange(S.value)}),v=b=>{o||(s.onOpenChange(!0),y()),b&&(s.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return m.jsx(f0,{asChild:!0,...i,children:m.jsx(rn.button,{type:"button",role:"combobox","aria-controls":s.contentId,"aria-expanded":s.open,"aria-required":s.required,"aria-autocomplete":"none",dir:s.dir,"data-state":s.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":wL(s.value)?"":void 0,...a,ref:l,onClick:Vt(a.onClick,b=>{b.currentTarget.focus(),d.current!=="mouse"&&v(b)}),onPointerDown:Vt(a.onPointerDown,b=>{d.current=b.pointerType;const w=b.target;w.hasPointerCapture(b.pointerId)&&w.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(v(b),b.preventDefault())}),onKeyDown:Vt(a.onKeyDown,b=>{const w=h.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&p(b.key),!(w&&b.key===" ")&&Fde.includes(b.key)&&(v(),b.preventDefault())})})})});QF.displayName=JF;var eL="SelectValue",tL=T.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:i,placeholder:s="",...o}=e,l=Nu(eL,n),{onValueNodeHasChildrenChange:u}=l,d=i!==void 0,h=Cn(t,l.onValueNodeChange);return za(()=>{u(d)},[u,d]),m.jsx(rn.span,{...o,ref:h,style:{pointerEvents:"none"},children:wL(l.value)?m.jsx(m.Fragment,{children:s}):i})});tL.displayName=eL;var qde="SelectIcon",nL=T.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return m.jsx(rn.span,{"aria-hidden":!0,...a,ref:t,children:r||""})});nL.displayName=qde;var Hde="SelectPortal",rL=e=>m.jsx(rp,{asChild:!0,...e});rL.displayName=Hde;var $d="SelectContent",aL=T.forwardRef((e,t)=>{const n=Nu($d,e.__scopeSelect),[r,a]=T.useState();if(za(()=>{a(new DocumentFragment)},[]),!n.open){const i=r;return i?$o.createPortal(m.jsx(iL,{scope:e.__scopeSelect,children:m.jsx(jx.Slot,{scope:e.__scopeSelect,children:m.jsx("div",{children:e.children})})}),i):null}return m.jsx(sL,{...e,ref:t})});aL.displayName=$d;var Us=10,[iL,Ru]=vp($d),Vde="SelectContentImpl",Gde=eu("SelectContent.RemoveScroll"),sL=T.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:s,side:o,sideOffset:l,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:p,collisionPadding:y,sticky:v,hideWhenDetached:b,avoidCollisions:w,...x}=e,S=Nu($d,n),[E,C]=T.useState(null),[k,R]=T.useState(null),O=Cn(t,Ne=>C(Ne)),[j,$]=T.useState(null),[L,X]=T.useState(null),F=Ox(n),[K,q]=T.useState(!1),de=T.useRef(!1);T.useEffect(()=>{if(E)return Rx(E)},[E]),Ax();const re=T.useCallback(Ne=>{const[Re,...ke]=F().map(Le=>Le.ref.current),[Fe]=ke.slice(-1),Qe=document.activeElement;for(const Le of Ne)if(Le===Qe||(Le==null||Le.scrollIntoView({block:"nearest"}),Le===Re&&k&&(k.scrollTop=0),Le===Fe&&k&&(k.scrollTop=k.scrollHeight),Le==null||Le.focus(),document.activeElement!==Qe))return},[F,k]),Y=T.useCallback(()=>re([j,E]),[re,j,E]);T.useEffect(()=>{K&&Y()},[K,Y]);const{onOpenChange:Q,triggerPointerDownPosRef:ae}=S;T.useEffect(()=>{if(E){let Ne={x:0,y:0};const Re=Fe=>{var Qe,Le;Ne={x:Math.abs(Math.round(Fe.pageX)-(((Qe=ae.current)==null?void 0:Qe.x)??0)),y:Math.abs(Math.round(Fe.pageY)-(((Le=ae.current)==null?void 0:Le.y)??0))}},ke=Fe=>{Ne.x<=10&&Ne.y<=10?Fe.preventDefault():E.contains(Fe.target)||Q(!1),document.removeEventListener("pointermove",Re),ae.current=null};return ae.current!==null&&(document.addEventListener("pointermove",Re),document.addEventListener("pointerup",ke,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Re),document.removeEventListener("pointerup",ke,{capture:!0})}}},[E,Q,ae]),T.useEffect(()=>{const Ne=()=>Q(!1);return window.addEventListener("blur",Ne),window.addEventListener("resize",Ne),()=>{window.removeEventListener("blur",Ne),window.removeEventListener("resize",Ne)}},[Q]);const[B,J]=xL(Ne=>{const Re=F().filter(Qe=>!Qe.disabled),ke=Re.find(Qe=>Qe.ref.current===document.activeElement),Fe=_L(Re,Ne,ke);Fe&&setTimeout(()=>Fe.ref.current.focus())}),ee=T.useCallback((Ne,Re,ke)=>{const Fe=!de.current&&!ke;(S.value!==void 0&&S.value===Re||Fe)&&($(Ne),Fe&&(de.current=!0))},[S.value]),oe=T.useCallback(()=>E==null?void 0:E.focus(),[E]),me=T.useCallback((Ne,Re,ke)=>{const Fe=!de.current&&!ke;(S.value!==void 0&&S.value===Re||Fe)&&X(Ne)},[S.value]),xe=r==="popper"?dC:oL,Pe=xe===dC?{side:o,sideOffset:l,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:p,collisionPadding:y,sticky:v,hideWhenDetached:b,avoidCollisions:w}:{};return m.jsx(iL,{scope:n,content:E,viewport:k,onViewportChange:R,itemRefCallback:ee,selectedItem:j,onItemLeave:oe,itemTextRefCallback:me,focusSelectedItem:Y,selectedItemText:L,position:r,isPositioned:K,searchRef:B,children:m.jsx(W0,{as:Gde,allowPinchZoom:!0,children:m.jsx(G0,{asChild:!0,trapped:S.open,onMountAutoFocus:Ne=>{Ne.preventDefault()},onUnmountAutoFocus:Vt(a,Ne=>{var Re;(Re=S.trigger)==null||Re.focus({preventScroll:!0}),Ne.preventDefault()}),children:m.jsx(ep,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:Ne=>Ne.preventDefault(),onDismiss:()=>S.onOpenChange(!1),children:m.jsx(xe,{role:"listbox",id:S.contentId,"data-state":S.open?"open":"closed",dir:S.dir,onContextMenu:Ne=>Ne.preventDefault(),...x,...Pe,onPlaced:()=>q(!0),ref:O,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Vt(x.onKeyDown,Ne=>{const Re=Ne.ctrlKey||Ne.altKey||Ne.metaKey;if(Ne.key==="Tab"&&Ne.preventDefault(),!Re&&Ne.key.length===1&&J(Ne.key),["ArrowUp","ArrowDown","Home","End"].includes(Ne.key)){let Fe=F().filter(Qe=>!Qe.disabled).map(Qe=>Qe.ref.current);if(["ArrowUp","End"].includes(Ne.key)&&(Fe=Fe.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ne.key)){const Qe=Ne.target,Le=Fe.indexOf(Qe);Fe=Fe.slice(Le+1)}setTimeout(()=>re(Fe)),Ne.preventDefault()}})})})})})})});sL.displayName=Vde;var Wde="SelectItemAlignedPosition",oL=T.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,i=Nu($d,n),s=Ru($d,n),[o,l]=T.useState(null),[u,d]=T.useState(null),h=Cn(t,O=>d(O)),p=Ox(n),y=T.useRef(!1),v=T.useRef(!0),{viewport:b,selectedItem:w,selectedItemText:x,focusSelectedItem:S}=s,E=T.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&u&&b&&w&&x){const O=i.trigger.getBoundingClientRect(),j=u.getBoundingClientRect(),$=i.valueNode.getBoundingClientRect(),L=x.getBoundingClientRect();if(i.dir!=="rtl"){const Qe=L.left-j.left,Le=$.left-Qe,Ie=O.left-Le,V=O.width+Ie,ge=Math.max(V,j.width),Te=window.innerWidth-Us,le=qg(Le,[Us,Math.max(Us,Te-ge)]);o.style.minWidth=V+"px",o.style.left=le+"px"}else{const Qe=j.right-L.right,Le=window.innerWidth-$.right-Qe,Ie=window.innerWidth-O.right-Le,V=O.width+Ie,ge=Math.max(V,j.width),Te=window.innerWidth-Us,le=qg(Le,[Us,Math.max(Us,Te-ge)]);o.style.minWidth=V+"px",o.style.right=le+"px"}const X=p(),F=window.innerHeight-Us*2,K=b.scrollHeight,q=window.getComputedStyle(u),de=parseInt(q.borderTopWidth,10),re=parseInt(q.paddingTop,10),Y=parseInt(q.borderBottomWidth,10),Q=parseInt(q.paddingBottom,10),ae=de+re+K+Q+Y,B=Math.min(w.offsetHeight*5,ae),J=window.getComputedStyle(b),ee=parseInt(J.paddingTop,10),oe=parseInt(J.paddingBottom,10),me=O.top+O.height/2-Us,xe=F-me,Pe=w.offsetHeight/2,Ne=w.offsetTop+Pe,Re=de+re+Ne,ke=ae-Re;if(Re<=me){const Qe=X.length>0&&w===X[X.length-1].ref.current;o.style.bottom="0px";const Le=u.clientHeight-b.offsetTop-b.offsetHeight,Ie=Math.max(xe,Pe+(Qe?oe:0)+Le+Y),V=Re+Ie;o.style.height=V+"px"}else{const Qe=X.length>0&&w===X[0].ref.current;o.style.top="0px";const Ie=Math.max(me,de+b.offsetTop+(Qe?ee:0)+Pe)+ke;o.style.height=Ie+"px",b.scrollTop=Re-me+b.offsetTop}o.style.margin=`${Us}px 0`,o.style.minHeight=B+"px",o.style.maxHeight=F+"px",r==null||r(),requestAnimationFrame(()=>y.current=!0)}},[p,i.trigger,i.valueNode,o,u,b,w,x,i.dir,r]);za(()=>E(),[E]);const[C,k]=T.useState();za(()=>{u&&k(window.getComputedStyle(u).zIndex)},[u]);const R=T.useCallback(O=>{O&&v.current===!0&&(E(),S==null||S(),v.current=!1)},[E,S]);return m.jsx(Zde,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:y,onScrollButtonChange:R,children:m.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C},children:m.jsx(rn.div,{...a,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});oL.displayName=Wde;var Kde="SelectPopperPosition",dC=T.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=Us,...i}=e,s=Dx(n);return m.jsx(Vw,{...s,...i,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});dC.displayName=Kde;var[Zde,_T]=vp($d,{}),fC="SelectViewport",lL=T.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,i=Ru(fC,n),s=_T(fC,n),o=Cn(t,i.onViewportChange),l=T.useRef(0);return m.jsxs(m.Fragment,{children:[m.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),m.jsx(jx.Slot,{scope:n,children:m.jsx(rn.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Vt(a.onScroll,u=>{const d=u.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:p}=s;if(p!=null&&p.current&&h){const y=Math.abs(l.current-d.scrollTop);if(y>0){const v=window.innerHeight-Us*2,b=parseFloat(h.style.minHeight),w=parseFloat(h.style.height),x=Math.max(b,w);if(x<v){const S=x+y,E=Math.min(v,S),C=S-E;h.style.height=E+"px",h.style.bottom==="0px"&&(d.scrollTop=C>0?C:0,h.style.justifyContent="flex-end")}}}l.current=d.scrollTop})})})]})});lL.displayName=fC;var cL="SelectGroup",[Yde,Xde]=vp(cL),Jde=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Ya();return m.jsx(Yde,{scope:n,id:a,children:m.jsx(rn.div,{role:"group","aria-labelledby":a,...r,ref:t})})});Jde.displayName=cL;var uL="SelectLabel",Qde=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Xde(uL,n);return m.jsx(rn.div,{id:a.id,...r,ref:t})});Qde.displayName=uL;var fw="SelectItem",[efe,dL]=vp(fw),fL=T.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:i,...s}=e,o=Nu(fw,n),l=Ru(fw,n),u=o.value===r,[d,h]=T.useState(i??""),[p,y]=T.useState(!1),v=Cn(t,S=>{var E;return(E=l.itemRefCallback)==null?void 0:E.call(l,S,r,a)}),b=Ya(),w=T.useRef("touch"),x=()=>{a||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return m.jsx(efe,{scope:n,value:r,disabled:a,textId:b,isSelected:u,onItemTextChange:T.useCallback(S=>{h(E=>E||((S==null?void 0:S.textContent)??"").trim())},[]),children:m.jsx(jx.ItemSlot,{scope:n,value:r,disabled:a,textValue:d,children:m.jsx(rn.div,{role:"option","aria-labelledby":b,"data-highlighted":p?"":void 0,"aria-selected":u&&p,"data-state":u?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...s,ref:v,onFocus:Vt(s.onFocus,()=>y(!0)),onBlur:Vt(s.onBlur,()=>y(!1)),onClick:Vt(s.onClick,()=>{w.current!=="mouse"&&x()}),onPointerUp:Vt(s.onPointerUp,()=>{w.current==="mouse"&&x()}),onPointerDown:Vt(s.onPointerDown,S=>{w.current=S.pointerType}),onPointerMove:Vt(s.onPointerMove,S=>{var E;w.current=S.pointerType,a?(E=l.onItemLeave)==null||E.call(l):w.current==="mouse"&&S.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Vt(s.onPointerLeave,S=>{var E;S.currentTarget===document.activeElement&&((E=l.onItemLeave)==null||E.call(l))}),onKeyDown:Vt(s.onKeyDown,S=>{var C;((C=l.searchRef)==null?void 0:C.current)!==""&&S.key===" "||(Lde.includes(S.key)&&x(),S.key===" "&&S.preventDefault())})})})})});fL.displayName=fw;var Hm="SelectItemText",hL=T.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...i}=e,s=Nu(Hm,n),o=Ru(Hm,n),l=dL(Hm,n),u=Ude(Hm,n),[d,h]=T.useState(null),p=Cn(t,x=>h(x),l.onItemTextChange,x=>{var S;return(S=o.itemTextRefCallback)==null?void 0:S.call(o,x,l.value,l.disabled)}),y=d==null?void 0:d.textContent,v=T.useMemo(()=>m.jsx("option",{value:l.value,disabled:l.disabled,children:y},l.value),[l.disabled,l.value,y]),{onNativeOptionAdd:b,onNativeOptionRemove:w}=u;return za(()=>(b(v),()=>w(v)),[b,w,v]),m.jsxs(m.Fragment,{children:[m.jsx(rn.span,{id:l.textId,...i,ref:p}),l.isSelected&&s.valueNode&&!s.valueNodeHasChildren?$o.createPortal(i.children,s.valueNode):null]})});hL.displayName=Hm;var pL="SelectItemIndicator",mL=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return dL(pL,n).isSelected?m.jsx(rn.span,{"aria-hidden":!0,...r,ref:t}):null});mL.displayName=pL;var hC="SelectScrollUpButton",gL=T.forwardRef((e,t)=>{const n=Ru(hC,e.__scopeSelect),r=_T(hC,e.__scopeSelect),[a,i]=T.useState(!1),s=Cn(t,r.onScrollButtonChange);return za(()=>{if(n.viewport&&n.isPositioned){let o=function(){const u=l.scrollTop>0;i(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),a?m.jsx(bL,{...e,ref:s,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});gL.displayName=hC;var pC="SelectScrollDownButton",yL=T.forwardRef((e,t)=>{const n=Ru(pC,e.__scopeSelect),r=_T(pC,e.__scopeSelect),[a,i]=T.useState(!1),s=Cn(t,r.onScrollButtonChange);return za(()=>{if(n.viewport&&n.isPositioned){let o=function(){const u=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<u;i(d)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),a?m.jsx(bL,{...e,ref:s,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});yL.displayName=pC;var bL=T.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,i=Ru("SelectScrollButton",n),s=T.useRef(null),o=Ox(n),l=T.useCallback(()=>{s.current!==null&&(window.clearInterval(s.current),s.current=null)},[]);return T.useEffect(()=>()=>l(),[l]),za(()=>{var d;const u=o().find(h=>h.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[o]),m.jsx(rn.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Vt(a.onPointerDown,()=>{s.current===null&&(s.current=window.setInterval(r,50))}),onPointerMove:Vt(a.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),s.current===null&&(s.current=window.setInterval(r,50))}),onPointerLeave:Vt(a.onPointerLeave,()=>{l()})})}),tfe="SelectSeparator",nfe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return m.jsx(rn.div,{"aria-hidden":!0,...r,ref:t})});nfe.displayName=tfe;var mC="SelectArrow",rfe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Dx(n),i=Nu(mC,n),s=Ru(mC,n);return i.open&&s.position==="popper"?m.jsx(Gw,{...a,...r,ref:t}):null});rfe.displayName=mC;var afe="SelectBubbleInput",vL=T.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const a=T.useRef(null),i=Cn(r,a),s=Nx(t);return T.useEffect(()=>{const o=a.current;if(!o)return;const l=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(l,"value").set;if(s!==t&&d){const h=new Event("change",{bubbles:!0});d.call(o,t),o.dispatchEvent(h)}},[s,t]),m.jsx(rn.select,{...n,style:{...A8,...n.style},ref:i,defaultValue:t})});vL.displayName=afe;function wL(e){return e===""||e===void 0}function xL(e){const t=Fa(e),n=T.useRef(""),r=T.useRef(0),a=T.useCallback(s=>{const o=n.current+s;t(o),function l(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),i=T.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return T.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,i]}function _L(e,t,n){const a=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let s=ife(e,Math.max(i,0));a.length===1&&(s=s.filter(u=>u!==n));const l=s.find(u=>u.textValue.toLowerCase().startsWith(a.toLowerCase()));return l!==n?l:void 0}function ife(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var sfe=XF,ofe=QF,lfe=tL,cfe=nL,ufe=rL,dfe=aL,ffe=lL,hfe=fL,pfe=hL,mfe=mL,gfe=gL,yfe=yL;function Iu({...e}){return m.jsx(sfe,{"data-slot":"select",...e})}function ju({...e}){return m.jsx(lfe,{"data-slot":"select-value",...e})}function Ou({className:e,size:t="default",children:n,...r}){return m.jsxs(ofe,{"data-slot":"select-trigger","data-size":t,className:Nt("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,m.jsx(cfe,{asChild:!0,children:m.jsx(Yo,{className:"size-4 opacity-50"})})]})}function Du({className:e,children:t,position:n="popper",...r}){return m.jsx(ufe,{children:m.jsxs(dfe,{"data-slot":"select-content",className:Nt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[m.jsx(bfe,{}),m.jsx(ffe,{className:Nt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),m.jsx(vfe,{})]})})}function Za({className:e,children:t,...n}){return m.jsxs(hfe,{"data-slot":"select-item",className:Nt("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[m.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:m.jsx(mfe,{children:m.jsx(so,{className:"size-4"})})}),m.jsx(pfe,{children:t})]})}function bfe({className:e,...t}){return m.jsx(gfe,{"data-slot":"select-scroll-up-button",className:Nt("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(qd,{className:"size-4"})})}function vfe({className:e,...t}){return m.jsx(yfe,{"data-slot":"select-scroll-down-button",className:Nt("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(Yo,{className:"size-4"})})}var wfe="Label",SL=T.forwardRef((e,t)=>m.jsx(rn.label,{...e,ref:t,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));SL.displayName=wfe;var xfe=SL;function en({className:e,...t}){return m.jsx(xfe,{"data-slot":"label",className:Nt("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const EL=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:a,isSaving:i,className:s})=>{const[o,l]=T.useState(t),[u,d]=T.useState(n),[h,p]=T.useState(e),y=T.useRef(null);T.useEffect(()=>{l(t),d(n),p(e)},[t,n,e]);const v=T.useCallback(w=>{var C,k;const x=w;p(x);const S=(C=Td.find(R=>R.value===x))==null?void 0:C.label,E=(k=Td.find(R=>R.value===h))==null?void 0:k.label;S&&(!o.trim()||o===`${E}`)&&l(`${S}`),requestAnimationFrame(()=>{var R;(R=y.current)==null||R.focus()})},[o,h]),b=T.useCallback(async()=>{if(!o.trim()||!u.trim()||!h){tt.error("Key Name, Provider Type, and API Key Value are required.");return}await r(o.trim(),h,u.trim())},[o,u,h,r]);return m.jsxs("div",{className:Nt("space-y-4",s),children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"api-key-provider",children:"Provider Type"}),m.jsxs(Iu,{value:h??"",onValueChange:v,disabled:i,children:[m.jsx(Ou,{id:"api-key-provider",children:m.jsx(ju,{placeholder:"Select Provider Type"})}),m.jsx(Du,{children:Td.map(w=>m.jsx(Za,{value:w.value,children:w.label},w.value))})]})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"api-key-name",children:"Key Name"}),m.jsx(qn,{id:"api-key-name",value:o,onChange:w=>l(w.target.value),placeholder:"e.g., My OpenAI Key",required:!0,disabled:i})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"api-key-value",children:"API Key Value"}),m.jsx(qn,{ref:y,id:"api-key-value",type:"password",value:u,onChange:w=>d(w.target.value),placeholder:"Enter your API key",required:!0,disabled:i,autoComplete:"new-password"})]})]}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Mt,{variant:"ghost",size:"sm",onClick:a,disabled:i,type:"button",children:[m.jsx(Ts,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsxs(Mt,{variant:"secondary",size:"sm",onClick:b,disabled:i||!o.trim()||!u.trim()||!h,type:"button",children:[i&&m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(Vd,{className:"h-4 w-4 mr-1"})," ",i?"Saving...":"Save API Key"]})]})]})};var Mx="Switch",[_fe,l_e]=Si(Mx),[Sfe,Efe]=_fe(Mx),CL=T.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:a,defaultChecked:i,required:s,disabled:o,value:l="on",onCheckedChange:u,form:d,...h}=e,[p,y]=T.useState(null),v=Cn(t,E=>y(E)),b=T.useRef(!1),w=p?d||!!p.closest("form"):!0,[x,S]=no({prop:a,defaultProp:i??!1,onChange:u,caller:Mx});return m.jsxs(Sfe,{scope:n,checked:x,disabled:o,children:[m.jsx(rn.button,{type:"button",role:"switch","aria-checked":x,"aria-required":s,"data-state":NL(x),"data-disabled":o?"":void 0,disabled:o,value:l,...h,ref:v,onClick:Vt(e.onClick,E=>{S(C=>!C),w&&(b.current=E.isPropagationStopped(),b.current||E.stopPropagation())})}),w&&m.jsx(AL,{control:p,bubbles:!b.current,name:r,value:l,checked:x,required:s,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});CL.displayName=Mx;var kL="SwitchThumb",TL=T.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,a=Efe(kL,n);return m.jsx(rn.span,{"data-state":NL(a.checked),"data-disabled":a.disabled?"":void 0,...r,ref:t})});TL.displayName=kL;var Cfe="SwitchBubbleInput",AL=T.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...a},i)=>{const s=T.useRef(null),o=Cn(s,i),l=Nx(n),u=qw(t);return T.useEffect(()=>{const d=s.current;if(!d)return;const h=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==n&&y){const v=new Event("click",{bubbles:r});y.call(d,n),d.dispatchEvent(v)}},[l,n,r]),m.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:o,style:{...a.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});AL.displayName=Cfe;function NL(e){return e?"checked":"unchecked"}var kfe=CL,Tfe=TL;function Gs({className:e,...t}){return m.jsx(kfe,{"data-slot":"switch",className:Nt("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:m.jsx(Tfe,{"data-slot":"switch-thumb",className:Nt("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const RL=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:a,disabled:i=!1})=>{var u;const s=d=>{r(d==="none"?null:d)},o=(u=a.find(d=>d.id===n))==null?void 0:u.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return m.jsxs(Iu,{value:n??"none",onValueChange:s,disabled:i||a.length===0,children:[m.jsx(Ou,{className:Nt("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:m.jsx(ju,{asChild:!0,children:m.jsxs("div",{className:"flex items-center overflow-hidden",children:[m.jsx(Jq,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),m.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&m.jsxs("span",{className:"mr-1",children:[t,":"]}),a.length===0?m.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),m.jsxs(Du,{className:"bg-popover border-border text-popover-foreground",children:[m.jsx(Za,{value:"none",children:m.jsx("span",{className:"text-muted-foreground",children:"None"})}),a.map(d=>m.jsx(Za,{value:d.id,children:d.name||`Key ID: ${d.id.substring(0,6)}...`},d.id))]})]})},IL=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:a="",initialApiKeyId:i=null})=>{var w;const[s,o]=T.useState(!1),[l,u]=T.useState({name:a,type:r,isEnabled:!0,apiKeyId:i,baseURL:null,enabledModels:null,autoFetchModels:!1,fetchedModels:null,modelsLastFetchedAt:null});T.useEffect(()=>{u(x=>({...x,name:a||x.name||"",type:r||x.type||null,apiKeyId:i||x.apiKeyId||null,autoFetchModels:r?fh(r):x.autoFetchModels}))},[a,r,i]);const d=T.useCallback((x,S)=>{u(E=>{var R,O;const C={...E,[x]:S},k=E.name||"";if(x==="type"){const j=S,$=(R=Td.find(X=>X.value===E.type))==null?void 0:R.label;C.apiKeyId=null,C.baseURL=null,C.autoFetchModels=j?fh(j):!1,C.enabledModels=null;const L=(O=Td.find(X=>X.value===j))==null?void 0:O.label;if(L&&(!k.trim()||k===$)&&(C.name=L),j&&Fv(j)){const X=(e||[]).filter(F=>F.providerId===j);X.length>0&&(C.apiKeyId=X[0].id)}}return(x==="isEnabled"||x==="autoFetchModels")&&(C[x]=!!S),C})},[e]),h=T.useCallback(async()=>{var x,S;if(!((x=l.name)!=null&&x.trim())||!l.type){tt.error("Provider Name and Type are required.");return}o(!0);try{const E=l.type,C=l.autoFetchModels??fh(E),k={name:l.name.trim(),type:E,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((S=l.baseURL)==null?void 0:S.trim())||null,enabledModels:null,autoFetchModels:C,fetchedModels:null,modelsLastFetchedAt:null};await t(k),n()}catch(E){console.error("Failed to add provider (from form component):",E)}finally{o(!1)}},[l,t,n]),p=Fv(l.type??null),y=rk(l.type??null),v=fh(l.type??null),b=(e||[]).filter(x=>!l.type||x.providerId===l.type);return m.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"new-provider-type",children:"Provider Type"}),m.jsxs(Iu,{value:l.type??"",onValueChange:x=>d("type",x),disabled:s,children:[m.jsx(Ou,{id:"new-provider-type",children:m.jsx(ju,{placeholder:"Select Type"})}),m.jsx(Du,{children:Td.map(x=>m.jsx(Za,{value:x.value,children:x.label},x.value))})]})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"new-provider-name",children:"Provider Name"}),m.jsx(qn,{id:"new-provider-name",value:l.name||"",onChange:x=>d("name",x.target.value),placeholder:"e.g., My Ollama",disabled:s,"aria-label":"Provider Name"})]}),p&&m.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[m.jsx(en,{children:"API Key"}),m.jsx(RL,{label:"API Key",selectedKeyId:l.apiKeyId??null,onKeySelected:x=>d("apiKeyId",x),apiKeys:b,disabled:s||!l.type})]}),y&&m.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[m.jsx(en,{htmlFor:"new-provider-baseurl",children:"Base URL"}),m.jsx(qn,{id:"new-provider-baseurl",value:l.baseURL||"",onChange:x=>d("baseURL",x.target.value),placeholder:"Base URL (e.g., http://localhost:11434)",disabled:s,"aria-label":"Base URL"})]})]}),m.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 pt-2",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Gs,{id:"new-enabled",checked:l.isEnabled??!0,onCheckedChange:x=>d("isEnabled",x),disabled:s,"aria-labelledby":"new-enabled-label"}),m.jsx(en,{id:"new-enabled-label",htmlFor:"new-enabled",children:"Enabled"})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Gs,{id:"new-autofetch",checked:l.autoFetchModels??!1,onCheckedChange:x=>d("autoFetchModels",x),disabled:!v||s,"aria-labelledby":"new-autofetch-label"}),m.jsxs(en,{id:"new-autofetch-label",htmlFor:"new-autofetch",className:Nt("text-sm",v?"":"text-muted-foreground"),children:["Auto-fetch models ",v?"":"(Not Supported)"]})]})]}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Models fetched will appear in the global organizer above after fetching."}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Mt,{variant:"ghost",size:"sm",onClick:n,disabled:s,type:"button",children:[m.jsx(Ts,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsxs(Mt,{variant:"secondary",size:"sm",onClick:h,disabled:s||!((w=l.name)!=null&&w.trim())||!l.type,type:"button",children:[s&&m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(Vd,{className:"h-4 w-4 mr-1"})," ",s?"Adding...":"Add Provider"]})]})]})};var Px="Collapsible",[Afe,c_e]=Si(Px),[Nfe,ST]=Afe(Px),jL=T.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:i,onOpenChange:s,...o}=e,[l,u]=no({prop:r,defaultProp:a??!1,onChange:s,caller:Px});return m.jsx(Nfe,{scope:n,disabled:i,contentId:Ya(),open:l,onOpenToggle:T.useCallback(()=>u(d=>!d),[u]),children:m.jsx(rn.div,{"data-state":CT(l),"data-disabled":i?"":void 0,...o,ref:t})})});jL.displayName=Px;var OL="CollapsibleTrigger",DL=T.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=ST(OL,n);return m.jsx(rn.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":CT(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:Vt(e.onClick,a.onOpenToggle)})});DL.displayName=OL;var ET="CollapsibleContent",ML=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=ST(ET,e.__scopeCollapsible);return m.jsx(ka,{present:n||a.open,children:({present:i})=>m.jsx(Rfe,{...r,ref:t,present:i})})});ML.displayName=ET;var Rfe=T.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...i}=e,s=ST(ET,n),[o,l]=T.useState(r),u=T.useRef(null),d=Cn(t,u),h=T.useRef(0),p=h.current,y=T.useRef(0),v=y.current,b=s.open||o,w=T.useRef(b),x=T.useRef(void 0);return T.useEffect(()=>{const S=requestAnimationFrame(()=>w.current=!1);return()=>cancelAnimationFrame(S)},[]),za(()=>{const S=u.current;if(S){x.current=x.current||{transitionDuration:S.style.transitionDuration,animationName:S.style.animationName},S.style.transitionDuration="0s",S.style.animationName="none";const E=S.getBoundingClientRect();h.current=E.height,y.current=E.width,w.current||(S.style.transitionDuration=x.current.transitionDuration,S.style.animationName=x.current.animationName),l(r)}},[s.open,r]),m.jsx(rn.div,{"data-state":CT(s.open),"data-disabled":s.disabled?"":void 0,id:s.contentId,hidden:!b,...i,ref:d,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":v?`${v}px`:void 0,...e.style},children:b&&a})});function CT(e){return e?"open":"closed"}var Ife=jL;function jfe({...e}){return m.jsx(Ife,{"data-slot":"collapsible",...e})}function Ofe({...e}){return m.jsx(DL,{"data-slot":"collapsible-trigger",...e})}function Dfe({...e}){return m.jsx(ML,{"data-slot":"collapsible-content",...e})}const Mfe=({stepNumber:e,title:t,description:n,isComplete:r,isActive:a,children:i,contentClassName:s,openOnComplete:o})=>{const[l,u]=T.useState(a&&!r);T.useEffect(()=>{a&&(!r||o)&&u(!0)},[a,r,o]);const d=r?BC:S6,h=r?"text-green-500":a?"text-primary":"text-muted-foreground";return m.jsxs(jfe,{open:l,onOpenChange:u,className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center justify-between space-x-4 px-1",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx(d,{className:Nt("h-5 w-5 flex-shrink-0",h)}),m.jsxs("h4",{className:Nt("text-sm font-semibold",r?"text-muted-foreground line-through":"text-primary"),children:["Step ",e,": ",t]})]}),m.jsx(Ofe,{asChild:!0,children:m.jsxs(Mt,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[l?m.jsx(Yo,{className:"h-4 w-4"}):m.jsx(_6,{className:"h-4 w-4"}),m.jsxs("span",{className:"sr-only",children:["Toggle ",t]})]})})]}),m.jsx(Dfe,{className:"space-y-2",children:m.jsxs("div",{className:Nt("rounded-md border px-4 py-3 font-mono text-sm shadow-sm bg-card ml-8",s),children:[m.jsx("p",{className:"text-sm mb-3 text-card-foreground",children:n}),i]})})]})},kT=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:a=!1,disabled:i=!1,listHeightClass:s="h-48",onModelClick:o})=>{const[l,u]=T.useState(""),d=T.useMemo(()=>{if(!l)return t;const h=l.toLowerCase();return t.filter(p=>p.name.toLowerCase().includes(h)||p.id.toLowerCase().includes(h))},[t,l]);return a?m.jsxs("div",{className:`space-y-2 ${s}`,children:[m.jsx(ur,{className:"h-8 w-full"}),m.jsx(ur,{className:"h-8 w-full"}),m.jsx(ur,{className:"h-8 w-full"})]}):t.length===0?m.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):m.jsxs("div",{className:"space-y-2",children:[m.jsx(qn,{value:l,onChange:h=>u(h.target.value),placeholder:"Search models...",className:"h-9 w-full text-xs",type:"text"}),m.jsx(Yl,{className:`${s} w-full rounded-md border border-border p-3 bg-background/50`,children:m.jsx("div",{className:"space-y-2",children:d.map(h=>m.jsxs("div",{className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[m.jsx(en,{htmlFor:`enable-model-${e}-${h.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate",title:h.name||h.id,onClick:o?()=>o(h.id):void 0,children:h.name||h.id}),m.jsx("div",{className:"flex items-center flex-shrink-0 gap-1",children:m.jsx(Gs,{id:`enable-model-${e}-${h.id}`,checked:n.has(h.id),onCheckedChange:p=>r(h.id,p),disabled:i,"aria-label":`Enable model ${h.name||h.id}`,onClick:p=>p.stopPropagation()})})]},h.id))})})]})},yd=gt.forwardRef(({className:e,href:t,children:n,...r},a)=>m.jsx("a",{ref:a,href:t,target:"_blank",rel:"noopener noreferrer",className:Nt("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));yd.displayName="Lnk";const Pfe=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:a,getAllAvailableModelDefsForProvider:i,isLoading:s,enableApiKeyManagement:o}=Fn(dn(B=>({apiKeys:B.dbApiKeys,addApiKey:B.addApiKey,providers:B.dbProviderConfigs,addProviderConfig:B.addProviderConfig,updateProviderConfig:B.updateProviderConfig,getAllAvailableModelDefsForProvider:B.getAllAvailableModelDefsForProvider,isLoading:B.isLoading,enableApiKeyManagement:B.enableApiKeyManagement}))),{toggleChatControlPanel:l,setInitialSettingsTabs:u}=pa(dn(B=>({toggleChatControlPanel:B.toggleChatControlPanel,setInitialSettingsTabs:B.setInitialSettingsTabs}))),{addConversation:d,selectItem:h}=mn(dn(B=>({addConversation:B.addConversation,selectItem:B.selectItem}))),[p,y]=T.useState(!1),[v,b]=T.useState(!1),[w,x]=T.useState(!1),S=pa(B=>B.setFocusInputFlag),[E,C]=T.useState(!1),[k,R]=T.useState(null),O=T.useMemo(()=>!o||e.length>0,[o,e]),j=T.useMemo(()=>n.length>0,[n]),$=T.useMemo(()=>n.some(B=>B.isEnabled&&B.enabledModels&&B.enabledModels.length>0),[n]),L=T.useMemo(()=>n.length>0?n[0]:null,[n]),X=T.useMemo(()=>L?i(L.id).map(B=>({id:B.id,name:B.name})):[],[L,i]),F=T.useMemo(()=>new Set((L==null?void 0:L.enabledModels)??[]),[L]),K=T.useCallback(async(B,J,ee)=>{y(!0);try{await t(B,J,ee),R(J)}finally{y(!1)}},[t]),q=T.useCallback(async B=>{b(!0);try{const J=await r(B);return R(null),J}finally{b(!1)}},[r]),de=T.useCallback(async(B,J)=>{if(!L)return;C(!0);const ee=new Set(L.enabledModels??[]);J?ee.add(B):ee.delete(B);const oe=Array.from(ee);try{await a(L.id,{enabledModels:oe})}catch(me){tt.error("Failed to update model status."),console.error("Failed to save model toggle:",me)}finally{C(!1)}},[L,a]),re=T.useCallback(async()=>{x(!0);try{const B=await d({title:"New Chat"});await h(B,"conversation"),setTimeout(()=>S(!0),0)}catch(B){tt.error("Failed to start your first chat."),console.error("Failed to start first chat:",B)}finally{x(!1)}},[d,h,S]),Y=(B,J)=>{u(B,J),l("settingsModal",!0)},Q=[...o?[{id:"api-key",title:"Add API Key",description:m.jsxs("div",{children:[m.jsxs("p",{children:["To use providers like"," ",m.jsx(yd,{href:"https://platform.openai.com/api-keys",children:"OpenAI"}),","," ",m.jsx(yd,{href:"https://aistudio.google.com/app/apikey",children:"Google"}),","," ",m.jsx(yd,{href:"https://console.anthropic.com/settings/keys",children:"Anthropic (Claude)"}),", or ",m.jsx(yd,{href:"https://openrouter.ai/keys",children:"OpenRouter"})," ","or any OpenAi API compatible provider , add an API key. Keys are stored securely in your browser."]}),m.jsxs("p",{className:"py-2",children:['If you want truly local AI, "no internet required", you can setup ',m.jsx(yd,{href:"https://www.ollama.com/",children:"Ollama"})," or,"," ",m.jsx(yd,{href:"https://lmstudio.ai/",children:"LMStudio"})," (or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys."]})]}),isComplete:O,content:m.jsx(EL,{onSave:K,onCancel:()=>{},isSaving:p,className:"border-none shadow-none p-0"})}]:[],{id:"add-provider",title:"Add AI Provider",description:"Connect to an AI provider like OpenAI, Ollama, or others to start chatting.",isComplete:j,content:m.jsx(IL,{apiKeys:e,onAddProvider:q,onCancel:()=>{},initialType:k??void 0})},{id:"enable-models",title:"Enable Models",description:m.jsxs(m.Fragment,{children:["Enable models for the provider you just added (",(L==null?void 0:L.name)||"","). Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."]}),isComplete:$,content:L?m.jsx(kT,{providerId:L.id,allAvailableModels:X,enabledModelIds:F,onToggleModel:de,isLoading:s||E,listHeightClass:"h-48"}):m.jsxs("p",{className:"text-sm text-muted-foreground italic",children:["Add a provider in Step ",o?"2":"1"," first."]})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:m.jsxs(Mt,{onClick:re,disabled:w,size:"sm",children:[m.jsx(T6,{className:"mr-2 h-4 w-4"}),w?"Starting...":"Start First Chat"]}),contentClassName:""}],ae=Q.findIndex(B=>!B.isComplete);return s?m.jsxs("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-2xl mx-auto w-full",children:[m.jsx(ur,{className:"h-10 w-3/4"}),m.jsx(ur,{className:"h-20 w-full"}),m.jsx(ur,{className:"h-10 w-3/4"}),m.jsx(ur,{className:"h-20 w-full"})]}):m.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4",children:m.jsxs("div",{className:"w-full max-w-4xl space-y-6",children:[m.jsxs("div",{className:"text-center mb-6",children:[m.jsx(A6,{className:"h-12 w-12 text-primary mx-auto mb-3"}),m.jsx("h2",{className:"text-2xl font-semibold mb-1",children:"LiteChat Setup"}),m.jsx("p",{className:"text-muted-foreground",children:"Follow these steps to configure LiteChat."})]}),m.jsx("div",{className:"space-y-4",children:Q.map((B,J)=>{const ee=J===ae;return m.jsx(Mfe,{stepNumber:J+1,title:B.title,description:B.description,isComplete:B.id!=="start-chat"&&B.isComplete,isActive:ee,contentClassName:B.id==="add-provider"||B.id==="api-key"?"p-0 border-none shadow-none bg-transparent":B.id==="enable-models"?"p-0":B.contentClassName,children:B.content},B.id)})}),!s&&!o&&!j&&ae===-1&&m.jsxs("div",{className:"text-center text-muted-foreground mt-6",children:[m.jsx(Ad,{className:"h-8 w-8 text-destructive mx-auto mb-2"}),m.jsx("p",{className:"text-sm",children:"Configuration issue detected. Please review provider settings."}),m.jsx(Mt,{variant:"outline",size:"sm",onClick:()=>Y("providers"),className:"mt-2",children:"Go to Settings"})]})]})})},Ffe=({conversationId:e,interactions:t,status:n,className:r,onRegenerateInteraction:a,onEditInteraction:i,onStopInteraction:s})=>{const o=T.useRef(null),l=T.useRef(null),[u,d]=T.useState(!1),h=Zn(k=>k.streamingInteractionIds),{isLoading:p}=Fn(dn(k=>({providers:k.dbProviderConfigs,apiKeys:k.dbApiKeys,isLoading:k.isLoading,enableApiKeyManagement:k.enableApiKeyManagement}))),{conversationCount:y,isConversationLoading:v}=mn(dn(k=>({conversationCount:k.conversations.length,isConversationLoading:k.isLoading}))),{projectCount:b,isProjectLoading:w}=ii(dn(k=>({projectCount:k.projects.length,isProjectLoading:k.isLoading}))),x=T.useMemo(()=>p||v||w?!1:y===0&&b===0,[y,b,p,v,w]),S=T.useMemo(()=>{const k=[],R=new Set;return[...t].sort((j,$)=>j.index-$.index).forEach(j=>{if(R.has(j.id))return;const $=[j];R.add(j.id),k.push($)}),k},[t]),E=(k="smooth")=>{l.current&&l.current.scrollTo({top:l.current.scrollHeight,behavior:k})};T.useEffect(()=>{if(l.current){const{scrollHeight:k,clientHeight:R,scrollTop:O}=l.current,j=k-R<=O+150,$=n==="streaming"&&h.length>0;(j||$)&&E($?"smooth":"auto")}},[t,n,h]),T.useEffect(()=>{const k=l.current;if(!k)return;const R=()=>{const{scrollHeight:O,clientHeight:j,scrollTop:$}=k,L=$<O-j-j*.5;d(L)};return k.addEventListener("scroll",R,{passive:!0}),R(),()=>{k.removeEventListener("scroll",R)}},[]),T.useEffect(()=>{o.current&&(l.current=o.current.querySelector("[data-radix-scroll-area-viewport]"))},[]);const C=()=>p||v||w?m.jsxs("div",{className:"space-y-4 p-4",children:[m.jsx(ur,{className:"h-24 w-full"}),m.jsx(ur,{className:"h-32 w-full"}),m.jsx(ur,{className:"h-20 w-full"})]}):x?m.jsx(Pfe,{}):e?e?t.length===0&&n!=="streaming"?m.jsx(eO,{}):m.jsxs("div",{className:"space-y-4 p-4",children:[S.map(k=>{const R=k[0];return h.includes(R.id)?m.jsx(cC,{interactionId:R.id,onStop:s},`${R.id}-streaming`):m.jsx(TF,{interaction:R,onEdit:i,onRegenerate:a,onDelete:void 0},R.id)}),n==="streaming"&&h.filter(k=>!t.some(R=>R.id===k)).map(k=>m.jsx(cC,{interactionId:k,onStop:s},`${k}-streaming-new`))]}):null:m.jsx(eO,{});return m.jsxs("div",{className:Nt("flex-grow relative",r),children:[m.jsx(Yl,{className:"h-full w-full",ref:o,children:C()}),u&&m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>E(),"aria-label":"Scroll to bottom",children:m.jsx(XU,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"left",children:"Scroll to Bottom"})]})})]})},Gb=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const a=e.filter(i=>(i.panel??"main")===t&&(i.show?i.show():!0));return a.length===0?null:m.jsx("div",{className:Nt(r),children:a.map(i=>{const s=n==="icon"?i.iconRenderer:i.renderer;return m.jsx(gt.Fragment,{children:s?s():null},i.id)})})},Lfe=Symbol("Let zodToJsonSchema decide on which parser to use"),fO={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},$fe=e=>typeof e=="string"?{...fO,name:e}:{...fO,...e},Bfe=e=>{const t=$fe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function PL(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function vr(e,t,n,r,a){e[t]=n,PL(e,t,r,a)}function zfe(){return{}}function Ufe(e,t){var r,a,i;const n={type:"array"};return(r=e.type)!=null&&r._def&&((i=(a=e.type)==null?void 0:a._def)==null?void 0:i.typeName)!==qt.ZodAny&&(n.items=dr(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&vr(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&vr(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(vr(n,"minItems",e.exactLength.value,e.exactLength.message,t),vr(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function qfe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?vr(n,"minimum",r.value,r.message,t):vr(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),vr(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?vr(n,"maximum",r.value,r.message,t):vr(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),vr(n,"maximum",r.value,r.message,t));break;case"multipleOf":vr(n,"multipleOf",r.value,r.message,t);break}return n}function Hfe(){return{type:"boolean"}}function FL(e,t){return dr(e.type._def,t)}const Vfe=(e,t)=>dr(e.innerType._def,t);function LL(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,i)=>LL(e,t,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Gfe(e,t)}}const Gfe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":vr(n,"minimum",r.value,r.message,t);break;case"max":vr(n,"maximum",r.value,r.message,t);break}return n};function Wfe(e,t){return{...dr(e.innerType._def,t),default:e.defaultValue()}}function Kfe(e,t){return t.effectStrategy==="input"?dr(e.schema._def,t):{}}function Zfe(e){return{type:"string",enum:Array.from(e.values)}}const Yfe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function Xfe(e,t){const n=[dr(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),dr(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(i=>!!i);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach(i=>{if(Yfe(i))a.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let s=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...l}=i;s=l}else r=void 0;a.push(s)}}),a.length?{allOf:a,...r}:void 0}function Jfe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let WE;const Bs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(WE===void 0&&(WE=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),WE),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function $L(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":vr(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":vr(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":zs(n,"email",r.message,t);break;case"format:idn-email":zs(n,"idn-email",r.message,t);break;case"pattern:zod":vi(n,Bs.email,r.message,t);break}break;case"url":zs(n,"uri",r.message,t);break;case"uuid":zs(n,"uuid",r.message,t);break;case"regex":vi(n,r.regex,r.message,t);break;case"cuid":vi(n,Bs.cuid,r.message,t);break;case"cuid2":vi(n,Bs.cuid2,r.message,t);break;case"startsWith":vi(n,RegExp(`^${KE(r.value,t)}`),r.message,t);break;case"endsWith":vi(n,RegExp(`${KE(r.value,t)}$`),r.message,t);break;case"datetime":zs(n,"date-time",r.message,t);break;case"date":zs(n,"date",r.message,t);break;case"time":zs(n,"time",r.message,t);break;case"duration":zs(n,"duration",r.message,t);break;case"length":vr(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),vr(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{vi(n,RegExp(KE(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&zs(n,"ipv4",r.message,t),r.version!=="v4"&&zs(n,"ipv6",r.message,t);break}case"base64url":vi(n,Bs.base64url,r.message,t);break;case"jwt":vi(n,Bs.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&vi(n,Bs.ipv4Cidr,r.message,t),r.version!=="v4"&&vi(n,Bs.ipv6Cidr,r.message,t);break}case"emoji":vi(n,Bs.emoji(),r.message,t);break;case"ulid":{vi(n,Bs.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{zs(n,"binary",r.message,t);break}case"contentEncoding:base64":{vr(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{vi(n,Bs.base64,r.message,t);break}}break}case"nanoid":vi(n,Bs.nanoid,r.message,t)}return n}function KE(e,t){return t.patternStrategy==="escape"?ehe(e):e}const Qfe=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function ehe(e){let t="";for(let n=0;n<e.length;n++)Qfe.has(e[n])||(t+="\\"),t+=e[n];return t}function zs(e,t,n,r){var a;e.format||(a=e.anyOf)!=null&&a.some(i=>i.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):vr(e,"format",t,n,r)}function vi(e,t,n,r){var a;e.pattern||(a=e.allOf)!=null&&a.some(i=>i.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:hO(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):vr(e,"pattern",hO(t,r),n,r)}function hO(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let a="",i=!1,s=!1,o=!1;for(let u=0;u<r.length;u++){if(i){a+=r[u],i=!1;continue}if(n.i){if(s){if(r[u].match(/[a-z]/)){o?(a+=r[u],a+=`${r[u-2]}-${r[u]}`.toUpperCase(),o=!1):r[u+1]==="-"&&((l=r[u+2])!=null&&l.match(/[a-z]/))?(a+=r[u],o=!0):a+=`${r[u]}${r[u].toUpperCase()}`;continue}}else if(r[u].match(/[a-z]/)){a+=`[${r[u]}${r[u].toUpperCase()}]`;continue}}if(n.m){if(r[u]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(r[u]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&r[u]==="."){a+=s?`${r[u]}\r
`:`[${r[u]}\r
]`;continue}a+=r[u],r[u]==="\\"?i=!0:s&&r[u]==="]"?s=!1:!s&&r[u]==="["&&(s=!0)}try{new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return a}function BL(e,t){var r,a,i,s,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===qt.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((u,d)=>({...u,[d]:dr(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",d]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:dr(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((a=e.keyType)==null?void 0:a._def.typeName)===qt.ZodString&&((i=e.keyType._def.checks)!=null&&i.length)){const{type:u,...d}=$L(e.keyType._def,t);return{...n,propertyNames:d}}else{if(((s=e.keyType)==null?void 0:s._def.typeName)===qt.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===qt.ZodBranded&&e.keyType._def.type._def.typeName===qt.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:u,...d}=FL(e.keyType._def,t);return{...n,propertyNames:d}}}return n}function the(e,t){if(t.mapStrategy==="record")return BL(e,t);const n=dr(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=dr(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function nhe(e){const t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),a=Array.from(new Set(r.map(i=>typeof i)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:r}}function rhe(){return{not:{}}}function ahe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const hw={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function ihe(e,t){if(t.target==="openApi3")return pO(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in hw&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((a,i)=>{const s=hw[i._def.typeName];return s&&!a.includes(s)?[...a,s]:a},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((a,i)=>{const s=typeof i._def.value;switch(s){case"string":case"number":case"boolean":return[...a,s];case"bigint":return[...a,"integer"];case"object":if(i._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===n.length){const a=r.filter((i,s,o)=>o.indexOf(i)===s);return{type:a.length>1?a:a[0],enum:n.reduce((i,s)=>i.includes(s._def.value)?i:[...i,s._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,a)=>[...r,...a._def.values.filter(i=>!r.includes(i))],[])};return pO(e,t)}const pO=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,a)=>dr(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function she(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:hw[e.innerType._def.typeName],nullable:!0}:{type:[hw[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=dr(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=dr(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function ohe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",PL(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?vr(n,"minimum",r.value,r.message,t):vr(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),vr(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?vr(n,"maximum",r.value,r.message,t):vr(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),vr(n,"maximum",r.value,r.message,t));break;case"multipleOf":vr(n,"multipleOf",r.value,r.message,t);break}return n}function lhe(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},a=[],i=e.shape();for(const o in i){let l=i[o];if(l===void 0||l._def===void 0)continue;let u=uhe(l);u&&n&&(l instanceof Ks&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),u=!1);const d=dr(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});d!==void 0&&(r.properties[o]=d,u||a.push(o))}a.length&&(r.required=a);const s=che(e,t);return s!==void 0&&(r.additionalProperties=s),r}function che(e,t){if(e.catchall._def.typeName!=="ZodNever")return dr(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function uhe(e){try{return e.isOptional()}catch{return!0}}const dhe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return dr(e.innerType._def,t);const n=dr(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},fhe=(e,t)=>{if(t.pipeStrategy==="input")return dr(e.in._def,t);if(t.pipeStrategy==="output")return dr(e.out._def,t);const n=dr(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=dr(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(a=>a!==void 0)}};function hhe(e,t){return dr(e.type._def,t)}function phe(e,t){const r={type:"array",uniqueItems:!0,items:dr(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&vr(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&vr(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function mhe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>dr(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:dr(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>dr(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function ghe(){return{not:{}}}function yhe(){return{}}const bhe=(e,t)=>dr(e.innerType._def,t),vhe=(e,t,n)=>{switch(t){case qt.ZodString:return $L(e,n);case qt.ZodNumber:return ohe(e,n);case qt.ZodObject:return lhe(e,n);case qt.ZodBigInt:return qfe(e,n);case qt.ZodBoolean:return Hfe();case qt.ZodDate:return LL(e,n);case qt.ZodUndefined:return ghe();case qt.ZodNull:return ahe(n);case qt.ZodArray:return Ufe(e,n);case qt.ZodUnion:case qt.ZodDiscriminatedUnion:return ihe(e,n);case qt.ZodIntersection:return Xfe(e,n);case qt.ZodTuple:return mhe(e,n);case qt.ZodRecord:return BL(e,n);case qt.ZodLiteral:return Jfe(e,n);case qt.ZodEnum:return Zfe(e);case qt.ZodNativeEnum:return nhe(e);case qt.ZodNullable:return she(e,n);case qt.ZodOptional:return dhe(e,n);case qt.ZodMap:return the(e,n);case qt.ZodSet:return phe(e,n);case qt.ZodLazy:return()=>e.getter()._def;case qt.ZodPromise:return hhe(e,n);case qt.ZodNaN:case qt.ZodNever:return rhe();case qt.ZodEffects:return Kfe(e,n);case qt.ZodAny:return zfe();case qt.ZodUnknown:return yhe();case qt.ZodDefault:return Wfe(e,n);case qt.ZodBranded:return FL(e,n);case qt.ZodReadonly:return bhe(e,n);case qt.ZodCatch:return Vfe(e,n);case qt.ZodPipeline:return fhe(e,n);case qt.ZodFunction:case qt.ZodVoid:case qt.ZodSymbol:return;default:return(r=>{})()}};function dr(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==Lfe)return l}if(r&&!n){const l=whe(r,t);if(l!==void 0)return l}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const i=vhe(e,e.typeName,t),s=typeof i=="function"?dr(i(),t):i;if(s&&_he(e,t,s),t.postProcess){const l=t.postProcess(s,e,t);return a.jsonSchema=s,l}return a.jsonSchema=s,s}const whe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:xhe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},xhe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},_he=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),She=(e,t)=>{const n=Bfe(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[u,d])=>({...l,[u]:dr(d._def,{...n,currentPath:[...n.basePath,n.definitionPath,u]},!0)??{}}),{}):void 0,a=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,i=dr(e._def,a===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,a]},!1)??{},s=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;s!==void 0&&(i.title=s);const o=a===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Hg={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Vg={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Gg={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Wg={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Kg={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},Ehe=[Hg,Vg,Gg,Wg,Kg];Hg.code+"",Vg.code+"",Gg.code+"",Wg.code+"",Kg.code+"";Hg.name+"",Hg.code,Vg.name+"",Vg.code,Gg.name+"",Gg.code,Wg.name+"",Wg.code,Kg.name+"",Kg.code;Ehe.map(e=>e.code);function Che(e){const t=["ROOT"];let n=-1,r=null;function a(l,u,d){switch(l){case'"':{n=u,t.pop(),t.push(d),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=u,r=u,t.pop(),t.push(d),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(d),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=u,t.pop(),t.push(d),t.push("INSIDE_NUMBER");break}case"{":{n=u,t.pop(),t.push(d),t.push("INSIDE_OBJECT_START");break}case"[":{n=u,t.pop(),t.push(d),t.push("INSIDE_ARRAY_START");break}}}function i(l,u){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=u,t.pop();break}}}function s(l,u){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=u,t.pop();break}}}for(let l=0;l<e.length;l++){const u=e[l];switch(t[t.length-1]){case"ROOT":a(u,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(u){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(u){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(u){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(u){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{a(u,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(u,l);break}case"INSIDE_STRING":{switch(u){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(u){case"]":{n=l,t.pop();break}default:{n=l,a(u,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(u){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{a(u,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(u){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&s(u,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(u,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(u,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&s(u,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const h=e.substring(r,l+1);!"false".startsWith(h)&&!"true".startsWith(h)&&!"null".startsWith(h)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(u,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&s(u,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const d=e.substring(r,e.length);"true".startsWith(d)?o+="true".slice(d.length):"false".startsWith(d)?o+="false".slice(d.length):"null".startsWith(d)&&(o+="null".slice(d.length))}}return o}function khe(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=Id({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=Id({text:Che(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var The={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Ahe={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},Nhe={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Rhe={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Ihe={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},jhe={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},Ohe={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},Dhe={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Mhe={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Phe={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},Fhe={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},Lhe={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},$he={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},Bhe={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},zhe={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},Uhe={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},Fx=[The,Ahe,Nhe,Rhe,Ihe,jhe,Ohe,Dhe,Mhe,Phe,Fhe,Lhe,$he,Bhe,zhe,Uhe];Object.fromEntries(Fx.map(e=>[e.code,e]));Object.fromEntries(Fx.map(e=>[e.name,e.code]));Fx.map(e=>e.code);function ri(e,t){const n=Fx.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function qhe(e,t){var n;const r=(n=void 0)!=null?n:!1;return Hhe(She(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:a=>{const i=e.safeParse(a);return i.success?{success:!0,value:i.data}:{success:!1,error:i.error}}})}var gC=Symbol.for("vercel.ai.schema");function Hhe(e,{validate:t}={}){return{[gC]:!0,_type:void 0,[mv]:!0,jsonSchema:e,validate:t}}function Vhe(e){return typeof e=="object"&&e!==null&&gC in e&&e[gC]===!0&&"jsonSchema"in e&&"validate"in e}function Lx(e){return Vhe(e)?e:qhe(e)}const mO=globalThis||void 0||self;var Ghe=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof mO=="object"?mO:{},Sd="1.9.0",gO=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function Whe(e){var t=new Set([e]),n=new Set,r=e.match(gO);if(!r)return function(){return!1};var a={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(a.prerelease!=null)return function(l){return l===e};function i(o){return n.add(o),!1}function s(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var u=l.match(gO);if(!u)return i(l);var d={major:+u[1],minor:+u[2],patch:+u[3],prerelease:u[4]};return d.prerelease!=null||a.major!==d.major?i(l):a.major===0?a.minor===d.minor&&a.patch<=d.patch?s(l):i(l):a.minor<=d.minor?s(l):i(l)}}var Khe=Whe(Sd),Zhe=Sd.split(".")[0],Zg=Symbol.for("opentelemetry.js.api."+Zhe),Yg=Ghe;function TT(e,t,n,r){var a;r===void 0&&(r=!1);var i=Yg[Zg]=(a=Yg[Zg])!==null&&a!==void 0?a:{version:Sd};if(!r&&i[e]){var s=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(s.stack||s.message),!1}if(i.version!==Sd){var s=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+Sd);return n.error(s.stack||s.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+Sd+"."),!0}function Xg(e){var t,n,r=(t=Yg[Zg])===null||t===void 0?void 0:t.version;if(!(!r||!Khe(r)))return(n=Yg[Zg])===null||n===void 0?void 0:n[e]}function AT(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Sd+".");var n=Yg[Zg];n&&delete n[e]}var Yhe=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),a,i=[],s;try{for(;(t===void 0||t-- >0)&&!(a=r.next()).done;)i.push(a.value)}catch(o){s={error:o}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i},Xhe=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Jhe=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Bm("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Bm("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Bm("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Bm("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Bm("verbose",this._namespace,t)},e}();function Bm(e,t,n){var r=Xg("diag");if(r)return n.unshift(t),r[e].apply(r,Xhe([],Yhe(n),!1))}var Ji;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(Ji||(Ji={}));function Qhe(e,t){e<Ji.NONE?e=Ji.NONE:e>Ji.ALL&&(e=Ji.ALL),t=t||{};function n(r,a){var i=t[r];return typeof i=="function"&&e>=a?i.bind(t):function(){}}return{error:n("error",Ji.ERROR),warn:n("warn",Ji.WARN),info:n("info",Ji.INFO),debug:n("debug",Ji.DEBUG),verbose:n("verbose",Ji.VERBOSE)}}var epe=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),a,i=[],s;try{for(;(t===void 0||t-- >0)&&!(a=r.next()).done;)i.push(a.value)}catch(o){s={error:o}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i},tpe=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},npe="diag",pw=function(){function e(){function t(a){return function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var o=Xg("diag");if(o)return o[a].apply(o,tpe([],epe(i),!1))}}var n=this,r=function(a,i){var s,o,l;if(i===void 0&&(i={logLevel:Ji.INFO}),a===n){var u=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((s=u.stack)!==null&&s!==void 0?s:u.message),!1}typeof i=="number"&&(i={logLevel:i});var d=Xg("diag"),h=Qhe((o=i.logLevel)!==null&&o!==void 0?o:Ji.INFO,a);if(d&&!i.suppressOverrideMessage){var p=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";d.warn("Current logger will be overwritten from "+p),h.warn("Current logger will overwrite one already registered from "+p)}return TT("diag",h,n,!0)};n.setLogger=r,n.disable=function(){AT(npe,n)},n.createComponentLogger=function(a){return new Jhe(a)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function rpe(e){return Symbol.for(e)}var ape=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,a){var i=new e(n._currentContext);return i._currentContext.set(r,a),i},n.deleteValue=function(r){var a=new e(n._currentContext);return a._currentContext.delete(r),a}}return e}(),ipe=new ape,spe=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),a,i=[],s;try{for(;(t===void 0||t-- >0)&&!(a=r.next()).done;)i.push(a.value)}catch(o){s={error:o}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i},ope=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},lpe=function(){function e(){}return e.prototype.active=function(){return ipe},e.prototype.with=function(t,n,r){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return n.call.apply(n,ope([r],spe(a),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),cpe=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),a,i=[],s;try{for(;(t===void 0||t-- >0)&&!(a=r.next()).done;)i.push(a.value)}catch(o){s={error:o}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i},upe=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},ZE="context",dpe=new lpe,zL=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return TT(ZE,t,pw.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var a,i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return(a=this._getContextManager()).with.apply(a,upe([t,n,r],cpe(i),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return Xg(ZE)||dpe},e.prototype.disable=function(){this._getContextManager().disable(),AT(ZE,pw.instance())},e}(),yC;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(yC||(yC={}));var UL="0000000000000000",qL="00000000000000000000000000000000",fpe={traceId:qL,spanId:UL,traceFlags:yC.NONE},Ym=function(){function e(t){t===void 0&&(t=fpe),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),NT=rpe("OpenTelemetry Context Key SPAN");function RT(e){return e.getValue(NT)||void 0}function hpe(){return RT(zL.getInstance().active())}function IT(e,t){return e.setValue(NT,t)}function ppe(e){return e.deleteValue(NT)}function mpe(e,t){return IT(e,new Ym(t))}function HL(e){var t;return(t=RT(e))===null||t===void 0?void 0:t.spanContext()}var gpe=/^([0-9a-f]{32})$/i,ype=/^[0-9a-f]{16}$/i;function bpe(e){return gpe.test(e)&&e!==qL}function vpe(e){return ype.test(e)&&e!==UL}function VL(e){return bpe(e.traceId)&&vpe(e.spanId)}function wpe(e){return new Ym(e)}var YE=zL.getInstance(),GL=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=YE.active());var a=!!(n!=null&&n.root);if(a)return new Ym;var i=r&&HL(r);return xpe(i)&&VL(i)?new Ym(i):new Ym},e.prototype.startActiveSpan=function(t,n,r,a){var i,s,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(i=n,o=r):(i=n,s=r,o=a);var l=s??YE.active(),u=this.startSpan(t,i,l),d=IT(l,u);return YE.with(d,o,void 0,u)}},e}();function xpe(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var _pe=new GL,Spe=function(){function e(t,n,r,a){this._provider=t,this.name=n,this.version=r,this.options=a}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,a){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):_pe},e}(),Epe=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new GL},e}(),Cpe=new Epe,yO=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var a;return(a=this.getDelegateTracer(t,n,r))!==null&&a!==void 0?a:new Spe(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:Cpe},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var a;return(a=this._delegate)===null||a===void 0?void 0:a.getTracer(t,n,r)},e}(),mw;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(mw||(mw={}));var XE="trace",kpe=function(){function e(){this._proxyTracerProvider=new yO,this.wrapSpanContext=wpe,this.isSpanContextValid=VL,this.deleteSpan=ppe,this.getSpan=RT,this.getActiveSpan=hpe,this.getSpanContext=HL,this.setSpan=IT,this.setSpanContext=mpe}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=TT(XE,this._proxyTracerProvider,pw.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return Xg(XE)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){AT(XE,pw.instance()),this._proxyTracerProvider=new yO},e}(),Tpe=kpe.getInstance(),Ape=Object.defineProperty,jT=(e,t)=>{for(var n in t)Ape(e,n,{get:t[n],enumerable:!0})};function gw(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function bO(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[a,i]of Object.entries(e))r[a]=i;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function vO({response:e,status:t,statusText:n,headers:r,stream:a}){e.writeHead(t??200,n,r);const i=a.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await i.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var WL="AI_InvalidArgumentError",KL=`vercel.ai.error.${WL}`,Npe=Symbol.for(KL),ZL,qs=class extends Tn{constructor({parameter:e,value:t,message:n}){super({name:WL,message:`Invalid argument for parameter ${e}: ${n}`}),this[ZL]=!0,this.parameter=e,this.value=t}static isInstance(e){return Tn.hasMarker(e,KL)}};ZL=Npe;var YL="AI_RetryError",XL=`vercel.ai.error.${YL}`,Rpe=Symbol.for(XL),JL,wO=class extends Tn{constructor({message:e,reason:t,errors:n}){super({name:YL,message:e}),this[JL]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return Tn.hasMarker(e,XL)}};JL=Rpe;var Ipe=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>QL(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function QL(e,{maxRetries:t,delayInMs:n,backoffFactor:r},a=[]){try{return await e()}catch(i){if(ev(i)||t===0)throw i;const s=BV(i),o=[...a,i],l=o.length;if(l>t)throw new wO({message:`Failed after ${l} attempts. Last error: ${s}`,reason:"maxRetriesExceeded",errors:o});if(i instanceof Error&&xa.isInstance(i)&&i.isRetryable===!0&&l<=t)return await FV(n),QL(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?i:new wO({message:`Failed after ${l} attempts with non-retryable error: '${s}'`,reason:"errorNotRetryable",errors:o})}}function jpe({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new qs({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new qs({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:Ipe({maxRetries:t})}}function bC({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function Ope({model:e,settings:t,telemetry:n,headers:r}){var a;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((i,[s,o])=>(i[`ai.settings.${s}`]=o,i),{}),...Object.entries((a=n==null?void 0:n.metadata)!=null?a:{}).reduce((i,[s,o])=>(i[`ai.telemetry.metadata.${s}`]=o,i),{}),...Object.entries(r??{}).reduce((i,[s,o])=>(o!==void 0&&(i[`ai.request.headers.${s}`]=o),i),{})}}var Dpe={startSpan(){return Wb},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(Wb);if(typeof n=="function")return n(Wb);if(typeof r=="function")return r(Wb)}},Wb={spanContext(){return Mpe},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},Mpe={traceId:"",spanId:"",traceFlags:0};function Ppe({isEnabled:e=!1,tracer:t}={}){return e?t||Tpe.getTracer("ai"):Dpe}function vC({name:e,tracer:t,attributes:n,fn:r,endWhenDone:a=!0}){return t.startActiveSpan(e,{attributes:n},async i=>{try{const s=await r(i);return a&&i.end(),s}catch(s){try{s instanceof Error?(i.recordException({name:s.name,message:s.message,stack:s.stack}),i.setStatus({code:mw.ERROR,message:s.message})):i.setStatus({code:mw.ERROR})}finally{i.end()}throw s}})}function mh({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,a])=>{if(a===void 0)return n;if(typeof a=="object"&&"input"in a&&typeof a.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const i=a.input();return i===void 0?n:{...n,[r]:i}}if(typeof a=="object"&&"output"in a&&typeof a.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const i=a.output();return i===void 0?n:{...n,[r]:i}}return{...n,[r]:a}},{})}var Fpe=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=Th(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=gD(this.base64Data)),this.uint8ArrayData}},Lpe=class extends Fpe{constructor(e){super(e),this.type="file"}},$pe=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}];function Bpe(e){for(const t of $pe)if(typeof e=="string"?e.startsWith(t.base64Prefix):e.length>=t.bytesPrefix.length&&t.bytesPrefix.every((n,r)=>e[r]===n))return t.mimeType}var e$="AI_NoObjectGeneratedError",t$=`vercel.ai.error.${e$}`,zpe=Symbol.for(t$),n$,xO=class extends Tn{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:a}){super({name:e$,message:e,cause:t}),this[n$]=!0,this.text=n,this.response=r,this.usage=a}static isInstance(e){return Tn.hasMarker(e,t$)}};n$=zpe;var r$="AI_DownloadError",a$=`vercel.ai.error.${r$}`,Upe=Symbol.for(a$),i$,JE=class extends Tn{constructor({url:e,statusCode:t,statusText:n,cause:r,message:a=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:r$,message:a,cause:r}),this[i$]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return Tn.hasMarker(e,a$)}};i$=Upe;async function qpe({url:e,fetchImplementation:t=fetch}){var n;const r=e.toString();try{const a=await t(r);if(!a.ok)throw new JE({url:r,statusCode:a.status,statusText:a.statusText});return{data:new Uint8Array(await a.arrayBuffer()),mimeType:(n=a.headers.get("content-type"))!=null?n:void 0}}catch(a){throw JE.isInstance(a)?a:new JE({url:r,cause:a})}}var s$="AI_InvalidDataContentError",o$=`vercel.ai.error.${s$}`,Hpe=Symbol.for(o$),l$,_O=class extends Tn{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:s$,message:n,cause:t}),this[l$]=!0,this.content=e}static isInstance(e){return Tn.hasMarker(e,o$)}};l$=Hpe;var c$=z.union([z.string(),z.instanceof(Uint8Array),z.instanceof(ArrayBuffer),z.custom(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function u$(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Th(new Uint8Array(e)):Th(e)}function yw(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return gD(e)}catch(t){throw new _O({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new _O({content:e})}function Vpe(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var d$="AI_InvalidMessageRoleError",f$=`vercel.ai.error.${d$}`,Gpe=Symbol.for(f$),h$,Wpe=class extends Tn{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:d$,message:t}),this[h$]=!0,this.role=e}static isInstance(e){return Tn.hasMarker(e,f$)}};h$=Gpe;function Kpe(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function Zpe({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=qpe}){const a=await Xpe(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(i=>Ype(i,a))]}function Ype(e,t){var n,r,a,i,s,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(u=>Jpe(u,t)).filter(u=>u.type!=="text"||u.text!==""),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(u=>u.type!=="text"||u.text!=="").map(u=>{var d;const h=(d=u.providerOptions)!=null?d:u.experimental_providerMetadata;switch(u.type){case"file":return{type:"file",data:u.data instanceof URL?u.data:u$(u.data),filename:u.filename,mimeType:u.mimeType,providerMetadata:h};case"reasoning":return{type:"reasoning",text:u.text,signature:u.signature,providerMetadata:h};case"redacted-reasoning":return{type:"redacted-reasoning",data:u.data,providerMetadata:h};case"text":return{type:"text",text:u.text,providerMetadata:h};case"tool-call":return{type:"tool-call",toolCallId:u.toolCallId,toolName:u.toolName,args:u.args,providerMetadata:h}}}),providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(u=>{var d;return{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result,content:u.experimental_content,isError:u.isError,providerMetadata:(d=u.providerOptions)!=null?d:u.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const u=l;throw new Wpe({role:u})}}}async function Xpe(e,t,n,r){const a=e.filter(s=>s.role==="user").map(s=>s.content).filter(s=>Array.isArray(s)).flat().filter(s=>s.type==="image"||s.type==="file").filter(s=>!(s.type==="image"&&n===!0)).map(s=>s.type==="image"?s.image:s.data).map(s=>typeof s=="string"&&(s.startsWith("http:")||s.startsWith("https:"))?new URL(s):s).filter(s=>s instanceof URL).filter(s=>!r(s)),i=await Promise.all(a.map(async s=>({url:s,data:await t({url:s})})));return Object.fromEntries(i.map(({url:s,data:o})=>[s.toString(),o]))}function Jpe(e,t){var n,r,a,i;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let s=e.mimeType,o,l,u;const d=e.type;switch(d){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${d}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:h,base64Content:p}=Kpe(l.toString());if(h==null||p==null)throw new Error(`Invalid data URL format in part ${d}`);s=h,u=yw(p)}else{const h=t[l.toString()];h?(u=h.data,s??(s=h.mimeType)):u=l}else u=yw(l);switch(d){case"image":return u instanceof Uint8Array&&(s=(r=Bpe(u))!=null?r:s),{type:"image",image:u,mimeType:s,providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"file":{if(s==null)throw new Error("Mime type is missing for file part");return{type:"file",data:u instanceof Uint8Array?u$(u):u,filename:e.filename,mimeType:s,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}}}}function Qpe({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:a,frequencyPenalty:i,stopSequences:s,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new qs({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new qs({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new qs({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new qs({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new qs({parameter:"topK",value:r,message:"topK must be a number"});if(a!=null&&typeof a!="number")throw new qs({parameter:"presencePenalty",value:a,message:"presencePenalty must be a number"});if(i!=null&&typeof i!="number")throw new qs({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new qs({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:a,frequencyPenalty:i,stopSequences:s!=null&&s.length>0?s:void 0,seed:o}}function SO(e){var t,n,r;const a=[];for(const i of e){let s;try{s=new URL(i.url)}catch{throw new Error(`Invalid URL: ${i.url}`)}switch(s.protocol){case"http:":case"https:":{if((t=i.contentType)!=null&&t.startsWith("image/"))a.push({type:"image",image:s});else{if(!i.contentType)throw new Error("If the attachment is not an image, it must specify a content type");a.push({type:"file",data:s,mimeType:i.contentType})}break}case"data:":{let o,l,u;try{[o,l]=i.url.split(","),u=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${i.url}`)}if(u==null||l==null)throw new Error(`Invalid data URL format: ${i.url}`);if((n=i.contentType)!=null&&n.startsWith("image/"))a.push({type:"image",image:yw(l)});else if((r=i.contentType)!=null&&r.startsWith("text/"))a.push({type:"text",text:Vpe(yw(l))});else{if(!i.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");a.push({type:"file",data:l,mimeType:i.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${s.protocol}`)}}return a}var p$="AI_MessageConversionError",m$=`vercel.ai.error.${p$}`,eme=Symbol.for(m$),g$,QE=class extends Tn{constructor({originalMessage:e,message:t}){super({name:p$,message:t}),this[g$]=!0,this.originalMessage=e}static isInstance(e){return Tn.hasMarker(e,m$)}};g$=eme;function tme(e,t){var n,r;const a=(n=t==null?void 0:t.tools)!=null?n:{},i=[];for(let s=0;s<e.length;s++){const o=e[s],l=s===e.length-1,{role:u,content:d,experimental_attachments:h}=o;switch(u){case"system":{i.push({role:"system",content:d});break}case"user":{if(o.parts==null)i.push({role:"user",content:h?[{type:"text",text:d},...SO(h)]:d});else{const p=o.parts.filter(y=>y.type==="text").map(y=>({type:"text",text:y.text}));i.push({role:"user",content:h?[...p,...SO(h)]:p})}break}case"assistant":{if(o.parts!=null){let v=function(){const S=[];for(const C of x)switch(C.type){case"file":case"text":{S.push(C);break}case"reasoning":{for(const k of C.details)switch(k.type){case"text":S.push({type:"reasoning",text:k.text,signature:k.signature});break;case"redacted":S.push({type:"redacted-reasoning",data:k.data});break}break}case"tool-invocation":S.push({type:"tool-call",toolCallId:C.toolInvocation.toolCallId,toolName:C.toolInvocation.toolName,args:C.toolInvocation.args});break;default:{const k=C;throw new Error(`Unsupported part: ${k}`)}}i.push({role:"assistant",content:S});const E=x.filter(C=>C.type==="tool-invocation").map(C=>C.toolInvocation);E.length>0&&i.push({role:"tool",content:E.map(C=>{if(!("result"in C))throw new QE({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(C)});const{toolCallId:k,toolName:R,result:O}=C,j=a[R];return(j==null?void 0:j.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:k,toolName:R,result:j.experimental_toToolResultContent(O),experimental_content:j.experimental_toToolResultContent(O)}:{type:"tool-result",toolCallId:k,toolName:R,result:O}})}),x=[],w=!1,b++},b=0,w=!1,x=[];for(const S of o.parts)switch(S.type){case"text":{w&&v(),x.push(S);break}case"file":case"reasoning":{x.push(S);break}case"tool-invocation":{((r=S.toolInvocation.step)!=null?r:0)!==b&&v(),x.push(S),w=!0;break}}v();break}const p=o.toolInvocations;if(p==null||p.length===0){i.push({role:"assistant",content:d});break}const y=p.reduce((v,b)=>{var w;return Math.max(v,(w=b.step)!=null?w:0)},0);for(let v=0;v<=y;v++){const b=p.filter(w=>{var x;return((x=w.step)!=null?x:0)===v});b.length!==0&&(i.push({role:"assistant",content:[...l&&d&&v===0?[{type:"text",text:d}]:[],...b.map(({toolCallId:w,toolName:x,args:S})=>({type:"tool-call",toolCallId:w,toolName:x,args:S}))]}),i.push({role:"tool",content:b.map(w=>{if(!("result"in w))throw new QE({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(w)});const{toolCallId:x,toolName:S,result:E}=w,C=a[S];return(C==null?void 0:C.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:x,toolName:S,result:C.experimental_toToolResultContent(E),experimental_content:C.experimental_toToolResultContent(E)}:{type:"tool-result",toolCallId:x,toolName:S,result:E}})}))}d&&!l&&i.push({role:"assistant",content:d});break}case"data":break;default:{const p=u;throw new QE({originalMessage:o,message:`Unsupported role: ${p}`})}}}return i}function nme(e){if(!Array.isArray(e))return"other";if(e.length===0)return"messages";const t=e.map(rme);return t.some(n=>n==="has-ui-specific-parts")?"ui-messages":t.every(n=>n==="has-core-specific-parts"||n==="message")?"messages":"other"}function rme(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}var wC=z.lazy(()=>z.union([z.null(),z.string(),z.number(),z.boolean(),z.record(z.string(),wC),z.array(wC)])),na=z.record(z.string(),z.record(z.string(),wC)),ame=z.array(z.union([z.object({type:z.literal("text"),text:z.string()}),z.object({type:z.literal("image"),data:z.string(),mimeType:z.string().optional()})])),y$=z.object({type:z.literal("text"),text:z.string(),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),ime=z.object({type:z.literal("image"),image:z.union([c$,z.instanceof(URL)]),mimeType:z.string().optional(),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),b$=z.object({type:z.literal("file"),data:z.union([c$,z.instanceof(URL)]),filename:z.string().optional(),mimeType:z.string(),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),sme=z.object({type:z.literal("reasoning"),text:z.string(),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),ome=z.object({type:z.literal("redacted-reasoning"),data:z.string(),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),lme=z.object({type:z.literal("tool-call"),toolCallId:z.string(),toolName:z.string(),args:z.unknown(),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),cme=z.object({type:z.literal("tool-result"),toolCallId:z.string(),toolName:z.string(),result:z.unknown(),content:ame.optional(),isError:z.boolean().optional(),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),ume=z.object({role:z.literal("system"),content:z.string(),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),dme=z.object({role:z.literal("user"),content:z.union([z.string(),z.array(z.union([y$,ime,b$]))]),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),fme=z.object({role:z.literal("assistant"),content:z.union([z.string(),z.array(z.union([y$,b$,sme,ome,lme]))]),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),hme=z.object({role:z.literal("tool"),content:z.array(cme),providerOptions:na.optional(),experimental_providerMetadata:na.optional()}),pme=z.union([ume,dme,fme,hme]);function mme({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new Nl({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new Nl({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new Nl({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new Nl({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const n=nme(e.messages);if(n==="other")throw new Nl({prompt:e,message:"messages must be an array of CoreMessage or UIMessage"});const r=n==="ui-messages"?tme(e.messages,{tools:t}):e.messages;if(r.length===0)throw new Nl({prompt:e,message:"messages must not be empty"});const a=Qh({value:r,schema:z.array(pme)});if(!a.success)throw new Nl({prompt:e,message:"messages must be an array of CoreMessage or UIMessage",cause:a.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function gme({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function yme(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var bme="JSON schema:",vme="You MUST answer with a JSON object that matches the JSON schema above.",wme="You MUST answer with JSON.";function xme({prompt:e,schema:t,schemaPrefix:n=t!=null?bme:void 0,schemaSuffix:r=t!=null?vme:wme}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(a=>a!=null).join(`
`)}function e2(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:a}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:a}}}},t}Gd({prefix:"aiobj",size:24});var Ri=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function EO(){let e,t;return{promise:new Promise((r,a)=>{e=r,t=a}),resolve:e,reject:t}}function _me(){let e=[],t=null,n=!1,r=EO();const a=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=EO(),await r.promise,a();try{const{value:i,done:s}=await e[0].read();s?(e.shift(),e.length>0?await a():n&&(t==null||t.close())):t==null||t.enqueue(i)}catch(i){t==null||t.error(i),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(i){t=i},pull:a,async cancel(){for(const i of e)await i.cancel();e=[],n=!0}}),addStream:i=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(i.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(i=>i.cancel()),e=[],t==null||t.close()}}}function Sme(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}Gd({prefix:"aiobj",size:24});var v$="AI_NoOutputSpecifiedError",w$=`vercel.ai.error.${v$}`,Eme=Symbol.for(w$),x$,Cme=class extends Tn{constructor({message:e="No output specified."}={}){super({name:v$,message:e}),this[x$]=!0}static isInstance(e){return Tn.hasMarker(e,w$)}};x$=Eme;var _$="AI_ToolExecutionError",S$=`vercel.ai.error.${_$}`,kme=Symbol.for(S$),E$,Tme=class extends Tn{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:a=`Error executing tool ${t}: ${l0(r)}`}){super({name:_$,message:a,cause:r}),this[E$]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return Tn.hasMarker(e,S$)}};E$=kme;function Ame(e){return e!=null&&Object.keys(e).length>0}function Nme({tools:e,toolChoice:t,activeTools:n}){return Ame(e)?{tools:(n!=null?Object.entries(e).filter(([a])=>n.includes(a)):Object.entries(e)).map(([a,i])=>{const s=i.type;switch(s){case void 0:case"function":return{type:"function",name:a,description:i.description,parameters:Lx(i.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:a,id:i.id,args:i.args};default:{const o=s;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var Rme=/^([\s\S]*?)(\s+)(\S*)$/;function Ime(e){const t=e.match(Rme);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var C$="AI_InvalidToolArgumentsError",k$=`vercel.ai.error.${C$}`,jme=Symbol.for(k$),T$,A$=class extends Tn{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${l0(n)}`}){super({name:C$,message:r,cause:n}),this[T$]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return Tn.hasMarker(e,k$)}};T$=jme;var N$="AI_NoSuchToolError",R$=`vercel.ai.error.${N$}`,Ome=Symbol.for(R$),I$,xC=class extends Tn{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:N$,message:n}),this[I$]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return Tn.hasMarker(e,R$)}};I$=Ome;var j$="AI_ToolCallRepairError",O$=`vercel.ai.error.${j$}`,Dme=Symbol.for(O$),D$,Mme=class extends Tn{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${l0(e)}`}){super({name:j$,message:n,cause:e}),this[D$]=!0,this.originalError=t}static isInstance(e){return Tn.hasMarker(e,O$)}};D$=Dme;async function Pme({toolCall:e,tools:t,repairToolCall:n,system:r,messages:a}){if(t==null)throw new xC({toolName:e.toolName});try{return await CO({toolCall:e,tools:t})}catch(i){if(n==null||!(xC.isInstance(i)||A$.isInstance(i)))throw i;let s=null;try{s=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>Lx(t[o].parameters).jsonSchema,system:r,messages:a,error:i})}catch(o){throw new Mme({cause:o,originalError:i})}if(s==null)throw i;return await CO({toolCall:s,tools:t})}}async function CO({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new xC({toolName:e.toolName,availableTools:Object.keys(t)});const a=Lx(r.parameters),i=e.args.trim()===""?Qh({value:{},schema:a}):Id({text:e.args,schema:a});if(i.success===!1)throw new A$({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function Fme(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function kO({text:e="",files:t,reasoning:n,tools:r,toolCalls:a,toolResults:i,messageId:s,generateMessageId:o}){const l=[];return l.push({role:"assistant",content:[...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"}),...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType})),{type:"text",text:e},...a],id:s}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(u=>{const d=r[u.toolName];return(d==null?void 0:d.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:d.experimental_toToolResultContent(u.result),experimental_content:d.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}Gd({prefix:"aitxt",size:24});Gd({prefix:"msg",size:24});var Lme={};jT(Lme,{object:()=>Ume,text:()=>zme});var M$="AI_InvalidStreamPartError",P$=`vercel.ai.error.${M$}`,$me=Symbol.for(P$),F$,Bme=class extends Tn{constructor({chunk:e,message:t}){super({name:M$,message:t}),this[F$]=!0,this.chunk=e}static isInstance(e){return Tn.hasMarker(e,P$)}};F$=$me;var zme=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),Ume=({schema:e})=>{const t=Lx(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:xme({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=khe(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const a=r.state;throw new Error(`Unsupported parse state: ${a}`)}}},parseOutput({text:n},r){const a=Id({text:n});if(!a.success)throw new xO({message:"No object generated: could not parse the response.",cause:a.error,text:n,response:r.response,usage:r.usage});const i=Qh({value:a.value,schema:t});if(!i.success)throw new xO({message:"No object generated: response did not match schema.",cause:i.error,text:n,response:r.response,usage:r.usage});return i.value}}};function L$(e){return e===void 0?[]:Array.isArray(e)?e:[e]}function OT(e,t){const n=e.getReader(),r=t.getReader();let a,i,s=!1,o=!1;async function l(d){try{a==null&&(a=n.read());const h=await a;a=void 0,h.done?d.close():d.enqueue(h.value)}catch(h){d.error(h)}}async function u(d){try{i==null&&(i=r.read());const h=await i;i=void 0,h.done?d.close():d.enqueue(h.value)}catch(h){d.error(h)}}return new ReadableStream({async pull(d){try{if(s){await u(d);return}if(o){await l(d);return}a==null&&(a=n.read()),i==null&&(i=r.read());const{result:h,reader:p}=await Promise.race([a.then(y=>({result:y,reader:n})),i.then(y=>({result:y,reader:r}))]);h.done||d.enqueue(h.value),p===n?(a=void 0,h.done&&(await u(d),s=!0)):(i=void 0,h.done&&(o=!0,await l(d)))}catch(h){d.error(h)}},cancel(){n.cancel(),r.cancel()}})}function qme({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:a,system:i,messages:s,abortSignal:o,repairToolCall:l}){let u=null;const d=new ReadableStream({start(x){u=x}}),h={},p=new Set;let y=!1,v;function b(){y&&p.size===0&&(v!=null&&u.enqueue(v),u.close())}const w=new TransformStream({async transform(x,S){const E=x.type;switch(E){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{S.enqueue(x);break}case"file":{S.enqueue(new Lpe({data:x.data,mimeType:x.mimeType}));break}case"tool-call-delta":{n&&(h[x.toolCallId]||(S.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),h[x.toolCallId]=!0),S.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case"tool-call":{try{const C=await Pme({toolCall:x,tools:e,repairToolCall:l,system:i,messages:s});S.enqueue(C);const k=e[C.toolName];if(k.execute!=null){const R=Po();p.add(R),vC({name:"ai.toolCall",attributes:mh({telemetry:a,attributes:{...bC({operationId:"ai.toolCall",telemetry:a}),"ai.toolCall.name":C.toolName,"ai.toolCall.id":C.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(C.args)}}}),tracer:r,fn:async O=>k.execute(C.args,{toolCallId:C.toolCallId,messages:s,abortSignal:o}).then(j=>{u.enqueue({...C,type:"tool-result",result:j}),p.delete(R),b();try{O.setAttributes(mh({telemetry:a,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(j)}}}))}catch{}},j=>{u.enqueue({type:"error",error:new Tme({toolCallId:C.toolCallId,toolName:C.toolName,toolArgs:C.args,cause:j})}),p.delete(R),b()})})}}catch(C){u.enqueue({type:"error",error:C})}break}case"finish":{v={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:gme(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{const C=E;throw new Error(`Unhandled chunk type: ${C}`)}}},flush(){y=!0,b()}});return new ReadableStream({async start(x){return Promise.all([t.pipeThrough(w).pipeTo(new WritableStream({write(S){x.enqueue(S)},close(){}})),d.pipeTo(new WritableStream({write(S){x.enqueue(S)},close(){x.close()}}))])}})}var Hme=Gd({prefix:"aitxt",size:24}),Vme=Gd({prefix:"msg",size:24});function Gme({model:e,tools:t,toolChoice:n,system:r,prompt:a,messages:i,maxRetries:s,abortSignal:o,headers:l,maxSteps:u=1,experimental_generateMessageId:d=Vme,experimental_output:h,experimental_continueSteps:p=!1,experimental_telemetry:y,experimental_providerMetadata:v,providerOptions:b=v,experimental_toolCallStreaming:w=!1,toolCallStreaming:x=w,experimental_activeTools:S,experimental_repairToolCall:E,experimental_transform:C,onChunk:k,onError:R,onFinish:O,onStepFinish:j,_internal:{now:$=Sme,generateId:L=Hme,currentDate:X=()=>new Date}={},...F}){return new Kme({model:e,telemetry:y,headers:l,settings:F,maxRetries:s,abortSignal:o,system:r,prompt:a,messages:i,tools:t,toolChoice:n,toolCallStreaming:x,transforms:L$(C),activeTools:S,repairToolCall:E,maxSteps:u,output:h,continueSteps:p,providerOptions:b,onChunk:k,onError:R,onFinish:O,onStepFinish:j,now:$,currentDate:X,generateId:L,generateMessageId:d})}function Wme(e){if(!e)return new TransformStream({transform(i,s){s.enqueue({part:i,partialOutput:void 0})}});let t="",n="",r="";function a({controller:i,partialOutput:s=void 0}){i.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:s}),n=""}return new TransformStream({transform(i,s){if(i.type==="step-finish"&&a({controller:s}),i.type!=="text-delta"){s.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(a({controller:s,partialOutput:o.partial}),r=l)}},flush(i){n.length>0&&a({controller:i})}})}var Kme=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:a,abortSignal:i,system:s,prompt:o,messages:l,tools:u,toolChoice:d,toolCallStreaming:h,transforms:p,activeTools:y,repairToolCall:v,maxSteps:b,output:w,continueSteps:x,providerOptions:S,now:E,currentDate:C,generateId:k,generateMessageId:R,onChunk:O,onError:j,onFinish:$,onStepFinish:L}){this.warningsPromise=new Ri,this.usagePromise=new Ri,this.finishReasonPromise=new Ri,this.providerMetadataPromise=new Ri,this.textPromise=new Ri,this.reasoningPromise=new Ri,this.reasoningDetailsPromise=new Ri,this.sourcesPromise=new Ri,this.filesPromise=new Ri,this.toolCallsPromise=new Ri,this.toolResultsPromise=new Ri,this.requestPromise=new Ri,this.responsePromise=new Ri,this.stepsPromise=new Ri;var X;if(b<1)throw new qs({parameter:"maxSteps",value:b,message:"maxSteps must be at least 1"});this.output=w;let F="",K="",q="",de=[],re=[],Y,Q=[];const ae=[],B={id:k(),timestamp:C(),modelId:e.modelId,messages:[]};let J=[],ee=[],oe,me,xe="initial";const Pe=[];let Ne;const Re=new TransformStream({async transform(le,ie){ie.enqueue(le);const{part:te}=le;if((te.type==="text-delta"||te.type==="reasoning"||te.type==="source"||te.type==="tool-call"||te.type==="tool-result"||te.type==="tool-call-streaming-start"||te.type==="tool-call-delta")&&await(O==null?void 0:O({chunk:te})),te.type==="error"&&await(j==null?void 0:j({error:te.error})),te.type==="text-delta"&&(F+=te.textDelta,K+=te.textDelta,q+=te.textDelta),te.type==="reasoning"&&(Y==null?(Y={type:"text",text:te.textDelta},de.push(Y)):Y.text+=te.textDelta),te.type==="reasoning-signature"){if(Y==null)throw new Tn({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});Y.signature=te.signature,Y=void 0}if(te.type==="redacted-reasoning"&&de.push({type:"redacted",data:te.data}),te.type==="file"&&re.push(te),te.type==="source"&&(ae.push(te.source),Q.push(te.source)),te.type==="tool-call"&&J.push(te),te.type==="tool-result"&&ee.push(te),te.type==="step-finish"){const _e=kO({text:K,files:re,reasoning:de,tools:u??{},toolCalls:J,toolResults:ee,messageId:te.messageId,generateMessageId:R}),Me=Pe.length;let Ee="done";Me+1<b&&(x&&te.finishReason==="length"&&J.length===0?Ee="continue":J.length>0&&ee.length===J.length&&(Ee="tool-result"));const We={stepType:xe,text:F,reasoning:Fme(de),reasoningDetails:de,files:re,sources:Q,toolCalls:J,toolResults:ee,finishReason:te.finishReason,usage:te.usage,warnings:te.warnings,logprobs:te.logprobs,request:te.request,response:{...te.response,messages:[...B.messages,..._e]},providerMetadata:te.experimental_providerMetadata,experimental_providerMetadata:te.experimental_providerMetadata,isContinued:te.isContinued};await(L==null?void 0:L(We)),Pe.push(We),J=[],ee=[],F="",Q=[],de=[],re=[],Y=void 0,Ee!=="done"&&(xe=Ee),Ee!=="continue"&&(B.messages.push(..._e),K="")}te.type==="finish"&&(B.id=te.response.id,B.timestamp=te.response.timestamp,B.modelId=te.response.modelId,B.headers=te.response.headers,me=te.usage,oe=te.finishReason)},async flush(le){var ie;try{if(Pe.length===0)return;const te=Pe[Pe.length-1];Te.warningsPromise.resolve(te.warnings),Te.requestPromise.resolve(te.request),Te.responsePromise.resolve(te.response),Te.toolCallsPromise.resolve(te.toolCalls),Te.toolResultsPromise.resolve(te.toolResults),Te.providerMetadataPromise.resolve(te.experimental_providerMetadata),Te.reasoningPromise.resolve(te.reasoning),Te.reasoningDetailsPromise.resolve(te.reasoningDetails);const _e=oe??"unknown",Me=me??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Te.finishReasonPromise.resolve(_e),Te.usagePromise.resolve(Me),Te.textPromise.resolve(q),Te.sourcesPromise.resolve(ae),Te.filesPromise.resolve(te.files),Te.stepsPromise.resolve(Pe),await($==null?void 0:$({finishReason:_e,logprobs:void 0,usage:Me,text:q,reasoning:te.reasoning,reasoningDetails:te.reasoningDetails,files:te.files,sources:te.sources,toolCalls:te.toolCalls,toolResults:te.toolResults,request:(ie=te.request)!=null?ie:{},response:te.response,warnings:te.warnings,providerMetadata:te.providerMetadata,experimental_providerMetadata:te.experimental_providerMetadata,steps:Pe})),Ne.setAttributes(mh({telemetry:t,attributes:{"ai.response.finishReason":_e,"ai.response.text":{output:()=>q},"ai.response.toolCalls":{output:()=>{var Ee;return(Ee=te.toolCalls)!=null&&Ee.length?JSON.stringify(te.toolCalls):void 0}},"ai.usage.promptTokens":Me.promptTokens,"ai.usage.completionTokens":Me.completionTokens}}))}catch(te){le.error(te)}finally{Ne.end()}}}),ke=_me();this.addStream=ke.addStream,this.closeStream=ke.close;let Fe=ke.stream;for(const le of p)Fe=Fe.pipeThrough(le({tools:u,stopStream(){ke.terminate()}}));this.baseStream=Fe.pipeThrough(Wme(w)).pipeThrough(Re);const{maxRetries:Qe,retry:Le}=jpe({maxRetries:a}),Ie=Ppe(t),V=Ope({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:Qe}}),ge=mme({prompt:{system:(X=w==null?void 0:w.injectIntoSystemPrompt({system:s,model:e}))!=null?X:s,prompt:o,messages:l},tools:u}),Te=this;vC({name:"ai.streamText",attributes:mh({telemetry:t,attributes:{...bC({operationId:"ai.streamText",telemetry:t}),...V,"ai.prompt":{input:()=>JSON.stringify({system:s,prompt:o,messages:l})},"ai.settings.maxSteps":b}}),tracer:Ie,endWhenDone:!1,fn:async le=>{Ne=le;async function ie({currentStep:te,responseMessages:_e,usage:Me,stepType:Ee,previousStepText:We,hasLeadingWhitespace:kt,messageId:it}){var xt;const Dt=_e.length===0?ge.type:"messages",Ot=[...ge.messages,..._e],Wt=await Zpe({prompt:{type:Dt,system:ge.system,messages:Ot},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(xt=e.supportsUrl)==null?void 0:xt.bind(e)}),be={type:"regular",...Nme({tools:u,toolChoice:d,activeTools:y})},{result:{stream:I,warnings:G,rawResponse:fe,request:je},doStreamSpan:ve,startTimestampMs:Ce}=await Le(()=>vC({name:"ai.streamText.doStream",attributes:mh({telemetry:t,attributes:{...bC({operationId:"ai.streamText.doStream",telemetry:t}),...V,"ai.prompt.format":{input:()=>Dt},"ai.prompt.messages":{input:()=>JSON.stringify(Wt)},"ai.prompt.tools":{input:()=>{var Tt;return(Tt=be.tools)==null?void 0:Tt.map(Pt=>JSON.stringify(Pt))}},"ai.prompt.toolChoice":{input:()=>be.toolChoice!=null?JSON.stringify(be.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:Ie,endWhenDone:!1,fn:async Tt=>({startTimestampMs:E(),doStreamSpan:Tt,result:await e.doStream({mode:be,...Qpe(r),inputFormat:Dt,responseFormat:w==null?void 0:w.responseFormat({model:e}),prompt:Wt,providerMetadata:S,abortSignal:i,headers:n})})})),ce=qme({tools:u,generatorStream:I,toolCallStreaming:h,tracer:Ie,telemetry:t,system:s,messages:Ot,repairToolCall:v,abortSignal:i}),ft=je??{},vt=[],M=[],Be=[],nt=[];let ye,Oe="unknown",Ke={promptTokens:0,completionTokens:0,totalTokens:0},Rt,pe=!0,H="",U=Ee==="continue"?We:"",W,he={id:k(),timestamp:C(),modelId:e.modelId},Ae="",qe=!1,pt=!0,Gt=!1;async function ut({controller:Tt,chunk:Pt}){Tt.enqueue(Pt),H+=Pt.textDelta,U+=Pt.textDelta,qe=!0,Gt=Pt.textDelta.trimEnd()!==Pt.textDelta}Te.addStream(ce.pipeThrough(new TransformStream({async transform(Tt,Pt){var Jt,An,Hn;if(pe){const xr=E()-Ce;pe=!1,ve.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":xr}),ve.setAttributes({"ai.response.msToFirstChunk":xr}),Pt.enqueue({type:"step-start",messageId:it,request:ft,warnings:G??[]})}if(Tt.type==="text-delta"&&Tt.textDelta.length===0)return;const wr=Tt.type;switch(wr){case"text-delta":{if(x){const xr=pt&&kt?Tt.textDelta.trimStart():Tt.textDelta;if(xr.length===0)break;pt=!1,Ae+=xr;const Mn=Ime(Ae);Mn!=null&&(Ae=Mn.suffix,await ut({controller:Pt,chunk:{type:"text-delta",textDelta:Mn.prefix+Mn.whitespace}}))}else await ut({controller:Pt,chunk:Tt});break}case"reasoning":{Pt.enqueue(Tt),ye==null?(ye={type:"text",text:Tt.textDelta},Be.push(ye)):ye.text+=Tt.textDelta;break}case"reasoning-signature":{if(Pt.enqueue(Tt),ye==null)throw new Bme({chunk:Tt,message:"reasoning-signature without reasoning"});ye.signature=Tt.signature,ye=void 0;break}case"redacted-reasoning":{Pt.enqueue(Tt),Be.push({type:"redacted",data:Tt.data});break}case"tool-call":{Pt.enqueue(Tt),vt.push(Tt);break}case"tool-result":{Pt.enqueue(Tt),M.push(Tt);break}case"response-metadata":{he={id:(Jt=Tt.id)!=null?Jt:he.id,timestamp:(An=Tt.timestamp)!=null?An:he.timestamp,modelId:(Hn=Tt.modelId)!=null?Hn:he.modelId};break}case"finish":{Ke=Tt.usage,Oe=Tt.finishReason,Rt=Tt.experimental_providerMetadata,W=Tt.logprobs;const xr=E()-Ce;ve.addEvent("ai.stream.finish"),ve.setAttributes({"ai.response.msToFinish":xr,"ai.response.avgCompletionTokensPerSecond":1e3*Ke.completionTokens/xr});break}case"file":{nt.push(Tt),Pt.enqueue(Tt);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{Pt.enqueue(Tt);break}case"error":{Pt.enqueue(Tt),Oe="error";break}default:{const xr=wr;throw new Error(`Unknown chunk type: ${xr}`)}}},async flush(Tt){const Pt=vt.length>0?JSON.stringify(vt):void 0;let Jt="done";te+1<b&&(x&&Oe==="length"&&vt.length===0?Jt="continue":vt.length>0&&M.length===vt.length&&(Jt="tool-result")),x&&Ae.length>0&&(Jt!=="continue"||Ee==="continue"&&!qe)&&(await ut({controller:Tt,chunk:{type:"text-delta",textDelta:Ae}}),Ae="");try{ve.setAttributes(mh({telemetry:t,attributes:{"ai.response.finishReason":Oe,"ai.response.text":{output:()=>H},"ai.response.toolCalls":{output:()=>Pt},"ai.response.id":he.id,"ai.response.model":he.modelId,"ai.response.timestamp":he.timestamp.toISOString(),"ai.usage.promptTokens":Ke.promptTokens,"ai.usage.completionTokens":Ke.completionTokens,"gen_ai.response.finish_reasons":[Oe],"gen_ai.response.id":he.id,"gen_ai.response.model":he.modelId,"gen_ai.usage.input_tokens":Ke.promptTokens,"gen_ai.usage.output_tokens":Ke.completionTokens}}))}catch{}finally{ve.end()}Tt.enqueue({type:"step-finish",finishReason:Oe,usage:Ke,providerMetadata:Rt,experimental_providerMetadata:Rt,logprobs:W,request:ft,response:{...he,headers:fe==null?void 0:fe.headers},warnings:G,isContinued:Jt==="continue",messageId:it});const An=yme(Me,Ke);if(Jt==="done")Tt.enqueue({type:"finish",finishReason:Oe,usage:An,providerMetadata:Rt,experimental_providerMetadata:Rt,logprobs:W,response:{...he,headers:fe==null?void 0:fe.headers}}),Te.closeStream();else{if(Ee==="continue"){const Hn=_e[_e.length-1];typeof Hn.content=="string"?Hn.content+=H:Hn.content.push({text:H,type:"text"})}else _e.push(...kO({text:H,files:nt,reasoning:Be,tools:u??{},toolCalls:vt,toolResults:M,messageId:it,generateMessageId:R}));await ie({currentStep:te+1,responseMessages:_e,usage:An,stepType:Jt,previousStepText:U,hasLeadingWhitespace:Gt,messageId:Jt==="continue"?it:R()})}}})))}await ie({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:R()})}}).catch(le=>{Te.addStream(new ReadableStream({start(ie){ie.enqueue({type:"error",error:le}),ie.close()}})),Te.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return e2(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return e2(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(){const e=this.fullStream;for await(const t of e);}get experimental_partialOutputStream(){if(this.output==null)throw new Cme;return e2(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:a=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,s)=>{const o=i.type;switch(o){case"text-delta":{s.enqueue(ri("text",i.textDelta));break}case"reasoning":{n&&s.enqueue(ri("reasoning",i.textDelta));break}case"redacted-reasoning":{n&&s.enqueue(ri("redacted_reasoning",{data:i.data}));break}case"reasoning-signature":{n&&s.enqueue(ri("reasoning_signature",{signature:i.signature}));break}case"file":{s.enqueue(ri("file",{mimeType:i.mimeType,data:i.base64}));break}case"source":{r&&s.enqueue(ri("source",i.source));break}case"tool-call-streaming-start":{s.enqueue(ri("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break}case"tool-call-delta":{s.enqueue(ri("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break}case"tool-call":{s.enqueue(ri("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break}case"tool-result":{s.enqueue(ri("tool_result",{toolCallId:i.toolCallId,result:i.result}));break}case"error":{s.enqueue(ri("error",e(i.error)));break}case"step-start":{s.enqueue(ri("start_step",{messageId:i.messageId}));break}case"step-finish":{s.enqueue(ri("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break}case"finish":{a&&s.enqueue(ri("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:a,getErrorMessage:i,sendUsage:s,sendReasoning:o,sendSources:l,experimental_sendFinish:u}={}){vO({response:e,status:t,statusText:n,headers:bO(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:a,getErrorMessage:i,sendUsage:s,sendReasoning:o,sendSources:l,experimental_sendFinish:u})})}pipeTextStreamToResponse(e,t){vO({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:bO(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?OT(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:a,sendUsage:i,sendReasoning:s,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:a,sendUsage:i,sendReasoning:s,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:gw(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:gw(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};function Zme(e,t){if(t.length===0)return null;const n=e.indexOf(t);if(n!==-1)return n;for(let r=e.length-1;r>=0;r--){const a=e.substring(r);if(t.startsWith(a))return r}return null}function Yme({tagName:e,separator:t=`
`,startWithReasoning:n=!1}){const r=`<${e}>`,a=`</${e}>`;return{middlewareVersion:"v1",wrapGenerate:async({doGenerate:i})=>{const{text:s,...o}=await i();if(s==null)return{text:s,...o};const l=n?r+s:s,u=new RegExp(`${r}(.*?)${a}`,"gs"),d=Array.from(l.matchAll(u));if(!d.length)return{text:l,...o};const h=d.map(y=>y[1]).join(t);let p=l;for(let y=d.length-1;y>=0;y--){const v=d[y],b=p.slice(0,v.index),w=p.slice(v.index+v[0].length);p=b+(b.length>0&&w.length>0?t:"")+w}return{...o,text:p,reasoning:h}},wrapStream:async({doStream:i})=>{const{stream:s,...o}=await i();let l=!0,u=!0,d=!1,h=n,p="";return{stream:s.pipeThrough(new TransformStream({transform:(y,v)=>{if(y.type!=="text-delta"){v.enqueue(y);return}p+=y.textDelta;function b(w){if(w.length>0){const x=d&&(h?!l:!u)?t:"";v.enqueue({type:h?"reasoning":"text-delta",textDelta:x+w}),d=!1,h?l=!1:u=!1}}do{const w=h?a:r,x=Zme(p,w);if(x==null){b(p),p="";break}if(b(p.slice(0,x)),x+w.length<=p.length)p=p.slice(x+w.length),h=!h,d=!0;else{p=p.slice(x);break}}while(!0)}})),...o}}}}var Xme=({model:e,middleware:t,modelId:n,providerId:r})=>L$(t).reverse().reduce((a,i)=>Jme({model:a,middleware:i,modelId:n,providerId:r}),e),Jme=({model:e,middleware:{transformParams:t,wrapGenerate:n,wrapStream:r},modelId:a,providerId:i})=>{var s;async function o({params:l,type:u}){return t?await t({params:l,type:u}):l}return{specificationVersion:"v1",provider:i??e.provider,modelId:a??e.modelId,defaultObjectGenerationMode:e.defaultObjectGenerationMode,supportsImageUrls:e.supportsImageUrls,supportsUrl:(s=e.supportsUrl)==null?void 0:s.bind(e),supportsStructuredOutputs:e.supportsStructuredOutputs,async doGenerate(l){const u=await o({params:l,type:"generate"}),d=async()=>e.doGenerate(u);return n?n({doGenerate:d,doStream:async()=>e.doStream(u),params:u,model:e}):d()},async doStream(l){const u=await o({params:l,type:"stream"}),d=async()=>e.doGenerate(u),h=async()=>e.doStream(u);return r?r({doGenerate:d,doStream:h,params:u,model:e}):h()}}},Qme=z.object({name:z.string(),version:z.string()}).passthrough(),DT=z.object({_meta:z.optional(z.object({}).passthrough())}).passthrough(),Jg=DT,ege=z.object({method:z.string(),params:z.optional(DT)}),tge=z.object({experimental:z.optional(z.object({}).passthrough()),logging:z.optional(z.object({}).passthrough()),prompts:z.optional(z.object({listChanged:z.optional(z.boolean())}).passthrough()),resources:z.optional(z.object({subscribe:z.optional(z.boolean()),listChanged:z.optional(z.boolean())}).passthrough()),tools:z.optional(z.object({listChanged:z.optional(z.boolean())}).passthrough())}).passthrough();Jg.extend({protocolVersion:z.string(),capabilities:tge,serverInfo:Qme,instructions:z.optional(z.string())});var nge=Jg.extend({nextCursor:z.optional(z.string())}),rge=z.object({name:z.string(),description:z.optional(z.string()),inputSchema:z.object({type:z.literal("object"),properties:z.optional(z.object({}).passthrough())}).passthrough()}).passthrough();nge.extend({tools:z.array(rge)});var age=z.object({type:z.literal("text"),text:z.string()}).passthrough(),ige=z.object({type:z.literal("image"),data:z.string().base64(),mimeType:z.string()}).passthrough(),$$=z.object({uri:z.string(),mimeType:z.optional(z.string())}).passthrough(),sge=$$.extend({text:z.string()}),oge=$$.extend({blob:z.string().base64()}),lge=z.object({type:z.literal("resource"),resource:z.union([sge,oge])}).passthrough();Jg.extend({content:z.array(z.union([age,ige,lge])),isError:z.boolean().default(!1).optional()}).or(Jg.extend({toolResult:z.unknown()}));var $x="2.0",cge=z.object({jsonrpc:z.literal($x),id:z.union([z.string(),z.number().int()])}).merge(ege).strict(),uge=z.object({jsonrpc:z.literal($x),id:z.union([z.string(),z.number().int()]),result:Jg}).strict(),dge=z.object({jsonrpc:z.literal($x),id:z.union([z.string(),z.number().int()]),error:z.object({code:z.number().int(),message:z.string(),data:z.optional(z.unknown())})}).strict(),fge=z.object({jsonrpc:z.literal($x)}).merge(z.object({method:z.string(),params:z.optional(DT)})).strict();z.union([cge,fge,uge,dge]);var hge={};jT(hge,{mergeIntoDataStream:()=>gge,toDataStream:()=>pge,toDataStreamResponse:()=>mge});function B$(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,a){a.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function MT(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var a;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&TO((a=n.data)==null?void 0:a.chunk,r);return}TO(n,r)}})).pipeThrough(B$(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(ri("text",n))}}))}function pge(e,t){return MT(e,t).pipeThrough(new TextEncoderStream)}function mge(e,t){var n;const r=MT(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),a=t==null?void 0:t.data,i=t==null?void 0:t.init,s=a?OT(a.stream,r):r;return new Response(s,{status:(n=i==null?void 0:i.status)!=null?n:200,statusText:i==null?void 0:i.statusText,headers:gw(i==null?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function gge(e,t){t.dataStream.merge(MT(e,t.callbacks))}function TO(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var yge={};jT(yge,{mergeIntoDataStream:()=>wge,toDataStream:()=>bge,toDataStreamResponse:()=>vge});function PT(e,t){const n=xge();return PV(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,a){a.enqueue(n(r.delta))}})).pipeThrough(B$(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,a)=>{a.enqueue(ri("text",r))}}))}function bge(e,t){return PT(e,t).pipeThrough(new TextEncoderStream)}function vge(e,t={}){var n;const{init:r,data:a,callbacks:i}=t,s=PT(e,i).pipeThrough(new TextEncoderStream),o=a?OT(a.stream,s):s;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:gw(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function wge(e,t){t.dataStream.merge(PT(e,t.callbacks))}function xge(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class _ge{static async executeInteraction(t,n,r){let a,i=!1;try{a=await Gme(n);for await(const s of a.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(s.type){case"text-delta":r.onChunk(s.textDelta);break;case"tool-call":r.onToolCall(s);break;case"tool-result":r.onToolResult(s);break;case"finish":i=!0,r.onFinish({finishReason:s.finishReason,usage:s.usage,providerMetadata:s.providerMetadata});break;case"error":r.onError(new Error(`AI Stream Error Part: ${s.error instanceof Error?s.error.message:s.error}`));return;default:break}}!n.abortSignal.aborted&&!i&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(s){console.error(`[AIService] Error during streamText call for ${t}:`,s),s instanceof Error&&s.name==="AbortError"||r.onError(s instanceof Error?s:new Error(String(s)))}finally{console.log(`[AIService] Stream processing loop finished for ${t}.`)}}}const _C={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,async startInteraction(e,t,n){var F,K,q,de,re,Y,Q,ae,B;console.log("[InteractionService] startInteraction called",e,t,n);const r=await $2(pv.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(r===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const a=r&&typeof r=="object"?r.prompt:e,i=Pi(),s=new AbortController;this._activeControllers.set(i,s),this._streamingToolData.set(i,{calls:[],results:[]}),this._firstChunkTimestamps.delete(i),this._interactionStartTimes.delete(i);const o=Zn.getState(),u=o.interactions.filter(J=>J.conversationId===t),d=u.reduce((J,ee)=>Math.max(J,ee.index),-1)+1,h=u.length>0?u[u.length-1].id:null,p=performance.now();this._interactionStartTimes.set(i,p);const y={id:i,conversationId:t,type:"message.user_assistant",prompt:{...n},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...a.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0,timeToFirstToken:void 0,generationTime:void 0},index:d,parentId:h};o._addInteractionToState(y),o._addStreamingId(i),Ft.saveInteraction({...y}).catch(J=>{console.error(`[InteractionService] Failed initial persistence for ${i}`,J)}),St.emit(_t.INTERACTION_STARTED,{interactionId:i,conversationId:t,type:y.type});const v=(F=a.metadata)==null?void 0:F.modelId;if(!v)return this._finalizeInteraction(i,"ERROR",new Error("No model ID specified in prompt metadata.")),null;const{providerId:b,modelId:w}=Ql(v);if(!b||!w)return this._finalizeInteraction(i,"ERROR",new Error(`Invalid combined model ID format: ${v}`)),null;const x=Fn.getState().dbProviderConfigs.find(J=>J.id===b);if(!x)return this._finalizeInteraction(i,"ERROR",new Error(`Provider configuration not found for ID: ${b}`)),null;const S=Fn.getState().getApiKeyForProvider(b),E=n8(x,w,S);if(!E)return this._finalizeInteraction(i,"ERROR",new Error(`Failed to instantiate model instance for ${v} from provider ${x.name}`)),null;console.log(`[InteractionService] Using model instance for ${v}`);const C=Dr.getState().getRegisteredTools(),R=(((K=a.metadata)==null?void 0:K.enabledTools)??[]).reduce((J,ee)=>{const oe=C[ee];if(oe!=null&&oe.implementation){const me={...oe.definition};me.execute=async xe=>{const Pe=Zn.getState().currentConversationId,Ne=Pe?mn.getState().getConversationById(Pe):null,Re=(Ne==null?void 0:Ne.projectId)??"orphan";let ke;try{console.log(`[InteractionService Tool Execute] Ensuring VFS ready for key "${Re}"...`),ke=await Xs.getState().initializeVFS(Re,{force:!0}),console.log(`[InteractionService Tool Execute] VFS ready for key "${Re}".`)}catch(Fe){return console.error(`[InteractionService Tool Execute] VFS initialization error for key "${Re}":`,Fe),{_isError:!0,error:`Filesystem error: ${Fe.message}`}}try{const Fe=tX(),Qe=oe.definition.parameters.parse(xe),Le=oe.implementation,Ie={...Fe,fsInstance:ke};return await Le(Qe,Ie)}catch(Fe){const Qe=Fe instanceof Error?Fe.message:String(Fe);return Fe instanceof z.ZodError?{_isError:!0,error:`Invalid arguments: ${Fe.errors.map(Le=>`${Le.path.join(".")} (${Le.message})`).join(", ")}`}:{_isError:!0,error:Qe}}},J[ee]=me}return J},{}),O=((q=a.parameters)==null?void 0:q.maxSteps)??qr.getState().toolMaxSteps,j=Yme({tagName:"reasoning"}),L={model:Xme({model:E,middleware:j}),messages:a.messages,abortSignal:s.signal,system:a.system,temperature:(de=a.parameters)==null?void 0:de.temperature,maxTokens:(re=a.parameters)==null?void 0:re.max_tokens,topP:(Y=a.parameters)==null?void 0:Y.top_p,topK:(Q=a.parameters)==null?void 0:Q.top_k,presencePenalty:(ae=a.parameters)==null?void 0:ae.presence_penalty,frequencyPenalty:(B=a.parameters)==null?void 0:B.frequency_penalty,maxSteps:O,...Object.keys(R).length>0&&{tools:R},toolChoice:a.toolChoice??(Object.keys(R).length>0?"auto":"none")},X={onChunk:J=>this._handleChunk(i,J),onToolCall:J=>this._handleToolCall(i,J),onToolResult:J=>this._handleToolResult(i,J),onFinish:J=>this._handleFinish(i,J),onError:J=>this._handleError(i,J)};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${i}`),_ge.executeInteraction(i,L,X).catch(J=>{console.error(`[InteractionService] Error calling AIService.executeInteraction for ${i}:`,J),this._handleError(i,J instanceof Error?J:new Error("Failed to start AI execution"))}),i},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);t&&!t.signal.aborted?(t.abort(),tt.info("Interaction cancelled.")):(console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`),Zn.getState().streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"))))},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await $2(pv.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const a=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;Zn.getState().appendInteractionResponseChunk(e,a),St.emit(_t.INTERACTION_STREAM_CHUNK,{interactionId:e,chunk:a})}},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),Zn.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),Zn.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},_handleFinish(e,t){console.log(`[InteractionService] Finishing interaction ${e}. Reason: ${t.finishReason}`),this._finalizeInteraction(e,"COMPLETED",void 0,t)},_handleError(e,t){console.error(`[InteractionService] Handling error for interaction ${e}:`,t);const n=t.name==="AbortError";this._finalizeInteraction(e,n?"CANCELLED":"ERROR",n?void 0:t)},_finalizeInteraction(e,t,n,r){var E;const a=Zn.getState(),i=a.interactions.find(C=>C.id===e);if(!i||i.status!=="STREAMING"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const s=a.activeStreamBuffers[e]??"",o=this._streamingToolData.get(e)||{calls:[],results:[]},l=i.metadata||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${s.length}`);const u=performance.now(),d=this._interactionStartTimes.get(e),h=this._firstChunkTimestamps.get(e),p=d?Math.round(u-d):void 0,y=d&&h?Math.round(h-d):void 0,v=r==null?void 0:r.reasoning,b={status:t,endedAt:new Date,response:s||null,metadata:{...l,...(r==null?void 0:r.usage)&&{promptTokens:r.usage.promptTokens,completionTokens:r.usage.completionTokens,totalTokens:r.usage.totalTokens},...(r==null?void 0:r.providerMetadata)&&{providerMetadata:r.providerMetadata},toolCalls:o.calls,toolResults:o.results,reasoning:v,timeToFirstToken:y,generationTime:p,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};a._updateInteractionInState(e,b),a._removeStreamingId(e);const w=Zn.getState().interactions.find(C=>C.id===e);w?(console.log(`[InteractionService] Persisting final state for ${e}. Response length: ${((E=w.response)==null?void 0:E.length)??0}`),Ft.saveInteraction({...w}).catch(C=>{console.error(`[InteractionService] Failed final persistence for ${e}`,C)})):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let x=[],S=[];try{x=o.calls.map(C=>JSON.parse(C)),S=o.results.map(C=>JSON.parse(C))}catch(C){console.error("[InteractionService] Failed to parse tool strings for event emitter:",C)}St.emit(_t.INTERACTION_COMPLETED,{interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:x,toolResults:S}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e),console.log(`[InteractionService] Finalized interaction ${e} with status ${t}.`)}},Io=(e,t)=>{St.emit(_t.PROMPT_PARAMS_CHANGED,{params:{[e]:t}})},Ca=As(Ns((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),Io("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),Io("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),Io("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),Io("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),Io("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),Io("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),Io("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),Io("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),Io("webSearchEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),Io("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),a={};let i=!1;r.modelId!==n.modelId&&(a.modelId=n.modelId,i=!0),r.temperature!==n.temperature&&(a.temperature=n.temperature,i=!0),r.maxTokens!==n.maxTokens&&(a.maxTokens=n.maxTokens,i=!0),r.topP!==n.topP&&(a.topP=n.topP,i=!0),r.topK!==n.topK&&(a.topK=n.topK,i=!0),r.presencePenalty!==n.presencePenalty&&(a.presencePenalty=n.presencePenalty,i=!0),r.frequencyPenalty!==n.frequencyPenalty&&(a.frequencyPenalty=n.frequencyPenalty,i=!0),i&&(e(a),St.emit(_t.PROMPT_PARAMS_CHANGED,{params:a}))},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let a=!1;n.temperature!==null&&(r.temperature=null,a=!0),n.maxTokens!==null&&(r.maxTokens=null,a=!0),n.topP!==null&&(r.topP=null,a=!0),n.topK!==null&&(r.topK=null,a=!0),n.presencePenalty!==null&&(r.presencePenalty=null,a=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,a=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,a=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,a=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,a=!0),a&&(e(r),St.emit(_t.PROMPT_PARAMS_CHANGED,{params:r}))}}))),Xl=As(Ns((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,a]=await Promise.all([Ft.loadRules(),Ft.loadTags(),Ft.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:a,isLoading:!1})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),tt.error("Failed to load rules and tags.")}},addRule:async n=>{const r=Pi(),a=new Date,i={id:r,createdAt:a,updatedAt:a,...n};e(s=>{s.rules.push(i),s.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{return await Ft.saveRule(i),tt.success(`Rule "${i.name}" added.`),r}catch(s){throw console.error("RulesStore: Error adding rule",s),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),tt.error("Failed to save new rule."),s}},updateRule:async(n,r)=>{const a=t().rules.find(s=>s.id===n);if(!a)return;const i={...a,...r,updatedAt:new Date};e(s=>{const o=s.rules.findIndex(l=>l.id===n);o!==-1&&(s.rules[o]=i,s.rules.sort((l,u)=>l.name.localeCompare(u.name)))});try{await Ft.saveRule(i),tt.success(`Rule "${i.name}" updated.`)}catch(s){throw console.error("RulesStore: Error updating rule",s),e(o=>{const l=o.rules.findIndex(u=>u.id===n);l!==-1&&(o.rules[l]=a,o.rules.sort((u,d)=>u.name.localeCompare(d.name))),o.error="Failed to save rule update"}),tt.error("Failed to save rule update."),s}},deleteRule:async n=>{const r=t().rules.find(i=>i.id===n);if(!r)return;const a=t().tagRuleLinks.filter(i=>i.ruleId===n);e(i=>({rules:i.rules.filter(s=>s.id!==n),tagRuleLinks:i.tagRuleLinks.filter(s=>s.ruleId!==n)}));try{await Ft.deleteRule(n),tt.success(`Rule "${r.name}" deleted.`)}catch(i){throw console.error("RulesStore: Error deleting rule",i),e(s=>{s.rules.push(r),s.rules.sort((o,l)=>o.name.localeCompare(l.name)),s.tagRuleLinks.push(...a),s.error="Failed to delete rule"}),tt.error("Failed to delete rule."),i}},addTag:async n=>{const r=Pi(),a=new Date,i={id:r,createdAt:a,updatedAt:a,...n};e(s=>{s.tags.push(i),s.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{return await Ft.saveTag(i),tt.success(`Tag "${i.name}" added.`),r}catch(s){throw console.error("RulesStore: Error adding tag",s),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),tt.error("Failed to save new tag."),s}},updateTag:async(n,r)=>{const a=t().tags.find(s=>s.id===n);if(!a)return;const i={...a,...r,updatedAt:new Date};e(s=>{const o=s.tags.findIndex(l=>l.id===n);o!==-1&&(s.tags[o]=i,s.tags.sort((l,u)=>l.name.localeCompare(u.name)))});try{await Ft.saveTag(i),tt.success(`Tag "${i.name}" updated.`)}catch(s){throw console.error("RulesStore: Error updating tag",s),e(o=>{const l=o.tags.findIndex(u=>u.id===n);l!==-1&&(o.tags[l]=a,o.tags.sort((u,d)=>u.name.localeCompare(d.name))),o.error="Failed to save tag update"}),tt.error("Failed to save tag update."),s}},deleteTag:async n=>{const r=t().tags.find(i=>i.id===n);if(!r)return;const a=t().tagRuleLinks.filter(i=>i.tagId===n);e(i=>({tags:i.tags.filter(s=>s.id!==n),tagRuleLinks:i.tagRuleLinks.filter(s=>s.tagId!==n)}));try{await Ft.deleteTag(n),tt.success(`Tag "${r.name}" deleted.`)}catch(i){throw console.error("RulesStore: Error deleting tag",i),e(s=>{s.tags.push(r),s.tags.sort((o,l)=>o.name.localeCompare(l.name)),s.tagRuleLinks.push(...a),s.error="Failed to delete tag"}),tt.error("Failed to delete tag."),i}},linkTagToRule:async(n,r)=>{const a=`${n}-${r}`;if(t().tagRuleLinks.find(o=>o.id===a))return;const s={id:a,tagId:n,ruleId:r};e(o=>{o.tagRuleLinks.push(s)});try{await Ft.saveTagRuleLink(s)}catch(o){throw console.error("RulesStore: Error linking tag to rule",o),e(l=>({error:"Failed to link tag and rule",tagRuleLinks:l.tagRuleLinks.filter(u=>u.id!==a)})),tt.error("Failed to link tag and rule."),o}},unlinkTagFromRule:async(n,r)=>{const a=`${n}-${r}`,i=t().tagRuleLinks.find(s=>s.id===a);if(i){e(s=>({tagRuleLinks:s.tagRuleLinks.filter(o=>o.id!==a)}));try{await Ft.deleteTagRuleLink(a)}catch(s){throw console.error("RulesStore: Error unlinking tag from rule",s),e(o=>{o.tagRuleLinks.push(i),o.error="Failed to unlink tag and rule"}),tt.error("Failed to unlink tag and rule."),s}}},getRulesForTag:n=>{const r=t(),a=new Set(r.tagRuleLinks.filter(i=>i.tagId===n).map(i=>i.ruleId));return r.rules.filter(i=>a.has(i.id))},getTagsForRule:n=>{const r=t(),a=new Set(r.tagRuleLinks.filter(i=>i.ruleId===n).map(i=>i.tagId));return r.tags.filter(i=>a.has(i.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(a=>r.has(a.id))}}))),AO={async submitPrompt(e){var X,F,K,q,de;console.log("[ConversationService] submitPrompt called",e);const t=Zn.getState(),n=ii.getState(),r=Ca.getState(),a=mn.getState(),i=Xl.getState(),s=t.currentConversationId;if(!s){tt.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=a.getConversationById(s),l=(o==null?void 0:o.projectId)??null,d=t.interactions.filter(re=>re.status==="COMPLETED"&&re.type==="message.user_assistant"),h=p3(d);let p=e.content;const y=[],v=((X=e.metadata)==null?void 0:X.activeTagIds)??[],b=((F=e.metadata)==null?void 0:F.activeRuleIds)??[],w=new Set(b);v.forEach(re=>{i.getRulesForTag(re).forEach(Y=>w.add(Y.id))});const x=i.getRulesByIds(Array.from(w))||[],S=x.filter(re=>re.type==="system").map(re=>re.content),E=x.filter(re=>re.type==="before").map(re=>re.content),C=x.filter(re=>re.type==="after").map(re=>re.content);E.length>0&&(p=`${E.join(`

`)}

${p}`),C.length>0&&(p=`${p}

${C.join(`

`)}`),p&&y.push({type:"text",text:p});const k=((K=e.metadata)==null?void 0:K.attachedFiles)??[];if(k.length>0){const re=await this._processFilesForPrompt(k,s);y.unshift(...re)}y.length>0?h.push({role:"user",content:y}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");const R=(q=e.metadata)==null?void 0:q.turnSystemPrompt,O=n.getEffectiveProjectSettings(l);let j=R??O.systemPrompt??void 0;S.length>0&&(j=`${j?`${j}

`:""}${S.join(`

`)}`);const $={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys($).forEach(re=>{($[re]===null||$[re]===void 0)&&delete $[re]});const L={system:j,messages:h,parameters:$,metadata:{...(({turnSystemPrompt:re,activeTagIds:Y,activeRuleIds:Q,...ae})=>ae)(e.metadata??{}),modelId:r.modelId,attachedFiles:(de=e.metadata.attachedFiles)==null?void 0:de.map(({contentBase64:re,contentText:Y,...Q})=>Q)}};try{await _C.startInteraction(L,s,e)}catch(re){throw console.error("[ConversationService] Error starting interaction:",re),tt.error(`Failed to start interaction: ${re instanceof Error?re.message:String(re)}`),re}},async regenerateInteraction(e){var K,q,de,re;console.log("[ConversationService] regenerateInteraction called",e);const t=Zn.getState(),n=ii.getState(),r=Ca.getState(),a=mn.getState(),i=Xl.getState(),s=t.interactions.find(Y=>Y.id===e);if(!s||!s.prompt){tt.error("Cannot regenerate: Original interaction data missing.");return}const o=s.prompt,l=s.conversationId,u=a.getConversationById(l),d=(u==null?void 0:u.projectId)??null,h=s.index,p=t.interactions.filter(Y=>Y.conversationId===l&&Y.index<h&&Y.status==="COMPLETED"&&Y.type==="message.user_assistant").sort((Y,Q)=>Y.index-Q.index),y=p3(p);let v=o.content;const b=[],w=((K=o.metadata)==null?void 0:K.activeTagIds)??[],x=((q=o.metadata)==null?void 0:q.activeRuleIds)??[],S=new Set(x);w.forEach(Y=>{i.getRulesForTag(Y).forEach(Q=>S.add(Q.id))});const E=i.getRulesByIds(Array.from(S))||[],C=E.filter(Y=>Y.type==="before").map(Y=>Y.content),k=E.filter(Y=>Y.type==="after").map(Y=>Y.content);C.length>0&&(v=`${C.join(`

`)}

${v}`),k.length>0&&(v=`${v}

${k.join(`

`)}`),v&&b.push({type:"text",text:v});const R=((de=o.metadata)==null?void 0:de.attachedFiles)??[];if(R.length>0){const Y=await this._processFilesForPrompt(R,l);b.unshift(...Y)}b.length>0?y.push({role:"user",content:b}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");const O=(re=o.metadata)==null?void 0:re.turnSystemPrompt,j=n.getEffectiveProjectSettings(d);let $=O??j.systemPrompt??void 0;const L=E.filter(Y=>Y.type==="system").map(Y=>Y.content);L.length>0&&($=`${$?`${$}

`:""}${L.join(`

`)}`);const X={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...o.parameters??{}};Object.keys(X).forEach(Y=>{(X[Y]===null||X[Y]===void 0)&&delete X[Y]});const F={system:$,messages:y,parameters:X,metadata:{...(({turnSystemPrompt:Y,activeTagIds:Q,activeRuleIds:ae,...B})=>B)(o.metadata??{}),modelId:r.modelId,regeneratedFromId:e,attachedFiles:R.map(({contentBase64:Y,contentText:Q,...ae})=>ae)}};try{await _C.startInteraction(F,l,o)}catch(Y){throw console.error("[ConversationService] Error starting regeneration interaction:",Y),tt.error(`Failed to start regeneration: ${Y instanceof Error?Y.message:String(Y)}`),Y}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(i=>i.source==="vfs");let a;if(r.length>0){const i=mn.getState().getConversationById(t),s=(i==null?void 0:i.projectId)??"orphan";try{a=await this._ensureVfsReady(s)}catch{tt.error(`Filesystem unavailable for key ${s}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),a=void 0}}for(const i of e){let s=null;try{if(i.source==="direct")s=h3(i);else if(i.source==="vfs"&&a&&i.path){console.log(`[ConversationService] Fetching VFS file: ${i.path}`);const o=await of(i.path,{fsInstance:a});s=h3({...i,contentBytes:o})}else if(i.source==="vfs"&&!a)continue;s&&n.push(s)}catch(o){console.error(`[ConversationService] Error processing file ${i.name}:`,o),n.push({type:"text",text:`[Error processing file: ${i.name}]`})}}return n},async _ensureVfsReady(e){console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`);try{const t=await Xs.getState().initializeVFS(e,{force:!0});return console.log(`[ConversationService] VFS ready for key "${e}".`),t}catch(t){throw console.error(`[ConversationService] Failed to ensure VFS ready for key ${e}:`,t),t}}},Qg=As(Ns((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await Ft.loadMods();e({dbMods:n,isLoading:!1})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),tt.error(r)}},addDbMod:async n=>{const r=Pi(),a={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(i=>{i.dbMods.push(a),i.dbMods.sort((s,o)=>s.loadOrder-o.loadOrder)});try{return await Ft.saveMod(a),tt.success(`Mod "${a.name}" added.`),r}catch(i){const s="Failed to save new mod";throw console.error("ModStore: Error adding mod",i),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=s}),tt.error(s),i}},updateDbMod:async(n,r)=>{let a,i=-1;e(o=>{i=o.dbMods.findIndex(l=>l.id===n),i!==-1?(a={...o.dbMods[i]},o.dbMods[i]={...o.dbMods[i],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,u)=>l.loadOrder-u.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const s=i!==-1?t().dbMods[i]:void 0;if(s)try{await Ft.saveMod(s),tt.success(`Mod "${s.name}" updated.`)}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(u=>{const d=u.dbMods.findIndex(h=>h.id===n);d!==-1&&a&&(u.dbMods[d]=a,u.dbMods.sort((h,p)=>h.loadOrder-p.loadOrder)),u.error=l}),tt.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(i=>i.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const a=r.name;e(i=>({dbMods:i.dbMods.filter(s=>s.id!==n)}));try{await Ft.deleteMod(n),tt.success(`Mod "${a}" deleted.`)}catch(i){const s="Failed to delete mod";throw console.error("ModStore: Error deleting mod",i),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,u)=>l.loadOrder-u.loadOrder),o.error=s}),tt.error(s),i}},setLoadedMods:n=>{e({loadedMods:n})},_addSettingsTab:n=>{e(r=>{r.modSettingsTabs.some(a=>a.id===n.id)||(r.modSettingsTabs.push(n),r.modSettingsTabs.sort((a,i)=>(a.order??999)-(i.order??999)))})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(a=>a.id!==n)})}})));function NO(e){const t=e.id,n=e.name,r=Dr.getState(),a=Qg.getState();return{modId:t,modName:n,registerPromptControl:s=>r.registerPromptControl(s),registerChatControl:s=>{const o={...s,status:s.status??(()=>"ready")};return r.registerChatControl(o)},registerTool:(s,o,l)=>(console.log(`[${n}] Registering tool: ${s}`),r.registerTool(t,s,o,l)),on:(s,o)=>(St.on(s,o),()=>St.off(s,o)),addMiddleware:(s,o)=>r.registerMiddleware(s,t,o),registerSettingsTab:s=>(a._addSettingsTab(s),()=>a._removeSettingsTab(s.id)),getContextSnapshot:()=>{const s=Zn.getState(),o=mn.getState(),l=qr.getState(),u=Fn.getState(),{providerId:d}=Ql(u.selectedModelId),h=o.selectedItemType==="conversation"?o.selectedItemId:null;return Object.freeze({selectedConversationId:h,interactions:Object.freeze(s.currentConversationId===h?s.interactions.map(p=>Object.freeze({...p})):[]),isStreaming:s.status==="streaming",selectedProviderId:d,selectedModelId:u.selectedModelId,activeSystemPrompt:l.globalSystemPrompt,temperature:l.temperature,maxTokens:l.maxTokens,theme:l.theme})},showToast:(s,o)=>{tt[s](`[${n}] ${o}`)},log:(s,...o)=>{console[s](`[Mod: ${n}]`,...o)}}}async function Sge(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let a=r.scriptContent,i=null,s=null;try{if(i=NO(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const u=await fetch(r.sourceUrl);if(!u.ok)throw new Error(`Failed to fetch mod script: ${u.status} ${u.statusText}`);a=await u.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(u){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,u),u}}if(!a)throw new Error("Mod script content is empty.");new Function("modApi",a)(i),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){s=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),tt.error(`Error loading mod "${r.name}": ${s instanceof Error?s.message:s}`)}i||(i=NO(r));const o={id:r.id,name:r.name,api:i,error:s??void 0};return St.emit(o.error?_t.MOD_ERROR:_t.MOD_LOADED,{id:r.id,name:r.name,error:o.error}),o}));return St.emit(_t.APP_LOADED,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}var Ege=(e,t,n,r,a,i,s,o)=>{let l=document.documentElement,u=["light","dark"];function d(y){(Array.isArray(e)?e:[e]).forEach(v=>{let b=v==="class",w=b&&i?a.map(x=>i[x]||x):a;b?(l.classList.remove(...w),l.classList.add(i&&i[y]?i[y]:y)):l.setAttribute(v,y)}),h(y)}function h(y){o&&u.includes(y)&&(l.style.colorScheme=y)}function p(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)d(r);else try{let y=localStorage.getItem(t)||n,v=s&&y==="system"?p():y;d(v)}catch{}},Cge=T.createContext(void 0),kge={setTheme:e=>{},themes:[]},Tge=()=>{var e;return(e=T.useContext(Cge))!=null?e:kge};T.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:a,defaultTheme:i,value:s,themes:o,nonce:l,scriptProps:u})=>{let d=JSON.stringify([n,t,i,e,o,s,r,a]).slice(1,-1);return T.createElement("script",{...u,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${Ege.toString()})(${d})`}})});const Age=({...e})=>{const{theme:t="system"}=Tge();return m.jsx(XY,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function Mu({className:e,...t}){return m.jsx("textarea",{"data-slot":"textarea",className:Nt("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const z$=T.memo(T.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:a,onValueChange:i,...s},o)=>{const l=T.useRef(null),[u,d]=T.useState(e);T.useImperativeHandle(o,()=>({getValue:()=>u,focus:()=>{var b;return(b=l.current)==null?void 0:b.focus()}}));const{focusInputOnNextRender:h,setFocusInputFlag:p}=pa(dn(b=>({focusInputOnNextRender:b.focusInputOnNextRender,setFocusInputFlag:b.setFocusInputFlag})));T.useEffect(()=>{h&&l.current&&(p(!1),requestAnimationFrame(()=>{var b;(b=l.current)==null||b.focus()}))},[h,p]);const y=b=>{if(b.key==="Enter"&&!b.shiftKey&&!n){b.preventDefault();const w=tu.getState().attachedFilesMetadata.length>0;(u.trim().length>0||w)&&(t(),d(""),i&&i(""))}},v=b=>{const w=b.target.value;d(w),i&&i(w)};return T.useEffect(()=>{const b=l.current;if(b){b.style.height="auto";const w=b.scrollHeight,x=250;b.style.height=`${Math.min(w,x)}px`,b.style.overflowY=w>x?"auto":"hidden"}},[u]),T.useEffect(()=>{d(e),i&&i(e)},[e,i]),m.jsx(Mu,{ref:l,value:u,onChange:v,onKeyDown:y,disabled:n,placeholder:r,rows:1,className:Nt("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",a),"aria-label":"Chat input",...s})}));z$.displayName="InputArea";const U$=(e,t)=>{if(!t)return null;let n=eg,r="text-muted-foreground/70",a=`Linked to ${t}`;switch(e){case"syncing":n=zn,r="animate-spin text-blue-500",a=`Syncing with ${t}...`;break;case"error":n=Ad,r="text-destructive",a=`Sync error with ${t}`;break;case"needs-sync":n=qC,r="text-orange-500",a=`Needs sync with ${t}`;break;case"idle":n=BC,r="text-green-500",a=`Synced with ${t}`;break;default:n=eg,r="text-muted-foreground/70",a=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(n,{className:Nt("h-3 w-3 ml-1 flex-shrink-0",r)})}),m.jsx(Jn,{side:"right",children:a})]})})},bw=T.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:a,onSelectItem:i,onDeleteConversation:s,onDeleteProject:o,onExportConversation:l,onExportProject:u,expandedProjects:d,toggleProjectExpansion:h,getChildren:p,filterText:y,editingItemId:v,editingItemType:b,originalName:w,localEditingName:x,setLocalEditingName:S,handleStartEditing:E,handleSaveEdit:C,handleCancelEdit:k,isSavingEdit:R,editInputRef:O})=>{const j=e.id===n,$=e.itemType==="project",L=e.id===v&&e.itemType===b,X=$&&d.has(e.id),{projects:F,conversations:K}=$?p(e.id,y):{projects:[],conversations:[]},q=F.length>0||K.length>0,de=!$&&e.syncRepoId?r[e.id]:void 0,re=!$&&e.syncRepoId?a.get(e.syncRepoId):void 0,Y=!$&&re?U$(de,re):null,Q=pa(Ne=>Ne.openProjectSettingsModal),ae=()=>{L||($&&q&&h(e.id),i(e.id,e.itemType))},B=Ne=>{Ne.stopPropagation(),$?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,Ne):s(e.id,Ne)},J=Ne=>{Ne.stopPropagation(),E(e)},ee=Ne=>{Ne.stopPropagation(),$&&Q(e.id)},oe=Ne=>{Ne.key==="Enter"?(Ne.preventDefault(),C()):Ne.key==="Escape"&&k()},me=$?e.name:e.title,xe=R?zn:so,Pe=R?"h-3 w-3 animate-spin":"h-3 w-3";return m.jsxs(m.Fragment,{children:[m.jsxs("li",{className:Nt("flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!L&&"hover:bg-muted/50 hover:text-primary/80",j&&!L?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",L&&"bg-muted ring-1 ring-primary",!L&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:ae,children:[m.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[$&&q&&m.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:Ne=>{Ne.stopPropagation(),h(e.id)},children:X?m.jsx(Yo,{className:"h-3 w-3 text-muted-foreground"}):m.jsx(_6,{className:"h-3 w-3 text-muted-foreground"})}),$&&!q&&m.jsx("span",{className:"w-3 flex-shrink-0"}),$?m.jsx(s0,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):m.jsx(nH,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),L?m.jsx(qn,{ref:O,value:x,onChange:Ne=>S(Ne.target.value),onKeyDown:oe,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:Ne=>Ne.stopPropagation(),disabled:R}):m.jsx("span",{className:"truncate pr-1",children:me}),Y]}),m.jsx("div",{className:"flex items-center flex-shrink-0",children:L?m.jsxs(m.Fragment,{children:[m.jsx(rr,{tooltipText:"Save (Enter)",onClick:Ne=>{Ne.stopPropagation(),C()},disabled:R||!x.trim(),"aria-label":"Save changes",icon:m.jsx(xe,{}),iconClassName:Pe,className:"h-5 w-5 text-green-500 hover:text-green-600"}),m.jsx(rr,{tooltipText:"Cancel (Esc)",onClick:Ne=>{Ne.stopPropagation(),k()},disabled:R,"aria-label":"Cancel edit",icon:m.jsx(Ts,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):m.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[$&&m.jsx(rr,{tooltipText:"Project Settings",onClick:ee,"aria-label":`Settings for ${me}`,icon:m.jsx(gq,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),m.jsx(rr,{tooltipText:"Edit",onClick:J,"aria-label":`Edit ${me}`,icon:m.jsx(o0,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),$?m.jsx(rr,{tooltipText:"Export Project (JSON)",onClick:Ne=>u(e.id,Ne),"aria-label":`Export project ${me}`,icon:m.jsx(Sq,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):m.jsxs("div",{className:"relative group/export",children:[m.jsx(rr,{tooltipText:"Export Conversation","aria-label":`Export ${me}`,icon:m.jsx(yh,{}),className:"h-5 w-5 text-muted-foreground group-hover/export:text-foreground"}),m.jsxs("div",{className:`absolute right-0 top-full mt-1 hidden group-hover/export:flex
                                   bg-popover border border-border rounded-md shadow-lg p-0.5 z-10 gap-0.5`,onClick:Ne=>Ne.stopPropagation(),children:[m.jsx(Mt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:Ne=>l(e.id,"json",Ne),children:"JSON"}),m.jsx(Mt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:Ne=>l(e.id,"md",Ne),children:"MD"})]})]}),m.jsx(rr,{tooltipText:"Delete",onClick:B,"aria-label":`Delete ${me}`,icon:m.jsx(ts,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]},e.id),$&&X&&m.jsxs(m.Fragment,{children:[F.sort((Ne,Re)=>Re.updatedAt.getTime()-Ne.updatedAt.getTime()).map(Ne=>m.jsx(bw,{item:{...Ne,itemType:"project"},level:t+1,selectedItemId:n,conversationSyncStatus:r,repoNameMap:a,onSelectItem:i,onDeleteConversation:s,onDeleteProject:o,onExportConversation:l,onExportProject:u,expandedProjects:d,toggleProjectExpansion:h,getChildren:p,filterText:y,editingItemId:v,editingItemType:b,originalName:w,localEditingName:x,setLocalEditingName:S,handleStartEditing:E,handleSaveEdit:C,handleCancelEdit:k,isSavingEdit:R,editInputRef:O},Ne.id)),K.sort((Ne,Re)=>Re.updatedAt.getTime()-Ne.updatedAt.getTime()).map(Ne=>m.jsx(bw,{item:{...Ne,itemType:"conversation"},level:t+1,selectedItemId:n,conversationSyncStatus:r,repoNameMap:a,onSelectItem:i,onDeleteConversation:s,onDeleteProject:o,onExportConversation:l,onExportProject:u,expandedProjects:d,toggleProjectExpansion:h,getChildren:p,filterText:y,editingItemId:v,editingItemType:b,originalName:w,localEditingName:x,setLocalEditingName:S,handleStartEditing:E,handleSaveEdit:C,handleCancelEdit:k,isSavingEdit:R,editInputRef:O},Ne.id))]})]})});bw.displayName="ConversationItemRenderer";function Nge({updateProject:e,updateConversation:t,deleteProject:n}){const[r,a]=T.useState(null),[i,s]=T.useState(null),[o,l]=T.useState(""),[u,d]=T.useState(""),[h,p]=T.useState(!1),y=T.useRef(null),v=T.useCallback(x=>{a(x.id),s(x.itemType);const S=x.itemType==="project"?x.name:x.title;l(S),d(S),p(!1)},[]),b=T.useCallback(x=>{const S=r,E=x??(i==="project"&&o==="New Project");a(null),s(null),l(""),d(""),p(!1),E&&S&&(console.log(`Cancelling edit for new project ${S}, deleting...`),n(S).catch(C=>{console.error("Failed to delete new project on cancel:",C),tt.error("Failed to clean up cancelled new project.")}))},[r,i,o,n]),w=T.useCallback(async()=>{var E;if(!r||!i||h)return;const x=u.trim(),S=i==="project"&&o==="New Project";if(!x){tt.error("Name cannot be empty."),(E=y.current)==null||E.focus();return}if(x===o&&!S){b();return}p(!0);try{i==="project"?await e(r,{name:x}):await t(r,{title:x}),tt.success("Item renamed successfully."),a(null),s(null),l(""),d("")}catch(C){console.error("Failed to save item name:",C),tt.error(`Failed to rename item: ${C instanceof Error?C.message:String(C)}`)}finally{p(!1)}},[r,i,u,o,h,e,t,b]);return T.useEffect(()=>{r&&y.current&&(y.current.focus(),y.current.select())},[r]),{editingItemId:r,editingItemType:i,originalName:o,localEditingName:u,setLocalEditingName:d,isSavingEdit:h,editInputRef:y,handleStartEditing:v,handleSaveEdit:w,handleCancelEdit:b}}const SC=(e,t,n,r,a,i,s,o,l)=>{if(!n)return!0;const u=`${t}-${e}`;if(l[u]!==void 0)return l[u];let d=!1;{const h=i.get(e);if(h)if(h.name.toLowerCase().includes(n))d=!0;else{const p=o.get(e)||[],y=s.get(e)||[];for(const v of y)if(v.title.toLowerCase().includes(n)){d=!0;break}if(!d){for(const v of p)if(SC(v.id,"project",n,r,a,i,s,o,l)){d=!0;break}}}}return l[u]=d,d},Rge=()=>{const e=mn(ge=>ge.selectedItemId),t=mn(ge=>ge.selectedItemType),n=mn(ge=>ge.isLoading),r=ii(ge=>ge.isLoading),a=pa(ge=>ge.setFocusInputFlag),{conversations:i,syncRepos:s,conversationSyncStatus:o}=mn(dn(ge=>({conversations:ge.conversations,syncRepos:ge.syncRepos,conversationSyncStatus:ge.conversationSyncStatus}))),l=ii(ge=>ge.projects),u=mn(ge=>ge.selectItem),d=mn(ge=>ge.addConversation),h=mn(ge=>ge.updateConversation),p=mn(ge=>ge.deleteConversation),y=mn(ge=>ge.exportConversation),v=mn(ge=>ge.exportProject),b=mn(ge=>ge.getConversationById),w=ii(ge=>ge.addProject),x=ii(ge=>ge.updateProject),S=ii(ge=>ge.deleteProject),E=ii(ge=>ge.getProjectById),[C,k]=gt.useState(new Set),[R,O]=T.useState(""),j=n||r,$=Nge({updateProject:x,updateConversation:h,deleteProject:S,getProjectById:E,getConversationById:b}),{editingItemId:L,editingItemType:X,originalName:F,localEditingName:K,setLocalEditingName:q,isSavingEdit:de,editInputRef:re,handleStartEditing:Y,handleSaveEdit:Q,handleCancelEdit:ae}=$,B=T.useCallback(ge=>{k(Te=>{const le=new Set(Te);return le.has(ge)?le.delete(ge):le.add(ge),le})},[]),J=T.useCallback(()=>{if(t==="project")return e;if(t==="conversation"&&e){const ge=b(e);return(ge==null?void 0:ge.projectId)??null}return null},[e,t,b]),ee=T.useCallback(async()=>{if(!L)try{const ge=J(),Te=await d({title:"New Chat",projectId:ge});u(Te,"conversation"),setTimeout(()=>a(!0),0)}catch(ge){console.error("Failed to create new chat:",ge),tt.error("Failed to create new chat.")}},[L,J,d,u,a]),oe=T.useCallback(async()=>{if(!L)try{const ge=J(),Te=await w({name:"New Project",parentId:ge});u(Te,"project"),ge&&k(le=>new Set(le).add(ge)),setTimeout(()=>{const le=E(Te);le?Y({...le,itemType:"project"}):console.warn("New project data not found, cannot start edit.")},50)}catch(ge){console.error("Failed to create new project:",ge)}},[L,J,w,u,E,Y]),me=T.useCallback((ge,Te)=>{ge!==L&&(L&&ge!==L&&(K.trim()&&K.trim()!==F?Q():ae()),(ge!==e||Te!==t)&&(u(ge,Te),Te==="conversation"&&setTimeout(()=>a(!0),0)))},[L,K,F,e,t,Q,ae,u,a]),xe=T.useCallback((ge,Te)=>{Te.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&p(ge).catch(le=>{console.error("Failed to delete conversation:",le),tt.error("Failed to delete conversation.")})},[p]),Pe=T.useCallback((ge,Te)=>{Te.stopPropagation(),S(ge).catch(le=>{console.error("Failed to delete project:",le),tt.error("Failed to delete project.")})},[S]),Ne=T.useCallback(async(ge,Te,le)=>{le.stopPropagation();try{await y(ge,Te)}catch(ie){console.error(`Failed to export conversation as ${Te}:`,ie)}},[y]),Re=T.useCallback(async(ge,Te)=>{Te.stopPropagation();try{await v(ge)}catch(le){console.error("Failed to export project:",le)}},[v]),ke=T.useMemo(()=>new Map((s||[]).map(ge=>[ge.id,ge.name])),[s]),{projectsById:Fe,conversationsByProjectId:Qe,projectsByParentId:Le}=T.useMemo(()=>{const ge=new Map(l.map(ie=>[ie.id,ie])),Te=new Map;i.forEach(ie=>{const te=ie.projectId??null;Te.has(te)||Te.set(te,[]),Te.get(te).push(ie)});const le=new Map;return l.forEach(ie=>{const te=ie.parentId??null;le.has(te)||le.set(te,[]),le.get(te).push(ie)}),{projectsById:ge,conversationsByProjectId:Te,projectsByParentId:le}},[l,i]),Ie=T.useCallback((ge,Te)=>{const le=Te.toLowerCase(),ie={},te=(Le.get(ge)||[]).filter(Me=>SC(Me.id,"project",le,l,i,Fe,Qe,Le,ie)),_e=(Qe.get(ge)||[]).filter(Me=>Me.title.toLowerCase().includes(le));return te.sort((Me,Ee)=>Ee.updatedAt.getTime()-Me.updatedAt.getTime()),_e.sort((Me,Ee)=>Ee.updatedAt.getTime()-Me.updatedAt.getTime()),{projects:te,conversations:_e}},[l,i,Fe,Qe,Le]),V=T.useMemo(()=>{const ge=R.toLowerCase(),Te={},le=(Le.get(null)||[]).filter(_e=>SC(_e.id,"project",ge,l,i,Fe,Qe,Le,Te)),ie=(Qe.get(null)||[]).filter(_e=>_e.title.toLowerCase().includes(ge)),te=[...le.map(_e=>({..._e,itemType:"project"})),...ie.map(_e=>({..._e,itemType:"conversation"}))];return te.sort((_e,Me)=>Me.updatedAt.getTime()-_e.updatedAt.getTime()),te},[l,i,R,Fe,Qe,Le]);return m.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[m.jsx("h3",{className:"text-sm font-semibold",children:"Workspace"}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{size:"sm",variant:"ghost",onClick:oe,"aria-label":"New Project",disabled:j||!!L,className:"h-7 w-7 p-0",children:m.jsx(UC,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"bottom",children:"New Project"})]})}),m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{size:"sm",variant:"ghost",onClick:ee,"aria-label":"New Chat",disabled:j||!!L,className:"h-7 w-7 p-0",children:m.jsx(Hd,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"bottom",children:"New Chat"})]})})]})]}),m.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[m.jsx(Nd,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),m.jsx(qn,{type:"search",placeholder:"Filter...",value:R,onChange:ge=>O(ge.target.value),className:"h-8 text-xs pl-8",disabled:j})]}),m.jsx(Yl,{className:"flex-grow",children:j?m.jsxs("div",{className:"space-y-1 p-1",children:[m.jsx(ur,{className:"h-8 w-full"}),m.jsx(ur,{className:"h-8 w-full"}),m.jsx(ur,{className:"h-8 w-full"})]}):V.length===0?m.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:R.trim()!==""?"No items match your filter.":"Workspace is empty."}):m.jsx("ul",{className:"space-y-0.5 p-1",children:V.map(ge=>m.jsx(bw,{item:ge,level:0,selectedItemId:e,conversationSyncStatus:o,repoNameMap:ke,onSelectItem:me,onDeleteConversation:xe,onDeleteProject:Pe,onExportConversation:Ne,onExportProject:Re,expandedProjects:C,toggleProjectExpansion:B,getChildren:Ie,filterText:R,editingItemId:L,editingItemType:X,originalName:F,localEditingName:K,setLocalEditingName:q,handleStartEditing:Y,handleSaveEdit:Q,handleCancelEdit:ae,isSavingEdit:de,editInputRef:re},ge.id))})})]})},Ige=()=>{const{addConversation:e,selectItem:t,selectedItemId:n,selectedItemType:r}=mn(dn(u=>({addConversation:u.addConversation,selectItem:u.selectItem,selectedItemId:u.selectedItemId,selectedItemType:u.selectedItemType,getConversationById:u.getConversationById}))),{addProject:a}=ii(dn(u=>({addProject:u.addProject,getProjectById:u.getProjectById}))),i=pa(u=>u.setFocusInputFlag),s=()=>{if(r==="project")return n;if(r==="conversation"&&n){const u=mn.getState().getConversationById(n);return(u==null?void 0:u.projectId)??null}return null},o=async()=>{try{const u=s(),d=await e({title:"New Chat",projectId:u});t(d,"conversation"),setTimeout(()=>i(!0),0)}catch(u){console.error("Failed to create new chat:",u)}},l=async()=>{try{const u=s(),d=await a({name:"New Project",parentId:u});t(d,"project")}catch(u){console.error("Failed to create new project:",u)}};return m.jsxs("div",{className:"flex flex-col items-center gap-2",children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",onClick:l,className:"h-8 w-8","aria-label":"New Project",children:m.jsx(UC,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"right",children:"New Project"})]})}),m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",onClick:o,className:"h-8 w-8","aria-label":"New Chat",children:m.jsx(Hd,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"right",children:"New Chat"})]})})]})};function jge(){const e=Dr.getState().registerChatControl,t=mn.getState().isLoading;e({id:"core-conversation-list",panel:"sidebar",status:()=>t?"loading":"ready",renderer:()=>gt.createElement(Rge),iconRenderer:()=>gt.createElement(Ige),show:()=>!0}),console.log("[Function] Registered Core Conversation List Control")}var Bx="Dialog",[q$,u_e]=Si(Bx),[Oge,fo]=q$(Bx),H$=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:i,modal:s=!0}=e,o=T.useRef(null),l=T.useRef(null),[u,d]=no({prop:r,defaultProp:a??!1,onChange:i,caller:Bx});return m.jsx(Oge,{scope:t,triggerRef:o,contentRef:l,contentId:Ya(),titleId:Ya(),descriptionId:Ya(),open:u,onOpenChange:d,onOpenToggle:T.useCallback(()=>d(h=>!h),[d]),modal:s,children:n})};H$.displayName=Bx;var V$="DialogTrigger",Dge=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fo(V$,n),i=Cn(t,a.triggerRef);return m.jsx(rn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":$T(a.open),...r,ref:i,onClick:Vt(e.onClick,a.onOpenToggle)})});Dge.displayName=V$;var FT="DialogPortal",[Mge,G$]=q$(FT,{forceMount:void 0}),W$=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,i=fo(FT,t);return m.jsx(Mge,{scope:t,forceMount:n,children:T.Children.map(r,s=>m.jsx(ka,{present:n||i.open,children:m.jsx(rp,{asChild:!0,container:a,children:s})}))})};W$.displayName=FT;var vw="DialogOverlay",K$=T.forwardRef((e,t)=>{const n=G$(vw,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,i=fo(vw,e.__scopeDialog);return i.modal?m.jsx(ka,{present:r||i.open,children:m.jsx(Fge,{...a,ref:t})}):null});K$.displayName=vw;var Pge=eu("DialogOverlay.RemoveScroll"),Fge=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fo(vw,n);return m.jsx(W0,{as:Pge,allowPinchZoom:!0,shards:[a.contentRef],children:m.jsx(rn.div,{"data-state":$T(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Bd="DialogContent",Z$=T.forwardRef((e,t)=>{const n=G$(Bd,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,i=fo(Bd,e.__scopeDialog);return m.jsx(ka,{present:r||i.open,children:i.modal?m.jsx(Lge,{...a,ref:t}):m.jsx($ge,{...a,ref:t})})});Z$.displayName=Bd;var Lge=T.forwardRef((e,t)=>{const n=fo(Bd,e.__scopeDialog),r=T.useRef(null),a=Cn(t,n.contentRef,r);return T.useEffect(()=>{const i=r.current;if(i)return Rx(i)},[]),m.jsx(Y$,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Vt(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),(s=n.triggerRef.current)==null||s.focus()}),onPointerDownOutside:Vt(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,o=s.button===0&&s.ctrlKey===!0;(s.button===2||o)&&i.preventDefault()}),onFocusOutside:Vt(e.onFocusOutside,i=>i.preventDefault())})}),$ge=T.forwardRef((e,t)=>{const n=fo(Bd,e.__scopeDialog),r=T.useRef(!1),a=T.useRef(!1);return m.jsx(Y$,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var s,o;(s=e.onCloseAutoFocus)==null||s.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:i=>{var l,u;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(s))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),Y$=T.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:i,...s}=e,o=fo(Bd,n),l=T.useRef(null),u=Cn(t,l);return Ax(),m.jsxs(m.Fragment,{children:[m.jsx(G0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:i,children:m.jsx(ep,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":$T(o.open),...s,ref:u,onDismiss:()=>o.onOpenChange(!1)})}),m.jsxs(m.Fragment,{children:[m.jsx(Bge,{titleId:o.titleId}),m.jsx(Uge,{contentRef:l,descriptionId:o.descriptionId})]})]})}),LT="DialogTitle",X$=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fo(LT,n);return m.jsx(rn.h2,{id:a.titleId,...r,ref:t})});X$.displayName=LT;var J$="DialogDescription",Q$=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fo(J$,n);return m.jsx(rn.p,{id:a.descriptionId,...r,ref:t})});Q$.displayName=J$;var e9="DialogClose",t9=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=fo(e9,n);return m.jsx(rn.button,{type:"button",...r,ref:t,onClick:Vt(e.onClick,()=>a.onOpenChange(!1))})});t9.displayName=e9;function $T(e){return e?"open":"closed"}var n9="DialogTitleWarning",[d_e,r9]=sX(n9,{contentName:Bd,titleName:LT,docsSlug:"dialog"}),Bge=({titleId:e})=>{const t=r9(n9),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return T.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},zge="DialogDescriptionWarning",Uge=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${r9(zge).contentName}}.`;return T.useEffect(()=>{var i;const a=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},a9=H$,i9=W$,s9=K$,o9=Z$,qge=X$,Hge=Q$,l9=t9;function zx({...e}){return m.jsx(a9,{"data-slot":"dialog",...e})}function Vge({...e}){return m.jsx(i9,{"data-slot":"dialog-portal",...e})}function Gge({...e}){return m.jsx(l9,{"data-slot":"dialog-close",...e})}function Wge({className:e,...t}){return m.jsx(s9,{"data-slot":"dialog-overlay",className:Nt("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function Ux({className:e,children:t,...n}){return m.jsxs(Vge,{"data-slot":"dialog-portal",children:[m.jsx(Wge,{}),m.jsxs(o9,{"data-slot":"dialog-content",className:Nt("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,m.jsxs(l9,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[m.jsx(Ts,{}),m.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function qx({className:e,...t}){return m.jsx("div",{"data-slot":"dialog-header",className:Nt("flex flex-col gap-2 text-center sm:text-left",e),...t})}function Hx({className:e,...t}){return m.jsx("div",{"data-slot":"dialog-footer",className:Nt("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function Vx({className:e,...t}){return m.jsx(qge,{"data-slot":"dialog-title",className:Nt("text-lg leading-none font-semibold",e),...t})}function Gx({className:e,...t}){return m.jsx(Hge,{"data-slot":"dialog-description",className:Nt("text-muted-foreground text-sm",e),...t})}var c9=["PageUp","PageDown"],u9=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],d9={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},wp="Slider",[EC,Kge,Zge]=Tx(wp),[f9,f_e]=Si(wp,[Zge]),[Yge,Wx]=f9(wp),h9=T.forwardRef((e,t)=>{const{name:n,min:r=0,max:a=100,step:i=1,orientation:s="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:u=[r],value:d,onValueChange:h=()=>{},onValueCommit:p=()=>{},inverted:y=!1,form:v,...b}=e,w=T.useRef(new Set),x=T.useRef(0),E=s==="horizontal"?Xge:Jge,[C=[],k]=no({prop:d,defaultProp:u,onChange:X=>{var K;(K=[...w.current][x.current])==null||K.focus(),h(X)}}),R=T.useRef(C);function O(X){const F=r0e(C,X);L(X,F)}function j(X){L(X,x.current)}function $(){const X=R.current[x.current];C[x.current]!==X&&p(C)}function L(X,F,{commit:K}={commit:!1}){const q=o0e(i),de=l0e(Math.round((X-r)/i)*i+r,q),re=qg(de,[r,a]);k((Y=[])=>{const Q=t0e(Y,re,F);if(s0e(Q,l*i)){x.current=Q.indexOf(re);const ae=String(Q)!==String(Y);return ae&&K&&p(Q),ae?Q:Y}else return Y})}return m.jsx(Yge,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:a,valueIndexToChangeRef:x,thumbs:w.current,values:C,orientation:s,form:v,children:m.jsx(EC.Provider,{scope:e.__scopeSlider,children:m.jsx(EC.Slot,{scope:e.__scopeSlider,children:m.jsx(E,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:t,onPointerDown:Vt(b.onPointerDown,()=>{o||(R.current=C)}),min:r,max:a,inverted:y,onSlideStart:o?void 0:O,onSlideMove:o?void 0:j,onSlideEnd:o?void 0:$,onHomeKeyDown:()=>!o&&L(r,0,{commit:!0}),onEndKeyDown:()=>!o&&L(a,C.length-1,{commit:!0}),onStepKeyDown:({event:X,direction:F})=>{if(!o){const de=c9.includes(X.key)||X.shiftKey&&u9.includes(X.key)?10:1,re=x.current,Y=C[re],Q=i*de*F;L(Y+Q,re,{commit:!0})}}})})})})});h9.displayName=wp;var[p9,m9]=f9(wp,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Xge=T.forwardRef((e,t)=>{const{min:n,max:r,dir:a,inverted:i,onSlideStart:s,onSlideMove:o,onSlideEnd:l,onStepKeyDown:u,...d}=e,[h,p]=T.useState(null),y=Cn(t,E=>p(E)),v=T.useRef(void 0),b=bp(a),w=b==="ltr",x=w&&!i||!w&&i;function S(E){const C=v.current||h.getBoundingClientRect(),k=[0,C.width],O=BT(k,x?[n,r]:[r,n]);return v.current=C,O(E-C.left)}return m.jsx(p9,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:m.jsx(g9,{dir:b,"data-orientation":"horizontal",...d,ref:y,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:E=>{const C=S(E.clientX);s==null||s(C)},onSlideMove:E=>{const C=S(E.clientX);o==null||o(C)},onSlideEnd:()=>{v.current=void 0,l==null||l()},onStepKeyDown:E=>{const k=d9[x?"from-left":"from-right"].includes(E.key);u==null||u({event:E,direction:k?-1:1})}})})}),Jge=T.forwardRef((e,t)=>{const{min:n,max:r,inverted:a,onSlideStart:i,onSlideMove:s,onSlideEnd:o,onStepKeyDown:l,...u}=e,d=T.useRef(null),h=Cn(t,d),p=T.useRef(void 0),y=!a;function v(b){const w=p.current||d.current.getBoundingClientRect(),x=[0,w.height],E=BT(x,y?[r,n]:[n,r]);return p.current=w,E(b-w.top)}return m.jsx(p9,{scope:e.__scopeSlider,startEdge:y?"bottom":"top",endEdge:y?"top":"bottom",size:"height",direction:y?1:-1,children:m.jsx(g9,{"data-orientation":"vertical",...u,ref:h,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const w=v(b.clientY);i==null||i(w)},onSlideMove:b=>{const w=v(b.clientY);s==null||s(w)},onSlideEnd:()=>{p.current=void 0,o==null||o()},onStepKeyDown:b=>{const x=d9[y?"from-bottom":"from-top"].includes(b.key);l==null||l({event:b,direction:x?-1:1})}})})}),g9=T.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:a,onSlideEnd:i,onHomeKeyDown:s,onEndKeyDown:o,onStepKeyDown:l,...u}=e,d=Wx(wp,n);return m.jsx(rn.span,{...u,ref:t,onKeyDown:Vt(e.onKeyDown,h=>{h.key==="Home"?(s(h),h.preventDefault()):h.key==="End"?(o(h),h.preventDefault()):c9.concat(u9).includes(h.key)&&(l(h),h.preventDefault())}),onPointerDown:Vt(e.onPointerDown,h=>{const p=h.target;p.setPointerCapture(h.pointerId),h.preventDefault(),d.thumbs.has(p)?p.focus():r(h)}),onPointerMove:Vt(e.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&a(h)}),onPointerUp:Vt(e.onPointerUp,h=>{const p=h.target;p.hasPointerCapture(h.pointerId)&&(p.releasePointerCapture(h.pointerId),i(h))})})}),y9="SliderTrack",b9=T.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,a=Wx(y9,n);return m.jsx(rn.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...r,ref:t})});b9.displayName=y9;var CC="SliderRange",v9=T.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,a=Wx(CC,n),i=m9(CC,n),s=T.useRef(null),o=Cn(t,s),l=a.values.length,u=a.values.map(p=>_9(p,a.min,a.max)),d=l>1?Math.min(...u):0,h=100-Math.max(...u);return m.jsx(rn.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...r,ref:o,style:{...e.style,[i.startEdge]:d+"%",[i.endEdge]:h+"%"}})});v9.displayName=CC;var kC="SliderThumb",w9=T.forwardRef((e,t)=>{const n=Kge(e.__scopeSlider),[r,a]=T.useState(null),i=Cn(t,o=>a(o)),s=T.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return m.jsx(Qge,{...e,ref:i,index:s})}),Qge=T.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:a,...i}=e,s=Wx(kC,n),o=m9(kC,n),[l,u]=T.useState(null),d=Cn(t,S=>u(S)),h=l?s.form||!!l.closest("form"):!0,p=qw(l),y=s.values[r],v=y===void 0?0:_9(y,s.min,s.max),b=n0e(r,s.values.length),w=p==null?void 0:p[o.size],x=w?a0e(w,v,o.direction):0;return T.useEffect(()=>{if(l)return s.thumbs.add(l),()=>{s.thumbs.delete(l)}},[l,s.thumbs]),m.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${v}% + ${x}px)`},children:[m.jsx(EC.ItemSlot,{scope:e.__scopeSlider,children:m.jsx(rn.span,{role:"slider","aria-label":e["aria-label"]||b,"aria-valuemin":s.min,"aria-valuenow":y,"aria-valuemax":s.max,"aria-orientation":s.orientation,"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,tabIndex:s.disabled?void 0:0,...i,ref:d,style:y===void 0?{display:"none"}:e.style,onFocus:Vt(e.onFocus,()=>{s.valueIndexToChangeRef.current=r})})}),h&&m.jsx(x9,{name:a??(s.name?s.name+(s.values.length>1?"[]":""):void 0),form:s.form,value:y},r)]})});w9.displayName=kC;var e0e="RadioBubbleInput",x9=T.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const a=T.useRef(null),i=Cn(a,r),s=Nx(t);return T.useEffect(()=>{const o=a.current;if(!o)return;const l=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(l,"value").set;if(s!==t&&d){const h=new Event("input",{bubbles:!0});d.call(o,t),o.dispatchEvent(h)}},[s,t]),m.jsx(rn.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});x9.displayName=e0e;function t0e(e=[],t,n){const r=[...e];return r[n]=t,r.sort((a,i)=>a-i)}function _9(e,t,n){const i=100/(n-t)*(e-t);return qg(i,[0,100])}function n0e(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function r0e(e,t){if(e.length===1)return 0;const n=e.map(a=>Math.abs(a-t)),r=Math.min(...n);return n.indexOf(r)}function a0e(e,t,n){const r=e/2,i=BT([0,50],[0,r]);return(r-i(t)*n)*n}function i0e(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function s0e(e,t){if(t>0){const n=i0e(e);return Math.min(...n)>=t}return!0}function BT(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function o0e(e){return(String(e).split(".")[1]||"").length}function l0e(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var c0e=h9,u0e=b9,d0e=v9,f0e=w9;function Fl({className:e,defaultValue:t,value:n,min:r=0,max:a=100,...i}){const s=T.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,a],[n,t,r,a]);return m.jsxs(c0e,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:a,className:Nt("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[m.jsx(u0e,{"data-slot":"slider-track",className:Nt("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:m.jsx(d0e,{"data-slot":"slider-range",className:Nt("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:s.length},(o,l)=>m.jsx(f0e,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}var h0e="Separator",RO="horizontal",p0e=["horizontal","vertical"],S9=T.forwardRef((e,t)=>{const{decorative:n,orientation:r=RO,...a}=e,i=m0e(r)?r:RO,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return m.jsx(rn.div,{"data-orientation":i,...o,...a,ref:t})});S9.displayName=h0e;function m0e(e){return p0e.includes(e)}var g0e=S9;function zd({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return m.jsx(g0e,{"data-slot":"separator-root",decorative:n,orientation:t,className:Nt("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const y0e=()=>{const{theme:e,setTheme:t,enableStreamingMarkdown:n,setEnableStreamingMarkdown:r,enableStreamingCodeBlockParsing:a,setEnableStreamingCodeBlockParsing:i,foldStreamingCodeBlocks:s,setFoldStreamingCodeBlocks:o,foldUserMessagesOnCompletion:l,setFoldUserMessagesOnCompletion:u,streamingRenderFPS:d,setStreamingRenderFPS:h,prismThemeUrl:p,setPrismThemeUrl:y,resetGeneralSettings:v}=qr(dn(k=>({theme:k.theme,setTheme:k.setTheme,enableStreamingMarkdown:k.enableStreamingMarkdown,setEnableStreamingMarkdown:k.setEnableStreamingMarkdown,enableStreamingCodeBlockParsing:k.enableStreamingCodeBlockParsing,setEnableStreamingCodeBlockParsing:k.setEnableStreamingCodeBlockParsing,foldStreamingCodeBlocks:k.foldStreamingCodeBlocks,setFoldStreamingCodeBlocks:k.setFoldStreamingCodeBlocks,foldUserMessagesOnCompletion:k.foldUserMessagesOnCompletion,setFoldUserMessagesOnCompletion:k.setFoldUserMessagesOnCompletion,streamingRenderFPS:k.streamingRenderFPS,setStreamingRenderFPS:k.setStreamingRenderFPS,prismThemeUrl:k.prismThemeUrl,setPrismThemeUrl:k.setPrismThemeUrl,resetGeneralSettings:k.resetGeneralSettings}))),[b,w]=T.useState(d),x=T.useCallback(k=>{w(k[0])},[]),S=T.useCallback(k=>{h(k[0])},[h]),E=T.useCallback(k=>{const R=k.target.value,O=R===""?15:parseInt(R.replace(/[^0-9]/g,""),10);if(!isNaN(O)){const j=Math.max(3,Math.min(60,O));h(j),w(j)}},[h]);T.useEffect(()=>{w(d)},[d]);const C=()=>{window.confirm("Are you sure you want to reset Appearance and Streaming settings to their defaults?")&&v()};return m.jsxs("div",{className:"space-y-6 p-1",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("h3",{className:"text-lg font-medium",children:"Appearance"}),m.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 shadow-sm",children:[m.jsx(en,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),m.jsxs(Iu,{value:e??"system",onValueChange:k=>t(k),children:[m.jsx(Ou,{id:"theme-select",className:"w-[180px]",children:m.jsx(ju,{placeholder:"Select theme"})}),m.jsxs(Du,{children:[m.jsx(Za,{value:"light",children:"Light"}),m.jsx(Za,{value:"dark",children:"Dark"}),m.jsx(Za,{value:"system",children:"System"}),m.jsx(Za,{value:"TijuLight",children:"Tiju Light"}),m.jsx(Za,{value:"TijuDark",children:"Tiju Dark"})]})]})]}),m.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-1.5",children:[m.jsx(en,{htmlFor:"prism-theme-url",className:"font-medium",children:"Code Block Theme URL (Optional)"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter the URL of a PrismJS CSS theme file (e.g., from cdnjs). Leave blank to use the default themes."}),m.jsx(qn,{id:"prism-theme-url",type:"url",placeholder:"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css",value:p??"",onChange:k=>y(k.target.value)})]})]}),m.jsx(zd,{}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),m.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 shadow-sm",children:[m.jsxs("div",{children:[m.jsx(en,{htmlFor:"streaming-markdown-switch",className:"font-medium",children:"Parse Markdown While Streaming"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Render Markdown formatting as the response arrives (may impact performance slightly)."})]}),m.jsx(Gs,{id:"streaming-markdown-switch",checked:n??!0,onCheckedChange:r})]}),m.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 shadow-sm",children:[m.jsxs("div",{children:[m.jsx(en,{htmlFor:"streaming-codeblock-switch",className:"font-medium",children:"Use Full Code Blocks While Streaming"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Use the syntax-highlighting component for code blocks during streaming. Disable for potentially smoother streaming on complex code, using a basic block instead."})]}),m.jsx(Gs,{id:"streaming-codeblock-switch",checked:a??!1,onCheckedChange:i})]}),m.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 shadow-sm",children:[m.jsxs("div",{children:[m.jsx(en,{htmlFor:"fold-codeblock-switch",className:"font-medium",children:"Fold Code Blocks by Default During Streaming"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically collapse code blocks as they stream in. Useful for long code outputs."})]}),m.jsx(Gs,{id:"fold-codeblock-switch",checked:s??!1,onCheckedChange:o})]}),m.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3 shadow-sm",children:[m.jsxs("div",{children:[m.jsx(en,{htmlFor:"fold-user-message-switch",className:"font-medium",children:"Fold User Messages After Response"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically collapse the user's prompt message once the assistant finishes responding."})]}),m.jsx(Gs,{id:"fold-user-message-switch",checked:l??!1,onCheckedChange:u})]}),m.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[m.jsxs("div",{children:[m.jsxs(en,{htmlFor:"streaming-fps-slider",className:"font-medium",children:["Streaming Update Rate (",b," FPS)"]}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Controls how frequently the UI updates during streaming (3-60 FPS). Lower values may feel less smooth but reduce CPU usage. (Default: 15)"})]}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(Fl,{id:"streaming-fps-slider",min:3,max:60,step:1,value:[b],onValueChange:x,onValueCommit:S,className:"flex-grow"}),m.jsx(qn,{type:"number",min:3,max:60,step:1,value:b,onChange:E,className:"w-20 h-8 text-xs"}),m.jsx("span",{className:"text-xs text-muted-foreground",children:"FPS"})]})]})]}),m.jsx(zd,{}),m.jsx("div",{className:"flex justify-end pt-4",children:m.jsxs(Mt,{variant:"outline",size:"sm",onClick:C,children:[m.jsx(pH,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})})]})},b0e=gt.memo(y0e),E9=({temperature:e,setTemperature:t,topP:n,setTopP:r,maxTokens:a,setMaxTokens:i,topK:s,setTopK:o,presencePenalty:l,setPresencePenalty:u,frequencyPenalty:d,setFrequencyPenalty:h,defaultTemperature:p=.7,defaultTopP:y=null,defaultMaxTokens:v=null,defaultTopK:b=null,defaultPresencePenalty:w=0,defaultFrequencyPenalty:x=0,className:S})=>{const{selectedModelId:E,dbProviderConfigs:C,dbApiKeys:k}=Fn(dn(B=>({selectedModelId:B.selectedModelId,dbProviderConfigs:B.dbProviderConfigs,dbApiKeys:B.dbApiKeys}))),R=T.useMemo(()=>{if(!E)return;const{providerId:B,modelId:J}=Ql(E);if(!B||!J)return;const ee=C.find(me=>me.id===B);if(!ee)return;const oe=k.find(me=>me.id===ee.apiKeyId);return ak(ee,J,oe==null?void 0:oe.value)},[E,C,k]),O=T.useMemo(()=>{var B;return new Set(((B=R==null?void 0:R.metadata)==null?void 0:B.supported_parameters)??[])},[R]),[j,$]=T.useState(e??p),[L,X]=T.useState(n??y??1),[F,K]=T.useState(l??w??0),[q,de]=T.useState(d??x??0);T.useEffect(()=>{$(e??p)},[e,p]),T.useEffect(()=>{X(n??y??1)},[n,y]),T.useEffect(()=>{K(l??w??0)},[l,w]),T.useEffect(()=>{de(d??x??0)},[d,x]);const re=T.useCallback((B,J)=>{const ee=J.target.value,oe=ee===""?null:parseInt(ee,10);(ee===""||!isNaN(oe)&&oe!==null)&&B(oe)},[]),Y=T.useCallback((B,J)=>{B(J[0])},[]),Q=T.useCallback(B=>{B(null)},[]),ae=p!==void 0||y!==void 0||v!==void 0||b!==void 0||w!==void 0||x!==void 0;return m.jsxs("div",{className:Nt("space-y-4 p-4",S),children:[O.has("temperature")&&m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(en,{htmlFor:"param-temperature",className:"text-xs",children:["Temperature (",j.toFixed(2),")"]}),m.jsx(Fl,{id:"param-temperature",min:0,max:1,step:.01,value:[j],onValueChange:B=>$(B[0]),onValueCommit:B=>Y(t,B)}),ae&&m.jsxs(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>Q(t),disabled:e===null,children:["Use Default (",(p==null?void 0:p.toFixed(2))??"N/A",")"]})]}),O.has("top_p")&&m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(en,{htmlFor:"param-top-p",className:"text-xs",children:["Top P (",(L??0).toFixed(2),")"]}),m.jsx(Fl,{id:"param-top-p",min:0,max:1,step:.01,value:[L??1],onValueChange:B=>X(B[0]),onValueCommit:B=>Y(r,B)}),ae&&m.jsxs(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>Q(r),disabled:n===null,children:["Use Default (",(y==null?void 0:y.toFixed(2))??"N/A",")"]})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[O.has("max_tokens")&&m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"param-max-tokens",className:"text-xs",children:"Max Tokens"}),m.jsx(qn,{id:"param-max-tokens",type:"number",placeholder:`Default: ${v??"None"}`,value:a??"",onChange:B=>re(i,B),min:"1",className:"h-8 text-xs"}),ae&&m.jsx(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>Q(i),disabled:a===null,children:"Use Default"})]}),O.has("top_k")&&m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"param-top-k",className:"text-xs",children:"Top K"}),m.jsx(qn,{id:"param-top-k",type:"number",placeholder:`Default: ${b??"None"}`,value:s??"",onChange:B=>re(o,B),min:"1",className:"h-8 text-xs"}),ae&&m.jsx(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>Q(o),disabled:s===null,children:"Use Default"})]})]}),O.has("presence_penalty")&&m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(en,{htmlFor:"param-presence-penalty",className:"text-xs",children:["Presence Penalty (",(F??0).toFixed(2),")"]}),m.jsx(Fl,{id:"param-presence-penalty",min:-2,max:2,step:.01,value:[F??0],onValueChange:B=>K(B[0]),onValueCommit:B=>Y(u,B)}),ae&&m.jsxs(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>Q(u),disabled:l===null,children:["Use Default (",(w==null?void 0:w.toFixed(2))??"N/A",")"]})]}),O.has("frequency_penalty")&&m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(en,{htmlFor:"param-frequency-penalty",className:"text-xs",children:["Frequency Penalty (",(q??0).toFixed(2),")"]}),m.jsx(Fl,{id:"param-frequency-penalty",min:-2,max:2,step:.01,value:[q??0],onValueChange:B=>de(B[0]),onValueCommit:B=>Y(h,B)}),ae&&m.jsxs(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>Q(h),disabled:d===null,children:["Use Default (",(x==null?void 0:x.toFixed(2))??"N/A",")"]})]})]})},v0e=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t,toolMaxSteps:n,setToolMaxSteps:r,temperature:a,setTemperature:i,topP:s,setTopP:o,maxTokens:l,setMaxTokens:u,topK:d,setTopK:h,presencePenalty:p,setPresencePenalty:y,frequencyPenalty:v,setFrequencyPenalty:b}=qr(dn(k=>({globalSystemPrompt:k.globalSystemPrompt,setGlobalSystemPrompt:k.setGlobalSystemPrompt,toolMaxSteps:k.toolMaxSteps,setToolMaxSteps:k.setToolMaxSteps,temperature:k.temperature,setTemperature:k.setTemperature,topP:k.topP,setTopP:k.setTopP,maxTokens:k.maxTokens,setMaxTokens:k.setMaxTokens,topK:k.topK,setTopK:k.setTopK,presencePenalty:k.presencePenalty,setPresencePenalty:k.setPresencePenalty,frequencyPenalty:k.frequencyPenalty,setFrequencyPenalty:k.setFrequencyPenalty}))),w=k=>{const R=k.target.value,O=R===""?5:parseInt(R,10);isNaN(O)||r(O)},x=k=>{k!==null&&i(k)},S=k=>{k!==null&&o(k)},E=k=>{k!==null&&y(k)},C=k=>{k!==null&&b(k)};return m.jsxs("div",{className:"space-y-6 p-1",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium mb-2",children:"Prompt Configuration"}),m.jsx(en,{htmlFor:"assistant-global-system-prompt",className:"text-sm mb-1 block",children:"Global System Prompt"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),m.jsx(Mu,{id:"assistant-global-system-prompt",placeholder:"Enter default system instructions for the assistant...",value:e??"",onChange:k=>t(k.target.value),rows:4})]}),m.jsx(zd,{}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium mb-2",children:"Default Parameters"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),m.jsx(E9,{temperature:a,setTemperature:x,topP:s,setTopP:S,maxTokens:l,setMaxTokens:u,topK:d,setTopK:h,presencePenalty:p,setPresencePenalty:E,frequencyPenalty:v,setFrequencyPenalty:C,reasoningEnabled:null,setReasoningEnabled:()=>{},webSearchEnabled:null,setWebSearchEnabled:()=>{},className:"p-0 w-full"})]}),m.jsx(zd,{}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium mb-2",children:"Tool Usage"}),m.jsx(en,{htmlFor:"tool-max-steps",className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),m.jsx(qn,{id:"tool-max-steps",type:"number",min:"1",max:"20",step:"1",value:n,onChange:w,className:"w-24"})]})]})},w0e=gt.memo(v0e),x0e=()=>{const{importConversation:e,exportAllConversations:t}=mn(dn(y=>({importConversation:y.importConversation,exportAllConversations:y.exportAllConversations}))),n=T.useRef(null),[r,a]=T.useState(!1),[i,s]=T.useState(!1),[o,l]=T.useState(!1),u=()=>{var y;(y=n.current)==null||y.click()},d=T.useCallback(async y=>{var b;const v=(b=y.target.files)==null?void 0:b[0];if(v){a(!0);try{await e(v)}catch(w){console.error("Import failed (from component):",w)}finally{n.current&&(n.current.value=""),a(!1)}}},[e]),h=T.useCallback(async()=>{s(!0);try{await t()}catch(y){console.error("Export all failed (from component):",y)}finally{s(!1)}},[t]),p=T.useCallback(async()=>{if(window.confirm(` ARE YOU ABSOLUTELY SURE? 

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){l(!0);try{await Ft.clearAllData(),tt.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(y){const v="Failed to clear all data";console.error(v,y),tt.error(`${v}: ${y instanceof Error?y.message:String(y)}`),l(!1)}}},[]);return m.jsxs("div",{className:"space-y-6 p-1",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium mb-2",children:"Import Conversation"}),m.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:"Import a previously exported conversation (.json file). It will be added as a new chat."}),m.jsx("input",{type:"file",ref:n,onChange:d,accept:".json",className:"hidden",id:"import-file-input",disabled:r}),m.jsxs(Mt,{onClick:u,variant:"outline",disabled:r,children:[r?m.jsx(zn,{className:"mr-2 h-4 w-4 animate-spin"}):m.jsx(jH,{className:"mr-2 h-4 w-4"}),r?"Importing...":"Select Import File..."]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium mb-2",children:"Export Data"}),m.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:"Export all your conversations and messages into a single JSON file."}),m.jsxs(Mt,{onClick:h,variant:"outline",disabled:i,children:[i?m.jsx(zn,{className:"mr-2 h-4 w-4 animate-spin"}):m.jsx(yh,{className:"mr-2 h-4 w-4"}),i?"Exporting...":"Export All Chats"]})]}),m.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[m.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),m.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),m.jsxs(Mt,{onClick:p,variant:"destructive",disabled:o,children:[o?m.jsx(zn,{className:"mr-2 h-4 w-4 animate-spin"}):m.jsx(ts,{className:"mr-2 h-4 w-4"}),o?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},_0e=gt.memo(x0e),S0e=LC("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function C9({className:e,variant:t,...n}){return m.jsx("div",{"data-slot":"alert",role:"alert",className:Nt(S0e({variant:t}),e),...n})}function k9({className:e,...t}){return m.jsx("div",{"data-slot":"alert-title",className:Nt("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function T9({className:e,...t}){return m.jsx("div",{"data-slot":"alert-description",className:Nt("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}function xp({className:e,...t}){return m.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:m.jsx("table",{"data-slot":"table",className:Nt("w-full caption-bottom text-sm",e),...t})})}function _p({className:e,...t}){return m.jsx("thead",{"data-slot":"table-header",className:Nt("[&_tr]:border-b",e),...t})}function Sp({className:e,...t}){return m.jsx("tbody",{"data-slot":"table-body",className:Nt("[&_tr:last-child]:border-0",e),...t})}function Yr({className:e,...t}){return m.jsx("tr",{"data-slot":"table-row",className:Nt("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function kr({className:e,...t}){return m.jsx("th",{"data-slot":"table-head",className:Nt("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function jn({className:e,...t}){return m.jsx("td",{"data-slot":"table-cell",className:Nt("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}const E0e=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:a,isLoading:i}=Qg(dn(R=>({loadedMods:R.loadedMods,addDbMod:R.addDbMod,updateDbMod:R.updateDbMod,deleteDbMod:R.deleteDbMod,dbMods:R.dbMods,isLoading:R.isLoading}))),[s,o]=T.useState(""),[l,u]=T.useState(""),[d,h]=T.useState(""),[p,y]=T.useState(!1),[v,b]=T.useState({}),[w,x]=T.useState({}),S=T.useCallback(async()=>{if(!s.trim()){tt.error("Mod name cannot be empty.");return}if(!l.trim()&&!d.trim()){tt.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&d.trim()){tt.error("Provide either a Mod URL or Script Content, not both.");return}y(!0);try{const R={name:s.trim(),sourceUrl:l.trim()||null,scriptContent:d.trim()||null,enabled:!0,loadOrder:((a==null?void 0:a.length)??1)*10};await t(R),o(""),u(""),h(""),tt.info("Mod added. Reload required for changes to take effect.")}catch(R){console.error("Failed to add mod (from component):",R)}finally{y(!1)}},[s,l,d,t,a==null?void 0:a.length]),E=T.useCallback(async R=>{b(O=>({...O,[R.id]:!0}));try{await n(R.id,{enabled:!R.enabled}),tt.info(`Mod "${R.name}" ${R.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(O){console.error("Failed to update mod (from component):",O)}finally{b(O=>({...O,[R.id]:!1}))}},[n]),C=T.useCallback(async R=>{if(window.confirm(`Are you sure you want to delete the mod "${R.name}"? This cannot be undone.`)){x(O=>({...O,[R.id]:!0}));try{await r(R.id),tt.info("Mod deleted. Reload required for changes to take effect.")}catch(O){console.error("Failed to delete mod (from component):",O)}finally{x(O=>({...O,[R.id]:!1}))}}},[r]),k=T.useCallback(R=>{const O=e.find($=>$.id===R);if(O)if(O.error){const $=O.error instanceof Error?O.error.message:String(O.error);return{status:"Error",error:O.error,tooltip:$}}else return{status:"Loaded"};const j=(a||[]).find($=>$.id===R);return j?j.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,a]);return m.jsxs("div",{className:"space-y-6 p-1",children:[m.jsxs(C9,{variant:"destructive",className:"border-destructive/50",children:[m.jsx(qC,{className:"h-4 w-4"}),m.jsx(k9,{children:"Security Warning"}),m.jsx(T9,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),m.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[m.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(en,{htmlFor:"mod-name",children:"Mod Name"}),m.jsx(qn,{id:"mod-name",value:s,onChange:R=>o(R.target.value),placeholder:"My Awesome Mod",disabled:p})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(en,{htmlFor:"mod-url",children:"Source URL (Optional)"}),m.jsx(qn,{id:"mod-url",type:"url",value:l,onChange:R=>u(R.target.value),placeholder:"https://example.com/my-mod.js",disabled:p||!!d.trim()})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(en,{htmlFor:"mod-script",children:"Script Content (Optional)"}),m.jsx(Mu,{id:"mod-script",value:d,onChange:R=>h(R.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:p||!!l.trim()})]}),m.jsxs(Mt,{onClick:S,disabled:p,children:[p&&m.jsx(zn,{className:"mr-2 h-4 w-4 animate-spin"}),p?"Adding...":"Add Mod"]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),m.jsx("div",{className:"rounded-md border",children:m.jsx(Kn,{delayDuration:100,children:m.jsxs(xp,{children:[m.jsx(_p,{children:m.jsxs(Yr,{children:[m.jsx(kr,{children:"Name"}),m.jsx(kr,{children:"Source"}),m.jsx(kr,{children:"Status"}),m.jsx(kr,{className:"text-center",children:"Enabled"}),m.jsx(kr,{className:"text-right",children:"Actions"})]})}),m.jsx(Sp,{children:i?m.jsxs(m.Fragment,{children:[m.jsx(Yr,{children:m.jsx(jn,{colSpan:5,children:m.jsx(ur,{className:"h-10 w-full"})})}),m.jsx(Yr,{children:m.jsx(jn,{colSpan:5,children:m.jsx(ur,{className:"h-10 w-full"})})})]}):(a||[]).length===0?m.jsx(Yr,{children:m.jsx(jn,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(a||[]).map(R=>{const{status:O,error:j,tooltip:$}=k(R.id),L=R.sourceUrl?new URL(R.sourceUrl).hostname:"Direct Script",X=v[R.id],F=w[R.id],K=X||F,q=O==="Error";return m.jsxs(Yr,{children:[m.jsx(jn,{className:"font-medium",children:R.name}),m.jsx(jn,{className:"text-muted-foreground",children:L}),m.jsxs(jn,{children:[m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx("span",{className:q?"text-destructive font-semibold cursor-help":"",children:O})}),$&&m.jsx(Jn,{className:"max-w-xs break-words",children:m.jsx("p",{children:$})})]}),q&&j&&m.jsx("p",{className:"text-xs text-destructive truncate",children:j instanceof Error?j.message:String(j)})]}),m.jsxs(jn,{className:"text-center",children:[m.jsx(Gs,{checked:R.enabled??!1,onCheckedChange:()=>E(R),disabled:K,"aria-label":`Enable ${R.name}`}),X&&m.jsx(zn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),m.jsx(jn,{className:"text-right",children:m.jsx(Mt,{variant:"ghost",size:"icon",onClick:()=>C(R),disabled:K,"aria-label":`Delete ${R.name}`,className:"text-destructive hover:text-destructive/80",children:F?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(ts,{className:"h-4 w-4"})})})]},R.id)})})]})})})]})]})},C0e=gt.memo(E0e),k0e=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:a,onUpdate:i,fetchStatus:s,isDeleting:o,onSelectModelForDetails:l})=>{var X,F;const[u,d]=T.useState(!0),h=Fv(e.type),p=rk(e.type),y=fh(e.type),v=s==="fetching"||o,b=o||s==="fetching",w=o||s==="fetching",S=Fn(K=>K.getAllAvailableModelDefsForProvider)(e.id),E=T.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),C=e.apiKeyId?t.some(K=>K.id===e.apiKeyId):!1,k=h&&!C,R=T.useCallback(async(K,q)=>{const de=new Set(e.enabledModels??[]);q?de.add(K):de.delete(K);const re=Array.from(de);try{await i(e.id,{enabledModels:re})}catch(Y){tt.error("Failed to update model status."),console.error("Failed to save model toggle:",Y)}},[e.enabledModels,e.id,i]),O=()=>d(K=>!K),j=((X=e.enabledModels)==null?void 0:X.length)??0,$=S.length,L=K=>{const q=Wc(e.id,K);l(q)};return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{children:m.jsx("span",{className:Nt("h-2.5 w-2.5 rounded-full flex-shrink-0 block",s==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),m.jsx(Jn,{side:"top",children:s==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),m.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),m.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),k&&m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{children:m.jsx(Ad,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),m.jsx(Jn,{side:"top",children:m.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),m.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[m.jsx(rr,{tooltipText:"Edit",onClick:n,disabled:b,"aria-label":"Edit provider",icon:m.jsx(o0,{}),className:"h-8 w-8"}),m.jsx(rr,{tooltipText:"Delete",onClick:r,disabled:w,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(ts,{})})]})]}),m.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[h&&m.jsxs("div",{children:["API Key:"," ",e.apiKeyId?C?m.jsx("span",{className:"text-green-400",children:((F=t.find(K=>K.id===e.apiKeyId))==null?void 0:F.name)||"Linked (Unnamed Key)"}):m.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):m.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),p&&m.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),m.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?m.jsx("span",{className:"text-green-400",children:"Enabled"}):m.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&m.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),y&&m.jsx("div",{className:"pt-1",children:m.jsxs(Mt,{variant:"outline",size:"sm",onClick:a,disabled:v,className:"text-xs h-7 px-2",children:[s==="fetching"&&m.jsx(zn,{className:"h-3 w-3 mr-1 animate-spin"}),s==="success"&&m.jsx(so,{className:"h-3 w-3 mr-1 text-green-500"}),s==="error"&&m.jsx(Ad,{className:"h-3 w-3 mr-1 text-destructive"}),s==="idle"&&m.jsx(Tw,{className:"h-3 w-3 mr-1"}),s==="fetching"?"Fetching...":s==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),m.jsxs("div",{className:"space-y-1 pt-2",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",j," / ",$," enabled)"]}),m.jsx(rr,{tooltipText:u?"Show Models":"Hide Models",onClick:O,"aria-label":u?"Show model list":"Hide model list",icon:u?m.jsx(Yo,{}):m.jsx(qd,{}),className:"h-6 w-6"})]}),!u&&m.jsx(kT,{providerId:e.id,allAvailableModels:S.map(K=>({id:K.id,name:K.name})),enabledModelIds:E,onToggleModel:R,isLoading:s==="fetching",disabled:o,listHeightClass:"h-64",onModelClick:L})]})]})},T0e=gt.memo(k0e),A0e=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:a,onCancel:i,onSave:s,onChange:o})=>{const l=Fv(t.type??null),u=rk(t.type??null),d=fh(t.type??null),h=t.isEnabled??!1,p=t.autoFetchModels??!1,y=T.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),v=T.useCallback((b,w)=>{const x=new Set(t.enabledModels??[]);w?x.add(b):x.delete(b);const S=Array.from(x);o("enabledModels",S)},[t.enabledModels,o]);return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.jsxs("div",{className:"space-y-3",children:[m.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),m.jsxs("div",{className:"space-y-1",children:[m.jsx(en,{htmlFor:`edit-name-${e}`,children:"Provider Name"}),m.jsx(qn,{id:`edit-name-${e}`,value:t.name||"",onChange:b=>o("name",b.target.value),placeholder:"Provider Name",disabled:a})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx(en,{htmlFor:`edit-type-${e}`,children:"Provider Type"}),m.jsxs(Iu,{value:t.type??"",onValueChange:b=>o("type",b),disabled:a,children:[m.jsx(Ou,{id:`edit-type-${e}`,children:m.jsx(ju,{placeholder:"Select Type"})}),m.jsx(Du,{children:Td.map(b=>m.jsx(Za,{value:b.value,children:b.label},b.value))})]})]}),l&&m.jsxs("div",{className:"space-y-1",children:[m.jsx(en,{children:"API Key"}),m.jsx(RL,{selectedKeyId:t.apiKeyId??null,onKeySelected:b=>o("apiKeyId",b),apiKeys:n,disabled:a})]}),u&&m.jsxs("div",{className:"space-y-1",children:[m.jsx(en,{htmlFor:`edit-baseurl-${e}`,children:"Base URL"}),m.jsx(qn,{id:`edit-baseurl-${e}`,value:t.baseURL||"",onChange:b=>o("baseURL",b.target.value),placeholder:"e.g., http://localhost:11434",disabled:a})]}),m.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[m.jsx(Gs,{id:`edit-enabled-${e}`,checked:h,onCheckedChange:b=>o("isEnabled",b),disabled:a,"aria-labelledby":`edit-enabled-label-${e}`}),m.jsx(en,{id:`edit-enabled-label-${e}`,htmlFor:`edit-enabled-${e}`,children:"Provider Enabled"})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Gs,{id:`edit-autofetch-${e}`,checked:p,onCheckedChange:b=>o("autoFetchModels",b),disabled:!d||a,"aria-labelledby":`edit-autofetch-label-${e}`}),m.jsxs(en,{id:`edit-autofetch-label-${e}`,htmlFor:`edit-autofetch-${e}`,className:d?"":"text-muted-foreground",children:["Auto-fetch models ",d?"":"(Not Supported)"]})]})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),m.jsx(kT,{providerId:e,allAvailableModels:r,enabledModelIds:y,onToggleModel:v,disabled:a,listHeightClass:"h-[calc(100%-8rem)]"})]})]}),m.jsx(zd,{className:"my-4"}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Mt,{variant:"ghost",size:"sm",onClick:i,disabled:a,type:"button",children:[m.jsx(Ts,{className:"h-4 w-4 mr-1"})," Cancel Edit"]}),m.jsxs(Mt,{variant:"secondary",size:"sm",onClick:s,disabled:a,type:"button",children:[a&&m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(Vd,{className:"h-4 w-4 mr-1"})," ",a?"Saving...":"Save Changes"]})]})]})},N0e=gt.memo(A0e),R0e=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:a,fetchStatus:i,onSelectModelForDetails:s})=>{const[o,l]=T.useState(!1),[u,d]=T.useState(!1),[h,p]=T.useState(!1),[y,v]=T.useState({}),b=Fn($=>$.getAllAvailableModelDefsForProvider),[w,x]=T.useState([]),S=T.useMemo(()=>[...w].sort(($,L)=>($.name||$.id).localeCompare(L.name||L.id)),[w]);T.useEffect(()=>{if(o){const $=b(e.id);x($.map(L=>({id:L.id,name:L.name}))),v({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else x([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,b]);const E=()=>l(!0),C=()=>{l(!1),v({}),d(!1)},k=T.useCallback(async()=>{d(!0);try{const $=y.enabledModels&&y.enabledModels.length>0?y.enabledModels:null,L={name:y.name,type:y.type,isEnabled:y.isEnabled,apiKeyId:y.apiKeyId,baseURL:y.baseURL,autoFetchModels:y.autoFetchModels,enabledModels:$};Object.keys(L).forEach(X=>{L[X]===void 0&&delete L[X]}),await n(e.id,L),l(!1),v({}),tt.success(`Provider "${L.name||e.name}" updated.`)}catch($){console.error("Failed to save provider update:",$),tt.error("Failed to save provider configuration.")}finally{d(!1)}},[y,n,e.id,e.name]),R=T.useCallback(($,L)=>{v(X=>({...X,[$]:L}))},[]),O=T.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){p(!0);try{await r(e.id)}catch($){console.error("Failed to delete provider:",$),p(!1)}}},[r,e.id,e.name]),j=T.useCallback(async()=>{if(await a(e.id),o){const $=b(e.id);x($.map(L=>({id:L.id,name:L.name})))}},[a,e.id,o,b]);return m.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?m.jsx(N0e,{providerId:e.id,editData:y,apiKeys:t,allAvailableModels:S,isSaving:u,onCancel:C,onSave:k,onChange:R,onUpdate:n}):m.jsx(T0e,{provider:e,apiKeys:t,onEdit:E,onDelete:O,onFetchModels:j,onUpdate:n,fetchStatus:i,isDeleting:h,onSelectModelForDetails:s})})},I0e=gt.memo(R0e);var t2="rovingFocusGroup.onEntryFocus",j0e={bubbles:!1,cancelable:!0},K0="RovingFocusGroup",[TC,A9,O0e]=Tx(K0),[D0e,Kx]=Si(K0,[O0e]),[M0e,P0e]=D0e(K0),N9=T.forwardRef((e,t)=>m.jsx(TC.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(TC.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(F0e,{...e,ref:t})})}));N9.displayName=K0;var F0e=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:i,currentTabStopId:s,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=e,p=T.useRef(null),y=Cn(t,p),v=bp(i),[b,w]=no({prop:s,defaultProp:o??null,onChange:l,caller:K0}),[x,S]=T.useState(!1),E=Fa(u),C=A9(n),k=T.useRef(!1),[R,O]=T.useState(0);return T.useEffect(()=>{const j=p.current;if(j)return j.addEventListener(t2,E),()=>j.removeEventListener(t2,E)},[E]),m.jsx(M0e,{scope:n,orientation:r,dir:v,loop:a,currentTabStopId:b,onItemFocus:T.useCallback(j=>w(j),[w]),onItemShiftTab:T.useCallback(()=>S(!0),[]),onFocusableItemAdd:T.useCallback(()=>O(j=>j+1),[]),onFocusableItemRemove:T.useCallback(()=>O(j=>j-1),[]),children:m.jsx(rn.div,{tabIndex:x||R===0?-1:0,"data-orientation":r,...h,ref:y,style:{outline:"none",...e.style},onMouseDown:Vt(e.onMouseDown,()=>{k.current=!0}),onFocus:Vt(e.onFocus,j=>{const $=!k.current;if(j.target===j.currentTarget&&$&&!x){const L=new CustomEvent(t2,j0e);if(j.currentTarget.dispatchEvent(L),!L.defaultPrevented){const X=C().filter(re=>re.focusable),F=X.find(re=>re.active),K=X.find(re=>re.id===b),de=[F,K,...X].filter(Boolean).map(re=>re.ref.current);j9(de,d)}}k.current=!1}),onBlur:Vt(e.onBlur,()=>S(!1))})})}),R9="RovingFocusGroupItem",I9=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:i,children:s,...o}=e,l=Ya(),u=i||l,d=P0e(R9,n),h=d.currentTabStopId===u,p=A9(n),{onFocusableItemAdd:y,onFocusableItemRemove:v,currentTabStopId:b}=d;return T.useEffect(()=>{if(r)return y(),()=>v()},[r,y,v]),m.jsx(TC.ItemSlot,{scope:n,id:u,focusable:r,active:a,children:m.jsx(rn.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...o,ref:t,onMouseDown:Vt(e.onMouseDown,w=>{r?d.onItemFocus(u):w.preventDefault()}),onFocus:Vt(e.onFocus,()=>d.onItemFocus(u)),onKeyDown:Vt(e.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){d.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const x=B0e(w,d.orientation,d.dir);if(x!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let E=p().filter(C=>C.focusable).map(C=>C.ref.current);if(x==="last")E.reverse();else if(x==="prev"||x==="next"){x==="prev"&&E.reverse();const C=E.indexOf(w.currentTarget);E=d.loop?z0e(E,C+1):E.slice(C+1)}setTimeout(()=>j9(E))}}),children:typeof s=="function"?s({isCurrentTabStop:h,hasTabStop:b!=null}):s})})});I9.displayName=R9;var L0e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $0e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function B0e(e,t,n){const r=$0e(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return L0e[r]}function j9(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function z0e(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var O9=N9,D9=I9,Zx="Tabs",[U0e,h_e]=Si(Zx,[Kx]),M9=Kx(),[q0e,zT]=U0e(Zx),P9=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:i,orientation:s="horizontal",dir:o,activationMode:l="automatic",...u}=e,d=bp(o),[h,p]=no({prop:r,onChange:a,defaultProp:i??"",caller:Zx});return m.jsx(q0e,{scope:n,baseId:Ya(),value:h,onValueChange:p,orientation:s,dir:d,activationMode:l,children:m.jsx(rn.div,{dir:d,"data-orientation":s,...u,ref:t})})});P9.displayName=Zx;var F9="TabsList",L9=T.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,i=zT(F9,n),s=M9(n);return m.jsx(O9,{asChild:!0,...s,orientation:i.orientation,dir:i.dir,loop:r,children:m.jsx(rn.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});L9.displayName=F9;var $9="TabsTrigger",B9=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...i}=e,s=zT($9,n),o=M9(n),l=q9(s.baseId,r),u=H9(s.baseId,r),d=r===s.value;return m.jsx(D9,{asChild:!0,...o,focusable:!a,active:d,children:m.jsx(rn.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:l,...i,ref:t,onMouseDown:Vt(e.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?s.onValueChange(r):h.preventDefault()}),onKeyDown:Vt(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&s.onValueChange(r)}),onFocus:Vt(e.onFocus,()=>{const h=s.activationMode!=="manual";!d&&!a&&h&&s.onValueChange(r)})})})});B9.displayName=$9;var z9="TabsContent",U9=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:i,...s}=e,o=zT(z9,n),l=q9(o.baseId,r),u=H9(o.baseId,r),d=r===o.value,h=T.useRef(d);return T.useEffect(()=>{const p=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(p)},[]),m.jsx(ka,{present:a||d,children:({present:p})=>m.jsx(rn.div,{"data-state":d?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!p,id:u,tabIndex:0,...s,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:p&&i})})});U9.displayName=z9;function q9(e,t){return`${e}-trigger-${t}`}function H9(e,t){return`${e}-content-${t}`}var H0e=P9,V0e=L9,G0e=B9,W0e=U9;function K0e({className:e,...t}){return m.jsx(H0e,{"data-slot":"tabs",className:Nt("flex flex-col gap-2",e),...t})}function Z0e({className:e,...t}){return m.jsx(V0e,{"data-slot":"tabs-list",className:Nt("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function Y0e({className:e,...t}){return m.jsx(G0e,{"data-slot":"tabs-trigger",className:Nt("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function X0e({className:e,...t}){return m.jsx(W0e,{"data-slot":"tabs-content",className:Nt("flex-1 outline-none",e),...t})}const Pu=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:a,listClassName:i,contentContainerClassName:s,scrollable:o})=>{var y;const[l,u]=T.useState(n??t??((y=e[0])==null?void 0:y.value));T.useEffect(()=>{n!==void 0&&n!==l&&u(n)},[n,l]);const d=v=>{u(v),r&&r(v)},h=Nt("px-3 py-1.5 text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),p=({children:v})=>{const b=Nt("flex-grow overflow-y-auto pb-6 pr-2 -mr-2",s);return o?m.jsx(Yl,{className:b,children:v}):m.jsx("div",{className:b,children:v})};return m.jsxs(K0e,{value:l,onValueChange:d,defaultValue:t,className:Nt("flex flex-col h-full",a),children:[m.jsx(Z0e,{className:Nt("flex-shrink-0 sticky top-0 bg-background z-10 mb-4 flex-wrap h-auto justify-start border-b gap-1 p-1 -mx-6 px-6",i),children:e.map(v=>m.jsx(Y0e,{value:v.value,disabled:v.disabled,className:h,children:v.label},v.value))}),m.jsx(p,{children:e.map(v=>m.jsx(X0e,{value:v.value,className:"data-[state=inactive]:hidden h-full",children:v.content},v.value))})]})};function J0e(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return T.useMemo(()=>r=>{t.forEach(a=>a(r))},t)}const Yx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ep(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function UT(e){return"nodeType"in e}function Bi(e){var t,n;return e?Ep(e)?e:UT(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function qT(e){const{Document:t}=Bi(e);return e instanceof t}function Z0(e){return Ep(e)?!1:e instanceof Bi(e).HTMLElement}function V9(e){return e instanceof Bi(e).SVGElement}function Cp(e){return e?Ep(e)?e.document:UT(e)?qT(e)?e:Z0(e)||V9(e)?e.ownerDocument:document:document:document}const Zo=Yx?T.useLayoutEffect:T.useEffect;function HT(e){const t=T.useRef(e);return Zo(()=>{t.current=e}),T.useCallback(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t.current==null?void 0:t.current(...r)},[])}function Q0e(){const e=T.useRef(null),t=T.useCallback((r,a)=>{e.current=setInterval(r,a)},[]),n=T.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function e0(e,t){t===void 0&&(t=[e]);const n=T.useRef(e);return Zo(()=>{n.current!==e&&(n.current=e)},t),n}function Y0(e,t){const n=T.useRef();return T.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function ww(e){const t=HT(e),n=T.useRef(null),r=T.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,r]}function AC(e){const t=T.useRef();return T.useEffect(()=>{t.current=e},[e]),t.current}let n2={};function X0(e,t){return T.useMemo(()=>{if(t)return t;const n=n2[e]==null?0:n2[e]+1;return n2[e]=n,e+"-"+n},[e,t])}function G9(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.reduce((i,s)=>{const o=Object.entries(s);for(const[l,u]of o){const d=i[l];d!=null&&(i[l]=d+e*u)}return i},{...t})}}const Eh=G9(1),t0=G9(-1);function eye(e){return"clientX"in e&&"clientY"in e}function VT(e){if(!e)return!1;const{KeyboardEvent:t}=Bi(e.target);return t&&e instanceof t}function tye(e){if(!e)return!1;const{TouchEvent:t}=Bi(e.target);return t&&e instanceof t}function NC(e){if(tye(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return eye(e)?{x:e.clientX,y:e.clientY}:null}const n0=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[n0.Translate.toString(e),n0.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),IO="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function nye(e){return e.matches(IO)?e:e.querySelector(IO)}const rye={display:"none"};function aye(e){let{id:t,value:n}=e;return gt.createElement("div",{id:t,style:rye},n)}function iye(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return gt.createElement("div",{id:t,style:a,role:"status","aria-live":r,"aria-atomic":!0},n)}function sye(){const[e,t]=T.useState("");return{announce:T.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const W9=T.createContext(null);function oye(e){const t=T.useContext(W9);T.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function lye(){const[e]=T.useState(()=>new Set),t=T.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[T.useCallback(r=>{let{type:a,event:i}=r;e.forEach(s=>{var o;return(o=s[a])==null?void 0:o.call(s,i)})},[e]),t]}const cye={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},uye={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function dye(e){let{announcements:t=uye,container:n,hiddenTextDescribedById:r,screenReaderInstructions:a=cye}=e;const{announce:i,announcement:s}=sye(),o=X0("DndLiveRegion"),[l,u]=T.useState(!1);if(T.useEffect(()=>{u(!0)},[]),oye(T.useMemo(()=>({onDragStart(h){let{active:p}=h;i(t.onDragStart({active:p}))},onDragMove(h){let{active:p,over:y}=h;t.onDragMove&&i(t.onDragMove({active:p,over:y}))},onDragOver(h){let{active:p,over:y}=h;i(t.onDragOver({active:p,over:y}))},onDragEnd(h){let{active:p,over:y}=h;i(t.onDragEnd({active:p,over:y}))},onDragCancel(h){let{active:p,over:y}=h;i(t.onDragCancel({active:p,over:y}))}}),[i,t])),!l)return null;const d=gt.createElement(gt.Fragment,null,gt.createElement(aye,{id:r,value:a.draggable}),gt.createElement(iye,{id:o,announcement:s}));return n?$o.createPortal(d,n):d}var wa;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(wa||(wa={}));function xw(){}function jO(e,t){return T.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function fye(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return T.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const io=Object.freeze({x:0,y:0});function K9(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Z9(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function hye(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function OO(e){let{left:t,top:n,height:r,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+r},{x:t+a,y:n+r}]}function Y9(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function DO(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const pye=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const a=DO(t,t.left,t.top),i=[];for(const s of r){const{id:o}=s,l=n.get(o);if(l){const u=K9(DO(l),a);i.push({id:o,data:{droppableContainer:s,value:u}})}}return i.sort(Z9)},mye=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const a=OO(t),i=[];for(const s of r){const{id:o}=s,l=n.get(o);if(l){const u=OO(l),d=a.reduce((p,y,v)=>p+K9(u[v],y),0),h=Number((d/4).toFixed(4));i.push({id:o,data:{droppableContainer:s,value:h}})}}return i.sort(Z9)};function gye(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),s=a-r,o=i-n;if(r<a&&n<i){const l=t.width*t.height,u=e.width*e.height,d=s*o,h=d/(l+u-d);return Number(h.toFixed(4))}return 0}const yye=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const a=[];for(const i of r){const{id:s}=i,o=n.get(s);if(o){const l=gye(o,t);l>0&&a.push({id:s,data:{droppableContainer:i,value:l}})}}return a.sort(hye)};function bye(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function X9(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:io}function vye(e){return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return a.reduce((s,o)=>({...s,top:s.top+e*o.y,bottom:s.bottom+e*o.y,left:s.left+e*o.x,right:s.right+e*o.x}),{...n})}}const wye=vye(1);function xye(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function _ye(e,t,n){const r=xye(t);if(!r)return e;const{scaleX:a,scaleY:i,x:s,y:o}=r,l=e.left-s-(1-a)*parseFloat(n),u=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),d=a?e.width/a:e.width,h=i?e.height/i:e.height;return{width:d,height:h,top:u,right:l+d,bottom:u+h,left:l}}const Sye={ignoreTransform:!1};function kp(e,t){t===void 0&&(t=Sye);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Bi(e).getComputedStyle(e);u&&(n=_ye(n,u,d))}const{top:r,left:a,width:i,height:s,bottom:o,right:l}=n;return{top:r,left:a,width:i,height:s,bottom:o,right:l}}function MO(e){return kp(e,{ignoreTransform:!0})}function Eye(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Cye(e,t){return t===void 0&&(t=Bi(e).getComputedStyle(e)),t.position==="fixed"}function kye(e,t){t===void 0&&(t=Bi(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?n.test(i):!1})}function Xx(e,t){const n=[];function r(a){if(t!=null&&n.length>=t||!a)return n;if(qT(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!Z0(a)||V9(a)||n.includes(a))return n;const i=Bi(e).getComputedStyle(a);return a!==e&&kye(a,i)&&n.push(a),Cye(a,i)?n:r(a.parentNode)}return e?r(e):n}function J9(e){const[t]=Xx(e,1);return t??null}function r2(e){return!Yx||!e?null:Ep(e)?e:UT(e)?qT(e)||e===Cp(e).scrollingElement?window:Z0(e)?e:null:null}function Q9(e){return Ep(e)?e.scrollX:e.scrollLeft}function eB(e){return Ep(e)?e.scrollY:e.scrollTop}function RC(e){return{x:Q9(e),y:eB(e)}}var Pa;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Pa||(Pa={}));function tB(e){return!Yx||!e?!1:e===document.scrollingElement}function nB(e){const t={x:0,y:0},n=tB(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,s=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:a,isLeft:i,isBottom:s,isRight:o,maxScroll:r,minScroll:t}}const Tye={x:.2,y:.2};function Aye(e,t,n,r,a){let{top:i,left:s,right:o,bottom:l}=n;r===void 0&&(r=10),a===void 0&&(a=Tye);const{isTop:u,isBottom:d,isLeft:h,isRight:p}=nB(e),y={x:0,y:0},v={x:0,y:0},b={height:t.height*a.y,width:t.width*a.x};return!u&&i<=t.top+b.height?(y.y=Pa.Backward,v.y=r*Math.abs((t.top+b.height-i)/b.height)):!d&&l>=t.bottom-b.height&&(y.y=Pa.Forward,v.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!p&&o>=t.right-b.width?(y.x=Pa.Forward,v.x=r*Math.abs((t.right-b.width-o)/b.width)):!h&&s<=t.left+b.width&&(y.x=Pa.Backward,v.x=r*Math.abs((t.left+b.width-s)/b.width)),{direction:y,speed:v}}function Nye(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:s}=window;return{top:0,left:0,right:i,bottom:s,width:i,height:s}}const{top:t,left:n,right:r,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:a,width:e.clientWidth,height:e.clientHeight}}function rB(e){return e.reduce((t,n)=>Eh(t,RC(n)),io)}function Rye(e){return e.reduce((t,n)=>t+Q9(n),0)}function Iye(e){return e.reduce((t,n)=>t+eB(n),0)}function jye(e,t){if(t===void 0&&(t=kp),!e)return;const{top:n,left:r,bottom:a,right:i}=t(e);J9(e)&&(a<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Oye=[["x",["left","right"],Rye],["y",["top","bottom"],Iye]];class GT{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Xx(n),a=rB(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,s,o]of Oye)for(const l of s)Object.defineProperty(this,l,{get:()=>{const u=o(r),d=a[i]-u;return this.rect[l]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Xm{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var a;(a=this.target)==null||a.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Dye(e){const{EventTarget:t}=Bi(e);return e instanceof t?e:Cp(e)}function a2(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var xs;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(xs||(xs={}));function PO(e){e.preventDefault()}function Mye(e){e.stopPropagation()}var Qn;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Qn||(Qn={}));const aB={start:[Qn.Space,Qn.Enter],cancel:[Qn.Esc],end:[Qn.Space,Qn.Enter,Qn.Tab]},Pye=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Qn.Right:return{...n,x:n.x+25};case Qn.Left:return{...n,x:n.x-25};case Qn.Down:return{...n,y:n.y+25};case Qn.Up:return{...n,y:n.y-25}}};class WT{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Xm(Cp(n)),this.windowListeners=new Xm(Bi(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(xs.Resize,this.handleCancel),this.windowListeners.add(xs.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(xs.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&jye(r),n(io)}handleKeyDown(t){if(VT(t)){const{active:n,context:r,options:a}=this.props,{keyboardCodes:i=aB,coordinateGetter:s=Pye,scrollBehavior:o="smooth"}=a,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:u}=r.current,d=u?{x:u.left,y:u.top}:io;this.referenceCoordinates||(this.referenceCoordinates=d);const h=s(t,{active:n,context:r.current,currentCoordinates:d});if(h){const p=t0(h,d),y={x:0,y:0},{scrollableAncestors:v}=r.current;for(const b of v){const w=t.code,{isTop:x,isRight:S,isLeft:E,isBottom:C,maxScroll:k,minScroll:R}=nB(b),O=Nye(b),j={x:Math.min(w===Qn.Right?O.right-O.width/2:O.right,Math.max(w===Qn.Right?O.left:O.left+O.width/2,h.x)),y:Math.min(w===Qn.Down?O.bottom-O.height/2:O.bottom,Math.max(w===Qn.Down?O.top:O.top+O.height/2,h.y))},$=w===Qn.Right&&!S||w===Qn.Left&&!E,L=w===Qn.Down&&!C||w===Qn.Up&&!x;if($&&j.x!==h.x){const X=b.scrollLeft+p.x,F=w===Qn.Right&&X<=k.x||w===Qn.Left&&X>=R.x;if(F&&!p.y){b.scrollTo({left:X,behavior:o});return}F?y.x=b.scrollLeft-X:y.x=w===Qn.Right?b.scrollLeft-k.x:b.scrollLeft-R.x,y.x&&b.scrollBy({left:-y.x,behavior:o});break}else if(L&&j.y!==h.y){const X=b.scrollTop+p.y,F=w===Qn.Down&&X<=k.y||w===Qn.Up&&X>=R.y;if(F&&!p.x){b.scrollTo({top:X,behavior:o});return}F?y.y=b.scrollTop-X:y.y=w===Qn.Down?b.scrollTop-k.y:b.scrollTop-R.y,y.y&&b.scrollBy({top:-y.y,behavior:o});break}}this.handleMove(t,Eh(t0(h,this.referenceCoordinates),y))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}WT.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=aB,onActivation:a}=t,{active:i}=n;const{code:s}=e.nativeEvent;if(r.start.includes(s)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function FO(e){return!!(e&&"distance"in e)}function LO(e){return!!(e&&"delay"in e)}class KT{constructor(t,n,r){var a;r===void 0&&(r=Dye(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:s}=i;this.props=t,this.events=n,this.document=Cp(s),this.documentListeners=new Xm(this.document),this.listeners=new Xm(r),this.windowListeners=new Xm(Bi(s)),this.initialCoordinates=(a=NC(i))!=null?a:io,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(xs.Resize,this.handleCancel),this.windowListeners.add(xs.DragStart,PO),this.windowListeners.add(xs.VisibilityChange,this.handleCancel),this.windowListeners.add(xs.ContextMenu,PO),this.documentListeners.add(xs.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(LO(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(FO(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:a}=this.props;a(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(xs.Click,Mye,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(xs.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:a,props:i}=this,{onMove:s,options:{activationConstraint:o}}=i;if(!a)return;const l=(n=NC(t))!=null?n:io,u=t0(a,l);if(!r&&o){if(FO(o)){if(o.tolerance!=null&&a2(u,o.tolerance))return this.handleCancel();if(a2(u,o.distance))return this.handleStart()}if(LO(o)&&a2(u,o.tolerance))return this.handleCancel();this.handlePending(o,u);return}t.cancelable&&t.preventDefault(),s(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Qn.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Fye={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ZT extends KT{constructor(t){const{event:n}=t,r=Cp(n.target);super(t,Fye,r)}}ZT.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Lye={move:{name:"mousemove"},end:{name:"mouseup"}};var IC;(function(e){e[e.RightClick=2]="RightClick"})(IC||(IC={}));class $ye extends KT{constructor(t){super(t,Lye,Cp(t.event.target))}}$ye.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===IC.RightClick?!1:(r==null||r({event:n}),!0)}}];const i2={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Bye extends KT{constructor(t){super(t,i2)}static setup(){return window.addEventListener(i2.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(i2.move.name,t)};function t(){}}}Bye.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:a}=n;return a.length>1?!1:(r==null||r({event:n}),!0)}}];var Jm;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Jm||(Jm={}));var _w;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(_w||(_w={}));function zye(e){let{acceleration:t,activator:n=Jm.Pointer,canScroll:r,draggingRect:a,enabled:i,interval:s=5,order:o=_w.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:p}=e;const y=qye({delta:h,disabled:!i}),[v,b]=Q0e(),w=T.useRef({x:0,y:0}),x=T.useRef({x:0,y:0}),S=T.useMemo(()=>{switch(n){case Jm.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Jm.DraggableRect:return a}},[n,a,l]),E=T.useRef(null),C=T.useCallback(()=>{const R=E.current;if(!R)return;const O=w.current.x*x.current.x,j=w.current.y*x.current.y;R.scrollBy(O,j)},[]),k=T.useMemo(()=>o===_w.TreeOrder?[...u].reverse():u,[o,u]);T.useEffect(()=>{if(!i||!u.length||!S){b();return}for(const R of k){if((r==null?void 0:r(R))===!1)continue;const O=u.indexOf(R),j=d[O];if(!j)continue;const{direction:$,speed:L}=Aye(R,j,S,t,p);for(const X of["x","y"])y[X][$[X]]||(L[X]=0,$[X]=0);if(L.x>0||L.y>0){b(),E.current=R,v(C,s),w.current=L,x.current=$;return}}w.current={x:0,y:0},x.current={x:0,y:0},b()},[t,C,r,b,i,s,JSON.stringify(S),JSON.stringify(y),v,u,k,d,JSON.stringify(p)])}const Uye={x:{[Pa.Backward]:!1,[Pa.Forward]:!1},y:{[Pa.Backward]:!1,[Pa.Forward]:!1}};function qye(e){let{delta:t,disabled:n}=e;const r=AC(t);return Y0(a=>{if(n||!r||!a)return Uye;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[Pa.Backward]:a.x[Pa.Backward]||i.x===-1,[Pa.Forward]:a.x[Pa.Forward]||i.x===1},y:{[Pa.Backward]:a.y[Pa.Backward]||i.y===-1,[Pa.Forward]:a.y[Pa.Forward]||i.y===1}}},[n,t,r])}function Hye(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Y0(a=>{var i;return t==null?null:(i=r??a)!=null?i:null},[r,t])}function Vye(e,t){return T.useMemo(()=>e.reduce((n,r)=>{const{sensor:a}=r,i=a.activators.map(s=>({eventName:s.eventName,handler:t(s.handler,r)}));return[...n,...i]},[]),[e,t])}var r0;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(r0||(r0={}));var jC;(function(e){e.Optimized="optimized"})(jC||(jC={}));const $O=new Map;function Gye(e,t){let{dragging:n,dependencies:r,config:a}=t;const[i,s]=T.useState(null),{frequency:o,measure:l,strategy:u}=a,d=T.useRef(e),h=w(),p=e0(h),y=T.useCallback(function(x){x===void 0&&(x=[]),!p.current&&s(S=>S===null?x:S.concat(x.filter(E=>!S.includes(E))))},[p]),v=T.useRef(null),b=Y0(x=>{if(h&&!n)return $O;if(!x||x===$O||d.current!==e||i!=null){const S=new Map;for(let E of e){if(!E)continue;if(i&&i.length>0&&!i.includes(E.id)&&E.rect.current){S.set(E.id,E.rect.current);continue}const C=E.node.current,k=C?new GT(l(C),C):null;E.rect.current=k,k&&S.set(E.id,k)}return S}return x},[e,i,n,h,l]);return T.useEffect(()=>{d.current=e},[e]),T.useEffect(()=>{h||y()},[n,h]),T.useEffect(()=>{i&&i.length>0&&s(null)},[JSON.stringify(i)]),T.useEffect(()=>{h||typeof o!="number"||v.current!==null||(v.current=setTimeout(()=>{y(),v.current=null},o))},[o,h,y,...r]),{droppableRects:b,measureDroppableContainers:y,measuringScheduled:i!=null};function w(){switch(u){case r0.Always:return!1;case r0.BeforeDragging:return n;default:return!n}}}function iB(e,t){return Y0(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Wye(e,t){return iB(e,t)}function Kye(e){let{callback:t,disabled:n}=e;const r=HT(t),a=T.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return T.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Jx(e){let{callback:t,disabled:n}=e;const r=HT(t),a=T.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return T.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Zye(e){return new GT(kp(e),e)}function BO(e,t,n){t===void 0&&(t=Zye);const[r,a]=T.useState(null);function i(){a(l=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=l??n)!=null?u:null}const d=t(e);return JSON.stringify(l)===JSON.stringify(d)?l:d})}const s=Kye({callback(l){if(e)for(const u of l){const{type:d,target:h}=u;if(d==="childList"&&h instanceof HTMLElement&&h.contains(e)){i();break}}}}),o=Jx({callback:i});return Zo(()=>{i(),e?(o==null||o.observe(e),s==null||s.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),s==null||s.disconnect())},[e]),r}function Yye(e){const t=iB(e);return X9(e,t)}const zO=[];function Xye(e){const t=T.useRef(e),n=Y0(r=>e?r&&r!==zO&&e&&t.current&&e.parentNode===t.current.parentNode?r:Xx(e):zO,[e]);return T.useEffect(()=>{t.current=e},[e]),n}function Jye(e){const[t,n]=T.useState(null),r=T.useRef(e),a=T.useCallback(i=>{const s=r2(i.target);s&&n(o=>o?(o.set(s,RC(s)),new Map(o)):null)},[]);return T.useEffect(()=>{const i=r.current;if(e!==i){s(i);const o=e.map(l=>{const u=r2(l);return u?(u.addEventListener("scroll",a,{passive:!0}),[u,RC(u)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{s(e),s(i)};function s(o){o.forEach(l=>{const u=r2(l);u==null||u.removeEventListener("scroll",a)})}},[a,e]),T.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,s)=>Eh(i,s),io):rB(e):io,[e,t])}function UO(e,t){t===void 0&&(t=[]);const n=T.useRef(null);return T.useEffect(()=>{n.current=null},t),T.useEffect(()=>{const r=e!==io;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?t0(e,n.current):io}function Qye(e){T.useEffect(()=>{if(!Yx)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function ebe(e,t){return T.useMemo(()=>e.reduce((n,r)=>{let{eventName:a,handler:i}=r;return n[a]=s=>{i(s,t)},n},{}),[e,t])}function sB(e){return T.useMemo(()=>e?Eye(e):null,[e])}const qO=[];function tbe(e,t){t===void 0&&(t=kp);const[n]=e,r=sB(n?Bi(n):null),[a,i]=T.useState(qO);function s(){i(()=>e.length?e.map(l=>tB(l)?r:new GT(t(l),l)):qO)}const o=Jx({callback:s});return Zo(()=>{o==null||o.disconnect(),s(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),a}function nbe(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Z0(t)?t:e}function rbe(e){let{measure:t}=e;const[n,r]=T.useState(null),a=T.useCallback(u=>{for(const{target:d}of u)if(Z0(d)){r(h=>{const p=t(d);return h?{...h,width:p.width,height:p.height}:p});break}},[t]),i=Jx({callback:a}),s=T.useCallback(u=>{const d=nbe(u);i==null||i.disconnect(),d&&(i==null||i.observe(d)),r(d?t(d):null)},[t,i]),[o,l]=ww(s);return T.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const abe=[{sensor:ZT,options:{}},{sensor:WT,options:{}}],ibe={current:{}},cv={draggable:{measure:MO},droppable:{measure:MO,strategy:r0.WhileDragging,frequency:jC.Optimized},dragOverlay:{measure:kp}};class Qm extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const sbe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Qm,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:xw},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:cv,measureDroppableContainers:xw,windowRect:null,measuringScheduled:!1},obe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:xw,draggableNodes:new Map,over:null,measureDroppableContainers:xw},Qx=T.createContext(obe),oB=T.createContext(sbe);function lbe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Qm}}}function cbe(e,t){switch(t.type){case wa.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case wa.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case wa.DragEnd:case wa.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case wa.RegisterDroppable:{const{element:n}=t,{id:r}=n,a=new Qm(e.droppable.containers);return a.set(r,n),{...e,droppable:{...e.droppable,containers:a}}}case wa.SetDroppableDisabled:{const{id:n,key:r,disabled:a}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const s=new Qm(e.droppable.containers);return s.set(n,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:s}}}case wa.UnregisterDroppable:{const{id:n,key:r}=t,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const i=new Qm(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function ube(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:a}=T.useContext(Qx),i=AC(r),s=AC(n==null?void 0:n.id);return T.useEffect(()=>{if(!t&&!r&&i&&s!=null){if(!VT(i)||document.activeElement===i.target)return;const o=a.get(s);if(!o)return;const{activatorNode:l,node:u}=o;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[l.current,u.current]){if(!d)continue;const h=nye(d);if(h){h.focus();break}}})}},[r,t,a,s,i]),null}function dbe(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...r}),n):n}function fbe(e){return T.useMemo(()=>({draggable:{...cv.draggable,...e==null?void 0:e.draggable},droppable:{...cv.droppable,...e==null?void 0:e.droppable},dragOverlay:{...cv.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function hbe(e){let{activeNode:t,measure:n,initialRect:r,config:a=!0}=e;const i=T.useRef(!1),{x:s,y:o}=typeof a=="boolean"?{x:a,y:a}:a;Zo(()=>{if(!s&&!o||!t){i.current=!1;return}if(i.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=n(u),h=X9(d,r);if(s||(h.x=0),o||(h.y=0),i.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const p=J9(u);p&&p.scrollBy({top:h.y,left:h.x})}},[t,s,o,r,n])}const lB=T.createContext({...io,scaleX:1,scaleY:1});var Hc;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Hc||(Hc={}));const pbe=T.memo(function(t){var n,r,a,i;let{id:s,accessibility:o,autoScroll:l=!0,children:u,sensors:d=abe,collisionDetection:h=yye,measuring:p,modifiers:y,...v}=t;const b=T.useReducer(cbe,void 0,lbe),[w,x]=b,[S,E]=lye(),[C,k]=T.useState(Hc.Uninitialized),R=C===Hc.Initialized,{draggable:{active:O,nodes:j,translate:$},droppable:{containers:L}}=w,X=O!=null?j.get(O):null,F=T.useRef({initial:null,translated:null}),K=T.useMemo(()=>{var nt;return O!=null?{id:O,data:(nt=X==null?void 0:X.data)!=null?nt:ibe,rect:F}:null},[O,X]),q=T.useRef(null),[de,re]=T.useState(null),[Y,Q]=T.useState(null),ae=e0(v,Object.values(v)),B=X0("DndDescribedBy",s),J=T.useMemo(()=>L.getEnabled(),[L]),ee=fbe(p),{droppableRects:oe,measureDroppableContainers:me,measuringScheduled:xe}=Gye(J,{dragging:R,dependencies:[$.x,$.y],config:ee.droppable}),Pe=Hye(j,O),Ne=T.useMemo(()=>Y?NC(Y):null,[Y]),Re=Be(),ke=Wye(Pe,ee.draggable.measure);hbe({activeNode:O!=null?j.get(O):null,config:Re.layoutShiftCompensation,initialRect:ke,measure:ee.draggable.measure});const Fe=BO(Pe,ee.draggable.measure,ke),Qe=BO(Pe?Pe.parentElement:null),Le=T.useRef({activatorEvent:null,active:null,activeNode:Pe,collisionRect:null,collisions:null,droppableRects:oe,draggableNodes:j,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ie=L.getNodeFor((n=Le.current.over)==null?void 0:n.id),V=rbe({measure:ee.dragOverlay.measure}),ge=(r=V.nodeRef.current)!=null?r:Pe,Te=R?(a=V.rect)!=null?a:Fe:null,le=!!(V.nodeRef.current&&V.rect),ie=Yye(le?null:Fe),te=sB(ge?Bi(ge):null),_e=Xye(R?Ie??Pe:null),Me=tbe(_e),Ee=dbe(y,{transform:{x:$.x-ie.x,y:$.y-ie.y,scaleX:1,scaleY:1},activatorEvent:Y,active:K,activeNodeRect:Fe,containerNodeRect:Qe,draggingNodeRect:Te,over:Le.current.over,overlayNodeRect:V.rect,scrollableAncestors:_e,scrollableAncestorRects:Me,windowRect:te}),We=Ne?Eh(Ne,$):null,kt=Jye(_e),it=UO(kt),xt=UO(kt,[Fe]),Dt=Eh(Ee,it),Ot=Te?wye(Te,Ee):null,Wt=K&&Ot?h({active:K,collisionRect:Ot,droppableRects:oe,droppableContainers:J,pointerCoordinates:We}):null,be=Y9(Wt,"id"),[I,G]=T.useState(null),fe=le?Ee:Eh(Ee,xt),je=bye(fe,(i=I==null?void 0:I.rect)!=null?i:null,Fe),ve=T.useRef(null),Ce=T.useCallback((nt,ye)=>{let{sensor:Oe,options:Ke}=ye;if(q.current==null)return;const Rt=j.get(q.current);if(!Rt)return;const pe=nt.nativeEvent,H=new Oe({active:q.current,activeNode:Rt,event:pe,options:Ke,context:Le,onAbort(W){if(!j.get(W))return;const{onDragAbort:Ae}=ae.current,qe={id:W};Ae==null||Ae(qe),S({type:"onDragAbort",event:qe})},onPending(W,he,Ae,qe){if(!j.get(W))return;const{onDragPending:Gt}=ae.current,ut={id:W,constraint:he,initialCoordinates:Ae,offset:qe};Gt==null||Gt(ut),S({type:"onDragPending",event:ut})},onStart(W){const he=q.current;if(he==null)return;const Ae=j.get(he);if(!Ae)return;const{onDragStart:qe}=ae.current,pt={activatorEvent:pe,active:{id:he,data:Ae.data,rect:F}};$o.unstable_batchedUpdates(()=>{qe==null||qe(pt),k(Hc.Initializing),x({type:wa.DragStart,initialCoordinates:W,active:he}),S({type:"onDragStart",event:pt}),re(ve.current),Q(pe)})},onMove(W){x({type:wa.DragMove,coordinates:W})},onEnd:U(wa.DragEnd),onCancel:U(wa.DragCancel)});ve.current=H;function U(W){return async function(){const{active:Ae,collisions:qe,over:pt,scrollAdjustedTranslate:Gt}=Le.current;let ut=null;if(Ae&&Gt){const{cancelDrop:Tt}=ae.current;ut={activatorEvent:pe,active:Ae,collisions:qe,delta:Gt,over:pt},W===wa.DragEnd&&typeof Tt=="function"&&await Promise.resolve(Tt(ut))&&(W=wa.DragCancel)}q.current=null,$o.unstable_batchedUpdates(()=>{x({type:W}),k(Hc.Uninitialized),G(null),re(null),Q(null),ve.current=null;const Tt=W===wa.DragEnd?"onDragEnd":"onDragCancel";if(ut){const Pt=ae.current[Tt];Pt==null||Pt(ut),S({type:Tt,event:ut})}})}}},[j]),ce=T.useCallback((nt,ye)=>(Oe,Ke)=>{const Rt=Oe.nativeEvent,pe=j.get(Ke);if(q.current!==null||!pe||Rt.dndKit||Rt.defaultPrevented)return;const H={active:pe};nt(Oe,ye.options,H)===!0&&(Rt.dndKit={capturedBy:ye.sensor},q.current=Ke,Ce(Oe,ye))},[j,Ce]),ft=Vye(d,ce);Qye(d),Zo(()=>{Fe&&C===Hc.Initializing&&k(Hc.Initialized)},[Fe,C]),T.useEffect(()=>{const{onDragMove:nt}=ae.current,{active:ye,activatorEvent:Oe,collisions:Ke,over:Rt}=Le.current;if(!ye||!Oe)return;const pe={active:ye,activatorEvent:Oe,collisions:Ke,delta:{x:Dt.x,y:Dt.y},over:Rt};$o.unstable_batchedUpdates(()=>{nt==null||nt(pe),S({type:"onDragMove",event:pe})})},[Dt.x,Dt.y]),T.useEffect(()=>{const{active:nt,activatorEvent:ye,collisions:Oe,droppableContainers:Ke,scrollAdjustedTranslate:Rt}=Le.current;if(!nt||q.current==null||!ye||!Rt)return;const{onDragOver:pe}=ae.current,H=Ke.get(be),U=H&&H.rect.current?{id:H.id,rect:H.rect.current,data:H.data,disabled:H.disabled}:null,W={active:nt,activatorEvent:ye,collisions:Oe,delta:{x:Rt.x,y:Rt.y},over:U};$o.unstable_batchedUpdates(()=>{G(U),pe==null||pe(W),S({type:"onDragOver",event:W})})},[be]),Zo(()=>{Le.current={activatorEvent:Y,active:K,activeNode:Pe,collisionRect:Ot,collisions:Wt,droppableRects:oe,draggableNodes:j,draggingNode:ge,draggingNodeRect:Te,droppableContainers:L,over:I,scrollableAncestors:_e,scrollAdjustedTranslate:Dt},F.current={initial:Te,translated:Ot}},[K,Pe,Wt,Ot,j,ge,Te,oe,L,I,_e,Dt]),zye({...Re,delta:$,draggingRect:Ot,pointerCoordinates:We,scrollableAncestors:_e,scrollableAncestorRects:Me});const vt=T.useMemo(()=>({active:K,activeNode:Pe,activeNodeRect:Fe,activatorEvent:Y,collisions:Wt,containerNodeRect:Qe,dragOverlay:V,draggableNodes:j,droppableContainers:L,droppableRects:oe,over:I,measureDroppableContainers:me,scrollableAncestors:_e,scrollableAncestorRects:Me,measuringConfiguration:ee,measuringScheduled:xe,windowRect:te}),[K,Pe,Fe,Y,Wt,Qe,V,j,L,oe,I,me,_e,Me,ee,xe,te]),M=T.useMemo(()=>({activatorEvent:Y,activators:ft,active:K,activeNodeRect:Fe,ariaDescribedById:{draggable:B},dispatch:x,draggableNodes:j,over:I,measureDroppableContainers:me}),[Y,ft,K,Fe,x,B,j,I,me]);return gt.createElement(W9.Provider,{value:E},gt.createElement(Qx.Provider,{value:M},gt.createElement(oB.Provider,{value:vt},gt.createElement(lB.Provider,{value:je},u)),gt.createElement(ube,{disabled:(o==null?void 0:o.restoreFocus)===!1})),gt.createElement(dye,{...o,hiddenTextDescribedById:B}));function Be(){const nt=(de==null?void 0:de.autoScrollEnabled)===!1,ye=typeof l=="object"?l.enabled===!1:l===!1,Oe=R&&!nt&&!ye;return typeof l=="object"?{...l,enabled:Oe}:{enabled:Oe}}}),mbe=T.createContext(null),HO="button",gbe="Draggable";function ybe(e){let{id:t,data:n,disabled:r=!1,attributes:a}=e;const i=X0(gbe),{activators:s,activatorEvent:o,active:l,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:p}=T.useContext(Qx),{role:y=HO,roleDescription:v="draggable",tabIndex:b=0}=a??{},w=(l==null?void 0:l.id)===t,x=T.useContext(w?lB:mbe),[S,E]=ww(),[C,k]=ww(),R=ebe(s,t),O=e0(n);Zo(()=>(h.set(t,{id:t,key:i,node:S,activatorNode:C,data:O}),()=>{const $=h.get(t);$&&$.key===i&&h.delete(t)}),[h,t]);const j=T.useMemo(()=>({role:y,tabIndex:b,"aria-disabled":r,"aria-pressed":w&&y===HO?!0:void 0,"aria-roledescription":v,"aria-describedby":d.draggable}),[r,y,b,w,v,d.draggable]);return{active:l,activatorEvent:o,activeNodeRect:u,attributes:j,isDragging:w,listeners:r?void 0:R,node:S,over:p,setNodeRef:E,setActivatorNodeRef:k,transform:x}}function bbe(){return T.useContext(oB)}const vbe="Droppable",wbe={timeout:25};function xbe(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:a}=e;const i=X0(vbe),{active:s,dispatch:o,over:l,measureDroppableContainers:u}=T.useContext(Qx),d=T.useRef({disabled:n}),h=T.useRef(!1),p=T.useRef(null),y=T.useRef(null),{disabled:v,updateMeasurementsFor:b,timeout:w}={...wbe,...a},x=e0(b??r),S=T.useCallback(()=>{if(!h.current){h.current=!0;return}y.current!=null&&clearTimeout(y.current),y.current=setTimeout(()=>{u(Array.isArray(x.current)?x.current:[x.current]),y.current=null},w)},[w]),E=Jx({callback:S,disabled:v||!s}),C=T.useCallback((j,$)=>{E&&($&&(E.unobserve($),h.current=!1),j&&E.observe(j))},[E]),[k,R]=ww(C),O=e0(t);return T.useEffect(()=>{!E||!k.current||(E.disconnect(),h.current=!1,E.observe(k.current))},[k,E]),T.useEffect(()=>(o({type:wa.RegisterDroppable,element:{id:r,key:i,disabled:n,node:k,rect:p,data:O}}),()=>o({type:wa.UnregisterDroppable,key:i,id:r})),[r]),T.useEffect(()=>{n!==d.current.disabled&&(o({type:wa.SetDroppableDisabled,id:r,key:i,disabled:n}),d.current.disabled=n)},[r,i,n,o]),{active:s,rect:p,isOver:(l==null?void 0:l.id)===r,node:k,over:l,setNodeRef:R}}function YT(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function _be(e,t){return e.reduce((n,r,a)=>{const i=t.get(r);return i&&(n[a]=i),n},Array(e.length))}function Kb(e){return e!==null&&e>=0}function Sbe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ebe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const cB=e=>{let{rects:t,activeIndex:n,overIndex:r,index:a}=e;const i=YT(t,r,n),s=t[a],o=i[a];return!o||!s?null:{x:o.left-s.left,y:o.top-s.top,scaleX:o.width/s.width,scaleY:o.height/s.height}},Zb={scaleX:1,scaleY:1},Cbe=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:a,rects:i,overIndex:s}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(a===n){const u=i[s];return u?{x:0,y:n<s?u.top+u.height-(o.top+o.height):u.top-o.top,...Zb}:null}const l=kbe(i,a,n);return a>n&&a<=s?{x:0,y:-o.height-l,...Zb}:a<n&&a>=s?{x:0,y:o.height+l,...Zb}:{x:0,y:0,...Zb}};function kbe(e,t,n){const r=e[t],a=e[t-1],i=e[t+1];return r?n<t?a?r.top-(a.top+a.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):a?r.top-(a.top+a.height):0:0}const uB="Sortable",dB=gt.createContext({activeIndex:-1,containerId:uB,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:cB,disabled:{draggable:!1,droppable:!1}});function Tbe(e){let{children:t,id:n,items:r,strategy:a=cB,disabled:i=!1}=e;const{active:s,dragOverlay:o,droppableRects:l,over:u,measureDroppableContainers:d}=bbe(),h=X0(uB,n),p=o.rect!==null,y=T.useMemo(()=>r.map(R=>typeof R=="object"&&"id"in R?R.id:R),[r]),v=s!=null,b=s?y.indexOf(s.id):-1,w=u?y.indexOf(u.id):-1,x=T.useRef(y),S=!Sbe(y,x.current),E=w!==-1&&b===-1||S,C=Ebe(i);Zo(()=>{S&&v&&d(y)},[S,y,v,d]),T.useEffect(()=>{x.current=y},[y]);const k=T.useMemo(()=>({activeIndex:b,containerId:h,disabled:C,disableTransforms:E,items:y,overIndex:w,useDragOverlay:p,sortedRects:_be(y,l),strategy:a}),[b,h,C.draggable,C.droppable,E,y,w,l,p,a]);return gt.createElement(dB.Provider,{value:k},t)}const Abe=e=>{let{id:t,items:n,activeIndex:r,overIndex:a}=e;return YT(n,r,a).indexOf(t)},Nbe=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:a,items:i,newIndex:s,previousItems:o,previousContainerId:l,transition:u}=e;return!u||!r||o!==i&&a===s?!1:n?!0:s!==a&&t===l},Rbe={duration:200,easing:"ease"},fB="transform",Ibe=n0.Transition.toString({property:fB,duration:0,easing:"linear"}),jbe={roleDescription:"sortable"};function Obe(e){let{disabled:t,index:n,node:r,rect:a}=e;const[i,s]=T.useState(null),o=T.useRef(n);return Zo(()=>{if(!t&&n!==o.current&&r.current){const l=a.current;if(l){const u=kp(r.current,{ignoreTransform:!0}),d={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(d.x||d.y)&&s(d)}}n!==o.current&&(o.current=n)},[t,n,r,a]),T.useEffect(()=>{i&&s(null)},[i]),i}function Dbe(e){let{animateLayoutChanges:t=Nbe,attributes:n,disabled:r,data:a,getNewIndex:i=Abe,id:s,strategy:o,resizeObserverConfig:l,transition:u=Rbe}=e;const{items:d,containerId:h,activeIndex:p,disabled:y,disableTransforms:v,sortedRects:b,overIndex:w,useDragOverlay:x,strategy:S}=T.useContext(dB),E=Mbe(r,y),C=d.indexOf(s),k=T.useMemo(()=>({sortable:{containerId:h,index:C,items:d},...a}),[h,a,C,d]),R=T.useMemo(()=>d.slice(d.indexOf(s)),[d,s]),{rect:O,node:j,isOver:$,setNodeRef:L}=xbe({id:s,data:k,disabled:E.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...l}}),{active:X,activatorEvent:F,activeNodeRect:K,attributes:q,setNodeRef:de,listeners:re,isDragging:Y,over:Q,setActivatorNodeRef:ae,transform:B}=ybe({id:s,data:k,attributes:{...jbe,...n},disabled:E.draggable}),J=J0e(L,de),ee=!!X,oe=ee&&!v&&Kb(p)&&Kb(w),me=!x&&Y,xe=me&&oe?B:null,Ne=oe?xe??(o??S)({rects:b,activeNodeRect:K,activeIndex:p,overIndex:w,index:C}):null,Re=Kb(p)&&Kb(w)?i({id:s,items:d,activeIndex:p,overIndex:w}):C,ke=X==null?void 0:X.id,Fe=T.useRef({activeId:ke,items:d,newIndex:Re,containerId:h}),Qe=d!==Fe.current.items,Le=t({active:X,containerId:h,isDragging:Y,isSorting:ee,id:s,index:C,items:d,newIndex:Fe.current.newIndex,previousItems:Fe.current.items,previousContainerId:Fe.current.containerId,transition:u,wasDragging:Fe.current.activeId!=null}),Ie=Obe({disabled:!Le,index:C,node:j,rect:O});return T.useEffect(()=>{ee&&Fe.current.newIndex!==Re&&(Fe.current.newIndex=Re),h!==Fe.current.containerId&&(Fe.current.containerId=h),d!==Fe.current.items&&(Fe.current.items=d)},[ee,Re,h,d]),T.useEffect(()=>{if(ke===Fe.current.activeId)return;if(ke!=null&&Fe.current.activeId==null){Fe.current.activeId=ke;return}const ge=setTimeout(()=>{Fe.current.activeId=ke},50);return()=>clearTimeout(ge)},[ke]),{active:X,activeIndex:p,attributes:q,data:k,rect:O,index:C,newIndex:Re,items:d,isOver:$,isSorting:ee,isDragging:Y,listeners:re,node:j,overIndex:w,over:Q,setNodeRef:J,setActivatorNodeRef:ae,setDroppableNodeRef:L,setDraggableNodeRef:de,transform:Ie??Ne,transition:V()};function V(){if(Ie||Qe&&Fe.current.newIndex===C)return Ibe;if(!(me&&!VT(F)||!u)&&(ee||Le))return n0.Transition.toString({...u,property:fB})}}function Mbe(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function Sw(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Pbe=[Qn.Down,Qn.Right,Qn.Up,Qn.Left],Fbe=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:a,droppableContainers:i,over:s,scrollableAncestors:o}}=t;if(Pbe.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];i.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const p=a.get(h.id);if(p)switch(e.code){case Qn.Down:r.top<p.top&&l.push(h);break;case Qn.Up:r.top>p.top&&l.push(h);break;case Qn.Left:r.left>p.left&&l.push(h);break;case Qn.Right:r.left<p.left&&l.push(h);break}});const u=mye({collisionRect:r,droppableRects:a,droppableContainers:l});let d=Y9(u,"id");if(d===(s==null?void 0:s.id)&&u.length>1&&(d=u[1].id),d!=null){const h=i.get(n.id),p=i.get(d),y=p?a.get(p.id):null,v=p==null?void 0:p.node.current;if(v&&y&&h&&p){const w=Xx(v).some((R,O)=>o[O]!==R),x=hB(h,p),S=Lbe(h,p),E=w||!x?{x:0,y:0}:{x:S?r.width-y.width:0,y:S?r.height-y.height:0},C={x:y.left,y:y.top};return E.x&&E.y?C:t0(C,E)}}}};function hB(e,t){return!Sw(e)||!Sw(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Lbe(e,t){return!Sw(e)||!Sw(t)||!hB(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const $be=({id:e,name:t,disabled:n})=>{const{attributes:r,listeners:a,setNodeRef:i,transform:s,transition:o,isDragging:l}=Dbe({id:e,disabled:n}),u={transform:n0.Transform.toString(s),transition:o,zIndex:l?10:void 0,opacity:n?.5:1};return m.jsxs("div",{ref:i,style:u,...r,...a,className:Nt("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",l&&"shadow-lg border-primary bg-card",!n&&"cursor-grab active:cursor-grabbing",n&&"cursor-not-allowed opacity-50"),"aria-label":`Drag to reorder model ${t}`,children:[m.jsx(qq,{className:Nt("h-5 w-5 text-muted-foreground flex-shrink-0",!n&&"hover:text-foreground")}),m.jsx(en,{className:Nt("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:t||e})]})},Bbe=()=>{const{setGlobalModelSortOrder:e,dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAllAvailableModelDefsForProvider:a}=Fn(dn(p=>({setGlobalModelSortOrder:p.setGlobalModelSortOrder,dbProviderConfigs:p.dbProviderConfigs,globalModelSortOrder:p.globalModelSortOrder,isLoading:p.isLoading,getAllAvailableModelDefsForProvider:p.getAllAvailableModelDefsForProvider}))),[i,s]=T.useState(""),o=T.useMemo(()=>{const p=new Map,y=new Set;t.forEach(x=>{if(!x.isEnabled||!x.enabledModels)return;const S=a(x.id),E=new Map(S.map(C=>[C.id,C]));x.enabledModels.forEach(C=>{const k=Wc(x.id,C),R=E.get(C);R&&(y.add(k),p.set(k,{id:k,name:R.name||C,providerId:x.id,providerName:x.name,metadata:R}))})});const v=[],b=new Set;n.forEach(x=>{if(y.has(x)){const S=p.get(x);S&&!b.has(x)&&(v.push(S),b.add(x))}});const w=Array.from(y).filter(x=>!b.has(x)).map(x=>p.get(x)).filter(x=>!!x).sort((x,S)=>x.name.localeCompare(S.name));return[...v,...w]},[t,n,a]),l=T.useMemo(()=>{if(!i.trim())return o;const p=i.toLowerCase();return o.filter(y=>y.name.toLowerCase().includes(p)||y.providerName.toLowerCase().includes(p)||y.id.toLowerCase().includes(p))},[o,i]),u=T.useMemo(()=>l.map(p=>p.id),[l]),d=T.useCallback(p=>{const{active:y,over:v}=p;if(v&&y.id!==v.id){const b=o.map(C=>C.id),w=y.id,x=v.id,S=b.indexOf(w),E=b.indexOf(x);if(S!==-1&&E!==-1){const C=YT(b,S,E);e(C)}else console.error("Failed to find dragged items in the full model order. Cannot reorder.")}},[o,e]),h=fye(jO(ZT),jO(WT,{coordinateGetter:Fbe}));return r?m.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[m.jsx(ur,{className:"h-8 w-1/3"}),m.jsx(ur,{className:"h-6 w-1/2"}),m.jsx(ur,{className:"h-64 w-full"})]}):m.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[m.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models (set per provider below) to define their display order in the chat input selector. Filtering only affects the view below, not the actual order saved."}),m.jsx(zd,{}),m.jsxs("div",{className:"space-y-3",children:[m.jsx(en,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),m.jsxs("div",{className:"relative",children:[m.jsx(Nd,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(qn,{type:"search",placeholder:"Filter models by name or provider...",value:i,onChange:p=>s(p.target.value),className:"pl-8 w-full",disabled:r})]}),m.jsx(Yl,{className:"h-80 w-full rounded-md border border-border p-3 bg-background/50",children:l.length>0?m.jsx(pbe,{sensors:h,collisionDetection:pye,onDragEnd:d,children:m.jsx(Tbe,{items:u,strategy:Cbe,children:l.map(p=>m.jsx($be,{id:p.id,name:`${p.name} (${p.providerName})`},p.id))})}):m.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:i.trim()?"No models match your filter.":"No models enabled globally. Enable models within provider configurations below."})})]})]})},zbe=LC("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function pB({className:e,variant:t,asChild:n=!1,...r}){const a=n?s6:"span";return m.jsx(a,{"data-slot":"badge",className:Nt(zbe({variant:t}),e),...r})}const Ube=({modelId:e})=>{var s,o,l,u,d,h,p,y,v,b,w,x,S;const{getProviderById:t,getAllAvailableModelDefsForProvider:n}=Fn(E=>({getProviderById:C=>E.dbProviderConfigs.find(k=>k.id===C),getAllAvailableModelDefsForProvider:E.getAllAvailableModelDefsForProvider})),r=T.useMemo(()=>{if(!e)return null;const{providerId:E,modelId:C}=Ql(e);if(!E||!C)return null;const k=t(E);if(!k)return null;const O=n(E).find(j=>j.id===C);return O?{...O,providerName:k.name}:null},[e,t,n]);if(!r)return m.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Select a model from a provider's list to view its details."});const a=E=>{if(!E)return"N/A";const C=parseFloat(E);return isNaN(C)||C===0?"Free":`$${C.toFixed(4)} / 1M tokens`},i=E=>E?`${E.toLocaleString()} tokens`:"Unknown";return m.jsx(Yl,{className:"h-full p-1",children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("h3",{className:"text-xl font-semibold",children:[r.name," ",m.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",r.providerName,")"]})]}),m.jsx("p",{className:"text-sm text-muted-foreground",children:r.id}),r.description&&m.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:m.jsx("p",{children:r.description})}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[m.jsxs("div",{className:"space-y-1 border p-3 rounded-md bg-muted/30",children:[m.jsx("h4",{className:"font-medium mb-1",children:"Context & Limits"}),m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Context Length:"})," ",i(((s=r.top_provider)==null?void 0:s.context_length)??r.context_length)]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Max Completion Tokens:"})," ",(o=r.top_provider)!=null&&o.max_completion_tokens?r.top_provider.max_completion_tokens.toLocaleString():"Default"]}),r.per_request_limits&&m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Request Limits:"})," ",m.jsx("pre",{className:"text-xs whitespace-pre-wrap",children:JSON.stringify(r.per_request_limits,null,2)})]})]}),m.jsxs("div",{className:"space-y-1 border p-3 rounded-md bg-muted/30",children:[m.jsx("h4",{className:"font-medium mb-1",children:"Pricing (per 1M tokens)"}),m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Prompt:"})," ",a((l=r.pricing)==null?void 0:l.prompt)]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Completion:"})," ",a((u=r.pricing)==null?void 0:u.completion)]}),((d=r.pricing)==null?void 0:d.request)&&parseFloat(r.pricing.request)>0&&m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Request:"})," $",parseFloat(r.pricing.request).toFixed(6)]}),((h=r.pricing)==null?void 0:h.image)&&parseFloat(r.pricing.image)>0&&m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Image:"})," $",parseFloat(r.pricing.image).toFixed(6)]})]}),m.jsxs("div",{className:"space-y-1 border p-3 rounded-md bg-muted/30 md:col-span-2",children:[m.jsx("h4",{className:"font-medium mb-1",children:"Architecture"}),m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Modality:"})," ",((p=r.architecture)==null?void 0:p.modality)??"Unknown"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Input Modalities:"})," ",((v=(y=r.architecture)==null?void 0:y.input_modalities)==null?void 0:v.join(", "))??"Unknown"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Output Modalities:"})," ",((w=(b=r.architecture)==null?void 0:b.output_modalities)==null?void 0:w.join(", "))??"Unknown"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Tokenizer:"})," ",((x=r.architecture)==null?void 0:x.tokenizer)??"Unknown"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-semibold",children:"Instruct Type:"})," ",((S=r.architecture)==null?void 0:S.instruct_type)??"N/A"]})]}),m.jsxs("div",{className:"space-y-1 border p-3 rounded-md bg-muted/30 md:col-span-2",children:[m.jsx("h4",{className:"font-medium mb-1",children:"Supported Parameters"}),m.jsx("div",{className:"flex flex-wrap gap-1",children:r.supported_parameters&&r.supported_parameters.length>0?r.supported_parameters.map(E=>m.jsx(pB,{variant:"secondary",children:E},E)):m.jsx("span",{className:"text-muted-foreground italic",children:"None specified"})})]})]})]})})},qbe=()=>{const{apiKeys:e,addApiKey:t,deleteApiKey:n,isLoading:r}=Fn(dn(p=>({apiKeys:p.dbApiKeys,addApiKey:p.addApiKey,deleteApiKey:p.deleteApiKey,isLoading:p.isLoading}))),[a,i]=T.useState(!1),[s,o]=T.useState(!1),[l,u]=T.useState({}),d=T.useCallback(async(p,y,v)=>{o(!0);try{await t(p,y,v),i(!1)}catch(b){console.error("Failed to add API key (from component):",b)}finally{o(!1)}},[t]),h=T.useCallback(async(p,y)=>{if(window.confirm(`Are you sure you want to delete the API key "${y}"? This will unlink it from any providers using it.`)){u(v=>({...v,[p]:!0}));try{await n(p)}catch(v){console.error("Failed to delete API key (from component):",v)}finally{u(v=>({...v,[p]:!1}))}}},[n]);return m.jsxs("div",{className:"space-y-6 p-1",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),m.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!a&&m.jsxs(Mt,{onClick:()=>i(!0),variant:"outline",className:"w-full mb-4",disabled:r,children:[m.jsx(Hd,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),a&&m.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),m.jsx(EL,{onSave:d,onCancel:()=>i(!1),isSaving:s})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),r&&!a?m.jsxs("div",{className:"space-y-2",children:[m.jsx(ur,{className:"h-10 w-full"}),m.jsx(ur,{className:"h-10 w-full"})]}):(e||[]).length===0&&!a?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):m.jsx("div",{className:"border rounded-md overflow-hidden",children:m.jsxs(xp,{children:[m.jsx(_p,{children:m.jsxs(Yr,{children:[m.jsx(kr,{children:"Name"}),m.jsx(kr,{children:"Provider Type"}),m.jsx(kr,{children:"Created"}),m.jsx(kr,{className:"text-right",children:"Actions"})]})}),m.jsx(Sp,{children:(e||[]).map(p=>{const y=l[p.id];return m.jsxs(Yr,{className:y?"opacity-50":"",children:[m.jsx(jn,{className:"font-medium",children:p.name||"Unnamed Key"}),m.jsx(jn,{children:p.providerId||"Unknown"}),m.jsx(jn,{className:"text-xs text-muted-foreground",children:iC(new Date(p.createdAt),"PPp")}),m.jsx(jn,{className:"text-right",children:m.jsx(rr,{tooltipText:"Delete Key",onClick:()=>h(p.id,p.name||"Unnamed Key"),disabled:y,"aria-label":`Delete key ${p.name||"Unnamed Key"}`,icon:y?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(ts,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})})]},p.id)})})]})})]})]})},Hbe=gt.memo(qbe),Vbe=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:a,providerFetchStatus:i,dbProviderConfigs:s,apiKeys:o,isLoading:l}=Fn(dn(b=>({addDbProviderConfig:b.addProviderConfig,updateDbProviderConfig:b.updateProviderConfig,deleteDbProviderConfig:b.deleteProviderConfig,fetchModels:b.fetchModels,providerFetchStatus:b.providerFetchStatus,dbProviderConfigs:b.dbProviderConfigs,apiKeys:b.dbApiKeys,isLoading:b.isLoading}))),[u,d]=T.useState(!1),h=()=>d(!0),p=T.useCallback(()=>d(!1),[]),y=T.useCallback(async b=>{await a(b)},[a]),v=T.useMemo(()=>s||[],[s]);return m.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),m.jsx("div",{className:"flex-shrink-0",children:u?m.jsx(IL,{apiKeys:o||[],onAddProvider:t,onCancel:p}):m.jsxs(Mt,{onClick:h,variant:"outline",className:"w-full",disabled:l,children:[m.jsx(Hd,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),m.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:m.jsxs("div",{className:"space-y-2",children:[l&&!u?m.jsx(m.Fragment,{children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[m.jsx(ur,{className:"h-24 w-full"}),m.jsx(ur,{className:"h-24 w-full"}),m.jsx(ur,{className:"h-24 w-full"})]})}):m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:v.map(b=>m.jsx(I0e,{provider:b,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:y,fetchStatus:i[b.id]||"idle",onSelectModelForDetails:e},b.id))}),!l&&v.length===0&&!u&&m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},Gbe=()=>{const{selectedModelForDetails:e,setSelectedModelForDetails:t}=Fn(dn(s=>({selectedModelForDetails:s._selectedModelForDetails,setSelectedModelForDetails:s.setSelectedModelForDetails}))),[n,r]=T.useState("providers-config"),a=T.useCallback(s=>{t(s),s&&r("providers-details")},[t]),i=T.useMemo(()=>[{value:"providers-config",label:"Configuration",content:m.jsx(Vbe,{onSelectModelForDetails:a})},{value:"providers-order",label:"Model Order",content:m.jsx(Bbe,{})},{value:"api-keys",label:"API Keys",content:m.jsx(Hbe,{})},{value:"providers-details",label:"Model Details",content:m.jsx(Ube,{modelId:e})}],[e,a]);return m.jsx(Pu,{tabs:i,initialValue:n,onValueChange:r,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},Wbe=gt.memo(Gbe),Kbe=({title:e,description:t,children:n,className:r,titleClassName:a,descriptionClassName:i,contentClassName:s})=>m.jsxs("div",{className:Nt("space-y-3",r),children:[m.jsxs("div",{children:[m.jsx("h3",{className:Nt("text-lg font-medium",a),children:e}),t&&m.jsx("p",{className:Nt("text-sm text-muted-foreground",i),children:t})]}),m.jsx("div",{className:Nt(s),children:n})]}),Zbe=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=qr(dn(a=>({gitUserName:a.gitUserName,setGitUserName:a.setGitUserName,gitUserEmail:a.gitUserEmail,setGitUserEmail:a.setGitUserEmail})));return m.jsx("div",{className:"space-y-6 p-1",children:m.jsx(Kbe,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-4 shadow-sm bg-card",children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"git-user-name",children:"Git User Name"}),m.jsx(qn,{id:"git-user-name",value:e??"",onChange:a=>t(a.target.value),placeholder:"Your Name"})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"git-user-email",children:"Git User Email"}),m.jsx(qn,{id:"git-user-email",type:"email",value:n??"",onChange:a=>r(a.target.value),placeholder:"your.email@example.com"})]})]})})})},Ybe=gt.memo(Zbe),Xbe=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,deleteSyncRepo:r,initializeOrSyncRepo:a,repoInitializationStatus:i,isLoading:s}=mn(dn(j=>({syncRepos:j.syncRepos,addSyncRepo:j.addSyncRepo,updateSyncRepo:j.updateSyncRepo,deleteSyncRepo:j.deleteSyncRepo,initializeOrSyncRepo:j.initializeOrSyncRepo,repoInitializationStatus:j.repoInitializationStatus,isLoading:j.isLoading}))),[o,l]=T.useState(!1),[u,d]=T.useState(null),[h,p]=T.useState({name:"",remoteUrl:"",branch:"main",username:"",password:""}),[y,v]=T.useState(!1),[b,w]=T.useState({}),x=T.useCallback(()=>{p({name:"",remoteUrl:"",branch:"main",username:"",password:""}),l(!1),d(null),v(!1)},[]),S=T.useCallback((j,$)=>{p(L=>({...L,[j]:$}))},[]),E=T.useCallback(async()=>{var j,$,L,X;if(!((j=h.name)!=null&&j.trim())||!(($=h.remoteUrl)!=null&&$.trim())){tt.error("Repository Name and Remote URL are required.");return}v(!0);try{const F={name:h.name.trim(),remoteUrl:h.remoteUrl.trim(),branch:((L=h.branch)==null?void 0:L.trim())||"main",username:((X=h.username)==null?void 0:X.trim())||null,password:h.password||null};u?await n(u,F):await t(F),x()}catch(F){console.error("Failed to save sync repo:",F)}finally{v(!1)}},[h,u,t,n,x]),C=j=>{d(j.id),p({name:j.name,remoteUrl:j.remoteUrl,branch:j.branch||"main",username:j.username??"",password:j.password??""}),l(!1)},k=T.useCallback(async(j,$)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${$}"? This will unlink it from any conversations and remove the local copy.`)){w(L=>({...L,[j]:!0}));try{await r(j),u===j&&x()}catch(L){console.error("Failed to delete sync repo:",L)}finally{w(L=>({...L,[j]:!1}))}}},[r,u,x]),R=T.useCallback(async j=>{await a(j)},[a]),O=()=>{var j,$;return m.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:u?"Edit Sync Repository":"Add New Sync Repository"}),m.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[m.jsxs("div",{children:[m.jsx(en,{htmlFor:"repo-name",children:"Name"}),m.jsx(qn,{id:"repo-name",value:h.name||"",onChange:L=>S("name",L.target.value),placeholder:"e.g., My Conversation Backup",required:!0,className:"mt-1",disabled:y})]}),m.jsxs("div",{children:[m.jsx(en,{htmlFor:"repo-url",children:"Remote URL (HTTPS)"}),m.jsx(qn,{id:"repo-url",type:"url",value:h.remoteUrl||"",onChange:L=>S("remoteUrl",L.target.value),placeholder:"https://github.com/user/repo.git",required:!0,className:"mt-1",disabled:y})]}),m.jsxs("div",{children:[m.jsx(en,{htmlFor:"repo-branch",children:"Branch"}),m.jsx(qn,{id:"repo-branch",value:h.branch||"",onChange:L=>S("branch",L.target.value),placeholder:"main",className:"mt-1",disabled:y})]})]}),m.jsxs("div",{className:"pt-2",children:[m.jsx(en,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),m.jsxs(C9,{variant:"destructive",className:"mt-2 mb-3",children:[m.jsx(qC,{className:"h-4 w-4"}),m.jsx(k9,{children:"Security Warning"}),m.jsx(T9,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),m.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx(en,{htmlFor:"repo-username",children:"Username"}),m.jsx(qn,{id:"repo-username",value:h.username||"",onChange:L=>S("username",L.target.value),placeholder:"Git Username (Optional)",className:"mt-1",disabled:y,autoComplete:"off"})]}),m.jsxs("div",{children:[m.jsx(en,{htmlFor:"repo-password",children:"Password / Token"}),m.jsx(qn,{id:"repo-password",type:"password",value:h.password||"",onChange:L=>S("password",L.target.value),placeholder:"Password or PAT (Optional)",className:"mt-1",disabled:y,autoComplete:"new-password"})]})]})]}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Mt,{variant:"ghost",size:"sm",onClick:x,disabled:y,type:"button",children:[m.jsx(Ts,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsxs(Mt,{variant:"secondary",size:"sm",onClick:E,disabled:y||!((j=h.name)!=null&&j.trim())||!(($=h.remoteUrl)!=null&&$.trim()),type:"button",children:[y&&m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(Vd,{className:"h-4 w-4 mr-1"})," ",y?"Saving...":"Save Repository"]})]})]})};return m.jsxs("div",{className:"space-y-6 p-1",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),m.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."})]}),!o&&!u&&m.jsxs(Mt,{onClick:()=>l(!0),variant:"outline",className:"w-full mb-4",disabled:s,children:[m.jsx(Hd,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||u)&&O(),m.jsxs("div",{children:[m.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),s&&!o&&!u?m.jsxs("div",{className:"space-y-2",children:[m.jsx(ur,{className:"h-10 w-full"}),m.jsx(ur,{className:"h-10 w-full"}),m.jsx(ur,{className:"h-10 w-full"})]}):e.length===0&&!o&&!u?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):m.jsx("div",{className:"border rounded-md overflow-hidden",children:m.jsxs(xp,{children:[m.jsx(_p,{children:m.jsxs(Yr,{children:[m.jsx(kr,{children:"Name"}),m.jsx(kr,{children:"Remote URL"}),m.jsx(kr,{children:"Branch"}),m.jsx(kr,{children:"Auth"}),m.jsx(kr,{className:"text-right",children:"Actions"})]})}),m.jsx(Sp,{children:e.map(j=>{const $=b[j.id],L=u===j.id,X=!!j.username||!!j.password,F=i[j.id]||"idle",q=$||y||!!u||F==="syncing";let de=null,re="Initialize/Sync Repository";return F==="syncing"?(de=m.jsx(zn,{className:"h-4 w-4 animate-spin mr-1"}),re="Initializing/Syncing..."):F==="idle"?(de=m.jsx(BC,{className:"h-4 w-4 text-green-500 mr-1"}),re="Sync Successful / Ready"):F==="error"?(de=m.jsx(Ad,{className:"h-4 w-4 text-destructive mr-1"}),re="Sync Failed"):de=m.jsx(Tw,{className:"h-4 w-4 mr-1"}),m.jsxs(Yr,{className:Nt(L?"bg-muted/50":"",q&&!L?"opacity-70":""),children:[m.jsx(jn,{className:"font-medium",children:j.name}),m.jsx(jn,{className:"text-xs truncate max-w-xs",children:j.remoteUrl}),m.jsx(jn,{children:j.branch||"main"}),m.jsx(jn,{className:"text-xs",children:X?"Configured":"None"}),m.jsxs(jn,{className:"text-right space-x-1",children:[m.jsx(rr,{tooltipText:re,onClick:()=>R(j.id),"aria-label":`Initialize or Sync repo ${j.name}`,disabled:q,icon:de,variant:"outline",className:"h-8 w-8"}),m.jsx(rr,{tooltipText:"Edit",onClick:()=>C(j),"aria-label":`Edit repo ${j.name}`,disabled:q,icon:m.jsx(o0,{}),className:"h-8 w-8"}),m.jsx(rr,{tooltipText:"Delete",onClick:()=>k(j.id,j.name),"aria-label":`Delete repo ${j.name}`,disabled:q,icon:$?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(ts,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},j.id)})})]})})]})]})},Jbe=gt.memo(Xbe),Qbe=()=>{const e=T.useMemo(()=>[{value:"config",label:"User Config",content:m.jsx(Ybe,{})},{value:"sync",label:"Sync Repositories",content:m.jsx(Jbe,{})}],[]);return m.jsx(Pu,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},eve=gt.memo(Qbe),tve=({initialData:e,isSaving:t,onSave:n,onCancel:r})=>{const[a,i]=T.useState((e==null?void 0:e.name)||""),[s,o]=T.useState((e==null?void 0:e.content)||""),[l,u]=T.useState((e==null?void 0:e.type)||"before");T.useEffect(()=>{i((e==null?void 0:e.name)||""),o((e==null?void 0:e.content)||""),u((e==null?void 0:e.type)||"before")},[e]);const d=T.useCallback(async()=>{if(!a.trim()||!s.trim()){tt.error("Rule Name and Content are required.");return}await n({name:a.trim(),content:s.trim(),type:l})},[a,s,l,n]);return m.jsxs("div",{className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[m.jsx(en,{htmlFor:"rule-name",children:"Rule Name"}),m.jsx(qn,{id:"rule-name",value:a,onChange:h=>i(h.target.value),placeholder:"e.g., Always respond in JSON",required:!0,disabled:t})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"rule-type",children:"Rule Type"}),m.jsxs(Iu,{value:l,onValueChange:h=>u(h),disabled:t,children:[m.jsx(Ou,{id:"rule-type",children:m.jsx(ju,{placeholder:"Select Type"})}),m.jsxs(Du,{children:[m.jsx(Za,{value:"system",children:"System Prompt"}),m.jsx(Za,{value:"before",children:"Before User Prompt"}),m.jsx(Za,{value:"after",children:"After User Prompt"})]})]})]})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"rule-content",children:"Rule Content"}),m.jsx(Mu,{id:"rule-content",value:s,onChange:h=>o(h.target.value),placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"})]}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Mt,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[m.jsx(Ts,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsxs(Mt,{variant:"secondary",size:"sm",onClick:d,disabled:t||!a.trim()||!s.trim(),type:"button",children:[t&&m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(Vd,{className:"h-4 w-4 mr-1"})," ",t?"Saving...":"Save Rule"]})]})]})},nve=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:a})=>{const i=s=>{window.confirm(`Are you sure you want to delete the rule "${s.name}"? This will also remove it from any tags.`)&&a(s.id,s.name)};return m.jsx("div",{className:"border rounded-md overflow-hidden",children:m.jsxs(xp,{children:[m.jsx(_p,{children:m.jsxs(Yr,{children:[m.jsx(kr,{children:"Name"}),m.jsx(kr,{children:"Type"}),m.jsx(kr,{children:"Content Preview"}),m.jsx(kr,{className:"text-right",children:"Actions"})]})}),m.jsx(Sp,{children:t?m.jsxs(m.Fragment,{children:[m.jsx(Yr,{children:m.jsx(jn,{colSpan:4,children:m.jsx(ur,{className:"h-10 w-full"})})}),m.jsx(Yr,{children:m.jsx(jn,{colSpan:4,children:m.jsx(ur,{className:"h-10 w-full"})})})]}):e.length===0?m.jsx(Yr,{children:m.jsx(jn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(s=>{const o=n[s.id];return m.jsxs(Yr,{children:[m.jsx(jn,{className:"font-medium",children:s.name}),m.jsx(jn,{className:"capitalize",children:s.type}),m.jsx(jn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:s.content}),m.jsxs(jn,{className:"text-right space-x-1",children:[m.jsx(rr,{tooltipText:"Edit Rule",onClick:()=>r(s),disabled:o,icon:m.jsx(o0,{}),className:"h-8 w-8","aria-label":`Edit rule ${s.name}`}),m.jsx(rr,{tooltipText:"Delete Rule",onClick:()=>i(s),disabled:o,icon:o?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(ts,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${s.name}`})]})]},s.id)})})]})})},rve=()=>{const{rules:e,addRule:t,updateRule:n,deleteRule:r,isLoading:a}=Xl(dn(S=>({rules:S.rules,addRule:S.addRule,updateRule:S.updateRule,deleteRule:S.deleteRule,isLoading:S.isLoading}))),[i,s]=T.useState(!1),[o,l]=T.useState(null),[u,d]=T.useState(!1),[h,p]=T.useState({}),y=()=>{l(null),s(!0)},v=S=>{l(S),s(!0)},b=T.useCallback(()=>{s(!1),l(null),d(!1)},[]),w=T.useCallback(async S=>{d(!0);try{o?await n(o.id,S):await t(S),b()}catch{}finally{d(!1)}},[t,n,o,b]),x=T.useCallback(async S=>{p(E=>({...E,[S]:!0}));try{await r(S),(o==null?void 0:o.id)===S&&b()}catch{}finally{p(E=>({...E,[S]:!1}))}},[r,o,b]);return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!i&&m.jsxs(Mt,{onClick:y,variant:"outline",className:"w-full",disabled:a,children:[m.jsx(Hd,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),i&&m.jsx(tve,{initialData:o??void 0,isSaving:u,onSave:w,onCancel:b}),m.jsxs("div",{className:"pt-4",children:[m.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),m.jsx(nve,{rules:e,isLoading:a,isDeleting:h,onEdit:v,onDelete:x})]})]})},ave=({initialData:e,isSaving:t,onSave:n,onCancel:r})=>{const[a,i]=T.useState((e==null?void 0:e.name)||""),[s,o]=T.useState((e==null?void 0:e.description)||"");T.useEffect(()=>{i((e==null?void 0:e.name)||""),o((e==null?void 0:e.description)||"")},[e]);const l=T.useCallback(async()=>{if(!a.trim()){tt.error("Tag Name is required.");return}await n({name:a.trim(),description:(s==null?void 0:s.trim())||null})},[a,s,n]);return m.jsxs("div",{className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"tag-name",children:"Tag Name"}),m.jsx(qn,{id:"tag-name",value:a,onChange:u=>i(u.target.value),placeholder:"e.g., Code Generation, Summarization",required:!0,disabled:t})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"tag-description",children:"Description (Optional)"}),m.jsx(Mu,{id:"tag-description",value:s||"",onChange:u=>o(u.target.value),placeholder:"Describe when to use this tag...",rows:2,disabled:t})]}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Mt,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[m.jsx(Ts,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsxs(Mt,{variant:"secondary",size:"sm",onClick:l,disabled:t||!a.trim(),type:"button",children:[t&&m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(Vd,{className:"h-4 w-4 mr-1"})," ",t?"Saving...":"Save Tag"]})]})]})},ive=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:a,onDelete:i})=>{const s=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&i(o.id,o.name)};return m.jsx("div",{className:"border rounded-md overflow-hidden",children:m.jsxs(xp,{children:[m.jsx(_p,{children:m.jsxs(Yr,{children:[m.jsx(kr,{children:"Name"}),m.jsx(kr,{children:"Description"}),m.jsx(kr,{children:"Linked Rules"}),m.jsx(kr,{className:"text-right",children:"Actions"})]})}),m.jsx(Sp,{children:n?m.jsxs(m.Fragment,{children:[m.jsx(Yr,{children:m.jsx(jn,{colSpan:4,children:m.jsx(ur,{className:"h-10 w-full"})})}),m.jsx(Yr,{children:m.jsx(jn,{colSpan:4,children:m.jsx(ur,{className:"h-10 w-full"})})})]}):e.length===0?m.jsx(Yr,{children:m.jsx(jn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],u=t.get(o.id)||[];return m.jsxs(Yr,{children:[m.jsx(jn,{className:"font-medium",children:o.name}),m.jsx(jn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),m.jsx(jn,{className:"text-xs",children:u.length>0?u.map(d=>d.name).join(", "):"None"}),m.jsxs(jn,{className:"text-right space-x-1",children:[m.jsx(rr,{tooltipText:"Edit Tag & Rules",onClick:()=>a(o),disabled:l,icon:m.jsx(o0,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),m.jsx(rr,{tooltipText:"Delete Tag",onClick:()=>s(o),disabled:l,icon:l?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(ts,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})};var VO=1,sve=.9,ove=.8,lve=.17,s2=.1,o2=.999,cve=.9999,uve=.99,dve=/[\\\/_+.#"@\[\(\{&]/,fve=/[\\\/_+.#"@\[\(\{&]/g,hve=/[\s-]/,mB=/[\s-]/g;function OC(e,t,n,r,a,i,s){if(i===t.length)return a===e.length?VO:uve;var o=`${a},${i}`;if(s[o]!==void 0)return s[o];for(var l=r.charAt(i),u=n.indexOf(l,a),d=0,h,p,y,v;u>=0;)h=OC(e,t,n,r,u+1,i+1,s),h>d&&(u===a?h*=VO:dve.test(e.charAt(u-1))?(h*=ove,y=e.slice(a,u-1).match(fve),y&&a>0&&(h*=Math.pow(o2,y.length))):hve.test(e.charAt(u-1))?(h*=sve,v=e.slice(a,u-1).match(mB),v&&a>0&&(h*=Math.pow(o2,v.length))):(h*=lve,a>0&&(h*=Math.pow(o2,u-a))),e.charAt(u)!==t.charAt(i)&&(h*=cve)),(h<s2&&n.charAt(u-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(u-1)!==r.charAt(i))&&(p=OC(e,t,n,r,u+1,i+2,s),p*s2>h&&(h=p*s2)),h>d&&(d=h),u=n.indexOf(l,u+1);return s[o]=d,d}function GO(e){return e.toLowerCase().replace(mB," ")}function pve(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,OC(e,t,GO(e),GO(t),0,0,{})}var zm='[cmdk-group=""]',l2='[cmdk-group-items=""]',mve='[cmdk-group-heading=""]',gB='[cmdk-item=""]',WO=`${gB}:not([aria-disabled="true"])`,DC="cmdk-item-select",ch="data-value",gve=(e,t,n)=>pve(e,t,n),yB=T.createContext(void 0),J0=()=>T.useContext(yB),bB=T.createContext(void 0),XT=()=>T.useContext(bB),vB=T.createContext(void 0),wB=T.forwardRef((e,t)=>{let n=uh(()=>{var ee,oe;return{search:"",value:(oe=(ee=e.value)!=null?ee:e.defaultValue)!=null?oe:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=uh(()=>new Set),a=uh(()=>new Map),i=uh(()=>new Map),s=uh(()=>new Set),o=xB(e),{label:l,children:u,value:d,onValueChange:h,filter:p,shouldFilter:y,loop:v,disablePointerSelection:b=!1,vimBindings:w=!0,...x}=e,S=Ya(),E=Ya(),C=Ya(),k=T.useRef(null),R=Tve();Ud(()=>{if(d!==void 0){let ee=d.trim();n.current.value=ee,O.emit()}},[d]),Ud(()=>{R(6,K)},[]);let O=T.useMemo(()=>({subscribe:ee=>(s.current.add(ee),()=>s.current.delete(ee)),snapshot:()=>n.current,setState:(ee,oe,me)=>{var xe,Pe,Ne,Re;if(!Object.is(n.current[ee],oe)){if(n.current[ee]=oe,ee==="search")F(),L(),R(1,X);else if(ee==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let ke=document.getElementById(C);ke?ke.focus():(xe=document.getElementById(S))==null||xe.focus()}if(R(7,()=>{var ke;n.current.selectedItemId=(ke=q())==null?void 0:ke.id,O.emit()}),me||R(5,K),((Pe=o.current)==null?void 0:Pe.value)!==void 0){let ke=oe??"";(Re=(Ne=o.current).onValueChange)==null||Re.call(Ne,ke);return}}O.emit()}},emit:()=>{s.current.forEach(ee=>ee())}}),[]),j=T.useMemo(()=>({value:(ee,oe,me)=>{var xe;oe!==((xe=i.current.get(ee))==null?void 0:xe.value)&&(i.current.set(ee,{value:oe,keywords:me}),n.current.filtered.items.set(ee,$(oe,me)),R(2,()=>{L(),O.emit()}))},item:(ee,oe)=>(r.current.add(ee),oe&&(a.current.has(oe)?a.current.get(oe).add(ee):a.current.set(oe,new Set([ee]))),R(3,()=>{F(),L(),n.current.value||X(),O.emit()}),()=>{i.current.delete(ee),r.current.delete(ee),n.current.filtered.items.delete(ee);let me=q();R(4,()=>{F(),(me==null?void 0:me.getAttribute("id"))===ee&&X(),O.emit()})}),group:ee=>(a.current.has(ee)||a.current.set(ee,new Set),()=>{i.current.delete(ee),a.current.delete(ee)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:S,inputId:C,labelId:E,listInnerRef:k}),[]);function $(ee,oe){var me,xe;let Pe=(xe=(me=o.current)==null?void 0:me.filter)!=null?xe:gve;return ee?Pe(ee,n.current.search,oe):0}function L(){if(!n.current.search||o.current.shouldFilter===!1)return;let ee=n.current.filtered.items,oe=[];n.current.filtered.groups.forEach(xe=>{let Pe=a.current.get(xe),Ne=0;Pe.forEach(Re=>{let ke=ee.get(Re);Ne=Math.max(ke,Ne)}),oe.push([xe,Ne])});let me=k.current;de().sort((xe,Pe)=>{var Ne,Re;let ke=xe.getAttribute("id"),Fe=Pe.getAttribute("id");return((Ne=ee.get(Fe))!=null?Ne:0)-((Re=ee.get(ke))!=null?Re:0)}).forEach(xe=>{let Pe=xe.closest(l2);Pe?Pe.appendChild(xe.parentElement===Pe?xe:xe.closest(`${l2} > *`)):me.appendChild(xe.parentElement===me?xe:xe.closest(`${l2} > *`))}),oe.sort((xe,Pe)=>Pe[1]-xe[1]).forEach(xe=>{var Pe;let Ne=(Pe=k.current)==null?void 0:Pe.querySelector(`${zm}[${ch}="${encodeURIComponent(xe[0])}"]`);Ne==null||Ne.parentElement.appendChild(Ne)})}function X(){let ee=de().find(me=>me.getAttribute("aria-disabled")!=="true"),oe=ee==null?void 0:ee.getAttribute(ch);O.setState("value",oe||void 0)}function F(){var ee,oe,me,xe;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let Pe=0;for(let Ne of r.current){let Re=(oe=(ee=i.current.get(Ne))==null?void 0:ee.value)!=null?oe:"",ke=(xe=(me=i.current.get(Ne))==null?void 0:me.keywords)!=null?xe:[],Fe=$(Re,ke);n.current.filtered.items.set(Ne,Fe),Fe>0&&Pe++}for(let[Ne,Re]of a.current)for(let ke of Re)if(n.current.filtered.items.get(ke)>0){n.current.filtered.groups.add(Ne);break}n.current.filtered.count=Pe}function K(){var ee,oe,me;let xe=q();xe&&(((ee=xe.parentElement)==null?void 0:ee.firstChild)===xe&&((me=(oe=xe.closest(zm))==null?void 0:oe.querySelector(mve))==null||me.scrollIntoView({block:"nearest"})),xe.scrollIntoView({block:"nearest"}))}function q(){var ee;return(ee=k.current)==null?void 0:ee.querySelector(`${gB}[aria-selected="true"]`)}function de(){var ee;return Array.from(((ee=k.current)==null?void 0:ee.querySelectorAll(WO))||[])}function re(ee){let oe=de()[ee];oe&&O.setState("value",oe.getAttribute(ch))}function Y(ee){var oe;let me=q(),xe=de(),Pe=xe.findIndex(Re=>Re===me),Ne=xe[Pe+ee];(oe=o.current)!=null&&oe.loop&&(Ne=Pe+ee<0?xe[xe.length-1]:Pe+ee===xe.length?xe[0]:xe[Pe+ee]),Ne&&O.setState("value",Ne.getAttribute(ch))}function Q(ee){let oe=q(),me=oe==null?void 0:oe.closest(zm),xe;for(;me&&!xe;)me=ee>0?Cve(me,zm):kve(me,zm),xe=me==null?void 0:me.querySelector(WO);xe?O.setState("value",xe.getAttribute(ch)):Y(ee)}let ae=()=>re(de().length-1),B=ee=>{ee.preventDefault(),ee.metaKey?ae():ee.altKey?Q(1):Y(1)},J=ee=>{ee.preventDefault(),ee.metaKey?re(0):ee.altKey?Q(-1):Y(-1)};return T.createElement(rn.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:ee=>{var oe;(oe=x.onKeyDown)==null||oe.call(x,ee);let me=ee.nativeEvent.isComposing||ee.keyCode===229;if(!(ee.defaultPrevented||me))switch(ee.key){case"n":case"j":{w&&ee.ctrlKey&&B(ee);break}case"ArrowDown":{B(ee);break}case"p":case"k":{w&&ee.ctrlKey&&J(ee);break}case"ArrowUp":{J(ee);break}case"Home":{ee.preventDefault(),re(0);break}case"End":{ee.preventDefault(),ae();break}case"Enter":{ee.preventDefault();let xe=q();if(xe){let Pe=new Event(DC);xe.dispatchEvent(Pe)}}}}},T.createElement("label",{"cmdk-label":"",htmlFor:j.inputId,id:j.labelId,style:Nve},l),e1(e,ee=>T.createElement(bB.Provider,{value:O},T.createElement(yB.Provider,{value:j},ee))))}),yve=T.forwardRef((e,t)=>{var n,r;let a=Ya(),i=T.useRef(null),s=T.useContext(vB),o=J0(),l=xB(e),u=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:s==null?void 0:s.forceMount;Ud(()=>{if(!u)return o.item(a,s==null?void 0:s.id)},[u]);let d=_B(a,i,[e.value,e.children,i],e.keywords),h=XT(),p=vu(R=>R.value&&R.value===d.current),y=vu(R=>u||o.filter()===!1?!0:R.search?R.filtered.items.get(a)>0:!0);T.useEffect(()=>{let R=i.current;if(!(!R||e.disabled))return R.addEventListener(DC,v),()=>R.removeEventListener(DC,v)},[y,e.onSelect,e.disabled]);function v(){var R,O;b(),(O=(R=l.current).onSelect)==null||O.call(R,d.current)}function b(){h.setState("value",d.current,!0)}if(!y)return null;let{disabled:w,value:x,onSelect:S,forceMount:E,keywords:C,...k}=e;return T.createElement(rn.div,{ref:Qc(i,t),...k,id:a,"cmdk-item":"",role:"option","aria-disabled":!!w,"aria-selected":!!p,"data-disabled":!!w,"data-selected":!!p,onPointerMove:w||o.getDisablePointerSelection()?void 0:b,onClick:w?void 0:v},e.children)}),bve=T.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:a,...i}=e,s=Ya(),o=T.useRef(null),l=T.useRef(null),u=Ya(),d=J0(),h=vu(y=>a||d.filter()===!1?!0:y.search?y.filtered.groups.has(s):!0);Ud(()=>d.group(s),[]),_B(s,o,[e.value,e.heading,l]);let p=T.useMemo(()=>({id:s,forceMount:a}),[a]);return T.createElement(rn.div,{ref:Qc(o,t),...i,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},n&&T.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:u},n),e1(e,y=>T.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?u:void 0},T.createElement(vB.Provider,{value:p},y))))}),vve=T.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,a=T.useRef(null),i=vu(s=>!s.search);return!n&&!i?null:T.createElement(rn.div,{ref:Qc(a,t),...r,"cmdk-separator":"",role:"separator"})}),wve=T.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,a=e.value!=null,i=XT(),s=vu(u=>u.search),o=vu(u=>u.selectedItemId),l=J0();return T.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),T.createElement(rn.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:a?e.value:s,onChange:u=>{a||i.setState("search",u.target.value),n==null||n(u.target.value)}})}),xve=T.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...a}=e,i=T.useRef(null),s=T.useRef(null),o=vu(u=>u.selectedItemId),l=J0();return T.useEffect(()=>{if(s.current&&i.current){let u=s.current,d=i.current,h,p=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let y=u.offsetHeight;d.style.setProperty("--cmdk-list-height",y.toFixed(1)+"px")})});return p.observe(u),()=>{cancelAnimationFrame(h),p.unobserve(u)}}},[]),T.createElement(rn.div,{ref:Qc(i,t),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},e1(e,u=>T.createElement("div",{ref:Qc(s,l.listInnerRef),"cmdk-list-sizer":""},u)))}),_ve=T.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:a,contentClassName:i,container:s,...o}=e;return T.createElement(a9,{open:n,onOpenChange:r},T.createElement(i9,{container:s},T.createElement(s9,{"cmdk-overlay":"",className:a}),T.createElement(o9,{"aria-label":e.label,"cmdk-dialog":"",className:i},T.createElement(wB,{ref:t,...o}))))}),Sve=T.forwardRef((e,t)=>vu(n=>n.filtered.count===0)?T.createElement(rn.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Eve=T.forwardRef((e,t)=>{let{progress:n,children:r,label:a="Loading...",...i}=e;return T.createElement(rn.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},e1(e,s=>T.createElement("div",{"aria-hidden":!0},s)))}),Tp=Object.assign(wB,{List:xve,Item:yve,Input:wve,Group:bve,Separator:vve,Dialog:_ve,Empty:Sve,Loading:Eve});function Cve(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function kve(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function xB(e){let t=T.useRef(e);return Ud(()=>{t.current=e}),t}var Ud=typeof window>"u"?T.useEffect:T.useLayoutEffect;function uh(e){let t=T.useRef();return t.current===void 0&&(t.current=e()),t}function vu(e){let t=XT(),n=()=>e(t.snapshot());return T.useSyncExternalStore(t.subscribe,n,n)}function _B(e,t,n,r=[]){let a=T.useRef(),i=J0();return Ud(()=>{var s;let o=(()=>{var u;for(let d of n){if(typeof d=="string")return d.trim();if(typeof d=="object"&&"current"in d)return d.current?(u=d.current.textContent)==null?void 0:u.trim():a.current}})(),l=r.map(u=>u.trim());i.value(e,o,l),(s=t.current)==null||s.setAttribute(ch,o),a.current=o}),a}var Tve=()=>{let[e,t]=T.useState(),n=uh(()=>new Map);return Ud(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,a)=>{n.current.set(r,a),t({})}};function Ave(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function e1({asChild:e,children:t},n){return e&&T.isValidElement(t)?T.cloneElement(Ave(t),{ref:t.ref},n(t.props.children)):n(t)}var Nve={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function SB({className:e,...t}){return m.jsx(Tp,{"data-slot":"command",className:Nt("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function EB({className:e,...t}){return m.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[m.jsx(Nd,{className:"size-4 shrink-0 opacity-50"}),m.jsx(Tp.Input,{"data-slot":"command-input",className:Nt("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function CB({className:e,...t}){return m.jsx(Tp.List,{"data-slot":"command-list",className:Nt("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function kB({...e}){return m.jsx(Tp.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function TB({className:e,...t}){return m.jsx(Tp.Group,{"data-slot":"command-group",className:Nt("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function AB({className:e,...t}){return m.jsx(Tp.Item,{"data-slot":"command-item",className:Nt("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}var t1="Popover",[NB,p_e]=Si(t1,[wu]),Q0=wu(),[Rve,Fu]=NB(t1),RB=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:i,modal:s=!1}=e,o=Q0(t),l=T.useRef(null),[u,d]=T.useState(!1),[h,p]=no({prop:r,defaultProp:a??!1,onChange:i,caller:t1});return m.jsx(Hw,{...o,children:m.jsx(Rve,{scope:t,contentId:Ya(),triggerRef:l,open:h,onOpenChange:p,onOpenToggle:T.useCallback(()=>p(y=>!y),[p]),hasCustomAnchor:u,onCustomAnchorAdd:T.useCallback(()=>d(!0),[]),onCustomAnchorRemove:T.useCallback(()=>d(!1),[]),modal:s,children:n})})};RB.displayName=t1;var IB="PopoverAnchor",Ive=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Fu(IB,n),i=Q0(n),{onCustomAnchorAdd:s,onCustomAnchorRemove:o}=a;return T.useEffect(()=>(s(),()=>o()),[s,o]),m.jsx(f0,{...i,...r,ref:t})});Ive.displayName=IB;var jB="PopoverTrigger",OB=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Fu(jB,n),i=Q0(n),s=Cn(t,a.triggerRef),o=m.jsx(rn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":LB(a.open),...r,ref:s,onClick:Vt(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?o:m.jsx(f0,{asChild:!0,...i,children:o})});OB.displayName=jB;var JT="PopoverPortal",[jve,Ove]=NB(JT,{forceMount:void 0}),DB=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,i=Fu(JT,t);return m.jsx(jve,{scope:t,forceMount:n,children:m.jsx(ka,{present:n||i.open,children:m.jsx(rp,{asChild:!0,container:a,children:r})})})};DB.displayName=JT;var Yh="PopoverContent",MB=T.forwardRef((e,t)=>{const n=Ove(Yh,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,i=Fu(Yh,e.__scopePopover);return m.jsx(ka,{present:r||i.open,children:i.modal?m.jsx(Mve,{...a,ref:t}):m.jsx(Pve,{...a,ref:t})})});MB.displayName=Yh;var Dve=eu("PopoverContent.RemoveScroll"),Mve=T.forwardRef((e,t)=>{const n=Fu(Yh,e.__scopePopover),r=T.useRef(null),a=Cn(t,r),i=T.useRef(!1);return T.useEffect(()=>{const s=r.current;if(s)return Rx(s)},[]),m.jsx(W0,{as:Dve,allowPinchZoom:!0,children:m.jsx(PB,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Vt(e.onCloseAutoFocus,s=>{var o;s.preventDefault(),i.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Vt(e.onPointerDownOutside,s=>{const o=s.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,u=o.button===2||l;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Vt(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),Pve=T.forwardRef((e,t)=>{const n=Fu(Yh,e.__scopePopover),r=T.useRef(!1),a=T.useRef(!1);return m.jsx(PB,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var s,o;(s=e.onCloseAutoFocus)==null||s.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:i=>{var l,u;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(s))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),PB=T.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:d,...h}=e,p=Fu(Yh,n),y=Q0(n);return Ax(),m.jsx(G0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:i,children:m.jsx(ep,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:d,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>p.onOpenChange(!1),children:m.jsx(Vw,{"data-state":LB(p.open),role:"dialog",id:p.contentId,...y,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),FB="PopoverClose",Fve=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Fu(FB,n);return m.jsx(rn.button,{type:"button",...r,ref:t,onClick:Vt(e.onClick,()=>a.onOpenChange(!1))})});Fve.displayName=FB;var Lve="PopoverArrow",$ve=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=Q0(n);return m.jsx(Gw,{...a,...r,ref:t})});$ve.displayName=Lve;function LB(e){return e?"open":"closed"}var Bve=RB,zve=OB,Uve=DB,qve=MB;function Lu({...e}){return m.jsx(Bve,{"data-slot":"popover",...e})}function $u({...e}){return m.jsx(zve,{"data-slot":"popover-trigger",...e})}function Bu({className:e,align:t="center",sideOffset:n=4,...r}){return m.jsx(Uve,{children:m.jsx(qve,{"data-slot":"popover-content",align:t,sideOffset:n,className:Nt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}const Hve=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:a=!1})=>{const[i,s]=T.useState(!1),[o,l]=T.useState(""),u=T.useMemo(()=>[...t].sort((v,b)=>v.name.localeCompare(b.name)),[t]),d=T.useMemo(()=>{const v=o.toLowerCase();return v?u.filter(b=>b.name.toLowerCase().includes(v)||b.content.toLowerCase().includes(v)||b.type.toLowerCase().includes(v)):u},[u,o]),h=T.useCallback(v=>{const b=n.has(v);r(e.id,v,!b),l("")},[n,r,e.id]),p=T.useCallback((v,b)=>{b.stopPropagation(),r(e.id,v,!1)},[r,e.id]),y=T.useMemo(()=>u.filter(v=>n.has(v.id)),[u,n]);return m.jsxs("div",{className:"space-y-3",children:[m.jsxs(en,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),m.jsxs(Lu,{open:i,onOpenChange:s,children:[m.jsx($u,{asChild:!0,children:m.jsxs(Mt,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between h-9",disabled:a||t.length===0,children:[m.jsx("span",{className:"truncate",children:y.length>0?`${y.length} rule(s) selected`:"Select rules..."}),m.jsx(kw,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),m.jsx(Bu,{className:"w-[--radix-popover-trigger-width] p-0",children:m.jsxs(SB,{shouldFilter:!1,children:[m.jsx(EB,{placeholder:"Search rules...",value:o,onValueChange:l}),m.jsxs(CB,{children:[m.jsx(kB,{children:t.length===0?"No rules defined.":"No rules found."}),m.jsx(TB,{children:d.map(v=>{const b=n.has(v.id);return m.jsxs(AB,{value:v.id,onSelect:()=>h(v.id),className:"cursor-pointer",children:[m.jsx(so,{className:Nt("mr-2 h-4 w-4",b?"opacity-100":"opacity-0")}),m.jsx("span",{className:"truncate",children:v.name}),m.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",v.type,")"]})]},v.id)})})]})]})})]}),y.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:y.map(v=>m.jsxs(pB,{variant:"secondary",className:"flex items-center gap-1",children:[m.jsx("span",{className:"truncate",children:v.name}),m.jsx(Mt,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:b=>p(v.id,b),disabled:a,"aria-label":`Unlink rule ${v.name}`,children:m.jsx(Ts,{className:"h-3 w-3"})})]},v.id))})]})},Vve=()=>{const{tags:e,rules:t,tagRuleLinks:n,addTag:r,updateTag:a,deleteTag:i,linkTagToRule:s,unlinkTagFromRule:o,getRulesForTag:l,isLoading:u}=Xl(dn(L=>({tags:L.tags,rules:L.rules,tagRuleLinks:L.tagRuleLinks,addTag:L.addTag,updateTag:L.updateTag,deleteTag:L.deleteTag,linkTagToRule:L.linkTagToRule,unlinkTagFromRule:L.unlinkTagFromRule,getRulesForTag:L.getRulesForTag,isLoading:L.isLoading}))),[d,h]=T.useState(!1),[p,y]=T.useState(null),[v,b]=T.useState(!1),[w,x]=T.useState({}),S=()=>{y(null),h(!0)},E=L=>{y(L),h(!0)},C=T.useCallback(()=>{h(!1),y(null),b(!1)},[]),k=T.useCallback(async L=>{b(!0);try{p?await a(p.id,L):await r(L),p||C()}catch{}finally{b(!1)}},[r,a,p,C]),R=T.useCallback(async L=>{x(X=>({...X,[L]:!0}));try{await i(L),(p==null?void 0:p.id)===L&&C()}catch{}finally{x(X=>({...X,[L]:!1}))}},[i,p,C]),O=T.useCallback(async(L,X,F)=>{try{F?await s(L,X):await o(L,X)}catch{}},[s,o]),j=T.useMemo(()=>{const L=new Map;return e.forEach(X=>{L.set(X.id,l(X.id))}),L},[e,l]),$=T.useMemo(()=>p?new Set(n.filter(L=>L.tagId===p.id).map(L=>L.ruleId)):new Set,[p,n]);return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!d&&m.jsxs(Mt,{onClick:S,variant:"outline",className:"w-full",disabled:u,children:[m.jsx(Hd,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),d&&m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m.jsx(ave,{initialData:p??void 0,isSaving:v,onSave:k,onCancel:C}),p&&m.jsx(Hve,{tag:p,allRules:t,linkedRuleIds:$,onLinkChange:O,disabled:v})]}),m.jsx(zd,{}),m.jsxs("div",{className:"pt-4",children:[m.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),m.jsx(ive,{tags:e,rulesByTagId:j,isLoading:u,isDeleting:w,onEdit:E,onDelete:R})]})]})},Gve=()=>{const e=T.useMemo(()=>[{value:"rules",label:"Rules",content:m.jsx(rve,{})},{value:"tags",label:"Tags",content:m.jsx(Vve,{})}],[]);return m.jsx(Pu,{tabs:e,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},$B=T.memo(({isOpen:e,onClose:t})=>{const{enableAdvancedSettings:n}=qr(dn(h=>({enableAdvancedSettings:h.enableAdvancedSettings}))),{customSettingsTabs:r}=Qg(dn(h=>({customSettingsTabs:h.modSettingsTabs||[]}))),{initialSettingsTab:a,clearInitialSettingsTabs:i}=pa(dn(h=>({initialSettingsTab:h.initialSettingsTab,clearInitialSettingsTabs:h.clearInitialSettingsTabs}))),[s,o]=T.useState(a||"general");T.useEffect(()=>{e&&o(a||"general")},[e,a]);const l=h=>{h||(t(),i())},u=h=>{o(h)},d=T.useMemo(()=>{const h=[{value:"general",label:"General",content:m.jsx(b0e,{})},{value:"providers",label:"Providers & Models",content:m.jsx(Wbe,{})},...n?[{value:"assistant",label:"Assistant",content:m.jsx(w0e,{})}]:[],{value:"rules-tags",label:"Rules & Tags",content:m.jsx(Gve,{})},{value:"git",label:"Git",content:m.jsx(eve,{})},{value:"data",label:"Data",content:m.jsx(_0e,{})},{value:"mods",label:"Mods",content:m.jsx(C0e,{})}],p=r.map(y=>({value:y.id,label:y.title,content:gt.isValidElement(y.component)?y.component:typeof y.component=="function"?m.jsx(y.component,{}):null}));return[...h,...p]},[n,r]);return m.jsx(zx,{open:e,onOpenChange:l,children:m.jsxs(Ux,{className:"sm:max-w-[1200px] w-[90vw] h-[80vh] min-h-[550px] max-h-[90vh] flex flex-col p-0",children:[m.jsxs(qx,{className:"p-6 pb-4 flex-shrink-0",children:[m.jsx(Vx,{children:"Settings"}),m.jsx(Gx,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),m.jsx(Pu,{tabs:d,initialValue:s,onValueChange:u,className:"flex-grow overflow-hidden px-6",listClassName:"-mx-6 px-6",contentContainerClassName:"flex-grow overflow-y-auto pb-6 pr-2 -mr-2",scrollable:!0}),m.jsx(Hx,{className:"flex-shrink-0 border-t p-6 pt-4 mt-auto",children:m.jsx(Mt,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});$B.displayName="SettingsModalComponent";const Wve=$B;function Kve(){const e=Dr.getState().registerChatControl,t=pa.getState().toggleChatControlPanel,n=pa.getState().setInitialSettingsTabs,r=()=>{const i=(s,o)=>{n(null,null),t("settingsModal",!0)};return m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",onClick:()=>i(),className:"h-8 w-8","aria-label":"Open Settings",children:m.jsx(A6,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"top",children:"Settings"})]})})},a=()=>{const i=pa.getState().isChatControlPanelOpen.settingsModal??!1,s=()=>t("settingsModal",!1);return m.jsx(Wve,{isOpen:i,onClose:s})};e({id:"core-settings-trigger",panel:"sidebar-footer",status:()=>"ready",renderer:()=>gt.createElement(r),iconRenderer:()=>gt.createElement(r),settingsRenderer:()=>gt.createElement(a),show:()=>!0}),console.log("[Function] Registered Core Settings Control")}function Zve(){const e=Dr.getState().registerChatControl,t=()=>{const{isSidebarCollapsed:n,toggleSidebar:r}=pa.getState();return m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",onClick:()=>r(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?m.jsx(lH,{className:"h-4 w-4"}):m.jsx(sH,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};e({id:"core-sidebar-toggle",panel:"sidebar-footer",status:()=>"ready",renderer:()=>gt.createElement(t),iconRenderer:()=>gt.createElement(t),show:()=>!0}),console.log("[Function] Registered Core Sidebar Toggle Control")}const Yve=()=>{const{setTemperature:e,setTopP:t,setMaxTokens:n,setTopK:r,setPresencePenalty:a,setFrequencyPenalty:i}=Ca(dn(d=>({setTemperature:d.setTemperature,setTopP:d.setTopP,setMaxTokens:d.setMaxTokens,setTopK:d.setTopK,setPresencePenalty:d.setPresencePenalty,setFrequencyPenalty:d.setFrequencyPenalty}))),s=qr.getState(),[o,l]=T.useState(()=>Ca.getState());T.useEffect(()=>{const d=h=>{l(p=>({...p,...h.params}))};return St.on(_t.PROMPT_PARAMS_CHANGED,d),()=>{St.off(_t.PROMPT_PARAMS_CHANGED,d)}},[]);const u={temperature:o.temperature??null,setTemperature:e,topP:o.topP??null,setTopP:t,maxTokens:o.maxTokens??null,setMaxTokens:n,topK:o.topK??null,setTopK:r,presencePenalty:o.presencePenalty??null,setPresencePenalty:a,frequencyPenalty:o.frequencyPenalty??null,setFrequencyPenalty:i,reasoningEnabled:null,setReasoningEnabled:()=>{},webSearchEnabled:null,setWebSearchEnabled:()=>{},defaultTemperature:s.temperature,defaultTopP:s.topP,defaultMaxTokens:s.maxTokens,defaultTopK:s.topK,defaultPresencePenalty:s.presencePenalty,defaultFrequencyPenalty:s.frequencyPenalty};return m.jsx(E9,{...u})},Xve=()=>{const[e,t]=T.useState(!1),[n,r]=T.useState(()=>Zn.getState().status==="streaming"),[a,i]=T.useState(!0);return T.useEffect(()=>{const s=d=>{const h={...Ca.getState(),...d.params},p=h.temperature!==null||h.topP!==null||h.maxTokens!==null||h.topK!==null||h.presencePenalty!==null||h.frequencyPenalty!==null;t(p)},o=d=>{r(d.status==="streaming")},l=d=>{var w;if(!d.modelId){i(!1);return}const{getSelectedModel:h}=Fn.getState(),p=h(),y=((w=p==null?void 0:p.metadata)==null?void 0:w.supported_parameters)??[],v=["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"],b=qr.getState().enableAdvancedSettings;i(b&&y.some(x=>v.includes(x)))},u=d=>{d.key==="enableAdvancedSettings"&&l({modelId:Fn.getState().selectedModelId})};return s({params:{}}),l({modelId:Fn.getState().selectedModelId}),St.on(_t.PROMPT_PARAMS_CHANGED,s),St.on(_t.INTERACTION_STATUS_CHANGED,o),St.on(_t.MODEL_SELECTION_CHANGED,l),St.on(_t.SETTINGS_CHANGED,u),()=>{St.off(_t.PROMPT_PARAMS_CHANGED,s),St.off(_t.INTERACTION_STATUS_CHANGED,o),St.off(_t.MODEL_SELECTION_CHANGED,l),St.off(_t.SETTINGS_CHANGED,u)}},[]),a?m.jsxs(Lu,{children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx($u,{asChild:!0,children:m.jsx(Mt,{variant:e?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:m.jsx(xH,{className:"h-4 w-4"})})})}),m.jsx(Jn,{side:"top",children:"Advanced Parameters"})]})}),m.jsx(Bu,{className:"w-auto p-0",align:"start",children:m.jsx(Yve,{})})]}):null};function Jve(){const e=Dr.getState().registerPromptControl;e({id:"core-parameters",status:()=>"ready",triggerRenderer:()=>gt.createElement(Xve),getParameters:()=>{const{temperature:t,topP:n,maxTokens:r,topK:a,presencePenalty:i,frequencyPenalty:s}=Ca.getState(),o=(u,d,h)=>{h!==null&&(u[d]=h)},l={};return o(l,"temperature",t),o(l,"top_p",n),o(l,"max_tokens",r),o(l,"top_k",a),o(l,"presence_penalty",i),o(l,"frequency_penalty",s),Object.keys(l).length>0?l:void 0}}),console.log("[Function] Registered Core Parameter Control")}const BB=20,Qve=BB*1024*1024,ewe=()=>{const e=T.useRef(null),t=tu.getState().addAttachedFile,[n,r]=T.useState(()=>Zn.getState().status==="streaming"),[a,i]=T.useState(!0);T.useEffect(()=>{const u=h=>{r(h.status==="streaming")},d=h=>{var b,w;if(!h.modelId){i(!0);return}const{getSelectedModel:p}=Fn.getState(),y=p(),v=(w=(b=y==null?void 0:y.metadata)==null?void 0:b.architecture)==null?void 0:w.input_modalities;i(!v||v.some(x=>x!=="text"))};return d({modelId:Fn.getState().selectedModelId}),St.on(_t.INTERACTION_STATUS_CHANGED,u),St.on(_t.MODEL_SELECTION_CHANGED,d),()=>{St.off(_t.INTERACTION_STATUS_CHANGED,u),St.off(_t.MODEL_SELECTION_CHANGED,d)}},[]);const s=T.useCallback(async u=>{const d=u.target.files;if(d){for(const h of Array.from(d)){if(h.size>Qve){tt.error(`File "${h.name}" exceeds the ${BB}MB limit.`);continue}try{let p={};const y=GC(h.name,h.type),v=h.type.startsWith("image/");if(y)p.contentText=await h.text();else if(v){const b=new FileReader,w=new Promise((S,E)=>{b.onload=()=>S(b.result),b.onerror=C=>E(C)});b.readAsDataURL(h);const x=await w;x&&x.includes(",")?p.contentBase64=x.split(",")[1]:console.warn(`Could not extract base64 from data URL for ${h.name}`)}else console.log(`File type ${h.type} (Name: ${h.name}) not directly processed for content storage in InputStore.`);t({source:"direct",name:h.name,type:h.type||"application/octet-stream",size:h.size,...p})}catch(p){console.error(`Error processing file ${h.name}:`,p),tt.error(`Failed to process file "${h.name}": ${p instanceof Error?p.message:String(p)}`)}}u.target&&(u.target.value="")}},[t]),o=()=>{var u;(u=e.current)==null||u.click()},l=a?"Attach Files":"File input not supported by this model";return m.jsxs(m.Fragment,{children:[m.jsx("input",{type:"file",ref:e,onChange:s,multiple:!0,className:"hidden",disabled:n||!a}),m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{type:"button",variant:"ghost",size:"icon",onClick:o,disabled:n||!a,className:"h-8 w-8","aria-label":l,children:m.jsx(m2,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"top",children:l})]})})]})},twe=()=>{const e=tu.getState().removeAttachedFile,[t,n]=T.useState(()=>tu.getState().attachedFilesMetadata),[r,a]=T.useState(()=>Zn.getState().status==="streaming");return T.useEffect(()=>{const i=o=>{n(o.files)},s=o=>{a(o.status==="streaming")};return St.on(_t.ATTACHED_FILES_CHANGED,i),St.on(_t.INTERACTION_STATUS_CHANGED,s),()=>{St.off(_t.ATTACHED_FILES_CHANGED,i),St.off(_t.INTERACTION_STATUS_CHANGED,s)}},[]),t.length===0?null:m.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1 pr-1",children:t.map(i=>m.jsx(K5,{fileMeta:i,onRemove:e,isReadOnly:r},i.id))})};function nwe(){const e=Dr.getState().registerPromptControl;e({id:"core-file-attachment",triggerRenderer:()=>gt.createElement(ewe),renderer:()=>gt.createElement(twe)}),console.log("[Function] Registered Core File Attachment Control")}const rwe=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:a,isOperationLoading:i})=>{const s=o=>{o.key==="Enter"?n():o.key==="Escape"&&r()};return m.jsxs(Yr,{className:"bg-muted/30",children:[m.jsx(jn,{className:"px-2 py-1"}),m.jsx(jn,{className:"px-2 py-1",children:m.jsx(s0,{className:"h-5 w-5 text-yellow-400"})}),m.jsx(jn,{className:"py-1 px-2",colSpan:3,children:m.jsx(qn,{ref:a,value:e,onChange:o=>t(o.target.value),onBlur:n,onKeyDown:s,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:i})}),m.jsx(jn,{className:"text-right pr-4 py-1",children:m.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(so,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"top",children:"Create (Enter)"})]})}),m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:m.jsx(Ts,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};var n1="Checkbox",[awe,m_e]=Si(n1),[iwe,swe]=awe(n1),zB=T.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:i,required:s,disabled:o,value:l="on",onCheckedChange:u,form:d,...h}=e,[p,y]=T.useState(null),v=Cn(t,C=>y(C)),b=T.useRef(!1),w=p?d||!!p.closest("form"):!0,[x,S]=no({prop:a,defaultProp:i??!1,onChange:u,caller:n1}),E=T.useRef(x);return T.useEffect(()=>{const C=p==null?void 0:p.form;if(C){const k=()=>S(E.current);return C.addEventListener("reset",k),()=>C.removeEventListener("reset",k)}},[p,S]),m.jsxs(iwe,{scope:n,state:x,disabled:o,children:[m.jsx(rn.button,{type:"button",role:"checkbox","aria-checked":Jc(x)?"mixed":x,"aria-required":s,"data-state":VB(x),"data-disabled":o?"":void 0,disabled:o,value:l,...h,ref:v,onKeyDown:Vt(e.onKeyDown,C=>{C.key==="Enter"&&C.preventDefault()}),onClick:Vt(e.onClick,C=>{S(k=>Jc(k)?!0:!k),w&&(b.current=C.isPropagationStopped(),b.current||C.stopPropagation())})}),w&&m.jsx(HB,{control:p,bubbles:!b.current,name:r,value:l,checked:x,required:s,disabled:o,form:d,style:{transform:"translateX(-100%)"},defaultChecked:Jc(i)?!1:i})]})});zB.displayName=n1;var UB="CheckboxIndicator",qB=T.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,i=swe(UB,n);return m.jsx(ka,{present:r||Jc(i.state)||i.state===!0,children:m.jsx(rn.span,{"data-state":VB(i.state),"data-disabled":i.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});qB.displayName=UB;var owe="CheckboxBubbleInput",HB=T.forwardRef(({__scopeCheckbox:e,control:t,checked:n,bubbles:r=!0,defaultChecked:a,...i},s)=>{const o=T.useRef(null),l=Cn(o,s),u=Nx(n),d=qw(t);T.useEffect(()=>{const p=o.current;if(!p)return;const y=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(y,"checked").set;if(u!==n&&b){const w=new Event("click",{bubbles:r});p.indeterminate=Jc(n),b.call(p,Jc(n)?!1:n),p.dispatchEvent(w)}},[u,n,r]);const h=T.useRef(Jc(n)?!1:n);return m.jsx(rn.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??h.current,...i,tabIndex:-1,ref:l,style:{...i.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});HB.displayName=owe;function Jc(e){return e==="indeterminate"}function VB(e){return Jc(e)?"indeterminate":e?"checked":"unchecked"}var lwe=zB,cwe=qB;function MC({className:e,...t}){return m.jsx(lwe,{"data-slot":"checkbox",className:Nt("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:m.jsx(cwe,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:m.jsx(so,{className:"size-3.5"})})})}var PC=["Enter"," "],uwe=["ArrowDown","PageUp","Home"],GB=["ArrowUp","PageDown","End"],dwe=[...uwe,...GB],fwe={ltr:[...PC,"ArrowRight"],rtl:[...PC,"ArrowLeft"]},hwe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ey="Menu",[a0,pwe,mwe]=Tx(ey),[lf,WB]=Si(ey,[mwe,wu,Kx]),r1=wu(),KB=Kx(),[gwe,cf]=lf(ey),[ywe,ty]=lf(ey),ZB=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:i,modal:s=!0}=e,o=r1(t),[l,u]=T.useState(null),d=T.useRef(!1),h=Fa(i),p=bp(a);return T.useEffect(()=>{const y=()=>{d.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>d.current=!1;return document.addEventListener("keydown",y,{capture:!0}),()=>{document.removeEventListener("keydown",y,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),m.jsx(Hw,{...o,children:m.jsx(gwe,{scope:t,open:n,onOpenChange:h,content:l,onContentChange:u,children:m.jsx(ywe,{scope:t,onClose:T.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:p,modal:s,children:r})})})};ZB.displayName=ey;var bwe="MenuAnchor",QT=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=r1(n);return m.jsx(f0,{...a,...r,ref:t})});QT.displayName=bwe;var eA="MenuPortal",[vwe,YB]=lf(eA,{forceMount:void 0}),XB=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,i=cf(eA,t);return m.jsx(vwe,{scope:t,forceMount:n,children:m.jsx(ka,{present:n||i.open,children:m.jsx(rp,{asChild:!0,container:a,children:r})})})};XB.displayName=eA;var Cs="MenuContent",[wwe,tA]=lf(Cs),JB=T.forwardRef((e,t)=>{const n=YB(Cs,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,i=cf(Cs,e.__scopeMenu),s=ty(Cs,e.__scopeMenu);return m.jsx(a0.Provider,{scope:e.__scopeMenu,children:m.jsx(ka,{present:r||i.open,children:m.jsx(a0.Slot,{scope:e.__scopeMenu,children:s.modal?m.jsx(xwe,{...a,ref:t}):m.jsx(_we,{...a,ref:t})})})})}),xwe=T.forwardRef((e,t)=>{const n=cf(Cs,e.__scopeMenu),r=T.useRef(null),a=Cn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return Rx(i)},[]),m.jsx(nA,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Vt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),_we=T.forwardRef((e,t)=>{const n=cf(Cs,e.__scopeMenu);return m.jsx(nA,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Swe=eu("MenuContent.ScrollLock"),nA=T.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:p,onDismiss:y,disableOutsideScroll:v,...b}=e,w=cf(Cs,n),x=ty(Cs,n),S=r1(n),E=KB(n),C=pwe(n),[k,R]=T.useState(null),O=T.useRef(null),j=Cn(t,O,w.onContentChange),$=T.useRef(0),L=T.useRef(""),X=T.useRef(0),F=T.useRef(null),K=T.useRef("right"),q=T.useRef(0),de=v?W0:T.Fragment,re=v?{as:Swe,allowPinchZoom:!0}:void 0,Y=ae=>{var Ne,Re;const B=L.current+ae,J=C().filter(ke=>!ke.disabled),ee=document.activeElement,oe=(Ne=J.find(ke=>ke.ref.current===ee))==null?void 0:Ne.textValue,me=J.map(ke=>ke.textValue),xe=Mwe(me,B,oe),Pe=(Re=J.find(ke=>ke.textValue===xe))==null?void 0:Re.ref.current;(function ke(Fe){L.current=Fe,window.clearTimeout($.current),Fe!==""&&($.current=window.setTimeout(()=>ke(""),1e3))})(B),Pe&&setTimeout(()=>Pe.focus())};T.useEffect(()=>()=>window.clearTimeout($.current),[]),Ax();const Q=T.useCallback(ae=>{var J,ee;return K.current===((J=F.current)==null?void 0:J.side)&&Fwe(ae,(ee=F.current)==null?void 0:ee.area)},[]);return m.jsx(wwe,{scope:n,searchRef:L,onItemEnter:T.useCallback(ae=>{Q(ae)&&ae.preventDefault()},[Q]),onItemLeave:T.useCallback(ae=>{var B;Q(ae)||((B=O.current)==null||B.focus(),R(null))},[Q]),onTriggerLeave:T.useCallback(ae=>{Q(ae)&&ae.preventDefault()},[Q]),pointerGraceTimerRef:X,onPointerGraceIntentChange:T.useCallback(ae=>{F.current=ae},[]),children:m.jsx(de,{...re,children:m.jsx(G0,{asChild:!0,trapped:a,onMountAutoFocus:Vt(i,ae=>{var B;ae.preventDefault(),(B=O.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:m.jsx(ep,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:p,onDismiss:y,children:m.jsx(O9,{asChild:!0,...E,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:k,onCurrentTabStopIdChange:R,onEntryFocus:Vt(l,ae=>{x.isUsingKeyboardRef.current||ae.preventDefault()}),preventScrollOnEntryFocus:!0,children:m.jsx(Vw,{role:"menu","aria-orientation":"vertical","data-state":pz(w.open),"data-radix-menu-content":"",dir:x.dir,...S,...b,ref:j,style:{outline:"none",...b.style},onKeyDown:Vt(b.onKeyDown,ae=>{const J=ae.target.closest("[data-radix-menu-content]")===ae.currentTarget,ee=ae.ctrlKey||ae.altKey||ae.metaKey,oe=ae.key.length===1;J&&(ae.key==="Tab"&&ae.preventDefault(),!ee&&oe&&Y(ae.key));const me=O.current;if(ae.target!==me||!dwe.includes(ae.key))return;ae.preventDefault();const Pe=C().filter(Ne=>!Ne.disabled).map(Ne=>Ne.ref.current);GB.includes(ae.key)&&Pe.reverse(),Owe(Pe)}),onBlur:Vt(e.onBlur,ae=>{ae.currentTarget.contains(ae.target)||(window.clearTimeout($.current),L.current="")}),onPointerMove:Vt(e.onPointerMove,i0(ae=>{const B=ae.target,J=q.current!==ae.clientX;if(ae.currentTarget.contains(B)&&J){const ee=ae.clientX>q.current?"right":"left";K.current=ee,q.current=ae.clientX}}))})})})})})})});JB.displayName=Cs;var Ewe="MenuGroup",rA=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return m.jsx(rn.div,{role:"group",...r,ref:t})});rA.displayName=Ewe;var Cwe="MenuLabel",QB=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return m.jsx(rn.div,{...r,ref:t})});QB.displayName=Cwe;var Ew="MenuItem",KO="menu.itemSelect",a1=T.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,i=T.useRef(null),s=ty(Ew,e.__scopeMenu),o=tA(Ew,e.__scopeMenu),l=Cn(t,i),u=T.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const p=new CustomEvent(KO,{bubbles:!0,cancelable:!0});h.addEventListener(KO,y=>r==null?void 0:r(y),{once:!0}),i8(h,p),p.defaultPrevented?u.current=!1:s.onClose()}};return m.jsx(ez,{...a,ref:l,disabled:n,onClick:Vt(e.onClick,d),onPointerDown:h=>{var p;(p=e.onPointerDown)==null||p.call(e,h),u.current=!0},onPointerUp:Vt(e.onPointerUp,h=>{var p;u.current||(p=h.currentTarget)==null||p.click()}),onKeyDown:Vt(e.onKeyDown,h=>{const p=o.searchRef.current!=="";n||p&&h.key===" "||PC.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});a1.displayName=Ew;var ez=T.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...i}=e,s=tA(Ew,n),o=KB(n),l=T.useRef(null),u=Cn(t,l),[d,h]=T.useState(!1),[p,y]=T.useState("");return T.useEffect(()=>{const v=l.current;v&&y((v.textContent??"").trim())},[i.children]),m.jsx(a0.ItemSlot,{scope:n,disabled:r,textValue:a??p,children:m.jsx(D9,{asChild:!0,...o,focusable:!r,children:m.jsx(rn.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:Vt(e.onPointerMove,i0(v=>{r?s.onItemLeave(v):(s.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Vt(e.onPointerLeave,i0(v=>s.onItemLeave(v))),onFocus:Vt(e.onFocus,()=>h(!0)),onBlur:Vt(e.onBlur,()=>h(!1))})})})}),kwe="MenuCheckboxItem",tz=T.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return m.jsx(sz,{scope:e.__scopeMenu,checked:n,children:m.jsx(a1,{role:"menuitemcheckbox","aria-checked":Cw(n)?"mixed":n,...a,ref:t,"data-state":iA(n),onSelect:Vt(a.onSelect,()=>r==null?void 0:r(Cw(n)?!0:!n),{checkForDefaultPrevented:!1})})})});tz.displayName=kwe;var nz="MenuRadioGroup",[Twe,Awe]=lf(nz,{value:void 0,onValueChange:()=>{}}),rz=T.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,i=Fa(r);return m.jsx(Twe,{scope:e.__scopeMenu,value:n,onValueChange:i,children:m.jsx(rA,{...a,ref:t})})});rz.displayName=nz;var az="MenuRadioItem",iz=T.forwardRef((e,t)=>{const{value:n,...r}=e,a=Awe(az,e.__scopeMenu),i=n===a.value;return m.jsx(sz,{scope:e.__scopeMenu,checked:i,children:m.jsx(a1,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":iA(i),onSelect:Vt(r.onSelect,()=>{var s;return(s=a.onValueChange)==null?void 0:s.call(a,n)},{checkForDefaultPrevented:!1})})})});iz.displayName=az;var aA="MenuItemIndicator",[sz,Nwe]=lf(aA,{checked:!1}),oz=T.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,i=Nwe(aA,n);return m.jsx(ka,{present:r||Cw(i.checked)||i.checked===!0,children:m.jsx(rn.span,{...a,ref:t,"data-state":iA(i.checked)})})});oz.displayName=aA;var Rwe="MenuSeparator",lz=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return m.jsx(rn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});lz.displayName=Rwe;var Iwe="MenuArrow",cz=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=r1(n);return m.jsx(Gw,{...a,...r,ref:t})});cz.displayName=Iwe;var jwe="MenuSub",[g_e,uz]=lf(jwe),Vm="MenuSubTrigger",dz=T.forwardRef((e,t)=>{const n=cf(Vm,e.__scopeMenu),r=ty(Vm,e.__scopeMenu),a=uz(Vm,e.__scopeMenu),i=tA(Vm,e.__scopeMenu),s=T.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,u={__scopeMenu:e.__scopeMenu},d=T.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return T.useEffect(()=>d,[d]),T.useEffect(()=>{const h=o.current;return()=>{window.clearTimeout(h),l(null)}},[o,l]),m.jsx(QT,{asChild:!0,...u,children:m.jsx(ez,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":pz(n.open),...e,ref:Qc(t,a.onTriggerChange),onClick:h=>{var p;(p=e.onClick)==null||p.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Vt(e.onPointerMove,i0(h=>{i.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!n.open&&!s.current&&(i.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:Vt(e.onPointerLeave,i0(h=>{var y,v;d();const p=(y=n.content)==null?void 0:y.getBoundingClientRect();if(p){const b=(v=n.content)==null?void 0:v.dataset.side,w=b==="right",x=w?-5:5,S=p[w?"left":"right"],E=p[w?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+x,y:h.clientY},{x:S,y:p.top},{x:E,y:p.top},{x:E,y:p.bottom},{x:S,y:p.bottom}],side:b}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Vt(e.onKeyDown,h=>{var y;const p=i.searchRef.current!=="";e.disabled||p&&h.key===" "||fwe[r.dir].includes(h.key)&&(n.onOpenChange(!0),(y=n.content)==null||y.focus(),h.preventDefault())})})})});dz.displayName=Vm;var fz="MenuSubContent",hz=T.forwardRef((e,t)=>{const n=YB(Cs,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,i=cf(Cs,e.__scopeMenu),s=ty(Cs,e.__scopeMenu),o=uz(fz,e.__scopeMenu),l=T.useRef(null),u=Cn(t,l);return m.jsx(a0.Provider,{scope:e.__scopeMenu,children:m.jsx(ka,{present:r||i.open,children:m.jsx(a0.Slot,{scope:e.__scopeMenu,children:m.jsx(nA,{id:o.contentId,"aria-labelledby":o.triggerId,...a,ref:u,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;s.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:Vt(e.onFocusOutside,d=>{d.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Vt(e.onEscapeKeyDown,d=>{s.onClose(),d.preventDefault()}),onKeyDown:Vt(e.onKeyDown,d=>{var y;const h=d.currentTarget.contains(d.target),p=hwe[s.dir].includes(d.key);h&&p&&(i.onOpenChange(!1),(y=o.trigger)==null||y.focus(),d.preventDefault())})})})})})});hz.displayName=fz;function pz(e){return e?"open":"closed"}function Cw(e){return e==="indeterminate"}function iA(e){return Cw(e)?"indeterminate":e?"checked":"unchecked"}function Owe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Dwe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Mwe(e,t,n){const a=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let s=Dwe(e,Math.max(i,0));a.length===1&&(s=s.filter(u=>u!==n));const l=s.find(u=>u.toLowerCase().startsWith(a.toLowerCase()));return l!==n?l:void 0}function Pwe(e,t){const{x:n,y:r}=e;let a=!1;for(let i=0,s=t.length-1;i<t.length;s=i++){const o=t[i],l=t[s],u=o.x,d=o.y,h=l.x,p=l.y;d>r!=p>r&&n<(h-u)*(r-d)/(p-d)+u&&(a=!a)}return a}function Fwe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Pwe(n,t)}function i0(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Lwe=ZB,$we=QT,Bwe=XB,zwe=JB,Uwe=rA,qwe=QB,Hwe=a1,Vwe=tz,Gwe=rz,Wwe=iz,Kwe=oz,Zwe=lz,Ywe=cz,Xwe=dz,Jwe=hz,sA="ContextMenu",[Qwe,y_e]=Si(sA,[WB]),ki=WB(),[exe,mz]=Qwe(sA),gz=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:a,modal:i=!0}=e,[s,o]=T.useState(!1),l=ki(t),u=Fa(r),d=T.useCallback(h=>{o(h),u(h)},[u]);return m.jsx(exe,{scope:t,open:s,onOpenChange:d,modal:i,children:m.jsx(Lwe,{...l,dir:a,open:s,onOpenChange:d,modal:i,children:n})})};gz.displayName=sA;var yz="ContextMenuTrigger",bz=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...a}=e,i=mz(yz,n),s=ki(n),o=T.useRef({x:0,y:0}),l=T.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),u=T.useRef(0),d=T.useCallback(()=>window.clearTimeout(u.current),[]),h=p=>{o.current={x:p.clientX,y:p.clientY},i.onOpenChange(!0)};return T.useEffect(()=>d,[d]),T.useEffect(()=>void(r&&d()),[r,d]),m.jsxs(m.Fragment,{children:[m.jsx($we,{...s,virtualRef:l}),m.jsx(rn.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...a,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Vt(e.onContextMenu,p=>{d(),h(p),p.preventDefault()}),onPointerDown:r?e.onPointerDown:Vt(e.onPointerDown,Yb(p=>{d(),u.current=window.setTimeout(()=>h(p),700)})),onPointerMove:r?e.onPointerMove:Vt(e.onPointerMove,Yb(d)),onPointerCancel:r?e.onPointerCancel:Vt(e.onPointerCancel,Yb(d)),onPointerUp:r?e.onPointerUp:Vt(e.onPointerUp,Yb(d))})]})});bz.displayName=yz;var txe="ContextMenuPortal",vz=e=>{const{__scopeContextMenu:t,...n}=e,r=ki(t);return m.jsx(Bwe,{...r,...n})};vz.displayName=txe;var wz="ContextMenuContent",xz=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=mz(wz,n),i=ki(n),s=T.useRef(!1);return m.jsx(zwe,{...i,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&s.current&&o.preventDefault(),s.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!a.modal&&(s.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});xz.displayName=wz;var nxe="ContextMenuGroup",rxe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Uwe,{...a,...r,ref:t})});rxe.displayName=nxe;var axe="ContextMenuLabel",ixe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(qwe,{...a,...r,ref:t})});ixe.displayName=axe;var sxe="ContextMenuItem",_z=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Hwe,{...a,...r,ref:t})});_z.displayName=sxe;var oxe="ContextMenuCheckboxItem",lxe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Vwe,{...a,...r,ref:t})});lxe.displayName=oxe;var cxe="ContextMenuRadioGroup",uxe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Gwe,{...a,...r,ref:t})});uxe.displayName=cxe;var dxe="ContextMenuRadioItem",fxe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Wwe,{...a,...r,ref:t})});fxe.displayName=dxe;var hxe="ContextMenuItemIndicator",pxe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Kwe,{...a,...r,ref:t})});pxe.displayName=hxe;var mxe="ContextMenuSeparator",Sz=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Zwe,{...a,...r,ref:t})});Sz.displayName=mxe;var gxe="ContextMenuArrow",yxe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Ywe,{...a,...r,ref:t})});yxe.displayName=gxe;var bxe="ContextMenuSubTrigger",vxe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Xwe,{...a,...r,ref:t})});vxe.displayName=bxe;var wxe="ContextMenuSubContent",xxe=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,a=ki(n);return m.jsx(Jwe,{...a,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});xxe.displayName=wxe;function Yb(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var _xe=gz,Sxe=bz,Exe=vz,Cxe=xz,kxe=_z,Txe=Sz;function ZO({...e}){return m.jsx(_xe,{"data-slot":"context-menu",...e})}function YO({...e}){return m.jsx(Sxe,{"data-slot":"context-menu-trigger",...e})}function XO({className:e,...t}){return m.jsx(Exe,{children:m.jsx(Cxe,{"data-slot":"context-menu-content",className:Nt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function Xi({className:e,inset:t,variant:n="default",...r}){return m.jsx(kxe,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:Nt("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function JO({className:e,...t}){return m.jsx(Txe,{"data-slot":"context-menu-separator",className:Nt("bg-border -mx-1 my-1 h-px",e),...t})}const Axe=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:a,isOperationLoading:i,creatingFolder:s,handleNavigate:o,handleCheckboxChange:l,startEditing:u,cancelEditing:d,handleRename:h,handleDownload:p,handleDelete:y,setNewName:v,renameInputRef:b,handleGitInit:w,handleGitPull:x,handleGitCommit:S,handleGitPush:E,handleGitStatus:C})=>{const k=e.type==="folder",R=X=>{X.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||i||(k?o(e):l(!n,e.id))},O=X=>{X.key==="Enter"?h():X.key==="Escape"&&d()},j=k?r?Iq:s0:Nq,$=k?r?"text-green-400":"text-yellow-400":"text-blue-400",L=m.jsxs(Yr,{className:Nt("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",i&&"opacity-70 cursor-not-allowed",!k&&"cursor-pointer"),onClick:R,onDoubleClick:()=>!i&&!t&&o(e),children:[m.jsx(jn,{className:"px-2 py-1",children:m.jsx(MC,{checked:n,onCheckedChange:X=>l(!!X,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:i||k})}),m.jsx(jn,{className:"px-2 py-1",children:m.jsx(j,{className:Nt("h-5 w-5",$)})}),m.jsx(jn,{className:"py-1 px-2",children:t?m.jsx(qn,{ref:b,value:a,onChange:X=>v(X.target.value),onBlur:h,onKeyDown:O,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:X=>X.stopPropagation(),disabled:i}):m.jsx("span",{className:Nt("truncate",k&&"cursor-pointer hover:underline"),title:e.name,onClick:X=>{k&&(X.stopPropagation(),o(e))},children:e.name})}),m.jsx(jn,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?Zv(e.size):""}),m.jsx(jn,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),m.jsx(jn,{className:"text-right pr-4 py-1",children:m.jsx("div",{className:Nt("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",i&&"opacity-30"),children:t?m.jsxs(m.Fragment,{children:[m.jsx(rr,{tooltipText:"Save (Enter)",onClick:X=>{X.stopPropagation(),h()},"aria-label":"Save name",disabled:i||!a.trim(),icon:i?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(so,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),m.jsx(rr,{tooltipText:"Cancel (Esc)",onClick:X=>{X.stopPropagation(),d()},"aria-label":"Cancel edit",disabled:i,icon:m.jsx(Ts,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):m.jsxs(m.Fragment,{children:[m.jsx(rr,{tooltipText:"Rename",onClick:X=>{X.stopPropagation(),u(e)},"aria-label":"Rename",disabled:i||s,icon:m.jsx(Jb,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),m.jsx(rr,{tooltipText:k?"Download folder (.zip)":"Download file",onClick:X=>{X.stopPropagation(),p(e)},"aria-label":k?"Download folder as ZIP":"Download file",disabled:i,icon:m.jsx(yh,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),m.jsx(rr,{tooltipText:"Delete",onClick:X=>{X.stopPropagation(),y(e)},"aria-label":`Delete ${k?"folder":"file"}`,disabled:i,icon:m.jsx(ts,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return k?m.jsxs(ZO,{children:[m.jsx(YO,{disabled:t||i,asChild:!0,children:L}),m.jsxs(XO,{children:[m.jsx(Xi,{onSelect:()=>o(e),disabled:t||i,children:"Open Folder"}),m.jsx(JO,{}),r?m.jsxs(m.Fragment,{children:[m.jsxs(Xi,{onSelect:()=>x(e.path),disabled:i,children:[m.jsx(Bq,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),m.jsxs(Xi,{onSelect:()=>S(e.path),disabled:i,children:[m.jsx(Lq,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),m.jsxs(Xi,{onSelect:()=>E(e.path),disabled:i,children:[m.jsx(C6,{className:"mr-2 h-4 w-4"}),"Git Push"]}),m.jsxs(Xi,{onSelect:()=>C(e.path),disabled:i,children:[m.jsx(Yq,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):m.jsxs(Xi,{onSelect:()=>w(e.path),disabled:i,children:[m.jsx(eg,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),m.jsx(JO,{}),m.jsxs(Xi,{onSelect:()=>u(e),disabled:i,children:[m.jsx(Jb,{className:"mr-2 h-4 w-4"}),"Rename"]}),m.jsxs(Xi,{onSelect:()=>p(e),disabled:i,children:[m.jsx(yh,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),m.jsxs(Xi,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>y(e),disabled:i,children:[m.jsx(ts,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):m.jsxs(ZO,{children:[m.jsx(YO,{disabled:t||i,asChild:!0,children:L}),m.jsxs(XO,{children:[m.jsxs(Xi,{onSelect:()=>l(!n,e.id),disabled:i,children:[n?"Deselect":"Select"," File"]}),m.jsxs(Xi,{onSelect:()=>u(e),disabled:i,children:[m.jsx(Jb,{className:"mr-2 h-4 w-4"}),"Rename"]}),m.jsxs(Xi,{onSelect:()=>p(e),disabled:i,children:[m.jsx(yh,{className:"mr-2 h-4 w-4"}),"Download File"]}),m.jsxs(Xi,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>y(e),disabled:i,children:[m.jsx(ts,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},Nxe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:a,selectedFileIds:i,isOperationLoading:s,handleNavigate:o,handleCheckboxChange:l,startEditing:u,cancelEditing:d,handleRename:h,cancelCreatingFolder:p,handleCreateFolder:y,handleDownload:v,handleDelete:b,setNewName:w,setNewFolderName:x,renameInputRef:S,newFolderInputRef:E,gitRepoStatus:C,handleGitInit:k,handleGitPull:R,handleGitCommit:O,handleGitPush:j,handleGitStatus:$})=>{const L=T.useMemo(()=>e,[e]);return s&&e.length===0&&!r?m.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):m.jsx("div",{className:"relative h-full",children:m.jsxs(xp,{className:"w-full text-sm",children:[m.jsx(_p,{className:"sticky top-0 bg-card z-10",children:m.jsxs(Yr,{className:"hover:bg-card",children:[m.jsx(kr,{className:"w-[40px] px-2"}),m.jsx(kr,{className:"w-[40px] px-2"}),m.jsx(kr,{children:"Name"}),m.jsx(kr,{className:"w-[100px] text-right",children:"Size"}),m.jsx(kr,{className:"w-[150px] text-right",children:"Modified"}),m.jsx(kr,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),m.jsxs(Sp,{children:[r&&m.jsx(rwe,{newFolderName:a,setNewFolderName:x,handleCreateFolder:y,cancelCreatingFolder:p,newFolderInputRef:E,isOperationLoading:s}),L.map(X=>{const F=t===X.path,K=i.has(X.id),q=C[X.path]??!1;return m.jsx(Axe,{entry:X,isEditingThis:F,isChecked:K,isGitRepo:q,newName:F?n:"",isOperationLoading:s,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:u,cancelEditing:d,handleRename:h,handleDownload:v,handleDelete:b,setNewName:w,renameInputRef:S,handleGitInit:k,handleGitPull:R,handleGitCommit:O,handleGitPush:j,handleGitStatus:$},X.id)}),e.length===0&&!r&&!s&&m.jsx(Yr,{children:m.jsx(jn,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},Rxe=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:a,creatingFolder:i,handleNavigateHome:s,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:u,handleUploadClick:d,handleFolderUploadClick:h,handleArchiveUploadClick:p,handleDownloadAll:y,handleCloneClick:v,fileInputRef:b,folderInputRef:w,archiveInputRef:x,handleFileChange:S,handleArchiveChange:E})=>m.jsxs(m.Fragment,{children:[m.jsx("input",{type:"file",ref:b,onChange:S,className:"hidden",multiple:!0,disabled:t}),m.jsx("input",{type:"file",ref:w,onChange:S,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),m.jsx("input",{type:"file",ref:x,onChange:E,className:"hidden",accept:".zip",disabled:t}),m.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[m.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[m.jsx(Mt,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),s()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:m.jsx(Gq,{className:"h-4 w-4"})}),m.jsx(Mt,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:m.jsx(Dq,{className:"h-4 w-4"})}),m.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[200px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),m.jsx("div",{className:"flex-grow"}),m.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap",children:[m.jsx(Mt,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(Tw,{className:"h-4 w-4"})}),m.jsxs(Mt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),u()},disabled:t||i||!!a,className:"h-8",title:"Create New Folder",type:"button",children:[n&&i?m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(UC,{className:"h-4 w-4 mr-1"}),"Folder"]}),m.jsxs(Mt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),d()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(E6,{className:"h-4 w-4 mr-1"}),"Files"]}),m.jsxs(Mt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),h()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(s0,{className:"h-4 w-4 mr-1"}),"Folder"]}),m.jsxs(Mt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),p()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(xq,{className:"h-4 w-4 mr-1"}),"ZIP"]}),m.jsxs(Mt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),v()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(eg,{className:"h-4 w-4 mr-1"}),"Clone"]}),m.jsxs(Mt,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),y()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(ZU,{className:"h-4 w-4 mr-1"}),"Export"]})]})]})]}),Ez=({isOpen:e,onOpenChange:t,title:n,description:r,children:a,submitLabel:i="Submit",onSubmit:s,isSubmitting:o,submitDisabled:l=!1,className:u,contentClassName:d})=>{const h=async p=>{p==null||p.preventDefault(),!(o||l)&&await s()};return m.jsx(zx,{open:e,onOpenChange:t,children:m.jsxs(Ux,{className:Nt(u),children:[m.jsxs(qx,{children:[m.jsx(Vx,{children:n}),r&&m.jsx(Gx,{children:r})]}),m.jsx("div",{className:Nt("py-4",d),children:a}),m.jsxs(Hx,{children:[m.jsx(Gge,{asChild:!0,children:m.jsx(Mt,{variant:"outline",disabled:o,children:"Cancel"})}),m.jsxs(Mt,{onClick:h,disabled:o||l,children:[o&&m.jsx(zn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":i]})]})]})})},Ixe=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:a,setCloneBranch:i,isCloning:s,onSubmitClone:o,currentPath:l})=>m.jsx(Ez,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:m.jsxs(m.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",m.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:s,submitDisabled:!n.trim(),children:m.jsxs("div",{className:"grid gap-4",children:[m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(en,{htmlFor:"clone-url",className:"text-right",children:"URL"}),m.jsx(qn,{id:"clone-url",value:n,onChange:u=>r(u.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:s})]}),m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(en,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),m.jsx(qn,{id:"clone-branch",value:a,onChange:u=>i(u.target.value),className:"col-span-3",placeholder:"main (default)",disabled:s})]})]})}),jxe=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:a,isCommitting:i,onSubmitCommit:s})=>m.jsx(Ez,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:m.jsxs(m.Fragment,{children:["Enter a commit message for the changes in ",m.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:s,isSubmitting:i,submitDisabled:!r.trim(),children:m.jsx("div",{className:"grid gap-4",children:m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(en,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),m.jsx(qn,{id:"commit-msg",value:r,onChange:o=>a(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:i})]})})}),oA=T.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:a,error:i,fetchNodes:s,createDirectory:o,uploadFiles:l,deleteNodes:u,renameNode:d,setCurrentPath:h,rootId:p,selectFile:y,deselectFile:v,selectedFileIds:b,vfsKey:w,configuredVfsKey:x,initializingKey:S,_setError:E,_setOperationLoading:C,findNodeByPath:k,initializeVFS:R}=Xs(dn(ut=>({nodes:ut.nodes,childrenMap:ut.childrenMap,currentParentId:ut.currentParentId,selectedFileIds:ut.selectedFileIds,loading:ut.loading,operationLoading:ut.operationLoading,error:ut.error,fetchNodes:ut.fetchNodes,createDirectory:ut.createDirectory,uploadFiles:ut.uploadFiles,deleteNodes:ut.deleteNodes,renameNode:ut.renameNode,selectFile:ut.selectFile,deselectFile:ut.deselectFile,setCurrentPath:ut.setCurrentPath,rootId:ut.rootId,vfsKey:ut.vfsKey,configuredVfsKey:ut.configuredVfsKey,initializingKey:ut.initializingKey,_setError:ut._setError,_setOperationLoading:ut._setOperationLoading,findNodeByPath:ut.findNodeByPath,initializeVFS:ut.initializeVFS}))),[O,j]=T.useState(""),[$,L]=T.useState(null),[X,F]=T.useState(!1),[K,q]=T.useState(""),[de,re]=T.useState({}),[Y,Q]=T.useState(!1),[ae,B]=T.useState(""),[J,ee]=T.useState(""),[oe,me]=T.useState(!1),[xe,Pe]=T.useState(!1),[Ne,Re]=T.useState(null),[ke,Fe]=T.useState(""),[Qe,Le]=T.useState(!1),[Ie,V]=T.useState({}),ge=T.useRef(null),Te=T.useRef(null),le=T.useRef(null),ie=T.useRef(null),te=T.useRef(null),_e=n?e[n]:null,Me=_e?_e.path:"/",We=(t[n||p||""]||[]).map(ut=>e[ut]).filter(ut=>!!ut).sort((ut,Tt)=>ut.type==="folder"&&Tt.type==="file"?-1:ut.type==="file"&&Tt.type==="folder"?1:ut.name.localeCompare(Tt.name)),kt=T.useMemo(()=>We.filter(ut=>ut.type==="folder").map(ut=>ut.path),[We]),it=r||S!==null||w!==x,xt=a||oe||Qe||Object.values(Ie).some(Boolean);T.useEffect(()=>{n!==null&&!t[n]&&!it&&x===w?s(n):n===null&&p&&!t[p]&&!it&&x===w&&s(p)},[n,t,p,it,s,x,w]),T.useEffect(()=>{var ut,Tt;$&&((ut=ie.current)==null||ut.focus(),(Tt=ie.current)==null||Tt.select())},[$]),T.useEffect(()=>{var ut;X&&((ut=te.current)==null||ut.focus())},[X]),T.useEffect(()=>{(async()=>{if(it||kt.length===0)return;const Tt={};let Pt=!1;for(const Jt of kt)try{const An=await dse(Jt);de[Jt]!==An&&(Tt[Jt]=An,Pt=!0)}catch(An){console.error(`Error checking git status for ${Jt}:`,An),de[Jt]!==!1&&(Tt[Jt]=!1,Pt=!0)}Pt&&re(Jt=>({...Jt,...Tt}))})()},[kt,it,de]);const Dt=T.useCallback(async(ut,Tt)=>{if(!(xt||it)){Tt!==!1&&C(!0),E(null);try{await ut()}catch(Pt){console.error("[FileManager Operation Error]:",Pt)}finally{Tt!==!1&&C(!1)}}},[xt,it,E,C]),Ot=T.useCallback(ut=>{xt||it||$||ut.type==="folder"&&Dt(()=>h(ut.path),!1)},[xt,it,$,h,Dt]),Wt=T.useCallback(()=>{if(xt||it||Me==="/")return;const ut=_0(Me);Dt(()=>h(ut),!1)},[xt,it,Me,h,Dt]),be=T.useCallback(()=>{xt||it||Me==="/"||Dt(()=>h("/"),!1)},[xt,it,Me,h,Dt]),I=T.useCallback(()=>{it||Dt(()=>s(n),!1)},[Dt,s,n,it]),G=T.useCallback((ut,Tt)=>{const Pt=e[Tt];Pt&&Pt.type==="file"?ut?y(Tt):v(Tt):Pt&&Pt.type==="folder"&&tt.info("Folders cannot be attached to the prompt.")},[y,v,e]),fe=T.useCallback(ut=>{xt||it||X||(L(ut.path),j(ut.name),F(!1))},[xt,it,X]),je=T.useCallback(()=>{L(null),j("")},[]),ve=T.useCallback(async()=>{if(!$||!O.trim()){je();return}const ut=k($);ut&&ut.name!==O.trim()&&await Dt(()=>d(ut.id,O.trim())),je()},[$,O,d,je,k,Dt]),Ce=T.useCallback(()=>{xt||it||$||(F(!0),q(""),L(null))},[xt,it,$]),ce=T.useCallback(()=>{F(!1),q("")},[]),ft=T.useCallback(async()=>{if(!K.trim()){ce();return}await Dt(()=>o(n,K.trim())),ce()},[K,o,n,ce,Dt]),vt=()=>{var ut;return(ut=ge.current)==null?void 0:ut.click()},M=()=>{var ut;return(ut=Te.current)==null?void 0:ut.click()},Be=()=>{var ut;return(ut=le.current)==null?void 0:ut.click()},nt=T.useCallback(async ut=>{const Tt=ut.target.files;Tt&&Tt.length>0&&(await Dt(()=>l(n,Tt)),ut.target&&(ut.target.value=""))},[l,n,Dt]),ye=T.useCallback(async ut=>{var Pt;const Tt=(Pt=ut.target.files)==null?void 0:Pt[0];Tt&&(await Dt(async()=>{await pse(Tt,Me),await s(n)}),ut.target&&(ut.target.value=""))},[Me,s,n,Dt]),Oe=T.useCallback(async ut=>{window.confirm(`Delete ${ut.type} "${ut.name}"?${ut.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await Dt(()=>u([ut.id]))},[u,Dt]),Ke=T.useCallback(async ut=>{await Dt(async()=>{ut.type==="file"?await hse(ut.path):await E4(`${ut.name}.zip`,ut.path)})},[Dt]),Rt=T.useCallback(async()=>{We.length!==0&&await Dt(async()=>{const ut=ma(Me)||"root";await E4(`${ut}_export.zip`,Me)})},[Me,We.length,Dt]),pe=T.useCallback(async(ut,Tt)=>{if(!(Ie[ut]||it||a)){V(Pt=>({...Pt,[ut]:!0})),E(null);try{await Tt()}catch(Pt){console.error(`[FileManager Git Op Error @ ${ut}]:`,Pt)}finally{V(Pt=>({...Pt,[ut]:!1}))}}},[E,Ie,it,a]),H=T.useCallback(ut=>{pe(ut,async()=>{await q5(ut),re(Tt=>({...Tt,[ut]:!0}))})},[pe]),U=T.useCallback(ut=>{tt.info("Pulling default branch (auth not implemented yet)..."),pe(ut,()=>bx(ut,"main"))},[pe]),W=T.useCallback(ut=>{Re(ut),Fe(""),Pe(!0)},[]),he=T.useCallback(ut=>{tt.info("Pushing default branch (auth not implemented yet)..."),pe(ut,()=>oT(ut,"main"))},[pe]),Ae=T.useCallback(ut=>{pe(ut,()=>H5(ut))},[pe]),qe=T.useCallback(()=>{B(""),ee(""),Q(!0)},[]),pt=T.useCallback(async()=>{if(!ae.trim()){tt.error("Repository URL cannot be empty.");return}me(!0),E(null);try{const ut=ma(ae.trim().replace(/\.git$/,""))||"cloned_repo",Tt=Ng(Me,ut);await U5(Tt,ae.trim(),J.trim()||void 0),Q(!1),await I()}catch{}finally{me(!1)}},[ae,J,Me,E,I]),Gt=T.useCallback(async()=>{if(!Ne||!ke.trim()){tt.error("Commit message cannot be empty.");return}Le(!0),E(null);try{await sT(Ne,ke.trim()),Pe(!1)}catch{}finally{Le(!1)}},[Ne,ke,E]);return it?m.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[m.jsx(zn,{className:"h-8 w-8 animate-spin mb-2"}),m.jsx("p",{children:S?`Initializing filesystem: ${S}`:"Loading filesystem..."}),i&&m.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",i]})]}):i&&!it?m.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[m.jsxs("p",{children:["Error loading filesystem: ",i]}),m.jsx(Mt,{variant:"outline",size:"sm",onClick:()=>R(w||"default_fallback_key"),className:"mt-2",children:"Retry"})]}):m.jsxs("div",{className:Nt("flex h-full flex-col bg-card text-card-foreground"),children:[m.jsx(Rxe,{currentPath:Me,isAnyLoading:xt||it,isOperationLoading:a,entries:We,editingPath:$,creatingFolder:X,handleNavigateHome:be,handleNavigateUp:Wt,handleRefresh:I,startCreatingFolder:Ce,handleUploadClick:vt,handleFolderUploadClick:M,handleArchiveUploadClick:Be,handleDownloadAll:Rt,handleCloneClick:qe,fileInputRef:ge,folderInputRef:Te,archiveInputRef:le,handleFileChange:nt,handleArchiveChange:ye}),m.jsx("div",{className:"flex-grow overflow-auto",children:m.jsx(Nxe,{entries:We,editingPath:$,newName:O,creatingFolder:X,newFolderName:K,selectedFileIds:b,isOperationLoading:xt,handleNavigate:Ot,handleCheckboxChange:G,startEditing:fe,cancelEditing:je,handleRename:ve,cancelCreatingFolder:ce,handleCreateFolder:ft,handleDownload:Ke,handleDelete:Oe,setNewName:j,setNewFolderName:q,renameInputRef:ie,newFolderInputRef:te,gitRepoStatus:de,handleGitInit:H,handleGitPull:U,handleGitCommit:W,handleGitPush:he,handleGitStatus:Ae})}),m.jsx(Ixe,{isOpen:Y,onOpenChange:Q,cloneRepoUrl:ae,setCloneRepoUrl:B,cloneBranch:J,setCloneBranch:ee,isCloning:oe,onSubmitClone:pt,currentPath:Me}),m.jsx(jxe,{isOpen:xe,onOpenChange:Pe,commitPath:Ne,commitMessage:ke,setCommitMessage:Fe,isCommitting:Qe,onSubmitCommit:Gt})]})});oA.displayName="FileManager";const Oxe=({vfsKey:e,selectedItemType:t})=>e==="orphan"?m.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[m.jsx(vI,{className:"h-4 w-4"}),m.jsxs("span",{children:[m.jsx("b",{children:"Shared VFS:"})," All chats ",m.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?m.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[m.jsx(vI,{className:"h-4 w-4"}),m.jsxs("span",{children:[m.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?m.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[m.jsx(s0,{className:"h-4 w-4"}),m.jsxs("span",{children:[m.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null;function Dxe(){const e=Dr.getState().registerPromptControl,t=Dr.getState().registerChatControl,n=tu.getState().addAttachedFile,r=()=>{const{toggleVfsModal:i,isVfsModalOpen:s}=pa(dn(p=>({toggleVfsModal:p.toggleVfsModal,isVfsModalOpen:p.isVfsModalOpen}))),{enableVfs:o,selectedFileIds:l,nodes:u,clearSelection:d}=Xs(dn(p=>({enableVfs:p.enableVfs,selectedFileIds:p.selectedFileIds,nodes:p.nodes,clearSelection:p.clearSelection}))),h=()=>{if(l.size===0){tt.info("No files selected in VFS to attach.");return}let p=0;l.forEach(y=>{const v=u[y];v&&v.type==="file"&&(n({source:"vfs",name:v.name,type:v.mimeType||"application/octet-stream",size:v.size,path:v.path}),p++)}),p>0&&(tt.success(`Attached ${p} file(s) from VFS to the next prompt.`),d(),i(!1))};return o?m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:"ghost",size:"icon",className:Nt("h-8 w-8",s&&"bg-muted text-primary"),onClick:()=>i(),"aria-label":"Toggle Virtual File System",children:m.jsx(k6,{className:"h-4 w-4"})})}),m.jsx(Jn,{side:"top",children:"Virtual Filesystem"})]})}),l.size>0&&m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsxs(Mt,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:h,"aria-label":`Attach ${l.size} selected VFS file(s)`,children:[m.jsx(m2,{className:"h-4 w-4 mr-1"}),"Attach (",l.size,")"]})}),m.jsx(Jn,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null},a=()=>{const{isVfsModalOpen:i,toggleVfsModal:s}=pa(dn(y=>({isVfsModalOpen:y.isVfsModalOpen,toggleVfsModal:y.toggleVfsModal}))),{vfsKey:o,selectedFileIds:l,clearSelection:u}=Xs(dn(y=>({vfsKey:y.vfsKey,selectedFileIds:y.selectedFileIds,clearSelection:y.clearSelection}))),d=mn(y=>y.selectedItemType),h=()=>{s(!1)},p=()=>{u(),s(!1)};return m.jsx(zx,{open:i,onOpenChange:p,children:m.jsxs(Ux,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[m.jsxs(qx,{className:"p-4 pb-2 border-b flex-shrink-0",children:[m.jsx(Vx,{children:"Virtual Filesystem"}),m.jsx(Gx,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),m.jsx(Oxe,{vfsKey:o,selectedItemType:d})]}),m.jsx("div",{className:"flex-grow overflow-hidden",children:m.jsx(oA,{})}),m.jsxs(Hx,{className:"p-4 pt-2 border-t flex-shrink-0",children:[m.jsx(Mt,{variant:"outline",onClick:p,children:"Close"}),m.jsxs(Mt,{onClick:h,disabled:l.size===0,children:[m.jsx(m2,{className:"h-4 w-4 mr-2"}),"Attach Selected (",l.size,")"]})]})]})})};e({id:"core-vfs-prompt-trigger",show:()=>Xs.getState().enableVfs,triggerRenderer:()=>gt.createElement(r),getParameters:void 0,getMetadata:void 0,clearOnSubmit:void 0}),t({id:"core-vfs-modal-panel",panel:void 0,show:()=>pa.getState().isVfsModalOpen,renderer:()=>gt.createElement(a),status:()=>"ready"}),console.log("[Function] Registered Core VFS Control (Prompt Trigger & Modal)")}const Mxe=()=>{const{linkConversationToRepo:e,syncConversation:t}=mn(dn(L=>({linkConversationToRepo:L.linkConversationToRepo,syncConversation:L.syncConversation}))),[n,r]=T.useState(()=>mn.getState().selectedItemId),[a,i]=T.useState(()=>mn.getState().selectedItemType),[s,o]=T.useState(()=>mn.getState().syncRepos),[l,u]=T.useState(()=>mn.getState().conversationSyncStatus),[d,h]=T.useState(()=>Zn.getState().status==="streaming"),[p,y]=T.useState(null),[v,b]=T.useState("idle"),[w,x]=T.useState(!1),[S,E]=T.useState(!1);T.useEffect(()=>{const L=re=>{r(re.selectedItemId),i(re.selectedItemType)},X=()=>{o(mn.getState().syncRepos)},F=re=>{u(Y=>({...Y,[re.conversationId]:re.status}))},K=re=>{h(re.status==="streaming")},q=re=>{re.conversationId===n&&re.updates.syncRepoId!==void 0&&y(re.updates.syncRepoId)},de=mn.getState();return r(de.selectedItemId),i(de.selectedItemType),o(de.syncRepos),u(de.conversationSyncStatus),St.on(_t.CONTEXT_CHANGED,L),St.on(_t.SYNC_REPO_CHANGED,X),St.on(_t.CONVERSATION_SYNC_STATUS_CHANGED,F),St.on(_t.INTERACTION_STATUS_CHANGED,K),St.on(_t.CONVERSATION_UPDATED,q),()=>{St.off(_t.CONTEXT_CHANGED,L),St.off(_t.SYNC_REPO_CHANGED,X),St.off(_t.CONVERSATION_SYNC_STATUS_CHANGED,F),St.off(_t.INTERACTION_STATUS_CHANGED,K),St.off(_t.CONVERSATION_UPDATED,q)}},[n]),T.useEffect(()=>{if(a==="conversation"&&n){const L=mn.getState().getConversationById(n);y((L==null?void 0:L.syncRepoId)??null),b(l[n]??"idle")}else y(null),b("idle")},[n,a,l]);const C=gt.useMemo(()=>new Map(s.map(L=>[L.id,L.name])),[s]),k=p?C.get(p):void 0,R=T.useCallback(async L=>{if(!n||a!=="conversation")return;x(!0),await e(n,L==="none"?null:L),x(!1)},[n,a,e]),O=T.useCallback(async()=>{!n||!p||(E(!0),await t(n),E(!1))},[n,p,t]),j=U$(v,k),$=!p||S||w||d||v==="syncing";return a!=="conversation"||s.length===0?null:m.jsxs(Lu,{children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx($u,{asChild:!0,children:m.jsx(Mt,{variant:p?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:d||w||S,"aria-label":"Configure Git Sync",children:v==="syncing"||S||w?m.jsx(zn,{className:"h-4 w-4 animate-spin"}):m.jsx(eg,{className:"h-4 w-4"})})})}),m.jsx(Jn,{side:"top",children:p?`Sync Status: ${v}`:"Link to Sync Repo"})]})}),m.jsxs(Bu,{className:"w-64 p-4 space-y-3",align:"start",children:[m.jsx(en,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),m.jsxs(Iu,{value:p??"none",onValueChange:R,disabled:w||S||d,children:[m.jsx(Ou,{id:"sync-repo-select",className:"w-full h-9",children:m.jsx(ju,{placeholder:"Select repository..."})}),m.jsxs(Du,{children:[m.jsx(Za,{value:"none",children:m.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(L=>m.jsx(Za,{value:L.id,children:L.name},L.id))]})]}),m.jsxs("div",{className:"flex items-center justify-between pt-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",j||"Not Linked"]}),m.jsxs(Mt,{size:"sm",variant:"outline",onClick:O,disabled:$,className:"h-8",children:[S||v==="syncing"?m.jsx(zn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(C6,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]})};function Pxe(){const e=Dr.getState().registerPromptControl;e({id:"core-git-sync",triggerRenderer:()=>gt.createElement(Mxe)}),console.log("[Function] Registered Core Git Sync Control")}const Fxe=z.object({path:z.string().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),Lxe=z.object({path:z.string().describe("The path of the file to read within the VFS."),encoding:z.enum(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),$xe=z.object({path:z.string().describe("The path where the file should be written."),content:z.string().describe("The content to write to the file."),encoding:z.enum(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),Bxe=z.object({path:z.string().describe("The path of the file or directory to delete."),recursive:z.boolean().optional().default(!1).describe("Whether to delete directories recursively.")}),zxe=z.object({path:z.string().describe("The path of the directory to create (including parents).")}),Uxe=z.object({oldPath:z.string().describe("The current path of the item to rename."),newName:z.string().describe("The new name for the item.")});function qxe(){const e=Dr.getState().registerTool;console.log("[Function] Registering Core VFS Tools..."),e("core","vfsListFiles",{description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:Fxe},async({path:o},l)=>{const u=l==null?void 0:l.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=nr(o||"/");try{const h=await lT(d,{fsInstance:u});return{success:!0,path:d,entries:h.map(p=>({name:p.name,type:p.isDirectory?"folder":"file",size:p.size,lastModified:p.lastModified.toISOString()}))}}catch(h){return{success:!1,path:d,error:h.message}}}),e("core","vfsReadFile",{description:"Read the content of a file from the VFS.",parameters:Lxe},async({path:o,encoding:l},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=nr(o);try{const p=await of(h,{fsInstance:d});let y;return l==="base64"?y=btoa(String.fromCharCode(...p)):y=new TextDecoder().decode(p),{success:!0,path:h,content:y,encoding:l}}catch(p){return{success:!1,path:h,error:p.message}}}),e("core","vfsWriteFile",{description:"Write content to a file in the VFS.",parameters:$xe},async({path:o,content:l,encoding:u},d)=>{const h=d==null?void 0:d.fsInstance;if(!h)return{success:!1,error:"Filesystem instance not available in context."};const p=nr(o);try{let y;if(u==="base64"){const v=atob(l),b=v.length,w=new Uint8Array(b);for(let x=0;x<b;x++)w[x]=v.charCodeAt(x);y=w}else y=l;return await vx(p,y,{fsInstance:h}),{success:!0,path:p}}catch(y){return{success:!1,path:p,error:y.message}}}),e("core","vfsDelete",{description:"Delete a file or directory from the VFS.",parameters:Bxe},async({path:o,recursive:l},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=nr(o);try{return await cT(h,l,{fsInstance:d}),{success:!0,path:h}}catch(p){return{success:!1,path:h,error:p.message}}}),e("core","vfsCreateDirectory",{description:"Create a directory (including parents) in the VFS.",parameters:zxe},async({path:o},l)=>{const u=l==null?void 0:l.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=nr(o);try{return await V5(d,{fsInstance:u}),{success:!0,path:d}}catch(h){return{success:!1,path:d,error:h.message}}}),e("core","vfsRename",{description:"Rename a file or directory in the VFS.",parameters:Uxe},async({oldPath:o,newName:l},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=nr(o),p=nr(h.substring(0,h.lastIndexOf("/"))||"/"),y=Ko(p,l);try{return await W5(h,y,{fsInstance:d}),{success:!0,oldPath:h,newPath:y}}catch(v){return{success:!1,oldPath:h,newName:l,error:v.message}}}),console.log("[Function] Core VFS Tools Registered.")}const Hxe=z.object({path:z.string().describe("The directory path within the VFS to initialize as a Git repository.")}),Vxe=z.object({path:z.string().describe("The directory path of the Git repository within the VFS to commit."),message:z.string().describe("The commit message.")}),Gxe=z.object({path:z.string().describe("The directory path of the Git repository within the VFS to pull from."),branch:z.string().optional().describe("The branch name to pull.")}),Wxe=z.object({path:z.string().describe("The directory path of the Git repository within the VFS to push."),branch:z.string().optional().describe("The branch name to push.")}),Kxe=z.object({path:z.string().describe("The directory path of the Git repository within the VFS to check status.")});function Zxe(){const e=Dr.getState().registerTool;console.log("[Function] Registering Core Git Tools..."),e("core","gitInit",{description:"Initialize an empty Git repository in a VFS directory.",parameters:Hxe},async({path:s},o)=>{const l=o==null?void 0:o.fsInstance;if(!l)return{success:!1,error:"Filesystem instance not available in context."};try{return await q5(s,{fsInstance:l}),{success:!0,message:`Repository initialized at ${s}`}}catch(u){return{success:!1,error:u.message}}}),e("core","gitCommit",{description:"Stage all changes and commit them in a VFS Git repository.",parameters:Vxe},async({path:s,message:o},l)=>{const u=l==null?void 0:l.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=qr.getState();if(!d.gitUserName||!d.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await sT(s,o,{fsInstance:u}),{success:!0,message:`Changes committed in ${s}`}}catch(h){return{success:!1,error:h.message}}}),e("core","gitPull",{description:"Pull changes from the remote repository for the specified branch.",parameters:Gxe},async({path:s,branch:o},l)=>{const u=l==null?void 0:l.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await bx(s,o||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${s}`}}catch(d){return{success:!1,error:d.message}}}),e("core","gitPush",{description:"Push committed changes from the local branch to the remote repository.",parameters:Wxe},async({path:s,branch:o},l)=>{const u=l==null?void 0:l.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await oT(s,o||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${s}`}}catch(d){return{success:!1,error:d.message}}}),e("core","gitStatus",{description:"Get the Git status for a VFS repository.",parameters:Kxe},async({path:s},o)=>{const l=o==null?void 0:o.fsInstance;if(!l)return{success:!1,error:"Filesystem instance not available in context."};try{return await H5(s,{fsInstance:l}),{success:!0,message:`Status checked for ${s}`}}catch(u){return{success:!1,error:u.message}}}),console.log("[Function] Core Git Tools Registered.")}const Yxe=({className:e,enabledTools:t,setEnabledTools:n,localMaxSteps:r,setLocalMaxSteps:a,conversationId:i,conversationType:s})=>{const o=Dr(S=>S.tools),l=qr(S=>S.toolMaxSteps),[u,d]=T.useState(""),h=T.useMemo(()=>Object.entries(o).map(([S,{definition:E,modId:C}])=>({name:S,description:E.description??"No description provided.",modId:C})).sort((S,E)=>S.name.localeCompare(E.name)),[o]),p=T.useMemo(()=>{const S=u.trim().toLowerCase();return S?h.filter(E=>E.name.toLowerCase().includes(S)||E.description.toLowerCase().includes(S)||E.modId.toLowerCase().includes(S)):h},[h,u]),y=T.useCallback((S,E)=>{n(C=>{const k=new Set(C);return E?k.add(S):k.delete(S),k})},[n]),v=T.useCallback(S=>{n(()=>S?new Set(h.map(E=>E.name)):new Set)},[h,n]),b=S=>{const E=S.target.value;if(E===""){a(null);return}const C=parseInt(E,10);if(isNaN(C))a(null);else{const k=Math.max(1,Math.min(20,C));a(k)}},w=r===null?"":String(r),x=s!=="conversation"||!i;return m.jsxs("div",{className:Nt("p-4 h-[28rem] max-w-2xl space-y-3",e),children:[m.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),m.jsxs("div",{className:"relative",children:[m.jsx(Nd,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(qn,{type:"search",placeholder:"Filter tools...",value:u,onChange:S=>d(S.target.value),className:"pl-8 h-9",disabled:x})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs(en,{className:"text-xs text-muted-foreground",children:[p.length," tools shown (",t.size," enabled)"]}),m.jsxs("div",{className:"space-x-2",children:[m.jsx(Mt,{variant:"outline",size:"sm",onClick:()=>v(!0),disabled:x||h.length===0,children:"Enable All"}),m.jsx(Mt,{variant:"outline",size:"sm",onClick:()=>v(!1),disabled:x||h.length===0||t.size===0,children:"Disable All"})]})]}),m.jsx(Yl,{className:"h-56 border rounded-md p-2 bg-background/50",children:x?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Select a conversation to manage tools."}):h.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):p.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):m.jsx("div",{className:"space-y-1",children:p.map(S=>m.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[m.jsx(Gs,{id:`tool-switch-${S.name}`,checked:t.has(S.name),onCheckedChange:E=>y(S.name,E),className:"flex-shrink-0",disabled:x}),m.jsxs(en,{htmlFor:`tool-switch-${S.name}`,className:Nt("text-sm font-normal flex-grow pl-2 space-y-0.5",x?"cursor-not-allowed":"cursor-pointer"),title:`${S.name} (from ${S.modId})`,children:[m.jsx("span",{className:"block font-medium",children:S.name}),m.jsx("span",{className:"block text-xs text-muted-foreground break-words",children:S.description})]})]},S.name))})}),m.jsxs("div",{className:"pt-2",children:[m.jsx(en,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),m.jsx(qn,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:w,onChange:b,className:"w-20 h-8 text-xs mt-1",placeholder:String(l??5),disabled:x}),m.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})};let Xc=new Set,Ml=null,Gm=()=>{};const Xxe=()=>{const[e,t]=T.useState({enabledTools:Xc,maxStepsOverride:Ml}),[n,r]=T.useState(e.maxStepsOverride),[a,i]=T.useState(!1),[s,o]=T.useState(()=>Zn.getState().status==="streaming"),[l,u]=T.useState(!0),[d,h]=T.useState(()=>mn.getState().selectedItemType),[p,y]=T.useState(()=>mn.getState().selectedItemId),v=Object.keys(Dr.getState().tools).length;T.useEffect(()=>(Gm=E=>{const C=E({enabledTools:Xc,maxStepsOverride:Ml});Xc=C.enabledTools,Ml=C.maxStepsOverride,t(C)},t({enabledTools:Xc,maxStepsOverride:Ml}),()=>{Gm=()=>{}}),[]),T.useEffect(()=>{r(e.maxStepsOverride)},[e.maxStepsOverride]),T.useEffect(()=>{const E=R=>{o(R.status==="streaming")},C=R=>{var L,X;if(!R.modelId){u(!1);return}const{getSelectedModel:O}=Fn.getState(),j=O(),$=Object.keys(Dr.getState().tools).length>0;u($&&(((X=(L=j==null?void 0:j.metadata)==null?void 0:L.supported_parameters)==null?void 0:X.includes("tools"))??!1))},k=R=>{h(R.selectedItemType),y(R.selectedItemId)};return C({modelId:Fn.getState().selectedModelId}),k({selectedItemId:mn.getState().selectedItemId,selectedItemType:mn.getState().selectedItemType}),St.on(_t.INTERACTION_STATUS_CHANGED,E),St.on(_t.MODEL_SELECTION_CHANGED,C),St.on(_t.CONTEXT_CHANGED,k),()=>{St.off(_t.INTERACTION_STATUS_CHANGED,E),St.off(_t.MODEL_SELECTION_CHANGED,C),St.off(_t.CONTEXT_CHANGED,k)}},[]);const b=E=>{i(E),!E&&n!==e.maxStepsOverride&&Gm(C=>({...C,maxStepsOverride:n}))},w=T.useCallback(E=>{Gm(C=>({...C,enabledTools:E(C.enabledTools)}))},[]),x=e.enabledTools.size>0||e.maxStepsOverride!==null,S=s||v===0||d!=="conversation";return l?m.jsxs(Lu,{open:a,onOpenChange:b,children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx($u,{asChild:!0,children:m.jsx(Mt,{variant:x?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:S,"aria-label":"Configure Tools",children:m.jsx($H,{className:"h-4 w-4"})})})}),m.jsx(Jn,{side:"top",children:S?"Tools unavailable (select conversation)":`Tools (${e.enabledTools.size} enabled)`})]})}),m.jsx(Bu,{className:"w-auto p-0",align:"start",children:m.jsx(Yxe,{enabledTools:e.enabledTools,setEnabledTools:w,localMaxSteps:n,setLocalMaxSteps:r,conversationId:p,conversationType:d})})]}):null};function Jxe(){const e=Dr.getState().registerPromptControl;Xc=new Set,Ml=null,e({id:"core-tool-selector",triggerRenderer:()=>gt.createElement(Xxe),getMetadata:()=>{if(Xc.size>0||Ml!==null)return{enabledTools:Array.from(Xc),...Ml!==null&&{maxSteps:Ml}}},clearOnSubmit:()=>{Xc=new Set,Ml=null,Gm(()=>({enabledTools:new Set,maxStepsOverride:null}))}}),console.log("[Function] Registered Core Tool Selector Control")}const lA=gt.memo(({value:e,onChange:t,disabled:n=!1,className:r})=>{const[a,i]=T.useState(!1),[s,o]=T.useState(""),{dbProviderConfigs:l,globalModelSortOrder:u,isLoading:d}=Fn(dn(b=>({dbProviderConfigs:b.dbProviderConfigs,globalModelSortOrder:b.globalModelSortOrder,isLoading:b.isLoading}))),h=T.useMemo(()=>{const b=new Map,w=new Set;l.forEach(E=>{if(!E.isEnabled||!E.enabledModels)return;const C=E.fetchedModels??(E.type?Fn.getState().getAllAvailableModelDefsForProvider(E.id):[]),k=new Map(C.map(R=>[R.id,R]));E.enabledModels.forEach(R=>{const O=Wc(E.id,R),j=k.get(R);j&&(w.add(O),b.set(O,{name:j.name||R,providerName:E.name}))})});const x=[],S=new Set;return u.forEach(E=>{if(w.has(E)){const C=b.get(E);C&&!S.has(E)&&(x.push({id:E,...C}),S.add(E))}}),w.forEach(E=>{if(!S.has(E)){const C=b.get(E);C&&x.push({id:E,...C})}}),x},[l,u]),p=T.useMemo(()=>{if(!s.trim())return h;const b=s.toLowerCase();return h.filter(w=>w.name.toLowerCase().includes(b)||w.providerName.toLowerCase().includes(b)||w.id.toLowerCase().includes(b))},[h,s]),y=T.useMemo(()=>h.find(b=>b.id===e),[h,e]),v=T.useCallback(b=>{t(b===e?null:b),i(!1),o("")},[t,e]);return d?m.jsx(ur,{className:Nt("h-9 w-[250px]",r)}):m.jsxs(Lu,{open:a,onOpenChange:i,children:[m.jsx($u,{asChild:!0,children:m.jsxs(Mt,{variant:"outline",role:"combobox","aria-expanded":a,disabled:n||h.length===0,className:Nt("w-auto justify-between h-9 text-sm font-normal",r),children:[m.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:y?`${y.name} (${y.providerName})`:"Select Model..."}),m.jsx(kw,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),m.jsx(Bu,{className:"w-[--radix-popover-trigger-width] max-h-[--radix-popover-content-available-height] p-0",children:m.jsxs(SB,{shouldFilter:!1,children:[" ",m.jsx(EB,{placeholder:"Search model...",value:s,onValueChange:o}),m.jsxs(CB,{children:[m.jsx(kB,{children:"No model found."}),m.jsx(TB,{children:p.map(b=>m.jsxs(AB,{value:b.id,onSelect:v,children:[m.jsx(so,{className:Nt("mr-2 h-4 w-4",e===b.id?"opacity-100":"opacity-0")}),m.jsxs("span",{className:"truncate",children:[b.name," (",b.providerName,")"]})]},b.id))})]})]})})]})});lA.displayName="GlobalModelSelector";const Qxe=({systemPrompt:e,setSystemPrompt:t,modelId:n,setModelId:r,effectiveSystemPrompt:a,effectiveModelId:i,isSaving:s})=>m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx(en,{htmlFor:"project-system-prompt",children:"System Prompt (Overrides Parent/Global)"}),m.jsx(Mu,{id:"project-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,100))||"Default"}${a&&a.length>100?"...":""}`,value:e??"",onChange:o=>t(o.target.value||null),rows:6,disabled:s,className:"mt-1"}),m.jsx(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>t(null),disabled:s||e===null,children:"Use Inherited/Default"})]}),m.jsxs("div",{children:[m.jsx(en,{children:"Default Model (Overrides Parent/Global)"}),m.jsx(lA,{value:n??i,onChange:r,disabled:s}),m.jsx(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>r(null),disabled:s||n===null,children:"Use Inherited/Default"})]})]}),e1e=({temperature:e,setTemperature:t,maxTokens:n,setMaxTokens:r,topP:a,setTopP:i,topK:s,setTopK:o,presencePenalty:l,setPresencePenalty:u,frequencyPenalty:d,setFrequencyPenalty:h,localTemp:p,setLocalTemp:y,localTopP:v,setLocalTopP:b,localPresence:w,setLocalPresence:x,localFrequency:S,setLocalFrequency:E,effectiveTemperature:C,effectiveMaxTokens:k,effectiveTopP:R,effectiveTopK:O,effectivePresencePenalty:j,effectiveFrequencyPenalty:$,isSaving:L})=>{const X=T.useCallback((K,q)=>{const de=q.target.value,re=de===""?null:parseInt(de,10);(de===""||!isNaN(re)&&re!==null)&&K(re)},[]),F=T.useCallback((K,q)=>{K(q[0])},[]);return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(en,{htmlFor:"project-temperature",className:"text-xs",children:["Temperature (",p.toFixed(2),")"]}),m.jsx(Fl,{id:"project-temperature",min:0,max:1,step:.01,value:[p],onValueChange:K=>y(K[0]),onValueCommit:K=>F(t,K),disabled:L}),m.jsxs(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>t(null),disabled:L||e===null,children:["Use Inherited/Default (",(C==null?void 0:C.toFixed(2))??"N/A",")"]})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(en,{htmlFor:"project-top-p",className:"text-xs",children:["Top P (",v.toFixed(2),")"]}),m.jsx(Fl,{id:"project-top-p",min:0,max:1,step:.01,value:[v],onValueChange:K=>b(K[0]),onValueCommit:K=>F(i,K),disabled:L}),m.jsxs(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>i(null),disabled:L||a===null,children:["Use Inherited/Default (",(R==null?void 0:R.toFixed(2))??"N/A",")"]})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"project-max-tokens",className:"text-xs",children:"Max Tokens"}),m.jsx(qn,{id:"project-max-tokens",type:"number",placeholder:`Inherited: ${k??"Default"}`,value:n??"",onChange:K=>X(r,K),min:"1",className:"h-8 text-xs",disabled:L}),m.jsx(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>r(null),disabled:L||n===null,children:"Use Inherited/Default"})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(en,{htmlFor:"project-top-k",className:"text-xs",children:"Top K"}),m.jsx(qn,{id:"project-top-k",type:"number",placeholder:`Inherited: ${O??"Default"}`,value:s??"",onChange:K=>X(o,K),min:"1",className:"h-8 text-xs",disabled:L}),m.jsx(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>o(null),disabled:L||s===null,children:"Use Inherited/Default"})]})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(en,{htmlFor:"project-presence-penalty",className:"text-xs",children:["Presence Penalty (",w.toFixed(2),")"]}),m.jsx(Fl,{id:"project-presence-penalty",min:-2,max:2,step:.01,value:[w],onValueChange:K=>x(K[0]),onValueCommit:K=>F(u,K),disabled:L}),m.jsxs(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>u(null),disabled:L||l===null,children:["Use Inherited/Default (",(j==null?void 0:j.toFixed(2))??"N/A",")"]})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(en,{htmlFor:"project-frequency-penalty",className:"text-xs",children:["Frequency Penalty (",S.toFixed(2),")"]}),m.jsx(Fl,{id:"project-frequency-penalty",min:-2,max:2,step:.01,value:[S],onValueChange:K=>E(K[0]),onValueCommit:K=>F(h,K),disabled:L}),m.jsxs(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>h(null),disabled:L||d===null,children:["Use Inherited/Default (",($==null?void 0:$.toFixed(2))??"N/A",")"]})]})]})},t1e=({syncRepoId:e,setSyncRepoId:t,effectiveSyncRepoId:n,syncRepos:r,isSaving:a})=>{var s;const i=((s=r.find(o=>o.id===n))==null?void 0:s.name)??"None";return m.jsx("div",{className:"space-y-4",children:m.jsxs("div",{children:[m.jsx(en,{htmlFor:"project-sync-repo",children:"Sync Repository (Overrides Parent/Global)"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),m.jsxs(Iu,{value:e??"none",onValueChange:o=>t(o==="none"?null:o),disabled:a||r.length===0,children:[m.jsx(Ou,{id:"project-sync-repo",children:m.jsx(ju,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${i}`})}),m.jsxs(Du,{children:[m.jsx(Za,{value:"none",children:m.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",i,")"]})}),r.map(o=>m.jsx(Za,{value:o.id,children:o.name},o.id))]})]}),m.jsx(Mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>t(null),disabled:a||e===null,children:"Use Inherited/Default"})]})})},n1e=({projectId:e,projectName:t,isSaving:n})=>{const r=()=>{tt.info(`VFS clearing for project "${t}" is not yet implemented.`)},a=T.useMemo(()=>[{value:"manage",label:"Manage Files",content:m.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?m.jsx(oA,{}):m.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings & Danger Zone",content:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx(en,{children:"Project Filesystem Info"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),m.jsx("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2",children:m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",m.jsx("code",{className:"text-xs",children:e||"N/A"})]})})]}),m.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[m.jsx(en,{className:"text-destructive",children:"Danger Zone"}),m.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."}),m.jsxs(Mt,{variant:"destructive",size:"sm",onClick:r,disabled:n||!e,children:[m.jsx(Ad,{className:"h-4 w-4 mr-1"}),"Clear Project VFS (Not Implemented)"]})]})]})}],[e,t,n]);return m.jsx(Pu,{tabs:a,defaultValue:"manage",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-3 flex-grow flex flex-col"})},r1e=({isOpen:e,onClose:t,projectId:n})=>{const{getProjectById:r,updateProject:a}=ii(dn(Fe=>({getProjectById:Fe.getProjectById,updateProject:Fe.updateProject}))),i=ii(Fe=>Fe.getEffectiveProjectSettings),s=mn(Fe=>Fe.syncRepos),o=qr(dn(Fe=>({globalSystemPrompt:Fe.globalSystemPrompt,temperature:Fe.temperature,maxTokens:Fe.maxTokens,topP:Fe.topP,topK:Fe.topK,presencePenalty:Fe.presencePenalty,frequencyPenalty:Fe.frequencyPenalty}))),l=Fn(Fe=>Fe.selectedModelId),u=Xs(Fe=>Fe.setVfsKey),[d,h]=T.useState(null),[p,y]=T.useState(null),[v,b]=T.useState(null),[w,x]=T.useState(null),[S,E]=T.useState(null),[C,k]=T.useState(null),[R,O]=T.useState(null),[j,$]=T.useState(null),[L,X]=T.useState(null),[F,K]=T.useState(.7),[q,de]=T.useState(1),[re,Y]=T.useState(0),[Q,ae]=T.useState(0),[B,J]=T.useState(!1),[ee,oe]=T.useState("prompt"),{project:me,effectiveSettings:xe}=T.useMemo(()=>{const Fe=n?r(n):null,Qe=n?i(n):null;return{project:Fe,effectiveSettings:Qe}},[n,r,i]),Pe=T.useCallback(Fe=>{var Le;if(!Fe)return null;const Qe=r(Fe);return Qe?((Le=Qe.metadata)==null?void 0:Le.syncRepoId)!==void 0?Qe.metadata.syncRepoId:Pe(Qe.parentId):null},[r]),Ne=n?Pe(n):null;T.useEffect(()=>{var Fe;e&&n&&me&&xe?(u(n),h(me.systemPrompt??null),y(me.modelId??null),b(me.temperature??null),x(me.maxTokens??null),E(me.topP??null),k(me.topK??null),O(me.presencePenalty??null),$(me.frequencyPenalty??null),X(((Fe=me.metadata)==null?void 0:Fe.syncRepoId)??null),K(xe.temperature??o.temperature),de(xe.topP??o.topP??1),Y(xe.presencePenalty??o.presencePenalty??0),ae(xe.frequencyPenalty??o.frequencyPenalty??0),oe("prompt")):e||(u(null),h(null),y(null),b(null),x(null),E(null),k(null),O(null),$(null),X(null))},[e,n,me,xe,o,u]),T.useEffect(()=>K(v??(xe==null?void 0:xe.temperature)??o.temperature),[v,xe,o.temperature]),T.useEffect(()=>de(S??(xe==null?void 0:xe.topP)??o.topP??1),[S,xe,o.topP]),T.useEffect(()=>Y(R??(xe==null?void 0:xe.presencePenalty)??o.presencePenalty??0),[R,xe,o.presencePenalty]),T.useEffect(()=>ae(j??(xe==null?void 0:xe.frequencyPenalty)??o.frequencyPenalty??0),[j,xe,o.frequencyPenalty]);const Re=async()=>{if(!(!n||!me)){J(!0);try{const Fe=me.parentId?i(me.parentId):{systemPrompt:o.globalSystemPrompt,modelId:l,temperature:o.temperature,maxTokens:o.maxTokens,topP:o.topP,topK:o.topK,presencePenalty:o.presencePenalty,frequencyPenalty:o.frequencyPenalty},Qe=me.parentId?Pe(me.parentId):null,Le={},Ie={...me.metadata??{}};d!==Fe.systemPrompt?Le.systemPrompt=d:Le.systemPrompt=void 0,p!==Fe.modelId?Le.modelId=p:Le.modelId=void 0,v!==Fe.temperature?Le.temperature=v:Le.temperature=void 0,w!==Fe.maxTokens?Le.maxTokens=w:Le.maxTokens=void 0,S!==Fe.topP?Le.topP=S:Le.topP=void 0,C!==Fe.topK?Le.topK=C:Le.topK=void 0,R!==Fe.presencePenalty?Le.presencePenalty=R:Le.presencePenalty=void 0,j!==Fe.frequencyPenalty?Le.frequencyPenalty=j:Le.frequencyPenalty=void 0,L!==Qe?Ie.syncRepoId=L:delete Ie.syncRepoId,Le.metadata=Ie,await a(n,Le),tt.success(`Project "${me.name}" settings updated.`),t()}catch(Fe){tt.error("Failed to save project settings."),console.error("Failed to save project settings:",Fe)}finally{J(!1)}}},ke=T.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:m.jsx(Qxe,{systemPrompt:d,setSystemPrompt:h,modelId:p,setModelId:y,effectiveSystemPrompt:(xe==null?void 0:xe.systemPrompt)??o.globalSystemPrompt,effectiveModelId:(xe==null?void 0:xe.modelId)??l,isSaving:B})},{value:"params",label:"Parameters",content:m.jsx(e1e,{temperature:v,setTemperature:b,maxTokens:w,setMaxTokens:x,topP:S,setTopP:E,topK:C,setTopK:k,presencePenalty:R,setPresencePenalty:O,frequencyPenalty:j,setFrequencyPenalty:$,localTemp:F,setLocalTemp:K,localTopP:q,setLocalTopP:de,localPresence:re,setLocalPresence:Y,localFrequency:Q,setLocalFrequency:ae,effectiveTemperature:(xe==null?void 0:xe.temperature)??o.temperature,effectiveMaxTokens:(xe==null?void 0:xe.maxTokens)??o.maxTokens,effectiveTopP:(xe==null?void 0:xe.topP)??o.topP,effectiveTopK:(xe==null?void 0:xe.topK)??o.topK,effectivePresencePenalty:(xe==null?void 0:xe.presencePenalty)??o.presencePenalty,effectiveFrequencyPenalty:(xe==null?void 0:xe.frequencyPenalty)??o.frequencyPenalty,isSaving:B})},{value:"sync",label:"Sync",content:m.jsx(t1e,{syncRepoId:L,setSyncRepoId:X,effectiveSyncRepoId:Ne,syncRepos:s,isSaving:B})},{value:"vfs",label:"Filesystem",content:m.jsx(n1e,{projectId:n,projectName:(me==null?void 0:me.name)??null,isSaving:B})}],[d,p,v,w,S,C,R,j,L,xe,o,l,B,F,q,re,Q,Ne,s,n,me==null?void 0:me.name]);return m.jsx(zx,{open:e,onOpenChange:t,children:m.jsxs(Ux,{className:"sm:max-w-[800px] w-[90vw] h-[70vh] min-h-[500px] max-h-[80vh] flex flex-col p-0",children:[m.jsxs(qx,{className:"p-6 pb-4 flex-shrink-0",children:[m.jsxs(Vx,{children:["Project Settings: ",me==null?void 0:me.name]}),m.jsx(Gx,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),m.jsx(Pu,{tabs:ke,initialValue:ee,onValueChange:oe,className:"flex-grow overflow-hidden px-6",listClassName:"-mx-6 px-6",contentContainerClassName:"pb-6 pr-2 -mr-2"}),m.jsxs(Hx,{className:"flex-shrink-0 border-t p-6 pt-4 mt-auto",children:[m.jsx(Mt,{variant:"outline",onClick:t,disabled:B,children:"Cancel"}),m.jsxs(Mt,{onClick:Re,disabled:B,children:[B&&m.jsx(zn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};function a1e(){const e=Dr.getState().registerChatControl,t=()=>{const{isProjectSettingsModalOpen:n,projectSettingsModalTargetId:r,closeProjectSettingsModal:a}=pa.getState();return m.jsx(r1e,{isOpen:n,onClose:a,projectId:r})};e({id:"core-project-settings-trigger",renderer:void 0,iconRenderer:void 0,panel:void 0,show:()=>!1,settingsRenderer:()=>gt.createElement(t),status:()=>"ready"}),console.log("[Function] Registered Core Project Settings Control")}const i1e=()=>{const{selectedModelId:e,selectModel:t}=Fn(dn(o=>({selectedModelId:o.selectedModelId,selectModel:o.selectModel}))),[n,r]=T.useState(()=>Zn.getState().status==="streaming"),[a,i]=T.useState(e);T.useEffect(()=>{const o=u=>{r(u.status==="streaming")},l=u=>{i(u.modelId)};return i(Fn.getState().selectedModelId),St.on(_t.INTERACTION_STATUS_CHANGED,o),St.on(_t.MODEL_SELECTION_CHANGED,l),()=>{St.off(_t.INTERACTION_STATUS_CHANGED,o),St.off(_t.MODEL_SELECTION_CHANGED,l)}},[]);const s=o=>{t(o)};return m.jsx(lA,{value:a,onChange:s,disabled:n})};function s1e(){const e=Dr.getState().registerPromptControl;e({id:"core-global-model-selector",status:()=>Fn.getState().isLoading?"loading":"ready",triggerRenderer:()=>gt.createElement(i1e),getParameters:void 0,getMetadata:void 0}),console.log("[Function] Registered Core Global Model Selector (Prompt)")}let Gc="",Wm=()=>{};const o1e=()=>{const[e,t]=T.useState(Gc),[n,r]=T.useState(!1),[a,i]=T.useState(null),[s,o]=T.useState(()=>Zn.getState().status==="streaming");T.useEffect(()=>(Wm=p=>{Gc=p,t(p)},t(Gc),()=>{Wm=()=>{}}),[]),T.useEffect(()=>{const p=S=>{o(S.status==="streaming")},y=(S,E)=>{var j;const{getConversationById:C}=mn.getState(),{getEffectiveProjectSettings:k}=ii.getState(),R=qr.getState().globalSystemPrompt,O=E==="project"?S:E==="conversation"?((j=C(S))==null?void 0:j.projectId)??null:null;i(k(O).systemPrompt??R)},v=S=>{y(S.selectedItemId,S.selectedItemType)},b=S=>{var k;const E=mn.getState();(E.selectedItemType==="project"?E.selectedItemId:E.selectedItemType==="conversation"?((k=E.getConversationById(E.selectedItemId))==null?void 0:k.projectId)??null:null)===S.projectId&&y(E.selectedItemId,E.selectedItemType)},w=S=>{if(S.key==="globalSystemPrompt"){const E=mn.getState();y(E.selectedItemId,E.selectedItemType)}},x=mn.getState();return y(x.selectedItemId,x.selectedItemType),St.on(_t.INTERACTION_STATUS_CHANGED,p),St.on(_t.CONTEXT_CHANGED,v),St.on(_t.PROJECT_UPDATED,b),St.on(_t.SETTINGS_CHANGED,w),()=>{St.off(_t.INTERACTION_STATUS_CHANGED,p),St.off(_t.CONTEXT_CHANGED,v),St.off(_t.PROJECT_UPDATED,b),St.off(_t.SETTINGS_CHANGED,w)}},[]);const l=T.useCallback(()=>{Wm(e.trim()),r(!1)},[e]),u=T.useCallback(()=>{Wm(""),r(!1)},[]),d=p=>{p&&t(Gc),r(p)},h=Gc.trim().length>0;return m.jsxs(Lu,{open:n,onOpenChange:d,children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx($u,{asChild:!0,children:m.jsx(Mt,{variant:h?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:s,"aria-label":"Set System Prompt for Next Turn",children:m.jsx(AH,{className:"h-4 w-4"})})})}),m.jsx(Jn,{side:"top",children:h?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),m.jsxs(Bu,{className:"w-80 p-4 space-y-3",align:"start",children:[m.jsx(en,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),m.jsx(Mu,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:e,onChange:p=>t(p.target.value),rows:5,className:"text-sm"}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx(Mt,{variant:"outline",size:"sm",onClick:u,disabled:!e.trim(),children:"Clear Override"}),m.jsx(Mt,{size:"sm",onClick:l,children:"Set for Next Turn"})]})]})]})};function l1e(){const e=Dr.getState().registerPromptControl;Gc="",e({id:"core-system-prompt",status:()=>"ready",triggerRenderer:()=>gt.createElement(o1e),getMetadata:()=>{const t=Gc.trim();return t?{turnSystemPrompt:t}:void 0},clearOnSubmit:()=>{Gc="",Wm("")}}),console.log("[Function] Registered Core System Prompt Control")}const c1e=()=>{const{structuredOutputJson:e,setStructuredOutputJson:t}=Ca(dn(x=>({structuredOutputJson:x.structuredOutputJson,setStructuredOutputJson:x.setStructuredOutputJson}))),[n,r]=T.useState(!1),[a,i]=T.useState(e??""),[s,o]=T.useState(""),[l,u]=T.useState([]),d=T.useCallback(()=>{try{JSON.parse(a),t(a.trim()||null),r(!1),tt.success("Structured output applied for next turn.")}catch{tt.error("Invalid JSON format.")}},[a,t]),h=T.useCallback(()=>{i(""),t(null),r(!1),tt.info("Structured output cleared.")},[t]),p=T.useCallback(()=>{if(!s.trim()){tt.error("Please provide a name to save to the library.");return}try{JSON.parse(a);const x={id:Date.now().toString(),name:s.trim(),json:a};u(S=>[...S,x]),o(""),tt.success(`"${x.name}" saved to library.`)}catch{tt.error("Cannot save invalid JSON to library.")}},[a,s]),y=T.useCallback(x=>{i(x.json),t(x.json),r(!1),tt.success(`Loaded "${x.name}" from library.`)},[t]),v=T.useCallback(x=>{u(S=>S.filter(E=>E.id!==x)),tt.info("Item removed from library.")},[]);T.useEffect(()=>{n&&i(e??"")},[n,e]);const b=[{value:"entry",label:"Entry",content:m.jsxs("div",{className:"space-y-3 p-1",children:[m.jsx(en,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),m.jsx(Mu,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:a,onChange:x=>i(x.target.value),rows:8,className:"font-mono text-xs"}),m.jsxs("div",{className:"flex justify-between items-end gap-2",children:[m.jsxs("div",{className:"flex-grow space-y-1",children:[m.jsx(en,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),m.jsx(qn,{id:"structured-output-name",value:s,onChange:x=>o(x.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),m.jsxs(Mt,{size:"sm",variant:"outline",onClick:p,disabled:!s.trim()||!a.trim(),className:"h-8",children:[m.jsx(Vd,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),m.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[m.jsx(Mt,{variant:"outline",size:"sm",onClick:h,disabled:!e,children:"Clear Applied Schema"}),m.jsx(Mt,{size:"sm",onClick:d,disabled:!a,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:m.jsx("div",{className:"space-y-2 p-1",children:l.length===0?m.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):l.map(x=>m.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[m.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:x.name}),m.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[m.jsx(Mt,{size:"sm",variant:"outline",onClick:()=>y(x),className:"h-7 px-2 text-xs",children:"Use"}),m.jsx(Mt,{size:"icon",variant:"ghost",onClick:()=>v(x.id),className:"h-7 w-7 text-destructive",children:m.jsx(ts,{className:"h-3.5 w-3.5"})})]})]},x.id))})}],w=!!e;return m.jsxs(Lu,{open:n,onOpenChange:r,children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx($u,{asChild:!0,children:m.jsx(Mt,{variant:w?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:m.jsx(pq,{className:"h-4 w-4"})})})}),m.jsx(Jn,{side:"top",children:w?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),m.jsx(Bu,{className:"w-[450px] p-0",align:"start",children:m.jsx(Pu,{tabs:b,defaultValue:"entry"})})]})},u1e=()=>{const[e,t]=T.useState(!0);return T.useEffect(()=>{console.log("[VisibleStructuredOutputControl] useEffect setup running.");const n=r=>{var l;if(console.log("[VisibleStructuredOutputControl] handleModelChange triggered:",r),!r.modelId){t(!1);return}const{getSelectedModel:a}=Fn.getState(),i=a(),s=(l=i==null?void 0:i.metadata)==null?void 0:l.supported_parameters,o=Array.isArray(s)&&s.includes("structured_output");console.log(`[VisibleStructuredOutputControl] Model ${r.modelId} supports structured_output: ${o}`),t(o)};return n({modelId:Fn.getState().selectedModelId}),console.log(`[VisibleStructuredOutputControl] Subscribing to ${_t.MODEL_SELECTION_CHANGED}`),St.on(_t.MODEL_SELECTION_CHANGED,n),()=>{console.log("[VisibleStructuredOutputControl] useEffect cleanup running."),St.off(_t.MODEL_SELECTION_CHANGED,n)}},[]),e?m.jsx(c1e,{}):null};function d1e(){const e=Dr.getState().registerPromptControl;e({id:"core-structured-output",status:()=>"ready",triggerRenderer:()=>gt.createElement(u1e),getParameters:()=>{const{structuredOutputJson:t}=Ca.getState();if(t)try{return{structured_output:JSON.parse(t)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{Ca.getState().setStructuredOutputJson(null)}}),console.log("[Function] Registered Core Structured Output Control")}const Cz=4,c2=e=>{let t=0;return e.forEach(n=>{var r,a,i,s;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(s=(i=(a=n.prompt)==null?void 0:a.metadata)==null?void 0:i.attachedFiles)==null||s.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/Cz)},f1e=()=>{const[e,t]=T.useState(""),[n,r]=T.useState(0),[a,i]=T.useState([]),[s,o]=T.useState(null),[l,u]=T.useState(0);T.useEffect(()=>{const b=tu.getState(),w=Fn.getState(),x=Zn.getState();if(i(b.attachedFilesMetadata),o(w.selectedModelId),x.currentConversationId){const O=x.interactions.filter(j=>j.status==="COMPLETED");r(c2(O))}else r(0);const S=O=>{t(O.value)},E=O=>{i(O.files)},C=O=>{console.log(O),o(O.modelId)},k=()=>{const O=Zn.getState();if(O.currentConversationId){const j=O.interactions.filter($=>$.status==="COMPLETED");r(c2(j))}},R=()=>{const O=Zn.getState();if(O.currentConversationId){const j=O.interactions.filter($=>$.status==="COMPLETED");r(c2(j))}else r(0)};return St.on(_t.PROMPT_INPUT_CHANGE,S),St.on(_t.ATTACHED_FILES_CHANGED,E),St.on(_t.MODEL_SELECTION_CHANGED,C),St.on(_t.INTERACTION_COMPLETED,k),St.on(_t.CONTEXT_CHANGED,R),()=>{St.off(_t.PROMPT_INPUT_CHANGE,S),St.off(_t.ATTACHED_FILES_CHANGED,E),St.off(_t.MODEL_SELECTION_CHANGED,C),St.off(_t.INTERACTION_COMPLETED,k),St.off(_t.CONTEXT_CHANGED,R)}},[]),T.useEffect(()=>{var j;if(!s){u(0);return}const{dbProviderConfigs:b,dbApiKeys:w}=Fn.getState(),{providerId:x,modelId:S}=Ql(s);if(!x||!S){u(0);return}const E=b.find($=>$.id===x);if(!E){u(0);return}const C=w.find($=>$.id===E.apiKeyId),k=ak(E,S,C==null?void 0:C.value),R=k==null?void 0:k.metadata,O=((j=R==null?void 0:R.top_provider)==null?void 0:j.context_length)??(R==null?void 0:R.context_length)??0;u(O)},[s]);const{estimatedInputTokens:d,totalEstimatedTokens:h,contextPercentage:p}=T.useMemo(()=>{const b=new TextEncoder().encode(e).length,w=a.reduce((C,k)=>C+k.size,0),x=Math.ceil((b+w)/Cz),S=n+x,E=l?Math.min(100,Math.round(S/l*100)):0;return{estimatedInputTokens:x,totalEstimatedTokens:S,contextPercentage:E}},[e,a,n,l]),y=T.useMemo(()=>p>85?"text-red-600 dark:text-red-500":p>70?"text-orange-500 dark:text-orange-400":p>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[p]);if(!s||l===0)return null;const v=`Context: ~${h.toLocaleString()} / ${l.toLocaleString()} tokens (${p}%) [History: ${n}, Input: ${d}]`;return m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:m.jsx(S6,{className:Nt("h-3 w-3 fill-current",y)})})}),m.jsx(Jn,{side:"top",children:v})]})})};function h1e(){const e=Dr.getState().registerPromptControl;e({id:"core-usage-display",status:()=>"ready",triggerRenderer:()=>gt.createElement(f1e),renderer:void 0}),console.log("[Function] Registered Core Usage Display Control (Trigger)")}const p1e=()=>{const{setReasoningEnabled:e}=Ca(dn(u=>({setReasoningEnabled:u.setReasoningEnabled}))),[t,n]=T.useState(()=>Ca.getState().reasoningEnabled),[r,a]=T.useState(()=>Zn.getState().status==="streaming"),[i,s]=T.useState(!0);T.useEffect(()=>{const u=p=>{p.params.reasoningEnabled!==void 0&&n(p.params.reasoningEnabled)},d=p=>{a(p.status==="streaming")},h=p=>{var b,w;if(!p.modelId){s(!1);return}const{getSelectedModel:y}=Fn.getState(),v=y();s(((w=(b=v==null?void 0:v.metadata)==null?void 0:b.supported_parameters)==null?void 0:w.includes("reasoning"))??!1)};return h({modelId:Fn.getState().selectedModelId}),St.on(_t.PROMPT_PARAMS_CHANGED,u),St.on(_t.INTERACTION_STATUS_CHANGED,d),St.on(_t.MODEL_SELECTION_CHANGED,h),()=>{St.off(_t.PROMPT_PARAMS_CHANGED,u),St.off(_t.INTERACTION_STATUS_CHANGED,d),St.off(_t.MODEL_SELECTION_CHANGED,h)}},[]);const o=t===!0,l=()=>{e(o?null:!0)};return i?m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:l,disabled:r,"aria-label":o?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:m.jsx(x6,{className:Nt("h-4 w-4",o?"text-primary":"text-muted-foreground")})})}),m.jsx(Jn,{side:"top",children:o?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};function m1e(){const e=Dr.getState().registerPromptControl;e({id:"core-reasoning",status:()=>"ready",triggerRenderer:()=>gt.createElement(p1e),getParameters:()=>{const{reasoningEnabled:t}=Ca.getState();return t===!0?{reasoning:!0}:void 0},clearOnSubmit:()=>{Ca.getState().setReasoningEnabled(null)}}),console.log("[Function] Registered Core Reasoning Control")}const g1e=()=>{const{setWebSearchEnabled:e}=Ca(dn(u=>({setWebSearchEnabled:u.setWebSearchEnabled}))),[t,n]=T.useState(()=>Ca.getState().webSearchEnabled),[r,a]=T.useState(()=>Zn.getState().status==="streaming"),[i,s]=T.useState(!0);T.useEffect(()=>{const u=p=>{p.params.webSearchEnabled!==void 0&&n(p.params.webSearchEnabled)},d=p=>{a(p.status==="streaming")},h=p=>{var w;if(!p.modelId){s(!1);return}const{getSelectedModel:y}=Fn.getState(),v=y(),b=((w=v==null?void 0:v.metadata)==null?void 0:w.supported_parameters)??[];s(b.includes("web_search")||b.includes("web_search_options"))};return h({modelId:Fn.getState().selectedModelId}),St.on(_t.PROMPT_PARAMS_CHANGED,u),St.on(_t.INTERACTION_STATUS_CHANGED,d),St.on(_t.MODEL_SELECTION_CHANGED,h),()=>{St.off(_t.PROMPT_PARAMS_CHANGED,u),St.off(_t.INTERACTION_STATUS_CHANGED,d),St.off(_t.MODEL_SELECTION_CHANGED,h)}},[]);const o=t===!0,l=()=>{e(o?null:!0)};return i?m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx(Mt,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:l,disabled:r,"aria-label":o?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:m.jsx(Nd,{className:Nt("h-4 w-4",o?"text-primary":"text-muted-foreground")})})}),m.jsx(Jn,{side:"top",children:o?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};function y1e(){const e=Dr.getState().registerPromptControl;e({id:"core-web-search",status:()=>"ready",triggerRenderer:()=>gt.createElement(g1e),getParameters:()=>{const{webSearchEnabled:t}=Ca.getState();return t===!0?{web_search:!0}:void 0},clearOnSubmit:()=>{Ca.getState().setWebSearchEnabled(null)}}),console.log("[Function] Registered Core Web Search Control")}const b1e=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r})=>{const{rules:a,tags:i,getRulesForTag:s}=Xl(dn(S=>({rules:S.rules,tags:S.tags,getRulesForTag:S.getRulesForTag}))),[o,l]=T.useState(""),[u,d]=T.useState(""),h=T.useMemo(()=>{const S=o.toLowerCase();return S?i.filter(E=>{var C;return E.name.toLowerCase().includes(S)||((C=E.description)==null?void 0:C.toLowerCase().includes(S))}):i},[i,o]),p=T.useMemo(()=>{const S=u.toLowerCase();return S?a.filter(E=>E.name.toLowerCase().includes(S)||E.content.toLowerCase().includes(S)||E.type.toLowerCase().includes(S)):a},[a,u]),y=T.useCallback((S,E)=>{n(S,E)},[n]),v=T.useCallback((S,E)=>{r(S,E)},[r]),b=()=>m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"relative",children:[m.jsx(Nd,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(qn,{type:"search",placeholder:"Filter tags...",value:o,onChange:S=>l(S.target.value),className:"pl-8 h-9"})]}),m.jsx(Yl,{className:"h-64 border rounded-md p-2 bg-background/50",children:h.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No tags defined.":"No tags match filter."}):m.jsx("div",{className:"space-y-1",children:h.map(S=>{const E=s(S.id);return m.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:m.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[m.jsx(MC,{id:`tag-activate-${S.id}`,checked:e.has(S.id),onCheckedChange:C=>y(S.id,!!C),className:"mt-0.5"}),m.jsxs(en,{htmlFor:`tag-activate-${S.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[m.jsx("span",{className:"block font-medium",children:S.name}),S.description&&m.jsx("span",{className:"block text-xs text-muted-foreground",children:S.description}),E.length>0&&m.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",E.map(C=>C.name).join(", ")]})]})]})},S.id)})})})]}),w=()=>m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"relative",children:[m.jsx(Nd,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(qn,{type:"search",placeholder:"Filter rules...",value:u,onChange:S=>d(S.target.value),className:"pl-8 h-9"})]}),m.jsx(Yl,{className:"h-64 border rounded-md p-2 bg-background/50",children:p.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:a.length===0?"No rules defined.":"No rules match filter."}):m.jsx("div",{className:"space-y-1",children:p.map(S=>m.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:m.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[m.jsx(MC,{id:`rule-activate-${S.id}`,checked:t.has(S.id),onCheckedChange:E=>v(S.id,!!E),className:"mt-0.5"}),m.jsxs(en,{htmlFor:`rule-activate-${S.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[m.jsx("span",{className:"block font-medium",children:S.name}),m.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",S.type]}),m.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",S.content]})]})]})},S.id))})})]}),x=[{value:"tags",label:"Activate Tags",content:b()},{value:"rules",label:"Activate Rules",content:w()}];return m.jsx("div",{className:"p-0 h-[28rem] max-w-lg",children:m.jsx(Pu,{tabs:x,defaultValue:"tags"})})};let Ed=new Set,Cd=new Set,Km=()=>{};const v1e=()=>{const[e,t]=T.useState({activeTagIds:Ed,activeRuleIds:Cd}),[n,r]=T.useState(!1),[a,i]=T.useState(()=>Zn.getState().status==="streaming"),s=Xl(h=>h.rules.length>0||h.tags.length>0);T.useEffect(()=>(Km=h=>{const p=h({activeTagIds:Ed,activeRuleIds:Cd});Ed=p.activeTagIds,Cd=p.activeRuleIds,t(p)},t({activeTagIds:Ed,activeRuleIds:Cd}),()=>{Km=()=>{}}),[]),T.useEffect(()=>{const h=p=>{i(p.status==="streaming")};return St.on(_t.INTERACTION_STATUS_CHANGED,h),()=>{St.off(_t.INTERACTION_STATUS_CHANGED,h)}},[]);const o=T.useCallback((h,p)=>{Km(y=>{const v=new Set(y.activeTagIds);return p?v.add(h):v.delete(h),{...y,activeTagIds:v}})},[]),l=T.useCallback((h,p)=>{Km(y=>{const v=new Set(y.activeRuleIds);return p?v.add(h):v.delete(h),{...y,activeRuleIds:v}})},[]),u=e.activeTagIds.size>0||e.activeRuleIds.size>0,d=a||!s;return s?m.jsxs(Lu,{open:n,onOpenChange:r,children:[m.jsx(Kn,{delayDuration:100,children:m.jsxs(Yn,{children:[m.jsx(Xn,{asChild:!0,children:m.jsx($u,{asChild:!0,children:m.jsx(Mt,{variant:u?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:d,"aria-label":"Configure Rules & Tags for Next Turn",children:m.jsx(kH,{className:"h-4 w-4"})})})}),m.jsx(Jn,{side:"top",children:u?`Rules/Tags Active (${e.activeTagIds.size} tags, ${e.activeRuleIds.size} rules)`:"Activate Rules/Tags (Next Turn)"})]})}),m.jsx(Bu,{className:"w-auto p-0",align:"start",children:m.jsx(b1e,{activeTagIds:e.activeTagIds,activeRuleIds:e.activeRuleIds,onToggleTag:o,onToggleRule:l})})]}):null};function w1e(){const e=Dr.getState().registerPromptControl;Ed=new Set,Cd=new Set,e({id:"core-rules-tags",status:()=>Xl.getState().isLoading?"loading":"ready",triggerRenderer:()=>gt.createElement(v1e),getMetadata:()=>{const t=Array.from(Ed),n=Array.from(Cd);if(t.length>0||n.length>0)return{activeTagIds:t,activeRuleIds:n}},clearOnSubmit:()=>{Ed=new Set,Cd=new Set,Km(()=>({activeTagIds:new Set,activeRuleIds:new Set}))},show:()=>{const t=Xl.getState();return t.rules.length>0||t.tags.length>0}}),console.log("[Function] Registered Core Rules & Tags Control")}const x1e=()=>{const[e,t]=T.useState(!0),n=mn(Y=>Y.selectedItemId),r=mn(Y=>Y.selectedItemType),a=mn(Y=>Y.loadSidebarItems),i=mn(Y=>Y.getConversationById),{getEffectiveProjectSettings:s}=ii(dn(Y=>({projects:Y.projects,getProjectById:Y.getProjectById,getEffectiveProjectSettings:Y.getEffectiveProjectSettings}))),{interactions:o,status:l}=Zn(dn(Y=>({interactions:Y.interactions,status:Y.status}))),{globalError:u,isSidebarCollapsed:d,isChatControlPanelOpen:h,isProjectSettingsModalOpen:p,isVfsModalOpen:y}=pa(dn(Y=>({globalError:Y.globalError,isSidebarCollapsed:Y.isSidebarCollapsed,isChatControlPanelOpen:Y.isChatControlPanelOpen,isProjectSettingsModalOpen:Y.isProjectSettingsModalOpen,isVfsModalOpen:Y.isVfsModalOpen}))),v=Dr(dn(Y=>Object.values(Y.chatControls))),{loadDbMods:b,setLoadedMods:w}=Qg(dn(Y=>({loadDbMods:Y.loadDbMods,setLoadedMods:Y.setLoadedMods}))),{loadInitialData:x}=Fn(dn(Y=>({loadInitialData:Y.loadInitialData}))),{loadSettings:S}=qr(dn(Y=>({loadSettings:Y.loadSettings}))),{setVfsKey:E}=Xs(dn(Y=>({setVfsKey:Y.setVfsKey}))),{initializePromptState:C}=Ca(dn(Y=>({initializePromptState:Y.initializePromptState}))),{loadRulesAndTags:k}=Xl(dn(Y=>({loadRulesAndTags:Y.loadRulesAndTags})));T.useEffect(()=>{let Y=!0;return(async()=>{var ae;console.log("LiteChat: Starting initialization..."),t(!0);try{if(console.log("LiteChat: Loading core data..."),await S(),!Y||(console.log("LiteChat: Settings loaded."),await x(),!Y)||(console.log("LiteChat: Provider data loaded."),await k(),!Y)||(console.log("LiteChat: Rules and Tags loaded."),await a(),!Y)||(console.log("LiteChat: Sidebar items loaded."),console.log("LiteChat: Registering core controls and tools..."),jge(),Zve(),Kve(),a1e(),s1e(),h1e(),l1e(),m1e(),y1e(),nwe(),Dxe(),Jxe(),w1e(),Jve(),d1e(),Pxe(),qxe(),Zxe(),console.log("LiteChat: Core controls and tools registered."),!Y)||(console.log("LiteChat: Loading mods..."),await b(),!Y))return;console.log("LiteChat: DB Mods loaded.");const B=Qg.getState().dbMods;console.log(`LiteChat: Processing ${B.length} mods...`);const J=await Sge(B);if(!Y)return;w(J),console.log(`LiteChat: ${J.length} mods processed.`);const ee=r==="project"?n:r==="conversation"?((ae=i(n))==null?void 0:ae.projectId)??null:null,oe=s(ee);C(oe),console.log("LiteChat: Initial prompt state initialized.",oe)}catch(B){console.error("LiteChat: Initialization failed:",B),tt.error(`Initialization failed: ${B instanceof Error?B.message:String(B)}`),pa.getState().setGlobalError("Initialization failed.")}finally{Y&&(console.log("LiteChat: Initialization complete."),t(!1))}})(),()=>{Y=!1,console.log("LiteChat: Unmounting, initialization cancelled if pending.")}},[]);const R=T.useRef({itemId:null,itemType:null});T.useEffect(()=>{var Q;if(e)return;const Y={itemId:n,itemType:r};if(Y.itemId!==R.current.itemId||Y.itemType!==R.current.itemType){const ae=r==="project"?n:r==="conversation"?((Q=i(n))==null?void 0:Q.projectId)??null:null;console.log(`[LiteChat Effect] Context changed (Item: ${n}, Type: ${r}). Calculating effective settings for Project ID: ${ae}`);const B=s(ae);C(B),console.log("[LiteChat Effect] Prompt state updated based on context change.",B),R.current=Y}},[n,r,i,s,C,e]),T.useEffect(()=>{let Y=null;if(y||r==="project"){if(r==="project")Y=n;else if(r==="conversation"){const Q=mn.getState().getConversationById(n);Y=(Q==null?void 0:Q.projectId)??"orphan"}else Y="orphan";console.log(`[LiteChat Effect] VFS Context Required. Setting target key: ${Y}`)}else Y=null,console.log("[LiteChat Effect] VFS Context Not Required. Setting target key: null");Xs.getState().vfsKey!==Y&&E(Y)},[y,n,r,E]);const O=T.useCallback(async Y=>{var oe;const Q=mn.getState(),ae=pa.getState(),B=Ca.getState();let J=Q.selectedItemType==="conversation"?Q.selectedItemId:null;const ee=Q.selectedItemType==="project"?Q.selectedItemId:Q.selectedItemType==="conversation"?((oe=Q.getConversationById(Q.selectedItemId))==null?void 0:oe.projectId)??null:null;if(!J){console.log("LiteChat: No conversation selected, creating new one...");try{const me=await Q.addConversation({title:"New Chat",projectId:ee});await Q.selectItem(me,"conversation"),J=mn.getState().selectedItemId,J!==me&&console.error("LiteChat: Mismatch between created ID and selected ID after selection!"),console.log(`LiteChat: New conversation created (${J}), selected.`),setTimeout(()=>ae.setFocusInputFlag(!0),0)}catch(me){console.error("LiteChat: Failed to create new conversation",me),tt.error("Failed to start new chat.");return}}console.log("LiteChat: Submitting turn data to ConversationService...");try{const me={...Y,metadata:{...Y.metadata,modelId:B.modelId}};await AO.submitPrompt(me),console.log("LiteChat: ConversationService processing initiated."),ae.setFocusInputFlag(!0)}catch(me){console.error("LiteChat: Error submitting prompt:",me)}},[]),j=T.useCallback(async Y=>{console.log(`LiteChat: Regenerating interaction ${Y}`);try{await AO.regenerateInteraction(Y),console.log(`LiteChat: ConversationService regeneration initiated for ${Y}.`),pa.getState().setFocusInputFlag(!0)}catch(Q){console.error("LiteChat: Error regenerating interaction:",Q)}},[]),$=T.useCallback(Y=>{console.log(`LiteChat: Stopping interaction ${Y}`),_C.abortInteraction(Y)},[]),L=T.useMemo(()=>v.filter(Y=>(Y.panel??"main")==="sidebar"&&(Y.show?Y.show():!0)).map(Y=>Y),[v]),X=T.useMemo(()=>v.filter(Y=>Y.panel==="sidebar-footer"&&(Y.show?Y.show():!0)).map(Y=>Y),[v]),F=T.useMemo(()=>v.filter(Y=>Y.panel==="header"&&(Y.show?Y.show():!0)).map(Y=>Y),[v]),K=T.useMemo(()=>{var Y;return(Y=v.find(Q=>Q.id==="core-settings-trigger"))==null?void 0:Y.settingsRenderer},[v]),q=T.useMemo(()=>{var Y;return(Y=v.find(Q=>Q.id==="core-project-settings-trigger"))==null?void 0:Y.settingsRenderer},[v]),de=T.useMemo(()=>{var Y;return(Y=v.find(Q=>Q.id==="core-vfs-modal-panel"))==null?void 0:Y.renderer},[v]),re=r==="conversation"?n:null;return e?m.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:m.jsxs("div",{className:"flex flex-col items-center gap-4",children:[m.jsx(zn,{className:"h-12 w-12 animate-spin text-primary"}),m.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:Nt("flex h-full w-full border border-[--border] rounded-lg overflow-hidden bg-background text-foreground"),children:[m.jsxs("div",{className:Nt("hidden md:flex flex-col border-r border-[--border] bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",d?"w-16":"w-64"),children:[m.jsxs("div",{className:Nt("flex-grow overflow-y-auto overflow-x-hidden"),children:[m.jsx("div",{className:Nt(d?"hidden":"block"),children:m.jsx(Gb,{controls:L,panelId:"sidebar",renderMode:"full",className:"h-full"})}),m.jsx("div",{className:Nt(d?"block":"hidden"),children:m.jsx(Gb,{controls:L,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),m.jsx("div",{className:Nt("flex-shrink-0 border-t border-[--border] p-2",d?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:m.jsx(Gb,{controls:X,panelId:"sidebar-footer",renderMode:d?"icon":"full",className:Nt("flex",d?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),m.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[m.jsx("div",{className:"flex items-center justify-end p-2 border-b border-[--border] bg-card flex-shrink-0",children:m.jsx(Gb,{controls:F,panelId:"header",className:"flex items-center justify-end gap-1"})}),m.jsx(Ffe,{conversationId:re,interactions:o,onRegenerateInteraction:j,onStopInteraction:$,status:l,className:"flex-grow overflow-y-hidden p-4 space-y-4"}),u&&m.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",u]}),m.jsx(iX,{InputAreaRenderer:z$,onSubmit:O,className:"border-t border-[--border] bg-card flex-shrink-0"})]})]}),h.settingsModal&&K&&K(),p&&q&&q(),y&&de&&de(),m.jsx(Age,{richColors:!0,position:"bottom-right",closeButton:!0})]})};function _1e(){return m.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:m.jsx("main",{className:"flex-grow overflow-hidden",children:m.jsx(x1e,{})})})}nV();function S1e({children:e}){const t=qr(n=>n.theme);return T.useEffect(()=>{const n=window.document.documentElement;if(n.classList.remove("light","dark"),t==="system"){const r=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";n.classList.add(r)}else n.classList.add(t)},[t]),m.jsx(m.Fragment,{children:e})}rU.createRoot(document.getElementById("root")).render(m.jsx(gt.StrictMode,{children:m.jsx(S1e,{children:m.jsx(_1e,{})})}));
